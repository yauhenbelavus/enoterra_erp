function sb(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Gu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ob(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var W0={exports:{}},el={},U0={exports:{}},Nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pm;function ib(){if(pm)return Nt;pm=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function g(M){return M===null||typeof M!="object"?null:(M=m&&M[m]||M["@@iterator"],typeof M=="function"?M:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function k(M,F,le){this.props=M,this.context=F,this.refs=b,this.updater=le||v}k.prototype.isReactComponent={},k.prototype.setState=function(M,F){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,F,"setState")},k.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function N(){}N.prototype=k.prototype;function C(M,F,le){this.props=M,this.context=F,this.refs=b,this.updater=le||v}var S=C.prototype=new N;S.constructor=C,w(S,k.prototype),S.isPureReactComponent=!0;var U=Array.isArray,te=Object.prototype.hasOwnProperty,Q={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function K(M,F,le){var A,T={},j=null,R=null;if(F!=null)for(A in F.ref!==void 0&&(R=F.ref),F.key!==void 0&&(j=""+F.key),F)te.call(F,A)&&!D.hasOwnProperty(A)&&(T[A]=F[A]);var q=arguments.length-2;if(q===1)T.children=le;else if(1<q){for(var H=Array(q),B=0;B<q;B++)H[B]=arguments[B+2];T.children=H}if(M&&M.defaultProps)for(A in q=M.defaultProps,q)T[A]===void 0&&(T[A]=q[A]);return{$$typeof:e,type:M,key:j,ref:R,props:T,_owner:Q.current}}function W(M,F){return{$$typeof:e,type:M.type,key:F,ref:M.ref,props:M.props,_owner:M._owner}}function oe(M){return typeof M=="object"&&M!==null&&M.$$typeof===e}function J(M){var F={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(le){return F[le]})}var Y=/\/+/g;function pe(M,F){return typeof M=="object"&&M!==null&&M.key!=null?J(""+M.key):F.toString(36)}function de(M,F,le,A,T){var j=typeof M;(j==="undefined"||j==="boolean")&&(M=null);var R=!1;if(M===null)R=!0;else switch(j){case"string":case"number":R=!0;break;case"object":switch(M.$$typeof){case e:case n:R=!0}}if(R)return R=M,T=T(R),M=A===""?"."+pe(R,0):A,U(T)?(le="",M!=null&&(le=M.replace(Y,"$&/")+"/"),de(T,F,le,"",function(B){return B})):T!=null&&(oe(T)&&(T=W(T,le+(!T.key||R&&R.key===T.key?"":(""+T.key).replace(Y,"$&/")+"/")+M)),F.push(T)),1;if(R=0,A=A===""?".":A+":",U(M))for(var q=0;q<M.length;q++){j=M[q];var H=A+pe(j,q);R+=de(j,F,le,H,T)}else if(H=g(M),typeof H=="function")for(M=H.call(M),q=0;!(j=M.next()).done;)j=j.value,H=A+pe(j,q++),R+=de(j,F,le,H,T);else if(j==="object")throw F=String(M),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return R}function G(M,F,le){if(M==null)return M;var A=[],T=0;return de(M,A,"","",function(j){return F.call(le,j,T++)}),A}function ie(M){if(M._status===-1){var F=M._result;F=F(),F.then(function(le){(M._status===0||M._status===-1)&&(M._status=1,M._result=le)},function(le){(M._status===0||M._status===-1)&&(M._status=2,M._result=le)}),M._status===-1&&(M._status=0,M._result=F)}if(M._status===1)return M._result.default;throw M._result}var L={current:null},ne={transition:null},O={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:ne,ReactCurrentOwner:Q};function re(){throw Error("act(...) is not supported in production builds of React.")}return Nt.Children={map:G,forEach:function(M,F,le){G(M,function(){F.apply(this,arguments)},le)},count:function(M){var F=0;return G(M,function(){F++}),F},toArray:function(M){return G(M,function(F){return F})||[]},only:function(M){if(!oe(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},Nt.Component=k,Nt.Fragment=t,Nt.Profiler=a,Nt.PureComponent=C,Nt.StrictMode=r,Nt.Suspense=f,Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,Nt.act=re,Nt.cloneElement=function(M,F,le){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var A=w({},M.props),T=M.key,j=M.ref,R=M._owner;if(F!=null){if(F.ref!==void 0&&(j=F.ref,R=Q.current),F.key!==void 0&&(T=""+F.key),M.type&&M.type.defaultProps)var q=M.type.defaultProps;for(H in F)te.call(F,H)&&!D.hasOwnProperty(H)&&(A[H]=F[H]===void 0&&q!==void 0?q[H]:F[H])}var H=arguments.length-2;if(H===1)A.children=le;else if(1<H){q=Array(H);for(var B=0;B<H;B++)q[B]=arguments[B+2];A.children=q}return{$$typeof:e,type:M.type,key:T,ref:j,props:A,_owner:R}},Nt.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:o,_context:M},M.Consumer=M},Nt.createElement=K,Nt.createFactory=function(M){var F=K.bind(null,M);return F.type=M,F},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(M){return{$$typeof:c,render:M}},Nt.isValidElement=oe,Nt.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:ie}},Nt.memo=function(M,F){return{$$typeof:h,type:M,compare:F===void 0?null:F}},Nt.startTransition=function(M){var F=ne.transition;ne.transition={};try{M()}finally{ne.transition=F}},Nt.unstable_act=re,Nt.useCallback=function(M,F){return L.current.useCallback(M,F)},Nt.useContext=function(M){return L.current.useContext(M)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(M){return L.current.useDeferredValue(M)},Nt.useEffect=function(M,F){return L.current.useEffect(M,F)},Nt.useId=function(){return L.current.useId()},Nt.useImperativeHandle=function(M,F,le){return L.current.useImperativeHandle(M,F,le)},Nt.useInsertionEffect=function(M,F){return L.current.useInsertionEffect(M,F)},Nt.useLayoutEffect=function(M,F){return L.current.useLayoutEffect(M,F)},Nt.useMemo=function(M,F){return L.current.useMemo(M,F)},Nt.useReducer=function(M,F,le){return L.current.useReducer(M,F,le)},Nt.useRef=function(M){return L.current.useRef(M)},Nt.useState=function(M){return L.current.useState(M)},Nt.useSyncExternalStore=function(M,F,le){return L.current.useSyncExternalStore(M,F,le)},Nt.useTransition=function(){return L.current.useTransition()},Nt.version="18.3.1",Nt}var hm;function Fl(){return hm||(hm=1,U0.exports=ib()),U0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xm;function lb(){if(xm)return el;xm=1;var e=Fl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,h){var p,m={},g=null,v=null;h!==void 0&&(g=""+h),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(v=f.ref);for(p in f)r.call(f,p)&&!o.hasOwnProperty(p)&&(m[p]=f[p]);if(c&&c.defaultProps)for(p in f=c.defaultProps,f)m[p]===void 0&&(m[p]=f[p]);return{$$typeof:n,type:c,key:g,ref:v,props:m,_owner:a.current}}return el.Fragment=t,el.jsx=l,el.jsxs=l,el}var mm;function cb(){return mm||(mm=1,W0.exports=lb()),W0.exports}var u=cb(),E=Fl();const Te=Gu(E),zv=sb({__proto__:null,default:Te},[E]);var Gc={},$0={exports:{}},vn={},H0={exports:{}},Y0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gm;function ub(){return gm||(gm=1,(function(e){function n(ne,O){var re=ne.length;ne.push(O);e:for(;0<re;){var M=re-1>>>1,F=ne[M];if(0<a(F,O))ne[M]=O,ne[re]=F,re=M;else break e}}function t(ne){return ne.length===0?null:ne[0]}function r(ne){if(ne.length===0)return null;var O=ne[0],re=ne.pop();if(re!==O){ne[0]=re;e:for(var M=0,F=ne.length,le=F>>>1;M<le;){var A=2*(M+1)-1,T=ne[A],j=A+1,R=ne[j];if(0>a(T,re))j<F&&0>a(R,T)?(ne[M]=R,ne[j]=re,M=j):(ne[M]=T,ne[A]=re,M=A);else if(j<F&&0>a(R,re))ne[M]=R,ne[j]=re,M=j;else break e}}return O}function a(ne,O){var re=ne.sortIndex-O.sortIndex;return re!==0?re:ne.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],h=[],p=1,m=null,g=3,v=!1,w=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(ne){for(var O=t(h);O!==null;){if(O.callback===null)r(h);else if(O.startTime<=ne)r(h),O.sortIndex=O.expirationTime,n(f,O);else break;O=t(h)}}function U(ne){if(b=!1,S(ne),!w)if(t(f)!==null)w=!0,ie(te);else{var O=t(h);O!==null&&L(U,O.startTime-ne)}}function te(ne,O){w=!1,b&&(b=!1,N(K),K=-1),v=!0;var re=g;try{for(S(O),m=t(f);m!==null&&(!(m.expirationTime>O)||ne&&!J());){var M=m.callback;if(typeof M=="function"){m.callback=null,g=m.priorityLevel;var F=M(m.expirationTime<=O);O=e.unstable_now(),typeof F=="function"?m.callback=F:m===t(f)&&r(f),S(O)}else r(f);m=t(f)}if(m!==null)var le=!0;else{var A=t(h);A!==null&&L(U,A.startTime-O),le=!1}return le}finally{m=null,g=re,v=!1}}var Q=!1,D=null,K=-1,W=5,oe=-1;function J(){return!(e.unstable_now()-oe<W)}function Y(){if(D!==null){var ne=e.unstable_now();oe=ne;var O=!0;try{O=D(!0,ne)}finally{O?pe():(Q=!1,D=null)}}else Q=!1}var pe;if(typeof C=="function")pe=function(){C(Y)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,G=de.port2;de.port1.onmessage=Y,pe=function(){G.postMessage(null)}}else pe=function(){k(Y,0)};function ie(ne){D=ne,Q||(Q=!0,pe())}function L(ne,O){K=k(function(){ne(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){w||v||(w=!0,ie(te))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(ne){switch(g){case 1:case 2:case 3:var O=3;break;default:O=g}var re=g;g=O;try{return ne()}finally{g=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,O){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var re=g;g=ne;try{return O()}finally{g=re}},e.unstable_scheduleCallback=function(ne,O,re){var M=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?M+re:M):re=M,ne){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=re+F,ne={id:p++,callback:O,priorityLevel:ne,startTime:re,expirationTime:F,sortIndex:-1},re>M?(ne.sortIndex=re,n(h,ne),t(f)===null&&ne===t(h)&&(b?(N(K),K=-1):b=!0,L(U,re-M))):(ne.sortIndex=F,n(f,ne),w||v||(w=!0,ie(te))),ne},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(ne){var O=g;return function(){var re=g;g=O;try{return ne.apply(this,arguments)}finally{g=re}}}})(Y0)),Y0}var vm;function db(){return vm||(vm=1,H0.exports=ub()),H0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ym;function fb(){if(ym)return vn;ym=1;var e=Fl(),n=db();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,d=1;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function g(s){return f.call(m,s)?!0:f.call(p,s)?!1:h.test(s)?m[s]=!0:(p[s]=!0,!1)}function v(s,i,d,x){if(d!==null&&d.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return x?!1:d!==null?!d.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function w(s,i,d,x){if(i===null||typeof i>"u"||v(s,i,d,x))return!0;if(x)return!1;if(d!==null)switch(d.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function b(s,i,d,x,y,_,z){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=x,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=s,this.type=i,this.sanitizeURL=_,this.removeEmptyString=z}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){k[s]=new b(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];k[i]=new b(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){k[s]=new b(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){k[s]=new b(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){k[s]=new b(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){k[s]=new b(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){k[s]=new b(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){k[s]=new b(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){k[s]=new b(s,5,!1,s.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function C(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(N,C);k[i]=new b(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(N,C);k[i]=new b(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(N,C);k[i]=new b(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){k[s]=new b(s,1,!1,s.toLowerCase(),null,!1,!1)}),k.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){k[s]=new b(s,1,!1,s.toLowerCase(),null,!0,!0)});function S(s,i,d,x){var y=k.hasOwnProperty(i)?k[i]:null;(y!==null?y.type!==0:x||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(w(i,d,y,x)&&(d=null),x||y===null?g(i)&&(d===null?s.removeAttribute(i):s.setAttribute(i,""+d)):y.mustUseProperty?s[y.propertyName]=d===null?y.type===3?!1:"":d:(i=y.attributeName,x=y.attributeNamespace,d===null?s.removeAttribute(i):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,x?s.setAttributeNS(x,i,d):s.setAttribute(i,d))))}var U=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),Q=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),K=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),oe=Symbol.for("react.provider"),J=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),L=Symbol.for("react.offscreen"),ne=Symbol.iterator;function O(s){return s===null||typeof s!="object"?null:(s=ne&&s[ne]||s["@@iterator"],typeof s=="function"?s:null)}var re=Object.assign,M;function F(s){if(M===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);M=i&&i[1]||""}return`
`+M+s}var le=!1;function A(s,i){if(!s||le)return"";le=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Ce){var x=Ce}Reflect.construct(s,[],i)}else{try{i.call()}catch(Ce){x=Ce}s.call(i.prototype)}else{try{throw Error()}catch(Ce){x=Ce}s()}}catch(Ce){if(Ce&&x&&typeof Ce.stack=="string"){for(var y=Ce.stack.split(`
`),_=x.stack.split(`
`),z=y.length-1,ce=_.length-1;1<=z&&0<=ce&&y[z]!==_[ce];)ce--;for(;1<=z&&0<=ce;z--,ce--)if(y[z]!==_[ce]){if(z!==1||ce!==1)do if(z--,ce--,0>ce||y[z]!==_[ce]){var xe=`
`+y[z].replace(" at new "," at ");return s.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",s.displayName)),xe}while(1<=z&&0<=ce);break}}}finally{le=!1,Error.prepareStackTrace=d}return(s=s?s.displayName||s.name:"")?F(s):""}function T(s){switch(s.tag){case 5:return F(s.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return s=A(s.type,!1),s;case 11:return s=A(s.type.render,!1),s;case 1:return s=A(s.type,!0),s;default:return""}}function j(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case Q:return"Portal";case W:return"Profiler";case K:return"StrictMode";case pe:return"Suspense";case de:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case J:return(s.displayName||"Context")+".Consumer";case oe:return(s._context.displayName||"Context")+".Provider";case Y:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case G:return i=s.displayName||null,i!==null?i:j(s.type)||"Memo";case ie:i=s._payload,s=s._init;try{return j(s(i))}catch{}}return null}function R(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(i);case 8:return i===K?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function q(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function H(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function B(s){var i=H(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),x=""+s[i];if(!s.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,_=d.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return y.call(this)},set:function(z){x=""+z,_.call(this,z)}}),Object.defineProperty(s,i,{enumerable:d.enumerable}),{getValue:function(){return x},setValue:function(z){x=""+z},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function fe(s){s._valueTracker||(s._valueTracker=B(s))}function I(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var d=i.getValue(),x="";return s&&(x=H(s)?s.checked?"true":"false":s.value),s=x,s!==d?(i.setValue(s),!0):!1}function Fe(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Pe(s,i){var d=i.checked;return re({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??s._wrapperState.initialChecked})}function Qe(s,i){var d=i.defaultValue==null?"":i.defaultValue,x=i.checked!=null?i.checked:i.defaultChecked;d=q(i.value!=null?i.value:d),s._wrapperState={initialChecked:x,initialValue:d,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function qe(s,i){i=i.checked,i!=null&&S(s,"checked",i,!1)}function he(s,i){qe(s,i);var d=q(i.value),x=i.type;if(d!=null)x==="number"?(d===0&&s.value===""||s.value!=d)&&(s.value=""+d):s.value!==""+d&&(s.value=""+d);else if(x==="submit"||x==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?we(s,i.type,d):i.hasOwnProperty("defaultValue")&&we(s,i.type,q(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function ue(s,i,d){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var x=i.type;if(!(x!=="submit"&&x!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,d||i===s.value||(s.value=i),s.defaultValue=i}d=s.name,d!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,d!==""&&(s.name=d)}function we(s,i,d){(i!=="number"||Fe(s.ownerDocument)!==s)&&(d==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+d&&(s.defaultValue=""+d))}var ve=Array.isArray;function Oe(s,i,d,x){if(s=s.options,i){i={};for(var y=0;y<d.length;y++)i["$"+d[y]]=!0;for(d=0;d<s.length;d++)y=i.hasOwnProperty("$"+s[d].value),s[d].selected!==y&&(s[d].selected=y),y&&x&&(s[d].defaultSelected=!0)}else{for(d=""+q(d),i=null,y=0;y<s.length;y++){if(s[y].value===d){s[y].selected=!0,x&&(s[y].defaultSelected=!0);return}i!==null||s[y].disabled||(i=s[y])}i!==null&&(i.selected=!0)}}function lt(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return re({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function ft(s,i){var d=i.value;if(d==null){if(d=i.children,i=i.defaultValue,d!=null){if(i!=null)throw Error(t(92));if(ve(d)){if(1<d.length)throw Error(t(93));d=d[0]}i=d}i==null&&(i=""),d=i}s._wrapperState={initialValue:q(d)}}function gt(s,i){var d=q(i.value),x=q(i.defaultValue);d!=null&&(d=""+d,d!==s.value&&(s.value=d),i.defaultValue==null&&s.defaultValue!==d&&(s.defaultValue=d)),x!=null&&(s.defaultValue=""+x)}function Rt(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Gt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cr(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Gt(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Lt,Qt=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,d,x,y){MSApp.execUnsafeLocalFunction(function(){return s(i,d,x,y)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Lt=Lt||document.createElement("div"),Lt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Lt.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function dt(s,i){if(i){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=i;return}}s.textContent=i}var Et={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xt=["Webkit","ms","Moz","O"];Object.keys(Et).forEach(function(s){Xt.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),Et[i]=Et[s]})});function Ct(s,i,d){return i==null||typeof i=="boolean"||i===""?"":d||typeof i!="number"||i===0||Et.hasOwnProperty(s)&&Et[s]?(""+i).trim():i+"px"}function $t(s,i){s=s.style;for(var d in i)if(i.hasOwnProperty(d)){var x=d.indexOf("--")===0,y=Ct(d,i[d],x);d==="float"&&(d="cssFloat"),x?s.setProperty(d,y):s[d]=y}}var Bt=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jr(s,i){if(i){if(Bt[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function en(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var me=null;function Ae(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ze=null,Ze=null,rt=null;function se(s){if(s=Li(s)){if(typeof ze!="function")throw Error(t(280));var i=s.stateNode;i&&(i=cc(i),ze(s.stateNode,s.type,i))}}function ye(s){Ze?rt?rt.push(s):rt=[s]:Ze=s}function De(){if(Ze){var s=Ze,i=rt;if(rt=Ze=null,se(s),i)for(s=0;s<i.length;s++)se(i[s])}}function Re(s,i){return s(i)}function $e(){}var et=!1;function mt(s,i,d){if(et)return s(i,d);et=!0;try{return Re(s,i,d)}finally{et=!1,(Ze!==null||rt!==null)&&($e(),De())}}function Mt(s,i){var d=s.stateNode;if(d===null)return null;var x=cc(d);if(x===null)return null;d=x[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(t(231,i,typeof d));return d}var Ke=!1;if(c)try{var Je={};Object.defineProperty(Je,"passive",{get:function(){Ke=!0}}),window.addEventListener("test",Je,Je),window.removeEventListener("test",Je,Je)}catch{Ke=!1}function Me(s,i,d,x,y,_,z,ce,xe){var Ce=Array.prototype.slice.call(arguments,3);try{i.apply(d,Ce)}catch(Le){this.onError(Le)}}var tt=!1,wt=null,P=!1,ee=null,V={onError:function(s){tt=!0,wt=s}};function X(s,i,d,x,y,_,z,ce,xe){tt=!1,wt=null,Me.apply(V,arguments)}function Z(s,i,d,x,y,_,z,ce,xe){if(X.apply(this,arguments),tt){if(tt){var Ce=wt;tt=!1,wt=null}else throw Error(t(198));P||(P=!0,ee=Ce)}}function ae(s){var i=s,d=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(d=i.return),s=i.return;while(s)}return i.tag===3?d:null}function _e(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function je(s){if(ae(s)!==s)throw Error(t(188))}function be(s){var i=s.alternate;if(!i){if(i=ae(s),i===null)throw Error(t(188));return i!==s?null:s}for(var d=s,x=i;;){var y=d.return;if(y===null)break;var _=y.alternate;if(_===null){if(x=y.return,x!==null){d=x;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===d)return je(y),s;if(_===x)return je(y),i;_=_.sibling}throw Error(t(188))}if(d.return!==x.return)d=y,x=_;else{for(var z=!1,ce=y.child;ce;){if(ce===d){z=!0,d=y,x=_;break}if(ce===x){z=!0,x=y,d=_;break}ce=ce.sibling}if(!z){for(ce=_.child;ce;){if(ce===d){z=!0,d=_,x=y;break}if(ce===x){z=!0,x=_,d=y;break}ce=ce.sibling}if(!z)throw Error(t(189))}}if(d.alternate!==x)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?s:i}function Ee(s){return s=be(s),s!==null?Ne(s):null}function Ne(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=Ne(s);if(i!==null)return i;s=s.sibling}return null}var Be=n.unstable_scheduleCallback,Xe=n.unstable_cancelCallback,We=n.unstable_shouldYield,Ue=n.unstable_requestPaint,Ye=n.unstable_now,xt=n.unstable_getCurrentPriorityLevel,Ht=n.unstable_ImmediatePriority,Wt=n.unstable_UserBlockingPriority,hr=n.unstable_NormalPriority,Ls=n.unstable_LowPriority,rs=n.unstable_IdlePriority,da=null,Dr=null;function wi(s){if(Dr&&typeof Dr.onCommitFiberRoot=="function")try{Dr.onCommitFiberRoot(da,s,void 0,(s.current.flags&128)===128)}catch{}}var xr=Math.clz32?Math.clz32:_w,kw=Math.log,bw=Math.LN2;function _w(s){return s>>>=0,s===0?32:31-(kw(s)/bw|0)|0}var Yl=64,Vl=4194304;function ki(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Kl(s,i){var d=s.pendingLanes;if(d===0)return 0;var x=0,y=s.suspendedLanes,_=s.pingedLanes,z=d&268435455;if(z!==0){var ce=z&~y;ce!==0?x=ki(ce):(_&=z,_!==0&&(x=ki(_)))}else z=d&~y,z!==0?x=ki(z):_!==0&&(x=ki(_));if(x===0)return 0;if(i!==0&&i!==x&&(i&y)===0&&(y=x&-x,_=i&-i,y>=_||y===16&&(_&4194240)!==0))return i;if((x&4)!==0&&(x|=d&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=x;0<i;)d=31-xr(i),y=1<<d,x|=s[d],i&=~y;return x}function Sw(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ew(s,i){for(var d=s.suspendedLanes,x=s.pingedLanes,y=s.expirationTimes,_=s.pendingLanes;0<_;){var z=31-xr(_),ce=1<<z,xe=y[z];xe===-1?((ce&d)===0||(ce&x)!==0)&&(y[z]=Sw(ce,i)):xe<=i&&(s.expiredLanes|=ce),_&=~ce}}function ld(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Hp(){var s=Yl;return Yl<<=1,(Yl&4194240)===0&&(Yl=64),s}function cd(s){for(var i=[],d=0;31>d;d++)i.push(s);return i}function bi(s,i,d){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-xr(i),s[i]=d}function Nw(s,i){var d=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var x=s.eventTimes;for(s=s.expirationTimes;0<d;){var y=31-xr(d),_=1<<y;i[y]=0,x[y]=-1,s[y]=-1,d&=~_}}function ud(s,i){var d=s.entangledLanes|=i;for(s=s.entanglements;d;){var x=31-xr(d),y=1<<x;y&i|s[x]&i&&(s[x]|=i),d&=~y}}var Yt=0;function Yp(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Vp,dd,Kp,Gp,Qp,fd=!1,Gl=[],ns=null,as=null,ss=null,_i=new Map,Si=new Map,os=[],Cw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xp(s,i){switch(s){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":ss=null;break;case"pointerover":case"pointerout":_i.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Si.delete(i.pointerId)}}function Ei(s,i,d,x,y,_){return s===null||s.nativeEvent!==_?(s={blockedOn:i,domEventName:d,eventSystemFlags:x,nativeEvent:_,targetContainers:[y]},i!==null&&(i=Li(i),i!==null&&dd(i)),s):(s.eventSystemFlags|=x,i=s.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),s)}function Tw(s,i,d,x,y){switch(i){case"focusin":return ns=Ei(ns,s,i,d,x,y),!0;case"dragenter":return as=Ei(as,s,i,d,x,y),!0;case"mouseover":return ss=Ei(ss,s,i,d,x,y),!0;case"pointerover":var _=y.pointerId;return _i.set(_,Ei(_i.get(_)||null,s,i,d,x,y)),!0;case"gotpointercapture":return _=y.pointerId,Si.set(_,Ei(Si.get(_)||null,s,i,d,x,y)),!0}return!1}function qp(s){var i=Bs(s.target);if(i!==null){var d=ae(i);if(d!==null){if(i=d.tag,i===13){if(i=_e(d),i!==null){s.blockedOn=i,Qp(s.priority,function(){Kp(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ql(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var d=hd(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(d===null){d=s.nativeEvent;var x=new d.constructor(d.type,d);me=x,d.target.dispatchEvent(x),me=null}else return i=Li(d),i!==null&&dd(i),s.blockedOn=d,!1;i.shift()}return!0}function Zp(s,i,d){Ql(s)&&d.delete(i)}function Dw(){fd=!1,ns!==null&&Ql(ns)&&(ns=null),as!==null&&Ql(as)&&(as=null),ss!==null&&Ql(ss)&&(ss=null),_i.forEach(Zp),Si.forEach(Zp)}function Ni(s,i){s.blockedOn===i&&(s.blockedOn=null,fd||(fd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Dw)))}function Ci(s){function i(y){return Ni(y,s)}if(0<Gl.length){Ni(Gl[0],s);for(var d=1;d<Gl.length;d++){var x=Gl[d];x.blockedOn===s&&(x.blockedOn=null)}}for(ns!==null&&Ni(ns,s),as!==null&&Ni(as,s),ss!==null&&Ni(ss,s),_i.forEach(i),Si.forEach(i),d=0;d<os.length;d++)x=os[d],x.blockedOn===s&&(x.blockedOn=null);for(;0<os.length&&(d=os[0],d.blockedOn===null);)qp(d),d.blockedOn===null&&os.shift()}var No=U.ReactCurrentBatchConfig,Xl=!0;function jw(s,i,d,x){var y=Yt,_=No.transition;No.transition=null;try{Yt=1,pd(s,i,d,x)}finally{Yt=y,No.transition=_}}function Fw(s,i,d,x){var y=Yt,_=No.transition;No.transition=null;try{Yt=4,pd(s,i,d,x)}finally{Yt=y,No.transition=_}}function pd(s,i,d,x){if(Xl){var y=hd(s,i,d,x);if(y===null)Fd(s,i,x,ql,d),Xp(s,x);else if(Tw(y,s,i,d,x))x.stopPropagation();else if(Xp(s,x),i&4&&-1<Cw.indexOf(s)){for(;y!==null;){var _=Li(y);if(_!==null&&Vp(_),_=hd(s,i,d,x),_===null&&Fd(s,i,x,ql,d),_===y)break;y=_}y!==null&&x.stopPropagation()}else Fd(s,i,x,null,d)}}var ql=null;function hd(s,i,d,x){if(ql=null,s=Ae(x),s=Bs(s),s!==null)if(i=ae(s),i===null)s=null;else if(d=i.tag,d===13){if(s=_e(i),s!==null)return s;s=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return ql=s,null}function Jp(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xt()){case Ht:return 1;case Wt:return 4;case hr:case Ls:return 16;case rs:return 536870912;default:return 16}default:return 16}}var is=null,xd=null,Zl=null;function eh(){if(Zl)return Zl;var s,i=xd,d=i.length,x,y="value"in is?is.value:is.textContent,_=y.length;for(s=0;s<d&&i[s]===y[s];s++);var z=d-s;for(x=1;x<=z&&i[d-x]===y[_-x];x++);return Zl=y.slice(s,1<x?1-x:void 0)}function Jl(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ec(){return!0}function th(){return!1}function kn(s){function i(d,x,y,_,z){this._reactName=d,this._targetInst=y,this.type=x,this.nativeEvent=_,this.target=z,this.currentTarget=null;for(var ce in s)s.hasOwnProperty(ce)&&(d=s[ce],this[ce]=d?d(_):_[ce]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ec:th,this.isPropagationStopped=th,this}return re(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=ec)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=ec)},persist:function(){},isPersistent:ec}),i}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},md=kn(Co),Ti=re({},Co,{view:0,detail:0}),Pw=kn(Ti),gd,vd,Di,tc=re({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Di&&(Di&&s.type==="mousemove"?(gd=s.screenX-Di.screenX,vd=s.screenY-Di.screenY):vd=gd=0,Di=s),gd)},movementY:function(s){return"movementY"in s?s.movementY:vd}}),rh=kn(tc),Aw=re({},tc,{dataTransfer:0}),Ow=kn(Aw),Rw=re({},Ti,{relatedTarget:0}),yd=kn(Rw),zw=re({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),Mw=kn(zw),Iw=re({},Co,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Lw=kn(Iw),Bw=re({},Co,{data:0}),nh=kn(Bw),Ww={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$w={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hw(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=$w[s])?!!i[s]:!1}function wd(){return Hw}var Yw=re({},Ti,{key:function(s){if(s.key){var i=Ww[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Jl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Uw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wd,charCode:function(s){return s.type==="keypress"?Jl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Jl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Vw=kn(Yw),Kw=re({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ah=kn(Kw),Gw=re({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wd}),Qw=kn(Gw),Xw=re({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),qw=kn(Xw),Zw=re({},tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Jw=kn(Zw),ek=[9,13,27,32],kd=c&&"CompositionEvent"in window,ji=null;c&&"documentMode"in document&&(ji=document.documentMode);var tk=c&&"TextEvent"in window&&!ji,sh=c&&(!kd||ji&&8<ji&&11>=ji),oh=" ",ih=!1;function lh(s,i){switch(s){case"keyup":return ek.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ch(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var To=!1;function rk(s,i){switch(s){case"compositionend":return ch(i);case"keypress":return i.which!==32?null:(ih=!0,oh);case"textInput":return s=i.data,s===oh&&ih?null:s;default:return null}}function nk(s,i){if(To)return s==="compositionend"||!kd&&lh(s,i)?(s=eh(),Zl=xd=is=null,To=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return sh&&i.locale!=="ko"?null:i.data;default:return null}}var ak={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!ak[s.type]:i==="textarea"}function dh(s,i,d,x){ye(x),i=oc(i,"onChange"),0<i.length&&(d=new md("onChange","change",null,d,x),s.push({event:d,listeners:i}))}var Fi=null,Pi=null;function sk(s){Dh(s,0)}function rc(s){var i=Ao(s);if(I(i))return s}function ok(s,i){if(s==="change")return i}var fh=!1;if(c){var bd;if(c){var _d="oninput"in document;if(!_d){var ph=document.createElement("div");ph.setAttribute("oninput","return;"),_d=typeof ph.oninput=="function"}bd=_d}else bd=!1;fh=bd&&(!document.documentMode||9<document.documentMode)}function hh(){Fi&&(Fi.detachEvent("onpropertychange",xh),Pi=Fi=null)}function xh(s){if(s.propertyName==="value"&&rc(Pi)){var i=[];dh(i,Pi,s,Ae(s)),mt(sk,i)}}function ik(s,i,d){s==="focusin"?(hh(),Fi=i,Pi=d,Fi.attachEvent("onpropertychange",xh)):s==="focusout"&&hh()}function lk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return rc(Pi)}function ck(s,i){if(s==="click")return rc(i)}function uk(s,i){if(s==="input"||s==="change")return rc(i)}function dk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Gn=typeof Object.is=="function"?Object.is:dk;function Ai(s,i){if(Gn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var d=Object.keys(s),x=Object.keys(i);if(d.length!==x.length)return!1;for(x=0;x<d.length;x++){var y=d[x];if(!f.call(i,y)||!Gn(s[y],i[y]))return!1}return!0}function mh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function gh(s,i){var d=mh(s);s=0;for(var x;d;){if(d.nodeType===3){if(x=s+d.textContent.length,s<=i&&x>=i)return{node:d,offset:i-s};s=x}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=mh(d)}}function vh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?vh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function yh(){for(var s=window,i=Fe();i instanceof s.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)s=i.contentWindow;else break;i=Fe(s.document)}return i}function Sd(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function fk(s){var i=yh(),d=s.focusedElem,x=s.selectionRange;if(i!==d&&d&&d.ownerDocument&&vh(d.ownerDocument.documentElement,d)){if(x!==null&&Sd(d)){if(i=x.start,s=x.end,s===void 0&&(s=i),"selectionStart"in d)d.selectionStart=i,d.selectionEnd=Math.min(s,d.value.length);else if(s=(i=d.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var y=d.textContent.length,_=Math.min(x.start,y);x=x.end===void 0?_:Math.min(x.end,y),!s.extend&&_>x&&(y=x,x=_,_=y),y=gh(d,_);var z=gh(d,x);y&&z&&(s.rangeCount!==1||s.anchorNode!==y.node||s.anchorOffset!==y.offset||s.focusNode!==z.node||s.focusOffset!==z.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),s.removeAllRanges(),_>x?(s.addRange(i),s.extend(z.node,z.offset)):(i.setEnd(z.node,z.offset),s.addRange(i)))}}for(i=[],s=d;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<i.length;d++)s=i[d],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var pk=c&&"documentMode"in document&&11>=document.documentMode,Do=null,Ed=null,Oi=null,Nd=!1;function wh(s,i,d){var x=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Nd||Do==null||Do!==Fe(x)||(x=Do,"selectionStart"in x&&Sd(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Oi&&Ai(Oi,x)||(Oi=x,x=oc(Ed,"onSelect"),0<x.length&&(i=new md("onSelect","select",null,i,d),s.push({event:i,listeners:x}),i.target=Do)))}function nc(s,i){var d={};return d[s.toLowerCase()]=i.toLowerCase(),d["Webkit"+s]="webkit"+i,d["Moz"+s]="moz"+i,d}var jo={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Cd={},kh={};c&&(kh=document.createElement("div").style,"AnimationEvent"in window||(delete jo.animationend.animation,delete jo.animationiteration.animation,delete jo.animationstart.animation),"TransitionEvent"in window||delete jo.transitionend.transition);function ac(s){if(Cd[s])return Cd[s];if(!jo[s])return s;var i=jo[s],d;for(d in i)if(i.hasOwnProperty(d)&&d in kh)return Cd[s]=i[d];return s}var bh=ac("animationend"),_h=ac("animationiteration"),Sh=ac("animationstart"),Eh=ac("transitionend"),Nh=new Map,Ch="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ls(s,i){Nh.set(s,i),o(i,[s])}for(var Td=0;Td<Ch.length;Td++){var Dd=Ch[Td],hk=Dd.toLowerCase(),xk=Dd[0].toUpperCase()+Dd.slice(1);ls(hk,"on"+xk)}ls(bh,"onAnimationEnd"),ls(_h,"onAnimationIteration"),ls(Sh,"onAnimationStart"),ls("dblclick","onDoubleClick"),ls("focusin","onFocus"),ls("focusout","onBlur"),ls(Eh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function Th(s,i,d){var x=s.type||"unknown-event";s.currentTarget=d,Z(x,i,void 0,s),s.currentTarget=null}function Dh(s,i){i=(i&4)!==0;for(var d=0;d<s.length;d++){var x=s[d],y=x.event;x=x.listeners;e:{var _=void 0;if(i)for(var z=x.length-1;0<=z;z--){var ce=x[z],xe=ce.instance,Ce=ce.currentTarget;if(ce=ce.listener,xe!==_&&y.isPropagationStopped())break e;Th(y,ce,Ce),_=xe}else for(z=0;z<x.length;z++){if(ce=x[z],xe=ce.instance,Ce=ce.currentTarget,ce=ce.listener,xe!==_&&y.isPropagationStopped())break e;Th(y,ce,Ce),_=xe}}}if(P)throw s=ee,P=!1,ee=null,s}function er(s,i){var d=i[Md];d===void 0&&(d=i[Md]=new Set);var x=s+"__bubble";d.has(x)||(jh(i,s,2,!1),d.add(x))}function jd(s,i,d){var x=0;i&&(x|=4),jh(d,s,x,i)}var sc="_reactListening"+Math.random().toString(36).slice(2);function zi(s){if(!s[sc]){s[sc]=!0,r.forEach(function(d){d!=="selectionchange"&&(mk.has(d)||jd(d,!1,s),jd(d,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[sc]||(i[sc]=!0,jd("selectionchange",!1,i))}}function jh(s,i,d,x){switch(Jp(i)){case 1:var y=jw;break;case 4:y=Fw;break;default:y=pd}d=y.bind(null,i,d,s),y=void 0,!Ke||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),x?y!==void 0?s.addEventListener(i,d,{capture:!0,passive:y}):s.addEventListener(i,d,!0):y!==void 0?s.addEventListener(i,d,{passive:y}):s.addEventListener(i,d,!1)}function Fd(s,i,d,x,y){var _=x;if((i&1)===0&&(i&2)===0&&x!==null)e:for(;;){if(x===null)return;var z=x.tag;if(z===3||z===4){var ce=x.stateNode.containerInfo;if(ce===y||ce.nodeType===8&&ce.parentNode===y)break;if(z===4)for(z=x.return;z!==null;){var xe=z.tag;if((xe===3||xe===4)&&(xe=z.stateNode.containerInfo,xe===y||xe.nodeType===8&&xe.parentNode===y))return;z=z.return}for(;ce!==null;){if(z=Bs(ce),z===null)return;if(xe=z.tag,xe===5||xe===6){x=_=z;continue e}ce=ce.parentNode}}x=x.return}mt(function(){var Ce=_,Le=Ae(d),Ve=[];e:{var Ie=Nh.get(s);if(Ie!==void 0){var at=md,ot=s;switch(s){case"keypress":if(Jl(d)===0)break e;case"keydown":case"keyup":at=Vw;break;case"focusin":ot="focus",at=yd;break;case"focusout":ot="blur",at=yd;break;case"beforeblur":case"afterblur":at=yd;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Ow;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Qw;break;case bh:case _h:case Sh:at=Mw;break;case Eh:at=qw;break;case"scroll":at=Pw;break;case"wheel":at=Jw;break;case"copy":case"cut":case"paste":at=Lw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=ah}var it=(i&4)!==0,mr=!it&&s==="scroll",ke=it?Ie!==null?Ie+"Capture":null:Ie;it=[];for(var ge=Ce,Se;ge!==null;){Se=ge;var Ge=Se.stateNode;if(Se.tag===5&&Ge!==null&&(Se=Ge,ke!==null&&(Ge=Mt(ge,ke),Ge!=null&&it.push(Mi(ge,Ge,Se)))),mr)break;ge=ge.return}0<it.length&&(Ie=new at(Ie,ot,null,d,Le),Ve.push({event:Ie,listeners:it}))}}if((i&7)===0){e:{if(Ie=s==="mouseover"||s==="pointerover",at=s==="mouseout"||s==="pointerout",Ie&&d!==me&&(ot=d.relatedTarget||d.fromElement)&&(Bs(ot)||ot[Ra]))break e;if((at||Ie)&&(Ie=Le.window===Le?Le:(Ie=Le.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,at?(ot=d.relatedTarget||d.toElement,at=Ce,ot=ot?Bs(ot):null,ot!==null&&(mr=ae(ot),ot!==mr||ot.tag!==5&&ot.tag!==6)&&(ot=null)):(at=null,ot=Ce),at!==ot)){if(it=rh,Ge="onMouseLeave",ke="onMouseEnter",ge="mouse",(s==="pointerout"||s==="pointerover")&&(it=ah,Ge="onPointerLeave",ke="onPointerEnter",ge="pointer"),mr=at==null?Ie:Ao(at),Se=ot==null?Ie:Ao(ot),Ie=new it(Ge,ge+"leave",at,d,Le),Ie.target=mr,Ie.relatedTarget=Se,Ge=null,Bs(Le)===Ce&&(it=new it(ke,ge+"enter",ot,d,Le),it.target=Se,it.relatedTarget=mr,Ge=it),mr=Ge,at&&ot)t:{for(it=at,ke=ot,ge=0,Se=it;Se;Se=Fo(Se))ge++;for(Se=0,Ge=ke;Ge;Ge=Fo(Ge))Se++;for(;0<ge-Se;)it=Fo(it),ge--;for(;0<Se-ge;)ke=Fo(ke),Se--;for(;ge--;){if(it===ke||ke!==null&&it===ke.alternate)break t;it=Fo(it),ke=Fo(ke)}it=null}else it=null;at!==null&&Fh(Ve,Ie,at,it,!1),ot!==null&&mr!==null&&Fh(Ve,mr,ot,it,!0)}}e:{if(Ie=Ce?Ao(Ce):window,at=Ie.nodeName&&Ie.nodeName.toLowerCase(),at==="select"||at==="input"&&Ie.type==="file")var ct=ok;else if(uh(Ie))if(fh)ct=uk;else{ct=lk;var pt=ik}else(at=Ie.nodeName)&&at.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(ct=ck);if(ct&&(ct=ct(s,Ce))){dh(Ve,ct,d,Le);break e}pt&&pt(s,Ie,Ce),s==="focusout"&&(pt=Ie._wrapperState)&&pt.controlled&&Ie.type==="number"&&we(Ie,"number",Ie.value)}switch(pt=Ce?Ao(Ce):window,s){case"focusin":(uh(pt)||pt.contentEditable==="true")&&(Do=pt,Ed=Ce,Oi=null);break;case"focusout":Oi=Ed=Do=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,wh(Ve,d,Le);break;case"selectionchange":if(pk)break;case"keydown":case"keyup":wh(Ve,d,Le)}var ht;if(kd)e:{switch(s){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else To?lh(s,d)&&(yt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(yt="onCompositionStart");yt&&(sh&&d.locale!=="ko"&&(To||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&To&&(ht=eh()):(is=Le,xd="value"in is?is.value:is.textContent,To=!0)),pt=oc(Ce,yt),0<pt.length&&(yt=new nh(yt,s,null,d,Le),Ve.push({event:yt,listeners:pt}),ht?yt.data=ht:(ht=ch(d),ht!==null&&(yt.data=ht)))),(ht=tk?rk(s,d):nk(s,d))&&(Ce=oc(Ce,"onBeforeInput"),0<Ce.length&&(Le=new nh("onBeforeInput","beforeinput",null,d,Le),Ve.push({event:Le,listeners:Ce}),Le.data=ht))}Dh(Ve,i)})}function Mi(s,i,d){return{instance:s,listener:i,currentTarget:d}}function oc(s,i){for(var d=i+"Capture",x=[];s!==null;){var y=s,_=y.stateNode;y.tag===5&&_!==null&&(y=_,_=Mt(s,d),_!=null&&x.unshift(Mi(s,_,y)),_=Mt(s,i),_!=null&&x.push(Mi(s,_,y))),s=s.return}return x}function Fo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Fh(s,i,d,x,y){for(var _=i._reactName,z=[];d!==null&&d!==x;){var ce=d,xe=ce.alternate,Ce=ce.stateNode;if(xe!==null&&xe===x)break;ce.tag===5&&Ce!==null&&(ce=Ce,y?(xe=Mt(d,_),xe!=null&&z.unshift(Mi(d,xe,ce))):y||(xe=Mt(d,_),xe!=null&&z.push(Mi(d,xe,ce)))),d=d.return}z.length!==0&&s.push({event:i,listeners:z})}var gk=/\r\n?/g,vk=/\u0000|\uFFFD/g;function Ph(s){return(typeof s=="string"?s:""+s).replace(gk,`
`).replace(vk,"")}function ic(s,i,d){if(i=Ph(i),Ph(s)!==i&&d)throw Error(t(425))}function lc(){}var Pd=null,Ad=null;function Od(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Rd=typeof setTimeout=="function"?setTimeout:void 0,yk=typeof clearTimeout=="function"?clearTimeout:void 0,Ah=typeof Promise=="function"?Promise:void 0,wk=typeof queueMicrotask=="function"?queueMicrotask:typeof Ah<"u"?function(s){return Ah.resolve(null).then(s).catch(kk)}:Rd;function kk(s){setTimeout(function(){throw s})}function zd(s,i){var d=i,x=0;do{var y=d.nextSibling;if(s.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(x===0){s.removeChild(y),Ci(i);return}x--}else d!=="$"&&d!=="$?"&&d!=="$!"||x++;d=y}while(d);Ci(i)}function cs(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Oh(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return s;i--}else d==="/$"&&i++}s=s.previousSibling}return null}var Po=Math.random().toString(36).slice(2),fa="__reactFiber$"+Po,Ii="__reactProps$"+Po,Ra="__reactContainer$"+Po,Md="__reactEvents$"+Po,bk="__reactListeners$"+Po,_k="__reactHandles$"+Po;function Bs(s){var i=s[fa];if(i)return i;for(var d=s.parentNode;d;){if(i=d[Ra]||d[fa]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(s=Oh(s);s!==null;){if(d=s[fa])return d;s=Oh(s)}return i}s=d,d=s.parentNode}return null}function Li(s){return s=s[fa]||s[Ra],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Ao(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function cc(s){return s[Ii]||null}var Id=[],Oo=-1;function us(s){return{current:s}}function tr(s){0>Oo||(s.current=Id[Oo],Id[Oo]=null,Oo--)}function qt(s,i){Oo++,Id[Oo]=s.current,s.current=i}var ds={},Ur=us(ds),pn=us(!1),Ws=ds;function Ro(s,i){var d=s.type.contextTypes;if(!d)return ds;var x=s.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===i)return x.__reactInternalMemoizedMaskedChildContext;var y={},_;for(_ in d)y[_]=i[_];return x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=y),y}function hn(s){return s=s.childContextTypes,s!=null}function uc(){tr(pn),tr(Ur)}function Rh(s,i,d){if(Ur.current!==ds)throw Error(t(168));qt(Ur,i),qt(pn,d)}function zh(s,i,d){var x=s.stateNode;if(i=i.childContextTypes,typeof x.getChildContext!="function")return d;x=x.getChildContext();for(var y in x)if(!(y in i))throw Error(t(108,R(s)||"Unknown",y));return re({},d,x)}function dc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ds,Ws=Ur.current,qt(Ur,s),qt(pn,pn.current),!0}function Mh(s,i,d){var x=s.stateNode;if(!x)throw Error(t(169));d?(s=zh(s,i,Ws),x.__reactInternalMemoizedMergedChildContext=s,tr(pn),tr(Ur),qt(Ur,s)):tr(pn),qt(pn,d)}var za=null,fc=!1,Ld=!1;function Ih(s){za===null?za=[s]:za.push(s)}function Sk(s){fc=!0,Ih(s)}function fs(){if(!Ld&&za!==null){Ld=!0;var s=0,i=Yt;try{var d=za;for(Yt=1;s<d.length;s++){var x=d[s];do x=x(!0);while(x!==null)}za=null,fc=!1}catch(y){throw za!==null&&(za=za.slice(s+1)),Be(Ht,fs),y}finally{Yt=i,Ld=!1}}return null}var zo=[],Mo=0,pc=null,hc=0,jn=[],Fn=0,Us=null,Ma=1,Ia="";function $s(s,i){zo[Mo++]=hc,zo[Mo++]=pc,pc=s,hc=i}function Lh(s,i,d){jn[Fn++]=Ma,jn[Fn++]=Ia,jn[Fn++]=Us,Us=s;var x=Ma;s=Ia;var y=32-xr(x)-1;x&=~(1<<y),d+=1;var _=32-xr(i)+y;if(30<_){var z=y-y%5;_=(x&(1<<z)-1).toString(32),x>>=z,y-=z,Ma=1<<32-xr(i)+y|d<<y|x,Ia=_+s}else Ma=1<<_|d<<y|x,Ia=s}function Bd(s){s.return!==null&&($s(s,1),Lh(s,1,0))}function Wd(s){for(;s===pc;)pc=zo[--Mo],zo[Mo]=null,hc=zo[--Mo],zo[Mo]=null;for(;s===Us;)Us=jn[--Fn],jn[Fn]=null,Ia=jn[--Fn],jn[Fn]=null,Ma=jn[--Fn],jn[Fn]=null}var bn=null,_n=null,nr=!1,Qn=null;function Bh(s,i){var d=Rn(5,null,null,0);d.elementType="DELETED",d.stateNode=i,d.return=s,i=s.deletions,i===null?(s.deletions=[d],s.flags|=16):i.push(d)}function Wh(s,i){switch(s.tag){case 5:var d=s.type;return i=i.nodeType!==1||d.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,bn=s,_n=cs(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,bn=s,_n=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(d=Us!==null?{id:Ma,overflow:Ia}:null,s.memoizedState={dehydrated:i,treeContext:d,retryLane:1073741824},d=Rn(18,null,null,0),d.stateNode=i,d.return=s,s.child=d,bn=s,_n=null,!0):!1;default:return!1}}function Ud(s){return(s.mode&1)!==0&&(s.flags&128)===0}function $d(s){if(nr){var i=_n;if(i){var d=i;if(!Wh(s,i)){if(Ud(s))throw Error(t(418));i=cs(d.nextSibling);var x=bn;i&&Wh(s,i)?Bh(x,d):(s.flags=s.flags&-4097|2,nr=!1,bn=s)}}else{if(Ud(s))throw Error(t(418));s.flags=s.flags&-4097|2,nr=!1,bn=s}}}function Uh(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;bn=s}function xc(s){if(s!==bn)return!1;if(!nr)return Uh(s),nr=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Od(s.type,s.memoizedProps)),i&&(i=_n)){if(Ud(s))throw $h(),Error(t(418));for(;i;)Bh(s,i),i=cs(i.nextSibling)}if(Uh(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"){if(i===0){_n=cs(s.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++}s=s.nextSibling}_n=null}}else _n=bn?cs(s.stateNode.nextSibling):null;return!0}function $h(){for(var s=_n;s;)s=cs(s.nextSibling)}function Io(){_n=bn=null,nr=!1}function Hd(s){Qn===null?Qn=[s]:Qn.push(s)}var Ek=U.ReactCurrentBatchConfig;function Bi(s,i,d){if(s=d.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var x=d.stateNode}if(!x)throw Error(t(147,s));var y=x,_=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===_?i.ref:(i=function(z){var ce=y.refs;z===null?delete ce[_]:ce[_]=z},i._stringRef=_,i)}if(typeof s!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,s))}return s}function mc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Hh(s){var i=s._init;return i(s._payload)}function Yh(s){function i(ke,ge){if(s){var Se=ke.deletions;Se===null?(ke.deletions=[ge],ke.flags|=16):Se.push(ge)}}function d(ke,ge){if(!s)return null;for(;ge!==null;)i(ke,ge),ge=ge.sibling;return null}function x(ke,ge){for(ke=new Map;ge!==null;)ge.key!==null?ke.set(ge.key,ge):ke.set(ge.index,ge),ge=ge.sibling;return ke}function y(ke,ge){return ke=ws(ke,ge),ke.index=0,ke.sibling=null,ke}function _(ke,ge,Se){return ke.index=Se,s?(Se=ke.alternate,Se!==null?(Se=Se.index,Se<ge?(ke.flags|=2,ge):Se):(ke.flags|=2,ge)):(ke.flags|=1048576,ge)}function z(ke){return s&&ke.alternate===null&&(ke.flags|=2),ke}function ce(ke,ge,Se,Ge){return ge===null||ge.tag!==6?(ge=R0(Se,ke.mode,Ge),ge.return=ke,ge):(ge=y(ge,Se),ge.return=ke,ge)}function xe(ke,ge,Se,Ge){var ct=Se.type;return ct===D?Le(ke,ge,Se.props.children,Ge,Se.key):ge!==null&&(ge.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===ie&&Hh(ct)===ge.type)?(Ge=y(ge,Se.props),Ge.ref=Bi(ke,ge,Se),Ge.return=ke,Ge):(Ge=Bc(Se.type,Se.key,Se.props,null,ke.mode,Ge),Ge.ref=Bi(ke,ge,Se),Ge.return=ke,Ge)}function Ce(ke,ge,Se,Ge){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Se.containerInfo||ge.stateNode.implementation!==Se.implementation?(ge=z0(Se,ke.mode,Ge),ge.return=ke,ge):(ge=y(ge,Se.children||[]),ge.return=ke,ge)}function Le(ke,ge,Se,Ge,ct){return ge===null||ge.tag!==7?(ge=qs(Se,ke.mode,Ge,ct),ge.return=ke,ge):(ge=y(ge,Se),ge.return=ke,ge)}function Ve(ke,ge,Se){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=R0(""+ge,ke.mode,Se),ge.return=ke,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case te:return Se=Bc(ge.type,ge.key,ge.props,null,ke.mode,Se),Se.ref=Bi(ke,null,ge),Se.return=ke,Se;case Q:return ge=z0(ge,ke.mode,Se),ge.return=ke,ge;case ie:var Ge=ge._init;return Ve(ke,Ge(ge._payload),Se)}if(ve(ge)||O(ge))return ge=qs(ge,ke.mode,Se,null),ge.return=ke,ge;mc(ke,ge)}return null}function Ie(ke,ge,Se,Ge){var ct=ge!==null?ge.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return ct!==null?null:ce(ke,ge,""+Se,Ge);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case te:return Se.key===ct?xe(ke,ge,Se,Ge):null;case Q:return Se.key===ct?Ce(ke,ge,Se,Ge):null;case ie:return ct=Se._init,Ie(ke,ge,ct(Se._payload),Ge)}if(ve(Se)||O(Se))return ct!==null?null:Le(ke,ge,Se,Ge,null);mc(ke,Se)}return null}function at(ke,ge,Se,Ge,ct){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number")return ke=ke.get(Se)||null,ce(ge,ke,""+Ge,ct);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case te:return ke=ke.get(Ge.key===null?Se:Ge.key)||null,xe(ge,ke,Ge,ct);case Q:return ke=ke.get(Ge.key===null?Se:Ge.key)||null,Ce(ge,ke,Ge,ct);case ie:var pt=Ge._init;return at(ke,ge,Se,pt(Ge._payload),ct)}if(ve(Ge)||O(Ge))return ke=ke.get(Se)||null,Le(ge,ke,Ge,ct,null);mc(ge,Ge)}return null}function ot(ke,ge,Se,Ge){for(var ct=null,pt=null,ht=ge,yt=ge=0,Pr=null;ht!==null&&yt<Se.length;yt++){ht.index>yt?(Pr=ht,ht=null):Pr=ht.sibling;var zt=Ie(ke,ht,Se[yt],Ge);if(zt===null){ht===null&&(ht=Pr);break}s&&ht&&zt.alternate===null&&i(ke,ht),ge=_(zt,ge,yt),pt===null?ct=zt:pt.sibling=zt,pt=zt,ht=Pr}if(yt===Se.length)return d(ke,ht),nr&&$s(ke,yt),ct;if(ht===null){for(;yt<Se.length;yt++)ht=Ve(ke,Se[yt],Ge),ht!==null&&(ge=_(ht,ge,yt),pt===null?ct=ht:pt.sibling=ht,pt=ht);return nr&&$s(ke,yt),ct}for(ht=x(ke,ht);yt<Se.length;yt++)Pr=at(ht,ke,yt,Se[yt],Ge),Pr!==null&&(s&&Pr.alternate!==null&&ht.delete(Pr.key===null?yt:Pr.key),ge=_(Pr,ge,yt),pt===null?ct=Pr:pt.sibling=Pr,pt=Pr);return s&&ht.forEach(function(ks){return i(ke,ks)}),nr&&$s(ke,yt),ct}function it(ke,ge,Se,Ge){var ct=O(Se);if(typeof ct!="function")throw Error(t(150));if(Se=ct.call(Se),Se==null)throw Error(t(151));for(var pt=ct=null,ht=ge,yt=ge=0,Pr=null,zt=Se.next();ht!==null&&!zt.done;yt++,zt=Se.next()){ht.index>yt?(Pr=ht,ht=null):Pr=ht.sibling;var ks=Ie(ke,ht,zt.value,Ge);if(ks===null){ht===null&&(ht=Pr);break}s&&ht&&ks.alternate===null&&i(ke,ht),ge=_(ks,ge,yt),pt===null?ct=ks:pt.sibling=ks,pt=ks,ht=Pr}if(zt.done)return d(ke,ht),nr&&$s(ke,yt),ct;if(ht===null){for(;!zt.done;yt++,zt=Se.next())zt=Ve(ke,zt.value,Ge),zt!==null&&(ge=_(zt,ge,yt),pt===null?ct=zt:pt.sibling=zt,pt=zt);return nr&&$s(ke,yt),ct}for(ht=x(ke,ht);!zt.done;yt++,zt=Se.next())zt=at(ht,ke,yt,zt.value,Ge),zt!==null&&(s&&zt.alternate!==null&&ht.delete(zt.key===null?yt:zt.key),ge=_(zt,ge,yt),pt===null?ct=zt:pt.sibling=zt,pt=zt);return s&&ht.forEach(function(ab){return i(ke,ab)}),nr&&$s(ke,yt),ct}function mr(ke,ge,Se,Ge){if(typeof Se=="object"&&Se!==null&&Se.type===D&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case te:e:{for(var ct=Se.key,pt=ge;pt!==null;){if(pt.key===ct){if(ct=Se.type,ct===D){if(pt.tag===7){d(ke,pt.sibling),ge=y(pt,Se.props.children),ge.return=ke,ke=ge;break e}}else if(pt.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===ie&&Hh(ct)===pt.type){d(ke,pt.sibling),ge=y(pt,Se.props),ge.ref=Bi(ke,pt,Se),ge.return=ke,ke=ge;break e}d(ke,pt);break}else i(ke,pt);pt=pt.sibling}Se.type===D?(ge=qs(Se.props.children,ke.mode,Ge,Se.key),ge.return=ke,ke=ge):(Ge=Bc(Se.type,Se.key,Se.props,null,ke.mode,Ge),Ge.ref=Bi(ke,ge,Se),Ge.return=ke,ke=Ge)}return z(ke);case Q:e:{for(pt=Se.key;ge!==null;){if(ge.key===pt)if(ge.tag===4&&ge.stateNode.containerInfo===Se.containerInfo&&ge.stateNode.implementation===Se.implementation){d(ke,ge.sibling),ge=y(ge,Se.children||[]),ge.return=ke,ke=ge;break e}else{d(ke,ge);break}else i(ke,ge);ge=ge.sibling}ge=z0(Se,ke.mode,Ge),ge.return=ke,ke=ge}return z(ke);case ie:return pt=Se._init,mr(ke,ge,pt(Se._payload),Ge)}if(ve(Se))return ot(ke,ge,Se,Ge);if(O(Se))return it(ke,ge,Se,Ge);mc(ke,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,ge!==null&&ge.tag===6?(d(ke,ge.sibling),ge=y(ge,Se),ge.return=ke,ke=ge):(d(ke,ge),ge=R0(Se,ke.mode,Ge),ge.return=ke,ke=ge),z(ke)):d(ke,ge)}return mr}var Lo=Yh(!0),Vh=Yh(!1),gc=us(null),vc=null,Bo=null,Yd=null;function Vd(){Yd=Bo=vc=null}function Kd(s){var i=gc.current;tr(gc),s._currentValue=i}function Gd(s,i,d){for(;s!==null;){var x=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,x!==null&&(x.childLanes|=i)):x!==null&&(x.childLanes&i)!==i&&(x.childLanes|=i),s===d)break;s=s.return}}function Wo(s,i){vc=s,Yd=Bo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(xn=!0),s.firstContext=null)}function Pn(s){var i=s._currentValue;if(Yd!==s)if(s={context:s,memoizedValue:i,next:null},Bo===null){if(vc===null)throw Error(t(308));Bo=s,vc.dependencies={lanes:0,firstContext:s}}else Bo=Bo.next=s;return i}var Hs=null;function Qd(s){Hs===null?Hs=[s]:Hs.push(s)}function Kh(s,i,d,x){var y=i.interleaved;return y===null?(d.next=d,Qd(i)):(d.next=y.next,y.next=d),i.interleaved=d,La(s,x)}function La(s,i){s.lanes|=i;var d=s.alternate;for(d!==null&&(d.lanes|=i),d=s,s=s.return;s!==null;)s.childLanes|=i,d=s.alternate,d!==null&&(d.childLanes|=i),d=s,s=s.return;return d.tag===3?d.stateNode:null}var ps=!1;function Xd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Ba(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function hs(s,i,d){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Ft&2)!==0){var y=x.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),x.pending=i,La(s,d)}return y=x.interleaved,y===null?(i.next=i,Qd(x)):(i.next=y.next,y.next=i),x.interleaved=i,La(s,d)}function yc(s,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194240)!==0)){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,ud(s,d)}}function Qh(s,i){var d=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,d===x)){var y=null,_=null;if(d=d.firstBaseUpdate,d!==null){do{var z={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};_===null?y=_=z:_=_.next=z,d=d.next}while(d!==null);_===null?y=_=i:_=_.next=i}else y=_=i;d={baseState:x.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:x.shared,effects:x.effects},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=i:s.next=i,d.lastBaseUpdate=i}function wc(s,i,d,x){var y=s.updateQueue;ps=!1;var _=y.firstBaseUpdate,z=y.lastBaseUpdate,ce=y.shared.pending;if(ce!==null){y.shared.pending=null;var xe=ce,Ce=xe.next;xe.next=null,z===null?_=Ce:z.next=Ce,z=xe;var Le=s.alternate;Le!==null&&(Le=Le.updateQueue,ce=Le.lastBaseUpdate,ce!==z&&(ce===null?Le.firstBaseUpdate=Ce:ce.next=Ce,Le.lastBaseUpdate=xe))}if(_!==null){var Ve=y.baseState;z=0,Le=Ce=xe=null,ce=_;do{var Ie=ce.lane,at=ce.eventTime;if((x&Ie)===Ie){Le!==null&&(Le=Le.next={eventTime:at,lane:0,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null});e:{var ot=s,it=ce;switch(Ie=i,at=d,it.tag){case 1:if(ot=it.payload,typeof ot=="function"){Ve=ot.call(at,Ve,Ie);break e}Ve=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=it.payload,Ie=typeof ot=="function"?ot.call(at,Ve,Ie):ot,Ie==null)break e;Ve=re({},Ve,Ie);break e;case 2:ps=!0}}ce.callback!==null&&ce.lane!==0&&(s.flags|=64,Ie=y.effects,Ie===null?y.effects=[ce]:Ie.push(ce))}else at={eventTime:at,lane:Ie,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},Le===null?(Ce=Le=at,xe=Ve):Le=Le.next=at,z|=Ie;if(ce=ce.next,ce===null){if(ce=y.shared.pending,ce===null)break;Ie=ce,ce=Ie.next,Ie.next=null,y.lastBaseUpdate=Ie,y.shared.pending=null}}while(!0);if(Le===null&&(xe=Ve),y.baseState=xe,y.firstBaseUpdate=Ce,y.lastBaseUpdate=Le,i=y.shared.interleaved,i!==null){y=i;do z|=y.lane,y=y.next;while(y!==i)}else _===null&&(y.shared.lanes=0);Ks|=z,s.lanes=z,s.memoizedState=Ve}}function Xh(s,i,d){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var x=s[i],y=x.callback;if(y!==null){if(x.callback=null,x=d,typeof y!="function")throw Error(t(191,y));y.call(x)}}}var Wi={},pa=us(Wi),Ui=us(Wi),$i=us(Wi);function Ys(s){if(s===Wi)throw Error(t(174));return s}function qd(s,i){switch(qt($i,i),qt(Ui,s),qt(pa,Wi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:cr(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=cr(i,s)}tr(pa),qt(pa,i)}function Uo(){tr(pa),tr(Ui),tr($i)}function qh(s){Ys($i.current);var i=Ys(pa.current),d=cr(i,s.type);i!==d&&(qt(Ui,s),qt(pa,d))}function Zd(s){Ui.current===s&&(tr(pa),tr(Ui))}var or=us(0);function kc(s){for(var i=s;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Jd=[];function e0(){for(var s=0;s<Jd.length;s++)Jd[s]._workInProgressVersionPrimary=null;Jd.length=0}var bc=U.ReactCurrentDispatcher,t0=U.ReactCurrentBatchConfig,Vs=0,ir=null,Sr=null,jr=null,_c=!1,Hi=!1,Yi=0,Nk=0;function $r(){throw Error(t(321))}function r0(s,i){if(i===null)return!1;for(var d=0;d<i.length&&d<s.length;d++)if(!Gn(s[d],i[d]))return!1;return!0}function n0(s,i,d,x,y,_){if(Vs=_,ir=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,bc.current=s===null||s.memoizedState===null?jk:Fk,s=d(x,y),Hi){_=0;do{if(Hi=!1,Yi=0,25<=_)throw Error(t(301));_+=1,jr=Sr=null,i.updateQueue=null,bc.current=Pk,s=d(x,y)}while(Hi)}if(bc.current=Nc,i=Sr!==null&&Sr.next!==null,Vs=0,jr=Sr=ir=null,_c=!1,i)throw Error(t(300));return s}function a0(){var s=Yi!==0;return Yi=0,s}function ha(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?ir.memoizedState=jr=s:jr=jr.next=s,jr}function An(){if(Sr===null){var s=ir.alternate;s=s!==null?s.memoizedState:null}else s=Sr.next;var i=jr===null?ir.memoizedState:jr.next;if(i!==null)jr=i,Sr=s;else{if(s===null)throw Error(t(310));Sr=s,s={memoizedState:Sr.memoizedState,baseState:Sr.baseState,baseQueue:Sr.baseQueue,queue:Sr.queue,next:null},jr===null?ir.memoizedState=jr=s:jr=jr.next=s}return jr}function Vi(s,i){return typeof i=="function"?i(s):i}function s0(s){var i=An(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=Sr,y=x.baseQueue,_=d.pending;if(_!==null){if(y!==null){var z=y.next;y.next=_.next,_.next=z}x.baseQueue=y=_,d.pending=null}if(y!==null){_=y.next,x=x.baseState;var ce=z=null,xe=null,Ce=_;do{var Le=Ce.lane;if((Vs&Le)===Le)xe!==null&&(xe=xe.next={lane:0,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null}),x=Ce.hasEagerState?Ce.eagerState:s(x,Ce.action);else{var Ve={lane:Le,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null};xe===null?(ce=xe=Ve,z=x):xe=xe.next=Ve,ir.lanes|=Le,Ks|=Le}Ce=Ce.next}while(Ce!==null&&Ce!==_);xe===null?z=x:xe.next=ce,Gn(x,i.memoizedState)||(xn=!0),i.memoizedState=x,i.baseState=z,i.baseQueue=xe,d.lastRenderedState=x}if(s=d.interleaved,s!==null){y=s;do _=y.lane,ir.lanes|=_,Ks|=_,y=y.next;while(y!==s)}else y===null&&(d.lanes=0);return[i.memoizedState,d.dispatch]}function o0(s){var i=An(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=d.dispatch,y=d.pending,_=i.memoizedState;if(y!==null){d.pending=null;var z=y=y.next;do _=s(_,z.action),z=z.next;while(z!==y);Gn(_,i.memoizedState)||(xn=!0),i.memoizedState=_,i.baseQueue===null&&(i.baseState=_),d.lastRenderedState=_}return[_,x]}function Zh(){}function Jh(s,i){var d=ir,x=An(),y=i(),_=!Gn(x.memoizedState,y);if(_&&(x.memoizedState=y,xn=!0),x=x.queue,i0(rx.bind(null,d,x,s),[s]),x.getSnapshot!==i||_||jr!==null&&jr.memoizedState.tag&1){if(d.flags|=2048,Ki(9,tx.bind(null,d,x,y,i),void 0,null),Fr===null)throw Error(t(349));(Vs&30)!==0||ex(d,i,y)}return y}function ex(s,i,d){s.flags|=16384,s={getSnapshot:i,value:d},i=ir.updateQueue,i===null?(i={lastEffect:null,stores:null},ir.updateQueue=i,i.stores=[s]):(d=i.stores,d===null?i.stores=[s]:d.push(s))}function tx(s,i,d,x){i.value=d,i.getSnapshot=x,nx(i)&&ax(s)}function rx(s,i,d){return d(function(){nx(i)&&ax(s)})}function nx(s){var i=s.getSnapshot;s=s.value;try{var d=i();return!Gn(s,d)}catch{return!0}}function ax(s){var i=La(s,1);i!==null&&Jn(i,s,1,-1)}function sx(s){var i=ha();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:s},i.queue=s,s=s.dispatch=Dk.bind(null,ir,s),[i.memoizedState,s]}function Ki(s,i,d,x){return s={tag:s,create:i,destroy:d,deps:x,next:null},i=ir.updateQueue,i===null?(i={lastEffect:null,stores:null},ir.updateQueue=i,i.lastEffect=s.next=s):(d=i.lastEffect,d===null?i.lastEffect=s.next=s:(x=d.next,d.next=s,s.next=x,i.lastEffect=s)),s}function ox(){return An().memoizedState}function Sc(s,i,d,x){var y=ha();ir.flags|=s,y.memoizedState=Ki(1|i,d,void 0,x===void 0?null:x)}function Ec(s,i,d,x){var y=An();x=x===void 0?null:x;var _=void 0;if(Sr!==null){var z=Sr.memoizedState;if(_=z.destroy,x!==null&&r0(x,z.deps)){y.memoizedState=Ki(i,d,_,x);return}}ir.flags|=s,y.memoizedState=Ki(1|i,d,_,x)}function ix(s,i){return Sc(8390656,8,s,i)}function i0(s,i){return Ec(2048,8,s,i)}function lx(s,i){return Ec(4,2,s,i)}function cx(s,i){return Ec(4,4,s,i)}function ux(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function dx(s,i,d){return d=d!=null?d.concat([s]):null,Ec(4,4,ux.bind(null,i,s),d)}function l0(){}function fx(s,i){var d=An();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&r0(i,x[1])?x[0]:(d.memoizedState=[s,i],s)}function px(s,i){var d=An();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&r0(i,x[1])?x[0]:(s=s(),d.memoizedState=[s,i],s)}function hx(s,i,d){return(Vs&21)===0?(s.baseState&&(s.baseState=!1,xn=!0),s.memoizedState=d):(Gn(d,i)||(d=Hp(),ir.lanes|=d,Ks|=d,s.baseState=!0),i)}function Ck(s,i){var d=Yt;Yt=d!==0&&4>d?d:4,s(!0);var x=t0.transition;t0.transition={};try{s(!1),i()}finally{Yt=d,t0.transition=x}}function xx(){return An().memoizedState}function Tk(s,i,d){var x=vs(s);if(d={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null},mx(s))gx(i,d);else if(d=Kh(s,i,d,x),d!==null){var y=rn();Jn(d,s,x,y),vx(d,i,x)}}function Dk(s,i,d){var x=vs(s),y={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null};if(mx(s))gx(i,y);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=i.lastRenderedReducer,_!==null))try{var z=i.lastRenderedState,ce=_(z,d);if(y.hasEagerState=!0,y.eagerState=ce,Gn(ce,z)){var xe=i.interleaved;xe===null?(y.next=y,Qd(i)):(y.next=xe.next,xe.next=y),i.interleaved=y;return}}catch{}finally{}d=Kh(s,i,y,x),d!==null&&(y=rn(),Jn(d,s,x,y),vx(d,i,x))}}function mx(s){var i=s.alternate;return s===ir||i!==null&&i===ir}function gx(s,i){Hi=_c=!0;var d=s.pending;d===null?i.next=i:(i.next=d.next,d.next=i),s.pending=i}function vx(s,i,d){if((d&4194240)!==0){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,ud(s,d)}}var Nc={readContext:Pn,useCallback:$r,useContext:$r,useEffect:$r,useImperativeHandle:$r,useInsertionEffect:$r,useLayoutEffect:$r,useMemo:$r,useReducer:$r,useRef:$r,useState:$r,useDebugValue:$r,useDeferredValue:$r,useTransition:$r,useMutableSource:$r,useSyncExternalStore:$r,useId:$r,unstable_isNewReconciler:!1},jk={readContext:Pn,useCallback:function(s,i){return ha().memoizedState=[s,i===void 0?null:i],s},useContext:Pn,useEffect:ix,useImperativeHandle:function(s,i,d){return d=d!=null?d.concat([s]):null,Sc(4194308,4,ux.bind(null,i,s),d)},useLayoutEffect:function(s,i){return Sc(4194308,4,s,i)},useInsertionEffect:function(s,i){return Sc(4,2,s,i)},useMemo:function(s,i){var d=ha();return i=i===void 0?null:i,s=s(),d.memoizedState=[s,i],s},useReducer:function(s,i,d){var x=ha();return i=d!==void 0?d(i):i,x.memoizedState=x.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},x.queue=s,s=s.dispatch=Tk.bind(null,ir,s),[x.memoizedState,s]},useRef:function(s){var i=ha();return s={current:s},i.memoizedState=s},useState:sx,useDebugValue:l0,useDeferredValue:function(s){return ha().memoizedState=s},useTransition:function(){var s=sx(!1),i=s[0];return s=Ck.bind(null,s[1]),ha().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,d){var x=ir,y=ha();if(nr){if(d===void 0)throw Error(t(407));d=d()}else{if(d=i(),Fr===null)throw Error(t(349));(Vs&30)!==0||ex(x,i,d)}y.memoizedState=d;var _={value:d,getSnapshot:i};return y.queue=_,ix(rx.bind(null,x,_,s),[s]),x.flags|=2048,Ki(9,tx.bind(null,x,_,d,i),void 0,null),d},useId:function(){var s=ha(),i=Fr.identifierPrefix;if(nr){var d=Ia,x=Ma;d=(x&~(1<<32-xr(x)-1)).toString(32)+d,i=":"+i+"R"+d,d=Yi++,0<d&&(i+="H"+d.toString(32)),i+=":"}else d=Nk++,i=":"+i+"r"+d.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Fk={readContext:Pn,useCallback:fx,useContext:Pn,useEffect:i0,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:px,useReducer:s0,useRef:ox,useState:function(){return s0(Vi)},useDebugValue:l0,useDeferredValue:function(s){var i=An();return hx(i,Sr.memoizedState,s)},useTransition:function(){var s=s0(Vi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:xx,unstable_isNewReconciler:!1},Pk={readContext:Pn,useCallback:fx,useContext:Pn,useEffect:i0,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:px,useReducer:o0,useRef:ox,useState:function(){return o0(Vi)},useDebugValue:l0,useDeferredValue:function(s){var i=An();return Sr===null?i.memoizedState=s:hx(i,Sr.memoizedState,s)},useTransition:function(){var s=o0(Vi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:xx,unstable_isNewReconciler:!1};function Xn(s,i){if(s&&s.defaultProps){i=re({},i),s=s.defaultProps;for(var d in s)i[d]===void 0&&(i[d]=s[d]);return i}return i}function c0(s,i,d,x){i=s.memoizedState,d=d(x,i),d=d==null?i:re({},i,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var Cc={isMounted:function(s){return(s=s._reactInternals)?ae(s)===s:!1},enqueueSetState:function(s,i,d){s=s._reactInternals;var x=rn(),y=vs(s),_=Ba(x,y);_.payload=i,d!=null&&(_.callback=d),i=hs(s,_,y),i!==null&&(Jn(i,s,y,x),yc(i,s,y))},enqueueReplaceState:function(s,i,d){s=s._reactInternals;var x=rn(),y=vs(s),_=Ba(x,y);_.tag=1,_.payload=i,d!=null&&(_.callback=d),i=hs(s,_,y),i!==null&&(Jn(i,s,y,x),yc(i,s,y))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var d=rn(),x=vs(s),y=Ba(d,x);y.tag=2,i!=null&&(y.callback=i),i=hs(s,y,x),i!==null&&(Jn(i,s,x,d),yc(i,s,x))}};function yx(s,i,d,x,y,_,z){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,_,z):i.prototype&&i.prototype.isPureReactComponent?!Ai(d,x)||!Ai(y,_):!0}function wx(s,i,d){var x=!1,y=ds,_=i.contextType;return typeof _=="object"&&_!==null?_=Pn(_):(y=hn(i)?Ws:Ur.current,x=i.contextTypes,_=(x=x!=null)?Ro(s,y):ds),i=new i(d,_),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Cc,s.stateNode=i,i._reactInternals=s,x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=y,s.__reactInternalMemoizedMaskedChildContext=_),i}function kx(s,i,d,x){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,x),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,x),i.state!==s&&Cc.enqueueReplaceState(i,i.state,null)}function u0(s,i,d,x){var y=s.stateNode;y.props=d,y.state=s.memoizedState,y.refs={},Xd(s);var _=i.contextType;typeof _=="object"&&_!==null?y.context=Pn(_):(_=hn(i)?Ws:Ur.current,y.context=Ro(s,_)),y.state=s.memoizedState,_=i.getDerivedStateFromProps,typeof _=="function"&&(c0(s,i,_,d),y.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Cc.enqueueReplaceState(y,y.state,null),wc(s,d,y,x),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308)}function $o(s,i){try{var d="",x=i;do d+=T(x),x=x.return;while(x);var y=d}catch(_){y=`
Error generating stack: `+_.message+`
`+_.stack}return{value:s,source:i,stack:y,digest:null}}function d0(s,i,d){return{value:s,source:null,stack:d??null,digest:i??null}}function f0(s,i){try{console.error(i.value)}catch(d){setTimeout(function(){throw d})}}var Ak=typeof WeakMap=="function"?WeakMap:Map;function bx(s,i,d){d=Ba(-1,d),d.tag=3,d.payload={element:null};var x=i.value;return d.callback=function(){Oc||(Oc=!0,C0=x),f0(s,i)},d}function _x(s,i,d){d=Ba(-1,d),d.tag=3;var x=s.type.getDerivedStateFromError;if(typeof x=="function"){var y=i.value;d.payload=function(){return x(y)},d.callback=function(){f0(s,i)}}var _=s.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(d.callback=function(){f0(s,i),typeof x!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var z=i.stack;this.componentDidCatch(i.value,{componentStack:z!==null?z:""})}),d}function Sx(s,i,d){var x=s.pingCache;if(x===null){x=s.pingCache=new Ak;var y=new Set;x.set(i,y)}else y=x.get(i),y===void 0&&(y=new Set,x.set(i,y));y.has(d)||(y.add(d),s=Kk.bind(null,s,i,d),i.then(s,s))}function Ex(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Nx(s,i,d,x,y){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(i=Ba(-1,1),i.tag=2,hs(d,i,1))),d.lanes|=1),s):(s.flags|=65536,s.lanes=y,s)}var Ok=U.ReactCurrentOwner,xn=!1;function tn(s,i,d,x){i.child=s===null?Vh(i,null,d,x):Lo(i,s.child,d,x)}function Cx(s,i,d,x,y){d=d.render;var _=i.ref;return Wo(i,y),x=n0(s,i,d,x,_,y),d=a0(),s!==null&&!xn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Wa(s,i,y)):(nr&&d&&Bd(i),i.flags|=1,tn(s,i,x,y),i.child)}function Tx(s,i,d,x,y){if(s===null){var _=d.type;return typeof _=="function"&&!O0(_)&&_.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(i.tag=15,i.type=_,Dx(s,i,_,x,y)):(s=Bc(d.type,null,x,i,i.mode,y),s.ref=i.ref,s.return=i,i.child=s)}if(_=s.child,(s.lanes&y)===0){var z=_.memoizedProps;if(d=d.compare,d=d!==null?d:Ai,d(z,x)&&s.ref===i.ref)return Wa(s,i,y)}return i.flags|=1,s=ws(_,x),s.ref=i.ref,s.return=i,i.child=s}function Dx(s,i,d,x,y){if(s!==null){var _=s.memoizedProps;if(Ai(_,x)&&s.ref===i.ref)if(xn=!1,i.pendingProps=x=_,(s.lanes&y)!==0)(s.flags&131072)!==0&&(xn=!0);else return i.lanes=s.lanes,Wa(s,i,y)}return p0(s,i,d,x,y)}function jx(s,i,d){var x=i.pendingProps,y=x.children,_=s!==null?s.memoizedState:null;if(x.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(Yo,Sn),Sn|=d;else{if((d&1073741824)===0)return s=_!==null?_.baseLanes|d:d,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,qt(Yo,Sn),Sn|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=_!==null?_.baseLanes:d,qt(Yo,Sn),Sn|=x}else _!==null?(x=_.baseLanes|d,i.memoizedState=null):x=d,qt(Yo,Sn),Sn|=x;return tn(s,i,y,d),i.child}function Fx(s,i){var d=i.ref;(s===null&&d!==null||s!==null&&s.ref!==d)&&(i.flags|=512,i.flags|=2097152)}function p0(s,i,d,x,y){var _=hn(d)?Ws:Ur.current;return _=Ro(i,_),Wo(i,y),d=n0(s,i,d,x,_,y),x=a0(),s!==null&&!xn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Wa(s,i,y)):(nr&&x&&Bd(i),i.flags|=1,tn(s,i,d,y),i.child)}function Px(s,i,d,x,y){if(hn(d)){var _=!0;dc(i)}else _=!1;if(Wo(i,y),i.stateNode===null)Dc(s,i),wx(i,d,x),u0(i,d,x,y),x=!0;else if(s===null){var z=i.stateNode,ce=i.memoizedProps;z.props=ce;var xe=z.context,Ce=d.contextType;typeof Ce=="object"&&Ce!==null?Ce=Pn(Ce):(Ce=hn(d)?Ws:Ur.current,Ce=Ro(i,Ce));var Le=d.getDerivedStateFromProps,Ve=typeof Le=="function"||typeof z.getSnapshotBeforeUpdate=="function";Ve||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ce!==x||xe!==Ce)&&kx(i,z,x,Ce),ps=!1;var Ie=i.memoizedState;z.state=Ie,wc(i,x,z,y),xe=i.memoizedState,ce!==x||Ie!==xe||pn.current||ps?(typeof Le=="function"&&(c0(i,d,Le,x),xe=i.memoizedState),(ce=ps||yx(i,d,ce,x,Ie,xe,Ce))?(Ve||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(i.flags|=4194308)):(typeof z.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=x,i.memoizedState=xe),z.props=x,z.state=xe,z.context=Ce,x=ce):(typeof z.componentDidMount=="function"&&(i.flags|=4194308),x=!1)}else{z=i.stateNode,Gh(s,i),ce=i.memoizedProps,Ce=i.type===i.elementType?ce:Xn(i.type,ce),z.props=Ce,Ve=i.pendingProps,Ie=z.context,xe=d.contextType,typeof xe=="object"&&xe!==null?xe=Pn(xe):(xe=hn(d)?Ws:Ur.current,xe=Ro(i,xe));var at=d.getDerivedStateFromProps;(Le=typeof at=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ce!==Ve||Ie!==xe)&&kx(i,z,x,xe),ps=!1,Ie=i.memoizedState,z.state=Ie,wc(i,x,z,y);var ot=i.memoizedState;ce!==Ve||Ie!==ot||pn.current||ps?(typeof at=="function"&&(c0(i,d,at,x),ot=i.memoizedState),(Ce=ps||yx(i,d,Ce,x,Ie,ot,xe)||!1)?(Le||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(x,ot,xe),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(x,ot,xe)),typeof z.componentDidUpdate=="function"&&(i.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof z.componentDidUpdate!="function"||ce===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ce===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=1024),i.memoizedProps=x,i.memoizedState=ot),z.props=x,z.state=ot,z.context=xe,x=Ce):(typeof z.componentDidUpdate!="function"||ce===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ce===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=1024),x=!1)}return h0(s,i,d,x,_,y)}function h0(s,i,d,x,y,_){Fx(s,i);var z=(i.flags&128)!==0;if(!x&&!z)return y&&Mh(i,d,!1),Wa(s,i,_);x=i.stateNode,Ok.current=i;var ce=z&&typeof d.getDerivedStateFromError!="function"?null:x.render();return i.flags|=1,s!==null&&z?(i.child=Lo(i,s.child,null,_),i.child=Lo(i,null,ce,_)):tn(s,i,ce,_),i.memoizedState=x.state,y&&Mh(i,d,!0),i.child}function Ax(s){var i=s.stateNode;i.pendingContext?Rh(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Rh(s,i.context,!1),qd(s,i.containerInfo)}function Ox(s,i,d,x,y){return Io(),Hd(y),i.flags|=256,tn(s,i,d,x),i.child}var x0={dehydrated:null,treeContext:null,retryLane:0};function m0(s){return{baseLanes:s,cachePool:null,transitions:null}}function Rx(s,i,d){var x=i.pendingProps,y=or.current,_=!1,z=(i.flags&128)!==0,ce;if((ce=z)||(ce=s!==null&&s.memoizedState===null?!1:(y&2)!==0),ce?(_=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(y|=1),qt(or,y&1),s===null)return $d(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(z=x.children,s=x.fallback,_?(x=i.mode,_=i.child,z={mode:"hidden",children:z},(x&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=z):_=Wc(z,x,0,null),s=qs(s,x,d,null),_.return=i,s.return=i,_.sibling=s,i.child=_,i.child.memoizedState=m0(d),i.memoizedState=x0,s):g0(i,z));if(y=s.memoizedState,y!==null&&(ce=y.dehydrated,ce!==null))return Rk(s,i,z,x,ce,y,d);if(_){_=x.fallback,z=i.mode,y=s.child,ce=y.sibling;var xe={mode:"hidden",children:x.children};return(z&1)===0&&i.child!==y?(x=i.child,x.childLanes=0,x.pendingProps=xe,i.deletions=null):(x=ws(y,xe),x.subtreeFlags=y.subtreeFlags&14680064),ce!==null?_=ws(ce,_):(_=qs(_,z,d,null),_.flags|=2),_.return=i,x.return=i,x.sibling=_,i.child=x,x=_,_=i.child,z=s.child.memoizedState,z=z===null?m0(d):{baseLanes:z.baseLanes|d,cachePool:null,transitions:z.transitions},_.memoizedState=z,_.childLanes=s.childLanes&~d,i.memoizedState=x0,x}return _=s.child,s=_.sibling,x=ws(_,{mode:"visible",children:x.children}),(i.mode&1)===0&&(x.lanes=d),x.return=i,x.sibling=null,s!==null&&(d=i.deletions,d===null?(i.deletions=[s],i.flags|=16):d.push(s)),i.child=x,i.memoizedState=null,x}function g0(s,i){return i=Wc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Tc(s,i,d,x){return x!==null&&Hd(x),Lo(i,s.child,null,d),s=g0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Rk(s,i,d,x,y,_,z){if(d)return i.flags&256?(i.flags&=-257,x=d0(Error(t(422))),Tc(s,i,z,x)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(_=x.fallback,y=i.mode,x=Wc({mode:"visible",children:x.children},y,0,null),_=qs(_,y,z,null),_.flags|=2,x.return=i,_.return=i,x.sibling=_,i.child=x,(i.mode&1)!==0&&Lo(i,s.child,null,z),i.child.memoizedState=m0(z),i.memoizedState=x0,_);if((i.mode&1)===0)return Tc(s,i,z,null);if(y.data==="$!"){if(x=y.nextSibling&&y.nextSibling.dataset,x)var ce=x.dgst;return x=ce,_=Error(t(419)),x=d0(_,x,void 0),Tc(s,i,z,x)}if(ce=(z&s.childLanes)!==0,xn||ce){if(x=Fr,x!==null){switch(z&-z){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(x.suspendedLanes|z))!==0?0:y,y!==0&&y!==_.retryLane&&(_.retryLane=y,La(s,y),Jn(x,s,y,-1))}return A0(),x=d0(Error(t(421))),Tc(s,i,z,x)}return y.data==="$?"?(i.flags|=128,i.child=s.child,i=Gk.bind(null,s),y._reactRetry=i,null):(s=_.treeContext,_n=cs(y.nextSibling),bn=i,nr=!0,Qn=null,s!==null&&(jn[Fn++]=Ma,jn[Fn++]=Ia,jn[Fn++]=Us,Ma=s.id,Ia=s.overflow,Us=i),i=g0(i,x.children),i.flags|=4096,i)}function zx(s,i,d){s.lanes|=i;var x=s.alternate;x!==null&&(x.lanes|=i),Gd(s.return,i,d)}function v0(s,i,d,x,y){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:x,tail:d,tailMode:y}:(_.isBackwards=i,_.rendering=null,_.renderingStartTime=0,_.last=x,_.tail=d,_.tailMode=y)}function Mx(s,i,d){var x=i.pendingProps,y=x.revealOrder,_=x.tail;if(tn(s,i,x.children,d),x=or.current,(x&2)!==0)x=x&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&zx(s,d,i);else if(s.tag===19)zx(s,d,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}if(qt(or,x),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(d=i.child,y=null;d!==null;)s=d.alternate,s!==null&&kc(s)===null&&(y=d),d=d.sibling;d=y,d===null?(y=i.child,i.child=null):(y=d.sibling,d.sibling=null),v0(i,!1,y,d,_);break;case"backwards":for(d=null,y=i.child,i.child=null;y!==null;){if(s=y.alternate,s!==null&&kc(s)===null){i.child=y;break}s=y.sibling,y.sibling=d,d=y,y=s}v0(i,!0,d,null,_);break;case"together":v0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Dc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Wa(s,i,d){if(s!==null&&(i.dependencies=s.dependencies),Ks|=i.lanes,(d&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,d=ws(s,s.pendingProps),i.child=d,d.return=i;s.sibling!==null;)s=s.sibling,d=d.sibling=ws(s,s.pendingProps),d.return=i;d.sibling=null}return i.child}function zk(s,i,d){switch(i.tag){case 3:Ax(i),Io();break;case 5:qh(i);break;case 1:hn(i.type)&&dc(i);break;case 4:qd(i,i.stateNode.containerInfo);break;case 10:var x=i.type._context,y=i.memoizedProps.value;qt(gc,x._currentValue),x._currentValue=y;break;case 13:if(x=i.memoizedState,x!==null)return x.dehydrated!==null?(qt(or,or.current&1),i.flags|=128,null):(d&i.child.childLanes)!==0?Rx(s,i,d):(qt(or,or.current&1),s=Wa(s,i,d),s!==null?s.sibling:null);qt(or,or.current&1);break;case 19:if(x=(d&i.childLanes)!==0,(s.flags&128)!==0){if(x)return Mx(s,i,d);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),qt(or,or.current),x)break;return null;case 22:case 23:return i.lanes=0,jx(s,i,d)}return Wa(s,i,d)}var Ix,y0,Lx,Bx;Ix=function(s,i){for(var d=i.child;d!==null;){if(d.tag===5||d.tag===6)s.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break;for(;d.sibling===null;){if(d.return===null||d.return===i)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},y0=function(){},Lx=function(s,i,d,x){var y=s.memoizedProps;if(y!==x){s=i.stateNode,Ys(pa.current);var _=null;switch(d){case"input":y=Pe(s,y),x=Pe(s,x),_=[];break;case"select":y=re({},y,{value:void 0}),x=re({},x,{value:void 0}),_=[];break;case"textarea":y=lt(s,y),x=lt(s,x),_=[];break;default:typeof y.onClick!="function"&&typeof x.onClick=="function"&&(s.onclick=lc)}Jr(d,x);var z;d=null;for(Ce in y)if(!x.hasOwnProperty(Ce)&&y.hasOwnProperty(Ce)&&y[Ce]!=null)if(Ce==="style"){var ce=y[Ce];for(z in ce)ce.hasOwnProperty(z)&&(d||(d={}),d[z]="")}else Ce!=="dangerouslySetInnerHTML"&&Ce!=="children"&&Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&Ce!=="autoFocus"&&(a.hasOwnProperty(Ce)?_||(_=[]):(_=_||[]).push(Ce,null));for(Ce in x){var xe=x[Ce];if(ce=y?.[Ce],x.hasOwnProperty(Ce)&&xe!==ce&&(xe!=null||ce!=null))if(Ce==="style")if(ce){for(z in ce)!ce.hasOwnProperty(z)||xe&&xe.hasOwnProperty(z)||(d||(d={}),d[z]="");for(z in xe)xe.hasOwnProperty(z)&&ce[z]!==xe[z]&&(d||(d={}),d[z]=xe[z])}else d||(_||(_=[]),_.push(Ce,d)),d=xe;else Ce==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,ce=ce?ce.__html:void 0,xe!=null&&ce!==xe&&(_=_||[]).push(Ce,xe)):Ce==="children"?typeof xe!="string"&&typeof xe!="number"||(_=_||[]).push(Ce,""+xe):Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ce)?(xe!=null&&Ce==="onScroll"&&er("scroll",s),_||ce===xe||(_=[])):(_=_||[]).push(Ce,xe))}d&&(_=_||[]).push("style",d);var Ce=_;(i.updateQueue=Ce)&&(i.flags|=4)}},Bx=function(s,i,d,x){d!==x&&(i.flags|=4)};function Gi(s,i){if(!nr)switch(s.tailMode){case"hidden":i=s.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Hr(s){var i=s.alternate!==null&&s.alternate.child===s.child,d=0,x=0;if(i)for(var y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags&14680064,x|=y.flags&14680064,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags,x|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=x,s.childLanes=d,i}function Mk(s,i,d){var x=i.pendingProps;switch(Wd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(i),null;case 1:return hn(i.type)&&uc(),Hr(i),null;case 3:return x=i.stateNode,Uo(),tr(pn),tr(Ur),e0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(s===null||s.child===null)&&(xc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Qn!==null&&(j0(Qn),Qn=null))),y0(s,i),Hr(i),null;case 5:Zd(i);var y=Ys($i.current);if(d=i.type,s!==null&&i.stateNode!=null)Lx(s,i,d,x,y),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!x){if(i.stateNode===null)throw Error(t(166));return Hr(i),null}if(s=Ys(pa.current),xc(i)){x=i.stateNode,d=i.type;var _=i.memoizedProps;switch(x[fa]=i,x[Ii]=_,s=(i.mode&1)!==0,d){case"dialog":er("cancel",x),er("close",x);break;case"iframe":case"object":case"embed":er("load",x);break;case"video":case"audio":for(y=0;y<Ri.length;y++)er(Ri[y],x);break;case"source":er("error",x);break;case"img":case"image":case"link":er("error",x),er("load",x);break;case"details":er("toggle",x);break;case"input":Qe(x,_),er("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!_.multiple},er("invalid",x);break;case"textarea":ft(x,_),er("invalid",x)}Jr(d,_),y=null;for(var z in _)if(_.hasOwnProperty(z)){var ce=_[z];z==="children"?typeof ce=="string"?x.textContent!==ce&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,ce,s),y=["children",ce]):typeof ce=="number"&&x.textContent!==""+ce&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,ce,s),y=["children",""+ce]):a.hasOwnProperty(z)&&ce!=null&&z==="onScroll"&&er("scroll",x)}switch(d){case"input":fe(x),ue(x,_,!0);break;case"textarea":fe(x),Rt(x);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(x.onclick=lc)}x=y,i.updateQueue=x,x!==null&&(i.flags|=4)}else{z=y.nodeType===9?y:y.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Gt(d)),s==="http://www.w3.org/1999/xhtml"?d==="script"?(s=z.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof x.is=="string"?s=z.createElement(d,{is:x.is}):(s=z.createElement(d),d==="select"&&(z=s,x.multiple?z.multiple=!0:x.size&&(z.size=x.size))):s=z.createElementNS(s,d),s[fa]=i,s[Ii]=x,Ix(s,i,!1,!1),i.stateNode=s;e:{switch(z=en(d,x),d){case"dialog":er("cancel",s),er("close",s),y=x;break;case"iframe":case"object":case"embed":er("load",s),y=x;break;case"video":case"audio":for(y=0;y<Ri.length;y++)er(Ri[y],s);y=x;break;case"source":er("error",s),y=x;break;case"img":case"image":case"link":er("error",s),er("load",s),y=x;break;case"details":er("toggle",s),y=x;break;case"input":Qe(s,x),y=Pe(s,x),er("invalid",s);break;case"option":y=x;break;case"select":s._wrapperState={wasMultiple:!!x.multiple},y=re({},x,{value:void 0}),er("invalid",s);break;case"textarea":ft(s,x),y=lt(s,x),er("invalid",s);break;default:y=x}Jr(d,y),ce=y;for(_ in ce)if(ce.hasOwnProperty(_)){var xe=ce[_];_==="style"?$t(s,xe):_==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,xe!=null&&Qt(s,xe)):_==="children"?typeof xe=="string"?(d!=="textarea"||xe!=="")&&dt(s,xe):typeof xe=="number"&&dt(s,""+xe):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(a.hasOwnProperty(_)?xe!=null&&_==="onScroll"&&er("scroll",s):xe!=null&&S(s,_,xe,z))}switch(d){case"input":fe(s),ue(s,x,!1);break;case"textarea":fe(s),Rt(s);break;case"option":x.value!=null&&s.setAttribute("value",""+q(x.value));break;case"select":s.multiple=!!x.multiple,_=x.value,_!=null?Oe(s,!!x.multiple,_,!1):x.defaultValue!=null&&Oe(s,!!x.multiple,x.defaultValue,!0);break;default:typeof y.onClick=="function"&&(s.onclick=lc)}switch(d){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Hr(i),null;case 6:if(s&&i.stateNode!=null)Bx(s,i,s.memoizedProps,x);else{if(typeof x!="string"&&i.stateNode===null)throw Error(t(166));if(d=Ys($i.current),Ys(pa.current),xc(i)){if(x=i.stateNode,d=i.memoizedProps,x[fa]=i,(_=x.nodeValue!==d)&&(s=bn,s!==null))switch(s.tag){case 3:ic(x.nodeValue,d,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ic(x.nodeValue,d,(s.mode&1)!==0)}_&&(i.flags|=4)}else x=(d.nodeType===9?d:d.ownerDocument).createTextNode(x),x[fa]=i,i.stateNode=x}return Hr(i),null;case 13:if(tr(or),x=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(nr&&_n!==null&&(i.mode&1)!==0&&(i.flags&128)===0)$h(),Io(),i.flags|=98560,_=!1;else if(_=xc(i),x!==null&&x.dehydrated!==null){if(s===null){if(!_)throw Error(t(318));if(_=i.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[fa]=i}else Io(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Hr(i),_=!1}else Qn!==null&&(j0(Qn),Qn=null),_=!0;if(!_)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=d,i):(x=x!==null,x!==(s!==null&&s.memoizedState!==null)&&x&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(or.current&1)!==0?Er===0&&(Er=3):A0())),i.updateQueue!==null&&(i.flags|=4),Hr(i),null);case 4:return Uo(),y0(s,i),s===null&&zi(i.stateNode.containerInfo),Hr(i),null;case 10:return Kd(i.type._context),Hr(i),null;case 17:return hn(i.type)&&uc(),Hr(i),null;case 19:if(tr(or),_=i.memoizedState,_===null)return Hr(i),null;if(x=(i.flags&128)!==0,z=_.rendering,z===null)if(x)Gi(_,!1);else{if(Er!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(z=kc(s),z!==null){for(i.flags|=128,Gi(_,!1),x=z.updateQueue,x!==null&&(i.updateQueue=x,i.flags|=4),i.subtreeFlags=0,x=d,d=i.child;d!==null;)_=d,s=x,_.flags&=14680066,z=_.alternate,z===null?(_.childLanes=0,_.lanes=s,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=z.childLanes,_.lanes=z.lanes,_.child=z.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=z.memoizedProps,_.memoizedState=z.memoizedState,_.updateQueue=z.updateQueue,_.type=z.type,s=z.dependencies,_.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),d=d.sibling;return qt(or,or.current&1|2),i.child}s=s.sibling}_.tail!==null&&Ye()>Vo&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304)}else{if(!x)if(s=kc(z),s!==null){if(i.flags|=128,x=!0,d=s.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),Gi(_,!0),_.tail===null&&_.tailMode==="hidden"&&!z.alternate&&!nr)return Hr(i),null}else 2*Ye()-_.renderingStartTime>Vo&&d!==1073741824&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304);_.isBackwards?(z.sibling=i.child,i.child=z):(d=_.last,d!==null?d.sibling=z:i.child=z,_.last=z)}return _.tail!==null?(i=_.tail,_.rendering=i,_.tail=i.sibling,_.renderingStartTime=Ye(),i.sibling=null,d=or.current,qt(or,x?d&1|2:d&1),i):(Hr(i),null);case 22:case 23:return P0(),x=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==x&&(i.flags|=8192),x&&(i.mode&1)!==0?(Sn&1073741824)!==0&&(Hr(i),i.subtreeFlags&6&&(i.flags|=8192)):Hr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Ik(s,i){switch(Wd(i),i.tag){case 1:return hn(i.type)&&uc(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Uo(),tr(pn),tr(Ur),e0(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Zd(i),null;case 13:if(tr(or),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Io()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return tr(or),null;case 4:return Uo(),null;case 10:return Kd(i.type._context),null;case 22:case 23:return P0(),null;case 24:return null;default:return null}}var jc=!1,Yr=!1,Lk=typeof WeakSet=="function"?WeakSet:Set,st=null;function Ho(s,i){var d=s.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(x){ur(s,i,x)}else d.current=null}function w0(s,i,d){try{d()}catch(x){ur(s,i,x)}}var Wx=!1;function Bk(s,i){if(Pd=Xl,s=yh(),Sd(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var x=d.getSelection&&d.getSelection();if(x&&x.rangeCount!==0){d=x.anchorNode;var y=x.anchorOffset,_=x.focusNode;x=x.focusOffset;try{d.nodeType,_.nodeType}catch{d=null;break e}var z=0,ce=-1,xe=-1,Ce=0,Le=0,Ve=s,Ie=null;t:for(;;){for(var at;Ve!==d||y!==0&&Ve.nodeType!==3||(ce=z+y),Ve!==_||x!==0&&Ve.nodeType!==3||(xe=z+x),Ve.nodeType===3&&(z+=Ve.nodeValue.length),(at=Ve.firstChild)!==null;)Ie=Ve,Ve=at;for(;;){if(Ve===s)break t;if(Ie===d&&++Ce===y&&(ce=z),Ie===_&&++Le===x&&(xe=z),(at=Ve.nextSibling)!==null)break;Ve=Ie,Ie=Ve.parentNode}Ve=at}d=ce===-1||xe===-1?null:{start:ce,end:xe}}else d=null}d=d||{start:0,end:0}}else d=null;for(Ad={focusedElem:s,selectionRange:d},Xl=!1,st=i;st!==null;)if(i=st,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,st=s;else for(;st!==null;){i=st;try{var ot=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ot!==null){var it=ot.memoizedProps,mr=ot.memoizedState,ke=i.stateNode,ge=ke.getSnapshotBeforeUpdate(i.elementType===i.type?it:Xn(i.type,it),mr);ke.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var Se=i.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ge){ur(i,i.return,Ge)}if(s=i.sibling,s!==null){s.return=i.return,st=s;break}st=i.return}return ot=Wx,Wx=!1,ot}function Qi(s,i,d){var x=i.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var y=x=x.next;do{if((y.tag&s)===s){var _=y.destroy;y.destroy=void 0,_!==void 0&&w0(i,d,_)}y=y.next}while(y!==x)}}function Fc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var d=i=i.next;do{if((d.tag&s)===s){var x=d.create;d.destroy=x()}d=d.next}while(d!==i)}}function k0(s){var i=s.ref;if(i!==null){var d=s.stateNode;switch(s.tag){case 5:s=d;break;default:s=d}typeof i=="function"?i(s):i.current=s}}function Ux(s){var i=s.alternate;i!==null&&(s.alternate=null,Ux(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[fa],delete i[Ii],delete i[Md],delete i[bk],delete i[_k])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function $x(s){return s.tag===5||s.tag===3||s.tag===4}function Hx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||$x(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function b0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.nodeType===8?d.parentNode.insertBefore(s,i):d.insertBefore(s,i):(d.nodeType===8?(i=d.parentNode,i.insertBefore(s,d)):(i=d,i.appendChild(s)),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=lc));else if(x!==4&&(s=s.child,s!==null))for(b0(s,i,d),s=s.sibling;s!==null;)b0(s,i,d),s=s.sibling}function _0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.insertBefore(s,i):d.appendChild(s);else if(x!==4&&(s=s.child,s!==null))for(_0(s,i,d),s=s.sibling;s!==null;)_0(s,i,d),s=s.sibling}var zr=null,qn=!1;function xs(s,i,d){for(d=d.child;d!==null;)Yx(s,i,d),d=d.sibling}function Yx(s,i,d){if(Dr&&typeof Dr.onCommitFiberUnmount=="function")try{Dr.onCommitFiberUnmount(da,d)}catch{}switch(d.tag){case 5:Yr||Ho(d,i);case 6:var x=zr,y=qn;zr=null,xs(s,i,d),zr=x,qn=y,zr!==null&&(qn?(s=zr,d=d.stateNode,s.nodeType===8?s.parentNode.removeChild(d):s.removeChild(d)):zr.removeChild(d.stateNode));break;case 18:zr!==null&&(qn?(s=zr,d=d.stateNode,s.nodeType===8?zd(s.parentNode,d):s.nodeType===1&&zd(s,d),Ci(s)):zd(zr,d.stateNode));break;case 4:x=zr,y=qn,zr=d.stateNode.containerInfo,qn=!0,xs(s,i,d),zr=x,qn=y;break;case 0:case 11:case 14:case 15:if(!Yr&&(x=d.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){y=x=x.next;do{var _=y,z=_.destroy;_=_.tag,z!==void 0&&((_&2)!==0||(_&4)!==0)&&w0(d,i,z),y=y.next}while(y!==x)}xs(s,i,d);break;case 1:if(!Yr&&(Ho(d,i),x=d.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=d.memoizedProps,x.state=d.memoizedState,x.componentWillUnmount()}catch(ce){ur(d,i,ce)}xs(s,i,d);break;case 21:xs(s,i,d);break;case 22:d.mode&1?(Yr=(x=Yr)||d.memoizedState!==null,xs(s,i,d),Yr=x):xs(s,i,d);break;default:xs(s,i,d)}}function Vx(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var d=s.stateNode;d===null&&(d=s.stateNode=new Lk),i.forEach(function(x){var y=Qk.bind(null,s,x);d.has(x)||(d.add(x),x.then(y,y))})}}function Zn(s,i){var d=i.deletions;if(d!==null)for(var x=0;x<d.length;x++){var y=d[x];try{var _=s,z=i,ce=z;e:for(;ce!==null;){switch(ce.tag){case 5:zr=ce.stateNode,qn=!1;break e;case 3:zr=ce.stateNode.containerInfo,qn=!0;break e;case 4:zr=ce.stateNode.containerInfo,qn=!0;break e}ce=ce.return}if(zr===null)throw Error(t(160));Yx(_,z,y),zr=null,qn=!1;var xe=y.alternate;xe!==null&&(xe.return=null),y.return=null}catch(Ce){ur(y,i,Ce)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Kx(i,s),i=i.sibling}function Kx(s,i){var d=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Zn(i,s),xa(s),x&4){try{Qi(3,s,s.return),Fc(3,s)}catch(it){ur(s,s.return,it)}try{Qi(5,s,s.return)}catch(it){ur(s,s.return,it)}}break;case 1:Zn(i,s),xa(s),x&512&&d!==null&&Ho(d,d.return);break;case 5:if(Zn(i,s),xa(s),x&512&&d!==null&&Ho(d,d.return),s.flags&32){var y=s.stateNode;try{dt(y,"")}catch(it){ur(s,s.return,it)}}if(x&4&&(y=s.stateNode,y!=null)){var _=s.memoizedProps,z=d!==null?d.memoizedProps:_,ce=s.type,xe=s.updateQueue;if(s.updateQueue=null,xe!==null)try{ce==="input"&&_.type==="radio"&&_.name!=null&&qe(y,_),en(ce,z);var Ce=en(ce,_);for(z=0;z<xe.length;z+=2){var Le=xe[z],Ve=xe[z+1];Le==="style"?$t(y,Ve):Le==="dangerouslySetInnerHTML"?Qt(y,Ve):Le==="children"?dt(y,Ve):S(y,Le,Ve,Ce)}switch(ce){case"input":he(y,_);break;case"textarea":gt(y,_);break;case"select":var Ie=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!_.multiple;var at=_.value;at!=null?Oe(y,!!_.multiple,at,!1):Ie!==!!_.multiple&&(_.defaultValue!=null?Oe(y,!!_.multiple,_.defaultValue,!0):Oe(y,!!_.multiple,_.multiple?[]:"",!1))}y[Ii]=_}catch(it){ur(s,s.return,it)}}break;case 6:if(Zn(i,s),xa(s),x&4){if(s.stateNode===null)throw Error(t(162));y=s.stateNode,_=s.memoizedProps;try{y.nodeValue=_}catch(it){ur(s,s.return,it)}}break;case 3:if(Zn(i,s),xa(s),x&4&&d!==null&&d.memoizedState.isDehydrated)try{Ci(i.containerInfo)}catch(it){ur(s,s.return,it)}break;case 4:Zn(i,s),xa(s);break;case 13:Zn(i,s),xa(s),y=s.child,y.flags&8192&&(_=y.memoizedState!==null,y.stateNode.isHidden=_,!_||y.alternate!==null&&y.alternate.memoizedState!==null||(N0=Ye())),x&4&&Vx(s);break;case 22:if(Le=d!==null&&d.memoizedState!==null,s.mode&1?(Yr=(Ce=Yr)||Le,Zn(i,s),Yr=Ce):Zn(i,s),xa(s),x&8192){if(Ce=s.memoizedState!==null,(s.stateNode.isHidden=Ce)&&!Le&&(s.mode&1)!==0)for(st=s,Le=s.child;Le!==null;){for(Ve=st=Le;st!==null;){switch(Ie=st,at=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:Qi(4,Ie,Ie.return);break;case 1:Ho(Ie,Ie.return);var ot=Ie.stateNode;if(typeof ot.componentWillUnmount=="function"){x=Ie,d=Ie.return;try{i=x,ot.props=i.memoizedProps,ot.state=i.memoizedState,ot.componentWillUnmount()}catch(it){ur(x,d,it)}}break;case 5:Ho(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){Xx(Ve);continue}}at!==null?(at.return=Ie,st=at):Xx(Ve)}Le=Le.sibling}e:for(Le=null,Ve=s;;){if(Ve.tag===5){if(Le===null){Le=Ve;try{y=Ve.stateNode,Ce?(_=y.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(ce=Ve.stateNode,xe=Ve.memoizedProps.style,z=xe!=null&&xe.hasOwnProperty("display")?xe.display:null,ce.style.display=Ct("display",z))}catch(it){ur(s,s.return,it)}}}else if(Ve.tag===6){if(Le===null)try{Ve.stateNode.nodeValue=Ce?"":Ve.memoizedProps}catch(it){ur(s,s.return,it)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===s)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===s)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===s)break e;Le===Ve&&(Le=null),Ve=Ve.return}Le===Ve&&(Le=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:Zn(i,s),xa(s),x&4&&Vx(s);break;case 21:break;default:Zn(i,s),xa(s)}}function xa(s){var i=s.flags;if(i&2){try{e:{for(var d=s.return;d!==null;){if($x(d)){var x=d;break e}d=d.return}throw Error(t(160))}switch(x.tag){case 5:var y=x.stateNode;x.flags&32&&(dt(y,""),x.flags&=-33);var _=Hx(s);_0(s,_,y);break;case 3:case 4:var z=x.stateNode.containerInfo,ce=Hx(s);b0(s,ce,z);break;default:throw Error(t(161))}}catch(xe){ur(s,s.return,xe)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Wk(s,i,d){st=s,Gx(s)}function Gx(s,i,d){for(var x=(s.mode&1)!==0;st!==null;){var y=st,_=y.child;if(y.tag===22&&x){var z=y.memoizedState!==null||jc;if(!z){var ce=y.alternate,xe=ce!==null&&ce.memoizedState!==null||Yr;ce=jc;var Ce=Yr;if(jc=z,(Yr=xe)&&!Ce)for(st=y;st!==null;)z=st,xe=z.child,z.tag===22&&z.memoizedState!==null?qx(y):xe!==null?(xe.return=z,st=xe):qx(y);for(;_!==null;)st=_,Gx(_),_=_.sibling;st=y,jc=ce,Yr=Ce}Qx(s)}else(y.subtreeFlags&8772)!==0&&_!==null?(_.return=y,st=_):Qx(s)}}function Qx(s){for(;st!==null;){var i=st;if((i.flags&8772)!==0){var d=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Yr||Fc(5,i);break;case 1:var x=i.stateNode;if(i.flags&4&&!Yr)if(d===null)x.componentDidMount();else{var y=i.elementType===i.type?d.memoizedProps:Xn(i.type,d.memoizedProps);x.componentDidUpdate(y,d.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var _=i.updateQueue;_!==null&&Xh(i,_,x);break;case 3:var z=i.updateQueue;if(z!==null){if(d=null,i.child!==null)switch(i.child.tag){case 5:d=i.child.stateNode;break;case 1:d=i.child.stateNode}Xh(i,z,d)}break;case 5:var ce=i.stateNode;if(d===null&&i.flags&4){d=ce;var xe=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":xe.autoFocus&&d.focus();break;case"img":xe.src&&(d.src=xe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Ce=i.alternate;if(Ce!==null){var Le=Ce.memoizedState;if(Le!==null){var Ve=Le.dehydrated;Ve!==null&&Ci(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Yr||i.flags&512&&k0(i)}catch(Ie){ur(i,i.return,Ie)}}if(i===s){st=null;break}if(d=i.sibling,d!==null){d.return=i.return,st=d;break}st=i.return}}function Xx(s){for(;st!==null;){var i=st;if(i===s){st=null;break}var d=i.sibling;if(d!==null){d.return=i.return,st=d;break}st=i.return}}function qx(s){for(;st!==null;){var i=st;try{switch(i.tag){case 0:case 11:case 15:var d=i.return;try{Fc(4,i)}catch(xe){ur(i,d,xe)}break;case 1:var x=i.stateNode;if(typeof x.componentDidMount=="function"){var y=i.return;try{x.componentDidMount()}catch(xe){ur(i,y,xe)}}var _=i.return;try{k0(i)}catch(xe){ur(i,_,xe)}break;case 5:var z=i.return;try{k0(i)}catch(xe){ur(i,z,xe)}}}catch(xe){ur(i,i.return,xe)}if(i===s){st=null;break}var ce=i.sibling;if(ce!==null){ce.return=i.return,st=ce;break}st=i.return}}var Uk=Math.ceil,Pc=U.ReactCurrentDispatcher,S0=U.ReactCurrentOwner,On=U.ReactCurrentBatchConfig,Ft=0,Fr=null,wr=null,Mr=0,Sn=0,Yo=us(0),Er=0,Xi=null,Ks=0,Ac=0,E0=0,qi=null,mn=null,N0=0,Vo=1/0,Ua=null,Oc=!1,C0=null,ms=null,Rc=!1,gs=null,zc=0,Zi=0,T0=null,Mc=-1,Ic=0;function rn(){return(Ft&6)!==0?Ye():Mc!==-1?Mc:Mc=Ye()}function vs(s){return(s.mode&1)===0?1:(Ft&2)!==0&&Mr!==0?Mr&-Mr:Ek.transition!==null?(Ic===0&&(Ic=Hp()),Ic):(s=Yt,s!==0||(s=window.event,s=s===void 0?16:Jp(s.type)),s)}function Jn(s,i,d,x){if(50<Zi)throw Zi=0,T0=null,Error(t(185));bi(s,d,x),((Ft&2)===0||s!==Fr)&&(s===Fr&&((Ft&2)===0&&(Ac|=d),Er===4&&ys(s,Mr)),gn(s,x),d===1&&Ft===0&&(i.mode&1)===0&&(Vo=Ye()+500,fc&&fs()))}function gn(s,i){var d=s.callbackNode;Ew(s,i);var x=Kl(s,s===Fr?Mr:0);if(x===0)d!==null&&Xe(d),s.callbackNode=null,s.callbackPriority=0;else if(i=x&-x,s.callbackPriority!==i){if(d!=null&&Xe(d),i===1)s.tag===0?Sk(Jx.bind(null,s)):Ih(Jx.bind(null,s)),wk(function(){(Ft&6)===0&&fs()}),d=null;else{switch(Yp(x)){case 1:d=Ht;break;case 4:d=Wt;break;case 16:d=hr;break;case 536870912:d=rs;break;default:d=hr}d=im(d,Zx.bind(null,s))}s.callbackPriority=i,s.callbackNode=d}}function Zx(s,i){if(Mc=-1,Ic=0,(Ft&6)!==0)throw Error(t(327));var d=s.callbackNode;if(Ko()&&s.callbackNode!==d)return null;var x=Kl(s,s===Fr?Mr:0);if(x===0)return null;if((x&30)!==0||(x&s.expiredLanes)!==0||i)i=Lc(s,x);else{i=x;var y=Ft;Ft|=2;var _=tm();(Fr!==s||Mr!==i)&&(Ua=null,Vo=Ye()+500,Qs(s,i));do try{Yk();break}catch(ce){em(s,ce)}while(!0);Vd(),Pc.current=_,Ft=y,wr!==null?i=0:(Fr=null,Mr=0,i=Er)}if(i!==0){if(i===2&&(y=ld(s),y!==0&&(x=y,i=D0(s,y))),i===1)throw d=Xi,Qs(s,0),ys(s,x),gn(s,Ye()),d;if(i===6)ys(s,x);else{if(y=s.current.alternate,(x&30)===0&&!$k(y)&&(i=Lc(s,x),i===2&&(_=ld(s),_!==0&&(x=_,i=D0(s,_))),i===1))throw d=Xi,Qs(s,0),ys(s,x),gn(s,Ye()),d;switch(s.finishedWork=y,s.finishedLanes=x,i){case 0:case 1:throw Error(t(345));case 2:Xs(s,mn,Ua);break;case 3:if(ys(s,x),(x&130023424)===x&&(i=N0+500-Ye(),10<i)){if(Kl(s,0)!==0)break;if(y=s.suspendedLanes,(y&x)!==x){rn(),s.pingedLanes|=s.suspendedLanes&y;break}s.timeoutHandle=Rd(Xs.bind(null,s,mn,Ua),i);break}Xs(s,mn,Ua);break;case 4:if(ys(s,x),(x&4194240)===x)break;for(i=s.eventTimes,y=-1;0<x;){var z=31-xr(x);_=1<<z,z=i[z],z>y&&(y=z),x&=~_}if(x=y,x=Ye()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*Uk(x/1960))-x,10<x){s.timeoutHandle=Rd(Xs.bind(null,s,mn,Ua),x);break}Xs(s,mn,Ua);break;case 5:Xs(s,mn,Ua);break;default:throw Error(t(329))}}}return gn(s,Ye()),s.callbackNode===d?Zx.bind(null,s):null}function D0(s,i){var d=qi;return s.current.memoizedState.isDehydrated&&(Qs(s,i).flags|=256),s=Lc(s,i),s!==2&&(i=mn,mn=d,i!==null&&j0(i)),s}function j0(s){mn===null?mn=s:mn.push.apply(mn,s)}function $k(s){for(var i=s;;){if(i.flags&16384){var d=i.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var x=0;x<d.length;x++){var y=d[x],_=y.getSnapshot;y=y.value;try{if(!Gn(_(),y))return!1}catch{return!1}}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ys(s,i){for(i&=~E0,i&=~Ac,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var d=31-xr(i),x=1<<d;s[d]=-1,i&=~x}}function Jx(s){if((Ft&6)!==0)throw Error(t(327));Ko();var i=Kl(s,0);if((i&1)===0)return gn(s,Ye()),null;var d=Lc(s,i);if(s.tag!==0&&d===2){var x=ld(s);x!==0&&(i=x,d=D0(s,x))}if(d===1)throw d=Xi,Qs(s,0),ys(s,i),gn(s,Ye()),d;if(d===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Xs(s,mn,Ua),gn(s,Ye()),null}function F0(s,i){var d=Ft;Ft|=1;try{return s(i)}finally{Ft=d,Ft===0&&(Vo=Ye()+500,fc&&fs())}}function Gs(s){gs!==null&&gs.tag===0&&(Ft&6)===0&&Ko();var i=Ft;Ft|=1;var d=On.transition,x=Yt;try{if(On.transition=null,Yt=1,s)return s()}finally{Yt=x,On.transition=d,Ft=i,(Ft&6)===0&&fs()}}function P0(){Sn=Yo.current,tr(Yo)}function Qs(s,i){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;if(d!==-1&&(s.timeoutHandle=-1,yk(d)),wr!==null)for(d=wr.return;d!==null;){var x=d;switch(Wd(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&uc();break;case 3:Uo(),tr(pn),tr(Ur),e0();break;case 5:Zd(x);break;case 4:Uo();break;case 13:tr(or);break;case 19:tr(or);break;case 10:Kd(x.type._context);break;case 22:case 23:P0()}d=d.return}if(Fr=s,wr=s=ws(s.current,null),Mr=Sn=i,Er=0,Xi=null,E0=Ac=Ks=0,mn=qi=null,Hs!==null){for(i=0;i<Hs.length;i++)if(d=Hs[i],x=d.interleaved,x!==null){d.interleaved=null;var y=x.next,_=d.pending;if(_!==null){var z=_.next;_.next=y,x.next=z}d.pending=x}Hs=null}return s}function em(s,i){do{var d=wr;try{if(Vd(),bc.current=Nc,_c){for(var x=ir.memoizedState;x!==null;){var y=x.queue;y!==null&&(y.pending=null),x=x.next}_c=!1}if(Vs=0,jr=Sr=ir=null,Hi=!1,Yi=0,S0.current=null,d===null||d.return===null){Er=1,Xi=i,wr=null;break}e:{var _=s,z=d.return,ce=d,xe=i;if(i=Mr,ce.flags|=32768,xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var Ce=xe,Le=ce,Ve=Le.tag;if((Le.mode&1)===0&&(Ve===0||Ve===11||Ve===15)){var Ie=Le.alternate;Ie?(Le.updateQueue=Ie.updateQueue,Le.memoizedState=Ie.memoizedState,Le.lanes=Ie.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var at=Ex(z);if(at!==null){at.flags&=-257,Nx(at,z,ce,_,i),at.mode&1&&Sx(_,Ce,i),i=at,xe=Ce;var ot=i.updateQueue;if(ot===null){var it=new Set;it.add(xe),i.updateQueue=it}else ot.add(xe);break e}else{if((i&1)===0){Sx(_,Ce,i),A0();break e}xe=Error(t(426))}}else if(nr&&ce.mode&1){var mr=Ex(z);if(mr!==null){(mr.flags&65536)===0&&(mr.flags|=256),Nx(mr,z,ce,_,i),Hd($o(xe,ce));break e}}_=xe=$o(xe,ce),Er!==4&&(Er=2),qi===null?qi=[_]:qi.push(_),_=z;do{switch(_.tag){case 3:_.flags|=65536,i&=-i,_.lanes|=i;var ke=bx(_,xe,i);Qh(_,ke);break e;case 1:ce=xe;var ge=_.type,Se=_.stateNode;if((_.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&(ms===null||!ms.has(Se)))){_.flags|=65536,i&=-i,_.lanes|=i;var Ge=_x(_,ce,i);Qh(_,Ge);break e}}_=_.return}while(_!==null)}nm(d)}catch(ct){i=ct,wr===d&&d!==null&&(wr=d=d.return);continue}break}while(!0)}function tm(){var s=Pc.current;return Pc.current=Nc,s===null?Nc:s}function A0(){(Er===0||Er===3||Er===2)&&(Er=4),Fr===null||(Ks&268435455)===0&&(Ac&268435455)===0||ys(Fr,Mr)}function Lc(s,i){var d=Ft;Ft|=2;var x=tm();(Fr!==s||Mr!==i)&&(Ua=null,Qs(s,i));do try{Hk();break}catch(y){em(s,y)}while(!0);if(Vd(),Ft=d,Pc.current=x,wr!==null)throw Error(t(261));return Fr=null,Mr=0,Er}function Hk(){for(;wr!==null;)rm(wr)}function Yk(){for(;wr!==null&&!We();)rm(wr)}function rm(s){var i=om(s.alternate,s,Sn);s.memoizedProps=s.pendingProps,i===null?nm(s):wr=i,S0.current=null}function nm(s){var i=s;do{var d=i.alternate;if(s=i.return,(i.flags&32768)===0){if(d=Mk(d,i,Sn),d!==null){wr=d;return}}else{if(d=Ik(d,i),d!==null){d.flags&=32767,wr=d;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Er=6,wr=null;return}}if(i=i.sibling,i!==null){wr=i;return}wr=i=s}while(i!==null);Er===0&&(Er=5)}function Xs(s,i,d){var x=Yt,y=On.transition;try{On.transition=null,Yt=1,Vk(s,i,d,x)}finally{On.transition=y,Yt=x}return null}function Vk(s,i,d,x){do Ko();while(gs!==null);if((Ft&6)!==0)throw Error(t(327));d=s.finishedWork;var y=s.finishedLanes;if(d===null)return null;if(s.finishedWork=null,s.finishedLanes=0,d===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var _=d.lanes|d.childLanes;if(Nw(s,_),s===Fr&&(wr=Fr=null,Mr=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Rc||(Rc=!0,im(hr,function(){return Ko(),null})),_=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||_){_=On.transition,On.transition=null;var z=Yt;Yt=1;var ce=Ft;Ft|=4,S0.current=null,Bk(s,d),Kx(d,s),fk(Ad),Xl=!!Pd,Ad=Pd=null,s.current=d,Wk(d),Ue(),Ft=ce,Yt=z,On.transition=_}else s.current=d;if(Rc&&(Rc=!1,gs=s,zc=y),_=s.pendingLanes,_===0&&(ms=null),wi(d.stateNode),gn(s,Ye()),i!==null)for(x=s.onRecoverableError,d=0;d<i.length;d++)y=i[d],x(y.value,{componentStack:y.stack,digest:y.digest});if(Oc)throw Oc=!1,s=C0,C0=null,s;return(zc&1)!==0&&s.tag!==0&&Ko(),_=s.pendingLanes,(_&1)!==0?s===T0?Zi++:(Zi=0,T0=s):Zi=0,fs(),null}function Ko(){if(gs!==null){var s=Yp(zc),i=On.transition,d=Yt;try{if(On.transition=null,Yt=16>s?16:s,gs===null)var x=!1;else{if(s=gs,gs=null,zc=0,(Ft&6)!==0)throw Error(t(331));var y=Ft;for(Ft|=4,st=s.current;st!==null;){var _=st,z=_.child;if((st.flags&16)!==0){var ce=_.deletions;if(ce!==null){for(var xe=0;xe<ce.length;xe++){var Ce=ce[xe];for(st=Ce;st!==null;){var Le=st;switch(Le.tag){case 0:case 11:case 15:Qi(8,Le,_)}var Ve=Le.child;if(Ve!==null)Ve.return=Le,st=Ve;else for(;st!==null;){Le=st;var Ie=Le.sibling,at=Le.return;if(Ux(Le),Le===Ce){st=null;break}if(Ie!==null){Ie.return=at,st=Ie;break}st=at}}}var ot=_.alternate;if(ot!==null){var it=ot.child;if(it!==null){ot.child=null;do{var mr=it.sibling;it.sibling=null,it=mr}while(it!==null)}}st=_}}if((_.subtreeFlags&2064)!==0&&z!==null)z.return=_,st=z;else e:for(;st!==null;){if(_=st,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Qi(9,_,_.return)}var ke=_.sibling;if(ke!==null){ke.return=_.return,st=ke;break e}st=_.return}}var ge=s.current;for(st=ge;st!==null;){z=st;var Se=z.child;if((z.subtreeFlags&2064)!==0&&Se!==null)Se.return=z,st=Se;else e:for(z=ge;st!==null;){if(ce=st,(ce.flags&2048)!==0)try{switch(ce.tag){case 0:case 11:case 15:Fc(9,ce)}}catch(ct){ur(ce,ce.return,ct)}if(ce===z){st=null;break e}var Ge=ce.sibling;if(Ge!==null){Ge.return=ce.return,st=Ge;break e}st=ce.return}}if(Ft=y,fs(),Dr&&typeof Dr.onPostCommitFiberRoot=="function")try{Dr.onPostCommitFiberRoot(da,s)}catch{}x=!0}return x}finally{Yt=d,On.transition=i}}return!1}function am(s,i,d){i=$o(d,i),i=bx(s,i,1),s=hs(s,i,1),i=rn(),s!==null&&(bi(s,1,i),gn(s,i))}function ur(s,i,d){if(s.tag===3)am(s,s,d);else for(;i!==null;){if(i.tag===3){am(i,s,d);break}else if(i.tag===1){var x=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(ms===null||!ms.has(x))){s=$o(d,s),s=_x(i,s,1),i=hs(i,s,1),s=rn(),i!==null&&(bi(i,1,s),gn(i,s));break}}i=i.return}}function Kk(s,i,d){var x=s.pingCache;x!==null&&x.delete(i),i=rn(),s.pingedLanes|=s.suspendedLanes&d,Fr===s&&(Mr&d)===d&&(Er===4||Er===3&&(Mr&130023424)===Mr&&500>Ye()-N0?Qs(s,0):E0|=d),gn(s,i)}function sm(s,i){i===0&&((s.mode&1)===0?i=1:(i=Vl,Vl<<=1,(Vl&130023424)===0&&(Vl=4194304)));var d=rn();s=La(s,i),s!==null&&(bi(s,i,d),gn(s,d))}function Gk(s){var i=s.memoizedState,d=0;i!==null&&(d=i.retryLane),sm(s,d)}function Qk(s,i){var d=0;switch(s.tag){case 13:var x=s.stateNode,y=s.memoizedState;y!==null&&(d=y.retryLane);break;case 19:x=s.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(i),sm(s,d)}var om;om=function(s,i,d){if(s!==null)if(s.memoizedProps!==i.pendingProps||pn.current)xn=!0;else{if((s.lanes&d)===0&&(i.flags&128)===0)return xn=!1,zk(s,i,d);xn=(s.flags&131072)!==0}else xn=!1,nr&&(i.flags&1048576)!==0&&Lh(i,hc,i.index);switch(i.lanes=0,i.tag){case 2:var x=i.type;Dc(s,i),s=i.pendingProps;var y=Ro(i,Ur.current);Wo(i,d),y=n0(null,i,x,s,y,d);var _=a0();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,hn(x)?(_=!0,dc(i)):_=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Xd(i),y.updater=Cc,i.stateNode=y,y._reactInternals=i,u0(i,x,s,d),i=h0(null,i,x,!0,_,d)):(i.tag=0,nr&&_&&Bd(i),tn(null,i,y,d),i=i.child),i;case 16:x=i.elementType;e:{switch(Dc(s,i),s=i.pendingProps,y=x._init,x=y(x._payload),i.type=x,y=i.tag=qk(x),s=Xn(x,s),y){case 0:i=p0(null,i,x,s,d);break e;case 1:i=Px(null,i,x,s,d);break e;case 11:i=Cx(null,i,x,s,d);break e;case 14:i=Tx(null,i,x,Xn(x.type,s),d);break e}throw Error(t(306,x,""))}return i;case 0:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),p0(s,i,x,y,d);case 1:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),Px(s,i,x,y,d);case 3:e:{if(Ax(i),s===null)throw Error(t(387));x=i.pendingProps,_=i.memoizedState,y=_.element,Gh(s,i),wc(i,x,null,d);var z=i.memoizedState;if(x=z.element,_.isDehydrated)if(_={element:x,isDehydrated:!1,cache:z.cache,pendingSuspenseBoundaries:z.pendingSuspenseBoundaries,transitions:z.transitions},i.updateQueue.baseState=_,i.memoizedState=_,i.flags&256){y=$o(Error(t(423)),i),i=Ox(s,i,x,d,y);break e}else if(x!==y){y=$o(Error(t(424)),i),i=Ox(s,i,x,d,y);break e}else for(_n=cs(i.stateNode.containerInfo.firstChild),bn=i,nr=!0,Qn=null,d=Vh(i,null,x,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Io(),x===y){i=Wa(s,i,d);break e}tn(s,i,x,d)}i=i.child}return i;case 5:return qh(i),s===null&&$d(i),x=i.type,y=i.pendingProps,_=s!==null?s.memoizedProps:null,z=y.children,Od(x,y)?z=null:_!==null&&Od(x,_)&&(i.flags|=32),Fx(s,i),tn(s,i,z,d),i.child;case 6:return s===null&&$d(i),null;case 13:return Rx(s,i,d);case 4:return qd(i,i.stateNode.containerInfo),x=i.pendingProps,s===null?i.child=Lo(i,null,x,d):tn(s,i,x,d),i.child;case 11:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),Cx(s,i,x,y,d);case 7:return tn(s,i,i.pendingProps,d),i.child;case 8:return tn(s,i,i.pendingProps.children,d),i.child;case 12:return tn(s,i,i.pendingProps.children,d),i.child;case 10:e:{if(x=i.type._context,y=i.pendingProps,_=i.memoizedProps,z=y.value,qt(gc,x._currentValue),x._currentValue=z,_!==null)if(Gn(_.value,z)){if(_.children===y.children&&!pn.current){i=Wa(s,i,d);break e}}else for(_=i.child,_!==null&&(_.return=i);_!==null;){var ce=_.dependencies;if(ce!==null){z=_.child;for(var xe=ce.firstContext;xe!==null;){if(xe.context===x){if(_.tag===1){xe=Ba(-1,d&-d),xe.tag=2;var Ce=_.updateQueue;if(Ce!==null){Ce=Ce.shared;var Le=Ce.pending;Le===null?xe.next=xe:(xe.next=Le.next,Le.next=xe),Ce.pending=xe}}_.lanes|=d,xe=_.alternate,xe!==null&&(xe.lanes|=d),Gd(_.return,d,i),ce.lanes|=d;break}xe=xe.next}}else if(_.tag===10)z=_.type===i.type?null:_.child;else if(_.tag===18){if(z=_.return,z===null)throw Error(t(341));z.lanes|=d,ce=z.alternate,ce!==null&&(ce.lanes|=d),Gd(z,d,i),z=_.sibling}else z=_.child;if(z!==null)z.return=_;else for(z=_;z!==null;){if(z===i){z=null;break}if(_=z.sibling,_!==null){_.return=z.return,z=_;break}z=z.return}_=z}tn(s,i,y.children,d),i=i.child}return i;case 9:return y=i.type,x=i.pendingProps.children,Wo(i,d),y=Pn(y),x=x(y),i.flags|=1,tn(s,i,x,d),i.child;case 14:return x=i.type,y=Xn(x,i.pendingProps),y=Xn(x.type,y),Tx(s,i,x,y,d);case 15:return Dx(s,i,i.type,i.pendingProps,d);case 17:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),Dc(s,i),i.tag=1,hn(x)?(s=!0,dc(i)):s=!1,Wo(i,d),wx(i,x,y),u0(i,x,y,d),h0(null,i,x,!0,s,d);case 19:return Mx(s,i,d);case 22:return jx(s,i,d)}throw Error(t(156,i.tag))};function im(s,i){return Be(s,i)}function Xk(s,i,d,x){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(s,i,d,x){return new Xk(s,i,d,x)}function O0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function qk(s){if(typeof s=="function")return O0(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Y)return 11;if(s===G)return 14}return 2}function ws(s,i){var d=s.alternate;return d===null?(d=Rn(s.tag,i,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=i,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&14680064,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,i=s.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d}function Bc(s,i,d,x,y,_){var z=2;if(x=s,typeof s=="function")O0(s)&&(z=1);else if(typeof s=="string")z=5;else e:switch(s){case D:return qs(d.children,y,_,i);case K:z=8,y|=8;break;case W:return s=Rn(12,d,i,y|2),s.elementType=W,s.lanes=_,s;case pe:return s=Rn(13,d,i,y),s.elementType=pe,s.lanes=_,s;case de:return s=Rn(19,d,i,y),s.elementType=de,s.lanes=_,s;case L:return Wc(d,y,_,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case oe:z=10;break e;case J:z=9;break e;case Y:z=11;break e;case G:z=14;break e;case ie:z=16,x=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Rn(z,d,i,y),i.elementType=s,i.type=x,i.lanes=_,i}function qs(s,i,d,x){return s=Rn(7,s,x,i),s.lanes=d,s}function Wc(s,i,d,x){return s=Rn(22,s,x,i),s.elementType=L,s.lanes=d,s.stateNode={isHidden:!1},s}function R0(s,i,d){return s=Rn(6,s,null,i),s.lanes=d,s}function z0(s,i,d){return i=Rn(4,s.children!==null?s.children:[],s.key,i),i.lanes=d,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function Zk(s,i,d,x,y){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cd(0),this.expirationTimes=cd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cd(0),this.identifierPrefix=x,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function M0(s,i,d,x,y,_,z,ce,xe){return s=new Zk(s,i,d,ce,xe),i===1?(i=1,_===!0&&(i|=8)):i=0,_=Rn(3,null,null,i),s.current=_,_.stateNode=s,_.memoizedState={element:x,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xd(_),s}function Jk(s,i,d){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Q,key:x==null?null:""+x,children:s,containerInfo:i,implementation:d}}function lm(s){if(!s)return ds;s=s._reactInternals;e:{if(ae(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(hn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var d=s.type;if(hn(d))return zh(s,d,i)}return i}function cm(s,i,d,x,y,_,z,ce,xe){return s=M0(d,x,!0,s,y,_,z,ce,xe),s.context=lm(null),d=s.current,x=rn(),y=vs(d),_=Ba(x,y),_.callback=i??null,hs(d,_,y),s.current.lanes=y,bi(s,y,x),gn(s,x),s}function Uc(s,i,d,x){var y=i.current,_=rn(),z=vs(y);return d=lm(d),i.context===null?i.context=d:i.pendingContext=d,i=Ba(_,z),i.payload={element:s},x=x===void 0?null:x,x!==null&&(i.callback=x),s=hs(y,i,z),s!==null&&(Jn(s,y,z,_),yc(s,y,z)),z}function $c(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function um(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<i?d:i}}function I0(s,i){um(s,i),(s=s.alternate)&&um(s,i)}function eb(){return null}var dm=typeof reportError=="function"?reportError:function(s){console.error(s)};function L0(s){this._internalRoot=s}Hc.prototype.render=L0.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));Uc(s,i,null,null)},Hc.prototype.unmount=L0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Gs(function(){Uc(null,s,null,null)}),i[Ra]=null}};function Hc(s){this._internalRoot=s}Hc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Gp();s={blockedOn:null,target:s,priority:i};for(var d=0;d<os.length&&i!==0&&i<os[d].priority;d++);os.splice(d,0,s),d===0&&qp(s)}};function B0(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Yc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function fm(){}function tb(s,i,d,x,y){if(y){if(typeof x=="function"){var _=x;x=function(){var Ce=$c(z);_.call(Ce)}}var z=cm(i,x,s,0,null,!1,!1,"",fm);return s._reactRootContainer=z,s[Ra]=z.current,zi(s.nodeType===8?s.parentNode:s),Gs(),z}for(;y=s.lastChild;)s.removeChild(y);if(typeof x=="function"){var ce=x;x=function(){var Ce=$c(xe);ce.call(Ce)}}var xe=M0(s,0,!1,null,null,!1,!1,"",fm);return s._reactRootContainer=xe,s[Ra]=xe.current,zi(s.nodeType===8?s.parentNode:s),Gs(function(){Uc(i,xe,d,x)}),xe}function Vc(s,i,d,x,y){var _=d._reactRootContainer;if(_){var z=_;if(typeof y=="function"){var ce=y;y=function(){var xe=$c(z);ce.call(xe)}}Uc(i,z,s,y)}else z=tb(d,i,s,y,x);return $c(z)}Vp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var d=ki(i.pendingLanes);d!==0&&(ud(i,d|1),gn(i,Ye()),(Ft&6)===0&&(Vo=Ye()+500,fs()))}break;case 13:Gs(function(){var x=La(s,1);if(x!==null){var y=rn();Jn(x,s,1,y)}}),I0(s,1)}},dd=function(s){if(s.tag===13){var i=La(s,134217728);if(i!==null){var d=rn();Jn(i,s,134217728,d)}I0(s,134217728)}},Kp=function(s){if(s.tag===13){var i=vs(s),d=La(s,i);if(d!==null){var x=rn();Jn(d,s,i,x)}I0(s,i)}},Gp=function(){return Yt},Qp=function(s,i){var d=Yt;try{return Yt=s,i()}finally{Yt=d}},ze=function(s,i,d){switch(i){case"input":if(he(s,d),i=d.name,d.type==="radio"&&i!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<d.length;i++){var x=d[i];if(x!==s&&x.form===s.form){var y=cc(x);if(!y)throw Error(t(90));I(x),he(x,y)}}}break;case"textarea":gt(s,d);break;case"select":i=d.value,i!=null&&Oe(s,!!d.multiple,i,!1)}},Re=F0,$e=Gs;var rb={usingClientEntryPoint:!1,Events:[Li,Ao,cc,ye,De,F0]},Ji={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nb={bundleType:Ji.bundleType,version:Ji.version,rendererPackageName:Ji.rendererPackageName,rendererConfig:Ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:U.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Ee(s),s===null?null:s.stateNode},findFiberByHostInstance:Ji.findFiberByHostInstance||eb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kc.isDisabled&&Kc.supportsFiber)try{da=Kc.inject(nb),Dr=Kc}catch{}}return vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rb,vn.createPortal=function(s,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B0(i))throw Error(t(200));return Jk(s,i,null,d)},vn.createRoot=function(s,i){if(!B0(s))throw Error(t(299));var d=!1,x="",y=dm;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(x=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=M0(s,1,!1,null,null,d,!1,x,y),s[Ra]=i.current,zi(s.nodeType===8?s.parentNode:s),new L0(i)},vn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Ee(i),s=s===null?null:s.stateNode,s},vn.flushSync=function(s){return Gs(s)},vn.hydrate=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!0,d)},vn.hydrateRoot=function(s,i,d){if(!B0(s))throw Error(t(405));var x=d!=null&&d.hydratedSources||null,y=!1,_="",z=dm;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onRecoverableError!==void 0&&(z=d.onRecoverableError)),i=cm(i,null,s,1,d??null,y,!1,_,z),s[Ra]=i.current,zi(s),x)for(s=0;s<x.length;s++)d=x[s],y=d._getVersion,y=y(d._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[d,y]:i.mutableSourceEagerHydrationData.push(d,y);return new Hc(i)},vn.render=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!1,d)},vn.unmountComponentAtNode=function(s){if(!Yc(s))throw Error(t(40));return s._reactRootContainer?(Gs(function(){Vc(null,null,s,!1,function(){s._reactRootContainer=null,s[Ra]=null})}),!0):!1},vn.unstable_batchedUpdates=F0,vn.unstable_renderSubtreeIntoContainer=function(s,i,d,x){if(!Yc(d))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Vc(s,i,d,!1,x)},vn.version="18.3.1-next-f1338f8080-20240426",vn}var wm;function Xf(){if(wm)return $0.exports;wm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),$0.exports=fb(),$0.exports}var km;function pb(){if(km)return Gc;km=1;var e=Xf();return Gc.createRoot=e.createRoot,Gc.hydrateRoot=e.hydrateRoot,Gc}var hb=pb();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Dn=(e,n)=>{const t=E.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...h},p)=>E.createElement("svg",{ref:p,...xb,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${mb(e)}`,c].join(" "),...h},[...n.map(([m,g])=>E.createElement(m,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=Dn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Dn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=Dn("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=Dn("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=Dn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Dn("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=Dn("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Dn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=Dn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Dn("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Dn("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=Dn("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=Dn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Qc={exports:{}},bs={},V0={exports:{}},K0,bm;function bb(){if(bm)return K0;bm=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K0=e,K0}var G0,_m;function _b(){if(_m)return G0;_m=1;var e=bb();function n(){}function t(){}return t.resetWarningCache=n,G0=function(){function r(l,c,f,h,p,m){if(m!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},G0}var Sm;function Mv(){return Sm||(Sm=1,V0.exports=_b()()),V0.exports}var Xc={exports:{}},zn={},qc={exports:{}},Em;function Iv(){return Em||(Em=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(m,g){return g.getPropertyValue("overflow")!=="visible"||m.scrollWidth<=0&&m.scrollHeight<=0}function l(m){var g=m.offsetWidth<=0&&m.offsetHeight<=0;if(g&&!m.innerHTML)return!0;try{var v=window.getComputedStyle(m),w=v.getPropertyValue("display");return g?w!==r&&o(m,v):w===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(m){for(var g=m,v=m.getRootNode&&m.getRootNode();g&&g!==document.body;){if(v&&g===v&&(g=v.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(m,g){var v=m.nodeName.toLowerCase(),w=a.test(v)&&!m.disabled||v==="a"&&m.href||g;return w&&c(m)}function h(m){var g=m.getAttribute("tabindex");g===null&&(g=void 0);var v=isNaN(g);return(v||g>=0)&&f(m,!v)}function p(m){var g=[].slice.call(m.querySelectorAll("*"),0).reduce(function(v,w){return v.concat(w.shadowRoot?p(w.shadowRoot):[w])},[]);return g.filter(h)}e.exports=n.default})(qc,qc.exports)),qc.exports}var Nm;function Sb(){if(Nm)return zn;Nm=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.resetState=l,zn.log=c,zn.handleBlur=f,zn.handleFocus=h,zn.markForFocusLater=p,zn.returnFocus=m,zn.popWithoutFocus=g,zn.setupScopedFocus=v,zn.teardownScopedFocus=w;var e=Iv(),n=t(e);function t(b){return b&&b.__esModule?b:{default:b}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function h(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var b=(0,n.default)(a)[0]||a;b.focus()}},0)}}function p(){r.push(document.activeElement)}function m(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=null;try{r.length!==0&&(k=r.pop(),k.focus({preventScroll:b}));return}catch{console.warn(["You tried to return focus to",k,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function v(b){a=b,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",h,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",h))}function w(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",h)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",h))}return zn}var Zc={exports:{}},Cm;function Eb(){return Cm||(Cm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=Iv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var h=(0,r.default)(c);if(!h.length){f.preventDefault();return}var p=void 0,m=f.shiftKey,g=h[0],v=h[h.length-1],w=o();if(c===w){if(!m)return;p=v}if(v===w&&!m&&(p=g),g===w&&m&&(p=v),p){f.preventDefault(),p.focus();return}var b=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),k=b!=null&&b[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(k){var N=h.indexOf(w);if(N>-1&&(N+=m?-1:1),p=h[N],typeof p>"u"){f.preventDefault(),p=m?v:g,p.focus();return}f.preventDefault(),p.focus()}}e.exports=n.default})(Zc,Zc.exports)),Zc.exports}var ea={},Q0,Tm;function Nb(){if(Tm)return Q0;Tm=1;var e=function(){};return Q0=e,Q0}var ma={},X0={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Dm;function Cb(){return Dm||(Dm=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(X0)),X0.exports}var jm;function tp(){if(jm)return ma;jm=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.canUseDOM=ma.SafeNodeList=ma.SafeHTMLCollection=void 0;var e=Cb(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return ma.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},ma.SafeNodeList=r.canUseDOM?window.NodeList:{},ma.canUseDOM=r.canUseDOM,ma.default=a,ma}var Fm;function Lv(){if(Fm)return ea;Fm=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.resetState=o,ea.log=l,ea.assertNodeList=c,ea.setElement=f,ea.validateElement=h,ea.hide=p,ea.show=m,ea.documentNotReadyOrSSRTesting=g;var e=Nb(),n=r(e),t=tp();function r(v){return v&&v.__esModule?v:{default:v}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(v){return v.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(v){return v.removeAttribute("aria-hidden")})),a=null}function l(){}function c(v,w){if(!v||!v.length)throw new Error("react-modal: No elements were found for selector "+w+".")}function f(v){var w=v;if(typeof w=="string"&&t.canUseDOM){var b=document.querySelectorAll(w);c(b,w),w=b}return a=w||a,a}function h(v){var w=v||a;return w?Array.isArray(w)||w instanceof HTMLCollection||w instanceof NodeList?w:[w]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function p(v){var w=!0,b=!1,k=void 0;try{for(var N=h(v)[Symbol.iterator](),C;!(w=(C=N.next()).done);w=!0){var S=C.value;S.setAttribute("aria-hidden","true")}}catch(U){b=!0,k=U}finally{try{!w&&N.return&&N.return()}finally{if(b)throw k}}}function m(v){var w=!0,b=!1,k=void 0;try{for(var N=h(v)[Symbol.iterator](),C;!(w=(C=N.next()).done);w=!0){var S=C.value;S.removeAttribute("aria-hidden")}}catch(U){b=!0,k=U}finally{try{!w&&N.return&&N.return()}finally{if(b)throw k}}}function g(){a=null}return ea}var Zs={},Pm;function Tb(){if(Pm)return Zs;Pm=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.resetState=r,Zs.log=a;var e={},n={};function t(h,p){h.classList.remove(p)}function r(){var h=document.getElementsByTagName("html")[0];for(var p in e)t(h,e[p]);var m=document.body;for(var g in n)t(m,n[g]);e={},n={}}function a(){}var o=function(p,m){return p[m]||(p[m]=0),p[m]+=1,m},l=function(p,m){return p[m]&&(p[m]-=1),m},c=function(p,m,g){g.forEach(function(v){o(m,v),p.add(v)})},f=function(p,m,g){g.forEach(function(v){l(m,v),m[v]===0&&p.remove(v)})};return Zs.add=function(p,m){return c(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs.remove=function(p,m){return f(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs}var Go={},Am;function Bv(){if(Am)return Go;Am=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.log=r,Go.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return Go.default=t,Go}var tl={},Om;function Db(){if(Om)return tl;Om=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.resetState=l,tl.log=c;var e=Bv(),n=t(e);function t(p){return p&&p.__esModule?p:{default:p}}var r=void 0,a=void 0,o=[];function l(){for(var p=[r,a],m=0;m<p.length;m++){var g=p[m];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var p=[r,a],m=0;m<p.length;m++){var g=p[m],v=g||{};console.log(v.nodeName,v.className,v.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function h(p,m){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=m,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(h),tl}var Rm;function jb(){return Rm||(Rm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(de){for(var G=1;G<arguments.length;G++){var ie=arguments[G];for(var L in ie)Object.prototype.hasOwnProperty.call(ie,L)&&(de[L]=ie[L])}return de},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},a=(function(){function de(G,ie){for(var L=0;L<ie.length;L++){var ne=ie[L];ne.enumerable=ne.enumerable||!1,ne.configurable=!0,"value"in ne&&(ne.writable=!0),Object.defineProperty(G,ne.key,ne)}}return function(G,ie,L){return ie&&de(G.prototype,ie),L&&de(G,L),G}})(),o=Fl(),l=Mv(),c=te(l),f=Sb(),h=U(f),p=Eb(),m=te(p),g=Lv(),v=U(g),w=Tb(),b=U(w),k=tp(),N=te(k),C=Bv(),S=te(C);Db();function U(de){if(de&&de.__esModule)return de;var G={};if(de!=null)for(var ie in de)Object.prototype.hasOwnProperty.call(de,ie)&&(G[ie]=de[ie]);return G.default=de,G}function te(de){return de&&de.__esModule?de:{default:de}}function Q(de,G){if(!(de instanceof G))throw new TypeError("Cannot call a class as a function")}function D(de,G){if(!de)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return G&&(typeof G=="object"||typeof G=="function")?G:de}function K(de,G){if(typeof G!="function"&&G!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof G);de.prototype=Object.create(G&&G.prototype,{constructor:{value:de,enumerable:!1,writable:!0,configurable:!0}}),G&&(Object.setPrototypeOf?Object.setPrototypeOf(de,G):de.__proto__=G)}var W={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},oe=function(G){return G.code==="Tab"||G.keyCode===9},J=function(G){return G.code==="Escape"||G.keyCode===27},Y=0,pe=(function(de){K(G,de);function G(ie){Q(this,G);var L=D(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,ie));return L.setOverlayRef=function(ne){L.overlay=ne,L.props.overlayRef&&L.props.overlayRef(ne)},L.setContentRef=function(ne){L.content=ne,L.props.contentRef&&L.props.contentRef(ne)},L.afterClose=function(){var ne=L.props,O=ne.appElement,re=ne.ariaHideApp,M=ne.htmlOpenClassName,F=ne.bodyOpenClassName,le=ne.parentSelector,A=le&&le().ownerDocument||document;F&&b.remove(A.body,F),M&&b.remove(A.getElementsByTagName("html")[0],M),re&&Y>0&&(Y-=1,Y===0&&v.show(O)),L.props.shouldFocusAfterRender&&(L.props.shouldReturnFocusAfterClose?(h.returnFocus(L.props.preventScroll),h.teardownScopedFocus()):h.popWithoutFocus()),L.props.onAfterClose&&L.props.onAfterClose(),S.default.deregister(L)},L.open=function(){L.beforeOpen(),L.state.afterOpen&&L.state.beforeClose?(clearTimeout(L.closeTimer),L.setState({beforeClose:!1})):(L.props.shouldFocusAfterRender&&(h.setupScopedFocus(L.node),h.markForFocusLater()),L.setState({isOpen:!0},function(){L.openAnimationFrame=requestAnimationFrame(function(){L.setState({afterOpen:!0}),L.props.isOpen&&L.props.onAfterOpen&&L.props.onAfterOpen({overlayEl:L.overlay,contentEl:L.content})})}))},L.close=function(){L.props.closeTimeoutMS>0?L.closeWithTimeout():L.closeWithoutTimeout()},L.focusContent=function(){return L.content&&!L.contentHasFocus()&&L.content.focus({preventScroll:!0})},L.closeWithTimeout=function(){var ne=Date.now()+L.props.closeTimeoutMS;L.setState({beforeClose:!0,closesAt:ne},function(){L.closeTimer=setTimeout(L.closeWithoutTimeout,L.state.closesAt-Date.now())})},L.closeWithoutTimeout=function(){L.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},L.afterClose)},L.handleKeyDown=function(ne){oe(ne)&&(0,m.default)(L.content,ne),L.props.shouldCloseOnEsc&&J(ne)&&(ne.stopPropagation(),L.requestClose(ne))},L.handleOverlayOnClick=function(ne){L.shouldClose===null&&(L.shouldClose=!0),L.shouldClose&&L.props.shouldCloseOnOverlayClick&&(L.ownerHandlesClose()?L.requestClose(ne):L.focusContent()),L.shouldClose=null},L.handleContentOnMouseUp=function(){L.shouldClose=!1},L.handleOverlayOnMouseDown=function(ne){!L.props.shouldCloseOnOverlayClick&&ne.target==L.overlay&&ne.preventDefault()},L.handleContentOnClick=function(){L.shouldClose=!1},L.handleContentOnMouseDown=function(){L.shouldClose=!1},L.requestClose=function(ne){return L.ownerHandlesClose()&&L.props.onRequestClose(ne)},L.ownerHandlesClose=function(){return L.props.onRequestClose},L.shouldBeClosed=function(){return!L.state.isOpen&&!L.state.beforeClose},L.contentHasFocus=function(){return document.activeElement===L.content||L.content.contains(document.activeElement)},L.buildClassName=function(ne,O){var re=(typeof O>"u"?"undefined":r(O))==="object"?O:{base:W[ne],afterOpen:W[ne]+"--after-open",beforeClose:W[ne]+"--before-close"},M=re.base;return L.state.afterOpen&&(M=M+" "+re.afterOpen),L.state.beforeClose&&(M=M+" "+re.beforeClose),typeof O=="string"&&O?M+" "+O:M},L.attributesFromObject=function(ne,O){return Object.keys(O).reduce(function(re,M){return re[ne+"-"+M]=O[M],re},{})},L.state={afterOpen:!1,beforeClose:!1},L.shouldClose=null,L.moveFromContentToOverlay=null,L}return a(G,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(L,ne){this.props.isOpen&&!L.isOpen?this.open():!this.props.isOpen&&L.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!ne.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var L=this.props,ne=L.appElement,O=L.ariaHideApp,re=L.htmlOpenClassName,M=L.bodyOpenClassName,F=L.parentSelector,le=F&&F().ownerDocument||document;M&&b.add(le.body,M),re&&b.add(le.getElementsByTagName("html")[0],re),O&&(Y+=1,v.hide(ne)),S.default.register(this)}},{key:"render",value:function(){var L=this.props,ne=L.id,O=L.className,re=L.overlayClassName,M=L.defaultStyles,F=L.children,le=O?{}:M.content,A=re?{}:M.overlay;if(this.shouldBeClosed())return null;var T={ref:this.setOverlayRef,className:this.buildClassName("overlay",re),style:t({},A,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},j=t({id:ne,ref:this.setContentRef,style:t({},le,this.props.style.content),className:this.buildClassName("content",O),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),R=this.props.contentElement(j,F);return this.props.overlayElement(T,R)}}]),G})(o.Component);pe.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},pe.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(N.default),c.default.instanceOf(k.SafeHTMLCollection),c.default.instanceOf(k.SafeNodeList),c.default.arrayOf(c.default.instanceOf(N.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=pe,e.exports=n.default})(Xc,Xc.exports)),Xc.exports}function Wv(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Uv(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function $v(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}Wv.__suppressDeprecationWarning=!0;Uv.__suppressDeprecationWarning=!0;$v.__suppressDeprecationWarning=!0;function Fb(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=Wv,n.componentWillReceiveProps=Uv),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=$v;var c=n.componentDidUpdate;n.componentDidUpdate=function(h,p,m){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:m;c.call(this,h,p,g)}}return e}const Pb=Object.freeze(Object.defineProperty({__proto__:null,polyfill:Fb},Symbol.toStringTag,{value:"Module"})),Ab=ob(Pb);var zm;function Ob(){if(zm)return bs;zm=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.bodyOpenClassName=bs.portalClassName=void 0;var e=Object.assign||function(J){for(var Y=1;Y<arguments.length;Y++){var pe=arguments[Y];for(var de in pe)Object.prototype.hasOwnProperty.call(pe,de)&&(J[de]=pe[de])}return J},n=(function(){function J(Y,pe){for(var de=0;de<pe.length;de++){var G=pe[de];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(Y,G.key,G)}}return function(Y,pe,de){return pe&&J(Y.prototype,pe),de&&J(Y,de),Y}})(),t=Fl(),r=k(t),a=Xf(),o=k(a),l=Mv(),c=k(l),f=jb(),h=k(f),p=Lv(),m=b(p),g=tp(),v=k(g),w=Ab;function b(J){if(J&&J.__esModule)return J;var Y={};if(J!=null)for(var pe in J)Object.prototype.hasOwnProperty.call(J,pe)&&(Y[pe]=J[pe]);return Y.default=J,Y}function k(J){return J&&J.__esModule?J:{default:J}}function N(J,Y){if(!(J instanceof Y))throw new TypeError("Cannot call a class as a function")}function C(J,Y){if(!J)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y&&(typeof Y=="object"||typeof Y=="function")?Y:J}function S(J,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Y);J.prototype=Object.create(Y&&Y.prototype,{constructor:{value:J,enumerable:!1,writable:!0,configurable:!0}}),Y&&(Object.setPrototypeOf?Object.setPrototypeOf(J,Y):J.__proto__=Y)}var U=bs.portalClassName="ReactModalPortal",te=bs.bodyOpenClassName="ReactModal__Body--open",Q=g.canUseDOM&&o.default.createPortal!==void 0,D=function(Y){return document.createElement(Y)},K=function(){return Q?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function W(J){return J()}var oe=(function(J){S(Y,J);function Y(){var pe,de,G,ie;N(this,Y);for(var L=arguments.length,ne=Array(L),O=0;O<L;O++)ne[O]=arguments[O];return ie=(de=(G=C(this,(pe=Y.__proto__||Object.getPrototypeOf(Y)).call.apply(pe,[this].concat(ne))),G),G.removePortal=function(){!Q&&o.default.unmountComponentAtNode(G.node);var re=W(G.props.parentSelector);re&&re.contains(G.node)?re.removeChild(G.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},G.portalRef=function(re){G.portal=re},G.renderPortal=function(re){var M=K(),F=M(G,r.default.createElement(h.default,e({defaultStyles:Y.defaultStyles},re)),G.node);G.portalRef(F)},de),C(G,ie)}return n(Y,[{key:"componentDidMount",value:function(){if(g.canUseDOM){Q||(this.node=D("div")),this.node.className=this.props.portalClassName;var de=W(this.props.parentSelector);de.appendChild(this.node),!Q&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(de){var G=W(de.parentSelector),ie=W(this.props.parentSelector);return{prevParent:G,nextParent:ie}}},{key:"componentDidUpdate",value:function(de,G,ie){if(g.canUseDOM){var L=this.props,ne=L.isOpen,O=L.portalClassName;de.portalClassName!==O&&(this.node.className=O);var re=ie.prevParent,M=ie.nextParent;M!==re&&(re.removeChild(this.node),M.appendChild(this.node)),!(!de.isOpen&&!ne)&&!Q&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var de=this.portal.state,G=Date.now(),ie=de.isOpen&&this.props.closeTimeoutMS&&(de.closesAt||G+this.props.closeTimeoutMS);ie?(de.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,ie-G)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!Q)return null;!this.node&&Q&&(this.node=D("div"));var de=K();return de(r.default.createElement(h.default,e({ref:this.portalRef,defaultStyles:Y.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(de){m.setElement(de)}}]),Y})(t.Component);return oe.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(v.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(v.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},oe.defaultProps={isOpen:!1,portalClassName:U,bodyOpenClassName:te,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(Y,pe){return r.default.createElement("div",Y,pe)},contentElement:function(Y,pe){return r.default.createElement("div",Y,pe)}},oe.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,w.polyfill)(oe),bs.default=oe,bs}var Mm;function Rb(){return Mm||(Mm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ob(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Qc,Qc.exports)),Qc.exports}var zb=Rb();const rr=Gu(zb);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Hv=1252,Mb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},np=function(e){Mb.indexOf(e)!=-1&&(Hv=rp[0]=e)};function Ib(){np(1252)}var aa=function(e){np(e)};function Yv(){aa(1200),Ib()}function Im(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function Lb(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Vv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var al=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?Lb(e.slice(2)):n==254&&t==255?Vv(e.slice(2)):n==65279?e.slice(1):e},Jc=function(n){return String.fromCharCode(n)},Lm=function(n){return String.fromCharCode(n)},wl,Cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bm(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,r=e.charCodeAt(h++),l=(t&3)<<4|r>>4,a=e.charCodeAt(h++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=Cs.charAt(o)+Cs.charAt(l)+Cs.charAt(c)+Cs.charAt(f);return n}function Tn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=Cs.indexOf(e.charAt(h++)),l=Cs.indexOf(e.charAt(h++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=Cs.indexOf(e.charAt(h++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=Cs.indexOf(e.charAt(h++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),vo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function As(e){return Tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Wm(e){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var na=function(n){return Tt?vo(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function yo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function ap(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ap(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var Es=Tt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:vo(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Bb(e){for(var n=[],t=0,r=e.length+250,a=As(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=As(65535),r=65530)}return n.push(a.slice(0,t)),Es(n)}var dn=/\u0000/g,sl=/[\u0001-\u0006]/g;function ri(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function sa(e,n){var t=""+e;return t.length>=n?t:dr("0",n-t.length)+t}function sp(e,n){var t=""+e;return t.length>=n?t:dr(" ",n-t.length)+t}function _u(e,n){var t=""+e;return t.length>=n?t:t+dr(" ",n-t.length)}function Wb(e,n){var t=""+Math.round(e);return t.length>=n?t:dr("0",n-t.length)+t}function Ub(e,n){var t=""+e;return t.length>=n?t:dr("0",n-t.length)+t}var Um=Math.pow(2,32);function Qo(e,n){if(e>Um||e<-Um)return Wb(e,n);var t=Math.round(e);return Ub(t,n)}function Su(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var $m=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],q0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $b(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var bt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Hm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Hb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Eu(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,h=0,p=0,m=Math.floor(a);h<n&&(m=Math.floor(a),c=m*l+o,p=m*h+f,!(a-m<5e-8));)a=1/(a-m),o=l,l=c,f=h,h=p;if(p>n&&(h>n?(p=f,c=o):(p=h,c=l)),!t)return[0,r*c,p];var g=Math.floor(r*c/p);return[g,r*c-g*p,p]}function to(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=Xb(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var Kv=new Date(1899,11,31,0,0,0),Yb=Kv.getTime(),Vb=new Date(1900,2,1,0,0,0);function Gv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=Vb&&(t+=1440*60*1e3),(t-(Yb+(e.getTimezoneOffset()-Kv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function op(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Kb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Gb(e){var n=e<0?12:11,t=op(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function Qb(e){var n=op(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function kl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=Gb(e):n===10?t=e.toFixed(10).substr(0,12):t=Qb(e),op(Kb(t.toUpperCase()))}function uo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):kl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Yn(14,Gv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function Xb(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function qb(e,n,t,r){var a="",o=0,l=0,c=t.y,f,h=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,h=n.length;break;case 3:return q0[t.m-1][1];case 5:return q0[t.m-1][0];default:return q0[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,h=n.length;break;case 3:return $m[t.q][0];default:return $m[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?sa(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=sa(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:f=c,h=1;break}var p=h>0?sa(f,h):"";return p}function Ts(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Qv=/%/g;function Zb(e,n,t){var r=n.replace(Qv,""),a=n.length-r.length;return Va(e,r,t*Math.pow(10,2*a))+dr("%",a)}function Jb(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Va(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Xv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Xv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var qv=/# (\?+)( ?)\/( ?)(\d+)/;function e2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?dr(" ",e[1].length+1+e[4].length):sp(l,e[1].length)+e[2]+"/"+e[3]+sa(c,e[4].length))}function t2(e,n,t){return t+(n===0?"":""+n)+dr(" ",e[1].length+2+e[4].length)}var Zv=/^#*0*\.([0#]+)/,Jv=/\).*[0#]/,e1=/\(###\) ###\\?-####/;function nn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Ym(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Vm(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function r2(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function n2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ln(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Jv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ln("n",r,t):"("+Ln("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return Jb(e,n,t);if(n.indexOf("%")!==-1)return Zb(e,n,t);if(n.indexOf("E")!==-1)return Xv(n,t);if(n.charCodeAt(0)===36)return"$"+Ln(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+Qo(f,n.length);if(n.match(/^[#?]+$/))return a=Qo(t,0),a==="0"&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(qv))return e2(o,f,h);if(n.match(/^#+0+$/))return h+Qo(f,n.length-n.indexOf("0"));if(o=n.match(Zv))return a=Ym(t,o[1].length).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+dr("0",nn(o[1]).length-b.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+Ym(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Ts(Qo(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ln(e,n,-t):Ts(""+(Math.floor(t)+r2(t,o[1].length)))+"."+sa(Vm(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return Ln(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(Ln(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(n.match(e1))return a=Ln(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Eu(f,Math.pow(10,l)-1,!1),a=""+h,p=Va("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=_u(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Eu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+_u(c[2],l):dr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=Qo(t,0),n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Vm(t,o[1].length),t<0?"-"+Ln(e,n,-t):Ts(n2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?sa(0,3-w.length):"")+w})+"."+sa(l,o[1].length);switch(n){case"###,##0.00":return Ln(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var v=Ts(Qo(f,0));return v!=="0"?h+v:"";case"###,###.00":return Ln(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ln(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function a2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Va(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function s2(e,n,t){var r=n.replace(Qv,""),a=n.length-r.length;return Va(e,r,t*Math.pow(10,2*a))+dr("%",a)}function t1(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+t1(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function va(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Jv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?va("n",r,t):"("+va("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return a2(e,n,t);if(n.indexOf("%")!==-1)return s2(e,n,t);if(n.indexOf("E")!==-1)return t1(n,t);if(n.charCodeAt(0)===36)return"$"+va(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+sa(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(qv))return t2(o,f,h);if(n.match(/^#+0+$/))return h+sa(f,n.length-n.indexOf("0"));if(o=n.match(Zv))return a=(""+t).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])),a=a.replace(/\.(\d*)$/,function(w,b){return"."+b+dr("0",nn(o[1]).length-b.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Ts(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+va(e,n,-t):Ts(""+t)+"."+dr("0",o[1].length);if(o=n.match(/^#,#*,#0/))return va(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(va(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(n.match(e1))return a=va(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Eu(f,Math.pow(10,l)-1,!1),a=""+h,p=Va("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=_u(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Eu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+_u(c[2],l):dr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+va(e,n,-t):Ts(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?sa(0,3-w.length):"")+w})+"."+sa(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var v=Ts(""+f);return v!=="0"?h+v:"";default:if(n.match(/\.[0#?]*$/))return va(e,n.slice(0,n.lastIndexOf(".")),t)+nn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Va(e,n,t){return(t|0)===t?va(e,n,t):Ln(e,n,t)}function o2(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var r1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mi(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":Su(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(r1))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function i2(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",h,p,m,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!Su(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(m=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(m);a[a.length]={t:"t",v:o},++l;break;case"\\":var v=e.charAt(++l),w=v==="("||v===")"?v:"t";a[a.length]={t:w,v},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=to(n,t,e.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=to(n,t),h==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"":var b={t:c,v:c};if(h==null&&(h=to(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(b.v=h.H>=12?"P":"A"),b.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(b.v=h.H>=12?"PM":"AM"),b.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="/"?(h!=null&&(b.v=h.H>=12?"":""),b.t="T",l+=5,g="h"):(b.t="t",++l),h==null&&b.t==="T")return"";a[a.length]=b,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(r1)){if(h==null&&(h=to(n,t),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",mi(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var k=0,N=0,C;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",k<1&&(k=1);break;case"s":(C=a[l].v.match(/\.0+$/))&&(N=Math.max(N,C[0].length-1)),k<3&&(k=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",k<2&&(k=2));break;case"X":break;case"Z":k<1&&a[l].v.match(/[Hh]/)&&(k=1),k<2&&a[l].v.match(/[Mm]/)&&(k=2),k<3&&a[l].v.match(/[Ss]/)&&(k=3)}switch(k){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var S="",U;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=qb(a[l].t.charCodeAt(0),a[l].v,h,N),a[l].t="t";break;case"n":case"?":for(U=l+1;a[U]!=null&&((c=a[U].t)==="?"||c==="D"||(c===" "||c==="t")&&a[U+1]!=null&&(a[U+1].t==="?"||a[U+1].t==="t"&&a[U+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[U].v==="/"||a[U].v===" "&&a[U+1]!=null&&a[U+1].t=="?"));)a[l].v+=a[U].v,a[U]={v:"",t:";"},++U;S+=a[l].v,l=U-1;break;case"G":a[l].t="t",a[l].v=uo(n,t);break}var te="",Q,D;if(S.length>0){S.charCodeAt(0)==40?(Q=n<0&&S.charCodeAt(0)===45?-n:n,D=Va("n",S,Q)):(Q=n<0&&r>1?-n:n,D=Va("n",S,Q),Q<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),U=D.length-1;var K=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){K=l;break}var W=a.length;if(K===a.length&&D.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(U>=a[l].v.length-1?(U-=a[l].v.length,a[l].v=D.substr(U+1,a[l].v.length)):U<0?a[l].v="":(a[l].v=D.substr(0,U+1),U=-1),a[l].t="t",W=l);U>=0&&W<a.length&&(a[W].v=D.substr(0,U+1)+a[W].v)}else if(K!==a.length&&D.indexOf("E")===-1){for(U=D.indexOf(".")-1,l=K;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")-1:a[l].v.length-1,te=a[l].v.substr(p+1);p>=0;--p)U>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(te=D.charAt(U--)+te);a[l].v=te,a[l].t="t",W=l}for(U>=0&&W<a.length&&(a[W].v=D.substr(0,U+1)+a[W].v),U=D.indexOf(".")+1,l=K;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==K)){for(p=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")+1:0,te=a[l].v.substr(0,p);p<a[l].v.length;++p)U<D.length&&(te+=D.charAt(U++));a[l].v=te,a[l].t="t",W=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(Q=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=Va(a[l].t,a[l].v,Q),a[l].t="t");var oe="";for(l=0;l!==a.length;++l)a[l]!=null&&(oe+=a[l].v);return oe}var Km=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gm(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function l2(e,n){var t=o2(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Km),c=t[1].match(Km);return Gm(n,l)?[r,t[0]]:Gm(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Yn(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:bt)[e],r==null&&(r=t.table&&t.table[Hm[e]]||bt[Hm[e]]),r==null&&(r=Hb[e]||"General");break}if(Su(r,0))return uo(n,t);n instanceof Date&&(n=Gv(n,t.date1904));var a=l2(r,n);if(Su(a[1]))return uo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return i2(a[1],n,t,a[0])}function ao(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(bt[t]==null){n<0&&(n=t);continue}if(bt[t]==e){n=t;break}}n<0&&(n=391)}return bt[n]=e,n}function n1(){bt=$b()}var c2={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},a1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function u2(e){var n=typeof e=="number"?bt[e]:e;return n=n.replace(a1,"(\\d+)"),new RegExp("^"+n+"$")}function d2(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(a1)||[]).forEach(function(m,g){var v=parseInt(t[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=v;break;case"d":o=v;break;case"h":l=v;break;case"s":f=v;break;case"m":l>=0?c=v:a=v;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?h:r==-1&&a==-1&&o==-1?p:h+"T"+p}var f2=(function(){var e={};e.version="1.2.0";function n(){for(var D=0,K=new Array(256),W=0;W!=256;++W)D=W,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,K[W]=D;return typeof Int32Array<"u"?new Int32Array(K):K}var t=n();function r(D){var K=0,W=0,oe=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(oe=0;oe!=256;++oe)J[oe]=D[oe];for(oe=0;oe!=256;++oe)for(W=D[oe],K=256+oe;K<4096;K+=256)W=J[K]=W>>>8^D[W&255];var Y=[];for(oe=1;oe!=16;++oe)Y[oe-1]=typeof Int32Array<"u"?J.subarray(oe*256,oe*256+256):J.slice(oe*256,oe*256+256);return Y}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],h=a[4],p=a[5],m=a[6],g=a[7],v=a[8],w=a[9],b=a[10],k=a[11],N=a[12],C=a[13],S=a[14];function U(D,K){for(var W=K^-1,oe=0,J=D.length;oe<J;)W=W>>>8^t[(W^D.charCodeAt(oe++))&255];return~W}function te(D,K){for(var W=K^-1,oe=D.length-15,J=0;J<oe;)W=S[D[J++]^W&255]^C[D[J++]^W>>8&255]^N[D[J++]^W>>16&255]^k[D[J++]^W>>>24]^b[D[J++]]^w[D[J++]]^v[D[J++]]^g[D[J++]]^m[D[J++]]^p[D[J++]]^h[D[J++]]^f[D[J++]]^c[D[J++]]^l[D[J++]]^o[D[J++]]^t[D[J++]];for(oe+=15;J<oe;)W=W>>>8^t[(W^D[J++])&255];return~W}function Q(D,K){for(var W=K^-1,oe=0,J=D.length,Y=0,pe=0;oe<J;)Y=D.charCodeAt(oe++),Y<128?W=W>>>8^t[(W^Y)&255]:Y<2048?(W=W>>>8^t[(W^(192|Y>>6&31))&255],W=W>>>8^t[(W^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,pe=D.charCodeAt(oe++)&1023,W=W>>>8^t[(W^(240|Y>>8&7))&255],W=W>>>8^t[(W^(128|Y>>2&63))&255],W=W>>>8^t[(W^(128|pe>>6&15|(Y&3)<<4))&255],W=W>>>8^t[(W^(128|pe&63))&255]):(W=W>>>8^t[(W^(224|Y>>12&15))&255],W=W>>>8^t[(W^(128|Y>>6&63))&255],W=W>>>8^t[(W^(128|Y&63))&255]);return~W}return e.table=t,e.bstr=U,e.buf=te,e.str=Q,e})(),Dt=(function(){var n={};n.version="1.2.1";function t(P,ee){for(var V=P.split("/"),X=ee.split("/"),Z=0,ae=0,_e=Math.min(V.length,X.length);Z<_e;++Z){if(ae=V[Z].length-X[Z].length)return ae;if(V[Z]!=X[Z])return V[Z]<X[Z]?-1:1}return V.length-X.length}function r(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:r(P.slice(0,-1));var ee=P.lastIndexOf("/");return ee===-1?P:P.slice(0,ee+1)}function a(P){if(P.charAt(P.length-1)=="/")return a(P.slice(0,-1));var ee=P.lastIndexOf("/");return ee===-1?P:P.slice(ee+1)}function o(P,ee){typeof ee=="string"&&(ee=new Date(ee));var V=ee.getHours();V=V<<6|ee.getMinutes(),V=V<<5|ee.getSeconds()>>>1,P.write_shift(2,V);var X=ee.getFullYear()-1980;X=X<<4|ee.getMonth()+1,X=X<<5|ee.getDate(),P.write_shift(2,X)}function l(P){var ee=P.read_shift(2)&65535,V=P.read_shift(2)&65535,X=new Date,Z=V&31;V>>>=5;var ae=V&15;V>>>=4,X.setMilliseconds(0),X.setFullYear(V+1980),X.setMonth(ae-1),X.setDate(Z);var _e=ee&31;ee>>>=5;var je=ee&63;return ee>>>=6,X.setHours(ee),X.setMinutes(je),X.setSeconds(_e<<1),X}function c(P){Ir(P,0);for(var ee={},V=0;P.l<=P.length-4;){var X=P.read_shift(2),Z=P.read_shift(2),ae=P.l+Z,_e={};switch(X){case 21589:V=P.read_shift(1),V&1&&(_e.mtime=P.read_shift(4)),Z>5&&(V&2&&(_e.atime=P.read_shift(4)),V&4&&(_e.ctime=P.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}P.l=ae,ee[X]=_e}return ee}var f;function h(){return f||(f={})}function p(P,ee){if(P[0]==80&&P[1]==75)return ze(P,ee);if((P[0]|32)==109&&(P[1]|32)==105)return mt(P,ee);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var V=3,X=512,Z=0,ae=0,_e=0,je=0,be=0,Ee=[],Ne=P.slice(0,512);Ir(Ne,0);var Be=m(Ne);switch(V=Be[0],V){case 3:X=512;break;case 4:X=4096;break;case 0:if(Be[1]==0)return ze(P,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}X!==512&&(Ne=P.slice(0,X),Ir(Ne,28));var Xe=P.slice(0,X);g(Ne,V);var We=Ne.read_shift(4,"i");if(V===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);Ne.l+=4,_e=Ne.read_shift(4,"i"),Ne.l+=4,Ne.chk("00100000","Mini Stream Cutoff Size: "),je=Ne.read_shift(4,"i"),Z=Ne.read_shift(4,"i"),be=Ne.read_shift(4,"i"),ae=Ne.read_shift(4,"i");for(var Ue=-1,Ye=0;Ye<109&&(Ue=Ne.read_shift(4,"i"),!(Ue<0));++Ye)Ee[Ye]=Ue;var xt=v(P,X);k(be,ae,xt,X,Ee);var Ht=C(xt,_e,Ee,X);Ht[_e].name="!Directory",Z>0&&je!==pe&&(Ht[je].name="!MiniFAT"),Ht[Ee[0]].name="!FAT",Ht.fat_addrs=Ee,Ht.ssz=X;var Wt={},hr=[],Ls=[],rs=[];S(_e,Ht,xt,hr,Z,Wt,Ls,je),w(Ls,rs,hr),hr.shift();var da={FileIndex:Ls,FullPaths:rs};return ee&&ee.raw&&(da.raw={header:Xe,sectors:xt}),da}function m(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(de,"Header Signature: "),P.l+=16;var ee=P.read_shift(2,"u");return[P.read_shift(2,"u"),ee]}function g(P,ee){var V=9;switch(P.l+=2,V=P.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function v(P,ee){for(var V=Math.ceil(P.length/ee)-1,X=[],Z=1;Z<V;++Z)X[Z-1]=P.slice(Z*ee,(Z+1)*ee);return X[V-1]=P.slice(V*ee),X}function w(P,ee,V){for(var X=0,Z=0,ae=0,_e=0,je=0,be=V.length,Ee=[],Ne=[];X<be;++X)Ee[X]=Ne[X]=X,ee[X]=V[X];for(;je<Ne.length;++je)X=Ne[je],Z=P[X].L,ae=P[X].R,_e=P[X].C,Ee[X]===X&&(Z!==-1&&Ee[Z]!==Z&&(Ee[X]=Ee[Z]),ae!==-1&&Ee[ae]!==ae&&(Ee[X]=Ee[ae])),_e!==-1&&(Ee[_e]=X),Z!==-1&&X!=Ee[X]&&(Ee[Z]=Ee[X],Ne.lastIndexOf(Z)<je&&Ne.push(Z)),ae!==-1&&X!=Ee[X]&&(Ee[ae]=Ee[X],Ne.lastIndexOf(ae)<je&&Ne.push(ae));for(X=1;X<be;++X)Ee[X]===X&&(ae!==-1&&Ee[ae]!==ae?Ee[X]=Ee[ae]:Z!==-1&&Ee[Z]!==Z&&(Ee[X]=Ee[Z]));for(X=1;X<be;++X)if(P[X].type!==0){if(je=X,je!=Ee[je])do je=Ee[je],ee[X]=ee[je]+"/"+ee[X];while(je!==0&&Ee[je]!==-1&&je!=Ee[je]);Ee[X]=-1}for(ee[0]+="/",X=1;X<be;++X)P[X].type!==2&&(ee[X]+="/")}function b(P,ee,V){for(var X=P.start,Z=P.size,ae=[],_e=X;V&&Z>0&&_e>=0;)ae.push(ee.slice(_e*Y,_e*Y+Y)),Z-=Y,_e=eo(V,_e*4);return ae.length===0?Nr(0):Es(ae).slice(0,P.size)}function k(P,ee,V,X,Z){var ae=pe;if(P===pe){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var _e=V[P],je=(X>>>2)-1;if(!_e)return;for(var be=0;be<je&&(ae=eo(_e,be*4))!==pe;++be)Z.push(ae);k(eo(_e,X-4),ee-1,V,X,Z)}}function N(P,ee,V,X,Z){var ae=[],_e=[];Z||(Z=[]);var je=X-1,be=0,Ee=0;for(be=ee;be>=0;){Z[be]=!0,ae[ae.length]=be,_e.push(P[be]);var Ne=V[Math.floor(be*4/X)];if(Ee=be*4&je,X<4+Ee)throw new Error("FAT boundary crossed: "+be+" 4 "+X);if(!P[Ne])break;be=eo(P[Ne],Ee)}return{nodes:ae,data:ag([_e])}}function C(P,ee,V,X){var Z=P.length,ae=[],_e=[],je=[],be=[],Ee=X-1,Ne=0,Be=0,Xe=0,We=0;for(Ne=0;Ne<Z;++Ne)if(je=[],Xe=Ne+ee,Xe>=Z&&(Xe-=Z),!_e[Xe]){be=[];var Ue=[];for(Be=Xe;Be>=0;){Ue[Be]=!0,_e[Be]=!0,je[je.length]=Be,be.push(P[Be]);var Ye=V[Math.floor(Be*4/X)];if(We=Be*4&Ee,X<4+We)throw new Error("FAT boundary crossed: "+Be+" 4 "+X);if(!P[Ye]||(Be=eo(P[Ye],We),Ue[Be]))break}ae[Xe]={nodes:je,data:ag([be])}}return ae}function S(P,ee,V,X,Z,ae,_e,je){for(var be=0,Ee=X.length?2:0,Ne=ee[P].data,Be=0,Xe=0,We;Be<Ne.length;Be+=128){var Ue=Ne.slice(Be,Be+128);Ir(Ue,64),Xe=Ue.read_shift(2),We=dp(Ue,0,Xe-Ee),X.push(We);var Ye={name:We,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},xt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);xt!==0&&(Ye.ct=U(Ue,Ue.l-8));var Ht=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Ht!==0&&(Ye.mt=U(Ue,Ue.l-8)),Ye.start=Ue.read_shift(4,"i"),Ye.size=Ue.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=pe,Ye.name=""),Ye.type===5?(be=Ye.start,Z>0&&be!==pe&&(ee[be].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",ee[Ye.start]===void 0&&(ee[Ye.start]=N(V,Ye.start,ee.fat_addrs,ee.ssz)),ee[Ye.start].name=Ye.name,Ye.content=ee[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:be!==pe&&Ye.start!==pe&&ee[be]&&(Ye.content=b(Ye,ee[be].data,(ee[je]||{}).data))),Ye.content&&Ir(Ye.content,0),ae[We]=Ye,_e.push(Ye)}}function U(P,ee){return new Date((En(P,ee+4)/1e7*Math.pow(2,32)+En(P,ee)/1e7-11644473600)*1e3)}function te(P,ee){return h(),p(f.readFileSync(P),ee)}function Q(P,ee){var V=ee&&ee.type;switch(V||Tt&&Buffer.isBuffer(P)&&(V="buffer"),V||"base64"){case"file":return te(P,ee);case"base64":return p(na(Tn(P)),ee);case"binary":return p(na(P),ee)}return p(P,ee)}function D(P,ee){var V=ee||{},X=V.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=X+"/",P.FileIndex[0]={name:X,type:5}),V.CLSID&&(P.FileIndex[0].clsid=V.CLSID),K(P)}function K(P){var ee="Sh33tJ5";if(!Dt.find(P,"/"+ee)){var V=Nr(4);V[0]=55,V[1]=V[3]=50,V[2]=54,P.FileIndex.push({name:ee,type:2,content:V,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+ee),W(P)}}function W(P,ee){D(P);for(var V=!1,X=!1,Z=P.FullPaths.length-1;Z>=0;--Z){var ae=P.FileIndex[Z];switch(ae.type){case 0:X?V=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(ae.R*ae.L*ae.C)&&(V=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!ee)){var _e=new Date(1987,1,19),je=0,be=Object.create?Object.create(null):{},Ee=[];for(Z=0;Z<P.FullPaths.length;++Z)be[P.FullPaths[Z]]=!0,P.FileIndex[Z].type!==0&&Ee.push([P.FullPaths[Z],P.FileIndex[Z]]);for(Z=0;Z<Ee.length;++Z){var Ne=r(Ee[Z][0]);X=be[Ne],X||(Ee.push([Ne,{name:a(Ne).replace("/",""),type:1,clsid:ie,ct:_e,mt:_e,content:null}]),be[Ne]=!0)}for(Ee.sort(function(We,Ue){return t(We[0],Ue[0])}),P.FullPaths=[],P.FileIndex=[],Z=0;Z<Ee.length;++Z)P.FullPaths[Z]=Ee[Z][0],P.FileIndex[Z]=Ee[Z][1];for(Z=0;Z<Ee.length;++Z){var Be=P.FileIndex[Z],Xe=P.FullPaths[Z];if(Be.name=a(Xe).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||ie,Z===0)Be.C=Ee.length>1?1:-1,Be.size=0,Be.type=5;else if(Xe.slice(-1)=="/"){for(je=Z+1;je<Ee.length&&r(P.FullPaths[je])!=Xe;++je);for(Be.C=je>=Ee.length?-1:je,je=Z+1;je<Ee.length&&r(P.FullPaths[je])!=r(Xe);++je);Be.R=je>=Ee.length?-1:je,Be.type=1}else r(P.FullPaths[Z+1]||"")==r(Xe)&&(Be.R=Z+1),Be.type=2}}}function oe(P,ee){var V=ee||{};if(V.fileType=="mad")return Mt(P,V);switch(W(P),V.fileType){case"zip":return rt(P,V)}var X=(function(We){for(var Ue=0,Ye=0,xt=0;xt<We.FileIndex.length;++xt){var Ht=We.FileIndex[xt];if(Ht.content){var Wt=Ht.content.length;Wt>0&&(Wt<4096?Ue+=Wt+63>>6:Ye+=Wt+511>>9)}}for(var hr=We.FullPaths.length+3>>2,Ls=Ue+7>>3,rs=Ue+127>>7,da=Ls+Ye+hr+rs,Dr=da+127>>7,wi=Dr<=109?0:Math.ceil((Dr-109)/127);da+Dr+wi+127>>7>Dr;)wi=++Dr<=109?0:Math.ceil((Dr-109)/127);var xr=[1,wi,Dr,rs,hr,Ye,Ue,0];return We.FileIndex[0].size=Ue<<6,xr[7]=(We.FileIndex[0].start=xr[0]+xr[1]+xr[2]+xr[3]+xr[4]+xr[5])+(xr[6]+7>>3),xr})(P),Z=Nr(X[7]<<9),ae=0,_e=0;{for(ae=0;ae<8;++ae)Z.write_shift(1,G[ae]);for(ae=0;ae<8;++ae)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),ae=0;ae<3;++ae)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,X[2]),Z.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:pe),Z.write_shift(4,X[3]),Z.write_shift(-4,X[1]?X[0]-1:pe),Z.write_shift(4,X[1]),ae=0;ae<109;++ae)Z.write_shift(-4,ae<X[2]?X[1]+ae:-1)}if(X[1])for(_e=0;_e<X[1];++_e){for(;ae<236+_e*127;++ae)Z.write_shift(-4,ae<X[2]?X[1]+ae:-1);Z.write_shift(-4,_e===X[1]-1?pe:_e+1)}var je=function(We){for(_e+=We;ae<_e-1;++ae)Z.write_shift(-4,ae+1);We&&(++ae,Z.write_shift(-4,pe))};for(_e=ae=0,_e+=X[1];ae<_e;++ae)Z.write_shift(-4,L.DIFSECT);for(_e+=X[2];ae<_e;++ae)Z.write_shift(-4,L.FATSECT);je(X[3]),je(X[4]);for(var be=0,Ee=0,Ne=P.FileIndex[0];be<P.FileIndex.length;++be)Ne=P.FileIndex[be],Ne.content&&(Ee=Ne.content.length,!(Ee<4096)&&(Ne.start=_e,je(Ee+511>>9)));for(je(X[6]+7>>3);Z.l&511;)Z.write_shift(-4,L.ENDOFCHAIN);for(_e=ae=0,be=0;be<P.FileIndex.length;++be)Ne=P.FileIndex[be],Ne.content&&(Ee=Ne.content.length,!(!Ee||Ee>=4096)&&(Ne.start=_e,je(Ee+63>>6)));for(;Z.l&511;)Z.write_shift(-4,L.ENDOFCHAIN);for(ae=0;ae<X[4]<<2;++ae){var Be=P.FullPaths[ae];if(!Be||Be.length===0){for(be=0;be<17;++be)Z.write_shift(4,0);for(be=0;be<3;++be)Z.write_shift(4,-1);for(be=0;be<12;++be)Z.write_shift(4,0);continue}Ne=P.FileIndex[ae],ae===0&&(Ne.start=Ne.size?Ne.start-1:pe);var Xe=ae===0&&V.root||Ne.name;if(Ee=2*(Xe.length+1),Z.write_shift(64,Xe,"utf16le"),Z.write_shift(2,Ee),Z.write_shift(1,Ne.type),Z.write_shift(1,Ne.color),Z.write_shift(-4,Ne.L),Z.write_shift(-4,Ne.R),Z.write_shift(-4,Ne.C),Ne.clsid)Z.write_shift(16,Ne.clsid,"hex");else for(be=0;be<4;++be)Z.write_shift(4,0);Z.write_shift(4,Ne.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,Ne.start),Z.write_shift(4,Ne.size),Z.write_shift(4,0)}for(ae=1;ae<P.FileIndex.length;++ae)if(Ne=P.FileIndex[ae],Ne.size>=4096)if(Z.l=Ne.start+1<<9,Tt&&Buffer.isBuffer(Ne.content))Ne.content.copy(Z,Z.l,0,Ne.size),Z.l+=Ne.size+511&-512;else{for(be=0;be<Ne.size;++be)Z.write_shift(1,Ne.content[be]);for(;be&511;++be)Z.write_shift(1,0)}for(ae=1;ae<P.FileIndex.length;++ae)if(Ne=P.FileIndex[ae],Ne.size>0&&Ne.size<4096)if(Tt&&Buffer.isBuffer(Ne.content))Ne.content.copy(Z,Z.l,0,Ne.size),Z.l+=Ne.size+63&-64;else{for(be=0;be<Ne.size;++be)Z.write_shift(1,Ne.content[be]);for(;be&63;++be)Z.write_shift(1,0)}if(Tt)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function J(P,ee){var V=P.FullPaths.map(function(be){return be.toUpperCase()}),X=V.map(function(be){var Ee=be.split("/");return Ee[Ee.length-(be.slice(-1)=="/"?2:1)]}),Z=!1;ee.charCodeAt(0)===47?(Z=!0,ee=V[0].slice(0,-1)+ee):Z=ee.indexOf("/")!==-1;var ae=ee.toUpperCase(),_e=Z===!0?V.indexOf(ae):X.indexOf(ae);if(_e!==-1)return P.FileIndex[_e];var je=!ae.match(sl);for(ae=ae.replace(dn,""),je&&(ae=ae.replace(sl,"!")),_e=0;_e<V.length;++_e)if((je?V[_e].replace(sl,"!"):V[_e]).replace(dn,"")==ae||(je?X[_e].replace(sl,"!"):X[_e]).replace(dn,"")==ae)return P.FileIndex[_e];return null}var Y=64,pe=-2,de="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",L={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:pe,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(P,ee,V){h();var X=oe(P,V);f.writeFileSync(ee,X)}function O(P){for(var ee=new Array(P.length),V=0;V<P.length;++V)ee[V]=String.fromCharCode(P[V]);return ee.join("")}function re(P,ee){var V=oe(P,ee);switch(ee&&ee.type||"buffer"){case"file":return h(),f.writeFileSync(ee.filename,V),V;case"binary":return typeof V=="string"?V:O(V);case"base64":return Bm(typeof V=="string"?V:O(V));case"buffer":if(Tt)return Buffer.isBuffer(V)?V:vo(V);case"array":return typeof V=="string"?na(V):V}return V}var M;function F(P){try{var ee=P.InflateRaw,V=new ee;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)M=P;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function le(P,ee){if(!M)return me(P,ee);var V=M.InflateRaw,X=new V,Z=X._processChunk(P.slice(P.l),X._finishFlushFlag);return P.l+=X.bytesRead,Z}function A(P){return M?M.deflateRawSync(P):dt(P)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function q(P){var ee=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var H=typeof Uint8Array<"u",B=H?new Uint8Array(256):[],fe=0;fe<256;++fe)B[fe]=q(fe);function I(P,ee){var V=B[P&255];return ee<=8?V>>>8-ee:(V=V<<8|B[P>>8&255],ee<=16?V>>>16-ee:(V=V<<8|B[P>>16&255],V>>>24-ee))}function Fe(P,ee){var V=ee&7,X=ee>>>3;return(P[X]|(V<=6?0:P[X+1]<<8))>>>V&3}function Pe(P,ee){var V=ee&7,X=ee>>>3;return(P[X]|(V<=5?0:P[X+1]<<8))>>>V&7}function Qe(P,ee){var V=ee&7,X=ee>>>3;return(P[X]|(V<=4?0:P[X+1]<<8))>>>V&15}function qe(P,ee){var V=ee&7,X=ee>>>3;return(P[X]|(V<=3?0:P[X+1]<<8))>>>V&31}function he(P,ee){var V=ee&7,X=ee>>>3;return(P[X]|(V<=1?0:P[X+1]<<8))>>>V&127}function ue(P,ee,V){var X=ee&7,Z=ee>>>3,ae=(1<<V)-1,_e=P[Z]>>>X;return V<8-X||(_e|=P[Z+1]<<8-X,V<16-X)||(_e|=P[Z+2]<<16-X,V<24-X)||(_e|=P[Z+3]<<24-X),_e&ae}function we(P,ee,V){var X=ee&7,Z=ee>>>3;return X<=5?P[Z]|=(V&7)<<X:(P[Z]|=V<<X&255,P[Z+1]=(V&7)>>8-X),ee+3}function ve(P,ee,V){var X=ee&7,Z=ee>>>3;return V=(V&1)<<X,P[Z]|=V,ee+1}function Oe(P,ee,V){var X=ee&7,Z=ee>>>3;return V<<=X,P[Z]|=V&255,V>>>=8,P[Z+1]=V,ee+8}function lt(P,ee,V){var X=ee&7,Z=ee>>>3;return V<<=X,P[Z]|=V&255,V>>>=8,P[Z+1]=V&255,P[Z+2]=V>>>8,ee+16}function ft(P,ee){var V=P.length,X=2*V>ee?2*V:ee+5,Z=0;if(V>=ee)return P;if(Tt){var ae=Wm(X);if(P.copy)P.copy(ae);else for(;Z<P.length;++Z)ae[Z]=P[Z];return ae}else if(H){var _e=new Uint8Array(X);if(_e.set)_e.set(P);else for(;Z<V;++Z)_e[Z]=P[Z];return _e}return P.length=X,P}function gt(P){for(var ee=new Array(P),V=0;V<P;++V)ee[V]=0;return ee}function Rt(P,ee,V){var X=1,Z=0,ae=0,_e=0,je=0,be=P.length,Ee=H?new Uint16Array(32):gt(32);for(ae=0;ae<32;++ae)Ee[ae]=0;for(ae=be;ae<V;++ae)P[ae]=0;be=P.length;var Ne=H?new Uint16Array(be):gt(be);for(ae=0;ae<be;++ae)Ee[Z=P[ae]]++,X<Z&&(X=Z),Ne[ae]=0;for(Ee[0]=0,ae=1;ae<=X;++ae)Ee[ae+16]=je=je+Ee[ae-1]<<1;for(ae=0;ae<be;++ae)je=P[ae],je!=0&&(Ne[ae]=Ee[je+16]++);var Be=0;for(ae=0;ae<be;++ae)if(Be=P[ae],Be!=0)for(je=I(Ne[ae],X)>>X-Be,_e=(1<<X+4-Be)-1;_e>=0;--_e)ee[je|_e<<Be]=Be&15|ae<<4;return X}var Gt=H?new Uint16Array(512):gt(512),cr=H?new Uint16Array(32):gt(32);if(!H){for(var Lt=0;Lt<512;++Lt)Gt[Lt]=0;for(Lt=0;Lt<32;++Lt)cr[Lt]=0}(function(){for(var P=[],ee=0;ee<32;ee++)P.push(5);Rt(P,cr,32);var V=[];for(ee=0;ee<=143;ee++)V.push(8);for(;ee<=255;ee++)V.push(9);for(;ee<=279;ee++)V.push(7);for(;ee<=287;ee++)V.push(8);Rt(V,Gt,288)})();var Qt=(function(){for(var ee=H?new Uint8Array(32768):[],V=0,X=0;V<R.length-1;++V)for(;X<R[V+1];++X)ee[X]=V;for(;X<32768;++X)ee[X]=29;var Z=H?new Uint8Array(259):[];for(V=0,X=0;V<j.length-1;++V)for(;X<j[V+1];++X)Z[X]=V;function ae(je,be){for(var Ee=0;Ee<je.length;){var Ne=Math.min(65535,je.length-Ee),Be=Ee+Ne==je.length;for(be.write_shift(1,+Be),be.write_shift(2,Ne),be.write_shift(2,~Ne&65535);Ne-- >0;)be[be.l++]=je[Ee++]}return be.l}function _e(je,be){for(var Ee=0,Ne=0,Be=H?new Uint16Array(32768):[];Ne<je.length;){var Xe=Math.min(65535,je.length-Ne);if(Xe<10){for(Ee=we(be,Ee,+(Ne+Xe==je.length)),Ee&7&&(Ee+=8-(Ee&7)),be.l=Ee/8|0,be.write_shift(2,Xe),be.write_shift(2,~Xe&65535);Xe-- >0;)be[be.l++]=je[Ne++];Ee=be.l*8;continue}Ee=we(be,Ee,+(Ne+Xe==je.length)+2);for(var We=0;Xe-- >0;){var Ue=je[Ne];We=(We<<5^Ue)&32767;var Ye=-1,xt=0;if((Ye=Be[We])&&(Ye|=Ne&-32768,Ye>Ne&&(Ye-=32768),Ye<Ne))for(;je[Ye+xt]==je[Ne+xt]&&xt<250;)++xt;if(xt>2){Ue=Z[xt],Ue<=22?Ee=Oe(be,Ee,B[Ue+1]>>1)-1:(Oe(be,Ee,3),Ee+=5,Oe(be,Ee,B[Ue-23]>>5),Ee+=3);var Ht=Ue<8?0:Ue-4>>2;Ht>0&&(lt(be,Ee,xt-j[Ue]),Ee+=Ht),Ue=ee[Ne-Ye],Ee=Oe(be,Ee,B[Ue]>>3),Ee-=3;var Wt=Ue<4?0:Ue-2>>1;Wt>0&&(lt(be,Ee,Ne-Ye-R[Ue]),Ee+=Wt);for(var hr=0;hr<xt;++hr)Be[We]=Ne&32767,We=(We<<5^je[Ne])&32767,++Ne;Xe-=xt-1}else Ue<=143?Ue=Ue+48:Ee=ve(be,Ee,1),Ee=Oe(be,Ee,B[Ue]),Be[We]=Ne&32767,++Ne}Ee=Oe(be,Ee,0)-1}return be.l=(Ee+7)/8|0,be.l}return function(be,Ee){return be.length<8?ae(be,Ee):_e(be,Ee)}})();function dt(P){var ee=Nr(50+Math.floor(P.length*1.1)),V=Qt(P,ee);return ee.slice(0,V)}var Et=H?new Uint16Array(32768):gt(32768),Xt=H?new Uint16Array(32768):gt(32768),Ct=H?new Uint16Array(128):gt(128),$t=1,Bt=1;function Jr(P,ee){var V=qe(P,ee)+257;ee+=5;var X=qe(P,ee)+1;ee+=5;var Z=Qe(P,ee)+4;ee+=4;for(var ae=0,_e=H?new Uint8Array(19):gt(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,Ee=H?new Uint8Array(8):gt(8),Ne=H?new Uint8Array(8):gt(8),Be=_e.length,Xe=0;Xe<Z;++Xe)_e[T[Xe]]=ae=Pe(P,ee),be<ae&&(be=ae),Ee[ae]++,ee+=3;var We=0;for(Ee[0]=0,Xe=1;Xe<=be;++Xe)Ne[Xe]=We=We+Ee[Xe-1]<<1;for(Xe=0;Xe<Be;++Xe)(We=_e[Xe])!=0&&(je[Xe]=Ne[We]++);var Ue=0;for(Xe=0;Xe<Be;++Xe)if(Ue=_e[Xe],Ue!=0){We=B[je[Xe]]>>8-Ue;for(var Ye=(1<<7-Ue)-1;Ye>=0;--Ye)Ct[We|Ye<<Ue]=Ue&7|Xe<<3}var xt=[];for(be=1;xt.length<V+X;)switch(We=Ct[he(P,ee)],ee+=We&7,We>>>=3){case 16:for(ae=3+Fe(P,ee),ee+=2,We=xt[xt.length-1];ae-- >0;)xt.push(We);break;case 17:for(ae=3+Pe(P,ee),ee+=3;ae-- >0;)xt.push(0);break;case 18:for(ae=11+he(P,ee),ee+=7;ae-- >0;)xt.push(0);break;default:xt.push(We),be<We&&(be=We);break}var Ht=xt.slice(0,V),Wt=xt.slice(V);for(Xe=V;Xe<286;++Xe)Ht[Xe]=0;for(Xe=X;Xe<30;++Xe)Wt[Xe]=0;return $t=Rt(Ht,Et,286),Bt=Rt(Wt,Xt,30),ee}function en(P,ee){if(P[0]==3&&!(P[1]&3))return[As(ee),2];for(var V=0,X=0,Z=Wm(ee||1<<18),ae=0,_e=Z.length>>>0,je=0,be=0;(X&1)==0;){if(X=Pe(P,V),V+=3,X>>>1)X>>1==1?(je=9,be=5):(V=Jr(P,V),je=$t,be=Bt);else{V&7&&(V+=8-(V&7));var Ee=P[V>>>3]|P[(V>>>3)+1]<<8;if(V+=32,Ee>0)for(!ee&&_e<ae+Ee&&(Z=ft(Z,ae+Ee),_e=Z.length);Ee-- >0;)Z[ae++]=P[V>>>3],V+=8;continue}for(;;){!ee&&_e<ae+32767&&(Z=ft(Z,ae+32767),_e=Z.length);var Ne=ue(P,V,je),Be=X>>>1==1?Gt[Ne]:Et[Ne];if(V+=Be&15,Be>>>=4,(Be>>>8&255)===0)Z[ae++]=Be;else{if(Be==256)break;Be-=257;var Xe=Be<8?0:Be-4>>2;Xe>5&&(Xe=0);var We=ae+j[Be];Xe>0&&(We+=ue(P,V,Xe),V+=Xe),Ne=ue(P,V,be),Be=X>>>1==1?cr[Ne]:Xt[Ne],V+=Be&15,Be>>>=4;var Ue=Be<4?0:Be-2>>1,Ye=R[Be];for(Ue>0&&(Ye+=ue(P,V,Ue),V+=Ue),!ee&&_e<We&&(Z=ft(Z,We+100),_e=Z.length);ae<We;)Z[ae]=Z[ae-Ye],++ae}}}return ee?[Z,V+7>>>3]:[Z.slice(0,ae),V+7>>>3]}function me(P,ee){var V=P.slice(P.l||0),X=en(V,ee);return P.l+=X[1],X[0]}function Ae(P,ee){if(P)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function ze(P,ee){var V=P;Ir(V,0);var X=[],Z=[],ae={FileIndex:X,FullPaths:Z};D(ae,{root:ee.root});for(var _e=V.length-4;(V[_e]!=80||V[_e+1]!=75||V[_e+2]!=5||V[_e+3]!=6)&&_e>=0;)--_e;V.l=_e+4,V.l+=4;var je=V.read_shift(2);V.l+=6;var be=V.read_shift(4);for(V.l=be,_e=0;_e<je;++_e){V.l+=20;var Ee=V.read_shift(4),Ne=V.read_shift(4),Be=V.read_shift(2),Xe=V.read_shift(2),We=V.read_shift(2);V.l+=8;var Ue=V.read_shift(4),Ye=c(V.slice(V.l+Be,V.l+Be+Xe));V.l+=Be+Xe+We;var xt=V.l;V.l=Ue+4,Ze(V,Ee,Ne,ae,Ye),V.l=xt}return ae}function Ze(P,ee,V,X,Z){P.l+=2;var ae=P.read_shift(2),_e=P.read_shift(2),je=l(P);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var be=P.read_shift(4),Ee=P.read_shift(4),Ne=P.read_shift(4),Be=P.read_shift(2),Xe=P.read_shift(2),We="",Ue=0;Ue<Be;++Ue)We+=String.fromCharCode(P[P.l++]);if(Xe){var Ye=c(P.slice(P.l,P.l+Xe));(Ye[21589]||{}).mt&&(je=Ye[21589].mt),((Z||{})[21589]||{}).mt&&(je=Z[21589].mt)}P.l+=Xe;var xt=P.slice(P.l,P.l+Ee);switch(_e){case 8:xt=le(P,Ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var Ht=!1;ae&8&&(be=P.read_shift(4),be==134695760&&(be=P.read_shift(4),Ht=!0),Ee=P.read_shift(4),Ne=P.read_shift(4)),Ee!=ee&&Ae(Ht,"Bad compressed size: "+ee+" != "+Ee),Ne!=V&&Ae(Ht,"Bad uncompressed size: "+V+" != "+Ne),Je(X,We,xt,{unsafe:!0,mt:je})}function rt(P,ee){var V=ee||{},X=[],Z=[],ae=Nr(1),_e=V.compression?8:0,je=0,be=0,Ee=0,Ne=0,Be=0,Xe=P.FullPaths[0],We=Xe,Ue=P.FileIndex[0],Ye=[],xt=0;for(be=1;be<P.FullPaths.length;++be)if(We=P.FullPaths[be].slice(Xe.length),Ue=P.FileIndex[be],!(!Ue.size||!Ue.content||We=="Sh33tJ5")){var Ht=Ne,Wt=Nr(We.length);for(Ee=0;Ee<We.length;++Ee)Wt.write_shift(1,We.charCodeAt(Ee)&127);Wt=Wt.slice(0,Wt.l),Ye[Be]=f2.buf(Ue.content,0);var hr=Ue.content;_e==8&&(hr=A(hr)),ae=Nr(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,je),ae.write_shift(2,_e),Ue.mt?o(ae,Ue.mt):ae.write_shift(4,0),ae.write_shift(-4,Ye[Be]),ae.write_shift(4,hr.length),ae.write_shift(4,Ue.content.length),ae.write_shift(2,Wt.length),ae.write_shift(2,0),Ne+=ae.length,X.push(ae),Ne+=Wt.length,X.push(Wt),Ne+=hr.length,X.push(hr),ae=Nr(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,je),ae.write_shift(2,_e),ae.write_shift(4,0),ae.write_shift(-4,Ye[Be]),ae.write_shift(4,hr.length),ae.write_shift(4,Ue.content.length),ae.write_shift(2,Wt.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,Ht),xt+=ae.l,Z.push(ae),xt+=Wt.length,Z.push(Wt),++Be}return ae=Nr(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,Be),ae.write_shift(2,Be),ae.write_shift(4,xt),ae.write_shift(4,Ne),ae.write_shift(2,0),Es([Es(X),Es(Z),ae])}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ye(P,ee){if(P.ctype)return P.ctype;var V=P.name||"",X=V.match(/\.([^\.]+)$/);return X&&se[X[1]]||ee&&(X=(V=ee).match(/[\.\\]([^\.\\])+$/),X&&se[X[1]])?se[X[1]]:"application/octet-stream"}function De(P){for(var ee=Bm(P),V=[],X=0;X<ee.length;X+=76)V.push(ee.slice(X,X+76));return V.join(`\r
`)+`\r
`}function Re(P){var ee=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var Ne=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(Ne.length==1?"0"+Ne:Ne)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],X=ee.split(`\r
`),Z=0;Z<X.length;++Z){var ae=X[Z];if(ae.length==0){V.push("");continue}for(var _e=0;_e<ae.length;){var je=76,be=ae.slice(_e,_e+je);be.charAt(je-1)=="="?je--:be.charAt(je-2)=="="?je-=2:be.charAt(je-3)=="="&&(je-=3),be=ae.slice(_e,_e+je),_e+=je,_e<ae.length&&(be+="="),V.push(be)}}return V.join(`\r
`)}function $e(P){for(var ee=[],V=0;V<P.length;++V){for(var X=P[V];V<=P.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+P[++V];ee.push(X)}for(var Z=0;Z<ee.length;++Z)ee[Z]=ee[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return na(ee.join(`\r
`))}function et(P,ee,V){for(var X="",Z="",ae="",_e,je=0;je<10;++je){var be=ee[je];if(!be||be.match(/^\s*$/))break;var Ee=be.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":X=Ee[2].trim();break;case"content-type":ae=Ee[2].trim();break;case"content-transfer-encoding":Z=Ee[2].trim();break}}switch(++je,Z.toLowerCase()){case"base64":_e=na(Tn(ee.slice(je).join("")));break;case"quoted-printable":_e=$e(ee.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var Ne=Je(P,X.slice(V.length),_e,{unsafe:!0});ae&&(Ne.ctype=ae)}function mt(P,ee){if(O(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=ee&&ee.root||"",X=(Tt&&Buffer.isBuffer(P)?P.toString("binary"):O(P)).split(`\r
`),Z=0,ae="";for(Z=0;Z<X.length;++Z)if(ae=X[Z],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),V||(V=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),ae.slice(0,V.length)!=V););var _e=(X[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var je="--"+(_e[1]||""),be=[],Ee=[],Ne={FileIndex:be,FullPaths:Ee};D(Ne);var Be,Xe=0;for(Z=0;Z<X.length;++Z){var We=X[Z];We!==je&&We!==je+"--"||(Xe++&&et(Ne,X.slice(Be,Z),V),Be=Z)}return Ne}function Mt(P,ee){var V=ee||{},X=V.boundary||"SheetJS";X="------="+X;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],ae=P.FullPaths[0],_e=ae,je=P.FileIndex[0],be=1;be<P.FullPaths.length;++be)if(_e=P.FullPaths[be].slice(ae.length),je=P.FileIndex[be],!(!je.size||!je.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(xt){return"_x"+xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(xt){return"_u"+xt.charCodeAt(0).toString(16)+"_"});for(var Ee=je.content,Ne=Tt&&Buffer.isBuffer(Ee)?Ee.toString("binary"):O(Ee),Be=0,Xe=Math.min(1024,Ne.length),We=0,Ue=0;Ue<=Xe;++Ue)(We=Ne.charCodeAt(Ue))>=32&&We<128&&++Be;var Ye=Be>=Xe*4/5;Z.push(X),Z.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+_e),Z.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),Z.push("Content-Type: "+ye(je,_e)),Z.push(""),Z.push(Ye?Re(Ne):De(Ne))}return Z.push(X+`--\r
`),Z.join(`\r
`)}function Ke(P){var ee={};return D(ee,P),ee}function Je(P,ee,V,X){var Z=X&&X.unsafe;Z||D(P);var ae=!Z&&Dt.find(P,ee);if(!ae){var _e=P.FullPaths[0];ee.slice(0,_e.length)==_e?_e=ee:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+ee).replace("//","/")),ae={name:a(ee),type:2},P.FileIndex.push(ae),P.FullPaths.push(_e),Z||Dt.utils.cfb_gc(P)}return ae.content=V,ae.size=V?V.length:0,X&&(X.CLSID&&(ae.clsid=X.CLSID),X.mt&&(ae.mt=X.mt),X.ct&&(ae.ct=X.ct)),ae}function Me(P,ee){D(P);var V=Dt.find(P,ee);if(V){for(var X=0;X<P.FileIndex.length;++X)if(P.FileIndex[X]==V)return P.FileIndex.splice(X,1),P.FullPaths.splice(X,1),!0}return!1}function tt(P,ee,V){D(P);var X=Dt.find(P,ee);if(X){for(var Z=0;Z<P.FileIndex.length;++Z)if(P.FileIndex[Z]==X)return P.FileIndex[Z].name=a(V),P.FullPaths[Z]=V,!0}return!1}function wt(P){W(P,!0)}return n.find=J,n.read=Q,n.parse=p,n.write=re,n.writeFile=ne,n.utils={cfb_new:Ke,cfb_add:Je,cfb_del:Me,cfb_mov:tt,cfb_gc:wt,ReadShift:ul,CheckField:N1,prep_blob:Ir,bconcat:Es,use_zlib:F,_deflateRaw:dt,_inflateRaw:me,consts:L},n})();function p2(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ca(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function ip(e){for(var n=[],t=Ca(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var Nu=new Date(1899,11,30,0,0,0);function fn(e,n){var t=e.getTime(),r=Nu.getTime()+(e.getTimezoneOffset()-Nu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var s1=new Date,h2=Nu.getTime()+(s1.getTimezoneOffset()-Nu.getTimezoneOffset())*6e4,Qm=s1.getTimezoneOffset();function Qu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+h2),n.getTimezoneOffset()!==Qm&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Qm)*6e4),n}function x2(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var Xm=new Date("2017-02-19T19:06:09.000Z"),o1=isNaN(Xm.getFullYear())?new Date("2/19/17"):Xm,m2=o1.getFullYear()==2017;function Or(e,n){var t=new Date(e);if(m2)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(o1.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function fo(e,n){if(Tt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return il(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return il(Vv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return il(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return il(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Br(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=Br(e[t]));return n}function dr(e,n){for(var t="";t.length<n;)t+=e;return t}function oa(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var g2=["january","february","march","april","may","june","july","august","september","october","november","december"];function li(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&g2.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var v2=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function i1(e){return e?e.content&&e.type?fo(e.content,!0):e.data?al(e.data):e.asNodeBuffer&&Tt?al(e.asNodeBuffer().toString("binary")):e.asBinary?al(e.asBinary()):e._data&&e._data.getContent?al(fo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function l1(e){if(!e)return null;if(e.data)return Im(e.data);if(e.asNodeBuffer&&Tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Im(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function y2(e){return e&&e.name.slice(-4)===".bin"?l1(e):i1(e)}function Bn(e,n){for(var t=e.FullPaths||Ca(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function lp(e,n){var t=Bn(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function br(e,n,t){if(!t)return y2(lp(e,n));if(!n)return null;try{return br(e,n)}catch{return null}}function Nn(e,n,t){if(!t)return i1(lp(e,n));if(!n)return null;try{return Nn(e,n)}catch{return null}}function w2(e,n,t){return l1(lp(e,n))}function qm(e){for(var n=e.FullPaths||Ca(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function k2(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return Tt?r=vo(t):r=Bb(t),Dt.utils.cfb_add(e,n,r)}Dt.utils.cfb_add(e,n,t)}else e.file(n,t)}function c1(e,n){switch(n.type){case"base64":return Dt.read(e,{type:"base64"});case"binary":return Dt.read(e,{type:"binary"});case"buffer":case"array":return Dt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ol(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var u1=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,b2=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Zm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_2=/<[^>]*>/g,Zr=u1.match(Zm)?Zm:_2,S2=/<\w*:/,E2=/<(\/?)\w+:/;function vt(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(b2),c=0,f="",h=0,p="",m="",g=1;if(l)for(h=0;h!=l.length;++h){for(m=l[h],o=0;o!=m.length&&m.charCodeAt(o)!==61;++o);for(p=m.slice(0,o).trim();m.charCodeAt(o+1)==32;)++o;for(g=(a=m.charCodeAt(o+1))==34||a==39?1:0,f=m.slice(o+1+g,m.length-g),c=0;c!=p.length&&p.charCodeAt(c)!==58;++c);if(c===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=f,r[p.toLowerCase()]=f;else{var v=(c===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(c+1);if(r[v]&&p.slice(c-3,c)=="ext")continue;r[v]=f,r[v.toLowerCase()]=f}}return r}function Da(e){return e.replace(E2,"<$1")}var d1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},N2=ip(d1),Ot=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return d1[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),C2=/[&<>'"]/g,T2=/[\u0000-\u001f]/g;function cp(e){var n=e+"";return n.replace(C2,function(t){return N2[t]}).replace(/\n/g,"<br/>").replace(T2,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Jm=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function ar(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Z0(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function eg(e){var n=As(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function tg(e){return vo(e,"binary").toString("utf8")}var eu="foo bar baz",Jt=Tt&&(tg(eu)==Z0(eu)&&tg||eg(eu)==Z0(eu)&&eg)||Z0,il=Tt?function(e){return vo(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},bl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),f1=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),D2=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),j2=/<\/?(?:vt:)?variant>/g,F2=/<(?:vt:)([^>]*)>([\s\S]*)</;function rg(e,n){var t=vt(e),r=e.match(D2(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(j2,"").match(F2);l&&a.push({v:Jt(l[2]),t:l[1]})}),a}var P2=/(^\s|\s$|\n)/;function A2(e){return Ca(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function O2(e,n,t){return"<"+e+(t!=null?A2(t):"")+(n!=null?(n.match(P2)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function up(e){if(Tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Jt(yo(ap(e)));throw new Error("Bad input format: expected Buffer or string")}var _l=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,R2={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},z2=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function M2(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function I2(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var ng=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},ag=Tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:vo(n)})):ng(e)}:ng,sg=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(Ya(e,a)));return r.join("").replace(dn,"")},dp=Tt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(dn,""):sg(e,n,t)}:sg,og=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},p1=Tt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):og(e,n,t)}:og,ig=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Zo(e,a)));return r.join("")},Al=Tt?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):ig(n,t,r)}:ig,h1=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},x1=h1,m1=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},g1=m1,v1=function(e,n){var t=2*En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},y1=v1,w1=function(n,t){var r=En(n,t);return r>0?dp(n,t+4,t+4+r):""},k1=w1,b1=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t):""},_1=b1,S1=function(e,n){return M2(e,n)},Cu=S1,E1=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Tt&&(x1=function(n,t){if(!Buffer.isBuffer(n))return h1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},g1=function(n,t){if(!Buffer.isBuffer(n))return m1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},y1=function(n,t){if(!Buffer.isBuffer(n))return v1(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},k1=function(n,t){if(!Buffer.isBuffer(n))return w1(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},_1=function(n,t){if(!Buffer.isBuffer(n))return b1(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Cu=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):S1(n,t)},E1=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Zo=function(e,n){return e[n]},Ya=function(e,n){return e[n+1]*256+e[n]},L2=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},En=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},eo=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},B2=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ul(e,n){var t="",r,a,o=[],l,c,f,h;switch(n){case"dbcs":if(h=this.l,Tt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(Ya(this,h)),h+=2;e*=2;break;case"utf8":t=Al(this,this.l,this.l+e);break;case"utf16le":e*=2,t=dp(this,this.l,this.l+e);break;case"wstr":return ul.call(this,e,"dbcs");case"lpstr-ansi":t=x1(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":t=g1(this,this.l),e=4+En(this,this.l);break;case"lpwstr":t=y1(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),t=k1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),t=_1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Zo(this,this.l+e++))!==0;)o.push(Jc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=Ya(this,this.l+e))!==0;)o.push(Jc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Ya(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Zo(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return r=Zo(this,this.l),this.l++,r;case 2:return r=(n==="i"?L2:Ya)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?eo:B2)(this,this.l),this.l+=4,r):(a=En(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Cu(this,this.l):a=Cu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=p1(this,this.l,e);break}}return this.l+=e,t}var W2=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},U2=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},$2=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function H2(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)$2(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,W2(this,n,this.l);break;case 8:if(r=8,t==="f"){I2(this,n,this.l);break}case 16:break;case-4:r=4,U2(this,n,this.l);break}return this.l+=r,this}function N1(e,n){var t=p1(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Ir(e,n){e.l=n,e.read_shift=ul,e.chk=N1,e.write_shift=H2}function qr(e,n){e.l+=n}function Nr(e){var n=As(e);return Ir(n,0),n}function ts(e,n,t){if(e){var r,a,o;Ir(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var h=Au[c]||Au[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var p=h.f&&h.f(e,o,t);if(e.l=f,n(p,h,c))return}}}function Ef(){var e=[],n=Tt?256:2048,t=function(h){var p=Nr(h);return Ir(p,0),p},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=t(Math.max(h+1,n)))},l=function(){return a(),Es(e)},c=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function dl(e,n,t){var r=Br(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function lg(e,n,t){var r=Br(e);return r.s=dl(r.s,n.s,t),r.e=dl(r.e,n.s,t),r}function fl(e,n){if(e.cRel&&e.c<0)for(e=Br(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Br(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=kt(e);return!e.cRel&&e.cRel!=null&&(t=K2(t)),!e.rRel&&e.rRel!=null&&(t=Y2(t)),t}function J0(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Cr(e.s.c)+":"+(e.e.cRel?"":"$")+Cr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Wr(e.s.r)+":"+(e.e.rRel?"":"$")+Wr(e.e.r):fl(e.s,n.biff)+":"+fl(e.e,n.biff)}function fp(e){return parseInt(V2(e),10)-1}function Wr(e){return""+(e+1)}function Y2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function V2(e){return e.replace(/\$(\d+)$/,"$1")}function pp(e){for(var n=G2(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Cr(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function K2(e){return e.replace(/^([A-Z])/,"$$$1")}function G2(e){return e.replace(/^\$([A-Z])/,"$1")}function Q2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function kt(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function gi(e){var n=e.indexOf(":");return n==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,n)),e:ln(e.slice(n+1))}}function jt(e,n){return typeof n>"u"||typeof n=="number"?jt(e.s,e.e):(typeof e!="string"&&(e=kt(e)),typeof n!="string"&&(n=kt(n)),e==n?e:e+":"+n)}function fr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function cg(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Yn(e.z,t?fn(n):n)}catch{}try{return e.w=Yn((e.XF||{}).numFmtId||(t?14:0),t?fn(n):n)}catch{return""+n}}function Ja(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?bo[e.v]||e.v:n==null?cg(e,e.v):cg(e,n))}function Ms(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function C1(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=fr(o["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),l==-1&&(h.e.r=l=p.e.r+1)}for(var m=0;m!=n.length;++m)if(n[m]){if(!Array.isArray(n[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[m].length;++g)if(!(typeof n[m][g]>"u")){var v={v:n[m][g]},w=l+m,b=c+g;if(h.s.r>w&&(h.s.r=w),h.s.c>b&&(h.s.c=b),h.e.r<w&&(h.e.r=w),h.e.c<b&&(h.e.c=b),n[m][g]&&typeof n[m][g]=="object"&&!Array.isArray(n[m][g])&&!(n[m][g]instanceof Date))v=n[m][g];else if(Array.isArray(v.v)&&(v.f=n[m][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(r.nullError)v.t="e",v.v=0;else if(r.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=r.dateNF||bt[14],r.cellDates?(v.t="d",v.w=Yn(v.z,fn(v.v))):(v.t="n",v.v=fn(v.v),v.w=Yn(v.z,v.v))):v.t="s";if(a)o[w]||(o[w]=[]),o[w][b]&&o[w][b].z&&(v.z=o[w][b].z),o[w][b]=v;else{var k=kt({c:b,r:w});o[k]&&o[k].z&&(v.z=o[k].z),o[k]=v}}}return h.s.c<1e7&&(o["!ref"]=jt(h)),o}function vi(e,n){return C1(null,e,n)}function X2(e){return e.read_shift(4,"i")}function Xr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function q2(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hp(e,n){var t=e.l,r=e.read_shift(1),a=Xr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(q2(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var Z2=hp;function Kn(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function wo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var J2=Xr;function xp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var e_=Xr,Nf=xp;function mp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Cu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):eo(n,0)>>2;return t?a/100:a}function T1(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var ko=T1;function Gr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function t_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var h=so[a];h&&(n.rgb=El(h));break;case 2:n.rgb=El([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function r_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function D1(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function n_(e){return D1(e,1)}function a_(e){return D1(e,2)}var gp=2,yn=3,tu=11,ug=12,Tu=19,ru=64,s_=65,o_=71,i_=4108,l_=4126,Ar=80,j1=81,c_=[Ar,j1],u_={1:{n:"CodePage",t:gp},2:{n:"Category",t:Ar},3:{n:"PresentationFormat",t:Ar},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:tu},12:{n:"HeadingPairs",t:i_},13:{n:"TitlesOfParts",t:l_},14:{n:"Manager",t:Ar},15:{n:"Company",t:Ar},16:{n:"LinksUpToDate",t:tu},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:tu},22:{n:"HyperlinksChanged",t:tu},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:s_},26:{n:"ContentType",t:Ar},27:{n:"ContentStatus",t:Ar},28:{n:"Language",t:Ar},29:{n:"Version",t:Ar},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},d_={1:{n:"CodePage",t:gp},2:{n:"Title",t:Ar},3:{n:"Subject",t:Ar},4:{n:"Author",t:Ar},5:{n:"Keywords",t:Ar},6:{n:"Comments",t:Ar},7:{n:"Template",t:Ar},8:{n:"LastAuthor",t:Ar},9:{n:"RevNumber",t:Ar},10:{n:"EditTime",t:ru},11:{n:"LastPrinted",t:ru},12:{n:"CreatedDate",t:ru},13:{n:"ModifiedDate",t:ru},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:o_},18:{n:"Application",t:Ar},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},dg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},f_=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function p_(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var h_=p_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),so=Br(h_),bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},F1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},fg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function x_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function m_(e){var n=x_();if(!e||!e.match)return n;var t={};if((e.match(Zr)||[]).forEach(function(r){var a=vt(r);switch(a[0].replace(S2,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[fg[a.ContentType]]!==void 0&&n[fg[a.ContentType]].push(a.PartName);break}}),n.xmlns!==R2.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var ei={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cf(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function pl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(Zr)||[]).forEach(function(a){var o=vt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:ol(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var g_="application/vnd.oasis.opendocument.spreadsheet";function v_(e,n){for(var t=up(e),r,a;r=_l.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=vt(r[0],!1),a.path=="/"&&a.type!==g_)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var hl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],y_=(function(){for(var e=new Array(hl.length),n=0;n<hl.length;++n){var t=hl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function P1(e){var n={};e=Jt(e);for(var t=0;t<hl.length;++t){var r=hl[t],a=e.match(y_[t]);a!=null&&a.length>0&&(n[r[1]]=Ot(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=Or(n[r[1]]))}return n}var w_=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function A1(e,n,t,r){var a=[];if(typeof e=="string")a=rg(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(p){return{v:p}}));var l=typeof n=="string"?rg(n,r).map(function(p){return p.v}):n,c=0,f=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function k_(e,n,t){var r={};return n||(n={}),e=Jt(e),w_.forEach(function(a){var o=(e.match(bl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=Ot(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&A1(r.HeadingPairs,r.TitlesOfParts,n,t),n}var b_=/<[^>]+>[^<]*/g;function __(e,n){var t={},r="",a=e.match(b_);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=vt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Ot(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),p=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[r]=Ot(p);break;case"bool":t[r]=ar(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(p);break;case"filetime":case"date":t[r]=Or(p);break;case"cy":case"error":t[r]=Ot(p);break;default:if(h.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var S_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ef;function E_(e,n,t){ef||(ef=ip(S_)),n=ef[n]||n,e[n]=t}function vp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function O1(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function R1(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function z1(e,n,t){return n===31?R1(e):O1(e,n,t)}function Tf(e,n,t){return z1(e,n,t===!1?0:4)}function N_(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return z1(e,n,0)}function C_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(dn,""),e.l-a&2&&(e.l+=2)}return t}function T_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(dn,"");return t}function D_(e){var n=e.l,t=Du(e,j1);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Du(e,yn);return[t,r]}function j_(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(D_(e));return t}function pg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(dn,"").replace(sl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function M1(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function F_(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Du(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==ug&&r!==n&&c_.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===ug?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return O1(e,r,4).replace(dn,"");case 31:return R1(e);case 64:return vp(e);case 65:return M1(e);case 71:return F_(e);case 80:return Tf(e,r,!o.raw).replace(dn,"");case 81:return N_(e,r).replace(dn,"");case 4108:return j_(e);case 4126:case 4127:return r==4127?C_(e):T_(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function hg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,h={};for(l=0;l!=a;++l){var p=e.read_shift(4),m=e.read_shift(4);o[l]=[p,m+t]}o.sort(function(C,S){return C[1]-S[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var v=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,v=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(v=!1,e.l=o[l][1]),v)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var w=n[o[l][0]];if(g[w.n]=Du(e,w.t,{raw:!0}),w.p==="version"&&(g[w.n]=String(g[w.n]>>16)+"."+("0000"+String(g[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(g[w.n]){case 0:g[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:aa(c=g[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[w.n])}}else if(o[l][0]===1){if(c=g.CodePage=Du(e,gp),aa(c),f!==-1){var b=e.l;e.l=o[f][1],h=pg(e,c),e.l=b}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}h=pg(e,c)}else{var k=h[o[l][0]],N;switch(e[e.l]){case 65:e.l+=4,N=M1(e);break;case 30:e.l+=4,N=Tf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,N=Tf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=gr(e,4);break;case 64:e.l+=4,N=Or(vp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[k]=N}}return e.l=t+r,g}function xg(e,n,t){var r=e.content;if(!r)return{};Ir(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),p=r.read_shift(16);if(p!==Dt.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var m=hg(r,n),g={SystemIdentifier:h};for(var v in m)g[v]=m[v];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var w;try{w=hg(r,null)}catch{}for(v in w)g[v]=w[v];return g.FMTID=[o,l],g}function _s(e,n){return e.read_shift(n),null}function P_(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function gr(e,n){return e.read_shift(n)===1}function _r(e){return e.read_shift(2,"u")}function I1(e,n){return P_(e,n,_r)}function A_(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Ol(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function O_(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",p=n===0?"":e.read_shift(n,h);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function po(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Rl(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):po(e,r,t)}function _o(e,n,t){if(t.biff>5)return Rl(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function R_(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function z_(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(dn,"");return r&&(e.l+=24),a}function M_(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(dn,"");return t+l}function I_(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return z_(e);case"0303000000000000c000000000000046":return M_(e);default:throw new Error("Unsupported Moniker "+t)}}function nu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(dn,""):"";return t}function L_(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,h="",p,m;a&16&&(o=nu(e,t-e.l)),a&128&&(l=nu(e,t-e.l)),(a&257)===257&&(c=nu(e,t-e.l)),(a&257)===1&&(f=I_(e,t-e.l)),a&8&&(h=nu(e,t-e.l)),a&32&&(p=e.read_shift(16)),a&64&&(m=vp(e)),e.l=t;var g=l||c||f||"";g&&h&&(g+="#"+h),g||(g="#"+h),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return p&&(v.guid=p),m&&(v.time=m),o&&(v.Tooltip=o),v}function L1(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function B1(e,n){var t=L1(e);return t[3]=0,t}function ja(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function B_(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function W_(e,n,t){return n===0?"":_o(e,n,t)}function U_(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function W1(e){var n=e.read_shift(2),t=mp(e);return[n,t]}function $_(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Ol(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function Xu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function U1(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var H_=U1;function $1(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function Y_(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function V_(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Vr(e){e.l+=2,e.l+=e.read_shift(2)}var K_={0:Vr,4:Vr,5:Vr,6:Vr,7:V_,8:Vr,9:Vr,10:Vr,11:Vr,12:Vr,13:Y_,14:Vr,15:Vr,16:Vr,17:Vr,18:Vr,19:Vr,20:Vr,21:$1};function G_(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push(K_[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function au(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function Q_(e,n){return n===0||e.read_shift(2),1200}function X_(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=_o(e,0,t);return e.read_shift(n+r-e.l),a}function q_(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function Z_(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Ol(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function J_(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(O_(e));return o.Count=r,o.Unique=a,o}function eS(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function tS(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function rS(e){var n=B_(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function nS(e){return e.read_shift(2),e.read_shift(4)}function mg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function aS(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),h=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:h}}function sS(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function oS(){}function iS(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Ol(e,0,t),r}function lS(e){var n=ja(e);return n.isst=e.read_shift(4),n}function cS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=ja(e);t.biff==2&&e.l++;var o=Rl(e,r-e.l,t);return a.val=o,a}function uS(e,n,t){var r=e.read_shift(2),a=_o(e,0,t);return[r,a]}var dS=_o;function gg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function fS(e){var n=e.read_shift(2),t=e.read_shift(2),r=W1(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function pS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(W1(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function hS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function xS(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=f_[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function mS(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=xS(e,n,r.fStyle,t),r}function gS(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function vg(e,n,t){var r=ja(e);(t.biff==2||n==9)&&++e.l;var a=A_(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function vS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=ja(e),a=Gr(e);return r.val=a,r}var yg=W_;function yS(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=po(e,o),c=[];r>e.l;)c.push(Rl(e));return[o,a,l,c]}function wg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=$_(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var wS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=po(e,l,t);a&32&&(h=wS[h.charCodeAt(0)]);var p=r-e.l;t&&t.biff==2&&--p;var m=r==e.l||c===0||!(p>0)?[]:tT(e,p,t,c);return{chKey:o,Name:h,itab:f,rgce:m}}function H1(e,n,t){if(t.biff<8)return kS(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(U_(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function kS(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Ol(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function bS(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=po(e,r,t),l=po(e,a,t);return[o,l]}function _S(e,n,t){var r=U1(e);e.l++;var a=e.read_shift(1);return n-=8,[rT(e,n,t),a,r]}function bg(e,n,t){var r=H_(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,JC(e,n,t)]}function SS(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function ES(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=_o(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function NS(e,n,t){return ES(e,n,t)}function CS(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(Xu(e));return t}function TS(e,n,t){if(t&&t.biff<8)return jS(e,n,t);var r=$1(e),a=G_(e,n-22,r[1]);return{cmo:r,ft:a}}var DS={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function jS(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((DS[r]||qr)(e,n,t)),{cmo:[a,r,o],ft:l}}function FS(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=R_(e,6,t);var c=e.read_shift(2);e.read_shift(2),_r(e,2);var f=e.read_shift(2);e.l+=f;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],m=po(e,e.lens[h+1]-e.lens[h]-1);if(a+=m,a.length>=(p?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function PS(e,n){var t=Xu(e);e.l+=16;var r=L_(e,n-24);return[t,r]}function AS(e,n){e.read_shift(2);var t=Xu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(dn,""),[t,r]}function OS(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=dg[t]||t,t=e.read_shift(2),n[1]=dg[t]||t,n}function RS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(B1(e));return t}function zS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(B1(e));return t}function MS(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Y1(e,n,t){if(!t.cellStyles)return qr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var h={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(h.level=f>>8&7),h}function IS(e,n){var t={};return n<32||(e.l+=16,t.header=Gr(e),t.footer=Gr(e),e.l+=2),t}function LS(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var BS=ja,WS=I1,US=Rl;function $S(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function HS(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=ja(e);++e.l;var a=_o(e,n-7,t);return r.t="str",r.val=a,r}function YS(e){var n=ja(e);++e.l;var t=Gr(e);return n.t="n",n.val=t,n}function VS(e){var n=ja(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function KS(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function GS(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function QS(e,n,t){var r=e.l+n,a=ja(e),o=e.read_shift(2),l=po(e,o,t);return e.l=r,a.t="str",a.val=l,a}var XS=[2,3,48,49,131,139,140,245],_g=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=ip({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var h=[],p=As(1);switch(f.type){case"base64":p=na(Tn(c));break;case"binary":p=na(c);break;case"buffer":case"array":p=c;break}Ir(p,0);var m=p.read_shift(1),g=!!(m&136),v=!1,w=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var b=0,k=521;m==2&&(b=p.read_shift(2)),p.l+=3,m!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),m!=2&&(k=p.read_shift(2));var N=p.read_shift(2),C=f.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(C=e[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var S=[],U={},te=Math.min(p.length,m==2?521:k-10-(v?264:0)),Q=w?32:11;p.l<te&&p[p.l]!=13;)switch(U={},U.name=wl.utils.decode(C,p.slice(p.l,p.l+Q)).replace(/[\u0000\r\n].*$/g,""),p.l+=Q,U.type=String.fromCharCode(p.read_shift(1)),m!=2&&!w&&(U.offset=p.read_shift(4)),U.len=p.read_shift(1),m==2&&(U.offset=p.read_shift(2)),U.dec=p.read_shift(1),U.name.length&&S.push(U),m!=2&&(p.l+=w?13:14),U.type){case"B":(!v||U.len!=8)&&f.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(p[p.l]!==13&&(p.l=k-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=k;var D=0,K=0;for(h[0]=[],K=0;K!=S.length;++K)h[0][K]=S[K].name;for(;b-- >0;){if(p[p.l]===42){p.l+=N;continue}for(++p.l,h[++D]=[],K=0,K=0;K!=S.length;++K){var W=p.slice(p.l,p.l+S[K].len);p.l+=S[K].len,Ir(W,0);var oe=wl.utils.decode(C,W);switch(S[K].type){case"C":oe.trim().length&&(h[D][K]=oe.replace(/\s+$/,""));break;case"D":oe.length===8?h[D][K]=new Date(+oe.slice(0,4),+oe.slice(4,6)-1,+oe.slice(6,8)):h[D][K]=oe;break;case"F":h[D][K]=parseFloat(oe.trim());break;case"+":case"I":h[D][K]=w?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(oe.trim().toUpperCase()){case"Y":case"T":h[D][K]=!0;break;case"N":case"F":h[D][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+oe+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[D][K]="##MEMO##"+(w?parseInt(oe.trim(),10):W.read_shift(4));break;case"N":oe=oe.replace(/\u0000/g,"").trim(),oe&&oe!="."&&(h[D][K]=+oe||0);break;case"@":h[D][K]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":h[D][K]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":h[D][K]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[D][K]=-W.read_shift(-8,"f");break;case"B":if(v&&S[K].len==8){h[D][K]=W.read_shift(8,"f");break}case"G":case"P":W.l+=S[K].len;break;case"0":if(S[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[K].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=S,h}function r(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var p=vi(t(c,h),h);return p["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,p}function a(c,f){try{return Ms(r(c,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var h=f||{};if(+h.codepage>=0&&aa(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ef(),m=Rf(c,{header:1,raw:!0,cellDates:!0}),g=m[0],v=m.slice(1),w=c["!cols"]||[],b=0,k=0,N=0,C=1;for(b=0;b<g.length;++b){if(((w[b]||{}).DBF||{}).name){g[b]=w[b].DBF.name,++N;continue}if(g[b]!=null){if(++N,typeof g[b]=="number"&&(g[b]=g[b].toString(10)),typeof g[b]!="string")throw new Error("DBF Invalid column name "+g[b]+" |"+typeof g[b]+"|");if(g.indexOf(g[b])!==b){for(k=0;k<1024;++k)if(g.indexOf(g[b]+"_"+k)==-1){g[b]+="_"+k;break}}}}var S=fr(c["!ref"]),U=[],te=[],Q=[];for(b=0;b<=S.e.c-S.s.c;++b){var D="",K="",W=0,oe=[];for(k=0;k<v.length;++k)v[k][b]!=null&&oe.push(v[k][b]);if(oe.length==0||g[b]==null){U[b]="?";continue}for(k=0;k<oe.length;++k){switch(typeof oe[k]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=oe[k]instanceof Date?"D":"C";break;default:K="C"}W=Math.max(W,String(oe[k]).length),D=D&&D!=K?"C":K}W>250&&(W=250),K=((w[b]||{}).DBF||{}).type,K=="C"&&w[b].DBF.len>W&&(W=w[b].DBF.len),D=="B"&&K=="N"&&(D="N",Q[b]=w[b].DBF.dec,W=w[b].DBF.len),te[b]=D=="C"||K=="N"?W:o[D]||0,C+=te[b],U[b]=D}var J=p.next(32);for(J.write_shift(4,318902576),J.write_shift(4,v.length),J.write_shift(2,296+32*N),J.write_shift(2,C),b=0;b<4;++b)J.write_shift(4,0);for(J.write_shift(4,0|(+n[Hv]||3)<<8),b=0,k=0;b<g.length;++b)if(g[b]!=null){var Y=p.next(32),pe=(g[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,pe,"sbcs"),Y.write_shift(1,U[b]=="?"?"C":U[b],"sbcs"),Y.write_shift(4,k),Y.write_shift(1,te[b]||o[U[b]]||0),Y.write_shift(1,Q[b]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),k+=te[b]||o[U[b]]||0}var de=p.next(264);for(de.write_shift(4,13),b=0;b<65;++b)de.write_shift(4,0);for(b=0;b<v.length;++b){var G=p.next(C);for(G.write_shift(1,0),k=0;k<g.length;++k)if(g[k]!=null)switch(U[k]){case"L":G.write_shift(1,v[b][k]==null?63:v[b][k]?84:70);break;case"B":G.write_shift(8,v[b][k]||0,"f");break;case"N":var ie="0";for(typeof v[b][k]=="number"&&(ie=v[b][k].toFixed(Q[k]||0)),N=0;N<te[k]-ie.length;++N)G.write_shift(1,32);G.write_shift(1,ie,"sbcs");break;case"D":v[b][k]?(G.write_shift(4,("0000"+v[b][k].getFullYear()).slice(-4),"sbcs"),G.write_shift(2,("00"+(v[b][k].getMonth()+1)).slice(-2),"sbcs"),G.write_shift(2,("00"+v[b][k].getDate()).slice(-2),"sbcs")):G.write_shift(8,"00000000","sbcs");break;case"C":var L=String(v[b][k]!=null?v[b][k]:"").slice(0,te[k]);for(G.write_shift(1,L,"sbcs"),N=0;N<te[k]-L.length;++N)G.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),qS=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ca(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,v){var w=e[v];return typeof w=="number"?Lm(w):w},r=function(g,v,w){var b=v.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?g:Lm(b)};e["|"]=254;function a(g,v){switch(v.type){case"base64":return o(Tn(g),v);case"binary":return o(g,v);case"buffer":return o(Tt&&Buffer.isBuffer(g)?g.toString("binary"):yo(g),v);case"array":return o(fo(g),v)}throw new Error("Unrecognized type "+v.type)}function o(g,v){var w=g.split(/[\n\r]+/),b=-1,k=-1,N=0,C=0,S=[],U=[],te=null,Q={},D=[],K=[],W=[],oe=0,J;for(+v.codepage>=0&&aa(+v.codepage);N!==w.length;++N){oe=0;var Y=w[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),pe=Y.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),de=pe[0],G;if(Y.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":pe[1].charAt(0)=="P"&&U.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,L=!1,ne=!1,O=!1,re=-1,M=-1;for(C=1;C<pe.length;++C)switch(pe[C].charAt(0)){case"A":break;case"X":k=parseInt(pe[C].slice(1))-1,L=!0;break;case"Y":for(b=parseInt(pe[C].slice(1))-1,L||(k=0),J=S.length;J<=b;++J)S[J]=[];break;case"K":G=pe[C].slice(1),G.charAt(0)==='"'?G=G.slice(1,G.length-1):G==="TRUE"?G=!0:G==="FALSE"?G=!1:isNaN(oa(G))?isNaN(li(G).getDate())||(G=Or(G)):(G=oa(G),te!==null&&mi(te)&&(G=Qu(G))),ie=!0;break;case"E":O=!0;var F=ni(pe[C].slice(1),{r:b,c:k});S[b][k]=[S[b][k],F];break;case"S":ne=!0,S[b][k]=[S[b][k],"S5S"];break;case"G":break;case"R":re=parseInt(pe[C].slice(1))-1;break;case"C":M=parseInt(pe[C].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}if(ie&&(S[b][k]&&S[b][k].length==2?S[b][k][0]=G:S[b][k]=G,te=null),ne){if(O)throw new Error("SYLK shared formula cannot have own formula");var le=re>-1&&S[re][M];if(!le||!le[1])throw new Error("SYLK shared formula cannot find base");S[b][k][1]=ty(le[1],{r:b-re,c:k-M})}break;case"F":var A=0;for(C=1;C<pe.length;++C)switch(pe[C].charAt(0)){case"X":k=parseInt(pe[C].slice(1))-1,++A;break;case"Y":for(b=parseInt(pe[C].slice(1))-1,J=S.length;J<=b;++J)S[J]=[];break;case"M":oe=parseInt(pe[C].slice(1))/20;break;case"F":break;case"G":break;case"P":te=U[parseInt(pe[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=pe[C].slice(1).split(" "),J=parseInt(W[0],10);J<=parseInt(W[1],10);++J)oe=parseInt(W[2],10),K[J-1]=oe===0?{hidden:!0}:{wch:oe},ci(K[J-1]);break;case"C":k=parseInt(pe[C].slice(1))-1,K[k]||(K[k]={});break;case"R":b=parseInt(pe[C].slice(1))-1,D[b]||(D[b]={}),oe>0?(D[b].hpt=oe,D[b].hpx=Nl(oe)):oe===0&&(D[b].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}A<1&&(te=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}}return D.length>0&&(Q["!rows"]=D),K.length>0&&(Q["!cols"]=K),v&&v.sheetRows&&(S=S.slice(0,v.sheetRows)),[S,Q]}function l(g,v){var w=a(g,v),b=w[0],k=w[1],N=vi(b,v);return Ca(k).forEach(function(C){N[C]=k[C]}),N}function c(g,v){return Ms(l(g,v),v)}function f(g,v,w,b){var k="C;Y"+(w+1)+";X"+(b+1)+";K";switch(g.t){case"n":k+=g.v||0,g.f&&!g.F&&(k+=";E"+MN(g.f,{r:w,c:b}));break;case"b":k+=g.v?"TRUE":"FALSE";break;case"e":k+=g.w||g.v;break;case"d":k+='"'+(g.w||g.v)+'"';break;case"s":k+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return k}function h(g,v){v.forEach(function(w,b){var k="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?k+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Fu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Pu(w.wpx)),typeof w.wch=="number"&&(k+=Math.round(w.wch))),k.charAt(k.length-1)!=" "&&g.push(k)})}function p(g,v){v.forEach(function(w,b){var k="F;";w.hidden?k+="M0;":w.hpt?k+="M"+20*w.hpt+";":w.hpx&&(k+="M"+20*Z1(w.hpx)+";"),k.length>2&&g.push(k+"R"+(b+1))})}function m(g,v){var w=["ID;PWXL;N;E"],b=[],k=fr(g["!ref"]),N,C=Array.isArray(g),S=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),g["!cols"]&&h(w,g["!cols"]),g["!rows"]&&p(w,g["!rows"]),w.push("B;Y"+(k.e.r-k.s.r+1)+";X"+(k.e.c-k.s.c+1)+";D"+[k.s.c,k.s.r,k.e.c,k.e.r].join(" "));for(var U=k.s.r;U<=k.e.r;++U)for(var te=k.s.c;te<=k.e.c;++te){var Q=kt({r:U,c:te});N=C?(g[U]||[])[te]:g[Q],!(!N||N.v==null&&(!N.f||N.F))&&b.push(f(N,g,U,te))}return w.join(S)+S+b.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:l,from_sheet:m}})(),ZS=(function(){function e(o,l){switch(l.type){case"base64":return n(Tn(o),l);case"binary":return n(o,l);case"buffer":return n(Tt&&Buffer.isBuffer(o)?o.toString("binary"):yo(o),l);case"array":return n(fo(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,h=-1,p=0,m=[];p!==c.length;++p){if(c[p].trim()==="BOT"){m[++f]=[],h=0;continue}if(!(f<0)){var g=c[p].trim().split(","),v=g[0],w=g[1];++p;for(var b=c[p]||"";(b.match(/["]/g)||[]).length&1&&p<c.length-1;)b+=`
`+c[++p];switch(b=b.trim(),+v){case-1:if(b==="BOT"){m[++f]=[],h=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?m[f][h]=!0:b==="FALSE"?m[f][h]=!1:isNaN(oa(w))?isNaN(li(w).getDate())?m[f][h]=w:m[f][h]=Or(w):m[f][h]=oa(w),++h;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),m[f][h++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function t(o,l){return vi(e(o,l),l)}function r(o,l){return Ms(t(o,l),l)}var a=(function(){var o=function(f,h,p,m,g){f.push(h),f.push(p+","+m),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,h,p,m){f.push(h+","+p),f.push(h==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var h=[],p=fr(f["!ref"]),m,g=Array.isArray(f);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,p.e.r-p.s.r+1,""),o(h,"TUPLES",0,p.e.c-p.s.c+1,""),o(h,"DATA",0,0,"");for(var v=p.s.r;v<=p.e.r;++v){l(h,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var b=kt({r:v,c:w});if(m=g?(f[v]||[])[w]:f[b],!m){l(h,1,0,"");continue}switch(m.t){case"n":var k=m.w;!k&&m.v!=null&&(k=m.v),k==null?m.f&&!m.F?l(h,1,0,"="+m.f):l(h,1,0,""):l(h,0,k,"V");break;case"b":l(h,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Yn(m.z||bt[14],fn(Or(m.v)))),l(h,0,m.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var N=`\r
`,C=h.join(N);return C}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),JS=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(m,g){for(var v=m.split(`
`),w=-1,b=-1,k=0,N=[];k!==v.length;++k){var C=v[k].trim().split(":");if(C[0]==="cell"){var S=ln(C[1]);if(N.length<=S.r)for(w=N.length;w<=S.r;++w)N[w]||(N[w]=[]);switch(w=S.r,b=S.c,C[2]){case"t":N[w][b]=e(C[3]);break;case"v":N[w][b]=+C[3];break;case"vtf":var U=C[C.length-1];case"vtc":switch(C[3]){case"nl":N[w][b]=!!+C[4];break;default:N[w][b]=+C[4];break}C[2]=="vtf"&&(N[w][b]=[N[w][b],U])}}}return g&&g.sheetRows&&(N=N.slice(0,g.sheetRows)),N}function r(m,g){return vi(t(m,g),g)}function a(m,g){return Ms(r(m,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var g=[],v=[],w,b="",k=gi(m["!ref"]),N=Array.isArray(m),C=k.s.r;C<=k.e.r;++C)for(var S=k.s.c;S<=k.e.c;++S)if(b=kt({r:C,c:S}),w=N?(m[C]||[])[S]:m[b],!(!w||w.v==null||w.t==="z")){switch(v=["cell",b,"t"],w.t){case"s":case"str":v.push(n(w.v));break;case"n":w.f?(v[2]="vtf",v[3]="n",v[4]=w.v,v[5]=n(w.f)):(v[2]="v",v[3]=w.v);break;case"b":v[2]="vt"+(w.f?"f":"c"),v[3]="nl",v[4]=w.v?"1":"0",v[5]=n(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var U=fn(Or(w.v));v[2]="vtc",v[3]="nd",v[4]=""+U,v[5]=w.w||Yn(w.z||bt[14],U);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(k.e.c-k.s.c+1)+":r:"+(k.e.r-k.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(m){return[o,l,c,l,h(m),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:p}})(),Sl=(function(){function e(p,m,g,v,w){w.raw?m[g][v]=p:p===""||(p==="TRUE"?m[g][v]=!0:p==="FALSE"?m[g][v]=!1:isNaN(oa(p))?isNaN(li(p).getDate())?m[g][v]=p:m[g][v]=Or(p):m[g][v]=oa(p))}function n(p,m){var g=m||{},v=[];if(!p||p.length===0)return v;for(var w=p.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var k=10,N=0,C=0;C<=b;++C)N=w[C].indexOf(" "),N==-1?N=w[C].length:N++,k=Math.max(k,N);for(C=0;C<=b;++C){v[C]=[];var S=0;for(e(w[C].slice(0,k).trim(),v,C,S,g),S=1;S<=(w[C].length-k)/10+1;++S)e(w[C].slice(k+(S-1)*10,k+S*10).trim(),v,C,S,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(p){for(var m={},g=!1,v=0,w=0;v<p.length;++v)(w=p.charCodeAt(v))==34?g=!g:!g&&w in t&&(m[w]=(m[w]||0)+1);w=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&w.push([m[v],v]);if(!w.length){m=r;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&w.push([m[v],v])}return w.sort(function(b,k){return b[0]-k[0]||r[b[1]]-r[k[1]]}),t[w.pop()[1]]||44}function o(p,m){var g=m||{},v="",w=g.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(v=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(v=p.charAt(4),p=p.slice(6)):v=a(p.slice(0,1024)):g&&g.FS?v=g.FS:v=a(p.slice(0,1024));var k=0,N=0,C=0,S=0,U=0,te=v.charCodeAt(0),Q=!1,D=0,K=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var W=g.dateNF!=null?u2(g.dateNF):null;function oe(){var J=p.slice(S,U),Y={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=J;else if(J.trim().length===0)Y.t="s",Y.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(Y.t="s",Y.v=J.slice(2,-1).replace(/""/g,'"')):LN(J)?(Y.t="n",Y.f=J.slice(1)):(Y.t="s",Y.v=J);else if(J=="TRUE")Y.t="b",Y.v=!0;else if(J=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(C=oa(J)))Y.t="n",g.cellText!==!1&&(Y.w=J),Y.v=C;else if(!isNaN(li(J).getDate())||W&&J.match(W)){Y.z=g.dateNF||bt[14];var pe=0;W&&J.match(W)&&(J=d2(J,g.dateNF,J.match(W)||[]),pe=1),g.cellDates?(Y.t="d",Y.v=Or(J,pe)):(Y.t="n",Y.v=fn(Or(J,pe))),g.cellText!==!1&&(Y.w=Yn(Y.z,Y.v instanceof Date?fn(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=J;if(Y.t=="z"||(g.dense?(w[k]||(w[k]=[]),w[k][N]=Y):w[kt({c:N,r:k})]=Y),S=U+1,K=p.charCodeAt(S),b.e.c<N&&(b.e.c=N),b.e.r<k&&(b.e.r=k),D==te)++N;else if(N=0,++k,g.sheetRows&&g.sheetRows<=k)return!0}e:for(;U<p.length;++U)switch(D=p.charCodeAt(U)){case 34:K===34&&(Q=!Q);break;case te:case 10:case 13:if(!Q&&oe())break e;break}return U-S>0&&oe(),w["!ref"]=jt(b),w}function l(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,m):vi(n(p,m),m)}function c(p,m){var g="",v=m.type=="string"?[0,0,0,0]:Np(p,m);switch(m.type){case"base64":g=Tn(p);break;case"binary":g=p;break;case"buffer":m.codepage==65001?g=p.toString("utf8"):m.codepage&&typeof wl<"u"||(g=Tt&&Buffer.isBuffer(p)?p.toString("binary"):yo(p));break;case"array":g=fo(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=Jt(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=Jt(g):m.type=="binary"&&typeof wl<"u",g.slice(0,19)=="socialcalc:version:"?JS.to_sheet(m.type=="string"?g:Jt(g),m):l(g,m)}function f(p,m){return Ms(c(p,m),m)}function h(p){for(var m=[],g=fr(p["!ref"]),v,w=Array.isArray(p),b=g.s.r;b<=g.e.r;++b){for(var k=[],N=g.s.c;N<=g.e.c;++N){var C=kt({r:b,c:N});if(v=w?(p[b]||[])[N]:p[C],!v||v.v==null){k.push("          ");continue}for(var S=(v.w||(Ja(v),v.w)||"").slice(0,10);S.length<10;)S+=" ";k.push(S+(N===0?" ":""))}m.push(k.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})();function eE(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=qS.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return Sl.to_workbook(e,n)}}var xl=(function(){function e(F,le,A){if(F){Ir(F,F.l||0);for(var T=A.Enum||re;F.l<F.length;){var j=F.read_shift(2),R=T[j]||T[65535],q=F.read_shift(2),H=F.l+q,B=R.f&&R.f(F,q,A);if(F.l=H,le(B,R,j))return}}}function n(F,le){switch(le.type){case"base64":return t(na(Tn(F)),le);case"binary":return t(na(F),le);case"buffer":case"array":return t(F,le)}throw"Unsupported type "+le.type}function t(F,le){if(!F)return F;var A=le||{},T=A.dense?[]:{},j="Sheet1",R="",q=0,H={},B=[],fe=[],I={s:{r:0,c:0},e:{r:0,c:0}},Fe=A.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)A.Enum=re,e(F,function(he,ue,we){switch(we){case 0:A.vers=he,he>=4096&&(A.qpro=!0);break;case 6:I=he;break;case 204:he&&(R=he);break;case 222:R=he;break;case 15:case 51:A.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:we==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=A.dateNF||bt[14],A.cellDates&&(he[1].t="d",he[1].v=Qu(he[1].v))),A.qpro&&he[3]>q&&(T["!ref"]=jt(I),H[j]=T,B.push(j),T=A.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},q=he[3],j=R||"Sheet"+(q+1),R="");var ve=A.dense?(T[he[0].r]||[])[he[0].c]:T[kt(he[0])];if(ve){ve.t=he[1].t,ve.v=he[1].v,he[1].z!=null&&(ve.z=he[1].z),he[1].f!=null&&(ve.f=he[1].f);break}A.dense?(T[he[0].r]||(T[he[0].r]=[]),T[he[0].r][he[0].c]=he[1]):T[kt(he[0])]=he[1];break}},A);else if(F[2]==26||F[2]==14)A.Enum=M,F[2]==14&&(A.qpro=!0,F.l=0),e(F,function(he,ue,we){switch(we){case 204:j=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>q&&(T["!ref"]=jt(I),H[j]=T,B.push(j),T=A.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},q=he[3],j="Sheet"+(q+1)),Fe>0&&he[0].r>=Fe)break;A.dense?(T[he[0].r]||(T[he[0].r]=[]),T[he[0].r][he[0].c]=he[1]):T[kt(he[0])]=he[1],I.e.c<he[0].c&&(I.e.c=he[0].c),I.e.r<he[0].r&&(I.e.r=he[0].r);break;case 27:he[14e3]&&(fe[he[14e3][0]]=he[14e3][1]);break;case 1537:fe[he[0]]=he[1],he[0]==q&&(j=he[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(T["!ref"]=jt(I),H[R||j]=T,B.push(R||j),!fe.length)return{SheetNames:B,Sheets:H};for(var Pe={},Qe=[],qe=0;qe<fe.length;++qe)H[B[qe]]?(Qe.push(fe[qe]||B[qe]),Pe[fe[qe]]=H[fe[qe]]||H[B[qe]]):(Qe.push(fe[qe]),Pe[fe[qe]]={"!ref":"A1"});return{SheetNames:Qe,Sheets:Pe}}function r(F,le){var A=le||{};if(+A.codepage>=0&&aa(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var T=Ef(),j=fr(F["!ref"]),R=Array.isArray(F),q=[];ra(T,0,o(1030)),ra(T,6,f(j));for(var H=Math.min(j.e.r,8191),B=j.s.r;B<=H;++B)for(var fe=Wr(B),I=j.s.c;I<=j.e.c;++I){B===j.s.r&&(q[I]=Cr(I));var Fe=q[I]+fe,Pe=R?(F[B]||[])[I]:F[Fe];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")(Pe.v|0)==Pe.v&&Pe.v>=-32768&&Pe.v<=32767?ra(T,13,v(B,I,Pe.v)):ra(T,14,b(B,I,Pe.v));else{var Qe=Ja(Pe);ra(T,15,m(B,I,Qe.slice(0,239)))}}return ra(T,1),T.end()}function a(F,le){var A=le||{};if(+A.codepage>=0&&aa(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var T=Ef();ra(T,0,l(F));for(var j=0,R=0;j<F.SheetNames.length;++j)(F.Sheets[F.SheetNames[j]]||{})["!ref"]&&ra(T,27,O(F.SheetNames[j],R++));var q=0;for(j=0;j<F.SheetNames.length;++j){var H=F.Sheets[F.SheetNames[j]];if(!(!H||!H["!ref"])){for(var B=fr(H["!ref"]),fe=Array.isArray(H),I=[],Fe=Math.min(B.e.r,8191),Pe=B.s.r;Pe<=Fe;++Pe)for(var Qe=Wr(Pe),qe=B.s.c;qe<=B.e.c;++qe){Pe===B.s.r&&(I[qe]=Cr(qe));var he=I[qe]+Qe,ue=fe?(H[Pe]||[])[qe]:H[he];if(!(!ue||ue.t=="z"))if(ue.t=="n")ra(T,23,oe(Pe,qe,q,ue.v));else{var we=Ja(ue);ra(T,22,D(Pe,qe,q,we.slice(0,239)))}}++q}}return ra(T,1),T.end()}function o(F){var le=Nr(2);return le.write_shift(2,F),le}function l(F){var le=Nr(26);le.write_shift(2,4096),le.write_shift(2,4),le.write_shift(4,0);for(var A=0,T=0,j=0,R=0;R<F.SheetNames.length;++R){var q=F.SheetNames[R],H=F.Sheets[q];if(!(!H||!H["!ref"])){++j;var B=gi(H["!ref"]);A<B.e.r&&(A=B.e.r),T<B.e.c&&(T=B.e.c)}}return A>8191&&(A=8191),le.write_shift(2,A),le.write_shift(1,j),le.write_shift(1,T),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(1,1),le.write_shift(1,2),le.write_shift(4,0),le.write_shift(4,0),le}function c(F,le,A){var T={s:{c:0,r:0},e:{c:0,r:0}};return le==8&&A.qpro?(T.s.c=F.read_shift(1),F.l++,T.s.r=F.read_shift(2),T.e.c=F.read_shift(1),F.l++,T.e.r=F.read_shift(2),T):(T.s.c=F.read_shift(2),T.s.r=F.read_shift(2),le==12&&A.qpro&&(F.l+=2),T.e.c=F.read_shift(2),T.e.r=F.read_shift(2),le==12&&A.qpro&&(F.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function f(F){var le=Nr(8);return le.write_shift(2,F.s.c),le.write_shift(2,F.s.r),le.write_shift(2,F.e.c),le.write_shift(2,F.e.r),le}function h(F,le,A){var T=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(T[0].c=F.read_shift(1),T[3]=F.read_shift(1),T[0].r=F.read_shift(2),F.l+=2):(T[2]=F.read_shift(1),T[0].c=F.read_shift(2),T[0].r=F.read_shift(2)),T}function p(F,le,A){var T=F.l+le,j=h(F,le,A);if(j[1].t="s",A.vers==20768){F.l++;var R=F.read_shift(1);return j[1].v=F.read_shift(R,"utf8"),j}return A.qpro&&F.l++,j[1].v=F.read_shift(T-F.l,"cstr"),j}function m(F,le,A){var T=Nr(7+A.length);T.write_shift(1,255),T.write_shift(2,le),T.write_shift(2,F),T.write_shift(1,39);for(var j=0;j<T.length;++j){var R=A.charCodeAt(j);T.write_shift(1,R>=128?95:R)}return T.write_shift(1,0),T}function g(F,le,A){var T=h(F,le,A);return T[1].v=F.read_shift(2,"i"),T}function v(F,le,A){var T=Nr(7);return T.write_shift(1,255),T.write_shift(2,le),T.write_shift(2,F),T.write_shift(2,A,"i"),T}function w(F,le,A){var T=h(F,le,A);return T[1].v=F.read_shift(8,"f"),T}function b(F,le,A){var T=Nr(13);return T.write_shift(1,255),T.write_shift(2,le),T.write_shift(2,F),T.write_shift(8,A,"f"),T}function k(F,le,A){var T=F.l+le,j=h(F,le,A);if(j[1].v=F.read_shift(8,"f"),A.qpro)F.l=T;else{var R=F.read_shift(2);U(F.slice(F.l,F.l+R),j),F.l+=R}return j}function N(F,le,A){var T=le&32768;return le&=-32769,le=(T?F:0)+(le>=8192?le-16384:le),(T?"":"$")+(A?Cr(le):Wr(le))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(F,le){Ir(F,0);for(var A=[],T=0,j="",R="",q="",H="";F.l<F.length;){var B=F[F.l++];switch(B){case 0:A.push(F.read_shift(8,"f"));break;case 1:R=N(le[0].c,F.read_shift(2),!0),j=N(le[0].r,F.read_shift(2),!1),A.push(R+j);break;case 2:{var fe=N(le[0].c,F.read_shift(2),!0),I=N(le[0].r,F.read_shift(2),!1);R=N(le[0].c,F.read_shift(2),!0),j=N(le[0].r,F.read_shift(2),!1),A.push(fe+I+":"+R+j)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(F.read_shift(2));break;case 6:{for(var Fe="";B=F[F.l++];)Fe+=String.fromCharCode(B);A.push('"'+Fe.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:H=A.pop(),q=A.pop(),A.push(["AND","OR"][B-20]+"("+q+","+H+")");break;default:if(B<32&&S[B])H=A.pop(),q=A.pop(),A.push(q+S[B]+H);else if(C[B]){if(T=C[B][1],T==69&&(T=F[F.l++]),T>A.length){console.error("WK1 bad formula parse 0x"+B.toString(16)+":|"+A.join("|")+"|");return}var Pe=A.slice(-T);A.length-=T,A.push(C[B][0]+"("+Pe.join(",")+")")}else return B<=7?console.error("WK1 invalid opcode "+B.toString(16)):B<=24?console.error("WK1 unsupported op "+B.toString(16)):B<=30?console.error("WK1 invalid opcode "+B.toString(16)):B<=115?console.error("WK1 unsupported function opcode "+B.toString(16)):console.error("WK1 unrecognized opcode "+B.toString(16))}}A.length==1?le[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function te(F){var le=[{c:0,r:0},{t:"n",v:0},0];return le[0].r=F.read_shift(2),le[3]=F[F.l++],le[0].c=F[F.l++],le}function Q(F,le){var A=te(F);return A[1].t="s",A[1].v=F.read_shift(le-4,"cstr"),A}function D(F,le,A,T){var j=Nr(6+T.length);j.write_shift(2,F),j.write_shift(1,A),j.write_shift(1,le),j.write_shift(1,39);for(var R=0;R<T.length;++R){var q=T.charCodeAt(R);j.write_shift(1,q>=128?95:q)}return j.write_shift(1,0),j}function K(F,le){var A=te(F);A[1].v=F.read_shift(2);var T=A[1].v>>1;if(A[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return A[1].v=T,A}function W(F,le){var A=te(F),T=F.read_shift(4),j=F.read_shift(4),R=F.read_shift(2);if(R==65535)return T===0&&j===3221225472?(A[1].t="e",A[1].v=15):T===0&&j===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var q=R&32768;return R=(R&32767)-16446,A[1].v=(1-q*2)*(j*Math.pow(2,R+32)+T*Math.pow(2,R)),A}function oe(F,le,A,T){var j=Nr(14);if(j.write_shift(2,F),j.write_shift(1,A),j.write_shift(1,le),T==0)return j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,65535),j;var R=0,q=0,H=0,B=0;return T<0&&(R=1,T=-T),q=Math.log2(T)|0,T/=Math.pow(2,q-31),B=T>>>0,(B&2147483648)==0&&(T/=2,++q,B=T>>>0),T-=B,B|=2147483648,B>>>=0,T*=Math.pow(2,32),H=T>>>0,j.write_shift(4,H),j.write_shift(4,B),q+=16383+(R?32768:0),j.write_shift(2,q),j}function J(F,le){var A=W(F);return F.l+=le-14,A}function Y(F,le){var A=te(F),T=F.read_shift(4);return A[1].v=T>>6,A}function pe(F,le){var A=te(F),T=F.read_shift(8,"f");return A[1].v=T,A}function de(F,le){var A=pe(F);return F.l+=le-10,A}function G(F,le){return F[F.l+le-1]==0?F.read_shift(le,"cstr"):""}function ie(F,le){var A=F[F.l++];A>le-1&&(A=le-1);for(var T="";T.length<A;)T+=String.fromCharCode(F[F.l++]);return T}function L(F,le,A){if(!(!A.qpro||le<21)){var T=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var j=F.read_shift(le-21,"cstr");return[T,j]}}function ne(F,le){for(var A={},T=F.l+le;F.l<T;){var j=F.read_shift(2);if(j==14e3){for(A[j]=[0,""],A[j][0]=F.read_shift(2);F[F.l];)A[j][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return A}function O(F,le){var A=Nr(5+F.length);A.write_shift(2,14e3),A.write_shift(2,le);for(var T=0;T<F.length;++T){var j=F.charCodeAt(T);A[A.l++]=j>127?95:j}return A[A.l++]=0,A}var re={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:k},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:G},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},M={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Q},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:pe},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:G},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:L},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function tE(e){var n={},t=e.match(Zr),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=vt(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=rp[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var rE=(function(){var e=bl("t"),n=bl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:Ot(l[1])},f=o.match(n);return f&&(c.s=tE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),nE=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),aE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sE=/<(?:\w+:)?r>/,oE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Ot(Jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Jt(e),t&&(r.h=cp(r.t))):e.match(sE)&&(r.r=Jt(e),r.t=Ot(Jt((e.replace(oE,"").match(aE)||[]).join("").replace(Zr,""))),t&&(r.h=nE(rE(r.r)))),r):{t:""}}var iE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,lE=/<(?:\w+:)?(?:si|sstItem)>/g,cE=/<\/(?:\w+:)?(?:si|sstItem)>/;function uE(e,n){var t=[],r="";if(!e)return t;var a=e.match(iE);if(a){r=a[2].replace(lE,"").split(cE);for(var o=0;o!=r.length;++o){var l=yp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=vt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function dE(e){return[e.read_shift(4),e.read_shift(4)]}function fE(e,n){var t=[],r=!1;return ts(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function V1(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Ka(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function pE(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Ka(e,4),n.U=Ka(e,4),n.W=Ka(e,4),n}function hE(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function xE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(hE(e));return n}function mE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function gE(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Ka(e,4),n.U=Ka(e,4),n.W=Ka(e,4),n}function vE(e){var n=gE(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function K1(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function G1(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function yE(e){var n=Ka(e);switch(n.Minor){case 2:return[n.Minor,wE(e)];case 3:return[n.Minor,kE()];case 4:return[n.Minor,bE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function wE(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=K1(e,t),a=G1(e,e.length-e.l);return{t:"Std",h:r,v:a}}function kE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function bE(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(Zr,function(o){var l=vt(o);switch(Da(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function _E(e,n){var t={},r=t.EncryptionVersionInfo=Ka(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=K1(e,a),n-=a,t.EncryptionVerifier=G1(e,n),t}function SE(e){var n={},t=n.EncryptionVersionInfo=Ka(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function EE(e){var n=0,t,r=V1(e),a=r.length+1,o,l,c,f,h;for(t=As(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,h=c|f,n=h^l;return n^52811}var Q1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var p=l[h],m=0;m!=7;++m)p&64&&(c^=t[f]),p*=2,--f;return c};return function(l){for(var c=V1(l),f=o(c),h=c.length,p=As(16),m=0;m!=16;++m)p[m]=0;var g,v,w;for((h&1)===1&&(g=f>>8,p[h]=a(e[0],g),--h,g=f&255,v=c[c.length-1],p[h]=a(v,g));h>0;)--h,g=f>>8,p[h]=a(c[h],g),--h,g=f&255,p[h]=a(c[h],g);for(h=15,w=15-c.length;w>0;)g=f>>8,p[h]=a(e[w],g),--h,--w,g=f&255,p[h]=a(c[h],g),--h,--w;return p}})(),NE=function(e,n,t,r,a){a||(a=n),r||(r=Q1(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},CE=function(e){var n=0,t=Q1(e);return function(r){var a=NE("",r,n,t);return n=a[1],a[0]}};function TE(e,n,t,r){var a={key:_r(e),verificationBytes:_r(e)};return t.password&&(a.verifier=EE(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=CE(t.password)),a}function DE(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=SE(e):r.Data=_E(e,n),r}function jE(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?DE(e,n-2,r):TE(e,t.biff>=8?n:n-2,t,r),r}var FE=(function(){function e(a,o){switch(o.type){case"base64":return n(Tn(a),o);case"binary":return n(a,o);case"buffer":return n(Tt&&Buffer.isBuffer(a)?a.toString("binary"):yo(a),o);case"array":return n(fo(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,m){Array.isArray(c)&&(c[m]=[]);for(var g=/\\\w+\b/g,v=0,w,b=-1;w=g.exec(p);){switch(w[0]){case"\\cell":var k=p.slice(v,g.lastIndex-w[0].length);if(k[0]==" "&&(k=k.slice(1)),++b,k.length){var N={v:k,t:"s"};Array.isArray(c)?c[m][b]=N:c[kt({r:m,c:b})]=N}break}v=g.lastIndex}b>h.e.c&&(h.e.c=b)}),c["!ref"]=jt(h),c}function t(a,o){return Ms(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=fr(a["!ref"]),c,f=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var m=kt({r:h,c:p});c=f?(a[h]||[])[p]:a[m],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Ja(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function PE(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function El(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function AE(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,h=a+o;switch(f=l/(h>1?2-h:h),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,h/2]}function OE(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function ju(e,n){if(n===0)return e;var t=AE(PE(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),El(OE(t))}var X1=6,RE=15,zE=1,sn=X1;function Fu(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function Pu(e){return Math.floor((e-5)/sn*100+.5)/100}function Df(e){return Math.round((e*sn+5)/sn*256)/256}function tf(e){return Df(Pu(Fu(e)))}function wp(e){var n=Math.abs(e-tf(e)),t=sn;if(n>.005)for(sn=zE;sn<RE;++sn)Math.abs(e-tf(e))<=n&&(n=Math.abs(e-tf(e)),t=sn);sn=t}function ci(e){e.width?(e.wpx=Fu(e.width),e.wch=Pu(e.wpx),e.MDW=sn):e.wpx?(e.wch=Pu(e.wpx),e.width=Df(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Df(e.wch),e.wpx=Fu(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var ME=96,q1=ME;function Z1(e){return e*96/q1}function Nl(e){return e*q1/96}var IE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function LE(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(Zr)||[]).forEach(function(l){var c=vt(l);switch(Da(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=ar(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=ar(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function BE(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(Zr)||[]).forEach(function(l){var c=vt(l);switch(Da(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function WE(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(Zr)||[]).forEach(function(l){var c=vt(l);switch(Da(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Jt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?ar(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?ar(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?ar(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?ar(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?ar(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?ar(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?ar(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=rp[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=ar(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=so[a.color.index];a.color.index==81&&(f=so[1]),f||(f=so[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=ju(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function UE(e,n,t){n.NumberFmt=[];for(var r=Ca(bt),a=0;a<r.length;++a)n.NumberFmt[r[a]]=bt[r[a]];var o=e[0].match(Zr);if(o)for(a=0;a<o.length;++a){var l=vt(o[a]);switch(Da(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ot(Jt(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}ao(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var su=["numFmtId","fillId","fontId","borderId","xfId"],ou=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function $E(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(Zr)||[]).forEach(function(o){var l=vt(o),c=0;switch(Da(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<su.length;++c)r[su[c]]&&(r[su[c]]=parseInt(r[su[c]],10));for(c=0;c<ou.length;++c)r[ou[c]]&&(r[ou[c]]=ar(r[ou[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=ar(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var HE=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,h){var p={};if(!c)return p;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(n))&&UE(m,p,h),(m=c.match(a))&&WE(m,p,f,h),(m=c.match(r))&&BE(m,p,f,h),(m=c.match(o))&&LE(m,p,f,h),(m=c.match(t))&&$E(m,p,h),p}})();function YE(e,n){var t=e.read_shift(2),r=Xr(e);return[t,r]}function VE(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=r_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=t_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Xr(e),r}var KE=qr;function GE(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var QE=qr;function XE(e,n,t){var r={};r.NumberFmt=[];for(var a in bt)r.NumberFmt[a]=bt[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return ts(e,function(f,h,p){switch(p){case 44:r.NumberFmt[f[0]]=f[1],ao(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=ju(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(p);else if(h.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var qE=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ZE(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(Zr)||[]).forEach(function(a){var o=vt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[qE.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function JE(){}function eN(){}var tN=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,rN=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,nN=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function aN(e,n,t){n.themeElements={};var r;[["clrScheme",tN,ZE],["fontScheme",rN,JE],["fmtScheme",nN,eN]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var sN=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function J1(e,n){(!e||e.length===0)&&(e=oN());var t,r={};if(!(t=e.match(sN)))throw new Error("themeElements not found in theme");return aN(t[0],r,n),r.raw=e,r}function oN(e,n){var t=[u1];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function iN(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=c1(o,{type:"array"})}catch{return}var c=Nn(l,"theme/theme/theme1.xml",!0);if(c)return J1(c,t)}}function lN(e){return e.read_shift(4)}function cN(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=uN(e,4);break;case 2:n.xclrValue=L1(e);break;case 3:n.xclrValue=lN(e);break;case 4:e.l+=4;break}return e.l+=8,n}function uN(e,n){return qr(e,n)}function dN(e,n){return qr(e,n)}function fN(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=cN(e);break;case 6:r[1]=dN(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function pN(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(fN(e,t-e.l));return{ixfe:r,ext:o}}function hN(e,n){n.forEach(function(t){t[0]})}function xN(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Xr(e)}}function mN(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function gN(e){return e.l+=4,e.read_shift(4)!=0}function vN(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return ts(e,function(f,h,p){switch(p){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?r.Cell.push({type:r.Types[m[0]-1].name,index:m[1]}):c==0&&r.Value.push({type:r.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function yN(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(Zr,function(c){var f=vt(c);switch(Da(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==f.name&&(l=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function wN(e){var n=[];if(!e)return n;var t=1;return(e.match(Zr)||[]).forEach(function(r){var a=vt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function kN(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=kt(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function bN(e,n,t){var r=[];return ts(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function _N(e,n,t,r){if(!e)return e;var a=r||{},o=!1;ts(e,function(c,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function SN(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function Sg(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=ln(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=fr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var h=jt(f);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:t};l.h&&(p.h=l.h);for(var m=o.c.length-1;m>=0;--m){if(!t&&o.c[m].T)return;t&&!o.c[m].T&&o.c.splice(m,1)}if(t&&r){for(m=0;m<r.length;++m)if(p.a==r[m].id){p.a=r[m].name||p.a;break}}o.c.push(p)})}function EN(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=vt(c[0]),h={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=ln(f.ref);if(!(n.sheetRows&&n.sheetRows<=p.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&yp(m[1])||{r:"",t:"",h:""};h.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),h.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(h.h=g.h),r.push(h)}}}}),r}function NN(e,n){var t=[],r=!1,a={},o=0;return e.replace(Zr,function(c,f){var h=vt(c);switch(Da(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function CN(e,n){var t=[],r=!1;return e.replace(Zr,function(o){var l=vt(o);switch(Da(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function TN(e){var n={};n.iauthor=e.read_shift(4);var t=ko(e);return n.rfx=t.s,n.ref=kt(t.s),e.l+=16,n}var DN=Xr;function jN(e,n){var t=[],r=[],a={},o=!1;return ts(e,function(c,f,h){switch(h){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var FN="application/vnd.ms-office.vbaProject";function PN(e){var n=Dt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(n,a,e.FileIndex[r].content)}}),Dt.write(n)}function AN(){return{"!type":"dialog"}}function ON(){return{"!type":"dialog"}}function RN(){return{"!type":"macro"}}function zN(){return{"!type":"macro"}}var ni=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return c?p+=n.c:--p,f?h+=n.r:--h,a+(c?"":"$")+Cr(p)+(f?"":"$")+Wr(h)}return function(a,o){return n=o,a.replace(e,t)}})(),ey=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,MN=(function(){return function(n,t){return n.replace(ey,function(r,a,o,l,c,f){var h=pp(l)-(o?0:t.c),p=fp(f)-(c?0:t.r),m=p==0?"":c?p+1:"["+p+"]",g=h==0?"":o?h+1:"["+h+"]";return a+"R"+m+"C"+g})}})();function ty(e,n){return e.replace(ey,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Cr(pp(o)+n.c))+(l=="$"?l+c:Wr(fp(c)+n.r))})}function IN(e,n,t){var r=gi(n),a=r.s,o=ln(t),l={r:o.r-a.r,c:o.c-a.c};return ty(e,l)}function LN(e){return e.length!=1}function Eg(e){return e.replace(/_xlfn\./g,"")}function kr(e){e.l+=1}function Os(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function ry(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return ny(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Os(e),c=Os(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function ny(e){var n=Os(e),t=Os(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function BN(e,n,t){if(t.biff<8)return ny(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=Os(e),l=Os(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ay(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return WN(e);var r=e.read_shift(t&&t.biff==12?4:2),a=Os(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function WN(e){var n=Os(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function UN(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function $N(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return HN(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function HN(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function YN(e,n,t){var r=(e[e.l++]&96)>>5,a=ry(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function VN(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=ry(e,o,t);return[r,a,l]}function KN(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function GN(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function QN(e,n,t){var r=(e[e.l++]&96)>>5,a=BN(e,n-1,t);return[r,a]}function XN(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Ng(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function qN(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function ZN(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function JN(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function eC(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function tC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function sy(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function rC(e){return e.read_shift(2),sy(e)}function nC(e){return e.read_shift(2),sy(e)}function aC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=ay(e,0,t);return[r,a]}function sC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=$N(e,0,t);return[r,a]}function oC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=ay(e,0,t);return[r,a,o]}function iC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[lT[a],ly[a],r]}function lC(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:cC(e);return[a,(o[0]===0?ly:iT)[o[1]]]}function cC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function uC(e,n,t){e.l+=t&&t.biff==2?3:4}function dC(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function fC(e){return e.l++,bo[e.read_shift(1)]}function pC(e){return e.l++,e.read_shift(2)}function hC(e){return e.l++,e.read_shift(1)!==0}function xC(e){return e.l++,Gr(e)}function mC(e,n,t){return e.l++,Ol(e,n-1,t)}function gC(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=gr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=bo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Gr(e);break;case 2:t[1]=_o(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function vC(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?ko:Xu)(e));return a}function yC(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=gC(e,t.biff);return l}function wC(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function kC(e,n,t){if(t.biff==5)return bC(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function bC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function _C(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function SC(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function EC(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function NC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var CC=qr,TC=qr,DC=qr;function zl(e,n,t){return e.l+=2,[UN(e)]}function kp(e){return e.l+=6,[]}var jC=zl,FC=kp,PC=kp,AC=zl;function oy(e){return e.l+=2,[_r(e),e.read_shift(2)&1]}var OC=zl,RC=oy,zC=kp,MC=zl,IC=zl,LC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function BC(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=LC[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function WC(e){return e.l+=2,[e.read_shift(4)]}function UC(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function $C(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function HC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function YC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function VC(e){return e.l+=4,[0,0]}var Cg={1:{n:"PtgExp",f:dC},2:{n:"PtgTbl",f:DC},3:{n:"PtgAdd",f:kr},4:{n:"PtgSub",f:kr},5:{n:"PtgMul",f:kr},6:{n:"PtgDiv",f:kr},7:{n:"PtgPower",f:kr},8:{n:"PtgConcat",f:kr},9:{n:"PtgLt",f:kr},10:{n:"PtgLe",f:kr},11:{n:"PtgEq",f:kr},12:{n:"PtgGe",f:kr},13:{n:"PtgGt",f:kr},14:{n:"PtgNe",f:kr},15:{n:"PtgIsect",f:kr},16:{n:"PtgUnion",f:kr},17:{n:"PtgRange",f:kr},18:{n:"PtgUplus",f:kr},19:{n:"PtgUminus",f:kr},20:{n:"PtgPercent",f:kr},21:{n:"PtgParen",f:kr},22:{n:"PtgMissArg",f:kr},23:{n:"PtgStr",f:mC},26:{n:"PtgSheet",f:UC},27:{n:"PtgEndSheet",f:$C},28:{n:"PtgErr",f:fC},29:{n:"PtgBool",f:hC},30:{n:"PtgInt",f:pC},31:{n:"PtgNum",f:xC},32:{n:"PtgArray",f:XN},33:{n:"PtgFunc",f:iC},34:{n:"PtgFuncVar",f:lC},35:{n:"PtgName",f:wC},36:{n:"PtgRef",f:aC},37:{n:"PtgArea",f:YN},38:{n:"PtgMemArea",f:_C},39:{n:"PtgMemErr",f:CC},40:{n:"PtgMemNoMem",f:TC},41:{n:"PtgMemFunc",f:SC},42:{n:"PtgRefErr",f:EC},43:{n:"PtgAreaErr",f:KN},44:{n:"PtgRefN",f:sC},45:{n:"PtgAreaN",f:QN},46:{n:"PtgMemAreaN",f:HC},47:{n:"PtgMemNoMemN",f:YC},57:{n:"PtgNameX",f:kC},58:{n:"PtgRef3d",f:oC},59:{n:"PtgArea3d",f:VN},60:{n:"PtgRefErr3d",f:NC},61:{n:"PtgAreaErr3d",f:GN},255:{}},KC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},GC={1:{n:"PtgElfLel",f:oy},2:{n:"PtgElfRw",f:MC},3:{n:"PtgElfCol",f:jC},6:{n:"PtgElfRwV",f:IC},7:{n:"PtgElfColV",f:AC},10:{n:"PtgElfRadical",f:OC},11:{n:"PtgElfRadicalS",f:zC},13:{n:"PtgElfColS",f:FC},15:{n:"PtgElfColSV",f:PC},16:{n:"PtgElfRadicalLel",f:RC},25:{n:"PtgList",f:BC},29:{n:"PtgSxName",f:WC},255:{}},QC={0:{n:"PtgAttrNoop",f:VC},1:{n:"PtgAttrSemi",f:tC},2:{n:"PtgAttrIf",f:JN},4:{n:"PtgAttrChoose",f:qN},8:{n:"PtgAttrGoto",f:ZN},16:{n:"PtgAttrSum",f:uC},32:{n:"PtgAttrBaxcel",f:Ng},33:{n:"PtgAttrBaxcel",f:Ng},64:{n:"PtgAttrSpace",f:rC},65:{n:"PtgAttrSpaceSemi",f:nC},128:{n:"PtgAttrIfError",f:eC},255:{}};function Ml(e,n,t,r){if(r.biff<8)return qr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=yC(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=vC(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(qr(e,n)),o}function Il(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Cg[o]||Cg[KC[o]],(o===24||o===25)&&(a=(o===24?GC:QC)[e[e.l+1]]),!a||!a.f?qr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function XC(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var qC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ZC(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function iy(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Tg(e,n,t){var r=iy(e,n,t);return r=="#REF"?r:ZC(r,t)}function Kr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,h,p,m=0,g=0,v,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,k="",N=0,C=e[0].length;N<C;++N){var S=e[0][N];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),b>=0){switch(e[0][b][1][0]){case 0:k=dr(" ",e[0][b][1][1]);break;case 1:k=dr("\r",e[0][b][1][1]);break;default:if(k="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}h=h+k,b=-1}c.push(h+qC[S[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=dl(S[1][1],l,a),c.push(fl(p,o));break;case"PtgRefN":p=t?dl(S[1][1],t,a):S[1][1],c.push(fl(p,o));break;case"PtgRef3d":m=S[1][1],p=dl(S[1][2],l,a),w=Tg(r,m,a),c.push(w+"!"+fl(p,o));break;case"PtgFunc":case"PtgFuncVar":var U=S[1][0],te=S[1][1];U||(U=0),U&=127;var Q=U==0?[]:c.slice(-U);c.length-=U,te==="User"&&(te=Q.shift()),c.push(te+"("+Q.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":v=lg(S[1][1],t?{s:t}:l,a),c.push(J0(v,a));break;case"PtgArea":v=lg(S[1][1],l,a),c.push(J0(v,a));break;case"PtgArea3d":m=S[1][1],v=S[1][2],w=Tg(r,m,a),c.push(w+"!"+J0(v,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=S[1][2];var D=(r.names||[])[g-1]||(r[0]||[])[g],K=D?D.Name:"SH33TJSNAME"+String(g);K&&K.slice(0,6)=="_xlfn."&&!a.xlfn&&(K=K.slice(6)),c.push(K);break;case"PtgNameX":var W=S[1][1];g=S[1][2];var oe;if(a.biff<=5)W<0&&(W=-W),r[W]&&(oe=r[W][g]);else{var J="";if(((r[W]||[])[0]||[])[0]==14849||(((r[W]||[])[0]||[])[0]==1025?r[W][g]&&r[W][g].itab>0&&(J=r.SheetNames[r[W][g].itab-1]+"!"):J=r.SheetNames[g-1]+"!"),r[W]&&r[W][g])J+=r[W][g].Name;else if(r[0]&&r[0][g])J+=r[0][g].Name;else{var Y=(iy(r,W,a)||"").split(";;");Y[g-1]?J=Y[g-1]:J+="SH33TJSERRX"}c.push(J);break}oe||(oe={Name:"SH33TJSERRY"}),c.push(oe.Name);break;case"PtgParen":var pe="(",de=")";if(b>=0){switch(k="",e[0][b][1][0]){case 2:pe=dr(" ",e[0][b][1][1])+pe;break;case 3:pe=dr("\r",e[0][b][1][1])+pe;break;case 4:de=dr(" ",e[0][b][1][1])+de;break;case 5:de=dr("\r",e[0][b][1][1])+de;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}c.push(pe+c.pop()+de);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var G={c:t.c,r:t.r};if(r.sharedf[kt(p)]){var ie=r.sharedf[kt(p)];c.push(Kr(ie,l,G,r,a))}else{var L=!1;for(f=0;f!=r.arrayf.length;++f)if(h=r.arrayf[f],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Kr(h[1],l,G,r,a)),L=!0;break}L||c.push(S[1])}break;case"PtgArray":c.push("{"+XC(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&ne.indexOf(e[0][N][0])==-1){S=e[0][b];var O=!0;switch(S[1][0]){case 4:O=!1;case 0:k=dr(" ",S[1][1]);break;case 5:O=!1;case 1:k=dr("\r",S[1][1]);break;default:if(k="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((O?k:"")+c.pop()+(O?"":k)),b=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function JC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],qr(e,n-2)];var c=Il(e,l,t);return n!==l+a&&(o=Ml(e,n-l-a,c,t)),e.l=r,[c,o]}function eT(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],qr(e,n-2)];var c=Il(e,l,t);return n!==l+a&&(o=Ml(e,n-l-a,c,t)),e.l=r,[c,o]}function tT(e,n,t,r){var a=e.l+n,o=Il(e,r,t),l;return a!==e.l&&(l=Ml(e,a-e.l,o,t)),[o,l]}function rT(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=Il(e,o,t);return o==65535?[[],qr(e,n-2)]:(n!==o+2&&(a=Ml(e,r-o-2,l,t)),[l,a])}function nT(e){var n;if(Ya(e,e.l+6)!==65535)return[Gr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function rf(e,n,t){var r=e.l+n,a=ja(e);t.biff==2&&++e.l;var o=nT(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=eT(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function qu(e,n,t){var r=e.read_shift(4),a=Il(e,r,t),o=e.read_shift(4),l=o>0?Ml(e,o,a,t):null;return[a,l]}var aT=qu,Zu=qu,sT=qu,oT=qu,iT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ly={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lT={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function nf(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var ml={},ai={};function gl(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function cy(e,n,t,r,a,o){try{r.cellNF&&(e.z=bt[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Or(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(bt[n]==null&&ao(c2[n]||"General",n),e.t==="e")e.w=e.w||bo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v);else if(e.t==="d"){var l=fn(e.v);(l|0)===l?e.w=l.toString(10):e.w=kl(l)}else{if(e.v===void 0)return"";e.w=uo(e.v,ai)}else e.t==="d"?e.w=Yn(n,fn(e.v),ai):e.w=Yn(n,e.v,ai)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ju(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ju(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function cT(e,n){var t=fr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=jt(t))}var uT=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,dT=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,fT=/<(?:\w:)?hyperlink [^>]*>/mg,pT=/"(\w*:\w*)"/,hT=/<(?:\w:)?col\b[^>]*[\/]?>/g,xT=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,mT=/<(?:\w:)?pageMargins[^>]*\/>/g,uy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,gT=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,vT=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function yT(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",m=e.match(dT);m?(h=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):h=p=e;var g=h.match(uy);g?bp(g[0],c,a,t):(g=h.match(gT))&&wT(g[0],g[1]||"",c,a,t);var v=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var w=h.slice(v,v+50).match(pT);w&&cT(c,w[1])}var b=h.match(vT);b&&b[1]&&NT(b[1],a);var k=[];if(n.cellStyles){var N=h.match(hT);N&&_T(k,N)}m&&CT(m[1],c,n,f,o,l);var C=p.match(xT);C&&(c["!autofilter"]=ST(C[0]));var S=[],U=p.match(uT);if(U)for(v=0;v!=U.length;++v)S[v]=fr(U[v].slice(U[v].indexOf('"')+1));var te=p.match(fT);te&&kT(c,te,r);var Q=p.match(mT);if(Q&&(c["!margins"]=bT(vt(Q[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=jt(f)),n.sheetRows>0&&c["!ref"]){var D=fr(c["!ref"]);n.sheetRows<=+D.e.r&&(D.e.r=n.sheetRows-1,D.e.r>f.e.r&&(D.e.r=f.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>f.e.c&&(D.e.c=f.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),c["!fullref"]=c["!ref"],c["!ref"]=jt(D))}return k.length>0&&(c["!cols"]=k),S.length>0&&(c["!merges"]=S),c}function bp(e,n,t,r){var a=vt(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=Ot(Jt(a.codeName)))}function wT(e,n,t,r,a){bp(e.slice(0,e.indexOf(">")),t,r,a)}function kT(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=vt(Jt(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Ot(o.location))):(o.Target="#"+Ot(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=fr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var h=c.s.c;h<=c.e.c;++h){var p=kt({c:h,r:f});r?(e[f]||(e[f]=[]),e[f][h]||(e[f][h]={t:"z",v:void 0}),e[f][h].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function bT(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function _T(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=vt(n[r],!0);a.hidden&&(a.hidden=ar(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,wp(a.width)),ci(a);o<=l;)e[o++]=Br(a)}}function ST(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var ET=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function NT(e,n){n.Views||(n.Views=[{}]),(e.match(ET)||[]).forEach(function(t,r){var a=vt(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),ar(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var CT=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=bl("v"),l=bl("f");return function(f,h,p,m,g,v){for(var w=0,b="",k=[],N=[],C=0,S=0,U=0,te="",Q,D,K=0,W=0,oe,J,Y=0,pe=0,de=Array.isArray(v.CellXf),G,ie=[],L=[],ne=Array.isArray(h),O=[],re={},M=!1,F=!!p.sheetStubs,le=f.split(n),A=0,T=le.length;A!=T;++A){b=le[A].trim();var j=b.length;if(j!==0){var R=0;e:for(w=0;w<j;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(D=vt(b.slice(R,w),!0),K=D.r!=null?parseInt(D.r,10):K+1,W=-1,p.sheetRows&&p.sheetRows<K)continue;re={},M=!1,D.ht&&(M=!0,re.hpt=parseFloat(D.ht),re.hpx=Nl(re.hpt)),D.hidden=="1"&&(M=!0,re.hidden=!0),D.outlineLevel!=null&&(M=!0,re.level=+D.outlineLevel),M&&(O[K-1]=re)}break;case"<":R=w;break}if(R>=w)break;if(D=vt(b.slice(R,w),!0),K=D.r!=null?parseInt(D.r,10):K+1,W=-1,!(p.sheetRows&&p.sheetRows<K)){m.s.r>K-1&&(m.s.r=K-1),m.e.r<K-1&&(m.e.r=K-1),p&&p.cellStyles&&(re={},M=!1,D.ht&&(M=!0,re.hpt=parseFloat(D.ht),re.hpx=Nl(re.hpt)),D.hidden=="1"&&(M=!0,re.hidden=!0),D.outlineLevel!=null&&(M=!0,re.level=+D.outlineLevel),M&&(O[K-1]=re)),k=b.slice(w).split(e);for(var q=0;q!=k.length&&k[q].trim().charAt(0)=="<";++q);for(k=k.slice(q),w=0;w!=k.length;++w)if(b=k[w].trim(),b.length!==0){if(N=b.match(t),C=w,S=0,U=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,N!=null&&N.length===2){for(C=0,te=N[1],S=0;S!=te.length&&!((U=te.charCodeAt(S)-64)<1||U>26);++S)C=26*C+U;--C,W=C}else++W;for(S=0;S!=b.length&&b.charCodeAt(S)!==62;++S);if(++S,D=vt(b.slice(0,S),!0),D.r||(D.r=kt({r:K-1,c:W})),te=b.slice(S),Q={t:""},(N=te.match(o))!=null&&N[1]!==""&&(Q.v=Ot(N[1])),p.cellFormula){if((N=te.match(l))!=null&&N[1]!==""){if(Q.f=Ot(Jt(N[1])).replace(/\r\n/g,`
`),p.xlfn||(Q.f=Eg(Q.f)),N[0].indexOf('t="array"')>-1)Q.F=(te.match(a)||[])[1],Q.F.indexOf(":")>-1&&ie.push([fr(Q.F),Q.F]);else if(N[0].indexOf('t="shared"')>-1){J=vt(N[0]);var H=Ot(Jt(N[1]));p.xlfn||(H=Eg(H)),L[parseInt(J.si,10)]=[J,H,D.r]}}else(N=te.match(/<f[^>]*\/>/))&&(J=vt(N[0]),L[J.si]&&(Q.f=IN(L[J.si][1],L[J.si][2],D.r)));var B=ln(D.r);for(S=0;S<ie.length;++S)B.r>=ie[S][0].s.r&&B.r<=ie[S][0].e.r&&B.c>=ie[S][0].s.c&&B.c<=ie[S][0].e.c&&(Q.F=ie[S][1])}if(D.t==null&&Q.v===void 0)if(Q.f||Q.F)Q.v=0,Q.t="n";else if(F)Q.t="z";else continue;else Q.t=D.t||"n";switch(m.s.c>W&&(m.s.c=W),m.e.c<W&&(m.e.c=W),Q.t){case"n":if(Q.v==""||Q.v==null){if(!F)continue;Q.t="z"}else Q.v=parseFloat(Q.v);break;case"s":if(typeof Q.v>"u"){if(!F)continue;Q.t="z"}else oe=ml[parseInt(Q.v,10)],Q.v=oe.t,Q.r=oe.r,p.cellHTML&&(Q.h=oe.h);break;case"str":Q.t="s",Q.v=Q.v!=null?Jt(Q.v):"",p.cellHTML&&(Q.h=cp(Q.v));break;case"inlineStr":N=te.match(r),Q.t="s",N!=null&&(oe=yp(N[1]))?(Q.v=oe.t,p.cellHTML&&(Q.h=oe.h)):Q.v="";break;case"b":Q.v=ar(Q.v);break;case"d":p.cellDates?Q.v=Or(Q.v,1):(Q.v=fn(Or(Q.v,1)),Q.t="n");break;case"e":(!p||p.cellText!==!1)&&(Q.w=Q.v),Q.v=F1[Q.v];break}if(Y=pe=0,G=null,de&&D.s!==void 0&&(G=v.CellXf[D.s],G!=null&&(G.numFmtId!=null&&(Y=G.numFmtId),p.cellStyles&&G.fillId!=null&&(pe=G.fillId))),cy(Q,Y,pe,p,g,v),p.cellDates&&de&&Q.t=="n"&&mi(bt[Y])&&(Q.t="d",Q.v=Qu(Q.v)),D.cm&&p.xlmeta){var fe=(p.xlmeta.Cell||[])[+D.cm-1];fe&&fe.type=="XLDAPR"&&(Q.D=!0)}if(ne){var I=ln(D.r);h[I.r]||(h[I.r]=[]),h[I.r][I.c]=Q}else h[D.r]=Q}}}}O.length>0&&(h["!rows"]=O)}})();function TT(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var DT=ko;function jT(){}function FT(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=J2(e),t}function PT(e){var n=Kn(e);return[n]}function AT(e){var n=wo(e);return[n]}function OT(e){var n=Kn(e),t=e.read_shift(1);return[n,t,"b"]}function RT(e){var n=wo(e),t=e.read_shift(1);return[n,t,"b"]}function zT(e){var n=Kn(e),t=e.read_shift(1);return[n,t,"e"]}function MT(e){var n=wo(e),t=e.read_shift(1);return[n,t,"e"]}function IT(e){var n=Kn(e),t=e.read_shift(4);return[n,t,"s"]}function LT(e){var n=wo(e),t=e.read_shift(4);return[n,t,"s"]}function BT(e){var n=Kn(e),t=Gr(e);return[n,t,"n"]}function dy(e){var n=wo(e),t=Gr(e);return[n,t,"n"]}function WT(e){var n=Kn(e),t=mp(e);return[n,t,"n"]}function UT(e){var n=wo(e),t=mp(e);return[n,t,"n"]}function $T(e){var n=Kn(e),t=hp(e);return[n,t,"is"]}function HT(e){var n=Kn(e),t=Xr(e);return[n,t,"str"]}function YT(e){var n=wo(e),t=Xr(e);return[n,t,"str"]}function VT(e,n,t){var r=e.l+n,a=Kn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Kr(c,null,a,t.supbooks,t)}else e.l=r;return l}function KT(e,n,t){var r=e.l+n,a=Kn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Kr(c,null,a,t.supbooks,t)}else e.l=r;return l}function GT(e,n,t){var r=e.l+n,a=Kn(e);a.r=t["!row"];var o=Gr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Kr(c,null,a,t.supbooks,t)}else e.l=r;return l}function QT(e,n,t){var r=e.l+n,a=Kn(e);a.r=t["!row"];var o=Xr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Kr(c,null,a,t.supbooks,t)}else e.l=r;return l}var XT=ko;function qT(e,n){var t=e.l+n,r=ko(e),a=xp(e),o=Xr(e),l=Xr(e),c=Xr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function ZT(){}function JT(e,n,t){var r=e.l+n,a=T1(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=aT(e,r-e.l,t);l[1]=c}else e.l=r;return l}function eD(e,n,t){var r=e.l+n,a=ko(e),o=[a];if(t.cellFormula){var l=oT(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var tD=["left","right","top","bottom","header","footer"];function rD(e){var n={};return tD.forEach(function(t){n[t]=Gr(e)}),n}function nD(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function aD(){}function sD(){}function oD(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,v,w,b,k,N,C,S,U,te,Q=[];c.biff=12,c["!row"]=0;var D=0,K=!1,W=[],oe={},J=c.supbooks||a.supbooks||[[]];if(J.sharedf=oe,J.arrayf=W,J.SheetNames=a.SheetNames||a.Sheets.map(function(ne){return ne.name}),!c.supbooks&&(c.supbooks=J,a.Names))for(var Y=0;Y<a.Names.length;++Y)J[0][Y+1]=a.Names[Y];var pe=[],de=[],G=!1;Au[16]={n:"BrtShortReal",f:dy};var ie;if(ts(e,function(O,re,M){if(!g)switch(M){case 148:h=O;break;case 0:v=O,c.sheetRows&&c.sheetRows<=v.r&&(g=!0),U=Wr(k=v.r),c["!row"]=v.r,(O.hidden||O.hpt||O.level!=null)&&(O.hpt&&(O.hpx=Nl(O.hpt)),de[O.r]=O);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:O[2]},O[2]){case"n":w.v=O[1];break;case"s":S=ml[O[1]],w.v=S.t,w.r=S.r;break;case"b":w.v=!!O[1];break;case"e":w.v=O[1],c.cellText!==!1&&(w.w=bo[w.v]);break;case"str":w.t="s",w.v=O[1];break;case"is":w.t="s",w.v=O[1].t;break}if((b=l.CellXf[O[0].iStyleRef])&&cy(w,b.numFmtId,null,c,o,l),N=O[0].c==-1?N+1:O[0].c,c.dense?(f[k]||(f[k]=[]),f[k][N]=w):f[Cr(N)+U]=w,c.cellFormula){for(K=!1,D=0;D<W.length;++D){var F=W[D];v.r>=F[0].s.r&&v.r<=F[0].e.r&&N>=F[0].s.c&&N<=F[0].e.c&&(w.F=jt(F[0]),K=!0)}!K&&O.length>3&&(w.f=O[3])}if(p.s.r>v.r&&(p.s.r=v.r),p.s.c>N&&(p.s.c=N),p.e.r<v.r&&(p.e.r=v.r),p.e.c<N&&(p.e.c=N),c.cellDates&&b&&w.t=="n"&&mi(bt[b.numFmtId])){var le=to(w.v);le&&(w.t="d",w.v=new Date(le.y,le.m-1,le.d,le.H,le.M,le.S,le.u))}ie&&(ie.type=="XLDAPR"&&(w.D=!0),ie=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;w={t:"z",v:void 0},N=O[0].c==-1?N+1:O[0].c,c.dense?(f[k]||(f[k]=[]),f[k][N]=w):f[Cr(N)+U]=w,p.s.r>v.r&&(p.s.r=v.r),p.s.c>N&&(p.s.c=N),p.e.r<v.r&&(p.e.r=v.r),p.e.c<N&&(p.e.c=N),ie&&(ie.type=="XLDAPR"&&(w.D=!0),ie=void 0);break;case 176:Q.push(O);break;case 49:ie=((c.xlmeta||{}).Cell||[])[O-1];break;case 494:var A=r["!id"][O.relId];for(A?(O.Target=A.Target,O.loc&&(O.Target+="#"+O.loc),O.Rel=A):O.relId==""&&(O.Target="#"+O.loc),k=O.rfx.s.r;k<=O.rfx.e.r;++k)for(N=O.rfx.s.c;N<=O.rfx.e.c;++N)c.dense?(f[k]||(f[k]=[]),f[k][N]||(f[k][N]={t:"z",v:void 0}),f[k][N].l=O):(C=kt({c:N,r:k}),f[C]||(f[C]={t:"z",v:void 0}),f[C].l=O);break;case 426:if(!c.cellFormula)break;W.push(O),te=c.dense?f[k][N]:f[Cr(N)+U],te.f=Kr(O[1],p,{r:v.r,c:N},J,c),te.F=jt(O[0]);break;case 427:if(!c.cellFormula)break;oe[kt(O[0].s)]=O[1],te=c.dense?f[k][N]:f[Cr(N)+U],te.f=Kr(O[1],p,{r:v.r,c:N},J,c);break;case 60:if(!c.cellStyles)break;for(;O.e>=O.s;)pe[O.e--]={width:O.w/256,hidden:!!(O.flags&1),level:O.level},G||(G=!0,wp(O.w/256)),ci(pe[O.e+1]);break;case 161:f["!autofilter"]={ref:jt(O)};break;case 476:f["!margins"]=O;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),O.name&&(a.Sheets[t].CodeName=O.name),(O.above||O.left)&&(f["!outline"]={above:O.above,left:O.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),O.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!re.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+M.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=jt(h||p)),c.sheetRows&&f["!ref"]){var L=fr(f["!ref"]);c.sheetRows<=+L.e.r&&(L.e.r=c.sheetRows-1,L.e.r>p.e.r&&(L.e.r=p.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>p.e.c&&(L.e.c=p.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),f["!fullref"]=f["!ref"],f["!ref"]=jt(L))}return Q.length>0&&(f["!merges"]=Q),pe.length>0&&(f["!cols"]=pe),de.length>0&&(f["!rows"]=de),f}function iD(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=Ot((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function lD(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=iD(m);p.s.r=p.s.c=0,p.e.c=c,h=Cr(c),g[0].forEach(function(v,w){l[h+Wr(w)]={t:"n",v,z:g[1]},f=w}),p.e.r<f&&(p.e.r=f),++c}),c>0&&(l["!ref"]=jt(p)),l}function cD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(uy);return c&&bp(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function uD(e,n){e.l+=10;var t=Xr(e);return{name:t}}function dD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ts(e,function(f,h,p){switch(p){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var fy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],fD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],pD=[],hD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jg(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=ar(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Fg(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=ar(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function py(e){Fg(e.WBProps,fy),Fg(e.CalcPr,hD),jg(e.WBView,fD),jg(e.Sheets,pD),ai.date1904=ar(e.WBProps.date1904)}var xD="][*?/\\".split("");function mD(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return xD.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var gD=/<\w+:workbook/;function vD(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(Zr,function(f,h){var p=vt(f);switch(Da(p[0])){case"<?xml":break;case"<workbook":f.match(gD)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fy.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":t.WBProps[m[0]]=ar(p[m[0]]);break;case"int":t.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:t.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(t.WBProps.CodeName=Jt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Ot(Jt(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=Jt(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),ar(p.hidden||"0")&&(o.Hidden=!0),l=h+f.length;break;case"</definedName>":o.Ref=Ot(Jt(e.slice(l,h))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),z2.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return py(t),t}function yD(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Nf(e),t.name=Xr(e),t}function wD(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?Xr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function kD(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function bD(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=e_(e),l=sT(e,0,t),c=xp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function _D(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Au[16]={n:"BrtFRTArchID$",f:kD},ts(e,function(f,h,p){switch(p){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Kr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(p),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},n),py(t),t.Names=o,t.supbooks=l,t}function SD(e,n,t){return n.slice(-4)===".bin"?_D(e,t):vD(e,t)}function ED(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?oD(e,r,t,a,o,l,c):yT(e,r,t,a,o,l,c)}function ND(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?dD(e,r,t,a,o):cD(e,r,t,a,o)}function CD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?RN():zN()}function TD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?AN():ON()}function DD(e,n,t,r){return n.slice(-4)===".bin"?XE(e,t,r):HE(e,t,r)}function jD(e,n,t){return J1(e,t)}function FD(e,n,t){return n.slice(-4)===".bin"?fE(e,t):uE(e,t)}function PD(e,n,t){return n.slice(-4)===".bin"?jN(e,t):EN(e,t)}function AD(e,n,t){return n.slice(-4)===".bin"?bN(e):wN(e)}function OD(e,n,t,r){return t.slice(-4)===".bin"?_N(e,n,t,r):void 0}function RD(e,n,t){return n.slice(-4)===".bin"?vN(e,n,t):yN(e,n,t)}var hy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ta(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(hy),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(xy),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function zD(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(hy),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(xy),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var vl;function MD(e,n){var t=vl[e]||Ot(e);return t==="General"?uo(n):Yn(t,n)}function ID(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ar(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Or(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Ot(n)]=a}function LD(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=MD(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=vl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&mi(r)){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function BD(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=IE[r.Pattern]||r.Pattern)}e[n.ID]=n}function WD(e,n,t,r,a,o,l,c,f,h){var p="General",m=r.StyleID,g={};h=h||{};var v=[],w=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&l&&(m=l.StyleID);o[m]!==void 0&&(o[m].nf&&(p=o[m].nf),o[m].Interior&&v.push(o[m].Interior),!!o[m].Parent);)m=o[m].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=ar(e);break;case"String":r.t="s",r.r=Jm(Ot(e)),r.v=e.indexOf("<")>-1?Ot(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Or(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Ot(e):r.v<60&&(r.v=r.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=F1[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=Jm(n||e));break}if(LD(r,p,h),h.cellFormula!==!1)if(r.Formula){var b=Ot(r.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),r.f=ni(b,a),delete r.Formula,r.ArrayRange=="RC"?r.F=ni("RC:RC",a):r.ArrayRange&&(r.F=ni(r.ArrayRange,a),f.push([fr(r.F),r.F]))}else for(w=0;w<f.length;++w)a.r>=f[w][0].s.r&&a.r<=f[w][0].e.r&&a.c>=f[w][0].s.c&&a.c<=f[w][0].e.c&&(r.F=f[w][1]);h.cellStyles&&(v.forEach(function(k){!g.patternType&&k.patternType&&(g.patternType=k.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function UD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function af(e,n){var t=n||{};n1();var r=al(up(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Jt(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Br(t);return l.type="string",Sl.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ue){a.indexOf("<"+ue)>=0&&(o=!0)}),o)return qD(r,t);vl={"General Number":"General","General Date":bt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":bt[15],"Short Date":bt[14],"Long Time":bt[19],"Medium Time":bt[18],"Short Time":bt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:bt[2],Standard:bt[4],Percent:bt[10],Scientific:bt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],h,p={},m=[],g=t.dense?[]:{},v="",w={},b={},k=ta('<Data ss:Type="String">'),N=0,C=0,S=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},Q={},D="",K=0,W=[],oe={},J={},Y=0,pe=[],de=[],G={},ie=[],L,ne=!1,O=[],re=[],M={},F=0,le=0,A={Sheets:[],WBProps:{date1904:!1}},T={};_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var j="";c=_l.exec(r);)switch(c[3]=(j=c[3]).toLowerCase()){case"data":if(j=="data"){if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?WD(r.slice(N,c.index),D,k,f[f.length-1][0]=="comment"?G:w,{c:C,r:S},te,ie[C],b,O,t):(D="",k=ta(c[0]),N=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(de.length>0&&(w.c=de),(!t.sheetRows||t.sheetRows>S)&&w.v!==void 0&&(t.dense?(g[S]||(g[S]=[]),g[S][C]=w):g[Cr(C)+Wr(S)]=w),w.HRef&&(w.l={Target:Ot(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(F=C+(parseInt(w.MergeAcross,10)|0),le=S+(parseInt(w.MergeDown,10)|0),W.push({s:{c:C,r:S},e:{c:F,r:le}})),!t.sheetStubs)w.MergeAcross?C=F+1:++C;else if(w.MergeAcross||w.MergeDown){for(var R=C;R<=F;++R)for(var q=S;q<=le;++q)(R>C||q>S)&&(t.dense?(g[q]||(g[q]=[]),g[q][R]={t:"z"}):g[Cr(R)+Wr(q)]={t:"z"});C=F+1}else++C;else w=zD(c[0]),w.Index&&(C=+w.Index-1),C<U.s.c&&(U.s.c=C),C>U.e.c&&(U.e.c=C),c[0].slice(-2)==="/>"&&++C,de=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<U.s.r&&(U.s.r=S),S>U.e.r&&(U.e.r=S),c[0].slice(-2)==="/>"&&(b=ta(c[0]),b.Index&&(S=+b.Index-1)),C=0,++S):(b=ta(c[0]),b.Index&&(S=+b.Index-1),M={},(b.AutoFitHeight=="0"||b.Height)&&(M.hpx=parseInt(b.Height,10),M.hpt=Z1(M.hpx),re[S]=M),b.Hidden=="1"&&(M.hidden=!0,re[S]=M));break;case"worksheet":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));m.push(v),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(g["!ref"]=jt(U),t.sheetRows&&t.sheetRows<=U.e.r&&(g["!fullref"]=g["!ref"],U.e.r=t.sheetRows-1,g["!ref"]=jt(U))),W.length&&(g["!merges"]=W),ie.length>0&&(g["!cols"]=ie),re.length>0&&(g["!rows"]=re),p[v]=g}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=C=0,f.push([c[3],!1]),h=ta(c[0]),v=Ot(h.Name),g=t.dense?[]:{},W=[],O=[],re=[],T={name:v,Hidden:0},A.Sheets.push(T);break;case"table":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),ie=[],ne=!1}break;case"style":c[1]==="/"?BD(te,Q,t):Q=ta(c[0]);break;case"numberformat":Q.nf=Ot(ta(c[0]).Format||"General"),vl[Q.nf]&&(Q.nf=vl[Q.nf]);for(var H=0;H!=392&&bt[H]!=Q.nf;++H);if(H==392){for(H=57;H!=392;++H)if(bt[H]==null){ao(Q.nf,H);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(L=ta(c[0]),L.Hidden&&(L.hidden=!0,delete L.Hidden),L.Width&&(L.wpx=parseInt(L.Width,10)),!ne&&L.wpx>10){ne=!0,sn=X1;for(var B=0;B<ie.length;++B)ie[B]&&ci(ie[B])}ne&&ci(L),ie[L.Index-1||ie.length]=L;for(var fe=0;fe<+L.Span;++fe)ie[ie.length]=Br(L);break;case"namedrange":if(c[1]==="/")break;A.Names||(A.Names=[]);var I=vt(c[0]),Fe={Name:I.Name,Ref:ni(I.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(Fe.Sheet=A.Sheets.length-1),A.Names.push(Fe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?D+=r.slice(K,c.index):K=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;Q.Interior=ta(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?E_(oe,j,r.slice(Y,c.index)):Y=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));UD(G),de.push(G)}else f.push([c[3],!1]),h=ta(c[0]),G={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Pe=ta(c[0]);g["!autofilter"]={ref:ni(Pe.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return Mg(r,t);var Qe=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Qe=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Qe=!1}break;case"excelworkbook":switch(c[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Qe=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Qe=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(Y,c.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else Y=c.index+c[0].length;break;case"header":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+vt(c[0]).Margin)||(g["!margins"].header=+vt(c[0]).Margin);break;case"footer":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+vt(c[0]).Margin)||(g["!margins"].footer=+vt(c[0]).Margin);break;case"pagemargins":var qe=vt(c[0]);g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+qe.Top)||(g["!margins"].top=+qe.Top),isNaN(+qe.Left)||(g["!margins"].left=+qe.Left),isNaN(+qe.Right)||(g["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(g["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Qe=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Qe=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Qe=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Qe=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Qe=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Qe=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Qe=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Qe=!1}break;case"smarttags":break;default:Qe=!1;break}if(Qe||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?ID(J,j,pe,r.slice(Y,c.index)):(pe=c,Y=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var he={};return!t.bookSheets&&!t.bookProps&&(he.Sheets=p),he.SheetNames=m,he.Workbook=A,he.SSF=Br(bt),he.Props=oe,he.Custprops=J,he}function jf(e,n){switch(Ep(n=n||{}),n.type||"base64"){case"base64":return af(Tn(e),n);case"binary":case"buffer":case"file":return af(e,n);case"array":return af(yo(e),n)}}function $D(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=n_(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=a_(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var HD=[60,1084,2066,2165,2175];function YD(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=Ya(t,t.l),h=Ff[f],p=0;h!=null&&HD.indexOf(f)>-1;)o=Ya(t,t.l+2),p=t.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),c=t.slice(p,t.l+4+o),l.push(c),t.l+=4+o,h=Ff[f=Ya(t,t.l)];var m=Es(l);Ir(m,0);var g=0;m.lens=[];for(var v=0;v<l.length;++v)m.lens.push(g),g+=l[v].length;if(m.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+r;return n.f(m,m.length,a)}function ga(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=bt[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=Yn(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&mi(bt[r]||String(r))){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function iu(e,n,t){return{v:e,ixfe:n,t}}function VD(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],h="",p={},m,g="",v,w,b,k,N={},C=[],S,U,te=[],Q=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},W=function(dt){return dt<8?so[dt]:dt<64&&Q[dt-8]||so[dt]},oe=function(dt,Et,Xt){var Ct=Et.XF.data;if(!(!Ct||!Ct.patternType||!Xt||!Xt.cellStyles)){Et.s={},Et.s.patternType=Ct.patternType;var $t;($t=El(W(Ct.icvFore)))&&(Et.s.fgColor={rgb:$t}),($t=El(W(Ct.icvBack)))&&(Et.s.bgColor={rgb:$t})}},J=function(dt,Et,Xt){if(!(M>1)&&!(Xt.sheetRows&&dt.r>=Xt.sheetRows)){if(Xt.cellStyles&&Et.XF&&Et.XF.data&&oe(dt,Et,Xt),delete Et.ixfe,delete Et.XF,m=dt,g=kt(dt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<l.s.r&&(l.s.r=dt.r),dt.c<l.s.c&&(l.s.c=dt.c),dt.r+1>l.e.r&&(l.e.r=dt.r+1),dt.c+1>l.e.c&&(l.e.c=dt.c+1),Xt.cellFormula&&Et.f){for(var Ct=0;Ct<C.length;++Ct)if(!(C[Ct][0].s.c>dt.c||C[Ct][0].s.r>dt.r)&&!(C[Ct][0].e.c<dt.c||C[Ct][0].e.r<dt.r)){Et.F=jt(C[Ct][0]),(C[Ct][0].s.c!=dt.c||C[Ct][0].s.r!=dt.r)&&delete Et.f,Et.f&&(Et.f=""+Kr(C[Ct][1],l,dt,O,Y));break}}Xt.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=Et):a[g]=Et}},Y={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(Y.password=n.password);var pe,de=[],G=[],ie=[],L=[],ne=!1,O=[];O.SheetNames=Y.snames,O.sharedf=Y.sharedf,O.arrayf=Y.arrayf,O.names=[],O.XTI=[];var re=0,M=0,F=0,le=[],A=[],T;Y.codepage=1200,aa(1200);for(var j=!1;e.l<e.length-1;){var R=e.l,q=e.read_shift(2);if(q===0&&re===10)break;var H=e.l===e.length?0:e.read_shift(2),B=Ff[q];if(B&&B.f){if(n.bookSheets&&re===133&&q!==133)break;if(re=q,B.r===2||B.r==12){var fe=e.read_shift(2);if(H-=2,!Y.enc&&fe!==q&&((fe&255)<<8|fe>>8)!==q)throw new Error("rt mismatch: "+fe+"!="+q);B.r==12&&(e.l+=10,H-=10)}var I={};if(q===10?I=B.f(e,H,Y):I=YD(q,B,e,H,Y),M==0&&[9,521,1033,2057].indexOf(re)===-1)continue;switch(q){case 34:t.opts.Date1904=D.WBProps.date1904=I;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=I,!n.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=I;break;case 66:var Fe=Number(I);switch(Fe){case 21010:Fe=1200;break;case 32768:Fe=1e4;break;case 32769:Fe=1252;break}aa(Y.codepage=Fe),j=!0;break;case 317:Y.rrtabid=I;break;case 25:Y.winlocked=I;break;case 439:t.opts.RefreshAll=I;break;case 12:t.opts.CalcCount=I;break;case 16:t.opts.CalcDelta=I;break;case 17:t.opts.CalcIter=I;break;case 13:t.opts.CalcMode=I;break;case 14:t.opts.CalcPrecision=I;break;case 95:t.opts.CalcSaveRecalc=I;break;case 15:Y.CalcRefMode=I;break;case 2211:t.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:te.push(I);break;case 430:O.push([I]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push(I);break;case 24:case 536:T={Name:I.Name,Ref:Kr(I.rgce,l,null,O,Y)},I.itab>0&&(T.Sheet=I.itab-1),O.names.push(T),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(A[I.itab-1]={ref:jt(I.rgce[0][0][1][2])});break;case 22:Y.ExternCount=I;break;case 23:O.length==0&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat(I),O.XTI=O.XTI.concat(I);break;case 2196:if(Y.biff<8)break;T!=null&&(T.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&Y.WTF&&console.error("Password verifier: "+I);break;case 133:o[I.pos]=I,Y.snames.push(I.name);break;case 10:{if(--M)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=jt(l),n.sheetRows&&n.sheetRows<=l.e.r){var Pe=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=jt(l),l.e.r=Pe}l.e.r++,l.e.c++}de.length>0&&(a["!merges"]=de),G.length>0&&(a["!objects"]=G),ie.length>0&&(a["!cols"]=ie),L.length>0&&(a["!rows"]=L),D.Sheets.push(K)}h===""?p=a:r[h]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),Y.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(Y.biff=5,j=!0,aa(Y.codepage=28591)),Y.biff==8&&I.BIFFVer==0&&I.dt==16&&(Y.biff=2),M++)break;if(a=n.dense?[]:{},Y.biff<8&&!j&&(j=!0,aa(Y.codepage=n.codepage||1252)),Y.biff<5||I.BIFFVer==0&&I.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Qe={pos:e.l-H,name:h};o[Qe.pos]=Qe,Y.snames.push(h)}else h=(o[R]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),de=[],G=[],Y.arrayf=C=[],ie=[],L=[],ne=!1,K={Hidden:(o[R]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[I.r]||[])[I.c]:a[kt({c:I.c,r:I.r})])&&++I.c,S={ixfe:I.ixfe,XF:te[I.ixfe]||{},v:I.val,t:"n"},F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:I.c,r:I.r},S,n);break;case 5:case 517:S={ixfe:I.ixfe,XF:te[I.ixfe],v:I.val,t:I.t},F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:I.c,r:I.r},S,n);break;case 638:S={ixfe:I.ixfe,XF:te[I.ixfe],v:I.rknum,t:"n"},F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:I.c,r:I.r},S,n);break;case 189:for(var qe=I.c;qe<=I.C;++qe){var he=I.rkrec[qe-I.c][0];S={ixfe:he,XF:te[he],v:I.rkrec[qe-I.c][1],t:"n"},F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:qe,r:I.r},S,n)}break;case 6:case 518:case 1030:{if(I.val=="String"){c=I;break}if(S=iu(I.val,I.cell.ixfe,I.tt),S.XF=te[S.ixfe],n.cellFormula){var ue=I.formula;if(ue&&ue[0]&&ue[0][0]&&ue[0][0][0]=="PtgExp"){var we=ue[0][0][1][0],ve=ue[0][0][1][1],Oe=kt({r:we,c:ve});N[Oe]?S.f=""+Kr(I.formula,l,I.cell,O,Y):S.F=((n.dense?(a[we]||[])[ve]:a[Oe])||{}).F}else S.f=""+Kr(I.formula,l,I.cell,O,Y)}F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J(I.cell,S,n),c=I}break;case 7:case 519:if(c)c.val=I,S=iu(I,c.cell.ixfe,"s"),S.XF=te[S.ixfe],n.cellFormula&&(S.f=""+Kr(c.formula,l,c.cell,O,Y)),F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J(c.cell,S,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(I);var lt=kt(I[0].s);if(v=n.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[lt],n.cellFormula&&v){if(!c||!lt||!v)break;v.f=""+Kr(I[1],l,I[0],O,Y),v.F=jt(I[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;N[kt(c.cell)]=I[0],v=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[kt(c.cell)],(v||{}).f=""+Kr(I[0],l,m,O,Y)}}break;case 253:S=iu(f[I.isst].t,I.ixfe,"s"),f[I.isst].h&&(S.h=f[I.isst].h),S.XF=te[S.ixfe],F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:I.c,r:I.r},S,n);break;case 513:n.sheetStubs&&(S={ixfe:I.ixfe,XF:te[I.ixfe],t:"z"},F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:I.c,r:I.r},S,n));break;case 190:if(n.sheetStubs)for(var ft=I.c;ft<=I.C;++ft){var gt=I.ixfe[ft-I.c];S={ixfe:gt,XF:te[gt],t:"z"},F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:ft,r:I.r},S,n)}break;case 214:case 516:case 4:S=iu(I.val,I.ixfe,"s"),S.XF=te[S.ixfe],F>0&&(S.z=le[S.ixfe>>8&63]),ga(S,n,t.opts.Date1904),J({c:I.c,r:I.r},S,n);break;case 0:case 512:M===1&&(l=I);break;case 252:f=I;break;case 1054:if(Y.biff==4){le[F++]=I[1];for(var Rt=0;Rt<F+163&&bt[Rt]!=I[1];++Rt);Rt>=163&&ao(I[1],F+163)}else ao(I[1],I[0]);break;case 30:{le[F++]=I;for(var Gt=0;Gt<F+163&&bt[Gt]!=I;++Gt);Gt>=163&&ao(I,F+163)}break;case 229:de=de.concat(I);break;case 93:G[I.cmo[0]]=Y.lastobj=I;break;case 438:Y.lastobj.TxO=I;break;case 127:Y.lastobj.ImData=I;break;case 440:for(k=I[0].s.r;k<=I[0].e.r;++k)for(b=I[0].s.c;b<=I[0].e.c;++b)v=n.dense?(a[k]||[])[b]:a[kt({c:b,r:k})],v&&(v.l=I[1]);break;case 2048:for(k=I[0].s.r;k<=I[0].e.r;++k)for(b=I[0].s.c;b<=I[0].e.c;++b)v=n.dense?(a[k]||[])[b]:a[kt({c:b,r:k})],v&&v.l&&(v.l.Tooltip=I[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;v=n.dense?(a[I[0].r]||[])[I[0].c]:a[kt(I[0])];var cr=G[I[2]];v||(n.dense?(a[I[0].r]||(a[I[0].r]=[]),v=a[I[0].r][I[0].c]={t:"z"}):v=a[kt(I[0])]={t:"z"},l.e.r=Math.max(l.e.r,I[0].r),l.s.r=Math.min(l.s.r,I[0].r),l.e.c=Math.max(l.e.c,I[0].c),l.s.c=Math.min(l.s.c,I[0].c)),v.c||(v.c=[]),w={a:I[1],t:cr.TxO.t},v.c.push(w)}break;case 2173:hN(te[I.ixfe],I.ext);break;case 125:{if(!Y.cellStyles)break;for(;I.e>=I.s;)ie[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},ne||(ne=!0,wp(I.w/256)),ci(ie[I.e+1])}break;case 520:{var Lt={};I.level!=null&&(L[I.r]=Lt,Lt.level=I.level),I.hidden&&(L[I.r]=Lt,Lt.hidden=!0),I.hpt&&(L[I.r]=Lt,Lt.hpt=I.hpt,Lt.hpx=Nl(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||gl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[q]]=I;break;case 161:a["!margins"]||gl(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(D.Views[0].RTL=!0);break;case 146:Q=I;break;case 2198:pe=I;break;case 140:U=I;break;case 442:h?K.CodeName=I||K.name:D.WBProps.CodeName=I||"ThisWorkbook";break}}else B||console.error("Missing Info for XLS Record 0x"+q.toString(16)),e.l+=H}return t.SheetNames=Ca(o).sort(function(Qt,dt){return Number(Qt)-Number(dt)}).map(function(Qt){return o[Qt].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&A.forEach(function(Qt,dt){t.Sheets[t.SheetNames[dt]]["!autofilter"]=Qt}),t.Strings=f,t.SSF=Br(bt),Y.enc&&(t.Encryption=Y.enc),pe&&(t.Themes=pe),t.Metadata={},U!==void 0&&(t.Metadata.Country=U),O.names.length>0&&(D.Names=O.names),t.Workbook=D,t}var Pg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KD(e,n,t){var r=Dt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=xg(r,u_,Pg.DSI);for(var o in a)n[o]=a[o]}catch(h){if(t.WTF)throw h}var l=Dt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=xg(l,d_,Pg.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(h){if(t.WTF)throw h}n.HeadingPairs&&n.TitlesOfParts&&(A1(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function my(e,n){n||(n={}),Ep(n),Yv(),n.codepage&&np(n.codepage);var t,r;if(e.FullPaths){if(Dt.find(e,"/encryption"))throw new Error("File is password-protected");t=Dt.find(e,"!CompObj"),r=Dt.find(e,"/Workbook")||Dt.find(e,"/Book")}else{switch(n.type){case"base64":e=na(Tn(e));break;case"binary":e=na(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ir(e,0),r={content:e}}var a,o;if(t&&$D(t),n.bookProps&&!n.bookSheets)a={};else{var l=Tt?"buffer":"array";if(r&&r.content)a=VD(r.content,n);else if((o=Dt.find(e,"PerfectOffice_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else if((o=Dt.find(e,"NativeContent_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else throw(o=Dt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&Dt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=PN(e))}var c={};return e.FullPaths&&KD(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Au={0:{f:TT},1:{f:PT},2:{f:WT},3:{f:zT},4:{f:OT},5:{f:BT},6:{f:HT},7:{f:IT},8:{f:QT},9:{f:GT},10:{f:VT},11:{f:KT},12:{f:AT},13:{f:UT},14:{f:MT},15:{f:RT},16:{f:dy},17:{f:YT},18:{f:LT},19:{f:hp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bD},40:{},42:{},43:{f:VE},44:{f:YE},45:{f:KE},46:{f:QE},47:{f:GE},48:{},49:{f:X2},50:{},51:{f:mN},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Y1},62:{f:$T},63:{f:kN},64:{f:aD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:nD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:FT},148:{f:DT,p:16},151:{f:ZT},152:{},153:{f:wD},154:{},155:{},156:{f:yD},157:{},158:{},159:{T:1,f:dE},160:{T:-1},161:{T:1,f:ko},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:xN},336:{T:-1},337:{f:gN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Nf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:H1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:JT},427:{f:eD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jT},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Nf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DN},633:{T:1},634:{T:-1},635:{T:1,f:TN},636:{T:-1},637:{f:Z2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:sD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ff={6:{f:rf},10:{f:_s},12:{f:_r},13:{f:_r},14:{f:gr},15:{f:gr},16:{f:Gr},17:{f:gr},18:{f:gr},19:{f:_r},20:{f:yg},21:{f:yg},23:{f:H1},24:{f:kg},25:{f:gr},26:{},27:{},28:{f:NS},29:{},34:{f:gr},35:{f:wg},38:{f:Gr},39:{f:Gr},40:{f:Gr},41:{f:Gr},42:{f:gr},43:{f:gr},47:{f:jE},49:{f:iS},51:{f:_r},60:{},61:{f:aS},64:{f:gr},65:{f:oS},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:X_},93:{f:TS},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:Y1},128:{f:gS},129:{f:q_},130:{f:_r},131:{f:gr},132:{f:gr},133:{f:Z_},134:{},140:{f:OS},141:{f:_r},144:{},146:{f:zS},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:WS},161:{f:IS},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:pS},190:{f:hS},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:gr},222:{},224:{f:mS},225:{f:Q_},226:{f:_s},227:{},229:{f:CS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:J_},253:{f:lS},255:{f:eS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:I1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:yS},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:FS},439:{f:gr},440:{f:PS},441:{},442:{f:Rl},443:{},444:{f:_r},445:{},446:{},448:{f:_s},449:{f:nS,r:2},450:{f:_s},512:{f:gg},513:{f:BS},515:{f:vS},516:{f:cS},517:{f:vg},519:{f:US},520:{f:tS},523:{},545:{f:bg},549:{f:mg},566:{},574:{f:sS},638:{f:fS},659:{},1048:{},1054:{f:uS},1084:{},1212:{f:_S},2048:{f:AS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:au},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:MS,r:12},2173:{f:pN,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:bS,r:12},2197:{},2198:{f:iN,r:12},2199:{},2200:{},2201:{},2202:{f:SS,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:rS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:LS},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:RS},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gg},1:{},2:{f:VS},3:{f:YS},4:{f:HS},5:{f:vg},7:{f:KS},8:{},9:{f:au},11:{},22:{f:_r},30:{f:dS},31:{},32:{},33:{f:bg},36:{},37:{f:mg},50:{f:GS},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:$S},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:QS},223:{},234:{},354:{},421:{},518:{f:rf},521:{f:au},536:{f:kg},547:{f:wg},561:{},579:{},1030:{f:rf},1033:{f:au},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ra(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&E1(t)&&e.push(t)}}function Ag(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=v2(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,m=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<f.length;++l){var b=f[l].trim(),k=b.slice(0,3).toLowerCase();if(k=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(k!="<td"&&k!="<th")){var N=b.split(/<\/t[dh]>/i);for(c=0;c<N.length;++c){var C=N[c].trim();if(C.match(/<t[dh]/i)){for(var S=C,U=0;S.charAt(0)=="<"&&(U=S.indexOf(">"))>-1;)S=S.slice(U+1);for(var te=0;te<w.length;++te){var Q=w[te];Q.s.c==p&&Q.s.r<h&&h<=Q.e.r&&(p=Q.e.c+1,te=-1)}var D=vt(C.slice(0,C.indexOf(">")));g=D.colspan?+D.colspan:1,((m=+D.rowspan)>1||g>1)&&w.push({s:{r:h,c:p},e:{r:h+(m||1)-1,c:p+g-1}});var K=D.t||D["data-t"]||"";if(!S.length){p+=g;continue}if(S=f1(S),v.s.r>h&&(v.s.r=h),v.e.r<h&&(v.e.r=h),v.s.c>p&&(v.s.c=p),v.e.c<p&&(v.e.c=p),!S.length){p+=g;continue}var W={t:"s",v:S};t.raw||!S.trim().length||K=="s"||(S==="TRUE"?W={t:"b",v:!0}:S==="FALSE"?W={t:"b",v:!1}:isNaN(oa(S))?isNaN(li(S).getDate())||(W={t:"d",v:Or(S)},t.cellDates||(W={t:"n",v:fn(W.v)}),W.z=t.dateNF||bt[14]):W={t:"n",v:oa(S)}),t.dense?(r[h]||(r[h]=[]),r[h][p]=W):r[kt({r:h,c:p})]=W,p+=g}}}}return r["!ref"]=jt(v),w.length&&(r["!merges"]=w),r}function GD(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>l)&&!(a[h].e.r<t||a[h].e.c<l)){if(a[h].s.r<t||a[h].s.c<l){c=-1;break}c=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(c<0)){var p=kt({r:t,c:l}),m=r.dense?(e[t]||[])[l]:e[p],g=m&&m.v!=null&&(m.h||cp(m.w||(Ja(m),m.w)||""))||"",v={};c>1&&(v.rowspan=c),f>1&&(v.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),v.id=(r.id||"sjs")+"-"+p,o.push(O2("td",g,v))}}var w="<tr>";return w+o.join("")+"</tr>"}var QD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XD="</body></html>";function qD(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ms(Ag(t[0],n),n);var r=Cp();return t.forEach(function(a,o){Tp(r,Ag(a,n),"Sheet"+(o+1))}),r}function ZD(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function JD(e,n){var t=n||{},r=t.header!=null?t.header:QD,a=t.footer!=null?t.footer:XD,o=[r],l=gi(e["!ref"]);t.dense=Array.isArray(e),o.push(ZD(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(GD(e,l,c,t));return o.push("</table>"+a),o.join("")}function gy(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var p=gi(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),a==-1&&(h.e.r=a=p.e.r+1)}var m=[],g=0,v=e["!rows"]||(e["!rows"]=[]),w=0,b=0,k=0,N=0,C=0,S=0;for(e["!cols"]||(e["!cols"]=[]);w<c.length&&b<f;++w){var U=c[w];if(Og(U)){if(r.display)continue;v[b]={hidden:!0}}var te=U.children;for(k=N=0;k<te.length;++k){var Q=te[k];if(!(r.display&&Og(Q))){var D=Q.hasAttribute("data-v")?Q.getAttribute("data-v"):Q.hasAttribute("v")?Q.getAttribute("v"):f1(Q.innerHTML),K=Q.getAttribute("data-z")||Q.getAttribute("z");for(g=0;g<m.length;++g){var W=m[g];W.s.c==N+o&&W.s.r<b+a&&b+a<=W.e.r&&(N=W.e.c+1-o,g=-1)}S=+Q.getAttribute("colspan")||1,((C=+Q.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:b+a,c:N+o},e:{r:b+a+(C||1)-1,c:N+o+(S||1)-1}});var oe={t:"s",v:D},J=Q.getAttribute("data-t")||Q.getAttribute("t")||"";D!=null&&(D.length==0?oe.t=J||"z":r.raw||D.trim().length==0||J=="s"||(D==="TRUE"?oe={t:"b",v:!0}:D==="FALSE"?oe={t:"b",v:!1}:isNaN(oa(D))?isNaN(li(D).getDate())||(oe={t:"d",v:Or(D)},r.cellDates||(oe={t:"n",v:fn(oe.v)}),oe.z=r.dateNF||bt[14]):oe={t:"n",v:oa(D)})),oe.z===void 0&&K!=null&&(oe.z=K);var Y="",pe=Q.getElementsByTagName("A");if(pe&&pe.length)for(var de=0;de<pe.length&&!(pe[de].hasAttribute("href")&&(Y=pe[de].getAttribute("href"),Y.charAt(0)!="#"));++de);Y&&Y.charAt(0)!="#"&&(oe.l={Target:Y}),r.dense?(e[b+a]||(e[b+a]=[]),e[b+a][N+o]=oe):e[kt({c:N+o,r:b+a})]=oe,h.e.c<N+o&&(h.e.c=N+o),N+=S}}++b}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),h.e.r=Math.max(h.e.r,b-1+a),e["!ref"]=jt(h),b>=f&&(e["!fullref"]=jt((h.e.r=c.length-w+b-1+a,h))),e}function vy(e,n){var t=n||{},r=t.dense?[]:{};return gy(r,e,n)}function e4(e,n){return Ms(vy(e,n),n)}function Og(e){var n="",t=t4(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function t4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function r4(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Ot(n.replace(/<[^>]*>/g,""));return[t]}var Rg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yy(e,n){var t=n||{},r=up(e),a=[],o,l,c={name:""},f="",h=0,p,m,g={},v=[],w=t.dense?[]:{},b,k,N={value:""},C="",S=0,U=[],te=-1,Q=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,W={},oe=[],J={},Y=0,pe=0,de=[],G=1,ie=1,L=[],ne={Names:[]},O={},re=["",""],M=[],F={},le="",A=0,T=!1,j=!1,R=0;for(_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=_l.exec(r);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?w["!ref"]=jt(D):w["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=D.e.r&&(w["!fullref"]=w["!ref"],D.e.r=t.sheetRows-1,w["!ref"]=jt(D)),oe.length&&(w["!merges"]=oe),de.length&&(w["!rows"]=de),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),v.push(p.name),g[p.name]=w,j=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=vt(b[0],!1),te=Q=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,w=t.dense?[]:{},oe=[],de=[],j=!0);break;case"table-row-group":b[1]==="/"?--K:++K;break;case"table-row":case"":if(b[1]==="/"){te+=G,G=1;break}if(m=vt(b[0],!1),m.?te=m.-1:te==-1&&(te=0),G=+m["number-rows-repeated"]||1,G<10)for(R=0;R<G;++R)K>0&&(de[te+R]={level:K});Q=-1;break;case"covered-table-cell":b[1]!=="/"&&++Q,t.sheetStubs&&(t.dense?(w[te]||(w[te]=[]),w[te][Q]={t:"z"}):w[kt({r:te,c:Q})]={t:"z"}),C="",U=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++Q,N=vt(b[0],!1),ie=parseInt(N["number-columns-repeated"]||"1",10),k={t:"z",v:null},N.formula&&t.cellFormula!=!1&&(k.f=Dg(Ot(N.formula))),(N.||N["value-type"])=="string"&&(k.t="s",k.v=Ot(N["string-value"]||""),t.dense?(w[te]||(w[te]=[]),w[te][Q]=k):w[kt({r:te,c:Q})]=k),Q+=ie-1;else if(b[1]!=="/"){++Q,C="",S=0,U=[],ie=1;var q=G?te+G-1:te;if(Q>D.e.c&&(D.e.c=Q),Q<D.s.c&&(D.s.c=Q),te<D.s.r&&(D.s.r=te),q>D.e.r&&(D.e.r=q),N=vt(b[0],!1),M=[],F={},k={t:N.||N["value-type"],v:null},t.cellFormula)if(N.formula&&(N.formula=Ot(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(Y=parseInt(N["number-matrix-rows-spanned"],10)||0,pe=parseInt(N["number-matrix-columns-spanned"],10)||0,J={s:{r:te,c:Q},e:{r:te+Y-1,c:Q+pe-1}},k.F=jt(J),L.push([J,k.F])),N.formula)k.f=Dg(N.formula);else for(R=0;R<L.length;++R)te>=L[R][0].s.r&&te<=L[R][0].e.r&&Q>=L[R][0].s.c&&Q<=L[R][0].e.c&&(k.F=L[R][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(Y=parseInt(N["number-rows-spanned"],10)||0,pe=parseInt(N["number-columns-spanned"],10)||0,J={s:{r:te,c:Q},e:{r:te+Y-1,c:Q+pe-1}},oe.push(J)),N["number-columns-repeated"]&&(ie=parseInt(N["number-columns-repeated"],10)),k.t){case"boolean":k.t="b",k.v=ar(N["boolean-value"]);break;case"float":k.t="n",k.v=parseFloat(N.value);break;case"percentage":k.t="n",k.v=parseFloat(N.value);break;case"currency":k.t="n",k.v=parseFloat(N.value);break;case"date":k.t="d",k.v=Or(N["date-value"]),t.cellDates||(k.t="n",k.v=fn(k.v)),k.z="m/d/yy";break;case"time":k.t="n",k.v=x2(N["time-value"])/86400,t.cellDates&&(k.t="d",k.v=Qu(k.v)),k.z="HH:MM:SS";break;case"number":k.t="n",k.v=parseFloat(N.);break;default:if(k.t==="string"||k.t==="text"||!k.t)k.t="s",N["string-value"]!=null&&(C=Ot(N["string-value"]),U=[]);else throw new Error("Unsupported value type "+k.t)}}else{if(T=!1,k.t==="s"&&(k.v=C||"",U.length&&(k.R=U),T=S==0),O.Target&&(k.l=O),M.length>0&&(k.c=M,M=[]),C&&t.cellText!==!1&&(k.w=C),T&&(k.t="z",delete k.v),(!T||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=te))for(var H=0;H<G;++H){if(ie=parseInt(N["number-columns-repeated"]||"1",10),t.dense)for(w[te+H]||(w[te+H]=[]),w[te+H][Q]=H==0?k:Br(k);--ie>0;)w[te+H][Q+ie]=Br(k);else for(w[kt({r:te+H,c:Q})]=k;--ie>0;)w[kt({r:te+H,c:Q+ie})]=Br(k);D.e.c<=Q&&(D.e.c=Q)}ie=parseInt(N["number-columns-repeated"]||"1",10),Q+=ie-1,ie=0,k={},C="",U=[]}O={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o;F.t=C,U.length&&(F.R=U),F.a=le,M.push(F)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);le="",A=0,C="",S=0,U=[];break;case"creator":b[1]==="/"?le=r.slice(A,b.index):A=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);C="",S=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(W[c.name]=f,(o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(f="",c=vt(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=vt(b[0],!1),f+=Rg[b[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=vt(b[0],!1),f+=Rg[b[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(h,b.index);break}else h=b.index+b[0].length;break;case"named-range":l=vt(b[0],!1),re=nf(l["cell-range-address"]);var B={Name:l.name,Ref:re[0]+"!"+re[1]};j&&(B.Sheet=v.length),ne.Names.push(B);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!N||!N["string-value"])){var fe=r4(r.slice(S,b.index));C=(C.length>0?C+`
`:"")+fe[0]}else vt(b[0],!1),S=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{re=nf(vt(b[0])["target-range-address"]),g[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(O=vt(b[0],!1),!O.href)break;O.Target=Ot(O.href),delete O.href,O.Target.charAt(0)=="#"&&O.Target.indexOf(".")>-1?(re=nf(O.Target.slice(1)),O.Target="#"+re[0]+"!"+re[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(b)}}var I={Sheets:g,SheetNames:v,Workbook:ne};return t.bookSheets&&delete I.Sheets,I}function zg(e,n){n=n||{},Bn(e,"META-INF/manifest.xml")&&v_(br(e,"META-INF/manifest.xml"),n);var t=Nn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=yy(Jt(t),n);return Bn(e,"meta.xml")&&(r.Props=P1(br(e,"meta.xml"))),r}function Mg(e,n){return yy(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _p(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Jt(yo(e))}function Af(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function Ig(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function n4(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Cl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Tr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function Qr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Cl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Cl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:c,type:o};n[a]==null?n[a]=[h]:n[a].push(h)}return n}function Sp(e,n){return e?.map(function(t){return n(t.data)})||[]}function a4(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Cl(e,r),o=Qr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Tr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=Qr(c.data),h=Tr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(n=o[3])!=null&&n[0]&&(l.merge=Tr(o[3][0].data)>>>0>0),t.push(l)}return t}function s4(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Cl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,h=0;if(o==1?(h=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(h=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Af(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var p=Af(a);if(p.length!=r)throw new Error("Unexpected length: ".concat(p.length," != ").concat(r));return p}function o4(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(s4(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Af(n)}function i4(e,n,t,r){var a=_p(e),o=a.getUint32(4,!0),l=(r>1?12:8)+Ig(o&(r>1?3470:398))*4,c=-1,f=-1,h=NaN,p=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=Ig(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(h=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:h};break;case 3:m={t:"s",v:n[f]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:t[c]};else if(f>-1)m={t:"s",v:n[f]};else if(!isNaN(h))m={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function l4(e,n,t){var r=_p(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,h=NaN,p=new Date(2001,0,1);a&1&&(f=n4(e,o),o+=16),a&2&&(h=r.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:n[c]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function c4(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return i4(e,n,t,e[0]);case 5:return l4(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function js(e){var n=Qr(e);return Cl(n[1][0].data)}function Lg(e,n){var t=Qr(n.data),r=Tr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=Qr(l.data),f=Tr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Pf(c[3][0].data);break;case 8:{var h=e[js(c[9][0].data)][0],p=Qr(h.data),m=e[js(p[1][0].data)][0],g=Tr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=Qr(m.data);o[f]=v[3].map(function(w){return Pf(w.data)}).join("")}break}}),o}function u4(e,n){var t,r,a,o,l,c,f,h,p,m,g,v,w,b,k=Qr(e),N=Tr(k[1][0].data)>>>0,C=Tr(k[2][0].data)>>>0,S=((r=(t=k[8])==null?void 0:t[0])==null?void 0:r.data)&&Tr(k[8][0].data)>0||!1,U,te;if((o=(a=k[7])==null?void 0:a[0])!=null&&o.data&&n!=0)U=(c=(l=k[7])==null?void 0:l[0])==null?void 0:c.data,te=(h=(f=k[6])==null?void 0:f[0])==null?void 0:h.data;else if((m=(p=k[4])==null?void 0:p[0])!=null&&m.data&&n!=1)U=(v=(g=k[4])==null?void 0:g[0])==null?void 0:v.data,te=(b=(w=k[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var Q=S?4:1,D=_p(U),K=[],W=0;W<U.length/2;++W){var oe=D.getUint16(W*2,!0);oe<65535&&K.push([W,oe])}if(K.length!=C)throw"Expected ".concat(C," cells, found ").concat(K.length);var J=[];for(W=0;W<K.length-1;++W)J[K[W][0]]=te.subarray(K[W][1]*Q,K[W+1][1]*Q);return K.length>=1&&(J[K[K.length-1][0]]=te.subarray(K[K.length-1][1]*Q)),{R:N,cells:J}}function d4(e,n){var t,r=Qr(n.data),a=(t=r?.[7])!=null&&t[0]?Tr(r[7][0].data)>>>0>0?1:0:-1,o=Sp(r[5],function(l){return u4(l,a)});return{nrows:Tr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,h){if(l[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));l[c.R][h]=f}),l},[])}}function f4(e,n,t){var r,a=Qr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Tr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Tr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=jt(o);var l=Qr(a[4][0].data),c=Lg(e,e[js(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?Lg(e,e[js(l[17][0].data)][0]):[],h=Qr(l[3][0].data),p=0;h[1].forEach(function(m){var g=Qr(m.data),v=e[js(g[2][0].data)][0],w=Tr(v.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=d4(e,v);b.data.forEach(function(k,N){k.forEach(function(C,S){var U=kt({r:p+N,c:S}),te=c4(C,c,f);te&&(t[U]=te)})}),p+=b.nrows})}function p4(e,n){var t=Qr(n.data),r={"!ref":"A1"},a=e[js(t[2][0].data)],o=Tr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return f4(e,a[0],r),r}function h4(e,n){var t,r=Qr(n.data),a={name:(t=r[1])!=null&&t[0]?Pf(r[1][0].data):"",sheets:[]},o=Sp(r[2],js);return o.forEach(function(l){e[l].forEach(function(c){var f=Tr(c.meta[1][0].data);f==6e3&&a.sheets.push(p4(e,c))})}),a}function x4(e,n){var t=Cp(),r=Qr(n.data),a=Sp(r[1],js);if(a.forEach(function(o){e[o].forEach(function(l){var c=Tr(l.meta[1][0].data);if(c==2){var f=h4(e,l);f.sheets.forEach(function(h,p){Tp(t,h,p==0?f.name:f.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function sf(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=o4(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var p;try{p=a4(h)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){o[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Tr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(h){var p=Tr(h.meta[1][0].data)>>>0;if(p==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return x4(o,c)}function m4(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Ep(e){m4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function g4(e){return ei.WS.indexOf(e)>-1?"sheet":e==ei.CS?"chart":e==ei.DS?"dialog":e==ei.MS?"macro":e&&e.length?e:"sheet"}function v4(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,g4(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function y4(e,n,t,r,a,o,l,c,f,h,p,m){try{o[r]=pl(Nn(e,t,!0),n);var g=br(e,n),v;switch(c){case"sheet":v=ED(g,n,a,f,o[r],h,p,m);break;case"chart":if(v=ND(g,n,a,f,o[r],h,p,m),!v||!v["!drawel"])break;var w=ol(v["!drawel"].Target,n),b=Cf(w),k=SN(Nn(e,w,!0),pl(Nn(e,b,!0),w)),N=ol(k,w),C=Cf(N);v=lD(Nn(e,N,!0),N,f,pl(Nn(e,C,!0),N),h,v);break;case"macro":v=CD(g,n,a,f,o[r],h,p,m);break;case"dialog":v=TD(g,n,a,f,o[r],h,p,m);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=v;var S=[];o&&o[r]&&Ca(o[r]).forEach(function(U){var te="";if(o[r][U].Type==ei.CMNT){te=ol(o[r][U].Target,n);var Q=PD(br(e,te,!0),te,f);if(!Q||!Q.length)return;Sg(v,Q,!1)}o[r][U].Type==ei.TCMNT&&(te=ol(o[r][U].Target,n),S=S.concat(NN(br(e,te,!0),f)))}),S&&S.length&&Sg(v,S,!0,f.people||[])}catch(U){if(f.WTF)throw U}}function Mn(e){return e.charAt(0)=="/"?e.slice(1):e}function w4(e,n){if(n1(),n=n||{},Ep(n),Bn(e,"META-INF/manifest.xml")||Bn(e,"objectdata.xml"))return zg(e,n);if(Bn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof sf<"u"){if(e.FileIndex)return sf(e);var t=Dt.utils.cfb_new();return qm(e).forEach(function(de){k2(t,de,w2(e,de))}),sf(t)}throw new Error("Unsupported NUMBERS file")}if(!Bn(e,"[Content_Types].xml"))throw Bn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Bn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=qm(e),a=m_(Nn(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",br(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!br(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},h={};if(!n.bookSheets&&!n.bookProps){if(ml=[],a.sst)try{ml=FD(br(e,Mn(a.sst)),a.sst,n)}catch(de){if(n.WTF)throw de}n.cellStyles&&a.themes.length&&(f=jD(Nn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(h=DD(br(e,Mn(a.style)),a.style,f,n))}a.links.map(function(de){try{var G=pl(Nn(e,Cf(Mn(de))),de);return OD(br(e,Mn(de)),G,de,n)}catch{}});var p=SD(br(e,Mn(a.workbooks[0])),a.workbooks[0],n),m={},g="";a.coreprops.length&&(g=br(e,Mn(a.coreprops[0]),!0),g&&(m=P1(g)),a.extprops.length!==0&&(g=br(e,Mn(a.extprops[0]),!0),g&&k_(g,m,n)));var v={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=Nn(e,Mn(a.custprops[0]),!0),g&&(v=__(g,n)));var w={};if((n.bookSheets||n.bookProps)&&(p.Sheets?l=p.Sheets.map(function(G){return G.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),n.bookProps&&(w.Props=m,w.Custprops=v),n.bookSheets&&typeof l<"u"&&(w.SheetNames=l),n.bookSheets?w.SheetNames:n.bookProps))return w;l={};var b={};n.bookDeps&&a.calcchain&&(b=AD(br(e,Mn(a.calcchain)),a.calcchain));var k=0,N={},C,S;{var U=p.Sheets;m.Worksheets=U.length,m.SheetNames=[];for(var te=0;te!=U.length;++te)m.SheetNames[te]=U[te].name}var Q=o?"bin":"xml",D=a.workbooks[0].lastIndexOf("/"),K=(a.workbooks[0].slice(0,D+1)+"_rels/"+a.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");Bn(e,K)||(K="xl/_rels/workbook."+Q+".rels");var W=pl(Nn(e,K,!0),K.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=RD(br(e,Mn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=CN(br(e,Mn(a.people[0])),n)),W&&(W=v4(W,p.Sheets));var oe=br(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(k=0;k!=m.Worksheets;++k){var J="sheet";if(W&&W[k]?(C="xl/"+W[k][1].replace(/[\/]?xl\//,""),Bn(e,C)||(C=W[k][1]),Bn(e,C)||(C=K.replace(/_rels\/.*$/,"")+W[k][1]),J=W[k][2]):(C="xl/worksheets/sheet"+(k+1-oe)+"."+Q,C=C.replace(/sheet0\./,"sheet.")),S=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(k!=n.sheets)continue e;break;case"string":if(m.SheetNames[k].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var Y=!1,pe=0;pe!=n.sheets.length;++pe)typeof n.sheets[pe]=="number"&&n.sheets[pe]==k&&(Y=1),typeof n.sheets[pe]=="string"&&n.sheets[pe].toLowerCase()==m.SheetNames[k].toLowerCase()&&(Y=1);if(!Y)continue e}}y4(e,C,S,m.SheetNames[k],k,N,l,J,n,p,f,h)}return w={Directory:a,Workbook:p,Props:m,Custprops:v,Deps:b,Sheets:l,SheetNames:m.SheetNames,Strings:ml,Styles:h,Themes:f,SSF:Br(bt)},n&&n.bookFiles&&(e.files?(w.keys=r,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(de,G){de=de.replace(/^Root Entry[\/]/,""),w.keys.push(de),w.files[de]=e.FileIndex[G]}))),n&&n.bookVBA&&(a.vba.length>0?w.vbaraw=br(e,Mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===FN&&(w.vbaraw=br(e,"xl/vbaProject.bin",!0))),w}function k4(e,n){var t=n||{},r="Workbook",a=Dt.find(e,r);try{if(r="/!DataSpaces/Version",a=Dt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(pE(a.content),r="/!DataSpaces/DataSpaceMap",a=Dt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=xE(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Dt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=mE(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Dt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);vE(a.content)}catch{}if(r="/EncryptionInfo",a=Dt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=yE(a.content);if(r="/EncryptedPackage",a=Dt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Np(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Tn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function b4(e,n){return Dt.find(e,"EncryptedPackage")?k4(e,n):my(e,n)}function _4(e,n){var t,r=e,a=n||{};return a.type||(a.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),t=c1(r,a),w4(t,a)}function wy(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return jf(e.slice(t),n);default:break e}return Sl.to_workbook(e,n)}function S4(e,n){var t="",r=Np(e,n);switch(n.type){case"base64":t=Tn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=fo(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Jt(t)),n.type="binary",wy(t,n)}function E4(e,n){var t=e;return n.type=="base64"&&(t=Tn(t)),t=wl.utils.decode(1200,t.slice(2),"str"),n.type="binary",wy(t,n)}function N4(e){return e.match(/[^\x00-\x7F]/)?il(e):e}function of(e,n,t,r){return r?(t.type="string",Sl.to_workbook(e,t)):Sl.to_workbook(n,t)}function Of(e,n){Yv();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Of(new Uint8Array(e),(t=Br(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ai={},t.dateNF&&(ai.dateNF=t.dateNF),t.type||(t.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Tt?"buffer":"binary",r=p2(e),typeof Uint8Array<"u"&&!Tt&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=N4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=Br(t),t.type="array",Of(ap(r),t)}switch((a=Np(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return b4(Dt.read(r,t),t);break;case 9:if(a[1]<=8)return my(r,t);break;case 60:return jf(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return eE(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return ZS.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?_4(r,t):of(e,r,t,o);case 239:return a[3]===60?jf(r,t):of(e,r,t,o);case 255:if(a[1]===254)return E4(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return xl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return xl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return _g.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return FE.to_workbook(r,t);break;case 10:case 13:case 32:return S4(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XS.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?_g.to_workbook(r,t):of(e,r,t,o)}function C4(e,n,t,r,a,o,l,c){var f=Wr(t),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var v=n.s.c;v<=n.e.c;++v){var w=l?e[t][v]:e[r[v]+f];if(w===void 0||w.t===void 0){if(h===void 0)continue;o[v]!=null&&(g[o[v]]=h);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[v]!=null){if(b==null)if(w.t=="e"&&b===null)g[o[v]]=null;else if(h!==void 0)g[o[v]]=h;else if(p&&b===null)g[o[v]]=null;else continue;else g[o[v]]=p&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?b:Ja(w,b,c);b!=null&&(m=!1)}}return{row:g,isempty:m}}function Rf(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof p){case"string":f=fr(p);break;case"number":f=fr(e["!ref"]),f.s.r=p;break;default:f=p}r>0&&(a=0);var m=Wr(f.s.r),g=[],v=[],w=0,b=0,k=Array.isArray(e),N=f.s.r,C=0,S={};k&&!e[N]&&(e[N]=[]);var U=h.skipHidden&&e["!cols"]||[],te=h.skipHidden&&e["!rows"]||[];for(C=f.s.c;C<=f.e.c;++C)if(!(U[C]||{}).hidden)switch(g[C]=Cr(C),t=k?e[N][C]:e[g[C]+m],r){case 1:o[C]=C-f.s.c;break;case 2:o[C]=g[C];break;case 3:o[C]=h.header[C-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ja(t,null,h),b=S[l]||0,!b)S[l]=1;else{do c=l+"_"+b++;while(S[c]);S[l]=b,S[c]=1}o[C]=c}for(N=f.s.r+a;N<=f.e.r;++N)if(!(te[N]||{}).hidden){var Q=C4(e,f,N,g,r,o,k,h);(Q.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(v[w++]=Q.row)}return v.length=w,v}var Bg=/"/g;function T4(e,n,t,r,a,o,l,c){for(var f=!0,h=[],p="",m=Wr(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var v=c.dense?(e[t]||[])[g]:e[r[g]+m];if(v==null)p="";else if(v.v!=null){f=!1,p=""+(c.rawNumbers&&v.t=="n"?v.v:Ja(v,null,c));for(var w=0,b=0;w!==p.length;++w)if((b=p.charCodeAt(w))===a||b===o||b===34||c.forceQuotes){p='"'+p.replace(Bg,'""')+'"';break}p=="ID"&&(p='"ID"')}else v.f!=null&&!v.F?(f=!1,p="="+v.f,p.indexOf(",")>=0&&(p='"'+p.replace(Bg,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&f?null:h.join(l)}function ky(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=fr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),p="",m=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],v=r.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(g[w]||{}).hidden||(m[w]=Cr(w));for(var b=0,k=a.s.r;k<=a.e.r;++k)(v[k]||{}).hidden||(p=T4(e,a,k,m,l,f,o,r),p!=null&&(r.strip&&(p=p.replace(h,"")),(p||r.blankrows!==!1)&&t.push((b++?c:"")+p)));return delete r.dense,t.join("")}function D4(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=ky(e,n);return t}function j4(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=fr(e["!ref"]),o="",l=[],c,f=[],h=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Cr(c);for(var p=a.s.r;p<=a.e.r;++p)for(o=Wr(p),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=h?(e[p]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function by(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}var h,p={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var m=fr(o["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),l==-1&&(l=m.e.r+1,p.e.r=l+n.length-1+a)}else l==-1&&(l=0,p.e.r=n.length-1+a);var g=r.header||[],v=0;n.forEach(function(b,k){Ca(b).forEach(function(N){(v=g.indexOf(N))==-1&&(g[v=g.length]=N);var C=b[N],S="z",U="",te=kt({c:c+v,r:l+k+a});h=Tl(o,te),C&&typeof C=="object"&&!(C instanceof Date)?o[te]=C:(typeof C=="number"?S="n":typeof C=="boolean"?S="b":typeof C=="string"?S="s":C instanceof Date?(S="d",r.cellDates||(S="n",C=fn(C)),U=r.dateNF||bt[14]):C===null&&r.nullError&&(S="e",C=0),h?(h.t=S,h.v=C,delete h.w,delete h.R,U&&(h.z=U)):o[te]=h={t:S,v:C},U&&(h.z=U))})}),p.e.c=Math.max(p.e.c,c+g.length-1);var w=Wr(l);if(a)for(v=0;v<g.length;++v)o[Cr(v+c)+w]={t:"s",v:g[v]};return o["!ref"]=jt(p),o}function F4(e,n){return by(null,e,n)}function Tl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=ln(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Tl(e,kt(n)):Tl(e,kt({r:n,c:t||0}))}function P4(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Cp(){return{SheetNames:[],Sheets:{}}}function Tp(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(mD(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function A4(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=P4(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function O4(e,n){return e.z=n,e}function _y(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function R4(e,n,t){return _y(e,"#"+n,t)}function z4(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function M4(e,n,t,r){for(var a=typeof n!="string"?n:fr(n),o=typeof n=="string"?n:jt(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Tl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var I4={encode_col:Cr,encode_row:Wr,encode_cell:kt,encode_range:jt,decode_col:pp,decode_row:fp,split_cell:Q2,decode_cell:ln,decode_range:gi,format_cell:Ja,sheet_add_aoa:C1,sheet_add_json:by,sheet_add_dom:gy,aoa_to_sheet:vi,json_to_sheet:F4,table_to_sheet:vy,table_to_book:e4,sheet_to_csv:ky,sheet_to_txt:D4,sheet_to_json:Rf,sheet_to_html:JD,sheet_to_formulae:j4,sheet_to_row_object_array:Rf,sheet_get_cell:Tl,book_new:Cp,book_append_sheet:Tp,book_set_sheet_visibility:A4,cell_set_number_format:O4,cell_set_hyperlink:_y,cell_set_internal_link:R4,cell_add_comment:z4,sheet_set_array_formula:M4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const L4=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=E.useState(null),o=E.useRef(null),l=h=>{const p=h.target.files?.[0];p&&a(p)},c=()=>{if(r){const h=new FileReader;h.onload=p=>{try{const m=new Uint8Array(p.target?.result),g=Of(m,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const v=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",v);const w=I4.sheet_to_json(v,{header:1});console.log("Parsed JSON data:",w);const b={headers:w[0],rows:w.slice(1)};console.log("Prepared file data:",b),t(r.name,b),f()}catch(m){console.error("Error reading Excel file:",m)}},h.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return u.jsx(rr,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Zaaduj plik Excel"}),u.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-2 overflow-hidden",children:u.jsx("div",{children:u.jsxs("div",{className:"relative mt-8",children:[u.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&u.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[u.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),u.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Zaaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Zaaduj"})]})]})})},B4=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>u.jsx(rr,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:u.jsxs("div",{className:"h-full flex items-center justify-between",children:[u.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastpi "',r,'"?']}),u.jsxs("div",{className:"flex space-x-2 shrink-0",children:[u.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),u.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastp"})]})]})});function Sy(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=Sy(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Lr(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=Sy(e))&&(r&&(r+=" "),r+=n);return r}const Ey=6048e5,W4=864e5,Ju=6e4,ed=36e5,U4=1e3,Wg=Symbol.for("constructDateFrom");function Kt(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Wg in e?e[Wg](n):e instanceof Date?new e.constructor(n):new Date(n)}function ut(e,n){return Kt(n||e,e)}function ia(e,n,t){const r=ut(e,t?.in);return isNaN(n)?Kt(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function ca(e,n,t){const r=ut(e,t?.in);if(isNaN(n))return Kt(e,NaN);if(!n)return r;const a=r.getDate(),o=Kt(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function Ny(e,n,t){return Kt(e,+ut(e)+n)}function $4(e,n,t){return Ny(e,n*ed)}let H4={};function So(){return H4}function ua(e,n){const t=So(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=ut(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function ui(e,n){return ua(e,{...n,weekStartsOn:1})}function Cy(e,n){const t=ut(e,n?.in),r=t.getFullYear(),a=Kt(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=ui(a),l=Kt(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=ui(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Ou(e){const n=ut(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function Fa(e,...n){const t=Kt.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function ho(e,n){const t=ut(e,n?.in);return t.setHours(0,0,0,0),t}function di(e,n,t){const[r,a]=Fa(t?.in,e,n),o=ho(r),l=ho(a),c=+o-Ou(o),f=+l-Ou(l);return Math.round((c-f)/W4)}function Y4(e,n){const t=Cy(e,n),r=Kt(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),ui(r)}function zf(e,n,t){const r=ut(e,t?.in);return r.setTime(r.getTime()+n*Ju),r}function Dp(e,n,t){return ca(e,n*3,t)}function V4(e,n,t){return Ny(e,n*1e3)}function Ru(e,n,t){return ia(e,n*7,t)}function Ga(e,n,t){return ca(e,n*12,t)}function Ug(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Kt.bind(null,a));const o=ut(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Kt(r,t||NaN)}function $g(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Kt.bind(null,a));const o=ut(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Kt(r,t||NaN)}function K4(e,n,t){const[r,a]=Fa(t?.in,e,n);return+ho(r)==+ho(a)}function Qa(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function zu(e){return!(!Qa(e)&&typeof e!="number"||isNaN(+ut(e)))}function Mu(e,n,t){const[r,a]=Fa(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function oo(e,n){const t=ut(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function Iu(e,n,t){const[r,a]=Fa(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=oo(r)-oo(a);return o*4+l}function Lu(e,n,t){const[r,a]=Fa(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function G4(e,n,t){const[r,a]=Fa(t?.in,e,n),o=Hg(r,a),l=Math.abs(di(r,a));r.setDate(r.getDate()-o*l);const c=+(Hg(r,a)===-o),f=o*(l-c);return f===0?0:f}function Hg(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function Ty(e,n){const t=ut(e,n?.in);return t.setHours(23,59,59,999),t}function Dy(e,n){const t=ut(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Mf(e,n){const t=ut(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function jy(e,n){const t=ut(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Fy(e,n){const t=ut(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function td(e,n){const t=ut(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function Q4(e,n){const t=So(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=ut(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const X4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},q4=(e,n,t)=>{let r;const a=X4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function si(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const Z4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},J4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},e3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},t3={date:si({formats:Z4,defaultWidth:"full"}),time:si({formats:J4,defaultWidth:"full"}),dateTime:si({formats:e3,defaultWidth:"full"})},r3={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},n3=(e,n,t,r)=>r3[e];function ka(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const a3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},s3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},o3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},i3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},l3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},c3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},u3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},d3={ordinalNumber:u3,era:ka({values:a3,defaultWidth:"wide"}),quarter:ka({values:s3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ka({values:o3,defaultWidth:"wide"}),day:ka({values:i3,defaultWidth:"wide"}),dayPeriod:ka({values:l3,defaultWidth:"wide",formattingValues:c3,defaultFormattingWidth:"wide"})};function ba(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?p3(c,m=>m.test(l)):f3(c,m=>m.test(l));let h;h=e.valueCallback?e.valueCallback(f):f,h=t.valueCallback?t.valueCallback(h):h;const p=n.slice(l.length);return{value:h,rest:p}}}function f3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function p3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function Py(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const h3=/^(\d+)(th|st|nd|rd)?/i,x3=/\d+/i,m3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},g3={any:[/^b/i,/^(a|c)/i]},v3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},y3={any:[/1/i,/2/i,/3/i,/4/i]},w3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},k3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},b3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},S3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},E3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},N3={ordinalNumber:Py({matchPattern:h3,parsePattern:x3,valueCallback:e=>parseInt(e,10)}),era:ba({matchPatterns:m3,defaultMatchWidth:"wide",parsePatterns:g3,defaultParseWidth:"any"}),quarter:ba({matchPatterns:v3,defaultMatchWidth:"wide",parsePatterns:y3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ba({matchPatterns:w3,defaultMatchWidth:"wide",parsePatterns:k3,defaultParseWidth:"any"}),day:ba({matchPatterns:b3,defaultMatchWidth:"wide",parsePatterns:_3,defaultParseWidth:"any"}),dayPeriod:ba({matchPatterns:S3,defaultMatchWidth:"any",parsePatterns:E3,defaultParseWidth:"any"})},Ay={code:"en-US",formatDistance:q4,formatLong:t3,formatRelative:n3,localize:d3,match:N3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function C3(e,n){const t=ut(e,n?.in);return di(t,td(t))+1}function jp(e,n){const t=ut(e,n?.in),r=+ui(t)-+Y4(t);return Math.round(r/Ey)+1}function Fp(e,n){const t=ut(e,n?.in),r=t.getFullYear(),a=So(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Kt(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=ua(l,n),f=Kt(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const h=ua(f,n);return+t>=+c?r+1:+t>=+h?r:r-1}function T3(e,n){const t=So(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Fp(e,n),o=Kt(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),ua(o,n)}function Oy(e,n){const t=ut(e,n?.in),r=+ua(t,n)-+T3(t,n);return Math.round(r/Ey)+1}function Vt(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const Ss={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Vt(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Vt(t+1,2)},d(e,n){return Vt(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Vt(e.getHours()%12||12,n.length)},H(e,n){return Vt(e.getHours(),n.length)},m(e,n){return Vt(e.getMinutes(),n.length)},s(e,n){return Vt(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Vt(a,n.length)}},Xo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Yg={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return Ss.y(e,n)},Y:function(e,n,t,r){const a=Fp(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Vt(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Vt(o,n.length)},R:function(e,n){const t=Cy(e);return Vt(t,n.length)},u:function(e,n){const t=e.getFullYear();return Vt(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Vt(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Vt(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return Ss.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Vt(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=Oy(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Vt(a,n.length)},I:function(e,n,t){const r=jp(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Vt(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Ss.d(e,n)},D:function(e,n,t){const r=C3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Vt(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Vt(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Vt(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Vt(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Xo.noon:r===0?a=Xo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Xo.evening:r>=12?a=Xo.afternoon:r>=4?a=Xo.morning:a=Xo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Ss.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Ss.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Vt(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Vt(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ss.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Ss.s(e,n)},S:function(e,n){return Ss.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Kg(r);case"XXXX":case"XX":return Js(r);case"XXXXX":case"XXX":default:return Js(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Kg(r);case"xxxx":case"xx":return Js(r);case"xxxxx":case"xxx":default:return Js(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Vg(r,":");case"OOOO":default:return"GMT"+Js(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Vg(r,":");case"zzzz":default:return"GMT"+Js(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Vt(r,n.length)},T:function(e,n,t){return Vt(+e,n.length)}};function Vg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Vt(o,2)}function Kg(e,n){return e%60===0?(e>0?"-":"+")+Vt(Math.abs(e)/60,2):Js(e,n)}function Js(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Vt(Math.trunc(r/60),2),o=Vt(r%60,2);return t+a+n+o}const Gg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},Ry=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},D3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Gg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Gg(r,n)).replace("{{time}}",Ry(a,n))},If={p:Ry,P:D3},j3=/^D+$/,F3=/^Y+$/,P3=["D","DD","YY","YYYY"];function A3(e){return j3.test(e)}function O3(e){return F3.test(e)}function R3(e,n,t){const r=z3(e,n,t);if(console.warn(r),P3.includes(e))throw new RangeError(r)}function z3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const M3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,I3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,L3=/^'([^]*?)'?$/,B3=/''/g,W3=/[a-zA-Z]/;function Qg(e,n,t){const r=So(),a=t?.locale??r.locale??Ay,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=ut(e,t?.in);if(!zu(c))throw new RangeError("Invalid time value");let f=n.match(I3).map(p=>{const m=p[0];if(m==="p"||m==="P"){const g=If[m];return g(p,a.formatLong)}return p}).join("").match(M3).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const m=p[0];if(m==="'")return{isToken:!1,value:U3(p)};if(Yg[m])return{isToken:!0,value:p};if(m.match(W3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const h={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(p=>{if(!p.isToken)return p.value;const m=p.value;(!t?.useAdditionalWeekYearTokens&&O3(m)||!t?.useAdditionalDayOfYearTokens&&A3(m))&&R3(m,n,String(e));const g=Yg[m[0]];return g(c,m,a.localize,h)}).join("")}function U3(e){const n=e.match(L3);return n?n[1].replace(B3,"'"):e}function Xg(e,n){return ut(e,n?.in).getDate()}function $3(e,n){return ut(e,n?.in).getDay()}function H3(e,n){const t=ut(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Kt(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function Y3(){return Object.assign({},So())}function Xa(e,n){return ut(e,n?.in).getHours()}function V3(e,n){const t=ut(e,n?.in).getDay();return t===0?7:t}function qa(e,n){return ut(e,n?.in).getMinutes()}function cn(e,n){return ut(e,n?.in).getMonth()}function Fs(e){return ut(e).getSeconds()}function Lf(e){return+ut(e)}function St(e,n){return ut(e,n?.in).getFullYear()}function Rs(e,n){return+ut(e)>+ut(n)}function xo(e,n){return+ut(e)<+ut(n)}function K3(e,n){return+ut(e)==+ut(n)}function G3(e,n){const t=Q3(n)?new n(0):Kt(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function Q3(e){return typeof e=="function"&&e.prototype?.constructor===e}const X3=10;class zy{subPriority=0;validate(n,t){return!0}}class q3 extends zy{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class Z3 extends zy{priority=X3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Kt(t,r))}set(n,t){return t.timestampIsSet?n:Kt(n,G3(n,this.context))}}class It{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new q3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class J3 extends It{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const vr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},_a={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function yr(e,n){return e&&{value:n(e.value),rest:e.rest}}function lr(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function Sa(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*ed+o*Ju+l*U4),rest:n.slice(t[0].length)}}function My(e){return lr(vr.anyDigitsSigned,e)}function pr(e,n){switch(e){case 1:return lr(vr.singleDigit,n);case 2:return lr(vr.twoDigits,n);case 3:return lr(vr.threeDigits,n);case 4:return lr(vr.fourDigits,n);default:return lr(new RegExp("^\\d{1,"+e+"}"),n)}}function Bu(e,n){switch(e){case 1:return lr(vr.singleDigitSigned,n);case 2:return lr(vr.twoDigitsSigned,n);case 3:return lr(vr.threeDigitsSigned,n);case 4:return lr(vr.fourDigitsSigned,n);default:return lr(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Pp(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Iy(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function Ly(e){return e%400===0||e%4===0&&e%100!==0}class ej extends It{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return yr(pr(4,n),a);case"yo":return yr(r.ordinalNumber(n,{unit:"year"}),a);default:return yr(pr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=Iy(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class tj extends It{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return yr(pr(4,n),a);case"Yo":return yr(r.ordinalNumber(n,{unit:"year"}),a);default:return yr(pr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=Fp(n,a);if(r.isTwoDigitYear){const c=Iy(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),ua(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),ua(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class rj extends It{priority=130;parse(n,t){return Bu(t==="R"?4:t.length,n)}set(n,t,r){const a=Kt(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),ui(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class nj extends It{priority=130;parse(n,t){return Bu(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class aj extends It{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return pr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class sj extends It{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return pr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class oj extends It{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return yr(lr(vr.month,n),a);case"MM":return yr(pr(2,n),a);case"Mo":return yr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class ij extends It{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return yr(lr(vr.month,n),a);case"LL":return yr(pr(2,n),a);case"Lo":return yr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function lj(e,n,t){const r=ut(e,t?.in),a=Oy(r,t)-n;return r.setDate(r.getDate()-a*7),ut(r,t?.in)}class cj extends It{priority=100;parse(n,t,r){switch(t){case"w":return lr(vr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return ua(lj(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function uj(e,n,t){const r=ut(e,t?.in),a=jp(r,t)-n;return r.setDate(r.getDate()-a*7),r}class dj extends It{priority=100;parse(n,t,r){switch(t){case"I":return lr(vr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return ui(uj(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const fj=[31,28,31,30,31,30,31,31,30,31,30,31],pj=[31,29,31,30,31,30,31,31,30,31,30,31];class hj extends It{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return lr(vr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return pr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=Ly(r),o=n.getMonth();return a?t>=1&&t<=pj[o]:t>=1&&t<=fj[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class xj extends It{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return lr(vr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return pr(t.length,n)}}validate(n,t){const r=n.getFullYear();return Ly(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Ap(e,n,t){const r=So(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=ut(e,t?.in),l=o.getDay(),f=(n%7+7)%7,h=7-a,p=n<0||n>6?n-(l+h)%7:(f+h)%7-(l+h)%7;return ia(o,p,t)}class mj extends It{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Ap(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class gj extends It{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return yr(pr(t.length,n),o);case"eo":return yr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Ap(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class vj extends It{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return yr(pr(t.length,n),o);case"co":return yr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Ap(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function yj(e,n,t){const r=ut(e,t?.in),a=V3(r,t),o=n-a;return ia(r,o,t)}class wj extends It{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return pr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return yr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return yr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return yr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return yr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=yj(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class kj extends It{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Pp(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class bj extends It{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Pp(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class _j extends It{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Pp(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class Sj extends It{priority=70;parse(n,t,r){switch(t){case"h":return lr(vr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class Ej extends It{priority=70;parse(n,t,r){switch(t){case"H":return lr(vr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class Nj extends It{priority=70;parse(n,t,r){switch(t){case"K":return lr(vr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class Cj extends It{priority=70;parse(n,t,r){switch(t){case"k":return lr(vr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class Tj extends It{priority=60;parse(n,t,r){switch(t){case"m":return lr(vr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class Dj extends It{priority=50;parse(n,t,r){switch(t){case"s":return lr(vr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class jj extends It{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return yr(pr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class Fj extends It{priority=10;parse(n,t){switch(t){case"X":return Sa(_a.basicOptionalMinutes,n);case"XX":return Sa(_a.basic,n);case"XXXX":return Sa(_a.basicOptionalSeconds,n);case"XXXXX":return Sa(_a.extendedOptionalSeconds,n);case"XXX":default:return Sa(_a.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Kt(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","x"]}class Pj extends It{priority=10;parse(n,t){switch(t){case"x":return Sa(_a.basicOptionalMinutes,n);case"xx":return Sa(_a.basic,n);case"xxxx":return Sa(_a.basicOptionalSeconds,n);case"xxxxx":return Sa(_a.extendedOptionalSeconds,n);case"xxx":default:return Sa(_a.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Kt(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","X"]}class Aj extends It{priority=40;parse(n){return My(n)}set(n,t,r){return[Kt(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class Oj extends It{priority=20;parse(n){return My(n)}set(n,t,r){return[Kt(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const Rj={G:new J3,y:new ej,Y:new tj,R:new rj,u:new nj,Q:new aj,q:new sj,M:new oj,L:new ij,w:new cj,I:new dj,d:new hj,D:new xj,E:new mj,e:new gj,c:new vj,i:new wj,a:new kj,b:new bj,B:new _j,h:new Sj,H:new Ej,K:new Nj,k:new Cj,m:new Tj,s:new Dj,S:new jj,X:new Fj,x:new Pj,t:new Aj,T:new Oj},zj=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Mj=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ij=/^'([^]*?)'?$/,Lj=/''/g,Bj=/\S/,Wj=/[a-zA-Z]/;function Uj(e,n,t,r){const a=()=>Kt(r?.in||t,NaN),o=Y3(),l=r?.locale??o.locale??Ay,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():ut(t,r?.in);const h={firstWeekContainsDate:c,weekStartsOn:f,locale:l},p=[new Z3(r?.in,t)],m=n.match(Mj).map(k=>{const N=k[0];if(N in If){const C=If[N];return C(k,l.formatLong)}return k}).join("").match(zj),g=[];for(let k of m){const N=k[0],C=Rj[N];if(C){const{incompatibleTokens:S}=C;if(Array.isArray(S)){const te=g.find(Q=>S.includes(Q.token)||Q.token===N);if(te)throw new RangeError(`The format string mustn't contain \`${te.fullToken}\` and \`${k}\` at the same time`)}else if(C.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${k}\` and any other token at the same time`);g.push({token:N,fullToken:k});const U=C.run(e,k,l.match,h);if(!U)return a();p.push(U.setter),e=U.rest}else{if(N.match(Wj))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");if(k==="''"?k="'":N==="'"&&(k=$j(k)),e.indexOf(k)===0)e=e.slice(k.length);else return a()}}if(e.length>0&&Bj.test(e))return a();const v=p.map(k=>k.priority).sort((k,N)=>N-k).filter((k,N,C)=>C.indexOf(k)===N).map(k=>p.filter(N=>N.priority===k).sort((N,C)=>C.subPriority-N.subPriority)).map(k=>k[0]);let w=ut(t,r?.in);if(isNaN(+w))return a();const b={};for(const k of v){if(!k.validate(w,h))return a();const N=k.set(w,b,h);Array.isArray(N)?(w=N[0],Object.assign(b,N[1])):w=N}return w}function $j(e){return e.match(Ij)[1].replace(Lj,"'")}function Hj(e,n,t){const[r,a]=Fa(t?.in,e,n);return+ua(r,t)==+ua(a,t)}function Yj(e,n,t){const[r,a]=Fa(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function Vj(e,n,t){const[r,a]=Fa(t?.in,e,n);return+Mf(r)==+Mf(a)}function Kj(e,n,t){const[r,a]=Fa(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Dl(e,n,t){const r=+ut(e,t?.in),[a,o]=[+ut(n.start,t?.in),+ut(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function Gj(e,n,t){return ia(e,-1,t)}function Qj(e,n){const t=()=>Kt(n?.in,NaN),a=Jj(e);let o;if(a.date){const h=eF(a.date,2);o=tF(h.restDateString,h.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=rF(a.time),isNaN(c)))return t();if(a.timezone){if(f=nF(a.timezone),isNaN(f))return t()}else{const h=new Date(l+c),p=ut(0,n?.in);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return ut(l+c+f,n?.in)}const lu={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Xj=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,qj=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Zj=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Jj(e){const n={},t=e.split(lu.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],lu.timeZoneDelimiter.test(n.date)&&(n.date=e.split(lu.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=lu.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function eF(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function tF(e,n){if(n===null)return new Date(NaN);const t=e.match(Xj);if(!t)return new Date(NaN);const r=!!t[4],a=rl(t[1]),o=rl(t[2])-1,l=rl(t[3]),c=rl(t[4]),f=rl(t[5])-1;if(r)return lF(n,c,f)?aF(n,c,f):new Date(NaN);{const h=new Date(0);return!oF(n,o,l)||!iF(n,a)?new Date(NaN):(h.setUTCFullYear(n,o,Math.max(a,l)),h)}}function rl(e){return e?parseInt(e):1}function rF(e){const n=e.match(qj);if(!n)return NaN;const t=lf(n[1]),r=lf(n[2]),a=lf(n[3]);return cF(t,r,a)?t*ed+r*Ju+a*1e3:NaN}function lf(e){return e&&parseFloat(e.replace(",","."))||0}function nF(e){if(e==="Z")return 0;const n=e.match(Zj);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return uF(r,a)?t*(r*ed+a*Ju):NaN}function aF(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const sF=[31,null,31,30,31,30,31,31,30,31,30,31];function By(e){return e%400===0||e%4===0&&e%100!==0}function oF(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(sF[n]||(By(e)?29:28))}function iF(e,n){return n>=1&&n<=(By(e)?366:365)}function lF(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function cF(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function uF(e,n){return n>=0&&n<=59}function Un(e,n,t){const r=ut(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Kt(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=H3(l);return r.setMonth(n,Math.min(o,c)),r}function mu(e,n,t){const r=ut(e,t?.in);return r.setHours(n),r}function gu(e,n,t){const r=ut(e,t?.in);return r.setMinutes(n),r}function Jo(e,n,t){const r=ut(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Un(r,r.getMonth()+o*3)}function vu(e,n,t){const r=ut(e,t?.in);return r.setSeconds(n),r}function ya(e,n,t){const r=ut(e,t?.in);return isNaN(+r)?Kt(e,NaN):(r.setFullYear(n),r)}function io(e,n,t){return ca(e,-n,t)}function Wy(e,n,t){return Dp(e,-1,t)}function qg(e,n,t){return Ru(e,-1,t)}function fi(e,n,t){return Ga(e,-n,t)}function rd(){return typeof window<"u"}function yi(e){return Uy(e)?(e.nodeName||"").toLowerCase():"#document"}function Cn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Pa(e){var n;return(n=(Uy(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function Uy(e){return rd()?e instanceof Node||e instanceof Cn(e).Node:!1}function un(e){return rd()?e instanceof Element||e instanceof Cn(e).Element:!1}function Ta(e){return rd()?e instanceof HTMLElement||e instanceof Cn(e).HTMLElement:!1}function Zg(e){return!rd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Cn(e).ShadowRoot}function Ll(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Vn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function dF(e){return["table","td","th"].includes(yi(e))}function nd(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Op(e){const n=Rp(),t=un(e)?Vn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function fF(e){let n=zs(e);for(;Ta(n)&&!pi(n);){if(Op(n))return n;if(nd(n))return null;n=zs(n)}return null}function Rp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function pi(e){return["html","body","#document"].includes(yi(e))}function Vn(e){return Cn(e).getComputedStyle(e)}function ad(e){return un(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function zs(e){if(yi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Zg(e)&&e.host||Pa(e);return Zg(n)?n.host:n}function $y(e){const n=zs(e);return pi(n)?e.ownerDocument?e.ownerDocument.body:e.body:Ta(n)&&Ll(n)?n:$y(n)}function jl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=$y(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Cn(a);if(o){const c=Bf(l);return n.concat(l,l.visualViewport||[],Ll(a)?a:[],c&&t?jl(c):[])}return n.concat(a,jl(a,[],t))}function Bf(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const hi=Math.min,lo=Math.max,Wu=Math.round,cu=Math.floor,Na=e=>({x:e,y:e}),pF={left:"right",right:"left",bottom:"top",top:"bottom"},hF={start:"end",end:"start"};function Wf(e,n,t){return lo(e,hi(n,t))}function Bl(e,n){return typeof e=="function"?e(n):e}function mo(e){return e.split("-")[0]}function Wl(e){return e.split("-")[1]}function Hy(e){return e==="x"?"y":"x"}function zp(e){return e==="y"?"height":"width"}function co(e){return["top","bottom"].includes(mo(e))?"y":"x"}function Mp(e){return Hy(co(e))}function xF(e,n,t){t===void 0&&(t=!1);const r=Wl(e),a=Mp(e),o=zp(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=Uu(l)),[l,Uu(l)]}function mF(e){const n=Uu(e);return[Uf(e),n,Uf(n)]}function Uf(e){return e.replace(/start|end/g,n=>hF[n])}function gF(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function vF(e,n,t,r){const a=Wl(e);let o=gF(mo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map(Uf)))),o}function Uu(e){return e.replace(/left|right|bottom|top/g,n=>pF[n])}function yF(e){return{top:0,right:0,bottom:0,left:0,...e}}function Yy(e){return typeof e!="number"?yF(e):{top:e,right:e,bottom:e,left:e}}function $u(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var Hu=typeof document<"u"?E.useLayoutEffect:E.useEffect;const wF={...zv},kF=wF.useInsertionEffect,bF=kF||(e=>e());function _F(e){const n=E.useRef(()=>{});return bF(()=>{n.current=e}),E.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var Vy=Xf();const SF=Gu(Vy);function Jg(e,n,t){let{reference:r,floating:a}=e;const o=co(n),l=Mp(n),c=zp(l),f=mo(n),h=o==="y",p=r.x+r.width/2-a.width/2,m=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let v;switch(f){case"top":v={x:p,y:r.y-a.height};break;case"bottom":v={x:p,y:r.y+r.height};break;case"right":v={x:r.x+r.width,y:m};break;case"left":v={x:r.x-a.width,y:m};break;default:v={x:r.x,y:r.y}}switch(Wl(n)){case"start":v[l]-=g*(t&&h?-1:1);break;case"end":v[l]+=g*(t&&h?-1:1);break}return v}const EF=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let h=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:p,y:m}=Jg(h,r,f),g=r,v={},w=0;for(let b=0;b<c.length;b++){const{name:k,fn:N}=c[b],{x:C,y:S,data:U,reset:te}=await N({x:p,y:m,initialPlacement:r,placement:g,strategy:a,middlewareData:v,rects:h,platform:l,elements:{reference:e,floating:n}});p=C??p,m=S??m,v={...v,[k]:{...v[k],...U}},te&&w<=50&&(w++,typeof te=="object"&&(te.placement&&(g=te.placement),te.rects&&(h=te.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):te.rects),{x:p,y:m}=Jg(h,g,f)),b=-1)}return{x:p,y:m,placement:g,strategy:a,middlewareData:v}};async function Ky(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:m="floating",altBoundary:g=!1,padding:v=0}=Bl(n,e),w=Yy(v),k=c[g?m==="floating"?"reference":"floating":m],N=$u(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(k)))==null||t?k:k.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:h,rootBoundary:p,strategy:f})),C=m==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),U=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},te=$u(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:C,offsetParent:S,strategy:f}):C);return{top:(N.top-te.top+w.top)/U.y,bottom:(te.bottom-N.bottom+w.bottom)/U.y,left:(N.left-te.left+w.left)/U.x,right:(te.right-N.right+w.right)/U.x}}const NF=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:h,padding:p=0}=Bl(e,n)||{};if(h==null)return{};const m=Yy(p),g={x:t,y:r},v=Mp(a),w=zp(v),b=await l.getDimensions(h),k=v==="y",N=k?"top":"left",C=k?"bottom":"right",S=k?"clientHeight":"clientWidth",U=o.reference[w]+o.reference[v]-g[v]-o.floating[w],te=g[v]-o.reference[v],Q=await(l.getOffsetParent==null?void 0:l.getOffsetParent(h));let D=Q?Q[S]:0;(!D||!await(l.isElement==null?void 0:l.isElement(Q)))&&(D=c.floating[S]||o.floating[w]);const K=U/2-te/2,W=D/2-b[w]/2-1,oe=hi(m[N],W),J=hi(m[C],W),Y=oe,pe=D-b[w]-J,de=D/2-b[w]/2+K,G=Wf(Y,de,pe),ie=!f.arrow&&Wl(a)!=null&&de!==G&&o.reference[w]/2-(de<Y?oe:J)-b[w]/2<0,L=ie?de<Y?de-Y:de-pe:0;return{[v]:g[v]+L,data:{[v]:G,centerOffset:de-G-L,...ie&&{alignmentOffset:L}},reset:ie}}}),CF=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:h}=n,{mainAxis:p=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:b=!0,...k}=Bl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const N=mo(a),C=co(c),S=mo(c)===c,U=await(f.isRTL==null?void 0:f.isRTL(h.floating)),te=g||(S||!b?[Uu(c)]:mF(c)),Q=w!=="none";!g&&Q&&te.push(...vF(c,b,w,U));const D=[c,...te],K=await Ky(n,k),W=[];let oe=((r=o.flip)==null?void 0:r.overflows)||[];if(p&&W.push(K[N]),m){const G=xF(a,l,U);W.push(K[G[0]],K[G[1]])}if(oe=[...oe,{placement:a,overflows:W}],!W.every(G=>G<=0)){var J,Y;const G=(((J=o.flip)==null?void 0:J.index)||0)+1,ie=D[G];if(ie){var pe;const ne=m==="alignment"?C!==co(ie):!1,O=((pe=oe[0])==null?void 0:pe.overflows[0])>0;if(!ne||O)return{data:{index:G,overflows:oe},reset:{placement:ie}}}let L=(Y=oe.filter(ne=>ne.overflows[0]<=0).sort((ne,O)=>ne.overflows[1]-O.overflows[1])[0])==null?void 0:Y.placement;if(!L)switch(v){case"bestFit":{var de;const ne=(de=oe.filter(O=>{if(Q){const re=co(O.placement);return re===C||re==="y"}return!0}).map(O=>[O.placement,O.overflows.filter(re=>re>0).reduce((re,M)=>re+M,0)]).sort((O,re)=>O[1]-re[1])[0])==null?void 0:de[0];ne&&(L=ne);break}case"initialPlacement":L=c;break}if(a!==L)return{reset:{placement:L}}}return{}}}};async function TF(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=mo(t),c=Wl(t),f=co(t)==="y",h=["left","top"].includes(l)?-1:1,p=o&&f?-1:1,m=Bl(n,e);let{mainAxis:g,crossAxis:v,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof w=="number"&&(v=c==="end"?w*-1:w),f?{x:v*p,y:g*h}:{x:g*h,y:v*p}}const DF=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await TF(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},jF=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:k=>{let{x:N,y:C}=k;return{x:N,y:C}}},...f}=Bl(e,n),h={x:t,y:r},p=await Ky(n,f),m=co(mo(a)),g=Hy(m);let v=h[g],w=h[m];if(o){const k=g==="y"?"top":"left",N=g==="y"?"bottom":"right",C=v+p[k],S=v-p[N];v=Wf(C,v,S)}if(l){const k=m==="y"?"top":"left",N=m==="y"?"bottom":"right",C=w+p[k],S=w-p[N];w=Wf(C,w,S)}const b=c.fn({...n,[g]:v,[m]:w});return{...b,data:{x:b.x-t,y:b.y-r,enabled:{[g]:o,[m]:l}}}}}};function Gy(e){const n=Vn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Ta(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=Wu(t)!==o||Wu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function Ip(e){return un(e)?e:e.contextElement}function oi(e){const n=Ip(e);if(!Ta(n))return Na(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Gy(n);let l=(o?Wu(t.width):t.width)/r,c=(o?Wu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const FF=Na(0);function Qy(e){const n=Cn(e);return!Rp()||!n.visualViewport?FF:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function PF(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Cn(e)?!1:n}function go(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=Ip(e);let l=Na(1);n&&(r?un(r)&&(l=oi(r)):l=oi(e));const c=PF(o,t,r)?Qy(o):Na(0);let f=(a.left+c.x)/l.x,h=(a.top+c.y)/l.y,p=a.width/l.x,m=a.height/l.y;if(o){const g=Cn(o),v=r&&un(r)?Cn(r):r;let w=g,b=Bf(w);for(;b&&r&&v!==w;){const k=oi(b),N=b.getBoundingClientRect(),C=Vn(b),S=N.left+(b.clientLeft+parseFloat(C.paddingLeft))*k.x,U=N.top+(b.clientTop+parseFloat(C.paddingTop))*k.y;f*=k.x,h*=k.y,p*=k.x,m*=k.y,f+=S,h+=U,w=Cn(b),b=Bf(w)}}return $u({width:p,height:m,x:f,y:h})}function Lp(e,n){const t=ad(e).scrollLeft;return n?n.left+t:go(Pa(e)).left+t}function Xy(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:Lp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function AF(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Pa(r),c=n?nd(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},h=Na(1);const p=Na(0),m=Ta(r);if((m||!m&&!o)&&((yi(r)!=="body"||Ll(l))&&(f=ad(r)),Ta(r))){const v=go(r);h=oi(r),p.x=v.x+r.clientLeft,p.y=v.y+r.clientTop}const g=l&&!m&&!o?Xy(l,f,!0):Na(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-f.scrollLeft*h.x+p.x+g.x,y:t.y*h.y-f.scrollTop*h.y+p.y+g.y}}function OF(e){return Array.from(e.getClientRects())}function RF(e){const n=Pa(e),t=ad(e),r=e.ownerDocument.body,a=lo(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=lo(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+Lp(e);const c=-t.scrollTop;return Vn(r).direction==="rtl"&&(l+=lo(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function zF(e,n){const t=Cn(e),r=Pa(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const h=Rp();(!h||h&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function MF(e,n){const t=go(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Ta(e)?oi(e):Na(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,h=r*o.y;return{width:l,height:c,x:f,y:h}}function ev(e,n,t){let r;if(n==="viewport")r=zF(e,t);else if(n==="document")r=RF(Pa(e));else if(un(n))r=MF(n,t);else{const a=Qy(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return $u(r)}function qy(e,n){const t=zs(e);return t===n||!un(t)||pi(t)?!1:Vn(t).position==="fixed"||qy(t,n)}function IF(e,n){const t=n.get(e);if(t)return t;let r=jl(e,[],!1).filter(c=>un(c)&&yi(c)!=="body"),a=null;const o=Vn(e).position==="fixed";let l=o?zs(e):e;for(;un(l)&&!pi(l);){const c=Vn(l),f=Op(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Ll(l)&&!f&&qy(e,l))?r=r.filter(p=>p!==l):a=c,l=zs(l)}return n.set(e,r),r}function LF(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?nd(n)?[]:IF(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((h,p)=>{const m=ev(n,p,a);return h.top=lo(m.top,h.top),h.right=hi(m.right,h.right),h.bottom=hi(m.bottom,h.bottom),h.left=lo(m.left,h.left),h},ev(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function BF(e){const{width:n,height:t}=Gy(e);return{width:n,height:t}}function WF(e,n,t){const r=Ta(n),a=Pa(n),o=t==="fixed",l=go(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=Na(0);function h(){f.x=Lp(a)}if(r||!r&&!o)if((yi(n)!=="body"||Ll(a))&&(c=ad(n)),r){const v=go(n,!0,o,n);f.x=v.x+n.clientLeft,f.y=v.y+n.clientTop}else a&&h();o&&!r&&a&&h();const p=a&&!r&&!o?Xy(a,c):Na(0),m=l.left+c.scrollLeft-f.x-p.x,g=l.top+c.scrollTop-f.y-p.y;return{x:m,y:g,width:l.width,height:l.height}}function cf(e){return Vn(e).position==="static"}function tv(e,n){if(!Ta(e)||Vn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Pa(e)===t&&(t=t.ownerDocument.body),t}function Zy(e,n){const t=Cn(e);if(nd(e))return t;if(!Ta(e)){let a=zs(e);for(;a&&!pi(a);){if(un(a)&&!cf(a))return a;a=zs(a)}return t}let r=tv(e,n);for(;r&&dF(r)&&cf(r);)r=tv(r,n);return r&&pi(r)&&cf(r)&&!Op(r)?t:r||fF(e)||t}const UF=async function(e){const n=this.getOffsetParent||Zy,t=this.getDimensions,r=await t(e.floating);return{reference:WF(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function $F(e){return Vn(e).direction==="rtl"}const HF={convertOffsetParentRelativeRectToViewportRelativeRect:AF,getDocumentElement:Pa,getClippingRect:LF,getOffsetParent:Zy,getElementRects:UF,getClientRects:OF,getDimensions:BF,getScale:oi,isElement:un,isRTL:$F};function Jy(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function YF(e,n){let t=null,r;const a=Pa(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const h=e.getBoundingClientRect(),{left:p,top:m,width:g,height:v}=h;if(c||n(),!g||!v)return;const w=cu(m),b=cu(a.clientWidth-(p+g)),k=cu(a.clientHeight-(m+v)),N=cu(p),S={rootMargin:-w+"px "+-b+"px "+-k+"px "+-N+"px",threshold:lo(0,hi(1,f))||1};let U=!0;function te(Q){const D=Q[0].intersectionRatio;if(D!==f){if(!U)return l();D?l(!1,D):r=setTimeout(()=>{l(!1,1e-7)},1e3)}D===1&&!Jy(h,e.getBoundingClientRect())&&l(),U=!1}try{t=new IntersectionObserver(te,{...S,root:a.ownerDocument})}catch{t=new IntersectionObserver(te,S)}t.observe(e)}return l(!0),o}function ew(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,h=Ip(e),p=a||o?[...h?jl(h):[],...jl(n)]:[];p.forEach(N=>{a&&N.addEventListener("scroll",t,{passive:!0}),o&&N.addEventListener("resize",t)});const m=h&&c?YF(h,t):null;let g=-1,v=null;l&&(v=new ResizeObserver(N=>{let[C]=N;C&&C.target===h&&v&&(v.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var S;(S=v)==null||S.observe(n)})),t()}),h&&!f&&v.observe(h),v.observe(n));let w,b=f?go(e):null;f&&k();function k(){const N=go(e);b&&!Jy(b,N)&&t(),b=N,w=requestAnimationFrame(k)}return t(),()=>{var N;p.forEach(C=>{a&&C.removeEventListener("scroll",t),o&&C.removeEventListener("resize",t)}),m?.(),(N=v)==null||N.disconnect(),v=null,f&&cancelAnimationFrame(w)}}const tw=DF,VF=jF,rw=CF,$f=NF,Hf=(e,n,t)=>{const r=new Map,a={platform:HF,...t},o={...a.platform,_c:r};return EF(e,n,{...a,platform:o})};var yu=typeof document<"u"?E.useLayoutEffect:E.useEffect;function Yu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Yu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Yu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function nw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function rv(e,n){const t=nw(e);return Math.round(n*t)/t}function uf(e){const n=E.useRef(e);return yu(()=>{n.current=e}),n}function KF(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:h}=e,[p,m]=E.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,v]=E.useState(r);Yu(g,r)||v(r);const[w,b]=E.useState(null),[k,N]=E.useState(null),C=E.useCallback(ne=>{ne!==Q.current&&(Q.current=ne,b(ne))},[]),S=E.useCallback(ne=>{ne!==D.current&&(D.current=ne,N(ne))},[]),U=o||w,te=l||k,Q=E.useRef(null),D=E.useRef(null),K=E.useRef(p),W=f!=null,oe=uf(f),J=uf(a),Y=uf(h),pe=E.useCallback(()=>{if(!Q.current||!D.current)return;const ne={placement:n,strategy:t,middleware:g};J.current&&(ne.platform=J.current),Hf(Q.current,D.current,ne).then(O=>{const re={...O,isPositioned:Y.current!==!1};de.current&&!Yu(K.current,re)&&(K.current=re,Vy.flushSync(()=>{m(re)}))})},[g,n,t,J,Y]);yu(()=>{h===!1&&K.current.isPositioned&&(K.current.isPositioned=!1,m(ne=>({...ne,isPositioned:!1})))},[h]);const de=E.useRef(!1);yu(()=>(de.current=!0,()=>{de.current=!1}),[]),yu(()=>{if(U&&(Q.current=U),te&&(D.current=te),U&&te){if(oe.current)return oe.current(U,te,pe);pe()}},[U,te,pe,oe,W]);const G=E.useMemo(()=>({reference:Q,floating:D,setReference:C,setFloating:S}),[C,S]),ie=E.useMemo(()=>({reference:U,floating:te}),[U,te]),L=E.useMemo(()=>{const ne={position:t,left:0,top:0};if(!ie.floating)return ne;const O=rv(ie.floating,p.x),re=rv(ie.floating,p.y);return c?{...ne,transform:"translate("+O+"px, "+re+"px)",...nw(ie.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:O,top:re}},[t,c,ie.floating,p.x,p.y]);return E.useMemo(()=>({...p,update:pe,refs:G,elements:ie,floatingStyles:L}),[p,pe,G,ie,L])}const GF=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?$f({element:r.current,padding:a}).fn(t):{}:r?$f({element:r,padding:a}).fn(t):{}}}},QF=(e,n)=>({...tw(e),options:[e,n]}),XF=(e,n)=>({...rw(e),options:[e,n]}),qF=(e,n)=>({...GF(e),options:[e,n]}),ZF={...zv};let nv=!1,JF=0;const av=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+JF++;function eP(){const[e,n]=E.useState(()=>nv?av():void 0);return Hu(()=>{e==null&&n(av())},[]),E.useEffect(()=>{nv=!0},[]),e}const tP=ZF.useId,aw=tP||eP,rP=E.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:m,stroke:g,d:v,style:{transform:w,...b}={},...k}=n,N=aw(),[C,S]=E.useState(!1);if(Hu(()=>{if(!a)return;Vn(a).direction==="rtl"&&S(!0)},[a]),!a)return null;const[U,te]=r.split("-"),Q=U==="top"||U==="bottom";let D=m;(Q&&l!=null&&l.x||!Q&&l!=null&&l.y)&&(D=null);const K=p*2,W=K/2,oe=c/2*(h/-8+1),J=f/2*h/4,Y=!!v,pe=D&&te==="end"?"bottom":"top";let de=D&&te==="end"?"right":"left";D&&C&&(de=te==="end"?"left":"right");const G=o?.x!=null?D||o.x:"",ie=o?.y!=null?D||o.y:"",L=v||"M0,0"+(" H"+c)+(" L"+(c-oe)+","+(f-J))+(" Q"+c/2+","+f+" "+oe+","+(f-J))+" Z",ne={top:Y?"rotate(180deg)":"",left:Y?"rotate(90deg)":"rotate(-90deg)",bottom:Y?"":"rotate(180deg)",right:Y?"rotate(-90deg)":"rotate(90deg)"}[U];return u.jsxs("svg",{...k,"aria-hidden":!0,ref:t,width:Y?c:c+K,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[de]:G,[pe]:ie,[U]:Q||Y?"100%":"calc(100% - "+K/2+"px)",transform:[ne,w].filter(O=>!!O).join(" "),...b},children:[K>0&&u.jsx("path",{clipPath:"url(#"+N+")",fill:"none",stroke:g,strokeWidth:K+(v?0:1),d:L}),u.jsx("path",{stroke:K&&!v?k.fill:"none",d:L}),u.jsx("clipPath",{id:N,children:u.jsx("rect",{x:-W,y:W*(Y?-1:1),width:c+K,height:c})})]})});function nP(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const aP=E.createContext(null),sP=E.createContext(null),oP=()=>{var e;return((e=E.useContext(aP))==null?void 0:e.id)||null},iP=()=>E.useContext(sP);function lP(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=aw(),o=E.useRef({}),[l]=E.useState(()=>nP()),c=oP()!=null,[f,h]=E.useState(r.reference),p=_F((v,w,b)=>{o.current.openEvent=v?w:void 0,l.emit("openchange",{open:v,event:w,reason:b,nested:c}),t?.(v,w,b)}),m=E.useMemo(()=>({setPositionReference:h}),[]),g=E.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return E.useMemo(()=>({dataRef:o,open:n,onOpenChange:p,elements:g,events:l,floatingId:a,refs:m}),[n,p,g,l,a,m])}function cP(e){e===void 0&&(e={});const{nodeId:n}=e,t=lP({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=E.useState(null),[c,f]=E.useState(null),p=a?.domReference||o,m=E.useRef(null),g=iP();Hu(()=>{p&&(m.current=p)},[p]);const v=KF({...e,elements:{...a,...c&&{reference:c}}}),w=E.useCallback(S=>{const U=un(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),getClientRects:()=>S.getClientRects(),contextElement:S}:S;f(U),v.refs.setReference(U)},[v.refs]),b=E.useCallback(S=>{(un(S)||S===null)&&(m.current=S,l(S)),(un(v.refs.reference.current)||v.refs.reference.current===null||S!==null&&!un(S))&&v.refs.setReference(S)},[v.refs]),k=E.useMemo(()=>({...v.refs,setReference:b,setPositionReference:w,domReference:m}),[v.refs,b,w]),N=E.useMemo(()=>({...v.elements,domReference:p}),[v.elements,p]),C=E.useMemo(()=>({...v,...r,refs:k,elements:N,nodeId:n}),[v,k,N,n,r]);return Hu(()=>{r.dataRef.current.floatingContext=C;const S=g?.nodesRef.current.find(U=>U.id===n);S&&(S.context=C)}),E.useMemo(()=>({...v,context:C,refs:k,elements:N}),[v,k,N,C])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Yf=function(n,t){return Yf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},Yf(n,t)};function Rr(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Yf(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var At=function(){return At=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},At.apply(this,arguments)};function Ea(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var uP=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return Te.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},dP=function(e,n){var t=E.useRef(null),r=E.useRef(e);r.current=e;var a=E.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return E.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},sd=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=dP(t,l);return Te.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},nt;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(nt||(nt={}));function Bp(){var e=typeof window<"u"?window:globalThis;return e}var Ul=12;function Ut(e){if(e==null)return new Date;var n=typeof e=="string"?Qj(e):ut(e);return od(n)?n:new Date}function df(e,n,t,r,a){a===void 0&&(a=Ut());for(var o=xi(t)||xi(Wp()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var h=f[c],p=Uj(e,h,a,{locale:o});if(od(p)&&(!r||e===sr(p,h,t)))return p}return null}function od(e,n){return zu(e)&&!xo(e,new Date("1/1/1800"))}function sr(e,n,t){if(t==="en")return Qg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?xi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||xi(Wp()),Qg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Wn(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&sr(e,a,r)||""}function fP(e,n,t){if(!e)return"";var r=Wn(e,t),a=n?Wn(n,t):"";return"".concat(r," - ").concat(a)}function pP(e,n){if(!e?.length)return"";var t=e[0]?Wn(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=Wn(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function ff(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return mu(gu(vu(e,c),o),r)}function hP(e){return jp(e)}function xP(e,n){return sr(e,"ddd",n)}function wu(e){return ho(e)}function Ps(e,n,t){var r=xi(n||Wp());return ua(e,{locale:r,weekStartsOn:t})}function Za(e){return jy(e)}function ll(e){return td(e)}function sv(e){return Mf(e)}function ov(){return ho(Ut())}function iv(e){return Ty(e)}function mP(e){return Q4(e)}function gP(e){return Dy(e)}function wa(e,n){return e&&n?Kj(e,n):!e&&!n}function an(e,n){return e&&n?Yj(e,n):!e&&!n}function Vu(e,n){return e&&n?Vj(e,n):!e&&!n}function Pt(e,n){return e&&n?K4(e,n):!e&&!n}function ro(e,n){return e&&n?K3(e,n):!e&&!n}function cl(e,n,t){var r,a=ho(n),o=Ty(t);try{r=Dl(e,{start:a,end:o})}catch{r=!1}return r}function Aa(e,n){var t=Bp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function Wp(){var e=Bp();return e.__localeId__}function xi(e){if(typeof e=="string"){var n=Bp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function vP(e,n,t){return n(sr(e,"EEEE",t))}function yP(e,n){return sr(e,"EEEEEE",n)}function wP(e,n){return sr(e,"EEE",n)}function Up(e,n){return sr(Un(Ut(),e),"LLLL",n)}function sw(e,n){return sr(Un(Ut(),e),"LLL",n)}function kP(e,n){return sr(Jo(Ut(),e),"QQQ",n)}function $n(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,h=t.filterDate;return $l(e,{minDate:r,maxDate:a})||o&&o.some(function(p){return p instanceof Date?Pt(e,p):Pt(e,p.date)})||l&&l.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||c&&!c.some(function(p){return Pt(e,p)})||f&&!f.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||h&&!h(Ut(e))||!1}function $p(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Dl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?Pt(e,o):Pt(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function ow(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return $l(e,{minDate:r?jy(r):void 0,maxDate:a?Dy(a):void 0})||o?.some(function(f){return an(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return an(e,f)})||c&&!c(Ut(e))||!1}function uu(e,n,t,r){var a=St(e),o=cn(e),l=St(n),c=cn(n),f=St(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function bP(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return $l(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return an(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return an(c,e)})||!1}function du(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return $l(e,{minDate:r,maxDate:a})||o?.some(function(f){return Vu(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return Vu(e,f)})||c&&!c(Ut(e))||!1}function fu(e,n,t){if(!n||!t||!zu(n)||!zu(t))return!1;var r=St(n),a=St(t);return r<=e&&a>=e}function ku(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return $l(f,{minDate:r?td(r):void 0,maxDate:a?Fy(a):void 0})||o?.some(function(h){return wa(f,h instanceof Date?h:h.date)})||l&&!l.some(function(h){return wa(f,h)})||c&&!c(Ut(f))||!1}function pu(e,n,t,r){var a=St(e),o=oo(e),l=St(n),c=oo(n),f=St(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function $l(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&di(e,a)<0||o&&di(e,o)>0)!==null&&t!==void 0?t:!1}function lv(e,n){return n.some(function(t){return Xa(t)===Xa(e)&&qa(t)===qa(e)&&Fs(t)===Fs(e)})}function cv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&lv(e,r)||a&&!lv(e,a)||o&&!o(e)||!1}function uv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Ut();a=mu(a,Xa(e)),a=gu(a,qa(e)),a=vu(a,Fs(e));var o=Ut();o=mu(o,Xa(t)),o=gu(o,qa(t)),o=vu(o,Fs(t));var l=Ut();l=mu(l,Xa(r)),l=gu(l,qa(r)),l=vu(l,Fs(r));var c;try{c=!Dl(a,{start:o,end:l})}catch{c=!1}return c}function dv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=io(e,1);return r&&Mu(r,o)>0||a&&a.every(function(l){return Mu(l,o)>0})||!1}function fv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=ca(e,1);return r&&Mu(o,r)>0||a&&a.every(function(l){return Mu(o,l)>0})||!1}function _P(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=td(e),l=Wy(o);return r&&Iu(r,l)>0||a&&a.every(function(c){return Iu(c,l)>0})||!1}function SP(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Fy(e),l=Dp(o,1);return r&&Iu(l,r)>0||a&&a.every(function(c){return Iu(l,c)>0})||!1}function pv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=fi(e,1);return r&&Lu(r,o)>0||a&&a.every(function(l){return Lu(l,o)>0})||!1}function EP(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=ll(fi(e,o)),c=Ds(l,o).endPeriod,f=r&&St(r);return f&&f>c||!1}function hv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ga(e,1);return r&&Lu(o,r)>0||a&&a.every(function(l){return Lu(o,l)>0})||!1}function NP(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=Ga(e,o),c=Ds(l,o).startPeriod,f=r&&St(r);return f&&f<c||!1}function iw(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)>=0});return $g(r)}else return t?$g(t):n}function lw(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)<=0});return Ug(r)}else return t?Ug(t):n}function xv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Qa(l)){var c=sr(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var h=Object.keys(l),p=(t=h[0])!==null&&t!==void 0?t:"",m=l[p];if(typeof p=="string"&&Array.isArray(m))for(var g=0,v=m.length;g<v;g++){var w=m[g];if(w){var c=sr(w,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(p)||(f.push(p),r.set(c,f))}}}}return r}function CP(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function TP(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Qa(a)){var l=sr(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&CP(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?Ea(Ea([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function DP(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,h=a[c];h&&(f=$4(f,Xa(h)),f=zf(f,qa(h)),f=V4(f,Fs(h)));var p=zf(e,(t+1)*r);Rs(f,n)&&xo(f,p)&&h!=null&&l.push(h)}return l}function mv(e){return e<10?"0".concat(e):"".concat(e)}function Ds(e,n){n===void 0&&(n=Ul);var t=Math.ceil(St(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function jP(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function gv(e){var n=e.getSeconds(),t=e.getMilliseconds();return ut(e.getTime()-n*1e3-t)}function FP(e,n){return gv(e).getTime()===gv(n).getTime()}function vv(e){if(!Qa(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function yv(e,n){if(!Qa(e)||!Qa(n))throw new Error("Invalid date received");var t=vv(e),r=vv(n);return xo(t,r)}function cw(e){return e.key===nt.Space}var PP=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=Te.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),h=f?c:new Date;if(a?.includes(":")){var p=a.split(":"),m=p[0],g=p[1];h.setHours(Number(m)),h.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,h)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?E.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):Te.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var h;(h=r.inputRef.current)===null||h===void 0||h.focus()},required:!0,value:a,onChange:function(h){r.onTimeChange(h.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return Te.createElement("div",{className:"react-datepicker__input-time-container"},Te.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),Te.createElement("div",{className:"react-datepicker-time__input-container"},Te.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(E.Component),AP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=E.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===nt.Space&&(r.preventDefault(),r.key=nt.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return Pt(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),$n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return $p(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Pt(t.props.day,Ps(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&Pt(r,Ps(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=sr(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=sr(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:cl(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,h=a.selectsDisabledDaysInRange,p=a.startDate,m=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!h&&t.isDisabled()?!1:l&&m&&(xo(g,m)||ro(g,m))?cl(o,g,m):c&&p&&!m&&(Rs(g,p)||ro(g,p))||f&&p&&!m&&(Rs(g,p)||ro(g,p))?cl(o,p,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?Pt(o,f):Pt(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,h=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?Pt(o,h):Pt(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Pt(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Pt(l,a)},t.isWeekend=function(){var r=$3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===cn(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(cn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Ut())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Lr("react-datepicker__day",a,"react-datepicker__day--"+xP(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,h=t.isDisabled()||t.isExcluded()?f:l;return"".concat(h," ").concat(sr(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=sr(a,"MM.dd.yyyy"),h=[];return l.has(f)&&h.push.apply(h,l.get(f).holidayNames),t.isExcluded()&&h.push(c?.filter(function(p){return p instanceof Date?Pt(p,a):Pt(p?.date,a)}).map(function(p){if(!(p instanceof Date))return p?.message})),h.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&Pt(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Xg(t.props.day),t.props.day):Xg(t.props.day)},t.render=function(){return Te.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&Te.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(E.Component),OP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=E.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===nt.Space&&(r.preventDefault(),r.key=nt.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Pt(t.props.date,t.props.selected)&&Pt(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Pt(t.props.date,t.props.selected)&&Pt(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&Pt(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&Pt(this.props.date,this.props.selected)};return Te.createElement("div",{ref:this.weekNumberEl,className:Lr(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(E.Component),RP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return $n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,h=new Date(r),p=0;p<7;p++){var m=new Date(r);m.setDate(m.getDate()+p);var g=!t.isDisabled(m);if(g){h=m;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(h,a,o),t.props.showWeekPicker&&t.handleDayClick(h,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):hP(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=ia(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=ia(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(Te.createElement(OP,At({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=ia(r,c);return Te.createElement(AP,At({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Ps(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Pt(t.startOfWeek(),t.props.selected)&&Pt(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Pt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return Te.createElement("div",{className:Lr(t)},this.renderDays())},n})(E.Component),nl,zP=6,ii={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},pf=(nl={},nl[ii.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},nl[ii.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},nl[ii.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},nl),hu=1;function wv(e,n){return e?ii.FOUR_COLUMNS:n?ii.TWO_COLUMNS:ii.THREE_COLUMNS}var MP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=Ea([],Array(12),!0).map(function(){return E.createRef()}),t.QUARTER_REFS=Ea([],Array(4),!0).map(function(){return E.createRef()}),t.isDisabled=function(r){return $n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return $p(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Un(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Vu(Jo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Un(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Vu(Jo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?uu(g,m,r,l):f&&p||h&&p&&!m?uu(p,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,h=Un(l,r),p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?an(h,p):an(h,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,h=o.selectsRange,p=Un(l,r),m=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||h?an(p,m):an(p,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?pu(g,m,r,l):f&&p||h&&p&&!m?pu(p,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=ia(r,6);return an(r,a)||an(o,a)},t.isCurrentMonth=function(r,a){return St(r)===St(Ut())&&a===cn(Ut())},t.isCurrentQuarter=function(r,a){return St(r)===St(Ut())&&a===oo(Ut())},t.isSelectedMonth=function(r,a,o){return cn(o)===a&&St(r)===St(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return oo(r)===a&&St(r)===St(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Ps(Za(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(w){return t.props.showWeekPicker?Ps(w,t.props.locale,t.props.calendarStartDay):t.props.preSelection},h=function(w){return t.props.showWeekPicker?Ps(w,t.props.locale,t.props.calendarStartDay):t.props.selected},p=t.props.selected?h(t.props.selected):void 0,m=t.props.preSelection?f(t.props.preSelection):void 0;r.push(Te.createElement(RP,At({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:cn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:p,preSelection:m,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=Ru(c,1);var g=a&&o>=zP,v=!a&&!t.isWeekInMonth(c);if(g||v)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Za(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Za(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,h=c.preSelection,p=c.setPreSelection,m=c.minDate,g=c.maxDate,v=c.showFourColumnMonthYearPicker,w=c.showTwoColumnMonthYearPicker;if(h){var b=wv(v,w),k=t.getVerticalOffset(b),N=(l=pf[b])===null||l===void 0?void 0:l.grid,C=function(D,K,W){var oe,J,Y=K,pe=W;switch(D){case nt.ArrowRight:Y=ca(K,hu),pe=W===11?0:W+hu;break;case nt.ArrowLeft:Y=io(K,hu),pe=W===0?11:W-hu;break;case nt.ArrowUp:Y=io(K,k),pe=!((oe=N?.[0])===null||oe===void 0)&&oe.includes(W)?W+12-k:W-k;break;case nt.ArrowDown:Y=ca(K,k),pe=!((J=N?.[N.length-1])===null||J===void 0)&&J.includes(W)?W-12+k:W+k;break}return{newCalculatedDate:Y,newCalculatedMonth:pe}},S=function(D,K,W){for(var oe=40,J=D,Y=!1,pe=0,de=C(J,K,W),G=de.newCalculatedDate,ie=de.newCalculatedMonth;!Y;){if(pe>=oe){G=K,ie=W;break}if(m&&G<m){J=nt.ArrowRight;var L=C(J,G,ie);G=L.newCalculatedDate,ie=L.newCalculatedMonth}if(g&&G>g){J=nt.ArrowLeft;var L=C(J,G,ie);G=L.newCalculatedDate,ie=L.newCalculatedMonth}if(bP(G,t.props)){var L=C(J,G,ie);G=L.newCalculatedDate,ie=L.newCalculatedMonth}else Y=!0;pe++}return{newCalculatedDate:G,newCalculatedMonth:ie}};if(a===nt.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),p?.(f));return}var U=S(a,h,o),te=U.newCalculatedDate,Q=U.newCalculatedMonth;switch(a){case nt.ArrowRight:case nt.ArrowLeft:case nt.ArrowUp:case nt.ArrowDown:t.handleMonthNavigation(Q,te);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=pf[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==nt.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Jo(t.props.day,a);du(o,t.props)||t.handleDayClick(sv(o),r)},t.onQuarterMouseEnter=function(r){var a=Jo(t.props.day,r);du(a,t.props)||t.handleDayMouseEnter(sv(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case nt.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case nt.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Dp(t.props.preSelection,1));break;case nt.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,Wy(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=Un(l,r);return{isDisabled:(a=(c||f||h||p)&&ow(m,t.props))!==null&&a!==void 0?a:!1,labelDate:m}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,h=a.monthClassName,p=h?h(Un(o,r)):void 0,m=t.getSelection();return Lr("react-datepicker__month-text","react-datepicker__month-".concat(r),p,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":m?t.isSelectMonthInList(o,r,m):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=cn(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=oo(t.props.preSelection),o=du(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,h=a.day,p=a.locale,m=Un(h,r),g=t.isDisabled(m)||t.isExcluded(m)?f:l;return"".concat(g," ").concat(sr(m,"MMMM yyyy",p))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,h=a.minDate,p=a.maxDate,m=a.excludeDates,g=a.includeDates,v=a.filterDate,w=a.preSelection,b=a.disabledKeyboardNavigation,k=(h||p||m||g||v)&&du(Jo(o,r),t.props);return Lr("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":k,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!b&&w&&t.isSelectedQuarter(o,r,w)&&!k,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?pu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,h=sw(r,c),p=Up(r,c);return l?l(r,h,p,f):o?p:h},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=kP(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,h=(r=pf[wv(l,o)])===null||r===void 0?void 0:r.grid;return h?.map(function(p,m){return Te.createElement("div",{className:"react-datepicker__month-wrapper",key:m},p.map(function(g,v){return Te.createElement("div",{ref:t.MONTH_REFS[g],key:v,onClick:function(w){t.onMonthClick(w,g)},onKeyDown:function(w){cw(w)&&(w.preventDefault(),w.key=nt.Enter),t.onMonthKeyDown(w,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return Te.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return Te.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(h){t.onQuarterClick(h,c)},onKeyDown:function(h){t.onQuarterKeyDown(h,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,h=r.showWeekPicker;return Lr("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":h})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return Te.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(sr(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(E.Component),IP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return Te.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?Te.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return Te.createElement(sd,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(E.Component),LP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return Te.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return Te.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},Te.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return Te.createElement(IP,At({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return sw(o,t.props.locale)}:function(o){return Up(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return Te.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(E.Component);function BP(e,n){for(var t=[],r=Za(e),a=Za(n);!Rs(r,a);)t.push(Ut(r)),r=ca(r,1);return t}var WP=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=Lf(a),l=wa(r.props.date,a)&&an(r.props.date,a);return Te.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?Te.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",sr(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:BP(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Lr({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return Te.createElement(sd,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(E.Component),UP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Za(t.props.minDate),a=Za(t.props.maxDate),o=[];!Rs(r,a);){var l=Lf(r);o.push(Te.createElement("option",{key:l,value:l},sr(r,t.props.dateFormat,t.props.locale))),r=ca(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Te.createElement("select",{value:Lf(Za(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=sr(t.props.date,t.props.dateFormat,t.props.locale);return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},Te.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return Te.createElement(WP,At({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Ut(r);wa(t.props.date,a)&&an(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Te.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(E.Component),$P=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&FP(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(Xa(r)*3600+qa(r)*60+Fs(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===nt.Space&&(r.preventDefault(),r.key=nt.Enter),(r.key===nt.ArrowUp||r.key===nt.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===nt.ArrowDown||r.key===nt.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===nt.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Ut(),f=wu(c),h=t.props.injectTimes&&t.props.injectTimes.sort(function(k,N){return k.getTime()-N.getTime()}),p=60*jP(c),m=p/l,g=0;g<m;g++){var v=zf(f,g*l);if(a.push(v),h){var w=DP(f,v,g,l,h);a=a.concat(w)}}var b=a.reduce(function(k,N){return N.getTime()<=c.getTime()?N:k},a[0]);return a.map(function(k){return Te.createElement("li",{key:k.valueOf(),onClick:t.handleClick.bind(t,k),className:t.liClasses(k),ref:function(N){k===b&&(t.centerLi=N)},onKeyDown:function(N){t.handleOnKeyDown(N,k)},tabIndex:k===b?0:-1,role:"option","aria-selected":t.isSelectedTime(k)?"true":void 0,"aria-disabled":t.isDisabledTime(k)?"true":void 0},sr(k,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?Te.createElement(Te.Fragment,null):Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},Te.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return Te.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),Te.createElement("div",{className:"react-datepicker__time"},Te.createElement("div",{className:"react-datepicker__time-box"},Te.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(E.Component),kv=3,HP=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=Ea([],Array(r.props.yearItemNumber),!0).map(function(){return E.createRef()}),r.isDisabled=function(a){return $n(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return $p(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,h,p=r.props,m=p.date,g=p.yearItemNumber;if(!(m===void 0||g===void 0)){var v=Ds(m,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-v<0?r.updateFocusOnPaginate(g-(v-a)):a-v>=g?r.updateFocusOnPaginate(Math.abs(g-(a-v))):(h=(f=r.YEAR_REFS[a-v])===null||f===void 0?void 0:f.current)===null||h===void 0||h.focus())}},r.isSameDay=function(a,o){return Pt(a,o)},r.isCurrentYear=function(a){return a===St(Ut())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&wa(ya(Ut(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&wa(ya(Ut(),a),r.props.endDate)},r.isInRange=function(a){return fu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,h=o.startDate,p=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&p?fu(a,r.selectingDate(),p):c&&h||f&&h&&!p?fu(a,h,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,h=ya(Ut(),a);return f?wa(h,(o=r.selectingDate())!==null&&o!==void 0?o:null):wa(h,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,h=l.selectsRange,p=ya(Ut(),a);return f||h?wa(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):wa(p,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,h=o.includeDates,p=o.filterDate,m=ll(ya(r.props.date,a)),g=(l||c||f||h||p)&&ku(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Pt(m,ll(r.props.selected))&&Pt(m,ll(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(h){return a===St(h)}):!c||a===St(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ll(ya(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,h=r.props,p=h.date,m=h.yearItemNumber,g=h.handleOnKeyDown;if(f!==nt.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case nt.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case nt.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Ga(r.props.preSelection,1));break;case nt.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,fi(r.props.preSelection,1));break;case nt.ArrowUp:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var v=Ds(p,m).startPeriod,w=kv,b=o-w;if(b<v){var k=m%w;o>=v&&o<v+k?w=k:w+=k,b=o-w}r.handleYearNavigation(b,fi(r.props.preSelection,w));break}case nt.ArrowDown:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var N=Ds(p,m).endPeriod,w=kv,b=o+w;if(b>N){var k=m%w;o<=N&&o>N-k?w=k:w+=k,b=o+w}r.handleYearNavigation(b,Ga(r.props.preSelection,w));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=o.filterDate,g=o.yearClassName;return Lr("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(ya(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||h||p||m)&&ku(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=St(r.props.preSelection),l=ku(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var h=Ds(o,l),p=h.startPeriod,m=h.endPeriod,g=function(b){r.push(Te.createElement("div",{ref:v.YEAR_REFS[b-p],onClick:function(k){t.onYearClick(k,b)},onKeyDown:function(k){cw(k)&&(k.preventDefault(),k.key=nt.Enter),t.onYearKeyDown(k,b)},tabIndex:Number(v.getYearTabIndex(b)),className:v.getYearClassNames(b),onMouseEnter:v.props.usePointerEvent?void 0:function(k){return c(k,b)},onPointerEnter:v.props.usePointerEvent?function(k){return c(k,b)}:void 0,onMouseLeave:v.props.usePointerEvent?void 0:function(k){return f(k,b)},onPointerLeave:v.props.usePointerEvent?function(k){return f(k,b)}:void 0,key:b,"aria-current":v.isCurrentYear(b)?"date":void 0},v.getYearContent(b)))},v=this,w=p;w<=m;w++)g(w);return Te.createElement("div",{className:"react-datepicker__year"},Te.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(E.Component);function YP(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=St(t)<=l),r&&c&&(c=St(r)>=l),c&&a.push(l)}return a}var VP=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(m){return Te.createElement("div",{className:c===m?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:m,onClick:r.onChange.bind(r,m),"aria-selected":c===m?"true":void 0},c===m?Te.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",m)}),h=r.props.minDate?St(r.props.minDate):null,p=r.props.maxDate?St(r.props.maxDate):null;return(!p||!r.state.yearsList.find(function(m){return m===p}))&&f.unshift(Te.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!h||!r.state.yearsList.find(function(m){return m===h}))&&f.push(Te.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(h){return h+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:YP(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=E.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Lr({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return Te.createElement(sd,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(E.Component),KP=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?St(t.props.minDate):1900,a=t.props.maxDate?St(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(Te.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Te.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},Te.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return Te.createElement(VP,At({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Te.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(E.Component),GP=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],QP=function(e){var n=(e.className||"").split(/\s+/);return GP.some(function(t){return n.indexOf(t)>=0})},XP=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;QP(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=iw(r.props),h=lw(r.props),p=Ut(),m=c||l||o;return m||(f&&xo(p,f)?f:h&&Rs(p,h)?h:p)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:ca(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:io(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:ya(Ut(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!$n(a,r.props))return a;for(var o=Za(a),l=gP(a),c=G4(l,o),f=null,h=0;h<=c;h++){var p=ia(o,h);if(!$n(p,r.props)){f=p;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:ya(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Un(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:ya(Un(l,cn(a)),St(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Ps(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(Te.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=ia(o,c),h=r.formatWeekday(f,r.props.locale),p=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return Te.createElement("div",{key:c,"aria-label":sr(f,"EEEE",r.props.locale),className:Lr("react-datepicker__day-name",p)},h)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?vP(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?wP(a,o):yP(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:fi(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,p=io(r.state.date,h),m;switch(!0){case r.props.showMonthYearPicker:m=pv(r.state.date,r.props);break;case r.props.showYearPicker:m=EP(r.state.date,r.props);break;case r.props.showQuarterYearPicker:m=_P(r.state.date,r.props);break;default:m=dv(p,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&m||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],v=["react-datepicker__navigation","react-datepicker__navigation--previous"],w=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(w=r.decreaseYear),m&&r.props.showDisabledMonthNavigation&&(v.push("react-datepicker__navigation--previous--disabled"),w=void 0);var b=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,k=r.props,N=k.previousMonthButtonLabel,C=N===void 0?n.defaultProps.previousMonthButtonLabel:N,S=k.previousYearButtonLabel,U=S===void 0?n.defaultProps.previousYearButtonLabel:S,te=r.props,Q=te.previousMonthAriaLabel,D=Q===void 0?typeof C=="string"?C:"Previous Month":Q,K=te.previousYearAriaLabel,W=K===void 0?typeof U=="string"?U:"Previous Year":K;return Te.createElement("button",{type:"button",className:v.join(" "),onClick:w,onKeyDown:r.props.handleOnKeyDown,"aria-label":b?W:D},Te.createElement("span",{className:g.join(" ")},b?U:C))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Ga(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=hv(r.state.date,r.props);break;case r.props.showYearPicker:o=NP(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=SP(r.state.date,r.props);break;default:o=fv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,m=p.nextMonthButtonLabel,g=m===void 0?n.defaultProps.nextMonthButtonLabel:m,v=p.nextYearButtonLabel,w=v===void 0?n.defaultProps.nextYearButtonLabel:v,b=r.props,k=b.nextMonthAriaLabel,N=k===void 0?typeof g=="string"?g:"Next Month":k,C=b.nextYearAriaLabel,S=C===void 0?typeof w=="string"?w:"Next Year":C;return Te.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":h?S:N},Te.createElement("span",{className:c.join(" ")},h?w:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),Te.createElement("h2",{className:o.join(" ")},sr(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return Te.createElement(KP,At({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:St(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return Te.createElement(LP,At({},n.defaultProps,r.props,{month:cn(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return Te.createElement(UP,At({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(ov(),a),r.props.setPreSelection&&r.props.setPreSelection(ov())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return Te.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return Te.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),Te.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),Te.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var h=dv(r.state.date,r.props),p=fv(r.state.date,r.props),m=pv(r.state.date,r.props),g=hv(r.state.date,r.props),v=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,At(At({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:p,prevYearButtonDisabled:m,nextYearButtonDisabled:g})),v&&Te.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,h=f===void 0?n.defaultProps.yearItemNumber:f,p=Ds(o,h),m=p.startPeriod,g=p.endPeriod;return Te.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(m," - ").concat(g):St(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ga(r.state.date,f):io(r.state.date,f),p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,m=0;m<c;++m){var g=m-p+f,v=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ga(h,g):ca(h,g),w="month-".concat(m),b=m<c-1,k=m>0;l.push(Te.createElement("div",{key:w,ref:function(N){r.monthContainer=N??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:v,i:m}),Te.createElement(MP,At({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:v,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:m,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:b,monthShowsDuplicateDaysStart:k}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return Te.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),Te.createElement(HP,At({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return Te.createElement($P,At({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&od(a)&&!!r.props.selected,l=o?"".concat(mv(a.getHours()),":").concat(mv(a.getMinutes())):"";if(r.props.showTimeInput)return Te.createElement(PP,At({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=Ds(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=St(r.state.date):f="".concat(Up(cn(r.state.date),r.props.locale)," ").concat(St(r.state.date)),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return Te.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=E.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:Ul}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!Pt(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!an(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!Pt(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||uP;return Te.createElement(sd,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},Te.createElement("div",{style:{display:"contents"},ref:this.containerRef},Te.createElement(t,{className:Lr("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(E.Component),qP=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return Te.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(Te.isValidElement(n)){var l=n;return Te.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return Te.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},Te.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},uw=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return SF.createPortal(this.props.children,this.el)},n})(E.Component),ZP="[tabindex], a, button, input, select, textarea",JP=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},dw=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(ZP),1,-1).filter(JP)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=E.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?Te.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},Te.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,Te.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(E.Component);function eA(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=E.useRef(null),l=cP(At({open:!a,whileElementsMounted:ew,placement:t.popperPlacement,middleware:Ea([XF({padding:15}),QF(10),qF({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=At(At({},t),{hidePopper:a,popperProps:At(At({},l),{arrowRef:o})});return Te.createElement(e,At({},c))};return n}var tA=(function(e){Rr(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,h=t.enableTabLoop,p=t.popperOnKeyDown,m=t.portalId,g=t.portalHost,v=t.popperProps,w=t.showArrow,b=void 0;if(!l){var k=Lr("react-datepicker-popper",r);b=Te.createElement(dw,{enableTabLoop:h},Te.createElement("div",{ref:v.refs.setFloating,style:v.floatingStyles,className:k,"data-placement":v.placement,onKeyDown:p},c,w&&Te.createElement(rP,{ref:v.arrowRef,context:v.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(b=E.createElement(this.props.popperContainer,{},b)),m&&!l&&(b=Te.createElement(uw,{portalId:m,portalHost:g},b));var N=Lr("react-datepicker-wrapper",a);return Te.createElement(Te.Fragment,null,Te.createElement("div",{ref:v.refs.setReference,className:N},f),b)},n})(E.Component),rA=eA(tA),bv="react-datepicker-ignore-onclickoutside";function nA(e,n){return e&&n?cn(e)!==cn(n)||St(e)!==St(n):e!==n}var hf="Date input not valid.",wn=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Ut()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return od(c)?Ea(Ea([],o,!0),[At(At({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=iw(r.props),c=lw(r.props),f=l&&xo(o,wu(l))?l:c&&Rs(o,iv(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:xv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(At(At({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(At(At({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:xf},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Qa(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var m=h[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,h),!m||typeof m.isDefaultPrevented!="function"||m.isDefaultPrevented()))){r.setState({inputValue:m?.target instanceof HTMLInputElement?m.target.value:null,lastPreSelectChange:aA});var g=r.props,v=g.selectsRange,w=g.startDate,b=g.endDate,k=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,N=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,C=m?.target instanceof HTMLInputElement?m.target.value:"";if(v){var S=C.split("-",2).map(function(J){return J.trim()}),U=S[0],te=S[1],Q=df(U??"",k,r.props.locale,N),D=df(te??"",k,r.props.locale,N),K=w?.getTime()!==Q?.getTime(),W=b?.getTime()!==D?.getTime();if(!K&&!W||Q&&$n(Q,r.props)||D&&$n(D,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[Q,D],m)}else{var oe=df(C,k,r.props.locale,N,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(oe||!C)&&r.setSelected(oe,m,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,h=c.endDate;f&&!h&&(r.props.swapRange||!yv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,h,p=a;if(r.props.showYearPicker){if(p!==null&&ku(St(p),r.props))return}else if(r.props.showMonthYearPicker){if(p!==null&&ow(p,r.props))return}else if(p!==null&&$n(p,r.props))return;var m=r.props,g=m.onChange,v=m.selectsRange,w=m.startDate,b=m.endDate,k=m.selectsMultiple,N=m.selectedDates,C=m.minTime,S=m.swapRange;if(!ro(r.props.selected,p)||r.props.allowSameDay||v||k)if(p!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(p=ff(p,{hour:Xa(r.props.selected),minute:qa(r.props.selected),second:Fs(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&C&&(p=ff(p,{hour:C.getHours(),minute:C.getMinutes(),second:C.getSeconds()})),r.props.inline||r.setState({preSelection:p}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),v){var U=!w&&!b,te=w&&!b,Q=w&&b;U?g?.([p,null],o):te&&(p===null?g?.([null,null],o):yv(p,w)?g?.(S?[p,w]:[p,null],o):g?.([w,p],o)),Q&&g?.([p,null],o)}else if(k){if(p!==null)if(!N?.length)g?.([p],o);else{var D=N.some(function(W){return Pt(W,p)});if(D){var K=N.filter(function(W){return!Pt(W,p)});g?.(K,o)}else g?.(Ea(Ea([],N,!0),[p],!1),o)}}else g?.(p,o);l||((h=(f=r.props).onSelect)===null||h===void 0||h.call(f,p,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Qa(r.props.minDate),l=Qa(r.props.maxDate),c=!0;if(a){var f=wu(a);if(o&&l)c=cl(a,r.props.minDate,r.props.maxDate);else if(o){var h=wu(r.props.minDate);c=Rs(a,h)||ro(f,h)}else if(l){var p=iv(r.props.maxDate);c=xo(a,p)||ro(f,p)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:ff(c,{hour:Xa(a),minute:qa(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,h,p;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var m=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(m===nt.ArrowDown||m===nt.ArrowUp||m===nt.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(m===nt.ArrowDown||m===nt.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',v=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);v instanceof HTMLElement&&v.focus({preventScroll:!0});return}var w=Ut(r.state.preSelection);m===nt.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===xf?(r.handleSelect(w,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(w)):r.setOpen(!1)):m===nt.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):m===nt.Tab&&r.setOpen(!1),r.inputOk()||(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hf})}},r.onPortalKeyDown=function(a){var o=a.key;o===nt.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,h,p,m=r.props,g=m.minDate,v=m.maxDate,w=m.disabledKeyboardNavigation,b=m.showWeekPicker,k=m.shouldCloseOnSelect,N=m.locale,C=m.calendarStartDay,S=m.adjustDateOnChange,U=m.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!w){var te=a.key,Q=a.shiftKey,D=Ut(r.state.preSelection),K=function(G,ie){var L=ie;switch(G){case nt.ArrowRight:L=b?Ru(ie,1):ia(ie,1);break;case nt.ArrowLeft:L=b?qg(ie):Gj(ie);break;case nt.ArrowUp:L=qg(ie);break;case nt.ArrowDown:L=Ru(ie,1);break;case nt.PageUp:L=Q?fi(ie,1):io(ie,1);break;case nt.PageDown:L=Q?Ga(ie,1):ca(ie,1);break;case nt.Home:L=Ps(ie,N,C);break;case nt.End:L=mP(ie);break}return L},W=function(G,ie){for(var L=40,ne=G,O=!1,re=0,M=K(G,ie);!O;){if(re>=L){M=ie;break}g&&M<g&&(ne=nt.ArrowRight,M=$n(g,r.props)?K(ne,M):g),v&&M>v&&(ne=nt.ArrowLeft,M=$n(v,r.props)?K(ne,M):v),$n(M,r.props)?((ne===nt.PageUp||ne===nt.Home)&&(ne=nt.ArrowRight),(ne===nt.PageDown||ne===nt.End)&&(ne=nt.ArrowLeft),M=K(ne,M)):O=!0,re++}return M};if(te===nt.Enter){a.preventDefault(),r.handleSelect(D,a),!k&&r.setPreSelection(D);return}else if(te===nt.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:hf});return}var oe=null;switch(te){case nt.ArrowLeft:case nt.ArrowRight:case nt.ArrowUp:case nt.ArrowDown:case nt.PageUp:case nt.PageDown:case nt.Home:case nt.End:oe=W(te,D);break}if(!oe){(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hf});return}if(a.preventDefault(),r.setState({lastPreSelectChange:xf}),S&&r.setSelected(oe),r.setPreSelection(oe),U){var J=cn(D),Y=cn(oe),pe=St(D),de=St(oe);J!==Y||pe!==de?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===nt.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:Te.createElement(XP,At({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:TP(r.modifyHolidays()),outsideClickIgnoreClass:bv,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,h=f?"PPPPp":"PPPP",p;return r.props.selectsRange?p="Selected start date: ".concat(Wn(r.props.startDate,{dateFormat:h,locale:c}),". ").concat(r.props.endDate?"End date: "+Wn(r.props.endDate,{dateFormat:h,locale:c}):""):r.props.showTimeSelectOnly?p="Selected time: ".concat(Wn(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?p="Selected year: ".concat(Wn(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?p="Selected month: ".concat(Wn(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?p="Selected quarter: ".concat(Wn(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):p="Selected date: ".concat(Wn(r.props.selected,{dateFormat:h,locale:c})),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},p)},r.renderDateInput=function(){var a,o,l,c=Lr(r.props.className,(a={},a[bv]=r.state.open,a)),f=r.props.customInput||Te.createElement("input",{type:"text"}),h=r.props.customInputRef||"ref",p=r.props,m=p.dateFormat,g=m===void 0?n.defaultProps.dateFormat:m,v=p.locale,w=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?fP(r.props.startDate,r.props.endDate,{dateFormat:g,locale:v}):r.props.selectsMultiple?pP((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:v}):Wn(r.props.selected,{dateFormat:g,locale:v});return E.cloneElement(f,(o={},o[h]=function(b){r.input=b},o.value=w,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Lr(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,h=a.endDate,p=a.clearButtonTitle,m=a.clearButtonClassName,g=m===void 0?"":m,v=a.ariaLabelClose,w=v===void 0?"Close":v,b=a.selectedDates;return o&&(c!=null||f!=null||h!=null||b?.length)?Te.createElement("button",{type:"button",className:Lr("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":w,onClick:r.onClearClick,title:p,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:Ul,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&nA(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:xv(this.props.highlightDates)}),!r.focused&&!ro(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),Te.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&Te.createElement(qP,At({icon:a,className:Lr(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?Te.createElement(dw,{enableTabLoop:this.props.enableTabLoop},Te.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=Te.createElement(uw,At({portalId:this.props.portalId},this.props),r)),Te.createElement("div",null,this.renderInputContainer(),r)}return Te.createElement(rA,At({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(E.Component),aA="input",xf="navigate";const sA={lessThanXSeconds:{one:{regular:"mniej ni sekunda",past:"mniej ni sekund",future:"mniej ni sekund"},twoFour:"mniej ni {{count}} sekundy",other:"mniej ni {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekund",future:"sekund"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"p minuty",twoFour:"p minuty",other:"p minuty"},lessThanXMinutes:{one:{regular:"mniej ni minuta",past:"mniej ni minut",future:"mniej ni minut"},twoFour:"mniej ni {{count}} minuty",other:"mniej ni {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minut",future:"minut"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"okoo godziny",past:"okoo godziny",future:"okoo godzin"},twoFour:"okoo {{count}} godziny",other:"okoo {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzin",future:"godzin"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzie",past:"dzie",future:"1 dzie"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"okoo tygodnia",twoFour:"okoo {{count}} tygodni",other:"okoo {{count}} tygodni"},xWeeks:{one:"tydzie",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"okoo miesic",twoFour:"okoo {{count}} miesice",other:"okoo {{count}} miesicy"},xMonths:{one:"miesic",twoFour:"{{count}} miesice",other:"{{count}} miesicy"},aboutXYears:{one:"okoo rok",twoFour:"okoo {{count}} lata",other:"okoo {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function oA(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function mf(e,n,t){const r=oA(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const iA=(e,n,t)=>{const r=sA[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+mf(r,n,"future"):mf(r,n,"past")+" temu":mf(r,n,"regular")},lA={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},cA={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},uA={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},dA={date:si({formats:lA,defaultWidth:"full"}),time:si({formats:cA,defaultWidth:"full"}),dateTime:si({formats:uA,defaultWidth:"full"})},fA={masculine:"ostatni",feminine:"ostatnia"},pA={masculine:"ten",feminine:"ta"},hA={masculine:"nastpny",feminine:"nastpna"},xA={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function _v(e,n,t,r){let a;if(Hj(n,t,r))a=pA;else if(e==="lastWeek")a=fA;else if(e==="nextWeek")a=hA;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=xA[o];return`'${a[l]}' eeee 'o' p`}const mA={lastWeek:_v,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:_v,other:"P"},gA=(e,n,t,r)=>{const a=mA[e];return typeof a=="function"?a(e,n,t,r):a},vA={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed nasz er","naszej ery"]},yA={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwarta","II kwarta","III kwarta","IV kwarta"]},wA={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"]},kA={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrzenia","padziernika","listopada","grudnia"]},bA={narrow:["N","P","W","","C","P","S"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},_A={narrow:["n","p","w","","c","p","s"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},SA={narrow:{am:"a",pm:"p",midnight:"pn.",noon:"po",morning:"rano",afternoon:"popo.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"}},EA={narrow:{am:"a",pm:"p",midnight:"o pn.",noon:"w po.",morning:"rano",afternoon:"po po.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"}},NA=(e,n)=>String(e),CA={ordinalNumber:NA,era:ka({values:vA,defaultWidth:"wide"}),quarter:ka({values:yA,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ka({values:wA,defaultWidth:"wide",formattingValues:kA,defaultFormattingWidth:"wide"}),day:ka({values:bA,defaultWidth:"wide",formattingValues:_A,defaultFormattingWidth:"wide"}),dayPeriod:ka({values:SA,defaultWidth:"wide",formattingValues:EA,defaultFormattingWidth:"wide"})},TA=/^(\d+)?/i,DA=/\d+/i,jA={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(|a)\s*er(|a)|naszej\s*ery)/i},FA={any:[/^p/i,/^n/i]},PA={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(|l)/i},AA={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},OA={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(|z)|lis|gru)/i,wide:/^(stycznia|stycze(|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(|n)|wrze(|s)nia|wrzesie(|n)|pa(|z)dziernika|pa(|z)dziernik|listopada|listopad|grudnia|grudzie(|n))/i},RA={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},zA={narrow:/^[npwcs]/i,short:/^(nie|pon|wto|(|s)ro|czw|pi(|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(|l)ek|wtorek|(|s)roda|czwartek|pi(|a)tek|sobota)/i},MA={narrow:[/^n/i,/^p/i,/^w/i,/^/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pi/i,/^so/i]},IA={narrow:/^(^a$|^p$|p(|l)n\.?|o\s*p(|l)n\.?|po(|l)\.?|w\s*po(|l)\.?|po\s*po(|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|p(|l)noc|o\s*p(|l)nocy|po(|l)udnie|w\s*po(|l)udnie|popo(|l)udnie|po\s*po(|l)udniu|rano|wieczr|wieczorem|noc|w\s*nocy)/i},LA={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i}},BA={ordinalNumber:Py({matchPattern:TA,parsePattern:DA,valueCallback:e=>parseInt(e,10)}),era:ba({matchPatterns:jA,defaultMatchWidth:"wide",parsePatterns:FA,defaultParseWidth:"any"}),quarter:ba({matchPatterns:PA,defaultMatchWidth:"wide",parsePatterns:AA,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ba({matchPatterns:OA,defaultMatchWidth:"wide",parsePatterns:RA,defaultParseWidth:"any"}),day:ba({matchPatterns:zA,defaultMatchWidth:"wide",parsePatterns:MA,defaultParseWidth:"any"}),dayPeriod:ba({matchPatterns:IA,defaultMatchWidth:"any",parsePatterns:LA,defaultParseWidth:"any"})},Oa={code:"pl",formatDistance:iA,formatLong:dA,formatRelative:gA,localize:CA,match:BA,options:{weekStartsOn:1,firstWeekContainsDate:4}};Aa("pl",Oa);const gf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],WA=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],UA=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=E.useState(null),[o,l]=E.useState(""),[c,f]=E.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[h,p]=E.useState(""),[m,g]=E.useState(null),[v,w]=E.useState(null),b=E.useRef(null),k=E.useRef(null),[N,C]=E.useState(null),[S,U]=E.useState(null),[te,Q]=E.useState("0,00"),[D,K]=E.useState("0,00"),[W,oe]=E.useState("0,00"),J=()=>{const j=c.reduce((q,H)=>{const B=parseFloat(H.ilosc.toString().replace(",","."))||0;return q+B},0),R=parseFloat(h.replace(",","."))||0;return j>0?(R/j).toFixed(2):"0,00"},Y=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},pe=j=>{if(c.length>1){const R=[...c];R.splice(j,1),f(R)}},de=j=>{const R=[...c];R[j].showDataWaznosci=!R[j].showDataWaznosci,f(R)},G=j=>{const R=j.target.files?.[0];console.log(" Product file selected:",R),R&&R.type==="application/pdf"?(g(R),console.log(" Product invoice set:",R.name)):console.log(" Invalid product file type:",R?.type)},ie=j=>{const R=j.target.files?.[0];console.log(" Transport file selected:",R),R&&R.type==="application/pdf"?(w(R),console.log(" Transport invoice set:",R.name)):console.log(" Invalid transport file type:",R?.type)},L=()=>{b.current?.click()},ne=()=>{k.current?.click()},O=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",h),console.log("productRows:",c),!r||!c.some(Pe=>Pe.kod&&Pe.nazwa&&Pe.ilosc&&Pe.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(Pe=>Pe.kod&&Pe.nazwa&&Pe.ilosc&&Pe.cena));return}const j=parseFloat(te.replace(",","."))||1,R=c.reduce((Pe,Qe)=>Pe+(parseFloat(Qe.ilosc)||0),0),q=R>0?parseFloat(h.replace(",","."))/R*j:0,H=c.filter(Pe=>Pe.kod&&Pe.nazwa&&Pe.ilosc&&Pe.cena).map(Pe=>({kod:Pe.kod,nazwa:Pe.nazwa,kod_kreskowy:Pe.kod_kreskowy||"",ilosc:parseFloat(Pe.ilosc)||0,cena:parseFloat(Pe.cena.replace(",","."))||0,dataWaznosci:Pe.dataWaznosci?Pe.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:Pe.typ||void 0,objetosc:Pe.objetosc||void 0,deliveryCostPerUnitPln:q,podatekAkcyzowyPerLiter:parseFloat(D.replace(",","."))||0}));console.log("formattedProducts:",H);const B=H.reduce((Pe,Qe)=>Pe+Qe.ilosc*Qe.cena,0),fe=parseFloat(h.replace(",","."))||0,I=parseFloat(W.replace(",","."))||0,Fe=B*(1-I/100);console.log("totalValue:",B),console.log("rabat:",I+"%"),console.log("wartoscZRabatem:",Fe),console.log("deliveryCost:",fe),console.log(" Files to submit:",{productInvoice:m,transportInvoice:v}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:Fe,kosztDostawy:fe,aktualnyKurs:te,podatekAkcyzowy:D,rabat:W,products:H,productInvoice:m||null,transportInvoice:v||null}),re()},re=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),p(""),l(""),Q("0,00"),K("0,00"),oe("0,00"),g(null),w(null),n()},M=()=>c.reduce((j,R)=>{const q=parseFloat(R.ilosc)||0,H=parseFloat(R.cena.replace(",","."))||0;return j+q*H},0).toFixed(2),F=(j,R)=>{const q=[...c];q[j].typ=R,f(q),C(null)},le=j=>{C(N===j?null:j)},A=j=>{U(S===j?null:j)},T=(j,R)=>{const q=[...c];q[j].objetosc=R,f(q),U(null)};return E.useEffect(()=>{const j=q=>{const H=q.target;if(!H.closest(".react-datepicker")&&!H.closest('button[title*="wanoci"]')){const B=[...c];let fe=!1;B.forEach(I=>{I.showDataWaznosci&&(I.showDataWaznosci=!1,fe=!0)}),fe&&f(B)}N!==null&&(H.closest(".dropdown-container")||C(null)),S!==null&&(H.closest(".dropdown-container")||U(null))},R=q=>{q.key==="Escape"&&(C(null),U(null))};return document.addEventListener("mousedown",j),document.addEventListener("keydown",R),()=>{document.removeEventListener("mousedown",j),document.removeEventListener("keydown",R)}},[N,S,c]),u.jsx(rr,{isOpen:e,onRequestClose:re,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),u.jsx("button",{onClick:re,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx(wn,{selected:r,onChange:j=>a(j),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:h,onKeyPress:j=>{const R=String.fromCharCode(j.which);(!/[\d,]/.test(R)||R===","&&j.target.value.includes(",")||j.target.value===""&&R===",")&&j.preventDefault()},onChange:j=>{const R=j.target,q=R.selectionStart??0;let H=R.value.replace(/[^\d,]/g,"");if(H===""){p("");return}if(!H.includes(","))H=H+",00";else{const[fe,I]=H.split(",");I&&I.length>2&&(H=`${fe},${I.slice(0,2)}`)}p(H),requestAnimationFrame(()=>{const fe=Math.min(q,H.length);R.setSelectionRange(fe,fe)})},className:"w-[70%] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:G,className:"hidden",ref:b}),u.jsx("button",{type:"button",onClick:L,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),m&&u.jsx("a",{href:URL.createObjectURL(m),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:m.name,children:m.name})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:ie,className:"hidden",ref:k}),u.jsx("button",{type:"button",onClick:ne,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Zf,{className:"h-4 w-4 text-gray-500"})}),v&&u.jsx("a",{href:URL.createObjectURL(v),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:v.name,children:v.name})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:o,onChange:j=>l(j.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[J().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:te,onChange:j=>Q(j.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:D,onChange:j=>K(j.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:W,onChange:j=>oe(j.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((j,R)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:j.kod,onChange:q=>{const H=[...c];H[R].kod=q.target.value,f(H)}}),R===c.length-1&&u.jsx("button",{onClick:Y,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(Hn,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:j.nazwa,onChange:q=>{const H=[...c];H[R].nazwa=q.target.value,f(H)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:j.kod_kreskowy,onChange:q=>{const H=[...c];H[R].kod_kreskowy=q.target.value,f(H)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:j.ilosc,onChange:q=>{const H=[...c],B=q.target.value;(B===""||/^\d*$/.test(B))&&(H[R].ilosc=B,f(H))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:j.cena,onKeyPress:q=>{const H=String.fromCharCode(q.which);(!/[\d,]/.test(H)||H===","&&q.target.value.includes(",")||q.target.value===""&&H===",")&&q.preventDefault()},onChange:q=>{const H=q.target,B=H.selectionStart??0;let fe=q.target.value.replace(/[^\d,]/g,"");if(fe===""){const Pe=[...c];Pe[R].cena="",f(Pe);return}if(!fe.includes(","))fe=fe+",00";else{const[Pe,Qe]=fe.split(",");Qe&&Qe.length>2&&(fe=`${Pe},${Qe.slice(0,2)}`)}const Fe=[...c];Fe[R].cena=fe,f(Fe),requestAnimationFrame(()=>{const Pe=Math.min(B,fe.length);H.setSelectionRange(Pe,Pe)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const q=parseFloat(j.ilosc)||0,H=parseFloat(j.cena.replace(",","."))||0;return(q*H).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>de(R),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${j.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:j.dataWaznosci?`Termin wanoci: ${j.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(qf,{size:16})}),u.jsx("button",{onClick:()=>pe(R),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(_t,{size:16})})]}),j.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx(wn,{selected:j.dataWaznosci,onChange:q=>{const H=[...c];H[R].dataWaznosci=q,H[R].showDataWaznosci=!1,f(H)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const q=[...c];q[R].showDataWaznosci=!1,f(q)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>le(R),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${j.typ&&gf.find(q=>q.value===j.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:j.typ&&gf.find(q=>q.value===j.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),N===R&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:q=>q.stopPropagation(),children:gf.map(q=>u.jsx("button",{type:"button",onClick:()=>F(R,q.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${q.color}`,children:q.label},q.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>A(R),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${j.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:j.objetosc||"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),S===R&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:q=>q.stopPropagation(),style:{maxWidth:"200px"},children:WA.map(q=>u.jsx("button",{type:"button",onClick:()=>T(R,q.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:q.label},q.value))})]})]})]},R))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[M().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(j=>j.kod&&j.nazwa&&j.ilosc&&j.cena)}),O()},disabled:!r||!c.some(j=>j.kod&&j.nazwa&&j.ilosc&&j.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(j=>j.kod&&j.nazwa&&j.ilosc&&j.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},$A=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilo"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilo"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsx("tr",{children:o.map((c,f)=>u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>u.jsx("tr",{children:c.map((h,p)=>u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:h},p))},f))})]})})},HA=({onSearch:e})=>{const[n,t]=E.useState(""),[r,a]=E.useState([]),[o,l]=E.useState(!1);return E.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),u.jsxs("div",{className:"w-full relative",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktw...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsxs("div",{className:"text-center py-4",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"adowanie..."})]})}):r.length>0?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:u.jsxs("table",{className:"w-full table-fixed",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),u.jsx("th",{className:"w-[70%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilo"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc})]},f))})]})}):n?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynik"})}):null]})};let YA={data:""},VA=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||YA,KA=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,GA=/\/\*[^]*?\*\/|  +/g,Sv=/\n+/g,Ns=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?Ns(l,o):o+"{"+Ns(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=Ns(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Ns.p?Ns.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},$a={},fw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+fw(e[t]);return n}return e},QA=(e,n,t,r,a)=>{let o=fw(e),l=$a[o]||($a[o]=(f=>{let h=0,p=11;for(;h<f.length;)p=101*p+f.charCodeAt(h++)>>>0;return"go"+p})(o));if(!$a[l]){let f=o!==e?e:(h=>{let p,m,g=[{}];for(;p=KA.exec(h.replace(GA,""));)p[4]?g.shift():p[3]?(m=p[3].replace(Sv," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][p[1]]=p[2].replace(Sv," ").trim();return g[0]})(e);$a[l]=Ns(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&$a.g?$a.g:null;return t&&($a.g=$a[l]),((f,h,p,m)=>{m?h.data=h.data.replace(m,f):h.data.indexOf(f)===-1&&(h.data=p?f+h.data:h.data+f)})($a[l],n,r,c),l},XA=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":Ns(c,""):c===!1?"":c}return r+a+(l??"")},"");function id(e){let n=this||{},t=e.call?e(n.p):e;return QA(t.unshift?t.raw?XA(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,VA(n.target),n.g,n.o,n.k)}let pw,Vf,Kf;id.bind({g:1});let es=id.bind({k:1});function qA(e,n,t,r){Ns.p=n,pw=e,Vf=t,Kf=r}function Is(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Vf&&Vf()},c),t.o=/ *go\d+/.test(f),c.className=id.apply(t,r)+(f?" "+f:"");let h=e;return e[0]&&(h=c.as||e,delete c.as),Kf&&h[0]&&Kf(c),pw(h,c)}return a}}var ZA=e=>typeof e=="function",Ku=(e,n)=>ZA(e)?e(n):e,JA=(()=>{let e=0;return()=>(++e).toString()})(),hw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),eO=20,xw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,eO)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return xw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},bu=[],no={toasts:[],pausedAt:void 0},Eo=e=>{no=xw(no,e),bu.forEach(n=>{n(no)})},tO={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},rO=(e={})=>{let[n,t]=E.useState(no),r=E.useRef(no);E.useEffect(()=>(r.current!==no&&t(no),bu.push(t),()=>{let o=bu.indexOf(t);o>-1&&bu.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||tO[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},nO=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||JA()}),Hl=e=>(n,t)=>{let r=nO(n,e,t);return Eo({type:2,toast:r}),r.id},on=(e,n)=>Hl("blank")(e,n);on.error=Hl("error");on.success=Hl("success");on.loading=Hl("loading");on.custom=Hl("custom");on.dismiss=e=>{Eo({type:3,toastId:e})};on.remove=e=>Eo({type:4,toastId:e});on.promise=(e,n,t)=>{let r=on.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?Ku(n.success,a):void 0;return o?on.success(o,{id:r,...t,...t?.success}):on.dismiss(r),a}).catch(a=>{let o=n.error?Ku(n.error,a):void 0;o?on.error(o,{id:r,...t,...t?.error}):on.dismiss(r)}),e};var aO=(e,n)=>{Eo({type:1,toast:{id:e,height:n}})},sO=()=>{Eo({type:5,time:Date.now()})},yl=new Map,oO=1e3,iO=(e,n=oO)=>{if(yl.has(e))return;let t=setTimeout(()=>{yl.delete(e),Eo({type:4,toastId:e})},n);yl.set(e,t)},lO=e=>{let{toasts:n,pausedAt:t}=rO(e);E.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&on.dismiss(c.id);return}return setTimeout(()=>on.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=E.useCallback(()=>{t&&Eo({type:6,time:Date.now()})},[t]),a=E.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:h}=l||{},p=n.filter(v=>(v.position||h)===(o.position||h)&&v.height),m=p.findIndex(v=>v.id===o.id),g=p.filter((v,w)=>w<m&&v.visible).length;return p.filter(v=>v.visible).slice(...c?[g+1]:[0,g]).reduce((v,w)=>v+(w.height||0)+f,0)},[n]);return E.useEffect(()=>{n.forEach(o=>{if(o.dismissed)iO(o.id,o.removeDelay);else{let l=yl.get(o.id);l&&(clearTimeout(l),yl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:aO,startPause:sO,endPause:r,calculateOffset:a}}},cO=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,uO=es`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,dO=es`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,fO=Is("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${uO} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${dO} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,pO=es`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,hO=Is("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${pO} 1s linear infinite;
`,xO=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,mO=es`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,gO=Is("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${xO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${mO} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,vO=Is("div")`
  position: absolute;
`,yO=Is("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,wO=es`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,kO=Is("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${wO} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,bO=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?E.createElement(kO,null,n):n:t==="blank"?null:E.createElement(yO,null,E.createElement(hO,{...r}),t!=="loading"&&E.createElement(vO,null,t==="error"?E.createElement(fO,{...r}):E.createElement(gO,{...r})))},_O=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,SO=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,EO="0%{opacity:0;} 100%{opacity:1;}",NO="0%{opacity:1;} 100%{opacity:0;}",CO=Is("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,TO=Is("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,DO=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=hw()?[EO,NO]:[_O(t),SO(t)];return{animation:n?`${es(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${es(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},jO=E.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?DO(e.position||n||"top-center",e.visible):{opacity:0},o=E.createElement(bO,{toast:e}),l=E.createElement(TO,{...e.ariaProps},Ku(e.message,e));return E.createElement(CO,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):E.createElement(E.Fragment,null,o,l))});qA(E.createElement);var FO=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=E.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return E.createElement("div",{ref:o,className:n,style:t},a)},PO=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},AO=id`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,xu=16,OO=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=lO(t);return E.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:xu,left:xu,right:xu,bottom:xu,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(h=>{let p=h.position||n,m=f.calculateOffset(h,{reverseOrder:e,gutter:r,defaultPosition:n}),g=PO(p,m);return E.createElement(FO,{id:h.id,key:h.id,onHeightUpdate:f.updateHeight,className:h.visible?AO:"",style:g},h.type==="custom"?Ku(h.message,h):a?a(h):E.createElement(jO,{toast:h,position:p}))}))},He=on;Aa("pl",Oa);const RO=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log(" OrderModal render - isOpen:",e);const[r,a]=E.useState(null),[o,l]=E.useState(""),[c,f]=E.useState(""),[h,p]=E.useState([]),[m,g]=E.useState(null),[v,w]=E.useState(!1),[b,k]=E.useState([]),[N,C]=E.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[S,U]=E.useState(null),[te,Q]=E.useState(!1),[D,K]=E.useState(!1),[W,oe]=E.useState(null),[J,Y]=E.useState(new Set),pe=E.useRef(null),de=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],G=()=>{const A=Math.max(...N.map(T=>T.id))+1;C([...N,{id:A,searchQuery:"",selectedProduct:null,typ:""}])},ie=A=>{N.length>1&&C(T=>T.filter(j=>j.id!==A))},L=()=>{console.log(" OrderModal handleClose called"),a(null),l(""),f(""),p([]),g(null),k([]),C([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),U(null),Q(!1),K(!1),oe(null),Y(new Set),pe.current=null,n()};E.useEffect(()=>{e&&(console.log(" OrderModal opened - clearing state"),a(null),l(""),f(""),p([]),g(null),k([]),C([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),U(null),Q(!1),K(!1),oe(null),Y(new Set),pe.current=null)},[e]),E.useEffect(()=>{const T=setTimeout(async()=>{if(c.trim().length<2){p([]);return}w(!0);try{const j=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!j.ok)throw new Error("Failed to fetch clients");const R=await j.json();p(R)}catch(j){console.error("Error searching clients:",j),p([])}finally{w(!1)}},300);return()=>clearTimeout(T)},[c]),E.useEffect(()=>{const T=setTimeout(async()=>{if(S===null||!N.find(j=>j.id===S)?.searchQuery.trim()){k([]);return}Q(!0);try{const j=N.find(fe=>fe.id===S)?.searchQuery||"",R=m?`/api/working-sheets/search?query=${encodeURIComponent(j)}&client_id=${m.id}`:`/api/working-sheets/search?query=${encodeURIComponent(j)}`,q=await fetch(R);if(!q.ok)throw new Error("Failed to fetch products");const B=(await q.json()).map(fe=>({kod:fe.kod,nazwa:fe.nazwa,ilosc:fe.ilosc.toString(),kodKreskowy:"",selectedQuantity:0,ilosc_reserved:fe.ilosc_reserved||0,ilosc_client_reserved:fe.ilosc_client_reserved||0}));k(B)}catch(j){console.error("Error searching products:",j),k([])}finally{Q(!1)}},300);return()=>clearTimeout(T)},[N,S,m]),E.useEffect(()=>{const A=j=>{const R=j.target;W!==null&&(R.closest(".dropdown-container")||oe(null))},T=j=>{j.key==="Escape"&&oe(null)};return W!==null&&(document.addEventListener("mousedown",A),document.addEventListener("keydown",T)),()=>{document.removeEventListener("mousedown",A),document.removeEventListener("keydown",T)}},[W]);const ne=(A,T)=>{console.log(" handleProductSelect called for fieldId:",A,"product:",T.kod),C(j=>j.map(q=>q.id===A?{...q,selectedProduct:T,searchQuery:`${T.kod} - ${T.nazwa.includes(" (samples)")?T.nazwa.replace(" (samples)","")+" (samples)":T.nazwa}`}:q)),k([]),U(null),console.log(" Products list cleared, activeSearchId reset")},O=A=>{oe(W===A?null:A)},re=(A,T)=>{C(j=>j.map(R=>R.id===A?{...R,typ:T}:R)),oe(null)},M=()=>N.filter(A=>A.selectedProduct).reduce((A,T)=>{const j=T.selectedProduct?.selectedQuantity||0;return A+j},0),F=()=>{if(!r||!o.trim()||!m)return!1;const A=N.filter(j=>j.selectedProduct);return!(A.length===0||A.some(j=>!j.selectedProduct?.selectedQuantity||j.selectedProduct.selectedQuantity<=0)||A.some(j=>!j.typ)||Array.from(J).some(j=>{const q=N.find(H=>H.id===j)?.selectedProduct;return q?(q.ilosc_client_reserved||0)===0:!1}))},le=async()=>{const A=N.filter(H=>H.selectedProduct).map(H=>({kod:H.selectedProduct.kod,nazwa:H.selectedProduct.nazwa,ilosc:H.selectedProduct.selectedQuantity||0,typ:H.typ}));if(!r){He.error("Wybierz dat zamwienia");return}if(!o.trim()){He.error("Wprowad numer zamwienia");return}if(!m){He.error("Wybierz klienta");return}if(A.length===0){He.error("Dodaj produkty");return}if(A.some(H=>!H.ilosc)){He.error("Wprowad ilo dla wszystkich produktw");return}if(A.some(H=>!H.typ)){He.error("Wybierz typ dla wszystkich produktw");return}Y(new Set);const T=r.getDate().toString().padStart(2,"0"),j=(r.getMonth()+1).toString().padStart(2,"0"),R=r.getFullYear(),q=`${o.trim()}_${T}_${j}_${R}`;K(!0);try{const H=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:m.nazwa,order_number:q,products:A})});if(!H.ok){const B=await H.json();if(H.status===400&&B.error.includes("Insufficient quantity")){const fe=B.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(fe){const[,I,Fe,Pe]=fe;He.error(`Niewystarczajca ilo produktu ${I}. Dostpne: ${Fe}, Zamwione: ${Pe}`)}else He.error(B.error)}else throw new Error("Failed to create order");return}He.success("Zamwienie zostao dodane"),L(),t&&t()}catch(H){console.error("Error creating order:",H),He.error("Wystpi bd podczas dodawania zamwienia")}finally{K(!1)}};return u.jsx(rr,{isOpen:e,onRequestClose:L,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamwienia"}),u.jsx("button",{onClick:L,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx(wn,{selected:r,onChange:A=>a(A),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px] ml-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsx("input",{type:"text",value:o,onChange:A=>l(A.target.value),placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:c,onChange:A=>f(A.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),v&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),h.length>0&&!m&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:h.map(A=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(A),f(A.nazwa),p([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:A.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:A.firma})]})},A.id))})]}),m&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.firma})]}),m.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.adres})]}),m.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.kontakt})]})]}),u.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(_t,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),N.map(A=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:A.searchQuery,onChange:T=>{const j=T.target.value;console.log(" Product search input changed for fieldId:",A.id,"value:",j),C(R=>R.map(q=>q.id===A.id?{...q,searchQuery:j,selectedProduct:null}:q)),U(A.id)},onFocus:()=>U(A.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:A.selectedProduct?.selectedQuantity||"",onChange:T=>{const j=T.target.value,R=j===""?0:Math.max(1,parseInt(j)||0);C(q=>{const H=q.map(fe=>fe.id===A.id&&fe.selectedProduct?{...fe,selectedProduct:{...fe.selectedProduct,selectedQuantity:R}}:fe);pe.current=null;const B=H.find(fe=>fe.id===A.id);if(B?.selectedProduct){const fe=B.selectedProduct.kod,I=parseInt(B.selectedProduct.ilosc)||0,Fe=B.selectedProduct.ilosc_reserved||0,Pe=B.selectedProduct.ilosc_client_reserved||0,Qe=H.filter(ve=>ve.selectedProduct?.kod===fe),qe=Qe.reduce((ve,Oe)=>ve+(Oe.selectedProduct?.selectedQuantity||0),0),he=Qe.length>1;let ue,we;Pe>0?(ue=Pe,we=!0):(ue=Math.max(0,I-Fe),we=!1),R===0?Y(ve=>{const Oe=new Set(ve);return Oe.delete(A.id),Oe}):qe>ue?(Y(ve=>{const Oe=new Set(ve);return Oe.add(A.id),Oe}),we?he?He.error(`Przekroczono ilo w rezerwacji towaru. cznie w zamwieniu: ${qe} szt., dostpne w rezerwacji: ${ue} szt.`):He.error(`Przekroczono ilo w rezerwacji towaru. Dostpne: ${ue} szt.`):Fe>0?he?He.error(`Niewystarczajca ilo towaru - cznie w zamwieniu: ${qe}, dostpne: ${ue} (na magazynie: ${I}, z nich w rezerwacji: ${Fe})`):He.error(`Niewystarczajca ilo towaru - dostpne: ${ue} (na magazynie: ${I}, z nich w rezerwacji: ${Fe})`):he?He.error(`Niewystarczajca ilo towaru - cznie w zamwieniu: ${qe}, dostpne: ${ue} (na magazynie: ${I})`):He.error(`Niewystarczajca ilo towaru - dostpne: ${ue} (na magazynie: ${I})`)):Y(ve=>{const Oe=new Set(ve);return Oe.delete(A.id),Oe})}else Y(fe=>{const I=new Set(fe);return I.delete(A.id),I});return H})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${J.has(A.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>O(A.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${A.typ&&de.find(T=>T.value===A.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:A.typ&&de.find(T=>T.value===A.typ)?.label||"Typ"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),W===A.id&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:T=>T.stopPropagation(),children:de.map(T=>u.jsx("button",{type:"button",onClick:()=>re(A.id,T.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${T.color}`,children:T.label},T.value))})]}),N.length>1&&u.jsx("button",{onClick:()=>ie(A.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(_t,{size:16})})]}),A.id===Math.max(...N.map(T=>T.id))&&u.jsx("button",{onClick:G,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),te&&S===A.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),b.length>0&&S===A.id&&!A.selectedProduct&&A.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:b.map((T,j)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>ne(A.id,{...T,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.kod}),T.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:T.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:T.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",T.ilosc]}),(T.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",T.ilosc_reserved??0]})]})},`${T.kod}-${T.nazwa||""}-${j}`))})]},A.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:le,disabled:D||!F(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${D||!F()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:D?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:M()})]})]})})},zO=({isOpen:e,onClose:n,order:t})=>{const[r,a]=E.useState(null),[o,l]=E.useState(null),[c,f]=E.useState(!1),h=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],p=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}];E.useEffect(()=>{e&&t&&(m(),g())},[e,t]);const m=async()=>{if(t){f(!0);try{const k=await fetch(`/api/orders/${t.id}`);if(!k.ok)throw new Error("Failed to load order details");const N=await k.json();a(N)}catch(k){console.error("Error loading order details:",k)}finally{f(!1)}}},g=async()=>{if(t)try{const k=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(k.ok){const N=await k.json();l(N)}}catch(k){console.error("Error loading client data:",k)}},v=k=>new Date(k).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const w=r||t,b=async()=>{if(!(!t||!w))try{const k=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!k.ok)throw new Error("Failed to generate PDF");const N=await k.blob(),C=window.URL.createObjectURL(N),S=document.createElement("a");S.href=C;const U=o?o.nazwa:w.klient,te=`${U}_${w.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",U),console.log("Order number:",w.numer_zamowienia),console.log("Generated filename:",te),S.download=te,document.body.appendChild(S),S.click(),window.URL.revokeObjectURL(C),document.body.removeChild(S)}catch(k){console.error("Error generating PDF:",k),alert("Bd podczas generowania PDF")}};return u.jsx(rr,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:w.typ==="odpisanie"?"Szczegy odpisania":"Szczegy zamwienia"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:w.typ==="odpisanie"?"Numer odpisania:":"Numer zamwienia:"}),u.jsx("p",{className:"text-sm font-bold text-gray-900",children:w.numer_zamowienia})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),u.jsx("p",{className:"text-gray-900",children:v(w.data_utworzenia||"")})]})]})}),o&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:w.typ==="odpisanie"?"Produkty w odpisaniu":"Produkty w zamwieniu"}),w.products&&w.products.length>0?u.jsx("div",{children:u.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:w.typ==="odpisanie"?"Powd":"Typ"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.products.map(k=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:k.kod}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:k.nazwa})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:k.kod_kreskowy||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:k.ilosc}),u.jsx("td",{className:"px-4 py-2 text-xs w-20",children:k.typ?u.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${w.typ==="odpisanie"?p.find(N=>N.value===k.typ)?.color:h.find(N=>N.value===k.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:w.typ==="odpisanie"?p.find(N=>N.value===k.typ)?.label||k.typ:h.find(N=>N.value===k.typ)?.label||k.typ}):u.jsx("span",{className:"text-gray-500",children:"-"})})]},k.id))})]})}):u.jsx("p",{className:"text-xs text-gray-500",children:w.typ==="odpisanie"?"Brak produktw w odpisaniu":"Brak produktw w zamwieniu"})]})]})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:w.laczna_ilosc})]}),u.jsx("div",{className:"absolute bottom-4 left-4",children:u.jsx("button",{onClick:b,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};Aa("pl",Oa);const vf=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],yf=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}],MO=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=E.useState(""),[l,c]=E.useState(""),[f,h]=E.useState(""),[p,m]=E.useState(null),[g,v]=E.useState([{kod:"",nazwa:"",ilosc:"",typ:""}]),[w,b]=E.useState(null),[k,N]=E.useState(""),[C,S]=E.useState([]),[U,te]=E.useState(!1),[Q,D]=E.useState(null),[K,W]=E.useState([]),[oe,J]=E.useState(!1),[Y,pe]=E.useState(null),[de,G]=E.useState(new Set),ie=async(T,j)=>{try{const R=T.map(H=>H.kod).filter(H=>H.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",R),console.log("Client ID for reservations:",j),R.length===0)return;const q=[];for(const H of R){const B=j?`/api/working-sheets/search?query=${encodeURIComponent(H)}&client_id=${j}`:`/api/working-sheets/search?query=${encodeURIComponent(H)}`,fe=await fetch(B);if(!fe.ok)continue;const Fe=(await fe.json()).find(Pe=>Pe.kod===H);Fe&&(q.push(Fe),console.log(`Found product for ${H}:`,Fe))}console.log("Found products with reservations:",q),S(q),v(H=>H.map(B=>{const fe=q.find(I=>I.kod===B.kod);return fe?{...B,availableQuantity:parseInt(fe.ilosc)||0,ilosc_reserved:fe.ilosc_reserved||0,ilosc_client_reserved:fe.ilosc_client_reserved||0,originalIlosc:parseInt(B.ilosc)||0}:B})),console.log(" Final loaded products info for order editing:",q)}catch(R){console.error(" Error loading products info:",R)}};E.useEffect(()=>{if(e&&r){if(o(r.klient),N(r.klient),r.typ==="odpisanie"){const j=r.numer_zamowienia.match(/^(OP\d+)/);j?h(j[1]):fetch("/api/writeoffs/next-number-only").then(R=>{if(!R.ok)throw new Error("Failed to fetch next number");return R.json()}).then(R=>{R.numer_odpisania?h(R.numer_odpisania):h("OP001")}).catch(R=>{console.error(" Error fetching next write-off number:",R),h("OP001")})}if(c(r.numer_zamowienia),r.data_utworzenia){const j=new Date(r.data_utworzenia);m(j),console.log(" Loaded order date:",j)}else m(null);const T=r.products&&r.products.length>0?r.products.map(j=>({kod:j.kod||"",nazwa:j.nazwa||"",ilosc:(j.ilosc||0).toString(),typ:j.typ||"",originalIlosc:j.ilosc||0})):[{kod:"",nazwa:"",ilosc:"",typ:""}];console.log("Order products from backend:",r.products),console.log("Formatted products:",T),v(T),r.klient&&r.typ!=="odpisanie"?fetch(`/api/clients/search?q=${encodeURIComponent(r.klient)}`).then(j=>j.ok?j.json():[]).then(j=>{const R=j.find(q=>q.nazwa?.toLowerCase()===r.klient.toLowerCase());R?(pe(R),console.log(" Loaded client with id:",R.id),T.length>0&&T[0].kod&&ie(T,R.id)):(pe({nazwa:r.klient}),T.length>0&&T[0].kod&&ie(T))}).catch(j=>{console.error(" Error loading client:",j),pe({nazwa:r.klient}),T.length>0&&T[0].kod&&ie(T)}):(pe({nazwa:r.klient}),T.length>0&&T[0].kod&&ie(T))}else h("")},[e,r]),E.useEffect(()=>{if(r?.typ==="odpisanie"&&f&&p){const T=String(p.getDate()).padStart(2,"0"),j=String(p.getMonth()+1).padStart(2,"0"),R=p.getFullYear(),q=`${f}_${T}_${j}_${R}`;c(q)}},[f,p,r?.typ]),E.useEffect(()=>{const j=setTimeout(async()=>{if(Q===null||!g.find((R,q)=>q===Q)?.nazwa.trim()){S([]);return}te(!0);try{const R=g.find((I,Fe)=>Fe===Q)?.nazwa||"";if(!R.trim()){S([]),te(!1);return}const q=Y?.id?`/api/working-sheets/search?query=${encodeURIComponent(R)}&client_id=${Y.id}`:`/api/working-sheets/search?query=${encodeURIComponent(R)}`,H=await fetch(q);if(!H.ok)throw new Error("Failed to fetch products");const fe=(await H.json()).map(I=>({kod:I.kod,nazwa:I.nazwa||"",ilosc:I.ilosc?I.ilosc.toString():"0",status:I.status||null,ilosc_reserved:I.ilosc_reserved||0,ilosc_client_reserved:I.ilosc_client_reserved||0}));S(fe)}catch(R){console.error("Error searching products:",R),S([])}finally{te(!1)}},300);return()=>clearTimeout(j)},[g,Q,Y]),E.useEffect(()=>{const j=setTimeout(async()=>{if(k.trim().length<2){W([]);return}J(!0);try{const R=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!R.ok)throw new Error("Failed to fetch clients");const q=await R.json();W(q)}catch(R){console.error("Error searching clients:",R),W([])}finally{J(!1)}},300);return()=>clearTimeout(j)},[k]),E.useEffect(()=>{const T=R=>{const q=R.target;w!==null&&(q.closest(".dropdown-container")||b(null))},j=R=>{R.key==="Escape"&&b(null)};return w!==null&&(document.addEventListener("mousedown",T),document.addEventListener("keydown",j)),()=>{document.removeEventListener("mousedown",T),document.removeEventListener("keydown",j)}},[w]);const L=()=>{v([...g,{kod:"",nazwa:"",ilosc:"",typ:""}])},ne=T=>{g.length>1&&v(g.filter((j,R)=>R!==T))},O=(T,j)=>{const R=[...g];R[T].typ=j,v(R),b(null)},re=T=>{b(w===T?null:T)},M=(T,j)=>{console.log(" EditOrderModal handleProductSelect called for index:",T,"product:",j.kod),console.log(" Product data:",j);const R=[...g];R[T]={...R[T],kod:j.kod,nazwa:j.nazwa,typ:j.typ||"sztuki",availableQuantity:parseInt(j.ilosc)||0,ilosc_reserved:j.ilosc_reserved||0,ilosc_client_reserved:j.ilosc_client_reserved||0,originalIlosc:0},v(R);const q=[...C],H=q.findIndex(B=>B.kod===j.kod);H>=0?q[H]=j:q.push(j),S(q),D(null),console.log(" EditOrderModal Products list cleared, activeSearchId reset")},F=async(T,j)=>{const R=new Set;for(let q=0;q<T.length;q++){const H=T[q],B=parseInt(H.ilosc)||0,fe=g.findIndex(Oe=>Oe.kod===H.kod&&Oe.nazwa===H.nazwa&&Oe.ilosc===H.ilosc);if(fe===-1){console.warn(` Could not find actual index for product ${H.kod}`);continue}const I=g[fe],Fe=j.find(Oe=>Oe.kod===H.kod),Pe=Fe?.ilosc||I.availableQuantity||0,Qe=Fe?.ilosc_reserved||I.ilosc_reserved||0,qe=Fe?.ilosc_client_reserved||I.ilosc_client_reserved||0,he=r?.products?.find(Oe=>Oe.kod===H.kod),ue=he&&he.ilosc||0,we=Pe+ue;let ve;if(qe>0){const Oe=we-Qe;ve=qe+Math.max(0,Oe)}else ve=we-Qe;console.log(`Product ${fe} (valid index ${q}):`,{kod:H.kod,requested:B,totalOnStock:Pe,originalQuantityInOrder:ue,availableForEdit:we,reservedQuantity:Qe,clientReservedQuantity:qe,maxAllowed:ve,hasError:B>ve}),B>ve&&(R.add(fe),console.log(` Error for product ${fe}: requested ${B} > maxAllowed ${ve}`),qe>0?He.error(`Produkt ${H.kod}: przekroczono ilo w rezerwacji. Dostpne: ${ve} szt.`):Qe>0?He.error(`Produkt ${H.kod}: niewystarczajca ilo - dostpne: ${ve} (na magazynie: ${we}, z nich w rezerwacji: ${Qe})`):He.error(`Produkt ${H.kod}: niewystarczajca ilo - dostpne: ${ve}`))}return R},le=async T=>{if(T.preventDefault(),!r)return;if(!a.trim()){He.error("Wprowad nazw klienta");return}if(!l.trim()){He.error(r?.typ==="odpisanie"?"Wprowad numer odpisania":"Wprowad numer zamwienia");return}const j=g.filter(H=>H.kod.trim()&&H.nazwa.trim()&&H.ilosc.trim()&&H.typ.trim());if(j.length===0){He.error(r?.typ==="odpisanie"?"Dodaj produkty do odpisania":"Dodaj produkty do zamwienia");return}if(j.some(H=>!H.ilosc||!H.typ)){He.error("Wprowad ilo i typ dla wszystkich produktw");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",j),console.log("products (stock info):",C),console.log("products.length:",C.length),C.length===0){console.log(" Products info is empty, reloading...");try{const H=await fetch("/api/working-sheets");if(H.ok){const B=await H.json();console.log("Reloaded all products:",B),S(B);const fe=await F(j,B);if(fe.size>0){G(fe);return}else G(new Set);console.log(" Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),He.error("Bd podczas adowania informacji o produktach");return}}catch(H){console.error("Error reloading products:",H),He.error("Bd podczas adowania informacji o produktach");return}}const R=await F(j,C);if(R.size>0){G(R);return}else G(new Set);const q=j.map(H=>({kod:H.kod,nazwa:H.nazwa,ilosc:parseInt(H.ilosc)||0,typ:H.typ}));console.log("Sending products data:",q);try{const H=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:q})});if(!H.ok){const B=await H.json();throw new Error(B.error||"Failed to update order")}He.success(r?.typ==="odpisanie"?"Odpisanie zostao zaktualizowane":"Zamwienie zostao zaktualizowane"),A(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:q})}catch(H){console.error("Error updating order:",H),He.error("Wystpi bd podczas aktualizacji zamwienia")}},A=()=>{o(""),N(""),pe(null),W([]),c(""),m(null),v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),b(null),S([]),D(null),n()};return r?u.jsx(rr,{isOpen:e,onRequestClose:A,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:r?.typ==="odpisanie"?"Edytuj odpisanie":"Edytuj zamwienie"}),u.jsx("button",{type:"button",onClick:A,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("form",{onSubmit:le,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex space-x-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx(wn,{selected:p,onChange:T=>m(T),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:r?.typ==="odpisanie"?"Numer odpisania":"Numer zamwienia"}),u.jsx("input",{type:"text",value:l,onChange:T=>c(T.target.value),readOnly:r?.typ==="odpisanie",placeholder:r?.typ==="odpisanie"?"Wprowad numer odpisania":"Wprowad numer zamwienia",className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${r?.typ==="odpisanie"?"bg-gray-100":""}`})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),r?.typ==="odpisanie"?u.jsx("input",{type:"text",value:"VEIS",readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100"}):u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:k,onChange:T=>N(T.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),r?.typ!=="odpisanie"&&oe&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),r?.typ!=="odpisanie"&&K.length>0&&!Y&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:K.map(T=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{pe(T),N(T.nazwa),o(T.nazwa),W([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:T.firma})]})},T.id))})]}),r?.typ!=="odpisanie"&&Y&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.nazwa})]}),Y.firma&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.firma})]}),Y.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.adres})]}),Y.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.kontakt})]})]}),u.jsx("button",{type:"button",onClick:()=>{pe(null),N(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(_t,{size:16})})]})})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),g.map((T,j)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:`relative flex-1 ${r?.typ==="odpisanie"?"max-w-[65%]":"max-w-[70%]"}`,children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:T.nazwa,onChange:R=>{const q=R.target.value;console.log(" EditOrderModal Product search input changed for index:",j,"value:",q);const H=[...g];H[j].nazwa=q,v(H),D(j)},onFocus:()=>D(j),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:T.ilosc,onChange:R=>{const q=R.target.value,H=parseInt(q)||0,B=[...g];if(B[j].ilosc=q,v(B),r?.typ!=="odpisanie"&&T.kod){const fe=T.originalIlosc||0,I=T.availableQuantity||0,Fe=T.ilosc_reserved||0,Pe=T.ilosc_client_reserved||0,Qe=I+fe;let qe,he=!1;if(Pe>0){const ue=Qe-Fe;qe=Pe+Math.max(0,ue),he=!0}else qe=Qe-Fe;H>qe?(G(ue=>{const we=new Set(ue);return we.add(j),we}),he?He.error(`Przekroczono ilo w rezerwacji. Dostpne: ${qe} szt.`):Fe>0?He.error(`Niewystarczajca ilo - dostpne: ${qe} (na magazynie: ${Qe}, z nich w rezerwacji: ${Fe})`):He.error(`Niewystarczajca ilo - dostpne: ${qe} (na magazynie: ${Qe})`)):G(ue=>{const we=new Set(ue);return we.delete(j),we})}else if(de.has(j)){const fe=new Set(de);fe.delete(j),G(fe)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${de.has(j)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:`${r?.typ==="odpisanie"?"w-32":"w-24"} ml-2 relative dropdown-container`,children:[u.jsxs("button",{type:"button",onClick:()=>re(j),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${T.typ&&(r?.typ==="odpisanie"?yf.find(R=>R.value===T.typ)?.color:vf.find(R=>R.value===T.typ)?.color)||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:T.typ&&(r?.typ==="odpisanie"?yf.find(R=>R.value===T.typ)?.label:vf.find(R=>R.value===T.typ)?.label)||(r?.typ==="odpisanie"?"Powd":"Typ")}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w===j&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:R=>R.stopPropagation(),children:(r?.typ==="odpisanie"?yf:vf).map(R=>u.jsx("button",{type:"button",onClick:()=>O(j,R.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${R.color}`,children:R.label},R.value))})]}),g.length>1&&u.jsx("button",{type:"button",onClick:()=>ne(j),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(_t,{size:16})})]}),j===g.length-1&&u.jsx("button",{type:"button",onClick:L,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),U&&Q===j&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),C.length>0&&Q===j&&T.nazwa.trim()&&u.jsx("div",{className:`absolute z-50 mt-1 ${r?.typ==="odpisanie"?"w-[65%]":"w-[70%]"} bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200`,children:C.map(R=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>M(j,R),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:R.kod}),R.nazwa&&R.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:R.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:R.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",R.ilosc]}),(R.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",R.ilosc_reserved??0]})]})},R.kod))})]},j))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:A,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:le,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null};Aa("pl",Oa);const IO=[{value:0,label:"0%"},{value:5,label:"5%"},{value:8,label:"8%"},{value:23,label:"23%"}],LO=({isOpen:e,onClose:n,orderData:t})=>{const[r,a]=E.useState(null),[o,l]=E.useState(""),[c,f]=E.useState(""),[h,p]=E.useState(""),[m,g]=E.useState([{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23}]),[v,w]=E.useState(0),[b,k]=E.useState(!1),[N,C]=E.useState(null),S=async()=>{try{const G=await fetch("/api/working-sheets");if(!G.ok){console.error(" Failed to fetch working sheets");return}const ie=await G.json(),L=new Map;ie.forEach(ne=>{if(ne.kod&&ne.cena_sprzedazy!==null&&ne.cena_sprzedazy!==void 0){const O=Number(ne.cena_sprzedazy);isNaN(O)||L.set(ne.kod,O)}}),g(ne=>ne.map(O=>{if(O.kod&&L.has(O.kod)){const re=L.get(O.kod),M=re%1===0?`${re.toFixed(0)},00`:re.toFixed(2).replace(".",",");return{...O,cena_jednostkowa:M}}return O})),console.log(" Prices loaded from working_sheets")}catch(G){console.error(" Error loading prices from working_sheets:",G)}};E.useEffect(()=>{if(e){if(a(new Date),fetch("/api/invoices/next-number-only").then(G=>{if(!G.ok)throw new Error("Failed to fetch next number");return G.json()}).then(G=>{G.numer_faktury?(l(G.numer_faktury),console.log(" Set invoice base number to:",G.numer_faktury)):l("001")}).catch(G=>{console.error(" Error fetching next invoice number:",G),l("001")}),t&&(p(t.klient),t.products&&t.products.length>0)){const G=t.products.filter(ie=>ie.typ==="sprzedaz"||ie.typ==="probka");if(G.length>0){const ie=G.map(L=>({kod:L.kod,nazwa:L.nazwa,ilosc:L.ilosc.toString(),cena_jednostkowa:"",rabat:L.typ==="probka"?"30":"",vat:23}));g(ie),w(ie.length),S()}}}else a(null),l(""),f(""),p(""),g([{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23}]),w(0)},[e,t]),E.useEffect(()=>{if(o&&r){const G=r.getMonth()+1,ie=r.getFullYear(),L=`FV ${o}/${G}/${ie}`;f(L)}else if(o&&!r){const G=new Date().getMonth()+1,ie=new Date().getFullYear(),L=`FV ${o}/${G}/${ie}`;f(L)}},[o,r]),E.useEffect(()=>{const G=L=>{const ne=L.target;N!==null&&(ne.closest(".dropdown-container")||C(null))},ie=L=>{L.key==="Escape"&&C(null)};return document.addEventListener("mousedown",G),document.addEventListener("keydown",ie),()=>{document.removeEventListener("mousedown",G),document.removeEventListener("keydown",ie)}},[N]);const U=()=>{g([...m,{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23}])},te=G=>{if(!(G<v)&&m.length>1){const ie=[...m];ie.splice(G,1),g(ie)}},Q=G=>{C(N===G?null:G)},D=(G,ie)=>{const L=[...m];L[G].vat=ie,g(L),C(null)},K=G=>{const ie=parseFloat(G.ilosc)||0,L=parseFloat(G.cena_jednostkowa.replace(",","."))||0,ne=parseFloat(G.rabat.replace(",","."))||0;return ie*L*(1-ne/100)},W=G=>K(G)*(1+G.vat/100),oe=()=>m.reduce((G,ie)=>G+K(ie),0).toFixed(2),J=()=>m.reduce((G,ie)=>{const L=K(ie),ne=W(ie);return G+(ne-L)},0).toFixed(2),Y=()=>m.reduce((G,ie)=>G+W(ie),0).toFixed(2),pe=async()=>{if(!r||!h||!m.some(G=>G.nazwa&&G.ilosc&&G.cena_jednostkowa)){He.error("Prosz wypeni wszystkie wymagane pola");return}k(!0);try{const G=m.filter(L=>L.nazwa&&L.ilosc&&L.cena_jednostkowa).map(L=>({kod:L.kod,nazwa:L.nazwa,ilosc:parseFloat(L.ilosc)||0,cena_jednostkowa:parseFloat(L.cena_jednostkowa.replace(",","."))||0,vat:L.vat})),ie={data_faktury:r.toLocaleDateString("en-CA"),numer_faktury:c,klient:h,order_id:t?.id,products:G,total:parseFloat(Y())};console.log("Creating invoice:",ie),He.success(`Faktura zostaa utworzona: ${c}`),de()}catch(G){console.error("Error creating invoice:",G),He.error("Bd podczas tworzenia faktury")}finally{k(!1)}},de=()=>{a(null),l(""),f(""),p(""),g([{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23}]),w(0),k(!1),C(null),n()};return u.jsx(rr,{isOpen:e,onRequestClose:de,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Utwrz faktur VAT"}),u.jsx("button",{onClick:de,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[120px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data faktury"}),u.jsx(wn,{selected:r,onChange:G=>a(G),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-center",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[123px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer faktury"}),u.jsx("input",{type:"text",value:c,onChange:G=>f(G.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"FV XXX/M/YYYY"})]}),u.jsxs("div",{className:"w-[250px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsx("input",{type:"text",value:h,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed",placeholder:"Nazwa klienta"})]})]})}),u.jsx("div",{className:"space-y-2",children:m.map((G,ie)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[38%]",children:[ie===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${ie<v?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,placeholder:"Nazwa produktu",value:G.nazwa,readOnly:ie<v,onChange:L=>{const ne=[...m];ne[ie].nazwa=L.target.value,g(ne)}})]}),u.jsxs("div",{className:"w-16 ml-2",children:[ie===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Ilo"}),u.jsx("input",{type:"number",className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${ie<v?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,placeholder:"0",value:G.ilosc,readOnly:ie<v,onChange:L=>{const ne=[...m],O=L.target.value;(O===""||/^\d*$/.test(O))&&(ne[ie].ilosc=O,g(ne))}})]}),u.jsxs("div",{className:"w-24 ml-2",children:[ie===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena netto"}),u.jsx("input",{type:"text",value:G.cena_jednostkowa,onKeyPress:L=>{const ne=String.fromCharCode(L.which);(!/[\d,]/.test(ne)||ne===","&&L.target.value.includes(",")||L.target.value===""&&ne===",")&&L.preventDefault()},onChange:L=>{const ne=L.target,O=ne.selectionStart??0;let re=L.target.value.replace(/[^\d,]/g,"");if(re===""){const le=[...m];le[ie].cena_jednostkowa="",g(le);return}if(!re.includes(","))re=re+",00";else{const[le,A]=re.split(",");A&&A.length>2&&(re=`${le},${A.slice(0,2)}`)}const F=[...m];F[ie].cena_jednostkowa=re,g(F),requestAnimationFrame(()=>{const le=Math.min(O,re.length);ne.setSelectionRange(le,le)})},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})]}),u.jsxs("div",{className:"w-16 ml-2",children:[ie===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat %"}),u.jsx("input",{type:"text",value:G.rabat,onKeyPress:L=>{const ne=String.fromCharCode(L.which);(!/[\d,]/.test(ne)||ne===","&&L.target.value.includes(",")||L.target.value===""&&ne===",")&&L.preventDefault()},onChange:L=>{const ne=[...m];ne[ie].rabat=L.target.value.replace(/[^\d,]/g,""),g(ne)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0"})]}),u.jsxs("div",{className:"w-20 ml-2 relative dropdown-container",children:[ie===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"VAT"}),u.jsxs("button",{type:"button",onClick:()=>Q(ie),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between bg-white",children:[u.jsxs("span",{className:"truncate",children:[G.vat,"%"]}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),N===ie&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:L=>L.stopPropagation(),children:IO.map(L=>u.jsx("button",{type:"button",onClick:()=>D(ie,L.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:L.label},L.value))})]}),u.jsxs("div",{className:"w-24 ml-2",children:[ie===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Wart. netto"}),u.jsx("input",{type:"text",value:K(G).toFixed(2).replace(".",","),readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"0,00"})]}),u.jsxs("div",{className:"w-24 ml-2",children:[ie===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Wart. brutto"}),u.jsx("input",{type:"text",value:W(G).toFixed(2).replace(".",","),readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"0,00"})]}),m.length>1&&ie>=v&&u.jsx("button",{onClick:()=>te(ie),className:`ml-2 text-red-400 hover:text-red-600 ${ie===0?"mt-[28px]":""}`,title:"Usu pozycj",children:u.jsx(_t,{size:16})})]}),ie===m.length-1&&u.jsx("button",{onClick:U,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})})]},ie))})]}),u.jsxs("div",{className:"absolute bottom-8 right-12 flex flex-col items-start gap-1",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs text-gray-700 mr-2",children:"Kwota netto:"}),u.jsxs("span",{className:"text-xs text-gray-900",children:[oe().replace(".",",")," z"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs text-gray-700 mr-2",children:"Kwota VAT:"}),u.jsxs("span",{className:"text-xs text-gray-900",children:[J().replace(".",",")," z"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs font-bold text-gray-700 mr-2",children:"Razem (PLN):"}),u.jsxs("span",{className:"text-xs font-bold text-gray-900",children:[Y().replace(".",",")," z"]})]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:pe,disabled:b||!r||!h||!m.some(G=>G.nazwa&&G.ilosc&&G.cena_jednostkowa),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors font-sora ${b||!r||!h||!m.some(G=>G.nazwa&&G.ilosc&&G.cena_jednostkowa)?"bg-gray-400 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"}`,children:b?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Tworzenie..."]}):"Utwrz faktur"})})]})})},BO=({onDeleteOrder:e,onUpdateOrder:n,refreshTrigger:t})=>{const[r,a]=E.useState([]),[o,l]=E.useState(!0),[c,f]=E.useState(null),[h,p]=E.useState(null),[m,g]=E.useState(!1),[v,w]=E.useState(!1),[b,k]=E.useState(null),[N,C]=E.useState(!1),[S,U]=E.useState(null),[te,Q]=E.useState(""),[D,K]=E.useState({}),[W,oe]=E.useState(!1),[J,Y]=E.useState(null),[pe,de]=E.useState("data_utworzenia"),[G,ie]=E.useState("desc"),[L,ne]=E.useState(""),[O,re]=E.useState(""),M=async()=>{try{console.log(" Starting to load orders..."),l(!0),f(null),console.log(" Fetching from /api/orders-with-products...");const ue=await fetch("/api/orders-with-products");if(console.log(" Response status:",ue.status),console.log(" Response ok:",ue.ok),!ue.ok)throw new Error(`HTTP error! status: ${ue.status}`);const we=await ue.json();console.log(" Raw data received:",we),console.log(" Raw data length:",we.length);const ve=we.map(Oe=>({id:Oe.id,klient:Oe.klient,numer_zamowienia:Oe.numer_zamowienia,data_utworzenia:Oe.data_utworzenia,laczna_ilosc:Oe.laczna_ilosc,typ:Oe.typ||"zamowienie",numer_zwrotu:Oe.numer_zwrotu||null,products:Oe.products||[]}));console.log(" Transformed orders:",ve),console.log(" Orders count:",ve.length),a(ve)}catch(ue){console.error(" Error loading orders:",ue),f("Failed to load orders")}finally{l(!1)}};E.useEffect(()=>{M()},[]),E.useEffect(()=>{t&&M()},[t]);const F=ue=>new Date(ue).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),le=ue=>{p(ue),g(!0)},A=ue=>{k(ue),w(!0)},T=ue=>{Y(ue),oe(!0)},j=async ue=>{if(console.log("OrdersList handleEditSubmit called with data:",ue),n)n(ue);else try{console.log("Sending PUT request to update order:",ue);const we=await fetch(`/api/orders/${ue.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(!we.ok)throw new Error(`HTTP error! status: ${we.status}`);He.success("Zamwienie zostao zaktualizowane"),M()}catch(we){console.error("Error updating order:",we),He.error("Bd podczas aktualizacji zamwienia")}},R=ue=>{U(ue),C(!0),Q("")},q=async()=>{if(te==="5202"){if(S?.id)try{e&&e(S.id);const ue=await fetch(`/api/orders/${S.id}`,{method:"DELETE"});if(!ue.ok)throw new Error(`HTTP error! status: ${ue.status}`);const we=await ue.json();console.log("Order deleted:",we),He.success("Zamwienie zostao usunite"),M()}catch(ue){console.error("Error deleting order:",ue),He.error("Bd podczas usuwania zamwienia")}H()}else He.error("Nieprawidowe haso"),Q("")},H=()=>{C(!1),U(null),Q("")},B=ue=>{ue.key==="Enter"&&q()},fe=async ue=>{try{console.log("    WMS  backend, orderId:",ue.id);const we=await fetch("/api/wms/send-shipment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:ue.id})}),ve=await we.json();if(!we.ok)throw new Error(ve.error||`HTTP ${we.status}`);return console.log("   backend:",ve),He.success(`   WMS: ${ve.wmsShipmentId||""}`),!0}catch(we){return console.error("    WMS:",we),He.error(`   WMS: ${we instanceof Error?we.message:" "}`),!1}},I=async(ue,we)=>{const ve=r.find(lt=>lt.id===ue);if(!ve)return;const Oe=D[ue]||"przygotowane";if(Oe==="przygotowane"&&we==="wysane"){const lt=He.loading("  WMS..."),ft=await fe(ve);if(He.dismiss(lt),!ft)return}K(lt=>({...lt,[ue]:we})),(Oe!=="przygotowane"||we!=="wysane")&&He.success(`Status zamwienia zmieniony na: ${we}`)},Fe=ue=>{pe===ue?ie(G==="asc"?"desc":"asc"):(de(ue),ie("asc"))},Pe=Array.from(new Set(r.map(ue=>new Date(ue.data_utworzenia).getFullYear().toString()))).sort((ue,we)=>parseInt(we)-parseInt(ue)),Qe=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],he=r.filter(ue=>!(L&&new Date(ue.data_utworzenia).getFullYear().toString()!==L||O&&(new Date(ue.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==O)).sort((ue,we)=>{let ve,Oe;switch(pe){case"numer_zamowienia":ve=(ue.numer_zamowienia||"").toLowerCase(),Oe=(we.numer_zamowienia||"").toLowerCase();break;case"klient":ve=(ue.klient||"").toLowerCase(),Oe=(we.klient||"").toLowerCase();break;case"laczna_ilosc":ve=ue.laczna_ilosc,Oe=we.laczna_ilosc;break;case"data_utworzenia":ve=new Date(ue.data_utworzenia),Oe=new Date(we.data_utworzenia);break;default:ve=ue[pe]||"",Oe=we[pe]||""}return typeof ve=="string"&&typeof Oe=="string"?G==="asc"?ve.localeCompare(Oe):Oe.localeCompare(ve):typeof ve=="number"&&typeof Oe=="number"?G==="asc"?ve-Oe:Oe-ve:ve instanceof Date&&Oe instanceof Date?G==="asc"?ve.getTime()-Oe.getTime():Oe.getTime()-ve.getTime():0});return o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie zamwie..."})}):c?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",c]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Fe("numer_zamowienia"),children:"Numer zamwienia"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Fe("klient"),children:"Klient"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Fe("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Fe("laczna_ilosc"),children:"czna ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Fe("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:L,onChange:ue=>ne(ue.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),Pe.map(ue=>u.jsx("option",{value:ue,style:{fontFamily:"Sora, sans-serif"},children:ue},ue))]}),u.jsxs("select",{value:O,onChange:ue=>re(ue.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[u.jsx("option",{value:"",children:"Msc"}),Qe.map(ue=>u.jsx("option",{value:ue.value,style:{fontFamily:"Sora, sans-serif"},children:ue.value},ue.value))]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamwie"})}):he.map(ue=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ue.numer_zamowienia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ue.klient}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ue.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":ue.typ==="odpisanie"?"bg-green-100 text-green-800 border border-green-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:ue.typ==="zwrot"?"Zwrot":ue.typ==="odpisanie"?"Odpisanie":"Zamwienie"})}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ue.laczna_ilosc}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:F(ue.data_utworzenia)}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:we=>{we.preventDefault(),we.stopPropagation(),le(ue)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(Jf,{size:16})}),u.jsx("button",{type:"button",onClick:we=>{we.preventDefault(),we.stopPropagation(),T(ue)},className:"text-purple-600 hover:text-purple-800 focus:outline-none font-semibold text-sm",title:"Utwrz faktur",children:"FV"}),u.jsx("button",{type:"button",onClick:we=>{we.preventDefault(),we.stopPropagation(),A(ue)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:we=>{we.preventDefault(),we.stopPropagation(),R(ue)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(_t,{size:16})})]}),u.jsxs("select",{value:D[ue.id]||"przygotowane",onChange:we=>{we.preventDefault(),we.stopPropagation(),I(ue.id,we.target.value)},onClick:we=>we.stopPropagation(),className:"px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"przygotowane",children:"Przygotowane"}),u.jsx("option",{value:"wysane",children:"Wysane"})]})]})})]},ue.id))})]})}),u.jsx(rr,{isOpen:N,onRequestClose:H,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:H,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:te,onChange:ue=>Q(ue.target.value),onKeyPress:B,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:H,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:q,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(zO,{isOpen:m,onClose:()=>g(!1),order:h}),u.jsx(MO,{isOpen:v,onClose:()=>{w(!1),k(null)},onSubmit:ue=>{j(ue),w(!1),k(null)},order:b}),u.jsx(LO,{isOpen:W,onClose:()=>{oe(!1),Y(null)},orderData:J})]})},WO=({isOpen:e,onClose:n,reservation:t})=>{const[r,a]=Te.useState({x:0,y:0}),[o,l]=Te.useState(!1),c=Te.useRef({x:0,y:0});Te.useEffect(()=>{const p=g=>{o&&a({x:g.clientX-c.current.x,y:g.clientY-c.current.y})},m=()=>l(!1);return o&&(window.addEventListener("mousemove",p),window.addEventListener("mouseup",m)),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m)}},[o]);const f=p=>{p.target.closest("button")||p.target.closest("input")||(l(!0),c.current={x:p.clientX-r.x,y:p.clientY-r.y})};if(!t)return null;const h=p=>new Date(p).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"});return u.jsx(rr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${r.x}px), calc(-50% + ${r.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:f,style:{cursor:o?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy rezerwacji"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Numer rezerwacji"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.numer_rezerwacji})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data utworzenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_utworzenia)})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Klient"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.klient})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakoczenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_zakonczenia)})]})]}),t.komentarz&&u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Komentarz"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.komentarz})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[220px]",children:"Nazwa"}),(t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa")&&u.jsx("th",{className:"py-2 text-left w-[85px]"}),u.jsx("th",{className:"px-2 py-2 text-center w-[70px]",children:"Pozostao"}),u.jsx("th",{className:"px-2 py-2 text-center w-[60px]",children:"Wydane"}),u.jsx("th",{className:"px-2 py-2 text-center w-[90px]",children:"Zarezerwowane"})]})}),u.jsx("tbody",{children:t.products&&t.products.length>0?t.products.map(p=>{const m=p.ilosc_wydane??0,g=p.ilosc-m,v=t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa";return u.jsxs("tr",{className:v?"opacity-50":"",children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:p.product_kod}),u.jsx("td",{className:"px-2 py-2 w-[220px] break-words leading-tight",children:p.product_nazwa}),t.status==="anulowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-red-600 font-medium",children:"anulowana"})}),t.status==="zrealizowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-blue-600 font-medium",children:"zrealizowana"})}),t.status==="wygasa"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-gray-600 font-medium",children:"wygasa"})}),u.jsx("td",{className:"px-2 py-2 w-[70px] text-center",children:u.jsx("span",{className:g>0&&!v?"text-green-600 font-medium":"text-gray-400",children:g})}),u.jsx("td",{className:`px-2 py-2 w-[60px] text-center ${v?"text-gray-400":"text-red-600"}`,children:m}),u.jsx("td",{className:"px-2 py-2 w-[90px] text-center",children:p.ilosc})]},p.id)}):u.jsx("tr",{children:u.jsx("td",{colSpan:t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa"?6:5,className:"px-2 py-4 text-center text-gray-500",children:"Brak produktw"})})})]})]})]})]})})};Aa("pl",Oa);const UO=({isOpen:e,onClose:n,onSubmit:t,reservation:r})=>{const[a,o]=E.useState(""),[l,c]=E.useState(""),[f,h]=E.useState(null),[p,m]=E.useState(null),[g,v]=E.useState("aktywna"),[w,b]=E.useState(""),[k,N]=E.useState([{kod:"",nazwa:"",ilosc:""}]),[C,S]=E.useState([]),[U,te]=E.useState([]),[Q,D]=E.useState(!1),[K,W]=E.useState(null),[oe,J]=E.useState([]),[Y,pe]=E.useState(!1),[de,G]=E.useState(null),[ie,L]=E.useState(""),[ne,O]=E.useState(new Set),[re,M]=E.useState(!1),F=E.useRef(null);E.useEffect(()=>{e&&(async()=>{try{const B=await fetch("/api/working-sheets/search?query=");if(B.ok){const fe=await B.json();te(fe)}}catch(B){console.error("Error loading stock info:",B)}})()},[e]),E.useEffect(()=>{if(e&&r)if(o(r.klient),L(r.klient),G({nazwa:r.klient,firma:r.firma}),c(r.numer_rezerwacji),v(r.status),b(r.komentarz||""),O(new Set),F.current=null,r.data_utworzenia&&h(new Date(r.data_utworzenia)),r.data_zakonczenia&&m(new Date(r.data_zakonczenia)),r.products&&r.products.length>0){const H=r.products.map(fe=>({kod:fe.product_kod||"",nazwa:fe.product_nazwa||"",ilosc:(fe.ilosc||0).toString(),originalIlosc:fe.ilosc||0,iloscWydane:fe.ilosc_wydane||0}));N(H);const B=r.products.some(fe=>(fe.ilosc_wydane||0)>0);M(B)}else N([{kod:"",nazwa:"",ilosc:""}]),M(!1)},[e,r]),E.useEffect(()=>{const B=setTimeout(async()=>{if(K===null||!k.find((fe,I)=>I===K)?.nazwa.trim()){S([]);return}D(!0);try{const fe=k.find((Pe,Qe)=>Qe===K)?.nazwa||"";if(!fe.trim()){S([]),D(!1);return}const I=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(fe)}`);if(!I.ok)throw new Error("Failed to fetch products");const Fe=await I.json();S(Fe)}catch(fe){console.error("Error searching products:",fe),S([])}finally{D(!1)}},300);return()=>clearTimeout(B)},[k,K]),E.useEffect(()=>{const B=setTimeout(async()=>{if(ie.trim().length<2){J([]);return}pe(!0);try{const fe=await fetch(`/api/clients/search?q=${encodeURIComponent(ie)}`);if(!fe.ok)throw new Error("Failed to fetch clients");const I=await fe.json();J(I)}catch(fe){console.error("Error searching clients:",fe),J([])}finally{pe(!1)}},300);return()=>clearTimeout(B)},[ie]);const le=()=>{N([...k,{kod:"",nazwa:"",ilosc:""}])},A=(H,B)=>{const fe=[...k];fe[H]={...fe[H],kod:B.kod,nazwa:B.nazwa},N(fe),W(null),U.findIndex(Fe=>Fe.kod===B.kod)<0&&te([...U,B])},T=(H,B)=>{const fe=[...k];fe[H].ilosc=B,N(fe);const I=fe[H],Fe=parseInt(B)||0,Pe=I.originalIlosc||0,Qe=I.iloscWydane||0;if(F.current=null,!B.trim()||Fe===0){O(Oe=>{const lt=new Set(Oe);return lt.delete(H),lt});return}const qe=U.find(Oe=>Oe.kod===I.kod),he=qe?.ilosc||0,ue=qe?.ilosc_reserved||0,we=he-ue+Pe;let ve=null;Fe<Qe?ve=`Nie mona zmniejszy poniej wydanej iloci (${Qe} szt.)`:I.kod&&Fe>we&&(ve=`Niewystarczajca ilo - dostpne do rezerwacji: ${Math.max(0,we-Pe)} szt.`),O(Oe=>{const lt=new Set(Oe);return ve?lt.add(H):lt.delete(H),lt}),ve&&He.error(ve)},j=()=>{if(!de||!a.trim()||!p||ne.size>0||k.filter(B=>B.kod.trim()&&B.nazwa.trim()&&B.ilosc.trim()).length===0)return!1;for(let B=0;B<k.length;B++){const fe=k[B];if(!fe.kod.trim()||!fe.nazwa.trim()||!fe.ilosc.trim())continue;const I=parseInt(fe.ilosc)||0,Fe=fe.iloscWydane||0,Pe=fe.originalIlosc||0;if(I<Fe)return!1;if(I>Pe&&fe.kod){const Qe=U.find(we=>we.kod===fe.kod),qe=Qe?.ilosc||0,he=Qe?.ilosc_reserved||0,ue=qe-he+Pe;if(I>ue)return!1}}return!0},R=async H=>{if(H.preventDefault(),!r)return;if(!de||!a.trim()){He.error("Wybierz klienta");return}if(!l.trim()){He.error("Wprowad numer rezerwacji");return}if(!p){He.error("Wybierz dat zakoczenia");return}const B=k.filter(I=>I.kod.trim()&&I.nazwa.trim()&&I.ilosc.trim());if(B.length===0){He.error("Dodaj produkty do rezerwacji");return}if(!j()){He.error("Popraw bdy w formularzu");return}const fe=B.map(I=>({kod:I.kod,nazwa:I.nazwa,ilosc:parseInt(I.ilosc)||0,originalIlosc:I.originalIlosc||0,iloscWydane:I.iloscWydane||0}));try{const I=await fetch(`/api/reservations/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_rezerwacji:l.trim(),data_utworzenia:f?f.toISOString().split("T")[0]:null,data_zakonczenia:p.toISOString().split("T")[0],status:g,komentarz:w.trim()||null,products:fe})});if(!I.ok){const Fe=await I.json();throw new Error(Fe.error||"Failed to update reservation")}He.success("Rezerwacja zostaa zaktualizowana"),q(),t()}catch(I){console.error("Error updating reservation:",I),He.error(I.message||"Wystpi bd podczas aktualizacji rezerwacji")}},q=()=>{o(""),L(""),G(null),J([]),c(""),h(null),m(null),v("aktywna"),b(""),N([{kod:"",nazwa:"",ilosc:""}]),S([]),te([]),W(null),O(new Set),M(!1),F.current=null,n()};return r?u.jsx(rr,{isOpen:e,onRequestClose:q,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj rezerwacj"}),u.jsx("button",{type:"button",onClick:q,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("form",{onSubmit:R,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx(wn,{selected:f,onChange:()=>{},locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholderText:"Wybierz dat",popperClassName:"z-50",disabled:!0})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:l,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx(wn,{selected:p,onChange:H=>m(H),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:f||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:ie,onChange:H=>{re||(L(H.target.value),de&&(G(null),o("")))},placeholder:"Wyszukaj klienta...",disabled:re,title:re?"Nie mona zmieni klienta - cz towaru zostaa ju wydana":"",className:`w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${re?"bg-gray-50 cursor-not-allowed":""}`}),Y&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),oe.length>0&&!de&&!re&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:oe.map(H=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{G(H),L(H.nazwa),o(H.nazwa),J([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:H.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:H.firma})]})},H.id))}),de&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:de.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:de.firma})]}),!re&&u.jsx("button",{type:"button",onClick:()=>{G(null),L(""),o("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(_t,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:w,onChange:H=>b(H.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),k.map((H,B)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:H.nazwa,onChange:fe=>{const I=[...k];I[B].nazwa=fe.target.value,I[B].kod="",N(I),W(B)},onFocus:()=>W(B),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",disabled:(H.iloscWydane??0)>0})]}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:H.iloscWydane||1,placeholder:"Ilo",value:H.ilosc,onChange:fe=>T(B,fe.target.value),className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${ne.has(B)?"border-red-500 bg-red-50":"border-gray-300"}`})})]}),B===k.length-1&&u.jsx("button",{type:"button",onClick:le,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),Q&&K===B&&u.jsx("div",{className:"absolute right-24 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),C.length>0&&K===B&&H.nazwa.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[calc(100%-6rem)] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:C.map(fe=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>A(B,fe),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:fe.kod}),fe.nazwa&&fe.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:fe.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:fe.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",fe.ilosc]}),(fe.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",fe.ilosc_reserved??0]})]})},fe.kod))})]},B))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:q,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:R,disabled:!j(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora ${j()?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:"Zapisz zmiany"})]})]})}):null},$O=({refreshTrigger:e})=>{const[n,t]=E.useState([]),[r,a]=E.useState(!0),[o,l]=E.useState(null),[c,f]=E.useState(null),[h,p]=E.useState(!1),[m,g]=E.useState(!1),[v,w]=E.useState(null),[b,k]=E.useState(!1),[N,C]=E.useState(null),[S,U]=E.useState("data_utworzenia"),[te,Q]=E.useState("desc"),[D,K]=E.useState(""),[W,oe]=E.useState(""),[J,Y]=E.useState(""),[pe,de]=E.useState(""),G=async()=>{try{console.log(" Starting to load reservations..."),a(!0),l(null),console.log(" Fetching from /api/reservations-with-products...");const B=await fetch("/api/reservations-with-products");if(console.log(" Response status:",B.status),!B.ok)throw new Error(`HTTP error! status: ${B.status}`);const fe=await B.json();console.log(" Raw data received:",fe),console.log(" Raw data length:",fe.length);const I=fe.map(Fe=>({id:Fe.id,numer_rezerwacji:Fe.numer_rezerwacji,klient:Fe.klient||"",firma:Fe.firma||"",data_utworzenia:Fe.data_utworzenia,data_zakonczenia:Fe.data_zakonczenia,status:Fe.status||"aktywna",komentarz:Fe.komentarz||null,laczna_ilosc:Fe.laczna_ilosc||0,products:Fe.products||[]}));console.log(" Transformed reservations:",I),console.log(" Reservations count:",I.length),t(I)}catch(B){console.error(" Error loading reservations:",B),l("Failed to load reservations")}finally{a(!1)}};E.useEffect(()=>{G()},[]),E.useEffect(()=>{e&&G()},[e]);const ie=B=>new Date(B).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"}),L=B=>{f(B),p(!0)},ne=B=>{w(B),g(!0)},O=B=>{C(B),k(!0)},re=async()=>{if(N)try{const B=await fetch(`/api/reservations/${N.id}/cancel`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!B.ok){const fe=await B.json();throw new Error(fe.error||"Failed to cancel reservation")}He.success("Rezerwacja zostaa anulowana"),k(!1),C(null),G()}catch(B){console.error("Error cancelling reservation:",B),He.error(B.message||"Wystpi bd podczas anulowania rezerwacji")}},M=B=>{S===B?Q(te==="asc"?"desc":"asc"):(U(B),Q("asc"))},F=Array.from(new Set(n.map(B=>new Date(B.data_utworzenia).getFullYear().toString()))).sort((B,fe)=>parseInt(fe)-parseInt(B)),le=Array.from(new Set(n.map(B=>B.klient).filter(Boolean))).sort(),A=Array.from(new Set(n.map(B=>B.status).filter(Boolean))).sort(),T=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],j=new Set(n.map(B=>(new Date(B.data_utworzenia).getMonth()+1).toString().padStart(2,"0"))),R=T.filter(B=>j.has(B.value)),H=n.filter(B=>!(D&&new Date(B.data_utworzenia).getFullYear().toString()!==D||W&&(new Date(B.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==W||J&&B.klient!==J||pe&&B.status!==pe)).sort((B,fe)=>{let I,Fe;switch(S){case"numer_rezerwacji":I=(B.numer_rezerwacji||"").toLowerCase(),Fe=(fe.numer_rezerwacji||"").toLowerCase();break;case"klient":I=(B.klient||"").toLowerCase(),Fe=(fe.klient||"").toLowerCase();break;case"status":I=(B.status||"").toLowerCase(),Fe=(fe.status||"").toLowerCase();break;case"laczna_ilosc":I=B.laczna_ilosc,Fe=fe.laczna_ilosc;break;case"data_utworzenia":I=new Date(B.data_utworzenia),Fe=new Date(fe.data_utworzenia);break;case"data_zakonczenia":I=new Date(B.data_zakonczenia),Fe=new Date(fe.data_zakonczenia);break;default:I=B[S]||"",Fe=fe[S]||""}return typeof I=="string"&&typeof Fe=="string"?te==="asc"?I.localeCompare(Fe):Fe.localeCompare(I):typeof I=="number"&&typeof Fe=="number"?te==="asc"?I-Fe:Fe-I:I instanceof Date&&Fe instanceof Date?te==="asc"?I.getTime()-Fe.getTime():Fe.getTime()-I.getTime():0});return r?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie rezerwacji..."})}):o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",o]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-end",children:u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1",children:[u.jsxs("select",{value:J,onChange:B=>Y(B.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Klient"}),le.map(B=>u.jsx("option",{value:B,children:B},B))]}),u.jsxs("select",{value:pe,onChange:B=>de(B.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Status"}),A.map(B=>u.jsx("option",{value:B,children:B},B))]}),u.jsxs("select",{value:D,onChange:B=>K(B.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Rok"}),F.map(B=>u.jsx("option",{value:B,children:B},B))]}),u.jsxs("select",{value:W,onChange:B=>oe(B.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Miesic"}),R.map(B=>u.jsx("option",{value:B.value,children:B.label},B.value))]})]}),(J||pe||D||W)&&u.jsx("button",{onClick:()=>{Y(""),de(""),K(""),oe("")},className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})}),u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("numer_rezerwacji"),children:"Numer rezerwacji"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("klient"),children:"Klient"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("data_zakonczenia"),children:"Data zakoczenia"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("status"),children:"Status"}),u.jsx("th",{className:"px-8 py-4 border-b border-gray-200 bg-gray-50"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak rezerwacji"})}):H.map(B=>u.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>L(B),children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:B.numer_rezerwacji}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:B.klient}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:ie(B.data_utworzenia)}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:ie(B.data_zakonczenia)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-left",children:u.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded ${B.status==="aktywna"?"bg-green-100 text-green-800":B.status==="anulowana"?"bg-red-100 text-red-800":B.status==="zrealizowana"?"bg-blue-100 text-blue-800":B.status==="wygasa"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:B.status})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-sora",children:u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),B.status==="aktywna"&&ne(B)},className:"text-green-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:text-green-600 hover:text-green-800",title:B.status==="aktywna"?"Edytuj":void 0,disabled:B.status!=="aktywna",children:u.jsx(Pl,{size:16})}),B.status==="aktywna"&&u.jsx("button",{type:"button",onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),O(B)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Anuluj rezerwacj",children:u.jsx(kb,{size:16})})]})})]},B.id))})]})}),u.jsx(WO,{isOpen:h,onClose:()=>p(!1),reservation:c}),u.jsx(UO,{isOpen:m,onClose:()=>{g(!1),w(null)},onSubmit:()=>{g(!1),w(null),G()},reservation:v}),u.jsx(rr,{isOpen:b,onRequestClose:()=>{k(!1),C(null)},style:{content:{width:"320px",height:"170px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800"}),u.jsx("button",{onClick:()=>{k(!1),C(null)},className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-4 text-center",children:"Czy na pewno chcesz anulowa rezerwacj?"}),u.jsxs("div",{className:"flex justify-center gap-3 mt-auto",children:[u.jsx("button",{type:"button",onClick:()=>{k(!1),C(null)},className:"px-3 py-1.5 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200 font-sora",children:"Nie"}),u.jsx("button",{type:"button",onClick:re,className:"px-3 py-1.5 text-xs text-white bg-blue-500 rounded hover:bg-blue-600 font-sora",children:"Tak"})]})]})})]})};var wf={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Ev;function HO(){return Ev||(Ev=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(wf)),wf.exports}var YO=HO();const Gf=Gu(YO);var Nv={};const VO="react-tooltip-core-styles",KO="react-tooltip-base-styles",Cv={core:!1,base:!1};function Tv({css:e,id:n=KO,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Cv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Nv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Nv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=VO),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Cv[t]=!0}const Dv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[tw(Number(a)),rw({fallbackAxisSideDirection:"start"}),VF({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const h=l;return t?(h.push($f({element:t,padding:5})),Hf(e,n,{placement:r,strategy:o,middleware:h}).then((({x:p,y:m,placement:g,middlewareData:v})=>{var w,b;const k={left:`${p}px`,top:`${m}px`,border:c},{x:N,y:C}=(w=v.arrow)!==null&&w!==void 0?w:{x:0,y:0},S=(b={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&b!==void 0?b:"bottom",U=c&&{borderBottom:c,borderRight:c};let te=0;if(c){const Q=`${c}`.match(/(\d+)px/);te=Q?.[1]?Number(Q[1]):1}return{tooltipStyles:k,tooltipArrowStyles:{left:N!=null?`${N}px`:"",top:C!=null?`${C}px`:"",right:"",bottom:"",...U,[S]:`-${f/2+te}px`},place:g}}))):Hf(e,n,{placement:"bottom",strategy:o,middleware:h}).then((({x:p,y:m,placement:g})=>({tooltipStyles:{left:`${p}px`,top:`${m}px`},tooltipArrowStyles:{},place:g})))},jv=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),Fv=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Pv=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Qf=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Qf(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Pv(e)||!Pv(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Qf(e[a],n[a])))},GO=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Av=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(GO(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},QO=typeof window<"u"?E.useLayoutEffect:E.useEffect,In=e=>{e.current&&(clearTimeout(e.current),e.current=null)},XO="DEFAULT_TOOLTIP_ID",qO={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},ZO=E.createContext({getTooltipData:()=>qO});function mw(e=XO){return E.useContext(ZO).getTooltipData(e)}var qo={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},kf={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const JO=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:h=["hover"],openOnClick:p=!1,positionStrategy:m="absolute",middlewares:g,wrapper:v,delayShow:w=0,delayHide:b=0,float:k=!1,hidden:N=!1,noArrow:C=!1,clickable:S=!1,closeOnEsc:U=!1,closeOnScroll:te=!1,closeOnResize:Q=!1,openEvents:D,closeEvents:K,globalCloseEvents:W,imperativeModeOnly:oe,style:J,position:Y,afterShow:pe,afterHide:de,disableTooltip:G,content:ie,contentWrapperRef:L,isOpen:ne,defaultIsOpen:O=!1,setIsOpen:re,activeAnchor:M,setActiveAnchor:F,border:le,opacity:A,arrowColor:T,arrowSize:j=8,role:R="tooltip"})=>{var q;const H=E.useRef(null),B=E.useRef(null),fe=E.useRef(null),I=E.useRef(null),Fe=E.useRef(null),[Pe,Qe]=E.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[qe,he]=E.useState(!1),[ue,we]=E.useState(!1),[ve,Oe]=E.useState(null),lt=E.useRef(!1),ft=E.useRef(null),{anchorRefs:gt,setActiveAnchor:Rt}=mw(n),Gt=E.useRef(!1),[cr,Lt]=E.useState([]),Qt=E.useRef(!1),dt=p||h.includes("click"),Et=dt||D?.click||D?.dblclick||D?.mousedown,Xt=D?{...D}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!D&&dt&&Object.assign(Xt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const Ct=K?{...K}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!K&&dt&&Object.assign(Ct,{mouseleave:!1,blur:!1,mouseout:!1});const $t=W?{...W}:{escape:U||!1,scroll:te||!1,resize:Q||!1,clickOutsideAnchor:Et||!1};oe&&(Object.assign(Xt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(Ct,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign($t,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),QO((()=>(Qt.current=!0,()=>{Qt.current=!1})),[]);const Bt=Ke=>{Qt.current&&(Ke&&we(!0),setTimeout((()=>{Qt.current&&(re?.(Ke),ne===void 0&&he(Ke))}),10))};E.useEffect((()=>{if(ne===void 0)return()=>null;ne&&we(!0);const Ke=setTimeout((()=>{he(ne)}),10);return()=>{clearTimeout(Ke)}}),[ne]),E.useEffect((()=>{if(qe!==lt.current)if(In(Fe),lt.current=qe,qe)pe?.();else{const Ke=(Je=>{const Me=Je.match(/^([\d.]+)(ms|s)$/);if(!Me)return 0;const[,tt,wt]=Me;return Number(tt)*(wt==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));Fe.current=setTimeout((()=>{we(!1),Oe(null),de?.()}),Ke+25)}}),[qe]);const Jr=Ke=>{Qe((Je=>Qf(Je,Ke)?Je:Ke))},en=(Ke=w)=>{In(fe),ue?Bt(!0):fe.current=setTimeout((()=>{Bt(!0)}),Ke)},me=(Ke=b)=>{In(I),I.current=setTimeout((()=>{Gt.current||Bt(!1)}),Ke)},Ae=Ke=>{var Je;if(!Ke)return;const Me=(Je=Ke.currentTarget)!==null&&Je!==void 0?Je:Ke.target;if(!Me?.isConnected)return F(null),void Rt({current:null});w?en():Bt(!0),F(Me),Rt({current:Me}),In(I)},ze=()=>{S?me(b||100):b?me():Bt(!1),In(fe)},Ze=({x:Ke,y:Je})=>{var Me;const tt={getBoundingClientRect:()=>({x:Ke,y:Je,width:0,height:0,top:Je,left:Ke,right:Ke,bottom:Je})};Dv({place:(Me=ve?.place)!==null&&Me!==void 0?Me:c,offset:f,elementReference:tt,tooltipReference:H.current,tooltipArrowReference:B.current,strategy:m,middlewares:g,border:le,arrowSize:j}).then((wt=>{Jr(wt)}))},rt=Ke=>{if(!Ke)return;const Je=Ke,Me={x:Je.clientX,y:Je.clientY};Ze(Me),ft.current=Me},se=Ke=>{var Je;if(!qe)return;const Me=Ke.target;Me.isConnected&&(!((Je=H.current)===null||Je===void 0)&&Je.contains(Me)||[document.querySelector(`[id='${o}']`),...cr].some((tt=>tt?.contains(Me)))||(Bt(!1),In(fe)))},ye=Fv(Ae,50),De=Fv(ze,50),Re=Ke=>{De.cancel(),ye(Ke)},$e=()=>{ye.cancel(),De()},et=E.useCallback((()=>{var Ke,Je;const Me=(Ke=ve?.position)!==null&&Ke!==void 0?Ke:Y;Me?Ze(Me):k?ft.current&&Ze(ft.current):M?.isConnected&&Dv({place:(Je=ve?.place)!==null&&Je!==void 0?Je:c,offset:f,elementReference:M,tooltipReference:H.current,tooltipArrowReference:B.current,strategy:m,middlewares:g,border:le,arrowSize:j}).then((tt=>{Qt.current&&Jr(tt)}))}),[qe,M,ie,J,c,ve?.place,f,m,Y,ve?.position,k,j]);E.useEffect((()=>{var Ke,Je;const Me=new Set(gt);cr.forEach((We=>{G?.(We)||Me.add({current:We})}));const tt=document.querySelector(`[id='${o}']`);tt&&!G?.(tt)&&Me.add({current:tt});const wt=()=>{Bt(!1)},P=Av(M),ee=Av(H.current);$t.scroll&&(window.addEventListener("scroll",wt),P?.addEventListener("scroll",wt),ee?.addEventListener("scroll",wt));let V=null;$t.resize?window.addEventListener("resize",wt):M&&H.current&&(V=ew(M,H.current,et,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const X=We=>{We.key==="Escape"&&Bt(!1)};$t.escape&&window.addEventListener("keydown",X),$t.clickOutsideAnchor&&window.addEventListener("click",se);const Z=[],ae=We=>!!(We?.target&&M?.contains(We.target)),_e=We=>{qe&&ae(We)||Ae(We)},je=We=>{qe&&ae(We)&&ze()},be=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],Ee=["click","dblclick","mousedown","mouseup"];Object.entries(Xt).forEach((([We,Ue])=>{Ue&&(be.includes(We)?Z.push({event:We,listener:Re}):Ee.includes(We)&&Z.push({event:We,listener:_e}))})),Object.entries(Ct).forEach((([We,Ue])=>{Ue&&(be.includes(We)?Z.push({event:We,listener:$e}):Ee.includes(We)&&Z.push({event:We,listener:je}))})),k&&Z.push({event:"pointermove",listener:rt});const Ne=()=>{Gt.current=!0},Be=()=>{Gt.current=!1,ze()},Xe=S&&(Ct.mouseout||Ct.mouseleave);return Xe&&((Ke=H.current)===null||Ke===void 0||Ke.addEventListener("mouseover",Ne),(Je=H.current)===null||Je===void 0||Je.addEventListener("mouseout",Be)),Z.forEach((({event:We,listener:Ue})=>{Me.forEach((Ye=>{var xt;(xt=Ye.current)===null||xt===void 0||xt.addEventListener(We,Ue)}))})),()=>{var We,Ue;$t.scroll&&(window.removeEventListener("scroll",wt),P?.removeEventListener("scroll",wt),ee?.removeEventListener("scroll",wt)),$t.resize?window.removeEventListener("resize",wt):V?.(),$t.clickOutsideAnchor&&window.removeEventListener("click",se),$t.escape&&window.removeEventListener("keydown",X),Xe&&((We=H.current)===null||We===void 0||We.removeEventListener("mouseover",Ne),(Ue=H.current)===null||Ue===void 0||Ue.removeEventListener("mouseout",Be)),Z.forEach((({event:Ye,listener:xt})=>{Me.forEach((Ht=>{var Wt;(Wt=Ht.current)===null||Wt===void 0||Wt.removeEventListener(Ye,xt)}))}))}}),[M,et,ue,gt,cr,D,K,W,dt,w,b]),E.useEffect((()=>{var Ke,Je;let Me=(Je=(Ke=ve?.anchorSelect)!==null&&Ke!==void 0?Ke:l)!==null&&Je!==void 0?Je:"";!Me&&n&&(Me=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const tt=new MutationObserver((wt=>{const P=[],ee=[];wt.forEach((V=>{if(V.type==="attributes"&&V.attributeName==="data-tooltip-id"&&(V.target.getAttribute("data-tooltip-id")===n?P.push(V.target):V.oldValue===n&&ee.push(V.target)),V.type==="childList"){if(M){const X=[...V.removedNodes].filter((Z=>Z.nodeType===1));if(Me)try{ee.push(...X.filter((Z=>Z.matches(Me)))),ee.push(...X.flatMap((Z=>[...Z.querySelectorAll(Me)])))}catch{}X.some((Z=>{var ae;return!!(!((ae=Z?.contains)===null||ae===void 0)&&ae.call(Z,M))&&(we(!1),Bt(!1),F(null),In(fe),In(I),!0)}))}if(Me)try{const X=[...V.addedNodes].filter((Z=>Z.nodeType===1));P.push(...X.filter((Z=>Z.matches(Me)))),P.push(...X.flatMap((Z=>[...Z.querySelectorAll(Me)])))}catch{}}})),(P.length||ee.length)&&Lt((V=>[...V.filter((X=>!ee.includes(X))),...P]))}));return tt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{tt.disconnect()}}),[n,l,ve?.anchorSelect,M]),E.useEffect((()=>{et()}),[et]),E.useEffect((()=>{if(!L?.current)return()=>null;const Ke=new ResizeObserver((()=>{setTimeout((()=>et()))}));return Ke.observe(L.current),()=>{Ke.disconnect()}}),[ie,L?.current]),E.useEffect((()=>{var Ke;const Je=document.querySelector(`[id='${o}']`),Me=[...cr,Je];M&&Me.includes(M)||F((Ke=cr[0])!==null&&Ke!==void 0?Ke:Je)}),[o,cr,M]),E.useEffect((()=>(O&&Bt(!0),()=>{In(fe),In(I)})),[]),E.useEffect((()=>{var Ke;let Je=(Ke=ve?.anchorSelect)!==null&&Ke!==void 0?Ke:l;if(!Je&&n&&(Je=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),Je)try{const Me=Array.from(document.querySelectorAll(Je));Lt(Me)}catch{Lt([])}}),[n,l,ve?.anchorSelect]),E.useEffect((()=>{fe.current&&(In(fe),en(w))}),[w]);const mt=(q=ve?.content)!==null&&q!==void 0?q:ie,Mt=qe&&Object.keys(Pe.tooltipStyles).length>0;return E.useImperativeHandle(e,(()=>({open:Ke=>{if(Ke?.anchorSelect)try{document.querySelector(Ke.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ke.anchorSelect}" is not a valid CSS selector`)}Oe(Ke??null),Ke?.delay?en(Ke.delay):Bt(!0)},close:Ke=>{Ke?.delay?me(Ke.delay):Bt(!1)},activeAnchor:M,place:Pe.place,isOpen:!!(ue&&!N&&mt&&Mt)}))),ue&&!N&&mt?Te.createElement(v,{id:n,role:R,className:Gf("react-tooltip",qo.tooltip,kf.tooltip,kf[a],t,`react-tooltip__place-${Pe.place}`,qo[Mt?"show":"closing"],Mt?"react-tooltip__show":"react-tooltip__closing",m==="fixed"&&qo.fixed,S&&qo.clickable),onTransitionEnd:Ke=>{In(Fe),qe||Ke.propertyName!=="opacity"||(we(!1),Oe(null),de?.())},style:{...J,...Pe.tooltipStyles,opacity:A!==void 0&&Mt?A:void 0},ref:H},mt,Te.createElement(v,{className:Gf("react-tooltip-arrow",qo.arrow,kf.arrow,r,C&&qo.noArrow),style:{...Pe.tooltipArrowStyles,background:T?`linear-gradient(to right bottom, transparent 50%, ${T} 50%)`:void 0,"--rt-arrow-size":`${j}px`},ref:B})):null},eR=({content:e})=>Te.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),ti=Te.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:h="top",offset:p=10,wrapper:m="div",children:g=null,events:v=["hover"],openOnClick:w=!1,positionStrategy:b="absolute",middlewares:k,delayShow:N=0,delayHide:C=0,float:S=!1,hidden:U=!1,noArrow:te=!1,clickable:Q=!1,closeOnEsc:D=!1,closeOnScroll:K=!1,closeOnResize:W=!1,openEvents:oe,closeEvents:J,globalCloseEvents:Y,imperativeModeOnly:pe=!1,style:de,position:G,isOpen:ie,defaultIsOpen:L=!1,disableStyleInjection:ne=!1,border:O,opacity:re,arrowColor:M,arrowSize:F,setIsOpen:le,afterShow:A,afterHide:T,disableTooltip:j,role:R="tooltip"},q)=>{const[H,B]=E.useState(r),[fe,I]=E.useState(a),[Fe,Pe]=E.useState(h),[Qe,qe]=E.useState(f),[he,ue]=E.useState(p),[we,ve]=E.useState(N),[Oe,lt]=E.useState(C),[ft,gt]=E.useState(S),[Rt,Gt]=E.useState(U),[cr,Lt]=E.useState(m),[Qt,dt]=E.useState(v),[Et,Xt]=E.useState(b),[Ct,$t]=E.useState(null),[Bt,Jr]=E.useState(null),en=E.useRef(ne),{anchorRefs:me,activeAnchor:Ae}=mw(e),ze=De=>De?.getAttributeNames().reduce(((Re,$e)=>{var et;return $e.startsWith("data-tooltip-")&&(Re[$e.replace(/^data-tooltip-/,"")]=(et=De?.getAttribute($e))!==null&&et!==void 0?et:null),Re}),{}),Ze=De=>{const Re={place:$e=>{var et;Pe((et=$e)!==null&&et!==void 0?et:h)},content:$e=>{B($e??r)},html:$e=>{I($e??a)},variant:$e=>{var et;qe((et=$e)!==null&&et!==void 0?et:f)},offset:$e=>{ue($e===null?p:Number($e))},wrapper:$e=>{var et;Lt((et=$e)!==null&&et!==void 0?et:m)},events:$e=>{const et=$e?.split(" ");dt(et??v)},"position-strategy":$e=>{var et;Xt((et=$e)!==null&&et!==void 0?et:b)},"delay-show":$e=>{ve($e===null?N:Number($e))},"delay-hide":$e=>{lt($e===null?C:Number($e))},float:$e=>{gt($e===null?S:$e==="true")},hidden:$e=>{Gt($e===null?U:$e==="true")},"class-name":$e=>{$t($e)}};Object.values(Re).forEach(($e=>$e(null))),Object.entries(De).forEach((([$e,et])=>{var mt;(mt=Re[$e])===null||mt===void 0||mt.call(Re,et)}))};E.useEffect((()=>{B(r)}),[r]),E.useEffect((()=>{I(a)}),[a]),E.useEffect((()=>{Pe(h)}),[h]),E.useEffect((()=>{qe(f)}),[f]),E.useEffect((()=>{ue(p)}),[p]),E.useEffect((()=>{ve(N)}),[N]),E.useEffect((()=>{lt(C)}),[C]),E.useEffect((()=>{gt(S)}),[S]),E.useEffect((()=>{Gt(U)}),[U]),E.useEffect((()=>{Xt(b)}),[b]),E.useEffect((()=>{en.current!==ne&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[ne]),E.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:ne==="core",disableBase:ne}}))}),[]),E.useEffect((()=>{var De;const Re=new Set(me);let $e=t;if(!$e&&e&&($e=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),$e)try{document.querySelectorAll($e).forEach((Je=>{Re.add({current:Je})}))}catch{console.warn(`[react-tooltip] "${$e}" is not a valid CSS selector`)}const et=document.querySelector(`[id='${n}']`);if(et&&Re.add({current:et}),!Re.size)return()=>null;const mt=(De=Bt??et)!==null&&De!==void 0?De:Ae.current,Mt=new MutationObserver((Je=>{Je.forEach((Me=>{var tt;if(!mt||Me.type!=="attributes"||!(!((tt=Me.attributeName)===null||tt===void 0)&&tt.startsWith("data-tooltip-")))return;const wt=ze(mt);Ze(wt)}))})),Ke={attributes:!0,childList:!1,subtree:!1};if(mt){const Je=ze(mt);Ze(Je),Mt.observe(mt,Ke)}return()=>{Mt.disconnect()}}),[me,Ae,Bt,n,t]),E.useEffect((()=>{de?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),O&&!jv("border",`${O}`)&&console.warn(`[react-tooltip] "${O}" is not a valid \`border\`.`),de?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),re&&!jv("opacity",`${re}`)&&console.warn(`[react-tooltip] "${re}" is not a valid \`opacity\`.`)}),[]);let rt=g;const se=E.useRef(null);if(o){const De=o({content:Bt?.getAttribute("data-tooltip-content")||H||null,activeAnchor:Bt});rt=De?Te.createElement("div",{ref:se,className:"react-tooltip-content-wrapper"},De):null}else H&&(rt=H);fe&&(rt=Te.createElement(eR,{content:fe}));const ye={forwardRef:q,id:e,anchorId:n,anchorSelect:t,className:Gf(l,Ct),classNameArrow:c,content:rt,contentWrapperRef:se,place:Fe,variant:Qe,offset:he,wrapper:cr,events:Qt,openOnClick:w,positionStrategy:Et,middlewares:k,delayShow:we,delayHide:Oe,float:ft,hidden:Rt,noArrow:te,clickable:Q,closeOnEsc:D,closeOnScroll:K,closeOnResize:W,openEvents:oe,closeEvents:J,globalCloseEvents:Y,imperativeModeOnly:pe,style:de,position:G,isOpen:ie,defaultIsOpen:L,border:O,opacity:re,arrowColor:M,arrowSize:F,setIsOpen:le,afterShow:A,afterHide:T,disableTooltip:j,activeAnchor:Bt,setActiveAnchor:De=>Jr(De),role:R};return Te.createElement(JO,{...ye})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Tv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Tv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));const tR="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",gw=({isOpen:e,onClose:n,product:t})=>t?u.jsx(rr,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[u.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:u.jsx(_t,{size:24})}),u.jsx("h2",{className:"text-xl font-semibold mb-4",children:" "}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.nazwa]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.ilosc]}),u.jsxs("p",{children:[u.jsx("strong",{children:". :"})," ",t.jednostka_miary]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod_kreskowy]}),t.data_waznosci&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.data_waznosci]}),t.waga_netto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_netto," "]}),t.waga_brutto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_brutto," "]}),t.objetosc&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.objetosc," "]}),t.opis&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.opis]})]})]})}):null,Ha="",vw=({isOpen:e,onClose:n,receipt:t})=>{const[r]=Te.useState(null),[a,o]=Te.useState(!1),[l,c]=Te.useState({x:0,y:0}),[f,h]=Te.useState(!1),p=Te.useRef({x:0,y:0});Te.useEffect(()=>{const v=b=>{f&&c({x:b.clientX-p.current.x,y:b.clientY-p.current.y})},w=()=>h(!1);return f&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",w)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",w)}},[f]);const m=v=>{v.target.closest("button")||v.target.closest("input")||(h(!0),p.current={x:v.clientX-l.x,y:v.clientY-l.y})};if(!t)return null;let g=[];if(Array.isArray(t.products))g=t.products;else if(typeof t.products=="string")try{g=JSON.parse(t.products)}catch{g=[]}return u.jsxs(rr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${l.x}px), calc(-50% + ${l.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:m,style:{cursor:f?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy zakupu"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Warto"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," "]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," "]})]})]}),(t.productInvoice||t.transportInvoice)&&u.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ha}/uploads/${t.productInvoice}`;console.log(" Opening product invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(ep,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ha}/uploads/${t.transportInvoice}`;console.log(" Opening transport invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(Zf,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),u.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),u.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilo"}),u.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),u.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Warto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data wanoci"})]})}),u.jsx("tbody",{children:g.map((v,w)=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.kod}),u.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:v.nazwa}),u.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:v.kod_kreskowy||"-"}),u.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:v.ilosc}),u.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[v.cena," "]}),u.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(v.ilosc*v.cena).toFixed(2).replace(".",",")," "]}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const b=v.typ;return b?{czerwone:"Czerwone",biale:"Biae",musujace:"Musujce",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment",rozowe:"Rowe",slodkie:"Sodkie",aksesoria:"Aksesoria",amber:"Amber"}[b]||b:"-"})()}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.objetosc||"-"}),u.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:v.dataWaznosci?typeof v.dataWaznosci=="number"?new Date(v.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(v.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},w))})]})]})]}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),u.jsx(gw,{isOpen:a,onClose:()=>o(!1),product:r})]})},rR=({isOpen:e,onClose:n,onAdd:t,initialData:r})=>{const[a,o]=E.useState(""),[l,c]=E.useState(""),[f,h]=E.useState(""),[p,m]=E.useState(""),[g,v]=E.useState("");E.useEffect(()=>{console.log(" useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log(" Setting initial data from props"),o(r.firma),c(r.nazwa),h(r.adres),m(r.czas_dostawy),v(r.kontakt)):e&&!r&&console.log(" Modal opened without initial data - keeping current values")},[e,r]);const w=()=>{if(console.log(" handleSubmit called with values:",{firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g}),console.log(" Trimmed values:",{firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()}),!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()){console.log(" Validation failed: some fields are empty");return}const k={firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()};console.log(" Submitting client data:",k),t(k),b()},b=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(rr,{isOpen:e,onRequestClose:b,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),u.jsx("button",{onClick:b,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:k=>{console.log(" firma onChange:",k.target.value),o(k.target.value)},placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:k=>c(k.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:k=>m(k.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:k=>v(k.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:w,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};Aa("pl",Oa);const bf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],Ov=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],yw=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=E.useState(null),[l,c]=E.useState(""),[f,h]=E.useState({x:0,y:0}),[p,m]=E.useState(!1),[g,v]=E.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),w=E.useRef({x:0,y:0}),[b,k]=E.useState(""),[N,C]=E.useState(null),[S,U]=E.useState(null),[te,Q]=E.useState(null),[D,K]=E.useState(null),W=E.useRef(null),oe=E.useRef(null),[J,Y]=E.useState(null),[pe,de]=E.useState(null),[G,ie]=E.useState("0,00"),[L,ne]=E.useState("0,00"),[O,re]=E.useState("0,00"),M=()=>{const he=g.reduce((we,ve)=>{const Oe=parseFloat(ve.ilosc.toString().replace(",","."))||0;return we+Oe},0),ue=parseFloat(b.replace(",","."))||0;return he>0?(ue/he).toFixed(2):"0,00"};E.useEffect(()=>{if(e&&r){let he=[];if(r.products)if(typeof r.products=="string")try{he=JSON.parse(r.products)}catch(ue){console.error("Error parsing products JSON:",ue),he=[]}else Array.isArray(r.products)&&(he=r.products);if(Array.isArray(he)&&he.length>0){let ue=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[ve,Oe,lt]=r.dataPrzyjecia.split("/");ue=new Date(parseInt(lt),parseInt(Oe)-1,parseInt(ve))}else r.dataPrzyjecia.includes("-")?ue=new Date(r.dataPrzyjecia):ue=new Date(r.dataPrzyjecia);if(o(ue),c(r.sprzedawca||""),k((r.kosztDostawy||0).toFixed(2).replace(".",",")),r.aktualny_kurs!==void 0&&r.aktualny_kurs!==null)ie(Number(r.aktualny_kurs).toFixed(2).replace(".",","));else if(r.aktualnyKurs!==void 0&&r.aktualnyKurs!==null)ie(String(r.aktualnyKurs).replace(".",","));else{const ve=he.reduce((gt,Rt)=>gt+(Rt.ilosc||0),0),Oe=ve?r.kosztDostawy/ve:0,lt=he[0]?.deliveryCostPerUnitPln||0,ft=Oe?lt/Oe:1;ie(ft.toFixed(2).replace(".",","))}if(r.podatek_akcyzowy!==void 0&&r.podatek_akcyzowy!==null)ne(Number(r.podatek_akcyzowy).toFixed(2).replace(".",","));else if(r.podatekAkcyzowy!==void 0&&r.podatekAkcyzowy!==null)ne(String(r.podatekAkcyzowy).replace(".",","));else{const ve=he[0]?.podatekAkcyzowyPerLiter??he[0]?.podatekAkcyzowy??he[0]?.podatek_akcyzowy??0;ne(ve.toFixed(2).replace(".",","))}r.rabat!==void 0&&r.rabat!==null?re(Number(r.rabat).toFixed(2).replace(".",",")):re("0,00");const we=he.map(ve=>({kod:ve.kod||"",nazwa:ve.nazwa||"",kod_kreskowy:ve.kod_kreskowy||ve.ean||"",ilosc:(ve.ilosc||0).toString(),cena:(ve.cena||0).toFixed(2).replace(".",","),dataWaznosci:ve.dataWaznosci||"",showDataWaznosci:!1,typ:ve.typ||ve.typTowaru||"",objetosc:ve.objetosc||""}));v(we.length>0?we:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),Q(r.productInvoice||null),K(r.transportInvoice||null),C(null),U(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),k(""),C(null),U(null),Q(null),K(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),k(""),C(null),U(null),Q(null),K(null)},[e,r]),E.useEffect(()=>{const he=we=>{const ve=we.target;if(!ve.closest(".dropdown-container")&&!ve.closest('button[onclick*="toggleDropdown"]')&&Y(null),!ve.closest(".objetosc-dropdown-container")&&!ve.closest('button[onclick*="toggleObjetoscDropdown"]')&&de(null),!ve.closest(".react-datepicker")&&!ve.closest('button[title*="wanoci"]')){const Oe=[...g];let lt=!1;Oe.forEach(ft=>{ft.showDataWaznosci&&(ft.showDataWaznosci=!1,lt=!0)}),lt&&v(Oe)}},ue=we=>{if(we.key==="Escape"){Y(null),de(null);const ve=[...g];let Oe=!1;ve.forEach(lt=>{lt.showDataWaznosci&&(lt.showDataWaznosci=!1,Oe=!0)}),Oe&&v(ve)}};return document.addEventListener("mousedown",he),document.addEventListener("keydown",ue),()=>{document.removeEventListener("mousedown",he),document.removeEventListener("keydown",ue)}},[g]);const F=()=>{v([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},le=he=>{if(g.length>1){const ue=[...g];ue.splice(he,1),v(ue)}},A=he=>{const ue=[...g];ue[he].showDataWaznosci=!ue[he].showDataWaznosci,v(ue)},T=(he,ue)=>{const we=[...g];we[he].typ=ue,v(we),Y(null)},j=he=>{Y(J===he?null:he)},R=(he,ue)=>{const we=[...g];we[he].objetosc=ue,v(we),de(null)},q=he=>{de(pe===he?null:he)},H=he=>{he.target.closest("button")||he.target.closest("input")||he.target.closest(".react-datepicker")||he.target.closest('[role="button"]')||he.target.closest(".react-datepicker__input-container")||(m(!0),w.current={x:he.clientX-f.x,y:he.clientY-f.y})};E.useEffect(()=>{const he=we=>{p&&requestAnimationFrame(()=>{h({x:we.clientX-w.current.x,y:we.clientY-w.current.y})})},ue=()=>{m(!1)};return p&&(window.addEventListener("mousemove",he),window.addEventListener("mouseup",ue)),()=>{window.removeEventListener("mousemove",he),window.removeEventListener("mouseup",ue)}},[p]);const B=he=>{const ue=he.target.files?.[0];console.log(" Product file selected (edit):",ue),ue&&ue.type==="application/pdf"?(C(ue),console.log(" Product invoice set (edit):",ue.name)):console.log(" Invalid product file type (edit):",ue?.type)},fe=he=>{const ue=he.target.files?.[0];console.log(" Transport file selected (edit):",ue),ue&&ue.type==="application/pdf"?(U(ue),console.log(" Transport invoice set (edit):",ue.name)):console.log(" Invalid transport file type (edit):",ue?.type)},I=()=>{W.current?.click()},Fe=()=>{oe.current?.click()},Pe=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const he=g.filter(ft=>ft.kod&&ft.nazwa&&ft.ilosc&&ft.cena);if(console.log("productRows:",g),console.log("validProducts:",he),console.log("validProducts.length:",he.length),he.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const ue=he.map(ft=>({kod:ft.kod,nazwa:ft.nazwa,kod_kreskowy:ft.kod_kreskowy||"",ilosc:parseFloat(ft.ilosc)||0,cena:parseFloat(ft.cena.replace(",","."))||0,dataWaznosci:ft.dataWaznosci||void 0,typ:ft.typ||void 0,objetosc:ft.objetosc?parseFloat(ft.objetosc):void 0})),we=ue.reduce((ft,gt)=>ft+gt.ilosc*gt.cena,0),ve=parseFloat(b.replace(",","."))||0,Oe=parseFloat(O.replace(",","."))||0,lt=we*(1-Oe/100);console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:lt,rabat:Oe+"%",kosztDostawy:ve,products:ue}),console.log(" Files to submit (edit):",{productInvoice:N,transportInvoice:S}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:lt,kosztDostawy:ve,aktualnyKurs:parseFloat(G.replace(",","."))||1,podatekAkcyzowy:parseFloat(L.replace(",","."))||0,rabat:Oe,products:ue,productInvoice:N||null,transportInvoice:S||null}),Qe()},Qe=()=>{o(null),h({x:0,y:0}),v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k(""),c(""),C(null),U(null),Q(null),K(null),n()},qe=()=>g.reduce((he,ue)=>{const we=parseFloat(ue.ilosc)||0,ve=parseFloat(ue.cena.replace(",","."))||0;return he+we*ve},0).toFixed(2);return u.jsx(rr,{isOpen:e,onRequestClose:Qe,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:H,style:{cursor:p?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:he=>he.stopPropagation(),children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),u.jsx("button",{type:"button",onClick:he=>{he.preventDefault(),he.stopPropagation(),Qe()},className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx(wn,{selected:a,onChange:he=>o(he),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:b,onKeyPress:he=>{const ue=String.fromCharCode(he.which);(!/[\d,]/.test(ue)||ue===","&&he.target.value.includes(",")||he.target.value===""&&ue===",")&&he.preventDefault()},onChange:he=>{const ue=he.target,we=ue.selectionStart??0;let ve=ue.value.replace(/[^\d,]/g,"");if(ve===""){k("");return}if(!ve.includes(","))ve=ve+",00";else{const[lt,ft]=ve.split(",");ft&&ft.length>2&&(ve=`${lt},${ft.slice(0,2)}`)}k(ve),requestAnimationFrame(()=>{const lt=Math.min(we,ve.length);ue.setSelectionRange(lt,lt)})},className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:B,className:"hidden",ref:W}),u.jsx("button",{type:"button",onClick:I,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),N&&u.jsx("a",{href:URL.createObjectURL(N),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:N.name,children:N.name}),!N&&te&&u.jsx("a",{href:`${Ha}${te}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:fe,className:"hidden",ref:oe}),u.jsx("button",{type:"button",onClick:Fe,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Zf,{className:"h-4 w-4 text-gray-500"})}),S&&u.jsx("a",{href:URL.createObjectURL(S),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:S.name,children:S.name}),!S&&D&&u.jsx("a",{href:`${Ha}${D}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:l,onChange:he=>c(he.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[M().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:G,onChange:he=>ie(he.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-8 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:L,onChange:he=>ne(he.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:O,onChange:he=>re(he.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((he,ue)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:he.kod,onChange:we=>{const ve=[...g];ve[ue].kod=we.target.value,v(ve)}}),ue===g.length-1&&u.jsx("button",{onClick:F,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(Hn,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:he.nazwa,onChange:we=>{const ve=[...g];ve[ue].nazwa=we.target.value,v(ve)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:he.kod_kreskowy,onChange:we=>{const ve=[...g];ve[ue].kod_kreskowy=we.target.value,v(ve)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:he.ilosc,onChange:we=>{const ve=[...g],Oe=we.target.value;(Oe===""||/^\d*$/.test(Oe))&&(ve[ue].ilosc=Oe,v(ve))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:he.cena,onKeyPress:we=>{const ve=String.fromCharCode(we.which);(!/[\d,]/.test(ve)||ve===","&&we.target.value.includes(",")||we.target.value===""&&ve===",")&&we.preventDefault()},onChange:we=>{const ve=we.target,Oe=ve.selectionStart??0;let lt=we.target.value.replace(/[^\d,]/g,"");if(lt===""){const Rt=[...g];Rt[ue].cena="",v(Rt);return}if(!lt.includes(","))lt=lt+",00";else{const[Rt,Gt]=lt.split(",");Gt&&Gt.length>2&&(lt=`${Rt},${Gt.slice(0,2)}`)}const gt=[...g];gt[ue].cena=lt,v(gt),requestAnimationFrame(()=>{const Rt=Math.min(Oe,lt.length);ve.setSelectionRange(Rt,Rt)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const we=parseFloat(he.ilosc)||0,ve=parseFloat(he.cena.replace(",","."))||0;return(we*ve).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>A(ue),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${he.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:he.dataWaznosci?`Termin wanoci: ${he.dataWaznosci}`:"Dodaj termin wanoci",children:u.jsx(qf,{size:16})}),u.jsx("button",{onClick:()=>le(ue),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(_t,{size:16})})]}),he.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx(wn,{selected:he.dataWaznosci?new Date(he.dataWaznosci):null,onChange:we=>{const ve=[...g];ve[ue].dataWaznosci=we?we.toISOString().split("T")[0]:"",ve[ue].showDataWaznosci=!1,v(ve)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const we=[...g];we[ue].showDataWaznosci=!1,v(we)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>j(ue),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${he.typ&&bf.find(we=>we.value===he.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:he.typ&&bf.find(we=>we.value===he.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),J===ue&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:we=>we.stopPropagation(),children:bf.map(we=>u.jsx("button",{type:"button",onClick:()=>T(ue,we.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${we.color}`,children:we.label},we.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ue>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>q(ue),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${he.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:he.objetosc?Ov.find(we=>we.value===he.objetosc)?.label||he.objetosc:"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),pe===ue&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:we=>we.stopPropagation(),style:{maxWidth:"200px"},children:Ov.map(we=>u.jsx("button",{type:"button",onClick:()=>R(ue,we.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:we.label},we.value))})]})]})]},ue))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[qe().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:Pe,disabled:!a||!g.some(he=>he.kod&&he.nazwa&&he.ilosc&&he.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(he=>he.kod&&he.nazwa&&he.ilosc&&he.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},nR=({receipts:e,onDelete:n,onUpdate:t,selectedCategory:r=""})=>{const[a,o]=E.useState(null),[l,c]=E.useState(!1),[f,h]=E.useState(!1),[p,m]=E.useState(null),[g,v]=E.useState(!1),[w,b]=E.useState(null),[k,N]=E.useState(""),[C,S]=E.useState({x:0,y:0}),[U,te]=E.useState(!1),Q=E.useRef({x:0,y:0}),[D,K]=E.useState("dataPrzyjecia"),[W,oe]=E.useState("desc"),[J,Y]=E.useState(""),[pe,de]=E.useState(""),G=R=>{o(R),c(!0)},ie=R=>{m(R),h(!0)},L=R=>{b(R),v(!0),N("")},ne=()=>{k==="5202"?(w?.id&&(n(w.id),He.success("Zapis zosta usunity")),O()):(He.error("Nieprawidowe haso"),N(""))},O=()=>{v(!1),b(null),N(""),S({x:0,y:0})},re=R=>{R.key==="Enter"&&ne()},M=R=>{D===R?oe(W==="asc"?"desc":"asc"):(K(R),oe("asc"))},F=R=>{R.target.closest("button")||R.target.closest("input")||(te(!0),Q.current={x:R.clientX-C.x,y:R.clientY-C.y})};E.useEffect(()=>{const R=H=>{U&&requestAnimationFrame(()=>{S({x:H.clientX-Q.current.x,y:H.clientY-Q.current.y})})},q=()=>{te(!1)};return U&&(window.addEventListener("mousemove",R),window.addEventListener("mouseup",q)),()=>{window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",q)}},[U]);const le=Array.from(new Set(e.map(R=>new Date(R.dataPrzyjecia).getFullYear().toString()))).sort((R,q)=>parseInt(q)-parseInt(R)),A=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],j=e.filter(R=>{if(r)if(typeof R.products=="string")try{if(!JSON.parse(R.products).some(B=>B.typ===r))return!1}catch{return!1}else if(Array.isArray(R.products)){if(!R.products.some(H=>H.typ===r))return!1}else return!1;return!(J&&new Date(R.dataPrzyjecia).getFullYear().toString()!==J||pe&&(new Date(R.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==pe)}).sort((R,q)=>{let H,B;switch(D){case"dataPrzyjecia":H=new Date(R.dataPrzyjecia),B=new Date(q.dataPrzyjecia);break;case"sprzedawca":H=(R.sprzedawca||"").toLowerCase(),B=(q.sprzedawca||"").toLowerCase();break;case"wartosc":H=R.wartosc,B=q.wartosc;break;case"kosztDostawy":H=R.kosztDostawy,B=q.kosztDostawy;break;default:H=R[D]||"",B=q[D]||""}return typeof H=="string"&&typeof B=="string"?W==="asc"?H.localeCompare(B):B.localeCompare(H):typeof H=="number"&&typeof B=="number"?W==="asc"?H-B:B-H:H instanceof Date&&B instanceof Date?W==="asc"?H.getTime()-B.getTime():B.getTime()-H.getTime():0});return u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("dataPrzyjecia"),children:"Data zakupu"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("sprzedawca"),children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("wartosc"),children:"Warto"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>M("kosztDostawy"),children:"Koszt dostawy"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:J,onChange:R=>Y(R.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),le.map(R=>u.jsx("option",{value:R,style:{fontFamily:"Sora, sans-serif"},children:R},R))]}),u.jsxs("select",{value:pe,onChange:R=>de(R.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Msc"}),A.map(R=>u.jsx("option",{value:R.value,style:{fontFamily:"Sora, sans-serif"},children:R.label},R.value))]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(R=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:R.dataPrzyjecia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:R.sprzedawca}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[R.wartosc.toFixed(2)," "]}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[R.kosztDostawy.toFixed(2)," "]}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),G(R)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(Jf,{size:16})}),u.jsx("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),ie(R)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),L(R)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(_t,{size:16})})]})})]},R.id))})]})}),u.jsx(rr,{isOpen:g,onRequestClose:O,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${C.x}px), calc(-50% + ${C.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:F,style:{cursor:U?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:O,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:k,onChange:R=>N(R.target.value),onKeyPress:re,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:O,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:ne,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(vw,{isOpen:l,onClose:()=>c(!1),receipt:a}),u.jsx(yw,{isOpen:f,onClose:()=>{h(!1),m(null)},onSubmit:R=>{t({...R,productInvoice:R.productInvoice??void 0,transportInvoice:R.transportInvoice??void 0}),h(!1),m(null)},receipt:p?{id:p.id||0,dataPrzyjecia:p.dataPrzyjecia,sprzedawca:p.sprzedawca,wartosc:p.wartosc,kosztDostawy:p.kosztDostawy,aktualnyKurs:p.aktualnyKurs,podatekAkcyzowy:p.podatekAkcyzowy,aktualny_kurs:p.aktualny_kurs,podatek_akcyzowy:p.podatek_akcyzowy,products:p.products,productInvoice:p.productInvoice,transportInvoice:p.transportInvoice}:null})]})},aR=({isOpen:e,onClose:n,client:t})=>t?u.jsx(rr,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy klienta"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,ww=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=E.useState(""),[l,c]=E.useState(""),[f,h]=E.useState(""),[p,m]=E.useState(""),[g,v]=E.useState("");E.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),h(r.adres||""),m(r.czas_dostawy||""),v(r.kontakt||"")):(o(""),c(""),h(""),m(""),v(""))},[e,r]);const w=async()=>{if(a.trim()&&l.trim()&&f.trim()&&p.trim()&&g.trim()&&r){const k={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g};t(k),b()}},b=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(rr,{isOpen:e,onRequestClose:b,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),u.jsx("button",{onClick:b,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:k=>o(k.target.value),placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:k=>c(k.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:k=>m(k.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:k=>v(k.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:w,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},sR=({clients:e,onDelete:n,onUpdate:t})=>{console.log(" ClientsList render - clients:",e),console.log(" ClientsList render - clients length:",e.length),console.log(" ClientsList render - first client:",e[0]),console.log(" ClientsList render - all clients:",e.map(O=>({id:O.id,firma:O.firma,nazwa:O.nazwa})));const[r,a]=E.useState(null),[o,l]=E.useState(!1),[c,f]=E.useState(!1),[h,p]=E.useState(null),[m,g]=E.useState(!1),[v,w]=E.useState(null),[b,k]=E.useState(""),[N,C]=E.useState({x:0,y:0}),[S,U]=E.useState(!1),te=E.useRef({x:0,y:0}),[Q,D]=E.useState(""),[K,W]=E.useState("asc");E.useEffect(()=>{console.log(" ClientsList useEffect - clients changed:",e),console.log(" ClientsList useEffect - clients length:",e.length)},[e]);const oe=O=>{a(O),l(!0)},J=O=>{p(O),f(!0)},Y=O=>{w(O),g(!0),k("")},pe=()=>{b==="5202"?(v?.id&&n(v.id),de()):(He.error("Nieprawidowe haso"),k(""))},de=()=>{g(!1),w(null),k(""),C({x:0,y:0})},G=O=>{O.key==="Enter"&&pe()},ie=O=>{Q===O?W(K==="asc"?"desc":"asc"):(D(O),W("asc"))},L=O=>{O.target.closest("button")||O.target.closest("input")||(U(!0),te.current={x:O.clientX-N.x,y:O.clientY-N.y})};E.useEffect(()=>{const O=M=>{S&&requestAnimationFrame(()=>{C({x:M.clientX-te.current.x,y:M.clientY-te.current.y})})},re=()=>{U(!1)};return S&&(window.addEventListener("mousemove",O),window.addEventListener("mouseup",re)),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",re)}},[S]),console.log(" Sorting logic - sortField:",Q,"sortDirection:",K),console.log(" Sorting logic - clients length:",e.length);const ne=Q?[...e].sort((O,re)=>{let M,F;switch(Q){case"firma":M=(O.firma||"").toLowerCase(),F=(re.firma||"").toLowerCase();break;case"nazwa":M=(O.nazwa||"").toLowerCase(),F=(re.nazwa||"").toLowerCase();break;case"adres":M=(O.adres||"").toLowerCase(),F=(re.adres||"").toLowerCase();break;case"czas_dostawy":M=(O.czas_dostawy||"").toLowerCase(),F=(re.czas_dostawy||"").toLowerCase();break;case"kontakt":M=(O.kontakt||"").toLowerCase(),F=(re.kontakt||"").toLowerCase();break;default:M=O[Q]||"",F=re[Q]||""}return typeof M=="string"&&typeof F=="string"?K==="asc"?M.localeCompare(F):F.localeCompare(M):0}):e;return console.log(" Final sortedClients length:",ne.length),console.log(" Final sortedClients first:",ne[0]),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${Q==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>ie("firma"),children:["Nazwa firmy ",Q==="firma"&&(K==="asc"?"":"")]}),u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${Q==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>ie("nazwa"),children:["Nazwa ",Q==="nazwa"&&(K==="asc"?"":"")]}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("adres"),children:"Adres"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("czas_dostawy"),children:"Czas dostawy"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("kontakt"),children:"Kontakt"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:Q&&u.jsx("button",{onClick:()=>{D(""),W("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:" ",children:""})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ne.map((O,re)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:O.firma}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:O.nazwa}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:O.adres}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:O.czas_dostawy}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:O.kontakt}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:M=>{M.preventDefault(),M.stopPropagation(),oe(O)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(Jf,{size:16})}),u.jsx("button",{type:"button",onClick:M=>{M.preventDefault(),M.stopPropagation(),J(O)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:M=>{M.preventDefault(),M.stopPropagation(),Y(O)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(_t,{size:16})})]})})]},O.id||`client-${re}`))})]})}),u.jsx(rr,{isOpen:m,onRequestClose:de,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${N.x}px), calc(-50% + ${N.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:L,style:{cursor:S?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:de,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:b,onChange:O=>k(O.target.value),onKeyPress:G,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:de,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:pe,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(aR,{isOpen:o,onClose:()=>l(!1),client:r}),u.jsx(ww,{isOpen:c,onClose:()=>{f(!1),p(null)},onSubmit:O=>{t(O),f(!1),p(null)},client:h})]})};Aa("pl",Oa);const _f=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],oR=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],iR=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=E.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:"",koszt_dostawy_per_unit:"",podatek_akcyzowy_per_liter:"2.22",kurs:"4.25"}),[l,c]=E.useState(!1),[f,h]=E.useState(!1),[p,m]=E.useState(!1),[g,v]=E.useState(!1),[w,b]=E.useState(null);E.useEffect(()=>{if(t)if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const D=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(D).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():"",koszt_dostawy_per_unit:t.koszt_dostawy_per_unit?t.koszt_dostawy_per_unit.toString():"",podatek_akcyzowy_per_liter:t.podatek_akcyzowy&&t.objetosc&&t.objetosc>0?(t.podatek_akcyzowy/t.objetosc).toFixed(2):"2.22",kurs:"4.25"}),t.data_waznosci){let D;if(typeof t.data_waznosci=="string")D=new Date(t.data_waznosci);else{const K=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;D=new Date(K)}b(isNaN(D.getTime())?null:D)}else b(null)},[t]);const k=D=>{o(K=>({...K,typ:D})),h(!1)},N=()=>{h(!f)},C=D=>{o(K=>({...K,objetosc:D})),m(!1)},S=()=>{m(!p)},U=()=>{v(!g)},te=D=>{b(D),o(K=>({...K,data_waznosci:D?D.toISOString().split("T")[0]:""})),v(!1)};E.useEffect(()=>{const D=W=>{const oe=W.target;f&&!oe.closest(".dropdown-container")&&h(!1),p&&!oe.closest(".dropdown-container")&&m(!1),g&&!oe.closest(".react-datepicker")&&!oe.closest('button[title*="wanoci"]')&&v(!1)},K=W=>{W.key==="Escape"&&(h(!1),m(!1),v(!1))};return(f||p||g)&&(document.addEventListener("mousedown",D),document.addEventListener("keydown",K)),()=>{document.removeEventListener("mousedown",D),document.removeEventListener("keydown",K)}},[f,p,g]);const Q=async D=>{if(D&&D.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(String(a.objetosc||"0").replace(",","."))||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(String(a.cena||"0").replace(",","."))||void 0,cena_sprzedazy:parseFloat(String(a.cena_sprzedazy||"0").replace(",","."))||void 0,koszt_dostawy_per_unit:parseFloat(String(a.koszt_dostawy_per_unit||"0").replace(",","."))||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(String(a.podatek_akcyzowy_per_liter||"0").replace(",","."))*parseFloat(String(a.objetosc||"0").replace(",",".")):void 0,kurs:parseFloat(a.kurs)||4.25})})).ok)throw new Error("Failed to update item");const W={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0,koszt_dostawy_per_unit:parseFloat(a.koszt_dostawy_per_unit)||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(a.podatek_akcyzowy_per_liter)*parseFloat(a.objetosc):void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(oe){console.error("Error creating price history record:",oe)}r(W),He.success("Pozycja zostaa zaktualizowana pomylnie"),n()}catch(K){console.error("Error updating item:",K),He.error("Bd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:u.jsx(rr,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycj"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsx("form",{onSubmit:Q,className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),u.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-[2]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:a.sprzedawca,onChange:D=>o(K=>({...K,sprzedawca:D.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:N,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&_f.find(D=>D.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:a.typ&&_f.find(D=>D.value===a.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:D=>D.stopPropagation(),children:_f.map(D=>u.jsx("button",{type:"button",onClick:()=>k(D.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${D.color}`,children:D.label},D.value))})]})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:S,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[u.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:D=>D.stopPropagation(),children:oR.map(D=>u.jsx("button",{type:"button",onClick:()=>C(D.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:D.label},D.value))})]})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data wanoci"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:w?w.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz dat",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),u.jsx("button",{type:"button",onClick:U,className:`p-1 focus:outline-none ${w?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:w?`Termin wanoci: ${w.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(qf,{size:16})})]}),g&&u.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:u.jsx(wn,{selected:w,onChange:te,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>v(!1)})})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa ()"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:D=>o(K=>({...K,cena:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzeday (z)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:D=>o(K=>({...K,cena_sprzedazy:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]}),u.jsx("div",{className:"flex gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kurs walutowy"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.kurs,onChange:D=>o(K=>({...K,kurs:D.target.value})),placeholder:"4.25",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.koszt_dostawy_per_unit,onChange:D=>o(K=>({...K,koszt_dostawy_per_unit:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.podatek_akcyzowy_per_liter,onChange:D=>o(K=>({...K,podatek_akcyzowy_per_liter:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:Q,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},lR=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .resizable-table {
    table-layout: fixed !important;
    width: max-content !important;
    min-width: 100% !important;
  }
  
  .resizable-table th,
  .resizable-table td {
    box-sizing: border-box !important;
    overflow: visible !important;
  }
  
  /* no generic resizable columns */
`,Sf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],Rv=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}return""}catch(n){return console.error("Error extracting date from order number:",n),""}},cR=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},uR=({refreshTrigger:e,productReceipts:n=[]})=>{E.useEffect(()=>{const se=document.createElement("style");return se.textContent=lR,document.head.appendChild(se),()=>{document.head.removeChild(se)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState([]),[f,h]=E.useState(!0),[p,m]=E.useState(null),[g,v]=E.useState(!1),[w,b]=E.useState(null),[k,N]=E.useState(""),[C,S]=E.useState(""),[U,te]=E.useState(()=>localStorage.getItem("sortField")||"nazwa"),[Q,D]=E.useState(()=>localStorage.getItem("sortDirection")||"asc"),[K,W]=E.useState([]),[oe,J]=E.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[Y,pe]=E.useState(!1),[de,G]=E.useState(null),[ie,L]=E.useState({}),[ne,O]=E.useState({}),[re,M]=E.useState({}),[F,le]=E.useState({}),[A,T]=E.useState({}),[j,R]=E.useState(()=>{const se=localStorage.getItem("columnWidths");if(se)try{return JSON.parse(se)}catch(ye){console.error("Error parsing saved column widths:",ye)}return{nazwa:250}}),[q,H]=E.useState(null),[B,fe]=E.useState(0),[I,Fe]=E.useState(0),[Pe,Qe]=E.useState(!1),qe=E.useRef(null),[he,ue]=E.useState(()=>{const se=new Date;return`${se.getFullYear()}-${String(se.getMonth()+1).padStart(2,"0")}-${String(se.getDate()).padStart(2,"0")}`});E.useEffect(()=>{const se=()=>{const De=new Date,Re=`${De.getFullYear()}-${String(De.getMonth()+1).padStart(2,"0")}-${String(De.getDate()).padStart(2,"0")}`;ue($e=>$e!==Re?(console.log(` Date changed: ${$e}  ${Re}, triggering averageSalesCache recalculation`),Re):$e)};se();const ye=setInterval(se,6e4);return()=>clearInterval(ye)},[]);const we=E.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const se=new Map;try{for(const ye of n)if(Array.isArray(ye.products))for(const De of ye.products)De.kod&&!se.has(De.kod)&&se.set(De.kod,ye.sprzedawca)}catch(ye){console.error("Error building sprzedawcaCache:",ye)}return console.log("sprzedawcaCache built with",se.size,"entries"),se},[n]),ve=E.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const se=new Map;try{for(const ye of t){const De=A[ye.kod],Re=De?new Date(De):null;if(Re&&!isNaN(Re.getTime())){const et=Math.max(1,Math.ceil((new Date().getTime()-Re.getTime())/(1e3*60*60*24))),mt=a.filter(Mt=>Mt.kod===ye.kod).reduce((Mt,Ke)=>Mt+Ke.ilosc,0);se.set(ye.kod,mt/et)}else se.set(ye.kod,0)}}catch(ye){console.error("Error building averageSalesCache:",ye)}return console.log("averageSalesCache built with",se.size,"entries"),se},[t,a,A,he]),Oe=async()=>{try{const se=await fetch("/api/products");if(se.ok){const ye=await se.json(),De={};ye.forEach(Re=>{Re.status!=="samples"&&(De[Re.kod]||(De[Re.kod]=[]),De[Re.kod].push({cena:Re.cena,ilosc_aktualna:Re.ilosc_aktualna,data_zmiany:Re.updated_at||Re.created_at}))}),Object.keys(De).forEach(Re=>{De[Re].sort(($e,et)=>new Date(et.data_zmiany).getTime()-new Date($e.data_zmiany).getTime())}),L(De)}}catch(se){console.error("Error loading all products:",se)}},lt=se=>{const ye=a.filter(Re=>Re.kod===se);if(ye.length===0)return null;let De=null;return ye.forEach(Re=>{let $e=null;Re.numer_zamowienia&&($e=cR(Re.numer_zamowienia)),!$e&&Re.created_at&&($e=new Date(Re.created_at)),$e&&(!De||$e>De)&&(De=$e)}),De},ft=async()=>{try{console.log("Starting loadInventory..."),h(!0),m(null),console.log("Fetching working-sheets...");const se=await fetch("/api/working-sheets");if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const ye=await se.json();console.log("Inventory data from server:",ye.length,"items"),ye.length>0&&(console.log("First item keys:",Object.keys(ye[0])),console.log("First item typ value:",ye[0].typ),ye[0].data_waznosci&&(console.log("First item data_waznosci:",ye[0].data_waznosci),console.log("First item data_waznosci type:",typeof ye[0].data_waznosci),console.log("First item data_waznosci formatted:",Ze(ye[0].data_waznosci)))),r(ye),console.log("Fetching orders...");const De=await fetch("/api/orders");if(!De.ok)throw new Error(`HTTP error! status: ${De.status}`);const Re=await De.json();console.log("Orders data from server:",Re.length,"items"),c(Re),console.log("Fetching orders-with-products...");const $e=await fetch("/api/orders-with-products");if(!$e.ok)throw new Error(`HTTP error! status: ${$e.status}`);const et=await $e.json();console.log("Orders with products from server:",et.length,"items");const mt=[];et.forEach(Me=>{Me.products&&Me.products.forEach(tt=>{mt.push({...tt,orderId:Me.id,created_at:tt.created_at||Me.data_utworzenia,numer_zamowienia:Me.numer_zamowienia})})}),console.log("Total order products:",mt.length),o(mt),await Oe();const Mt=await fetch("/api/products/samples-count");if(Mt.ok){const Me=await Mt.json(),tt={};Me.forEach(wt=>{tt[wt.kod]=wt.total_ilosc||0}),O(tt)}try{const Me=await fetch("/api/products/reservations-count");if(Me.ok){const tt=await Me.json(),wt={};tt.forEach(P=>{wt[P.kod]=P.total_ilosc||0}),M(wt),console.log(" Reservations count loaded:",wt)}else console.error(" Failed to load reservations count:",Me.status)}catch(Me){console.error(" Error loading reservations count:",Me)}const Ke=await fetch("/api/products/wartosc-towaru");if(Ke.ok){const Me=await Ke.json(),tt={};Me.forEach(wt=>{tt[wt.kod]=wt.wartosc||0}),le(tt)}const Je=await fetch("/api/products/oldest-date");if(Je.ok){const Me=await Je.json(),tt={};Me.forEach(wt=>{tt[wt.kod]=wt.oldest_created_at||""}),T(tt),console.log(" Oldest product dates loaded:",Object.keys(tt).length)}console.log("loadInventory completed successfully")}catch(se){console.error("Error loading inventory:",se),m(`Failed to load inventory: ${se instanceof Error?se.message:"Unknown error"}`)}finally{h(!1)}};E.useEffect(()=>{ft()},[]),E.useEffect(()=>{e&&ft()},[e]);const gt=se=>{if(U===se){const ye=Q==="asc"?"desc":"asc";D(ye),localStorage.setItem("sortDirection",ye)}else te(se),D("asc"),localStorage.setItem("sortField",se),localStorage.setItem("sortDirection","asc")},Rt=se=>{const ye=Sf.find(De=>De.value===se);return ye?ye.color:"bg-gray-100 text-gray-800 border-gray-200"},Gt=se=>se===1/0?"bg-gray-100 text-gray-800 border-gray-200":se<=30?"bg-red-100 text-gray-800 border-red-200":se<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",cr=E.useMemo(()=>{const se=new Set;return t.forEach(ye=>{const De=ye.sprzedawca||we.get(ye.kod);De&&se.add(De)}),Array.from(se).sort()},[t,we]),Lt=E.useMemo(()=>{const se=new Set;return t.forEach(ye=>{ye.typ&&se.add(ye.typ)}),Array.from(se).sort()},[t]),Qt=E.useMemo(()=>{const se=new Set;return t.forEach(ye=>{ye.objetosc&&se.add(ye.objetosc.toString())}),Array.from(se).sort((ye,De)=>parseFloat(ye)-parseFloat(De))},[t]),dt=E.useMemo(()=>{const se=new Set;return t.forEach(ye=>{if(ye.ilosc===0)se.add("brak");else{const De=ve.get(ye.kod)||0,Re=De<=0?1/0:Math.floor(ye.ilosc/De),$e=Re===1/0?"Brak danych":Re<=30?"mao":Re<=60?"rednie":"duo";se.add($e)}}),Array.from(se).sort()},[t,ve]),Et=t.filter(se=>{if(!(se.kod.toLowerCase().includes(C.toLowerCase())||se.nazwa.toLowerCase().includes(C.toLowerCase())||se.kod_kreskowy&&se.kod_kreskowy.toLowerCase().includes(C.toLowerCase()))||oe.sprzedawca&&(se.sprzedawca||we.get(se.kod))!==oe.sprzedawca||oe.typ&&se.typ!==oe.typ||oe.objetosc&&se.objetosc?.toString()!==oe.objetosc)return!1;if(oe.status){let De;if(se.ilosc===0)De="brak";else{const Re=ve.get(se.kod)||0,$e=Re<=0?1/0:Math.floor(se.ilosc/Re);De=$e===1/0?"Brak danych":$e<=30?"mao":$e<=60?"rednie":"duo"}if(De!==oe.status)return!1}return!0}).sort((se,ye)=>{let De,Re;switch(U){case"sprzedawca":De=se.sprzedawca||we.get(se.kod)||"",Re=ye.sprzedawca||we.get(ye.kod)||"";break;case"cena":De=se.cena||0,Re=ye.cena||0;break;case"cena_sprzedazy":De=se.cena_sprzedazy||0,Re=ye.cena_sprzedazy||0;break;case"koszt_wlasny":De=se.koszt_wlasny||0,Re=ye.koszt_wlasny||0;break;case"srednieZuzycie":De=ve.get(se.kod)||0,Re=ve.get(ye.kod)||0;break;case"dniPozostalo":const $e=ve.get(se.kod)||0,et=ve.get(ye.kod)||0;De=$e<=0?1/0:Math.floor(se.ilosc/$e),Re=et<=0?1/0:Math.floor(ye.ilosc/et);break;case"dataWyczerpania":if(se.ilosc===0){const Me=lt(se.kod);De=Me?Me.getTime():0}else{const Me=ve.get(se.kod)||0,tt=Me<=0?1/0:Math.floor(se.ilosc/Me);De=tt===1/0?1/0:new Date().setDate(new Date().getDate()+tt)}if(ye.ilosc===0){const Me=lt(ye.kod);Re=Me?Me.getTime():0}else{const Me=ve.get(ye.kod)||0,tt=Me<=0?1/0:Math.floor(ye.ilosc/Me);Re=tt===1/0?1/0:new Date().setDate(new Date().getDate()+tt)}break;case"status":const mt=Me=>{if(Me.ilosc===0)return 0;const tt=ve.get(Me.kod)||0,wt=tt<=0?1/0:Math.floor(Me.ilosc/tt);return wt===1/0?4:wt<=30?1:wt<=60?2:3};De=mt(se),Re=mt(ye);break;case"typ":De=se.typ||"",Re=ye.typ||"";break;case"objetosc":De=se.objetosc||0,Re=ye.objetosc||0;break;case"dataWaznosci":const Mt=Me=>{if(!Me)return 0;let tt;if(typeof Me=="string")tt=new Date(Me);else if(typeof Me=="number")Me<1e12?tt=new Date(Me*1e3):tt=new Date(Me);else return 0;return isNaN(tt.getTime())?0:tt.getTime()};De=Mt(se.data_waznosci),Re=Mt(ye.data_waznosci);break;case"sprzedaze":const Ke=a.filter(Me=>Me.kod===se.kod).length,Je=a.filter(Me=>Me.kod===ye.kod).length;De=Ke,Re=Je;break;default:De=se[U],Re=ye[U]}return typeof De=="string"&&typeof Re=="string"?Q==="asc"?De.localeCompare(Re):Re.localeCompare(De):typeof De=="number"&&typeof Re=="number"?Q==="asc"?De-Re:Re-De:0}),Xt=se=>{W(se?Et.map(ye=>ye.id):[])},Ct=(se,ye)=>{W(De=>ye?[...De,se]:De.filter(Re=>Re!==se))},$t=(se,ye)=>{se.preventDefault(),se.stopPropagation(),console.log(" Mouse down on column:",ye,"X:",se.clientX,"Current width:",j[ye]),H(ye),fe(se.clientX),Fe(j[ye]),Qe(!1),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},Bt=se=>{if(q){const ye=se.clientX-B,De=Math.max(50,I+ye);console.log(" Mouse move:","DeltaX:",ye,"NewWidth:",De,"Column:",q),Math.abs(ye)>3&&Qe(!0);const Re={...j,[q]:De};R(Re),localStorage.setItem("columnWidths",JSON.stringify(Re))}},Jr=()=>{console.log(" Mouse up - finishing resize"),H(null),fe(0),Fe(0),document.body.style.cursor="",document.body.style.userSelect="",setTimeout(()=>{Qe(!1)},100)};E.useEffect(()=>{if(q)return document.addEventListener("mousemove",Bt),document.addEventListener("mouseup",Jr),()=>{document.removeEventListener("mousemove",Bt),document.removeEventListener("mouseup",Jr)}},[q,B,I]);const en=()=>{if(K.length!==1){He.error("Wybierz dokadnie jedn pozycj do edycji");return}const se=t.find(ye=>ye.id===K[0]);se&&(G(se),pe(!0))},me=async()=>{try{const se=await fetch("/api/inventory/report/pdf");if(!se.ok)throw new Error("   ");const ye=await se.blob(),De=window.URL.createObjectURL(ye),Re=document.createElement("a");Re.href=De;const $e=se.headers.get("Content-Disposition");let et="raport_stanow_magazynowych.pdf";if($e){const mt=$e.match(/filename="?(.+)"?/i);mt&&(et=mt[1])}Re.download=et,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),setTimeout(()=>window.URL.revokeObjectURL(De),100)}catch(se){console.error("Error generating report:",se)}},Ae=se=>{r(ye=>ye.map(De=>De.id===se.id?se:De)),W([])},ze=Et.length>0&&Et.every(se=>K.includes(se.id)),Ze=se=>{if(!se)return"-";let ye;if(typeof se=="string")ye=new Date(se);else if(typeof se=="number")se<1e12?ye=new Date(se*1e3):ye=new Date(se);else return"-";return isNaN(ye.getTime())?"-":ye.toLocaleDateString("pl-PL")},rt=K.length>0?t.filter(se=>K.includes(se.id)):[];return f?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("p",{className:"text-red-600 font-sora",children:p}),u.jsx("button",{onClick:ft,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[u.jsxs("div",{className:"relative w-full max-w-xs",children:[u.jsx(la,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),u.jsx("input",{type:"text",value:C,onChange:se=>S(se.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),u.jsx("button",{onClick:en,disabled:K.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{onClick:me,className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Raport stanw magazynowych",children:u.jsx(vb,{size:16})})]}),u.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykuw"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:rt.length})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"czna ilo towaru"}),u.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:rt.length>0?rt.reduce((se,ye)=>se+(ye.ilosc||0),0):0})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru fakturowa"}),u.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[rt.length>0?rt.reduce((se,ye)=>se+(F[ye.kod]||0),0).toFixed(2):"0.00"," "]})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru w sprzeday"}),u.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[rt.length>0?rt.reduce((se,ye)=>{const De=ye.cena_sprzedazy||0,Re=ye.ilosc||0;return se+De*Re},0).toFixed(2):"0.00"," z"]})]})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[u.jsx("div",{className:"relative",children:u.jsxs("select",{value:oe.sprzedawca,onChange:se=>J(ye=>({...ye,sprzedawca:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Sprzedawca"}),cr.map(se=>u.jsx("option",{value:se,children:se},se))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:oe.typ,onChange:se=>J(ye=>({...ye,typ:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Typ"}),Lt.map(se=>u.jsx("option",{value:se,children:Sf.find(ye=>ye.value===se)?.label||se},se))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:oe.objetosc,onChange:se=>J(ye=>({...ye,objetosc:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Objto"}),Qt.map(se=>u.jsxs("option",{value:se,children:[se," l"]},se))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:oe.status,onChange:se=>J(ye=>({...ye,status:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Status"}),dt.map(se=>u.jsx("option",{value:se,children:se},se))]})})]}),(oe.sprzedawca||oe.typ||oe.objetosc||oe.status)&&u.jsx("button",{onClick:()=>J({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})]}),u.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:u.jsx("div",{className:"w-full overflow-x-auto overflow-y-scroll max-h-[500px] relative",style:{zIndex:1},children:u.jsxs("table",{className:"w-full resizable-table",ref:qe,children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsx("input",{type:"checkbox",checked:ze,onChange:se=>Xt(se.target.checked)})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>gt("kod"),style:{width:"100px"},children:"Kod"}),u.jsxs("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 relative",onClick:()=>{Pe||gt("nazwa")},style:{width:`${j.nazwa}px`},children:["Nazwa",u.jsx("div",{className:`absolute top-0 right-0 h-full cursor-col-resize hover:bg-blue-500 transition-opacity z-10 ${q==="nazwa"?"bg-blue-500 opacity-100":"opacity-0 hover:opacity-100"}`,style:{width:"2px"},onMouseDown:se=>{se.preventDefault(),se.stopPropagation(),$t(se,"nazwa")}})]}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>gt("sprzedawca"),style:{width:"120px"},children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>gt("ilosc"),children:"Ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>gt("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>gt("objetosc"),children:"Objto"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>gt("cena"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena",u.jsx("br",{}),"fakturowa"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>gt("koszt_wlasny"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Koszt",u.jsx("br",{}),"wasny"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>gt("cena_sprzedazy"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena w",u.jsx("br",{}),"sprzeday"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>gt("dataWaznosci"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data",u.jsx("br",{}),"wanoci"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>gt("sprzedaze"),children:"Sprzedae"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>gt("srednieZuzycie"),style:{width:"100px"},children:u.jsxs("div",{className:"whitespace-normal",children:["rednie",u.jsx("br",{}),"zuycie/dzie"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>gt("dniPozostalo"),style:{width:"80px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Dni",u.jsx("br",{}),"pozostao"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>gt("dataWyczerpania"),style:{width:"110px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data wyczerpania",u.jsx("br",{}),"zapasw"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>gt("status"),children:"Status"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Et.map(se=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:u.jsx("input",{type:"checkbox",checked:K.includes(se.id),onChange:ye=>Ct(se.id,ye.target.checked)})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:"100px"},children:u.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:se.kod})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:`${j.nazwa}px`},children:u.jsx("div",{className:"break-words leading-tight max-h-12 overflow-hidden",children:se.nazwa})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",style:{width:"120px"},children:se.sprzedawca||we.get(se.kod)||""}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`ilosc-tooltip-${se.kod}`,children:[se.ilosc,u.jsx(ti,{id:`ilosc-tooltip-${se.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"samples:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[ne[se.kod]||0," szt"]})]}),re[se.kod]>0&&u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"rezerwacja:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[re[se.kod]," szt"]})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:se.typ?u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Rt(se.typ)}`,children:Sf.find(ye=>ye.value===se.typ)?.label||se.typ}):"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:se.objetosc?`${se.objetosc} l`:"-"}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${se.kod}`,onMouseEnter:()=>{ie[se.kod]||Oe()},children:[se.cena!=null?`${se.cena.toFixed(2)} `:"-",u.jsx(ti,{id:`price-tooltip-${se.kod}`,className:"max-w-md",place:"top",children:u.jsxs("div",{className:"font-sora",children:[u.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),ie[se.kod]&&ie[se.kod].length>0?ie[se.kod].map((ye,De)=>u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:ye.cena!=null?`${ye.cena.toFixed(2)} `:"N/A"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:["(",ye.ilosc_aktualna," szt.)"]})]},De)):u.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`koszt-tooltip-${se.kod}`,children:[se.koszt_wlasny!=null?`${se.koszt_wlasny.toFixed(2)} z`:"-",u.jsx(ti,{id:`koszt-tooltip-${se.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"transport:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:se.koszt_dostawy_per_unit!=null?`${se.koszt_dostawy_per_unit.toFixed(2)} z`:"0,00 z"})]}),u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"akcyza:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:se.podatek_akcyzowy!=null?`${se.podatek_akcyzowy.toFixed(2)} z`:"0,00 z"})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:se.cena_sprzedazy!=null?`${se.cena_sprzedazy.toFixed(2)} z`:"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:Ze(se.data_waznosci)}),u.jsx("td",{className:"px-8 py-4 text-center text-xs text-gray-600 font-sora leading-tight align-middle whitespace-nowrap",children:(()=>{const ye=a.filter(et=>et.kod===se.kod);console.log(`Sales for ${se.kod}:`,ye.length);const De={};ye.forEach(et=>{const mt=l.find(Je=>Je.id===et.orderId),Mt=mt?mt.klient:"";let Ke="";mt&&mt.numer_zamowienia&&(Ke=Rv(mt.numer_zamowienia)),!Ke&&mt&&(Ke=new Date(mt.data_utworzenia).toLocaleDateString("pl-PL")),!Ke&&et.created_at&&(Ke=new Date(et.created_at).toLocaleDateString("pl-PL")),De[et.orderId]||(De[et.orderId]={qty:0,klient:Mt,date:Ke}),De[et.orderId].qty+=et.ilosc});const Re=Object.entries(De).sort(([,et],[,mt])=>{const Mt=new Date(et.date.split(".").reverse().join("-"));return new Date(mt.date.split(".").reverse().join("-")).getTime()-Mt.getTime()});if(console.log(`Sales array for ${se.kod}:`,Re.length),Re.length===0)return u.jsx("div",{className:"text-gray-400",children:"-"});const $e=Re.slice(0,3);return u.jsx("div",{className:"flex items-center justify-center",children:u.jsxs("div",{className:"relative cursor-pointer",children:[u.jsx(wb,{size:16,className:"text-blue-300 hover:text-blue-400 transition-colors focus:outline-none","data-tooltip-id":`sales-tooltip-${se.kod}`,onClick:et=>{et.stopPropagation(),b(se.kod),v(!0)},tabIndex:0,onMouseDown:et=>et.preventDefault()}),u.jsx(ti,{id:`sales-tooltip-${se.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!1,children:u.jsx("div",{className:"font-sora",children:$e.map(([et,mt])=>u.jsx("div",{className:"mb-1",children:mt.date&&mt.klient?u.jsxs("div",{children:[mt.date.split(".").slice(0,2).join(".")," | ",mt.klient,": ",u.jsx("span",{className:"text-gray-500",children:mt.qty})]}):u.jsxs("div",{className:"text-gray-500",children:["Ilo: ",mt.qty]})},et))})})]})})})()}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(()=>{const ye=ve.get(se.kod)||0;return ye>=1?ye.toFixed(2):ye>=.1?ye.toFixed(3):ye.toFixed(4)})(),"/dzie"]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const ye=ve.get(se.kod)||0,De=ye<=0?1/0:Math.floor(se.ilosc/ye);return De===1/0?"":De})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(se.ilosc===0){const $e=lt(se.kod);return $e?$e.toLocaleDateString("pl-PL"):"-"}const ye=ve.get(se.kod)||0,De=ye<=0?1/0:Math.floor(se.ilosc/ye);if(De===1/0)return"-";const Re=new Date;return Re.setDate(Re.getDate()+De),Re.toLocaleDateString("pl-PL")})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(se.ilosc===0)return u.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border bg-gray-100 text-gray-600 border-gray-300",children:"brak"});const ye=ve.get(se.kod)||0,De=ye<=0?1/0:Math.floor(se.ilosc/ye),Re=De===1/0?"Brak danych":De<=30?"mao":De<=60?"rednie":"duo";return u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Gt(De)}`,children:Re})})()})]},se.id))})]})})}),u.jsx(iR,{isOpen:Y,onClose:()=>{pe(!1),G(null)},item:de,onSave:Ae}),(()=>{let se=0;if(w){const Je=new Set;a.forEach(Me=>{Me.kod===w&&Je.add(Me.orderId)}),se=l.filter(Me=>Je.has(Me.id)).length}const ye=40,De=48,Re=40,$e=40,et=7,mt=et*$e,Mt=se===0?150:ye+De+Re+Math.max(se,et)*$e+20,Ke=Math.min(Math.max(Mt,ye+De+Re+mt+20),window.innerHeight*.9);return u.jsx(rr,{isOpen:g,onRequestClose:()=>{v(!1),b(null)},style:{content:{width:"400px",height:`${Ke}px`,maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},contentLabel:"Zamwienia",children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-start mb-8 select-none",children:[u.jsx("h2",{className:"text-xs font-semibold text-gray-800 pr-4 break-words leading-tight",children:w?t.find(Je=>Je.kod===w)?.nazwa||w:""}),u.jsx("button",{onClick:()=>{v(!1),b(null),N("")},className:"text-red-500 focus:outline-none flex-shrink-0",children:u.jsx(_t,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:w&&(()=>{const Je=new Set;a.forEach(P=>{P.kod===w&&Je.add(P.orderId)});let Me=l.filter(P=>Je.has(P.id));k.trim()&&(Me=Me.filter(P=>P.klient===k));const wt=Me.map(P=>{const ee=a.filter(X=>X.orderId===P.id&&X.kod===w).reduce((X,Z)=>X+Z.ilosc,0);let V="";return P.numer_zamowienia&&(V=Rv(P.numer_zamowienia)),!V&&P.data_utworzenia&&(V=new Date(P.data_utworzenia).toLocaleDateString("pl-PL")),{...P,date:V,totalQty:ee}}).sort((P,ee)=>{if(P.date&&ee.date){const V=new Date(P.date.split(".").reverse().join("-"));return new Date(ee.date.split(".").reverse().join("-")).getTime()-V.getTime()}return 0});return wt.length===0?u.jsx("p",{className:"text-xs text-gray-500",children:"Brak zamwie dla tego towaru"}):u.jsx("div",{children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-purple-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Zamwienia"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Klient"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-0"})]})}),u.jsx("tbody",{className:"bg-white",children:wt.map(P=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium",children:P.numer_zamowienia||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:P.klient||"-"})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:P.totalQty}),u.jsx("td",{})]},P.id))})]})})})()}),w&&(()=>{const Je=new Set;a.forEach(tt=>{tt.kod===w&&Je.add(tt.orderId)});const Me=l.filter(tt=>Je.has(tt.id)).map(tt=>tt.klient).filter((tt,wt,P)=>tt&&P.indexOf(tt)===wt).sort();return u.jsx("div",{className:"mt-6 pt-4",children:u.jsx("div",{className:"flex items-center space-x-2",children:u.jsxs("select",{value:k,onChange:tt=>N(tt.target.value),className:"block w-1/2 px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-0 focus:border-gray-300 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"",children:"Klient"}),Me.map(tt=>u.jsx("option",{value:tt,style:{fontFamily:"Sora, sans-serif"},children:tt},tt))]})})})})()]})})})()]})};Aa("pl",Oa);const dR=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=E.useState(new Date),[o,l]=E.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=E.useState([]),[,h]=E.useState(new Set),[p,m]=E.useState(!1),[g,v]=E.useState(""),[w,b]=E.useState(""),[k,N]=E.useState(!1),[C,S]=E.useState(null);E.useEffect(()=>{const W=setTimeout(async()=>{if(g.trim().length<2||k){f([]);return}m(!0);try{const oe=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(g)}`);if(!oe.ok)throw new Error("Failed to fetch orders");const J=await oe.json();if(J&&J.length>0){const Y=J.map(pe=>({id:pe.id,nazwa:`Zamwienie: ${pe.numer_zamowienia}`,kod:pe.klient,klient:pe.klient,numer_zamowienia:pe.numer_zamowienia,products:pe.products||[]}));f(Y)}else f([])}catch(oe){console.error("Error searching orders:",oe),f([])}finally{m(!1)}},300);return()=>clearTimeout(W)},[g,k]);const U=(K,W)=>{if(K.numer_zamowienia){if(b(K.klient),S(K.id),K.products&&K.products.length>0){const oe=K.products.map(J=>({nazwa:J.nazwa,ilosc:J.ilosc,original_ilosc:J.ilosc,powod_zwrotu:""}));l(oe)}f([]),v(K.numer_zamowienia),N(!0),He.success("Zamwienie wybrane")}else{const oe=[...o];oe[W]={...oe[W],nazwa:K.nazwa,ilosc:0,original_ilosc:0},l(oe)}},te=()=>{const K=new Set;return o.forEach((W,oe)=>{const J=W.original_ilosc,Y=o[oe].ilosc;!W.nazwa.trim()||!Y||Y<=0||!W.powod_zwrotu?K.add(oe):Y>J&&(K.add(oe),He.error(`Ilo zwrotu (${Y}) nie moe przekracza iloci w zamwieniu (${J})`))}),h(K),K.size===0},Q=async()=>{if(!te()){He.error("Prosz wypeni wszystkie wymagane pola");return}try{const K={klient:w,data_zwrotu:r,products:o,orderId:C},W=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)});if(!W.ok){const J=await W.json();throw new Error(J.error||"Failed to create return")}const oe=await W.json();console.log("Return created:",oe),t(K),He.success(`Zwrot zosta utworzony: ${oe.numer_zwrotu}`),n(),v(""),b(""),N(!1),S(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)}catch(K){console.error("Error creating return:",K),He.error("Bd podczas tworzenia zwrotu")}},D=()=>{n(),v(""),b(""),N(!1),S(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)};return u.jsx(rr,{isOpen:e,onRequestClose:D,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),u.jsx("button",{onClick:D,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),u.jsx(wn,{selected:r,onChange:K=>a(K||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:g,onChange:K=>{v(K.target.value),N(!1),S(null)},placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),p&&u.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&g.trim().length>=2&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(K=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>U(K,-1),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-[10px]",children:K.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",K.klient]})]})},K.id))})]})]})]})}),w&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),u.jsx("p",{className:"text-xs text-gray-900",children:w})]})}),u.jsx("button",{onClick:()=>b(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(_t,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((K,W)=>u.jsx("div",{className:"relative",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"relative flex-1 max-w-[50%]",children:u.jsx("input",{type:"text",value:K.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:"1",max:K.original_ilosc,value:o[W].ilosc||"",onChange:oe=>{const J=[...o],Y=oe.target.value===""?0:parseInt(oe.target.value)||0;J[W]={...J[W],ilosc:Y},l(J)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilo"})}),u.jsx("div",{className:"w-40 ml-2",children:u.jsxs("select",{value:o[W].powod_zwrotu,onChange:oe=>{const J=[...o];J[W]={...J[W],powod_zwrotu:oe.target.value},l(J)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[u.jsx("option",{value:"",children:"Powd zwrotu"}),u.jsx("option",{value:"Bd w zamwieniu",children:"Bd w zamwieniu"}),u.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),u.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&u.jsx("button",{onClick:()=>{const oe=o.filter((J,Y)=>Y!==W);l(oe)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(_t,{size:16})})]})},W))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:Q,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwrz zwrot"})}),u.jsx("div",{className:"absolute bottom-4 right-4",children:u.jsx("button",{onClick:D,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})};Aa("pl",Oa);const fR=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=E.useState(new Date),[o,l]=E.useState(""),[c,f]=E.useState(""),[h,p]=E.useState([{kod:"",nazwa:"",ilosc:0,powod:""}]),[m,g]=E.useState([]),[v,w]=E.useState(new Set),[b,k]=E.useState(new Set),[N,C]=E.useState(!1),[S,U]=E.useState(null),[te,Q]=E.useState(null),[D,K]=E.useState(!1),W=E.useRef(null),oe=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}];E.useEffect(()=>{e?fetch("/api/writeoffs/next-number-only").then(O=>{if(!O.ok)throw new Error("Failed to fetch next number");return O.json()}).then(O=>{O.numer_odpisania?(l(O.numer_odpisania),console.log(" Set write-off base number to:",O.numer_odpisania)):l("OP001")}).catch(O=>{console.error(" Error fetching next write-off number:",O),l("OP001")}):(l(""),f(""))},[e]),E.useEffect(()=>{if(o&&r){const O=String(r.getDate()).padStart(2,"0"),re=String(r.getMonth()+1).padStart(2,"0"),M=r.getFullYear(),F=`${o}_${O}_${re}_${M}`;f(F)}},[o,r]),E.useEffect(()=>{const re=setTimeout(async()=>{if(S===null){g([]);return}const M=h[S];if(!M||!M.nazwa||M.nazwa.trim().length<2||M.kod){g([]);return}C(!0);try{const F=M.nazwa,le=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(F)}`);if(!le.ok)throw new Error("Failed to fetch products");const T=(await le.json()).map(j=>({kod:j.kod,nazwa:j.nazwa,ilosc:j.ilosc?.toString()||"0"}));g(T)}catch(F){console.error("Error searching products:",F),g([])}finally{C(!1)}},300);return()=>clearTimeout(re)},[h,S]),E.useEffect(()=>{const O=M=>{const F=M.target;te!==null&&(F.closest(".dropdown-container")||Q(null))},re=M=>{M.key==="Escape"&&Q(null)};return te!==null&&(document.addEventListener("mousedown",O),document.addEventListener("keydown",re)),()=>{document.removeEventListener("mousedown",O),document.removeEventListener("keydown",re)}},[te]);const J=(O,re)=>{const M=[...h],F=parseInt(O.ilosc)||0;M[re]={...M[re],kod:O.kod,nazwa:`${O.kod} - ${O.nazwa}`,ilosc:0,availableQuantity:F},p(M),g([]),U(null),w(le=>{const A=new Set(le);return A.delete(re),A}),k(le=>{const A=new Set(le);return A.delete(re),A})},Y=O=>{Q(te===O?null:O)},pe=(O,re)=>{const M=[...h];M[O]={...M[O],powod:re},p(M),Q(null)},de=()=>{p([...h,{kod:"",nazwa:"",ilosc:0,powod:""}])},G=()=>c?h.every(O=>O.nazwa.trim()&&O.ilosc&&O.ilosc>0&&O.powod):!1,ie=()=>{const O=new Set;return h.forEach((re,M)=>{(!re.nazwa.trim()||!re.ilosc||re.ilosc<=0||!re.powod)&&O.add(M)}),w(O),O.size===0},L=async()=>{if(!ie()){He.error("Prosz wypeni wszystkie wymagane pola");return}if(!c){He.error("Brak numeru odpisania");return}K(!0);try{const O={data_odpisania:r.toISOString(),numer_odpisania:c,products:h},re=await fetch("/api/writeoffs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(!re.ok){const F=await re.json();throw new Error(F.error||"Failed to create write-off")}const M=await re.json();console.log("Write-off created:",M),t(O),He.success(`Odpisanie zostao utworzone: ${c}`),ne()}catch(O){console.error("Error creating write-off:",O),He.error("Bd podczas tworzenia odpisania")}finally{K(!1)}},ne=()=>{n(),a(new Date),l(""),f(""),p([{kod:"",nazwa:"",ilosc:0,powod:""}]),w(new Set),k(new Set),g([]),U(null),Q(null),K(!1)};return u.jsx(rr,{isOpen:e,onRequestClose:ne,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Odpisanie towaru"}),u.jsx("button",{onClick:ne,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4 mb-12",children:u.jsxs("div",{className:"flex items-end gap-6",children:[u.jsxs("div",{className:"w-[140px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data odpisania"}),u.jsx(wn,{selected:r,onChange:O=>a(O||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[120px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsx("input",{type:"text",value:"VEIS",readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed"})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer odpisania"}),u.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed"})]})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do odpisania"}),h.map((O,re)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"relative flex-1 max-w-[65%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:O.nazwa,onChange:M=>{const F=M.target.value,le=[...h];le[re]={...le[re],nazwa:F,kod:"",ilosc:0,powod:"",availableQuantity:void 0},p(le),U(re),k(A=>{const T=new Set(A);return T.delete(re),T})},onFocus:()=>U(re),className:`w-full pl-10 pr-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs ${v.has(re)?"border-red-500 bg-red-50":"border-gray-300"}`,placeholder:"Wyszukaj produkty..."}),N&&S===re&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),m.length>0&&S===re&&O.nazwa.trim().length>=2&&!O.kod&&u.jsx("div",{className:"absolute z-50 mt-1 w-[65%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map((M,F)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>J(M,re),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:M.kod}),u.jsx("span",{className:"text-[10px] text-gray-500",children:M.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",M.ilosc]})]})},`${M.kod}-${F}`))})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",value:O.ilosc||"",onChange:M=>{const F=M.target.value,le=F===""?0:Math.max(1,parseInt(F)||0),A=[...h];if(A[re]={...A[re],ilosc:le},p(A),W.current=null,O.kod&&O.availableQuantity!==void 0){const T=O.availableQuantity;le===0?k(j=>{const R=new Set(j);return R.delete(re),R}):le>T?(k(j=>{const R=new Set(j);return R.add(re),R}),W.current!==re&&(W.current=re,He.error(`Niewystarczajca ilo - dostpne: ${T} (na magazynie: ${T})`))):k(j=>{const R=new Set(j);return R.delete(re),R})}else k(T=>{const j=new Set(T);return j.delete(re),j})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${b.has(re)?"border-red-500 bg-red-50":"border-gray-300"}`,placeholder:"Ilo"})}),u.jsxs("div",{className:"w-32 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>Y(re),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${O.powod&&oe.find(M=>M.value===O.powod)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:O.powod?oe.find(M=>M.value===O.powod)?.label||O.powod:"Powd"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),te===re&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:M=>M.stopPropagation(),children:oe.map(M=>u.jsx("button",{type:"button",onClick:()=>pe(re,M.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${M.color}`,children:M.label},M.value))})]}),h.length>1&&u.jsx("button",{onClick:()=>{const M=h.filter((F,le)=>le!==re);p(M)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(_t,{size:16})})]}),re===h.length-1&&u.jsx("button",{type:"button",onClick:de,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})})]},re))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:L,disabled:D||!G(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${D||!G()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:D?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Tworzenie..."]}):"Utwrz odpisanie"})})]})})};Aa("pl",Oa);const pR=({isOpen:e,onClose:n,onReservationCreated:t})=>{console.log(" CreateReservationModal render - isOpen:",e);const[r,a]=E.useState(null),[o,l]=E.useState(null),[c,f]=E.useState(""),[h,p]=E.useState(""),[m,g]=E.useState([]),[v,w]=E.useState(null),[b,k]=E.useState(!1),[N,C]=E.useState([]),[S,U]=E.useState([{id:1,searchQuery:"",selectedProduct:null}]),[te,Q]=E.useState(null),[D,K]=E.useState(!1),[W,oe]=E.useState(!1),[J,Y]=E.useState(new Set),[pe,de]=E.useState(""),G=E.useRef(null),ie=E.useRef(""),L=()=>{const A=Math.max(...S.map(T=>T.id))+1;U([...S,{id:A,searchQuery:"",selectedProduct:null}])},ne=A=>{S.length>1&&U(T=>T.filter(j=>j.id!==A))},O=()=>{console.log(" CreateReservationModal handleClose called"),a(null),l(null),f(""),p(""),g([]),w(null),C([]),U([{id:1,searchQuery:"",selectedProduct:null}]),Q(null),K(!1),oe(!1),Y(new Set),de(""),G.current=null,n()};E.useEffect(()=>{if(e){console.log(" CreateReservationModal opened - clearing state and generating number"),a(null),l(null),p(""),g([]),w(null),C([]),U([{id:1,searchQuery:"",selectedProduct:null}]),Q(null),K(!1),oe(!1),Y(new Set),de(""),G.current=null;const A=new Date,T=A.getDate().toString().padStart(2,"0"),j=(A.getMonth()+1).toString().padStart(2,"0"),R=A.getFullYear();console.log(" Fetching next reservation number from:",`${Ha}/api/reservations/next-number-only`),fetch(`${Ha}/api/reservations/next-number-only`).then(q=>{if(console.log(" Response status:",q.status),!q.ok)throw new Error(`HTTP error! status: ${q.status}`);return q.json()}).then(q=>{if(console.log(" Received data:",q),q.numer_rezerwacji){ie.current=q.numer_rezerwacji;const H=`${q.numer_rezerwacji}_${T}_${j}_${R}`;f(H),console.log(" Set reservation number to:",H)}else console.warn(" No numer_rezerwacji in response, using fallback"),ie.current="R001",f(`R001_${T}_${j}_${R}`)}).catch(q=>{console.error(" Error fetching next reservation number:",q),ie.current="R001",f(`R001_${T}_${j}_${R}`)})}else f(""),ie.current=""},[e]),E.useEffect(()=>{const T=setTimeout(async()=>{if(h.trim().length<2){g([]);return}k(!0);try{const j=await fetch(`${Ha}/api/clients/search?q=${encodeURIComponent(h)}`);if(!j.ok)throw new Error("Failed to fetch clients");const R=await j.json();g(R)}catch(j){console.error("Error searching clients:",j),g([])}finally{k(!1)}},300);return()=>clearTimeout(T)},[h]),E.useEffect(()=>{const T=setTimeout(async()=>{if(te===null||!S.find(j=>j.id===te)?.searchQuery.trim()){C([]);return}K(!0);try{const j=S.find(B=>B.id===te)?.searchQuery||"",R=await fetch(`${Ha}/api/working-sheets/search?query=${encodeURIComponent(j)}`);if(!R.ok)throw new Error("Failed to fetch products");const H=(await R.json()).map(B=>({kod:B.kod,nazwa:B.nazwa,ilosc:B.ilosc.toString(),kodKreskowy:B.kod_kreskowy||"",selectedQuantity:0,ilosc_reserved:B.ilosc_reserved||0}));C(H)}catch(j){console.error("Error searching products:",j),C([])}finally{K(!1)}},300);return()=>clearTimeout(T)},[S,te]),E.useEffect(()=>{if(ie.current)if(r){const A=r.getDate().toString().padStart(2,"0"),T=(r.getMonth()+1).toString().padStart(2,"0"),j=r.getFullYear(),R=`${ie.current}_${A}_${T}_${j}`;f(R)}else{const A=new Date,T=A.getDate().toString().padStart(2,"0"),j=(A.getMonth()+1).toString().padStart(2,"0"),R=A.getFullYear(),q=`${ie.current}_${T}_${j}_${R}`;f(q)}},[r]);const re=(A,T)=>{console.log(" handleProductSelect called for fieldId:",A,"product:",T.kod),U(j=>j.map(q=>q.id===A?{...q,selectedProduct:T,searchQuery:`${T.kod} - ${T.nazwa.includes(" (samples)")?T.nazwa.replace(" (samples)","")+" (samples)":T.nazwa}`}:q)),C([]),Q(null),console.log(" Products list cleared, activeSearchId reset")},M=()=>S.filter(A=>A.selectedProduct).reduce((A,T)=>{const j=T.selectedProduct?.selectedQuantity||0;return A+j},0),F=()=>{if(!r||!o||!v||!c.trim())return!1;const A=S.filter(T=>T.selectedProduct);return!(A.length===0||A.some(T=>!T.selectedProduct?.selectedQuantity||T.selectedProduct.selectedQuantity<=0)||J.size>0)},le=async()=>{const A=S.filter(T=>T.selectedProduct).map(T=>({product_kod:T.selectedProduct.kod,product_nazwa:T.selectedProduct.nazwa,kod_kreskowy:T.selectedProduct.kodKreskowy||"",ilosc:T.selectedProduct.selectedQuantity||0}));if(!r){He.error("Wybierz dat rezerwacji");return}if(!o){He.error("Wybierz dat zakoczenia rezerwacji");return}if(o<r){He.error("Data zakoczenia nie moe by wczeniejsza ni data rezerwacji");return}if(!v){He.error("Wybierz klienta");return}if(A.length===0){He.error("Dodaj produkty");return}if(A.some(T=>!T.ilosc||T.ilosc<=0)){He.error("Wprowad ilo dla wszystkich produktw");return}Y(new Set),oe(!0);try{const T=await fetch(`${Ha}/api/reservations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:v.id,numer_rezerwacji:c,data_utworzenia:r.toISOString().split("T")[0],data_zakonczenia:o.toISOString().split("T")[0],komentarz:pe.trim()||null,products:A})});if(!T.ok){const j=await T.text();let R="Failed to create reservation";try{const q=JSON.parse(j);R=q.details?.message||q.error||R}catch{console.error("Non-JSON error response when creating reservation:",j)}throw new Error(R)}He.success("Rezerwacja zostaa utworzona"),O(),t&&t()}catch(T){console.error("Error creating reservation:",T),He.error(T.message||"Wystpi bd podczas tworzenia rezerwacji")}finally{oe(!1)}};return u.jsx(rr,{isOpen:e,onRequestClose:O,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"visible",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie rezerwacji"}),u.jsx("button",{onClick:O,className:"text-red-500 focus:outline-none",children:u.jsx(_t,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx(wn,{selected:r,onChange:A=>a(A),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx(wn,{selected:o,onChange:A=>l(A),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:r||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:h,onChange:A=>{p(A.target.value),v&&w(null)},placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),b&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),m.length>0&&!v&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map(A=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{w(A),p(A.nazwa),g([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:A.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:A.firma})]})},A.id))}),v&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.firma})]}),u.jsx("button",{onClick:()=>{w(null),p("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(_t,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:pe,onChange:A=>de(A.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),S.map(A=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(la,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:A.searchQuery,onChange:T=>{const j=T.target.value;console.log(" Product search input changed for fieldId:",A.id,"value:",j),U(R=>R.map(q=>q.id===A.id?{...q,searchQuery:j,selectedProduct:null}:q)),Q(A.id)},onFocus:()=>Q(A.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-8",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:A.selectedProduct?.selectedQuantity||"",onChange:T=>{const j=T.target.value,R=j===""?0:Math.max(1,parseInt(j)||0);U(q=>{const H=q.map(fe=>fe.id===A.id&&fe.selectedProduct?{...fe,selectedProduct:{...fe.selectedProduct,selectedQuantity:R}}:fe);G.current=null;const B=H.find(fe=>fe.id===A.id);if(B?.selectedProduct){const fe=parseInt(B.selectedProduct.ilosc)||0,I=B.selectedProduct.ilosc_reserved||0,Fe=Math.max(0,fe-I);R===0?Y(Pe=>{const Qe=new Set(Pe);return Qe.delete(A.id),Qe}):R>Fe?(Y(Pe=>{const Qe=new Set(Pe);return Qe.add(A.id),Qe}),I>0?He.error(`Niewystarczajca ilo - dostpne: ${Fe} (na magazynie: ${fe}, z nich w rezerwacji: ${I})`):He.error(`Niewystarczajca ilo - dostpne: ${Fe} (na magazynie: ${fe})`)):Y(Pe=>{const Qe=new Set(Pe);return Qe.delete(A.id),Qe})}else Y(fe=>{const I=new Set(fe);return I.delete(A.id),I});return H})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${J.has(A.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),S.length>1&&u.jsx("button",{onClick:()=>ne(A.id),className:"ml-4 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(_t,{size:16})})]}),A.id===Math.max(...S.map(T=>T.id))&&u.jsx("button",{onClick:L,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),D&&te===A.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),N.length>0&&te===A.id&&!A.selectedProduct&&A.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:N.map((T,j)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>re(A.id,{...T,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.kod}),T.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:T.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:T.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",T.ilosc]}),(T.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",T.ilosc_reserved??0]})]})},`${T.kod}-${T.nazwa||""}-${j}`))})]},A.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:le,disabled:W||!F(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${W||!F()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:W?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:M()})]})]})})},hR=e=>(e(!0),!0);rr.setAppElement("#root");const xR=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
  }
`,Zt="";console.log("API_URL configured as:",Zt);function mR(){const[e,n]=E.useState(!1),[t,r]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[f,h]=E.useState(!1),[p,m]=E.useState(!1),[g,v]=E.useState(null),[w,b]=E.useState(null),[k,N]=E.useState(["inventory","clients","orders","inventoryStatus"]),[C,S]=E.useState(()=>{const me=localStorage.getItem("activeTab")||"inventory",Ae=localStorage.getItem("activeSubTab"),ze=["inventory","clients","orders","inventoryStatus"],Ze=["przyjecie","analiza","kalendarz","wydanie","rezerwacje","analiza_towarow","faktury"],rt=ze.includes(me)?me:"inventory";let se="przyjecie";rt==="orders"&&(se="wydanie");const ye=Ae&&Ze.includes(Ae)?Ae:se;return{sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:rt,activeSubTab:ye,isDbInitialized:!1}}),[U,te]=E.useState(!1),[Q,D]=E.useState(!1),[K,W]=E.useState(!1),[oe,J]=E.useState(!1),[Y,pe]=E.useState(!1),[de,G]=E.useState(null),[ie,L]=E.useState(!1),[ne,O]=E.useState(null),[re,M]=E.useState(0),[F,le]=E.useState(0),[A,T]=E.useState(0),[j,R]=E.useState([]),[q,H]=E.useState(!1),[B,fe]=E.useState(null),[I,Fe]=E.useState(null);E.useEffect(()=>{(async()=>{try{console.log(" Starting data loading process..."),console.log(" API_URL:",Zt),console.log(" Loading clients...");const Ae=await Xt();console.log(" Clients loaded:",Ae.length),console.log(" Loading products...");const ze=await Ct();console.log(" Products loaded:",ze.length),console.log(" Loading product receipts...");const Ze=await $t();console.log(" Product receipts loaded:",Ze.length),console.log(" Updating app state with loaded data..."),console.log(" Setting clients:",Ae),S(rt=>{const se={...rt,clients:Ae,products:ze,productReceipts:Ze};return console.log(" New app state:",se),se}),console.log(" App state updated successfully"),console.log(" Final data counts:"),console.log("   - Clients:",Ae.length),console.log("   - Products:",ze.length),console.log("   - Product Receipts:",Ze.length)}catch(Ae){console.error(" Error loading data:",Ae),He.error("Bd podczas adowania danych")}finally{console.log(" Data loading process completed")}})()},[]),E.useEffect(()=>{const me=document.createElement("style");return me.textContent=xR,document.head.appendChild(me),()=>{document.head.contains(me)&&document.head.removeChild(me)}},[]),E.useEffect(()=>{if(!C.isDbInitialized)return;console.log(" useEffect triggered - clients changed:",C.clients.length),(async()=>{const Ae={sheets:C.sheets,sheetsData:C.sheetsData,activeSheet:C.activeSheet,showTable:C.showTable,clients:C.clients,products:C.products,productReceipts:C.productReceipts};try{localStorage.setItem("appState",JSON.stringify(Ae)),console.log("App state saved to localStorage")}catch(ze){console.error("Error saving state to localStorage:",ze)}})()},[C.sheetsData,C.sheets,C.activeSheet,C.showTable,C.clients,C.products,C.productReceipts]);const Pe=async()=>{try{console.log(" Loading sheets from database..."),console.log(" Making request to:",`${Zt}/api/original-sheets`);const me=await fetch(`${Zt}/api/original-sheets`);if(console.log(" Sheets response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Ae=await me.json();console.log(" Received sheets from server:",Ae),console.log(" Sheets count:",Ae.length);const ze=Ae.map(Ze=>({fileName:Ze.fileName,data:{headers:Ze.data.headers,rows:Ze.data.rows}}));console.log(" Processed sheets:",ze),console.log(" Processed sheets count:",ze.length),S(Ze=>({...Ze,sheets:ze,sheetsData:ze,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log(" App state updated with sheets data")}catch(me){console.error("     :",me),He.error("    ")}finally{console.log(" Loading sheets completed")}};E.useEffect(()=>{Pe()},[]);const Qe=async(me,Ae)=>{console.log("handleExcelUpload called with:",{newFileName:me,fileData:Ae});try{const ze=await fetch(`${Zt}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:me,data:Ae})});if(!ze.ok){if(ze.status===409){He.error("Moe by tylko jeden plik Excel. Usu istniejcy plik przed zaadowaniem nowego.");return}throw new Error(`HTTP error! status: ${ze.status}`)}await Pe(),n(!1)}catch(ze){console.error("Error saving file data:",ze),He.error("Bd podczas zapisywania danych pliku")}},qe=me=>{const Ae=`${Zt}/api/download_file/${encodeURIComponent(me.fileName)}`;window.open(Ae,"_blank")},he=me=>{b(me)},ue=me=>{me.preventDefault()},we=me=>{!w||w===me||(N(Ae=>{const ze=[...Ae],Ze=ze.indexOf(w),rt=ze.indexOf(me);return ze.splice(Ze,1),ze.splice(rt,0,w),ze}),b(null))},ve=me=>{if(me==="inventory"||me==="clients"||me==="orders"||me==="inventoryStatus"){const Ae=me==="inventory"?"przyjecie":me==="orders"?"wydanie":null;localStorage.setItem("activeTab",me),Ae&&localStorage.setItem("activeSubTab",Ae),S(ze=>({...ze,activeTab:me,activeSubTab:Ae}))}},Oe=me=>{localStorage.setItem("activeSubTab",me),S(Ae=>({...Ae,activeSubTab:me}))};E.useEffect(()=>{C.activeSubTab==="analiza_towarow"&&dt()},[C.activeSubTab,A]);const lt=me=>{switch(me){case"inventory":return"Zakup towarw";case"clients":return"Klienci";case"orders":return"Sprzeda towarw";case"inventoryStatus":return"Stany magazynowe";default:return me}},ft=()=>{c(!1),n(!1)},gt=async me=>{try{console.log(" Starting handleAddProduct..."),console.log(" Received data:",me),console.log(" Files check:",{hasProductInvoice:!!me.productInvoice,hasTransportInvoice:!!me.transportInvoice,productInvoice:me.productInvoice,transportInvoice:me.transportInvoice}),console.log(" Making request to:",`${Zt}/api/product-receipts`);let Ae;if(me.productInvoice||me.transportInvoice){console.log(" Files detected, using FormData...");const rt=new FormData,se={date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,aktualnyKurs:me.aktualnyKurs,podatekAkcyzowy:me.podatekAkcyzowy,products:me.products};rt.append("data",JSON.stringify(se)),console.log(" JSON data:",se),me.productInvoice&&(rt.append("productInvoice",me.productInvoice),console.log(" Product invoice added:",me.productInvoice.name)),me.transportInvoice&&(rt.append("transportInvoice",me.transportInvoice),console.log(" Transport invoice added:",me.transportInvoice.name)),console.log(" FormData entries:");for(let[ye,De]of rt.entries())console.log(`  ${ye}:`,De);Ae=await fetch(`${Zt}/api/product-receipts`,{method:"POST",body:rt})}else{console.log(" No files, using JSON...");const rt={date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,aktualnyKurs:me.aktualnyKurs,podatekAkcyzowy:me.podatekAkcyzowy,products:me.products};console.log(" JSON data:",rt),Ae=await fetch(`${Zt}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)})}if(console.log(" Response status:",Ae.status),console.log(" Response headers:",Ae.headers),!Ae.ok){const rt=await Ae.text();throw console.error(" Response error text:",rt),new Error(`Failed to save product receipt: ${Ae.status} - ${rt}`)}const ze=await Ae.json();if(console.log(" Saved receipt:",ze),ze.workingSheetsUpdated||ze.workingSheetsInserted){let rt="Dodano nowy towar";ze.workingSheetsUpdated>0&&(rt+=` (${ze.workingSheetsUpdated}    working sheets)`),ze.workingSheetsInserted>0&&(rt+=` (${ze.workingSheetsInserted}     working sheets)`),He.success(rt)}else He.success("Dodano nowy towar");console.log(" Loading updated receipts...");const Ze=await $t();console.log(" Updated receipts:",Ze),console.log(" Updating app state..."),S(rt=>{const se={...rt,productReceipts:Ze};return console.log(" New app state:",se),se}),o(!1)}catch(Ae){console.error(" Error adding product:",Ae),He.error("Wystpi bd podczas dodawania towaru")}},Rt=async me=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",me),console.log(" Files check (update):",{hasProductInvoice:!!me.productInvoice,hasTransportInvoice:!!me.transportInvoice,productInvoice:me.productInvoice,transportInvoice:me.transportInvoice});try{let Ae;if(me.productInvoice||me.transportInvoice){console.log(" Files detected (update), using FormData...");const se=new FormData,ye={date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,products:me.products};se.append("data",JSON.stringify(ye)),console.log(" JSON data (update):",ye),me.productInvoice&&(se.append("productInvoice",me.productInvoice),console.log(" Product invoice added (update):",me.productInvoice.name)),me.transportInvoice&&(se.append("transportInvoice",me.transportInvoice),console.log(" Transport invoice added (update):",me.transportInvoice.name)),console.log(" FormData entries (update):");for(let[De,Re]of se.entries())console.log(`  ${De}:`,Re);Ae=await fetch(`${Zt}/api/product-receipts/${me.id}`,{method:"PUT",body:se})}else console.log(" No files (update), using JSON..."),Ae=await fetch(`${Zt}/api/product-receipts/${me.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,aktualnyKurs:me.aktualnyKurs,podatekAkcyzowy:me.podatekAkcyzowy,products:me.products})});if(!Ae.ok)throw new Error("Failed to update product receipt");const ze=await Ae.json();console.log("Updated receipt:",ze),console.log("Loading updated receipts...");const Ze=await $t();console.log("Updated receipts:",Ze),console.log("Loading updated products...");const rt=await Ct();console.log("Updated products:",rt),console.log("Updating app state..."),S(se=>{const ye={...se,productReceipts:Ze,products:rt};return console.log("New app state:",ye),ye}),He.success("Zakup zosta zaktualizowany"),pe(!1),G(null),h(!1),v(null)}catch(Ae){console.error("Error updating product receipt:",Ae),He.error("Wystpi bd podczas aktualizacji zakupu")}},Gt=async me=>{try{if(!(await fetch(`${Zt}/api/product-receipts/${me}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const ze=await $t(),Ze=await Ct();S(rt=>({...rt,productReceipts:ze,products:Ze})),He.success("Zakup zosta usunity")}catch(Ae){console.error("Error deleting receipt:",Ae),He.error("Wystpi bd podczas usuwania zakupu")}},cr=async me=>{try{const Ae=await fetch(`${Zt}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(!Ae.ok)throw new Error("Failed to add client");const ze=await Ae.json(),Ze={...me,id:ze.id};S(rt=>({...rt,clients:[...rt.clients,Ze]})),le(rt=>rt+1),He.success("Klient zosta dodany")}catch(Ae){console.error("Error adding client:",Ae),He.error("Bd podczas dodawania klienta")}},Lt=async me=>{try{if(!(await fetch(`${Zt}/api/clients/${me}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");S(ze=>({...ze,clients:ze.clients.filter(Ze=>Ze.id!==me)})),le(ze=>ze+1),He.success("Klient zosta usunity")}catch(Ae){console.error("Error deleting client:",Ae),He.error("Bd podczas usuwania klienta")}},Qt=async me=>{try{console.log(" handleUpdateClient called with data:",me);const Ae=await fetch(`${Zt}/api/clients/${me.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(!Ae.ok)throw new Error("Failed to update client");const ze=await Ae.json();console.log(" Client updated in database:",ze),console.log(" Updated client fields:",{id:ze.id,firma:ze.firma,nazwa:ze.nazwa,adres:ze.adres,czas_dostawy:ze.czas_dostawy,kontakt:ze.kontakt}),S(Ze=>{console.log(" Updating app state..."),console.log(" Previous clients:",Ze.clients),console.log(" Updated client data:",ze);const rt=Ze.clients.map(ye=>ye.id===me.id?(console.log(" Updating client:",ye.id,"from:",ye,"to:",{...ye,...ze}),{id:ye.id,firma:ze.firma||ye.firma,nazwa:ze.nazwa||ye.nazwa,adres:ze.adres||ye.adres,czas_dostawy:ze.czas_dostawy||ye.czas_dostawy,kontakt:ze.kontakt||ye.kontakt}):{...ye});console.log(" New clients array:",rt);const se={...Ze,clients:rt};return console.log(" New app state:",se),se}),He.success("Klient zosta zaktualizowany"),setTimeout(()=>{S(Ze=>(console.log(" Force update after timeout"),{...Ze})),le(Ze=>Ze+1),Fe(me.id),Xt().then(Ze=>{S(rt=>({...rt,clients:Ze})),le(rt=>rt+1)})},100)}catch(Ae){console.error("Error updating client:",Ae),He.error("Bd podczas aktualizacji klienta")}},dt=async()=>{try{H(!0),fe(null);const me=await fetch(`${Zt}/api/reservations/active-products`);if(!me.ok)throw new Error(`HTTP ${me.status}`);const Ae=await me.json();console.log(" Active reservation products loaded:",Ae.length),R(Ae)}catch(me){console.error(" Error loading analysis products:",me),fe(me.message||"Bd adowania danych")}finally{H(!1)}},Et=async me=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",me),console.log("Products data:",JSON.stringify(me.products,null,2));try{const Ae=await fetch(`${Zt}/api/orders/${me.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(!Ae.ok)throw new Error("Failed to update order");const ze=await Ae.json();console.log("Updated order result:",ze),He.success("Zamwienie zostao zaktualizowane"),M(Ze=>Ze+1)}catch(Ae){console.error("Error updating order:",Ae),He.error("Bd podczas aktualizacji zamwienia")}},Xt=async()=>{try{console.log(" Loading clients from:",`${Zt}/api/clients`);const me=await fetch(`${Zt}/api/clients`);if(console.log(" Clients response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Ae=await me.json();return console.log(" Loaded clients:",Ae.length,"records"),console.log(" First client:",Ae[0]),Ae}catch(me){return console.error(" Error loading clients:",me),[]}},Ct=async()=>{try{console.log(" Loading products from:",`${Zt}/api/products`);const me=await fetch(`${Zt}/api/products`);if(console.log(" Products response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Ae=await me.json();console.log(" Loaded products:",Ae.length,"records"),console.log(" First product:",Ae[0]);const ze=Ae.map(Ze=>({kod:Ze.kod,nazwa:Ze.nazwa,ilosc:Ze.ilosc,jednostka_miary:Ze.jednostka_miary||"",kod_kreskowy:Ze.kod_kreskowy||"",data_waznosci:Ze.data_waznosci??void 0,archiwalny:Ze.archiwalny,rezerwacje:Ze.rezerwacje,ilosc_na_poleceniach:Ze.ilosc_na_poleceniach,waga_netto:Ze.waga_netto,waga_brutto:Ze.waga_brutto,objetosc:Ze.objetosc,opis:Ze.opis}));return console.log(" Processed products:",ze.length,"records"),ze}catch(me){return console.error(" Error loading products:",me),[]}},$t=async()=>{try{console.log(" Loading product receipts from:",`${Zt}/api/product-receipts`);const me=await fetch(`${Zt}/api/product-receipts`);if(console.log(" Product receipts response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Ae=await me.json();return console.log(" Loaded product receipts:",Ae.length,"records"),Ae.map(ze=>({id:ze.id,dataPrzyjecia:ze.dataPrzyjecia,sprzedawca:ze.sprzedawca||"",wartosc:ze.wartosc||0,kosztDostawy:ze.kosztDostawy||0,aktualny_kurs:ze.aktualny_kurs,podatek_akcyzowy:ze.podatek_akcyzowy,aktualnyKurs:ze.aktualnyKurs,podatekAkcyzowy:ze.podatekAkcyzowy,products:ze.products||[],productInvoice:ze.productInvoice,transportInvoice:ze.transportInvoice}))}catch(me){return console.error(" Error loading product receipts:",me),[]}},Bt=async me=>{try{console.log(" Searching working_sheets with query:",me),console.log(" Making request to:",`${Zt}/api/working-sheets/search?query=${encodeURIComponent(me)}`);const Ae=await fetch(`${Zt}/api/working-sheets/search?query=${encodeURIComponent(me)}`);if(console.log(" Search response status:",Ae.status),!Ae.ok)throw new Error(`HTTP error! status: ${Ae.status}`);const ze=await Ae.json();return console.log(" Search results:",ze.length,"items found"),ze.map(rt=>({kod:rt.kod,nazwa:rt.nazwa,ilosc:rt.ilosc.toString(),kodKreskowy:rt.kod_kreskowy||""}))}catch(Ae){return console.error(" Error searching working_sheets:",Ae),[]}},Jr=()=>{M(me=>me+1)},en=()=>{M(me=>me+1)};return u.jsxs("div",{className:"min-h-screen bg-gray-100",children:[u.jsx(OO,{position:"top-right"}),u.jsx(gw,{isOpen:oe,onClose:()=>J(!1),product:null}),u.jsx(L4,{isOpen:e,onClose:()=>n(!1),onUpload:Qe}),u.jsx(B4,{isOpen:l,onClose:()=>c(!1),fileName:"",onConfirm:ft}),u.jsx(UA,{isOpen:a,onClose:()=>o(!1),onSubmit:gt}),u.jsx(rR,{isOpen:t,onClose:()=>r(!1),onAdd:cr}),u.jsx(ww,{isOpen:ie,onClose:()=>{L(!1),O(null)},onSubmit:Qt,client:ne}),u.jsx(vw,{isOpen:f,onClose:()=>h(!1),receipt:g}),u.jsx(yw,{isOpen:Y,onClose:()=>{pe(!1),G(null)},onSubmit:Rt,receipt:de}),u.jsx(RO,{isOpen:U,onClose:()=>te(!1),onOrderCreated:Jr}),u.jsx(dR,{isOpen:Q,onClose:()=>D(!1),onSubmit:en}),u.jsx(fR,{isOpen:K,onClose:()=>W(!1),onSubmit:()=>{W(!1),M(me=>me+1)}}),u.jsx(pR,{isOpen:p,onClose:()=>m(!1),onReservationCreated:()=>{T(me=>me+1),m(!1)},apiUrl:Zt}),u.jsx("div",{className:"bg-white shadow-sm",children:u.jsx("div",{className:"container mx-auto px-4 py-3",children:u.jsx("img",{src:tR,alt:"Enoterra Logo",className:"h-32"})})}),u.jsx("div",{className:"bg-gray-100",children:u.jsx("div",{className:"container mx-auto px-4",children:u.jsx("div",{className:"flex items-center h-14",children:u.jsx("div",{className:"flex space-x-4",children:k.map(me=>u.jsx("div",{draggable:!0,onDragStart:()=>he(me),onDragOver:ue,onDrop:()=>we(me),className:`relative -mb-px cursor-pointer ${C.activeTab===me?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${w===me?"opacity-50":""}`,onClick:()=>ve(me),children:u.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:lt(me)})},me))})})})}),u.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:u.jsx("div",{className:"container mx-auto px-4 py-6",children:u.jsxs("div",{className:"flex items-start -mt-2",children:[C.activeTab==="inventory"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>Oe("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjcie towarw"}),u.jsx("button",{onClick:()=>Oe("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupw"}),u.jsx("button",{onClick:()=>Oe("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz patnoci"})]}),C.activeSubTab==="przyjecie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>hR(n),children:[u.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:u.jsx(gb,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),u.jsx(nR,{receipts:C.productReceipts,onDelete:Gt,onUpdate:Rt})]}),C.activeSubTab==="analiza"&&u.jsx("div",{className:"flex flex-col gap-4",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupw"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupw bdzie dostpna wkrtce."})]})}),C.activeSubTab==="kalendarz"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz patnoci"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza patnoci bdzie dostpna wkrtce."})]})})]}),C.activeTab==="inventory"&&u.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:C.sheets.map(me=>u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("button",{onClick:()=>qe(me),title:":     ",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:me.fileName})},me.fileName))}),C.activeTab==="inventory"&&C.showTable&&C.activeSheet&&u.jsx("div",{className:"mt-6 bg-white",children:u.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:u.jsx($A,{data:C.activeSheet.data})})}),C.activeTab==="clients"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),u.jsx(sR,{clients:C.clients,onDelete:Lt,onUpdate:Qt},`clients-${F}-${I||"none"}`)]}),C.activeTab==="orders"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>Oe("wydanie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="wydanie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Wydanie towarw"}),u.jsx("button",{onClick:()=>Oe("rezerwacje"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="rezerwacje"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Rezerwacje"}),u.jsx("button",{onClick:()=>Oe("analiza_towarow"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="analiza_towarow"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza towarw"}),u.jsx("button",{onClick:()=>Oe("faktury"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="faktury"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Faktury"})]}),C.activeSubTab==="wydanie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsx("div",{className:"mb-4",children:u.jsx("div",{className:"w-1/2 mx-auto",children:u.jsx(HA,{onSearch:Bt})})}),u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>te(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>D(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:u.jsx(_t,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>W(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-orange-500 rounded-full flex items-center justify-center text-white",title:"Odpisanie",children:u.jsx(yb,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Odpisanie towaru"})})]})]}),u.jsx(BO,{onDeleteOrder:me=>{console.log("Delete order:",me)},onUpdateOrder:Et,refreshTrigger:re})]}),C.activeSubTab==="rezerwacje"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>m(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj rezerwacj"})})]})}),u.jsx($O,{refreshTrigger:A})]}),C.activeSubTab==="analiza_towarow"&&u.jsxs("div",{className:"space-y-4 mt-6",children:[q&&u.jsx("div",{className:"text-gray-600 font-sora text-sm",children:"adowanie danych..."}),B&&u.jsx("div",{className:"text-red-600 font-sora text-sm",children:B}),!q&&!B&&u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Kod"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Nazwa"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Pozostao"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Wydane"}),u.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Zarezerwowane"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.filter(me=>{const Ae=me.ilosc??0,ze=me.ilosc_wydane??0;return Ae-ze>0}).length>0?j.filter(me=>{const Ae=me.ilosc??0,ze=me.ilosc_wydane??0;return Ae-ze>0}).map((me,Ae)=>{const ze=me.ilosc??0,Ze=me.ilosc_wydane??0,rt=ze-Ze,se=me.product_kod??"",ye=me.product_nazwa??"",De=me.klienci||[];return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:se}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:ye}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center",children:u.jsx("span",{className:rt>0?"text-green-600 font-medium":"text-gray-400",children:rt})}),u.jsxs("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center text-red-600 cursor-pointer","data-tooltip-id":`wydane-tooltip-${me.product_kod}-${Ae}`,children:[Ze,Ze>0&&u.jsx(ti,{id:`wydane-tooltip-${me.product_kod}-${Ae}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:me.zamowienia_z_iloscia&&me.zamowienia_z_iloscia.length>0?me.zamowienia_z_iloscia.map((Re,$e)=>u.jsxs("div",{className:$e===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:Re.numer_zamowienia}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[Re.ilosc," szt"]})]},$e)):u.jsx("div",{children:"Brak danych o zamwieniach"})})})]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center cursor-pointer","data-tooltip-id":`zarezerwowane-tooltip-${me.product_kod}-${Ae}`,children:[ze,De.length>0&&u.jsx(ti,{id:`zarezerwowane-tooltip-${me.product_kod}-${Ae}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:De.map((Re,$e)=>u.jsxs("div",{className:$e===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:Re.klient||""}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[Re.ilosc??0," szt"]})]},$e))})})]})]},`${me.product_kod}-${Ae}`)}):u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak towarw w aktywnych rezerwacjach"})})})]})})]}),C.activeSubTab==="faktury"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Faktury"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja faktur bdzie dostpna wkrtce."})]})})]}),C.activeTab==="inventoryStatus"&&u.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:u.jsx(uR,{productReceipts:C.productReceipts})})]})})})]})}hb.createRoot(document.getElementById("root")).render(u.jsx(E.StrictMode,{children:u.jsx(mR,{})}));
