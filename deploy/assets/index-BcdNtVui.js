var l2=Object.defineProperty;var c2=(e,r,t)=>r in e?l2(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var Ae=(e,r,t)=>c2(e,typeof r!="symbol"?r+"":r,t);function u2(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();function r0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function f2(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var t=function n(){return this instanceof n?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),t}var sv={exports:{}},n0={},ov={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ll=Symbol.for("react.element"),d2=Symbol.for("react.portal"),p2=Symbol.for("react.fragment"),h2=Symbol.for("react.strict_mode"),m2=Symbol.for("react.profiler"),x2=Symbol.for("react.provider"),g2=Symbol.for("react.context"),v2=Symbol.for("react.forward_ref"),y2=Symbol.for("react.suspense"),w2=Symbol.for("react.memo"),k2=Symbol.for("react.lazy"),Yh=Symbol.iterator;function _2(e){return e===null||typeof e!="object"?null:(e=Yh&&e[Yh]||e["@@iterator"],typeof e=="function"?e:null)}var iv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lv=Object.assign,cv={};function li(e,r,t){this.props=e,this.context=r,this.refs=cv,this.updater=t||iv}li.prototype.isReactComponent={};li.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};li.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function uv(){}uv.prototype=li.prototype;function np(e,r,t){this.props=e,this.context=r,this.refs=cv,this.updater=t||iv}var ap=np.prototype=new uv;ap.constructor=np;lv(ap,li.prototype);ap.isPureReactComponent=!0;var Vh=Array.isArray,fv=Object.prototype.hasOwnProperty,sp={current:null},dv={key:!0,ref:!0,__self:!0,__source:!0};function pv(e,r,t){var n,a={},s=null,o=null;if(r!=null)for(n in r.ref!==void 0&&(o=r.ref),r.key!==void 0&&(s=""+r.key),r)fv.call(r,n)&&!dv.hasOwnProperty(n)&&(a[n]=r[n]);var i=arguments.length-2;if(i===1)a.children=t;else if(1<i){for(var l=Array(i),c=0;c<i;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in i=e.defaultProps,i)a[n]===void 0&&(a[n]=i[n]);return{$$typeof:Ll,type:e,key:s,ref:o,props:a,_owner:sp.current}}function b2(e,r){return{$$typeof:Ll,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function op(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ll}function E2(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(t){return r[t]})}var Kh=/\/+/g;function I0(e,r){return typeof e=="object"&&e!==null&&e.key!=null?E2(""+e.key):r.toString(36)}function Lc(e,r,t,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ll:case d2:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+I0(o,0):n,Vh(a)?(t="",e!=null&&(t=e.replace(Kh,"$&/")+"/"),Lc(a,r,t,"",function(c){return c})):a!=null&&(op(a)&&(a=b2(a,t+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Kh,"$&/")+"/")+e)),r.push(a)),1;if(o=0,n=n===""?".":n+":",Vh(e))for(var i=0;i<e.length;i++){s=e[i];var l=n+I0(s,i);o+=Lc(s,r,t,l,a)}else if(l=_2(e),typeof l=="function")for(e=l.call(e),i=0;!(s=e.next()).done;)s=s.value,l=n+I0(s,i++),o+=Lc(s,r,t,l,a);else if(s==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return o}function nc(e,r,t){if(e==null)return e;var n=[],a=0;return Lc(e,n,"","",function(s){return r.call(t,s,a++)}),n}function S2(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var Wr={current:null},zc={transition:null},T2={ReactCurrentDispatcher:Wr,ReactCurrentBatchConfig:zc,ReactCurrentOwner:sp};function hv(){throw Error("act(...) is not supported in production builds of React.")}Qe.Children={map:nc,forEach:function(e,r,t){nc(e,function(){r.apply(this,arguments)},t)},count:function(e){var r=0;return nc(e,function(){r++}),r},toArray:function(e){return nc(e,function(r){return r})||[]},only:function(e){if(!op(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Qe.Component=li;Qe.Fragment=p2;Qe.Profiler=m2;Qe.PureComponent=np;Qe.StrictMode=h2;Qe.Suspense=y2;Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T2;Qe.act=hv;Qe.cloneElement=function(e,r,t){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=lv({},e.props),a=e.key,s=e.ref,o=e._owner;if(r!=null){if(r.ref!==void 0&&(s=r.ref,o=sp.current),r.key!==void 0&&(a=""+r.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(l in r)fv.call(r,l)&&!dv.hasOwnProperty(l)&&(n[l]=r[l]===void 0&&i!==void 0?i[l]:r[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){i=Array(l);for(var c=0;c<l;c++)i[c]=arguments[c+2];n.children=i}return{$$typeof:Ll,type:e.type,key:a,ref:s,props:n,_owner:o}};Qe.createContext=function(e){return e={$$typeof:g2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:x2,_context:e},e.Consumer=e};Qe.createElement=pv;Qe.createFactory=function(e){var r=pv.bind(null,e);return r.type=e,r};Qe.createRef=function(){return{current:null}};Qe.forwardRef=function(e){return{$$typeof:v2,render:e}};Qe.isValidElement=op;Qe.lazy=function(e){return{$$typeof:k2,_payload:{_status:-1,_result:e},_init:S2}};Qe.memo=function(e,r){return{$$typeof:w2,type:e,compare:r===void 0?null:r}};Qe.startTransition=function(e){var r=zc.transition;zc.transition={};try{e()}finally{zc.transition=r}};Qe.unstable_act=hv;Qe.useCallback=function(e,r){return Wr.current.useCallback(e,r)};Qe.useContext=function(e){return Wr.current.useContext(e)};Qe.useDebugValue=function(){};Qe.useDeferredValue=function(e){return Wr.current.useDeferredValue(e)};Qe.useEffect=function(e,r){return Wr.current.useEffect(e,r)};Qe.useId=function(){return Wr.current.useId()};Qe.useImperativeHandle=function(e,r,t){return Wr.current.useImperativeHandle(e,r,t)};Qe.useInsertionEffect=function(e,r){return Wr.current.useInsertionEffect(e,r)};Qe.useLayoutEffect=function(e,r){return Wr.current.useLayoutEffect(e,r)};Qe.useMemo=function(e,r){return Wr.current.useMemo(e,r)};Qe.useReducer=function(e,r,t){return Wr.current.useReducer(e,r,t)};Qe.useRef=function(e){return Wr.current.useRef(e)};Qe.useState=function(e){return Wr.current.useState(e)};Qe.useSyncExternalStore=function(e,r,t){return Wr.current.useSyncExternalStore(e,r,t)};Qe.useTransition=function(){return Wr.current.useTransition()};Qe.version="18.3.1";ov.exports=Qe;var S=ov.exports;const fe=r0(S),mv=u2({__proto__:null,default:fe},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C2=S,D2=Symbol.for("react.element"),N2=Symbol.for("react.fragment"),F2=Object.prototype.hasOwnProperty,A2=C2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,O2={key:!0,ref:!0,__self:!0,__source:!0};function xv(e,r,t){var n,a={},s=null,o=null;t!==void 0&&(s=""+t),r.key!==void 0&&(s=""+r.key),r.ref!==void 0&&(o=r.ref);for(n in r)F2.call(r,n)&&!O2.hasOwnProperty(n)&&(a[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps,r)a[n]===void 0&&(a[n]=r[n]);return{$$typeof:D2,type:e,key:s,ref:o,props:a,_owner:A2.current}}n0.Fragment=N2;n0.jsx=xv;n0.jsxs=xv;sv.exports=n0;var f=sv.exports,gv={exports:{}},nn={},vv={exports:{}},yv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(q,N){var U=q.length;q.push(N);e:for(;0<U;){var Z=U-1>>>1,_=q[Z];if(0<a(_,N))q[Z]=N,q[U]=_,U=Z;else break e}}function t(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var N=q[0],U=q.pop();if(U!==N){q[0]=U;e:for(var Z=0,_=q.length,P=_>>>1;Z<P;){var A=2*(Z+1)-1,z=q[A],Q=A+1,re=q[Q];if(0>a(z,U))Q<_&&0>a(re,z)?(q[Z]=re,q[Q]=U,Z=Q):(q[Z]=z,q[A]=U,Z=A);else if(Q<_&&0>a(re,U))q[Z]=re,q[Q]=U,Z=Q;else break e}}return N}function a(q,N){var U=q.sortIndex-N.sortIndex;return U!==0?U:q.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,i=o.now();e.unstable_now=function(){return o.now()-i}}var l=[],c=[],u=1,d=null,p=3,h=!1,x=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(q){for(var N=t(c);N!==null;){if(N.callback===null)n(c);else if(N.startTime<=q)n(c),N.sortIndex=N.expirationTime,r(l,N);else break;N=t(c)}}function b(q){if(m=!1,v(q),!x)if(t(l)!==null)x=!0,ne(M);else{var N=t(c);N!==null&&B(b,N.startTime-q)}}function M(q,N){x=!1,m&&(m=!1,g(F),F=-1),h=!0;var U=p;try{for(v(N),d=t(l);d!==null&&(!(d.expirationTime>N)||q&&!V());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,p=d.priorityLevel;var _=Z(d.expirationTime<=N);N=e.unstable_now(),typeof _=="function"?d.callback=_:d===t(l)&&n(l),v(N)}else n(l);d=t(l)}if(d!==null)var P=!0;else{var A=t(c);A!==null&&B(b,A.startTime-N),P=!1}return P}finally{d=null,p=U,h=!1}}var C=!1,k=null,F=-1,E=5,j=-1;function V(){return!(e.unstable_now()-j<E)}function W(){if(k!==null){var q=e.unstable_now();j=q;var N=!0;try{N=k(!0,q)}finally{N?te():(C=!1,k=null)}}else C=!1}var te;if(typeof w=="function")te=function(){w(W)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,J=ee.port2;ee.port1.onmessage=W,te=function(){J.postMessage(null)}}else te=function(){y(W,0)};function ne(q){k=q,C||(C=!0,te())}function B(q,N){F=y(function(){q(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){x||h||(x=!0,ne(M))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return t(l)},e.unstable_next=function(q){switch(p){case 1:case 2:case 3:var N=3;break;default:N=p}var U=p;p=N;try{return q()}finally{p=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,N){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var U=p;p=q;try{return N()}finally{p=U}},e.unstable_scheduleCallback=function(q,N,U){var Z=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?Z+U:Z):U=Z,q){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=U+_,q={id:u++,callback:N,priorityLevel:q,startTime:U,expirationTime:_,sortIndex:-1},U>Z?(q.sortIndex=U,r(c,q),t(l)===null&&q===t(c)&&(m?(g(F),F=-1):m=!0,B(b,U-Z))):(q.sortIndex=_,r(l,q),x||h||(x=!0,ne(M))),q},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(q){var N=p;return function(){var U=p;p=N;try{return q.apply(this,arguments)}finally{p=U}}}})(yv);vv.exports=yv;var P2=vv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M2=S,tn=P2;function ke(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)r+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wv=new Set,cl={};function ro(e,r){Yo(e,r),Yo(e+"Capture",r)}function Yo(e,r){for(cl[e]=r,e=0;e<r.length;e++)wv.add(r[e])}var Da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mf=Object.prototype.hasOwnProperty,R2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gh={},Xh={};function I2(e){return Mf.call(Xh,e)?!0:Mf.call(Gh,e)?!1:R2.test(e)?Xh[e]=!0:(Gh[e]=!0,!1)}function j2(e,r,t,n){if(t!==null&&t.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function L2(e,r,t,n){if(r===null||typeof r>"u"||j2(e,r,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function Ur(e,r,t,n,a,s,o){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=t,this.propertyName=e,this.type=r,this.sanitizeURL=s,this.removeEmptyString=o}var hr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){hr[e]=new Ur(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];hr[r]=new Ur(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){hr[e]=new Ur(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){hr[e]=new Ur(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){hr[e]=new Ur(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){hr[e]=new Ur(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){hr[e]=new Ur(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){hr[e]=new Ur(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){hr[e]=new Ur(e,5,!1,e.toLowerCase(),null,!1,!1)});var ip=/[\-:]([a-z])/g;function lp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(ip,lp);hr[r]=new Ur(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(ip,lp);hr[r]=new Ur(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(ip,lp);hr[r]=new Ur(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){hr[e]=new Ur(e,1,!1,e.toLowerCase(),null,!1,!1)});hr.xlinkHref=new Ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){hr[e]=new Ur(e,1,!1,e.toLowerCase(),null,!0,!0)});function cp(e,r,t,n){var a=hr.hasOwnProperty(r)?hr[r]:null;(a!==null?a.type!==0:n||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(L2(r,t,a,n)&&(t=null),n||a===null?I2(r)&&(t===null?e.removeAttribute(r):e.setAttribute(r,""+t)):a.mustUseProperty?e[a.propertyName]=t===null?a.type===3?!1:"":t:(r=a.attributeName,n=a.attributeNamespace,t===null?e.removeAttribute(r):(a=a.type,t=a===3||a===4&&t===!0?"":""+t,n?e.setAttributeNS(n,r,t):e.setAttribute(r,t))))}var Ma=M2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ac=Symbol.for("react.element"),yo=Symbol.for("react.portal"),wo=Symbol.for("react.fragment"),up=Symbol.for("react.strict_mode"),Rf=Symbol.for("react.profiler"),kv=Symbol.for("react.provider"),_v=Symbol.for("react.context"),fp=Symbol.for("react.forward_ref"),If=Symbol.for("react.suspense"),jf=Symbol.for("react.suspense_list"),dp=Symbol.for("react.memo"),Ba=Symbol.for("react.lazy"),bv=Symbol.for("react.offscreen"),Qh=Symbol.iterator;function _i(e){return e===null||typeof e!="object"?null:(e=Qh&&e[Qh]||e["@@iterator"],typeof e=="function"?e:null)}var It=Object.assign,j0;function Oi(e){if(j0===void 0)try{throw Error()}catch(t){var r=t.stack.trim().match(/\n( *(at )?)/);j0=r&&r[1]||""}return`
`+j0+e}var L0=!1;function z0(e,r){if(!e||L0)return"";L0=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(c){var n=c}Reflect.construct(e,[],r)}else{try{r.call()}catch(c){n=c}e.call(r.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,i=s.length-1;1<=o&&0<=i&&a[o]!==s[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==s[i]){if(o!==1||i!==1)do if(o--,i--,0>i||a[o]!==s[i]){var l=`
`+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=i);break}}}finally{L0=!1,Error.prepareStackTrace=t}return(e=e?e.displayName||e.name:"")?Oi(e):""}function z2(e){switch(e.tag){case 5:return Oi(e.type);case 16:return Oi("Lazy");case 13:return Oi("Suspense");case 19:return Oi("SuspenseList");case 0:case 2:case 15:return e=z0(e.type,!1),e;case 11:return e=z0(e.type.render,!1),e;case 1:return e=z0(e.type,!0),e;default:return""}}function Lf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case wo:return"Fragment";case yo:return"Portal";case Rf:return"Profiler";case up:return"StrictMode";case If:return"Suspense";case jf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _v:return(e.displayName||"Context")+".Consumer";case kv:return(e._context.displayName||"Context")+".Provider";case fp:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case dp:return r=e.displayName||null,r!==null?r:Lf(e.type)||"Memo";case Ba:r=e._payload,e=e._init;try{return Lf(e(r))}catch{}}return null}function B2(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lf(r);case 8:return r===up?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function cs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ev(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function W2(e){var r=Ev(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),n=""+e[r];if(!e.hasOwnProperty(r)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var a=t.get,s=t.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,r,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function sc(e){e._valueTracker||(e._valueTracker=W2(e))}function Sv(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var t=r.getValue(),n="";return e&&(n=Ev(e)?e.checked?"true":"false":e.value),e=n,e!==t?(r.setValue(e),!0):!1}function nu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zf(e,r){var t=r.checked;return It({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??e._wrapperState.initialChecked})}function qh(e,r){var t=r.defaultValue==null?"":r.defaultValue,n=r.checked!=null?r.checked:r.defaultChecked;t=cs(r.value!=null?r.value:t),e._wrapperState={initialChecked:n,initialValue:t,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function Tv(e,r){r=r.checked,r!=null&&cp(e,"checked",r,!1)}function Bf(e,r){Tv(e,r);var t=cs(r.value),n=r.type;if(t!=null)n==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+t):e.value!==""+t&&(e.value=""+t);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?Wf(e,r.type,t):r.hasOwnProperty("defaultValue")&&Wf(e,r.type,cs(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function Zh(e,r,t){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var n=r.type;if(!(n!=="submit"&&n!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,t||r===e.value||(e.value=r),e.defaultValue=r}t=e.name,t!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,t!==""&&(e.name=t)}function Wf(e,r,t){(r!=="number"||nu(e.ownerDocument)!==e)&&(t==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+t&&(e.defaultValue=""+t))}var Pi=Array.isArray;function Po(e,r,t,n){if(e=e.options,r){r={};for(var a=0;a<t.length;a++)r["$"+t[a]]=!0;for(t=0;t<e.length;t++)a=r.hasOwnProperty("$"+e[t].value),e[t].selected!==a&&(e[t].selected=a),a&&n&&(e[t].defaultSelected=!0)}else{for(t=""+cs(t),r=null,a=0;a<e.length;a++){if(e[a].value===t){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}r!==null||e[a].disabled||(r=e[a])}r!==null&&(r.selected=!0)}}function Uf(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(ke(91));return It({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Jh(e,r){var t=r.value;if(t==null){if(t=r.children,r=r.defaultValue,t!=null){if(r!=null)throw Error(ke(92));if(Pi(t)){if(1<t.length)throw Error(ke(93));t=t[0]}r=t}r==null&&(r=""),t=r}e._wrapperState={initialValue:cs(t)}}function Cv(e,r){var t=cs(r.value),n=cs(r.defaultValue);t!=null&&(t=""+t,t!==e.value&&(e.value=t),r.defaultValue==null&&e.defaultValue!==t&&(e.defaultValue=t)),n!=null&&(e.defaultValue=""+n)}function em(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function Dv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $f(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?Dv(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var oc,Nv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,t,n,a){MSApp.execUnsafeLocalFunction(function(){return e(r,t,n,a)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(oc=oc||document.createElement("div"),oc.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=oc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function ul(e,r){if(r){var t=e.firstChild;if(t&&t===e.lastChild&&t.nodeType===3){t.nodeValue=r;return}}e.textContent=r}var Ui={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U2=["Webkit","ms","Moz","O"];Object.keys(Ui).forEach(function(e){U2.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),Ui[r]=Ui[e]})});function Fv(e,r,t){return r==null||typeof r=="boolean"||r===""?"":t||typeof r!="number"||r===0||Ui.hasOwnProperty(e)&&Ui[e]?(""+r).trim():r+"px"}function Av(e,r){e=e.style;for(var t in r)if(r.hasOwnProperty(t)){var n=t.indexOf("--")===0,a=Fv(t,r[t],n);t==="float"&&(t="cssFloat"),n?e.setProperty(t,a):e[t]=a}}var $2=It({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hf(e,r){if(r){if($2[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(ke(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(ke(61))}if(r.style!=null&&typeof r.style!="object")throw Error(ke(62))}}function Yf(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vf=null;function pp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kf=null,Mo=null,Ro=null;function tm(e){if(e=Wl(e)){if(typeof Kf!="function")throw Error(ke(280));var r=e.stateNode;r&&(r=l0(r),Kf(e.stateNode,e.type,r))}}function Ov(e){Mo?Ro?Ro.push(e):Ro=[e]:Mo=e}function Pv(){if(Mo){var e=Mo,r=Ro;if(Ro=Mo=null,tm(e),r)for(e=0;e<r.length;e++)tm(r[e])}}function Mv(e,r){return e(r)}function Rv(){}var B0=!1;function Iv(e,r,t){if(B0)return e(r,t);B0=!0;try{return Mv(e,r,t)}finally{B0=!1,(Mo!==null||Ro!==null)&&(Rv(),Pv())}}function fl(e,r){var t=e.stateNode;if(t===null)return null;var n=l0(t);if(n===null)return null;t=n[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(t&&typeof t!="function")throw Error(ke(231,r,typeof t));return t}var Gf=!1;if(Da)try{var bi={};Object.defineProperty(bi,"passive",{get:function(){Gf=!0}}),window.addEventListener("test",bi,bi),window.removeEventListener("test",bi,bi)}catch{Gf=!1}function H2(e,r,t,n,a,s,o,i,l){var c=Array.prototype.slice.call(arguments,3);try{r.apply(t,c)}catch(u){this.onError(u)}}var $i=!1,au=null,su=!1,Xf=null,Y2={onError:function(e){$i=!0,au=e}};function V2(e,r,t,n,a,s,o,i,l){$i=!1,au=null,H2.apply(Y2,arguments)}function K2(e,r,t,n,a,s,o,i,l){if(V2.apply(this,arguments),$i){if($i){var c=au;$i=!1,au=null}else throw Error(ke(198));su||(su=!0,Xf=c)}}function no(e){var r=e,t=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(t=r.return),e=r.return;while(e)}return r.tag===3?t:null}function jv(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function rm(e){if(no(e)!==e)throw Error(ke(188))}function G2(e){var r=e.alternate;if(!r){if(r=no(e),r===null)throw Error(ke(188));return r!==e?null:e}for(var t=e,n=r;;){var a=t.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){t=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===t)return rm(a),e;if(s===n)return rm(a),r;s=s.sibling}throw Error(ke(188))}if(t.return!==n.return)t=a,n=s;else{for(var o=!1,i=a.child;i;){if(i===t){o=!0,t=a,n=s;break}if(i===n){o=!0,n=a,t=s;break}i=i.sibling}if(!o){for(i=s.child;i;){if(i===t){o=!0,t=s,n=a;break}if(i===n){o=!0,n=s,t=a;break}i=i.sibling}if(!o)throw Error(ke(189))}}if(t.alternate!==n)throw Error(ke(190))}if(t.tag!==3)throw Error(ke(188));return t.stateNode.current===t?e:r}function Lv(e){return e=G2(e),e!==null?zv(e):null}function zv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=zv(e);if(r!==null)return r;e=e.sibling}return null}var Bv=tn.unstable_scheduleCallback,nm=tn.unstable_cancelCallback,X2=tn.unstable_shouldYield,Q2=tn.unstable_requestPaint,$t=tn.unstable_now,q2=tn.unstable_getCurrentPriorityLevel,hp=tn.unstable_ImmediatePriority,Wv=tn.unstable_UserBlockingPriority,ou=tn.unstable_NormalPriority,Z2=tn.unstable_LowPriority,Uv=tn.unstable_IdlePriority,a0=null,ra=null;function J2(e){if(ra&&typeof ra.onCommitFiberRoot=="function")try{ra.onCommitFiberRoot(a0,e,void 0,(e.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:r_,e_=Math.log,t_=Math.LN2;function r_(e){return e>>>=0,e===0?32:31-(e_(e)/t_|0)|0}var ic=64,lc=4194304;function Mi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function iu(e,r){var t=e.pendingLanes;if(t===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,o=t&268435455;if(o!==0){var i=o&~a;i!==0?n=Mi(i):(s&=o,s!==0&&(n=Mi(s)))}else o=t&~a,o!==0?n=Mi(o):s!==0&&(n=Mi(s));if(n===0)return 0;if(r!==0&&r!==n&&!(r&a)&&(a=n&-n,s=r&-r,a>=s||a===16&&(s&4194240)!==0))return r;if(n&4&&(n|=t&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=n;0<r;)t=31-Pn(r),a=1<<t,n|=e[t],r&=~a;return n}function n_(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function a_(e,r){for(var t=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Pn(s),i=1<<o,l=a[o];l===-1?(!(i&t)||i&n)&&(a[o]=n_(i,r)):l<=r&&(e.expiredLanes|=i),s&=~i}}function Qf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $v(){var e=ic;return ic<<=1,!(ic&4194240)&&(ic=64),e}function W0(e){for(var r=[],t=0;31>t;t++)r.push(e);return r}function zl(e,r,t){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Pn(r),e[r]=t}function s_(e,r){var t=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<t;){var a=31-Pn(t),s=1<<a;r[a]=0,n[a]=-1,e[a]=-1,t&=~s}}function mp(e,r){var t=e.entangledLanes|=r;for(e=e.entanglements;t;){var n=31-Pn(t),a=1<<n;a&r|e[n]&r&&(e[n]|=r),t&=~a}}var mt=0;function Hv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Yv,xp,Vv,Kv,Gv,qf=!1,cc=[],Za=null,Ja=null,es=null,dl=new Map,pl=new Map,Ua=[],o_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function am(e,r){switch(e){case"focusin":case"focusout":Za=null;break;case"dragenter":case"dragleave":Ja=null;break;case"mouseover":case"mouseout":es=null;break;case"pointerover":case"pointerout":dl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":pl.delete(r.pointerId)}}function Ei(e,r,t,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:r,domEventName:t,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},r!==null&&(r=Wl(r),r!==null&&xp(r)),e):(e.eventSystemFlags|=n,r=e.targetContainers,a!==null&&r.indexOf(a)===-1&&r.push(a),e)}function i_(e,r,t,n,a){switch(r){case"focusin":return Za=Ei(Za,e,r,t,n,a),!0;case"dragenter":return Ja=Ei(Ja,e,r,t,n,a),!0;case"mouseover":return es=Ei(es,e,r,t,n,a),!0;case"pointerover":var s=a.pointerId;return dl.set(s,Ei(dl.get(s)||null,e,r,t,n,a)),!0;case"gotpointercapture":return s=a.pointerId,pl.set(s,Ei(pl.get(s)||null,e,r,t,n,a)),!0}return!1}function Xv(e){var r=Cs(e.target);if(r!==null){var t=no(r);if(t!==null){if(r=t.tag,r===13){if(r=jv(t),r!==null){e.blockedOn=r,Gv(e.priority,function(){Vv(t)});return}}else if(r===3&&t.stateNode.current.memoizedState.isDehydrated){e.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bc(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var t=Zf(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(t===null){t=e.nativeEvent;var n=new t.constructor(t.type,t);Vf=n,t.target.dispatchEvent(n),Vf=null}else return r=Wl(t),r!==null&&xp(r),e.blockedOn=t,!1;r.shift()}return!0}function sm(e,r,t){Bc(e)&&t.delete(r)}function l_(){qf=!1,Za!==null&&Bc(Za)&&(Za=null),Ja!==null&&Bc(Ja)&&(Ja=null),es!==null&&Bc(es)&&(es=null),dl.forEach(sm),pl.forEach(sm)}function Si(e,r){e.blockedOn===r&&(e.blockedOn=null,qf||(qf=!0,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,l_)))}function hl(e){function r(a){return Si(a,e)}if(0<cc.length){Si(cc[0],e);for(var t=1;t<cc.length;t++){var n=cc[t];n.blockedOn===e&&(n.blockedOn=null)}}for(Za!==null&&Si(Za,e),Ja!==null&&Si(Ja,e),es!==null&&Si(es,e),dl.forEach(r),pl.forEach(r),t=0;t<Ua.length;t++)n=Ua[t],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ua.length&&(t=Ua[0],t.blockedOn===null);)Xv(t),t.blockedOn===null&&Ua.shift()}var Io=Ma.ReactCurrentBatchConfig,lu=!0;function c_(e,r,t,n){var a=mt,s=Io.transition;Io.transition=null;try{mt=1,gp(e,r,t,n)}finally{mt=a,Io.transition=s}}function u_(e,r,t,n){var a=mt,s=Io.transition;Io.transition=null;try{mt=4,gp(e,r,t,n)}finally{mt=a,Io.transition=s}}function gp(e,r,t,n){if(lu){var a=Zf(e,r,t,n);if(a===null)q0(e,r,n,cu,t),am(e,n);else if(i_(a,e,r,t,n))n.stopPropagation();else if(am(e,n),r&4&&-1<o_.indexOf(e)){for(;a!==null;){var s=Wl(a);if(s!==null&&Yv(s),s=Zf(e,r,t,n),s===null&&q0(e,r,n,cu,t),s===a)break;a=s}a!==null&&n.stopPropagation()}else q0(e,r,n,null,t)}}var cu=null;function Zf(e,r,t,n){if(cu=null,e=pp(n),e=Cs(e),e!==null)if(r=no(e),r===null)e=null;else if(t=r.tag,t===13){if(e=jv(r),e!==null)return e;e=null}else if(t===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return cu=e,null}function Qv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(q2()){case hp:return 1;case Wv:return 4;case ou:case Z2:return 16;case Uv:return 536870912;default:return 16}default:return 16}}var Va=null,vp=null,Wc=null;function qv(){if(Wc)return Wc;var e,r=vp,t=r.length,n,a="value"in Va?Va.value:Va.textContent,s=a.length;for(e=0;e<t&&r[e]===a[e];e++);var o=t-e;for(n=1;n<=o&&r[t-n]===a[s-n];n++);return Wc=a.slice(e,1<n?1-n:void 0)}function Uc(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function uc(){return!0}function om(){return!1}function an(e){function r(t,n,a,s,o){this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?uc:om,this.isPropagationStopped=om,this}return It(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=uc)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=uc)},persist:function(){},isPersistent:uc}),r}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yp=an(ci),Bl=It({},ci,{view:0,detail:0}),f_=an(Bl),U0,$0,Ti,s0=It({},Bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ti&&(Ti&&e.type==="mousemove"?(U0=e.screenX-Ti.screenX,$0=e.screenY-Ti.screenY):$0=U0=0,Ti=e),U0)},movementY:function(e){return"movementY"in e?e.movementY:$0}}),im=an(s0),d_=It({},s0,{dataTransfer:0}),p_=an(d_),h_=It({},Bl,{relatedTarget:0}),H0=an(h_),m_=It({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),x_=an(m_),g_=It({},ci,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),v_=an(g_),y_=It({},ci,{data:0}),lm=an(y_),w_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},k_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},__={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b_(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=__[e])?!!r[e]:!1}function wp(){return b_}var E_=It({},Bl,{key:function(e){if(e.key){var r=w_[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=Uc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?k_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wp,charCode:function(e){return e.type==="keypress"?Uc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Uc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),S_=an(E_),T_=It({},s0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cm=an(T_),C_=It({},Bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wp}),D_=an(C_),N_=It({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),F_=an(N_),A_=It({},s0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),O_=an(A_),P_=[9,13,27,32],kp=Da&&"CompositionEvent"in window,Hi=null;Da&&"documentMode"in document&&(Hi=document.documentMode);var M_=Da&&"TextEvent"in window&&!Hi,Zv=Da&&(!kp||Hi&&8<Hi&&11>=Hi),um=" ",fm=!1;function Jv(e,r){switch(e){case"keyup":return P_.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ko=!1;function R_(e,r){switch(e){case"compositionend":return e1(r);case"keypress":return r.which!==32?null:(fm=!0,um);case"textInput":return e=r.data,e===um&&fm?null:e;default:return null}}function I_(e,r){if(ko)return e==="compositionend"||!kp&&Jv(e,r)?(e=qv(),Wc=vp=Va=null,ko=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Zv&&r.locale!=="ko"?null:r.data;default:return null}}var j_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dm(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!j_[e.type]:r==="textarea"}function t1(e,r,t,n){Ov(n),r=uu(r,"onChange"),0<r.length&&(t=new yp("onChange","change",null,t,n),e.push({event:t,listeners:r}))}var Yi=null,ml=null;function L_(e){d1(e,0)}function o0(e){var r=Eo(e);if(Sv(r))return e}function z_(e,r){if(e==="change")return r}var r1=!1;if(Da){var Y0;if(Da){var V0="oninput"in document;if(!V0){var pm=document.createElement("div");pm.setAttribute("oninput","return;"),V0=typeof pm.oninput=="function"}Y0=V0}else Y0=!1;r1=Y0&&(!document.documentMode||9<document.documentMode)}function hm(){Yi&&(Yi.detachEvent("onpropertychange",n1),ml=Yi=null)}function n1(e){if(e.propertyName==="value"&&o0(ml)){var r=[];t1(r,ml,e,pp(e)),Iv(L_,r)}}function B_(e,r,t){e==="focusin"?(hm(),Yi=r,ml=t,Yi.attachEvent("onpropertychange",n1)):e==="focusout"&&hm()}function W_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return o0(ml)}function U_(e,r){if(e==="click")return o0(r)}function $_(e,r){if(e==="input"||e==="change")return o0(r)}function H_(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Ln=typeof Object.is=="function"?Object.is:H_;function xl(e,r){if(Ln(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var a=t[n];if(!Mf.call(r,a)||!Ln(e[a],r[a]))return!1}return!0}function mm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xm(e,r){var t=mm(e);e=0;for(var n;t;){if(t.nodeType===3){if(n=e+t.textContent.length,e<=r&&n>=r)return{node:t,offset:r-e};e=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=mm(t)}}function a1(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?a1(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function s1(){for(var e=window,r=nu();r instanceof e.HTMLIFrameElement;){try{var t=typeof r.contentWindow.location.href=="string"}catch{t=!1}if(t)e=r.contentWindow;else break;r=nu(e.document)}return r}function _p(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function Y_(e){var r=s1(),t=e.focusedElem,n=e.selectionRange;if(r!==t&&t&&t.ownerDocument&&a1(t.ownerDocument.documentElement,t)){if(n!==null&&_p(t)){if(r=n.start,e=n.end,e===void 0&&(e=r),"selectionStart"in t)t.selectionStart=r,t.selectionEnd=Math.min(e,t.value.length);else if(e=(r=t.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var a=t.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=xm(t,s);var o=xm(t,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(r=r.createRange(),r.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(r),e.extend(o.node,o.offset)):(r.setEnd(o.node,o.offset),e.addRange(r)))}}for(r=[],e=t;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<r.length;t++)e=r[t],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var V_=Da&&"documentMode"in document&&11>=document.documentMode,_o=null,Jf=null,Vi=null,ed=!1;function gm(e,r,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;ed||_o==null||_o!==nu(n)||(n=_o,"selectionStart"in n&&_p(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Vi&&xl(Vi,n)||(Vi=n,n=uu(Jf,"onSelect"),0<n.length&&(r=new yp("onSelect","select",null,r,t),e.push({event:r,listeners:n}),r.target=_o)))}function fc(e,r){var t={};return t[e.toLowerCase()]=r.toLowerCase(),t["Webkit"+e]="webkit"+r,t["Moz"+e]="moz"+r,t}var bo={animationend:fc("Animation","AnimationEnd"),animationiteration:fc("Animation","AnimationIteration"),animationstart:fc("Animation","AnimationStart"),transitionend:fc("Transition","TransitionEnd")},K0={},o1={};Da&&(o1=document.createElement("div").style,"AnimationEvent"in window||(delete bo.animationend.animation,delete bo.animationiteration.animation,delete bo.animationstart.animation),"TransitionEvent"in window||delete bo.transitionend.transition);function i0(e){if(K0[e])return K0[e];if(!bo[e])return e;var r=bo[e],t;for(t in r)if(r.hasOwnProperty(t)&&t in o1)return K0[e]=r[t];return e}var i1=i0("animationend"),l1=i0("animationiteration"),c1=i0("animationstart"),u1=i0("transitionend"),f1=new Map,vm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xs(e,r){f1.set(e,r),ro(r,[e])}for(var G0=0;G0<vm.length;G0++){var X0=vm[G0],K_=X0.toLowerCase(),G_=X0[0].toUpperCase()+X0.slice(1);xs(K_,"on"+G_)}xs(i1,"onAnimationEnd");xs(l1,"onAnimationIteration");xs(c1,"onAnimationStart");xs("dblclick","onDoubleClick");xs("focusin","onFocus");xs("focusout","onBlur");xs(u1,"onTransitionEnd");Yo("onMouseEnter",["mouseout","mouseover"]);Yo("onMouseLeave",["mouseout","mouseover"]);Yo("onPointerEnter",["pointerout","pointerover"]);Yo("onPointerLeave",["pointerout","pointerover"]);ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),X_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function ym(e,r,t){var n=e.type||"unknown-event";e.currentTarget=t,K2(n,r,void 0,e),e.currentTarget=null}function d1(e,r){r=(r&4)!==0;for(var t=0;t<e.length;t++){var n=e[t],a=n.event;n=n.listeners;e:{var s=void 0;if(r)for(var o=n.length-1;0<=o;o--){var i=n[o],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==s&&a.isPropagationStopped())break e;ym(a,i,c),s=l}else for(o=0;o<n.length;o++){if(i=n[o],l=i.instance,c=i.currentTarget,i=i.listener,l!==s&&a.isPropagationStopped())break e;ym(a,i,c),s=l}}}if(su)throw e=Xf,su=!1,Xf=null,e}function Tt(e,r){var t=r[sd];t===void 0&&(t=r[sd]=new Set);var n=e+"__bubble";t.has(n)||(p1(r,e,2,!1),t.add(n))}function Q0(e,r,t){var n=0;r&&(n|=4),p1(t,e,n,r)}var dc="_reactListening"+Math.random().toString(36).slice(2);function gl(e){if(!e[dc]){e[dc]=!0,wv.forEach(function(t){t!=="selectionchange"&&(X_.has(t)||Q0(t,!1,e),Q0(t,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[dc]||(r[dc]=!0,Q0("selectionchange",!1,r))}}function p1(e,r,t,n){switch(Qv(r)){case 1:var a=c_;break;case 4:a=u_;break;default:a=gp}t=a.bind(null,r,t,e),a=void 0,!Gf||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(r,t,{capture:!0,passive:a}):e.addEventListener(r,t,!0):a!==void 0?e.addEventListener(r,t,{passive:a}):e.addEventListener(r,t,!1)}function q0(e,r,t,n,a){var s=n;if(!(r&1)&&!(r&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var i=n.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;o=o.return}for(;i!==null;){if(o=Cs(i),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}i=i.parentNode}}n=n.return}Iv(function(){var c=s,u=pp(t),d=[];e:{var p=f1.get(e);if(p!==void 0){var h=yp,x=e;switch(e){case"keypress":if(Uc(t)===0)break e;case"keydown":case"keyup":h=S_;break;case"focusin":x="focus",h=H0;break;case"focusout":x="blur",h=H0;break;case"beforeblur":case"afterblur":h=H0;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=im;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=p_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=D_;break;case i1:case l1:case c1:h=x_;break;case u1:h=F_;break;case"scroll":h=f_;break;case"wheel":h=O_;break;case"copy":case"cut":case"paste":h=v_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=cm}var m=(r&4)!==0,y=!m&&e==="scroll",g=m?p!==null?p+"Capture":null:p;m=[];for(var w=c,v;w!==null;){v=w;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,g!==null&&(b=fl(w,g),b!=null&&m.push(vl(w,b,v)))),y)break;w=w.return}0<m.length&&(p=new h(p,x,null,t,u),d.push({event:p,listeners:m}))}}if(!(r&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&t!==Vf&&(x=t.relatedTarget||t.fromElement)&&(Cs(x)||x[Na]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(x=t.relatedTarget||t.toElement,h=c,x=x?Cs(x):null,x!==null&&(y=no(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(h=null,x=c),h!==x)){if(m=im,b="onMouseLeave",g="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=cm,b="onPointerLeave",g="onPointerEnter",w="pointer"),y=h==null?p:Eo(h),v=x==null?p:Eo(x),p=new m(b,w+"leave",h,t,u),p.target=y,p.relatedTarget=v,b=null,Cs(u)===c&&(m=new m(g,w+"enter",x,t,u),m.target=v,m.relatedTarget=y,b=m),y=b,h&&x)t:{for(m=h,g=x,w=0,v=m;v;v=po(v))w++;for(v=0,b=g;b;b=po(b))v++;for(;0<w-v;)m=po(m),w--;for(;0<v-w;)g=po(g),v--;for(;w--;){if(m===g||g!==null&&m===g.alternate)break t;m=po(m),g=po(g)}m=null}else m=null;h!==null&&wm(d,p,h,m,!1),x!==null&&y!==null&&wm(d,y,x,m,!0)}}e:{if(p=c?Eo(c):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var M=z_;else if(dm(p))if(r1)M=$_;else{M=W_;var C=B_}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(M=U_);if(M&&(M=M(e,c))){t1(d,M,t,u);break e}C&&C(e,p,c),e==="focusout"&&(C=p._wrapperState)&&C.controlled&&p.type==="number"&&Wf(p,"number",p.value)}switch(C=c?Eo(c):window,e){case"focusin":(dm(C)||C.contentEditable==="true")&&(_o=C,Jf=c,Vi=null);break;case"focusout":Vi=Jf=_o=null;break;case"mousedown":ed=!0;break;case"contextmenu":case"mouseup":case"dragend":ed=!1,gm(d,t,u);break;case"selectionchange":if(V_)break;case"keydown":case"keyup":gm(d,t,u)}var k;if(kp)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else ko?Jv(e,t)&&(F="onCompositionEnd"):e==="keydown"&&t.keyCode===229&&(F="onCompositionStart");F&&(Zv&&t.locale!=="ko"&&(ko||F!=="onCompositionStart"?F==="onCompositionEnd"&&ko&&(k=qv()):(Va=u,vp="value"in Va?Va.value:Va.textContent,ko=!0)),C=uu(c,F),0<C.length&&(F=new lm(F,e,null,t,u),d.push({event:F,listeners:C}),k?F.data=k:(k=e1(t),k!==null&&(F.data=k)))),(k=M_?R_(e,t):I_(e,t))&&(c=uu(c,"onBeforeInput"),0<c.length&&(u=new lm("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=k))}d1(d,r)})}function vl(e,r,t){return{instance:e,listener:r,currentTarget:t}}function uu(e,r){for(var t=r+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=fl(e,t),s!=null&&n.unshift(vl(e,s,a)),s=fl(e,r),s!=null&&n.push(vl(e,s,a))),e=e.return}return n}function po(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wm(e,r,t,n,a){for(var s=r._reactName,o=[];t!==null&&t!==n;){var i=t,l=i.alternate,c=i.stateNode;if(l!==null&&l===n)break;i.tag===5&&c!==null&&(i=c,a?(l=fl(t,s),l!=null&&o.unshift(vl(t,l,i))):a||(l=fl(t,s),l!=null&&o.push(vl(t,l,i)))),t=t.return}o.length!==0&&e.push({event:r,listeners:o})}var Q_=/\r\n?/g,q_=/\u0000|\uFFFD/g;function km(e){return(typeof e=="string"?e:""+e).replace(Q_,`
`).replace(q_,"")}function pc(e,r,t){if(r=km(r),km(e)!==r&&t)throw Error(ke(425))}function fu(){}var td=null,rd=null;function nd(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var ad=typeof setTimeout=="function"?setTimeout:void 0,Z_=typeof clearTimeout=="function"?clearTimeout:void 0,_m=typeof Promise=="function"?Promise:void 0,J_=typeof queueMicrotask=="function"?queueMicrotask:typeof _m<"u"?function(e){return _m.resolve(null).then(e).catch(eb)}:ad;function eb(e){setTimeout(function(){throw e})}function Z0(e,r){var t=r,n=0;do{var a=t.nextSibling;if(e.removeChild(t),a&&a.nodeType===8)if(t=a.data,t==="/$"){if(n===0){e.removeChild(a),hl(r);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=a}while(t);hl(r)}function ts(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function bm(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var t=e.data;if(t==="$"||t==="$!"||t==="$?"){if(r===0)return e;r--}else t==="/$"&&r++}e=e.previousSibling}return null}var ui=Math.random().toString(36).slice(2),Qn="__reactFiber$"+ui,yl="__reactProps$"+ui,Na="__reactContainer$"+ui,sd="__reactEvents$"+ui,tb="__reactListeners$"+ui,rb="__reactHandles$"+ui;function Cs(e){var r=e[Qn];if(r)return r;for(var t=e.parentNode;t;){if(r=t[Na]||t[Qn]){if(t=r.alternate,r.child!==null||t!==null&&t.child!==null)for(e=bm(e);e!==null;){if(t=e[Qn])return t;e=bm(e)}return r}e=t,t=e.parentNode}return null}function Wl(e){return e=e[Qn]||e[Na],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Eo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function l0(e){return e[yl]||null}var od=[],So=-1;function gs(e){return{current:e}}function Ct(e){0>So||(e.current=od[So],od[So]=null,So--)}function bt(e,r){So++,od[So]=e.current,e.current=r}var us={},Tr=gs(us),Vr=gs(!1),$s=us;function Vo(e,r){var t=e.type.contextTypes;if(!t)return us;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===r)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in t)a[s]=r[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),a}function Kr(e){return e=e.childContextTypes,e!=null}function du(){Ct(Vr),Ct(Tr)}function Em(e,r,t){if(Tr.current!==us)throw Error(ke(168));bt(Tr,r),bt(Vr,t)}function h1(e,r,t){var n=e.stateNode;if(r=r.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var a in n)if(!(a in r))throw Error(ke(108,B2(e)||"Unknown",a));return It({},t,n)}function pu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||us,$s=Tr.current,bt(Tr,e),bt(Vr,Vr.current),!0}function Sm(e,r,t){var n=e.stateNode;if(!n)throw Error(ke(169));t?(e=h1(e,r,$s),n.__reactInternalMemoizedMergedChildContext=e,Ct(Vr),Ct(Tr),bt(Tr,e)):Ct(Vr),bt(Vr,t)}var xa=null,c0=!1,J0=!1;function m1(e){xa===null?xa=[e]:xa.push(e)}function nb(e){c0=!0,m1(e)}function vs(){if(!J0&&xa!==null){J0=!0;var e=0,r=mt;try{var t=xa;for(mt=1;e<t.length;e++){var n=t[e];do n=n(!0);while(n!==null)}xa=null,c0=!1}catch(a){throw xa!==null&&(xa=xa.slice(e+1)),Bv(hp,vs),a}finally{mt=r,J0=!1}}return null}var To=[],Co=0,hu=null,mu=0,pn=[],hn=0,Hs=null,ga=1,va="";function _s(e,r){To[Co++]=mu,To[Co++]=hu,hu=e,mu=r}function x1(e,r,t){pn[hn++]=ga,pn[hn++]=va,pn[hn++]=Hs,Hs=e;var n=ga;e=va;var a=32-Pn(n)-1;n&=~(1<<a),t+=1;var s=32-Pn(r)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,ga=1<<32-Pn(r)+a|t<<a|n,va=s+e}else ga=1<<s|t<<a|n,va=e}function bp(e){e.return!==null&&(_s(e,1),x1(e,1,0))}function Ep(e){for(;e===hu;)hu=To[--Co],To[Co]=null,mu=To[--Co],To[Co]=null;for(;e===Hs;)Hs=pn[--hn],pn[hn]=null,va=pn[--hn],pn[hn]=null,ga=pn[--hn],pn[hn]=null}var Jr=null,Zr=null,At=!1,Nn=null;function g1(e,r){var t=xn(5,null,null,0);t.elementType="DELETED",t.stateNode=r,t.return=e,r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)}function Tm(e,r){switch(e.tag){case 5:var t=e.type;return r=r.nodeType!==1||t.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,Jr=e,Zr=ts(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,Jr=e,Zr=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(t=Hs!==null?{id:ga,overflow:va}:null,e.memoizedState={dehydrated:r,treeContext:t,retryLane:1073741824},t=xn(18,null,null,0),t.stateNode=r,t.return=e,e.child=t,Jr=e,Zr=null,!0):!1;default:return!1}}function id(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ld(e){if(At){var r=Zr;if(r){var t=r;if(!Tm(e,r)){if(id(e))throw Error(ke(418));r=ts(t.nextSibling);var n=Jr;r&&Tm(e,r)?g1(n,t):(e.flags=e.flags&-4097|2,At=!1,Jr=e)}}else{if(id(e))throw Error(ke(418));e.flags=e.flags&-4097|2,At=!1,Jr=e}}}function Cm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Jr=e}function hc(e){if(e!==Jr)return!1;if(!At)return Cm(e),At=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!nd(e.type,e.memoizedProps)),r&&(r=Zr)){if(id(e))throw v1(),Error(ke(418));for(;r;)g1(e,r),r=ts(r.nextSibling)}if(Cm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var t=e.data;if(t==="/$"){if(r===0){Zr=ts(e.nextSibling);break e}r--}else t!=="$"&&t!=="$!"&&t!=="$?"||r++}e=e.nextSibling}Zr=null}}else Zr=Jr?ts(e.stateNode.nextSibling):null;return!0}function v1(){for(var e=Zr;e;)e=ts(e.nextSibling)}function Ko(){Zr=Jr=null,At=!1}function Sp(e){Nn===null?Nn=[e]:Nn.push(e)}var ab=Ma.ReactCurrentBatchConfig;function Ci(e,r,t){if(e=t.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ke(309));var n=t.stateNode}if(!n)throw Error(ke(147,e));var a=n,s=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===s?r.ref:(r=function(o){var i=a.refs;o===null?delete i[s]:i[s]=o},r._stringRef=s,r)}if(typeof e!="string")throw Error(ke(284));if(!t._owner)throw Error(ke(290,e))}return e}function mc(e,r){throw e=Object.prototype.toString.call(r),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function Dm(e){var r=e._init;return r(e._payload)}function y1(e){function r(g,w){if(e){var v=g.deletions;v===null?(g.deletions=[w],g.flags|=16):v.push(w)}}function t(g,w){if(!e)return null;for(;w!==null;)r(g,w),w=w.sibling;return null}function n(g,w){for(g=new Map;w!==null;)w.key!==null?g.set(w.key,w):g.set(w.index,w),w=w.sibling;return g}function a(g,w){return g=ss(g,w),g.index=0,g.sibling=null,g}function s(g,w,v){return g.index=v,e?(v=g.alternate,v!==null?(v=v.index,v<w?(g.flags|=2,w):v):(g.flags|=2,w)):(g.flags|=1048576,w)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function i(g,w,v,b){return w===null||w.tag!==6?(w=of(v,g.mode,b),w.return=g,w):(w=a(w,v),w.return=g,w)}function l(g,w,v,b){var M=v.type;return M===wo?u(g,w,v.props.children,b,v.key):w!==null&&(w.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Ba&&Dm(M)===w.type)?(b=a(w,v.props),b.ref=Ci(g,w,v),b.return=g,b):(b=Xc(v.type,v.key,v.props,null,g.mode,b),b.ref=Ci(g,w,v),b.return=g,b)}function c(g,w,v,b){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=lf(v,g.mode,b),w.return=g,w):(w=a(w,v.children||[]),w.return=g,w)}function u(g,w,v,b,M){return w===null||w.tag!==7?(w=Ms(v,g.mode,b,M),w.return=g,w):(w=a(w,v),w.return=g,w)}function d(g,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=of(""+w,g.mode,v),w.return=g,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ac:return v=Xc(w.type,w.key,w.props,null,g.mode,v),v.ref=Ci(g,null,w),v.return=g,v;case yo:return w=lf(w,g.mode,v),w.return=g,w;case Ba:var b=w._init;return d(g,b(w._payload),v)}if(Pi(w)||_i(w))return w=Ms(w,g.mode,v,null),w.return=g,w;mc(g,w)}return null}function p(g,w,v,b){var M=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return M!==null?null:i(g,w,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ac:return v.key===M?l(g,w,v,b):null;case yo:return v.key===M?c(g,w,v,b):null;case Ba:return M=v._init,p(g,w,M(v._payload),b)}if(Pi(v)||_i(v))return M!==null?null:u(g,w,v,b,null);mc(g,v)}return null}function h(g,w,v,b,M){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(v)||null,i(w,g,""+b,M);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ac:return g=g.get(b.key===null?v:b.key)||null,l(w,g,b,M);case yo:return g=g.get(b.key===null?v:b.key)||null,c(w,g,b,M);case Ba:var C=b._init;return h(g,w,v,C(b._payload),M)}if(Pi(b)||_i(b))return g=g.get(v)||null,u(w,g,b,M,null);mc(w,b)}return null}function x(g,w,v,b){for(var M=null,C=null,k=w,F=w=0,E=null;k!==null&&F<v.length;F++){k.index>F?(E=k,k=null):E=k.sibling;var j=p(g,k,v[F],b);if(j===null){k===null&&(k=E);break}e&&k&&j.alternate===null&&r(g,k),w=s(j,w,F),C===null?M=j:C.sibling=j,C=j,k=E}if(F===v.length)return t(g,k),At&&_s(g,F),M;if(k===null){for(;F<v.length;F++)k=d(g,v[F],b),k!==null&&(w=s(k,w,F),C===null?M=k:C.sibling=k,C=k);return At&&_s(g,F),M}for(k=n(g,k);F<v.length;F++)E=h(k,g,F,v[F],b),E!==null&&(e&&E.alternate!==null&&k.delete(E.key===null?F:E.key),w=s(E,w,F),C===null?M=E:C.sibling=E,C=E);return e&&k.forEach(function(V){return r(g,V)}),At&&_s(g,F),M}function m(g,w,v,b){var M=_i(v);if(typeof M!="function")throw Error(ke(150));if(v=M.call(v),v==null)throw Error(ke(151));for(var C=M=null,k=w,F=w=0,E=null,j=v.next();k!==null&&!j.done;F++,j=v.next()){k.index>F?(E=k,k=null):E=k.sibling;var V=p(g,k,j.value,b);if(V===null){k===null&&(k=E);break}e&&k&&V.alternate===null&&r(g,k),w=s(V,w,F),C===null?M=V:C.sibling=V,C=V,k=E}if(j.done)return t(g,k),At&&_s(g,F),M;if(k===null){for(;!j.done;F++,j=v.next())j=d(g,j.value,b),j!==null&&(w=s(j,w,F),C===null?M=j:C.sibling=j,C=j);return At&&_s(g,F),M}for(k=n(g,k);!j.done;F++,j=v.next())j=h(k,g,F,j.value,b),j!==null&&(e&&j.alternate!==null&&k.delete(j.key===null?F:j.key),w=s(j,w,F),C===null?M=j:C.sibling=j,C=j);return e&&k.forEach(function(W){return r(g,W)}),At&&_s(g,F),M}function y(g,w,v,b){if(typeof v=="object"&&v!==null&&v.type===wo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case ac:e:{for(var M=v.key,C=w;C!==null;){if(C.key===M){if(M=v.type,M===wo){if(C.tag===7){t(g,C.sibling),w=a(C,v.props.children),w.return=g,g=w;break e}}else if(C.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Ba&&Dm(M)===C.type){t(g,C.sibling),w=a(C,v.props),w.ref=Ci(g,C,v),w.return=g,g=w;break e}t(g,C);break}else r(g,C);C=C.sibling}v.type===wo?(w=Ms(v.props.children,g.mode,b,v.key),w.return=g,g=w):(b=Xc(v.type,v.key,v.props,null,g.mode,b),b.ref=Ci(g,w,v),b.return=g,g=b)}return o(g);case yo:e:{for(C=v.key;w!==null;){if(w.key===C)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){t(g,w.sibling),w=a(w,v.children||[]),w.return=g,g=w;break e}else{t(g,w);break}else r(g,w);w=w.sibling}w=lf(v,g.mode,b),w.return=g,g=w}return o(g);case Ba:return C=v._init,y(g,w,C(v._payload),b)}if(Pi(v))return x(g,w,v,b);if(_i(v))return m(g,w,v,b);mc(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(t(g,w.sibling),w=a(w,v),w.return=g,g=w):(t(g,w),w=of(v,g.mode,b),w.return=g,g=w),o(g)):t(g,w)}return y}var Go=y1(!0),w1=y1(!1),xu=gs(null),gu=null,Do=null,Tp=null;function Cp(){Tp=Do=gu=null}function Dp(e){var r=xu.current;Ct(xu),e._currentValue=r}function cd(e,r,t){for(;e!==null;){var n=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,n!==null&&(n.childLanes|=r)):n!==null&&(n.childLanes&r)!==r&&(n.childLanes|=r),e===t)break;e=e.return}}function jo(e,r){gu=e,Tp=Do=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(Yr=!0),e.firstContext=null)}function vn(e){var r=e._currentValue;if(Tp!==e)if(e={context:e,memoizedValue:r,next:null},Do===null){if(gu===null)throw Error(ke(308));Do=e,gu.dependencies={lanes:0,firstContext:e}}else Do=Do.next=e;return r}var Ds=null;function Np(e){Ds===null?Ds=[e]:Ds.push(e)}function k1(e,r,t,n){var a=r.interleaved;return a===null?(t.next=t,Np(r)):(t.next=a.next,a.next=t),r.interleaved=t,Fa(e,n)}function Fa(e,r){e.lanes|=r;var t=e.alternate;for(t!==null&&(t.lanes|=r),t=e,e=e.return;e!==null;)e.childLanes|=r,t=e.alternate,t!==null&&(t.childLanes|=r),t=e,e=e.return;return t.tag===3?t.stateNode:null}var Wa=!1;function Fp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _1(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function wa(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function rs(e,r,t){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,it&2){var a=n.pending;return a===null?r.next=r:(r.next=a.next,a.next=r),n.pending=r,Fa(e,t)}return a=n.interleaved,a===null?(r.next=r,Np(n)):(r.next=a.next,a.next=r),n.interleaved=r,Fa(e,t)}function $c(e,r,t){if(r=r.updateQueue,r!==null&&(r=r.shared,(t&4194240)!==0)){var n=r.lanes;n&=e.pendingLanes,t|=n,r.lanes=t,mp(e,t)}}function Nm(e,r){var t=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var a=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?a=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?a=s=r:s=s.next=r}else a=s=r;t={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=t;return}e=t.lastBaseUpdate,e===null?t.firstBaseUpdate=r:e.next=r,t.lastBaseUpdate=r}function vu(e,r,t,n){var a=e.updateQueue;Wa=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var l=i,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=e.alternate;u!==null&&(u=u.updateQueue,i=u.lastBaseUpdate,i!==o&&(i===null?u.firstBaseUpdate=c:i.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;o=0,u=c=l=null,i=s;do{var p=i.lane,h=i.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var x=e,m=i;switch(p=r,h=t,m.tag){case 1:if(x=m.payload,typeof x=="function"){d=x.call(h,d,p);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,p=typeof x=="function"?x.call(h,d,p):x,p==null)break e;d=It({},d,p);break e;case 2:Wa=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[i]:p.push(i))}else h={eventTime:h,lane:p,tag:i.tag,payload:i.payload,callback:i.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,o|=p;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;p=i,i=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(u===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,r=a.shared.interleaved,r!==null){a=r;do o|=a.lane,a=a.next;while(a!==r)}else s===null&&(a.shared.lanes=0);Vs|=o,e.lanes=o,e.memoizedState=d}}function Fm(e,r,t){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var n=e[r],a=n.callback;if(a!==null){if(n.callback=null,n=t,typeof a!="function")throw Error(ke(191,a));a.call(n)}}}var Ul={},na=gs(Ul),wl=gs(Ul),kl=gs(Ul);function Ns(e){if(e===Ul)throw Error(ke(174));return e}function Ap(e,r){switch(bt(kl,r),bt(wl,e),bt(na,Ul),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:$f(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=$f(r,e)}Ct(na),bt(na,r)}function Xo(){Ct(na),Ct(wl),Ct(kl)}function b1(e){Ns(kl.current);var r=Ns(na.current),t=$f(r,e.type);r!==t&&(bt(wl,e),bt(na,t))}function Op(e){wl.current===e&&(Ct(na),Ct(wl))}var Pt=gs(0);function yu(e){for(var r=e;r!==null;){if(r.tag===13){var t=r.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ef=[];function Pp(){for(var e=0;e<ef.length;e++)ef[e]._workInProgressVersionPrimary=null;ef.length=0}var Hc=Ma.ReactCurrentDispatcher,tf=Ma.ReactCurrentBatchConfig,Ys=0,Rt=null,qt=null,nr=null,wu=!1,Ki=!1,_l=0,sb=0;function gr(){throw Error(ke(321))}function Mp(e,r){if(r===null)return!1;for(var t=0;t<r.length&&t<e.length;t++)if(!Ln(e[t],r[t]))return!1;return!0}function Rp(e,r,t,n,a,s){if(Ys=s,Rt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Hc.current=e===null||e.memoizedState===null?cb:ub,e=t(n,a),Ki){s=0;do{if(Ki=!1,_l=0,25<=s)throw Error(ke(301));s+=1,nr=qt=null,r.updateQueue=null,Hc.current=fb,e=t(n,a)}while(Ki)}if(Hc.current=ku,r=qt!==null&&qt.next!==null,Ys=0,nr=qt=Rt=null,wu=!1,r)throw Error(ke(300));return e}function Ip(){var e=_l!==0;return _l=0,e}function Kn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nr===null?Rt.memoizedState=nr=e:nr=nr.next=e,nr}function yn(){if(qt===null){var e=Rt.alternate;e=e!==null?e.memoizedState:null}else e=qt.next;var r=nr===null?Rt.memoizedState:nr.next;if(r!==null)nr=r,qt=e;else{if(e===null)throw Error(ke(310));qt=e,e={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},nr===null?Rt.memoizedState=nr=e:nr=nr.next=e}return nr}function bl(e,r){return typeof r=="function"?r(e):r}function rf(e){var r=yn(),t=r.queue;if(t===null)throw Error(ke(311));t.lastRenderedReducer=e;var n=qt,a=n.baseQueue,s=t.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,t.pending=null}if(a!==null){s=a.next,n=n.baseState;var i=o=null,l=null,c=s;do{var u=c.lane;if((Ys&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(i=l=d,o=n):l=l.next=d,Rt.lanes|=u,Vs|=u}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=i,Ln(n,r.memoizedState)||(Yr=!0),r.memoizedState=n,r.baseState=o,r.baseQueue=l,t.lastRenderedState=n}if(e=t.interleaved,e!==null){a=e;do s=a.lane,Rt.lanes|=s,Vs|=s,a=a.next;while(a!==e)}else a===null&&(t.lanes=0);return[r.memoizedState,t.dispatch]}function nf(e){var r=yn(),t=r.queue;if(t===null)throw Error(ke(311));t.lastRenderedReducer=e;var n=t.dispatch,a=t.pending,s=r.memoizedState;if(a!==null){t.pending=null;var o=a=a.next;do s=e(s,o.action),o=o.next;while(o!==a);Ln(s,r.memoizedState)||(Yr=!0),r.memoizedState=s,r.baseQueue===null&&(r.baseState=s),t.lastRenderedState=s}return[s,n]}function E1(){}function S1(e,r){var t=Rt,n=yn(),a=r(),s=!Ln(n.memoizedState,a);if(s&&(n.memoizedState=a,Yr=!0),n=n.queue,jp(D1.bind(null,t,n,e),[e]),n.getSnapshot!==r||s||nr!==null&&nr.memoizedState.tag&1){if(t.flags|=2048,El(9,C1.bind(null,t,n,a,r),void 0,null),ar===null)throw Error(ke(349));Ys&30||T1(t,r,a)}return a}function T1(e,r,t){e.flags|=16384,e={getSnapshot:r,value:t},r=Rt.updateQueue,r===null?(r={lastEffect:null,stores:null},Rt.updateQueue=r,r.stores=[e]):(t=r.stores,t===null?r.stores=[e]:t.push(e))}function C1(e,r,t,n){r.value=t,r.getSnapshot=n,N1(r)&&F1(e)}function D1(e,r,t){return t(function(){N1(r)&&F1(e)})}function N1(e){var r=e.getSnapshot;e=e.value;try{var t=r();return!Ln(e,t)}catch{return!0}}function F1(e){var r=Fa(e,1);r!==null&&Mn(r,e,1,-1)}function Am(e){var r=Kn();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:e},r.queue=e,e=e.dispatch=lb.bind(null,Rt,e),[r.memoizedState,e]}function El(e,r,t,n){return e={tag:e,create:r,destroy:t,deps:n,next:null},r=Rt.updateQueue,r===null?(r={lastEffect:null,stores:null},Rt.updateQueue=r,r.lastEffect=e.next=e):(t=r.lastEffect,t===null?r.lastEffect=e.next=e:(n=t.next,t.next=e,e.next=n,r.lastEffect=e)),e}function A1(){return yn().memoizedState}function Yc(e,r,t,n){var a=Kn();Rt.flags|=e,a.memoizedState=El(1|r,t,void 0,n===void 0?null:n)}function u0(e,r,t,n){var a=yn();n=n===void 0?null:n;var s=void 0;if(qt!==null){var o=qt.memoizedState;if(s=o.destroy,n!==null&&Mp(n,o.deps)){a.memoizedState=El(r,t,s,n);return}}Rt.flags|=e,a.memoizedState=El(1|r,t,s,n)}function Om(e,r){return Yc(8390656,8,e,r)}function jp(e,r){return u0(2048,8,e,r)}function O1(e,r){return u0(4,2,e,r)}function P1(e,r){return u0(4,4,e,r)}function M1(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function R1(e,r,t){return t=t!=null?t.concat([e]):null,u0(4,4,M1.bind(null,r,e),t)}function Lp(){}function I1(e,r){var t=yn();r=r===void 0?null:r;var n=t.memoizedState;return n!==null&&r!==null&&Mp(r,n[1])?n[0]:(t.memoizedState=[e,r],e)}function j1(e,r){var t=yn();r=r===void 0?null:r;var n=t.memoizedState;return n!==null&&r!==null&&Mp(r,n[1])?n[0]:(e=e(),t.memoizedState=[e,r],e)}function L1(e,r,t){return Ys&21?(Ln(t,r)||(t=$v(),Rt.lanes|=t,Vs|=t,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,Yr=!0),e.memoizedState=t)}function ob(e,r){var t=mt;mt=t!==0&&4>t?t:4,e(!0);var n=tf.transition;tf.transition={};try{e(!1),r()}finally{mt=t,tf.transition=n}}function z1(){return yn().memoizedState}function ib(e,r,t){var n=as(e);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},B1(e))W1(r,t);else if(t=k1(e,r,t,n),t!==null){var a=Lr();Mn(t,e,n,a),U1(t,r,n)}}function lb(e,r,t){var n=as(e),a={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(B1(e))W1(r,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=r.lastRenderedReducer,s!==null))try{var o=r.lastRenderedState,i=s(o,t);if(a.hasEagerState=!0,a.eagerState=i,Ln(i,o)){var l=r.interleaved;l===null?(a.next=a,Np(r)):(a.next=l.next,l.next=a),r.interleaved=a;return}}catch{}finally{}t=k1(e,r,a,n),t!==null&&(a=Lr(),Mn(t,e,n,a),U1(t,r,n))}}function B1(e){var r=e.alternate;return e===Rt||r!==null&&r===Rt}function W1(e,r){Ki=wu=!0;var t=e.pending;t===null?r.next=r:(r.next=t.next,t.next=r),e.pending=r}function U1(e,r,t){if(t&4194240){var n=r.lanes;n&=e.pendingLanes,t|=n,r.lanes=t,mp(e,t)}}var ku={readContext:vn,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},cb={readContext:vn,useCallback:function(e,r){return Kn().memoizedState=[e,r===void 0?null:r],e},useContext:vn,useEffect:Om,useImperativeHandle:function(e,r,t){return t=t!=null?t.concat([e]):null,Yc(4194308,4,M1.bind(null,r,e),t)},useLayoutEffect:function(e,r){return Yc(4194308,4,e,r)},useInsertionEffect:function(e,r){return Yc(4,2,e,r)},useMemo:function(e,r){var t=Kn();return r=r===void 0?null:r,e=e(),t.memoizedState=[e,r],e},useReducer:function(e,r,t){var n=Kn();return r=t!==void 0?t(r):r,n.memoizedState=n.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},n.queue=e,e=e.dispatch=ib.bind(null,Rt,e),[n.memoizedState,e]},useRef:function(e){var r=Kn();return e={current:e},r.memoizedState=e},useState:Am,useDebugValue:Lp,useDeferredValue:function(e){return Kn().memoizedState=e},useTransition:function(){var e=Am(!1),r=e[0];return e=ob.bind(null,e[1]),Kn().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,t){var n=Rt,a=Kn();if(At){if(t===void 0)throw Error(ke(407));t=t()}else{if(t=r(),ar===null)throw Error(ke(349));Ys&30||T1(n,r,t)}a.memoizedState=t;var s={value:t,getSnapshot:r};return a.queue=s,Om(D1.bind(null,n,s,e),[e]),n.flags|=2048,El(9,C1.bind(null,n,s,t,r),void 0,null),t},useId:function(){var e=Kn(),r=ar.identifierPrefix;if(At){var t=va,n=ga;t=(n&~(1<<32-Pn(n)-1)).toString(32)+t,r=":"+r+"R"+t,t=_l++,0<t&&(r+="H"+t.toString(32)),r+=":"}else t=sb++,r=":"+r+"r"+t.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},ub={readContext:vn,useCallback:I1,useContext:vn,useEffect:jp,useImperativeHandle:R1,useInsertionEffect:O1,useLayoutEffect:P1,useMemo:j1,useReducer:rf,useRef:A1,useState:function(){return rf(bl)},useDebugValue:Lp,useDeferredValue:function(e){var r=yn();return L1(r,qt.memoizedState,e)},useTransition:function(){var e=rf(bl)[0],r=yn().memoizedState;return[e,r]},useMutableSource:E1,useSyncExternalStore:S1,useId:z1,unstable_isNewReconciler:!1},fb={readContext:vn,useCallback:I1,useContext:vn,useEffect:jp,useImperativeHandle:R1,useInsertionEffect:O1,useLayoutEffect:P1,useMemo:j1,useReducer:nf,useRef:A1,useState:function(){return nf(bl)},useDebugValue:Lp,useDeferredValue:function(e){var r=yn();return qt===null?r.memoizedState=e:L1(r,qt.memoizedState,e)},useTransition:function(){var e=nf(bl)[0],r=yn().memoizedState;return[e,r]},useMutableSource:E1,useSyncExternalStore:S1,useId:z1,unstable_isNewReconciler:!1};function Tn(e,r){if(e&&e.defaultProps){r=It({},r),e=e.defaultProps;for(var t in e)r[t]===void 0&&(r[t]=e[t]);return r}return r}function ud(e,r,t,n){r=e.memoizedState,t=t(n,r),t=t==null?r:It({},r,t),e.memoizedState=t,e.lanes===0&&(e.updateQueue.baseState=t)}var f0={isMounted:function(e){return(e=e._reactInternals)?no(e)===e:!1},enqueueSetState:function(e,r,t){e=e._reactInternals;var n=Lr(),a=as(e),s=wa(n,a);s.payload=r,t!=null&&(s.callback=t),r=rs(e,s,a),r!==null&&(Mn(r,e,a,n),$c(r,e,a))},enqueueReplaceState:function(e,r,t){e=e._reactInternals;var n=Lr(),a=as(e),s=wa(n,a);s.tag=1,s.payload=r,t!=null&&(s.callback=t),r=rs(e,s,a),r!==null&&(Mn(r,e,a,n),$c(r,e,a))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var t=Lr(),n=as(e),a=wa(t,n);a.tag=2,r!=null&&(a.callback=r),r=rs(e,a,n),r!==null&&(Mn(r,e,n,t),$c(r,e,n))}};function Pm(e,r,t,n,a,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):r.prototype&&r.prototype.isPureReactComponent?!xl(t,n)||!xl(a,s):!0}function $1(e,r,t){var n=!1,a=us,s=r.contextType;return typeof s=="object"&&s!==null?s=vn(s):(a=Kr(r)?$s:Tr.current,n=r.contextTypes,s=(n=n!=null)?Vo(e,a):us),r=new r(t,s),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=f0,e.stateNode=r,r._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),r}function Mm(e,r,t,n){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(t,n),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(t,n),r.state!==e&&f0.enqueueReplaceState(r,r.state,null)}function fd(e,r,t,n){var a=e.stateNode;a.props=t,a.state=e.memoizedState,a.refs={},Fp(e);var s=r.contextType;typeof s=="object"&&s!==null?a.context=vn(s):(s=Kr(r)?$s:Tr.current,a.context=Vo(e,s)),a.state=e.memoizedState,s=r.getDerivedStateFromProps,typeof s=="function"&&(ud(e,r,s,t),a.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(r=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),r!==a.state&&f0.enqueueReplaceState(a,a.state,null),vu(e,t,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Qo(e,r){try{var t="",n=r;do t+=z2(n),n=n.return;while(n);var a=t}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:r,stack:a,digest:null}}function af(e,r,t){return{value:e,source:null,stack:t??null,digest:r??null}}function dd(e,r){try{console.error(r.value)}catch(t){setTimeout(function(){throw t})}}var db=typeof WeakMap=="function"?WeakMap:Map;function H1(e,r,t){t=wa(-1,t),t.tag=3,t.payload={element:null};var n=r.value;return t.callback=function(){bu||(bu=!0,_d=n),dd(e,r)},t}function Y1(e,r,t){t=wa(-1,t),t.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=r.value;t.payload=function(){return n(a)},t.callback=function(){dd(e,r)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){dd(e,r),typeof n!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var o=r.stack;this.componentDidCatch(r.value,{componentStack:o!==null?o:""})}),t}function Rm(e,r,t){var n=e.pingCache;if(n===null){n=e.pingCache=new db;var a=new Set;n.set(r,a)}else a=n.get(r),a===void 0&&(a=new Set,n.set(r,a));a.has(t)||(a.add(t),e=Tb.bind(null,e,r,t),r.then(e,e))}function Im(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function jm(e,r,t,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===r?e.flags|=65536:(e.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(r=wa(-1,1),r.tag=2,rs(t,r,1))),t.lanes|=1),e)}var pb=Ma.ReactCurrentOwner,Yr=!1;function Fr(e,r,t,n){r.child=e===null?w1(r,null,t,n):Go(r,e.child,t,n)}function Lm(e,r,t,n,a){t=t.render;var s=r.ref;return jo(r,a),n=Rp(e,r,t,n,s,a),t=Ip(),e!==null&&!Yr?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~a,Aa(e,r,a)):(At&&t&&bp(r),r.flags|=1,Fr(e,r,n,a),r.child)}function zm(e,r,t,n,a){if(e===null){var s=t.type;return typeof s=="function"&&!Vp(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(r.tag=15,r.type=s,V1(e,r,s,n,a)):(e=Xc(t.type,null,n,r,r.mode,a),e.ref=r.ref,e.return=r,r.child=e)}if(s=e.child,!(e.lanes&a)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:xl,t(o,n)&&e.ref===r.ref)return Aa(e,r,a)}return r.flags|=1,e=ss(s,n),e.ref=r.ref,e.return=r,r.child=e}function V1(e,r,t,n,a){if(e!==null){var s=e.memoizedProps;if(xl(s,n)&&e.ref===r.ref)if(Yr=!1,r.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Yr=!0);else return r.lanes=e.lanes,Aa(e,r,a)}return pd(e,r,t,n,a)}function K1(e,r,t){var n=r.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(Fo,Xr),Xr|=t;else{if(!(t&1073741824))return e=s!==null?s.baseLanes|t:t,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,bt(Fo,Xr),Xr|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:t,bt(Fo,Xr),Xr|=n}else s!==null?(n=s.baseLanes|t,r.memoizedState=null):n=t,bt(Fo,Xr),Xr|=n;return Fr(e,r,a,t),r.child}function G1(e,r){var t=r.ref;(e===null&&t!==null||e!==null&&e.ref!==t)&&(r.flags|=512,r.flags|=2097152)}function pd(e,r,t,n,a){var s=Kr(t)?$s:Tr.current;return s=Vo(r,s),jo(r,a),t=Rp(e,r,t,n,s,a),n=Ip(),e!==null&&!Yr?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~a,Aa(e,r,a)):(At&&n&&bp(r),r.flags|=1,Fr(e,r,t,a),r.child)}function Bm(e,r,t,n,a){if(Kr(t)){var s=!0;pu(r)}else s=!1;if(jo(r,a),r.stateNode===null)Vc(e,r),$1(r,t,n),fd(r,t,n,a),n=!0;else if(e===null){var o=r.stateNode,i=r.memoizedProps;o.props=i;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=vn(c):(c=Kr(t)?$s:Tr.current,c=Vo(r,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==n||l!==c)&&Mm(r,o,n,c),Wa=!1;var p=r.memoizedState;o.state=p,vu(r,n,o,a),l=r.memoizedState,i!==n||p!==l||Vr.current||Wa?(typeof u=="function"&&(ud(r,t,u,n),l=r.memoizedState),(i=Wa||Pm(r,t,i,n,p,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(r.flags|=4194308)):(typeof o.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=n,r.memoizedState=l),o.props=n,o.state=l,o.context=c,n=i):(typeof o.componentDidMount=="function"&&(r.flags|=4194308),n=!1)}else{o=r.stateNode,_1(e,r),i=r.memoizedProps,c=r.type===r.elementType?i:Tn(r.type,i),o.props=c,d=r.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=vn(l):(l=Kr(t)?$s:Tr.current,l=Vo(r,l));var h=t.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==d||p!==l)&&Mm(r,o,n,l),Wa=!1,p=r.memoizedState,o.state=p,vu(r,n,o,a);var x=r.memoizedState;i!==d||p!==x||Vr.current||Wa?(typeof h=="function"&&(ud(r,t,h,n),x=r.memoizedState),(c=Wa||Pm(r,t,c,n,p,x,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,l)),typeof o.componentDidUpdate=="function"&&(r.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof o.componentDidUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(r.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(r.flags|=1024),r.memoizedProps=n,r.memoizedState=x),o.props=n,o.state=x,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(r.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&p===e.memoizedState||(r.flags|=1024),n=!1)}return hd(e,r,t,n,s,a)}function hd(e,r,t,n,a,s){G1(e,r);var o=(r.flags&128)!==0;if(!n&&!o)return a&&Sm(r,t,!1),Aa(e,r,s);n=r.stateNode,pb.current=r;var i=o&&typeof t.getDerivedStateFromError!="function"?null:n.render();return r.flags|=1,e!==null&&o?(r.child=Go(r,e.child,null,s),r.child=Go(r,null,i,s)):Fr(e,r,i,s),r.memoizedState=n.state,a&&Sm(r,t,!0),r.child}function X1(e){var r=e.stateNode;r.pendingContext?Em(e,r.pendingContext,r.pendingContext!==r.context):r.context&&Em(e,r.context,!1),Ap(e,r.containerInfo)}function Wm(e,r,t,n,a){return Ko(),Sp(a),r.flags|=256,Fr(e,r,t,n),r.child}var md={dehydrated:null,treeContext:null,retryLane:0};function xd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Q1(e,r,t){var n=r.pendingProps,a=Pt.current,s=!1,o=(r.flags&128)!==0,i;if((i=o)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(s=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),bt(Pt,a&1),e===null)return ld(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(o=n.children,e=n.fallback,s?(n=r.mode,s=r.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=h0(o,n,0,null),e=Ms(e,n,t,null),s.return=r,e.return=r,s.sibling=e,r.child=s,r.child.memoizedState=xd(t),r.memoizedState=md,e):zp(r,o));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return hb(e,r,o,n,i,a,t);if(s){s=n.fallback,o=r.mode,a=e.child,i=a.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&r.child!==a?(n=r.child,n.childLanes=0,n.pendingProps=l,r.deletions=null):(n=ss(a,l),n.subtreeFlags=a.subtreeFlags&14680064),i!==null?s=ss(i,s):(s=Ms(s,o,t,null),s.flags|=2),s.return=r,n.return=r,n.sibling=s,r.child=n,n=s,s=r.child,o=e.child.memoizedState,o=o===null?xd(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~t,r.memoizedState=md,n}return s=e.child,e=s.sibling,n=ss(s,{mode:"visible",children:n.children}),!(r.mode&1)&&(n.lanes=t),n.return=r,n.sibling=null,e!==null&&(t=r.deletions,t===null?(r.deletions=[e],r.flags|=16):t.push(e)),r.child=n,r.memoizedState=null,n}function zp(e,r){return r=h0({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function xc(e,r,t,n){return n!==null&&Sp(n),Go(r,e.child,null,t),e=zp(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function hb(e,r,t,n,a,s,o){if(t)return r.flags&256?(r.flags&=-257,n=af(Error(ke(422))),xc(e,r,o,n)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(s=n.fallback,a=r.mode,n=h0({mode:"visible",children:n.children},a,0,null),s=Ms(s,a,o,null),s.flags|=2,n.return=r,s.return=r,n.sibling=s,r.child=n,r.mode&1&&Go(r,e.child,null,o),r.child.memoizedState=xd(o),r.memoizedState=md,s);if(!(r.mode&1))return xc(e,r,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var i=n.dgst;return n=i,s=Error(ke(419)),n=af(s,n,void 0),xc(e,r,o,n)}if(i=(o&e.childLanes)!==0,Yr||i){if(n=ar,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Fa(e,a),Mn(n,e,a,-1))}return Yp(),n=af(Error(ke(421))),xc(e,r,o,n)}return a.data==="$?"?(r.flags|=128,r.child=e.child,r=Cb.bind(null,e),a._reactRetry=r,null):(e=s.treeContext,Zr=ts(a.nextSibling),Jr=r,At=!0,Nn=null,e!==null&&(pn[hn++]=ga,pn[hn++]=va,pn[hn++]=Hs,ga=e.id,va=e.overflow,Hs=r),r=zp(r,n.children),r.flags|=4096,r)}function Um(e,r,t){e.lanes|=r;var n=e.alternate;n!==null&&(n.lanes|=r),cd(e.return,r,t)}function sf(e,r,t,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:a}:(s.isBackwards=r,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=t,s.tailMode=a)}function q1(e,r,t){var n=r.pendingProps,a=n.revealOrder,s=n.tail;if(Fr(e,r,n.children,t),n=Pt.current,n&2)n=n&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Um(e,t,r);else if(e.tag===19)Um(e,t,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(bt(Pt,n),!(r.mode&1))r.memoizedState=null;else switch(a){case"forwards":for(t=r.child,a=null;t!==null;)e=t.alternate,e!==null&&yu(e)===null&&(a=t),t=t.sibling;t=a,t===null?(a=r.child,r.child=null):(a=t.sibling,t.sibling=null),sf(r,!1,a,t,s);break;case"backwards":for(t=null,a=r.child,r.child=null;a!==null;){if(e=a.alternate,e!==null&&yu(e)===null){r.child=a;break}e=a.sibling,a.sibling=t,t=a,a=e}sf(r,!0,t,null,s);break;case"together":sf(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Vc(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function Aa(e,r,t){if(e!==null&&(r.dependencies=e.dependencies),Vs|=r.lanes,!(t&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(ke(153));if(r.child!==null){for(e=r.child,t=ss(e,e.pendingProps),r.child=t,t.return=r;e.sibling!==null;)e=e.sibling,t=t.sibling=ss(e,e.pendingProps),t.return=r;t.sibling=null}return r.child}function mb(e,r,t){switch(r.tag){case 3:X1(r),Ko();break;case 5:b1(r);break;case 1:Kr(r.type)&&pu(r);break;case 4:Ap(r,r.stateNode.containerInfo);break;case 10:var n=r.type._context,a=r.memoizedProps.value;bt(xu,n._currentValue),n._currentValue=a;break;case 13:if(n=r.memoizedState,n!==null)return n.dehydrated!==null?(bt(Pt,Pt.current&1),r.flags|=128,null):t&r.child.childLanes?Q1(e,r,t):(bt(Pt,Pt.current&1),e=Aa(e,r,t),e!==null?e.sibling:null);bt(Pt,Pt.current&1);break;case 19:if(n=(t&r.childLanes)!==0,e.flags&128){if(n)return q1(e,r,t);r.flags|=128}if(a=r.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),bt(Pt,Pt.current),n)break;return null;case 22:case 23:return r.lanes=0,K1(e,r,t)}return Aa(e,r,t)}var Z1,gd,J1,ey;Z1=function(e,r){for(var t=r.child;t!==null;){if(t.tag===5||t.tag===6)e.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break;for(;t.sibling===null;){if(t.return===null||t.return===r)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};gd=function(){};J1=function(e,r,t,n){var a=e.memoizedProps;if(a!==n){e=r.stateNode,Ns(na.current);var s=null;switch(t){case"input":a=zf(e,a),n=zf(e,n),s=[];break;case"select":a=It({},a,{value:void 0}),n=It({},n,{value:void 0}),s=[];break;case"textarea":a=Uf(e,a),n=Uf(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=fu)}Hf(t,n);var o;t=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var i=a[c];for(o in i)i.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(cl.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(i=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==i&&(l!=null||i!=null))if(c==="style")if(i){for(o in i)!i.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&i[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,i=i?i.__html:void 0,l!=null&&i!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(cl.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Tt("scroll",e),s||i===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(r.updateQueue=c)&&(r.flags|=4)}};ey=function(e,r,t,n){t!==n&&(r.flags|=4)};function Di(e,r){if(!At)switch(e.tailMode){case"hidden":r=e.tail;for(var t=null;r!==null;)r.alternate!==null&&(t=r),r=r.sibling;t===null?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function vr(e){var r=e.alternate!==null&&e.alternate.child===e.child,t=0,n=0;if(r)for(var a=e.child;a!==null;)t|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)t|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=t,r}function xb(e,r,t){var n=r.pendingProps;switch(Ep(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(r),null;case 1:return Kr(r.type)&&du(),vr(r),null;case 3:return n=r.stateNode,Xo(),Ct(Vr),Ct(Tr),Pp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(hc(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Nn!==null&&(Sd(Nn),Nn=null))),gd(e,r),vr(r),null;case 5:Op(r);var a=Ns(kl.current);if(t=r.type,e!==null&&r.stateNode!=null)J1(e,r,t,n,a),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!n){if(r.stateNode===null)throw Error(ke(166));return vr(r),null}if(e=Ns(na.current),hc(r)){n=r.stateNode,t=r.type;var s=r.memoizedProps;switch(n[Qn]=r,n[yl]=s,e=(r.mode&1)!==0,t){case"dialog":Tt("cancel",n),Tt("close",n);break;case"iframe":case"object":case"embed":Tt("load",n);break;case"video":case"audio":for(a=0;a<Ri.length;a++)Tt(Ri[a],n);break;case"source":Tt("error",n);break;case"img":case"image":case"link":Tt("error",n),Tt("load",n);break;case"details":Tt("toggle",n);break;case"input":qh(n,s),Tt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Tt("invalid",n);break;case"textarea":Jh(n,s),Tt("invalid",n)}Hf(t,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var i=s[o];o==="children"?typeof i=="string"?n.textContent!==i&&(s.suppressHydrationWarning!==!0&&pc(n.textContent,i,e),a=["children",i]):typeof i=="number"&&n.textContent!==""+i&&(s.suppressHydrationWarning!==!0&&pc(n.textContent,i,e),a=["children",""+i]):cl.hasOwnProperty(o)&&i!=null&&o==="onScroll"&&Tt("scroll",n)}switch(t){case"input":sc(n),Zh(n,s,!0);break;case"textarea":sc(n),em(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=fu)}n=a,r.updateQueue=n,n!==null&&(r.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Dv(t)),e==="http://www.w3.org/1999/xhtml"?t==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(t,{is:n.is}):(e=o.createElement(t),t==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,t),e[Qn]=r,e[yl]=n,Z1(e,r,!1,!1),r.stateNode=e;e:{switch(o=Yf(t,n),t){case"dialog":Tt("cancel",e),Tt("close",e),a=n;break;case"iframe":case"object":case"embed":Tt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Ri.length;a++)Tt(Ri[a],e);a=n;break;case"source":Tt("error",e),a=n;break;case"img":case"image":case"link":Tt("error",e),Tt("load",e),a=n;break;case"details":Tt("toggle",e),a=n;break;case"input":qh(e,n),a=zf(e,n),Tt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=It({},n,{value:void 0}),Tt("invalid",e);break;case"textarea":Jh(e,n),a=Uf(e,n),Tt("invalid",e);break;default:a=n}Hf(t,a),i=a;for(s in i)if(i.hasOwnProperty(s)){var l=i[s];s==="style"?Av(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Nv(e,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&ul(e,l):typeof l=="number"&&ul(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Tt("scroll",e):l!=null&&cp(e,s,l,o))}switch(t){case"input":sc(e),Zh(e,n,!1);break;case"textarea":sc(e),em(e);break;case"option":n.value!=null&&e.setAttribute("value",""+cs(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Po(e,!!n.multiple,s,!1):n.defaultValue!=null&&Po(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=fu)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return vr(r),null;case 6:if(e&&r.stateNode!=null)ey(e,r,e.memoizedProps,n);else{if(typeof n!="string"&&r.stateNode===null)throw Error(ke(166));if(t=Ns(kl.current),Ns(na.current),hc(r)){if(n=r.stateNode,t=r.memoizedProps,n[Qn]=r,(s=n.nodeValue!==t)&&(e=Jr,e!==null))switch(e.tag){case 3:pc(n.nodeValue,t,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pc(n.nodeValue,t,(e.mode&1)!==0)}s&&(r.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[Qn]=r,r.stateNode=n}return vr(r),null;case 13:if(Ct(Pt),n=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(At&&Zr!==null&&r.mode&1&&!(r.flags&128))v1(),Ko(),r.flags|=98560,s=!1;else if(s=hc(r),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ke(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ke(317));s[Qn]=r}else Ko(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;vr(r),s=!1}else Nn!==null&&(Sd(Nn),Nn=null),s=!0;if(!s)return r.flags&65536?r:null}return r.flags&128?(r.lanes=t,r):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(r.child.flags|=8192,r.mode&1&&(e===null||Pt.current&1?Zt===0&&(Zt=3):Yp())),r.updateQueue!==null&&(r.flags|=4),vr(r),null);case 4:return Xo(),gd(e,r),e===null&&gl(r.stateNode.containerInfo),vr(r),null;case 10:return Dp(r.type._context),vr(r),null;case 17:return Kr(r.type)&&du(),vr(r),null;case 19:if(Ct(Pt),s=r.memoizedState,s===null)return vr(r),null;if(n=(r.flags&128)!==0,o=s.rendering,o===null)if(n)Di(s,!1);else{if(Zt!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(o=yu(e),o!==null){for(r.flags|=128,Di(s,!1),n=o.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),r.subtreeFlags=0,n=t,t=r.child;t!==null;)s=t,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t=t.sibling;return bt(Pt,Pt.current&1|2),r.child}e=e.sibling}s.tail!==null&&$t()>qo&&(r.flags|=128,n=!0,Di(s,!1),r.lanes=4194304)}else{if(!n)if(e=yu(o),e!==null){if(r.flags|=128,n=!0,t=e.updateQueue,t!==null&&(r.updateQueue=t,r.flags|=4),Di(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!At)return vr(r),null}else 2*$t()-s.renderingStartTime>qo&&t!==1073741824&&(r.flags|=128,n=!0,Di(s,!1),r.lanes=4194304);s.isBackwards?(o.sibling=r.child,r.child=o):(t=s.last,t!==null?t.sibling=o:r.child=o,s.last=o)}return s.tail!==null?(r=s.tail,s.rendering=r,s.tail=r.sibling,s.renderingStartTime=$t(),r.sibling=null,t=Pt.current,bt(Pt,n?t&1|2:t&1),r):(vr(r),null);case 22:case 23:return Hp(),n=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(r.flags|=8192),n&&r.mode&1?Xr&1073741824&&(vr(r),r.subtreeFlags&6&&(r.flags|=8192)):vr(r),null;case 24:return null;case 25:return null}throw Error(ke(156,r.tag))}function gb(e,r){switch(Ep(r),r.tag){case 1:return Kr(r.type)&&du(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Xo(),Ct(Vr),Ct(Tr),Pp(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return Op(r),null;case 13:if(Ct(Pt),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(ke(340));Ko()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Ct(Pt),null;case 4:return Xo(),null;case 10:return Dp(r.type._context),null;case 22:case 23:return Hp(),null;case 24:return null;default:return null}}var gc=!1,_r=!1,vb=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function No(e,r){var t=e.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){jt(e,r,n)}else t.current=null}function vd(e,r,t){try{t()}catch(n){jt(e,r,n)}}var $m=!1;function yb(e,r){if(td=lu,e=s1(),_p(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{t=(t=e.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,i=-1,l=-1,c=0,u=0,d=e,p=null;t:for(;;){for(var h;d!==t||a!==0&&d.nodeType!==3||(i=o+a),d!==s||n!==0&&d.nodeType!==3||(l=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===e)break t;if(p===t&&++c===a&&(i=o),p===s&&++u===n&&(l=o),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}t=i===-1||l===-1?null:{start:i,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(rd={focusedElem:e,selectionRange:t},lu=!1,Oe=r;Oe!==null;)if(r=Oe,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Oe=e;else for(;Oe!==null;){r=Oe;try{var x=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,y=x.memoizedState,g=r.stateNode,w=g.getSnapshotBeforeUpdate(r.elementType===r.type?m:Tn(r.type,m),y);g.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=r.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(b){jt(r,r.return,b)}if(e=r.sibling,e!==null){e.return=r.return,Oe=e;break}Oe=r.return}return x=$m,$m=!1,x}function Gi(e,r,t){var n=r.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&vd(r,t,s)}a=a.next}while(a!==n)}}function d0(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var t=r=r.next;do{if((t.tag&e)===e){var n=t.create;t.destroy=n()}t=t.next}while(t!==r)}}function yd(e){var r=e.ref;if(r!==null){var t=e.stateNode;switch(e.tag){case 5:e=t;break;default:e=t}typeof r=="function"?r(e):r.current=e}}function ty(e){var r=e.alternate;r!==null&&(e.alternate=null,ty(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Qn],delete r[yl],delete r[sd],delete r[tb],delete r[rb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ry(e){return e.tag===5||e.tag===3||e.tag===4}function Hm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ry(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wd(e,r,t){var n=e.tag;if(n===5||n===6)e=e.stateNode,r?t.nodeType===8?t.parentNode.insertBefore(e,r):t.insertBefore(e,r):(t.nodeType===8?(r=t.parentNode,r.insertBefore(e,t)):(r=t,r.appendChild(e)),t=t._reactRootContainer,t!=null||r.onclick!==null||(r.onclick=fu));else if(n!==4&&(e=e.child,e!==null))for(wd(e,r,t),e=e.sibling;e!==null;)wd(e,r,t),e=e.sibling}function kd(e,r,t){var n=e.tag;if(n===5||n===6)e=e.stateNode,r?t.insertBefore(e,r):t.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(kd(e,r,t),e=e.sibling;e!==null;)kd(e,r,t),e=e.sibling}var lr=null,Dn=!1;function ja(e,r,t){for(t=t.child;t!==null;)ny(e,r,t),t=t.sibling}function ny(e,r,t){if(ra&&typeof ra.onCommitFiberUnmount=="function")try{ra.onCommitFiberUnmount(a0,t)}catch{}switch(t.tag){case 5:_r||No(t,r);case 6:var n=lr,a=Dn;lr=null,ja(e,r,t),lr=n,Dn=a,lr!==null&&(Dn?(e=lr,t=t.stateNode,e.nodeType===8?e.parentNode.removeChild(t):e.removeChild(t)):lr.removeChild(t.stateNode));break;case 18:lr!==null&&(Dn?(e=lr,t=t.stateNode,e.nodeType===8?Z0(e.parentNode,t):e.nodeType===1&&Z0(e,t),hl(e)):Z0(lr,t.stateNode));break;case 4:n=lr,a=Dn,lr=t.stateNode.containerInfo,Dn=!0,ja(e,r,t),lr=n,Dn=a;break;case 0:case 11:case 14:case 15:if(!_r&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&vd(t,r,o),a=a.next}while(a!==n)}ja(e,r,t);break;case 1:if(!_r&&(No(t,r),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(i){jt(t,r,i)}ja(e,r,t);break;case 21:ja(e,r,t);break;case 22:t.mode&1?(_r=(n=_r)||t.memoizedState!==null,ja(e,r,t),_r=n):ja(e,r,t);break;default:ja(e,r,t)}}function Ym(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var t=e.stateNode;t===null&&(t=e.stateNode=new vb),r.forEach(function(n){var a=Db.bind(null,e,n);t.has(n)||(t.add(n),n.then(a,a))})}}function bn(e,r){var t=r.deletions;if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];try{var s=e,o=r,i=o;e:for(;i!==null;){switch(i.tag){case 5:lr=i.stateNode,Dn=!1;break e;case 3:lr=i.stateNode.containerInfo,Dn=!0;break e;case 4:lr=i.stateNode.containerInfo,Dn=!0;break e}i=i.return}if(lr===null)throw Error(ke(160));ny(s,o,a),lr=null,Dn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){jt(a,r,c)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)ay(r,e),r=r.sibling}function ay(e,r){var t=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bn(r,e),Hn(e),n&4){try{Gi(3,e,e.return),d0(3,e)}catch(m){jt(e,e.return,m)}try{Gi(5,e,e.return)}catch(m){jt(e,e.return,m)}}break;case 1:bn(r,e),Hn(e),n&512&&t!==null&&No(t,t.return);break;case 5:if(bn(r,e),Hn(e),n&512&&t!==null&&No(t,t.return),e.flags&32){var a=e.stateNode;try{ul(a,"")}catch(m){jt(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,o=t!==null?t.memoizedProps:s,i=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{i==="input"&&s.type==="radio"&&s.name!=null&&Tv(a,s),Yf(i,o);var c=Yf(i,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?Av(a,d):u==="dangerouslySetInnerHTML"?Nv(a,d):u==="children"?ul(a,d):cp(a,u,d,c)}switch(i){case"input":Bf(a,s);break;case"textarea":Cv(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Po(a,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?Po(a,!!s.multiple,s.defaultValue,!0):Po(a,!!s.multiple,s.multiple?[]:"",!1))}a[yl]=s}catch(m){jt(e,e.return,m)}}break;case 6:if(bn(r,e),Hn(e),n&4){if(e.stateNode===null)throw Error(ke(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){jt(e,e.return,m)}}break;case 3:if(bn(r,e),Hn(e),n&4&&t!==null&&t.memoizedState.isDehydrated)try{hl(r.containerInfo)}catch(m){jt(e,e.return,m)}break;case 4:bn(r,e),Hn(e);break;case 13:bn(r,e),Hn(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Up=$t())),n&4&&Ym(e);break;case 22:if(u=t!==null&&t.memoizedState!==null,e.mode&1?(_r=(c=_r)||u,bn(r,e),_r=c):bn(r,e),Hn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Oe=e,u=e.child;u!==null;){for(d=Oe=u;Oe!==null;){switch(p=Oe,h=p.child,p.tag){case 0:case 11:case 14:case 15:Gi(4,p,p.return);break;case 1:No(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,t=p.return;try{r=n,x.props=r.memoizedProps,x.state=r.memoizedState,x.componentWillUnmount()}catch(m){jt(n,t,m)}}break;case 5:No(p,p.return);break;case 22:if(p.memoizedState!==null){Km(d);continue}}h!==null?(h.return=p,Oe=h):Km(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(i=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,i.style.display=Fv("display",o))}catch(m){jt(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){jt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:bn(r,e),Hn(e),n&4&&Ym(e);break;case 21:break;default:bn(r,e),Hn(e)}}function Hn(e){var r=e.flags;if(r&2){try{e:{for(var t=e.return;t!==null;){if(ry(t)){var n=t;break e}t=t.return}throw Error(ke(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ul(a,""),n.flags&=-33);var s=Hm(e);kd(e,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,i=Hm(e);wd(e,i,o);break;default:throw Error(ke(161))}}catch(l){jt(e,e.return,l)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function wb(e,r,t){Oe=e,sy(e)}function sy(e,r,t){for(var n=(e.mode&1)!==0;Oe!==null;){var a=Oe,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||gc;if(!o){var i=a.alternate,l=i!==null&&i.memoizedState!==null||_r;i=gc;var c=_r;if(gc=o,(_r=l)&&!c)for(Oe=a;Oe!==null;)o=Oe,l=o.child,o.tag===22&&o.memoizedState!==null?Gm(a):l!==null?(l.return=o,Oe=l):Gm(a);for(;s!==null;)Oe=s,sy(s),s=s.sibling;Oe=a,gc=i,_r=c}Vm(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Oe=s):Vm(e)}}function Vm(e){for(;Oe!==null;){var r=Oe;if(r.flags&8772){var t=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:_r||d0(5,r);break;case 1:var n=r.stateNode;if(r.flags&4&&!_r)if(t===null)n.componentDidMount();else{var a=r.elementType===r.type?t.memoizedProps:Tn(r.type,t.memoizedProps);n.componentDidUpdate(a,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=r.updateQueue;s!==null&&Fm(r,s,n);break;case 3:var o=r.updateQueue;if(o!==null){if(t=null,r.child!==null)switch(r.child.tag){case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}Fm(r,o,t)}break;case 5:var i=r.stateNode;if(t===null&&r.flags&4){t=i;var l=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var c=r.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&hl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}_r||r.flags&512&&yd(r)}catch(p){jt(r,r.return,p)}}if(r===e){Oe=null;break}if(t=r.sibling,t!==null){t.return=r.return,Oe=t;break}Oe=r.return}}function Km(e){for(;Oe!==null;){var r=Oe;if(r===e){Oe=null;break}var t=r.sibling;if(t!==null){t.return=r.return,Oe=t;break}Oe=r.return}}function Gm(e){for(;Oe!==null;){var r=Oe;try{switch(r.tag){case 0:case 11:case 15:var t=r.return;try{d0(4,r)}catch(l){jt(r,t,l)}break;case 1:var n=r.stateNode;if(typeof n.componentDidMount=="function"){var a=r.return;try{n.componentDidMount()}catch(l){jt(r,a,l)}}var s=r.return;try{yd(r)}catch(l){jt(r,s,l)}break;case 5:var o=r.return;try{yd(r)}catch(l){jt(r,o,l)}}}catch(l){jt(r,r.return,l)}if(r===e){Oe=null;break}var i=r.sibling;if(i!==null){i.return=r.return,Oe=i;break}Oe=r.return}}var kb=Math.ceil,_u=Ma.ReactCurrentDispatcher,Bp=Ma.ReactCurrentOwner,gn=Ma.ReactCurrentBatchConfig,it=0,ar=null,Xt=null,fr=0,Xr=0,Fo=gs(0),Zt=0,Sl=null,Vs=0,p0=0,Wp=0,Xi=null,Hr=null,Up=0,qo=1/0,ma=null,bu=!1,_d=null,ns=null,vc=!1,Ka=null,Eu=0,Qi=0,bd=null,Kc=-1,Gc=0;function Lr(){return it&6?$t():Kc!==-1?Kc:Kc=$t()}function as(e){return e.mode&1?it&2&&fr!==0?fr&-fr:ab.transition!==null?(Gc===0&&(Gc=$v()),Gc):(e=mt,e!==0||(e=window.event,e=e===void 0?16:Qv(e.type)),e):1}function Mn(e,r,t,n){if(50<Qi)throw Qi=0,bd=null,Error(ke(185));zl(e,t,n),(!(it&2)||e!==ar)&&(e===ar&&(!(it&2)&&(p0|=t),Zt===4&&$a(e,fr)),Gr(e,n),t===1&&it===0&&!(r.mode&1)&&(qo=$t()+500,c0&&vs()))}function Gr(e,r){var t=e.callbackNode;a_(e,r);var n=iu(e,e===ar?fr:0);if(n===0)t!==null&&nm(t),e.callbackNode=null,e.callbackPriority=0;else if(r=n&-n,e.callbackPriority!==r){if(t!=null&&nm(t),r===1)e.tag===0?nb(Xm.bind(null,e)):m1(Xm.bind(null,e)),J_(function(){!(it&6)&&vs()}),t=null;else{switch(Hv(n)){case 1:t=hp;break;case 4:t=Wv;break;case 16:t=ou;break;case 536870912:t=Uv;break;default:t=ou}t=py(t,oy.bind(null,e))}e.callbackPriority=r,e.callbackNode=t}}function oy(e,r){if(Kc=-1,Gc=0,it&6)throw Error(ke(327));var t=e.callbackNode;if(Lo()&&e.callbackNode!==t)return null;var n=iu(e,e===ar?fr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||r)r=Su(e,n);else{r=n;var a=it;it|=2;var s=ly();(ar!==e||fr!==r)&&(ma=null,qo=$t()+500,Ps(e,r));do try{Eb();break}catch(i){iy(e,i)}while(!0);Cp(),_u.current=s,it=a,Xt!==null?r=0:(ar=null,fr=0,r=Zt)}if(r!==0){if(r===2&&(a=Qf(e),a!==0&&(n=a,r=Ed(e,a))),r===1)throw t=Sl,Ps(e,0),$a(e,n),Gr(e,$t()),t;if(r===6)$a(e,n);else{if(a=e.current.alternate,!(n&30)&&!_b(a)&&(r=Su(e,n),r===2&&(s=Qf(e),s!==0&&(n=s,r=Ed(e,s))),r===1))throw t=Sl,Ps(e,0),$a(e,n),Gr(e,$t()),t;switch(e.finishedWork=a,e.finishedLanes=n,r){case 0:case 1:throw Error(ke(345));case 2:bs(e,Hr,ma);break;case 3:if($a(e,n),(n&130023424)===n&&(r=Up+500-$t(),10<r)){if(iu(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Lr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ad(bs.bind(null,e,Hr,ma),r);break}bs(e,Hr,ma);break;case 4:if($a(e,n),(n&4194240)===n)break;for(r=e.eventTimes,a=-1;0<n;){var o=31-Pn(n);s=1<<o,o=r[o],o>a&&(a=o),n&=~s}if(n=a,n=$t()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*kb(n/1960))-n,10<n){e.timeoutHandle=ad(bs.bind(null,e,Hr,ma),n);break}bs(e,Hr,ma);break;case 5:bs(e,Hr,ma);break;default:throw Error(ke(329))}}}return Gr(e,$t()),e.callbackNode===t?oy.bind(null,e):null}function Ed(e,r){var t=Xi;return e.current.memoizedState.isDehydrated&&(Ps(e,r).flags|=256),e=Su(e,r),e!==2&&(r=Hr,Hr=t,r!==null&&Sd(r)),e}function Sd(e){Hr===null?Hr=e:Hr.push.apply(Hr,e)}function _b(e){for(var r=e;;){if(r.flags&16384){var t=r.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var a=t[n],s=a.getSnapshot;a=a.value;try{if(!Ln(s(),a))return!1}catch{return!1}}}if(t=r.child,r.subtreeFlags&16384&&t!==null)t.return=r,r=t;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function $a(e,r){for(r&=~Wp,r&=~p0,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var t=31-Pn(r),n=1<<t;e[t]=-1,r&=~n}}function Xm(e){if(it&6)throw Error(ke(327));Lo();var r=iu(e,0);if(!(r&1))return Gr(e,$t()),null;var t=Su(e,r);if(e.tag!==0&&t===2){var n=Qf(e);n!==0&&(r=n,t=Ed(e,n))}if(t===1)throw t=Sl,Ps(e,0),$a(e,r),Gr(e,$t()),t;if(t===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,bs(e,Hr,ma),Gr(e,$t()),null}function $p(e,r){var t=it;it|=1;try{return e(r)}finally{it=t,it===0&&(qo=$t()+500,c0&&vs())}}function Ks(e){Ka!==null&&Ka.tag===0&&!(it&6)&&Lo();var r=it;it|=1;var t=gn.transition,n=mt;try{if(gn.transition=null,mt=1,e)return e()}finally{mt=n,gn.transition=t,it=r,!(it&6)&&vs()}}function Hp(){Xr=Fo.current,Ct(Fo)}function Ps(e,r){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;if(t!==-1&&(e.timeoutHandle=-1,Z_(t)),Xt!==null)for(t=Xt.return;t!==null;){var n=t;switch(Ep(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&du();break;case 3:Xo(),Ct(Vr),Ct(Tr),Pp();break;case 5:Op(n);break;case 4:Xo();break;case 13:Ct(Pt);break;case 19:Ct(Pt);break;case 10:Dp(n.type._context);break;case 22:case 23:Hp()}t=t.return}if(ar=e,Xt=e=ss(e.current,null),fr=Xr=r,Zt=0,Sl=null,Wp=p0=Vs=0,Hr=Xi=null,Ds!==null){for(r=0;r<Ds.length;r++)if(t=Ds[r],n=t.interleaved,n!==null){t.interleaved=null;var a=n.next,s=t.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}t.pending=n}Ds=null}return e}function iy(e,r){do{var t=Xt;try{if(Cp(),Hc.current=ku,wu){for(var n=Rt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}wu=!1}if(Ys=0,nr=qt=Rt=null,Ki=!1,_l=0,Bp.current=null,t===null||t.return===null){Zt=1,Sl=r,Xt=null;break}e:{var s=e,o=t.return,i=t,l=r;if(r=fr,i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=i,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=Im(o);if(h!==null){h.flags&=-257,jm(h,o,i,s,r),h.mode&1&&Rm(s,c,r),r=h,l=c;var x=r.updateQueue;if(x===null){var m=new Set;m.add(l),r.updateQueue=m}else x.add(l);break e}else{if(!(r&1)){Rm(s,c,r),Yp();break e}l=Error(ke(426))}}else if(At&&i.mode&1){var y=Im(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),jm(y,o,i,s,r),Sp(Qo(l,i));break e}}s=l=Qo(l,i),Zt!==4&&(Zt=2),Xi===null?Xi=[s]:Xi.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,r&=-r,s.lanes|=r;var g=H1(s,l,r);Nm(s,g);break e;case 1:i=l;var w=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ns===null||!ns.has(v)))){s.flags|=65536,r&=-r,s.lanes|=r;var b=Y1(s,i,r);Nm(s,b);break e}}s=s.return}while(s!==null)}uy(t)}catch(M){r=M,Xt===t&&t!==null&&(Xt=t=t.return);continue}break}while(!0)}function ly(){var e=_u.current;return _u.current=ku,e===null?ku:e}function Yp(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),ar===null||!(Vs&268435455)&&!(p0&268435455)||$a(ar,fr)}function Su(e,r){var t=it;it|=2;var n=ly();(ar!==e||fr!==r)&&(ma=null,Ps(e,r));do try{bb();break}catch(a){iy(e,a)}while(!0);if(Cp(),it=t,_u.current=n,Xt!==null)throw Error(ke(261));return ar=null,fr=0,Zt}function bb(){for(;Xt!==null;)cy(Xt)}function Eb(){for(;Xt!==null&&!X2();)cy(Xt)}function cy(e){var r=dy(e.alternate,e,Xr);e.memoizedProps=e.pendingProps,r===null?uy(e):Xt=r,Bp.current=null}function uy(e){var r=e;do{var t=r.alternate;if(e=r.return,r.flags&32768){if(t=gb(t,r),t!==null){t.flags&=32767,Xt=t;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Zt=6,Xt=null;return}}else if(t=xb(t,r,Xr),t!==null){Xt=t;return}if(r=r.sibling,r!==null){Xt=r;return}Xt=r=e}while(r!==null);Zt===0&&(Zt=5)}function bs(e,r,t){var n=mt,a=gn.transition;try{gn.transition=null,mt=1,Sb(e,r,t,n)}finally{gn.transition=a,mt=n}return null}function Sb(e,r,t,n){do Lo();while(Ka!==null);if(it&6)throw Error(ke(327));t=e.finishedWork;var a=e.finishedLanes;if(t===null)return null;if(e.finishedWork=null,e.finishedLanes=0,t===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var s=t.lanes|t.childLanes;if(s_(e,s),e===ar&&(Xt=ar=null,fr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||vc||(vc=!0,py(ou,function(){return Lo(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=gn.transition,gn.transition=null;var o=mt;mt=1;var i=it;it|=4,Bp.current=null,yb(e,t),ay(t,e),Y_(rd),lu=!!td,rd=td=null,e.current=t,wb(t),Q2(),it=i,mt=o,gn.transition=s}else e.current=t;if(vc&&(vc=!1,Ka=e,Eu=a),s=e.pendingLanes,s===0&&(ns=null),J2(t.stateNode),Gr(e,$t()),r!==null)for(n=e.onRecoverableError,t=0;t<r.length;t++)a=r[t],n(a.value,{componentStack:a.stack,digest:a.digest});if(bu)throw bu=!1,e=_d,_d=null,e;return Eu&1&&e.tag!==0&&Lo(),s=e.pendingLanes,s&1?e===bd?Qi++:(Qi=0,bd=e):Qi=0,vs(),null}function Lo(){if(Ka!==null){var e=Hv(Eu),r=gn.transition,t=mt;try{if(gn.transition=null,mt=16>e?16:e,Ka===null)var n=!1;else{if(e=Ka,Ka=null,Eu=0,it&6)throw Error(ke(331));var a=it;for(it|=4,Oe=e.current;Oe!==null;){var s=Oe,o=s.child;if(Oe.flags&16){var i=s.deletions;if(i!==null){for(var l=0;l<i.length;l++){var c=i[l];for(Oe=c;Oe!==null;){var u=Oe;switch(u.tag){case 0:case 11:case 15:Gi(8,u,s)}var d=u.child;if(d!==null)d.return=u,Oe=d;else for(;Oe!==null;){u=Oe;var p=u.sibling,h=u.return;if(ty(u),u===c){Oe=null;break}if(p!==null){p.return=h,Oe=p;break}Oe=h}}}var x=s.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}Oe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Oe=o;else e:for(;Oe!==null;){if(s=Oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Gi(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,Oe=g;break e}Oe=s.return}}var w=e.current;for(Oe=w;Oe!==null;){o=Oe;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,Oe=v;else e:for(o=w;Oe!==null;){if(i=Oe,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:d0(9,i)}}catch(M){jt(i,i.return,M)}if(i===o){Oe=null;break e}var b=i.sibling;if(b!==null){b.return=i.return,Oe=b;break e}Oe=i.return}}if(it=a,vs(),ra&&typeof ra.onPostCommitFiberRoot=="function")try{ra.onPostCommitFiberRoot(a0,e)}catch{}n=!0}return n}finally{mt=t,gn.transition=r}}return!1}function Qm(e,r,t){r=Qo(t,r),r=H1(e,r,1),e=rs(e,r,1),r=Lr(),e!==null&&(zl(e,1,r),Gr(e,r))}function jt(e,r,t){if(e.tag===3)Qm(e,e,t);else for(;r!==null;){if(r.tag===3){Qm(r,e,t);break}else if(r.tag===1){var n=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ns===null||!ns.has(n))){e=Qo(t,e),e=Y1(r,e,1),r=rs(r,e,1),e=Lr(),r!==null&&(zl(r,1,e),Gr(r,e));break}}r=r.return}}function Tb(e,r,t){var n=e.pingCache;n!==null&&n.delete(r),r=Lr(),e.pingedLanes|=e.suspendedLanes&t,ar===e&&(fr&t)===t&&(Zt===4||Zt===3&&(fr&130023424)===fr&&500>$t()-Up?Ps(e,0):Wp|=t),Gr(e,r)}function fy(e,r){r===0&&(e.mode&1?(r=lc,lc<<=1,!(lc&130023424)&&(lc=4194304)):r=1);var t=Lr();e=Fa(e,r),e!==null&&(zl(e,r,t),Gr(e,t))}function Cb(e){var r=e.memoizedState,t=0;r!==null&&(t=r.retryLane),fy(e,t)}function Db(e,r){var t=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(t=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ke(314))}n!==null&&n.delete(r),fy(e,t)}var dy;dy=function(e,r,t){if(e!==null)if(e.memoizedProps!==r.pendingProps||Vr.current)Yr=!0;else{if(!(e.lanes&t)&&!(r.flags&128))return Yr=!1,mb(e,r,t);Yr=!!(e.flags&131072)}else Yr=!1,At&&r.flags&1048576&&x1(r,mu,r.index);switch(r.lanes=0,r.tag){case 2:var n=r.type;Vc(e,r),e=r.pendingProps;var a=Vo(r,Tr.current);jo(r,t),a=Rp(null,r,n,e,a,t);var s=Ip();return r.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Kr(n)?(s=!0,pu(r)):s=!1,r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Fp(r),a.updater=f0,r.stateNode=a,a._reactInternals=r,fd(r,n,e,t),r=hd(null,r,n,!0,s,t)):(r.tag=0,At&&s&&bp(r),Fr(null,r,a,t),r=r.child),r;case 16:n=r.elementType;e:{switch(Vc(e,r),e=r.pendingProps,a=n._init,n=a(n._payload),r.type=n,a=r.tag=Fb(n),e=Tn(n,e),a){case 0:r=pd(null,r,n,e,t);break e;case 1:r=Bm(null,r,n,e,t);break e;case 11:r=Lm(null,r,n,e,t);break e;case 14:r=zm(null,r,n,Tn(n.type,e),t);break e}throw Error(ke(306,n,""))}return r;case 0:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Tn(n,a),pd(e,r,n,a,t);case 1:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Tn(n,a),Bm(e,r,n,a,t);case 3:e:{if(X1(r),e===null)throw Error(ke(387));n=r.pendingProps,s=r.memoizedState,a=s.element,_1(e,r),vu(r,n,null,t);var o=r.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},r.updateQueue.baseState=s,r.memoizedState=s,r.flags&256){a=Qo(Error(ke(423)),r),r=Wm(e,r,n,t,a);break e}else if(n!==a){a=Qo(Error(ke(424)),r),r=Wm(e,r,n,t,a);break e}else for(Zr=ts(r.stateNode.containerInfo.firstChild),Jr=r,At=!0,Nn=null,t=w1(r,null,n,t),r.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ko(),n===a){r=Aa(e,r,t);break e}Fr(e,r,n,t)}r=r.child}return r;case 5:return b1(r),e===null&&ld(r),n=r.type,a=r.pendingProps,s=e!==null?e.memoizedProps:null,o=a.children,nd(n,a)?o=null:s!==null&&nd(n,s)&&(r.flags|=32),G1(e,r),Fr(e,r,o,t),r.child;case 6:return e===null&&ld(r),null;case 13:return Q1(e,r,t);case 4:return Ap(r,r.stateNode.containerInfo),n=r.pendingProps,e===null?r.child=Go(r,null,n,t):Fr(e,r,n,t),r.child;case 11:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Tn(n,a),Lm(e,r,n,a,t);case 7:return Fr(e,r,r.pendingProps,t),r.child;case 8:return Fr(e,r,r.pendingProps.children,t),r.child;case 12:return Fr(e,r,r.pendingProps.children,t),r.child;case 10:e:{if(n=r.type._context,a=r.pendingProps,s=r.memoizedProps,o=a.value,bt(xu,n._currentValue),n._currentValue=o,s!==null)if(Ln(s.value,o)){if(s.children===a.children&&!Vr.current){r=Aa(e,r,t);break e}}else for(s=r.child,s!==null&&(s.return=r);s!==null;){var i=s.dependencies;if(i!==null){o=s.child;for(var l=i.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=wa(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),cd(s.return,t,r),i.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===r.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ke(341));o.lanes|=t,i=o.alternate,i!==null&&(i.lanes|=t),cd(o,t,r),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===r){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Fr(e,r,a.children,t),r=r.child}return r;case 9:return a=r.type,n=r.pendingProps.children,jo(r,t),a=vn(a),n=n(a),r.flags|=1,Fr(e,r,n,t),r.child;case 14:return n=r.type,a=Tn(n,r.pendingProps),a=Tn(n.type,a),zm(e,r,n,a,t);case 15:return V1(e,r,r.type,r.pendingProps,t);case 17:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Tn(n,a),Vc(e,r),r.tag=1,Kr(n)?(e=!0,pu(r)):e=!1,jo(r,t),$1(r,n,a),fd(r,n,a,t),hd(null,r,n,!0,e,t);case 19:return q1(e,r,t);case 22:return K1(e,r,t)}throw Error(ke(156,r.tag))};function py(e,r){return Bv(e,r)}function Nb(e,r,t,n){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(e,r,t,n){return new Nb(e,r,t,n)}function Vp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fb(e){if(typeof e=="function")return Vp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===fp)return 11;if(e===dp)return 14}return 2}function ss(e,r){var t=e.alternate;return t===null?(t=xn(e.tag,r,e.key,e.mode),t.elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=r,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=e.flags&14680064,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,r=e.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t}function Xc(e,r,t,n,a,s){var o=2;if(n=e,typeof e=="function")Vp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case wo:return Ms(t.children,a,s,r);case up:o=8,a|=8;break;case Rf:return e=xn(12,t,r,a|2),e.elementType=Rf,e.lanes=s,e;case If:return e=xn(13,t,r,a),e.elementType=If,e.lanes=s,e;case jf:return e=xn(19,t,r,a),e.elementType=jf,e.lanes=s,e;case bv:return h0(t,a,s,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case kv:o=10;break e;case _v:o=9;break e;case fp:o=11;break e;case dp:o=14;break e;case Ba:o=16,n=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return r=xn(o,t,r,a),r.elementType=e,r.type=n,r.lanes=s,r}function Ms(e,r,t,n){return e=xn(7,e,n,r),e.lanes=t,e}function h0(e,r,t,n){return e=xn(22,e,n,r),e.elementType=bv,e.lanes=t,e.stateNode={isHidden:!1},e}function of(e,r,t){return e=xn(6,e,null,r),e.lanes=t,e}function lf(e,r,t){return r=xn(4,e.children!==null?e.children:[],e.key,r),r.lanes=t,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function Ab(e,r,t,n,a){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=W0(0),this.expirationTimes=W0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=W0(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Kp(e,r,t,n,a,s,o,i,l){return e=new Ab(e,r,t,i,l),r===1?(r=1,s===!0&&(r|=8)):r=0,s=xn(3,null,null,r),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fp(s),e}function Ob(e,r,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yo,key:n==null?null:""+n,children:e,containerInfo:r,implementation:t}}function hy(e){if(!e)return us;e=e._reactInternals;e:{if(no(e)!==e||e.tag!==1)throw Error(ke(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Kr(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(ke(171))}if(e.tag===1){var t=e.type;if(Kr(t))return h1(e,t,r)}return r}function my(e,r,t,n,a,s,o,i,l){return e=Kp(t,n,!0,e,a,s,o,i,l),e.context=hy(null),t=e.current,n=Lr(),a=as(t),s=wa(n,a),s.callback=r??null,rs(t,s,a),e.current.lanes=a,zl(e,a,n),Gr(e,n),e}function m0(e,r,t,n){var a=r.current,s=Lr(),o=as(a);return t=hy(t),r.context===null?r.context=t:r.pendingContext=t,r=wa(s,o),r.payload={element:e},n=n===void 0?null:n,n!==null&&(r.callback=n),e=rs(a,r,o),e!==null&&(Mn(e,a,o,s),$c(e,a,o)),o}function Tu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function qm(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var t=e.retryLane;e.retryLane=t!==0&&t<r?t:r}}function Gp(e,r){qm(e,r),(e=e.alternate)&&qm(e,r)}function Pb(){return null}var xy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Xp(e){this._internalRoot=e}x0.prototype.render=Xp.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(ke(409));m0(e,r,null,null)};x0.prototype.unmount=Xp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;Ks(function(){m0(null,e,null,null)}),r[Na]=null}};function x0(e){this._internalRoot=e}x0.prototype.unstable_scheduleHydration=function(e){if(e){var r=Kv();e={blockedOn:null,target:e,priority:r};for(var t=0;t<Ua.length&&r!==0&&r<Ua[t].priority;t++);Ua.splice(t,0,e),t===0&&Xv(e)}};function Qp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function g0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Zm(){}function Mb(e,r,t,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Tu(o);s.call(c)}}var o=my(r,n,e,0,null,!1,!1,"",Zm);return e._reactRootContainer=o,e[Na]=o.current,gl(e.nodeType===8?e.parentNode:e),Ks(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var i=n;n=function(){var c=Tu(l);i.call(c)}}var l=Kp(e,0,!1,null,null,!1,!1,"",Zm);return e._reactRootContainer=l,e[Na]=l.current,gl(e.nodeType===8?e.parentNode:e),Ks(function(){m0(r,l,t,n)}),l}function v0(e,r,t,n,a){var s=t._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var i=a;a=function(){var l=Tu(o);i.call(l)}}m0(r,o,e,a)}else o=Mb(t,r,e,a,n);return Tu(o)}Yv=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var t=Mi(r.pendingLanes);t!==0&&(mp(r,t|1),Gr(r,$t()),!(it&6)&&(qo=$t()+500,vs()))}break;case 13:Ks(function(){var n=Fa(e,1);if(n!==null){var a=Lr();Mn(n,e,1,a)}}),Gp(e,1)}};xp=function(e){if(e.tag===13){var r=Fa(e,134217728);if(r!==null){var t=Lr();Mn(r,e,134217728,t)}Gp(e,134217728)}};Vv=function(e){if(e.tag===13){var r=as(e),t=Fa(e,r);if(t!==null){var n=Lr();Mn(t,e,r,n)}Gp(e,r)}};Kv=function(){return mt};Gv=function(e,r){var t=mt;try{return mt=e,r()}finally{mt=t}};Kf=function(e,r,t){switch(r){case"input":if(Bf(e,t),r=t.name,t.type==="radio"&&r!=null){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<t.length;r++){var n=t[r];if(n!==e&&n.form===e.form){var a=l0(n);if(!a)throw Error(ke(90));Sv(n),Bf(n,a)}}}break;case"textarea":Cv(e,t);break;case"select":r=t.value,r!=null&&Po(e,!!t.multiple,r,!1)}};Mv=$p;Rv=Ks;var Rb={usingClientEntryPoint:!1,Events:[Wl,Eo,l0,Ov,Pv,$p]},Ni={findFiberByHostInstance:Cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ib={bundleType:Ni.bundleType,version:Ni.version,rendererPackageName:Ni.rendererPackageName,rendererConfig:Ni.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ma.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Lv(e),e===null?null:e.stateNode},findFiberByHostInstance:Ni.findFiberByHostInstance||Pb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yc.isDisabled&&yc.supportsFiber)try{a0=yc.inject(Ib),ra=yc}catch{}}nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rb;nn.createPortal=function(e,r){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qp(r))throw Error(ke(200));return Ob(e,r,null,t)};nn.createRoot=function(e,r){if(!Qp(e))throw Error(ke(299));var t=!1,n="",a=xy;return r!=null&&(r.unstable_strictMode===!0&&(t=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),r=Kp(e,1,!1,null,null,t,!1,n,a),e[Na]=r.current,gl(e.nodeType===8?e.parentNode:e),new Xp(r)};nn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=Lv(r),e=e===null?null:e.stateNode,e};nn.flushSync=function(e){return Ks(e)};nn.hydrate=function(e,r,t){if(!g0(r))throw Error(ke(200));return v0(null,e,r,!0,t)};nn.hydrateRoot=function(e,r,t){if(!Qp(e))throw Error(ke(405));var n=t!=null&&t.hydratedSources||null,a=!1,s="",o=xy;if(t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),r=my(r,null,e,1,t??null,a,!1,s,o),e[Na]=r.current,gl(e),n)for(e=0;e<n.length;e++)t=n[e],a=t._getVersion,a=a(t._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[t,a]:r.mutableSourceEagerHydrationData.push(t,a);return new x0(r)};nn.render=function(e,r,t){if(!g0(r))throw Error(ke(200));return v0(null,e,r,!1,t)};nn.unmountComponentAtNode=function(e){if(!g0(e))throw Error(ke(40));return e._reactRootContainer?(Ks(function(){v0(null,null,e,!1,function(){e._reactRootContainer=null,e[Na]=null})}),!0):!1};nn.unstable_batchedUpdates=$p;nn.unstable_renderSubtreeIntoContainer=function(e,r,t,n){if(!g0(t))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return v0(e,r,t,!1,n)};nn.version="18.3.1-next-f1338f8080-20240426";function gy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gy)}catch(e){console.error(e)}}gy(),gv.exports=nn;var y0=gv.exports;const jb=r0(y0);var vy,Jm=y0;vy=Jm.createRoot,Jm.hydrateRoot;/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Wn=(e,r)=>{const t=S.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:i="",children:l,...c},u)=>S.createElement("svg",{ref:u,...Lb,width:a,height:a,stroke:n,strokeWidth:o?Number(s)*24/Number(a):s,className:["lucide",`lucide-${zb(e)}`,i].join(" "),...c},[...r.map(([d,p])=>S.createElement(d,p)),...Array.isArray(l)?l:[l]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=Wn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=Wn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=Wn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=Wn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=Wn("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=Wn("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Wn("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Wn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=Wn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=Wn("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=Wn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Td={exports:{}},Gs={},yy={exports:{}},$b="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Hb=$b,Yb=Hb;function wy(){}function ky(){}ky.resetWarningCache=wy;var Vb=function(){function e(n,a,s,o,i,l){if(l!==Yb){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function r(){return e}var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:ky,resetWarningCache:wy};return t.PropTypes=t,t};yy.exports=Vb();var _y=yy.exports,Cd={exports:{}},Un={},Dd={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=u;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",n="contents",a=/^(input|select|textarea|button|object|iframe)$/;function s(d,p){return p.getPropertyValue("overflow")!=="visible"||d.scrollWidth<=0&&d.scrollHeight<=0}function o(d){var p=d.offsetWidth<=0&&d.offsetHeight<=0;if(p&&!d.innerHTML)return!0;try{var h=window.getComputedStyle(d),x=h.getPropertyValue("display");return p?x!==n&&s(d,h):x===t}catch{return console.warn("Failed to inspect element style"),!1}}function i(d){for(var p=d,h=d.getRootNode&&d.getRootNode();p&&p!==document.body;){if(h&&p===h&&(p=h.host.parentNode),o(p))return!1;p=p.parentNode}return!0}function l(d,p){var h=d.nodeName.toLowerCase(),x=a.test(h)&&!d.disabled||h==="a"&&d.href||p;return x&&i(d)}function c(d){var p=d.getAttribute("tabindex");p===null&&(p=void 0);var h=isNaN(p);return(h||p>=0)&&l(d,!h)}function u(d){var p=[].slice.call(d.querySelectorAll("*"),0).reduce(function(h,x){return h.concat(x.shadowRoot?u(x.shadowRoot):[x])},[]);return p.filter(c)}e.exports=r.default})(Dd,Dd.exports);var by=Dd.exports;Object.defineProperty(Un,"__esModule",{value:!0});Un.resetState=Qb;Un.log=qb;Un.handleBlur=Tl;Un.handleFocus=Cl;Un.markForFocusLater=Zb;Un.returnFocus=Jb;Un.popWithoutFocus=eE;Un.setupScopedFocus=tE;Un.teardownScopedFocus=rE;var Kb=by,Gb=Xb(Kb);function Xb(e){return e&&e.__esModule?e:{default:e}}var Jo=[],Ao=null,Nd=!1;function Qb(){Jo=[]}function qb(){}function Tl(){Nd=!0}function Cl(){if(Nd){if(Nd=!1,!Ao)return;setTimeout(function(){if(!Ao.contains(document.activeElement)){var e=(0,Gb.default)(Ao)[0]||Ao;e.focus()}},0)}}function Zb(){Jo.push(document.activeElement)}function Jb(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=null;try{Jo.length!==0&&(r=Jo.pop(),r.focus({preventScroll:e}));return}catch{console.warn(["You tried to return focus to",r,"but it is not in the DOM anymore"].join(" "))}}function eE(){Jo.length>0&&Jo.pop()}function tE(e){Ao=e,window.addEventListener?(window.addEventListener("blur",Tl,!1),document.addEventListener("focus",Cl,!0)):(window.attachEvent("onBlur",Tl),document.attachEvent("onFocus",Cl))}function rE(){Ao=null,window.addEventListener?(window.removeEventListener("blur",Tl),document.removeEventListener("focus",Cl)):(window.detachEvent("onBlur",Tl),document.detachEvent("onFocus",Cl))}var Fd={exports:{}};(function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var t=by,n=a(t);function a(i){return i&&i.__esModule?i:{default:i}}function s(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return i.activeElement.shadowRoot?s(i.activeElement.shadowRoot):i.activeElement}function o(i,l){var c=(0,n.default)(i);if(!c.length){l.preventDefault();return}var u=void 0,d=l.shiftKey,p=c[0],h=c[c.length-1],x=s();if(i===x){if(!d)return;u=h}if(h===x&&!d&&(u=p),p===x&&d&&(u=h),u){l.preventDefault(),u.focus();return}var m=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),y=m!=null&&m[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(y){var g=c.indexOf(x);if(g>-1&&(g+=d?-1:1),u=c[g],typeof u>"u"){l.preventDefault(),u=d?h:p,u.focus();return}l.preventDefault(),u.focus()}}e.exports=r.default})(Fd,Fd.exports);var nE=Fd.exports,$n={},aE=function(){},sE=aE,Rn={},Ey={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(e){(function(){var r=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:r,canUseWorkers:typeof Worker<"u",canUseEventListeners:r&&!!(window.addEventListener||window.attachEvent),canUseViewport:r&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(Ey);var oE=Ey.exports;Object.defineProperty(Rn,"__esModule",{value:!0});Rn.canUseDOM=Rn.SafeNodeList=Rn.SafeHTMLCollection=void 0;var iE=oE,lE=cE(iE);function cE(e){return e&&e.__esModule?e:{default:e}}var k0=lE.default,uE=k0.canUseDOM?window.HTMLElement:{};Rn.SafeHTMLCollection=k0.canUseDOM?window.HTMLCollection:{};Rn.SafeNodeList=k0.canUseDOM?window.NodeList:{};Rn.canUseDOM=k0.canUseDOM;Rn.default=uE;Object.defineProperty($n,"__esModule",{value:!0});$n.resetState=mE;$n.log=xE;$n.assertNodeList=Sy;$n.setElement=gE;$n.validateElement=th;$n.hide=vE;$n.show=yE;$n.documentNotReadyOrSSRTesting=wE;var fE=sE,dE=hE(fE),pE=Rn;function hE(e){return e&&e.__esModule?e:{default:e}}var fn=null;function mE(){fn&&(fn.removeAttribute?fn.removeAttribute("aria-hidden"):fn.length!=null?fn.forEach(function(e){return e.removeAttribute("aria-hidden")}):document.querySelectorAll(fn).forEach(function(e){return e.removeAttribute("aria-hidden")})),fn=null}function xE(){}function Sy(e,r){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+r+".")}function gE(e){var r=e;if(typeof r=="string"&&pE.canUseDOM){var t=document.querySelectorAll(r);Sy(t,r),r=t}return fn=r||fn,fn}function th(e){var r=e||fn;return r?Array.isArray(r)||r instanceof HTMLCollection||r instanceof NodeList?r:[r]:((0,dE.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function vE(e){var r=!0,t=!1,n=void 0;try{for(var a=th(e)[Symbol.iterator](),s;!(r=(s=a.next()).done);r=!0){var o=s.value;o.setAttribute("aria-hidden","true")}}catch(i){t=!0,n=i}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}}function yE(e){var r=!0,t=!1,n=void 0;try{for(var a=th(e)[Symbol.iterator](),s;!(r=(s=a.next()).done);r=!0){var o=s.value;o.removeAttribute("aria-hidden")}}catch(i){t=!0,n=i}finally{try{!r&&a.return&&a.return()}finally{if(t)throw n}}}function wE(){fn=null}var fi={};Object.defineProperty(fi,"__esModule",{value:!0});fi.resetState=kE;fi.log=_E;var qi={},Zi={};function ex(e,r){e.classList.remove(r)}function kE(){var e=document.getElementsByTagName("html")[0];for(var r in qi)ex(e,qi[r]);var t=document.body;for(var n in Zi)ex(t,Zi[n]);qi={},Zi={}}function _E(){}var bE=function(r,t){return r[t]||(r[t]=0),r[t]+=1,t},EE=function(r,t){return r[t]&&(r[t]-=1),t},SE=function(r,t,n){n.forEach(function(a){bE(t,a),r.add(a)})},TE=function(r,t,n){n.forEach(function(a){EE(t,a),t[a]===0&&r.remove(a)})};fi.add=function(r,t){return SE(r.classList,r.nodeName.toLowerCase()=="html"?qi:Zi,t.split(" "))};fi.remove=function(r,t){return TE(r.classList,r.nodeName.toLowerCase()=="html"?qi:Zi,t.split(" "))};var di={};Object.defineProperty(di,"__esModule",{value:!0});di.log=DE;di.resetState=NE;function CE(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var Ty=function e(){var r=this;CE(this,e),this.register=function(t){r.openInstances.indexOf(t)===-1&&(r.openInstances.push(t),r.emit("register"))},this.deregister=function(t){var n=r.openInstances.indexOf(t);n!==-1&&(r.openInstances.splice(n,1),r.emit("deregister"))},this.subscribe=function(t){r.subscribers.push(t)},this.emit=function(t){r.subscribers.forEach(function(n){return n(t,r.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},Cu=new Ty;function DE(){console.log("portalOpenInstances ----------"),console.log(Cu.openInstances.length),Cu.openInstances.forEach(function(e){return console.log(e)}),console.log("end portalOpenInstances ----------")}function NE(){Cu=new Ty}di.default=Cu;var rh={};Object.defineProperty(rh,"__esModule",{value:!0});rh.resetState=PE;rh.log=ME;var FE=di,AE=OE(FE);function OE(e){return e&&e.__esModule?e:{default:e}}var wr=void 0,Cn=void 0,Is=[];function PE(){for(var e=[wr,Cn],r=0;r<e.length;r++){var t=e[r];t&&t.parentNode&&t.parentNode.removeChild(t)}wr=Cn=null,Is=[]}function ME(){console.log("bodyTrap ----------"),console.log(Is.length);for(var e=[wr,Cn],r=0;r<e.length;r++){var t=e[r],n=t||{};console.log(n.nodeName,n.className,n.id)}console.log("edn bodyTrap ----------")}function tx(){Is.length!==0&&Is[Is.length-1].focusContent()}function RE(e,r){!wr&&!Cn&&(wr=document.createElement("div"),wr.setAttribute("data-react-modal-body-trap",""),wr.style.position="absolute",wr.style.opacity="0",wr.setAttribute("tabindex","0"),wr.addEventListener("focus",tx),Cn=wr.cloneNode(),Cn.addEventListener("focus",tx)),Is=r,Is.length>0?(document.body.firstChild!==wr&&document.body.insertBefore(wr,document.body.firstChild),document.body.lastChild!==Cn&&document.body.appendChild(Cn)):(wr.parentElement&&wr.parentElement.removeChild(wr),Cn.parentElement&&Cn.parentElement.removeChild(Cn))}AE.default.subscribe(RE);(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(ee){for(var J=1;J<arguments.length;J++){var ne=arguments[J];for(var B in ne)Object.prototype.hasOwnProperty.call(ne,B)&&(ee[B]=ne[B])}return ee},n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},a=function(){function ee(J,ne){for(var B=0;B<ne.length;B++){var q=ne[B];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(J,q.key,q)}}return function(J,ne,B){return ne&&ee(J.prototype,ne),B&&ee(J,B),J}}(),s=S,o=_y,i=M(o),l=Un,c=b(l),u=nE,d=M(u),p=$n,h=b(p),x=fi,m=b(x),y=Rn,g=M(y),w=di,v=M(w);function b(ee){if(ee&&ee.__esModule)return ee;var J={};if(ee!=null)for(var ne in ee)Object.prototype.hasOwnProperty.call(ee,ne)&&(J[ne]=ee[ne]);return J.default=ee,J}function M(ee){return ee&&ee.__esModule?ee:{default:ee}}function C(ee,J){if(!(ee instanceof J))throw new TypeError("Cannot call a class as a function")}function k(ee,J){if(!ee)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return J&&(typeof J=="object"||typeof J=="function")?J:ee}function F(ee,J){if(typeof J!="function"&&J!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof J);ee.prototype=Object.create(J&&J.prototype,{constructor:{value:ee,enumerable:!1,writable:!0,configurable:!0}}),J&&(Object.setPrototypeOf?Object.setPrototypeOf(ee,J):ee.__proto__=J)}var E={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},j=function(J){return J.code==="Tab"||J.keyCode===9},V=function(J){return J.code==="Escape"||J.keyCode===27},W=0,te=function(ee){F(J,ee);function J(ne){C(this,J);var B=k(this,(J.__proto__||Object.getPrototypeOf(J)).call(this,ne));return B.setOverlayRef=function(q){B.overlay=q,B.props.overlayRef&&B.props.overlayRef(q)},B.setContentRef=function(q){B.content=q,B.props.contentRef&&B.props.contentRef(q)},B.afterClose=function(){var q=B.props,N=q.appElement,U=q.ariaHideApp,Z=q.htmlOpenClassName,_=q.bodyOpenClassName,P=q.parentSelector,A=P&&P().ownerDocument||document;_&&m.remove(A.body,_),Z&&m.remove(A.getElementsByTagName("html")[0],Z),U&&W>0&&(W-=1,W===0&&h.show(N)),B.props.shouldFocusAfterRender&&(B.props.shouldReturnFocusAfterClose?(c.returnFocus(B.props.preventScroll),c.teardownScopedFocus()):c.popWithoutFocus()),B.props.onAfterClose&&B.props.onAfterClose(),v.default.deregister(B)},B.open=function(){B.beforeOpen(),B.state.afterOpen&&B.state.beforeClose?(clearTimeout(B.closeTimer),B.setState({beforeClose:!1})):(B.props.shouldFocusAfterRender&&(c.setupScopedFocus(B.node),c.markForFocusLater()),B.setState({isOpen:!0},function(){B.openAnimationFrame=requestAnimationFrame(function(){B.setState({afterOpen:!0}),B.props.isOpen&&B.props.onAfterOpen&&B.props.onAfterOpen({overlayEl:B.overlay,contentEl:B.content})})}))},B.close=function(){B.props.closeTimeoutMS>0?B.closeWithTimeout():B.closeWithoutTimeout()},B.focusContent=function(){return B.content&&!B.contentHasFocus()&&B.content.focus({preventScroll:!0})},B.closeWithTimeout=function(){var q=Date.now()+B.props.closeTimeoutMS;B.setState({beforeClose:!0,closesAt:q},function(){B.closeTimer=setTimeout(B.closeWithoutTimeout,B.state.closesAt-Date.now())})},B.closeWithoutTimeout=function(){B.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},B.afterClose)},B.handleKeyDown=function(q){j(q)&&(0,d.default)(B.content,q),B.props.shouldCloseOnEsc&&V(q)&&(q.stopPropagation(),B.requestClose(q))},B.handleOverlayOnClick=function(q){B.shouldClose===null&&(B.shouldClose=!0),B.shouldClose&&B.props.shouldCloseOnOverlayClick&&(B.ownerHandlesClose()?B.requestClose(q):B.focusContent()),B.shouldClose=null},B.handleContentOnMouseUp=function(){B.shouldClose=!1},B.handleOverlayOnMouseDown=function(q){!B.props.shouldCloseOnOverlayClick&&q.target==B.overlay&&q.preventDefault()},B.handleContentOnClick=function(){B.shouldClose=!1},B.handleContentOnMouseDown=function(){B.shouldClose=!1},B.requestClose=function(q){return B.ownerHandlesClose()&&B.props.onRequestClose(q)},B.ownerHandlesClose=function(){return B.props.onRequestClose},B.shouldBeClosed=function(){return!B.state.isOpen&&!B.state.beforeClose},B.contentHasFocus=function(){return document.activeElement===B.content||B.content.contains(document.activeElement)},B.buildClassName=function(q,N){var U=(typeof N>"u"?"undefined":n(N))==="object"?N:{base:E[q],afterOpen:E[q]+"--after-open",beforeClose:E[q]+"--before-close"},Z=U.base;return B.state.afterOpen&&(Z=Z+" "+U.afterOpen),B.state.beforeClose&&(Z=Z+" "+U.beforeClose),typeof N=="string"&&N?Z+" "+N:Z},B.attributesFromObject=function(q,N){return Object.keys(N).reduce(function(U,Z){return U[q+"-"+Z]=N[Z],U},{})},B.state={afterOpen:!1,beforeClose:!1},B.shouldClose=null,B.moveFromContentToOverlay=null,B}return a(J,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(B,q){this.props.isOpen&&!B.isOpen?this.open():!this.props.isOpen&&B.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!q.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var B=this.props,q=B.appElement,N=B.ariaHideApp,U=B.htmlOpenClassName,Z=B.bodyOpenClassName,_=B.parentSelector,P=_&&_().ownerDocument||document;Z&&m.add(P.body,Z),U&&m.add(P.getElementsByTagName("html")[0],U),N&&(W+=1,h.hide(q)),v.default.register(this)}},{key:"render",value:function(){var B=this.props,q=B.id,N=B.className,U=B.overlayClassName,Z=B.defaultStyles,_=B.children,P=N?{}:Z.content,A=U?{}:Z.overlay;if(this.shouldBeClosed())return null;var z={ref:this.setOverlayRef,className:this.buildClassName("overlay",U),style:t({},A,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},Q=t({id:q,ref:this.setContentRef,style:t({},P,this.props.style.content),className:this.buildClassName("content",N),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),re=this.props.contentElement(Q,_);return this.props.overlayElement(z,re)}}]),J}(s.Component);te.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},te.propTypes={isOpen:i.default.bool.isRequired,defaultStyles:i.default.shape({content:i.default.object,overlay:i.default.object}),style:i.default.shape({content:i.default.object,overlay:i.default.object}),className:i.default.oneOfType([i.default.string,i.default.object]),overlayClassName:i.default.oneOfType([i.default.string,i.default.object]),parentSelector:i.default.func,bodyOpenClassName:i.default.string,htmlOpenClassName:i.default.string,ariaHideApp:i.default.bool,appElement:i.default.oneOfType([i.default.instanceOf(g.default),i.default.instanceOf(y.SafeHTMLCollection),i.default.instanceOf(y.SafeNodeList),i.default.arrayOf(i.default.instanceOf(g.default))]),onAfterOpen:i.default.func,onAfterClose:i.default.func,onRequestClose:i.default.func,closeTimeoutMS:i.default.number,shouldFocusAfterRender:i.default.bool,shouldCloseOnOverlayClick:i.default.bool,shouldReturnFocusAfterClose:i.default.bool,preventScroll:i.default.bool,role:i.default.string,contentLabel:i.default.string,aria:i.default.object,data:i.default.object,children:i.default.node,shouldCloseOnEsc:i.default.bool,overlayRef:i.default.func,contentRef:i.default.func,id:i.default.string,overlayElement:i.default.func,contentElement:i.default.func,testId:i.default.string},r.default=te,e.exports=r.default})(Cd,Cd.exports);var IE=Cd.exports;function Cy(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Dy(e){function r(t){var n=this.constructor.getDerivedStateFromProps(e,t);return n??null}this.setState(r.bind(this))}function Ny(e,r){try{var t=this.props,n=this.state;this.props=e,this.state=r,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,n)}finally{this.props=t,this.state=n}}Cy.__suppressDeprecationWarning=!0;Dy.__suppressDeprecationWarning=!0;Ny.__suppressDeprecationWarning=!0;function jE(e){var r=e.prototype;if(!r||!r.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof r.getSnapshotBeforeUpdate!="function")return e;var t=null,n=null,a=null;if(typeof r.componentWillMount=="function"?t="componentWillMount":typeof r.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof r.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof r.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof r.componentWillUpdate=="function"?a="componentWillUpdate":typeof r.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||n!==null||a!==null){var s=e.displayName||e.name,o=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+o+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(r.componentWillMount=Cy,r.componentWillReceiveProps=Dy),typeof r.getSnapshotBeforeUpdate=="function"){if(typeof r.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");r.componentWillUpdate=Ny;var i=r.componentDidUpdate;r.componentDidUpdate=function(c,u,d){var p=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:d;i.call(this,c,u,p)}}return e}const LE=Object.freeze(Object.defineProperty({__proto__:null,polyfill:jE},Symbol.toStringTag,{value:"Module"})),zE=f2(LE);Object.defineProperty(Gs,"__esModule",{value:!0});Gs.bodyOpenClassName=Gs.portalClassName=void 0;var rx=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},BE=function(){function e(r,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),Fy=S,Du=$l(Fy),WE=y0,Nu=$l(WE),UE=_y,Ve=$l(UE),$E=IE,nx=$l($E),HE=$n,YE=KE(HE),Ga=Rn,ax=$l(Ga),VE=zE;function KE(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function $l(e){return e&&e.__esModule?e:{default:e}}function GE(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function sx(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:e}function XE(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var QE=Gs.portalClassName="ReactModalPortal",qE=Gs.bodyOpenClassName="ReactModal__Body--open",Es=Ga.canUseDOM&&Nu.default.createPortal!==void 0,ox=function(r){return document.createElement(r)},ix=function(){return Es?Nu.default.createPortal:Nu.default.unstable_renderSubtreeIntoContainer};function wc(e){return e()}var Hl=function(e){XE(r,e);function r(){var t,n,a,s;GE(this,r);for(var o=arguments.length,i=Array(o),l=0;l<o;l++)i[l]=arguments[l];return s=(n=(a=sx(this,(t=r.__proto__||Object.getPrototypeOf(r)).call.apply(t,[this].concat(i))),a),a.removePortal=function(){!Es&&Nu.default.unmountComponentAtNode(a.node);var c=wc(a.props.parentSelector);c&&c.contains(a.node)?c.removeChild(a.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},a.portalRef=function(c){a.portal=c},a.renderPortal=function(c){var u=ix(),d=u(a,Du.default.createElement(nx.default,rx({defaultStyles:r.defaultStyles},c)),a.node);a.portalRef(d)},n),sx(a,s)}return BE(r,[{key:"componentDidMount",value:function(){if(Ga.canUseDOM){Es||(this.node=ox("div")),this.node.className=this.props.portalClassName;var n=wc(this.props.parentSelector);n.appendChild(this.node),!Es&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(n){var a=wc(n.parentSelector),s=wc(this.props.parentSelector);return{prevParent:a,nextParent:s}}},{key:"componentDidUpdate",value:function(n,a,s){if(Ga.canUseDOM){var o=this.props,i=o.isOpen,l=o.portalClassName;n.portalClassName!==l&&(this.node.className=l);var c=s.prevParent,u=s.nextParent;u!==c&&(c.removeChild(this.node),u.appendChild(this.node)),!(!n.isOpen&&!i)&&!Es&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!Ga.canUseDOM||!this.node||!this.portal)){var n=this.portal.state,a=Date.now(),s=n.isOpen&&this.props.closeTimeoutMS&&(n.closesAt||a+this.props.closeTimeoutMS);s?(n.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,s-a)):this.removePortal()}}},{key:"render",value:function(){if(!Ga.canUseDOM||!Es)return null;!this.node&&Es&&(this.node=ox("div"));var n=ix();return n(Du.default.createElement(nx.default,rx({ref:this.portalRef,defaultStyles:r.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(n){YE.setElement(n)}}]),r}(Fy.Component);Hl.propTypes={isOpen:Ve.default.bool.isRequired,style:Ve.default.shape({content:Ve.default.object,overlay:Ve.default.object}),portalClassName:Ve.default.string,bodyOpenClassName:Ve.default.string,htmlOpenClassName:Ve.default.string,className:Ve.default.oneOfType([Ve.default.string,Ve.default.shape({base:Ve.default.string.isRequired,afterOpen:Ve.default.string.isRequired,beforeClose:Ve.default.string.isRequired})]),overlayClassName:Ve.default.oneOfType([Ve.default.string,Ve.default.shape({base:Ve.default.string.isRequired,afterOpen:Ve.default.string.isRequired,beforeClose:Ve.default.string.isRequired})]),appElement:Ve.default.oneOfType([Ve.default.instanceOf(ax.default),Ve.default.instanceOf(Ga.SafeHTMLCollection),Ve.default.instanceOf(Ga.SafeNodeList),Ve.default.arrayOf(Ve.default.instanceOf(ax.default))]),onAfterOpen:Ve.default.func,onRequestClose:Ve.default.func,closeTimeoutMS:Ve.default.number,ariaHideApp:Ve.default.bool,shouldFocusAfterRender:Ve.default.bool,shouldCloseOnOverlayClick:Ve.default.bool,shouldReturnFocusAfterClose:Ve.default.bool,preventScroll:Ve.default.bool,parentSelector:Ve.default.func,aria:Ve.default.object,data:Ve.default.object,role:Ve.default.string,contentLabel:Ve.default.string,shouldCloseOnEsc:Ve.default.bool,overlayRef:Ve.default.func,contentRef:Ve.default.func,id:Ve.default.string,overlayElement:Ve.default.func,contentElement:Ve.default.func};Hl.defaultProps={isOpen:!1,portalClassName:QE,bodyOpenClassName:qE,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(r,t){return Du.default.createElement("div",r,t)},contentElement:function(r,t){return Du.default.createElement("div",r,t)}};Hl.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}};(0,VE.polyfill)(Hl);Gs.default=Hl;(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=Gs,n=a(t);function a(s){return s&&s.__esModule?s:{default:s}}r.default=n.default,e.exports=r.default})(Td,Td.exports);var ZE=Td.exports;const or=r0(ZE);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ay=1252,JE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],nh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ah=function(e){JE.indexOf(e)!=-1&&(Ay=nh[0]=e)};function eS(){ah(1252)}var An=function(e){ah(e)};function Oy(){An(1200),eS()}function lx(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function tS(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Py(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Ii=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?tS(e.slice(2)):r==254&&t==255?Py(e.slice(2)):r==65279?e.slice(1):e},kc=function(r){return String.fromCharCode(r)},cx=function(r){return String.fromCharCode(r)},Ad,Xa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ux(e){for(var r="",t=0,n=0,a=0,s=0,o=0,i=0,l=0,c=0;c<e.length;)t=e.charCodeAt(c++),s=t>>2,n=e.charCodeAt(c++),o=(t&3)<<4|n>>4,a=e.charCodeAt(c++),i=(n&15)<<2|a>>6,l=a&63,isNaN(n)?i=l=64:isNaN(a)&&(l=64),r+=Xa.charAt(s)+Xa.charAt(o)+Xa.charAt(i)+Xa.charAt(l);return r}function rn(e){var r="",t=0,n=0,a=0,s=0,o=0,i=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Xa.indexOf(e.charAt(c++)),o=Xa.indexOf(e.charAt(c++)),t=s<<2|o>>4,r+=String.fromCharCode(t),i=Xa.indexOf(e.charAt(c++)),n=(o&15)<<4|i>>2,i!==64&&(r+=String.fromCharCode(n)),l=Xa.indexOf(e.charAt(c++)),a=(i&3)<<6|l,l!==64&&(r+=String.fromCharCode(a));return r}var et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ao=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function fs(e){return et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function fx(e){return et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Fn=function(r){return et?ao(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function so(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function sh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return sh(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Ha=et?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:ao(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function rS(e){for(var r=[],t=0,n=e.length+250,a=fs(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)a[t++]=o;else if(o<2048)a[t++]=192|o>>6&31,a[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var i=e.charCodeAt(++s)&1023;a[t++]=240|o>>8&7,a[t++]=128|o>>2&63,a[t++]=128|i>>6&15|(o&3)<<4,a[t++]=128|i&63}else a[t++]=224|o>>12&15,a[t++]=128|o>>6&63,a[t++]=128|o&63;t>n&&(r.push(a.slice(0,t)),t=0,a=fs(65535),n=65530)}return r.push(a.slice(0,t)),Ha(r)}var zr=/\u0000/g,ji=/[\u0001-\u0006]/g;function zo(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function On(e,r){var t=""+e;return t.length>=r?t:Lt("0",r-t.length)+t}function oh(e,r){var t=""+e;return t.length>=r?t:Lt(" ",r-t.length)+t}function Fu(e,r){var t=""+e;return t.length>=r?t:t+Lt(" ",r-t.length)}function nS(e,r){var t=""+Math.round(e);return t.length>=r?t:Lt("0",r-t.length)+t}function aS(e,r){var t=""+e;return t.length>=r?t:Lt("0",r-t.length)+t}var dx=Math.pow(2,32);function ho(e,r){if(e>dx||e<-dx)return nS(e,r);var t=Math.round(e);return aS(t,r)}function Au(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var px=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function sS(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},hx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},oS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ou(e,r,t){for(var n=e<0?-1:1,a=e*n,s=0,o=1,i=0,l=1,c=0,u=0,d=Math.floor(a);c<r&&(d=Math.floor(a),i=d*o+s,u=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=o,o=i,l=c,c=u;if(u>r&&(c>r?(u=l,i=s):(u=c,i=o)),!t)return[0,n*i,u];var p=Math.floor(n*i/u);return[p,n*i-p*u,u]}function Fs(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,o=[],i={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(i.u)<1e-6&&(i.u=0),r&&r.date1904&&(n+=1462),i.u>.9999&&(i.u=0,++a==86400&&(i.T=a=0,++n,++i.D)),n===60)o=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),t&&(s=dS(l,o))}return i.y=o[0],i.m=o[1],i.d=o[2],i.S=a%60,a=Math.floor(a/60),i.M=a%60,a=Math.floor(a/60),i.H=a,i.q=s,i}var My=new Date(1899,11,31,0,0,0),iS=My.getTime(),lS=new Date(1900,2,1,0,0,0);function Ry(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=lS&&(t+=24*60*60*1e3),(t-(iS+(e.getTimezoneOffset()-My.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ih(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function cS(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function uS(e){var r=e<0?12:11,t=ih(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function fS(e){var r=ih(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Dl(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=uS(e):r===10?t=e.toFixed(10).substr(0,12):t=fS(e),ih(cS(t.toUpperCase()))}function Xs(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Dl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return wn(14,Ry(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function dS(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function pS(e,r,t,n){var a="",s=0,o=0,i=t.y,l,c=0;switch(e){case 98:i=t.y+543;case 121:switch(r.length){case 1:case 2:l=i%100,c=2;break;default:l=i%1e4,c=4;break}break;case 109:switch(r.length){case 1:case 2:l=t.m,c=r.length;break;case 3:return cf[t.m-1][1];case 5:return cf[t.m-1][0];default:return cf[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=t.d,c=r.length;break;case 3:return px[t.q][0];default:return px[t.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(t.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=t.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=t.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?On(t.S,r.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(t.S+t.u)),s>=60*o&&(s=0),r==="s"?s===0?"0":""+s/o:(a=On(s,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}c=r.length===3?1:2;break;case 101:l=i,c=1;break}var u=c>0?On(l,c):"";return u}function Qa(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Iy=/%/g;function hS(e,r,t){var n=r.replace(Iy,""),a=r.length-n.length;return ka(e,n,t*Math.pow(10,2*a))+Lt("%",a)}function mS(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ka(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function jy(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+jy(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(i,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Ly=/# (\?+)( ?)\/( ?)(\d+)/;function xS(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),s=Math.floor(a/n),o=a-s*n,i=n;return t+(s===0?"":""+s)+" "+(o===0?Lt(" ",e[1].length+1+e[4].length):oh(o,e[1].length)+e[2]+"/"+e[3]+On(i,e[4].length))}function gS(e,r,t){return t+(r===0?"":""+r)+Lt(" ",e[1].length+2+e[4].length)}var zy=/^#*0*\.([0#]+)/,By=/\).*[0#]/,Wy=/\(###\) ###\\?-####/;function Ar(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function mx(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function xx(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function vS(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function yS(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ln(e,r,t){if(e.charCodeAt(0)===40&&!r.match(By)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ln("n",n,t):"("+ln("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return mS(e,r,t);if(r.indexOf("%")!==-1)return hS(e,r,t);if(r.indexOf("E")!==-1)return jy(r,t);if(r.charCodeAt(0)===36)return"$"+ln(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,o,i,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+ho(l,r.length);if(r.match(/^[#?]+$/))return a=ho(t,0),a==="0"&&(a=""),a.length>r.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(Ly))return xS(s,l,c);if(r.match(/^#+0+$/))return c+ho(l,r.length-r.indexOf("0"));if(s=r.match(zy))return a=mx(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+Lt("0",Ar(s[1]).length-m.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return c+mx(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return c+Qa(ho(l,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ln(e,r,-t):Qa(""+(Math.floor(t)+vS(t,s[1].length)))+"."+On(xx(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return ln(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zo(ln(e,r.replace(/[\\-]/g,""),t)),o=0,zo(zo(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(r.match(Wy))return a=ln(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),i=Ou(l,Math.pow(10,o)-1,!1),a=""+c,u=ka("n",s[1],i[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Fu(i[2],o),u.length<s[4].length&&(u=Ar(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),i=Ou(l,Math.pow(10,o)-1,!0),c+(i[0]||(i[1]?"":"0"))+" "+(i[1]?oh(i[1],o)+s[2]+"/"+s[3]+Fu(i[2],o):Lt(" ",2*o+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=ho(t,0),r.length<=a.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var d=r.indexOf(".")-o,p=r.length-a.length-d;return Ar(r.substr(0,d)+a+r.substr(r.length-p))}if(s=r.match(/^00,000\.([#0]*0)$/))return o=xx(t,s[1].length),t<0?"-"+ln(e,r,-t):Qa(yS(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?On(0,3-x.length):"")+x})+"."+On(o,s[1].length);switch(r){case"###,##0.00":return ln(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Qa(ho(l,0));return h!=="0"?c+h:"";case"###,###.00":return ln(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ln(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function wS(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ka(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function kS(e,r,t){var n=r.replace(Iy,""),a=r.length-n.length;return ka(e,n,t*Math.pow(10,2*a))+Lt("%",a)}function Uy(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Uy(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(i,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Vn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(By)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Vn("n",n,t):"("+Vn("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return wS(e,r,t);if(r.indexOf("%")!==-1)return kS(e,r,t);if(r.indexOf("E")!==-1)return Uy(r,t);if(r.charCodeAt(0)===36)return"$"+Vn(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,o,i,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+On(l,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(Ly))return gS(s,l,c);if(r.match(/^#+0+$/))return c+On(l,r.length-r.indexOf("0"));if(s=r.match(zy))return a=(""+t).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])),a=a.replace(/\.(\d*)$/,function(x,m){return"."+m+Lt("0",Ar(s[1]).length-m.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return c+Qa(""+l);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Vn(e,r,-t):Qa(""+t)+"."+Lt("0",s[1].length);if(s=r.match(/^#,#*,#0/))return Vn(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zo(Vn(e,r.replace(/[\\-]/g,""),t)),o=0,zo(zo(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(r.match(Wy))return a=Vn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),i=Ou(l,Math.pow(10,o)-1,!1),a=""+c,u=ka("n",s[1],i[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Fu(i[2],o),u.length<s[4].length&&(u=Ar(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),i=Ou(l,Math.pow(10,o)-1,!0),c+(i[0]||(i[1]?"":"0"))+" "+(i[1]?oh(i[1],o)+s[2]+"/"+s[3]+Fu(i[2],o):Lt(" ",2*o+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:Ar(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var d=r.indexOf(".")-o,p=r.length-a.length-d;return Ar(r.substr(0,d)+a+r.substr(r.length-p))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Vn(e,r,-t):Qa(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?On(0,3-x.length):"")+x})+"."+On(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Qa(""+l);return h!=="0"?c+h:"";default:if(r.match(/\.[0#?]*$/))return Vn(e,r.slice(0,r.lastIndexOf(".")),t)+Ar(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ka(e,r,t){return(t|0)===t?Vn(e,r,t):ln(e,r,t)}function _S(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var $y=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pi(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Au(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match($y))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function bS(e,r,t,n){for(var a=[],s="",o=0,i="",l="t",c,u,d,p="H";o<e.length;)switch(i=e.charAt(o)){case"G":if(!Au(e,o))throw new Error("unrecognized character "+i+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(d=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=e.charAt(++o),x=h==="("||h===")"?h:"t";a[a.length]={t:x,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:r},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=Fs(r,t,e.charAt(o+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},l=i,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":i=i.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||c==null&&(c=Fs(r,t),c==null))return"";for(s=i;++o<e.length&&e.charAt(o).toLowerCase()===i;)s+=i;i==="m"&&l.toLowerCase()==="h"&&(i="M"),i==="h"&&(i=p),a[a.length]={t:i,v:s},l=i;break;case"A":case"a":case"上":var m={t:i,v:i};if(c==null&&(c=Fs(r,t)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(c!=null&&(m.v=c.H>=12?"下午":"上午"),m.t="T",o+=5,p="h"):(m.t="t",++o),c==null&&m.t==="T")return"";a[a.length]=m,l=i;break;case"[":for(s=i;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($y)){if(c==null&&(c=Fs(r,t),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",pi(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=i;++o<e.length&&(i=e.charAt(o))==="0";)s+=i;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=i;++o<e.length&&"0#?.,E+-%".indexOf(i=e.charAt(o))>-1;)s+=i;a[a.length]={t:"n",v:s};break;case"?":for(s=i;e.charAt(++o)===i;)s+=i;a[a.length]={t:i,v:s},l=i;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":i,v:i},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=i;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:i,v:i},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(i)===-1)throw new Error("unrecognized character "+i+" in "+e);a[a.length]={t:"t",v:i},++o;break}var y=0,g=0,w;for(o=a.length-1,l="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=p,l="h",y<1&&(y=1);break;case"s":(w=a[o].v.match(/\.0+$/))&&(g=Math.max(g,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=a[o].t;break;case"m":l==="s"&&(a[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[o].v.match(/[Hh]/)&&(y=1),y<2&&a[o].v.match(/[Mm]/)&&(y=2),y<3&&a[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var v="",b;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=pS(a[o].t.charCodeAt(0),a[o].v,c,g),a[o].t="t";break;case"n":case"?":for(b=o+1;a[b]!=null&&((i=a[b].t)==="?"||i==="D"||(i===" "||i==="t")&&a[b+1]!=null&&(a[b+1].t==="?"||a[b+1].t==="t"&&a[b+1].v==="/")||a[o].t==="("&&(i===" "||i==="n"||i===")")||i==="t"&&(a[b].v==="/"||a[b].v===" "&&a[b+1]!=null&&a[b+1].t=="?"));)a[o].v+=a[b].v,a[b]={v:"",t:";"},++b;v+=a[o].v,o=b-1;break;case"G":a[o].t="t",a[o].v=Xs(r,t);break}var M="",C,k;if(v.length>0){v.charCodeAt(0)==40?(C=r<0&&v.charCodeAt(0)===45?-r:r,k=ka("n",v,C)):(C=r<0&&n>1?-r:r,k=ka("n",v,C),C<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),b=k.length-1;var F=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){F=o;break}var E=a.length;if(F===a.length&&k.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(b>=a[o].v.length-1?(b-=a[o].v.length,a[o].v=k.substr(b+1,a[o].v.length)):b<0?a[o].v="":(a[o].v=k.substr(0,b+1),b=-1),a[o].t="t",E=o);b>=0&&E<a.length&&(a[E].v=k.substr(0,b+1)+a[E].v)}else if(F!==a.length&&k.indexOf("E")===-1){for(b=k.indexOf(".")-1,o=F;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(u=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")-1:a[o].v.length-1,M=a[o].v.substr(u+1);u>=0;--u)b>=0&&(a[o].v.charAt(u)==="0"||a[o].v.charAt(u)==="#")&&(M=k.charAt(b--)+M);a[o].v=M,a[o].t="t",E=o}for(b>=0&&E<a.length&&(a[E].v=k.substr(0,b+1)+a[E].v),b=k.indexOf(".")+1,o=F;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==F)){for(u=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")+1:0,M=a[o].v.substr(0,u);u<a[o].v.length;++u)b<k.length&&(M+=k.charAt(b++));a[o].v=M,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(C=n>1&&r<0&&o>0&&a[o-1].v==="-"?-r:r,a[o].v=ka(a[o].t,a[o].v,C),a[o].t="t");var j="";for(o=0;o!==a.length;++o)a[o]!=null&&(j+=a[o].v);return j}var gx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vx(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function ES(e,r){var t=_S(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(gx),i=t[1].match(gx);return vx(r,o)?[n,t[0]]:vx(r,i)?[n,t[1]]:[n,t[o!=null&&i!=null?2:1]]}return[n,s]}function wn(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Ge)[e],n==null&&(n=t.table&&t.table[hx[e]]||Ge[hx[e]]),n==null&&(n=oS[e]||"General");break}if(Au(n,0))return Xs(r,t);r instanceof Date&&(r=Ry(r,t.date1904));var a=ES(n,r);if(Au(a[1]))return Xs(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return bS(a[1],r,t,a[0])}function js(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(Ge[t]==null){r<0&&(r=t);continue}if(Ge[t]==e){r=t;break}}r<0&&(r=391)}return Ge[r]=e,r}function Hy(){Ge=sS()}var SS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Yy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TS(e){var r=typeof e=="number"?Ge[e]:e;return r=r.replace(Yy,"(\\d+)"),new RegExp("^"+r+"$")}function CS(e,r,t){var n=-1,a=-1,s=-1,o=-1,i=-1,l=-1;(r.match(Yy)||[]).forEach(function(d,p){var h=parseInt(t[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":l=h;break;case"m":o>=0?i=h:a=h;break}}),l>=0&&i==-1&&a>=0&&(i=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&i==-1&&l==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var DS=function(){var e={};e.version="1.2.0";function r(){for(var k=0,F=new Array(256),E=0;E!=256;++E)k=E,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,F[E]=k;return typeof Int32Array<"u"?new Int32Array(F):F}var t=r();function n(k){var F=0,E=0,j=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)V[j]=k[j];for(j=0;j!=256;++j)for(E=k[j],F=256+j;F<4096;F+=256)E=V[F]=E>>>8^k[E&255];var W=[];for(j=1;j!=16;++j)W[j-1]=typeof Int32Array<"u"?V.subarray(j*256,j*256+256):V.slice(j*256,j*256+256);return W}var a=n(t),s=a[0],o=a[1],i=a[2],l=a[3],c=a[4],u=a[5],d=a[6],p=a[7],h=a[8],x=a[9],m=a[10],y=a[11],g=a[12],w=a[13],v=a[14];function b(k,F){for(var E=F^-1,j=0,V=k.length;j<V;)E=E>>>8^t[(E^k.charCodeAt(j++))&255];return~E}function M(k,F){for(var E=F^-1,j=k.length-15,V=0;V<j;)E=v[k[V++]^E&255]^w[k[V++]^E>>8&255]^g[k[V++]^E>>16&255]^y[k[V++]^E>>>24]^m[k[V++]]^x[k[V++]]^h[k[V++]]^p[k[V++]]^d[k[V++]]^u[k[V++]]^c[k[V++]]^l[k[V++]]^i[k[V++]]^o[k[V++]]^s[k[V++]]^t[k[V++]];for(j+=15;V<j;)E=E>>>8^t[(E^k[V++])&255];return~E}function C(k,F){for(var E=F^-1,j=0,V=k.length,W=0,te=0;j<V;)W=k.charCodeAt(j++),W<128?E=E>>>8^t[(E^W)&255]:W<2048?(E=E>>>8^t[(E^(192|W>>6&31))&255],E=E>>>8^t[(E^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,te=k.charCodeAt(j++)&1023,E=E>>>8^t[(E^(240|W>>8&7))&255],E=E>>>8^t[(E^(128|W>>2&63))&255],E=E>>>8^t[(E^(128|te>>6&15|(W&3)<<4))&255],E=E>>>8^t[(E^(128|te&63))&255]):(E=E>>>8^t[(E^(224|W>>12&15))&255],E=E>>>8^t[(E^(128|W>>6&63))&255],E=E>>>8^t[(E^(128|W&63))&255]);return~E}return e.table=t,e.bstr=b,e.buf=M,e.str=C,e}(),rt=function(){var r={};r.version="1.2.1";function t(T,L){for(var O=T.split("/"),R=L.split("/"),I=0,H=0,ie=Math.min(O.length,R.length);I<ie;++I){if(H=O[I].length-R[I].length)return H;if(O[I]!=R[I])return O[I]<R[I]?-1:1}return O.length-R.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var L=T.lastIndexOf("/");return L===-1?T:T.slice(0,L+1)}function a(T){if(T.charAt(T.length-1)=="/")return a(T.slice(0,-1));var L=T.lastIndexOf("/");return L===-1?T:T.slice(L+1)}function s(T,L){typeof L=="string"&&(L=new Date(L));var O=L.getHours();O=O<<6|L.getMinutes(),O=O<<5|L.getSeconds()>>>1,T.write_shift(2,O);var R=L.getFullYear()-1980;R=R<<4|L.getMonth()+1,R=R<<5|L.getDate(),T.write_shift(2,R)}function o(T){var L=T.read_shift(2)&65535,O=T.read_shift(2)&65535,R=new Date,I=O&31;O>>>=5;var H=O&15;O>>>=4,R.setMilliseconds(0),R.setFullYear(O+1980),R.setMonth(H-1),R.setDate(I);var ie=L&31;L>>>=5;var de=L&63;return L>>>=6,R.setHours(L),R.setMinutes(de),R.setSeconds(ie<<1),R}function i(T){cr(T,0);for(var L={},O=0;T.l<=T.length-4;){var R=T.read_shift(2),I=T.read_shift(2),H=T.l+I,ie={};switch(R){case 21589:O=T.read_shift(1),O&1&&(ie.mtime=T.read_shift(4)),I>5&&(O&2&&(ie.atime=T.read_shift(4)),O&4&&(ie.ctime=T.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}T.l=H,L[R]=ie}return L}var l;function c(){return l||(l={})}function u(T,L){if(T[0]==80&&T[1]==75)return Se(T,L);if((T[0]|32)==109&&(T[1]|32)==105)return Nr(T,L);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var O=3,R=512,I=0,H=0,ie=0,de=0,se=0,le=[],ce=T.slice(0,512);cr(ce,0);var ye=d(ce);switch(O=ye[0],O){case 3:R=512;break;case 4:R=4096;break;case 0:if(ye[1]==0)return Se(T,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}R!==512&&(ce=T.slice(0,R),cr(ce,28));var Te=T.slice(0,R);p(ce,O);var ge=ce.read_shift(4,"i");if(O===3&&ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ge);ce.l+=4,ie=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),de=ce.read_shift(4,"i"),I=ce.read_shift(4,"i"),se=ce.read_shift(4,"i"),H=ce.read_shift(4,"i");for(var ve=-1,Ce=0;Ce<109&&(ve=ce.read_shift(4,"i"),!(ve<0));++Ce)le[Ce]=ve;var Ue=h(T,R);y(se,H,Ue,R,le);var St=w(Ue,ie,le,R);St[ie].name="!Directory",I>0&&de!==te&&(St[de].name="!MiniFAT"),St[le[0]].name="!FAT",St.fat_addrs=le,St.ssz=R;var kt={},xr=[],yi=[],wi=[];v(ie,St,Ue,xr,I,kt,yi,de),x(yi,wi,xr),xr.shift();var ki={FileIndex:yi,FullPaths:wi};return L&&L.raw&&(ki.raw={header:Te,sectors:Ue}),ki}function d(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(ee,"Header Signature: "),T.l+=16;var L=T.read_shift(2,"u");return[T.read_shift(2,"u"),L]}function p(T,L){var O=9;switch(T.l+=2,O=T.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function h(T,L){for(var O=Math.ceil(T.length/L)-1,R=[],I=1;I<O;++I)R[I-1]=T.slice(I*L,(I+1)*L);return R[O-1]=T.slice(O*L),R}function x(T,L,O){for(var R=0,I=0,H=0,ie=0,de=0,se=O.length,le=[],ce=[];R<se;++R)le[R]=ce[R]=R,L[R]=O[R];for(;de<ce.length;++de)R=ce[de],I=T[R].L,H=T[R].R,ie=T[R].C,le[R]===R&&(I!==-1&&le[I]!==I&&(le[R]=le[I]),H!==-1&&le[H]!==H&&(le[R]=le[H])),ie!==-1&&(le[ie]=R),I!==-1&&R!=le[R]&&(le[I]=le[R],ce.lastIndexOf(I)<de&&ce.push(I)),H!==-1&&R!=le[R]&&(le[H]=le[R],ce.lastIndexOf(H)<de&&ce.push(H));for(R=1;R<se;++R)le[R]===R&&(H!==-1&&le[H]!==H?le[R]=le[H]:I!==-1&&le[I]!==I&&(le[R]=le[I]));for(R=1;R<se;++R)if(T[R].type!==0){if(de=R,de!=le[de])do de=le[de],L[R]=L[de]+"/"+L[R];while(de!==0&&le[de]!==-1&&de!=le[de]);le[R]=-1}for(L[0]+="/",R=1;R<se;++R)T[R].type!==2&&(L[R]+="/")}function m(T,L,O){for(var R=T.start,I=T.size,H=[],ie=R;O&&I>0&&ie>=0;)H.push(L.slice(ie*W,ie*W+W)),I-=W,ie=Ts(O,ie*4);return H.length===0?Qt(0):Ha(H).slice(0,T.size)}function y(T,L,O,R,I){var H=te;if(T===te){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var ie=O[T],de=(R>>>2)-1;if(!ie)return;for(var se=0;se<de&&(H=Ts(ie,se*4))!==te;++se)I.push(H);y(Ts(ie,R-4),L-1,O,R,I)}}function g(T,L,O,R,I){var H=[],ie=[];I||(I=[]);var de=R-1,se=0,le=0;for(se=L;se>=0;){I[se]=!0,H[H.length]=se,ie.push(T[se]);var ce=O[Math.floor(se*4/R)];if(le=se*4&de,R<4+le)throw new Error("FAT boundary crossed: "+se+" 4 "+R);if(!T[ce])break;se=Ts(T[ce],le)}return{nodes:H,data:Dx([ie])}}function w(T,L,O,R){var I=T.length,H=[],ie=[],de=[],se=[],le=R-1,ce=0,ye=0,Te=0,ge=0;for(ce=0;ce<I;++ce)if(de=[],Te=ce+L,Te>=I&&(Te-=I),!ie[Te]){se=[];var ve=[];for(ye=Te;ye>=0;){ve[ye]=!0,ie[ye]=!0,de[de.length]=ye,se.push(T[ye]);var Ce=O[Math.floor(ye*4/R)];if(ge=ye*4&le,R<4+ge)throw new Error("FAT boundary crossed: "+ye+" 4 "+R);if(!T[Ce]||(ye=Ts(T[Ce],ge),ve[ye]))break}H[Te]={nodes:de,data:Dx([se])}}return H}function v(T,L,O,R,I,H,ie,de){for(var se=0,le=R.length?2:0,ce=L[T].data,ye=0,Te=0,ge;ye<ce.length;ye+=128){var ve=ce.slice(ye,ye+128);cr(ve,64),Te=ve.read_shift(2),ge=dh(ve,0,Te-le),R.push(ge);var Ce={name:ge,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},Ue=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);Ue!==0&&(Ce.ct=b(ve,ve.l-8));var St=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);St!==0&&(Ce.mt=b(ve,ve.l-8)),Ce.start=ve.read_shift(4,"i"),Ce.size=ve.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=te,Ce.name=""),Ce.type===5?(se=Ce.start,I>0&&se!==te&&(L[se].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",L[Ce.start]===void 0&&(L[Ce.start]=g(O,Ce.start,L.fat_addrs,L.ssz)),L[Ce.start].name=Ce.name,Ce.content=L[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:se!==te&&Ce.start!==te&&L[se]&&(Ce.content=m(Ce,L[se].data,(L[de]||{}).data))),Ce.content&&cr(Ce.content,0),H[ge]=Ce,ie.push(Ce)}}function b(T,L){return new Date((Qr(T,L+4)/1e7*Math.pow(2,32)+Qr(T,L)/1e7-11644473600)*1e3)}function M(T,L){return c(),u(l.readFileSync(T),L)}function C(T,L){var O=L&&L.type;switch(O||et&&Buffer.isBuffer(T)&&(O="buffer"),O||"base64"){case"file":return M(T,L);case"base64":return u(Fn(rn(T)),L);case"binary":return u(Fn(T),L)}return u(T,L)}function k(T,L){var O=L||{},R=O.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=R+"/",T.FileIndex[0]={name:R,type:5}),O.CLSID&&(T.FileIndex[0].clsid=O.CLSID),F(T)}function F(T){var L="Sh33tJ5";if(!rt.find(T,"/"+L)){var O=Qt(4);O[0]=55,O[1]=O[3]=50,O[2]=54,T.FileIndex.push({name:L,type:2,content:O,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+L),E(T)}}function E(T,L){k(T);for(var O=!1,R=!1,I=T.FullPaths.length-1;I>=0;--I){var H=T.FileIndex[I];switch(H.type){case 0:R?O=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(H.R*H.L*H.C)&&(O=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!L)){var ie=new Date(1987,1,19),de=0,se=Object.create?Object.create(null):{},le=[];for(I=0;I<T.FullPaths.length;++I)se[T.FullPaths[I]]=!0,T.FileIndex[I].type!==0&&le.push([T.FullPaths[I],T.FileIndex[I]]);for(I=0;I<le.length;++I){var ce=n(le[I][0]);R=se[ce],R||(le.push([ce,{name:a(ce).replace("/",""),type:1,clsid:ne,ct:ie,mt:ie,content:null}]),se[ce]=!0)}for(le.sort(function(ge,ve){return t(ge[0],ve[0])}),T.FullPaths=[],T.FileIndex=[],I=0;I<le.length;++I)T.FullPaths[I]=le[I][0],T.FileIndex[I]=le[I][1];for(I=0;I<le.length;++I){var ye=T.FileIndex[I],Te=T.FullPaths[I];if(ye.name=a(Te).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||ne,I===0)ye.C=le.length>1?1:-1,ye.size=0,ye.type=5;else if(Te.slice(-1)=="/"){for(de=I+1;de<le.length&&n(T.FullPaths[de])!=Te;++de);for(ye.C=de>=le.length?-1:de,de=I+1;de<le.length&&n(T.FullPaths[de])!=n(Te);++de);ye.R=de>=le.length?-1:de,ye.type=1}else n(T.FullPaths[I+1]||"")==n(Te)&&(ye.R=I+1),ye.type=2}}}function j(T,L){var O=L||{};if(O.fileType=="mad")return da(T,O);switch(E(T),O.fileType){case"zip":return Le(T,O)}var R=function(ge){for(var ve=0,Ce=0,Ue=0;Ue<ge.FileIndex.length;++Ue){var St=ge.FileIndex[Ue];if(St.content){var kt=St.content.length;kt>0&&(kt<4096?ve+=kt+63>>6:Ce+=kt+511>>9)}}for(var xr=ge.FullPaths.length+3>>2,yi=ve+7>>3,wi=ve+127>>7,ki=yi+Ce+xr+wi,ks=ki+127>>7,R0=ks<=109?0:Math.ceil((ks-109)/127);ki+ks+R0+127>>7>ks;)R0=++ks<=109?0:Math.ceil((ks-109)/127);var pa=[1,R0,ks,wi,xr,Ce,ve,0];return ge.FileIndex[0].size=ve<<6,pa[7]=(ge.FileIndex[0].start=pa[0]+pa[1]+pa[2]+pa[3]+pa[4]+pa[5])+(pa[6]+7>>3),pa}(T),I=Qt(R[7]<<9),H=0,ie=0;{for(H=0;H<8;++H)I.write_shift(1,J[H]);for(H=0;H<8;++H)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),H=0;H<3;++H)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,R[2]),I.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:te),I.write_shift(4,R[3]),I.write_shift(-4,R[1]?R[0]-1:te),I.write_shift(4,R[1]),H=0;H<109;++H)I.write_shift(-4,H<R[2]?R[1]+H:-1)}if(R[1])for(ie=0;ie<R[1];++ie){for(;H<236+ie*127;++H)I.write_shift(-4,H<R[2]?R[1]+H:-1);I.write_shift(-4,ie===R[1]-1?te:ie+1)}var de=function(ge){for(ie+=ge;H<ie-1;++H)I.write_shift(-4,H+1);ge&&(++H,I.write_shift(-4,te))};for(ie=H=0,ie+=R[1];H<ie;++H)I.write_shift(-4,B.DIFSECT);for(ie+=R[2];H<ie;++H)I.write_shift(-4,B.FATSECT);de(R[3]),de(R[4]);for(var se=0,le=0,ce=T.FileIndex[0];se<T.FileIndex.length;++se)ce=T.FileIndex[se],ce.content&&(le=ce.content.length,!(le<4096)&&(ce.start=ie,de(le+511>>9)));for(de(R[6]+7>>3);I.l&511;)I.write_shift(-4,B.ENDOFCHAIN);for(ie=H=0,se=0;se<T.FileIndex.length;++se)ce=T.FileIndex[se],ce.content&&(le=ce.content.length,!(!le||le>=4096)&&(ce.start=ie,de(le+63>>6)));for(;I.l&511;)I.write_shift(-4,B.ENDOFCHAIN);for(H=0;H<R[4]<<2;++H){var ye=T.FullPaths[H];if(!ye||ye.length===0){for(se=0;se<17;++se)I.write_shift(4,0);for(se=0;se<3;++se)I.write_shift(4,-1);for(se=0;se<12;++se)I.write_shift(4,0);continue}ce=T.FileIndex[H],H===0&&(ce.start=ce.size?ce.start-1:te);var Te=H===0&&O.root||ce.name;if(le=2*(Te.length+1),I.write_shift(64,Te,"utf16le"),I.write_shift(2,le),I.write_shift(1,ce.type),I.write_shift(1,ce.color),I.write_shift(-4,ce.L),I.write_shift(-4,ce.R),I.write_shift(-4,ce.C),ce.clsid)I.write_shift(16,ce.clsid,"hex");else for(se=0;se<4;++se)I.write_shift(4,0);I.write_shift(4,ce.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,ce.start),I.write_shift(4,ce.size),I.write_shift(4,0)}for(H=1;H<T.FileIndex.length;++H)if(ce=T.FileIndex[H],ce.size>=4096)if(I.l=ce.start+1<<9,et&&Buffer.isBuffer(ce.content))ce.content.copy(I,I.l,0,ce.size),I.l+=ce.size+511&-512;else{for(se=0;se<ce.size;++se)I.write_shift(1,ce.content[se]);for(;se&511;++se)I.write_shift(1,0)}for(H=1;H<T.FileIndex.length;++H)if(ce=T.FileIndex[H],ce.size>0&&ce.size<4096)if(et&&Buffer.isBuffer(ce.content))ce.content.copy(I,I.l,0,ce.size),I.l+=ce.size+63&-64;else{for(se=0;se<ce.size;++se)I.write_shift(1,ce.content[se]);for(;se&63;++se)I.write_shift(1,0)}if(et)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function V(T,L){var O=T.FullPaths.map(function(se){return se.toUpperCase()}),R=O.map(function(se){var le=se.split("/");return le[le.length-(se.slice(-1)=="/"?2:1)]}),I=!1;L.charCodeAt(0)===47?(I=!0,L=O[0].slice(0,-1)+L):I=L.indexOf("/")!==-1;var H=L.toUpperCase(),ie=I===!0?O.indexOf(H):R.indexOf(H);if(ie!==-1)return T.FileIndex[ie];var de=!H.match(ji);for(H=H.replace(zr,""),de&&(H=H.replace(ji,"!")),ie=0;ie<O.length;++ie)if((de?O[ie].replace(ji,"!"):O[ie]).replace(zr,"")==H||(de?R[ie].replace(ji,"!"):R[ie]).replace(zr,"")==H)return T.FileIndex[ie];return null}var W=64,te=-2,ee="d0cf11e0a1b11ae1",J=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",B={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(T,L,O){c();var R=j(T,O);l.writeFileSync(L,R)}function N(T){for(var L=new Array(T.length),O=0;O<T.length;++O)L[O]=String.fromCharCode(T[O]);return L.join("")}function U(T,L){var O=j(T,L);switch(L&&L.type||"buffer"){case"file":return c(),l.writeFileSync(L.filename,O),O;case"binary":return typeof O=="string"?O:N(O);case"base64":return ux(typeof O=="string"?O:N(O));case"buffer":if(et)return Buffer.isBuffer(O)?O:ao(O);case"array":return typeof O=="string"?Fn(O):O}return O}var Z;function _(T){try{var L=T.InflateRaw,O=new L;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)Z=T;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function P(T,L){if(!Z)return ae(T,L);var O=Z.InflateRaw,R=new O,I=R._processChunk(T.slice(T.l),R._finishFlushFlag);return T.l+=R.bytesRead,I}function A(T){return Z?Z.deflateRawSync(T):Pe(T)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function oe(T){var L=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(L>>16|L>>8|L)&255}for(var X=typeof Uint8Array<"u",Y=X?new Uint8Array(256):[],K=0;K<256;++K)Y[K]=oe(K);function D(T,L){var O=Y[T&255];return L<=8?O>>>8-L:(O=O<<8|Y[T>>8&255],L<=16?O>>>16-L:(O=O<<8|Y[T>>16&255],O>>>24-L))}function we(T,L){var O=L&7,R=L>>>3;return(T[R]|(O<=6?0:T[R+1]<<8))>>>O&3}function pe(T,L){var O=L&7,R=L>>>3;return(T[R]|(O<=5?0:T[R+1]<<8))>>>O&7}function me(T,L){var O=L&7,R=L>>>3;return(T[R]|(O<=4?0:T[R+1]<<8))>>>O&15}function _e(T,L){var O=L&7,R=L>>>3;return(T[R]|(O<=3?0:T[R+1]<<8))>>>O&31}function xe(T,L){var O=L&7,R=L>>>3;return(T[R]|(O<=1?0:T[R+1]<<8))>>>O&127}function $e(T,L,O){var R=L&7,I=L>>>3,H=(1<<O)-1,ie=T[I]>>>R;return O<8-R||(ie|=T[I+1]<<8-R,O<16-R)||(ie|=T[I+2]<<16-R,O<24-R)||(ie|=T[I+3]<<24-R),ie&H}function G(T,L,O){var R=L&7,I=L>>>3;return R<=5?T[I]|=(O&7)<<R:(T[I]|=O<<R&255,T[I+1]=(O&7)>>8-R),L+3}function ue(T,L,O){var R=L&7,I=L>>>3;return O=(O&1)<<R,T[I]|=O,L+1}function he(T,L,O){var R=L&7,I=L>>>3;return O<<=R,T[I]|=O&255,O>>>=8,T[I+1]=O,L+8}function be(T,L,O){var R=L&7,I=L>>>3;return O<<=R,T[I]|=O&255,O>>>=8,T[I+1]=O&255,T[I+2]=O>>>8,L+16}function Fe(T,L){var O=T.length,R=2*O>L?2*O:L+5,I=0;if(O>=L)return T;if(et){var H=fx(R);if(T.copy)T.copy(H);else for(;I<T.length;++I)H[I]=T[I];return H}else if(X){var ie=new Uint8Array(R);if(ie.set)ie.set(T);else for(;I<O;++I)ie[I]=T[I];return ie}return T.length=R,T}function Me(T){for(var L=new Array(T),O=0;O<T;++O)L[O]=0;return L}function tt(T,L,O){var R=1,I=0,H=0,ie=0,de=0,se=T.length,le=X?new Uint16Array(32):Me(32);for(H=0;H<32;++H)le[H]=0;for(H=se;H<O;++H)T[H]=0;se=T.length;var ce=X?new Uint16Array(se):Me(se);for(H=0;H<se;++H)le[I=T[H]]++,R<I&&(R=I),ce[H]=0;for(le[0]=0,H=1;H<=R;++H)le[H+16]=de=de+le[H-1]<<1;for(H=0;H<se;++H)de=T[H],de!=0&&(ce[H]=le[de+16]++);var ye=0;for(H=0;H<se;++H)if(ye=T[H],ye!=0)for(de=D(ce[H],R)>>R-ye,ie=(1<<R+4-ye)-1;ie>=0;--ie)L[de|ie<<ye]=ye&15|H<<4;return R}var at=X?new Uint16Array(512):Me(512),yt=X?new Uint16Array(32):Me(32);if(!X){for(var gt=0;gt<512;++gt)at[gt]=0;for(gt=0;gt<32;++gt)yt[gt]=0}(function(){for(var T=[],L=0;L<32;L++)T.push(5);tt(T,yt,32);var O=[];for(L=0;L<=143;L++)O.push(8);for(;L<=255;L++)O.push(9);for(;L<=279;L++)O.push(7);for(;L<=287;L++)O.push(8);tt(O,at,288)})();var ct=function(){for(var L=X?new Uint8Array(32768):[],O=0,R=0;O<re.length-1;++O)for(;R<re[O+1];++R)L[R]=O;for(;R<32768;++R)L[R]=29;var I=X?new Uint8Array(259):[];for(O=0,R=0;O<Q.length-1;++O)for(;R<Q[O+1];++R)I[R]=O;function H(de,se){for(var le=0;le<de.length;){var ce=Math.min(65535,de.length-le),ye=le+ce==de.length;for(se.write_shift(1,+ye),se.write_shift(2,ce),se.write_shift(2,~ce&65535);ce-- >0;)se[se.l++]=de[le++]}return se.l}function ie(de,se){for(var le=0,ce=0,ye=X?new Uint16Array(32768):[];ce<de.length;){var Te=Math.min(65535,de.length-ce);if(Te<10){for(le=G(se,le,+(ce+Te==de.length)),le&7&&(le+=8-(le&7)),se.l=le/8|0,se.write_shift(2,Te),se.write_shift(2,~Te&65535);Te-- >0;)se[se.l++]=de[ce++];le=se.l*8;continue}le=G(se,le,+(ce+Te==de.length)+2);for(var ge=0;Te-- >0;){var ve=de[ce];ge=(ge<<5^ve)&32767;var Ce=-1,Ue=0;if((Ce=ye[ge])&&(Ce|=ce&-32768,Ce>ce&&(Ce-=32768),Ce<ce))for(;de[Ce+Ue]==de[ce+Ue]&&Ue<250;)++Ue;if(Ue>2){ve=I[Ue],ve<=22?le=he(se,le,Y[ve+1]>>1)-1:(he(se,le,3),le+=5,he(se,le,Y[ve-23]>>5),le+=3);var St=ve<8?0:ve-4>>2;St>0&&(be(se,le,Ue-Q[ve]),le+=St),ve=L[ce-Ce],le=he(se,le,Y[ve]>>3),le-=3;var kt=ve<4?0:ve-2>>1;kt>0&&(be(se,le,ce-Ce-re[ve]),le+=kt);for(var xr=0;xr<Ue;++xr)ye[ge]=ce&32767,ge=(ge<<5^de[ce])&32767,++ce;Te-=Ue-1}else ve<=143?ve=ve+48:le=ue(se,le,1),le=he(se,le,Y[ve]),ye[ge]=ce&32767,++ce}le=he(se,le,0)-1}return se.l=(le+7)/8|0,se.l}return function(se,le){return se.length<8?H(se,le):ie(se,le)}}();function Pe(T){var L=Qt(50+Math.floor(T.length*1.1)),O=ct(T,L);return L.slice(0,O)}var qe=X?new Uint16Array(32768):Me(32768),wt=X?new Uint16Array(32768):Me(32768),We=X?new Uint16Array(128):Me(128),Je=1,pt=1;function Ia(T,L){var O=_e(T,L)+257;L+=5;var R=_e(T,L)+1;L+=5;var I=me(T,L)+4;L+=4;for(var H=0,ie=X?new Uint8Array(19):Me(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,le=X?new Uint8Array(8):Me(8),ce=X?new Uint8Array(8):Me(8),ye=ie.length,Te=0;Te<I;++Te)ie[z[Te]]=H=pe(T,L),se<H&&(se=H),le[H]++,L+=3;var ge=0;for(le[0]=0,Te=1;Te<=se;++Te)ce[Te]=ge=ge+le[Te-1]<<1;for(Te=0;Te<ye;++Te)(ge=ie[Te])!=0&&(de[Te]=ce[ge]++);var ve=0;for(Te=0;Te<ye;++Te)if(ve=ie[Te],ve!=0){ge=Y[de[Te]]>>8-ve;for(var Ce=(1<<7-ve)-1;Ce>=0;--Ce)We[ge|Ce<<ve]=ve&7|Te<<3}var Ue=[];for(se=1;Ue.length<O+R;)switch(ge=We[xe(T,L)],L+=ge&7,ge>>>=3){case 16:for(H=3+we(T,L),L+=2,ge=Ue[Ue.length-1];H-- >0;)Ue.push(ge);break;case 17:for(H=3+pe(T,L),L+=3;H-- >0;)Ue.push(0);break;case 18:for(H=11+xe(T,L),L+=7;H-- >0;)Ue.push(0);break;default:Ue.push(ge),se<ge&&(se=ge);break}var St=Ue.slice(0,O),kt=Ue.slice(O);for(Te=O;Te<286;++Te)St[Te]=0;for(Te=R;Te<30;++Te)kt[Te]=0;return Je=tt(St,qe,286),pt=tt(kt,wt,30),L}function fa(T,L){if(T[0]==3&&!(T[1]&3))return[fs(L),2];for(var O=0,R=0,I=fx(L||1<<18),H=0,ie=I.length>>>0,de=0,se=0;!(R&1);){if(R=pe(T,O),O+=3,R>>>1)R>>1==1?(de=9,se=5):(O=Ia(T,O),de=Je,se=pt);else{O&7&&(O+=8-(O&7));var le=T[O>>>3]|T[(O>>>3)+1]<<8;if(O+=32,le>0)for(!L&&ie<H+le&&(I=Fe(I,H+le),ie=I.length);le-- >0;)I[H++]=T[O>>>3],O+=8;continue}for(;;){!L&&ie<H+32767&&(I=Fe(I,H+32767),ie=I.length);var ce=$e(T,O,de),ye=R>>>1==1?at[ce]:qe[ce];if(O+=ye&15,ye>>>=4,!(ye>>>8&255))I[H++]=ye;else{if(ye==256)break;ye-=257;var Te=ye<8?0:ye-4>>2;Te>5&&(Te=0);var ge=H+Q[ye];Te>0&&(ge+=$e(T,O,Te),O+=Te),ce=$e(T,O,se),ye=R>>>1==1?yt[ce]:wt[ce],O+=ye&15,ye>>>=4;var ve=ye<4?0:ye-2>>1,Ce=re[ye];for(ve>0&&(Ce+=$e(T,O,ve),O+=ve),!L&&ie<ge&&(I=Fe(I,ge+100),ie=I.length);H<ge;)I[H]=I[H-Ce],++H}}}return L?[I,O+7>>>3]:[I.slice(0,H),O+7>>>3]}function ae(T,L){var O=T.slice(T.l||0),R=fa(O,L);return T.l+=R[1],R[0]}function Ee(T,L){if(T)typeof console<"u"&&console.error(L);else throw new Error(L)}function Se(T,L){var O=T;cr(O,0);var R=[],I=[],H={FileIndex:R,FullPaths:I};k(H,{root:L.root});for(var ie=O.length-4;(O[ie]!=80||O[ie+1]!=75||O[ie+2]!=5||O[ie+3]!=6)&&ie>=0;)--ie;O.l=ie+4,O.l+=4;var de=O.read_shift(2);O.l+=6;var se=O.read_shift(4);for(O.l=se,ie=0;ie<de;++ie){O.l+=20;var le=O.read_shift(4),ce=O.read_shift(4),ye=O.read_shift(2),Te=O.read_shift(2),ge=O.read_shift(2);O.l+=8;var ve=O.read_shift(4),Ce=i(O.slice(O.l+ye,O.l+ye+Te));O.l+=ye+Te+ge;var Ue=O.l;O.l=ve+4,Ie(O,le,ce,H,Ce),O.l=Ue}return H}function Ie(T,L,O,R,I){T.l+=2;var H=T.read_shift(2),ie=T.read_shift(2),de=o(T);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var se=T.read_shift(4),le=T.read_shift(4),ce=T.read_shift(4),ye=T.read_shift(2),Te=T.read_shift(2),ge="",ve=0;ve<ye;++ve)ge+=String.fromCharCode(T[T.l++]);if(Te){var Ce=i(T.slice(T.l,T.l+Te));(Ce[21589]||{}).mt&&(de=Ce[21589].mt),((I||{})[21589]||{}).mt&&(de=I[21589].mt)}T.l+=Te;var Ue=T.slice(T.l,T.l+le);switch(ie){case 8:Ue=P(T,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var St=!1;H&8&&(se=T.read_shift(4),se==134695760&&(se=T.read_shift(4),St=!0),le=T.read_shift(4),ce=T.read_shift(4)),le!=L&&Ee(St,"Bad compressed size: "+L+" != "+le),ce!=O&&Ee(St,"Bad uncompressed size: "+O+" != "+ce),Be(R,ge,Ue,{unsafe:!0,mt:de})}function Le(T,L){var O=L||{},R=[],I=[],H=Qt(1),ie=O.compression?8:0,de=0,se=0,le=0,ce=0,ye=0,Te=T.FullPaths[0],ge=Te,ve=T.FileIndex[0],Ce=[],Ue=0;for(se=1;se<T.FullPaths.length;++se)if(ge=T.FullPaths[se].slice(Te.length),ve=T.FileIndex[se],!(!ve.size||!ve.content||ge=="Sh33tJ5")){var St=ce,kt=Qt(ge.length);for(le=0;le<ge.length;++le)kt.write_shift(1,ge.charCodeAt(le)&127);kt=kt.slice(0,kt.l),Ce[ye]=DS.buf(ve.content,0);var xr=ve.content;ie==8&&(xr=A(xr)),H=Qt(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,de),H.write_shift(2,ie),ve.mt?s(H,ve.mt):H.write_shift(4,0),H.write_shift(-4,Ce[ye]),H.write_shift(4,xr.length),H.write_shift(4,ve.content.length),H.write_shift(2,kt.length),H.write_shift(2,0),ce+=H.length,R.push(H),ce+=kt.length,R.push(kt),ce+=xr.length,R.push(xr),H=Qt(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,de),H.write_shift(2,ie),H.write_shift(4,0),H.write_shift(-4,Ce[ye]),H.write_shift(4,xr.length),H.write_shift(4,ve.content.length),H.write_shift(2,kt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,St),Ue+=H.l,I.push(H),Ue+=kt.length,I.push(kt),++ye}return H=Qt(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,ye),H.write_shift(2,ye),H.write_shift(4,Ue),H.write_shift(4,ce),H.write_shift(2,0),Ha([Ha(R),Ha(I),H])}var ft={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _t(T,L){if(T.ctype)return T.ctype;var O=T.name||"",R=O.match(/\.([^\.]+)$/);return R&&ft[R[1]]||L&&(R=(O=L).match(/[\.\\]([^\.\\])+$/),R&&ft[R[1]])?ft[R[1]]:"application/octet-stream"}function Dt(T){for(var L=ux(T),O=[],R=0;R<L.length;R+=76)O.push(L.slice(R,R+76));return O.join(`\r
`)+`\r
`}function mr(T){var L=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var ce=le.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],R=L.split(`\r
`),I=0;I<R.length;++I){var H=R[I];if(H.length==0){O.push("");continue}for(var ie=0;ie<H.length;){var de=76,se=H.slice(ie,ie+de);se.charAt(de-1)=="="?de--:se.charAt(de-2)=="="?de-=2:se.charAt(de-3)=="="&&(de-=3),se=H.slice(ie,ie+de),ie+=de,ie<H.length&&(se+="="),O.push(se)}}return O.join(`\r
`)}function ze(T){for(var L=[],O=0;O<T.length;++O){for(var R=T[O];O<=T.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+T[++O];L.push(R)}for(var I=0;I<L.length;++I)L[I]=L[I].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Fn(L.join(`\r
`))}function Ze(T,L,O){for(var R="",I="",H="",ie,de=0;de<10;++de){var se=L[de];if(!se||se.match(/^\s*$/))break;var le=se.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":R=le[2].trim();break;case"content-type":H=le[2].trim();break;case"content-transfer-encoding":I=le[2].trim();break}}switch(++de,I.toLowerCase()){case"base64":ie=Fn(rn(L.slice(de).join("")));break;case"quoted-printable":ie=ze(L.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var ce=Be(T,R.slice(O.length),ie,{unsafe:!0});H&&(ce.ctype=H)}function Nr(T,L){if(N(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=L&&L.root||"",R=(et&&Buffer.isBuffer(T)?T.toString("binary"):N(T)).split(`\r
`),I=0,H="";for(I=0;I<R.length;++I)if(H=R[I],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),O||(O=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),H.slice(0,O.length)!=O););var ie=(R[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var de="--"+(ie[1]||""),se=[],le=[],ce={FileIndex:se,FullPaths:le};k(ce);var ye,Te=0;for(I=0;I<R.length;++I){var ge=R[I];ge!==de&&ge!==de+"--"||(Te++&&Ze(ce,R.slice(ye,I),O),ye=I)}return ce}function da(T,L){var O=L||{},R=O.boundary||"SheetJS";R="------="+R;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],H=T.FullPaths[0],ie=H,de=T.FileIndex[0],se=1;se<T.FullPaths.length;++se)if(ie=T.FullPaths[se].slice(H.length),de=T.FileIndex[se],!(!de.size||!de.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var le=de.content,ce=et&&Buffer.isBuffer(le)?le.toString("binary"):N(le),ye=0,Te=Math.min(1024,ce.length),ge=0,ve=0;ve<=Te;++ve)(ge=ce.charCodeAt(ve))>=32&&ge<128&&++ye;var Ce=ye>=Te*4/5;I.push(R),I.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ie),I.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),I.push("Content-Type: "+_t(de,ie)),I.push(""),I.push(Ce?mr(ce):Dt(ce))}return I.push(R+`--\r
`),I.join(`\r
`)}function Ne(T){var L={};return k(L,T),L}function Be(T,L,O,R){var I=R&&R.unsafe;I||k(T);var H=!I&&rt.find(T,L);if(!H){var ie=T.FullPaths[0];L.slice(0,ie.length)==ie?ie=L:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+L).replace("//","/")),H={name:a(L),type:2},T.FileIndex.push(H),T.FullPaths.push(ie),I||rt.utils.cfb_gc(T)}return H.content=O,H.size=O?O.length:0,R&&(R.CLSID&&(H.clsid=R.CLSID),R.mt&&(H.mt=R.mt),R.ct&&(H.ct=R.ct)),H}function Ye(T,L){k(T);var O=rt.find(T,L);if(O){for(var R=0;R<T.FileIndex.length;++R)if(T.FileIndex[R]==O)return T.FileIndex.splice(R,1),T.FullPaths.splice(R,1),!0}return!1}function Wt(T,L,O){k(T);var R=rt.find(T,L);if(R){for(var I=0;I<T.FileIndex.length;++I)if(T.FileIndex[I]==R)return T.FileIndex[I].name=a(O),T.FullPaths[I]=O,!0}return!1}function tr(T){E(T,!0)}return r.find=V,r.read=C,r.parse=u,r.write=U,r.writeFile=q,r.utils={cfb_new:Ne,cfb_add:Be,cfb_del:Ye,cfb_mov:Wt,cfb_gc:tr,ReadShift:Ji,CheckField:pw,prep_blob:cr,bconcat:Ha,use_zlib:_,_deflateRaw:Pe,_inflateRaw:ae,consts:B},r}();function NS(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function sa(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function lh(e){for(var r=[],t=sa(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Pu=new Date(1899,11,30,0,0,0);function Br(e,r){var t=e.getTime(),n=Pu.getTime()+(e.getTimezoneOffset()-Pu.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Vy=new Date,FS=Pu.getTime()+(Vy.getTimezoneOffset()-Pu.getTimezoneOffset())*6e4,yx=Vy.getTimezoneOffset();function _0(e){var r=new Date;return r.setTime(e*24*60*60*1e3+FS),r.getTimezoneOffset()!==yx&&r.setTime(r.getTime()+(r.getTimezoneOffset()-yx)*6e4),r}function AS(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[s],10)}return r}var wx=new Date("2017-02-19T19:06:09.000Z"),Ky=isNaN(wx.getFullYear())?new Date("2/19/17"):wx,OS=Ky.getFullYear()==2017;function sr(e,r){var t=new Date(e);if(OS)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Ky.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Qs(e,r){if(et&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return zi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return zi(Py(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return zi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return zi(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function dr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=dr(e[t]));return r}function Lt(e,r){for(var t="";t.length<r;)t+=e;return t}function In(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(r=Number(n)))?r/t:r}var PS=["january","february","march","april","may","june","july","august","september","october","november","december"];function ei(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&PS.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var MS=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var s=t.split(n),o=[s[0]],i=1;i<s.length;++i)o.push(a),o.push(s[i]);return o}}();function Gy(e){return e?e.content&&e.type?Qs(e.content,!0):e.data?Ii(e.data):e.asNodeBuffer&&et?Ii(e.asNodeBuffer().toString("binary")):e.asBinary?Ii(e.asBinary()):e._data&&e._data.getContent?Ii(Qs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Xy(e){if(!e)return null;if(e.data)return lx(e.data);if(e.asNodeBuffer&&et)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?lx(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function RS(e){return e&&e.name.slice(-4)===".bin"?Xy(e):Gy(e)}function cn(e,r){for(var t=e.FullPaths||sa(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var o=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function ch(e,r){var t=cn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Kt(e,r,t){if(!t)return RS(ch(e,r));if(!r)return null;try{return Kt(e,r)}catch{return null}}function qr(e,r,t){if(!t)return Gy(ch(e,r));if(!r)return null;try{return qr(e,r)}catch{return null}}function IS(e,r,t){return Xy(ch(e,r))}function kx(e){for(var r=e.FullPaths||sa(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function jS(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return et?n=ao(t):n=rS(t),rt.utils.cfb_add(e,r,n)}rt.utils.cfb_add(e,r,t)}else e.file(r,t)}function Qy(e,r){switch(r.type){case"base64":return rt.read(e,{type:"base64"});case"binary":return rt.read(e,{type:"binary"});case"buffer":case"array":return rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Li(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var qy=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,LS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_x=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zS=/<[^>]*>/g,Dr=qy.match(_x)?_x:zS,BS=/<\w*:/,WS=/<(\/?)\w+:/;function He(e,r,t){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(LS),i=0,l="",c=0,u="",d="",p=1;if(o)for(c=0;c!=o.length;++c){for(d=o[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(u=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(p=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+p,d.length-p),i=0;i!=u.length&&u.charCodeAt(i)!==58;++i);if(i===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var h=(i===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(i+1);if(n[h]&&u.slice(i-3,i)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function ia(e){return e.replace(WS,"<$1")}var Zy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},US=lh(Zy),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(i,l){return Zy[i]||String.fromCharCode(parseInt(l,i.indexOf("x")>-1?16:10))||i}).replace(r,function(i,l){return String.fromCharCode(parseInt(l,16))});var o=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,o)+t(a.slice(o+3))}}(),$S=/[&<>'"]/g,HS=/[\u0000-\u001f]/g;function uh(e){var r=e+"";return r.replace($S,function(t){return US[t]}).replace(/\n/g,"<br/>").replace(HS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var bx=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Ft(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function uf(e){for(var r="",t=0,n=0,a=0,s=0,o=0,i=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=a&63,r+=String.fromCharCode(o);continue}if(s=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=e.charCodeAt(t++),i=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(i>>>10&1023)),r+=String.fromCharCode(56320+(i&1023))}return r}function Ex(e){var r=fs(2*e.length),t,n,a=1,s=0,o=0,i;for(n=0;n<e.length;n+=a)a=1,(i=e.charCodeAt(n))<128?t=i:i<224?(t=(i&31)*64+(e.charCodeAt(n+1)&63),a=2):i<240?(t=(i&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(i&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(r[s++]=o&255,r[s++]=o>>>8,o=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function Sx(e){return ao(e,"binary").toString("utf8")}var _c="foo bar bazâð£",Et=et&&(Sx(_c)==uf(_c)&&Sx||Ex(_c)==uf(_c)&&Ex)||uf,zi=et?function(e){return ao(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Nl=function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Jy=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),YS=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),VS=/<\/?(?:vt:)?variant>/g,KS=/<(?:vt:)([^>]*)>([\s\S]*)</;function Tx(e,r){var t=He(e),n=e.match(YS(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var o=s.replace(VS,"").match(KS);o&&a.push({v:Et(o[2]),t:o[1]})}),a}var GS=/(^\s|\s$|\n)/;function XS(e){return sa(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function QS(e,r,t){return"<"+e+(t!=null?XS(t):"")+(r!=null?(r.match(GS)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function fh(e){if(et&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Et(so(sh(e)));throw new Error("Bad input format: expected Buffer or string")}var Fl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qS={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ZS=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function JS(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,s=5;s>=0;--s)a=a*256+e[r+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function eT(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,s=0,o=n?-r:r;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(r)?26985:0);for(var i=0;i<=5;++i,s/=256)e[t+i]=s&255;e[t+6]=(a&15)<<4|s&15,e[t+7]=a>>4|n}var Cx=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Dx=et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:ao(r)})):Cx(e)}:Cx,Nx=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(ya(e,a)));return n.join("").replace(zr,"")},dh=et?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(zr,""):Nx(e,r,t)}:Nx,Fx=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ew=et?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Fx(e,r,t)}:Fx,Ax=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(go(e,a)));return n.join("")},Yl=et?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Ax(r,t,n)}:Ax,tw=function(e,r){var t=Qr(e,r);return t>0?Yl(e,r+4,r+4+t-1):""},rw=tw,nw=function(e,r){var t=Qr(e,r);return t>0?Yl(e,r+4,r+4+t-1):""},aw=nw,sw=function(e,r){var t=2*Qr(e,r);return t>0?Yl(e,r+4,r+4+t-1):""},ow=sw,iw=function(r,t){var n=Qr(r,t);return n>0?dh(r,t+4,t+4+n):""},lw=iw,cw=function(e,r){var t=Qr(e,r);return t>0?Yl(e,r+4,r+4+t):""},uw=cw,fw=function(e,r){return JS(e,r)},Mu=fw,dw=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};et&&(rw=function(r,t){if(!Buffer.isBuffer(r))return tw(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},aw=function(r,t){if(!Buffer.isBuffer(r))return nw(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},ow=function(r,t){if(!Buffer.isBuffer(r))return sw(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},lw=function(r,t){if(!Buffer.isBuffer(r))return iw(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},uw=function(r,t){if(!Buffer.isBuffer(r))return cw(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Mu=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):fw(r,t)},dw=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var go=function(e,r){return e[r]},ya=function(e,r){return e[r+1]*256+e[r]},tT=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Qr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ts=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},rT=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ji(e,r){var t="",n,a,s=[],o,i,l,c;switch(r){case"dbcs":if(c=this.l,et&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)t+=String.fromCharCode(ya(this,c)),c+=2;e*=2;break;case"utf8":t=Yl(this,this.l,this.l+e);break;case"utf16le":e*=2,t=dh(this,this.l,this.l+e);break;case"wstr":return Ji.call(this,e,"dbcs");case"lpstr-ansi":t=rw(this,this.l),e=4+Qr(this,this.l);break;case"lpstr-cp":t=aw(this,this.l),e=4+Qr(this,this.l);break;case"lpwstr":t=ow(this,this.l),e=4+2*Qr(this,this.l);break;case"lpp4":e=4+Qr(this,this.l),t=lw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qr(this,this.l),t=uw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(o=go(this,this.l+e++))!==0;)s.push(kc(o));t=s.join("");break;case"_wstr":for(e=0,t="";(o=ya(this,this.l+e))!==0;)s.push(kc(o)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=go(this,c),this.l=c+1,i=Ji.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+i;s.push(kc(ya(this,c))),c+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=go(this,c),this.l=c+1,i=Ji.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+i;s.push(kc(go(this,c))),c+=1}t=s.join("");break;default:switch(e){case 1:return n=go(this,this.l),this.l++,n;case 2:return n=(r==="i"?tT:ya)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?Ts:rT)(this,this.l),this.l+=4,n):(a=Qr(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Mu(this,this.l):a=Mu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=ew(this,this.l,e);break}}return this.l+=e,t}var nT=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},aT=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},sT=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function oT(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)sT(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var o=r.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,nT(this,r,this.l);break;case 8:if(n=8,t==="f"){eT(this,r,this.l);break}case 16:break;case-4:n=4,aT(this,r,this.l);break}return this.l+=n,this}function pw(e,r){var t=ew(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function cr(e,r){e.l=r,e.read_shift=Ji,e.chk=pw,e.write_shift=oT}function Cr(e,r){e.l+=r}function Qt(e){var r=fs(e);return cr(r,0),r}function Ra(e,r,t){if(e){var n,a,s;cr(e,e.l||0);for(var o=e.length,i=0,l=0;e.l<o;){i=e.read_shift(1),i&128&&(i=(i&127)+((e.read_shift(1)&127)<<7));var c=Bu[i]||Bu[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,t);if(e.l=l,r(u,c,i))return}}}function Od(){var e=[],r=et?256:2048,t=function(c){var u=Qt(c);return cr(u,0),u},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=t(Math.max(c+1,r)))},o=function(){return a(),Ha(e)},i=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(r)};return{next:s,push:i,end:o,_bufs:e}}function el(e,r,t){var n=dr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ox(e,r,t){var n=dr(e);return n.s=el(n.s,r.s,t),n.e=el(n.e,r.s,t),n}function tl(e,r){if(e.cRel&&e.c<0)for(e=dr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=dr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Ke(e);return!e.cRel&&e.cRel!=null&&(t=cT(t)),!e.rRel&&e.rRel!=null&&(t=iT(t)),t}function ff(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Jt(e.s.c)+":"+(e.e.cRel?"":"$")+Jt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pr(e.s.r)+":"+(e.e.rRel?"":"$")+pr(e.e.r):tl(e.s,r.biff)+":"+tl(e.e,r.biff)}function ph(e){return parseInt(lT(e),10)-1}function pr(e){return""+(e+1)}function iT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lT(e){return e.replace(/\$(\d+)$/,"$1")}function hh(e){for(var r=uT(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Jt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function cT(e){return e.replace(/^([A-Z])/,"$$$1")}function uT(e){return e.replace(/^\$([A-Z])/,"$1")}function fT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Rr(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Ke(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function hi(e){var r=e.indexOf(":");return r==-1?{s:Rr(e),e:Rr(e)}:{s:Rr(e.slice(0,r)),e:Rr(e.slice(r+1))}}function nt(e,r){return typeof r>"u"||typeof r=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=Ke(e)),typeof r!="string"&&(r=Ke(r)),e==r?e:e+":"+r)}function zt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=e.length;for(t=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===s||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Px(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=wn(e.z,t?Br(r):r)}catch{}try{return e.w=wn((e.XF||{}).numFmtId||(t?14:0),t?Br(r):r)}catch{return""+r}}function Oa(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?lo[e.v]||e.v:r==null?Px(e,e.v):Px(e,r))}function ys(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function hw(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),o=0,i=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Rr(n.origin):n.origin;o=l.r,i=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=zt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var d=0;d!=r.length;++d)if(r[d]){if(!Array.isArray(r[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=r[d].length;++p)if(!(typeof r[d][p]>"u")){var h={v:r[d][p]},x=o+d,m=i+p;if(c.s.r>x&&(c.s.r=x),c.s.c>m&&(c.s.c=m),c.e.r<x&&(c.e.r=x),c.e.c<m&&(c.e.c=m),r[d][p]&&typeof r[d][p]=="object"&&!Array.isArray(r[d][p])&&!(r[d][p]instanceof Date))h=r[d][p];else if(Array.isArray(h.v)&&(h.f=r[d][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Ge[14],n.cellDates?(h.t="d",h.w=wn(h.z,Br(h.v))):(h.t="n",h.v=Br(h.v),h.w=wn(h.z,h.v))):h.t="s";if(a)s[x]||(s[x]=[]),s[x][m]&&s[x][m].z&&(h.z=s[x][m].z),s[x][m]=h;else{var y=Ke({c:m,r:x});s[y]&&s[y].z&&(h.z=s[y].z),s[y]=h}}}return c.s.c<1e7&&(s["!ref"]=nt(c)),s}function mi(e,r){return hw(null,e,r)}function dT(e){return e.read_shift(4,"i")}function Sr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function pT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function mh(e,r){var t=e.l,n=e.read_shift(1),a=Sr(e),s=[],o={t:a,h:a};if(n&1){for(var i=e.read_shift(4),l=0;l!=i;++l)s.push(pT(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=t+r,o}var hT=mh;function _n(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function oo(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var mT=Sr;function xh(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var xT=Sr,Pd=xh;function gh(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Mu([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ts(r,0)>>2;return t?a/100:a}function mw(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var io=mw;function br(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function gT(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var c=Ls[a];c&&(r.rgb=Ol(c));break;case 2:r.rgb=Ol([o,i,l]);break;case 3:r.theme=a;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function vT(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function xw(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function yT(e){return xw(e,1)}function wT(e){return xw(e,2)}var vh=2,$r=3,bc=11,Mx=12,Ru=19,Ec=64,kT=65,_T=71,bT=4108,ET=4126,rr=80,gw=81,ST=[rr,gw],TT={1:{n:"CodePage",t:vh},2:{n:"Category",t:rr},3:{n:"PresentationFormat",t:rr},4:{n:"ByteCount",t:$r},5:{n:"LineCount",t:$r},6:{n:"ParagraphCount",t:$r},7:{n:"SlideCount",t:$r},8:{n:"NoteCount",t:$r},9:{n:"HiddenCount",t:$r},10:{n:"MultimediaClipCount",t:$r},11:{n:"ScaleCrop",t:bc},12:{n:"HeadingPairs",t:bT},13:{n:"TitlesOfParts",t:ET},14:{n:"Manager",t:rr},15:{n:"Company",t:rr},16:{n:"LinksUpToDate",t:bc},17:{n:"CharacterCount",t:$r},19:{n:"SharedDoc",t:bc},22:{n:"HyperlinksChanged",t:bc},23:{n:"AppVersion",t:$r,p:"version"},24:{n:"DigSig",t:kT},26:{n:"ContentType",t:rr},27:{n:"ContentStatus",t:rr},28:{n:"Language",t:rr},29:{n:"Version",t:rr},255:{},2147483648:{n:"Locale",t:Ru},2147483651:{n:"Behavior",t:Ru},1919054434:{}},CT={1:{n:"CodePage",t:vh},2:{n:"Title",t:rr},3:{n:"Subject",t:rr},4:{n:"Author",t:rr},5:{n:"Keywords",t:rr},6:{n:"Comments",t:rr},7:{n:"Template",t:rr},8:{n:"LastAuthor",t:rr},9:{n:"RevNumber",t:rr},10:{n:"EditTime",t:Ec},11:{n:"LastPrinted",t:Ec},12:{n:"CreatedDate",t:Ec},13:{n:"ModifiedDate",t:Ec},14:{n:"PageCount",t:$r},15:{n:"WordCount",t:$r},16:{n:"CharCount",t:$r},17:{n:"Thumbnail",t:_T},18:{n:"Application",t:rr},19:{n:"DocSecurity",t:$r},255:{},2147483648:{n:"Locale",t:Ru},2147483651:{n:"Behavior",t:Ru},1919054434:{}},Rx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},DT=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function NT(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var FT=NT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ls=dr(FT),lo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ix={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function AT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OT(e){var r=AT();if(!e||!e.match)return r;var t={};if((e.match(Dr)||[]).forEach(function(n){var a=He(n);switch(a[0].replace(BS,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[Ix[a.ContentType]]!==void 0&&r[Ix[a.ContentType]].push(a.PartName);break}}),r.xmlns!==qS.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var Oo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Md(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function rl(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Dr)||[]).forEach(function(a){var s=He(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var i=s.TargetMode==="External"?s.Target:Li(s.Target,r);t[i]=o,n[s.Id]=o}}),t["!id"]=n,t}var PT="application/vnd.oasis.opendocument.spreadsheet";function MT(e,r){for(var t=fh(e),n,a;n=Fl.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=He(n[0],!1),a.path=="/"&&a.type!==PT)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var nl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],RT=function(){for(var e=new Array(nl.length),r=0;r<nl.length;++r){var t=nl[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function yw(e){var r={};e=Et(e);for(var t=0;t<nl.length;++t){var n=nl[t],a=e.match(RT[t]);a!=null&&a.length>0&&(r[n[1]]=lt(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=sr(r[n[1]]))}return r}var IT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ww(e,r,t,n){var a=[];if(typeof e=="string")a=Tx(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var o=typeof r=="string"?Tx(r,n).map(function(u){return u.v}):r,i=0,l=0;if(o.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=o.slice(i,i+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=l,t.DefinedNames=o.slice(i,i+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=o.slice(i,i+l);break}i+=l}}function jT(e,r,t){var n={};return r||(r={}),e=Et(e),IT.forEach(function(a){var s=(e.match(Nl(a[0]))||[])[1];switch(a[2]){case"string":s&&(r[a[1]]=lt(s));break;case"bool":r[a[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ww(n.HeadingPairs,n.TitlesOfParts,r,t),r}var LT=/<[^>]+>[^<]*/g;function zT(e,r){var t={},n="",a=e.match(LT);if(a)for(var s=0;s!=a.length;++s){var o=a[s],i=He(o);switch(i[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(i.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":t[n]=lt(u);break;case"bool":t[n]=Ft(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(u);break;case"filetime":case"date":t[n]=sr(u);break;case"cy":case"error":t[n]=lt(u);break;default:if(c.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(r.WTF)throw new Error(o)}}}return t}var BT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},df;function WT(e,r,t){df||(df=lh(BT)),r=df[r]||r,e[r]=t}function yh(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kw(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function _w(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function bw(e,r,t){return r===31?_w(e):kw(e,r,t)}function Rd(e,r,t){return bw(e,r,t===!1?0:4)}function UT(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return bw(e,r,0)}function $T(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(zr,""),e.l-a&2&&(e.l+=2)}return t}function HT(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(zr,"");return t}function YT(e){var r=e.l,t=Iu(e,gw);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Iu(e,$r);return[t,n]}function VT(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(YT(e));return t}function jx(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,r===1200?"utf16le":"utf8").replace(zr,"").replace(ji,"!"),r===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Ew(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function KT(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Iu(e,r,t){var n=e.read_shift(2),a,s=t||{};if(e.l+=2,r!==Mx&&n!==r&&ST.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Mx?n:r){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return kw(e,n,4).replace(zr,"");case 31:return _w(e);case 64:return yh(e);case 65:return Ew(e);case 71:return KT(e);case 80:return Rd(e,n,!s.raw).replace(zr,"");case 81:return UT(e,n).replace(zr,"");case 4108:return VT(e);case 4126:case 4127:return n==4127?$T(e):HT(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Lx(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0,i=0,l=-1,c={};for(o=0;o!=a;++o){var u=e.read_shift(4),d=e.read_shift(4);s[o]=[u,d+t]}s.sort(function(w,v){return w[1]-v[1]});var p={};for(o=0;o!=a;++o){if(e.l!==s[o][1]){var h=!0;if(o>0&&r)switch(r[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break}if((!r||o==0)&&e.l<=s[o][1]&&(h=!1,e.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(r){var x=r[s[o][0]];if(p[x.n]=Iu(e,x.t,{raw:!0}),x.p==="version"&&(p[x.n]=String(p[x.n]>>16)+"."+("0000"+String(p[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(p[x.n]){case 0:p[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:An(i=p[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[x.n])}}else if(s[o][0]===1){if(i=p.CodePage=Iu(e,vh),An(i),l!==-1){var m=e.l;e.l=s[l][1],c=jx(e,i),e.l=m}}else if(s[o][0]===0){if(i===0){l=o,e.l=s[o+1][1];continue}c=jx(e,i)}else{var y=c[s[o][0]],g;switch(e[e.l]){case 65:e.l+=4,g=Ew(e);break;case 30:e.l+=4,g=Rd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=Rd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Ut(e,4);break;case 64:e.l+=4,g=sr(yh(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[y]=g}}return e.l=t+n,p}function zx(e,r,t){var n=e.content;if(!n)return{};cr(n,0);var a,s,o,i,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==rt.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),i=n.read_shift(4),a===1&&i!==n.l)throw new Error("Length mismatch: "+i+" !== "+n.l);a===2&&(o=n.read_shift(16),l=n.read_shift(4));var d=Lx(n,r),p={SystemIdentifier:c};for(var h in d)p[h]=d[h];if(p.FMTID=s,a===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Lx(n,null)}catch{}for(h in x)p[h]=x[h];return p.FMTID=[s,o],p}function La(e,r){return e.read_shift(r),null}function GT(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ut(e,r){return e.read_shift(r)===1}function Gt(e){return e.read_shift(2,"u")}function Sw(e,r){return GT(e,r,Gt)}function XT(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Vl(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function QT(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,s=1+(t&1),o=0,i,l={};a&&(o=e.read_shift(2)),n&&(i=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=r===0?"":e.read_shift(r,c);return a&&(e.l+=4*o),n&&(e.l+=i),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function qs(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Kl(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):qs(e,n,t)}function co(e,r,t){if(t.biff>5)return Kl(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function qT(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function ZT(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(zr,"");return n&&(e.l+=24),a}function JT(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(zr,"");return t+o}function eC(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return ZT(e);case"0303000000000000c000000000000046":return JT(e);default:throw new Error("Unsupported Moniker "+t)}}function Sc(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(zr,""):"";return t}function tC(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,o,i,l,c="",u,d;a&16&&(s=Sc(e,t-e.l)),a&128&&(o=Sc(e,t-e.l)),(a&257)===257&&(i=Sc(e,t-e.l)),(a&257)===1&&(l=eC(e,t-e.l)),a&8&&(c=Sc(e,t-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(d=yh(e)),e.l=t;var p=o||i||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return u&&(h.guid=u),d&&(h.time=d),s&&(h.Tooltip=s),h}function Tw(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function Cw(e,r){var t=Tw(e);return t[3]=0,t}function la(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function rC(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function nC(e,r,t){return r===0?"":co(e,r,t)}function aC(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,s,o]}function Dw(e){var r=e.read_shift(2),t=gh(e);return[r,t]}function sC(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=Vl(e,r,t),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function b0(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function Nw(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var oC=Nw;function Fw(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function iC(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function lC(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function yr(e){e.l+=2,e.l+=e.read_shift(2)}var cC={0:yr,4:yr,5:yr,6:yr,7:lC,8:yr,9:yr,10:yr,11:yr,12:yr,13:iC,14:yr,15:yr,16:yr,17:yr,18:yr,19:yr,20:yr,21:Fw};function uC(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(cC[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Tc(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function fC(e,r){return r===0||e.read_shift(2),1200}function dC(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=co(e,0,t);return e.read_shift(r+n-e.l),a}function pC(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function hC(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Vl(e,0,t);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function mC(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0;o!=a&&e.l<t;++o)s.push(QT(e));return s.Count=n,s.Unique=a,s}function xC(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function gC(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function vC(e){var r=rC(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function yC(e){return e.read_shift(2),e.read_shift(4)}function Bx(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function wC(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:s,CurTab:o,FirstTab:i,Selected:l,TabRatio:c}}function kC(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function _C(){}function bC(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Vl(e,0,t),n}function EC(e){var r=la(e);return r.isst=e.read_shift(4),r}function SC(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=la(e);t.biff==2&&e.l++;var s=Kl(e,n-e.l,t);return a.val=s,a}function TC(e,r,t){var n=e.read_shift(2),a=co(e,0,t);return[n,a]}var CC=co;function Wx(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,s=e.read_shift(a),o=e.read_shift(a),i=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:i},e:{r:o,c:l}}}function DC(e){var r=e.read_shift(2),t=e.read_shift(2),n=Dw(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function NC(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(Dw(e));if(e.l!==t)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function FC(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function AC(e,r,t,n){var a={},s=e.read_shift(4),o=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(2);return a.patternType=DT[i>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=i&127,a.icvBottom=i>>7&127,a.icvDiag=i>>14&127,a.dgDiag=i>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function OC(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=AC(e,r,n.fStyle,t),n}function PC(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Ux(e,r,t){var n=la(e);(t.biff==2||r==9)&&++e.l;var a=XT(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function MC(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=la(e),a=br(e);return n.val=a,n}var $x=nC;function RC(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=qs(e,s),i=[];n>e.l;)i.push(Kl(e));return[s,a,o,i]}function Hx(e,r,t){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=sC(e,r-2,t)),s.body=a||e.read_shift(r-2),typeof a=="string"&&(s.Name=a),s}var IC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Yx(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),i=e.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),l=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var c=qs(e,o,t);a&32&&(c=IC[c.charCodeAt(0)]);var u=n-e.l;t&&t.biff==2&&--u;var d=n==e.l||i===0||!(u>0)?[]:g3(e,u,t,i);return{chKey:s,Name:c,itab:l,rgce:d}}function Aw(e,r,t){if(t.biff<8)return jC(e,r,t);for(var n=[],a=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)n.push(aC(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function jC(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Vl(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function LC(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),s=qs(e,n,t),o=qs(e,a,t);return[s,o]}function zC(e,r,t){var n=Nw(e);e.l++;var a=e.read_shift(1);return r-=8,[v3(e,r,t),a,n]}function Vx(e,r,t){var n=oC(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,m3(e,r,t)]}function BC(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function WC(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),i=co(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},i,o,s]}}function UC(e,r,t){return WC(e,r,t)}function $C(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(b0(e));return t}function HC(e,r,t){if(t&&t.biff<8)return VC(e,r,t);var n=Fw(e),a=uC(e,r-22,n[1]);return{cmo:n,ft:a}}var YC={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function VC(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var o=[];return o.push((YC[n]||Cr)(e,r,t)),{cmo:[a,n,s],ft:o}}function KC(e,r,t){var n=e.l,a="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=qT(e,6,t);var i=e.read_shift(2);e.read_shift(2),Gt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=qs(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(u?i:2*i))break}if(a.length!==i&&a.length!==i*2)throw new Error("cchText: "+i+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function GC(e,r){var t=b0(e);e.l+=16;var n=tC(e,r-24);return[t,n]}function XC(e,r){e.read_shift(2);var t=b0(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(zr,""),[t,n]}function QC(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Rx[t]||t,t=e.read_shift(2),r[1]=Rx[t]||t,r}function qC(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Cw(e));return t}function ZC(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Cw(e));return t}function JC(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Ow(e,r,t){if(!t.cellStyles)return Cr(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:o,ixfe:i,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function eD(e,r){var t={};return r<32||(e.l+=16,t.header=br(e),t.footer=br(e),e.l+=2),t}function tD(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var rD=la,nD=Sw,aD=Kl;function sD(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function oD(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=la(e);++e.l;var a=co(e,r-7,t);return n.t="str",n.val=a,n}function iD(e){var r=la(e);++e.l;var t=br(e);return r.t="n",r.val=t,r}function lD(e){var r=la(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function cD(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function uD(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function fD(e,r,t){var n=e.l+r,a=la(e),s=e.read_shift(2),o=qs(e,s,t);return e.l=n,a.t="str",a.val=o,a}var dD=[2,3,48,49,131,139,140,245],Kx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=lh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(i,l){var c=[],u=fs(1);switch(l.type){case"base64":u=Fn(rn(i));break;case"binary":u=Fn(i);break;case"buffer":case"array":u=i;break}cr(u,0);var d=u.read_shift(1),p=!!(d&136),h=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,y=521;d==2&&(m=u.read_shift(2)),u.l+=3,d!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(y=u.read_shift(2));var g=u.read_shift(2),w=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var v=[],b={},M=Math.min(u.length,d==2?521:y-10-(h?264:0)),C=x?32:11;u.l<M&&u[u.l]!=13;)switch(b={},b.name=Ad.utils.decode(w,u.slice(u.l,u.l+C)).replace(/[\u0000\r\n].*$/g,""),u.l+=C,b.type=String.fromCharCode(u.read_shift(1)),d!=2&&!x&&(b.offset=u.read_shift(4)),b.len=u.read_shift(1),d==2&&(b.offset=u.read_shift(2)),b.dec=u.read_shift(1),b.name.length&&v.push(b),d!=2&&(u.l+=x?13:14),b.type){case"B":(!h||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var k=0,F=0;for(c[0]=[],F=0;F!=v.length;++F)c[0][F]=v[F].name;for(;m-- >0;){if(u[u.l]===42){u.l+=g;continue}for(++u.l,c[++k]=[],F=0,F=0;F!=v.length;++F){var E=u.slice(u.l,u.l+v[F].len);u.l+=v[F].len,cr(E,0);var j=Ad.utils.decode(w,E);switch(v[F].type){case"C":j.trim().length&&(c[k][F]=j.replace(/\s+$/,""));break;case"D":j.length===8?c[k][F]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):c[k][F]=j;break;case"F":c[k][F]=parseFloat(j.trim());break;case"+":case"I":c[k][F]=x?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":c[k][F]=!0;break;case"N":case"F":c[k][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[k][F]="##MEMO##"+(x?parseInt(j.trim(),10):E.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(c[k][F]=+j||0);break;case"@":c[k][F]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":c[k][F]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":c[k][F]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][F]=-E.read_shift(-8,"f");break;case"B":if(h&&v[F].len==8){c[k][F]=E.read_shift(8,"f");break}case"G":case"P":E.l+=v[F].len;break;case"0":if(v[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[F].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=v,c}function n(i,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=mi(t(i,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function a(i,l){try{return ys(n(i,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(i,l){var c=l||{};if(+c.codepage>=0&&An(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Od(),d=Ud(i,{header:1,raw:!0,cellDates:!0}),p=d[0],h=d.slice(1),x=i["!cols"]||[],m=0,y=0,g=0,w=1;for(m=0;m<p.length;++m){if(((x[m]||{}).DBF||{}).name){p[m]=x[m].DBF.name,++g;continue}if(p[m]!=null){if(++g,typeof p[m]=="number"&&(p[m]=p[m].toString(10)),typeof p[m]!="string")throw new Error("DBF Invalid column name "+p[m]+" |"+typeof p[m]+"|");if(p.indexOf(p[m])!==m){for(y=0;y<1024;++y)if(p.indexOf(p[m]+"_"+y)==-1){p[m]+="_"+y;break}}}}var v=zt(i["!ref"]),b=[],M=[],C=[];for(m=0;m<=v.e.c-v.s.c;++m){var k="",F="",E=0,j=[];for(y=0;y<h.length;++y)h[y][m]!=null&&j.push(h[y][m]);if(j.length==0||p[m]==null){b[m]="?";continue}for(y=0;y<j.length;++y){switch(typeof j[y]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=j[y]instanceof Date?"D":"C";break;default:F="C"}E=Math.max(E,String(j[y]).length),k=k&&k!=F?"C":F}E>250&&(E=250),F=((x[m]||{}).DBF||{}).type,F=="C"&&x[m].DBF.len>E&&(E=x[m].DBF.len),k=="B"&&F=="N"&&(k="N",C[m]=x[m].DBF.dec,E=x[m].DBF.len),M[m]=k=="C"||F=="N"?E:s[k]||0,w+=M[m],b[m]=k}var V=u.next(32);for(V.write_shift(4,318902576),V.write_shift(4,h.length),V.write_shift(2,296+32*g),V.write_shift(2,w),m=0;m<4;++m)V.write_shift(4,0);for(V.write_shift(4,0|(+r[Ay]||3)<<8),m=0,y=0;m<p.length;++m)if(p[m]!=null){var W=u.next(32),te=(p[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,te,"sbcs"),W.write_shift(1,b[m]=="?"?"C":b[m],"sbcs"),W.write_shift(4,y),W.write_shift(1,M[m]||s[b[m]]||0),W.write_shift(1,C[m]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),y+=M[m]||s[b[m]]||0}var ee=u.next(264);for(ee.write_shift(4,13),m=0;m<65;++m)ee.write_shift(4,0);for(m=0;m<h.length;++m){var J=u.next(w);for(J.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(b[y]){case"L":J.write_shift(1,h[m][y]==null?63:h[m][y]?84:70);break;case"B":J.write_shift(8,h[m][y]||0,"f");break;case"N":var ne="0";for(typeof h[m][y]=="number"&&(ne=h[m][y].toFixed(C[y]||0)),g=0;g<M[y]-ne.length;++g)J.write_shift(1,32);J.write_shift(1,ne,"sbcs");break;case"D":h[m][y]?(J.write_shift(4,("0000"+h[m][y].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(h[m][y].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+h[m][y].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var B=String(h[m][y]!=null?h[m][y]:"").slice(0,M[y]);for(J.write_shift(1,B,"sbcs"),g=0;g<M[y]-B.length;++g)J.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),pD=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+sa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(p,h){var x=e[h];return typeof x=="number"?cx(x):x},n=function(p,h,x){var m=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?p:cx(m)};e["|"]=254;function a(p,h){switch(h.type){case"base64":return s(rn(p),h);case"binary":return s(p,h);case"buffer":return s(et&&Buffer.isBuffer(p)?p.toString("binary"):so(p),h);case"array":return s(Qs(p),h)}throw new Error("Unrecognized type "+h.type)}function s(p,h){var x=p.split(/[\n\r]+/),m=-1,y=-1,g=0,w=0,v=[],b=[],M=null,C={},k=[],F=[],E=[],j=0,V;for(+h.codepage>=0&&An(+h.codepage);g!==x.length;++g){j=0;var W=x[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),te=W.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),ee=te[0],J;if(W.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&b.push(W.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,B=!1,q=!1,N=!1,U=-1,Z=-1;for(w=1;w<te.length;++w)switch(te[w].charAt(0)){case"A":break;case"X":y=parseInt(te[w].slice(1))-1,B=!0;break;case"Y":for(m=parseInt(te[w].slice(1))-1,B||(y=0),V=v.length;V<=m;++V)v[V]=[];break;case"K":J=te[w].slice(1),J.charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(In(J))?isNaN(ei(J).getDate())||(J=sr(J)):(J=In(J),M!==null&&pi(M)&&(J=_0(J))),ne=!0;break;case"E":N=!0;var _=Bo(te[w].slice(1),{r:m,c:y});v[m][y]=[v[m][y],_];break;case"S":q=!0,v[m][y]=[v[m][y],"S5S"];break;case"G":break;case"R":U=parseInt(te[w].slice(1))-1;break;case"C":Z=parseInt(te[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}if(ne&&(v[m][y]&&v[m][y].length==2?v[m][y][0]=J:v[m][y]=J,M=null),q){if(N)throw new Error("SYLK shared formula cannot have own formula");var P=U>-1&&v[U][Z];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");v[m][y][1]=Uw(P[1],{r:m-U,c:y-Z})}break;case"F":var A=0;for(w=1;w<te.length;++w)switch(te[w].charAt(0)){case"X":y=parseInt(te[w].slice(1))-1,++A;break;case"Y":for(m=parseInt(te[w].slice(1))-1,V=v.length;V<=m;++V)v[V]=[];break;case"M":j=parseInt(te[w].slice(1))/20;break;case"F":break;case"G":break;case"P":M=b[parseInt(te[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=te[w].slice(1).split(" "),V=parseInt(E[0],10);V<=parseInt(E[1],10);++V)j=parseInt(E[2],10),F[V-1]=j===0?{hidden:!0}:{wch:j},ti(F[V-1]);break;case"C":y=parseInt(te[w].slice(1))-1,F[y]||(F[y]={});break;case"R":m=parseInt(te[w].slice(1))-1,k[m]||(k[m]={}),j>0?(k[m].hpt=j,k[m].hpx=Pl(j)):j===0&&(k[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}A<1&&(M=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}}return k.length>0&&(C["!rows"]=k),F.length>0&&(C["!cols"]=F),h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),[v,C]}function o(p,h){var x=a(p,h),m=x[0],y=x[1],g=mi(m,h);return sa(y).forEach(function(w){g[w]=y[w]}),g}function i(p,h){return ys(o(p,h),h)}function l(p,h,x,m){var y="C;Y"+(x+1)+";X"+(m+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+J4(p.f,{r:x,c:m}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(p,h){h.forEach(function(x,m){var y="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Lu(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=zu(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function u(p,h){h.forEach(function(x,m){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*zw(x.hpx)+";"),y.length>2&&p.push(y+"R"+(m+1))})}function d(p,h){var x=["ID;PWXL;N;E"],m=[],y=zt(p["!ref"]),g,w=Array.isArray(p),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),p["!cols"]&&c(x,p["!cols"]),p["!rows"]&&u(x,p["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var b=y.s.r;b<=y.e.r;++b)for(var M=y.s.c;M<=y.e.c;++M){var C=Ke({r:b,c:M});g=w?(p[b]||[])[M]:p[C],!(!g||g.v==null&&(!g.f||g.F))&&m.push(l(g,p,b,M))}return x.join(v)+v+m.join(v)+v+"E"+v}return{to_workbook:i,to_sheet:o,from_sheet:d}}(),hD=function(){function e(s,o){switch(o.type){case"base64":return r(rn(s),o);case"binary":return r(s,o);case"buffer":return r(et&&Buffer.isBuffer(s)?s.toString("binary"):so(s),o);case"array":return r(Qs(s),o)}throw new Error("Unrecognized type "+o.type)}function r(s,o){for(var i=s.split(`
`),l=-1,c=-1,u=0,d=[];u!==i.length;++u){if(i[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var p=i[u].trim().split(","),h=p[0],x=p[1];++u;for(var m=i[u]||"";(m.match(/["]/g)||[]).length&1&&u<i.length-1;)m+=`
`+i[++u];switch(m=m.trim(),+h){case-1:if(m==="BOT"){d[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][c]=!0:m==="FALSE"?d[l][c]=!1:isNaN(In(x))?isNaN(ei(x).getDate())?d[l][c]=x:d[l][c]=sr(x):d[l][c]=In(x),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function t(s,o){return mi(e(s,o),o)}function n(s,o){return ys(t(s,o),o)}var a=function(){var s=function(l,c,u,d,p){l.push(c),l.push(u+","+d),l.push('"'+p.replace(/"/g,'""')+'"')},o=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=zt(l["!ref"]),d,p=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var m=Ke({r:h,c:x});if(d=p?(l[h]||[])[x]:l[m],!d){o(c,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?o(c,1,0,"="+d.f):o(c,1,0,""):o(c,0,y,"V");break;case"b":o(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=wn(d.z||Ge[14],Br(sr(d.v)))),o(c,0,d.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var g=`\r
`,w=c.join(g);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),mD=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,p){for(var h=d.split(`
`),x=-1,m=-1,y=0,g=[];y!==h.length;++y){var w=h[y].trim().split(":");if(w[0]==="cell"){var v=Rr(w[1]);if(g.length<=v.r)for(x=g.length;x<=v.r;++x)g[x]||(g[x]=[]);switch(x=v.r,m=v.c,w[2]){case"t":g[x][m]=e(w[3]);break;case"v":g[x][m]=+w[3];break;case"vtf":var b=w[w.length-1];case"vtc":switch(w[3]){case"nl":g[x][m]=!!+w[4];break;default:g[x][m]=+w[4];break}w[2]=="vtf"&&(g[x][m]=[g[x][m],b])}}}return p&&p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}function n(d,p){return mi(t(d,p),p)}function a(d,p){return ys(n(d,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var p=[],h=[],x,m="",y=hi(d["!ref"]),g=Array.isArray(d),w=y.s.r;w<=y.e.r;++w)for(var v=y.s.c;v<=y.e.c;++v)if(m=Ke({r:w,c:v}),x=g?(d[w]||[])[v]:d[m],!(!x||x.v==null||x.t==="z")){switch(h=["cell",m,"t"],x.t){case"s":case"str":h.push(r(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=r(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var b=Br(sr(x.v));h[2]="vtc",h[3]="nd",h[4]=""+b,h[5]=x.w||wn(x.z||Ge[14],b);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(d){return[s,o,i,o,c(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Al=function(){function e(u,d,p,h,x){x.raw?d[p][h]=u:u===""||(u==="TRUE"?d[p][h]=!0:u==="FALSE"?d[p][h]=!1:isNaN(In(u))?isNaN(ei(u).getDate())?d[p][h]=u:d[p][h]=sr(u):d[p][h]=In(u))}function r(u,d){var p=d||{},h=[];if(!u||u.length===0)return h;for(var x=u.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var y=10,g=0,w=0;w<=m;++w)g=x[w].indexOf(" "),g==-1?g=x[w].length:g++,y=Math.max(y,g);for(w=0;w<=m;++w){h[w]=[];var v=0;for(e(x[w].slice(0,y).trim(),h,w,v,p),v=1;v<=(x[w].length-y)/10+1;++v)e(x[w].slice(y+(v-1)*10,y+v*10).trim(),h,w,v,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var d={},p=!1,h=0,x=0;h<u.length;++h)(x=u.charCodeAt(h))==34?p=!p:!p&&x in t&&(d[x]=(d[x]||0)+1);x=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&x.push([d[h],h]);if(!x.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&x.push([d[h],h])}return x.sort(function(m,y){return m[0]-y[0]||n[m[1]]-n[y[1]]}),t[x.pop()[1]]||44}function s(u,d){var p=d||{},h="",x=p.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):p&&p.FS?h=p.FS:h=a(u.slice(0,1024));var y=0,g=0,w=0,v=0,b=0,M=h.charCodeAt(0),C=!1,k=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var E=p.dateNF!=null?TS(p.dateNF):null;function j(){var V=u.slice(v,b),W={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)W.t="z";else if(p.raw)W.t="s",W.v=V;else if(V.trim().length===0)W.t="s",W.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(W.t="s",W.v=V.slice(2,-1).replace(/""/g,'"')):tN(V)?(W.t="n",W.f=V.slice(1)):(W.t="s",W.v=V);else if(V=="TRUE")W.t="b",W.v=!0;else if(V=="FALSE")W.t="b",W.v=!1;else if(!isNaN(w=In(V)))W.t="n",p.cellText!==!1&&(W.w=V),W.v=w;else if(!isNaN(ei(V).getDate())||E&&V.match(E)){W.z=p.dateNF||Ge[14];var te=0;E&&V.match(E)&&(V=CS(V,p.dateNF,V.match(E)||[]),te=1),p.cellDates?(W.t="d",W.v=sr(V,te)):(W.t="n",W.v=Br(sr(V,te))),p.cellText!==!1&&(W.w=wn(W.z,W.v instanceof Date?Br(W.v):W.v)),p.cellNF||delete W.z}else W.t="s",W.v=V;if(W.t=="z"||(p.dense?(x[y]||(x[y]=[]),x[y][g]=W):x[Ke({c:g,r:y})]=W),v=b+1,F=u.charCodeAt(v),m.e.c<g&&(m.e.c=g),m.e.r<y&&(m.e.r=y),k==M)++g;else if(g=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;b<u.length;++b)switch(k=u.charCodeAt(b)){case 34:F===34&&(C=!C);break;case M:case 10:case 13:if(!C&&j())break e;break}return b-v>0&&j(),x["!ref"]=nt(m),x}function o(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):mi(r(u,d),d)}function i(u,d){var p="",h=d.type=="string"?[0,0,0,0]:Ch(u,d);switch(d.type){case"base64":p=rn(u);break;case"binary":p=u;break;case"buffer":d.codepage==65001?p=u.toString("utf8"):(d.codepage,p=et&&Buffer.isBuffer(u)?u.toString("binary"):so(u));break;case"array":p=Qs(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=Et(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=Et(p):d.type=="binary",p.slice(0,19)=="socialcalc:version:"?mD.to_sheet(d.type=="string"?p:Et(p),d):o(p,d)}function l(u,d){return ys(i(u,d),d)}function c(u){for(var d=[],p=zt(u["!ref"]),h,x=Array.isArray(u),m=p.s.r;m<=p.e.r;++m){for(var y=[],g=p.s.c;g<=p.e.c;++g){var w=Ke({r:m,c:g});if(h=x?(u[m]||[])[g]:u[w],!h||h.v==null){y.push("          ");continue}for(var v=(h.w||(Oa(h),h.w)||"").slice(0,10);v.length<10;)v+=" ";y.push(v+(g===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:i,from_sheet:c}}();function xD(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=pD.to_workbook(e,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Al.to_workbook(e,r)}}var al=function(){function e(_,P,A){if(_){cr(_,_.l||0);for(var z=A.Enum||U;_.l<_.length;){var Q=_.read_shift(2),re=z[Q]||z[65535],oe=_.read_shift(2),X=_.l+oe,Y=re.f&&re.f(_,oe,A);if(_.l=X,P(Y,re,Q))return}}}function r(_,P){switch(P.type){case"base64":return t(Fn(rn(_)),P);case"binary":return t(Fn(_),P);case"buffer":case"array":return t(_,P)}throw"Unsupported type "+P.type}function t(_,P){if(!_)return _;var A=P||{},z=A.dense?[]:{},Q="Sheet1",re="",oe=0,X={},Y=[],K=[],D={s:{r:0,c:0},e:{r:0,c:0}},we=A.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)A.Enum=U,e(_,function(xe,$e,G){switch(G){case 0:A.vers=xe,xe>=4096&&(A.qpro=!0);break;case 6:D=xe;break;case 204:xe&&(re=xe);break;case 222:re=xe;break;case 15:case 51:A.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:G==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=A.dateNF||Ge[14],A.cellDates&&(xe[1].t="d",xe[1].v=_0(xe[1].v))),A.qpro&&xe[3]>oe&&(z["!ref"]=nt(D),X[Q]=z,Y.push(Q),z=A.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},oe=xe[3],Q=re||"Sheet"+(oe+1),re="");var ue=A.dense?(z[xe[0].r]||[])[xe[0].c]:z[Ke(xe[0])];if(ue){ue.t=xe[1].t,ue.v=xe[1].v,xe[1].z!=null&&(ue.z=xe[1].z),xe[1].f!=null&&(ue.f=xe[1].f);break}A.dense?(z[xe[0].r]||(z[xe[0].r]=[]),z[xe[0].r][xe[0].c]=xe[1]):z[Ke(xe[0])]=xe[1];break}},A);else if(_[2]==26||_[2]==14)A.Enum=Z,_[2]==14&&(A.qpro=!0,_.l=0),e(_,function(xe,$e,G){switch(G){case 204:Q=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>oe&&(z["!ref"]=nt(D),X[Q]=z,Y.push(Q),z=A.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},oe=xe[3],Q="Sheet"+(oe+1)),we>0&&xe[0].r>=we)break;A.dense?(z[xe[0].r]||(z[xe[0].r]=[]),z[xe[0].r][xe[0].c]=xe[1]):z[Ke(xe[0])]=xe[1],D.e.c<xe[0].c&&(D.e.c=xe[0].c),D.e.r<xe[0].r&&(D.e.r=xe[0].r);break;case 27:xe[14e3]&&(K[xe[14e3][0]]=xe[14e3][1]);break;case 1537:K[xe[0]]=xe[1],xe[0]==oe&&(Q=xe[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(z["!ref"]=nt(D),X[re||Q]=z,Y.push(re||Q),!K.length)return{SheetNames:Y,Sheets:X};for(var pe={},me=[],_e=0;_e<K.length;++_e)X[Y[_e]]?(me.push(K[_e]||Y[_e]),pe[K[_e]]=X[K[_e]]||X[Y[_e]]):(me.push(K[_e]),pe[K[_e]]={"!ref":"A1"});return{SheetNames:me,Sheets:pe}}function n(_,P){var A=P||{};if(+A.codepage>=0&&An(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var z=Od(),Q=zt(_["!ref"]),re=Array.isArray(_),oe=[];Sn(z,0,s(1030)),Sn(z,6,l(Q));for(var X=Math.min(Q.e.r,8191),Y=Q.s.r;Y<=X;++Y)for(var K=pr(Y),D=Q.s.c;D<=Q.e.c;++D){Y===Q.s.r&&(oe[D]=Jt(D));var we=oe[D]+K,pe=re?(_[Y]||[])[D]:_[we];if(!(!pe||pe.t=="z"))if(pe.t=="n")(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?Sn(z,13,h(Y,D,pe.v)):Sn(z,14,m(Y,D,pe.v));else{var me=Oa(pe);Sn(z,15,d(Y,D,me.slice(0,239)))}}return Sn(z,1),z.end()}function a(_,P){var A=P||{};if(+A.codepage>=0&&An(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var z=Od();Sn(z,0,o(_));for(var Q=0,re=0;Q<_.SheetNames.length;++Q)(_.Sheets[_.SheetNames[Q]]||{})["!ref"]&&Sn(z,27,N(_.SheetNames[Q],re++));var oe=0;for(Q=0;Q<_.SheetNames.length;++Q){var X=_.Sheets[_.SheetNames[Q]];if(!(!X||!X["!ref"])){for(var Y=zt(X["!ref"]),K=Array.isArray(X),D=[],we=Math.min(Y.e.r,8191),pe=Y.s.r;pe<=we;++pe)for(var me=pr(pe),_e=Y.s.c;_e<=Y.e.c;++_e){pe===Y.s.r&&(D[_e]=Jt(_e));var xe=D[_e]+me,$e=K?(X[pe]||[])[_e]:X[xe];if(!(!$e||$e.t=="z"))if($e.t=="n")Sn(z,23,j(pe,_e,oe,$e.v));else{var G=Oa($e);Sn(z,22,k(pe,_e,oe,G.slice(0,239)))}}++oe}}return Sn(z,1),z.end()}function s(_){var P=Qt(2);return P.write_shift(2,_),P}function o(_){var P=Qt(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var A=0,z=0,Q=0,re=0;re<_.SheetNames.length;++re){var oe=_.SheetNames[re],X=_.Sheets[oe];if(!(!X||!X["!ref"])){++Q;var Y=hi(X["!ref"]);A<Y.e.r&&(A=Y.e.r),z<Y.e.c&&(z=Y.e.c)}}return A>8191&&(A=8191),P.write_shift(2,A),P.write_shift(1,Q),P.write_shift(1,z),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function i(_,P,A){var z={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&A.qpro?(z.s.c=_.read_shift(1),_.l++,z.s.r=_.read_shift(2),z.e.c=_.read_shift(1),_.l++,z.e.r=_.read_shift(2),z):(z.s.c=_.read_shift(2),z.s.r=_.read_shift(2),P==12&&A.qpro&&(_.l+=2),z.e.c=_.read_shift(2),z.e.r=_.read_shift(2),P==12&&A.qpro&&(_.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function l(_){var P=Qt(8);return P.write_shift(2,_.s.c),P.write_shift(2,_.s.r),P.write_shift(2,_.e.c),P.write_shift(2,_.e.r),P}function c(_,P,A){var z=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(z[0].c=_.read_shift(1),z[3]=_.read_shift(1),z[0].r=_.read_shift(2),_.l+=2):(z[2]=_.read_shift(1),z[0].c=_.read_shift(2),z[0].r=_.read_shift(2)),z}function u(_,P,A){var z=_.l+P,Q=c(_,P,A);if(Q[1].t="s",A.vers==20768){_.l++;var re=_.read_shift(1);return Q[1].v=_.read_shift(re,"utf8"),Q}return A.qpro&&_.l++,Q[1].v=_.read_shift(z-_.l,"cstr"),Q}function d(_,P,A){var z=Qt(7+A.length);z.write_shift(1,255),z.write_shift(2,P),z.write_shift(2,_),z.write_shift(1,39);for(var Q=0;Q<z.length;++Q){var re=A.charCodeAt(Q);z.write_shift(1,re>=128?95:re)}return z.write_shift(1,0),z}function p(_,P,A){var z=c(_,P,A);return z[1].v=_.read_shift(2,"i"),z}function h(_,P,A){var z=Qt(7);return z.write_shift(1,255),z.write_shift(2,P),z.write_shift(2,_),z.write_shift(2,A,"i"),z}function x(_,P,A){var z=c(_,P,A);return z[1].v=_.read_shift(8,"f"),z}function m(_,P,A){var z=Qt(13);return z.write_shift(1,255),z.write_shift(2,P),z.write_shift(2,_),z.write_shift(8,A,"f"),z}function y(_,P,A){var z=_.l+P,Q=c(_,P,A);if(Q[1].v=_.read_shift(8,"f"),A.qpro)_.l=z;else{var re=_.read_shift(2);b(_.slice(_.l,_.l+re),Q),_.l+=re}return Q}function g(_,P,A){var z=P&32768;return P&=-32769,P=(z?_:0)+(P>=8192?P-16384:P),(z?"":"$")+(A?Jt(P):pr(P))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(_,P){cr(_,0);for(var A=[],z=0,Q="",re="",oe="",X="";_.l<_.length;){var Y=_[_.l++];switch(Y){case 0:A.push(_.read_shift(8,"f"));break;case 1:re=g(P[0].c,_.read_shift(2),!0),Q=g(P[0].r,_.read_shift(2),!1),A.push(re+Q);break;case 2:{var K=g(P[0].c,_.read_shift(2),!0),D=g(P[0].r,_.read_shift(2),!1);re=g(P[0].c,_.read_shift(2),!0),Q=g(P[0].r,_.read_shift(2),!1),A.push(K+D+":"+re+Q)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(_.read_shift(2));break;case 6:{for(var we="";Y=_[_.l++];)we+=String.fromCharCode(Y);A.push('"'+we.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:X=A.pop(),oe=A.pop(),A.push(["AND","OR"][Y-20]+"("+oe+","+X+")");break;default:if(Y<32&&v[Y])X=A.pop(),oe=A.pop(),A.push(oe+v[Y]+X);else if(w[Y]){if(z=w[Y][1],z==69&&(z=_[_.l++]),z>A.length){console.error("WK1 bad formula parse 0x"+Y.toString(16)+":|"+A.join("|")+"|");return}var pe=A.slice(-z);A.length-=z,A.push(w[Y][0]+"("+pe.join(",")+")")}else return Y<=7?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=24?console.error("WK1 unsupported op "+Y.toString(16)):Y<=30?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=115?console.error("WK1 unsupported function opcode "+Y.toString(16)):console.error("WK1 unrecognized opcode "+Y.toString(16))}}A.length==1?P[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function M(_){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=_.read_shift(2),P[3]=_[_.l++],P[0].c=_[_.l++],P}function C(_,P){var A=M(_);return A[1].t="s",A[1].v=_.read_shift(P-4,"cstr"),A}function k(_,P,A,z){var Q=Qt(6+z.length);Q.write_shift(2,_),Q.write_shift(1,A),Q.write_shift(1,P),Q.write_shift(1,39);for(var re=0;re<z.length;++re){var oe=z.charCodeAt(re);Q.write_shift(1,oe>=128?95:oe)}return Q.write_shift(1,0),Q}function F(_,P){var A=M(_);A[1].v=_.read_shift(2);var z=A[1].v>>1;if(A[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return A[1].v=z,A}function E(_,P){var A=M(_),z=_.read_shift(4),Q=_.read_shift(4),re=_.read_shift(2);if(re==65535)return z===0&&Q===3221225472?(A[1].t="e",A[1].v=15):z===0&&Q===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var oe=re&32768;return re=(re&32767)-16446,A[1].v=(1-oe*2)*(Q*Math.pow(2,re+32)+z*Math.pow(2,re)),A}function j(_,P,A,z){var Q=Qt(14);if(Q.write_shift(2,_),Q.write_shift(1,A),Q.write_shift(1,P),z==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var re=0,oe=0,X=0,Y=0;return z<0&&(re=1,z=-z),oe=Math.log2(z)|0,z/=Math.pow(2,oe-31),Y=z>>>0,Y&2147483648||(z/=2,++oe,Y=z>>>0),z-=Y,Y|=2147483648,Y>>>=0,z*=Math.pow(2,32),X=z>>>0,Q.write_shift(4,X),Q.write_shift(4,Y),oe+=16383+(re?32768:0),Q.write_shift(2,oe),Q}function V(_,P){var A=E(_);return _.l+=P-14,A}function W(_,P){var A=M(_),z=_.read_shift(4);return A[1].v=z>>6,A}function te(_,P){var A=M(_),z=_.read_shift(8,"f");return A[1].v=z,A}function ee(_,P){var A=te(_);return _.l+=P-10,A}function J(_,P){return _[_.l+P-1]==0?_.read_shift(P,"cstr"):""}function ne(_,P){var A=_[_.l++];A>P-1&&(A=P-1);for(var z="";z.length<A;)z+=String.fromCharCode(_[_.l++]);return z}function B(_,P,A){if(!(!A.qpro||P<21)){var z=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var Q=_.read_shift(P-21,"cstr");return[z,Q]}}function q(_,P){for(var A={},z=_.l+P;_.l<z;){var Q=_.read_shift(2);if(Q==14e3){for(A[Q]=[0,""],A[Q][0]=_.read_shift(2);_[_.l];)A[Q][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return A}function N(_,P){var A=Qt(5+_.length);A.write_shift(2,14e3),A.write_shift(2,P);for(var z=0;z<_.length;++z){var Q=_.charCodeAt(z);A[A.l++]=Q>127?95:Q}return A[A.l++]=0,A}var U={0:{n:"BOF",f:Gt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:i},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:J},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:J},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:B},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function gD(e){var r={},t=e.match(Dr),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=He(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=nh[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return r}var vD=function(){var e=Nl("t"),r=Nl("rPr");function t(s){var o=s.match(e);if(!o)return{t:"s",v:""};var i={t:"s",v:lt(o[1])},l=s.match(r);return l&&(i.s=gD(l[1])),i}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(t).filter(function(i){return i.v})}}(),yD=function(){var r=/(\r\n|\n)/g;function t(a,s,o){var i=[];a.u&&i.push("text-decoration: underline;"),a.uval&&i.push("text-underline-style:"+a.uval+";"),a.sz&&i.push("font-size:"+a.sz+"pt;"),a.outline&&i.push("text-effect: outline;"),a.shadow&&i.push("text-shadow: auto;"),s.push('<span style="'+i.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),wD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,kD=/<(?:\w+:)?r>/,_D=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function wh(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(Et(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Et(e),t&&(n.h=uh(n.t))):e.match(kD)&&(n.r=Et(e),n.t=lt(Et((e.replace(_D,"").match(wD)||[]).join("").replace(Dr,""))),t&&(n.h=yD(vD(n.r)))),n):{t:""}}var bD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ED=/<(?:\w+:)?(?:si|sstItem)>/g,SD=/<\/(?:\w+:)?(?:si|sstItem)>/;function TD(e,r){var t=[],n="";if(!e)return t;var a=e.match(bD);if(a){n=a[2].replace(ED,"").split(SD);for(var s=0;s!=n.length;++s){var o=wh(n[s].trim(),r);o!=null&&(t[t.length]=o)}a=He(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function CD(e){return[e.read_shift(4),e.read_shift(4)]}function DD(e,r){var t=[],n=!1;return Ra(e,function(s,o,i){switch(i){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||r.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),t}function Pw(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function _a(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function ND(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=_a(e,4),r.U=_a(e,4),r.W=_a(e,4),r}function FD(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function AD(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(FD(e));return r}function OD(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function PD(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=_a(e,4),r.U=_a(e,4),r.W=_a(e,4),r}function MD(e){var r=PD(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Mw(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function Rw(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function RD(e){var r=_a(e);switch(r.Minor){case 2:return[r.Minor,ID(e)];case 3:return[r.Minor,jD()];case 4:return[r.Minor,LD(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function ID(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=Mw(e,t),a=Rw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function jD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function LD(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(Dr,function(s){var o=He(s);switch(ia(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(i){n[i]=o[i]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function zD(e,r){var t={},n=t.EncryptionVersionInfo=_a(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=Mw(e,a),r-=a,t.EncryptionVerifier=Rw(e,r),t}function BD(e){var r={},t=r.EncryptionVersionInfo=_a(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function WD(e){var r=0,t,n=Pw(e),a=n.length+1,s,o,i,l,c;for(t=fs(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)o=t[s],i=r&16384?1:0,l=r<<1&32767,c=i|l,r=c^o;return r^52811}var Iw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,i){return n(o^i)},s=function(o){for(var i=r[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],d=0;d!=7;++d)u&64&&(i^=t[l]),u*=2,--l;return i};return function(o){for(var i=Pw(o),l=s(i),c=i.length,u=fs(16),d=0;d!=16;++d)u[d]=0;var p,h,x;for((c&1)===1&&(p=l>>8,u[c]=a(e[0],p),--c,p=l&255,h=i[i.length-1],u[c]=a(h,p));c>0;)--c,p=l>>8,u[c]=a(i[c],p),--c,p=l&255,u[c]=a(i[c],p);for(c=15,x=15-i.length;x>0;)p=l>>8,u[c]=a(e[x],p),--c,--x,p=l&255,u[c]=a(i[c],p),--c,--x;return u}}(),UD=function(e,r,t,n,a){a||(a=r),n||(n=Iw(e));var s,o;for(s=0;s!=r.length;++s)o=r[s],o^=n[t],o=(o>>5|o<<3)&255,a[s]=o,++t;return[a,t,n]},$D=function(e){var r=0,t=Iw(e);return function(n){var a=UD("",n,r,t);return r=a[1],a[0]}};function HD(e,r,t,n){var a={key:Gt(e),verificationBytes:Gt(e)};return t.password&&(a.verifier=WD(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=$D(t.password)),a}function YD(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=BD(e):n.Data=zD(e,r),n}function VD(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?YD(e,r-2,n):HD(e,t.biff>=8?r:r-2,t,n),n}var KD=function(){function e(a,s){switch(s.type){case"base64":return r(rn(a),s);case"binary":return r(a,s);case"buffer":return r(et&&Buffer.isBuffer(a)?a.toString("binary"):so(a),s);case"array":return r(Qs(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){var o=s||{},i=o.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(i)&&(i[d]=[]);for(var p=/\\\w+\b/g,h=0,x,m=-1;x=p.exec(u);){switch(x[0]){case"\\cell":var y=u.slice(h,p.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++m,y.length){var g={v:y,t:"s"};Array.isArray(i)?i[d][m]=g:i[Ke({r:d,c:m})]=g}break}h=p.lastIndex}m>c.e.c&&(c.e.c=m)}),i["!ref"]=nt(c),i}function t(a,s){return ys(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=zt(a["!ref"]),i,l=Array.isArray(a),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var d=Ke({r:c,c:u});i=l?(a[c]||[])[u]:a[d],!(!i||i.v==null&&(!i.f||i.F))&&(s.push(" "+(i.w||(Oa(i),i.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function GD(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ol(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function XD(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),s=Math.min(r,t,n),o=a-s;if(o===0)return[0,0,r];var i=0,l=0,c=a+s;switch(l=o/(c>1?2-c:c),a){case r:i=((t-n)/o+6)%6;break;case t:i=(n-r)/o+2;break;case n:i=(r-t)/o+4;break}return[i/6,l,c/2]}function QD(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],i=6*r,l;if(t!==0)switch(i|0){case 0:case 6:l=a*i,o[0]+=a,o[1]+=l;break;case 1:l=a*(2-i),o[0]+=l,o[1]+=a;break;case 2:l=a*(i-2),o[1]+=a,o[2]+=l;break;case 3:l=a*(4-i),o[1]+=l,o[2]+=a;break;case 4:l=a*(i-4),o[2]+=a,o[0]+=l;break;case 5:l=a*(6-i),o[2]+=l,o[0]+=a;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function ju(e,r){if(r===0)return e;var t=XD(GD(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Ol(QD(t))}var jw=6,qD=15,ZD=1,Pr=jw;function Lu(e){return Math.floor((e+Math.round(128/Pr)/256)*Pr)}function zu(e){return Math.floor((e-5)/Pr*100+.5)/100}function Id(e){return Math.round((e*Pr+5)/Pr*256)/256}function pf(e){return Id(zu(Lu(e)))}function kh(e){var r=Math.abs(e-pf(e)),t=Pr;if(r>.005)for(Pr=ZD;Pr<qD;++Pr)Math.abs(e-pf(e))<=r&&(r=Math.abs(e-pf(e)),t=Pr);Pr=t}function ti(e){e.width?(e.wpx=Lu(e.width),e.wch=zu(e.wpx),e.MDW=Pr):e.wpx?(e.wch=zu(e.wpx),e.width=Id(e.wch),e.MDW=Pr):typeof e.wch=="number"&&(e.width=Id(e.wch),e.wpx=Lu(e.width),e.MDW=Pr),e.customWidth&&delete e.customWidth}var JD=96,Lw=JD;function zw(e){return e*96/Lw}function Pl(e){return e*Lw/96}var e4={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function t4(e,r,t,n){r.Borders=[];var a={},s=!1;(e[0].match(Dr)||[]).forEach(function(o){var i=He(o);switch(ia(i[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},i.diagonalUp&&(a.diagonalUp=Ft(i.diagonalUp)),i.diagonalDown&&(a.diagonalDown=Ft(i.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in borders")}})}function r4(e,r,t,n){r.Fills=[];var a={},s=!1;(e[0].match(Dr)||[]).forEach(function(o){var i=He(o);switch(ia(i[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":i.patternType&&(a.patternType=i.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),i.indexed&&(a.bgColor.indexed=parseInt(i.indexed,10)),i.theme&&(a.bgColor.theme=parseInt(i.theme,10)),i.tint&&(a.bgColor.tint=parseFloat(i.tint)),i.rgb&&(a.bgColor.rgb=i.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),i.theme&&(a.fgColor.theme=parseInt(i.theme,10)),i.tint&&(a.fgColor.tint=parseFloat(i.tint)),i.rgb!=null&&(a.fgColor.rgb=i.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fills")}})}function n4(e,r,t,n){r.Fonts=[];var a={},s=!1;(e[0].match(Dr)||[]).forEach(function(o){var i=He(o);switch(ia(i[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":i.val&&(a.name=Et(i.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=i.val?Ft(i.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=i.val?Ft(i.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(i.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=i.val?Ft(i.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=i.val?Ft(i.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=i.val?Ft(i.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=i.val?Ft(i.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=i.val?Ft(i.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":i.val&&(a.sz=+i.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":i.val&&(a.vertAlign=i.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":i.val&&(a.family=parseInt(i.val,10));break;case"<family/>":case"</family>":break;case"<scheme":i.val&&(a.scheme=i.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(i.val=="1")break;i.codepage=nh[parseInt(i.val,10)];break;case"<color":if(a.color||(a.color={}),i.auto&&(a.color.auto=Ft(i.auto)),i.rgb)a.color.rgb=i.rgb.slice(-6);else if(i.indexed){a.color.index=parseInt(i.indexed,10);var l=Ls[a.color.index];a.color.index==81&&(l=Ls[1]),l||(l=Ls[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else i.theme&&(a.color.theme=parseInt(i.theme,10),i.tint&&(a.color.tint=parseFloat(i.tint)),i.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=ju(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}function a4(e,r,t){r.NumberFmt=[];for(var n=sa(Ge),a=0;a<n.length;++a)r.NumberFmt[n[a]]=Ge[n[a]];var s=e[0].match(Dr);if(s)for(a=0;a<s.length;++a){var o=He(s[a]);switch(ia(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var i=lt(Et(o.formatCode)),l=parseInt(o.numFmtId,10);if(r.NumberFmt[l]=i,l>0){if(l>392){for(l=392;l>60&&r.NumberFmt[l]!=null;--l);r.NumberFmt[l]=i}js(i,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Cc=["numFmtId","fillId","fontId","borderId","xfId"],Dc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function s4(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(Dr)||[]).forEach(function(s){var o=He(s),i=0;switch(ia(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],i=0;i<Cc.length;++i)n[Cc[i]]&&(n[Cc[i]]=parseInt(n[Cc[i]],10));for(i=0;i<Dc.length;++i)n[Dc[i]]&&(n[Dc[i]]=Ft(n[Dc[i]]));if(r.NumberFmt&&n.numFmtId>392){for(i=392;i>60;--i)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[i]){n.numFmtId=i;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Ft(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var o4=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,l,c){var u={};if(!i)return u;i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=i.match(r))&&a4(d,u,c),(d=i.match(a))&&n4(d,u,l,c),(d=i.match(n))&&r4(d,u,l,c),(d=i.match(s))&&t4(d,u,l,c),(d=i.match(t))&&s4(d,u,c),u}}();function i4(e,r){var t=e.read_shift(2),n=Sr(e);return[t,n]}function l4(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=vT(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var i=e.read_shift(1);i>0&&(n.family=i);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=gT(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Sr(e),n}var c4=Cr;function u4(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var f4=Cr;function d4(e,r,t){var n={};n.NumberFmt=[];for(var a in Ge)n.NumberFmt[a]=Ge[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return Ra(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],js(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(l.color.rgb=ju(r.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!o||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var p4=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function h4(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(Dr)||[]).forEach(function(a){var s=He(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[p4.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function m4(){}function x4(){}var g4=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,v4=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,y4=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function w4(e,r,t){r.themeElements={};var n;[["clrScheme",g4,h4],["fontScheme",v4,m4],["fmtScheme",y4,x4]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var k4=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Bw(e,r){(!e||e.length===0)&&(e=_4());var t,n={};if(!(t=e.match(k4)))throw new Error("themeElements not found in theme");return w4(t[0],n,r),n.raw=e,n}function _4(e,r){var t=[qy];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function b4(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=Qy(s,{type:"array"})}catch{return}var i=qr(o,"theme/theme/theme1.xml",!0);if(i)return Bw(i,t)}}function E4(e){return e.read_shift(4)}function S4(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=T4(e,4);break;case 2:r.xclrValue=Tw(e);break;case 3:r.xclrValue=E4(e);break;case 4:e.l+=4;break}return e.l+=8,r}function T4(e,r){return Cr(e,r)}function C4(e,r){return Cr(e,r)}function D4(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=S4(e);break;case 6:n[1]=C4(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function N4(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(D4(e,t-e.l));return{ixfe:n,ext:s}}function F4(e,r){r.forEach(function(t){switch(t[0]){}})}function A4(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Sr(e)}}function O4(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function P4(e){return e.l+=4,e.read_shift(4)!=0}function M4(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],o=!1,i=2;return Ra(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){i==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):i==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:i=l?1:0;break;case 338:i=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!c.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function R4(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,o;return e.replace(Dr,function(i){var l=He(i);switch(ia(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(o=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return i}),n}function I4(e){var r=[];if(!e)return r;var t=1;return(e.match(Dr)||[]).forEach(function(n){var a=He(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function j4(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Ke(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function L4(e,r,t){var n=[];return Ra(e,function(s,o,i){switch(i){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+i.toString(16))}}),n}function z4(e,r,t,n){if(!e)return e;var a=n||{},s=!1;Ra(e,function(i,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function B4(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Gx(e,r,t,n){var a=Array.isArray(e),s;r.forEach(function(o){var i=Rr(o.ref);if(a?(e[i.r]||(e[i.r]=[]),s=e[i.r][i.c]):s=e[o.ref],!s){s={t:"z"},a?e[i.r][i.c]=s:e[o.ref]=s;var l=zt(e["!ref"]||"BDWGO1000001:A1");l.s.r>i.r&&(l.s.r=i.r),l.e.r<i.r&&(l.e.r=i.r),l.s.c>i.c&&(l.s.c=i.c),l.e.c<i.c&&(l.e.c=i.c);var c=nt(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:t};o.h&&(u.h=o.h);for(var d=s.c.length-1;d>=0;--d){if(!t&&s.c[d].T)return;t&&!s.c[d].T&&s.c.splice(d,1)}if(t&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}s.c.push(u)})}function W4(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var i=o.match(/<(?:\w+:)?author[^>]*>(.*)/);i&&t.push(i[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var i=o.match(/<(?:\w+:)?comment[^>]*>/);if(i){var l=He(i[0]),c={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Rr(l.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var d=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!d&&!!d[1]&&wh(d[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function U4(e,r){var t=[],n=!1,a={},s=0;return e.replace(Dr,function(i,l){var c=He(i);switch(ia(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=l+i.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return i}),t}function $4(e,r){var t=[],n=!1;return e.replace(Dr,function(s){var o=He(s);switch(ia(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),t}function H4(e){var r={};r.iauthor=e.read_shift(4);var t=io(e);return r.rfx=t.s,r.ref=Ke(t.s),e.l+=16,r}var Y4=Sr;function V4(e,r){var t=[],n=[],a={},s=!1;return Ra(e,function(i,l,c){switch(c){case 632:n.push(i);break;case 635:a=i;break;case 637:a.t=i.t,a.h=i.h,a.r=i.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),t}var K4="application/vnd.ms-office.vbaProject";function G4(e){var r=rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(r,a,e.FileIndex[n].content)}}),rt.write(r)}function X4(){return{"!type":"dialog"}}function Q4(){return{"!type":"dialog"}}function q4(){return{"!type":"macro"}}function Z4(){return{"!type":"macro"}}var Bo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,s,o){var i=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?i=!0:o.charAt(0)=="["&&(i=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return i?u+=r.c:--u,l?c+=r.r:--c,a+(i?"":"$")+Jt(u)+(l?"":"$")+pr(c)}return function(a,s){return r=s,a.replace(e,t)}}(),Ww=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,J4=function(){return function(r,t){return r.replace(Ww,function(n,a,s,o,i,l){var c=hh(o)-(s?0:t.c),u=ph(l)-(i?0:t.r),d=u==0?"":i?u+1:"["+u+"]",p=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+p})}}();function Uw(e,r){return e.replace(Ww,function(t,n,a,s,o,i){return n+(a=="$"?a+s:Jt(hh(s)+r.c))+(o=="$"?o+i:pr(ph(i)+r.r))})}function eN(e,r,t){var n=hi(r),a=n.s,s=Rr(t),o={r:s.r-a.r,c:s.c-a.c};return Uw(e,o)}function tN(e){return e.length!=1}function Xx(e){return e.replace(/_xlfn\./g,"")}function Vt(e){e.l+=1}function ds(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function $w(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Hw(e);t.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),o=ds(e),i=ds(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function Hw(e){var r=ds(e),t=ds(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function rN(e,r,t){if(t.biff<8)return Hw(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),s=ds(e),o=ds(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Yw(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return nN(e);var n=e.read_shift(t&&t.biff==12?4:2),a=ds(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function nN(e){var r=ds(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function aN(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function sN(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return oN(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,i=(s&32768)>>15;if(s&=16383,i==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:i}}function oN(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function iN(e,r,t){var n=(e[e.l++]&96)>>5,a=$w(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function lN(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=$w(e,s,t);return[n,a,o]}function cN(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function uN(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function fN(e,r,t){var n=(e[e.l++]&96)>>5,a=rN(e,r-1,t);return[n,a]}function dN(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Qx(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function pN(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function hN(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function mN(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function xN(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function gN(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Vw(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function vN(e){return e.read_shift(2),Vw(e)}function yN(e){return e.read_shift(2),Vw(e)}function wN(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Yw(e,0,t);return[n,a]}function kN(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=sN(e,0,t);return[n,a]}function _N(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=Yw(e,0,t);return[n,a,s]}function bN(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[E3[a],Xw[a],n]}function EN(e,r,t){var n=e[e.l++],a=e.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:SN(e);return[a,(s[0]===0?Xw:b3)[s[1]]]}function SN(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function TN(e,r,t){e.l+=t&&t.biff==2?3:4}function CN(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function DN(e){return e.l++,lo[e.read_shift(1)]}function NN(e){return e.l++,e.read_shift(2)}function FN(e){return e.l++,e.read_shift(1)!==0}function AN(e){return e.l++,br(e)}function ON(e,r,t){return e.l++,Vl(e,r-1,t)}function PN(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Ut(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=lo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=br(e);break;case 2:t[1]=co(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function MN(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?io:b0)(e));return a}function RN(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var i=0;i!=a;++i)o[s][i]=PN(e,t.biff);return o}function IN(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function jN(e,r,t){if(t.biff==5)return LN(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function LN(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function zN(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function BN(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function WN(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function UN(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var $N=Cr,HN=Cr,YN=Cr;function Gl(e,r,t){return e.l+=2,[aN(e)]}function _h(e){return e.l+=6,[]}var VN=Gl,KN=_h,GN=_h,XN=Gl;function Kw(e){return e.l+=2,[Gt(e),e.read_shift(2)&1]}var QN=Gl,qN=Kw,ZN=_h,JN=Gl,e3=Gl,t3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function r3(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),o=t3[t>>2&31];return{ixti:r,coltype:t&3,rt:o,idx:n,c:a,C:s}}function n3(e){return e.l+=2,[e.read_shift(4)]}function a3(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function s3(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function o3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function i3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function l3(e){return e.l+=4,[0,0]}var qx={1:{n:"PtgExp",f:CN},2:{n:"PtgTbl",f:YN},3:{n:"PtgAdd",f:Vt},4:{n:"PtgSub",f:Vt},5:{n:"PtgMul",f:Vt},6:{n:"PtgDiv",f:Vt},7:{n:"PtgPower",f:Vt},8:{n:"PtgConcat",f:Vt},9:{n:"PtgLt",f:Vt},10:{n:"PtgLe",f:Vt},11:{n:"PtgEq",f:Vt},12:{n:"PtgGe",f:Vt},13:{n:"PtgGt",f:Vt},14:{n:"PtgNe",f:Vt},15:{n:"PtgIsect",f:Vt},16:{n:"PtgUnion",f:Vt},17:{n:"PtgRange",f:Vt},18:{n:"PtgUplus",f:Vt},19:{n:"PtgUminus",f:Vt},20:{n:"PtgPercent",f:Vt},21:{n:"PtgParen",f:Vt},22:{n:"PtgMissArg",f:Vt},23:{n:"PtgStr",f:ON},26:{n:"PtgSheet",f:a3},27:{n:"PtgEndSheet",f:s3},28:{n:"PtgErr",f:DN},29:{n:"PtgBool",f:FN},30:{n:"PtgInt",f:NN},31:{n:"PtgNum",f:AN},32:{n:"PtgArray",f:dN},33:{n:"PtgFunc",f:bN},34:{n:"PtgFuncVar",f:EN},35:{n:"PtgName",f:IN},36:{n:"PtgRef",f:wN},37:{n:"PtgArea",f:iN},38:{n:"PtgMemArea",f:zN},39:{n:"PtgMemErr",f:$N},40:{n:"PtgMemNoMem",f:HN},41:{n:"PtgMemFunc",f:BN},42:{n:"PtgRefErr",f:WN},43:{n:"PtgAreaErr",f:cN},44:{n:"PtgRefN",f:kN},45:{n:"PtgAreaN",f:fN},46:{n:"PtgMemAreaN",f:o3},47:{n:"PtgMemNoMemN",f:i3},57:{n:"PtgNameX",f:jN},58:{n:"PtgRef3d",f:_N},59:{n:"PtgArea3d",f:lN},60:{n:"PtgRefErr3d",f:UN},61:{n:"PtgAreaErr3d",f:uN},255:{}},c3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},u3={1:{n:"PtgElfLel",f:Kw},2:{n:"PtgElfRw",f:JN},3:{n:"PtgElfCol",f:VN},6:{n:"PtgElfRwV",f:e3},7:{n:"PtgElfColV",f:XN},10:{n:"PtgElfRadical",f:QN},11:{n:"PtgElfRadicalS",f:ZN},13:{n:"PtgElfColS",f:KN},15:{n:"PtgElfColSV",f:GN},16:{n:"PtgElfRadicalLel",f:qN},25:{n:"PtgList",f:r3},29:{n:"PtgSxName",f:n3},255:{}},f3={0:{n:"PtgAttrNoop",f:l3},1:{n:"PtgAttrSemi",f:gN},2:{n:"PtgAttrIf",f:mN},4:{n:"PtgAttrChoose",f:pN},8:{n:"PtgAttrGoto",f:hN},16:{n:"PtgAttrSum",f:TN},32:{n:"PtgAttrBaxcel",f:Qx},33:{n:"PtgAttrBaxcel",f:Qx},64:{n:"PtgAttrSpace",f:vN},65:{n:"PtgAttrSpaceSemi",f:yN},128:{n:"PtgAttrIfError",f:xN},255:{}};function Xl(e,r,t,n){if(n.biff<8)return Cr(e,r);for(var a=e.l+r,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=RN(e,0,n),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=MN(e,t[o][1],n),s.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=e.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return r=a-e.l,r!==0&&s.push(Cr(e,r)),s}function Ql(e,r,t){for(var n=e.l+r,a,s,o=[];n!=e.l;)r=n-e.l,s=e[e.l],a=qx[s]||qx[c3[s]],(s===24||s===25)&&(a=(s===24?u3:f3)[e[e.l+1]]),!a||!a.f?Cr(e,r):o.push([a.n,a.f(e,r,t)]);return o}function d3(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var p3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function h3(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Gw(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Zx(e,r,t){var n=Gw(e,r,t);return n=="#REF"?n:h3(n,t)}function kr(e,r,t,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},i=[],l,c,u,d=0,p=0,h,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,y="",g=0,w=e[0].length;g<w;++g){var v=e[0][g];switch(v[0]){case"PtgUminus":i.push("-"+i.pop());break;case"PtgUplus":i.push("+"+i.pop());break;case"PtgPercent":i.push(i.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=i.pop(),c=i.pop(),m>=0){switch(e[0][m][1][0]){case 0:y=Lt(" ",e[0][m][1][1]);break;case 1:y=Lt("\r",e[0][m][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+y,m=-1}i.push(c+p3[v[0]]+l);break;case"PtgIsect":l=i.pop(),c=i.pop(),i.push(c+" "+l);break;case"PtgUnion":l=i.pop(),c=i.pop(),i.push(c+","+l);break;case"PtgRange":l=i.pop(),c=i.pop(),i.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=el(v[1][1],o,a),i.push(tl(u,s));break;case"PtgRefN":u=t?el(v[1][1],t,a):v[1][1],i.push(tl(u,s));break;case"PtgRef3d":d=v[1][1],u=el(v[1][2],o,a),x=Zx(n,d,a),i.push(x+"!"+tl(u,s));break;case"PtgFunc":case"PtgFuncVar":var b=v[1][0],M=v[1][1];b||(b=0),b&=127;var C=b==0?[]:i.slice(-b);i.length-=b,M==="User"&&(M=C.shift()),i.push(M+"("+C.join(",")+")");break;case"PtgBool":i.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":i.push(v[1]);break;case"PtgNum":i.push(String(v[1]));break;case"PtgStr":i.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":i.push(v[1]);break;case"PtgAreaN":h=Ox(v[1][1],t?{s:t}:o,a),i.push(ff(h,a));break;case"PtgArea":h=Ox(v[1][1],o,a),i.push(ff(h,a));break;case"PtgArea3d":d=v[1][1],h=v[1][2],x=Zx(n,d,a),i.push(x+"!"+ff(h,a));break;case"PtgAttrSum":i.push("SUM("+i.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=v[1][2];var k=(n.names||[])[p-1]||(n[0]||[])[p],F=k?k.Name:"SH33TJSNAME"+String(p);F&&F.slice(0,6)=="_xlfn."&&!a.xlfn&&(F=F.slice(6)),i.push(F);break;case"PtgNameX":var E=v[1][1];p=v[1][2];var j;if(a.biff<=5)E<0&&(E=-E),n[E]&&(j=n[E][p]);else{var V="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][p]&&n[E][p].itab>0&&(V=n.SheetNames[n[E][p].itab-1]+"!"):V=n.SheetNames[p-1]+"!"),n[E]&&n[E][p])V+=n[E][p].Name;else if(n[0]&&n[0][p])V+=n[0][p].Name;else{var W=(Gw(n,E,a)||"").split(";;");W[p-1]?V=W[p-1]:V+="SH33TJSERRX"}i.push(V);break}j||(j={Name:"SH33TJSERRY"}),i.push(j.Name);break;case"PtgParen":var te="(",ee=")";if(m>=0){switch(y="",e[0][m][1][0]){case 2:te=Lt(" ",e[0][m][1][1])+te;break;case 3:te=Lt("\r",e[0][m][1][1])+te;break;case 4:ee=Lt(" ",e[0][m][1][1])+ee;break;case 5:ee=Lt("\r",e[0][m][1][1])+ee;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}i.push(te+i.pop()+ee);break;case"PtgRefErr":i.push("#REF!");break;case"PtgRefErr3d":i.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var J={c:t.c,r:t.r};if(n.sharedf[Ke(u)]){var ne=n.sharedf[Ke(u)];i.push(kr(ne,o,J,n,a))}else{var B=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){i.push(kr(c[1],o,J,n,a)),B=!0;break}B||i.push(v[1])}break;case"PtgArray":i.push("{"+d3(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":i.push("");break;case"PtgAreaErr":i.push("#REF!");break;case"PtgAreaErr3d":i.push("#REF!");break;case"PtgList":i.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&q.indexOf(e[0][g][0])==-1){v=e[0][m];var N=!0;switch(v[1][0]){case 4:N=!1;case 0:y=Lt(" ",v[1][1]);break;case 5:N=!1;case 1:y=Lt("\r",v[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}i.push((N?y:"")+i.pop()+(N?"":y)),m=-1}}if(i.length>1&&a.WTF)throw new Error("bad formula stack");return i[0]}function m3(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Cr(e,r-2)];var i=Ql(e,o,t);return r!==o+a&&(s=Xl(e,r-o-a,i,t)),e.l=n,[i,s]}function x3(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Cr(e,r-2)];var i=Ql(e,o,t);return r!==o+a&&(s=Xl(e,r-o-a,i,t)),e.l=n,[i,s]}function g3(e,r,t,n){var a=e.l+r,s=Ql(e,n,t),o;return a!==e.l&&(o=Xl(e,a-e.l,s,t)),[s,o]}function v3(e,r,t){var n=e.l+r,a,s=e.read_shift(2),o=Ql(e,s,t);return s==65535?[[],Cr(e,r-2)]:(r!==s+2&&(a=Xl(e,n-s-2,o,t)),[o,a])}function y3(e){var r;if(ya(e,e.l+6)!==65535)return[br(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function hf(e,r,t){var n=e.l+r,a=la(e);t.biff==2&&++e.l;var s=y3(e),o=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var i=x3(e,n-e.l,t);return{cell:a,val:s[0],formula:i,shared:o>>3&1,tt:s[1]}}function E0(e,r,t){var n=e.read_shift(4),a=Ql(e,n,t),s=e.read_shift(4),o=s>0?Xl(e,s,a,t):null;return[a,o]}var w3=E0,S0=E0,k3=E0,_3=E0,b3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Xw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},E3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Jx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function mf(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var sl={},Wo={};function ol(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Qw(e,r,t,n,a,s){try{n.cellNF&&(e.z=Ge[r])}catch(i){if(n.WTF)throw i}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=sr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ge[r]==null&&js(SS[r]||"General",r),e.t==="e")e.w=e.w||lo[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v);else if(e.t==="d"){var o=Br(e.v);(o|0)===o?e.w=o.toString(10):e.w=Dl(o)}else{if(e.v===void 0)return"";e.w=Xs(e.v,Wo)}else e.t==="d"?e.w=wn(r,Br(e.v),Wo):e.w=wn(r,e.v,Wo)}catch(i){if(n.WTF)throw i}if(n.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ju(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ju(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(i){if(n.WTF&&s.Fills)throw i}}}function S3(e,r){var t=zt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=nt(t))}var T3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,C3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,D3=/<(?:\w:)?hyperlink [^>]*>/mg,N3=/"(\w*:\w*)"/,F3=/<(?:\w:)?col\b[^>]*[\/]?>/g,A3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,O3=/<(?:\w:)?pageMargins[^>]*\/>/g,qw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,P3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,M3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function R3(e,r,t,n,a,s,o){if(!e)return e;n||(n={"!id":{}});var i=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(C3);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var p=c.match(qw);p?bh(p[0],i,a,t):(p=c.match(P3))&&I3(p[0],p[1]||"",i,a,t);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var x=c.slice(h,h+50).match(N3);x&&S3(i,x[1])}var m=c.match(M3);m&&m[1]&&U3(m[1],a);var y=[];if(r.cellStyles){var g=c.match(F3);g&&z3(y,g)}d&&$3(d[1],i,r,l,s,o);var w=u.match(A3);w&&(i["!autofilter"]=B3(w[0]));var v=[],b=u.match(T3);if(b)for(h=0;h!=b.length;++h)v[h]=zt(b[h].slice(b[h].indexOf('"')+1));var M=u.match(D3);M&&j3(i,M,n);var C=u.match(O3);if(C&&(i["!margins"]=L3(He(C[0]))),!i["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(i["!ref"]=nt(l)),r.sheetRows>0&&i["!ref"]){var k=zt(i["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),i["!fullref"]=i["!ref"],i["!ref"]=nt(k))}return y.length>0&&(i["!cols"]=y),v.length>0&&(i["!merges"]=v),i}function bh(e,r,t,n){var a=He(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=lt(Et(a.codeName)))}function I3(e,r,t,n,a){bh(e.slice(0,e.indexOf(">")),t,n,a)}function j3(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var s=He(Et(r[a]),!0);if(!s.ref)return;var o=((t||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+lt(s.location))):(s.Target="#"+lt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var i=zt(s.ref),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c){var u=Ke({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function L3(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function z3(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=He(r[n],!0);a.hidden&&(a.hidden=Ft(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,kh(a.width)),ti(a);s<=o;)e[s++]=dr(a)}}function B3(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var W3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function U3(e,r){r.Views||(r.Views=[{}]),(e.match(W3)||[]).forEach(function(t,n){var a=He(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Ft(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var $3=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Nl("v"),o=Nl("f");return function(l,c,u,d,p,h){for(var x=0,m="",y=[],g=[],w=0,v=0,b=0,M="",C,k,F=0,E=0,j,V,W=0,te=0,ee=Array.isArray(h.CellXf),J,ne=[],B=[],q=Array.isArray(c),N=[],U={},Z=!1,_=!!u.sheetStubs,P=l.split(r),A=0,z=P.length;A!=z;++A){m=P[A].trim();var Q=m.length;if(Q!==0){var re=0;e:for(x=0;x<Q;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(k=He(m.slice(re,x),!0),F=k.r!=null?parseInt(k.r,10):F+1,E=-1,u.sheetRows&&u.sheetRows<F)continue;U={},Z=!1,k.ht&&(Z=!0,U.hpt=parseFloat(k.ht),U.hpx=Pl(U.hpt)),k.hidden=="1"&&(Z=!0,U.hidden=!0),k.outlineLevel!=null&&(Z=!0,U.level=+k.outlineLevel),Z&&(N[F-1]=U)}break;case"<":re=x;break}if(re>=x)break;if(k=He(m.slice(re,x),!0),F=k.r!=null?parseInt(k.r,10):F+1,E=-1,!(u.sheetRows&&u.sheetRows<F)){d.s.r>F-1&&(d.s.r=F-1),d.e.r<F-1&&(d.e.r=F-1),u&&u.cellStyles&&(U={},Z=!1,k.ht&&(Z=!0,U.hpt=parseFloat(k.ht),U.hpx=Pl(U.hpt)),k.hidden=="1"&&(Z=!0,U.hidden=!0),k.outlineLevel!=null&&(Z=!0,U.level=+k.outlineLevel),Z&&(N[F-1]=U)),y=m.slice(x).split(e);for(var oe=0;oe!=y.length&&y[oe].trim().charAt(0)=="<";++oe);for(y=y.slice(oe),x=0;x!=y.length;++x)if(m=y[x].trim(),m.length!==0){if(g=m.match(t),w=x,v=0,b=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,g!=null&&g.length===2){for(w=0,M=g[1],v=0;v!=M.length&&!((b=M.charCodeAt(v)-64)<1||b>26);++v)w=26*w+b;--w,E=w}else++E;for(v=0;v!=m.length&&m.charCodeAt(v)!==62;++v);if(++v,k=He(m.slice(0,v),!0),k.r||(k.r=Ke({r:F-1,c:E})),M=m.slice(v),C={t:""},(g=M.match(s))!=null&&g[1]!==""&&(C.v=lt(g[1])),u.cellFormula){if((g=M.match(o))!=null&&g[1]!==""){if(C.f=lt(Et(g[1])).replace(/\r\n/g,`
`),u.xlfn||(C.f=Xx(C.f)),g[0].indexOf('t="array"')>-1)C.F=(M.match(a)||[])[1],C.F.indexOf(":")>-1&&ne.push([zt(C.F),C.F]);else if(g[0].indexOf('t="shared"')>-1){V=He(g[0]);var X=lt(Et(g[1]));u.xlfn||(X=Xx(X)),B[parseInt(V.si,10)]=[V,X,k.r]}}else(g=M.match(/<f[^>]*\/>/))&&(V=He(g[0]),B[V.si]&&(C.f=eN(B[V.si][1],B[V.si][2],k.r)));var Y=Rr(k.r);for(v=0;v<ne.length;++v)Y.r>=ne[v][0].s.r&&Y.r<=ne[v][0].e.r&&Y.c>=ne[v][0].s.c&&Y.c<=ne[v][0].e.c&&(C.F=ne[v][1])}if(k.t==null&&C.v===void 0)if(C.f||C.F)C.v=0,C.t="n";else if(_)C.t="z";else continue;else C.t=k.t||"n";switch(d.s.c>E&&(d.s.c=E),d.e.c<E&&(d.e.c=E),C.t){case"n":if(C.v==""||C.v==null){if(!_)continue;C.t="z"}else C.v=parseFloat(C.v);break;case"s":if(typeof C.v>"u"){if(!_)continue;C.t="z"}else j=sl[parseInt(C.v,10)],C.v=j.t,C.r=j.r,u.cellHTML&&(C.h=j.h);break;case"str":C.t="s",C.v=C.v!=null?Et(C.v):"",u.cellHTML&&(C.h=uh(C.v));break;case"inlineStr":g=M.match(n),C.t="s",g!=null&&(j=wh(g[1]))?(C.v=j.t,u.cellHTML&&(C.h=j.h)):C.v="";break;case"b":C.v=Ft(C.v);break;case"d":u.cellDates?C.v=sr(C.v,1):(C.v=Br(sr(C.v,1)),C.t="n");break;case"e":(!u||u.cellText!==!1)&&(C.w=C.v),C.v=vw[C.v];break}if(W=te=0,J=null,ee&&k.s!==void 0&&(J=h.CellXf[k.s],J!=null&&(J.numFmtId!=null&&(W=J.numFmtId),u.cellStyles&&J.fillId!=null&&(te=J.fillId))),Qw(C,W,te,u,p,h),u.cellDates&&ee&&C.t=="n"&&pi(Ge[W])&&(C.t="d",C.v=_0(C.v)),k.cm&&u.xlmeta){var K=(u.xlmeta.Cell||[])[+k.cm-1];K&&K.type=="XLDAPR"&&(C.D=!0)}if(q){var D=Rr(k.r);c[D.r]||(c[D.r]=[]),c[D.r][D.c]=C}else c[k.r]=C}}}}N.length>0&&(c["!rows"]=N)}}();function H3(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}var Y3=io;function V3(){}function K3(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=mT(e),t}function G3(e){var r=_n(e);return[r]}function X3(e){var r=oo(e);return[r]}function Q3(e){var r=_n(e),t=e.read_shift(1);return[r,t,"b"]}function q3(e){var r=oo(e),t=e.read_shift(1);return[r,t,"b"]}function Z3(e){var r=_n(e),t=e.read_shift(1);return[r,t,"e"]}function J3(e){var r=oo(e),t=e.read_shift(1);return[r,t,"e"]}function eF(e){var r=_n(e),t=e.read_shift(4);return[r,t,"s"]}function tF(e){var r=oo(e),t=e.read_shift(4);return[r,t,"s"]}function rF(e){var r=_n(e),t=br(e);return[r,t,"n"]}function Zw(e){var r=oo(e),t=br(e);return[r,t,"n"]}function nF(e){var r=_n(e),t=gh(e);return[r,t,"n"]}function aF(e){var r=oo(e),t=gh(e);return[r,t,"n"]}function sF(e){var r=_n(e),t=mh(e);return[r,t,"is"]}function oF(e){var r=_n(e),t=Sr(e);return[r,t,"str"]}function iF(e){var r=oo(e),t=Sr(e);return[r,t,"str"]}function lF(e,r,t){var n=e.l+r,a=_n(e);a.r=t["!row"];var s=e.read_shift(1),o=[a,s,"b"];if(t.cellFormula){e.l+=2;var i=S0(e,n-e.l,t);o[3]=kr(i,null,a,t.supbooks,t)}else e.l=n;return o}function cF(e,r,t){var n=e.l+r,a=_n(e);a.r=t["!row"];var s=e.read_shift(1),o=[a,s,"e"];if(t.cellFormula){e.l+=2;var i=S0(e,n-e.l,t);o[3]=kr(i,null,a,t.supbooks,t)}else e.l=n;return o}function uF(e,r,t){var n=e.l+r,a=_n(e);a.r=t["!row"];var s=br(e),o=[a,s,"n"];if(t.cellFormula){e.l+=2;var i=S0(e,n-e.l,t);o[3]=kr(i,null,a,t.supbooks,t)}else e.l=n;return o}function fF(e,r,t){var n=e.l+r,a=_n(e);a.r=t["!row"];var s=Sr(e),o=[a,s,"str"];if(t.cellFormula){e.l+=2;var i=S0(e,n-e.l,t);o[3]=kr(i,null,a,t.supbooks,t)}else e.l=n;return o}var dF=io;function pF(e,r){var t=e.l+r,n=io(e),a=xh(e),s=Sr(e),o=Sr(e),i=Sr(e);e.l=t;var l={rfx:n,relId:a,loc:s,display:i};return o&&(l.Tooltip=o),l}function hF(){}function mF(e,r,t){var n=e.l+r,a=mw(e),s=e.read_shift(1),o=[a];if(o[2]=s,t.cellFormula){var i=w3(e,n-e.l,t);o[1]=i}else e.l=n;return o}function xF(e,r,t){var n=e.l+r,a=io(e),s=[a];if(t.cellFormula){var o=_3(e,n-e.l,t);s[1]=o,e.l=n}else e.l=n;return s}var gF=["left","right","top","bottom","header","footer"];function vF(e){var r={};return gF.forEach(function(t){r[t]=br(e)}),r}function yF(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function wF(){}function kF(){}function _F(e,r,t,n,a,s,o){if(!e)return e;var i=r||{};n||(n={"!id":{}});var l=i.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,p=!1,h,x,m,y,g,w,v,b,M,C=[];i.biff=12,i["!row"]=0;var k=0,F=!1,E=[],j={},V=i.supbooks||a.supbooks||[[]];if(V.sharedf=j,V.arrayf=E,V.SheetNames=a.SheetNames||a.Sheets.map(function(q){return q.name}),!i.supbooks&&(i.supbooks=V,a.Names))for(var W=0;W<a.Names.length;++W)V[0][W+1]=a.Names[W];var te=[],ee=[],J=!1;Bu[16]={n:"BrtShortReal",f:Zw};var ne;if(Ra(e,function(N,U,Z){if(!p)switch(Z){case 148:c=N;break;case 0:h=N,i.sheetRows&&i.sheetRows<=h.r&&(p=!0),b=pr(y=h.r),i["!row"]=h.r,(N.hidden||N.hpt||N.level!=null)&&(N.hpt&&(N.hpx=Pl(N.hpt)),ee[N.r]=N);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:N[2]},N[2]){case"n":x.v=N[1];break;case"s":v=sl[N[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!N[1];break;case"e":x.v=N[1],i.cellText!==!1&&(x.w=lo[x.v]);break;case"str":x.t="s",x.v=N[1];break;case"is":x.t="s",x.v=N[1].t;break}if((m=o.CellXf[N[0].iStyleRef])&&Qw(x,m.numFmtId,null,i,s,o),g=N[0].c==-1?g+1:N[0].c,i.dense?(l[y]||(l[y]=[]),l[y][g]=x):l[Jt(g)+b]=x,i.cellFormula){for(F=!1,k=0;k<E.length;++k){var _=E[k];h.r>=_[0].s.r&&h.r<=_[0].e.r&&g>=_[0].s.c&&g<=_[0].e.c&&(x.F=nt(_[0]),F=!0)}!F&&N.length>3&&(x.f=N[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),i.cellDates&&m&&x.t=="n"&&pi(Ge[m.numFmtId])){var P=Fs(x.v);P&&(x.t="d",x.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 1:case 12:if(!i.sheetStubs||d)break;x={t:"z",v:void 0},g=N[0].c==-1?g+1:N[0].c,i.dense?(l[y]||(l[y]=[]),l[y][g]=x):l[Jt(g)+b]=x,u.s.r>h.r&&(u.s.r=h.r),u.s.c>g&&(u.s.c=g),u.e.r<h.r&&(u.e.r=h.r),u.e.c<g&&(u.e.c=g),ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 176:C.push(N);break;case 49:ne=((i.xlmeta||{}).Cell||[])[N-1];break;case 494:var A=n["!id"][N.relId];for(A?(N.Target=A.Target,N.loc&&(N.Target+="#"+N.loc),N.Rel=A):N.relId==""&&(N.Target="#"+N.loc),y=N.rfx.s.r;y<=N.rfx.e.r;++y)for(g=N.rfx.s.c;g<=N.rfx.e.c;++g)i.dense?(l[y]||(l[y]=[]),l[y][g]||(l[y][g]={t:"z",v:void 0}),l[y][g].l=N):(w=Ke({c:g,r:y}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=N);break;case 426:if(!i.cellFormula)break;E.push(N),M=i.dense?l[y][g]:l[Jt(g)+b],M.f=kr(N[1],u,{r:h.r,c:g},V,i),M.F=nt(N[0]);break;case 427:if(!i.cellFormula)break;j[Ke(N[0].s)]=N[1],M=i.dense?l[y][g]:l[Jt(g)+b],M.f=kr(N[1],u,{r:h.r,c:g},V,i);break;case 60:if(!i.cellStyles)break;for(;N.e>=N.s;)te[N.e--]={width:N.w/256,hidden:!!(N.flags&1),level:N.level},J||(J=!0,kh(N.w/256)),ti(te[N.e+1]);break;case 161:l["!autofilter"]={ref:nt(N)};break;case 476:l["!margins"]=N;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),N.name&&(a.Sheets[t].CodeName=N.name),(N.above||N.left)&&(l["!outline"]={above:N.above,left:N.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),N.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!U.T){if(!d||i.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},i),delete i.supbooks,delete i["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=nt(c||u)),i.sheetRows&&l["!ref"]){var B=zt(l["!ref"]);i.sheetRows<=+B.e.r&&(B.e.r=i.sheetRows-1,B.e.r>u.e.r&&(B.e.r=u.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>u.e.c&&(B.e.c=u.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),l["!fullref"]=l["!ref"],l["!ref"]=nt(B))}return C.length>0&&(l["!merges"]=C),te.length>0&&(l["!cols"]=te),ee.length>0&&(l["!rows"]=ee),l}function bF(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(r[+o[1]]=t?+o[2]:o[2])});var a=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[r,a,n]}function EF(e,r,t,n,a,s){var o=s||{"!type":"chart"};if(!e)return s;var i=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var p=bF(d);u.s.r=u.s.c=0,u.e.c=i,c=Jt(i),p[0].forEach(function(h,x){o[c+pr(x)]={t:"n",v:h,z:p[1]},l=x}),u.e.r<l&&(u.e.r=l),++i}),i>0&&(o["!ref"]=nt(u)),o}function SF(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,i=e.match(qw);return i&&bh(i[0],s,a,t),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function TF(e,r){e.l+=10;var t=Sr(e);return{name:t}}function CF(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ra(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),l.name&&(a.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},r),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Jw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],DF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],NF=[],FF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function eg(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var s=r[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ft(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function tg(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ft(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ek(e){tg(e.WBProps,Jw),tg(e.CalcPr,FF),eg(e.WBView,DF),eg(e.Sheets,NF),Wo.date1904=Ft(e.WBProps.date1904)}var AF="][*?/\\".split("");function OF(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return AF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var PF=/<\w+:workbook/;function MF(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(e.replace(Dr,function(l,c){var u=He(l);switch(ia(u[0])){case"<?xml":break;case"<workbook":l.match(PF)&&(a="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Jw.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":t.WBProps[d[0]]=Ft(u[d[0]]);break;case"int":t.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:t.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(t.WBProps.CodeName=Et(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=lt(Et(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Et(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Ft(u.hidden||"0")&&(s.Hidden=!0),o=c+l.length;break;case"</definedName>":s.Ref=lt(Et(e.slice(o,c))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),ZS.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return ek(t),t}function RF(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Pd(e),t.name=Sr(e),t}function IF(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?Sr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function jF(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function LF(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),s=xT(e),o=k3(e,0,t),i=xh(e);e.l=n;var l={Name:s,Ptg:o};return a<268435455&&(l.Sheet=a),i&&(l.Comment=i),l}function zF(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Bu[16]={n:"BrtFRTArchID$",f:jF},Ra(e,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(r.SID=l.Sheet),l.Ref=kr(l.Ptg,null,null,o,r),delete r.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),ek(t),t.Names=s,t.supbooks=o,t}function BF(e,r,t){return r.slice(-4)===".bin"?zF(e,t):MF(e,t)}function WF(e,r,t,n,a,s,o,i){return r.slice(-4)===".bin"?_F(e,n,t,a,s,o,i):R3(e,n,t,a,s,o,i)}function UF(e,r,t,n,a,s,o,i){return r.slice(-4)===".bin"?CF(e,n,t,a,s):SF(e,n,t,a,s)}function $F(e,r,t,n,a,s,o,i){return r.slice(-4)===".bin"?q4():Z4()}function HF(e,r,t,n,a,s,o,i){return r.slice(-4)===".bin"?X4():Q4()}function YF(e,r,t,n){return r.slice(-4)===".bin"?d4(e,t,n):o4(e,t,n)}function VF(e,r,t){return Bw(e,t)}function KF(e,r,t){return r.slice(-4)===".bin"?DD(e,t):TD(e,t)}function GF(e,r,t){return r.slice(-4)===".bin"?V4(e,t):W4(e,t)}function XF(e,r,t){return r.slice(-4)===".bin"?L4(e):I4(e)}function QF(e,r,t,n){return t.slice(-4)===".bin"?z4(e,r,t,n):void 0}function qF(e,r,t){return r.slice(-4)===".bin"?M4(e,r,t):R4(e,r,t)}var tk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,rk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function En(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(tk),s,o,i,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(rk),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(o+1),n[i]=s[2].slice(1,s[2].length-1));return n}function ZF(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(tk),a,s,o,i;if(n)for(i=0;i!=n.length;++i)a=n[i].match(rk),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),t[o]=a[2].slice(1,a[2].length-1));return t}var il;function JF(e,r){var t=il[e]||lt(e);return t==="General"?Xs(r):wn(t,r)}function eA(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ft(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=sr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[lt(r)]=a}function tA(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||lo[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v):e.w=Xs(e.v):e.w=JF(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var n=il[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&pi(n)){var a=Fs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function rA(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=e4[n.Pattern]||n.Pattern)}e[r.ID]=r}function nA(e,r,t,n,a,s,o,i,l,c){var u="General",d=n.StyleID,p={};c=c||{};var h=[],x=0;for(d===void 0&&i&&(d=i.StyleID),d===void 0&&o&&(d=o.StyleID);s[d]!==void 0&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&h.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Ft(e);break;case"String":n.t="s",n.r=bx(lt(e)),n.v=e.indexOf("<")>-1?lt(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(sr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=vw[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=bx(r||e));break}if(tA(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=lt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Bo(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Bo("RC:RC",a):n.ArrayRange&&(n.F=Bo(n.ArrayRange,a),l.push([zt(n.F),n.F]))}else for(x=0;x<l.length;++x)a.r>=l[x][0].s.r&&a.r<=l[x][0].e.r&&a.c>=l[x][0].s.c&&a.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(h.forEach(function(y){!p.patternType&&y.patternType&&(p.patternType=y.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function aA(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function xf(e,r){var t=r||{};Hy();var n=Ii(fh(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Et(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=dr(t);return o.type="string",Al.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($e){a.indexOf("<"+$e)>=0&&(s=!0)}),s)return pA(n,t);il={"General Number":"General","General Date":Ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ge[15],"Short Date":Ge[14],"Long Time":Ge[19],"Medium Time":Ge[18],"Short Time":Ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ge[2],Standard:Ge[4],Percent:Ge[10],Scientific:Ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var i,l=[],c,u={},d=[],p=t.dense?[]:{},h="",x={},m={},y=En('<Data ss:Type="String">'),g=0,w=0,v=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},C={},k="",F=0,E=[],j={},V={},W=0,te=[],ee=[],J={},ne=[],B,q=!1,N=[],U=[],Z={},_=0,P=0,A={Sheets:[],WBProps:{date1904:!1}},z={};Fl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";i=Fl.exec(n);)switch(i[3]=(Q=i[3]).toLowerCase()){case"data":if(Q=="data"){if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"))}else i[0].charAt(i[0].length-2)!=="/"&&l.push([i[3],!0]);break}if(l[l.length-1][1])break;i[1]==="/"?nA(n.slice(g,i.index),k,y,l[l.length-1][0]=="comment"?J:x,{c:w,r:v},M,ne[w],m,N,t):(k="",y=En(i[0]),g=i.index+i[0].length);break;case"cell":if(i[1]==="/")if(ee.length>0&&(x.c=ee),(!t.sheetRows||t.sheetRows>v)&&x.v!==void 0&&(t.dense?(p[v]||(p[v]=[]),p[v][w]=x):p[Jt(w)+pr(v)]=x),x.HRef&&(x.l={Target:lt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(_=w+(parseInt(x.MergeAcross,10)|0),P=v+(parseInt(x.MergeDown,10)|0),E.push({s:{c:w,r:v},e:{c:_,r:P}})),!t.sheetStubs)x.MergeAcross?w=_+1:++w;else if(x.MergeAcross||x.MergeDown){for(var re=w;re<=_;++re)for(var oe=v;oe<=P;++oe)(re>w||oe>v)&&(t.dense?(p[oe]||(p[oe]=[]),p[oe][re]={t:"z"}):p[Jt(re)+pr(oe)]={t:"z"});w=_+1}else++w;else x=ZF(i[0]),x.Index&&(w=+x.Index-1),w<b.s.c&&(b.s.c=w),w>b.e.c&&(b.e.c=w),i[0].slice(-2)==="/>"&&++w,ee=[];break;case"row":i[1]==="/"||i[0].slice(-2)==="/>"?(v<b.s.r&&(b.s.r=v),v>b.e.r&&(b.e.r=v),i[0].slice(-2)==="/>"&&(m=En(i[0]),m.Index&&(v=+m.Index-1)),w=0,++v):(m=En(i[0]),m.Index&&(v=+m.Index-1),Z={},(m.AutoFitHeight=="0"||m.Height)&&(Z.hpx=parseInt(m.Height,10),Z.hpt=zw(Z.hpx),U[v]=Z),m.Hidden=="1"&&(Z.hidden=!0,U[v]=Z));break;case"worksheet":if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"));d.push(h),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(p["!ref"]=nt(b),t.sheetRows&&t.sheetRows<=b.e.r&&(p["!fullref"]=p["!ref"],b.e.r=t.sheetRows-1,p["!ref"]=nt(b))),E.length&&(p["!merges"]=E),ne.length>0&&(p["!cols"]=ne),U.length>0&&(p["!rows"]=U),u[h]=p}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,l.push([i[3],!1]),c=En(i[0]),h=lt(c.Name),p=t.dense?[]:{},E=[],N=[],U=[],z={name:h,Hidden:0},A.Sheets.push(z);break;case"table":if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"))}else{if(i[0].slice(-2)=="/>")break;l.push([i[3],!1]),ne=[],q=!1}break;case"style":i[1]==="/"?rA(M,C,t):C=En(i[0]);break;case"numberformat":C.nf=lt(En(i[0]).Format||"General"),il[C.nf]&&(C.nf=il[C.nf]);for(var X=0;X!=392&&Ge[X]!=C.nf;++X);if(X==392){for(X=57;X!=392;++X)if(Ge[X]==null){js(C.nf,X);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(B=En(i[0]),B.Hidden&&(B.hidden=!0,delete B.Hidden),B.Width&&(B.wpx=parseInt(B.Width,10)),!q&&B.wpx>10){q=!0,Pr=jw;for(var Y=0;Y<ne.length;++Y)ne[Y]&&ti(ne[Y])}q&&ti(B),ne[B.Index-1||ne.length]=B;for(var K=0;K<+B.Span;++K)ne[ne.length]=dr(B);break;case"namedrange":if(i[1]==="/")break;A.Names||(A.Names=[]);var D=He(i[0]),we={Name:D.Name,Ref:Bo(D.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(we.Sheet=A.Sheets.length-1),A.Names.push(we);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(i[0].slice(-2)==="/>")break;i[1]==="/"?k+=n.slice(F,i.index):F=i.index+i[0].length;break;case"interior":if(!t.cellStyles)break;C.Interior=En(i[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(i[0].slice(-2)==="/>")break;i[1]==="/"?WT(j,Q,n.slice(W,i.index)):W=i.index+i[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"))}else l.push([i[3],!1]);break;case"comment":if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"));aA(J),ee.push(J)}else l.push([i[3],!1]),c=En(i[0]),J={a:c.Author};break;case"autofilter":if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"))}else if(i[0].charAt(i[0].length-2)!=="/"){var pe=En(i[0]);p["!autofilter"]={ref:Bo(pe.Range).replace(/\$/g,"")},l.push([i[3],!0])}break;case"name":break;case"datavalidation":if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"))}else i[0].charAt(i[0].length-2)!=="/"&&l.push([i[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(i[1]==="/"){if((c=l.pop())[0]!==i[3])throw new Error("Bad state: "+c.join("|"))}else i[0].charAt(i[0].length-2)!=="/"&&l.push([i[3],!0]);break;case"null":break;default:if(l.length==0&&i[3]=="document"||l.length==0&&i[3]=="uof")return ig(n,t);var me=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(i[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:me=!1}break;case"componentoptions":switch(i[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:me=!1}break;case"excelworkbook":switch(i[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:me=!1}break;case"workbookoptions":switch(i[3]){case"owcversion":break;case"height":break;case"width":break;default:me=!1}break;case"worksheetoptions":switch(i[3]){case"visible":if(i[0].slice(-2)!=="/>")if(i[1]==="/")switch(n.slice(W,i.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else W=i.index+i[0].length;break;case"header":p["!margins"]||ol(p["!margins"]={},"xlml"),isNaN(+He(i[0]).Margin)||(p["!margins"].header=+He(i[0]).Margin);break;case"footer":p["!margins"]||ol(p["!margins"]={},"xlml"),isNaN(+He(i[0]).Margin)||(p["!margins"].footer=+He(i[0]).Margin);break;case"pagemargins":var _e=He(i[0]);p["!margins"]||ol(p["!margins"]={},"xlml"),isNaN(+_e.Top)||(p["!margins"].top=+_e.Top),isNaN(+_e.Left)||(p["!margins"].left=+_e.Left),isNaN(+_e.Right)||(p["!margins"].right=+_e.Right),isNaN(+_e.Bottom)||(p["!margins"].bottom=+_e.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:me=!1}break;case"pivottable":case"pivotcache":switch(i[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:me=!1}break;case"pagebreaks":switch(i[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:me=!1}break;case"autofilter":switch(i[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:me=!1}break;case"querytable":switch(i[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:me=!1}break;case"datavalidation":switch(i[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:me=!1}break;case"sorting":case"conditionalformatting":switch(i[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:me=!1}break;case"mapinfo":case"schema":case"data":switch(i[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:me=!1}break;case"smarttags":break;default:me=!1;break}if(me||i[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(i[0].slice(-2)==="/>")break;i[1]==="/"?eA(V,Q,te,n.slice(W,i.index)):(te=i,W=i.index+i[0].length);break}if(t.WTF)throw"Unrecognized tag: "+i[3]+"|"+l.join("|")}var xe={};return!t.bookSheets&&!t.bookProps&&(xe.Sheets=u),xe.SheetNames=d,xe.Workbook=A,xe.SSF=dr(Ge),xe.Props=j,xe.Custprops=V,xe}function jd(e,r){switch(Th(r=r||{}),r.type||"base64"){case"base64":return xf(rn(e),r);case"binary":case"buffer":case"file":return xf(e,r);case"array":return xf(so(e),r)}}function sA(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=yT(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=wT(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var oA=[60,1084,2066,2165,2175];function iA(e,r,t,n,a){var s=n,o=[],i=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&i.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(i)}o.push(i),t.l+=s;for(var l=ya(t,t.l),c=Ld[l],u=0;c!=null&&oA.indexOf(l)>-1;)s=ya(t,t.l+2),u=t.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),i=t.slice(u,t.l+4+s),o.push(i),t.l+=4+s,c=Ld[l=ya(t,t.l)];var d=Ha(o);cr(d,0);var p=0;d.lens=[];for(var h=0;h<o.length;++h)d.lens.push(p),p+=o[h].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return r.f(d,d.length,a)}function Yn(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=Ge[n])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||lo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Dl(e.v):e.w=Xs(e.v):e.w=wn(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&n&&e.t=="n"&&pi(Ge[n]||String(n))){var a=Fs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Nc(e,r,t){return{v:e,ixfe:r,t}}function lA(e,r){var t={opts:{}},n={},a=r.dense?[]:{},s={},o={},i=null,l=[],c="",u={},d,p="",h,x,m,y,g={},w=[],v,b,M=[],C=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},E=function(Pe){return Pe<8?Ls[Pe]:Pe<64&&C[Pe-8]||Ls[Pe]},j=function(Pe,qe,wt){var We=qe.XF.data;if(!(!We||!We.patternType||!wt||!wt.cellStyles)){qe.s={},qe.s.patternType=We.patternType;var Je;(Je=Ol(E(We.icvFore)))&&(qe.s.fgColor={rgb:Je}),(Je=Ol(E(We.icvBack)))&&(qe.s.bgColor={rgb:Je})}},V=function(Pe,qe,wt){if(!(Z>1)&&!(wt.sheetRows&&Pe.r>=wt.sheetRows)){if(wt.cellStyles&&qe.XF&&qe.XF.data&&j(Pe,qe,wt),delete qe.ixfe,delete qe.XF,d=Pe,p=Ke(Pe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Pe.r<o.s.r&&(o.s.r=Pe.r),Pe.c<o.s.c&&(o.s.c=Pe.c),Pe.r+1>o.e.r&&(o.e.r=Pe.r+1),Pe.c+1>o.e.c&&(o.e.c=Pe.c+1),wt.cellFormula&&qe.f){for(var We=0;We<w.length;++We)if(!(w[We][0].s.c>Pe.c||w[We][0].s.r>Pe.r)&&!(w[We][0].e.c<Pe.c||w[We][0].e.r<Pe.r)){qe.F=nt(w[We][0]),(w[We][0].s.c!=Pe.c||w[We][0].s.r!=Pe.r)&&delete qe.f,qe.f&&(qe.f=""+kr(w[We][1],o,Pe,N,W));break}}wt.dense?(a[Pe.r]||(a[Pe.r]=[]),a[Pe.r][Pe.c]=qe):a[p]=qe}},W={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(W.password=r.password);var te,ee=[],J=[],ne=[],B=[],q=!1,N=[];N.SheetNames=W.snames,N.sharedf=W.sharedf,N.arrayf=W.arrayf,N.names=[],N.XTI=[];var U=0,Z=0,_=0,P=[],A=[],z;W.codepage=1200,An(1200);for(var Q=!1;e.l<e.length-1;){var re=e.l,oe=e.read_shift(2);if(oe===0&&U===10)break;var X=e.l===e.length?0:e.read_shift(2),Y=Ld[oe];if(Y&&Y.f){if(r.bookSheets&&U===133&&oe!==133)break;if(U=oe,Y.r===2||Y.r==12){var K=e.read_shift(2);if(X-=2,!W.enc&&K!==oe&&((K&255)<<8|K>>8)!==oe)throw new Error("rt mismatch: "+K+"!="+oe);Y.r==12&&(e.l+=10,X-=10)}var D={};if(oe===10?D=Y.f(e,X,W):D=iA(oe,Y,e,X,W),Z==0&&[9,521,1033,2057].indexOf(U)===-1)continue;switch(oe){case 34:t.opts.Date1904=k.WBProps.date1904=D;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(W.enc||(e.l=0),W.enc=D,!r.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=D;break;case 66:var we=Number(D);switch(we){case 21010:we=1200;break;case 32768:we=1e4;break;case 32769:we=1252;break}An(W.codepage=we),Q=!0;break;case 317:W.rrtabid=D;break;case 25:W.winlocked=D;break;case 439:t.opts.RefreshAll=D;break;case 12:t.opts.CalcCount=D;break;case 16:t.opts.CalcDelta=D;break;case 17:t.opts.CalcIter=D;break;case 13:t.opts.CalcMode=D;break;case 14:t.opts.CalcPrecision=D;break;case 95:t.opts.CalcSaveRecalc=D;break;case 15:W.CalcRefMode=D;break;case 2211:t.opts.FullCalc=D;break;case 129:D.fDialog&&(a["!type"]="dialog"),D.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),D.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:M.push(D);break;case 430:N.push([D]),N[N.length-1].XTI=[];break;case 35:case 547:N[N.length-1].push(D);break;case 24:case 536:z={Name:D.Name,Ref:kr(D.rgce,o,null,N,W)},D.itab>0&&(z.Sheet=D.itab-1),N.names.push(z),N[0]||(N[0]=[],N[0].XTI=[]),N[N.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(A[D.itab-1]={ref:nt(D.rgce[0][0][1][2])});break;case 22:W.ExternCount=D;break;case 23:N.length==0&&(N[0]=[],N[0].XTI=[]),N[N.length-1].XTI=N[N.length-1].XTI.concat(D),N.XTI=N.XTI.concat(D);break;case 2196:if(W.biff<8)break;z!=null&&(z.Comment=D[1]);break;case 18:a["!protect"]=D;break;case 19:D!==0&&W.WTF&&console.error("Password verifier: "+D);break;case 133:s[D.pos]=D,W.snames.push(D.name);break;case 10:{if(--Z)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=nt(o),r.sheetRows&&r.sheetRows<=o.e.r){var pe=o.e.r;o.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=nt(o),o.e.r=pe}o.e.r++,o.e.c++}ee.length>0&&(a["!merges"]=ee),J.length>0&&(a["!objects"]=J),ne.length>0&&(a["!cols"]=ne),B.length>0&&(a["!rows"]=B),k.Sheets.push(F)}c===""?u=a:n[c]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[oe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),W.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(W.biff=5,Q=!0,An(W.codepage=28591)),W.biff==8&&D.BIFFVer==0&&D.dt==16&&(W.biff=2),Z++)break;if(a=r.dense?[]:{},W.biff<8&&!Q&&(Q=!0,An(W.codepage=r.codepage||1252)),W.biff<5||D.BIFFVer==0&&D.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var me={pos:e.l-X,name:c};s[me.pos]=me,W.snames.push(c)}else c=(s[re]||{name:""}).name;D.dt==32&&(a["!type"]="chart"),D.dt==64&&(a["!type"]="macro"),ee=[],J=[],W.arrayf=w=[],ne=[],B=[],q=!1,F={Hidden:(s[re]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[D.r]||[])[D.c]:a[Ke({c:D.c,r:D.r})])&&++D.c,v={ixfe:D.ixfe,XF:M[D.ixfe]||{},v:D.val,t:"n"},_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:D.c,r:D.r},v,r);break;case 5:case 517:v={ixfe:D.ixfe,XF:M[D.ixfe],v:D.val,t:D.t},_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:D.c,r:D.r},v,r);break;case 638:v={ixfe:D.ixfe,XF:M[D.ixfe],v:D.rknum,t:"n"},_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:D.c,r:D.r},v,r);break;case 189:for(var _e=D.c;_e<=D.C;++_e){var xe=D.rkrec[_e-D.c][0];v={ixfe:xe,XF:M[xe],v:D.rkrec[_e-D.c][1],t:"n"},_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:_e,r:D.r},v,r)}break;case 6:case 518:case 1030:{if(D.val=="String"){i=D;break}if(v=Nc(D.val,D.cell.ixfe,D.tt),v.XF=M[v.ixfe],r.cellFormula){var $e=D.formula;if($e&&$e[0]&&$e[0][0]&&$e[0][0][0]=="PtgExp"){var G=$e[0][0][1][0],ue=$e[0][0][1][1],he=Ke({r:G,c:ue});g[he]?v.f=""+kr(D.formula,o,D.cell,N,W):v.F=((r.dense?(a[G]||[])[ue]:a[he])||{}).F}else v.f=""+kr(D.formula,o,D.cell,N,W)}_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V(D.cell,v,r),i=D}break;case 7:case 519:if(i)i.val=D,v=Nc(D,i.cell.ixfe,"s"),v.XF=M[v.ixfe],r.cellFormula&&(v.f=""+kr(i.formula,o,i.cell,N,W)),_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V(i.cell,v,r),i=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(D);var be=Ke(D[0].s);if(h=r.dense?(a[D[0].s.r]||[])[D[0].s.c]:a[be],r.cellFormula&&h){if(!i||!be||!h)break;h.f=""+kr(D[1],o,D[0],N,W),h.F=nt(D[0])}}break;case 1212:{if(!r.cellFormula)break;if(p){if(!i)break;g[Ke(i.cell)]=D[0],h=r.dense?(a[i.cell.r]||[])[i.cell.c]:a[Ke(i.cell)],(h||{}).f=""+kr(D[0],o,d,N,W)}}break;case 253:v=Nc(l[D.isst].t,D.ixfe,"s"),l[D.isst].h&&(v.h=l[D.isst].h),v.XF=M[v.ixfe],_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:D.c,r:D.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:D.ixfe,XF:M[D.ixfe],t:"z"},_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:D.c,r:D.r},v,r));break;case 190:if(r.sheetStubs)for(var Fe=D.c;Fe<=D.C;++Fe){var Me=D.ixfe[Fe-D.c];v={ixfe:Me,XF:M[Me],t:"z"},_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:Fe,r:D.r},v,r)}break;case 214:case 516:case 4:v=Nc(D.val,D.ixfe,"s"),v.XF=M[v.ixfe],_>0&&(v.z=P[v.ixfe>>8&63]),Yn(v,r,t.opts.Date1904),V({c:D.c,r:D.r},v,r);break;case 0:case 512:Z===1&&(o=D);break;case 252:l=D;break;case 1054:if(W.biff==4){P[_++]=D[1];for(var tt=0;tt<_+163&&Ge[tt]!=D[1];++tt);tt>=163&&js(D[1],_+163)}else js(D[1],D[0]);break;case 30:{P[_++]=D;for(var at=0;at<_+163&&Ge[at]!=D;++at);at>=163&&js(D,_+163)}break;case 229:ee=ee.concat(D);break;case 93:J[D.cmo[0]]=W.lastobj=D;break;case 438:W.lastobj.TxO=D;break;case 127:W.lastobj.ImData=D;break;case 440:for(y=D[0].s.r;y<=D[0].e.r;++y)for(m=D[0].s.c;m<=D[0].e.c;++m)h=r.dense?(a[y]||[])[m]:a[Ke({c:m,r:y})],h&&(h.l=D[1]);break;case 2048:for(y=D[0].s.r;y<=D[0].e.r;++y)for(m=D[0].s.c;m<=D[0].e.c;++m)h=r.dense?(a[y]||[])[m]:a[Ke({c:m,r:y})],h&&h.l&&(h.l.Tooltip=D[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;h=r.dense?(a[D[0].r]||[])[D[0].c]:a[Ke(D[0])];var yt=J[D[2]];h||(r.dense?(a[D[0].r]||(a[D[0].r]=[]),h=a[D[0].r][D[0].c]={t:"z"}):h=a[Ke(D[0])]={t:"z"},o.e.r=Math.max(o.e.r,D[0].r),o.s.r=Math.min(o.s.r,D[0].r),o.e.c=Math.max(o.e.c,D[0].c),o.s.c=Math.min(o.s.c,D[0].c)),h.c||(h.c=[]),x={a:D[1],t:yt.TxO.t},h.c.push(x)}break;case 2173:F4(M[D.ixfe],D.ext);break;case 125:{if(!W.cellStyles)break;for(;D.e>=D.s;)ne[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},q||(q=!0,kh(D.w/256)),ti(ne[D.e+1])}break;case 520:{var gt={};D.level!=null&&(B[D.r]=gt,gt.level=D.level),D.hidden&&(B[D.r]=gt,gt.hidden=!0),D.hpt&&(B[D.r]=gt,gt.hpt=D.hpt,gt.hpx=Pl(D.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ol(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[oe]]=D;break;case 161:a["!margins"]||ol(a["!margins"]={}),a["!margins"].header=D.header,a["!margins"].footer=D.footer;break;case 574:D.RTL&&(k.Views[0].RTL=!0);break;case 146:C=D;break;case 2198:te=D;break;case 140:b=D;break;case 442:c?F.CodeName=D||F.name:k.WBProps.CodeName=D||"ThisWorkbook";break}}else Y||console.error("Missing Info for XLS Record 0x"+oe.toString(16)),e.l+=X}return t.SheetNames=sa(s).sort(function(ct,Pe){return Number(ct)-Number(Pe)}).map(function(ct){return s[ct].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&A.forEach(function(ct,Pe){t.Sheets[t.SheetNames[Pe]]["!autofilter"]=ct}),t.Strings=l,t.SSF=dr(Ge),W.enc&&(t.Encryption=W.enc),te&&(t.Themes=te),t.Metadata={},b!==void 0&&(t.Metadata.Country=b),N.names.length>0&&(k.Names=N.names),t.Workbook=k,t}var rg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cA(e,r,t){var n=rt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=zx(n,TT,rg.DSI);for(var s in a)r[s]=a[s]}catch(c){if(t.WTF)throw c}var o=rt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var i=zx(o,CT,rg.SI);for(var l in i)r[l]==null&&(r[l]=i[l])}catch(c){if(t.WTF)throw c}r.HeadingPairs&&r.TitlesOfParts&&(ww(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function nk(e,r){r||(r={}),Th(r),Oy(),r.codepage&&ah(r.codepage);var t,n;if(e.FullPaths){if(rt.find(e,"/encryption"))throw new Error("File is password-protected");t=rt.find(e,"!CompObj"),n=rt.find(e,"/Workbook")||rt.find(e,"/Book")}else{switch(r.type){case"base64":e=Fn(rn(e));break;case"binary":e=Fn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cr(e,0),n={content:e}}var a,s;if(t&&sA(t),r.bookProps&&!r.bookSheets)a={};else{var o=et?"buffer":"array";if(n&&n.content)a=lA(n.content,r);else if((s=rt.find(e,"PerfectOffice_MAIN"))&&s.content)a=al.to_workbook(s.content,(r.type=o,r));else if((s=rt.find(e,"NativeContent_MAIN"))&&s.content)a=al.to_workbook(s.content,(r.type=o,r));else throw(s=rt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=G4(e))}var i={};return e.FullPaths&&cA(e,i,r),a.Props=a.Custprops=i,r.bookFiles&&(a.cfb=e),a}var Bu={0:{f:H3},1:{f:G3},2:{f:nF},3:{f:Z3},4:{f:Q3},5:{f:rF},6:{f:oF},7:{f:eF},8:{f:fF},9:{f:uF},10:{f:lF},11:{f:cF},12:{f:X3},13:{f:aF},14:{f:J3},15:{f:q3},16:{f:Zw},17:{f:iF},18:{f:tF},19:{f:mh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:LF},40:{},42:{},43:{f:l4},44:{f:i4},45:{f:c4},46:{f:f4},47:{f:u4},48:{},49:{f:dT},50:{},51:{f:O4},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ow},62:{f:sF},63:{f:j4},64:{f:wF},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:K3},148:{f:Y3,p:16},151:{f:hF},152:{},153:{f:IF},154:{},155:{},156:{f:RF},157:{},158:{},159:{T:1,f:CD},160:{T:-1},161:{T:1,f:io},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:A4},336:{T:-1},337:{f:P4,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Aw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mF},427:{f:xF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:V3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:pF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Y4},633:{T:1},634:{T:-1},635:{T:1,f:H4},636:{T:-1},637:{f:hT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:TF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ld={6:{f:hf},10:{f:La},12:{f:Gt},13:{f:Gt},14:{f:Ut},15:{f:Ut},16:{f:br},17:{f:Ut},18:{f:Ut},19:{f:Gt},20:{f:$x},21:{f:$x},23:{f:Aw},24:{f:Yx},25:{f:Ut},26:{},27:{},28:{f:UC},29:{},34:{f:Ut},35:{f:Hx},38:{f:br},39:{f:br},40:{f:br},41:{f:br},42:{f:Ut},43:{f:Ut},47:{f:VD},49:{f:bC},51:{f:Gt},60:{},61:{f:wC},64:{f:Ut},65:{f:_C},66:{f:Gt},77:{},80:{},81:{},82:{},85:{f:Gt},89:{},90:{},91:{},92:{f:dC},93:{f:HC},94:{},95:{f:Ut},96:{},97:{},99:{f:Ut},125:{f:Ow},128:{f:PC},129:{f:pC},130:{f:Gt},131:{f:Ut},132:{f:Ut},133:{f:hC},134:{},140:{f:QC},141:{f:Gt},144:{},146:{f:ZC},151:{},152:{},153:{},154:{},155:{},156:{f:Gt},157:{},158:{},160:{f:nD},161:{f:eD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:NC},190:{f:FC},193:{f:La},197:{},198:{},199:{},200:{},201:{},202:{f:Ut},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gt},220:{},221:{f:Ut},222:{},224:{f:OC},225:{f:fC},226:{f:La},227:{},229:{f:$C},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:mC},253:{f:EC},255:{f:xC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Sw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ut},353:{f:La},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:RC},431:{f:Ut},432:{},433:{},434:{},437:{},438:{f:KC},439:{f:Ut},440:{f:GC},441:{},442:{f:Kl},443:{},444:{f:Gt},445:{},446:{},448:{f:La},449:{f:yC,r:2},450:{f:La},512:{f:Wx},513:{f:rD},515:{f:MC},516:{f:SC},517:{f:Ux},519:{f:aD},520:{f:gC},523:{},545:{f:Vx},549:{f:Bx},566:{},574:{f:kC},638:{f:DC},659:{},1048:{},1054:{f:TC},1084:{},1212:{f:zC},2048:{f:XC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Tc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:La},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JC,r:12},2173:{f:N4,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ut,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:LC,r:12},2197:{},2198:{f:b4,r:12},2199:{},2200:{},2201:{},2202:{f:BC,r:12},2203:{f:La},2204:{},2205:{},2206:{},2207:{},2211:{f:vC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:qC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Wx},1:{},2:{f:lD},3:{f:iD},4:{f:oD},5:{f:Ux},7:{f:cD},8:{},9:{f:Tc},11:{},22:{f:Gt},30:{f:CC},31:{},32:{},33:{f:Vx},36:{},37:{f:Bx},50:{f:uD},62:{},52:{},67:{},68:{f:Gt},69:{},86:{},126:{},127:{f:sD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:fD},223:{},234:{},354:{},421:{},518:{f:hf},521:{f:Tc},536:{f:Yx},547:{f:Hx},561:{},579:{},1030:{f:hf},1033:{f:Tc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Sn(e,r,t,n){var a=r;if(!isNaN(a)){var s=(t||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&dw(t)&&e.push(t)}}function ng(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=a.index,i=s&&s.index||e.length,l=MS(e.slice(o,i),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<l.length;++o){var m=l[o].trim(),y=m.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,t.sheetRows&&t.sheetRows<=c){--c;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var g=m.split(/<\/t[dh]>/i);for(i=0;i<g.length;++i){var w=g[i].trim();if(w.match(/<t[dh]/i)){for(var v=w,b=0;v.charAt(0)=="<"&&(b=v.indexOf(">"))>-1;)v=v.slice(b+1);for(var M=0;M<x.length;++M){var C=x[M];C.s.c==u&&C.s.r<c&&c<=C.e.r&&(u=C.e.c+1,M=-1)}var k=He(w.slice(0,w.indexOf(">")));p=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||p>1)&&x.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+p-1}});var F=k.t||k["data-t"]||"";if(!v.length){u+=p;continue}if(v=Jy(v),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!v.length){u+=p;continue}var E={t:"s",v};t.raw||!v.trim().length||F=="s"||(v==="TRUE"?E={t:"b",v:!0}:v==="FALSE"?E={t:"b",v:!1}:isNaN(In(v))?isNaN(ei(v).getDate())||(E={t:"d",v:sr(v)},t.cellDates||(E={t:"n",v:Br(E.v)}),E.z=t.dateNF||Ge[14]):E={t:"n",v:In(v)}),t.dense?(n[c]||(n[c]=[]),n[c][u]=E):n[Ke({r:c,c:u})]=E,u+=p}}}}return n["!ref"]=nt(h),x.length&&(n["!merges"]=x),n}function uA(e,r,t,n){for(var a=e["!merges"]||[],s=[],o=r.s.c;o<=r.e.c;++o){for(var i=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>t||a[c].s.c>o)&&!(a[c].e.r<t||a[c].e.c<o)){if(a[c].s.r<t||a[c].s.c<o){i=-1;break}i=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(i<0)){var u=Ke({r:t,c:o}),d=n.dense?(e[t]||[])[o]:e[u],p=d&&d.v!=null&&(d.h||uh(d.w||(Oa(d),d.w)||""))||"",h={};i>1&&(h.rowspan=i),l>1&&(h.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+u,s.push(QS("td",p,h))}}var x="<tr>";return x+s.join("")+"</tr>"}var fA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',dA="</body></html>";function pA(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return ys(ng(t[0],r),r);var n=Dh();return t.forEach(function(a,s){Nh(n,ng(a,r),"Sheet"+(s+1))}),n}function hA(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function mA(e,r){var t=r||{},n=t.header!=null?t.header:fA,a=t.footer!=null?t.footer:dA,s=[n],o=hi(e["!ref"]);t.dense=Array.isArray(e),s.push(hA(e,o,t));for(var i=o.s.r;i<=o.e.r;++i)s.push(uA(e,o,i,t));return s.push("</table>"+a),s.join("")}function ak(e,r,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Rr(n.origin):n.origin;a=o.r,s=o.c}var i=r.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,i.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=hi(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var d=[],p=0,h=e["!rows"]||(e["!rows"]=[]),x=0,m=0,y=0,g=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<i.length&&m<l;++x){var b=i[x];if(ag(b)){if(n.display)continue;h[m]={hidden:!0}}var M=b.children;for(y=g=0;y<M.length;++y){var C=M[y];if(!(n.display&&ag(C))){var k=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):Jy(C.innerHTML),F=C.getAttribute("data-z")||C.getAttribute("z");for(p=0;p<d.length;++p){var E=d[p];E.s.c==g+s&&E.s.r<m+a&&m+a<=E.e.r&&(g=E.e.c+1-s,p=-1)}v=+C.getAttribute("colspan")||1,((w=+C.getAttribute("rowspan")||1)>1||v>1)&&d.push({s:{r:m+a,c:g+s},e:{r:m+a+(w||1)-1,c:g+s+(v||1)-1}});var j={t:"s",v:k},V=C.getAttribute("data-t")||C.getAttribute("t")||"";k!=null&&(k.length==0?j.t=V||"z":n.raw||k.trim().length==0||V=="s"||(k==="TRUE"?j={t:"b",v:!0}:k==="FALSE"?j={t:"b",v:!1}:isNaN(In(k))?isNaN(ei(k).getDate())||(j={t:"d",v:sr(k)},n.cellDates||(j={t:"n",v:Br(j.v)}),j.z=n.dateNF||Ge[14]):j={t:"n",v:In(k)})),j.z===void 0&&F!=null&&(j.z=F);var W="",te=C.getElementsByTagName("A");if(te&&te.length)for(var ee=0;ee<te.length&&!(te[ee].hasAttribute("href")&&(W=te[ee].getAttribute("href"),W.charAt(0)!="#"));++ee);W&&W.charAt(0)!="#"&&(j.l={Target:W}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][g+s]=j):e[Ke({c:g+s,r:m+a})]=j,c.e.c<g+s&&(c.e.c=g+s),g+=v}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=nt(c),m>=l&&(e["!fullref"]=nt((c.e.r=i.length-x+m-1+a,c))),e}function sk(e,r){var t=r||{},n=t.dense?[]:{};return ak(n,e,r)}function xA(e,r){return ys(sk(e,r),r)}function ag(e){var r="",t=gA(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function gA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function vA(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=lt(r.replace(/<[^>]*>/g,""));return[t]}var sg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ok(e,r){var t=r||{},n=fh(e),a=[],s,o,i={name:""},l="",c=0,u,d,p={},h=[],x=t.dense?[]:{},m,y,g={value:""},w="",v=0,b=[],M=-1,C=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,E={},j=[],V={},W=0,te=0,ee=[],J=1,ne=1,B=[],q={Names:[]},N={},U=["",""],Z=[],_={},P="",A=0,z=!1,Q=!1,re=0;for(Fl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Fl.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=nt(k):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=t.sheetRows-1,x["!ref"]=nt(k)),j.length&&(x["!merges"]=j),ee.length&&(x["!rows"]=ee),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),p[u.name]=x,Q=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=He(m[0],!1),M=C=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=t.dense?[]:{},j=[],ee=[],Q=!0);break;case"table-row-group":m[1]==="/"?--F:++F;break;case"table-row":case"行":if(m[1]==="/"){M+=J,J=1;break}if(d=He(m[0],!1),d.行号?M=d.行号-1:M==-1&&(M=0),J=+d["number-rows-repeated"]||1,J<10)for(re=0;re<J;++re)F>0&&(ee[M+re]={level:F});C=-1;break;case"covered-table-cell":m[1]!=="/"&&++C,t.sheetStubs&&(t.dense?(x[M]||(x[M]=[]),x[M][C]={t:"z"}):x[Ke({r:M,c:C})]={t:"z"}),w="",b=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++C,g=He(m[0],!1),ne=parseInt(g["number-columns-repeated"]||"1",10),y={t:"z",v:null},g.formula&&t.cellFormula!=!1&&(y.f=Jx(lt(g.formula))),(g.数据类型||g["value-type"])=="string"&&(y.t="s",y.v=lt(g["string-value"]||""),t.dense?(x[M]||(x[M]=[]),x[M][C]=y):x[Ke({r:M,c:C})]=y),C+=ne-1;else if(m[1]!=="/"){++C,w="",v=0,b=[],ne=1;var oe=J?M+J-1:M;if(C>k.e.c&&(k.e.c=C),C<k.s.c&&(k.s.c=C),M<k.s.r&&(k.s.r=M),oe>k.e.r&&(k.e.r=oe),g=He(m[0],!1),Z=[],_={},y={t:g.数据类型||g["value-type"],v:null},t.cellFormula)if(g.formula&&(g.formula=lt(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(W=parseInt(g["number-matrix-rows-spanned"],10)||0,te=parseInt(g["number-matrix-columns-spanned"],10)||0,V={s:{r:M,c:C},e:{r:M+W-1,c:C+te-1}},y.F=nt(V),B.push([V,y.F])),g.formula)y.f=Jx(g.formula);else for(re=0;re<B.length;++re)M>=B[re][0].s.r&&M<=B[re][0].e.r&&C>=B[re][0].s.c&&C<=B[re][0].e.c&&(y.F=B[re][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(W=parseInt(g["number-rows-spanned"],10)||0,te=parseInt(g["number-columns-spanned"],10)||0,V={s:{r:M,c:C},e:{r:M+W-1,c:C+te-1}},j.push(V)),g["number-columns-repeated"]&&(ne=parseInt(g["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Ft(g["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(g.value);break;case"percentage":y.t="n",y.v=parseFloat(g.value);break;case"currency":y.t="n",y.v=parseFloat(g.value);break;case"date":y.t="d",y.v=sr(g["date-value"]),t.cellDates||(y.t="n",y.v=Br(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=AS(g["time-value"])/86400,t.cellDates&&(y.t="d",y.v=_0(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(g.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",g["string-value"]!=null&&(w=lt(g["string-value"]),b=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(z=!1,y.t==="s"&&(y.v=w||"",b.length&&(y.R=b),z=v==0),N.Target&&(y.l=N),Z.length>0&&(y.c=Z,Z=[]),w&&t.cellText!==!1&&(y.w=w),z&&(y.t="z",delete y.v),(!z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=M))for(var X=0;X<J;++X){if(ne=parseInt(g["number-columns-repeated"]||"1",10),t.dense)for(x[M+X]||(x[M+X]=[]),x[M+X][C]=X==0?y:dr(y);--ne>0;)x[M+X][C+ne]=dr(y);else for(x[Ke({r:M+X,c:C})]=y;--ne>0;)x[Ke({r:M+X,c:C+ne})]=dr(y);k.e.c<=C&&(k.e.c=C)}ne=parseInt(g["number-columns-repeated"]||"1",10),C+=ne-1,ne=0,y={},w="",b=[]}N={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;_.t=w,b.length&&(_.R=b),_.a=P,Z.push(_)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);P="",A=0,w="",v=0,b=[];break;case"creator":m[1]==="/"?P=n.slice(A,m.index):A=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);w="",v=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(E[i.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",i=He(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=He(m[0],!1),l+=sg[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=He(m[0],!1),l+=sg[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":o=He(m[0],!1),U=mf(o["cell-range-address"]);var Y={Name:o.name,Ref:U[0]+"!"+U[1]};Q&&(Y.Sheet=h.length),q.Names.push(Y);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!g||!g["string-value"])){var K=vA(n.slice(v,m.index));w=(w.length>0?w+`
`:"")+K[0]}else He(m[0],!1),v=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{U=mf(He(m[0])["target-range-address"]),p[U[0]]["!autofilter"]={ref:U[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(N=He(m[0],!1),!N.href)break;N.Target=lt(N.href),delete N.href,N.Target.charAt(0)=="#"&&N.Target.indexOf(".")>-1?(U=mf(N.Target.slice(1)),N.Target="#"+U[0]+"!"+U[1]):N.Target.match(/^\.\.[\\\/]/)&&(N.Target=N.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(m)}}var D={Sheets:p,SheetNames:h,Workbook:q};return t.bookSheets&&delete D.Sheets,D}function og(e,r){r=r||{},cn(e,"META-INF/manifest.xml")&&MT(Kt(e,"META-INF/manifest.xml"),r);var t=qr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=ok(Et(t),r);return cn(e,"meta.xml")&&(n.Props=yw(Kt(e,"meta.xml"))),n}function ig(e,r){return ok(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Eh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Et(so(e))}function Bd(e){var r=e.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function lg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function yA(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Ml(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function er(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Er(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Ml(e,t),s=a&7;a=Math.floor(a/8);var o=0,i;if(a==0)break;switch(s){case 0:{for(var l=t[0];e[t[0]++]>=128;);i=e.slice(l,t[0])}break;case 5:o=4,i=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,i=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Ml(e,t),i=e.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:i,type:s};r[a]==null?r[a]=[c]:r[a].push(c)}return r}function Sh(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function wA(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Ml(e,n),s=Er(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:er(s[1][0].data),messages:[]};s[2].forEach(function(i){var l=Er(i.data),c=er(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(r=s[3])!=null&&r[0]&&(o.merge=er(s[3][0].data)>>>0>0),t.push(o)}return t}function kA(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Ml(r,t),a=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var o=r[t[0]++]>>2;if(o<60)++o;else{var i=o-59;o=r[t[0]],i>1&&(o|=r[t[0]+1]<<8),i>2&&(o|=r[t[0]+2]<<16),i>3&&(o|=r[t[0]+3]<<24),o>>>=0,o++,t[0]+=i}a.push(r.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(r[t[0]]>>2&7)+4,l=(r[t[0]++]&224)<<3,l|=r[t[0]++]):(c=(r[t[0]++]>>2)+1,s==2?(l=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(l=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Bd(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=Bd(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function _A(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(kA(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Bd(r)}function bA(e,r,t,n){var a=Eh(e),s=a.getUint32(4,!0),o=(n>1?12:8)+lg(s&(n>1?3470:398))*4,i=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(i=a.getUint32(o,!0),o+=4),o+=lg(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(o,!0),o+=4),s&32&&(c=a.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:r[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:t[i]};else if(l>-1)d={t:"s",v:r[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function EA(e,r,t){var n=Eh(e),a=n.getUint32(8,!0),s=12,o=-1,i=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=yA(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(i=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:r[i]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:t[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function SA(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return bA(e,r,t,e[0]);case 5:return EA(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function os(e){var r=Er(e);return Ml(r[1][0].data)}function cg(e,r){var t=Er(r.data),n=er(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(o){var i=Er(o.data),l=er(i[1][0].data)>>>0;switch(n){case 1:s[l]=zd(i[3][0].data);break;case 8:{var c=e[os(i[9][0].data)][0],u=Er(c.data),d=e[os(u[1][0].data)][0],p=er(d.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=Er(d.data);s[l]=h[3].map(function(x){return zd(x.data)}).join("")}break}}),s}function TA(e,r){var t,n,a,s,o,i,l,c,u,d,p,h,x,m,y=Er(e),g=er(y[1][0].data)>>>0,w=er(y[2][0].data)>>>0,v=((n=(t=y[8])==null?void 0:t[0])==null?void 0:n.data)&&er(y[8][0].data)>0||!1,b,M;if((s=(a=y[7])==null?void 0:a[0])!=null&&s.data&&r!=0)b=(i=(o=y[7])==null?void 0:o[0])==null?void 0:i.data,M=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=y[4])==null?void 0:u[0])!=null&&d.data&&r!=1)b=(h=(p=y[4])==null?void 0:p[0])==null?void 0:h.data,M=(m=(x=y[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var C=v?4:1,k=Eh(b),F=[],E=0;E<b.length/2;++E){var j=k.getUint16(E*2,!0);j<65535&&F.push([E,j])}if(F.length!=w)throw"Expected ".concat(w," cells, found ").concat(F.length);var V=[];for(E=0;E<F.length-1;++E)V[F[E][0]]=M.subarray(F[E][1]*C,F[E+1][1]*C);return F.length>=1&&(V[F[F.length-1][0]]=M.subarray(F[F.length-1][1]*C)),{R:g,cells:V}}function CA(e,r){var t,n=Er(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?er(n[7][0].data)>>>0>0?1:0:-1,s=Sh(n[5],function(o){return TA(o,a)});return{nrows:er(n[4][0].data)>>>0,data:s.reduce(function(o,i){return o[i.R]||(o[i.R]=[]),i.cells.forEach(function(l,c){if(o[i.R][c])throw new Error("Duplicate cell r=".concat(i.R," c=").concat(c));o[i.R][c]=l}),o},[])}}function DA(e,r,t){var n,a=Er(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(er(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(er(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=nt(s);var o=Er(a[4][0].data),i=cg(e,e[os(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?cg(e,e[os(o[17][0].data)][0]):[],c=Er(o[3][0].data),u=0;c[1].forEach(function(d){var p=Er(d.data),h=e[os(p[2][0].data)][0],x=er(h.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=CA(e,h);m.data.forEach(function(y,g){y.forEach(function(w,v){var b=Ke({r:u+g,c:v}),M=SA(w,i,l);M&&(t[b]=M)})}),u+=m.nrows})}function NA(e,r){var t=Er(r.data),n={"!ref":"A1"},a=e[os(t[2][0].data)],s=er(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return DA(e,a[0],n),n}function FA(e,r){var t,n=Er(r.data),a={name:(t=n[1])!=null&&t[0]?zd(n[1][0].data):"",sheets:[]},s=Sh(n[2],os);return s.forEach(function(o){e[o].forEach(function(i){var l=er(i.meta[1][0].data);l==6e3&&a.sheets.push(NA(e,i))})}),a}function AA(e,r){var t=Dh(),n=Er(r.data),a=Sh(n[1],os);if(a.forEach(function(s){e[s].forEach(function(o){var i=er(o.meta[1][0].data);if(i==2){var l=FA(e,o);l.sheets.forEach(function(c,u){Nh(t,c,u==0?l.name:l.name+"_"+u,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function gf(e){var r,t,n,a,s={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=_A(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=wA(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){s[d.id]=d.messages,o.push(d.id)})}}),!o.length)throw new Error("File has no messages");var i=((a=(n=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&er(s[1][0].meta[1][0].data)==1&&s[1][0];if(i||o.forEach(function(l){s[l].forEach(function(c){var u=er(c.meta[1][0].data)>>>0;if(u==1)if(!i)i=c;else throw new Error("Document has multiple roots")})}),!i)throw new Error("Cannot find Document root");return AA(s,i)}function OA(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Th(e){OA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function PA(e){return Oo.WS.indexOf(e)>-1?"sheet":e==Oo.CS?"chart":e==Oo.DS?"dialog":e==Oo.MS?"macro":e&&e.length?e:"sheet"}function MA(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,PA(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function RA(e,r,t,n,a,s,o,i,l,c,u,d){try{s[n]=rl(qr(e,t,!0),r);var p=Kt(e,r),h;switch(i){case"sheet":h=WF(p,r,a,l,s[n],c,u,d);break;case"chart":if(h=UF(p,r,a,l,s[n],c,u,d),!h||!h["!drawel"])break;var x=Li(h["!drawel"].Target,r),m=Md(x),y=B4(qr(e,x,!0),rl(qr(e,m,!0),x)),g=Li(y,x),w=Md(g);h=EF(qr(e,g,!0),g,l,rl(qr(e,w,!0),g),c,h);break;case"macro":h=$F(p,r,a,l,s[n],c,u,d);break;case"dialog":h=HF(p,r,a,l,s[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+i)}o[n]=h;var v=[];s&&s[n]&&sa(s[n]).forEach(function(b){var M="";if(s[n][b].Type==Oo.CMNT){M=Li(s[n][b].Target,r);var C=GF(Kt(e,M,!0),M,l);if(!C||!C.length)return;Gx(h,C,!1)}s[n][b].Type==Oo.TCMNT&&(M=Li(s[n][b].Target,r),v=v.concat(U4(Kt(e,M,!0),l)))}),v&&v.length&&Gx(h,v,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function sn(e){return e.charAt(0)=="/"?e.slice(1):e}function IA(e,r){if(Hy(),r=r||{},Th(r),cn(e,"META-INF/manifest.xml")||cn(e,"objectdata.xml"))return og(e,r);if(cn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gf<"u"){if(e.FileIndex)return gf(e);var t=rt.utils.cfb_new();return kx(e).forEach(function(ee){jS(t,ee,IS(e,ee))}),gf(t)}throw new Error("Unsupported NUMBERS file")}if(!cn(e,"[Content_Types].xml"))throw cn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):cn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=kx(e),a=OT(qr(e,"[Content_Types].xml")),s=!1,o,i;if(a.workbooks.length===0&&(i="xl/workbook.xml",Kt(e,i,!0)&&a.workbooks.push(i)),a.workbooks.length===0){if(i="xl/workbook.bin",!Kt(e,i,!0))throw new Error("Could not find workbook");a.workbooks.push(i),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!r.bookSheets&&!r.bookProps){if(sl=[],a.sst)try{sl=KF(Kt(e,sn(a.sst)),a.sst,r)}catch(ee){if(r.WTF)throw ee}r.cellStyles&&a.themes.length&&(l=VF(qr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(c=YF(Kt(e,sn(a.style)),a.style,l,r))}a.links.map(function(ee){try{var J=rl(qr(e,Md(sn(ee))),ee);return QF(Kt(e,sn(ee)),J,ee,r)}catch{}});var u=BF(Kt(e,sn(a.workbooks[0])),a.workbooks[0],r),d={},p="";a.coreprops.length&&(p=Kt(e,sn(a.coreprops[0]),!0),p&&(d=yw(p)),a.extprops.length!==0&&(p=Kt(e,sn(a.extprops[0]),!0),p&&jT(p,d,r)));var h={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(p=qr(e,sn(a.custprops[0]),!0),p&&(h=zT(p,r)));var x={};if((r.bookSheets||r.bookProps)&&(u.Sheets?o=u.Sheets.map(function(J){return J.name}):d.Worksheets&&d.SheetNames.length>0&&(o=d.SheetNames),r.bookProps&&(x.Props=d,x.Custprops=h),r.bookSheets&&typeof o<"u"&&(x.SheetNames=o),r.bookSheets?x.SheetNames:r.bookProps))return x;o={};var m={};r.bookDeps&&a.calcchain&&(m=XF(Kt(e,sn(a.calcchain)),a.calcchain));var y=0,g={},w,v;{var b=u.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var M=0;M!=b.length;++M)d.SheetNames[M]=b[M].name}var C=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),F=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");cn(e,F)||(F="xl/_rels/workbook."+C+".rels");var E=rl(qr(e,F,!0),F.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=qF(Kt(e,sn(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=$4(Kt(e,sn(a.people[0])),r)),E&&(E=MA(E,u.Sheets));var j=Kt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var V="sheet";if(E&&E[y]?(w="xl/"+E[y][1].replace(/[\/]?xl\//,""),cn(e,w)||(w=E[y][1]),cn(e,w)||(w=F.replace(/_rels\/.*$/,"")+E[y][1]),V=E[y][2]):(w="xl/worksheets/sheet"+(y+1-j)+"."+C,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(y!=r.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var W=!1,te=0;te!=r.sheets.length;++te)typeof r.sheets[te]=="number"&&r.sheets[te]==y&&(W=1),typeof r.sheets[te]=="string"&&r.sheets[te].toLowerCase()==d.SheetNames[y].toLowerCase()&&(W=1);if(!W)continue e}}RA(e,w,v,d.SheetNames[y],y,g,o,V,r,u,l,c)}return x={Directory:a,Workbook:u,Props:d,Custprops:h,Deps:m,Sheets:o,SheetNames:d.SheetNames,Strings:sl,Styles:c,Themes:l,SSF:dr(Ge)},r&&r.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ee,J){ee=ee.replace(/^Root Entry[\/]/,""),x.keys.push(ee),x.files[ee]=e.FileIndex[J]}))),r&&r.bookVBA&&(a.vba.length>0?x.vbaraw=Kt(e,sn(a.vba[0]),!0):a.defaults&&a.defaults.bin===K4&&(x.vbaraw=Kt(e,"xl/vbaProject.bin",!0))),x}function jA(e,r){var t=r||{},n="Workbook",a=rt.find(e,n);try{if(n="/!DataSpaces/Version",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ND(a.content),n="/!DataSpaces/DataSpaceMap",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=AD(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=OD(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);MD(a.content)}catch{}if(n="/EncryptionInfo",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=RD(a.content);if(n="/EncryptedPackage",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(i[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(i[1],a.content,t.password||"",t);if(i[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(i[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Ch(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=rn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function LA(e,r){return rt.find(e,"EncryptedPackage")?jA(e,r):nk(e,r)}function zA(e,r){var t,n=e,a=r||{};return a.type||(a.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),t=Qy(n,a),IA(t,a)}function ik(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return jd(e.slice(t),r);default:break e}return Al.to_workbook(e,r)}function BA(e,r){var t="",n=Ch(e,r);switch(r.type){case"base64":t=rn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Qs(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Et(t)),r.type="binary",ik(t,r)}function WA(e,r){var t=e;return r.type=="base64"&&(t=rn(t)),t=Ad.utils.decode(1200,t.slice(2),"str"),r.type="binary",ik(t,r)}function UA(e){return e.match(/[^\x00-\x7F]/)?zi(e):e}function vf(e,r,t,n){return n?(t.type="string",Al.to_workbook(e,t)):Al.to_workbook(r,t)}function Wd(e,r){Oy();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Wd(new Uint8Array(e),(t=dr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Wo={},t.dateNF&&(Wo.dateNF=t.dateNF),t.type||(t.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=et?"buffer":"binary",n=NS(e),typeof Uint8Array<"u"&&!et&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=UA(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),i=new Uint8Array(o);if(i.foo="bar",!i.foo)return t=dr(t),t.type="array",Wd(sh(n),t)}switch((a=Ch(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return LA(rt.read(n,t),t);break;case 9:if(a[1]<=8)return nk(n,t);break;case 60:return jd(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return xD(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return hD.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?zA(n,t):vf(e,n,t,s);case 239:return a[3]===60?jd(n,t):vf(e,n,t,s);case 255:if(a[1]===254)return WA(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return al.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return al.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Kx.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return KD.to_workbook(n,t);break;case 10:case 13:case 32:return BA(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return dD.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Kx.to_workbook(n,t):vf(e,n,t,s)}function $A(e,r,t,n,a,s,o,i){var l=pr(t),c=i.defval,u=i.raw||!Object.prototype.hasOwnProperty.call(i,"raw"),d=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:t,enumerable:!1})}catch{p.__rowNum__=t}else p.__rowNum__=t;if(!o||e[t])for(var h=r.s.c;h<=r.e.c;++h){var x=o?e[t][h]:e[n[h]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[h]!=null&&(p[s[h]]=c);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[h]!=null){if(m==null)if(x.t=="e"&&m===null)p[s[h]]=null;else if(c!==void 0)p[s[h]]=c;else if(u&&m===null)p[s[h]]=null;else continue;else p[s[h]]=u&&(x.t!=="n"||x.t==="n"&&i.rawNumbers!==!1)?m:Oa(x,m,i);m!=null&&(d=!1)}}return{row:p,isempty:d}}function Ud(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],o=0,i="",l={s:{r:0,c:0},e:{r:0,c:0}},c=r||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=zt(u);break;case"number":l=zt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var d=pr(l.s.r),p=[],h=[],x=0,m=0,y=Array.isArray(e),g=l.s.r,w=0,v={};y&&!e[g]&&(e[g]=[]);var b=c.skipHidden&&e["!cols"]||[],M=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(b[w]||{}).hidden)switch(p[w]=Jt(w),t=y?e[g][w]:e[p[w]+d],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=p[w];break;case 3:s[w]=c.header[w-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),i=o=Oa(t,null,c),m=v[o]||0,!m)v[o]=1;else{do i=o+"_"+m++;while(v[i]);v[o]=m,v[i]=1}s[w]=i}for(g=l.s.r+a;g<=l.e.r;++g)if(!(M[g]||{}).hidden){var C=$A(e,l,g,p,n,s,y,c);(C.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[x++]=C.row)}return h.length=x,h}var ug=/"/g;function HA(e,r,t,n,a,s,o,i){for(var l=!0,c=[],u="",d=pr(t),p=r.s.c;p<=r.e.c;++p)if(n[p]){var h=i.dense?(e[t]||[])[p]:e[n[p]+d];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(i.rawNumbers&&h.t=="n"?h.v:Oa(h,null,i));for(var x=0,m=0;x!==u.length;++x)if((m=u.charCodeAt(x))===a||m===s||m===34||i.forceQuotes){u='"'+u.replace(ug,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(ug,'""')+'"')):u="";c.push(u)}return i.blankrows===!1&&l?null:c.join(o)}function lk(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=zt(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),i=n.RS!==void 0?n.RS:`
`,l=i.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(p[x]||{}).hidden||(d[x]=Jt(x));for(var m=0,y=a.s.r;y<=a.e.r;++y)(h[y]||{}).hidden||(u=HA(e,a,y,d,o,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&t.push((m++?i:"")+u)));return delete n.dense,t.join("")}function YA(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=lk(e,r);return t}function VA(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=zt(e["!ref"]),s="",o=[],i,l=[],c=Array.isArray(e);for(i=a.s.c;i<=a.e.c;++i)o[i]=Jt(i);for(var u=a.s.r;u<=a.e.r;++u)for(s=pr(u),i=a.s.c;i<=a.e.c;++i)if(r=o[i]+s,t=c?(e[u]||[])[i]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=r+"="+n}return l}function ck(e,r,t){var n=t||{},a=+!n.skipHeader,s=e||{},o=0,i=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Rr(n.origin):n.origin;o=l.r,i=l.c}var c,u={s:{c:0,r:0},e:{c:i,r:o+r.length-1+a}};if(s["!ref"]){var d=zt(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+r.length-1+a)}else o==-1&&(o=0,u.e.r=r.length-1+a);var p=n.header||[],h=0;r.forEach(function(m,y){sa(m).forEach(function(g){(h=p.indexOf(g))==-1&&(p[h=p.length]=g);var w=m[g],v="z",b="",M=Ke({c:i+h,r:o+y+a});c=Rl(s,M),w&&typeof w=="object"&&!(w instanceof Date)?s[M]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=Br(w)),b=n.dateNF||Ge[14]):w===null&&n.nullError&&(v="e",w=0),c?(c.t=v,c.v=w,delete c.w,delete c.R,b&&(c.z=b)):s[M]=c={t:v,v:w},b&&(c.z=b))})}),u.e.c=Math.max(u.e.c,i+p.length-1);var x=pr(o);if(a)for(h=0;h<p.length;++h)s[Jt(h+i)+x]={t:"s",v:p[h]};return s["!ref"]=nt(u),s}function KA(e,r){return ck(null,e,r)}function Rl(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=Rr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Rl(e,Ke(r)):Rl(e,Ke({r,c:t||0}))}function GA(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Dh(){return{SheetNames:[],Sheets:{}}}function Nh(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=o+a)!=-1;++a);}if(OF(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function XA(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=GA(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function QA(e,r){return e.z=r,e}function uk(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function qA(e,r,t){return uk(e,"#"+r,t)}function ZA(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function JA(e,r,t,n){for(var a=typeof r!="string"?r:zt(r),s=typeof r=="string"?r:nt(r),o=a.s.r;o<=a.e.r;++o)for(var i=a.s.c;i<=a.e.c;++i){var l=Rl(e,o,i);l.t="n",l.F=s,delete l.v,o==a.s.r&&i==a.s.c&&(l.f=t,n&&(l.D=!0))}return e}var eO={encode_col:Jt,encode_row:pr,encode_cell:Ke,encode_range:nt,decode_col:hh,decode_row:ph,split_cell:fT,decode_cell:Rr,decode_range:hi,format_cell:Oa,sheet_add_aoa:hw,sheet_add_json:ck,sheet_add_dom:ak,aoa_to_sheet:mi,json_to_sheet:KA,table_to_sheet:sk,table_to_book:xA,sheet_to_csv:lk,sheet_to_txt:YA,sheet_to_json:Ud,sheet_to_html:mA,sheet_to_formulae:VA,sheet_to_row_object_array:Ud,sheet_get_cell:Rl,book_new:Dh,book_append_sheet:Nh,book_set_sheet_visibility:XA,cell_set_number_format:QA,cell_set_hyperlink:uk,cell_set_internal_link:qA,cell_add_comment:ZA,sheet_set_array_formula:JA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const tO=({isOpen:e,onClose:r,onUpload:t})=>{const[n,a]=S.useState(null),s=S.useRef(null),o=c=>{var d;const u=(d=c.target.files)==null?void 0:d[0];u&&a(u)},i=()=>{if(n){const c=new FileReader;c.onload=u=>{var d;try{const p=new Uint8Array((d=u.target)==null?void 0:d.result),h=Wd(p,{type:"array"});console.log("Workbook sheets:",h.SheetNames);const x=h.Sheets[h.SheetNames[0]];console.log("First sheet data:",x);const m=eO.sheet_to_json(x,{header:1});console.log("Parsed JSON data:",m);const y={headers:m[0],rows:m.slice(1)};console.log("Prepared file data:",y),t(n.name,y),l()}catch(p){console.error("Error reading Excel file:",p)}},c.readAsArrayBuffer(n)}},l=()=>{a(null),s.current&&(s.current.value=""),r()};return f.jsx(or,{isOpen:e,onRequestClose:l,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Załaduj plik Excel"}),f.jsx("button",{onClick:l,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-2 overflow-hidden",children:f.jsx("div",{children:f.jsxs("div",{className:"relative mt-8",children:[f.jsx("input",{ref:s,type:"file",accept:".xlsx,.xls",onChange:o,className:"hidden"}),f.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[f.jsx("button",{onClick:()=>{var c;return(c=s.current)==null?void 0:c.click()},type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),n&&f.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:n.name})]})]})})}),f.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[f.jsx("button",{onClick:l,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),f.jsx("button",{onClick:i,disabled:!n,"aria-label":n?"Załaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${n?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Załaduj"})]})]})})},rO=({isOpen:e,onClose:r,onConfirm:t,fileName:n})=>f.jsx(or,{isOpen:e,onRequestClose:r,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:f.jsxs("div",{className:"h-full flex items-center justify-between",children:[f.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastąpić "',n,'"?']}),f.jsxs("div",{className:"flex space-x-2 shrink-0",children:[f.jsx("button",{onClick:r,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),f.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastąp"})]})]})});function fk(e){var r,t,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(r=0;r<a;r++)e[r]&&(t=fk(e[r]))&&(n&&(n+=" "),n+=t)}else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function ur(){for(var e,r,t=0,n="",a=arguments.length;t<a;t++)(e=arguments[t])&&(r=fk(e))&&(n&&(n+=" "),n+=r);return n}const dk=6048e5,nO=864e5,T0=6e4,C0=36e5,aO=1e3,fg=Symbol.for("constructDateFrom");function xt(e,r){return typeof e=="function"?e(r):e&&typeof e=="object"&&fg in e?e[fg](r):e instanceof Date?new e.constructor(r):new Date(r)}function Re(e,r){return xt(r||e,e)}function jn(e,r,t){const n=Re(e,t==null?void 0:t.in);return isNaN(r)?xt((t==null?void 0:t.in)||e,NaN):(r&&n.setDate(n.getDate()+r),n)}function zn(e,r,t){const n=Re(e,t==null?void 0:t.in);if(isNaN(r))return xt(e,NaN);if(!r)return n;const a=n.getDate(),s=xt(e,n.getTime());s.setMonth(n.getMonth()+r+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}function pk(e,r,t){return xt(e,+Re(e)+r)}function sO(e,r,t){return pk(e,r*C0)}let oO={};function uo(){return oO}function Bn(e,r){var i,l,c,u;const t=uo(),n=(r==null?void 0:r.weekStartsOn)??((l=(i=r==null?void 0:r.locale)==null?void 0:i.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,a=Re(e,r==null?void 0:r.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function ri(e,r){return Bn(e,{...r,weekStartsOn:1})}function hk(e,r){const t=Re(e,r==null?void 0:r.in),n=t.getFullYear(),a=xt(t,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=ri(a),o=xt(t,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const i=ri(o);return t.getTime()>=s.getTime()?n+1:t.getTime()>=i.getTime()?n:n-1}function Wu(e){const r=Re(e),t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),+e-+t}function ca(e,...r){const t=xt.bind(null,e||r.find(n=>typeof n=="object"));return r.map(t)}function Zs(e,r){const t=Re(e,r==null?void 0:r.in);return t.setHours(0,0,0,0),t}function ni(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r),s=Zs(n),o=Zs(a),i=+s-Wu(s),l=+o-Wu(o);return Math.round((i-l)/nO)}function iO(e,r){const t=hk(e,r),n=xt(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),ri(n)}function $d(e,r,t){const n=Re(e,t==null?void 0:t.in);return n.setTime(n.getTime()+r*T0),n}function Fh(e,r,t){return zn(e,r*3,t)}function lO(e,r,t){return pk(e,r*1e3)}function Uu(e,r,t){return jn(e,r*7,t)}function ba(e,r,t){return zn(e,r*12,t)}function dg(e,r){let t,n=r==null?void 0:r.in;return e.forEach(a=>{!n&&typeof a=="object"&&(n=xt.bind(null,a));const s=Re(a,n);(!t||t<s||isNaN(+s))&&(t=s)}),xt(n,t||NaN)}function pg(e,r){let t,n=r==null?void 0:r.in;return e.forEach(a=>{!n&&typeof a=="object"&&(n=xt.bind(null,a));const s=Re(a,n);(!t||t>s||isNaN(+s))&&(t=s)}),xt(n,t||NaN)}function cO(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r);return+Zs(n)==+Zs(a)}function Ea(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function $u(e){return!(!Ea(e)&&typeof e!="number"||isNaN(+Re(e)))}function Hu(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r),s=n.getFullYear()-a.getFullYear(),o=n.getMonth()-a.getMonth();return s*12+o}function zs(e,r){const t=Re(e,r==null?void 0:r.in);return Math.trunc(t.getMonth()/3)+1}function Yu(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r),s=n.getFullYear()-a.getFullYear(),o=zs(n)-zs(a);return s*4+o}function Vu(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r);return n.getFullYear()-a.getFullYear()}function uO(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r),s=hg(n,a),o=Math.abs(ni(n,a));n.setDate(n.getDate()-s*o);const i=+(hg(n,a)===-s),l=s*(o-i);return l===0?0:l}function hg(e,r){const t=e.getFullYear()-r.getFullYear()||e.getMonth()-r.getMonth()||e.getDate()-r.getDate()||e.getHours()-r.getHours()||e.getMinutes()-r.getMinutes()||e.getSeconds()-r.getSeconds()||e.getMilliseconds()-r.getMilliseconds();return t<0?-1:t>0?1:t}function mk(e,r){const t=Re(e,r==null?void 0:r.in);return t.setHours(23,59,59,999),t}function xk(e,r){const t=Re(e,r==null?void 0:r.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Hd(e,r){const t=Re(e,r==null?void 0:r.in),n=t.getMonth(),a=n-n%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function gk(e,r){const t=Re(e,r==null?void 0:r.in);return t.setDate(1),t.setHours(0,0,0,0),t}function vk(e,r){const t=Re(e,r==null?void 0:r.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}function D0(e,r){const t=Re(e,r==null?void 0:r.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function fO(e,r){var i,l;const t=uo(),n=t.weekStartsOn??((l=(i=t.locale)==null?void 0:i.options)==null?void 0:l.weekStartsOn)??0,a=Re(e,r==null?void 0:r.in),s=a.getDay(),o=(s<n?-7:0)+6-(s-n);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}const dO={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pO=(e,r,t)=>{let n;const a=dO[e];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function Uo(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const hO={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mO={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},xO={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gO={date:Uo({formats:hO,defaultWidth:"full"}),time:Uo({formats:mO,defaultWidth:"full"}),dateTime:Uo({formats:xO,defaultWidth:"full"})},vO={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yO=(e,r,t,n)=>vO[e];function qn(e){return(r,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,i=t!=null&&t.width?String(t.width):o;a=e.formattingValues[i]||e.formattingValues[o]}else{const o=e.defaultWidth,i=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[i]||e.values[o]}const s=e.argumentCallback?e.argumentCallback(r):r;return a[s]}}const wO={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},kO={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},_O={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},bO={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},EO={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},SO={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},TO=(e,r)=>{const t=Number(e),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},CO={ordinalNumber:TO,era:qn({values:wO,defaultWidth:"wide"}),quarter:qn({values:kO,defaultWidth:"wide",argumentCallback:e=>e-1}),month:qn({values:_O,defaultWidth:"wide"}),day:qn({values:bO,defaultWidth:"wide"}),dayPeriod:qn({values:EO,defaultWidth:"wide",formattingValues:SO,defaultFormattingWidth:"wide"})};function Zn(e){return(r,t={})=>{const n=t.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=r.match(a);if(!s)return null;const o=s[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(i)?NO(i,d=>d.test(o)):DO(i,d=>d.test(o));let c;c=e.valueCallback?e.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const u=r.slice(o.length);return{value:c,rest:u}}}function DO(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function NO(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function yk(e){return(r,t={})=>{const n=r.match(e.matchPattern);if(!n)return null;const a=n[0],s=r.match(e.parsePattern);if(!s)return null;let o=e.valueCallback?e.valueCallback(s[0]):s[0];o=t.valueCallback?t.valueCallback(o):o;const i=r.slice(a.length);return{value:o,rest:i}}}const FO=/^(\d+)(th|st|nd|rd)?/i,AO=/\d+/i,OO={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},PO={any:[/^b/i,/^(a|c)/i]},MO={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},RO={any:[/1/i,/2/i,/3/i,/4/i]},IO={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},jO={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},LO={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},zO={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},BO={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},WO={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},UO={ordinalNumber:yk({matchPattern:FO,parsePattern:AO,valueCallback:e=>parseInt(e,10)}),era:Zn({matchPatterns:OO,defaultMatchWidth:"wide",parsePatterns:PO,defaultParseWidth:"any"}),quarter:Zn({matchPatterns:MO,defaultMatchWidth:"wide",parsePatterns:RO,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zn({matchPatterns:IO,defaultMatchWidth:"wide",parsePatterns:jO,defaultParseWidth:"any"}),day:Zn({matchPatterns:LO,defaultMatchWidth:"wide",parsePatterns:zO,defaultParseWidth:"any"}),dayPeriod:Zn({matchPatterns:BO,defaultMatchWidth:"any",parsePatterns:WO,defaultParseWidth:"any"})},wk={code:"en-US",formatDistance:pO,formatLong:gO,formatRelative:yO,localize:CO,match:UO,options:{weekStartsOn:0,firstWeekContainsDate:1}};function $O(e,r){const t=Re(e,r==null?void 0:r.in);return ni(t,D0(t))+1}function Ah(e,r){const t=Re(e,r==null?void 0:r.in),n=+ri(t)-+iO(t);return Math.round(n/dk)+1}function Oh(e,r){var u,d,p,h;const t=Re(e,r==null?void 0:r.in),n=t.getFullYear(),a=uo(),s=(r==null?void 0:r.firstWeekContainsDate)??((d=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(p=a.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,o=xt((r==null?void 0:r.in)||e,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const i=Bn(o,r),l=xt((r==null?void 0:r.in)||e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const c=Bn(l,r);return+t>=+i?n+1:+t>=+c?n:n-1}function HO(e,r){var i,l,c,u;const t=uo(),n=(r==null?void 0:r.firstWeekContainsDate)??((l=(i=r==null?void 0:r.locale)==null?void 0:i.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,a=Oh(e,r),s=xt((r==null?void 0:r.in)||e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),Bn(s,r)}function kk(e,r){const t=Re(e,r==null?void 0:r.in),n=+Bn(t,r)-+HO(t,r);return Math.round(n/dk)+1}function ht(e,r){const t=e<0?"-":"",n=Math.abs(e).toString().padStart(r,"0");return t+n}const za={y(e,r){const t=e.getFullYear(),n=t>0?t:1-t;return ht(r==="yy"?n%100:n,r.length)},M(e,r){const t=e.getMonth();return r==="M"?String(t+1):ht(t+1,2)},d(e,r){return ht(e.getDate(),r.length)},a(e,r){const t=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,r){return ht(e.getHours()%12||12,r.length)},H(e,r){return ht(e.getHours(),r.length)},m(e,r){return ht(e.getMinutes(),r.length)},s(e,r){return ht(e.getSeconds(),r.length)},S(e,r){const t=r.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,t-3));return ht(a,r.length)}},mo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},mg={G:function(e,r,t){const n=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(e,r,t){if(r==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return t.ordinalNumber(a,{unit:"year"})}return za.y(e,r)},Y:function(e,r,t,n){const a=Oh(e,n),s=a>0?a:1-a;if(r==="YY"){const o=s%100;return ht(o,2)}return r==="Yo"?t.ordinalNumber(s,{unit:"year"}):ht(s,r.length)},R:function(e,r){const t=hk(e);return ht(t,r.length)},u:function(e,r){const t=e.getFullYear();return ht(t,r.length)},Q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return ht(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return ht(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,r,t){const n=e.getMonth();switch(r){case"M":case"MM":return za.M(e,r);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(e,r,t){const n=e.getMonth();switch(r){case"L":return String(n+1);case"LL":return ht(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(e,r,t,n){const a=kk(e,n);return r==="wo"?t.ordinalNumber(a,{unit:"week"}):ht(a,r.length)},I:function(e,r,t){const n=Ah(e);return r==="Io"?t.ordinalNumber(n,{unit:"week"}):ht(n,r.length)},d:function(e,r,t){return r==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):za.d(e,r)},D:function(e,r,t){const n=$O(e);return r==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):ht(n,r.length)},E:function(e,r,t){const n=e.getDay();switch(r){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(e,r,t,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(s);case"ee":return ht(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,t,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(s);case"cc":return ht(s,r.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,t){const n=e.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return ht(a,r.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(e,r,t){const a=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,t){const n=e.getHours();let a;switch(n===12?a=mo.noon:n===0?a=mo.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,t){const n=e.getHours();let a;switch(n>=17?a=mo.evening:n>=12?a=mo.afternoon:n>=4?a=mo.morning:a=mo.night,r){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,t){if(r==="ho"){let n=e.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return za.h(e,r)},H:function(e,r,t){return r==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):za.H(e,r)},K:function(e,r,t){const n=e.getHours()%12;return r==="Ko"?t.ordinalNumber(n,{unit:"hour"}):ht(n,r.length)},k:function(e,r,t){let n=e.getHours();return n===0&&(n=24),r==="ko"?t.ordinalNumber(n,{unit:"hour"}):ht(n,r.length)},m:function(e,r,t){return r==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):za.m(e,r)},s:function(e,r,t){return r==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):za.s(e,r)},S:function(e,r){return za.S(e,r)},X:function(e,r,t){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return gg(n);case"XXXX":case"XX":return Ss(n);case"XXXXX":case"XXX":default:return Ss(n,":")}},x:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"x":return gg(n);case"xxxx":case"xx":return Ss(n);case"xxxxx":case"xxx":default:return Ss(n,":")}},O:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+xg(n,":");case"OOOO":default:return"GMT"+Ss(n,":")}},z:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+xg(n,":");case"zzzz":default:return"GMT"+Ss(n,":")}},t:function(e,r,t){const n=Math.trunc(+e/1e3);return ht(n,r.length)},T:function(e,r,t){return ht(+e,r.length)}};function xg(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?t+String(a):t+String(a)+r+ht(s,2)}function gg(e,r){return e%60===0?(e>0?"-":"+")+ht(Math.abs(e)/60,2):Ss(e,r)}function Ss(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=ht(Math.trunc(n/60),2),s=ht(n%60,2);return t+a+r+s}const vg=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},_k=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},YO=(e,r)=>{const t=e.match(/(P+)(p+)?/)||[],n=t[1],a=t[2];if(!a)return vg(e,r);let s;switch(n){case"P":s=r.dateTime({width:"short"});break;case"PP":s=r.dateTime({width:"medium"});break;case"PPP":s=r.dateTime({width:"long"});break;case"PPPP":default:s=r.dateTime({width:"full"});break}return s.replace("{{date}}",vg(n,r)).replace("{{time}}",_k(a,r))},Yd={p:_k,P:YO},VO=/^D+$/,KO=/^Y+$/,GO=["D","DD","YY","YYYY"];function XO(e){return VO.test(e)}function QO(e){return KO.test(e)}function qO(e,r,t){const n=ZO(e,r,t);if(console.warn(n),GO.includes(e))throw new RangeError(n)}function ZO(e,r,t){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const JO=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,eP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tP=/^'([^]*?)'?$/,rP=/''/g,nP=/[a-zA-Z]/;function yg(e,r,t){var u,d,p,h,x,m,y,g;const n=uo(),a=(t==null?void 0:t.locale)??n.locale??wk,s=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(p=n.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,o=(t==null?void 0:t.weekStartsOn)??((m=(x=t==null?void 0:t.locale)==null?void 0:x.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((g=(y=n.locale)==null?void 0:y.options)==null?void 0:g.weekStartsOn)??0,i=Re(e,t==null?void 0:t.in);if(!$u(i))throw new RangeError("Invalid time value");let l=r.match(eP).map(w=>{const v=w[0];if(v==="p"||v==="P"){const b=Yd[v];return b(w,a.formatLong)}return w}).join("").match(JO).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const v=w[0];if(v==="'")return{isToken:!1,value:aP(w)};if(mg[v])return{isToken:!0,value:w};if(v.match(nP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:w}});a.localize.preprocessor&&(l=a.localize.preprocessor(i,l));const c={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return l.map(w=>{if(!w.isToken)return w.value;const v=w.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&QO(v)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&XO(v))&&qO(v,r,String(e));const b=mg[v[0]];return b(i,v,a.localize,c)}).join("")}function aP(e){const r=e.match(tP);return r?r[1].replace(rP,"'"):e}function wg(e,r){return Re(e,r==null?void 0:r.in).getDate()}function sP(e,r){return Re(e,r==null?void 0:r.in).getDay()}function oP(e,r){const t=Re(e,r==null?void 0:r.in),n=t.getFullYear(),a=t.getMonth(),s=xt(t,0);return s.setFullYear(n,a+1,0),s.setHours(0,0,0,0),s.getDate()}function iP(){return Object.assign({},uo())}function Sa(e,r){return Re(e,r==null?void 0:r.in).getHours()}function lP(e,r){const t=Re(e,r==null?void 0:r.in).getDay();return t===0?7:t}function Ta(e,r){return Re(e,r==null?void 0:r.in).getMinutes()}function Ir(e,r){return Re(e,r==null?void 0:r.in).getMonth()}function is(e){return Re(e).getSeconds()}function Vd(e){return+Re(e)}function Xe(e,r){return Re(e,r==null?void 0:r.in).getFullYear()}function ps(e,r){return+Re(e)>+Re(r)}function Js(e,r){return+Re(e)<+Re(r)}function cP(e,r){return+Re(e)==+Re(r)}function uP(e,r){const t=fP(r)?new r(0):xt(r,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function fP(e){var r;return typeof e=="function"&&((r=e.prototype)==null?void 0:r.constructor)===e}const dP=10;class bk{constructor(){Ae(this,"subPriority",0)}validate(r,t){return!0}}class pP extends bk{constructor(r,t,n,a,s){super(),this.value=r,this.validateValue=t,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(r,t){return this.validateValue(r,this.value,t)}set(r,t,n){return this.setValue(r,t,this.value,n)}}class hP extends bk{constructor(t,n){super();Ae(this,"priority",dP);Ae(this,"subPriority",-1);this.context=t||(a=>xt(n,a))}set(t,n){return n.timestampIsSet?t:xt(t,uP(t,this.context))}}class ut{run(r,t,n,a){const s=this.parse(r,t,n,a);return s?{setter:new pP(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(r,t,n){return!0}}class mP extends ut{constructor(){super(...arguments);Ae(this,"priority",140);Ae(this,"incompatibleTokens",["R","u","t","T"])}parse(t,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"});case"GGGGG":return a.era(t,{width:"narrow"});case"GGGG":default:return a.era(t,{width:"wide"})||a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"})}}set(t,n,a){return n.era=a,t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}const Ht={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Jn={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Yt(e,r){return e&&{value:r(e.value),rest:e.rest}}function Mt(e,r){const t=r.match(e);return t?{value:parseInt(t[0],10),rest:r.slice(t[0].length)}:null}function ea(e,r){const t=r.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:r.slice(1)};const n=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:n*(a*C0+s*T0+o*aO),rest:r.slice(t[0].length)}}function Ek(e){return Mt(Ht.anyDigitsSigned,e)}function Bt(e,r){switch(e){case 1:return Mt(Ht.singleDigit,r);case 2:return Mt(Ht.twoDigits,r);case 3:return Mt(Ht.threeDigits,r);case 4:return Mt(Ht.fourDigits,r);default:return Mt(new RegExp("^\\d{1,"+e+"}"),r)}}function Ku(e,r){switch(e){case 1:return Mt(Ht.singleDigitSigned,r);case 2:return Mt(Ht.twoDigitsSigned,r);case 3:return Mt(Ht.threeDigitsSigned,r);case 4:return Mt(Ht.fourDigitsSigned,r);default:return Mt(new RegExp("^-?\\d{1,"+e+"}"),r)}}function Ph(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Sk(e,r){const t=r>0,n=t?r:1-r;let a;if(n<=50)a=e||100;else{const s=n+50,o=Math.trunc(s/100)*100,i=e>=s%100;a=e+o-(i?100:0)}return t?a:1-a}function Tk(e){return e%400===0||e%4===0&&e%100!==0}class xP extends ut{constructor(){super(...arguments);Ae(this,"priority",130);Ae(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return Yt(Bt(4,t),s);case"yo":return Yt(a.ordinalNumber(t,{unit:"year"}),s);default:return Yt(Bt(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a){const s=t.getFullYear();if(a.isTwoDigitYear){const i=Sk(a.year,s);return t.setFullYear(i,0,1),t.setHours(0,0,0,0),t}const o=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}}class gP extends ut{constructor(){super(...arguments);Ae(this,"priority",130);Ae(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Yt(Bt(4,t),s);case"Yo":return Yt(a.ordinalNumber(t,{unit:"year"}),s);default:return Yt(Bt(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a,s){const o=Oh(t,s);if(a.isTwoDigitYear){const l=Sk(a.year,o);return t.setFullYear(l,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),Bn(t,s)}const i=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(i,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),Bn(t,s)}}class vP extends ut{constructor(){super(...arguments);Ae(this,"priority",130);Ae(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,n){return Ku(n==="R"?4:n.length,t)}set(t,n,a){const s=xt(t,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),ri(s)}}class yP extends ut{constructor(){super(...arguments);Ae(this,"priority",130);Ae(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,n){return Ku(n==="u"?4:n.length,t)}set(t,n,a){return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class wP extends ut{constructor(){super(...arguments);Ae(this,"priority",120);Ae(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"Q":case"QQ":return Bt(n.length,t);case"Qo":return a.ordinalNumber(t,{unit:"quarter"});case"QQQ":return a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(t,{width:"wide",context:"formatting"})||a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class kP extends ut{constructor(){super(...arguments);Ae(this,"priority",120);Ae(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"q":case"qq":return Bt(n.length,t);case"qo":return a.ordinalNumber(t,{unit:"quarter"});case"qqq":return a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(t,{width:"wide",context:"standalone"})||a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class _P extends ut{constructor(){super(...arguments);Ae(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Ae(this,"priority",110)}parse(t,n,a){const s=o=>o-1;switch(n){case"M":return Yt(Mt(Ht.month,t),s);case"MM":return Yt(Bt(2,t),s);case"Mo":return Yt(a.ordinalNumber(t,{unit:"month"}),s);case"MMM":return a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(t,{width:"wide",context:"formatting"})||a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}class bP extends ut{constructor(){super(...arguments);Ae(this,"priority",110);Ae(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,n,a){const s=o=>o-1;switch(n){case"L":return Yt(Mt(Ht.month,t),s);case"LL":return Yt(Bt(2,t),s);case"Lo":return Yt(a.ordinalNumber(t,{unit:"month"}),s);case"LLL":return a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(t,{width:"wide",context:"standalone"})||a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}function EP(e,r,t){const n=Re(e,t==null?void 0:t.in),a=kk(n,t)-r;return n.setDate(n.getDate()-a*7),Re(n,t==null?void 0:t.in)}class SP extends ut{constructor(){super(...arguments);Ae(this,"priority",100);Ae(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,n,a){switch(n){case"w":return Mt(Ht.week,t);case"wo":return a.ordinalNumber(t,{unit:"week"});default:return Bt(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a,s){return Bn(EP(t,a,s),s)}}function TP(e,r,t){const n=Re(e,t==null?void 0:t.in),a=Ah(n,t)-r;return n.setDate(n.getDate()-a*7),n}class CP extends ut{constructor(){super(...arguments);Ae(this,"priority",100);Ae(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,n,a){switch(n){case"I":return Mt(Ht.week,t);case"Io":return a.ordinalNumber(t,{unit:"week"});default:return Bt(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a){return ri(TP(t,a))}}const DP=[31,28,31,30,31,30,31,31,30,31,30,31],NP=[31,29,31,30,31,30,31,31,30,31,30,31];class FP extends ut{constructor(){super(...arguments);Ae(this,"priority",90);Ae(this,"subPriority",1);Ae(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"d":return Mt(Ht.date,t);case"do":return a.ordinalNumber(t,{unit:"date"});default:return Bt(n.length,t)}}validate(t,n){const a=t.getFullYear(),s=Tk(a),o=t.getMonth();return s?n>=1&&n<=NP[o]:n>=1&&n<=DP[o]}set(t,n,a){return t.setDate(a),t.setHours(0,0,0,0),t}}class AP extends ut{constructor(){super(...arguments);Ae(this,"priority",90);Ae(this,"subpriority",1);Ae(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,n,a){switch(n){case"D":case"DD":return Mt(Ht.dayOfYear,t);case"Do":return a.ordinalNumber(t,{unit:"date"});default:return Bt(n.length,t)}}validate(t,n){const a=t.getFullYear();return Tk(a)?n>=1&&n<=366:n>=1&&n<=365}set(t,n,a){return t.setMonth(0,a),t.setHours(0,0,0,0),t}}function Mh(e,r,t){var d,p,h,x;const n=uo(),a=(t==null?void 0:t.weekStartsOn)??((p=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:p.weekStartsOn)??n.weekStartsOn??((x=(h=n.locale)==null?void 0:h.options)==null?void 0:x.weekStartsOn)??0,s=Re(e,t==null?void 0:t.in),o=s.getDay(),l=(r%7+7)%7,c=7-a,u=r<0||r>6?r-(o+c)%7:(l+c)%7-(o+c)%7;return jn(s,u,t)}class OP extends ut{constructor(){super(...arguments);Ae(this,"priority",90);Ae(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Mh(t,a,s),t.setHours(0,0,0,0),t}}class PP extends ut{constructor(){super(...arguments);Ae(this,"priority",90);Ae(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,n,a,s){const o=i=>{const l=Math.floor((i-1)/7)*7;return(i+s.weekStartsOn+6)%7+l};switch(n){case"e":case"ee":return Yt(Bt(n.length,t),o);case"eo":return Yt(a.ordinalNumber(t,{unit:"day"}),o);case"eee":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeeee":return a.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Mh(t,a,s),t.setHours(0,0,0,0),t}}class MP extends ut{constructor(){super(...arguments);Ae(this,"priority",90);Ae(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,n,a,s){const o=i=>{const l=Math.floor((i-1)/7)*7;return(i+s.weekStartsOn+6)%7+l};switch(n){case"c":case"cc":return Yt(Bt(n.length,t),o);case"co":return Yt(a.ordinalNumber(t,{unit:"day"}),o);case"ccc":return a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"ccccc":return a.day(t,{width:"narrow",context:"standalone"});case"cccccc":return a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(t,{width:"wide",context:"standalone"})||a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,s){return t=Mh(t,a,s),t.setHours(0,0,0,0),t}}function RP(e,r,t){const n=Re(e,t==null?void 0:t.in),a=lP(n,t),s=r-a;return jn(n,s,t)}class IP extends ut{constructor(){super(...arguments);Ae(this,"priority",90);Ae(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return Bt(n.length,t);case"io":return a.ordinalNumber(t,{unit:"day"});case"iii":return Yt(a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiii":return Yt(a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Yt(a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Yt(a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s)}}validate(t,n){return n>=1&&n<=7}set(t,n,a){return t=RP(t,a),t.setHours(0,0,0,0),t}}class jP extends ut{constructor(){super(...arguments);Ae(this,"priority",80);Ae(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(Ph(a),0,0,0),t}}class LP extends ut{constructor(){super(...arguments);Ae(this,"priority",80);Ae(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(Ph(a),0,0,0),t}}class zP extends ut{constructor(){super(...arguments);Ae(this,"priority",80);Ae(this,"incompatibleTokens",["a","b","t","T"])}parse(t,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(Ph(a),0,0,0),t}}class BP extends ut{constructor(){super(...arguments);Ae(this,"priority",70);Ae(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,n,a){switch(n){case"h":return Mt(Ht.hour12h,t);case"ho":return a.ordinalNumber(t,{unit:"hour"});default:return Bt(n.length,t)}}validate(t,n){return n>=1&&n<=12}set(t,n,a){const s=t.getHours()>=12;return s&&a<12?t.setHours(a+12,0,0,0):!s&&a===12?t.setHours(0,0,0,0):t.setHours(a,0,0,0),t}}class WP extends ut{constructor(){super(...arguments);Ae(this,"priority",70);Ae(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,n,a){switch(n){case"H":return Mt(Ht.hour23h,t);case"Ho":return a.ordinalNumber(t,{unit:"hour"});default:return Bt(n.length,t)}}validate(t,n){return n>=0&&n<=23}set(t,n,a){return t.setHours(a,0,0,0),t}}class UP extends ut{constructor(){super(...arguments);Ae(this,"priority",70);Ae(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,n,a){switch(n){case"K":return Mt(Ht.hour11h,t);case"Ko":return a.ordinalNumber(t,{unit:"hour"});default:return Bt(n.length,t)}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.getHours()>=12&&a<12?t.setHours(a+12,0,0,0):t.setHours(a,0,0,0),t}}class $P extends ut{constructor(){super(...arguments);Ae(this,"priority",70);Ae(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,n,a){switch(n){case"k":return Mt(Ht.hour24h,t);case"ko":return a.ordinalNumber(t,{unit:"hour"});default:return Bt(n.length,t)}}validate(t,n){return n>=1&&n<=24}set(t,n,a){const s=a<=24?a%24:a;return t.setHours(s,0,0,0),t}}class HP extends ut{constructor(){super(...arguments);Ae(this,"priority",60);Ae(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"m":return Mt(Ht.minute,t);case"mo":return a.ordinalNumber(t,{unit:"minute"});default:return Bt(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setMinutes(a,0,0),t}}class YP extends ut{constructor(){super(...arguments);Ae(this,"priority",50);Ae(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"s":return Mt(Ht.second,t);case"so":return a.ordinalNumber(t,{unit:"second"});default:return Bt(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setSeconds(a,0),t}}class VP extends ut{constructor(){super(...arguments);Ae(this,"priority",30);Ae(this,"incompatibleTokens",["t","T"])}parse(t,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return Yt(Bt(n.length,t),a)}set(t,n,a){return t.setMilliseconds(a),t}}class KP extends ut{constructor(){super(...arguments);Ae(this,"priority",10);Ae(this,"incompatibleTokens",["t","T","x"])}parse(t,n){switch(n){case"X":return ea(Jn.basicOptionalMinutes,t);case"XX":return ea(Jn.basic,t);case"XXXX":return ea(Jn.basicOptionalSeconds,t);case"XXXXX":return ea(Jn.extendedOptionalSeconds,t);case"XXX":default:return ea(Jn.extended,t)}}set(t,n,a){return n.timestampIsSet?t:xt(t,t.getTime()-Wu(t)-a)}}class GP extends ut{constructor(){super(...arguments);Ae(this,"priority",10);Ae(this,"incompatibleTokens",["t","T","X"])}parse(t,n){switch(n){case"x":return ea(Jn.basicOptionalMinutes,t);case"xx":return ea(Jn.basic,t);case"xxxx":return ea(Jn.basicOptionalSeconds,t);case"xxxxx":return ea(Jn.extendedOptionalSeconds,t);case"xxx":default:return ea(Jn.extended,t)}}set(t,n,a){return n.timestampIsSet?t:xt(t,t.getTime()-Wu(t)-a)}}class XP extends ut{constructor(){super(...arguments);Ae(this,"priority",40);Ae(this,"incompatibleTokens","*")}parse(t){return Ek(t)}set(t,n,a){return[xt(t,a*1e3),{timestampIsSet:!0}]}}class QP extends ut{constructor(){super(...arguments);Ae(this,"priority",20);Ae(this,"incompatibleTokens","*")}parse(t){return Ek(t)}set(t,n,a){return[xt(t,a),{timestampIsSet:!0}]}}const qP={G:new mP,y:new xP,Y:new gP,R:new vP,u:new yP,Q:new wP,q:new kP,M:new _P,L:new bP,w:new SP,I:new CP,d:new FP,D:new AP,E:new OP,e:new PP,c:new MP,i:new IP,a:new jP,b:new LP,B:new zP,h:new BP,H:new WP,K:new UP,k:new $P,m:new HP,s:new YP,S:new VP,X:new KP,x:new GP,t:new XP,T:new QP},ZP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,JP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eM=/^'([^]*?)'?$/,tM=/''/g,rM=/\S/,nM=/[a-zA-Z]/;function aM(e,r,t,n){var y,g,w,v,b,M,C,k;const a=()=>xt((n==null?void 0:n.in)||t,NaN),s=iP(),o=(n==null?void 0:n.locale)??s.locale??wk,i=(n==null?void 0:n.firstWeekContainsDate)??((g=(y=n==null?void 0:n.locale)==null?void 0:y.options)==null?void 0:g.firstWeekContainsDate)??s.firstWeekContainsDate??((v=(w=s.locale)==null?void 0:w.options)==null?void 0:v.firstWeekContainsDate)??1,l=(n==null?void 0:n.weekStartsOn)??((M=(b=n==null?void 0:n.locale)==null?void 0:b.options)==null?void 0:M.weekStartsOn)??s.weekStartsOn??((k=(C=s.locale)==null?void 0:C.options)==null?void 0:k.weekStartsOn)??0;if(!r)return e?a():Re(t,n==null?void 0:n.in);const c={firstWeekContainsDate:i,weekStartsOn:l,locale:o},u=[new hP(n==null?void 0:n.in,t)],d=r.match(JP).map(F=>{const E=F[0];if(E in Yd){const j=Yd[E];return j(F,o.formatLong)}return F}).join("").match(ZP),p=[];for(let F of d){const E=F[0],j=qP[E];if(j){const{incompatibleTokens:V}=j;if(Array.isArray(V)){const te=p.find(ee=>V.includes(ee.token)||ee.token===E);if(te)throw new RangeError(`The format string mustn't contain \`${te.fullToken}\` and \`${F}\` at the same time`)}else if(j.incompatibleTokens==="*"&&p.length>0)throw new RangeError(`The format string mustn't contain \`${F}\` and any other token at the same time`);p.push({token:E,fullToken:F});const W=j.run(e,F,o.match,c);if(!W)return a();u.push(W.setter),e=W.rest}else{if(E.match(nM))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");if(F==="''"?F="'":E==="'"&&(F=sM(F)),e.indexOf(F)===0)e=e.slice(F.length);else return a()}}if(e.length>0&&rM.test(e))return a();const h=u.map(F=>F.priority).sort((F,E)=>E-F).filter((F,E,j)=>j.indexOf(F)===E).map(F=>u.filter(E=>E.priority===F).sort((E,j)=>j.subPriority-E.subPriority)).map(F=>F[0]);let x=Re(t,n==null?void 0:n.in);if(isNaN(+x))return a();const m={};for(const F of h){if(!F.validate(x,c))return a();const E=F.set(x,m,c);Array.isArray(E)?(x=E[0],Object.assign(m,E[1])):x=E}return x}function sM(e){return e.match(eM)[1].replace(tM,"'")}function oM(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r);return+Bn(n,t)==+Bn(a,t)}function iM(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function lM(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r);return+Hd(n)==+Hd(a)}function cM(e,r,t){const[n,a]=ca(t==null?void 0:t.in,e,r);return n.getFullYear()===a.getFullYear()}function Il(e,r,t){const n=+Re(e,t==null?void 0:t.in),[a,s]=[+Re(r.start,t==null?void 0:t.in),+Re(r.end,t==null?void 0:t.in)].sort((o,i)=>o-i);return n>=a&&n<=s}function uM(e,r,t){return jn(e,-1,t)}function fM(e,r){const t=()=>xt(r==null?void 0:r.in,NaN),a=mM(e);let s;if(a.date){const c=xM(a.date,2);s=gM(c.restDateString,c.year)}if(!s||isNaN(+s))return t();const o=+s;let i=0,l;if(a.time&&(i=vM(a.time),isNaN(i)))return t();if(a.timezone){if(l=yM(a.timezone),isNaN(l))return t()}else{const c=new Date(o+i),u=Re(0,r==null?void 0:r.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return Re(o+i+l,r==null?void 0:r.in)}const Fc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},dM=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,pM=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,hM=/^([+-])(\d{2})(?::?(\d{2}))?$/;function mM(e){const r={},t=e.split(Fc.dateTimeDelimiter);let n;if(t.length>2)return r;if(/:/.test(t[0])?n=t[0]:(r.date=t[0],n=t[1],Fc.timeZoneDelimiter.test(r.date)&&(r.date=e.split(Fc.timeZoneDelimiter)[0],n=e.substr(r.date.length,e.length))),n){const a=Fc.timezone.exec(n);a?(r.time=n.replace(a[1],""),r.timezone=a[1]):r.time=n}return r}function xM(e,r){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function gM(e,r){if(r===null)return new Date(NaN);const t=e.match(dM);if(!t)return new Date(NaN);const n=!!t[4],a=Fi(t[1]),s=Fi(t[2])-1,o=Fi(t[3]),i=Fi(t[4]),l=Fi(t[5])-1;if(n)return EM(r,i,l)?wM(r,i,l):new Date(NaN);{const c=new Date(0);return!_M(r,s,o)||!bM(r,a)?new Date(NaN):(c.setUTCFullYear(r,s,Math.max(a,o)),c)}}function Fi(e){return e?parseInt(e):1}function vM(e){const r=e.match(pM);if(!r)return NaN;const t=yf(r[1]),n=yf(r[2]),a=yf(r[3]);return SM(t,n,a)?t*C0+n*T0+a*1e3:NaN}function yf(e){return e&&parseFloat(e.replace(",","."))||0}function yM(e){if(e==="Z")return 0;const r=e.match(hM);if(!r)return 0;const t=r[1]==="+"?-1:1,n=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return TM(n,a)?t*(n*C0+a*T0):NaN}function wM(e,r,t){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(r-1)*7+t+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const kM=[31,null,31,30,31,30,31,31,30,31,30,31];function Ck(e){return e%400===0||e%4===0&&e%100!==0}function _M(e,r,t){return r>=0&&r<=11&&t>=1&&t<=(kM[r]||(Ck(e)?29:28))}function bM(e,r){return r>=1&&r<=(Ck(e)?366:365)}function EM(e,r,t){return r>=1&&r<=53&&t>=0&&t<=6}function SM(e,r,t){return e===24?r===0&&t===0:t>=0&&t<60&&r>=0&&r<60&&e>=0&&e<25}function TM(e,r){return r>=0&&r<=59}function dn(e,r,t){const n=Re(e,t==null?void 0:t.in),a=n.getFullYear(),s=n.getDate(),o=xt(e,0);o.setFullYear(a,r,15),o.setHours(0,0,0,0);const i=oP(o);return n.setMonth(r,Math.min(s,i)),n}function Qc(e,r,t){const n=Re(e,t==null?void 0:t.in);return n.setHours(r),n}function qc(e,r,t){const n=Re(e,t==null?void 0:t.in);return n.setMinutes(r),n}function vo(e,r,t){const n=Re(e,t==null?void 0:t.in),a=Math.trunc(n.getMonth()/3)+1,s=r-a;return dn(n,n.getMonth()+s*3)}function Zc(e,r,t){const n=Re(e,t==null?void 0:t.in);return n.setSeconds(r),n}function Gn(e,r,t){const n=Re(e,t==null?void 0:t.in);return isNaN(+n)?xt(e,NaN):(n.setFullYear(r),n)}function Bs(e,r,t){return zn(e,-r,t)}function Dk(e,r,t){return Fh(e,-1,t)}function kg(e,r,t){return Uu(e,-1,t)}function ai(e,r,t){return ba(e,-r,t)}function N0(){return typeof window<"u"}function xi(e){return Nk(e)?(e.nodeName||"").toLowerCase():"#document"}function en(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function ua(e){var r;return(r=(Nk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function Nk(e){return N0()?e instanceof Node||e instanceof en(e).Node:!1}function jr(e){return N0()?e instanceof Element||e instanceof en(e).Element:!1}function oa(e){return N0()?e instanceof HTMLElement||e instanceof en(e).HTMLElement:!1}function _g(e){return!N0()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof en(e).ShadowRoot}function ql(e){const{overflow:r,overflowX:t,overflowY:n,display:a}=kn(e);return/auto|scroll|overlay|hidden|clip/.test(r+n+t)&&!["inline","contents"].includes(a)}function CM(e){return["table","td","th"].includes(xi(e))}function F0(e){return[":popover-open",":modal"].some(r=>{try{return e.matches(r)}catch{return!1}})}function Rh(e){const r=Ih(),t=jr(e)?kn(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!r&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!r&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function DM(e){let r=hs(e);for(;oa(r)&&!si(r);){if(Rh(r))return r;if(F0(r))return null;r=hs(r)}return null}function Ih(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function si(e){return["html","body","#document"].includes(xi(e))}function kn(e){return en(e).getComputedStyle(e)}function A0(e){return jr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function hs(e){if(xi(e)==="html")return e;const r=e.assignedSlot||e.parentNode||_g(e)&&e.host||ua(e);return _g(r)?r.host:r}function Fk(e){const r=hs(e);return si(r)?e.ownerDocument?e.ownerDocument.body:e.body:oa(r)&&ql(r)?r:Fk(r)}function jl(e,r,t){var n;r===void 0&&(r=[]),t===void 0&&(t=!0);const a=Fk(e),s=a===((n=e.ownerDocument)==null?void 0:n.body),o=en(a);if(s){const i=Kd(o);return r.concat(o,o.visualViewport||[],ql(a)?a:[],i&&t?jl(i):[])}return r.concat(a,jl(a,[],t))}function Kd(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const oi=Math.min,Ws=Math.max,Gu=Math.round,Ac=Math.floor,aa=e=>({x:e,y:e}),NM={left:"right",right:"left",bottom:"top",top:"bottom"},FM={start:"end",end:"start"};function Gd(e,r,t){return Ws(e,oi(r,t))}function Zl(e,r){return typeof e=="function"?e(r):e}function eo(e){return e.split("-")[0]}function Jl(e){return e.split("-")[1]}function Ak(e){return e==="x"?"y":"x"}function jh(e){return e==="y"?"height":"width"}function Us(e){return["top","bottom"].includes(eo(e))?"y":"x"}function Lh(e){return Ak(Us(e))}function AM(e,r,t){t===void 0&&(t=!1);const n=Jl(e),a=Lh(e),s=jh(a);let o=a==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return r.reference[s]>r.floating[s]&&(o=Xu(o)),[o,Xu(o)]}function OM(e){const r=Xu(e);return[Xd(e),r,Xd(r)]}function Xd(e){return e.replace(/start|end/g,r=>FM[r])}function PM(e,r,t){const n=["left","right"],a=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return t?r?a:n:r?n:a;case"left":case"right":return r?s:o;default:return[]}}function MM(e,r,t,n){const a=Jl(e);let s=PM(eo(e),t==="start",n);return a&&(s=s.map(o=>o+"-"+a),r&&(s=s.concat(s.map(Xd)))),s}function Xu(e){return e.replace(/left|right|bottom|top/g,r=>NM[r])}function RM(e){return{top:0,right:0,bottom:0,left:0,...e}}function Ok(e){return typeof e!="number"?RM(e):{top:e,right:e,bottom:e,left:e}}function Qu(e){const{x:r,y:t,width:n,height:a}=e;return{width:n,height:a,top:t,left:r,right:r+n,bottom:t+a,x:r,y:t}}var qu=typeof document<"u"?S.useLayoutEffect:S.useEffect;const IM={...mv},jM=IM.useInsertionEffect,LM=jM||(e=>e());function zM(e){const r=S.useRef(()=>{});return LM(()=>{r.current=e}),S.useCallback(function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return r.current==null?void 0:r.current(...n)},[])}function bg(e,r,t){let{reference:n,floating:a}=e;const s=Us(r),o=Lh(r),i=jh(o),l=eo(r),c=s==="y",u=n.x+n.width/2-a.width/2,d=n.y+n.height/2-a.height/2,p=n[i]/2-a[i]/2;let h;switch(l){case"top":h={x:u,y:n.y-a.height};break;case"bottom":h={x:u,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:d};break;case"left":h={x:n.x-a.width,y:d};break;default:h={x:n.x,y:n.y}}switch(Jl(r)){case"start":h[o]-=p*(t&&c?-1:1);break;case"end":h[o]+=p*(t&&c?-1:1);break}return h}const BM=async(e,r,t)=>{const{placement:n="bottom",strategy:a="absolute",middleware:s=[],platform:o}=t,i=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(r));let c=await o.getElementRects({reference:e,floating:r,strategy:a}),{x:u,y:d}=bg(c,n,l),p=n,h={},x=0;for(let m=0;m<i.length;m++){const{name:y,fn:g}=i[m],{x:w,y:v,data:b,reset:M}=await g({x:u,y:d,initialPlacement:n,placement:p,strategy:a,middlewareData:h,rects:c,platform:o,elements:{reference:e,floating:r}});u=w??u,d=v??d,h={...h,[y]:{...h[y],...b}},M&&x<=50&&(x++,typeof M=="object"&&(M.placement&&(p=M.placement),M.rects&&(c=M.rects===!0?await o.getElementRects({reference:e,floating:r,strategy:a}):M.rects),{x:u,y:d}=bg(c,p,l)),m=-1)}return{x:u,y:d,placement:p,strategy:a,middlewareData:h}};async function Pk(e,r){var t;r===void 0&&(r={});const{x:n,y:a,platform:s,rects:o,elements:i,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:h=0}=Zl(r,e),x=Ok(h),y=i[p?d==="floating"?"reference":"floating":d],g=Qu(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(y)))==null||t?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(i.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,v=await(s.getOffsetParent==null?void 0:s.getOffsetParent(i.floating)),b=await(s.isElement==null?void 0:s.isElement(v))?await(s.getScale==null?void 0:s.getScale(v))||{x:1,y:1}:{x:1,y:1},M=Qu(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:w,offsetParent:v,strategy:l}):w);return{top:(g.top-M.top+x.top)/b.y,bottom:(M.bottom-g.bottom+x.bottom)/b.y,left:(g.left-M.left+x.left)/b.x,right:(M.right-g.right+x.right)/b.x}}const WM=e=>({name:"arrow",options:e,async fn(r){const{x:t,y:n,placement:a,rects:s,platform:o,elements:i,middlewareData:l}=r,{element:c,padding:u=0}=Zl(e,r)||{};if(c==null)return{};const d=Ok(u),p={x:t,y:n},h=Lh(a),x=jh(h),m=await o.getDimensions(c),y=h==="y",g=y?"top":"left",w=y?"bottom":"right",v=y?"clientHeight":"clientWidth",b=s.reference[x]+s.reference[h]-p[h]-s.floating[x],M=p[h]-s.reference[h],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let k=C?C[v]:0;(!k||!await(o.isElement==null?void 0:o.isElement(C)))&&(k=i.floating[v]||s.floating[x]);const F=b/2-M/2,E=k/2-m[x]/2-1,j=oi(d[g],E),V=oi(d[w],E),W=j,te=k-m[x]-V,ee=k/2-m[x]/2+F,J=Gd(W,ee,te),ne=!l.arrow&&Jl(a)!=null&&ee!==J&&s.reference[x]/2-(ee<W?j:V)-m[x]/2<0,B=ne?ee<W?ee-W:ee-te:0;return{[h]:p[h]+B,data:{[h]:J,centerOffset:ee-J-B,...ne&&{alignmentOffset:B}},reset:ne}}}),UM=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(r){var t,n;const{placement:a,middlewareData:s,rects:o,initialPlacement:i,platform:l,elements:c}=r,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:m=!0,...y}=Zl(e,r);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const g=eo(a),w=Us(i),v=eo(i)===i,b=await(l.isRTL==null?void 0:l.isRTL(c.floating)),M=p||(v||!m?[Xu(i)]:OM(i)),C=x!=="none";!p&&C&&M.push(...MM(i,m,x,b));const k=[i,...M],F=await Pk(r,y),E=[];let j=((n=s.flip)==null?void 0:n.overflows)||[];if(u&&E.push(F[g]),d){const J=AM(a,o,b);E.push(F[J[0]],F[J[1]])}if(j=[...j,{placement:a,overflows:E}],!E.every(J=>J<=0)){var V,W;const J=(((V=s.flip)==null?void 0:V.index)||0)+1,ne=k[J];if(ne){var te;const q=d==="alignment"?w!==Us(ne):!1,N=((te=j[0])==null?void 0:te.overflows[0])>0;if(!q||N)return{data:{index:J,overflows:j},reset:{placement:ne}}}let B=(W=j.filter(q=>q.overflows[0]<=0).sort((q,N)=>q.overflows[1]-N.overflows[1])[0])==null?void 0:W.placement;if(!B)switch(h){case"bestFit":{var ee;const q=(ee=j.filter(N=>{if(C){const U=Us(N.placement);return U===w||U==="y"}return!0}).map(N=>[N.placement,N.overflows.filter(U=>U>0).reduce((U,Z)=>U+Z,0)]).sort((N,U)=>N[1]-U[1])[0])==null?void 0:ee[0];q&&(B=q);break}case"initialPlacement":B=i;break}if(a!==B)return{reset:{placement:B}}}return{}}}};async function $M(e,r){const{placement:t,platform:n,elements:a}=e,s=await(n.isRTL==null?void 0:n.isRTL(a.floating)),o=eo(t),i=Jl(t),l=Us(t)==="y",c=["left","top"].includes(o)?-1:1,u=s&&l?-1:1,d=Zl(r,e);let{mainAxis:p,crossAxis:h,alignmentAxis:x}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return i&&typeof x=="number"&&(h=i==="end"?x*-1:x),l?{x:h*u,y:p*c}:{x:p*c,y:h*u}}const HM=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var t,n;const{x:a,y:s,placement:o,middlewareData:i}=r,l=await $M(r,e);return o===((t=i.offset)==null?void 0:t.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+l.x,y:s+l.y,data:{...l,placement:o}}}}},YM=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(r){const{x:t,y:n,placement:a}=r,{mainAxis:s=!0,crossAxis:o=!1,limiter:i={fn:y=>{let{x:g,y:w}=y;return{x:g,y:w}}},...l}=Zl(e,r),c={x:t,y:n},u=await Pk(r,l),d=Us(eo(a)),p=Ak(d);let h=c[p],x=c[d];if(s){const y=p==="y"?"top":"left",g=p==="y"?"bottom":"right",w=h+u[y],v=h-u[g];h=Gd(w,h,v)}if(o){const y=d==="y"?"top":"left",g=d==="y"?"bottom":"right",w=x+u[y],v=x-u[g];x=Gd(w,x,v)}const m=i.fn({...r,[p]:h,[d]:x});return{...m,data:{x:m.x-t,y:m.y-n,enabled:{[p]:s,[d]:o}}}}}};function Mk(e){const r=kn(e);let t=parseFloat(r.width)||0,n=parseFloat(r.height)||0;const a=oa(e),s=a?e.offsetWidth:t,o=a?e.offsetHeight:n,i=Gu(t)!==s||Gu(n)!==o;return i&&(t=s,n=o),{width:t,height:n,$:i}}function zh(e){return jr(e)?e:e.contextElement}function $o(e){const r=zh(e);if(!oa(r))return aa(1);const t=r.getBoundingClientRect(),{width:n,height:a,$:s}=Mk(r);let o=(s?Gu(t.width):t.width)/n,i=(s?Gu(t.height):t.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!i||!Number.isFinite(i))&&(i=1),{x:o,y:i}}const VM=aa(0);function Rk(e){const r=en(e);return!Ih()||!r.visualViewport?VM:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function KM(e,r,t){return r===void 0&&(r=!1),!t||r&&t!==en(e)?!1:r}function to(e,r,t,n){r===void 0&&(r=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),s=zh(e);let o=aa(1);r&&(n?jr(n)&&(o=$o(n)):o=$o(e));const i=KM(s,t,n)?Rk(s):aa(0);let l=(a.left+i.x)/o.x,c=(a.top+i.y)/o.y,u=a.width/o.x,d=a.height/o.y;if(s){const p=en(s),h=n&&jr(n)?en(n):n;let x=p,m=Kd(x);for(;m&&n&&h!==x;){const y=$o(m),g=m.getBoundingClientRect(),w=kn(m),v=g.left+(m.clientLeft+parseFloat(w.paddingLeft))*y.x,b=g.top+(m.clientTop+parseFloat(w.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,d*=y.y,l+=v,c+=b,x=en(m),m=Kd(x)}}return Qu({width:u,height:d,x:l,y:c})}function Bh(e,r){const t=A0(e).scrollLeft;return r?r.left+t:to(ua(e)).left+t}function Ik(e,r,t){t===void 0&&(t=!1);const n=e.getBoundingClientRect(),a=n.left+r.scrollLeft-(t?0:Bh(e,n)),s=n.top+r.scrollTop;return{x:a,y:s}}function GM(e){let{elements:r,rect:t,offsetParent:n,strategy:a}=e;const s=a==="fixed",o=ua(n),i=r?F0(r.floating):!1;if(n===o||i&&s)return t;let l={scrollLeft:0,scrollTop:0},c=aa(1);const u=aa(0),d=oa(n);if((d||!d&&!s)&&((xi(n)!=="body"||ql(o))&&(l=A0(n)),oa(n))){const h=to(n);c=$o(n),u.x=h.x+n.clientLeft,u.y=h.y+n.clientTop}const p=o&&!d&&!s?Ik(o,l,!0):aa(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+p.x,y:t.y*c.y-l.scrollTop*c.y+u.y+p.y}}function XM(e){return Array.from(e.getClientRects())}function QM(e){const r=ua(e),t=A0(e),n=e.ownerDocument.body,a=Ws(r.scrollWidth,r.clientWidth,n.scrollWidth,n.clientWidth),s=Ws(r.scrollHeight,r.clientHeight,n.scrollHeight,n.clientHeight);let o=-t.scrollLeft+Bh(e);const i=-t.scrollTop;return kn(n).direction==="rtl"&&(o+=Ws(r.clientWidth,n.clientWidth)-a),{width:a,height:s,x:o,y:i}}function qM(e,r){const t=en(e),n=ua(e),a=t.visualViewport;let s=n.clientWidth,o=n.clientHeight,i=0,l=0;if(a){s=a.width,o=a.height;const c=Ih();(!c||c&&r==="fixed")&&(i=a.offsetLeft,l=a.offsetTop)}return{width:s,height:o,x:i,y:l}}function ZM(e,r){const t=to(e,!0,r==="fixed"),n=t.top+e.clientTop,a=t.left+e.clientLeft,s=oa(e)?$o(e):aa(1),o=e.clientWidth*s.x,i=e.clientHeight*s.y,l=a*s.x,c=n*s.y;return{width:o,height:i,x:l,y:c}}function Eg(e,r,t){let n;if(r==="viewport")n=qM(e,t);else if(r==="document")n=QM(ua(e));else if(jr(r))n=ZM(r,t);else{const a=Rk(e);n={x:r.x-a.x,y:r.y-a.y,width:r.width,height:r.height}}return Qu(n)}function jk(e,r){const t=hs(e);return t===r||!jr(t)||si(t)?!1:kn(t).position==="fixed"||jk(t,r)}function JM(e,r){const t=r.get(e);if(t)return t;let n=jl(e,[],!1).filter(i=>jr(i)&&xi(i)!=="body"),a=null;const s=kn(e).position==="fixed";let o=s?hs(e):e;for(;jr(o)&&!si(o);){const i=kn(o),l=Rh(o);!l&&i.position==="fixed"&&(a=null),(s?!l&&!a:!l&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||ql(o)&&!l&&jk(e,o))?n=n.filter(u=>u!==o):a=i,o=hs(o)}return r.set(e,n),n}function eR(e){let{element:r,boundary:t,rootBoundary:n,strategy:a}=e;const o=[...t==="clippingAncestors"?F0(r)?[]:JM(r,this._c):[].concat(t),n],i=o[0],l=o.reduce((c,u)=>{const d=Eg(r,u,a);return c.top=Ws(d.top,c.top),c.right=oi(d.right,c.right),c.bottom=oi(d.bottom,c.bottom),c.left=Ws(d.left,c.left),c},Eg(r,i,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function tR(e){const{width:r,height:t}=Mk(e);return{width:r,height:t}}function rR(e,r,t){const n=oa(r),a=ua(r),s=t==="fixed",o=to(e,!0,s,r);let i={scrollLeft:0,scrollTop:0};const l=aa(0);function c(){l.x=Bh(a)}if(n||!n&&!s)if((xi(r)!=="body"||ql(a))&&(i=A0(r)),n){const h=to(r,!0,s,r);l.x=h.x+r.clientLeft,l.y=h.y+r.clientTop}else a&&c();s&&!n&&a&&c();const u=a&&!n&&!s?Ik(a,i):aa(0),d=o.left+i.scrollLeft-l.x-u.x,p=o.top+i.scrollTop-l.y-u.y;return{x:d,y:p,width:o.width,height:o.height}}function wf(e){return kn(e).position==="static"}function Sg(e,r){if(!oa(e)||kn(e).position==="fixed")return null;if(r)return r(e);let t=e.offsetParent;return ua(e)===t&&(t=t.ownerDocument.body),t}function Lk(e,r){const t=en(e);if(F0(e))return t;if(!oa(e)){let a=hs(e);for(;a&&!si(a);){if(jr(a)&&!wf(a))return a;a=hs(a)}return t}let n=Sg(e,r);for(;n&&CM(n)&&wf(n);)n=Sg(n,r);return n&&si(n)&&wf(n)&&!Rh(n)?t:n||DM(e)||t}const nR=async function(e){const r=this.getOffsetParent||Lk,t=this.getDimensions,n=await t(e.floating);return{reference:rR(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function aR(e){return kn(e).direction==="rtl"}const sR={convertOffsetParentRelativeRectToViewportRelativeRect:GM,getDocumentElement:ua,getClippingRect:eR,getOffsetParent:Lk,getElementRects:nR,getClientRects:XM,getDimensions:tR,getScale:$o,isElement:jr,isRTL:aR};function zk(e,r){return e.x===r.x&&e.y===r.y&&e.width===r.width&&e.height===r.height}function oR(e,r){let t=null,n;const a=ua(e);function s(){var i;clearTimeout(n),(i=t)==null||i.disconnect(),t=null}function o(i,l){i===void 0&&(i=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:u,top:d,width:p,height:h}=c;if(i||r(),!p||!h)return;const x=Ac(d),m=Ac(a.clientWidth-(u+p)),y=Ac(a.clientHeight-(d+h)),g=Ac(u),v={rootMargin:-x+"px "+-m+"px "+-y+"px "+-g+"px",threshold:Ws(0,oi(1,l))||1};let b=!0;function M(C){const k=C[0].intersectionRatio;if(k!==l){if(!b)return o();k?o(!1,k):n=setTimeout(()=>{o(!1,1e-7)},1e3)}k===1&&!zk(c,e.getBoundingClientRect())&&o(),b=!1}try{t=new IntersectionObserver(M,{...v,root:a.ownerDocument})}catch{t=new IntersectionObserver(M,v)}t.observe(e)}return o(!0),s}function Bk(e,r,t,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=zh(e),u=a||s?[...c?jl(c):[],...jl(r)]:[];u.forEach(g=>{a&&g.addEventListener("scroll",t,{passive:!0}),s&&g.addEventListener("resize",t)});const d=c&&i?oR(c,t):null;let p=-1,h=null;o&&(h=new ResizeObserver(g=>{let[w]=g;w&&w.target===c&&h&&(h.unobserve(r),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var v;(v=h)==null||v.observe(r)})),t()}),c&&!l&&h.observe(c),h.observe(r));let x,m=l?to(e):null;l&&y();function y(){const g=to(e);m&&!zk(m,g)&&t(),m=g,x=requestAnimationFrame(y)}return t(),()=>{var g;u.forEach(w=>{a&&w.removeEventListener("scroll",t),s&&w.removeEventListener("resize",t)}),d==null||d(),(g=h)==null||g.disconnect(),h=null,l&&cancelAnimationFrame(x)}}const Wk=HM,iR=YM,Uk=UM,Qd=WM,qd=(e,r,t)=>{const n=new Map,a={platform:sR,...t},s={...a.platform,_c:n};return BM(e,r,{...a,platform:s})};var Jc=typeof document<"u"?S.useLayoutEffect:S.useEffect;function Zu(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let t,n,a;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==r.length)return!1;for(n=t;n--!==0;)if(!Zu(e[n],r[n]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(r).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(r,a[n]))return!1;for(n=t;n--!==0;){const s=a[n];if(!(s==="_owner"&&e.$$typeof)&&!Zu(e[s],r[s]))return!1}return!0}return e!==e&&r!==r}function $k(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Tg(e,r){const t=$k(e);return Math.round(r*t)/t}function kf(e){const r=S.useRef(e);return Jc(()=>{r.current=e}),r}function lR(e){e===void 0&&(e={});const{placement:r="bottom",strategy:t="absolute",middleware:n=[],platform:a,elements:{reference:s,floating:o}={},transform:i=!0,whileElementsMounted:l,open:c}=e,[u,d]=S.useState({x:0,y:0,strategy:t,placement:r,middlewareData:{},isPositioned:!1}),[p,h]=S.useState(n);Zu(p,n)||h(n);const[x,m]=S.useState(null),[y,g]=S.useState(null),w=S.useCallback(q=>{q!==C.current&&(C.current=q,m(q))},[]),v=S.useCallback(q=>{q!==k.current&&(k.current=q,g(q))},[]),b=s||x,M=o||y,C=S.useRef(null),k=S.useRef(null),F=S.useRef(u),E=l!=null,j=kf(l),V=kf(a),W=kf(c),te=S.useCallback(()=>{if(!C.current||!k.current)return;const q={placement:r,strategy:t,middleware:p};V.current&&(q.platform=V.current),qd(C.current,k.current,q).then(N=>{const U={...N,isPositioned:W.current!==!1};ee.current&&!Zu(F.current,U)&&(F.current=U,y0.flushSync(()=>{d(U)}))})},[p,r,t,V,W]);Jc(()=>{c===!1&&F.current.isPositioned&&(F.current.isPositioned=!1,d(q=>({...q,isPositioned:!1})))},[c]);const ee=S.useRef(!1);Jc(()=>(ee.current=!0,()=>{ee.current=!1}),[]),Jc(()=>{if(b&&(C.current=b),M&&(k.current=M),b&&M){if(j.current)return j.current(b,M,te);te()}},[b,M,te,j,E]);const J=S.useMemo(()=>({reference:C,floating:k,setReference:w,setFloating:v}),[w,v]),ne=S.useMemo(()=>({reference:b,floating:M}),[b,M]),B=S.useMemo(()=>{const q={position:t,left:0,top:0};if(!ne.floating)return q;const N=Tg(ne.floating,u.x),U=Tg(ne.floating,u.y);return i?{...q,transform:"translate("+N+"px, "+U+"px)",...$k(ne.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:N,top:U}},[t,i,ne.floating,u.x,u.y]);return S.useMemo(()=>({...u,update:te,refs:J,elements:ne,floatingStyles:B}),[u,te,J,ne,B])}const cR=e=>{function r(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:n,padding:a}=typeof e=="function"?e(t):e;return n&&r(n)?n.current!=null?Qd({element:n.current,padding:a}).fn(t):{}:n?Qd({element:n,padding:a}).fn(t):{}}}},uR=(e,r)=>({...Wk(e),options:[e,r]}),fR=(e,r)=>({...Uk(e),options:[e,r]}),dR=(e,r)=>({...cR(e),options:[e,r]}),pR={...mv};let Cg=!1,hR=0;const Dg=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+hR++;function mR(){const[e,r]=S.useState(()=>Cg?Dg():void 0);return qu(()=>{e==null&&r(Dg())},[]),S.useEffect(()=>{Cg=!0},[]),e}const xR=pR.useId,Hk=xR||mR,gR=S.forwardRef(function(r,t){const{context:{placement:n,elements:{floating:a},middlewareData:{arrow:s,shift:o}},width:i=14,height:l=7,tipRadius:c=0,strokeWidth:u=0,staticOffset:d,stroke:p,d:h,style:{transform:x,...m}={},...y}=r,g=Hk(),[w,v]=S.useState(!1);if(qu(()=>{if(!a)return;kn(a).direction==="rtl"&&v(!0)},[a]),!a)return null;const[b,M]=n.split("-"),C=b==="top"||b==="bottom";let k=d;(C&&o!=null&&o.x||!C&&o!=null&&o.y)&&(k=null);const F=u*2,E=F/2,j=i/2*(c/-8+1),V=l/2*c/4,W=!!h,te=k&&M==="end"?"bottom":"top";let ee=k&&M==="end"?"right":"left";k&&w&&(ee=M==="end"?"left":"right");const J=(s==null?void 0:s.x)!=null?k||s.x:"",ne=(s==null?void 0:s.y)!=null?k||s.y:"",B=h||"M0,0"+(" H"+i)+(" L"+(i-j)+","+(l-V))+(" Q"+i/2+","+l+" "+j+","+(l-V))+" Z",q={top:W?"rotate(180deg)":"",left:W?"rotate(90deg)":"rotate(-90deg)",bottom:W?"":"rotate(180deg)",right:W?"rotate(-90deg)":"rotate(90deg)"}[b];return f.jsxs("svg",{...y,"aria-hidden":!0,ref:t,width:W?i:i+F,height:i,viewBox:"0 0 "+i+" "+(l>i?l:i),style:{position:"absolute",pointerEvents:"none",[ee]:J,[te]:ne,[b]:C||W?"100%":"calc(100% - "+F/2+"px)",transform:[q,x].filter(N=>!!N).join(" "),...m},children:[F>0&&f.jsx("path",{clipPath:"url(#"+g+")",fill:"none",stroke:p,strokeWidth:F+(h?0:1),d:B}),f.jsx("path",{stroke:F&&!h?y.fill:"none",d:B}),f.jsx("clipPath",{id:g,children:f.jsx("rect",{x:-E,y:E*(W?-1:1),width:i+F,height:i})})]})});function vR(){const e=new Map;return{emit(r,t){var n;(n=e.get(r))==null||n.forEach(a=>a(t))},on(r,t){e.has(r)||e.set(r,new Set),e.get(r).add(t)},off(r,t){var n;(n=e.get(r))==null||n.delete(t)}}}const yR=S.createContext(null),wR=S.createContext(null),kR=()=>{var e;return((e=S.useContext(yR))==null?void 0:e.id)||null},_R=()=>S.useContext(wR);function bR(e){const{open:r=!1,onOpenChange:t,elements:n}=e,a=Hk(),s=S.useRef({}),[o]=S.useState(()=>vR()),i=kR()!=null,[l,c]=S.useState(n.reference),u=zM((h,x,m)=>{s.current.openEvent=h?x:void 0,o.emit("openchange",{open:h,event:x,reason:m,nested:i}),t==null||t(h,x,m)}),d=S.useMemo(()=>({setPositionReference:c}),[]),p=S.useMemo(()=>({reference:l||n.reference||null,floating:n.floating||null,domReference:n.reference}),[l,n.reference,n.floating]);return S.useMemo(()=>({dataRef:s,open:r,onOpenChange:u,elements:p,events:o,floatingId:a,refs:d}),[r,u,p,o,a,d])}function ER(e){e===void 0&&(e={});const{nodeId:r}=e,t=bR({...e,elements:{reference:null,floating:null,...e.elements}}),n=e.rootContext||t,a=n.elements,[s,o]=S.useState(null),[i,l]=S.useState(null),u=(a==null?void 0:a.domReference)||s,d=S.useRef(null),p=_R();qu(()=>{u&&(d.current=u)},[u]);const h=lR({...e,elements:{...a,...i&&{reference:i}}}),x=S.useCallback(v=>{const b=jr(v)?{getBoundingClientRect:()=>v.getBoundingClientRect(),getClientRects:()=>v.getClientRects(),contextElement:v}:v;l(b),h.refs.setReference(b)},[h.refs]),m=S.useCallback(v=>{(jr(v)||v===null)&&(d.current=v,o(v)),(jr(h.refs.reference.current)||h.refs.reference.current===null||v!==null&&!jr(v))&&h.refs.setReference(v)},[h.refs]),y=S.useMemo(()=>({...h.refs,setReference:m,setPositionReference:x,domReference:d}),[h.refs,m,x]),g=S.useMemo(()=>({...h.elements,domReference:u}),[h.elements,u]),w=S.useMemo(()=>({...h,...n,refs:y,elements:g,nodeId:r}),[h,y,g,r,n]);return qu(()=>{n.dataRef.current.floatingContext=w;const v=p==null?void 0:p.nodesRef.current.find(b=>b.id===r);v&&(v.context=w)}),S.useMemo(()=>({...h,context:w,refs:y,elements:g}),[h,y,g,w])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Zd=function(r,t){return Zd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},Zd(r,t)};function ir(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");Zd(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var ot=function(){return ot=Object.assign||function(t){for(var n,a=1,s=arguments.length;a<s;a++){n=arguments[a];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ot.apply(this,arguments)};function ta(e,r,t){if(t||arguments.length===2)for(var n=0,a=r.length,s;n<a;n++)(s||!(n in r))&&(s||(s=Array.prototype.slice.call(r,0,n)),s[n]=r[n]);return e.concat(s||Array.prototype.slice.call(r))}var SR=function(e){var r=e.showTimeSelectOnly,t=r===void 0?!1:r,n=e.showTime,a=n===void 0?!1:n,s=e.className,o=e.children,i=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return fe.createElement("div",{className:s,role:"dialog","aria-label":i,"aria-modal":"true"},o)},TR=function(e,r){var t=S.useRef(null),n=S.useRef(e);n.current=e;var a=S.useCallback(function(s){var o,i=s.composed&&s.composedPath&&s.composedPath().find(function(l){return l instanceof Node})||s.target;t.current&&!t.current.contains(i)&&(r&&i instanceof HTMLElement&&i.classList.contains(r)||(o=n.current)===null||o===void 0||o.call(n,s))},[r]);return S.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},O0=function(e){var r=e.children,t=e.onClickOutside,n=e.className,a=e.containerRef,s=e.style,o=e.ignoreClass,i=TR(t,o);return fe.createElement("div",{className:n,style:s,ref:function(l){i.current=l,a&&(a.current=l)}},r)},De;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(De||(De={}));function Wh(){var e=typeof window<"u"?window:globalThis;return e}var ec=12;function dt(e){if(e==null)return new Date;var r=typeof e=="string"?fM(e):Re(e);return P0(r)?r:new Date}function _f(e,r,t,n,a){a===void 0&&(a=dt());for(var s=ii(t)||ii(Uh()),o=Array.isArray(r)?r:[r],i=0,l=o;i<l.length;i++){var c=l[i],u=aM(e,c,a,{locale:s});if(P0(u)&&(!n||e===Ot(u,c,t)))return u}return null}function P0(e,r){return $u(e)&&!Js(e,new Date("1/1/1800"))}function Ot(e,r,t){if(t==="en")return yg(e,r,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var n=t?ii(t):void 0;return t&&!n&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),n=n||ii(Uh()),yg(e,r,{locale:n,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function un(e,r){var t=r.dateFormat,n=r.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&Ot(e,a,n)||""}function CR(e,r,t){if(!e)return"";var n=un(e,t),a=r?un(r,t):"";return"".concat(n," - ").concat(a)}function DR(e,r){if(!(e!=null&&e.length))return"";var t=e[0]?un(e[0],r):"";if(e.length===1)return t;if(e.length===2&&e[1]){var n=un(e[1],r);return"".concat(t,", ").concat(n)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function bf(e,r){var t=r.hour,n=t===void 0?0:t,a=r.minute,s=a===void 0?0:a,o=r.second,i=o===void 0?0:o;return Qc(qc(Zc(e,i),s),n)}function NR(e){return Ah(e)}function FR(e,r){return Ot(e,"ddd",r)}function eu(e){return Zs(e)}function ls(e,r,t){var n=ii(r||Uh());return Bn(e,{locale:n,weekStartsOn:t})}function Ca(e){return gk(e)}function Bi(e){return D0(e)}function Ng(e){return Hd(e)}function Fg(){return Zs(dt())}function Ag(e){return mk(e)}function AR(e){return fO(e)}function OR(e){return xk(e)}function Xn(e,r){return e&&r?cM(e,r):!e&&!r}function Or(e,r){return e&&r?iM(e,r):!e&&!r}function Ju(e,r){return e&&r?lM(e,r):!e&&!r}function st(e,r){return e&&r?cO(e,r):!e&&!r}function As(e,r){return e&&r?cP(e,r):!e&&!r}function Wi(e,r,t){var n,a=Zs(r),s=mk(t);try{n=Il(e,{start:a,end:s})}catch{n=!1}return n}function gi(e,r){var t=Wh();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=r}function Uh(){var e=Wh();return e.__localeId__}function ii(e){if(typeof e=="string"){var r=Wh();return r.__localeData__?r.__localeData__[e]:void 0}else return e}function PR(e,r,t){return r(Ot(e,"EEEE",t))}function MR(e,r){return Ot(e,"EEEEEE",r)}function RR(e,r){return Ot(e,"EEE",r)}function $h(e,r){return Ot(dn(dt(),e),"LLLL",r)}function Yk(e,r){return Ot(dn(dt(),e),"LLL",r)}function IR(e,r){return Ot(vo(dt(),e),"QQQ",r)}function mn(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.maxDate,s=t.excludeDates,o=t.excludeDateIntervals,i=t.includeDates,l=t.includeDateIntervals,c=t.filterDate;return tc(e,{minDate:n,maxDate:a})||s&&s.some(function(u){return u instanceof Date?st(e,u):st(e,u.date)})||o&&o.some(function(u){var d=u.start,p=u.end;return Il(e,{start:d,end:p})})||i&&!i.some(function(u){return st(e,u)})||l&&!l.some(function(u){var d=u.start,p=u.end;return Il(e,{start:d,end:p})})||c&&!c(dt(e))||!1}function Hh(e,r){var t=r===void 0?{}:r,n=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(s){var o=s.start,i=s.end;return Il(e,{start:o,end:i})}):n&&n.some(function(s){var o;return s instanceof Date?st(e,s):st(e,(o=s.date)!==null&&o!==void 0?o:new Date)})||!1}function Vk(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.maxDate,s=t.excludeDates,o=t.includeDates,i=t.filterDate;return tc(e,{minDate:n?gk(n):void 0,maxDate:a?xk(a):void 0})||(s==null?void 0:s.some(function(l){return Or(e,l instanceof Date?l:l.date)}))||o&&!o.some(function(l){return Or(e,l)})||i&&!i(dt(e))||!1}function Oc(e,r,t,n){var a=Xe(e),s=Ir(e),o=Xe(r),i=Ir(r),l=Xe(n);return a===o&&a===l?s<=t&&t<=i:a<o?l===a&&s<=t||l===o&&i>=t||l<o&&l>a:!1}function jR(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.maxDate,s=t.excludeDates,o=t.includeDates;return tc(e,{minDate:n,maxDate:a})||s&&s.some(function(i){return Or(i instanceof Date?i:i.date,e)})||o&&!o.some(function(i){return Or(i,e)})||!1}function Pc(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.maxDate,s=t.excludeDates,o=t.includeDates,i=t.filterDate;return tc(e,{minDate:n,maxDate:a})||(s==null?void 0:s.some(function(l){return Ju(e,l instanceof Date?l:l.date)}))||o&&!o.some(function(l){return Ju(e,l)})||i&&!i(dt(e))||!1}function Mc(e,r,t){if(!r||!t||!$u(r)||!$u(t))return!1;var n=Xe(r),a=Xe(t);return n<=e&&a>=e}function tu(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.maxDate,s=t.excludeDates,o=t.includeDates,i=t.filterDate,l=new Date(e,0,1);return tc(l,{minDate:n?D0(n):void 0,maxDate:a?vk(a):void 0})||(s==null?void 0:s.some(function(c){return Xn(l,c instanceof Date?c:c.date)}))||o&&!o.some(function(c){return Xn(l,c)})||i&&!i(dt(l))||!1}function Rc(e,r,t,n){var a=Xe(e),s=zs(e),o=Xe(r),i=zs(r),l=Xe(n);return a===o&&a===l?s<=t&&t<=i:a<o?l===a&&s<=t||l===o&&i>=t||l<o&&l>a:!1}function tc(e,r){var t,n=r===void 0?{}:r,a=n.minDate,s=n.maxDate;return(t=a&&ni(e,a)<0||s&&ni(e,s)>0)!==null&&t!==void 0?t:!1}function Og(e,r){return r.some(function(t){return Sa(t)===Sa(e)&&Ta(t)===Ta(e)&&is(t)===is(e)})}function Pg(e,r){var t=r===void 0?{}:r,n=t.excludeTimes,a=t.includeTimes,s=t.filterTime;return n&&Og(e,n)||a&&!Og(e,a)||s&&!s(e)||!1}function Mg(e,r){var t=r.minTime,n=r.maxTime;if(!t||!n)throw new Error("Both minTime and maxTime props required");var a=dt();a=Qc(a,Sa(e)),a=qc(a,Ta(e)),a=Zc(a,is(e));var s=dt();s=Qc(s,Sa(t)),s=qc(s,Ta(t)),s=Zc(s,is(t));var o=dt();o=Qc(o,Sa(n)),o=qc(o,Ta(n)),o=Zc(o,is(n));var i;try{i=!Il(a,{start:s,end:o})}catch{i=!1}return i}function Rg(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.includeDates,s=Bs(e,1);return n&&Hu(n,s)>0||a&&a.every(function(o){return Hu(o,s)>0})||!1}function Ig(e,r){var t=r===void 0?{}:r,n=t.maxDate,a=t.includeDates,s=zn(e,1);return n&&Hu(s,n)>0||a&&a.every(function(o){return Hu(s,o)>0})||!1}function LR(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.includeDates,s=D0(e),o=Dk(s);return n&&Yu(n,o)>0||a&&a.every(function(i){return Yu(i,o)>0})||!1}function zR(e,r){var t=r===void 0?{}:r,n=t.maxDate,a=t.includeDates,s=vk(e),o=Fh(s,1);return n&&Yu(o,n)>0||a&&a.every(function(i){return Yu(o,i)>0})||!1}function jg(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.includeDates,s=ai(e,1);return n&&Vu(n,s)>0||a&&a.every(function(o){return Vu(o,s)>0})||!1}function BR(e,r){var t=r===void 0?{}:r,n=t.minDate,a=t.yearItemNumber,s=a===void 0?ec:a,o=Bi(ai(e,s)),i=qa(o,s).endPeriod,l=n&&Xe(n);return l&&l>i||!1}function Lg(e,r){var t=r===void 0?{}:r,n=t.maxDate,a=t.includeDates,s=ba(e,1);return n&&Vu(s,n)>0||a&&a.every(function(o){return Vu(s,o)>0})||!1}function WR(e,r){var t=r===void 0?{}:r,n=t.maxDate,a=t.yearItemNumber,s=a===void 0?ec:a,o=ba(e,s),i=qa(o,s).startPeriod,l=n&&Xe(n);return l&&l<i||!1}function Kk(e){var r=e.minDate,t=e.includeDates;if(t&&r){var n=t.filter(function(a){return ni(a,r)>=0});return pg(n)}else return t?pg(t):r}function Gk(e){var r=e.maxDate,t=e.includeDates;if(t&&r){var n=t.filter(function(a){return ni(a,r)<=0});return dg(n)}else return t?dg(t):r}function zg(e,r){var t;e===void 0&&(e=[]),r===void 0&&(r="react-datepicker__day--highlighted");for(var n=new Map,a=0,s=e.length;a<s;a++){var o=e[a];if(Ea(o)){var i=Ot(o,"MM.dd.yyyy"),l=n.get(i)||[];l.includes(r)||(l.push(r),n.set(i,l))}else if(typeof o=="object"){var c=Object.keys(o),u=(t=c[0])!==null&&t!==void 0?t:"",d=o[u];if(typeof u=="string"&&Array.isArray(d))for(var p=0,h=d.length;p<h;p++){var x=d[p];if(x){var i=Ot(x,"MM.dd.yyyy"),l=n.get(i)||[];l.includes(u)||(l.push(u),n.set(i,l))}}}}return n}function UR(e,r){return e.length!==r.length?!1:e.every(function(t,n){return t===r[n]})}function $R(e,r){e===void 0&&(e=[]),r===void 0&&(r="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(n){var a=n.date,s=n.holidayName;if(Ea(a)){var o=Ot(a,"MM.dd.yyyy"),i=t.get(o)||{className:"",holidayNames:[]};if(!("className"in i&&i.className===r&&UR(i.holidayNames,[s]))){i.className=r;var l=i.holidayNames;i.holidayNames=l?ta(ta([],l,!0),[s],!1):[s],t.set(o,i)}}}),t}function HR(e,r,t,n,a){for(var s=a.length,o=[],i=0;i<s;i++){var l=e,c=a[i];c&&(l=sO(l,Sa(c)),l=$d(l,Ta(c)),l=lO(l,is(c)));var u=$d(e,(t+1)*n);ps(l,r)&&Js(l,u)&&c!=null&&o.push(c)}return o}function Bg(e){return e<10?"0".concat(e):"".concat(e)}function qa(e,r){r===void 0&&(r=ec);var t=Math.ceil(Xe(e)/r)*r,n=t-(r-1);return{startPeriod:n,endPeriod:t}}function YR(e){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+r)/36e5)}function Wg(e){var r=e.getSeconds(),t=e.getMilliseconds();return Re(e.getTime()-r*1e3-t)}function VR(e,r){return Wg(e).getTime()===Wg(r).getTime()}function Ug(e){if(!Ea(e))throw new Error("Invalid date");var r=new Date(e);return r.setHours(0,0,0,0),r}function $g(e,r){if(!Ea(e)||!Ea(r))throw new Error("Invalid date received");var t=Ug(e),n=Ug(r);return Js(t,n)}function Xk(e){return e.key===De.Space}var KR=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;return n.inputRef=fe.createRef(),n.onTimeChange=function(a){var s,o;n.setState({time:a});var i=n.props.date,l=i instanceof Date&&!isNaN(+i),c=l?i:new Date;if(a!=null&&a.includes(":")){var u=a.split(":"),d=u[0],p=u[1];c.setHours(Number(d)),c.setMinutes(Number(p))}(o=(s=n.props).onChange)===null||o===void 0||o.call(s,c)},n.renderTimeInput=function(){var a=n.state.time,s=n.props,o=s.date,i=s.timeString,l=s.customTimeInput;return l?S.cloneElement(l,{date:o,value:a,onChange:n.onTimeChange}):fe.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var c;(c=n.inputRef.current)===null||c===void 0||c.focus()},required:!0,value:a,onChange:function(c){n.onTimeChange(c.target.value||i)}})},n.state={time:n.props.timeString},n}return r.getDerivedStateFromProps=function(t,n){return t.timeString!==n.time?{time:t.timeString}:null},r.prototype.render=function(){return fe.createElement("div",{className:"react-datepicker__input-time-container"},fe.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),fe.createElement("div",{className:"react-datepicker-time__input-container"},fe.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},r}(S.Component),GR=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=S.createRef(),t.handleClick=function(n){!t.isDisabled()&&t.props.onClick&&t.props.onClick(n)},t.handleMouseEnter=function(n){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(n)},t.handleOnKeyDown=function(n){var a,s,o=n.key;o===De.Space&&(n.preventDefault(),n.key=De.Enter),(s=(a=t.props).handleOnKeyDown)===null||s===void 0||s.call(a,n)},t.isSameDay=function(n){return st(t.props.day,n)},t.isKeyboardSelected=function(){var n;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(n=t.props.selectedDates)===null||n===void 0?void 0:n.some(function(o){return t.isSameDayOrWeek(o)}):t.isSameDayOrWeek(t.props.selected),s=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!s},t.isDisabled=function(n){return n===void 0&&(n=t.props.day),mn(n,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Hh(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return st(t.props.day,ls(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(n){return t.props.showWeekPicker&&st(n,ls(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(n){return t.isSameDay(n)||t.isSameWeek(n)},t.getHighLightedClass=function(){var n=t.props,a=n.day,s=n.highlightDates;if(!s)return!1;var o=Ot(a,"MM.dd.yyyy");return s.get(o)},t.getHolidaysClass=function(){var n,a=t.props,s=a.day,o=a.holidays;if(!o)return[void 0];var i=Ot(s,"MM.dd.yyyy");return o.has(i)?[(n=o.get(i))===null||n===void 0?void 0:n.className]:[void 0]},t.isInRange=function(){var n=t.props,a=n.day,s=n.startDate,o=n.endDate;return!s||!o?!1:Wi(a,s,o)},t.isInSelectingRange=function(){var n,a=t.props,s=a.day,o=a.selectsStart,i=a.selectsEnd,l=a.selectsRange,c=a.selectsDisabledDaysInRange,u=a.startDate,d=a.endDate,p=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return!(o||i||l)||!p||!c&&t.isDisabled()?!1:o&&d&&(Js(p,d)||As(p,d))?Wi(s,p,d):i&&u&&!d&&(ps(p,u)||As(p,u))||l&&u&&!d&&(ps(p,u)||As(p,u))?Wi(s,u,p):!1},t.isSelectingRangeStart=function(){var n;if(!t.isInSelectingRange())return!1;var a=t.props,s=a.day,o=a.startDate,i=a.selectsStart,l=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return i?st(s,l):st(s,o)},t.isSelectingRangeEnd=function(){var n;if(!t.isInSelectingRange())return!1;var a=t.props,s=a.day,o=a.endDate,i=a.selectsEnd,l=a.selectsRange,c=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return i||l?st(s,c):st(s,o)},t.isRangeStart=function(){var n=t.props,a=n.day,s=n.startDate,o=n.endDate;return!s||!o?!1:st(s,a)},t.isRangeEnd=function(){var n=t.props,a=n.day,s=n.startDate,o=n.endDate;return!s||!o?!1:st(o,a)},t.isWeekend=function(){var n=sP(t.props.day);return n===0||n===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===Ir(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(Ir(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(dt())},t.isSelected=function(){var n;return t.props.selectsMultiple?(n=t.props.selectedDates)===null||n===void 0?void 0:n.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(n){var a=t.props.dayClassName?t.props.dayClassName(n):void 0;return ur("react-datepicker__day",a,"react-datepicker__day--"+FR(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var n=t.props,a=n.day,s=n.ariaLabelPrefixWhenEnabled,o=s===void 0?"Choose":s,i=n.ariaLabelPrefixWhenDisabled,l=i===void 0?"Not available":i,c=t.isDisabled()||t.isExcluded()?l:o;return"".concat(c," ").concat(Ot(a,"PPPP",t.props.locale))},t.getTitle=function(){var n=t.props,a=n.day,s=n.holidays,o=s===void 0?new Map:s,i=n.excludeDates,l=Ot(a,"MM.dd.yyyy"),c=[];return o.has(l)&&c.push.apply(c,o.get(l).holidayNames),t.isExcluded()&&c.push(i==null?void 0:i.filter(function(u){return u instanceof Date?st(u,a):st(u==null?void 0:u.date,a)}).map(function(u){if(!(u instanceof Date))return u==null?void 0:u.message})),c.join(", ")},t.getTabIndex=function(){var n=t.props.selected,a=t.props.preSelection,s=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(n)&&st(a,n))?0:-1;return s},t.handleFocusDay=function(){var n;t.shouldFocusDay()&&((n=t.dayEl.current)===null||n===void 0||n.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(wg(t.props.day),t.props.day):wg(t.props.day)},t.render=function(){return fe.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&fe.createElement("span",{className:"overlay"},t.getTitle()))},t}return r.prototype.componentDidMount=function(){this.handleFocusDay()},r.prototype.componentDidUpdate=function(){this.handleFocusDay()},r.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},r.prototype.isDayActiveElement=function(){var t,n,a;return((n=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||n===void 0?void 0:n.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},r.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},r}(S.Component),XR=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=S.createRef(),t.handleClick=function(n){t.props.onClick&&t.props.onClick(n)},t.handleOnKeyDown=function(n){var a,s,o=n.key;o===De.Space&&(n.preventDefault(),n.key=De.Enter),(s=(a=t.props).handleOnKeyDown)===null||s===void 0||s.call(a,n)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!st(t.props.date,t.props.selected)&&st(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||st(t.props.date,t.props.selected)&&st(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(n){var a=!1;t.getTabIndex()===0&&!(n!=null&&n.isInputFocused)&&st(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(r,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),r.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},r.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},r.prototype.render=function(){var t=this.props,n=t.weekNumber,a=t.isWeekDisabled,s=t.ariaLabelPrefix,o=s===void 0?r.defaultProps.ariaLabelPrefix:s,i=t.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!i&&!a,"react-datepicker__week-number--selected":!!i&&st(this.props.date,this.props.selected)};return fe.createElement("div",{ref:this.weekNumberEl,className:ur(l),"aria-label":"".concat(o," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},n)},r}(S.Component),QR=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(n){return mn(n,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(n,a){t.props.onDayClick&&t.props.onDayClick(n,a)},t.handleDayMouseEnter=function(n){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(n)},t.handleWeekClick=function(n,a,s){for(var o,i,l,c=new Date(n),u=0;u<7;u++){var d=new Date(n);d.setDate(d.getDate()+u);var p=!t.isDisabled(d);if(p){c=d;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(c,a,s),t.props.showWeekPicker&&t.handleDayClick(c,s),((o=t.props.shouldCloseOnSelect)!==null&&o!==void 0?o:r.defaultProps.shouldCloseOnSelect)&&((l=(i=t.props).setOpen)===null||l===void 0||l.call(i,!1))},t.formatWeekNumber=function(n){return t.props.formatWeekNumber?t.props.formatWeekNumber(n):NR(n)},t.isWeekDisabled=function(){for(var n=t.startOfWeek(),a=jn(n,6),s=new Date(n);s<=a;){if(!t.isDisabled(s))return!1;s=jn(s,1)}return!0},t.renderDays=function(){var n=t.startOfWeek(),a=[],s=t.formatWeekNumber(n);if(t.props.showWeekNumber){var o=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,n,s):void 0;a.push(fe.createElement(XR,ot({key:"W"},r.defaultProps,t.props,{weekNumber:s,isWeekDisabled:t.isWeekDisabled(),date:n,onClick:o})))}return a.concat([0,1,2,3,4,5,6].map(function(i){var l=jn(n,i);return fe.createElement(GR,ot({},r.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:l.valueOf(),day:l,onClick:t.handleDayClick.bind(t,l),onMouseEnter:t.handleDayMouseEnter.bind(t,l)}))}))},t.startOfWeek=function(){return ls(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!st(t.startOfWeek(),t.props.selected)&&st(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(r,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),r.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":st(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return fe.createElement("div",{className:ur(t)},this.renderDays())},r}(S.Component),Ai,qR=6,Ho={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},Ef=(Ai={},Ai[Ho.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},Ai[Ho.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},Ai[Ho.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},Ai),Ic=1;function Hg(e,r){return e?Ho.FOUR_COLUMNS:r?Ho.TWO_COLUMNS:Ho.THREE_COLUMNS}var ZR=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=ta([],Array(12),!0).map(function(){return S.createRef()}),t.QUARTER_REFS=ta([],Array(4),!0).map(function(){return S.createRef()}),t.isDisabled=function(n){return mn(n,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(n){return Hh(n,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(n,a){var s,o;(o=(s=t.props).onDayClick)===null||o===void 0||o.call(s,n,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(n){var a,s;(s=(a=t.props).onDayMouseEnter)===null||s===void 0||s.call(a,n)},t.handleMouseLeave=function(){var n,a;(a=(n=t.props).onMouseLeave)===null||a===void 0||a.call(n)},t.isRangeStartMonth=function(n){var a=t.props,s=a.day,o=a.startDate,i=a.endDate;return!o||!i?!1:Or(dn(s,n),o)},t.isRangeStartQuarter=function(n){var a=t.props,s=a.day,o=a.startDate,i=a.endDate;return!o||!i?!1:Ju(vo(s,n),o)},t.isRangeEndMonth=function(n){var a=t.props,s=a.day,o=a.startDate,i=a.endDate;return!o||!i?!1:Or(dn(s,n),i)},t.isRangeEndQuarter=function(n){var a=t.props,s=a.day,o=a.startDate,i=a.endDate;return!o||!i?!1:Ju(vo(s,n),i)},t.isInSelectingRangeMonth=function(n){var a,s=t.props,o=s.day,i=s.selectsStart,l=s.selectsEnd,c=s.selectsRange,u=s.startDate,d=s.endDate,p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(i||l||c)||!p?!1:i&&d?Oc(p,d,n,o):l&&u||c&&u&&!d?Oc(u,p,n,o):!1},t.isSelectingMonthRangeStart=function(n){var a;if(!t.isInSelectingRangeMonth(n))return!1;var s=t.props,o=s.day,i=s.startDate,l=s.selectsStart,c=dn(o,n),u=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return l?Or(c,u):Or(c,i)},t.isSelectingMonthRangeEnd=function(n){var a;if(!t.isInSelectingRangeMonth(n))return!1;var s=t.props,o=s.day,i=s.endDate,l=s.selectsEnd,c=s.selectsRange,u=dn(o,n),d=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return l||c?Or(u,d):Or(u,i)},t.isInSelectingRangeQuarter=function(n){var a,s=t.props,o=s.day,i=s.selectsStart,l=s.selectsEnd,c=s.selectsRange,u=s.startDate,d=s.endDate,p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(i||l||c)||!p?!1:i&&d?Rc(p,d,n,o):l&&u||c&&u&&!d?Rc(u,p,n,o):!1},t.isWeekInMonth=function(n){var a=t.props.day,s=jn(n,6);return Or(n,a)||Or(s,a)},t.isCurrentMonth=function(n,a){return Xe(n)===Xe(dt())&&a===Ir(dt())},t.isCurrentQuarter=function(n,a){return Xe(n)===Xe(dt())&&a===zs(dt())},t.isSelectedMonth=function(n,a,s){return Ir(s)===a&&Xe(n)===Xe(s)},t.isSelectMonthInList=function(n,a,s){return s.some(function(o){return t.isSelectedMonth(n,a,o)})},t.isSelectedQuarter=function(n,a,s){return zs(n)===a&&Xe(n)===Xe(s)},t.renderWeeks=function(){for(var n=[],a=t.props.fixedHeight,s=0,o=!1,i=ls(Ca(t.props.day),t.props.locale,t.props.calendarStartDay),l=function(x){return t.props.showWeekPicker?ls(x,t.props.locale,t.props.calendarStartDay):t.props.preSelection},c=function(x){return t.props.showWeekPicker?ls(x,t.props.locale,t.props.calendarStartDay):t.props.selected},u=t.props.selected?c(t.props.selected):void 0,d=t.props.preSelection?l(t.props.preSelection):void 0;n.push(fe.createElement(QR,ot({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:s,day:i,month:Ir(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:u,preSelection:d,showWeekNumber:t.props.showWeekNumbers}))),!o;){s++,i=Uu(i,1);var p=a&&s>=qR,h=!a&&!t.isWeekInMonth(i);if(p||h)if(t.props.peekNextMonth)o=!0;else break}return n},t.onMonthClick=function(n,a){var s=t.isMonthDisabledForLabelDate(a),o=s.isDisabled,i=s.labelDate;o||t.handleDayClick(Ca(i),n)},t.onMonthMouseEnter=function(n){var a=t.isMonthDisabledForLabelDate(n),s=a.isDisabled,o=a.labelDate;s||t.handleDayMouseEnter(Ca(o))},t.handleMonthNavigation=function(n,a){var s,o,i,l;(o=(s=t.props).setPreSelection)===null||o===void 0||o.call(s,a),(l=(i=t.MONTH_REFS[n])===null||i===void 0?void 0:i.current)===null||l===void 0||l.focus()},t.handleKeyboardNavigation=function(n,a,s){var o,i=t.props,l=i.selected,c=i.preSelection,u=i.setPreSelection,d=i.minDate,p=i.maxDate,h=i.showFourColumnMonthYearPicker,x=i.showTwoColumnMonthYearPicker;if(c){var m=Hg(h,x),y=t.getVerticalOffset(m),g=(o=Ef[m])===null||o===void 0?void 0:o.grid,w=function(k,F,E){var j,V,W=F,te=E;switch(k){case De.ArrowRight:W=zn(F,Ic),te=E===11?0:E+Ic;break;case De.ArrowLeft:W=Bs(F,Ic),te=E===0?11:E-Ic;break;case De.ArrowUp:W=Bs(F,y),te=!((j=g==null?void 0:g[0])===null||j===void 0)&&j.includes(E)?E+12-y:E-y;break;case De.ArrowDown:W=zn(F,y),te=!((V=g==null?void 0:g[g.length-1])===null||V===void 0)&&V.includes(E)?E-12+y:E+y;break}return{newCalculatedDate:W,newCalculatedMonth:te}},v=function(k,F,E){for(var j=40,V=k,W=!1,te=0,ee=w(V,F,E),J=ee.newCalculatedDate,ne=ee.newCalculatedMonth;!W;){if(te>=j){J=F,ne=E;break}if(d&&J<d){V=De.ArrowRight;var B=w(V,J,ne);J=B.newCalculatedDate,ne=B.newCalculatedMonth}if(p&&J>p){V=De.ArrowLeft;var B=w(V,J,ne);J=B.newCalculatedDate,ne=B.newCalculatedMonth}if(jR(J,t.props)){var B=w(V,J,ne);J=B.newCalculatedDate,ne=B.newCalculatedMonth}else W=!0;te++}return{newCalculatedDate:J,newCalculatedMonth:ne}};if(a===De.Enter){t.isMonthDisabled(s)||(t.onMonthClick(n,s),u==null||u(l));return}var b=v(a,c,s),M=b.newCalculatedDate,C=b.newCalculatedMonth;switch(a){case De.ArrowRight:case De.ArrowLeft:case De.ArrowUp:case De.ArrowDown:t.handleMonthNavigation(C,M);break}}},t.getVerticalOffset=function(n){var a,s;return(s=(a=Ef[n])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&s!==void 0?s:0},t.onMonthKeyDown=function(n,a){var s=t.props,o=s.disabledKeyboardNavigation,i=s.handleOnMonthKeyDown,l=n.key;l!==De.Tab&&n.preventDefault(),o||t.handleKeyboardNavigation(n,l,a),i&&i(n)},t.onQuarterClick=function(n,a){var s=vo(t.props.day,a);Pc(s,t.props)||t.handleDayClick(Ng(s),n)},t.onQuarterMouseEnter=function(n){var a=vo(t.props.day,n);Pc(a,t.props)||t.handleDayMouseEnter(Ng(a))},t.handleQuarterNavigation=function(n,a){var s,o,i,l;t.isDisabled(a)||t.isExcluded(a)||((o=(s=t.props).setPreSelection)===null||o===void 0||o.call(s,a),(l=(i=t.QUARTER_REFS[n-1])===null||i===void 0?void 0:i.current)===null||l===void 0||l.focus())},t.onQuarterKeyDown=function(n,a){var s,o,i=n.key;if(!t.props.disabledKeyboardNavigation)switch(i){case De.Enter:t.onQuarterClick(n,a),(o=(s=t.props).setPreSelection)===null||o===void 0||o.call(s,t.props.selected);break;case De.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Fh(t.props.preSelection,1));break;case De.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,Dk(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(n){var a,s=t.props,o=s.day,i=s.minDate,l=s.maxDate,c=s.excludeDates,u=s.includeDates,d=dn(o,n);return{isDisabled:(a=(i||l||c||u)&&Vk(d,t.props))!==null&&a!==void 0?a:!1,labelDate:d}},t.isMonthDisabled=function(n){var a=t.isMonthDisabledForLabelDate(n).isDisabled;return a},t.getMonthClassNames=function(n){var a=t.props,s=a.day,o=a.startDate,i=a.endDate,l=a.preSelection,c=a.monthClassName,u=c?c(dn(s,n)):void 0,d=t.getSelection();return ur("react-datepicker__month-text","react-datepicker__month-".concat(n),u,{"react-datepicker__month-text--disabled":t.isMonthDisabled(n),"react-datepicker__month-text--selected":d?t.isSelectMonthInList(s,n,d):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&l&&t.isSelectedMonth(s,n,l)&&!t.isMonthDisabled(n),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(n),"react-datepicker__month-text--in-range":o&&i?Oc(o,i,n,s):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(n),"react-datepicker__month-text--range-end":t.isRangeEndMonth(n),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(n),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(n),"react-datepicker__month-text--today":t.isCurrentMonth(s,n)})},t.getTabIndex=function(n){if(t.props.preSelection==null)return"-1";var a=Ir(t.props.preSelection),s=t.isMonthDisabledForLabelDate(a).isDisabled,o=n===a&&!(s||t.props.disabledKeyboardNavigation)?"0":"-1";return o},t.getQuarterTabIndex=function(n){if(t.props.preSelection==null)return"-1";var a=zs(t.props.preSelection),s=Pc(t.props.day,t.props),o=n===a&&!(s||t.props.disabledKeyboardNavigation)?"0":"-1";return o},t.getAriaLabel=function(n){var a=t.props,s=a.chooseDayAriaLabelPrefix,o=s===void 0?"Choose":s,i=a.disabledDayAriaLabelPrefix,l=i===void 0?"Not available":i,c=a.day,u=a.locale,d=dn(c,n),p=t.isDisabled(d)||t.isExcluded(d)?l:o;return"".concat(p," ").concat(Ot(d,"MMMM yyyy",u))},t.getQuarterClassNames=function(n){var a=t.props,s=a.day,o=a.startDate,i=a.endDate,l=a.selected,c=a.minDate,u=a.maxDate,d=a.excludeDates,p=a.includeDates,h=a.filterDate,x=a.preSelection,m=a.disabledKeyboardNavigation,y=(c||u||d||p||h)&&Pc(vo(s,n),t.props);return ur("react-datepicker__quarter-text","react-datepicker__quarter-".concat(n),{"react-datepicker__quarter-text--disabled":y,"react-datepicker__quarter-text--selected":l?t.isSelectedQuarter(s,n,l):void 0,"react-datepicker__quarter-text--keyboard-selected":!m&&x&&t.isSelectedQuarter(s,n,x)&&!y,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(n),"react-datepicker__quarter-text--in-range":o&&i?Rc(o,i,n,s):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(n),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(n),"react-datepicker__quarter-text--today":t.isCurrentQuarter(s,n)})},t.getMonthContent=function(n){var a=t.props,s=a.showFullMonthYearPicker,o=a.renderMonthContent,i=a.locale,l=a.day,c=Yk(n,i),u=$h(n,i);return o?o(n,c,u,l):s?u:c},t.getQuarterContent=function(n){var a,s=t.props,o=s.renderQuarterContent,i=s.locale,l=IR(n,i);return(a=o==null?void 0:o(n,l))!==null&&a!==void 0?a:l},t.renderMonths=function(){var n,a=t.props,s=a.showTwoColumnMonthYearPicker,o=a.showFourColumnMonthYearPicker,i=a.day,l=a.selected,c=(n=Ef[Hg(o,s)])===null||n===void 0?void 0:n.grid;return c==null?void 0:c.map(function(u,d){return fe.createElement("div",{className:"react-datepicker__month-wrapper",key:d},u.map(function(p,h){return fe.createElement("div",{ref:t.MONTH_REFS[p],key:h,onClick:function(x){t.onMonthClick(x,p)},onKeyDown:function(x){Xk(x)&&(x.preventDefault(),x.key=De.Enter),t.onMonthKeyDown(x,p)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(p)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(p)}:void 0,tabIndex:Number(t.getTabIndex(p)),className:t.getMonthClassNames(p),"aria-disabled":t.isMonthDisabled(p),role:"option","aria-label":t.getAriaLabel(p),"aria-current":t.isCurrentMonth(i,p)?"date":void 0,"aria-selected":l?t.isSelectedMonth(i,p,l):void 0},t.getMonthContent(p))}))})},t.renderQuarters=function(){var n=t.props,a=n.day,s=n.selected,o=[1,2,3,4];return fe.createElement("div",{className:"react-datepicker__quarter-wrapper"},o.map(function(i,l){return fe.createElement("div",{key:l,ref:t.QUARTER_REFS[l],role:"option",onClick:function(c){t.onQuarterClick(c,i)},onKeyDown:function(c){t.onQuarterKeyDown(c,i)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(i)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(i)}:void 0,className:t.getQuarterClassNames(i),"aria-selected":s?t.isSelectedQuarter(a,i,s):void 0,tabIndex:Number(t.getQuarterTabIndex(i)),"aria-current":t.isCurrentQuarter(a,i)?"date":void 0},t.getQuarterContent(i))}))},t.getClassNames=function(){var n=t.props,a=n.selectingDate,s=n.selectsStart,o=n.selectsEnd,i=n.showMonthYearPicker,l=n.showQuarterYearPicker,c=n.showWeekPicker;return ur("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(s||o)},{"react-datepicker__monthPicker":i},{"react-datepicker__quarterPicker":l},{"react-datepicker__weekPicker":c})},t}return r.prototype.getSelection=function(){var t=this.props,n=t.selected,a=t.selectedDates,s=t.selectsMultiple;if(s)return a;if(n)return[n]},r.prototype.render=function(){var t=this.props,n=t.showMonthYearPicker,a=t.showQuarterYearPicker,s=t.day,o=t.ariaLabelPrefix,i=o===void 0?"Month ":o,l=i?i.trim()+" ":"";return fe.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(l).concat(Ot(s,"MMMM, yyyy",this.props.locale)),role:"listbox"},n?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},r}(S.Component),JR=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(n){return t.props.month===n},t.renderOptions=function(){return t.props.monthNames.map(function(n,a){return fe.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:n,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?fe.createElement("span",{className:"react-datepicker__month-option--selected"},"✓"):"",n)})},t.onChange=function(n){return t.props.onChange(n)},t.handleClickOutside=function(){return t.props.onCancel()},t}return r.prototype.render=function(){return fe.createElement(O0,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},r}(S.Component),e8=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(n){return n.map(function(a,s){return fe.createElement("option",{key:a,value:s},a)})},t.renderSelectMode=function(n){return fe.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(n))},t.renderReadView=function(n,a){return fe.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},fe.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),fe.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(n){return fe.createElement(JR,ot({key:"dropdown"},t.props,{monthNames:n,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(n){var a=t.state.dropdownVisible,s=[t.renderReadView(!a,n)];return a&&s.unshift(t.renderDropdown(n)),s},t.onChange=function(n){t.toggleDropdown(),n!==t.props.month&&t.props.onChange(n)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return r.prototype.render=function(){var t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(s){return Yk(s,t.props.locale)}:function(s){return $h(s,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(n);break;case"select":a=this.renderSelectMode(n);break}return fe.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},r}(S.Component);function t8(e,r){for(var t=[],n=Ca(e),a=Ca(r);!ps(n,a);)t.push(dt(n)),n=zn(n,1);return t}var r8=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(a){var s=Vd(a),o=Xn(n.props.date,a)&&Or(n.props.date,a);return fe.createElement("div",{className:o?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:s,onClick:n.onChange.bind(n,s),"aria-selected":o?"true":void 0},o?fe.createElement("span",{className:"react-datepicker__month-year-option--selected"},"✓"):"",Ot(a,n.props.dateFormat,n.props.locale))})},n.onChange=function(a){return n.props.onChange(a)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:t8(n.props.minDate,n.props.maxDate)},n}return r.prototype.render=function(){var t=ur({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return fe.createElement(O0,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},r}(S.Component),n8=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var n=Ca(t.props.minDate),a=Ca(t.props.maxDate),s=[];!ps(n,a);){var o=Vd(n);s.push(fe.createElement("option",{key:o,value:o},Ot(n,t.props.dateFormat,t.props.locale))),n=zn(n,1)}return s},t.onSelectChange=function(n){t.onChange(parseInt(n.target.value))},t.renderSelectMode=function(){return fe.createElement("select",{value:Vd(Ca(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(n){var a=Ot(t.props.date,t.props.dateFormat,t.props.locale);return fe.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},fe.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),fe.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return fe.createElement(r8,ot({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var n=t.state.dropdownVisible,a=[t.renderReadView(!n)];return n&&a.unshift(t.renderDropdown()),a},t.onChange=function(n){t.toggleDropdown();var a=dt(n);Xn(t.props.date,a)&&Or(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return r.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return fe.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},r}(S.Component),a8=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var n,a,s;t.list&&(t.list.scrollTop=(s=t.centerLi&&r.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(n=t.header)===null||n===void 0?void 0:n.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&s!==void 0?s:0)})},t.handleClick=function(n){var a,s;(t.props.minTime||t.props.maxTime)&&Mg(n,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&Pg(n,t.props)||(s=(a=t.props).onChange)===null||s===void 0||s.call(a,n)},t.isSelectedTime=function(n){return t.props.selected&&VR(t.props.selected,n)},t.isDisabledTime=function(n){return(t.props.minTime||t.props.maxTime)&&Mg(n,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&Pg(n,t.props)},t.liClasses=function(n){var a,s=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(n):void 0];return t.isSelectedTime(n)&&s.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(n)&&s.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(Sa(n)*3600+Ta(n)*60+is(n))%(((a=t.props.intervals)!==null&&a!==void 0?a:r.defaultProps.intervals)*60)!==0&&s.push("react-datepicker__time-list-item--injected"),s.join(" ")},t.handleOnKeyDown=function(n,a){var s,o;n.key===De.Space&&(n.preventDefault(),n.key=De.Enter),(n.key===De.ArrowUp||n.key===De.ArrowLeft)&&n.target instanceof HTMLElement&&n.target.previousSibling&&(n.preventDefault(),n.target.previousSibling instanceof HTMLElement&&n.target.previousSibling.focus()),(n.key===De.ArrowDown||n.key===De.ArrowRight)&&n.target instanceof HTMLElement&&n.target.nextSibling&&(n.preventDefault(),n.target.nextSibling instanceof HTMLElement&&n.target.nextSibling.focus()),n.key===De.Enter&&t.handleClick(a),(o=(s=t.props).handleOnKeyDown)===null||o===void 0||o.call(s,n)},t.renderTimes=function(){for(var n,a=[],s=typeof t.props.format=="string"?t.props.format:"p",o=(n=t.props.intervals)!==null&&n!==void 0?n:r.defaultProps.intervals,i=t.props.selected||t.props.openToDate||dt(),l=eu(i),c=t.props.injectTimes&&t.props.injectTimes.sort(function(y,g){return y.getTime()-g.getTime()}),u=60*YR(i),d=u/o,p=0;p<d;p++){var h=$d(l,p*o);if(a.push(h),c){var x=HR(l,h,p,o,c);a=a.concat(x)}}var m=a.reduce(function(y,g){return g.getTime()<=i.getTime()?g:y},a[0]);return a.map(function(y){return fe.createElement("li",{key:y.valueOf(),onClick:t.handleClick.bind(t,y),className:t.liClasses(y),ref:function(g){y===m&&(t.centerLi=g)},onKeyDown:function(g){t.handleOnKeyDown(g,y)},tabIndex:y===m?0:-1,role:"option","aria-selected":t.isSelectedTime(y)?"true":void 0,"aria-disabled":t.isDisabledTime(y)?"true":void 0},Ot(y,s,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?fe.createElement(fe.Fragment,null):fe.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(n){t.header=n}},fe.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(r,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),r.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},r.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},r.prototype.observeDatePickerHeightChanges=function(){var t=this,n=this.props.monthRef;this.updateContainerHeight(),n&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(n))},r.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},r.prototype.render=function(){var t=this,n,a=this.state.height;return fe.createElement("div",{className:"react-datepicker__time-container ".concat(((n=this.props.todayButton)!==null&&n!==void 0?n:r.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),fe.createElement("div",{className:"react-datepicker__time"},fe.createElement("div",{className:"react-datepicker__time-box"},fe.createElement("ul",{className:"react-datepicker__time-list",ref:function(s){t.list=s},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},r.calcCenterPosition=function(t,n){return n.offsetTop-(t/2-n.clientHeight/2)},r}(S.Component),Yg=3,s8=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;return n.YEAR_REFS=ta([],Array(n.props.yearItemNumber),!0).map(function(){return S.createRef()}),n.isDisabled=function(a){return mn(a,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(a){return Hh(a,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var a;return(a=n.props.selectingDate)!==null&&a!==void 0?a:n.props.preSelection},n.updateFocusOnPaginate=function(a){var s=function(){var o,i;(i=(o=n.YEAR_REFS[a])===null||o===void 0?void 0:o.current)===null||i===void 0||i.focus()};window.requestAnimationFrame(s)},n.handleYearClick=function(a,s){n.props.onDayClick&&n.props.onDayClick(a,s)},n.handleYearNavigation=function(a,s){var o,i,l,c,u=n.props,d=u.date,p=u.yearItemNumber;if(!(d===void 0||p===void 0)){var h=qa(d,p).startPeriod;n.isDisabled(s)||n.isExcluded(s)||((i=(o=n.props).setPreSelection)===null||i===void 0||i.call(o,s),a-h<0?n.updateFocusOnPaginate(p-(h-a)):a-h>=p?n.updateFocusOnPaginate(Math.abs(p-(a-h))):(c=(l=n.YEAR_REFS[a-h])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus())}},n.isSameDay=function(a,s){return st(a,s)},n.isCurrentYear=function(a){return a===Xe(dt())},n.isRangeStart=function(a){return n.props.startDate&&n.props.endDate&&Xn(Gn(dt(),a),n.props.startDate)},n.isRangeEnd=function(a){return n.props.startDate&&n.props.endDate&&Xn(Gn(dt(),a),n.props.endDate)},n.isInRange=function(a){return Mc(a,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(a){var s=n.props,o=s.selectsStart,i=s.selectsEnd,l=s.selectsRange,c=s.startDate,u=s.endDate;return!(o||i||l)||!n.selectingDate()?!1:o&&u?Mc(a,n.selectingDate(),u):i&&c||l&&c&&!u?Mc(a,c,n.selectingDate()):!1},n.isSelectingRangeStart=function(a){var s;if(!n.isInSelectingRange(a))return!1;var o=n.props,i=o.startDate,l=o.selectsStart,c=Gn(dt(),a);return l?Xn(c,(s=n.selectingDate())!==null&&s!==void 0?s:null):Xn(c,i??null)},n.isSelectingRangeEnd=function(a){var s;if(!n.isInSelectingRange(a))return!1;var o=n.props,i=o.endDate,l=o.selectsEnd,c=o.selectsRange,u=Gn(dt(),a);return l||c?Xn(u,(s=n.selectingDate())!==null&&s!==void 0?s:null):Xn(u,i??null)},n.isKeyboardSelected=function(a){if(!(n.props.date===void 0||n.props.selected==null||n.props.preSelection==null)){var s=n.props,o=s.minDate,i=s.maxDate,l=s.excludeDates,c=s.includeDates,u=s.filterDate,d=Bi(Gn(n.props.date,a)),p=(o||i||l||c||u)&&tu(a,n.props);return!n.props.disabledKeyboardNavigation&&!n.props.inline&&!st(d,Bi(n.props.selected))&&st(d,Bi(n.props.preSelection))&&!p}},n.isSelectedYear=function(a){var s=n.props,o=s.selectsMultiple,i=s.selected,l=s.selectedDates;return o?l==null?void 0:l.some(function(c){return a===Xe(c)}):!i||a===Xe(i)},n.onYearClick=function(a,s){var o=n.props.date;o!==void 0&&n.handleYearClick(Bi(Gn(o,s)),a)},n.onYearKeyDown=function(a,s){var o,i,l=a.key,c=n.props,u=c.date,d=c.yearItemNumber,p=c.handleOnKeyDown;if(l!==De.Tab&&a.preventDefault(),!n.props.disabledKeyboardNavigation)switch(l){case De.Enter:if(n.props.selected==null)break;n.onYearClick(a,s),(i=(o=n.props).setPreSelection)===null||i===void 0||i.call(o,n.props.selected);break;case De.ArrowRight:if(n.props.preSelection==null)break;n.handleYearNavigation(s+1,ba(n.props.preSelection,1));break;case De.ArrowLeft:if(n.props.preSelection==null)break;n.handleYearNavigation(s-1,ai(n.props.preSelection,1));break;case De.ArrowUp:{if(u===void 0||d===void 0||n.props.preSelection==null)break;var h=qa(u,d).startPeriod,x=Yg,m=s-x;if(m<h){var y=d%x;s>=h&&s<h+y?x=y:x+=y,m=s-x}n.handleYearNavigation(m,ai(n.props.preSelection,x));break}case De.ArrowDown:{if(u===void 0||d===void 0||n.props.preSelection==null)break;var g=qa(u,d).endPeriod,x=Yg,m=s+x;if(m>g){var y=d%x;s<=g&&s>g-y?x=y:x+=y,m=s+x}n.handleYearNavigation(m,ba(n.props.preSelection,x));break}}p&&p(a)},n.getYearClassNames=function(a){var s=n.props,o=s.date,i=s.minDate,l=s.maxDate,c=s.excludeDates,u=s.includeDates,d=s.filterDate,p=s.yearClassName;return ur("react-datepicker__year-text","react-datepicker__year-".concat(a),o?p==null?void 0:p(Gn(o,a)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(a),"react-datepicker__year-text--disabled":(i||l||c||u||d)&&tu(a,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(a),"react-datepicker__year-text--range-start":n.isRangeStart(a),"react-datepicker__year-text--range-end":n.isRangeEnd(a),"react-datepicker__year-text--in-range":n.isInRange(a),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(a),"react-datepicker__year-text--today":n.isCurrentYear(a)})},n.getYearTabIndex=function(a){if(n.props.disabledKeyboardNavigation||n.props.preSelection==null)return"-1";var s=Xe(n.props.preSelection),o=tu(a,n.props);return a===s&&!o?"0":"-1"},n.getYearContent=function(a){return n.props.renderYearContent?n.props.renderYearContent(a):a},n}return r.prototype.render=function(){var t=this,n=[],a=this.props,s=a.date,o=a.yearItemNumber,i=a.onYearMouseEnter,l=a.onYearMouseLeave;if(s===void 0)return null;for(var c=qa(s,o),u=c.startPeriod,d=c.endPeriod,p=function(m){n.push(fe.createElement("div",{ref:h.YEAR_REFS[m-u],onClick:function(y){t.onYearClick(y,m)},onKeyDown:function(y){Xk(y)&&(y.preventDefault(),y.key=De.Enter),t.onYearKeyDown(y,m)},tabIndex:Number(h.getYearTabIndex(m)),className:h.getYearClassNames(m),onMouseEnter:h.props.usePointerEvent?void 0:function(y){return i(y,m)},onPointerEnter:h.props.usePointerEvent?function(y){return i(y,m)}:void 0,onMouseLeave:h.props.usePointerEvent?void 0:function(y){return l(y,m)},onPointerLeave:h.props.usePointerEvent?function(y){return l(y,m)}:void 0,key:m,"aria-current":h.isCurrentYear(m)?"date":void 0},h.getYearContent(m)))},h=this,x=u;x<=d;x++)p(x);return fe.createElement("div",{className:"react-datepicker__year"},fe.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},n))},r}(S.Component);function o8(e,r,t,n){for(var a=[],s=0;s<2*r+1;s++){var o=e+r-s,i=!0;t&&(i=Xe(t)<=o),n&&i&&(i=Xe(n)>=o),i&&a.push(o)}return a}var i8=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;n.renderOptions=function(){var i=n.props.year,l=n.state.yearsList.map(function(d){return fe.createElement("div",{className:i===d?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:d,onClick:n.onChange.bind(n,d),"aria-selected":i===d?"true":void 0},i===d?fe.createElement("span",{className:"react-datepicker__year-option--selected"},"✓"):"",d)}),c=n.props.minDate?Xe(n.props.minDate):null,u=n.props.maxDate?Xe(n.props.maxDate):null;return(!u||!n.state.yearsList.find(function(d){return d===u}))&&l.unshift(fe.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},fe.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!c||!n.state.yearsList.find(function(d){return d===c}))&&l.push(fe.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},fe.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),l},n.onChange=function(i){n.props.onChange(i)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(i){var l=n.state.yearsList.map(function(c){return c+i});n.setState({yearsList:l})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var a=t.yearDropdownItemNumber,s=t.scrollableYearDropdown,o=a||(s?10:5);return n.state={yearsList:o8(n.props.year,o,n.props.minDate,n.props.maxDate)},n.dropdownRef=S.createRef(),n}return r.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var n=t.children?Array.from(t.children):null,a=n?n.find(function(s){return s.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},r.prototype.render=function(){var t=ur({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return fe.createElement(O0,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},r}(S.Component),l8=function(e){ir(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var n=t.props.minDate?Xe(t.props.minDate):1900,a=t.props.maxDate?Xe(t.props.maxDate):2100,s=[],o=n;o<=a;o++)s.push(fe.createElement("option",{key:o,value:o},o));return s},t.onSelectChange=function(n){t.onChange(parseInt(n.target.value))},t.renderSelectMode=function(){return fe.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(n){return fe.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},fe.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),fe.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return fe.createElement(i8,ot({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var n=t.state.dropdownVisible,a=[t.renderReadView(!n)];return n&&a.unshift(t.renderDropdown()),a},t.onChange=function(n){t.toggleDropdown(),n!==t.props.year&&t.props.onChange(n)},t.toggleDropdown=function(n){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,n)})},t.handleYearChange=function(n,a){var s;(s=t.onSelect)===null||s===void 0||s.call(t,n,a),t.setOpen()},t.onSelect=function(n,a){var s,o;(o=(s=t.props).onSelect)===null||o===void 0||o.call(s,n,a)},t.setOpen=function(){var n,a;(a=(n=t.props).setOpen)===null||a===void 0||a.call(n,!0)},t}return r.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return fe.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},r}(S.Component),c8=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],u8=function(e){var r=(e.className||"").split(/\s+/);return c8.some(function(t){return r.indexOf(t)>=0})},f8=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;return n.monthContainer=void 0,n.handleClickOutside=function(a){n.props.onClickOutside(a)},n.setClickOutsideRef=function(){return n.containerRef.current},n.handleDropdownFocus=function(a){var s,o;u8(a.target)&&((o=(s=n.props).onDropdownFocus)===null||o===void 0||o.call(s,a))},n.getDateInView=function(){var a=n.props,s=a.preSelection,o=a.selected,i=a.openToDate,l=Kk(n.props),c=Gk(n.props),u=dt(),d=i||o||s;return d||(l&&Js(u,l)?l:c&&ps(u,c)?c:u)},n.increaseMonth=function(){n.setState(function(a){var s=a.date;return{date:zn(s,1)}},function(){return n.handleMonthChange(n.state.date)})},n.decreaseMonth=function(){n.setState(function(a){var s=a.date;return{date:Bs(s,1)}},function(){return n.handleMonthChange(n.state.date)})},n.handleDayClick=function(a,s,o){n.props.onSelect(a,s,o),n.props.setPreSelection&&n.props.setPreSelection(a)},n.handleDayMouseEnter=function(a){n.setState({selectingDate:a}),n.props.onDayMouseEnter&&n.props.onDayMouseEnter(a)},n.handleMonthMouseLeave=function(){n.setState({selectingDate:void 0}),n.props.onMonthMouseLeave&&n.props.onMonthMouseLeave()},n.handleYearMouseEnter=function(a,s){n.setState({selectingDate:Gn(dt(),s)}),n.props.onYearMouseEnter&&n.props.onYearMouseEnter(a,s)},n.handleYearMouseLeave=function(a,s){n.props.onYearMouseLeave&&n.props.onYearMouseLeave(a,s)},n.handleYearChange=function(a){var s,o,i,l;(o=(s=n.props).onYearChange)===null||o===void 0||o.call(s,a),n.setState({isRenderAriaLiveMessage:!0}),n.props.adjustDateOnChange&&(n.props.onSelect(a),(l=(i=n.props).setOpen)===null||l===void 0||l.call(i,!0)),n.props.setPreSelection&&n.props.setPreSelection(a)},n.getEnabledPreSelectionDateForMonth=function(a){if(!mn(a,n.props))return a;for(var s=Ca(a),o=OR(a),i=uO(o,s),l=null,c=0;c<=i;c++){var u=jn(s,c);if(!mn(u,n.props)){l=u;break}}return l},n.handleMonthChange=function(a){var s,o,i,l=(s=n.getEnabledPreSelectionDateForMonth(a))!==null&&s!==void 0?s:a;n.handleCustomMonthChange(l),n.props.adjustDateOnChange&&(n.props.onSelect(l),(i=(o=n.props).setOpen)===null||i===void 0||i.call(o,!0)),n.props.setPreSelection&&n.props.setPreSelection(l)},n.handleCustomMonthChange=function(a){var s,o;(o=(s=n.props).onMonthChange)===null||o===void 0||o.call(s,a),n.setState({isRenderAriaLiveMessage:!0})},n.handleMonthYearChange=function(a){n.handleYearChange(a),n.handleMonthChange(a)},n.changeYear=function(a){n.setState(function(s){var o=s.date;return{date:Gn(o,Number(a))}},function(){return n.handleYearChange(n.state.date)})},n.changeMonth=function(a){n.setState(function(s){var o=s.date;return{date:dn(o,Number(a))}},function(){return n.handleMonthChange(n.state.date)})},n.changeMonthYear=function(a){n.setState(function(s){var o=s.date;return{date:Gn(dn(o,Ir(a)),Xe(a))}},function(){return n.handleMonthYearChange(n.state.date)})},n.header=function(a){a===void 0&&(a=n.state.date);var s=ls(a,n.props.locale,n.props.calendarStartDay),o=[];return n.props.showWeekNumbers&&o.push(fe.createElement("div",{key:"W",className:"react-datepicker__day-name"},n.props.weekLabel||"#")),o.concat([0,1,2,3,4,5,6].map(function(i){var l=jn(s,i),c=n.formatWeekday(l,n.props.locale),u=n.props.weekDayClassName?n.props.weekDayClassName(l):void 0;return fe.createElement("div",{key:i,"aria-label":Ot(l,"EEEE",n.props.locale),className:ur("react-datepicker__day-name",u)},c)}))},n.formatWeekday=function(a,s){return n.props.formatWeekDay?PR(a,n.props.formatWeekDay,s):n.props.useWeekdaysShort?RR(a,s):MR(a,s)},n.decreaseYear=function(){n.setState(function(a){var s,o=a.date;return{date:ai(o,n.props.showYearPicker?(s=n.props.yearItemNumber)!==null&&s!==void 0?s:r.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.clearSelectingDate=function(){n.setState({selectingDate:void 0})},n.renderPreviousButton=function(){var a,s,o;if(!n.props.renderCustomHeader){var i=(a=n.props.monthsShown)!==null&&a!==void 0?a:r.defaultProps.monthsShown,l=n.props.showPreviousMonths?i-1:0,c=(s=n.props.monthSelectedIn)!==null&&s!==void 0?s:l,u=Bs(n.state.date,c),d;switch(!0){case n.props.showMonthYearPicker:d=jg(n.state.date,n.props);break;case n.props.showYearPicker:d=BR(n.state.date,n.props);break;case n.props.showQuarterYearPicker:d=LR(n.state.date,n.props);break;default:d=Rg(u,n.props);break}if(!(!((o=n.props.forceShowMonthNavigation)!==null&&o!==void 0?o:r.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&d||n.props.showTimeSelectOnly)){var p=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],h=["react-datepicker__navigation","react-datepicker__navigation--previous"],x=n.decreaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(x=n.decreaseYear),d&&n.props.showDisabledMonthNavigation&&(h.push("react-datepicker__navigation--previous--disabled"),x=void 0);var m=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,y=n.props,g=y.previousMonthButtonLabel,w=g===void 0?r.defaultProps.previousMonthButtonLabel:g,v=y.previousYearButtonLabel,b=v===void 0?r.defaultProps.previousYearButtonLabel:v,M=n.props,C=M.previousMonthAriaLabel,k=C===void 0?typeof w=="string"?w:"Previous Month":C,F=M.previousYearAriaLabel,E=F===void 0?typeof b=="string"?b:"Previous Year":F;return fe.createElement("button",{type:"button",className:h.join(" "),onClick:x,onKeyDown:n.props.handleOnKeyDown,"aria-label":m?E:k},fe.createElement("span",{className:p.join(" ")},m?b:w))}}},n.increaseYear=function(){n.setState(function(a){var s,o=a.date;return{date:ba(o,n.props.showYearPicker?(s=n.props.yearItemNumber)!==null&&s!==void 0?s:r.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.renderNextButton=function(){var a;if(!n.props.renderCustomHeader){var s;switch(!0){case n.props.showMonthYearPicker:s=Lg(n.state.date,n.props);break;case n.props.showYearPicker:s=WR(n.state.date,n.props);break;case n.props.showQuarterYearPicker:s=zR(n.state.date,n.props);break;default:s=Ig(n.state.date,n.props);break}if(!(!((a=n.props.forceShowMonthNavigation)!==null&&a!==void 0?a:r.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&s||n.props.showTimeSelectOnly)){var o=["react-datepicker__navigation","react-datepicker__navigation--next"],i=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];n.props.showTimeSelect&&o.push("react-datepicker__navigation--next--with-time"),n.props.todayButton&&o.push("react-datepicker__navigation--next--with-today-button");var l=n.increaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(l=n.increaseYear),s&&n.props.showDisabledMonthNavigation&&(o.push("react-datepicker__navigation--next--disabled"),l=void 0);var c=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,u=n.props,d=u.nextMonthButtonLabel,p=d===void 0?r.defaultProps.nextMonthButtonLabel:d,h=u.nextYearButtonLabel,x=h===void 0?r.defaultProps.nextYearButtonLabel:h,m=n.props,y=m.nextMonthAriaLabel,g=y===void 0?typeof p=="string"?p:"Next Month":y,w=m.nextYearAriaLabel,v=w===void 0?typeof x=="string"?x:"Next Year":w;return fe.createElement("button",{type:"button",className:o.join(" "),onClick:l,onKeyDown:n.props.handleOnKeyDown,"aria-label":c?v:g},fe.createElement("span",{className:i.join(" ")},c?x:p))}}},n.renderCurrentMonth=function(a){a===void 0&&(a=n.state.date);var s=["react-datepicker__current-month"];return n.props.showYearDropdown&&s.push("react-datepicker__current-month--hasYearDropdown"),n.props.showMonthDropdown&&s.push("react-datepicker__current-month--hasMonthDropdown"),n.props.showMonthYearDropdown&&s.push("react-datepicker__current-month--hasMonthYearDropdown"),fe.createElement("h2",{className:s.join(" ")},Ot(a,n.props.dateFormat,n.props.locale))},n.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!n.props.showYearDropdown||a))return fe.createElement(l8,ot({},r.defaultProps,n.props,{date:n.state.date,onChange:n.changeYear,year:Xe(n.state.date)}))},n.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!n.props.showMonthDropdown||a))return fe.createElement(e8,ot({},r.defaultProps,n.props,{month:Ir(n.state.date),onChange:n.changeMonth}))},n.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!n.props.showMonthYearDropdown||a))return fe.createElement(n8,ot({},r.defaultProps,n.props,{date:n.state.date,onChange:n.changeMonthYear}))},n.handleTodayButtonClick=function(a){n.props.onSelect(Fg(),a),n.props.setPreSelection&&n.props.setPreSelection(Fg())},n.renderTodayButton=function(){if(!(!n.props.todayButton||n.props.showTimeSelectOnly))return fe.createElement("div",{className:"react-datepicker__today-button",onClick:n.handleTodayButtonClick},n.props.todayButton)},n.renderDefaultHeader=function(a){var s=a.monthDate,o=a.i;return fe.createElement("div",{className:"react-datepicker__header ".concat(n.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},n.renderCurrentMonth(s),fe.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(n.props.dropdownMode),onFocus:n.handleDropdownFocus},n.renderMonthDropdown(o!==0),n.renderMonthYearDropdown(o!==0),n.renderYearDropdown(o!==0)),fe.createElement("div",{className:"react-datepicker__day-names"},n.header(s)))},n.renderCustomHeader=function(a){var s,o,i=a.monthDate,l=a.i;if(n.props.showTimeSelect&&!n.state.monthContainer||n.props.showTimeSelectOnly)return null;var c=Rg(n.state.date,n.props),u=Ig(n.state.date,n.props),d=jg(n.state.date,n.props),p=Lg(n.state.date,n.props),h=!n.props.showMonthYearPicker&&!n.props.showQuarterYearPicker&&!n.props.showYearPicker;return fe.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:n.props.onDropdownFocus},(o=(s=n.props).renderCustomHeader)===null||o===void 0?void 0:o.call(s,ot(ot({},n.state),{customHeaderCount:l,monthDate:i,changeMonth:n.changeMonth,changeYear:n.changeYear,decreaseMonth:n.decreaseMonth,increaseMonth:n.increaseMonth,decreaseYear:n.decreaseYear,increaseYear:n.increaseYear,prevMonthButtonDisabled:c,nextMonthButtonDisabled:u,prevYearButtonDisabled:d,nextYearButtonDisabled:p})),h&&fe.createElement("div",{className:"react-datepicker__day-names"},n.header(i)))},n.renderYearHeader=function(a){var s=a.monthDate,o=n.props,i=o.showYearPicker,l=o.yearItemNumber,c=l===void 0?r.defaultProps.yearItemNumber:l,u=qa(s,c),d=u.startPeriod,p=u.endPeriod;return fe.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},i?"".concat(d," - ").concat(p):Xe(s))},n.renderHeader=function(a){var s=a.monthDate,o=a.i,i=o===void 0?0:o,l={monthDate:s,i};switch(!0){case n.props.renderCustomHeader!==void 0:return n.renderCustomHeader(l);case(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker):return n.renderYearHeader(l);default:return n.renderDefaultHeader(l)}},n.renderMonths=function(){var a,s;if(!(n.props.showTimeSelectOnly||n.props.showYearPicker)){for(var o=[],i=(a=n.props.monthsShown)!==null&&a!==void 0?a:r.defaultProps.monthsShown,l=n.props.showPreviousMonths?i-1:0,c=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?ba(n.state.date,l):Bs(n.state.date,l),u=(s=n.props.monthSelectedIn)!==null&&s!==void 0?s:l,d=0;d<i;++d){var p=d-u+l,h=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?ba(c,p):zn(c,p),x="month-".concat(d),m=d<i-1,y=d>0;o.push(fe.createElement("div",{key:x,ref:function(g){n.monthContainer=g??void 0},className:"react-datepicker__month-container"},n.renderHeader({monthDate:h,i:d}),fe.createElement(ZR,ot({},r.defaultProps,n.props,{containerRef:n.containerRef,ariaLabelPrefix:n.props.monthAriaLabelPrefix,day:h,onDayClick:n.handleDayClick,handleOnKeyDown:n.props.handleOnDayKeyDown,handleOnMonthKeyDown:n.props.handleOnKeyDown,onDayMouseEnter:n.handleDayMouseEnter,onMouseLeave:n.handleMonthMouseLeave,orderInDisplay:d,selectingDate:n.state.selectingDate,monthShowsDuplicateDaysEnd:m,monthShowsDuplicateDaysStart:y}))))}return o}},n.renderYears=function(){if(!n.props.showTimeSelectOnly&&n.props.showYearPicker)return fe.createElement("div",{className:"react-datepicker__year--container"},n.renderHeader({monthDate:n.state.date}),fe.createElement(s8,ot({},r.defaultProps,n.props,{selectingDate:n.state.selectingDate,date:n.state.date,onDayClick:n.handleDayClick,clearSelectingDate:n.clearSelectingDate,onYearMouseEnter:n.handleYearMouseEnter,onYearMouseLeave:n.handleYearMouseLeave})))},n.renderTimeSection=function(){if(n.props.showTimeSelect&&(n.state.monthContainer||n.props.showTimeSelectOnly))return fe.createElement(a8,ot({},r.defaultProps,n.props,{onChange:n.props.onTimeChange,format:n.props.timeFormat,intervals:n.props.timeIntervals,monthRef:n.state.monthContainer}))},n.renderInputTimeSection=function(){var a=n.props.selected?new Date(n.props.selected):void 0,s=a&&P0(a)&&!!n.props.selected,o=s?"".concat(Bg(a.getHours()),":").concat(Bg(a.getMinutes())):"";if(n.props.showTimeInput)return fe.createElement(KR,ot({},r.defaultProps,n.props,{date:a,timeString:o,onChange:n.props.onTimeChange}))},n.renderAriaLiveRegion=function(){var a,s=qa(n.state.date,(a=n.props.yearItemNumber)!==null&&a!==void 0?a:r.defaultProps.yearItemNumber),o=s.startPeriod,i=s.endPeriod,l;return n.props.showYearPicker?l="".concat(o," - ").concat(i):n.props.showMonthYearPicker||n.props.showQuarterYearPicker?l=Xe(n.state.date):l="".concat($h(Ir(n.state.date),n.props.locale)," ").concat(Xe(n.state.date)),fe.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},n.state.isRenderAriaLiveMessage&&l)},n.renderChildren=function(){if(n.props.children)return fe.createElement("div",{className:"react-datepicker__children-container"},n.props.children)},n.containerRef=S.createRef(),n.state={date:n.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},n}return Object.defineProperty(r,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:ec}},enumerable:!1,configurable:!0}),r.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=function(){t.setState({monthContainer:t.monthContainer})}())},r.prototype.componentDidUpdate=function(t){var n=this;if(this.props.preSelection&&(!st(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!Or(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&n.handleCustomMonthChange(n.state.date)})}else this.props.openToDate&&!st(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},r.prototype.render=function(){var t=this.props.container||SR;return fe.createElement(O0,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},fe.createElement("div",{style:{display:"contents"},ref:this.containerRef},fe.createElement(t,{className:ur("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},r}(S.Component),d8=function(e){var r=e.icon,t=e.className,n=t===void 0?"":t,a=e.onClick,s="react-datepicker__calendar-icon";if(typeof r=="string")return fe.createElement("i",{className:"".concat(s," ").concat(r," ").concat(n),"aria-hidden":"true",onClick:a});if(fe.isValidElement(r)){var o=r;return fe.cloneElement(o,{className:"".concat(o.props.className||""," ").concat(s," ").concat(n),onClick:function(i){typeof o.props.onClick=="function"&&o.props.onClick(i),typeof a=="function"&&a(i)}})}return fe.createElement("svg",{className:"".concat(s," ").concat(n),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},fe.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},Qk=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return r.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},r.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},r.prototype.render=function(){return jb.createPortal(this.props.children,this.el)},r}(S.Component),p8="[tabindex], a, button, input, select, textarea",h8=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},qk=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;return n.getTabChildren=function(){var a;return Array.prototype.slice.call((a=n.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(p8),1,-1).filter(h8)},n.handleFocusStart=function(){var a=n.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},n.handleFocusEnd=function(){var a=n.getTabChildren();a&&a.length>1&&a[0].focus()},n.tabLoopRef=S.createRef(),n}return r.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:r.defaultProps.enableTabLoop)?fe.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},fe.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,fe.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},r.defaultProps={enableTabLoop:!0},r}(S.Component);function m8(e){var r=function(t){var n,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,s=S.useRef(null),o=ER(ot({open:!a,whileElementsMounted:Bk,placement:t.popperPlacement,middleware:ta([fR({padding:15}),uR(10),dR({element:s})],(n=t.popperModifiers)!==null&&n!==void 0?n:[],!0)},t.popperProps)),i=ot(ot({},t),{hidePopper:a,popperProps:ot(ot({},o),{arrowRef:s})});return fe.createElement(e,ot({},i))};return r}var x8=function(e){ir(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(r,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),r.prototype.render=function(){var t=this.props,n=t.className,a=t.wrapperClassName,s=t.hidePopper,o=s===void 0?r.defaultProps.hidePopper:s,i=t.popperComponent,l=t.targetComponent,c=t.enableTabLoop,u=t.popperOnKeyDown,d=t.portalId,p=t.portalHost,h=t.popperProps,x=t.showArrow,m=void 0;if(!o){var y=ur("react-datepicker-popper",n);m=fe.createElement(qk,{enableTabLoop:c},fe.createElement("div",{ref:h.refs.setFloating,style:h.floatingStyles,className:y,"data-placement":h.placement,onKeyDown:u},i,x&&fe.createElement(gR,{ref:h.arrowRef,context:h.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(m=S.createElement(this.props.popperContainer,{},m)),d&&!o&&(m=fe.createElement(Qk,{portalId:d,portalHost:p},m));var g=ur("react-datepicker-wrapper",a);return fe.createElement(fe.Fragment,null,fe.createElement("div",{ref:h.refs.setReference,className:g},l),m)},r}(S.Component),g8=m8(x8),Vg="react-datepicker-ignore-onclickoutside";function v8(e,r){return e&&r?Ir(e)!==Ir(r)||Xe(e)!==Xe(r):e!==r}var Sf="Date input not valid.",ms=function(e){ir(r,e);function r(t){var n=e.call(this,t)||this;return n.calendar=null,n.input=null,n.getPreSelection=function(){return n.props.openToDate?n.props.openToDate:n.props.selectsEnd&&n.props.startDate?n.props.startDate:n.props.selectsStart&&n.props.endDate?n.props.endDate:dt()},n.modifyHolidays=function(){var a;return(a=n.props.holidays)===null||a===void 0?void 0:a.reduce(function(s,o){var i=new Date(o.date);return P0(i)?ta(ta([],s,!0),[ot(ot({},o),{date:i})],!1):s},[])},n.calcInitialState=function(){var a,s=n.getPreSelection(),o=Kk(n.props),i=Gk(n.props),l=o&&Js(s,eu(o))?o:i&&ps(s,Ag(i))?i:s;return{open:n.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=n.props.selectsRange?n.props.startDate:n.props.selected)!==null&&a!==void 0?a:l,highlightDates:zg(n.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},n.resetHiddenStatus=function(){n.setState(ot(ot({},n.state),{wasHidden:!1}))},n.setHiddenStatus=function(){n.setState(ot(ot({},n.state),{wasHidden:!0}))},n.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&n.setHiddenStatus()},n.clearPreventFocusTimeout=function(){n.preventFocusTimeout&&clearTimeout(n.preventFocusTimeout)},n.setFocus=function(){var a,s;(s=(a=n.input)===null||a===void 0?void 0:a.focus)===null||s===void 0||s.call(a,{preventScroll:!0})},n.setBlur=function(){var a,s;(s=(a=n.input)===null||a===void 0?void 0:a.blur)===null||s===void 0||s.call(a),n.cancelFocusInput()},n.deferBlur=function(){requestAnimationFrame(function(){n.setBlur()})},n.setOpen=function(a,s){s===void 0&&(s=!1),n.setState({open:a,preSelection:a&&n.state.open?n.state.preSelection:n.calcInitialState().preSelection,lastPreSelectChange:Tf},function(){a||n.setState(function(o){return{focused:s?o.focused:!1}},function(){!s&&n.deferBlur(),n.setState({inputValue:null})})})},n.inputOk=function(){return Ea(n.state.preSelection)},n.isCalendarOpen=function(){return n.props.open===void 0?n.state.open&&!n.props.disabled&&!n.props.readOnly:n.props.open},n.handleFocus=function(a){var s,o,i=n.state.wasHidden,l=i?n.state.open:!0;i&&n.resetHiddenStatus(),n.state.preventFocus||((o=(s=n.props).onFocus)===null||o===void 0||o.call(s,a),l&&!n.props.preventOpenOnFocus&&!n.props.readOnly&&n.setOpen(!0)),n.setState({focused:!0})},n.sendFocusBackToInput=function(){n.preventFocusTimeout&&n.clearPreventFocusTimeout(),n.setState({preventFocus:!0},function(){n.preventFocusTimeout=setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})})},n.cancelFocusInput=function(){clearTimeout(n.inputFocusTimeout),n.inputFocusTimeout=void 0},n.deferFocusInput=function(){n.cancelFocusInput(),n.inputFocusTimeout=setTimeout(function(){return n.setFocus()},1)},n.handleDropdownFocus=function(){n.cancelFocusInput()},n.handleBlur=function(a){var s,o;(!n.state.open||n.props.withPortal||n.props.showTimeInput)&&((o=(s=n.props).onBlur)===null||o===void 0||o.call(s,a)),n.state.open&&n.props.open===!1&&n.setOpen(!1),n.setState({focused:!1})},n.handleCalendarClickOutside=function(a){var s,o;n.props.inline||n.setOpen(!1),(o=(s=n.props).onClickOutside)===null||o===void 0||o.call(s,a),n.props.withPortal&&a.preventDefault()},n.handleChange=function(){for(var a,s,o,i,l,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=c[0];if(!(n.props.onChangeRaw&&(n.props.onChangeRaw.apply(n,c),!d||typeof d.isDefaultPrevented!="function"||d.isDefaultPrevented()))){n.setState({inputValue:(d==null?void 0:d.target)instanceof HTMLInputElement?d.target.value:null,lastPreSelectChange:y8});var p=n.props,h=p.selectsRange,x=p.startDate,m=p.endDate,y=(a=n.props.dateFormat)!==null&&a!==void 0?a:r.defaultProps.dateFormat,g=(s=n.props.strictParsing)!==null&&s!==void 0?s:r.defaultProps.strictParsing,w=(d==null?void 0:d.target)instanceof HTMLInputElement?d.target.value:"";if(h){var v=w.split("-",2).map(function(V){return V.trim()}),b=v[0],M=v[1],C=_f(b??"",y,n.props.locale,g),k=_f(M??"",y,n.props.locale,g),F=(x==null?void 0:x.getTime())!==(C==null?void 0:C.getTime()),E=(m==null?void 0:m.getTime())!==(k==null?void 0:k.getTime());if(!F&&!E||C&&mn(C,n.props)||k&&mn(k,n.props))return;(i=(o=n.props).onChange)===null||i===void 0||i.call(o,[C,k],d)}else{var j=_f(w,y,n.props.locale,g,(l=n.props.selected)!==null&&l!==void 0?l:void 0);(j||!w)&&n.setSelected(j,d,!0)}}},n.handleSelect=function(a,s,o){if(n.props.shouldCloseOnSelect&&!n.props.showTimeSelect&&n.sendFocusBackToInput(),n.props.onChangeRaw&&n.props.onChangeRaw(s),n.setSelected(a,s,!1,o),n.props.showDateSelect&&n.setState({isRenderAriaLiveMessage:!0}),!n.props.shouldCloseOnSelect||n.props.showTimeSelect)n.setPreSelection(a);else if(!n.props.inline){n.props.selectsRange||n.setOpen(!1);var i=n.props,l=i.startDate,c=i.endDate;l&&!c&&(n.props.swapRange||!$g(a,l))&&n.setOpen(!1)}},n.setSelected=function(a,s,o,i){var l,c,u=a;if(n.props.showYearPicker){if(u!==null&&tu(Xe(u),n.props))return}else if(n.props.showMonthYearPicker){if(u!==null&&Vk(u,n.props))return}else if(u!==null&&mn(u,n.props))return;var d=n.props,p=d.onChange,h=d.selectsRange,x=d.startDate,m=d.endDate,y=d.selectsMultiple,g=d.selectedDates,w=d.minTime,v=d.swapRange;if(!As(n.props.selected,u)||n.props.allowSameDay||h||y)if(u!==null&&(n.props.selected&&(!o||!n.props.showTimeSelect&&!n.props.showTimeSelectOnly&&!n.props.showTimeInput)&&(u=bf(u,{hour:Sa(n.props.selected),minute:Ta(n.props.selected),second:is(n.props.selected)})),!o&&(n.props.showTimeSelect||n.props.showTimeSelectOnly)&&w&&(u=bf(u,{hour:w.getHours(),minute:w.getMinutes(),second:w.getSeconds()})),n.props.inline||n.setState({preSelection:u}),n.props.focusSelectedMonth||n.setState({monthSelectedIn:i})),h){var b=!x&&!m,M=x&&!m,C=x&&m;b?p==null||p([u,null],s):M&&(u===null?p==null||p([null,null],s):$g(u,x)?v?p==null||p([u,x],s):p==null||p([u,null],s):p==null||p([x,u],s)),C&&(p==null||p([u,null],s))}else if(y){if(u!==null)if(!(g!=null&&g.length))p==null||p([u],s);else{var k=g.some(function(E){return st(E,u)});if(k){var F=g.filter(function(E){return!st(E,u)});p==null||p(F,s)}else p==null||p(ta(ta([],g,!0),[u],!1),s)}}else p==null||p(u,s);o||((c=(l=n.props).onSelect)===null||c===void 0||c.call(l,u,s),n.setState({inputValue:null}))},n.setPreSelection=function(a){var s=Ea(n.props.minDate),o=Ea(n.props.maxDate),i=!0;if(a){var l=eu(a);if(s&&o)i=Wi(a,n.props.minDate,n.props.maxDate);else if(s){var c=eu(n.props.minDate);i=ps(a,c)||As(l,c)}else if(o){var u=Ag(n.props.maxDate);i=Js(a,u)||As(l,u)}}i&&n.setState({preSelection:a})},n.toggleCalendar=function(){n.setOpen(!n.state.open)},n.handleTimeChange=function(a){var s,o;if(!(n.props.selectsRange||n.props.selectsMultiple)){var i=n.props.selected?n.props.selected:n.getPreSelection(),l=n.props.selected?a:bf(i,{hour:Sa(a),minute:Ta(a)});n.setState({preSelection:l}),(o=(s=n.props).onChange)===null||o===void 0||o.call(s,l),n.props.shouldCloseOnSelect&&!n.props.showTimeInput&&(n.sendFocusBackToInput(),n.setOpen(!1)),n.props.showTimeInput&&n.setOpen(!0),(n.props.showTimeSelectOnly||n.props.showTimeSelect)&&n.setState({isRenderAriaLiveMessage:!0}),n.setState({inputValue:null})}},n.onInputClick=function(){var a,s;!n.props.disabled&&!n.props.readOnly&&n.setOpen(!0),(s=(a=n.props).onInputClick)===null||s===void 0||s.call(a)},n.onInputKeyDown=function(a){var s,o,i,l,c,u;(o=(s=n.props).onKeyDown)===null||o===void 0||o.call(s,a);var d=a.key;if(!n.state.open&&!n.props.inline&&!n.props.preventOpenOnFocus){(d===De.ArrowDown||d===De.ArrowUp||d===De.Enter)&&((i=n.onInputClick)===null||i===void 0||i.call(n));return}if(n.state.open){if(d===De.ArrowDown||d===De.ArrowUp){a.preventDefault();var p=n.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":n.props.showWeekPicker&&n.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':n.props.showFullMonthYearPicker||n.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',h=((l=n.calendar)===null||l===void 0?void 0:l.containerRef.current)instanceof Element&&n.calendar.containerRef.current.querySelector(p);h instanceof HTMLElement&&h.focus({preventScroll:!0});return}var x=dt(n.state.preSelection);d===De.Enter?(a.preventDefault(),a.target.blur(),n.inputOk()&&n.state.lastPreSelectChange===Tf?(n.handleSelect(x,a),!n.props.shouldCloseOnSelect&&n.setPreSelection(x)):n.setOpen(!1)):d===De.Escape?(a.preventDefault(),a.target.blur(),n.sendFocusBackToInput(),n.setOpen(!1)):d===De.Tab&&n.setOpen(!1),n.inputOk()||(u=(c=n.props).onInputError)===null||u===void 0||u.call(c,{code:1,msg:Sf})}},n.onPortalKeyDown=function(a){var s=a.key;s===De.Escape&&(a.preventDefault(),n.setState({preventFocus:!0},function(){n.setOpen(!1),setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})}))},n.onDayKeyDown=function(a){var s,o,i,l,c,u,d=n.props,p=d.minDate,h=d.maxDate,x=d.disabledKeyboardNavigation,m=d.showWeekPicker,y=d.shouldCloseOnSelect,g=d.locale,w=d.calendarStartDay,v=d.adjustDateOnChange,b=d.inline;if((o=(s=n.props).onKeyDown)===null||o===void 0||o.call(s,a),!x){var M=a.key,C=a.shiftKey,k=dt(n.state.preSelection),F=function(J,ne){var B=ne;switch(J){case De.ArrowRight:B=m?Uu(ne,1):jn(ne,1);break;case De.ArrowLeft:B=m?kg(ne):uM(ne);break;case De.ArrowUp:B=kg(ne);break;case De.ArrowDown:B=Uu(ne,1);break;case De.PageUp:B=C?ai(ne,1):Bs(ne,1);break;case De.PageDown:B=C?ba(ne,1):zn(ne,1);break;case De.Home:B=ls(ne,g,w);break;case De.End:B=AR(ne);break}return B},E=function(J,ne){for(var B=40,q=J,N=!1,U=0,Z=F(J,ne);!N;){if(U>=B){Z=ne;break}p&&Z<p&&(q=De.ArrowRight,Z=mn(p,n.props)?F(q,Z):p),h&&Z>h&&(q=De.ArrowLeft,Z=mn(h,n.props)?F(q,Z):h),mn(Z,n.props)?((q===De.PageUp||q===De.Home)&&(q=De.ArrowRight),(q===De.PageDown||q===De.End)&&(q=De.ArrowLeft),Z=F(q,Z)):N=!0,U++}return Z};if(M===De.Enter){a.preventDefault(),n.handleSelect(k,a),!y&&n.setPreSelection(k);return}else if(M===De.Escape){a.preventDefault(),n.setOpen(!1),n.inputOk()||(l=(i=n.props).onInputError)===null||l===void 0||l.call(i,{code:1,msg:Sf});return}var j=null;switch(M){case De.ArrowLeft:case De.ArrowRight:case De.ArrowUp:case De.ArrowDown:case De.PageUp:case De.PageDown:case De.Home:case De.End:j=E(M,k);break}if(!j){(u=(c=n.props).onInputError)===null||u===void 0||u.call(c,{code:1,msg:Sf});return}if(a.preventDefault(),n.setState({lastPreSelectChange:Tf}),v&&n.setSelected(j),n.setPreSelection(j),b){var V=Ir(k),W=Ir(j),te=Xe(k),ee=Xe(j);V!==W||te!==ee?n.setState({shouldFocusDayInline:!0}):n.setState({shouldFocusDayInline:!1})}}},n.onPopperKeyDown=function(a){var s=a.key;s===De.Escape&&(a.preventDefault(),n.sendFocusBackToInput())},n.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),n.sendFocusBackToInput();var s=n.props,o=s.selectsRange,i=s.onChange;o?i==null||i([null,null],a):i==null||i(null,a),n.setState({inputValue:null})},n.clear=function(){n.onClearClick()},n.onScroll=function(a){typeof n.props.closeOnScroll=="boolean"&&n.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&n.setOpen(!1):typeof n.props.closeOnScroll=="function"&&n.props.closeOnScroll(a)&&n.setOpen(!1)},n.renderCalendar=function(){var a,s;return!n.props.inline&&!n.isCalendarOpen()?null:fe.createElement(f8,ot({showMonthYearDropdown:void 0,ref:function(o){n.calendar=o}},n.props,n.state,{setOpen:n.setOpen,dateFormat:(a=n.props.dateFormatCalendar)!==null&&a!==void 0?a:r.defaultProps.dateFormatCalendar,onSelect:n.handleSelect,onClickOutside:n.handleCalendarClickOutside,holidays:$R(n.modifyHolidays()),outsideClickIgnoreClass:Vg,onDropdownFocus:n.handleDropdownFocus,onTimeChange:n.handleTimeChange,className:n.props.calendarClassName,container:n.props.calendarContainer,handleOnKeyDown:n.props.onKeyDown,handleOnDayKeyDown:n.onDayKeyDown,setPreSelection:n.setPreSelection,dropdownMode:(s=n.props.dropdownMode)!==null&&s!==void 0?s:r.defaultProps.dropdownMode}),n.props.children)},n.renderAriaLiveRegion=function(){var a=n.props,s=a.dateFormat,o=s===void 0?r.defaultProps.dateFormat:s,i=a.locale,l=n.props.showTimeInput||n.props.showTimeSelect,c=l?"PPPPp":"PPPP",u;return n.props.selectsRange?u="Selected start date: ".concat(un(n.props.startDate,{dateFormat:c,locale:i}),". ").concat(n.props.endDate?"End date: "+un(n.props.endDate,{dateFormat:c,locale:i}):""):n.props.showTimeSelectOnly?u="Selected time: ".concat(un(n.props.selected,{dateFormat:o,locale:i})):n.props.showYearPicker?u="Selected year: ".concat(un(n.props.selected,{dateFormat:"yyyy",locale:i})):n.props.showMonthYearPicker?u="Selected month: ".concat(un(n.props.selected,{dateFormat:"MMMM yyyy",locale:i})):n.props.showQuarterYearPicker?u="Selected quarter: ".concat(un(n.props.selected,{dateFormat:"yyyy, QQQ",locale:i})):u="Selected date: ".concat(un(n.props.selected,{dateFormat:c,locale:i})),fe.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},u)},n.renderDateInput=function(){var a,s,o,i=ur(n.props.className,(a={},a[Vg]=n.state.open,a)),l=n.props.customInput||fe.createElement("input",{type:"text"}),c=n.props.customInputRef||"ref",u=n.props,d=u.dateFormat,p=d===void 0?r.defaultProps.dateFormat:d,h=u.locale,x=typeof n.props.value=="string"?n.props.value:typeof n.state.inputValue=="string"?n.state.inputValue:n.props.selectsRange?CR(n.props.startDate,n.props.endDate,{dateFormat:p,locale:h}):n.props.selectsMultiple?DR((o=n.props.selectedDates)!==null&&o!==void 0?o:[],{dateFormat:p,locale:h}):un(n.props.selected,{dateFormat:p,locale:h});return S.cloneElement(l,(s={},s[c]=function(m){n.input=m},s.value=x,s.onBlur=n.handleBlur,s.onChange=n.handleChange,s.onClick=n.onInputClick,s.onFocus=n.handleFocus,s.onKeyDown=n.onInputKeyDown,s.id=n.props.id,s.name=n.props.name,s.form=n.props.form,s.autoFocus=n.props.autoFocus,s.placeholder=n.props.placeholderText,s.disabled=n.props.disabled,s.autoComplete=n.props.autoComplete,s.className=ur(l.props.className,i),s.title=n.props.title,s.readOnly=n.props.readOnly,s.required=n.props.required,s.tabIndex=n.props.tabIndex,s["aria-describedby"]=n.props.ariaDescribedBy,s["aria-invalid"]=n.props.ariaInvalid,s["aria-labelledby"]=n.props.ariaLabelledBy,s["aria-required"]=n.props.ariaRequired,s))},n.renderClearButton=function(){var a=n.props,s=a.isClearable,o=a.disabled,i=a.selected,l=a.startDate,c=a.endDate,u=a.clearButtonTitle,d=a.clearButtonClassName,p=d===void 0?"":d,h=a.ariaLabelClose,x=h===void 0?"Close":h,m=a.selectedDates;return s&&(i!=null||l!=null||c!=null||m!=null&&m.length)?fe.createElement("button",{type:"button",className:ur("react-datepicker__close-icon",p,{"react-datepicker__close-icon--disabled":o}),disabled:o,"aria-label":x,onClick:n.onClearClick,title:u,tabIndex:-1}):null},n.state=n.calcInitialState(),n.preventFocusTimeout=void 0,n}return Object.defineProperty(r,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:ec,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),r.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},r.prototype.componentDidUpdate=function(t,n){var a,s,o,i;t.inline&&v8(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:zg(this.props.highlightDates)}),!n.focused&&!As(t.selected,this.props.selected)&&this.setState({inputValue:null}),n.open!==this.state.open&&(n.open===!1&&this.state.open===!0&&((s=(a=this.props).onCalendarOpen)===null||s===void 0||s.call(a)),n.open===!0&&this.state.open===!1&&((i=(o=this.props).onCalendarClose)===null||i===void 0||i.call(o)))},r.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},r.prototype.renderInputContainer=function(){var t=this.props,n=t.showIcon,a=t.icon,s=t.calendarIconClassname,o=t.calendarIconClassName,i=t.toggleCalendarOnIconClick,l=this.state.open;return s&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),fe.createElement("div",{className:"react-datepicker__input-container".concat(n?" react-datepicker__view-calendar-icon":"")},n&&fe.createElement(d8,ot({icon:a,className:ur(o,!o&&s,l&&"react-datepicker-ignore-onclickoutside")},i?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},r.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var n=this.state.open?fe.createElement(qk,{enableTabLoop:this.props.enableTabLoop},fe.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(n=fe.createElement(Qk,ot({portalId:this.props.portalId},this.props),n)),fe.createElement("div",null,this.renderInputContainer(),n)}return fe.createElement(g8,ot({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},r}(S.Component),y8="input",Tf="navigate";const w8={lessThanXSeconds:{one:{regular:"mniej niż sekunda",past:"mniej niż sekundę",future:"mniej niż sekundę"},twoFour:"mniej niż {{count}} sekundy",other:"mniej niż {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekundę",future:"sekundę"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"pół minuty",twoFour:"pół minuty",other:"pół minuty"},lessThanXMinutes:{one:{regular:"mniej niż minuta",past:"mniej niż minutę",future:"mniej niż minutę"},twoFour:"mniej niż {{count}} minuty",other:"mniej niż {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minutę",future:"minutę"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"około godziny",past:"około godziny",future:"około godzinę"},twoFour:"około {{count}} godziny",other:"około {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzinę",future:"godzinę"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzień",past:"dzień",future:"1 dzień"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"około tygodnia",twoFour:"około {{count}} tygodni",other:"około {{count}} tygodni"},xWeeks:{one:"tydzień",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"około miesiąc",twoFour:"około {{count}} miesiące",other:"około {{count}} miesięcy"},xMonths:{one:"miesiąc",twoFour:"{{count}} miesiące",other:"{{count}} miesięcy"},aboutXYears:{one:"około rok",twoFour:"około {{count}} lata",other:"około {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function k8(e,r){if(r===1)return e.one;const t=r%100;if(t<=20&&t>10)return e.other;const n=t%10;return n>=2&&n<=4?e.twoFour:e.other}function Cf(e,r,t){const n=k8(e,r);return(typeof n=="string"?n:n[t]).replace("{{count}}",String(r))}const _8=(e,r,t)=>{const n=w8[e];return t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"za "+Cf(n,r,"future"):Cf(n,r,"past")+" temu":Cf(n,r,"regular")},b8={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},E8={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},S8={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},T8={date:Uo({formats:b8,defaultWidth:"full"}),time:Uo({formats:E8,defaultWidth:"full"}),dateTime:Uo({formats:S8,defaultWidth:"full"})},C8={masculine:"ostatni",feminine:"ostatnia"},D8={masculine:"ten",feminine:"ta"},N8={masculine:"następny",feminine:"następna"},F8={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function Kg(e,r,t,n){let a;if(oM(r,t,n))a=D8;else if(e==="lastWeek")a=C8;else if(e==="nextWeek")a=N8;else throw new Error(`Cannot determine adjectives for token ${e}`);const s=r.getDay(),o=F8[s];return`'${a[o]}' eeee 'o' p`}const A8={lastWeek:Kg,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:Kg,other:"P"},O8=(e,r,t,n)=>{const a=A8[e];return typeof a=="function"?a(e,r,t,n):a},P8={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed naszą erą","naszej ery"]},M8={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwartał","II kwartał","III kwartał","IV kwartał"]},R8={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"]},I8={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"]},j8={narrow:["N","P","W","Ś","C","P","S"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},L8={narrow:["n","p","w","ś","c","p","s"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},z8={narrow:{am:"a",pm:"p",midnight:"półn.",noon:"poł",morning:"rano",afternoon:"popoł.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"}},B8={narrow:{am:"a",pm:"p",midnight:"o półn.",noon:"w poł.",morning:"rano",afternoon:"po poł.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"}},W8=(e,r)=>String(e),U8={ordinalNumber:W8,era:qn({values:P8,defaultWidth:"wide"}),quarter:qn({values:M8,defaultWidth:"wide",argumentCallback:e=>e-1}),month:qn({values:R8,defaultWidth:"wide",formattingValues:I8,defaultFormattingWidth:"wide"}),day:qn({values:j8,defaultWidth:"wide",formattingValues:L8,defaultFormattingWidth:"wide"}),dayPeriod:qn({values:z8,defaultWidth:"wide",formattingValues:B8,defaultFormattingWidth:"wide"})},$8=/^(\d+)?/i,H8=/\d+/i,Y8={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(ą|a)\s*er(ą|a)|naszej\s*ery)/i},V8={any:[/^p/i,/^n/i]},K8={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(ł|l)/i},G8={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},X8={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(ź|z)|lis|gru)/i,wide:/^(stycznia|stycze(ń|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(ń|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(ń|n)|wrze(ś|s)nia|wrzesie(ń|n)|pa(ź|z)dziernika|pa(ź|z)dziernik|listopada|listopad|grudnia|grudzie(ń|n))/i},Q8={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},q8={narrow:/^[npwścs]/i,short:/^(nie|pon|wto|(ś|s)ro|czw|pi(ą|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(ś|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(ł|l)ek|wtorek|(ś|s)roda|czwartek|pi(ą|a)tek|sobota)/i},Z8={narrow:[/^n/i,/^p/i,/^w/i,/^ś/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pi/i,/^so/i]},J8={narrow:/^(^a$|^p$|pó(ł|l)n\.?|o\s*pó(ł|l)n\.?|po(ł|l)\.?|w\s*po(ł|l)\.?|po\s*po(ł|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|pó(ł|l)noc|o\s*pó(ł|l)nocy|po(ł|l)udnie|w\s*po(ł|l)udnie|popo(ł|l)udnie|po\s*po(ł|l)udniu|rano|wieczór|wieczorem|noc|w\s*nocy)/i},eI={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i}},tI={ordinalNumber:yk({matchPattern:$8,parsePattern:H8,valueCallback:e=>parseInt(e,10)}),era:Zn({matchPatterns:Y8,defaultMatchWidth:"wide",parsePatterns:V8,defaultParseWidth:"any"}),quarter:Zn({matchPatterns:K8,defaultMatchWidth:"wide",parsePatterns:G8,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zn({matchPatterns:X8,defaultMatchWidth:"wide",parsePatterns:Q8,defaultParseWidth:"any"}),day:Zn({matchPatterns:q8,defaultMatchWidth:"wide",parsePatterns:Z8,defaultParseWidth:"any"}),dayPeriod:Zn({matchPatterns:J8,defaultMatchWidth:"any",parsePatterns:eI,defaultParseWidth:"any"})},vi={code:"pl",formatDistance:_8,formatLong:T8,formatRelative:O8,localize:U8,match:tI,options:{weekStartsOn:1,firstWeekContainsDate:4}};gi("pl",vi);const Df=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],rI=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],nI=({isOpen:e,onClose:r,onSubmit:t})=>{const[n,a]=S.useState(null),[s,o]=S.useState(""),[i,l]=S.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[c,u]=S.useState(""),[d,p]=S.useState(null),[h,x]=S.useState(null),m=S.useRef(null),y=S.useRef(null),[g,w]=S.useState(null),[v,b]=S.useState(null),M=()=>{l([...i,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},C=N=>{if(i.length>1){const U=[...i];U.splice(N,1),l(U)}},k=N=>{const U=[...i];U[N].showDataWaznosci=!U[N].showDataWaznosci,l(U)},F=N=>{var Z;const U=(Z=N.target.files)==null?void 0:Z[0];console.log("📎 Product file selected:",U),U&&U.type==="application/pdf"?(p(U),console.log("✅ Product invoice set:",U.name)):console.log("❌ Invalid product file type:",U==null?void 0:U.type)},E=N=>{var Z;const U=(Z=N.target.files)==null?void 0:Z[0];console.log("📎 Transport file selected:",U),U&&U.type==="application/pdf"?(x(U),console.log("✅ Transport invoice set:",U.name)):console.log("❌ Invalid transport file type:",U==null?void 0:U.type)},j=()=>{var N;(N=m.current)==null||N.click()},V=()=>{var N;(N=y.current)==null||N.click()},W=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",n),console.log("sprzedawca:",s),console.log("kosztDostawy:",c),console.log("productRows:",i),!n||!i.some(_=>_.kod&&_.nazwa&&_.ilosc&&_.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!n),console.log("productRows validation:",i.some(_=>_.kod&&_.nazwa&&_.ilosc&&_.cena));return}const N=i.filter(_=>_.kod&&_.nazwa&&_.ilosc&&_.cena).map(_=>({kod:_.kod,nazwa:_.nazwa,kod_kreskowy:_.kod_kreskowy||"",ilosc:parseFloat(_.ilosc)||0,cena:parseFloat(_.cena.replace(",","."))||0,dataWaznosci:_.dataWaznosci?_.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:_.typ||void 0,objetosc:_.objetosc||void 0}));console.log("formattedProducts:",N);const U=N.reduce((_,P)=>_+P.ilosc*P.cena,0),Z=parseFloat(c.replace(",","."))||0;console.log("totalValue:",U),console.log("deliveryCost:",Z),console.log("📎 Files to submit:",{productInvoice:d,transportInvoice:h}),t({date:n.toLocaleDateString("en-CA"),sprzedawca:s,wartosc:U,kosztDostawy:Z,products:N,productInvoice:d||null,transportInvoice:h||null}),te()},te=()=>{a(null),l([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),u(""),o(""),p(null),x(null),r()},ee=()=>i.reduce((N,U)=>{const Z=parseFloat(U.ilosc)||0,_=parseFloat(U.cena.replace(",","."))||0;return N+Z*_},0).toFixed(2),J=(N,U)=>{const Z=[...i];Z[N].typ=U,l(Z),w(null)},ne=N=>{w(g===N?null:N)},B=N=>{b(v===N?null:N)},q=(N,U)=>{const Z=[...i];Z[N].objetosc=U,l(Z),b(null)};return S.useEffect(()=>{const N=Z=>{const _=Z.target;if(!_.closest(".react-datepicker")&&!_.closest('button[title*="ważności"]')){const P=[...i];let A=!1;P.forEach(z=>{z.showDataWaznosci&&(z.showDataWaznosci=!1,A=!0)}),A&&l(P)}g!==null&&(_.closest(".dropdown-container")||w(null)),v!==null&&(_.closest(".dropdown-container")||b(null))},U=Z=>{Z.key==="Escape"&&(w(null),b(null))};return document.addEventListener("mousedown",N),document.addEventListener("keydown",U),()=>{document.removeEventListener("mousedown",N),document.removeEventListener("keydown",U)}},[g,v,i]),f.jsx(or,{isOpen:e,onRequestClose:te,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),f.jsx("button",{onClick:te,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsxs("div",{className:"space-y-6 flex-grow",children:[f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"flex",children:[f.jsxs("div",{className:"w-[200px]",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),f.jsx(ms,{selected:n,onChange:N=>a(N),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),f.jsx("div",{className:"w-[200px] flex items-start",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),f.jsx("div",{className:"relative",children:f.jsx("input",{type:"text",value:c,onKeyPress:N=>{const U=String.fromCharCode(N.which);(!/[\d,]/.test(U)||U===","&&N.target.value.includes(",")||N.target.value===""&&U===",")&&N.preventDefault()},onChange:N=>{const U=N.target,Z=U.selectionStart??0;let _=U.value.replace(/[^\d,]/g,"");if(_===""){u("");return}if(!_.includes(","))_=_+",00";else{const[A,z]=_.split(",");z&&z.length>2&&(_=`${A},${z.slice(0,2)}`)}u(_),requestAnimationFrame(()=>{const A=Math.min(Z,_.length);U.setSelectionRange(A,A)})},className:"w-[70%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]})}),f.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[f.jsxs("div",{className:"flex items-center w-48",children:[f.jsx("input",{type:"file",accept:".pdf",onChange:F,className:"hidden",ref:m}),f.jsx("button",{type:"button",onClick:j,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:f.jsx(eh,{className:"h-4 w-4 text-gray-500"})}),d&&f.jsx("a",{href:URL.createObjectURL(d),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:d.name,children:d.name})]}),f.jsxs("div",{className:"flex items-center w-48",children:[f.jsx("input",{type:"file",accept:".pdf",onChange:E,className:"hidden",ref:y}),f.jsx("button",{type:"button",onClick:V,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:f.jsx(Zp,{className:"h-4 w-4 text-gray-500"})}),h&&f.jsx("a",{href:URL.createObjectURL(h),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:h.name,children:h.name})]})]})]})}),f.jsx("div",{className:"flex gap-4",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),f.jsx("input",{type:"text",value:s,onChange:N=>o(N.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})}),f.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:i.map((N,U)=>{var Z,_;return f.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[f.jsxs("div",{className:"col-span-1.5 relative",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Kod"}),f.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:N.kod,onChange:P=>{const A=[...i];A[U].kod=P.target.value,l(A)}}),U===i.length-1&&f.jsx("button",{onClick:M,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:f.jsx(Rs,{size:16})})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Nazwa"}),f.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:N.nazwa,onChange:P=>{const A=[...i];A[U].nazwa=P.target.value,l(A)}})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Kod kreskowy"}),f.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:N.kod_kreskowy,onChange:P=>{const A=[...i];A[U].kod_kreskowy=P.target.value,l(A)}})]}),f.jsxs("div",{className:"col-span-1.5",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Ilość"}),f.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:N.ilosc,onChange:P=>{const A=[...i],z=P.target.value;(z===""||/^\d*$/.test(z))&&(A[U].ilosc=z,l(A))}})]}),f.jsxs("div",{className:"col-span-2.9 relative",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Cena"}),f.jsx("div",{className:"relative",children:f.jsx("input",{type:"text",value:N.cena,onKeyPress:P=>{const A=String.fromCharCode(P.which);(!/[\d,]/.test(A)||A===","&&P.target.value.includes(",")||P.target.value===""&&A===",")&&P.preventDefault()},onChange:P=>{const A=P.target,z=A.selectionStart??0;let Q=P.target.value.replace(/[^\d,]/g,"");if(Q===""){const X=[...i];X[U].cena="",l(X);return}if(!Q.includes(","))Q=Q+",00";else{const[X,Y]=Q.split(",");Y&&Y.length>2&&(Q=`${X},${Y.slice(0,2)}`)}const oe=[...i];oe[U].cena=Q,l(oe),requestAnimationFrame(()=>{const X=Math.min(z,Q.length);A.setSelectionRange(X,X)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),f.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Wartość"}),f.jsx("div",{className:"relative flex items-center",children:f.jsx("input",{type:"text",value:(()=>{const P=parseFloat(N.ilosc)||0,A=parseFloat(N.cena.replace(",","."))||0;return(P*A).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),f.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[f.jsx("button",{type:"button",onClick:()=>k(U),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${N.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:N.dataWaznosci?`Termin ważności: ${N.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:f.jsx(qp,{size:16})}),f.jsx("button",{onClick:()=>C(U),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:f.jsx(vt,{size:16})})]}),N.showDataWaznosci&&f.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:f.jsx(ms,{selected:N.dataWaznosci,onChange:P=>{const A=[...i];A[U].dataWaznosci=P,A[U].showDataWaznosci=!1,l(A)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const P=[...i];P[U].showDataWaznosci=!1,l(P)}})}),f.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Typ"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{type:"button",onClick:()=>ne(U),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${N.typ&&((Z=Df.find(P=>P.value===N.typ))==null?void 0:Z.color)||"border-gray-300 bg-white"}`,children:[f.jsx("span",{className:"truncate",children:N.typ&&((_=Df.find(P=>P.value===N.typ))==null?void 0:_.label)||"Wybierz typ"}),f.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g===U&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:P=>P.stopPropagation(),children:Df.map(P=>f.jsx("button",{type:"button",onClick:()=>J(U,P.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${P.color}`,children:P.label},P.value))})]})]}),f.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${U>0?"invisible":""}`,children:"Objętość"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{type:"button",onClick:()=>B(U),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${N.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[f.jsx("span",{className:"truncate",children:N.objetosc||"Wybierz"}),f.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),v===U&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:P=>P.stopPropagation(),style:{maxWidth:"200px"},children:rI.map(P=>f.jsx("button",{type:"button",onClick:()=>q(U,P.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:P.label},P.value))})]})]})]},U)})})]}),f.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[f.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),f.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[ee().replace(".",",")," €"]})]}),f.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:f.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:n,productRows:i,isDisabled:!n||!i.some(N=>N.kod&&N.nazwa&&N.ilosc&&N.cena)}),W()},disabled:!n||!i.some(N=>N.kod&&N.nazwa&&N.ilosc&&N.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!n||!i.some(N=>N.kod&&N.nazwa&&N.ilosc&&N.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},aI=({data:e})=>{const r=e.headers.findIndex(i=>i==="Kod"),t=e.headers.findIndex(i=>i==="Nazwa"),n=e.headers.findIndex(i=>i==="Ilość"),a=e.headers.findIndex(i=>i==="Kod kreskowy"),s=e.headers.filter(i=>i==="Kod"||i==="Nazwa"||i==="Ilość"||i==="Kod kreskowy"),o=e.rows.filter(i=>i.some(l=>l&&l.toString().trim()!=="")).map(i=>[i[r],i[t],i[n],i[a]]);return f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsx("tr",{children:s.map((i,l)=>f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i},l))})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map((i,l)=>f.jsx("tr",{children:i.map((c,u)=>f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:c},u))},l))})]})})},sI=({onSearch:e})=>{const[r,t]=S.useState(""),[n,a]=S.useState([]),[s,o]=S.useState(!1);return S.useEffect(()=>{const i=setTimeout(async()=>{if(r.trim()){o(!0);try{const l=await e(r);a(l)}catch(l){console.error("Error searching products:",l),a([])}finally{o(!1)}}else a([])},300);return()=>clearTimeout(i)},[r,e]),f.jsxs("div",{className:"w-full relative",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(Zo,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"text",value:r,onChange:i=>t(i.target.value),placeholder:"Szukaj produktów...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),s?f.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:f.jsxs("div",{className:"text-center py-4",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),f.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"Ładowanie..."})]})}):n.length>0?f.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:f.jsxs("table",{className:"w-full table-fixed",children:[f.jsx("thead",{className:"sticky top-0 z-10",children:f.jsxs("tr",{children:[f.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),f.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),f.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilość"}),f.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod kreskowy"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((i,l)=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:i.kod,children:i.kod}),f.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:i.nazwa,children:i.nazwa}),f.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:i.ilosc,children:i.ilosc}),f.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:i.kodKreskowy,children:i.kodKreskowy})]},l))})]})}):r?f.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:f.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynikов"})}):null]})};let oI={data:""},iI=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||oI,lI=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,cI=/\/\*[^]*?\*\/|  +/g,Gg=/\n+/g,Ya=(e,r)=>{let t="",n="",a="";for(let s in e){let o=e[s];s[0]=="@"?s[1]=="i"?t=s+" "+o+";":n+=s[1]=="f"?Ya(o,s):s+"{"+Ya(o,s[1]=="k"?"":r)+"}":typeof o=="object"?n+=Ya(o,r?r.replace(/([^,])+/g,i=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,i):i?i+" "+l:l)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Ya.p?Ya.p(s,o):s+":"+o+";")}return t+(r&&a?r+"{"+a+"}":a)+n},ha={},Zk=e=>{if(typeof e=="object"){let r="";for(let t in e)r+=t+Zk(e[t]);return r}return e},uI=(e,r,t,n,a)=>{let s=Zk(e),o=ha[s]||(ha[s]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(s));if(!ha[o]){let l=s!==e?e:(c=>{let u,d,p=[{}];for(;u=lI.exec(c.replace(cI,""));)u[4]?p.shift():u[3]?(d=u[3].replace(Gg," ").trim(),p.unshift(p[0][d]=p[0][d]||{})):p[0][u[1]]=u[2].replace(Gg," ").trim();return p[0]})(e);ha[o]=Ya(a?{["@keyframes "+o]:l}:l,t?"":"."+o)}let i=t&&ha.g?ha.g:null;return t&&(ha.g=ha[o]),((l,c,u,d)=>{d?c.data=c.data.replace(d,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(ha[o],r,n,i),o},fI=(e,r,t)=>e.reduce((n,a,s)=>{let o=r[s];if(o&&o.call){let i=o(t),l=i&&i.props&&i.props.className||/^go/.test(i)&&i;o=l?"."+l:i&&typeof i=="object"?i.props?"":Ya(i,""):i===!1?"":i}return n+a+(o??"")},"");function M0(e){let r=this||{},t=e.call?e(r.p):e;return uI(t.unshift?t.raw?fI(t,[].slice.call(arguments,1),r.p):t.reduce((n,a)=>Object.assign(n,a&&a.call?a(r.p):a),{}):t,iI(r.target),r.g,r.o,r.k)}let Jk,Jd,ep;M0.bind({g:1});let Pa=M0.bind({k:1});function dI(e,r,t,n){Ya.p=r,Jk=e,Jd=t,ep=n}function ws(e,r){let t=this||{};return function(){let n=arguments;function a(s,o){let i=Object.assign({},s),l=i.className||a.className;t.p=Object.assign({theme:Jd&&Jd()},i),t.o=/ *go\d+/.test(l),i.className=M0.apply(t,n)+(l?" "+l:"");let c=e;return e[0]&&(c=i.as||e,delete i.as),ep&&c[0]&&ep(i),Jk(c,i)}return a}}var pI=e=>typeof e=="function",e0=(e,r)=>pI(e)?e(r):e,hI=(()=>{let e=0;return()=>(++e).toString()})(),e2=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");e=!r||r.matches}return e}})(),mI=20,t2=(e,r)=>{switch(r.type){case 0:return{...e,toasts:[r.toast,...e.toasts].slice(0,mI)};case 1:return{...e,toasts:e.toasts.map(s=>s.id===r.toast.id?{...s,...r.toast}:s)};case 2:let{toast:t}=r;return t2(e,{type:e.toasts.find(s=>s.id===t.id)?1:0,toast:t});case 3:let{toastId:n}=r;return{...e,toasts:e.toasts.map(s=>s.id===n||n===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==r.toastId)};case 5:return{...e,pausedAt:r.time};case 6:let a=r.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+a}))}}},ru=[],Os={toasts:[],pausedAt:void 0},fo=e=>{Os=t2(Os,e),ru.forEach(r=>{r(Os)})},xI={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},gI=(e={})=>{let[r,t]=S.useState(Os),n=S.useRef(Os);S.useEffect(()=>(n.current!==Os&&t(Os),ru.push(t),()=>{let s=ru.indexOf(t);s>-1&&ru.splice(s,1)}),[]);let a=r.toasts.map(s=>{var o,i,l;return{...e,...e[s.type],...s,removeDelay:s.removeDelay||((o=e[s.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:s.duration||((i=e[s.type])==null?void 0:i.duration)||(e==null?void 0:e.duration)||xI[s.type],style:{...e.style,...(l=e[s.type])==null?void 0:l.style,...s.style}}});return{...r,toasts:a}},vI=(e,r="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:(t==null?void 0:t.id)||hI()}),rc=e=>(r,t)=>{let n=vI(r,e,t);return fo({type:2,toast:n}),n.id},Mr=(e,r)=>rc("blank")(e,r);Mr.error=rc("error");Mr.success=rc("success");Mr.loading=rc("loading");Mr.custom=rc("custom");Mr.dismiss=e=>{fo({type:3,toastId:e})};Mr.remove=e=>fo({type:4,toastId:e});Mr.promise=(e,r,t)=>{let n=Mr.loading(r.loading,{...t,...t==null?void 0:t.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let s=r.success?e0(r.success,a):void 0;return s?Mr.success(s,{id:n,...t,...t==null?void 0:t.success}):Mr.dismiss(n),a}).catch(a=>{let s=r.error?e0(r.error,a):void 0;s?Mr.error(s,{id:n,...t,...t==null?void 0:t.error}):Mr.dismiss(n)}),e};var yI=(e,r)=>{fo({type:1,toast:{id:e,height:r}})},wI=()=>{fo({type:5,time:Date.now()})},ll=new Map,kI=1e3,_I=(e,r=kI)=>{if(ll.has(e))return;let t=setTimeout(()=>{ll.delete(e),fo({type:4,toastId:e})},r);ll.set(e,t)},bI=e=>{let{toasts:r,pausedAt:t}=gI(e);S.useEffect(()=>{if(t)return;let s=Date.now(),o=r.map(i=>{if(i.duration===1/0)return;let l=(i.duration||0)+i.pauseDuration-(s-i.createdAt);if(l<0){i.visible&&Mr.dismiss(i.id);return}return setTimeout(()=>Mr.dismiss(i.id),l)});return()=>{o.forEach(i=>i&&clearTimeout(i))}},[r,t]);let n=S.useCallback(()=>{t&&fo({type:6,time:Date.now()})},[t]),a=S.useCallback((s,o)=>{let{reverseOrder:i=!1,gutter:l=8,defaultPosition:c}=o||{},u=r.filter(h=>(h.position||c)===(s.position||c)&&h.height),d=u.findIndex(h=>h.id===s.id),p=u.filter((h,x)=>x<d&&h.visible).length;return u.filter(h=>h.visible).slice(...i?[p+1]:[0,p]).reduce((h,x)=>h+(x.height||0)+l,0)},[r]);return S.useEffect(()=>{r.forEach(s=>{if(s.dismissed)_I(s.id,s.removeDelay);else{let o=ll.get(s.id);o&&(clearTimeout(o),ll.delete(s.id))}})},[r]),{toasts:r,handlers:{updateHeight:yI,startPause:wI,endPause:n,calculateOffset:a}}},EI=Pa`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,SI=Pa`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,TI=Pa`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,CI=ws("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${EI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${SI} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${TI} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,DI=Pa`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,NI=ws("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${DI} 1s linear infinite;
`,FI=Pa`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,AI=Pa`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,OI=ws("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${FI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${AI} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,PI=ws("div")`
  position: absolute;
`,MI=ws("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,RI=Pa`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,II=ws("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${RI} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,jI=({toast:e})=>{let{icon:r,type:t,iconTheme:n}=e;return r!==void 0?typeof r=="string"?S.createElement(II,null,r):r:t==="blank"?null:S.createElement(MI,null,S.createElement(NI,{...n}),t!=="loading"&&S.createElement(PI,null,t==="error"?S.createElement(CI,{...n}):S.createElement(OI,{...n})))},LI=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,zI=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,BI="0%{opacity:0;} 100%{opacity:1;}",WI="0%{opacity:1;} 100%{opacity:0;}",UI=ws("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,$I=ws("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,HI=(e,r)=>{let t=e.includes("top")?1:-1,[n,a]=e2()?[BI,WI]:[LI(t),zI(t)];return{animation:r?`${Pa(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Pa(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},YI=S.memo(({toast:e,position:r,style:t,children:n})=>{let a=e.height?HI(e.position||r||"top-center",e.visible):{opacity:0},s=S.createElement(jI,{toast:e}),o=S.createElement($I,{...e.ariaProps},e0(e.message,e));return S.createElement(UI,{className:e.className,style:{...a,...t,...e.style}},typeof n=="function"?n({icon:s,message:o}):S.createElement(S.Fragment,null,s,o))});dI(S.createElement);var VI=({id:e,className:r,style:t,onHeightUpdate:n,children:a})=>{let s=S.useCallback(o=>{if(o){let i=()=>{let l=o.getBoundingClientRect().height;n(e,l)};i(),new MutationObserver(i).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return S.createElement("div",{ref:s,className:r,style:t},a)},KI=(e,r)=>{let t=e.includes("top"),n=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:e2()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${r*(t?1:-1)}px)`,...n,...a}},GI=M0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,jc=16,XI=({reverseOrder:e,position:r="top-center",toastOptions:t,gutter:n,children:a,containerStyle:s,containerClassName:o})=>{let{toasts:i,handlers:l}=bI(t);return S.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:jc,left:jc,right:jc,bottom:jc,pointerEvents:"none",...s},className:o,onMouseEnter:l.startPause,onMouseLeave:l.endPause},i.map(c=>{let u=c.position||r,d=l.calculateOffset(c,{reverseOrder:e,gutter:n,defaultPosition:r}),p=KI(u,d);return S.createElement(VI,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?GI:"",style:p},c.type==="custom"?e0(c.message,c):a?a(c):S.createElement(YI,{toast:c,position:u}))}))},je=Mr;gi("pl",vi);const QI=({isOpen:e,onClose:r,onOrderCreated:t})=>{const[n,a]=S.useState(null),[s,o]=S.useState(""),[i,l]=S.useState(""),[c,u]=S.useState([]),[d,p]=S.useState(null),[h,x]=S.useState(!1),[m,y]=S.useState([]),[g,w]=S.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[v,b]=S.useState(null),[M,C]=S.useState(!1),[k,F]=S.useState(!1),[E,j]=S.useState(null),[V,W]=S.useState(new Set),te=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],ee=()=>{const _=Math.max(...g.map(P=>P.id))+1;w([...g,{id:_,searchQuery:"",selectedProduct:null,typ:""}])},J=_=>{g.length>1&&w(P=>P.filter(A=>A.id!==_))},ne=()=>{a(null),o(""),l(""),u([]),p(null),y([]),w([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),b(null),C(!1),F(!1),r()};S.useEffect(()=>{const P=setTimeout(async()=>{if(i.trim().length<2){u([]);return}x(!0);try{const A=await fetch(`/api/clients/search?q=${encodeURIComponent(i)}`);if(!A.ok)throw new Error("Failed to fetch clients");const z=await A.json();u(z)}catch(A){console.error("Error searching clients:",A),u([])}finally{x(!1)}},300);return()=>clearTimeout(P)},[i]),S.useEffect(()=>{const P=setTimeout(async()=>{var A,z;if(v===null||!((A=g.find(Q=>Q.id===v))!=null&&A.searchQuery.trim())){y([]);return}C(!0);try{const Q=((z=g.find(Y=>Y.id===v))==null?void 0:z.searchQuery)||"",re=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(Q)}`);if(!re.ok)throw new Error("Failed to fetch products");const X=(await re.json()).map(Y=>({kod:Y.kod,nazwa:Y.nazwa,ilosc:Y.ilosc.toString(),kodKreskowy:Y.kod_kreskowy||"",selectedQuantity:0}));y(X)}catch(Q){console.error("Error searching products:",Q),y([])}finally{C(!1)}},300);return()=>clearTimeout(P)},[g,v]),S.useEffect(()=>{const _=A=>{const z=A.target;E!==null&&(z.closest(".dropdown-container")||j(null))},P=A=>{A.key==="Escape"&&j(null)};return E!==null&&(document.addEventListener("mousedown",_),document.addEventListener("keydown",P)),()=>{document.removeEventListener("mousedown",_),document.removeEventListener("keydown",P)}},[E]);const B=(_,P)=>{w(A=>A.map(Q=>Q.id===_?{...Q,selectedProduct:P,searchQuery:`${P.kod} - ${P.nazwa}`}:Q)),y([]),b(null)},q=_=>{j(E===_?null:_)},N=(_,P)=>{w(A=>A.map(z=>z.id===_?{...z,typ:P}:z)),j(null)},U=()=>g.filter(_=>_.selectedProduct).reduce((_,P)=>{var z;const A=((z=P.selectedProduct)==null?void 0:z.selectedQuantity)||0;return _+A},0),Z=async()=>{const _=g.filter(oe=>oe.selectedProduct).map(oe=>({kod:oe.selectedProduct.kod,nazwa:oe.selectedProduct.nazwa,ilosc:oe.selectedProduct.selectedQuantity||0,typ:oe.typ,kod_kreskowy:oe.selectedProduct.kodKreskowy}));if(!n){je.error("Wybierz datę zamówienia");return}if(!s.trim()){je.error("Wprowadź numer zamówienia");return}if(!d){je.error("Wybierz klienta");return}if(_.length===0){je.error("Dodaj produkty");return}if(_.some(oe=>!oe.ilosc)){je.error("Wprowadź ilość dla wszystkich produktów");return}if(_.some(oe=>!oe.typ)){je.error("Wybierz typ dla wszystkich produktów");return}const P=new Set;for(let oe=0;oe<g.length;oe++){const X=g[oe];if(X.selectedProduct){const Y=X.selectedProduct.selectedQuantity||0,K=parseInt(X.selectedProduct.ilosc)||0;Y>K&&P.add(X.id)}}if(P.size>0){W(P);return}else W(new Set);const A=n.getDate().toString().padStart(2,"0"),z=(n.getMonth()+1).toString().padStart(2,"0"),Q=n.getFullYear(),re=`${s.trim()}_${A}_${z}_${Q}`;F(!0);try{const oe=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:d.nazwa,order_number:re,products:_})});if(!oe.ok){const X=await oe.json();if(oe.status===400&&X.error.includes("Insufficient quantity")){const Y=X.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(Y){const[,K,D,we]=Y;je.error(`Niewystarczająca ilość produktu ${K}. Dostępne: ${D}, Zamówione: ${we}`)}else je.error(X.error)}else throw new Error("Failed to create order");return}je.success("Zamówienie zostało dodane"),ne(),t&&t()}catch(oe){console.error("Error creating order:",oe),je.error("Wystąpił błąd podczas dodawania zamówienia")}finally{F(!1)}};return f.jsx(or,{isOpen:e,onRequestClose:ne,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamówienia"}),f.jsx("button",{onClick:ne,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"flex",children:[f.jsxs("div",{className:"w-[200px]",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),f.jsx(ms,{selected:n,onChange:_=>a(_),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),f.jsxs("div",{className:"w-[180px] ml-4",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),f.jsx("input",{type:"text",value:s,onChange:_=>o(_.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),f.jsxs("div",{className:"relative",children:[f.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(Zo,{className:"h-4 w-4 text-gray-400"})}),f.jsx("input",{type:"text",id:"client-search",value:i,onChange:_=>l(_.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),c.length>0&&!d&&f.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(_=>f.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{p(_),l(_.nazwa),u([])},children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"font-medium text-[10px]",children:_.nazwa}),f.jsx("span",{className:"text-[10px] text-gray-500",children:_.firma})]})},_.id))})]}),d&&f.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),f.jsx("p",{className:"text-xs text-gray-900",children:d.nazwa})]}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),f.jsx("p",{className:"text-xs text-gray-900",children:d.firma})]}),d.adres&&f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),f.jsx("p",{className:"text-xs text-gray-900",children:d.adres})]}),d.kontakt&&f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),f.jsx("p",{className:"text-xs text-gray-900",children:d.kontakt})]})]}),f.jsx("button",{onClick:()=>{p(null),l("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:f.jsx(vt,{size:16})})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),g.map(_=>{var P,A,z;return f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex",children:[f.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(Zo,{className:"h-4 w-4 text-gray-400"})}),f.jsx("input",{type:"text",value:_.searchQuery,onChange:Q=>{w(re=>re.map(oe=>oe.id===_.id?{...oe,searchQuery:Q.target.value,selectedProduct:null}:oe)),b(_.id)},onFocus:()=>b(_.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsx("div",{className:"w-16 ml-2",children:f.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:((P=_.selectedProduct)==null?void 0:P.selectedQuantity)||"",onChange:Q=>{const re=Q.target.value,oe=re===""?0:Math.max(1,parseInt(re)||0);if(w(X=>X.map(Y=>Y.id===_.id&&Y.selectedProduct?{...Y,selectedProduct:{...Y.selectedProduct,selectedQuantity:oe}}:Y)),V.has(_.id)){const X=new Set(V);X.delete(_.id),W(X)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${V.has(_.id)?"border-red-500":"border-gray-300"}`})}),f.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[f.jsxs("button",{type:"button",onClick:()=>q(_.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${_.typ&&((A=te.find(Q=>Q.value===_.typ))==null?void 0:A.color)||"border-gray-300 bg-white"}`,children:[f.jsx("span",{className:"truncate text-[10px]",children:_.typ&&((z=te.find(Q=>Q.value===_.typ))==null?void 0:z.label)||"Typ"}),f.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E===_.id&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:Q=>Q.stopPropagation(),children:te.map(Q=>f.jsx("button",{type:"button",onClick:()=>N(_.id,Q.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${Q.color}`,children:Q.label},Q.value))})]}),g.length>1&&f.jsx("button",{onClick:()=>J(_.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:f.jsx(vt,{size:16})})]}),_.id===Math.max(...g.map(Q=>Q.id))&&f.jsx("button",{onClick:ee,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:f.jsx(Rs,{size:16})}),M&&v===_.id&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),m.length>0&&v===_.id&&!_.selectedProduct&&f.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map(Q=>f.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>B(_.id,{...Q,selectedQuantity:0}),children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"font-medium text-[10px]",children:Q.kod}),f.jsx("span",{className:"text-[10px] text-gray-500",children:Q.nazwa}),f.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",Q.ilosc]})]})},Q.kod))})]},_.id)})]})]}),f.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:f.jsx("button",{onClick:Z,disabled:k,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${k?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:k?f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),f.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",f.jsx("span",{className:"font-semibold text-gray-900",children:U()})]})]})})},qI=({isOpen:e,onClose:r,order:t})=>{const[n,a]=S.useState(null),[s,o]=S.useState(null),[i,l]=S.useState(!1),c=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}];S.useEffect(()=>{e&&t&&(u(),d())},[e,t]);const u=async()=>{if(t){l(!0);try{const m=await fetch(`/api/orders/${t.id}`);if(!m.ok)throw new Error("Failed to load order details");const y=await m.json();a(y)}catch(m){console.error("Error loading order details:",m)}finally{l(!1)}}},d=async()=>{if(t)try{const m=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(m.ok){const y=await m.json();o(y)}}catch(m){console.error("Error loading client data:",m)}},p=m=>new Date(m).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const h=n||t,x=async()=>{if(!(!t||!h))try{const m=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!m.ok)throw new Error("Failed to generate PDF");const y=await m.blob(),g=window.URL.createObjectURL(y),w=document.createElement("a");w.href=g;const v=s?s.nazwa:h.klient,b=`${v}_${h.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",v),console.log("Order number:",h.numer_zamowienia),console.log("Generated filename:",b),w.download=b,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(g),document.body.removeChild(w)}catch(m){console.error("Error generating PDF:",m),alert("Błąd podczas generowania PDF")}};return f.jsx(or,{isOpen:e,onRequestClose:r,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zamówienia"}),f.jsx("button",{onClick:r,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:i?f.jsx("div",{className:"flex justify-center items-center py-8",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-700",children:"Numer zamówienia:"}),f.jsx("p",{className:"text-sm font-bold text-gray-900",children:h.numer_zamowienia})]}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),f.jsx("p",{className:"text-gray-900",children:p(h.data_utworzenia||"")})]})]})}),s&&f.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),f.jsx("p",{className:"text-xs text-gray-900",children:s.nazwa})]}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),f.jsx("p",{className:"text-xs text-gray-900",children:s.firma})]}),s.adres&&f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),f.jsx("p",{className:"text-xs text-gray-900",children:s.adres})]}),s.kontakt&&f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),f.jsx("p",{className:"text-xs text-gray-900",children:s.kontakt})]})]})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Produkty w zamówieniu"}),h.products&&h.products.length>0?f.jsx("div",{children:f.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilość"}),f.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Typ"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.products.map(m=>{var y,g;return f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:m.kod}),f.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:f.jsx("div",{className:"break-words leading-tight",children:m.nazwa})}),f.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:m.kod_kreskowy||"-"}),f.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:m.ilosc}),f.jsx("td",{className:"px-4 py-2 text-xs w-20",children:m.typ?f.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${((y=c.find(w=>w.value===m.typ))==null?void 0:y.color)||"bg-gray-100 text-gray-800 border-gray-200"}`,children:((g=c.find(w=>w.value===m.typ))==null?void 0:g.label)||m.typ}):f.jsx("span",{className:"text-gray-500",children:"-"})})]},m.id)})})]})}):f.jsx("p",{className:"text-xs text-gray-500",children:"Brak produktów w zamówieniu"})]})]})}),f.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",f.jsx("span",{className:"font-semibold text-gray-900",children:h.laczna_ilosc})]}),f.jsx("div",{className:"absolute bottom-4 left-4",children:f.jsx("button",{onClick:x,disabled:i,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:i?f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};gi("pl",vi);const Nf=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],ZI=({isOpen:e,onClose:r,onSubmit:t,order:n})=>{const[a,s]=S.useState(""),[o,i]=S.useState(""),[l,c]=S.useState(null),[u,d]=S.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),[p,h]=S.useState(null),[x,m]=S.useState(""),[y,g]=S.useState([]),[w,v]=S.useState(!1),[b,M]=S.useState(null),[C,k]=S.useState([]),[F,E]=S.useState(!1),[j,V]=S.useState(null),[W,te]=S.useState(new Set),ee=async P=>{try{const A=P.map(oe=>oe.kod).filter(oe=>oe.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",A),A.length===0)return;const z=await fetch("/api/working-sheets");if(!z.ok)throw new Error("Failed to fetch working sheets");const Q=await z.json();console.log("All working sheets products:",Q);const re=A.map(oe=>{const X=Q.find(Y=>Y.kod===oe);return console.log(`Found product for ${oe}:`,X),X}).filter(oe=>oe!==void 0);console.log("Found products for order:",re),g(re),console.log("✅ Final loaded products info for order editing:",re)}catch(A){console.error("❌ Error loading products info:",A)}};S.useEffect(()=>{if(e&&n){if(s(n.klient),m(n.klient),V({nazwa:n.klient}),i(n.numer_zamowienia),n.data_utworzenia){const P=new Date(n.data_utworzenia);c(P),console.log("📅 Loaded order date:",P)}else c(null);if(n.products&&n.products.length>0){console.log("Order products from backend:",n.products);const P=n.products.map(A=>({kod:A.kod||"",nazwa:A.nazwa||"",kod_kreskowy:A.kod_kreskowy||"",ilosc:(A.ilosc||0).toString(),typ:A.typ||""}));console.log("Formatted products:",P),d(P),console.log("🔄 About to load products info for:",P),ee(P)}else d([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])}},[e,n]),S.useEffect(()=>{const A=setTimeout(async()=>{var z,Q;if(b===null||!((z=u.find((re,oe)=>oe===b))!=null&&z.nazwa.trim())){g([]);return}v(!0);try{const re=((Q=u.find((Y,K)=>K===b))==null?void 0:Q.nazwa)||"",oe=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(re)}`);if(!oe.ok)throw new Error("Failed to fetch products");const X=await oe.json();g(X)}catch(re){console.error("Error searching products:",re),g([])}finally{v(!1)}},300);return()=>clearTimeout(A)},[u,b]),S.useEffect(()=>{const A=setTimeout(async()=>{if(x.trim().length<2){k([]);return}E(!0);try{const z=await fetch(`/api/clients/search?q=${encodeURIComponent(x)}`);if(!z.ok)throw new Error("Failed to fetch clients");const Q=await z.json();k(Q)}catch(z){console.error("Error searching clients:",z),k([])}finally{E(!1)}},300);return()=>clearTimeout(A)},[x]),S.useEffect(()=>{const P=z=>{const Q=z.target;p!==null&&(Q.closest(".dropdown-container")||h(null))},A=z=>{z.key==="Escape"&&h(null)};return p!==null&&(document.addEventListener("mousedown",P),document.addEventListener("keydown",A)),()=>{document.removeEventListener("mousedown",P),document.removeEventListener("keydown",A)}},[p]);const J=()=>{d([...u,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])},ne=P=>{u.length>1&&d(u.filter((A,z)=>z!==P))},B=(P,A)=>{const z=[...u];z[P].typ=A,d(z),h(null)},q=P=>{h(p===P?null:P)},N=(P,A)=>{const z=[...u];z[P]={...z[P],kod:A.kod,nazwa:A.nazwa,kod_kreskowy:A.kod_kreskowy||"",typ:A.typ||"sztuki"},d(z);const Q=[...y],re=Q.findIndex(oe=>oe.kod===A.kod);re>=0?Q[re]=A:Q.push(A),g(Q),h(null)},U=async(P,A)=>{var Q;const z=new Set;for(let re=0;re<P.length;re++){const oe=P[re],X=parseInt(oe.ilosc)||0,Y=u.findIndex(xe=>xe.kod===oe.kod&&xe.nazwa===oe.nazwa&&xe.ilosc===oe.ilosc);if(Y===-1){console.warn(`⚠️ Could not find actual index for product ${oe.kod}`);continue}const K=A.find(xe=>xe.kod===oe.kod),D=(K==null?void 0:K.ilosc)||0,we=(Q=n==null?void 0:n.products)==null?void 0:Q.find(xe=>xe.kod===oe.kod),pe=we&&we.ilosc||0;let me;X>pe?(me=X-pe,console.log(`📈 Increasing order: ${pe} → ${X}, need additional: ${me}`)):(me=X,console.log(`📉 Decreasing order: ${pe} → ${X}, checking total available`));const _e=D+(X<=pe?pe:0);console.log(`Product ${Y} (valid index ${re}):`,{kod:oe.kod,requested:X,availableOnStock:D,reservedInOrder:pe,requiredFromStock:me,totalAvailable:_e,hasError:me>_e}),me>_e&&(z.add(Y),console.log(`❌ Error for product ${Y}: required ${me} > available ${_e}`))}return z},Z=async P=>{if(P.preventDefault(),!n)return;if(!a.trim()){je.error("Wprowadź nazwę klienta");return}if(!o.trim()){je.error("Wprowadź numer zamówienia");return}const A=u.filter(re=>re.kod.trim()&&re.nazwa.trim()&&re.ilosc.trim()&&re.typ.trim());if(A.length===0){je.error("Dodaj produkty do zamówienia");return}if(A.some(re=>!re.ilosc||!re.typ)){je.error("Wprowadź ilość i typ dla wszystkich produktów");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",A),console.log("products (stock info):",y),console.log("products.length:",y.length),y.length===0){console.log("⚠️ Products info is empty, reloading...");try{const re=await fetch("/api/working-sheets");if(re.ok){const oe=await re.json();console.log("Reloaded all products:",oe),g(oe);const X=await U(A,oe);if(X.size>0){te(X);return}else te(new Set);console.log("✅ Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),je.error("Błąd podczas ładowania informacji o produktach");return}}catch(re){console.error("Error reloading products:",re),je.error("Błąd podczas ładowania informacji o produktach");return}}const z=await U(A,y);if(z.size>0){te(z);return}else te(new Set);const Q=A.map(re=>({kod:re.kod,kod_kreskowy:re.kod_kreskowy,nazwa:re.nazwa,ilosc:parseInt(re.ilosc)||0,typ:re.typ}));console.log("Sending products data:",Q);try{const re=await fetch(`/api/orders/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:o.trim(),products:Q})});if(!re.ok){const oe=await re.json();throw new Error(oe.error||"Failed to update order")}je.success("Zamówienie zostało zaktualizowane"),_(),t({id:n.id,klient:a.trim(),numer_zamowienia:o.trim(),products:Q})}catch(re){console.error("Error updating order:",re),je.error("Wystąpił błąd podczas aktualizacji zamówienia")}},_=()=>{s(""),m(""),V(null),k([]),i(""),c(null),d([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),h(null),g([]),M(null),r()};return n?f.jsx(or,{isOpen:e,onRequestClose:_,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj zamówienie"}),f.jsx("button",{onClick:_,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsxs("form",{onSubmit:Z,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex space-x-4",children:[f.jsxs("div",{className:"w-[200px]",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),f.jsx(ms,{selected:l,onChange:P=>c(P),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),f.jsx("input",{type:"text",value:o,onChange:P=>i(P.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(Zo,{className:"h-4 w-4 text-gray-400"})}),f.jsx("input",{type:"text",value:x,onChange:P=>m(P.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),F&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),C.length>0&&!j&&f.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:C.map(P=>f.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{V(P),m(P.nazwa),s(P.nazwa),k([])},children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"font-medium text-[10px]",children:P.nazwa}),f.jsx("span",{className:"text-[10px] text-gray-500",children:P.firma})]})},P.id))})]}),j&&f.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),f.jsx("p",{className:"text-xs text-gray-900",children:j.nazwa})]}),j.firma&&f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),f.jsx("p",{className:"text-xs text-gray-900",children:j.firma})]}),j.adres&&f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),f.jsx("p",{className:"text-xs text-gray-900",children:j.adres})]}),j.kontakt&&f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),f.jsx("p",{className:"text-xs text-gray-900",children:j.kontakt})]})]}),f.jsx("button",{onClick:()=>{V(null),m(""),s("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:f.jsx(vt,{size:16})})]})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),u.map((P,A)=>{var z,Q;return f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex",children:[f.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(Zo,{className:"h-4 w-4 text-gray-400"})}),f.jsx("input",{type:"text",value:P.nazwa,onChange:re=>{const oe=[...u];oe[A].nazwa=re.target.value,d(oe),M(A)},onFocus:()=>M(A),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsx("div",{className:"w-16 ml-2",children:f.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:P.ilosc,onChange:re=>{const oe=[...u];if(oe[A].ilosc=re.target.value,d(oe),W.has(A)){const X=new Set(W);X.delete(A),te(X)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${W.has(A)?"border-red-500":"border-gray-300"}`})}),f.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[f.jsxs("button",{type:"button",onClick:()=>q(A),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${P.typ&&((z=Nf.find(re=>re.value===P.typ))==null?void 0:z.color)||"border-gray-300 bg-white"}`,children:[f.jsx("span",{className:"truncate text-[10px]",children:P.typ&&((Q=Nf.find(re=>re.value===P.typ))==null?void 0:Q.label)||"Typ"}),f.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p===A&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:re=>re.stopPropagation(),children:Nf.map(re=>f.jsx("button",{type:"button",onClick:()=>B(A,re.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${re.color}`,children:re.label},re.value))})]}),u.length>1&&f.jsx("button",{onClick:()=>ne(A),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:f.jsx(vt,{size:16})})]}),A===u.length-1&&f.jsx("button",{onClick:J,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:f.jsx(Rs,{size:16})}),w&&b===A&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),y.length>0&&b===A&&f.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:y.map(re=>f.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>N(A,re),children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"font-medium text-[10px]",children:re.kod}),f.jsx("span",{className:"text-[10px] text-gray-500",children:re.nazwa}),f.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",re.ilosc]})]})},re.kod))})]},A)})]})]}),f.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[f.jsx("button",{type:"button",onClick:_,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),f.jsx("button",{onClick:Z,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null},JI=({onViewOrder:e,onEditOrder:r,onDeleteOrder:t,onUpdateOrder:n,refreshTrigger:a})=>{const[s,o]=S.useState([]),[i,l]=S.useState(!0),[c,u]=S.useState(null),[d,p]=S.useState(null),[h,x]=S.useState(!1),[m,y]=S.useState(!1),[g,w]=S.useState(null),[v,b]=S.useState(!1),[M,C]=S.useState(null),[k,F]=S.useState(""),[E,j]=S.useState("data_utworzenia"),[V,W]=S.useState("desc"),[te,ee]=S.useState(""),[J,ne]=S.useState(""),B=async()=>{try{console.log("🔄 Starting to load orders..."),l(!0),u(null),console.log("📡 Fetching from /api/orders-with-products...");const K=await fetch("/api/orders-with-products");if(console.log("📡 Response status:",K.status),console.log("📡 Response ok:",K.ok),!K.ok)throw new Error(`HTTP error! status: ${K.status}`);const D=await K.json();console.log("📡 Raw data received:",D),console.log("📡 Raw data length:",D.length);const we=D.map(pe=>({id:pe.id,klient:pe.klient,numer_zamowienia:pe.numer_zamowienia,data_utworzenia:pe.data_utworzenia,laczna_ilosc:pe.laczna_ilosc,typ:pe.typ||"zamowienie",numer_zwrotu:pe.numer_zwrotu||null,products:pe.products||[]}));console.log("🔄 Transformed orders:",we),console.log("🔄 Orders count:",we.length),o(we)}catch(K){console.error("❌ Error loading orders:",K),u("Failed to load orders")}finally{l(!1)}};S.useEffect(()=>{B()},[]),S.useEffect(()=>{a&&B()},[a]);const q=K=>new Date(K).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),N=K=>{p(K),x(!0)},U=K=>{w(K),y(!0)},Z=async K=>{if(console.log("OrdersList handleEditSubmit called with data:",K),n)n(K);else try{console.log("Sending PUT request to update order:",K);const D=await fetch(`/api/orders/${K.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)});if(!D.ok)throw new Error(`HTTP error! status: ${D.status}`);je.success("Zamówienie zostało zaktualizowane"),B()}catch(D){console.error("Error updating order:",D),je.error("Błąd podczas aktualizacji zamówienia")}},_=K=>{C(K),b(!0),F("")},P=async()=>{if(k==="5202"){if(M!=null&&M.id)try{t&&t(M.id);const K=await fetch(`/api/orders/${M.id}`,{method:"DELETE"});if(!K.ok)throw new Error(`HTTP error! status: ${K.status}`);const D=await K.json();console.log("Order deleted:",D),je.success("Zamówienie zostało usunięte"),B()}catch(K){console.error("Error deleting order:",K),je.error("Błąd podczas usuwania zamówienia")}A()}else je.error("Nieprawidłowe hasło"),F("")},A=()=>{b(!1),C(null),F("")},z=K=>{K.key==="Enter"&&P()},Q=K=>{E===K?W(V==="asc"?"desc":"asc"):(j(K),W("asc"))},re=Array.from(new Set(s.map(K=>new Date(K.data_utworzenia).getFullYear().toString()))).sort((K,D)=>parseInt(D)-parseInt(K)),oe=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],Y=s.filter(K=>!(te&&new Date(K.data_utworzenia).getFullYear().toString()!==te||J&&(new Date(K.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==J)).sort((K,D)=>{let we,pe;switch(E){case"numer_zamowienia":we=(K.numer_zamowienia||"").toLowerCase(),pe=(D.numer_zamowienia||"").toLowerCase();break;case"klient":we=(K.klient||"").toLowerCase(),pe=(D.klient||"").toLowerCase();break;case"laczna_ilosc":we=K.laczna_ilosc,pe=D.laczna_ilosc;break;case"data_utworzenia":we=new Date(K.data_utworzenia),pe=new Date(D.data_utworzenia);break;default:we=K[E]||"",pe=D[E]||""}return typeof we=="string"&&typeof pe=="string"?V==="asc"?we.localeCompare(pe):pe.localeCompare(we):typeof we=="number"&&typeof pe=="number"?V==="asc"?we-pe:pe-we:we instanceof Date&&pe instanceof Date?V==="asc"?we.getTime()-pe.getTime():pe.getTime()-we.getTime():0});return i?f.jsx("div",{className:"flex justify-center items-center h-32",children:f.jsx("div",{className:"text-gray-500",children:"Ładowanie zamówień..."})}):c?f.jsx("div",{className:"flex justify-center items-center h-32",children:f.jsxs("div",{className:"text-red-500",children:["Błąd: ",c]})}):f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"sticky top-0 z-10",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Q("numer_zamowienia"),children:"Numer zamówienia"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Q("klient"),children:"Klient"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Q("typ"),children:"Typ"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Q("laczna_ilosc"),children:"Łączna ilość"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Q("data_utworzenia"),children:"Data utworzenia"}),f.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:f.jsxs("div",{className:"flex space-x-1 justify-end",children:[f.jsxs("select",{value:te,onChange:K=>ee(K.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[f.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),re.map(K=>f.jsx("option",{value:K,style:{fontFamily:"Sora, sans-serif"},children:K},K))]}),f.jsxs("select",{value:J,onChange:K=>ne(K.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[f.jsx("option",{value:"",children:"Msc"}),oe.map(K=>f.jsx("option",{value:K.value,style:{fontFamily:"Sora, sans-serif"},children:K.value},K.value))]})]})})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamówień"})}):Y.map(K=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:K.numer_zamowienia}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:K.klient}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:K.typ==="zwrot"?"Zwrot":"Zamówienie"})}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:K.laczna_ilosc}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:q(K.data_utworzenia)}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{type:"button",onClick:D=>{D.preventDefault(),D.stopPropagation(),N(K)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:f.jsx(Jp,{size:16})}),f.jsx("button",{type:"button",onClick:D=>{D.preventDefault(),D.stopPropagation(),U(K)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:f.jsx(w0,{size:16})}),f.jsx("button",{type:"button",onClick:D=>{D.preventDefault(),D.stopPropagation(),_(K)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:f.jsx(vt,{size:16})})]})})]},K.id))})]})}),f.jsx(or,{isOpen:v,onRequestClose:A,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),f.jsx("button",{onClick:A,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-6 flex-grow",children:f.jsx("div",{children:f.jsx("input",{type:"password",value:k,onChange:K=>F(K.target.value),onKeyPress:z,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),f.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[f.jsx("button",{onClick:A,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),f.jsx("button",{onClick:P,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),f.jsx(qI,{isOpen:h,onClose:()=>x(!1),order:d}),f.jsx(ZI,{isOpen:m,onClose:()=>{y(!1),w(null)},onSubmit:K=>{Z(K),y(!1),w(null)},order:g})]})},e5="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",r2=({isOpen:e,onClose:r,product:t})=>t?f.jsx(or,{isOpen:e,onRequestClose:r,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[f.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:f.jsx(vt,{size:24})}),f.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Детали товара"}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Код:"})," ",t.kod]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Название:"})," ",t.nazwa]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Количество:"})," ",t.ilosc]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Ед. измерения:"})," ",t.jednostka_miary]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Штрихкод:"})," ",t.kod_kreskowy]}),t.data_waznosci&&f.jsxs("p",{children:[f.jsx("strong",{children:"Срок годности:"})," ",t.data_waznosci]}),t.waga_netto&&f.jsxs("p",{children:[f.jsx("strong",{children:"Вес нетто:"})," ",t.waga_netto," кг"]}),t.waga_brutto&&f.jsxs("p",{children:[f.jsx("strong",{children:"Вес брутто:"})," ",t.waga_brutto," кг"]}),t.objetosc&&f.jsxs("p",{children:[f.jsx("strong",{children:"Объем:"})," ",t.objetosc," л"]}),t.opis&&f.jsxs("p",{children:[f.jsx("strong",{children:"Описание:"})," ",t.opis]})]})]})}):null,t0="",n2=({isOpen:e,onClose:r,receipt:t,products:n})=>{const[a,s]=fe.useState(null),[o,i]=fe.useState(!1),[l,c]=fe.useState({x:0,y:0}),[u,d]=fe.useState(!1),p=fe.useRef({x:0,y:0});fe.useEffect(()=>{const m=g=>{u&&c({x:g.clientX-p.current.x,y:g.clientY-p.current.y})},y=()=>d(!1);return u&&(window.addEventListener("mousemove",m),window.addEventListener("mouseup",y)),()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",y)}},[u]);const h=m=>{m.target.closest("button")||m.target.closest("input")||(d(!0),p.current={x:m.clientX-l.x,y:m.clientY-l.y})};if(!t)return null;let x=[];if(Array.isArray(t.products))x=t.products;else if(typeof t.products=="string")try{x=JSON.parse(t.products)}catch{x=[]}return f.jsxs(or,{isOpen:e,onRequestClose:r,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${l.x}px), calc(-50% + ${l.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:h,style:{cursor:u?"grabbing":"grab"},children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zakupu"}),f.jsx("button",{onClick:r,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),f.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),f.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Wartość"}),f.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," €"]})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),f.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," €"]})]})]}),(t.productInvoice||t.transportInvoice)&&f.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&f.jsxs("button",{onClick:()=>{const m=`${t0}/uploads/${t.productInvoice}`;console.log("📎 Opening product invoice:",m),window.open(m,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[f.jsx(eh,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&f.jsxs("button",{onClick:()=>{const m=`${t0}/uploads/${t.transportInvoice}`;console.log("📎 Opening transport invoice:",m),window.open(m,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[f.jsx(Zp,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),f.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),f.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),f.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),f.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilość"}),f.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),f.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Wartość"}),f.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),f.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objętość"}),f.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data ważności"})]})}),f.jsx("tbody",{children:x.map((m,y)=>f.jsxs("tr",{children:[f.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:m.kod}),f.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:m.nazwa}),f.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:m.kod_kreskowy||"-"}),f.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:m.ilosc}),f.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[m.cena," €"]}),f.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(m.ilosc*m.cena).toFixed(2).replace(".",",")," €"]}),f.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const g=m.typ;return g?{czerwone:"Czerwone",biale:"Białe",musujace:"Musujące",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment"}[g]||g:"-"})()}),f.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:m.objetosc||"-"}),f.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:m.dataWaznosci?typeof m.dataWaznosci=="number"?new Date(m.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(m.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},y))})]})]})]}),f.jsx("button",{onClick:r,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),f.jsx(r2,{isOpen:o,onClose:()=>i(!1),product:a})]})},t5=({isOpen:e,onClose:r,onAdd:t,initialData:n,isEditMode:a=!1})=>{const[s,o]=S.useState(""),[i,l]=S.useState(""),[c,u]=S.useState(""),[d,p]=S.useState(""),[h,x]=S.useState("");S.useEffect(()=>{console.log("🔍 useEffect triggered:",{isOpen:e,initialData:n}),e&&n?(console.log("🔍 Setting initial data from props"),o(n.firma),l(n.nazwa),u(n.adres),p(n.czas_dostawy),x(n.kontakt)):e&&!n&&console.log("🔍 Modal opened without initial data - keeping current values")},[e,n]);const m=()=>{if(console.log("🔍 handleSubmit called with values:",{firma:s,nazwa:i,adres:c,czas_dostawy:d,kontakt:h}),console.log("🔍 Trimmed values:",{firma:s.trim(),nazwa:i.trim(),adres:c.trim(),czas_dostawy:d.trim(),kontakt:h.trim()}),!s.trim()||!i.trim()||!c.trim()||!d.trim()||!h.trim()){console.log("❌ Validation failed: some fields are empty");return}const g={firma:s.trim(),nazwa:i.trim(),adres:c.trim(),czas_dostawy:d.trim(),kontakt:h.trim()};console.log("✅ Submitting client data:",g),t(g),y()},y=()=>{o(""),l(""),u(""),p(""),x(""),r()};return f.jsx(or,{isOpen:e,onRequestClose:y,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),f.jsx("button",{onClick:y,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-6 flex-grow",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),f.jsx("input",{type:"text",value:s,onChange:g=>{console.log("🔍 firma onChange:",g.target.value),o(g.target.value)},placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),f.jsx("input",{type:"text",value:i,onChange:g=>l(g.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),f.jsx("input",{type:"text",value:c,onChange:g=>u(g.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),f.jsx("input",{type:"text",value:d,onChange:g=>p(g.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),f.jsx("input",{type:"text",value:h,onChange:g=>x(g.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),f.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:f.jsx("button",{onClick:m,disabled:!s.trim()||!i.trim()||!c.trim()||!d.trim()||!h.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!s.trim()||!i.trim()||!c.trim()||!d.trim()||!h.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};gi("pl",vi);const Ff=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],Xg=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],a2=({isOpen:e,onClose:r,onSubmit:t,receipt:n})=>{const[a,s]=S.useState(null),[o,i]=S.useState(""),[l,c]=S.useState({x:0,y:0}),[u,d]=S.useState(!1),[p,h]=S.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),x=S.useRef({x:0,y:0}),[m,y]=S.useState(""),[g,w]=S.useState(null),[v,b]=S.useState(null),[M,C]=S.useState(null),[k,F]=S.useState(null),E=S.useRef(null),j=S.useRef(null),[V,W]=S.useState(null),[te,ee]=S.useState(null);S.useEffect(()=>{if(e&&n){let Y=[];if(n.products)if(typeof n.products=="string")try{Y=JSON.parse(n.products)}catch(K){console.error("Error parsing products JSON:",K),Y=[]}else Array.isArray(n.products)&&(Y=n.products);if(Array.isArray(Y)&&Y.length>0){let K=null;if(n.dataPrzyjecia)if(n.dataPrzyjecia.includes("/")){const[we,pe,me]=n.dataPrzyjecia.split("/");K=new Date(parseInt(me),parseInt(pe)-1,parseInt(we))}else n.dataPrzyjecia.includes("-")?K=new Date(n.dataPrzyjecia):K=new Date(n.dataPrzyjecia);s(K),i(n.sprzedawca||""),y((n.kosztDostawy||0).toFixed(2).replace(".",","));const D=Y.map(we=>({kod:we.kod||"",nazwa:we.nazwa||"",kod_kreskowy:we.kod_kreskowy||we.ean||"",ilosc:(we.ilosc||0).toString(),cena:(we.cena||0).toFixed(2).replace(".",","),dataWaznosci:we.dataWaznosci||"",showDataWaznosci:!1,typ:we.typ||we.typTowaru||"",objetosc:we.objetosc||""}));h(D.length>0?D:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),C(n.productInvoice||null),F(n.transportInvoice||null),w(null),b(null)}else h([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),s(null),i(""),y(""),w(null),b(null),C(null),F(null)}else h([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),s(null),i(""),y(""),w(null),b(null),C(null),F(null)},[e,n]),S.useEffect(()=>{const Y=D=>{const we=D.target;if(!we.closest(".dropdown-container")&&!we.closest('button[onclick*="toggleDropdown"]')&&W(null),!we.closest(".objetosc-dropdown-container")&&!we.closest('button[onclick*="toggleObjetoscDropdown"]')&&ee(null),!we.closest(".react-datepicker")&&!we.closest('button[title*="ważności"]')){const pe=[...p];let me=!1;pe.forEach(_e=>{_e.showDataWaznosci&&(_e.showDataWaznosci=!1,me=!0)}),me&&h(pe)}},K=D=>{if(D.key==="Escape"){W(null),ee(null);const we=[...p];let pe=!1;we.forEach(me=>{me.showDataWaznosci&&(me.showDataWaznosci=!1,pe=!0)}),pe&&h(we)}};return document.addEventListener("mousedown",Y),document.addEventListener("keydown",K),()=>{document.removeEventListener("mousedown",Y),document.removeEventListener("keydown",K)}},[p]);const J=()=>{h([...p,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},ne=Y=>{if(p.length>1){const K=[...p];K.splice(Y,1),h(K)}},B=Y=>{const K=[...p];K[Y].showDataWaznosci=!K[Y].showDataWaznosci,h(K)},q=(Y,K)=>{const D=[...p];D[Y].typ=K,h(D),W(null)},N=Y=>{W(V===Y?null:Y)},U=(Y,K)=>{const D=[...p];D[Y].objetosc=K,h(D),ee(null)},Z=Y=>{ee(te===Y?null:Y)},_=Y=>{Y.target.closest("button")||Y.target.closest("input")||Y.target.closest(".react-datepicker")||Y.target.closest('[role="button"]')||Y.target.closest(".react-datepicker__input-container")||(d(!0),x.current={x:Y.clientX-l.x,y:Y.clientY-l.y})};S.useEffect(()=>{const Y=D=>{u&&requestAnimationFrame(()=>{c({x:D.clientX-x.current.x,y:D.clientY-x.current.y})})},K=()=>{d(!1)};return u&&(window.addEventListener("mousemove",Y),window.addEventListener("mouseup",K)),()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",K)}},[u]);const P=Y=>{var D;const K=(D=Y.target.files)==null?void 0:D[0];console.log("📎 Product file selected (edit):",K),K&&K.type==="application/pdf"?(w(K),console.log("✅ Product invoice set (edit):",K.name)):console.log("❌ Invalid product file type (edit):",K==null?void 0:K.type)},A=Y=>{var D;const K=(D=Y.target.files)==null?void 0:D[0];console.log("📎 Transport file selected (edit):",K),K&&K.type==="application/pdf"?(b(K),console.log("✅ Transport invoice set (edit):",K.name)):console.log("❌ Invalid transport file type (edit):",K==null?void 0:K.type)},z=()=>{var Y;(Y=E.current)==null||Y.click()},Q=()=>{var Y;(Y=j.current)==null||Y.click()},re=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",n),!a||!n){console.log("Early return: selectedDate or receipt is null");return}const Y=p.filter(pe=>pe.kod&&pe.nazwa&&pe.ilosc&&pe.cena);if(console.log("productRows:",p),console.log("validProducts:",Y),console.log("validProducts.length:",Y.length),Y.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const K=Y.map(pe=>({kod:pe.kod,nazwa:pe.nazwa,kod_kreskowy:pe.kod_kreskowy||"",ilosc:parseFloat(pe.ilosc)||0,cena:parseFloat(pe.cena.replace(",","."))||0,dataWaznosci:pe.dataWaznosci||void 0,typ:pe.typ||void 0,objetosc:pe.objetosc?parseFloat(pe.objetosc):void 0})),D=K.reduce((pe,me)=>pe+me.ilosc*me.cena,0),we=parseFloat(m.replace(",","."))||0;console.log("Submitting data:",{id:n.id,date:a.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:D,kosztDostawy:we,products:K}),console.log("📎 Files to submit (edit):",{productInvoice:g,transportInvoice:v}),t({id:n.id,date:a.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:D,kosztDostawy:we,products:K,productInvoice:g||null,transportInvoice:v||null}),oe()},oe=()=>{s(null),c({x:0,y:0}),h([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),y(""),i(""),w(null),b(null),C(null),F(null),r()},X=()=>p.reduce((Y,K)=>{const D=parseFloat(K.ilosc)||0,we=parseFloat(K.cena.replace(",","."))||0;return Y+D*we},0).toFixed(2);return f.jsx(or,{isOpen:e,onRequestClose:oe,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${l.x}px), calc(-50% + ${l.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:_,style:{cursor:u?"grabbing":"grab"},children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:Y=>Y.stopPropagation(),children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),f.jsx("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),oe()},className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsxs("div",{className:"space-y-6 flex-grow",children:[f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"flex",children:[f.jsxs("div",{className:"w-[200px]",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),f.jsx(ms,{selected:a,onChange:Y=>s(Y),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),f.jsx("div",{className:"w-[200px] flex items-start",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:m,onKeyPress:Y=>{const K=String.fromCharCode(Y.which);(!/[\d,]/.test(K)||K===","&&Y.target.value.includes(",")||Y.target.value===""&&K===",")&&Y.preventDefault()},onChange:Y=>{const K=Y.target,D=K.selectionStart??0;let we=K.value.replace(/[^\d,]/g,"");if(we===""){y("");return}if(!we.includes(","))we=we+",00";else{const[me,_e]=we.split(",");_e&&_e.length>2&&(we=`${me},${_e.slice(0,2)}`)}y(we),requestAnimationFrame(()=>{const me=Math.min(D,we.length);K.setSelectionRange(me,me)})},className:"w-[70%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),f.jsx("span",{className:"absolute right-[calc(30%+0.75rem)] top-1/2 -translate-y-1/2 text-gray-500",children:"€"})]})]})}),f.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[f.jsxs("div",{className:"flex items-center w-48",children:[f.jsx("input",{type:"file",accept:".pdf",onChange:P,className:"hidden",ref:E}),f.jsx("button",{type:"button",onClick:z,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:f.jsx(eh,{className:"h-4 w-4 text-gray-500"})}),g&&f.jsx("a",{href:URL.createObjectURL(g),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:g.name,children:g.name}),!g&&M&&f.jsx("a",{href:`${t0}${M}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),f.jsxs("div",{className:"flex items-center w-48",children:[f.jsx("input",{type:"file",accept:".pdf",onChange:A,className:"hidden",ref:j}),f.jsx("button",{type:"button",onClick:Q,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:f.jsx(Zp,{className:"h-4 w-4 text-gray-500"})}),v&&f.jsx("a",{href:URL.createObjectURL(v),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:v.name,children:v.name}),!v&&k&&f.jsx("a",{href:`${t0}${k}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),f.jsx("div",{className:"flex gap-4",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),f.jsx("input",{type:"text",value:o,onChange:Y=>i(Y.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})}),f.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:p.map((Y,K)=>{var D,we,pe;return f.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[f.jsxs("div",{className:"col-span-1.5 relative",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Kod"}),f.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:Y.kod,onChange:me=>{const _e=[...p];_e[K].kod=me.target.value,h(_e)}}),K===p.length-1&&f.jsx("button",{onClick:J,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:f.jsx(Rs,{size:16})})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Nazwa"}),f.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:Y.nazwa,onChange:me=>{const _e=[...p];_e[K].nazwa=me.target.value,h(_e)}})]}),f.jsxs("div",{className:"col-span-2",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Kod kreskowy"}),f.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:Y.kod_kreskowy,onChange:me=>{const _e=[...p];_e[K].kod_kreskowy=me.target.value,h(_e)}})]}),f.jsxs("div",{className:"col-span-1.5",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Ilość"}),f.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:Y.ilosc,onChange:me=>{const _e=[...p],xe=me.target.value;(xe===""||/^\d*$/.test(xe))&&(_e[K].ilosc=xe,h(_e))}})]}),f.jsxs("div",{className:"col-span-2.9 relative",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Cena"}),f.jsx("div",{className:"relative",children:f.jsx("input",{type:"text",value:Y.cena,onKeyPress:me=>{const _e=String.fromCharCode(me.which);(!/[\d,]/.test(_e)||_e===","&&me.target.value.includes(",")||me.target.value===""&&_e===",")&&me.preventDefault()},onChange:me=>{const _e=me.target,xe=_e.selectionStart??0;let $e=me.target.value.replace(/[^\d,]/g,"");if($e===""){const he=[...p];he[K].cena="",h(he);return}if(!$e.includes(","))$e=$e+",00";else{const[he,be]=$e.split(",");be&&be.length>2&&($e=`${he},${be.slice(0,2)}`)}const ue=[...p];ue[K].cena=$e,h(ue),requestAnimationFrame(()=>{const he=Math.min(xe,$e.length);_e.setSelectionRange(he,he)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),f.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Wartość"}),f.jsx("div",{className:"relative flex items-center",children:f.jsx("input",{type:"text",value:(()=>{const me=parseFloat(Y.ilosc)||0,_e=parseFloat(Y.cena.replace(",","."))||0;return(me*_e).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),f.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[f.jsx("button",{type:"button",onClick:()=>B(K),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${Y.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:Y.dataWaznosci?`Termin ważności: ${Y.dataWaznosci}`:"Dodaj termin ważności",children:f.jsx(qp,{size:16})}),f.jsx("button",{onClick:()=>ne(K),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:f.jsx(vt,{size:16})})]}),Y.showDataWaznosci&&f.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:f.jsx(ms,{selected:Y.dataWaznosci?new Date(Y.dataWaznosci):null,onChange:me=>{const _e=[...p];_e[K].dataWaznosci=me?me.toISOString().split("T")[0]:"",_e[K].showDataWaznosci=!1,h(_e)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const me=[...p];me[K].showDataWaznosci=!1,h(me)}})}),f.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Typ"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{type:"button",onClick:()=>N(K),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${Y.typ&&((D=Ff.find(me=>me.value===Y.typ))==null?void 0:D.color)||"border-gray-300 bg-white"}`,children:[f.jsx("span",{className:"truncate",children:Y.typ&&((we=Ff.find(me=>me.value===Y.typ))==null?void 0:we.label)||"Wybierz typ"}),f.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),V===K&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:me=>me.stopPropagation(),children:Ff.map(me=>f.jsx("button",{type:"button",onClick:()=>q(K,me.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${me.color}`,children:me.label},me.value))})]})]}),f.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[f.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${K>0?"invisible":""}`,children:"Objętość"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{type:"button",onClick:()=>Z(K),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${Y.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[f.jsx("span",{className:"truncate",children:Y.objetosc?((pe=Xg.find(me=>me.value===Y.objetosc))==null?void 0:pe.label)||Y.objetosc:"Wybierz"}),f.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),te===K&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:me=>me.stopPropagation(),style:{maxWidth:"200px"},children:Xg.map(me=>f.jsx("button",{type:"button",onClick:()=>U(K,me.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:me.label},me.value))})]})]})]},K)})})]}),f.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[f.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),f.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[X().replace(".",",")," €"]})]}),f.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:f.jsx("button",{onClick:re,disabled:!a||!p.some(Y=>Y.kod&&Y.nazwa&&Y.ilosc&&Y.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!p.some(Y=>Y.kod&&Y.nazwa&&Y.ilosc&&Y.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},r5=({receipts:e,products:r,onDelete:t,onEdit:n,onUpdate:a,selectedCategory:s=""})=>{const[o,i]=S.useState(null),[l,c]=S.useState(!1),[u,d]=S.useState(!1),[p,h]=S.useState(null),[x,m]=S.useState(!1),[y,g]=S.useState(null),[w,v]=S.useState(""),[b,M]=S.useState({x:0,y:0}),[C,k]=S.useState(!1),F=S.useRef({x:0,y:0}),[E,j]=S.useState("dataPrzyjecia"),[V,W]=S.useState("desc"),[te,ee]=S.useState(""),[J,ne]=S.useState(""),B=X=>{i(X),c(!0)},q=X=>{h(X),d(!0)},N=X=>{g(X),m(!0),v("")},U=()=>{w==="5202"?(y!=null&&y.id&&(t(y.id),je.success("Zapis został usunięty")),Z()):(je.error("Nieprawidłowe hasło"),v(""))},Z=()=>{m(!1),g(null),v(""),M({x:0,y:0})},_=X=>{X.key==="Enter"&&U()},P=X=>{E===X?W(V==="asc"?"desc":"asc"):(j(X),W("asc"))},A=X=>{X.target.closest("button")||X.target.closest("input")||(k(!0),F.current={x:X.clientX-b.x,y:X.clientY-b.y})};S.useEffect(()=>{const X=K=>{C&&requestAnimationFrame(()=>{M({x:K.clientX-F.current.x,y:K.clientY-F.current.y})})},Y=()=>{k(!1)};return C&&(window.addEventListener("mousemove",X),window.addEventListener("mouseup",Y)),()=>{window.removeEventListener("mousemove",X),window.removeEventListener("mouseup",Y)}},[C]);const z=Array.from(new Set(e.map(X=>new Date(X.dataPrzyjecia).getFullYear().toString()))).sort((X,Y)=>parseInt(Y)-parseInt(X)),Q=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],oe=e.filter(X=>{if(s)if(typeof X.products=="string")try{if(!JSON.parse(X.products).some(D=>D.typ===s))return!1}catch{return!1}else if(Array.isArray(X.products)){if(!X.products.some(K=>K.typ===s))return!1}else return!1;return!(te&&new Date(X.dataPrzyjecia).getFullYear().toString()!==te||J&&(new Date(X.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==J)}).sort((X,Y)=>{let K,D;switch(E){case"dataPrzyjecia":K=new Date(X.dataPrzyjecia),D=new Date(Y.dataPrzyjecia);break;case"sprzedawca":K=(X.sprzedawca||"").toLowerCase(),D=(Y.sprzedawca||"").toLowerCase();break;case"wartosc":K=X.wartosc,D=Y.wartosc;break;case"kosztDostawy":K=X.kosztDostawy,D=Y.kosztDostawy;break;default:K=X[E]||"",D=Y[E]||""}return typeof K=="string"&&typeof D=="string"?V==="asc"?K.localeCompare(D):D.localeCompare(K):typeof K=="number"&&typeof D=="number"?V==="asc"?K-D:D-K:K instanceof Date&&D instanceof Date?V==="asc"?K.getTime()-D.getTime():D.getTime()-K.getTime():0});return f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"sticky top-0 z-10",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("dataPrzyjecia"),children:"Data zakupu"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("sprzedawca"),children:"Sprzedawca"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("wartosc"),children:"Wartość"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("kosztDostawy"),children:"Koszt dostawy"}),f.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:f.jsxs("div",{className:"flex space-x-1 justify-end",children:[f.jsxs("select",{value:te,onChange:X=>ee(X.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[f.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),z.map(X=>f.jsx("option",{value:X,style:{fontFamily:"Sora, sans-serif"},children:X},X))]}),f.jsxs("select",{value:J,onChange:X=>ne(X.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[f.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Msc"}),Q.map(X=>f.jsx("option",{value:X.value,style:{fontFamily:"Sora, sans-serif"},children:X.label},X.value))]})]})})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:oe.map(X=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:X.dataPrzyjecia}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:X.sprzedawca}),f.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[X.wartosc.toFixed(2)," €"]}),f.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[X.kosztDostawy.toFixed(2)," €"]}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),B(X)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:f.jsx(Jp,{size:16})}),f.jsx("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),q(X)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:f.jsx(w0,{size:16})}),f.jsx("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),N(X)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:f.jsx(vt,{size:16})})]})})]},X.id))})]})}),f.jsx(or,{isOpen:x,onRequestClose:Z,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${b.x}px), calc(-50% + ${b.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:A,style:{cursor:C?"grabbing":"grab"},children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),f.jsx("button",{onClick:Z,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-6 flex-grow",children:f.jsx("div",{children:f.jsx("input",{type:"password",value:w,onChange:X=>v(X.target.value),onKeyPress:_,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),f.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[f.jsx("button",{onClick:Z,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),f.jsx("button",{onClick:U,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),f.jsx(n2,{isOpen:l,onClose:()=>c(!1),receipt:o,products:r}),f.jsx(a2,{isOpen:u,onClose:()=>{d(!1),h(null)},onSubmit:X=>{a({...X,productInvoice:X.productInvoice??void 0,transportInvoice:X.transportInvoice??void 0}),d(!1),h(null)},receipt:p?{id:p.id||0,dataPrzyjecia:p.dataPrzyjecia,sprzedawca:p.sprzedawca,wartosc:p.wartosc,kosztDostawy:p.kosztDostawy,products:p.products,productInvoice:p.productInvoice,transportInvoice:p.transportInvoice}:null})]})},n5=({isOpen:e,onClose:r,client:t})=>t?f.jsx(or,{isOpen:e,onRequestClose:r,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły klienta"}),f.jsx("button",{onClick:r,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:f.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),f.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),f.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),f.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),f.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),f.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),f.jsx("button",{onClick:r,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,s2=({isOpen:e,onClose:r,onSubmit:t,client:n})=>{const[a,s]=S.useState(""),[o,i]=S.useState(""),[l,c]=S.useState(""),[u,d]=S.useState(""),[p,h]=S.useState("");S.useEffect(()=>{e&&n?(s(n.firma||""),i(n.nazwa||""),c(n.adres||""),d(n.czas_dostawy||""),h(n.kontakt||"")):(s(""),i(""),c(""),d(""),h(""))},[e,n]);const x=async()=>{if(a.trim()&&o.trim()&&l.trim()&&u.trim()&&p.trim()&&n){const y={id:n.id,firma:a,nazwa:o,adres:l,czas_dostawy:u,kontakt:p};t(y),m()}},m=()=>{s(""),i(""),c(""),d(""),h(""),r()};return f.jsx(or,{isOpen:e,onRequestClose:m,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),f.jsx("button",{onClick:m,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-6 flex-grow",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),f.jsx("input",{type:"text",value:a,onChange:y=>s(y.target.value),placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),f.jsx("input",{type:"text",value:o,onChange:y=>i(y.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),f.jsx("input",{type:"text",value:l,onChange:y=>c(y.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),f.jsx("input",{type:"text",value:u,onChange:y=>d(y.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),f.jsx("input",{type:"text",value:p,onChange:y=>h(y.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),f.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:f.jsx("button",{onClick:x,disabled:!a.trim()||!o.trim()||!l.trim()||!u.trim()||!p.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!o.trim()||!l.trim()||!u.trim()||!p.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},a5=({clients:e,onDelete:r,onEdit:t,onUpdate:n})=>{console.log("🔍 ClientsList render - clients:",e),console.log("🔍 ClientsList render - clients length:",e.length),console.log("🔍 ClientsList render - first client:",e[0]),console.log("🔍 ClientsList render - all clients:",e.map(U=>({id:U.id,firma:U.firma,nazwa:U.nazwa})));const[a,s]=S.useState(null),[o,i]=S.useState(!1),[l,c]=S.useState(!1),[u,d]=S.useState(null),[p,h]=S.useState(!1),[x,m]=S.useState(null),[y,g]=S.useState(""),[w,v]=S.useState({x:0,y:0}),[b,M]=S.useState(!1),C=S.useRef({x:0,y:0}),[k,F]=S.useState(""),[E,j]=S.useState("asc");e&&e.length>0,S.useEffect(()=>{console.log("🔍 ClientsList useEffect - clients changed:",e),console.log("🔍 ClientsList useEffect - clients length:",e.length)},[e]);const V=U=>{s(U),i(!0)},W=U=>{d(U),c(!0)},te=U=>{m(U),h(!0),g("")},ee=()=>{y==="5202"?(x!=null&&x.id&&r(x.id),J()):(je.error("Nieprawidłowe hasło"),g(""))},J=()=>{h(!1),m(null),g(""),v({x:0,y:0})},ne=U=>{U.key==="Enter"&&ee()},B=U=>{k===U?j(E==="asc"?"desc":"asc"):(F(U),j("asc"))},q=U=>{U.target.closest("button")||U.target.closest("input")||(M(!0),C.current={x:U.clientX-w.x,y:U.clientY-w.y})};S.useEffect(()=>{const U=_=>{b&&requestAnimationFrame(()=>{v({x:_.clientX-C.current.x,y:_.clientY-C.current.y})})},Z=()=>{M(!1)};return b&&(window.addEventListener("mousemove",U),window.addEventListener("mouseup",Z)),()=>{window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",Z)}},[b]),console.log("🔍 Sorting logic - sortField:",k,"sortDirection:",E),console.log("🔍 Sorting logic - clients length:",e.length);const N=k?[...e].sort((U,Z)=>{let _,P;switch(k){case"firma":_=(U.firma||"").toLowerCase(),P=(Z.firma||"").toLowerCase();break;case"nazwa":_=(U.nazwa||"").toLowerCase(),P=(Z.nazwa||"").toLowerCase();break;case"adres":_=(U.adres||"").toLowerCase(),P=(Z.adres||"").toLowerCase();break;case"czas_dostawy":_=(U.czas_dostawy||"").toLowerCase(),P=(Z.czas_dostawy||"").toLowerCase();break;case"kontakt":_=(U.kontakt||"").toLowerCase(),P=(Z.kontakt||"").toLowerCase();break;default:_=U[k]||"",P=Z[k]||""}return typeof _=="string"&&typeof P=="string"?E==="asc"?_.localeCompare(P):P.localeCompare(_):0}):e;return console.log("🔍 Final sortedClients length:",N.length),console.log("🔍 Final sortedClients first:",N[0]),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"sticky top-0 z-10",children:f.jsxs("tr",{children:[f.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${k==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>B("firma"),children:["Nazwa firmy ",k==="firma"&&(E==="asc"?"↑":"↓")]}),f.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${k==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>B("nazwa"),children:["Nazwa ",k==="nazwa"&&(E==="asc"?"↑":"↓")]}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>B("adres"),children:"Adres"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>B("czas_dostawy"),children:"Czas dostawy"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>B("kontakt"),children:"Kontakt"}),f.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:k&&f.jsx("button",{onClick:()=>{F(""),j("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:"Сбросить сортировку",children:"Сброс"})})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map((U,Z)=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:U.firma}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:U.nazwa}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:U.adres}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:U.czas_dostawy}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:U.kontakt}),f.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{type:"button",onClick:_=>{_.preventDefault(),_.stopPropagation(),V(U)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:f.jsx(Jp,{size:16})}),f.jsx("button",{type:"button",onClick:_=>{_.preventDefault(),_.stopPropagation(),W(U)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:f.jsx(w0,{size:16})}),f.jsx("button",{type:"button",onClick:_=>{_.preventDefault(),_.stopPropagation(),te(U)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:f.jsx(vt,{size:16})})]})})]},U.id||`client-${Z}`))})]})}),f.jsx(or,{isOpen:p,onRequestClose:J,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${w.x}px), calc(-50% + ${w.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:q,style:{cursor:b?"grabbing":"grab"},children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),f.jsx("button",{onClick:J,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("div",{className:"space-y-6 flex-grow",children:f.jsx("div",{children:f.jsx("input",{type:"password",value:y,onChange:U=>g(U.target.value),onKeyPress:ne,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),f.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[f.jsx("button",{onClick:J,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),f.jsx("button",{onClick:ee,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),f.jsx(n5,{isOpen:o,onClose:()=>i(!1),client:a}),f.jsx(s2,{isOpen:l,onClose:()=>{c(!1),d(null)},onSubmit:U=>{n(U),c(!1),d(null)},client:u})]})};var o2={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var r={}.hasOwnProperty;function t(){for(var s="",o=0;o<arguments.length;o++){var i=arguments[o];i&&(s=a(s,n(i)))}return s}function n(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var i in s)r.call(s,i)&&s[i]&&(o=a(o,i));return o}function a(s,o){return o?s?s+" "+o:s+o:s}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(o2);var s5=o2.exports;const tp=r0(s5);var Qg={};const o5="react-tooltip-core-styles",i5="react-tooltip-base-styles",qg={core:!1,base:!1};function Zg({css:e,id:r=i5,type:t="base",ref:n}){var a,s;if(!e||typeof document>"u"||qg[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Qg)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((s=process==null?void 0:Qg)===null||s===void 0)&&s.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(r=o5),n||(n={});const{insertAt:o}=n;if(document.getElementById(r))return;const i=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.id=r,l.type="text/css",o==="top"&&i.firstChild?i.insertBefore(l,i.firstChild):i.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e)),qg[t]=!0}const Jg=async({elementReference:e=null,tooltipReference:r=null,tooltipArrowReference:t=null,place:n="top",offset:a=10,strategy:s="absolute",middlewares:o=[Wk(Number(a)),Uk({fallbackAxisSideDirection:"start"}),iR({padding:5})],border:i,arrowSize:l=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:n};if(r===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:n};const c=o;return t?(c.push(Qd({element:t,padding:5})),qd(e,r,{placement:n,strategy:s,middleware:c}).then(({x:u,y:d,placement:p,middlewareData:h})=>{var x,m;const y={left:`${u}px`,top:`${d}px`,border:i},{x:g,y:w}=(x=h.arrow)!==null&&x!==void 0?x:{x:0,y:0},v=(m={top:"bottom",right:"left",bottom:"top",left:"right"}[p.split("-")[0]])!==null&&m!==void 0?m:"bottom",b=i&&{borderBottom:i,borderRight:i};let M=0;if(i){const C=`${i}`.match(/(\d+)px/);M=C!=null&&C[1]?Number(C[1]):1}return{tooltipStyles:y,tooltipArrowStyles:{left:g!=null?`${g}px`:"",top:w!=null?`${w}px`:"",right:"",bottom:"",...b,[v]:`-${l/2+M}px`},place:p}})):qd(e,r,{placement:"bottom",strategy:s,middleware:c}).then(({x:u,y:d,placement:p})=>({tooltipStyles:{left:`${u}px`,top:`${d}px`},tooltipArrowStyles:{},place:p}))},ev=(e,r)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,r),tv=(e,r,t)=>{let n=null;const a=function(...s){const o=()=>{n=null};!n&&(e.apply(this,s),n=setTimeout(o,r))};return a.cancel=()=>{n&&(clearTimeout(n),n=null)},a},rv=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",rp=(e,r)=>{if(e===r)return!0;if(Array.isArray(e)&&Array.isArray(r))return e.length===r.length&&e.every((a,s)=>rp(a,r[s]));if(Array.isArray(e)!==Array.isArray(r))return!1;if(!rv(e)||!rv(r))return e===r;const t=Object.keys(e),n=Object.keys(r);return t.length===n.length&&t.every(a=>rp(e[a],r[a]))},l5=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const r=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some(t=>{const n=r.getPropertyValue(t);return n==="auto"||n==="scroll"})},nv=e=>{if(!e)return null;let r=e.parentElement;for(;r;){if(l5(r))return r;r=r.parentElement}return document.scrollingElement||document.documentElement},c5=typeof window<"u"?S.useLayoutEffect:S.useEffect,on=e=>{e.current&&(clearTimeout(e.current),e.current=null)},u5="DEFAULT_TOOLTIP_ID",f5={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},d5=S.createContext({getTooltipData:()=>f5});function i2(e=u5){return S.useContext(d5).getTooltipData(e)}var xo={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},Af={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const p5=({forwardRef:e,id:r,className:t,classNameArrow:n,variant:a="dark",anchorId:s,anchorSelect:o,place:i="top",offset:l=10,events:c=["hover"],openOnClick:u=!1,positionStrategy:d="absolute",middlewares:p,wrapper:h,delayShow:x=0,delayHide:m=0,float:y=!1,hidden:g=!1,noArrow:w=!1,clickable:v=!1,closeOnEsc:b=!1,closeOnScroll:M=!1,closeOnResize:C=!1,openEvents:k,closeEvents:F,globalCloseEvents:E,imperativeModeOnly:j,style:V,position:W,afterShow:te,afterHide:ee,disableTooltip:J,content:ne,contentWrapperRef:B,isOpen:q,defaultIsOpen:N=!1,setIsOpen:U,activeAnchor:Z,setActiveAnchor:_,border:P,opacity:A,arrowColor:z,arrowSize:Q=8,role:re="tooltip"})=>{var oe;const X=S.useRef(null),Y=S.useRef(null),K=S.useRef(null),D=S.useRef(null),we=S.useRef(null),[pe,me]=S.useState({tooltipStyles:{},tooltipArrowStyles:{},place:i}),[_e,xe]=S.useState(!1),[$e,G]=S.useState(!1),[ue,he]=S.useState(null),be=S.useRef(!1),Fe=S.useRef(null),{anchorRefs:Me,setActiveAnchor:tt}=i2(r),at=S.useRef(!1),[yt,gt]=S.useState([]),ct=S.useRef(!1),Pe=u||c.includes("click"),qe=Pe||(k==null?void 0:k.click)||(k==null?void 0:k.dblclick)||(k==null?void 0:k.mousedown),wt=k?{...k}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!k&&Pe&&Object.assign(wt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const We=F?{...F}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!F&&Pe&&Object.assign(We,{mouseleave:!1,blur:!1,mouseout:!1});const Je=E?{...E}:{escape:b||!1,scroll:M||!1,resize:C||!1,clickOutsideAnchor:qe||!1};j&&(Object.assign(wt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(We,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(Je,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),c5(()=>(ct.current=!0,()=>{ct.current=!1}),[]);const pt=Ne=>{ct.current&&(Ne&&G(!0),setTimeout(()=>{ct.current&&(U==null||U(Ne),q===void 0&&xe(Ne))},10))};S.useEffect(()=>{if(q===void 0)return()=>null;q&&G(!0);const Ne=setTimeout(()=>{xe(q)},10);return()=>{clearTimeout(Ne)}},[q]),S.useEffect(()=>{if(_e!==be.current)if(on(we),be.current=_e,_e)te==null||te();else{const Ne=(Be=>{const Ye=Be.match(/^([\d.]+)(ms|s)$/);if(!Ye)return 0;const[,Wt,tr]=Ye;return Number(Wt)*(tr==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));we.current=setTimeout(()=>{G(!1),he(null),ee==null||ee()},Ne+25)}},[_e]);const Ia=Ne=>{me(Be=>rp(Be,Ne)?Be:Ne)},fa=(Ne=x)=>{on(K),$e?pt(!0):K.current=setTimeout(()=>{pt(!0)},Ne)},ae=(Ne=m)=>{on(D),D.current=setTimeout(()=>{at.current||pt(!1)},Ne)},Ee=Ne=>{var Be;if(!Ne)return;const Ye=(Be=Ne.currentTarget)!==null&&Be!==void 0?Be:Ne.target;if(!(Ye!=null&&Ye.isConnected))return _(null),void tt({current:null});x?fa():pt(!0),_(Ye),tt({current:Ye}),on(D)},Se=()=>{v?ae(m||100):m?ae():pt(!1),on(K)},Ie=({x:Ne,y:Be})=>{var Ye;const Wt={getBoundingClientRect:()=>({x:Ne,y:Be,width:0,height:0,top:Be,left:Ne,right:Ne,bottom:Be})};Jg({place:(Ye=ue==null?void 0:ue.place)!==null&&Ye!==void 0?Ye:i,offset:l,elementReference:Wt,tooltipReference:X.current,tooltipArrowReference:Y.current,strategy:d,middlewares:p,border:P,arrowSize:Q}).then(tr=>{Ia(tr)})},Le=Ne=>{if(!Ne)return;const Be=Ne,Ye={x:Be.clientX,y:Be.clientY};Ie(Ye),Fe.current=Ye},ft=Ne=>{var Be;if(!_e)return;const Ye=Ne.target;Ye.isConnected&&(!((Be=X.current)===null||Be===void 0)&&Be.contains(Ye)||[document.querySelector(`[id='${s}']`),...yt].some(Wt=>Wt==null?void 0:Wt.contains(Ye))||(pt(!1),on(K)))},_t=tv(Ee,50),Dt=tv(Se,50),mr=Ne=>{Dt.cancel(),_t(Ne)},ze=()=>{_t.cancel(),Dt()},Ze=S.useCallback(()=>{var Ne,Be;const Ye=(Ne=ue==null?void 0:ue.position)!==null&&Ne!==void 0?Ne:W;Ye?Ie(Ye):y?Fe.current&&Ie(Fe.current):Z!=null&&Z.isConnected&&Jg({place:(Be=ue==null?void 0:ue.place)!==null&&Be!==void 0?Be:i,offset:l,elementReference:Z,tooltipReference:X.current,tooltipArrowReference:Y.current,strategy:d,middlewares:p,border:P,arrowSize:Q}).then(Wt=>{ct.current&&Ia(Wt)})},[_e,Z,ne,V,i,ue==null?void 0:ue.place,l,d,W,ue==null?void 0:ue.position,y,Q]);S.useEffect(()=>{var Ne,Be;const Ye=new Set(Me);yt.forEach(ge=>{J!=null&&J(ge)||Ye.add({current:ge})});const Wt=document.querySelector(`[id='${s}']`);Wt&&!(J!=null&&J(Wt))&&Ye.add({current:Wt});const tr=()=>{pt(!1)},T=nv(Z),L=nv(X.current);Je.scroll&&(window.addEventListener("scroll",tr),T==null||T.addEventListener("scroll",tr),L==null||L.addEventListener("scroll",tr));let O=null;Je.resize?window.addEventListener("resize",tr):Z&&X.current&&(O=Bk(Z,X.current,Ze,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const R=ge=>{ge.key==="Escape"&&pt(!1)};Je.escape&&window.addEventListener("keydown",R),Je.clickOutsideAnchor&&window.addEventListener("click",ft);const I=[],H=ge=>!!(ge!=null&&ge.target&&(Z!=null&&Z.contains(ge.target))),ie=ge=>{_e&&H(ge)||Ee(ge)},de=ge=>{_e&&H(ge)&&Se()},se=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],le=["click","dblclick","mousedown","mouseup"];Object.entries(wt).forEach(([ge,ve])=>{ve&&(se.includes(ge)?I.push({event:ge,listener:mr}):le.includes(ge)&&I.push({event:ge,listener:ie}))}),Object.entries(We).forEach(([ge,ve])=>{ve&&(se.includes(ge)?I.push({event:ge,listener:ze}):le.includes(ge)&&I.push({event:ge,listener:de}))}),y&&I.push({event:"pointermove",listener:Le});const ce=()=>{at.current=!0},ye=()=>{at.current=!1,Se()},Te=v&&(We.mouseout||We.mouseleave);return Te&&((Ne=X.current)===null||Ne===void 0||Ne.addEventListener("mouseover",ce),(Be=X.current)===null||Be===void 0||Be.addEventListener("mouseout",ye)),I.forEach(({event:ge,listener:ve})=>{Ye.forEach(Ce=>{var Ue;(Ue=Ce.current)===null||Ue===void 0||Ue.addEventListener(ge,ve)})}),()=>{var ge,ve;Je.scroll&&(window.removeEventListener("scroll",tr),T==null||T.removeEventListener("scroll",tr),L==null||L.removeEventListener("scroll",tr)),Je.resize?window.removeEventListener("resize",tr):O==null||O(),Je.clickOutsideAnchor&&window.removeEventListener("click",ft),Je.escape&&window.removeEventListener("keydown",R),Te&&((ge=X.current)===null||ge===void 0||ge.removeEventListener("mouseover",ce),(ve=X.current)===null||ve===void 0||ve.removeEventListener("mouseout",ye)),I.forEach(({event:Ce,listener:Ue})=>{Ye.forEach(St=>{var kt;(kt=St.current)===null||kt===void 0||kt.removeEventListener(Ce,Ue)})})}},[Z,Ze,$e,Me,yt,k,F,E,Pe,x,m]),S.useEffect(()=>{var Ne,Be;let Ye=(Be=(Ne=ue==null?void 0:ue.anchorSelect)!==null&&Ne!==void 0?Ne:o)!==null&&Be!==void 0?Be:"";!Ye&&r&&(Ye=`[data-tooltip-id='${r.replace(/'/g,"\\'")}']`);const Wt=new MutationObserver(tr=>{const T=[],L=[];tr.forEach(O=>{if(O.type==="attributes"&&O.attributeName==="data-tooltip-id"&&(O.target.getAttribute("data-tooltip-id")===r?T.push(O.target):O.oldValue===r&&L.push(O.target)),O.type==="childList"){if(Z){const R=[...O.removedNodes].filter(I=>I.nodeType===1);if(Ye)try{L.push(...R.filter(I=>I.matches(Ye))),L.push(...R.flatMap(I=>[...I.querySelectorAll(Ye)]))}catch{}R.some(I=>{var H;return!!(!((H=I==null?void 0:I.contains)===null||H===void 0)&&H.call(I,Z))&&(G(!1),pt(!1),_(null),on(K),on(D),!0)})}if(Ye)try{const R=[...O.addedNodes].filter(I=>I.nodeType===1);T.push(...R.filter(I=>I.matches(Ye))),T.push(...R.flatMap(I=>[...I.querySelectorAll(Ye)]))}catch{}}}),(T.length||L.length)&&gt(O=>[...O.filter(R=>!L.includes(R)),...T])});return Wt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{Wt.disconnect()}},[r,o,ue==null?void 0:ue.anchorSelect,Z]),S.useEffect(()=>{Ze()},[Ze]),S.useEffect(()=>{if(!(B!=null&&B.current))return()=>null;const Ne=new ResizeObserver(()=>{setTimeout(()=>Ze())});return Ne.observe(B.current),()=>{Ne.disconnect()}},[ne,B==null?void 0:B.current]),S.useEffect(()=>{var Ne;const Be=document.querySelector(`[id='${s}']`),Ye=[...yt,Be];Z&&Ye.includes(Z)||_((Ne=yt[0])!==null&&Ne!==void 0?Ne:Be)},[s,yt,Z]),S.useEffect(()=>(N&&pt(!0),()=>{on(K),on(D)}),[]),S.useEffect(()=>{var Ne;let Be=(Ne=ue==null?void 0:ue.anchorSelect)!==null&&Ne!==void 0?Ne:o;if(!Be&&r&&(Be=`[data-tooltip-id='${r.replace(/'/g,"\\'")}']`),Be)try{const Ye=Array.from(document.querySelectorAll(Be));gt(Ye)}catch{gt([])}},[r,o,ue==null?void 0:ue.anchorSelect]),S.useEffect(()=>{K.current&&(on(K),fa(x))},[x]);const Nr=(oe=ue==null?void 0:ue.content)!==null&&oe!==void 0?oe:ne,da=_e&&Object.keys(pe.tooltipStyles).length>0;return S.useImperativeHandle(e,()=>({open:Ne=>{if(Ne!=null&&Ne.anchorSelect)try{document.querySelector(Ne.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ne.anchorSelect}" is not a valid CSS selector`)}he(Ne??null),Ne!=null&&Ne.delay?fa(Ne.delay):pt(!0)},close:Ne=>{Ne!=null&&Ne.delay?ae(Ne.delay):pt(!1)},activeAnchor:Z,place:pe.place,isOpen:!!($e&&!g&&Nr&&da)})),$e&&!g&&Nr?fe.createElement(h,{id:r,role:re,className:tp("react-tooltip",xo.tooltip,Af.tooltip,Af[a],t,`react-tooltip__place-${pe.place}`,xo[da?"show":"closing"],da?"react-tooltip__show":"react-tooltip__closing",d==="fixed"&&xo.fixed,v&&xo.clickable),onTransitionEnd:Ne=>{on(we),_e||Ne.propertyName!=="opacity"||(G(!1),he(null),ee==null||ee())},style:{...V,...pe.tooltipStyles,opacity:A!==void 0&&da?A:void 0},ref:X},Nr,fe.createElement(h,{className:tp("react-tooltip-arrow",xo.arrow,Af.arrow,n,w&&xo.noArrow),style:{...pe.tooltipArrowStyles,background:z?`linear-gradient(to right bottom, transparent 50%, ${z} 50%)`:void 0,"--rt-arrow-size":`${Q}px`},ref:Y})):null},h5=({content:e})=>fe.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),av=fe.forwardRef(({id:e,anchorId:r,anchorSelect:t,content:n,html:a,render:s,className:o,classNameArrow:i,variant:l="dark",place:c="top",offset:u=10,wrapper:d="div",children:p=null,events:h=["hover"],openOnClick:x=!1,positionStrategy:m="absolute",middlewares:y,delayShow:g=0,delayHide:w=0,float:v=!1,hidden:b=!1,noArrow:M=!1,clickable:C=!1,closeOnEsc:k=!1,closeOnScroll:F=!1,closeOnResize:E=!1,openEvents:j,closeEvents:V,globalCloseEvents:W,imperativeModeOnly:te=!1,style:ee,position:J,isOpen:ne,defaultIsOpen:B=!1,disableStyleInjection:q=!1,border:N,opacity:U,arrowColor:Z,arrowSize:_,setIsOpen:P,afterShow:A,afterHide:z,disableTooltip:Q,role:re="tooltip"},oe)=>{const[X,Y]=S.useState(n),[K,D]=S.useState(a),[we,pe]=S.useState(c),[me,_e]=S.useState(l),[xe,$e]=S.useState(u),[G,ue]=S.useState(g),[he,be]=S.useState(w),[Fe,Me]=S.useState(v),[tt,at]=S.useState(b),[yt,gt]=S.useState(d),[ct,Pe]=S.useState(h),[qe,wt]=S.useState(m),[We,Je]=S.useState(null),[pt,Ia]=S.useState(null),fa=S.useRef(q),{anchorRefs:ae,activeAnchor:Ee}=i2(e),Se=Dt=>Dt==null?void 0:Dt.getAttributeNames().reduce((mr,ze)=>{var Ze;return ze.startsWith("data-tooltip-")&&(mr[ze.replace(/^data-tooltip-/,"")]=(Ze=Dt==null?void 0:Dt.getAttribute(ze))!==null&&Ze!==void 0?Ze:null),mr},{}),Ie=Dt=>{const mr={place:ze=>{var Ze;pe((Ze=ze)!==null&&Ze!==void 0?Ze:c)},content:ze=>{Y(ze??n)},html:ze=>{D(ze??a)},variant:ze=>{var Ze;_e((Ze=ze)!==null&&Ze!==void 0?Ze:l)},offset:ze=>{$e(ze===null?u:Number(ze))},wrapper:ze=>{var Ze;gt((Ze=ze)!==null&&Ze!==void 0?Ze:d)},events:ze=>{const Ze=ze==null?void 0:ze.split(" ");Pe(Ze??h)},"position-strategy":ze=>{var Ze;wt((Ze=ze)!==null&&Ze!==void 0?Ze:m)},"delay-show":ze=>{ue(ze===null?g:Number(ze))},"delay-hide":ze=>{be(ze===null?w:Number(ze))},float:ze=>{Me(ze===null?v:ze==="true")},hidden:ze=>{at(ze===null?b:ze==="true")},"class-name":ze=>{Je(ze)}};Object.values(mr).forEach(ze=>ze(null)),Object.entries(Dt).forEach(([ze,Ze])=>{var Nr;(Nr=mr[ze])===null||Nr===void 0||Nr.call(mr,Ze)})};S.useEffect(()=>{Y(n)},[n]),S.useEffect(()=>{D(a)},[a]),S.useEffect(()=>{pe(c)},[c]),S.useEffect(()=>{_e(l)},[l]),S.useEffect(()=>{$e(u)},[u]),S.useEffect(()=>{ue(g)},[g]),S.useEffect(()=>{be(w)},[w]),S.useEffect(()=>{Me(v)},[v]),S.useEffect(()=>{at(b)},[b]),S.useEffect(()=>{wt(m)},[m]),S.useEffect(()=>{fa.current!==q&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")},[q]),S.useEffect(()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:q==="core",disableBase:q}}))},[]),S.useEffect(()=>{var Dt;const mr=new Set(ae);let ze=t;if(!ze&&e&&(ze=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),ze)try{document.querySelectorAll(ze).forEach(Be=>{mr.add({current:Be})})}catch{console.warn(`[react-tooltip] "${ze}" is not a valid CSS selector`)}const Ze=document.querySelector(`[id='${r}']`);if(Ze&&mr.add({current:Ze}),!mr.size)return()=>null;const Nr=(Dt=pt??Ze)!==null&&Dt!==void 0?Dt:Ee.current,da=new MutationObserver(Be=>{Be.forEach(Ye=>{var Wt;if(!Nr||Ye.type!=="attributes"||!(!((Wt=Ye.attributeName)===null||Wt===void 0)&&Wt.startsWith("data-tooltip-")))return;const tr=Se(Nr);Ie(tr)})}),Ne={attributes:!0,childList:!1,subtree:!1};if(Nr){const Be=Se(Nr);Ie(Be),da.observe(Nr,Ne)}return()=>{da.disconnect()}},[ae,Ee,pt,r,t]),S.useEffect(()=>{ee!=null&&ee.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),N&&!ev("border",`${N}`)&&console.warn(`[react-tooltip] "${N}" is not a valid \`border\`.`),ee!=null&&ee.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),U&&!ev("opacity",`${U}`)&&console.warn(`[react-tooltip] "${U}" is not a valid \`opacity\`.`)},[]);let Le=p;const ft=S.useRef(null);if(s){const Dt=s({content:(pt==null?void 0:pt.getAttribute("data-tooltip-content"))||X||null,activeAnchor:pt});Le=Dt?fe.createElement("div",{ref:ft,className:"react-tooltip-content-wrapper"},Dt):null}else X&&(Le=X);K&&(Le=fe.createElement(h5,{content:K}));const _t={forwardRef:oe,id:e,anchorId:r,anchorSelect:t,className:tp(o,We),classNameArrow:i,content:Le,contentWrapperRef:ft,place:we,variant:me,offset:xe,wrapper:yt,events:ct,openOnClick:x,positionStrategy:qe,middlewares:y,delayShow:G,delayHide:he,float:Fe,hidden:tt,noArrow:M,clickable:C,closeOnEsc:k,closeOnScroll:F,closeOnResize:E,openEvents:j,closeEvents:V,globalCloseEvents:W,imperativeModeOnly:te,style:ee,position:J,isOpen:ne,defaultIsOpen:B,border:N,opacity:U,arrowColor:Z,arrowSize:_,setIsOpen:P,afterShow:A,afterHide:z,disableTooltip:Q,activeAnchor:pt,setActiveAnchor:Dt=>Ia(Dt),role:re};return fe.createElement(p5,{..._t})});typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",e=>{e.detail.disableCore||Zg({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Zg({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})});gi("pl",vi);const Of=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],m5=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],x5=({isOpen:e,onClose:r,item:t,onSave:n})=>{var k,F;const[a,s]=S.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:""}),[o,i]=S.useState(!1),[l,c]=S.useState(!1),[u,d]=S.useState(!1),[p,h]=S.useState(!1),[x,m]=S.useState(null);S.useEffect(()=>{if(t)if(s({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const E=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(E).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():""}),t.data_waznosci){let E;if(typeof t.data_waznosci=="string")E=new Date(t.data_waznosci);else{const j=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;E=new Date(j)}m(isNaN(E.getTime())?null:E)}else m(null)},[t]);const y=E=>{s(j=>({...j,typ:E})),c(!1)},g=()=>{c(!l)},w=E=>{s(j=>({...j,objetosc:E})),d(!1)},v=()=>{d(!u)},b=()=>{h(!p)},M=E=>{m(E),s(j=>({...j,data_waznosci:E?E.toISOString().split("T")[0]:""})),h(!1)};S.useEffect(()=>{const E=V=>{const W=V.target;l&&!W.closest(".dropdown-container")&&c(!1),u&&!W.closest(".dropdown-container")&&d(!1),p&&!W.closest(".react-datepicker")&&!W.closest('button[title*="ważności"]')&&h(!1)},j=V=>{V.key==="Escape"&&(c(!1),d(!1),h(!1))};return(l||u||p)&&(document.addEventListener("mousedown",E),document.addEventListener("keydown",j)),()=>{document.removeEventListener("mousedown",E),document.removeEventListener("keydown",j)}},[l,u,p]);const C=async E=>{if(E&&E.preventDefault(),!!t){i(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0})})).ok)throw new Error("Failed to update item");const V={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:t.id,kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(W){console.error("Error creating price history record:",W)}n(V),je.success("Pozycja została zaktualizowana pomyślnie"),r()}catch(j){console.error("Error updating item:",j),je.error("Błąd podczas aktualizacji pozycji")}finally{i(!1)}}};return!e||!t?null:f.jsx(or,{isOpen:e,onRequestClose:r,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycję"}),f.jsx("button",{onClick:r,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsx("form",{onSubmit:C,className:"space-y-6 flex-grow",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),f.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),f.jsx("input",{type:"text",value:a.sprzedawca,onChange:E=>s(j=>({...j,sprzedawca:E.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),f.jsxs("div",{className:"relative dropdown-container",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{type:"button",onClick:g,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&((k=Of.find(E=>E.value===a.typ))==null?void 0:k.color)||"border-gray-300 bg-white"}`,children:[f.jsx("span",{className:"truncate",children:a.typ&&((F=Of.find(E=>E.value===a.typ))==null?void 0:F.label)||"Wybierz typ"}),f.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:E=>E.stopPropagation(),children:Of.map(E=>f.jsx("button",{type:"button",onClick:()=>y(E.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${E.color}`,children:E.label},E.value))})]})]}),f.jsxs("div",{className:"relative dropdown-container",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objętość"}),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{type:"button",onClick:v,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[f.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),f.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u&&f.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:E=>E.stopPropagation(),children:m5.map(E=>f.jsx("button",{type:"button",onClick:()=>w(E.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:E.label},E.value))})]})]}),f.jsxs("div",{className:"relative",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data ważności"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"text",value:x?x.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz datę",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),f.jsx("button",{type:"button",onClick:b,className:`p-1 focus:outline-none ${x?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:x?`Termin ważności: ${x.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:f.jsx(qp,{size:16})})]}),p&&f.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:f.jsx(ms,{selected:x,onChange:M,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>h(!1)})})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa (€)"}),f.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:E=>s(j=>({...j,cena:E.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),f.jsxs("div",{className:"flex-1",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzedaży (zł)"}),f.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:E=>s(j=>({...j,cena_sprzedazy:E.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),f.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:f.jsx("button",{onClick:C,disabled:o,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${o?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:o?"Zapisywanie...":"Zapisz"})})]})})},g5=`
  .react-tooltip {
    z-index: 9999 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
`,Pf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],v5=({refreshTrigger:e,productReceipts:r=[]})=>{S.useEffect(()=>{const G=document.createElement("style");return G.textContent=g5,document.head.appendChild(G),()=>{document.head.removeChild(G)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",r),console.log("productReceipts length:",r.length);const[t,n]=S.useState([]),[a,s]=S.useState([]),[o,i]=S.useState([]),[l,c]=S.useState(!0),[u,d]=S.useState(null),[p,h]=S.useState(""),[x,m]=S.useState("nazwa"),[y,g]=S.useState("asc"),[w,v]=S.useState(30),[b,M]=S.useState([]),[C,k]=S.useState({}),[F,E]=S.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[j,V]=S.useState(!1),[W,te]=S.useState(null),[ee,J]=S.useState({}),ne=S.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",r);const G=new Map;try{for(const ue of r)if(Array.isArray(ue.products))for(const he of ue.products)he.kod&&!G.has(he.kod)&&G.set(he.kod,ue.sprzedawca)}catch(ue){console.error("Error building sprzedawcaCache:",ue)}return console.log("sprzedawcaCache built with",G.size,"entries"),G},[r]),B=S.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const G=new Map;try{const ue=he=>{let be=null;return r.forEach(Fe=>{if(Array.isArray(Fe.products)&&Fe.products.some(Me=>Me.kod===he)){const Me=new Date(Fe.dataPrzyjecia);(!be||Me<be)&&(be=Me)}}),a.forEach(Fe=>{if(Fe.kod===he&&Fe.created_at){const Me=new Date(Fe.created_at);(!be||Me<be)&&(be=Me)}}),be};for(const he of t){const be=ue(he.kod);if(be){const Me=Math.max(1,Math.ceil((new Date().getTime()-be.getTime())/(1e3*60*60*24))),tt=a.filter(at=>at.kod===he.kod).reduce((at,yt)=>at+yt.ilosc,0);G.set(he.kod,tt/Me)}else G.set(he.kod,0)}}catch(ue){console.error("Error building averageSalesCache:",ue)}return console.log("averageSalesCache built with",G.size,"entries"),G},[t,a,r]),q=async G=>{try{const ue=await fetch("/api/price-history");if(ue.ok){const be=(await ue.json()).filter(Fe=>Fe.kod===G);J(Fe=>({...Fe,[G]:be}))}}catch(ue){console.error("Error loading price history:",ue)}},N=async()=>{try{const G=await fetch("/api/price-history");if(G.ok){const ue=await G.json(),he={};ue.forEach(be=>{he[be.kod]||(he[be.kod]=[]),he[be.kod].push(be)}),J(he)}}catch(G){console.error("Error loading all price history:",G)}},U=async()=>{try{console.log("Starting loadInventory..."),c(!0),d(null),console.log("Fetching working-sheets...");const G=await fetch("/api/working-sheets");if(!G.ok)throw new Error(`HTTP error! status: ${G.status}`);const ue=await G.json();console.log("Inventory data from server:",ue.length,"items"),ue.length>0&&(console.log("First item keys:",Object.keys(ue[0])),console.log("First item typ value:",ue[0].typ),ue[0].data_waznosci&&(console.log("First item data_waznosci:",ue[0].data_waznosci),console.log("First item data_waznosci type:",typeof ue[0].data_waznosci),console.log("First item data_waznosci formatted:",xe(ue[0].data_waznosci)))),n(ue),console.log("Fetching orders...");const he=await fetch("/api/orders");if(!he.ok)throw new Error(`HTTP error! status: ${he.status}`);const be=await he.json();console.log("Orders data from server:",be.length,"items"),i(be),console.log("Fetching orders-with-products...");const Fe=await fetch("/api/orders-with-products");if(!Fe.ok)throw new Error(`HTTP error! status: ${Fe.status}`);const Me=await Fe.json();console.log("Orders with products from server:",Me.length,"items");const tt=[];Me.forEach(at=>{at.products&&at.products.forEach(yt=>{tt.push({...yt,orderId:at.id,created_at:yt.created_at||at.data_utworzenia})})}),console.log("Total order products:",tt.length),s(tt),await N(),console.log("loadInventory completed successfully")}catch(G){console.error("Error loading inventory:",G),d(`Failed to load inventory: ${G instanceof Error?G.message:"Unknown error"}`)}finally{c(!1)}};S.useEffect(()=>{U()},[]),S.useEffect(()=>{e&&U()},[e]);const Z=G=>{x===G?g(y==="asc"?"desc":"asc"):(m(G),g("asc"))},_=G=>{const ue=new Date;ue.setDate(ue.getDate()-w);const he=a.filter(Fe=>Fe.kod===G&&new Date(Fe.created_at)>=ue);return he.length===0?0:he.reduce((Fe,Me)=>Fe+Me.ilosc,0)/w},P=G=>{const ue=Pf.find(he=>he.value===G);return ue?ue.color:"bg-gray-100 text-gray-800 border-gray-200"},A=G=>G===1/0?"bg-gray-100 text-gray-800 border-gray-200":G<=30?"bg-red-100 text-gray-800 border-red-200":G<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",z=S.useMemo(()=>{const G=new Set;return t.forEach(ue=>{const he=ue.sprzedawca||ne.get(ue.kod);he&&G.add(he)}),Array.from(G).sort()},[t,ne]),Q=S.useMemo(()=>{const G=new Set;return t.forEach(ue=>{ue.typ&&G.add(ue.typ)}),Array.from(G).sort()},[t]),re=S.useMemo(()=>{const G=new Set;return t.forEach(ue=>{ue.objetosc&&G.add(ue.objetosc.toString())}),Array.from(G).sort((ue,he)=>parseFloat(ue)-parseFloat(he))},[t]),oe=S.useMemo(()=>{const G=new Set;return t.forEach(ue=>{const he=B.get(ue.kod)||0,be=he<=0?1/0:Math.floor(ue.ilosc/he),Fe=be===1/0?"Brak danych":be<=30?"mało":be<=60?"średnie":"dużo";G.add(Fe)}),Array.from(G).sort()},[t,B]),X=t.filter(G=>{var he;if(!(G.kod.toLowerCase().includes(p.toLowerCase())||G.nazwa.toLowerCase().includes(p.toLowerCase())||G.kod_kreskowy&&G.kod_kreskowy.toLowerCase().includes(p.toLowerCase()))||F.sprzedawca&&(G.sprzedawca||ne.get(G.kod))!==F.sprzedawca||F.typ&&G.typ!==F.typ||F.objetosc&&((he=G.objetosc)==null?void 0:he.toString())!==F.objetosc)return!1;if(F.status){const be=B.get(G.kod)||0,Fe=be<=0?1/0:Math.floor(G.ilosc/be);if((Fe===1/0?"Brak danych":Fe<=30?"mało":Fe<=60?"średnie":"dużo")!==F.status)return!1}return!0}).sort((G,ue)=>{let he,be;switch(x){case"sprzedawca":he=G.sprzedawca||ne.get(G.kod)||"",be=ue.sprzedawca||ne.get(ue.kod)||"";break;case"cena":he=G.cena||0,be=ue.cena||0;break;case"cena_sprzedazy":he=G.cena_sprzedazy||0,be=ue.cena_sprzedazy||0;break;case"srednieZuzycie":he=B.get(G.kod)||0,be=B.get(ue.kod)||0;break;case"dniPozostalo":const Fe=B.get(G.kod)||0,Me=B.get(ue.kod)||0;he=Fe<=0?1/0:Math.floor(G.ilosc/Fe),be=Me<=0?1/0:Math.floor(ue.ilosc/Me);break;case"dataWyczerpania":const tt=B.get(G.kod)||0,at=B.get(ue.kod)||0,yt=tt<=0?1/0:Math.floor(G.ilosc/tt),gt=at<=0?1/0:Math.floor(ue.ilosc/at);he=yt===1/0?1/0:new Date().setDate(new Date().getDate()+yt),be=gt===1/0?1/0:new Date().setDate(new Date().getDate()+gt);break;case"status":const ct=We=>{const Je=B.get(We.kod)||0,pt=Je<=0?1/0:Math.floor(We.ilosc/Je);return pt===1/0?3:pt<=30?0:pt<=60?1:2};he=ct(G),be=ct(ue);break;case"typ":he=G.typ||"",be=ue.typ||"";break;case"objetosc":he=G.objetosc||0,be=ue.objetosc||0;break;case"dataWaznosci":const Pe=We=>{if(!We)return 0;let Je;if(typeof We=="string")Je=new Date(We);else if(typeof We=="number")We<1e12?Je=new Date(We*1e3):Je=new Date(We);else return 0;return isNaN(Je.getTime())?0:Je.getTime()};he=Pe(G.data_waznosci),be=Pe(ue.data_waznosci);break;case"sprzedaze":const qe=a.filter(We=>We.kod===G.kod).length,wt=a.filter(We=>We.kod===ue.kod).length;he=qe,be=wt;break;default:he=G[x],be=ue[x]}return typeof he=="string"&&typeof be=="string"?y==="asc"?he.localeCompare(be):be.localeCompare(he):typeof he=="number"&&typeof be=="number"?y==="asc"?he-be:be-he:0}),Y=G=>{M(G?X.map(ue=>ue.id):[])},K=(G,ue)=>{M(he=>ue?[...he,G]:he.filter(be=>be!==G))},D=G=>{k(ue=>({...ue,[G]:Math.max(0,(ue[G]||0)-1)}))},we=(G,ue)=>{k(he=>({...he,[G]:Math.min(ue,(he[G]||0)+1)}))},pe=()=>{if(b.length!==1){je.error("Wybierz dokładnie jedną pozycję do edycji");return}const G=t.find(ue=>ue.id===b[0]);G&&(te(G),V(!0))},me=G=>{n(ue=>ue.map(he=>he.id===G.id?G:he)),M([])},_e=X.length>0&&X.every(G=>b.includes(G.id)),xe=G=>{if(!G)return"-";let ue;if(typeof G=="string")ue=new Date(G);else if(typeof G=="number")G<1e12?ue=new Date(G*1e3):ue=new Date(G);else return"-";return isNaN(ue.getTime())?"-":ue.toLocaleDateString("pl-PL")},$e=b.length>0?t.filter(G=>b.includes(G.id)):[];return l?f.jsx("div",{className:"flex justify-center items-center py-8",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u?f.jsxs("div",{className:"text-center py-8",children:[f.jsx("p",{className:"text-red-600 font-sora",children:u}),f.jsx("button",{onClick:U,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[f.jsxs("div",{className:"relative w-full max-w-xs",children:[f.jsx(Zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),f.jsx("input",{type:"text",value:p,onChange:G=>h(G.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),f.jsx("button",{onClick:pe,disabled:b.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:f.jsx(w0,{size:16})})]}),f.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[f.jsxs("div",{className:"flex flex-wrap gap-4",children:[f.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[f.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykułów"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:$e.length})]}),f.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[f.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Łączna ilość towaru"}),f.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:$e.length>0?$e.reduce((G,ue)=>G+(ue.ilosc||0),0):0})]}),f.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[f.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru fakturowa"}),f.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[$e.length>0?$e.reduce((G,ue)=>{const he=ee[ue.kod]||[],be=he.reduce((Fe,Me)=>Fe+Me.cena*Me.ilosc,0);if(he.length>0)return G+be;{const Fe=ue.cena||0,Me=ue.ilosc||0;return G+Fe*Me}},0).toFixed(2):"0.00"," €"]})]}),f.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[f.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru w sprzedaży"}),f.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[$e.length>0?$e.reduce((G,ue)=>{const he=ue.cena_sprzedazy||0,be=ue.ilosc||0;return G+he*be},0).toFixed(2):"0.00"," zł"]})]})]}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[f.jsx("div",{className:"relative",children:f.jsxs("select",{value:F.sprzedawca,onChange:G=>E(ue=>({...ue,sprzedawca:G.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[f.jsx("option",{value:"",children:"Sprzedawca"}),z.map(G=>f.jsx("option",{value:G,children:G},G))]})}),f.jsx("div",{className:"relative",children:f.jsxs("select",{value:F.typ,onChange:G=>E(ue=>({...ue,typ:G.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[f.jsx("option",{value:"",children:"Typ"}),Q.map(G=>{var ue;return f.jsx("option",{value:G,children:((ue=Pf.find(he=>he.value===G))==null?void 0:ue.label)||G},G)})]})}),f.jsx("div",{className:"relative",children:f.jsxs("select",{value:F.objetosc,onChange:G=>E(ue=>({...ue,objetosc:G.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[f.jsx("option",{value:"",children:"Objętość"}),re.map(G=>f.jsxs("option",{value:G,children:[G," l"]},G))]})}),f.jsx("div",{className:"relative",children:f.jsxs("select",{value:F.status,onChange:G=>E(ue=>({...ue,status:G.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[f.jsx("option",{value:"",children:"Status"}),oe.map(G=>f.jsx("option",{value:G,children:G},G))]})})]}),(F.sprzedawca||F.typ||F.objetosc||F.status)&&f.jsx("button",{onClick:()=>E({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczyść filtry"})]})]}),f.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:f.jsx("div",{className:"w-full overflow-y-scroll max-h-[500px] relative",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"sticky top-0 z-10",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:f.jsx("input",{type:"checkbox",checked:_e,onChange:G=>Y(G.target.checked)})}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("kod"),children:"Kod"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("nazwa"),children:"Nazwa"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("sprzedawca"),children:"Sprzedawca"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("ilosc"),children:"Ilość"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("typ"),children:"Typ"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("objetosc"),children:"Objętość"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("cena"),children:"Cena fakturowa"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("cena_sprzedazy"),children:"Cena w sprzedaży"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("dataWaznosci"),children:"Data ważności"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("sprzedaze"),children:"Sprzedaże"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("srednieZuzycie"),children:"Średnie zużycie/dzień"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("dniPozostalo"),children:"Dni pozostało"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("dataWyczerpania"),children:"Data wyczerpania zapasów"}),f.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Z("status"),children:"Status"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X.map(G=>{var he;_(G.kod);const ue=B.get(G.kod)||0;return ue<=0||Math.floor(G.ilosc/ue),f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:f.jsx("input",{type:"checkbox",checked:b.includes(G.id),onChange:be=>K(G.id,be.target.checked)})}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",children:f.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:G.kod})}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",children:f.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:G.nazwa})}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:G.sprzedawca||ne.get(G.kod)||""}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:G.ilosc}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:G.typ?f.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${P(G.typ)}`,children:((he=Pf.find(be=>be.value===G.typ))==null?void 0:he.label)||G.typ}):"-"}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:G.objetosc?`${G.objetosc} l`:"-"}),f.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${G.kod}`,onMouseEnter:()=>{ee[G.kod]||q(G.kod)},children:[G.cena?`${G.cena.toFixed(2)} €`:"-",f.jsx(av,{id:`price-tooltip-${G.kod}`,className:"max-w-md",place:"top",children:f.jsxs("div",{className:"font-sora",children:[f.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),f.jsxs("div",{className:"mb-1",children:[f.jsx("span",{className:"font-medium",children:G.cena?`${G.cena.toFixed(2)} €`:"Brak ceny"}),f.jsxs("span",{className:"text-gray-500 ml-2",children:["(",(()=>{if(!ee[G.kod]||ee[G.kod].length===0)return G.ilosc;const be=ee[G.kod].reduce((Me,tt)=>Me+tt.ilosc_fixed,0);return Math.max(0,G.ilosc-be)})()," szt.)"]})]}),ee[G.kod]&&ee[G.kod].length>0?ee[G.kod].map((be,Fe)=>f.jsxs("div",{className:"mb-1",children:[f.jsxs("span",{className:"font-medium",children:[be.cena.toFixed(2)," €"]}),f.jsxs("span",{className:"text-gray-500 ml-2",children:["(",be.ilosc_fixed," szt.)"]})]},Fe)):f.jsx("div",{className:"text-gray-500",children:"Brak historii cen"})]})})]}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:G.cena_sprzedazy?`${G.cena_sprzedazy.toFixed(2)} zł`:"-"}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:xe(G.data_waznosci)}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const be=a.filter(ct=>ct.kod===G.kod);console.log(`Sales for ${G.kod}:`,be.length);const Fe={};be.forEach(ct=>{const Pe=o.find(Je=>Je.id===ct.orderId),qe=Pe?Pe.klient:"",wt=Pe?new Date(Pe.data_utworzenia).toLocaleDateString("pl-PL"):ct.created_at?new Date(ct.created_at).toLocaleDateString("pl-PL"):"",We=wt+"|"+qe;Fe[We]||(Fe[We]={qty:0,klient:qe,date:wt}),Fe[We].qty+=ct.ilosc});const Me=Object.entries(Fe);if(console.log(`Sales array for ${G.kod}:`,Me.length),Me.length===0)return f.jsx("div",{className:"text-gray-400",children:"-"});const tt=C[G.kod]||0,at=Math.max(0,Me.length-5),yt=Me.length>5;if(Me.length===0)return f.jsx("div",{className:"text-gray-400",children:"-"});const gt=Me.slice(tt,tt+5);return f.jsxs("div",{className:"flex items-center gap-1",children:[yt&&tt>0&&f.jsx("button",{onClick:()=>D(G.kod),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:f.jsx(Bb,{size:12})}),f.jsx("div",{className:"flex flex-row gap-1",children:gt.map(([ct,Pe],qe)=>f.jsxs("div",{className:"w-5 h-5 bg-blue-100 border border-blue-300 rounded flex items-center justify-center text-xs font-bold cursor-pointer hover:bg-blue-200 relative","data-tooltip-id":`sales-tooltip-${G.kod}-${tt+qe}`,...Pe.date&&Pe.klient?{"data-tooltip-content":`${Pe.date} | ${Pe.klient}`}:{},children:[Pe.qty,f.jsx(av,{id:`sales-tooltip-${G.kod}-${tt+qe}`,className:"max-w-md",place:"top"})]},ct+qe))}),yt&&tt<at&&f.jsx("button",{onClick:()=>we(G.kod,at),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:f.jsx(Wb,{size:12})})]})})()}),f.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(B.get(G.kod)||0).toFixed(2),"/dzień"]}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const be=B.get(G.kod)||0,Fe=be<=0?1/0:Math.floor(G.ilosc/be);return Fe===1/0?"∞":Fe})()}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const be=B.get(G.kod)||0,Fe=be<=0?1/0:Math.floor(G.ilosc/be);if(Fe===1/0)return"-";const Me=new Date;return Me.setDate(Me.getDate()+Fe),Me.toLocaleDateString("pl-PL")})()}),f.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const be=B.get(G.kod)||0,Fe=be<=0?1/0:Math.floor(G.ilosc/be),Me=Fe===1/0?"Brak danych":Fe<=30?"mało":Fe<=60?"średnie":"dużo";return f.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${A(Fe)}`,children:Me})})()})]},G.id)})})]})})}),f.jsx(x5,{isOpen:j,onClose:()=>{V(!1),te(null)},item:W,onSave:me})]})};gi("pl",vi);const y5=({isOpen:e,onClose:r,onSubmit:t})=>{const[n,a]=S.useState(new Date),[s,o]=S.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[i,l]=S.useState([]),[c,u]=S.useState(new Set),[d,p]=S.useState(!1),[h,x]=S.useState(""),[m,y]=S.useState(""),[g,w]=S.useState(!1),[v,b]=S.useState(null);S.useEffect(()=>{const j=setTimeout(async()=>{if(h.trim().length<2||g){l([]);return}p(!0);try{const V=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(h)}`);if(!V.ok)throw new Error("Failed to fetch orders");const W=await V.json();if(W&&W.length>0){const te=W.map(ee=>({id:ee.id,nazwa:`Zamówienie: ${ee.numer_zamowienia}`,kod:ee.klient,klient:ee.klient,numer_zamowienia:ee.numer_zamowienia,products:ee.products||[]}));l(te)}else l([])}catch(V){console.error("Error searching orders:",V),l([])}finally{p(!1)}},300);return()=>clearTimeout(j)},[h,g]);const M=(E,j)=>{if(E.numer_zamowienia){if(y(E.klient),b(E.id),E.products&&E.products.length>0){const V=E.products.map(W=>({nazwa:W.nazwa,ilosc:W.ilosc,original_ilosc:W.ilosc,powod_zwrotu:""}));o(V)}l([]),x(E.numer_zamowienia),w(!0),je.success("Zamówienie wybrane")}else{const V=[...s];V[j]={...V[j],nazwa:E.nazwa,ilosc:0,original_ilosc:0},o(V)}},C=()=>{const E=new Set;return s.forEach((j,V)=>{const W=j.original_ilosc,te=s[V].ilosc;!j.nazwa.trim()||!te||te<=0||!j.powod_zwrotu?E.add(V):te>W&&(E.add(V),je.error(`Ilość zwrotu (${te}) nie może przekraczać ilości w zamówieniu (${W})`))}),u(E),E.size===0},k=async()=>{if(!C()){je.error("Proszę wypełnić wszystkie wymagane pola");return}try{const E={klient:m,data_zwrotu:n,products:s,orderId:v},j=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});if(!j.ok){const W=await j.json();throw new Error(W.error||"Failed to create return")}const V=await j.json();console.log("Return created:",V),t(E),je.success(`Zwrot został utworzony: ${V.numer_zwrotu}`),r(),x(""),y(""),w(!1),b(null),a(new Date),o([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),u(new Set)}catch(E){console.error("Error creating return:",E),je.error("Błąd podczas tworzenia zwrotu")}},F=()=>{r(),x(""),y(""),w(!1),b(null),a(new Date),o([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),u(new Set)};return f.jsx(or,{isOpen:e,onRequestClose:F,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:f.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[f.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),f.jsx("button",{onClick:F,className:"text-red-500 focus:outline-none",children:f.jsx(vt,{size:20})})]}),f.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"flex flex-wrap gap-4",children:[f.jsxs("div",{className:"w-[200px]",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),f.jsx(ms,{selected:n,onChange:E=>a(E||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),f.jsxs("div",{className:"w-[200px]",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:h,onChange:E=>{x(E.target.value),w(!1),b(null)},placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d&&f.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:f.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),i.length>0&&h.trim().length>=2&&f.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:i.map(E=>f.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>M(E,-1),children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-[10px]",children:E.nazwa}),f.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",E.klient]})]})},E.id))})]})]})]})}),m&&f.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),f.jsx("p",{className:"text-xs text-gray-900",children:m})]})}),f.jsx("button",{onClick:()=>y(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:f.jsx(vt,{size:16})})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),s.map((E,j)=>f.jsx("div",{className:"relative",children:f.jsxs("div",{className:"flex",children:[f.jsx("div",{className:"relative flex-1 max-w-[50%]",children:f.jsx("input",{type:"text",value:E.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),f.jsx("div",{className:"w-20 ml-2",children:f.jsx("input",{type:"number",min:"1",max:E.original_ilosc,value:s[j].ilosc||"",onChange:V=>{const W=[...s],te=V.target.value===""?0:parseInt(V.target.value)||0;W[j]={...W[j],ilosc:te},o(W)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilość"})}),f.jsx("div",{className:"w-40 ml-2",children:f.jsxs("select",{value:s[j].powod_zwrotu,onChange:V=>{const W=[...s];W[j]={...W[j],powod_zwrotu:V.target.value},o(W)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[f.jsx("option",{value:"",children:"Powód zwrotu"}),f.jsx("option",{value:"Błąd w zamówieniu",children:"Błąd w zamówieniu"}),f.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),f.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),s.length>1&&f.jsx("button",{onClick:()=>{const V=s.filter((W,te)=>te!==j);o(V)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:f.jsx(vt,{size:16})})]})},j))]})]}),f.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:f.jsx("button",{onClick:k,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwórz zwrot"})}),f.jsx("div",{className:"absolute bottom-4 right-4",children:f.jsx("button",{onClick:F,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})};or.setAppElement("#root");const Nt="";console.log("API_URL configured as:",Nt);function w5(){const[e,r]=S.useState(!1),[t,n]=S.useState(!1),[a,s]=S.useState(!1),[o,i]=S.useState(!1),[l,c]=S.useState(!1),[u,d]=S.useState(null),[p,h]=S.useState(null),[x,m]=S.useState(null),[y,g]=S.useState(null),[w,v]=S.useState(!0),[b,M]=S.useState(["inventory","clients","orders","inventoryStatus"]),[C,k]=S.useState({sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:"inventory",activeSubTab:"przyjecie",isDbInitialized:!1}),[F,E]=S.useState(!1),[j,V]=S.useState(!1),[W,te]=S.useState(!1),[ee,J]=S.useState(!1),[ne,B]=S.useState(null),[q,N]=S.useState(!1),[U,Z]=S.useState(null),[_,P]=S.useState(!1),[A,z]=S.useState(null),[Q,re]=S.useState(0),[oe,X]=S.useState(0),[Y,K]=S.useState(null),[D,we]=S.useState("");S.useEffect(()=>{(async()=>{try{v(!0),console.log("🚀 Starting data loading process..."),console.log("🔧 API_URL:",Nt),console.log("👥 Loading clients...");const Ee=await wt();console.log("✅ Clients loaded:",Ee.length),console.log("📦 Loading products...");const Se=await We();console.log("✅ Products loaded:",Se.length),console.log("🧾 Loading product receipts...");const Ie=await Je();console.log("✅ Product receipts loaded:",Ie.length),console.log("🔄 Updating app state with loaded data..."),console.log("📋 Setting clients:",Ee),k(Le=>{const ft={...Le,clients:Ee,products:Se,productReceipts:Ie};return console.log("🔄 New app state:",ft),ft}),console.log("✅ App state updated successfully"),console.log("📊 Final data counts:"),console.log("   - Clients:",Ee.length),console.log("   - Products:",Se.length),console.log("   - Product Receipts:",Ie.length)}catch(Ee){console.error("❌ Error loading data:",Ee),je.error("Błąd podczas ładowania danych")}finally{v(!1),console.log("🏁 Data loading process completed")}})()},[]),S.useEffect(()=>{if(!C.isDbInitialized)return;console.log("💾 useEffect triggered - clients changed:",C.clients.length),(async()=>{const Ee={sheets:C.sheets,sheetsData:C.sheetsData,activeSheet:C.activeSheet,showTable:C.showTable,clients:C.clients,products:C.products,productReceipts:C.productReceipts};try{localStorage.setItem("appState",JSON.stringify(Ee)),console.log("App state saved to localStorage")}catch(Se){console.error("Error saving state to localStorage:",Se)}})()},[C.sheetsData,C.sheets,C.activeSheet,C.showTable,C.clients,C.products,C.productReceipts]);const pe=async()=>{try{v(!0),console.log("🔍 Loading sheets from database..."),console.log("📡 Making request to:",`${Nt}/api/original-sheets`);const ae=await fetch(`${Nt}/api/original-sheets`);if(console.log("📡 Sheets response status:",ae.status),!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const Ee=await ae.json();console.log("✅ Received sheets from server:",Ee),console.log("📊 Sheets count:",Ee.length);const Se=Ee.map(Ie=>({fileName:Ie.fileName,data:{headers:Ie.data.headers,rows:Ie.data.rows}}));console.log("🔄 Processed sheets:",Se),console.log("📊 Processed sheets count:",Se.length),k(Ie=>({...Ie,sheets:Se,sheetsData:Se,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log("✅ App state updated with sheets data")}catch(ae){console.error("❌ Ошибка загрузки файлов из базы:",ae),je.error("Ошибка загрузки файлов из базы")}finally{v(!1),console.log("🏁 Loading sheets completed")}};S.useEffect(()=>{pe()},[]);const me=async(ae,Ee)=>{console.log("handleExcelUpload called with:",{newFileName:ae,fileData:Ee});try{const Se=await fetch(`${Nt}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:ae,data:Ee})});if(!Se.ok){if(Se.status===409){je.error("Może być tylko jeden plik Excel. Usuń istniejący plik przed załadowaniem nowego.");return}throw new Error(`HTTP error! status: ${Se.status}`)}await pe(),r(!1)}catch(Se){console.error("Error saving file data:",Se),je.error("Błąd podczas zapisywania danych pliku")}},_e=(ae,Ee)=>{const Se=`${Nt}/api/download_file/${encodeURIComponent(ae.fileName)}`;window.open(Se,"_blank")},xe=ae=>{m(ae)},$e=ae=>{ae.preventDefault()},G=ae=>{!x||x===ae||(M(Ee=>{const Se=[...Ee],Ie=Se.indexOf(x),Le=Se.indexOf(ae);return Se.splice(Ie,1),Se.splice(Le,0,x),Se}),m(null))},ue=ae=>{(ae==="inventory"||ae==="clients"||ae==="orders"||ae==="inventoryStatus")&&k(Ee=>({...Ee,activeTab:ae,activeSubTab:ae==="inventory"?"przyjecie":null}))},he=ae=>{k(Ee=>({...Ee,activeSubTab:ae}))},be=ae=>{switch(ae){case"inventory":return"Zakup towaru";case"clients":return"Klienci";case"orders":return"Zamówienia";case"inventoryStatus":return"Stany magazynowe";default:return ae}},Fe=()=>{p&&(i(!1),r(!1))},Me=async ae=>{try{console.log("🚀 Starting handleAddProduct..."),console.log("📋 Received data:",ae),console.log("📎 Files check:",{hasProductInvoice:!!ae.productInvoice,hasTransportInvoice:!!ae.transportInvoice,productInvoice:ae.productInvoice,transportInvoice:ae.transportInvoice}),console.log("📡 Making request to:",`${Nt}/api/product-receipts`);let Ee;if(ae.productInvoice||ae.transportInvoice){console.log("📎 Files detected, using FormData...");const Le=new FormData,ft={date:ae.date,sprzedawca:ae.sprzedawca,wartosc:ae.wartosc,kosztDostawy:ae.kosztDostawy,products:ae.products};Le.append("data",JSON.stringify(ft)),console.log("📄 JSON data:",ft),ae.productInvoice&&(Le.append("productInvoice",ae.productInvoice),console.log("📎 Product invoice added:",ae.productInvoice.name)),ae.transportInvoice&&(Le.append("transportInvoice",ae.transportInvoice),console.log("📎 Transport invoice added:",ae.transportInvoice.name)),console.log("📦 FormData entries:");for(let[_t,Dt]of Le.entries())console.log(`  ${_t}:`,Dt);Ee=await fetch(`${Nt}/api/product-receipts`,{method:"POST",body:Le})}else{console.log("📄 No files, using JSON...");const Le={date:ae.date,sprzedawca:ae.sprzedawca,wartosc:ae.wartosc,kosztDostawy:ae.kosztDostawy,products:ae.products};console.log("📄 JSON data:",Le),Ee=await fetch(`${Nt}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)})}if(console.log("📡 Response status:",Ee.status),console.log("📡 Response headers:",Ee.headers),!Ee.ok){const Le=await Ee.text();throw console.error("❌ Response error text:",Le),new Error(`Failed to save product receipt: ${Ee.status} - ${Le}`)}const Se=await Ee.json();if(console.log("✅ Saved receipt:",Se),Se.workingSheetsUpdated||Se.workingSheetsInserted){let Le="Dodano nowy towar";Se.workingSheetsUpdated>0&&(Le+=` (${Se.workingSheetsUpdated} товаров обновлено в working sheets)`),Se.workingSheetsInserted>0&&(Le+=` (${Se.workingSheetsInserted} новых товаров добавлено в working sheets)`),je.success(Le)}else je.success("Dodano nowy towar");console.log("🔄 Loading updated receipts...");const Ie=await Je();console.log("✅ Updated receipts:",Ie),console.log("🔄 Updating app state..."),k(Le=>{const ft={...Le,productReceipts:Ie};return console.log("✅ New app state:",ft),ft}),s(!1)}catch(Ee){console.error("❌ Error adding product:",Ee),je.error("Wystąpił błąd podczas dodawania towaru")}},tt=ae=>{Z(ae),N(!0)},at=async ae=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",ae),console.log("📎 Files check (update):",{hasProductInvoice:!!ae.productInvoice,hasTransportInvoice:!!ae.transportInvoice,productInvoice:ae.productInvoice,transportInvoice:ae.transportInvoice});try{let Ee;if(ae.productInvoice||ae.transportInvoice){console.log("📎 Files detected (update), using FormData...");const ft=new FormData,_t={date:ae.date,sprzedawca:ae.sprzedawca,wartosc:ae.wartosc,kosztDostawy:ae.kosztDostawy,products:ae.products};ft.append("data",JSON.stringify(_t)),console.log("📄 JSON data (update):",_t),ae.productInvoice&&(ft.append("productInvoice",ae.productInvoice),console.log("📎 Product invoice added (update):",ae.productInvoice.name)),ae.transportInvoice&&(ft.append("transportInvoice",ae.transportInvoice),console.log("📎 Transport invoice added (update):",ae.transportInvoice.name)),console.log("📦 FormData entries (update):");for(let[Dt,mr]of ft.entries())console.log(`  ${Dt}:`,mr);Ee=await fetch(`${Nt}/api/product-receipts/${ae.id}`,{method:"PUT",body:ft})}else console.log("📄 No files (update), using JSON..."),Ee=await fetch(`${Nt}/api/product-receipts/${ae.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:ae.date,sprzedawca:ae.sprzedawca,wartosc:ae.wartosc,kosztDostawy:ae.kosztDostawy,products:ae.products})});if(!Ee.ok)throw new Error("Failed to update product receipt");const Se=await Ee.json();console.log("Updated receipt:",Se),console.log("Loading updated receipts...");const Ie=await Je();console.log("Updated receipts:",Ie),console.log("Loading updated products...");const Le=await We();console.log("Updated products:",Le),console.log("Updating app state..."),k(ft=>{const _t={...ft,productReceipts:Ie,products:Le};return console.log("New app state:",_t),_t}),je.success("Zakup został zaktualizowany"),N(!1),Z(null),c(!1),d(null)}catch(Ee){console.error("Error updating product receipt:",Ee),je.error("Wystąpił błąd podczas aktualizacji zakupu")}},yt=async ae=>{try{if(!(await fetch(`${Nt}/api/product-receipts/${ae}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const Se=await Je(),Ie=await We();k(Le=>({...Le,productReceipts:Se,products:Ie})),je.success("Zakup został usunięty")}catch(Ee){console.error("Error deleting receipt:",Ee),je.error("Wystąpił błąd podczas usuwania zakupu")}},gt=async ae=>{try{const Ee=await fetch(`${Nt}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!Ee.ok)throw new Error("Failed to add client");const Se=await Ee.json(),Ie={...ae,id:Se.id};k(Le=>({...Le,clients:[...Le.clients,Ie]})),X(Le=>Le+1),je.success("Klient został dodany")}catch(Ee){console.error("Error adding client:",Ee),je.error("Błąd podczas dodawania klienta")}},ct=async ae=>{try{if(!(await fetch(`${Nt}/api/clients/${ae}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");k(Se=>({...Se,clients:Se.clients.filter(Ie=>Ie.id!==ae)})),X(Se=>Se+1),je.success("Klient został usunięty")}catch(Ee){console.error("Error deleting client:",Ee),je.error("Błąd podczas usuwania klienta")}},Pe=async ae=>{try{console.log("🔍 handleUpdateClient called with data:",ae);const Ee=await fetch(`${Nt}/api/clients/${ae.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!Ee.ok)throw new Error("Failed to update client");const Se=await Ee.json();console.log("✅ Client updated in database:",Se),console.log("✅ Updated client fields:",{id:Se.id,firma:Se.firma,nazwa:Se.nazwa,adres:Se.adres,czas_dostawy:Se.czas_dostawy,kontakt:Se.kontakt}),k(Ie=>{console.log("🔄 Updating app state..."),console.log("📋 Previous clients:",Ie.clients),console.log("📋 Updated client data:",Se);const Le=Ie.clients.map(_t=>_t.id===ae.id?(console.log("🔄 Updating client:",_t.id,"from:",_t,"to:",{..._t,...Se}),{id:_t.id,firma:Se.firma||_t.firma,nazwa:Se.nazwa||_t.nazwa,adres:Se.adres||_t.adres,czas_dostawy:Se.czas_dostawy||_t.czas_dostawy,kontakt:Se.kontakt||_t.kontakt}):{..._t});console.log("📋 New clients array:",Le);const ft={...Ie,clients:Le};return console.log("🔄 New app state:",ft),ft}),je.success("Klient został zaktualizowany"),setTimeout(()=>{k(Ie=>(console.log("🔄 Force update after timeout"),{...Ie})),X(Ie=>Ie+1),K(ae.id),wt().then(Ie=>{k(Le=>({...Le,clients:Ie})),X(Le=>Le+1)})},100)}catch(Ee){console.error("Error updating client:",Ee),je.error("Błąd podczas aktualizacji klienta")}},qe=async ae=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",ae),console.log("Products data:",JSON.stringify(ae.products,null,2));try{const Ee=await fetch(`${Nt}/api/orders/${ae.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!Ee.ok)throw new Error("Failed to update order");const Se=await Ee.json();console.log("Updated order result:",Se),je.success("Zamówienie zostało zaktualizowane"),re(Ie=>Ie+1)}catch(Ee){console.error("Error updating order:",Ee),je.error("Błąd podczas aktualizacji zamówienia")}},wt=async()=>{try{console.log("🔍 Loading clients from:",`${Nt}/api/clients`);const ae=await fetch(`${Nt}/api/clients`);if(console.log("📡 Clients response status:",ae.status),!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const Ee=await ae.json();return console.log("✅ Loaded clients:",Ee.length,"records"),console.log("📋 First client:",Ee[0]),Ee}catch(ae){return console.error("❌ Error loading clients:",ae),[]}},We=async()=>{try{console.log("🔍 Loading products from:",`${Nt}/api/products`);const ae=await fetch(`${Nt}/api/products`);if(console.log("📡 Products response status:",ae.status),!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const Ee=await ae.json();console.log("✅ Loaded products:",Ee.length,"records"),console.log("📋 First product:",Ee[0]);const Se=Ee.map(Ie=>({kod:Ie.kod,nazwa:Ie.nazwa,ilosc:Ie.ilosc,jednostka_miary:Ie.jednostka_miary||"",kod_kreskowy:Ie.kod_kreskowy||"",data_waznosci:Ie.data_waznosci??void 0,archiwalny:Ie.archiwalny,rezerwacje:Ie.rezerwacje,ilosc_na_poleceniach:Ie.ilosc_na_poleceniach,waga_netto:Ie.waga_netto,waga_brutto:Ie.waga_brutto,objetosc:Ie.objetosc,opis:Ie.opis}));return console.log("🔄 Processed products:",Se.length,"records"),Se}catch(ae){return console.error("❌ Error loading products:",ae),[]}},Je=async()=>{try{console.log("🔍 Loading product receipts from:",`${Nt}/api/product-receipts`);const ae=await fetch(`${Nt}/api/product-receipts`);if(console.log("📡 Product receipts response status:",ae.status),!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const Ee=await ae.json();return console.log("✅ Loaded product receipts:",Ee.length,"records"),Ee.map(Se=>({id:Se.id,dataPrzyjecia:Se.dataPrzyjecia,sprzedawca:Se.sprzedawca||"",wartosc:Se.wartosc||0,kosztDostawy:Se.kosztDostawy||0,products:Se.products||[],productInvoice:Se.productInvoice,transportInvoice:Se.transportInvoice}))}catch(ae){return console.error("❌ Error loading product receipts:",ae),[]}},pt=async ae=>{try{console.log("🔍 Searching working_sheets with query:",ae),console.log("📡 Making request to:",`${Nt}/api/working-sheets/search?query=${encodeURIComponent(ae)}`);const Ee=await fetch(`${Nt}/api/working-sheets/search?query=${encodeURIComponent(ae)}`);if(console.log("📡 Search response status:",Ee.status),!Ee.ok)throw new Error(`HTTP error! status: ${Ee.status}`);const Se=await Ee.json();return console.log("✅ Search results:",Se.length,"items found"),Se.map(Le=>({kod:Le.kod,nazwa:Le.nazwa,ilosc:Le.ilosc.toString(),kodKreskowy:Le.kod_kreskowy||""}))}catch(Ee){return console.error("❌ Error searching working_sheets:",Ee),[]}},Ia=()=>{re(ae=>ae+1)},fa=()=>{re(ae=>ae+1)};return f.jsxs("div",{className:"min-h-screen bg-gray-100",children:[f.jsx(XI,{position:"top-right"}),f.jsx(r2,{isOpen:ee,onClose:()=>J(!1),product:ne}),f.jsx(tO,{isOpen:e,onClose:()=>r(!1),onUpload:me}),f.jsx(rO,{isOpen:o,onClose:()=>i(!1),fileName:p||"",onConfirm:Fe}),f.jsx(nI,{isOpen:a,onClose:()=>s(!1),onSubmit:Me}),f.jsx(t5,{isOpen:t,onClose:()=>n(!1),onAdd:gt}),f.jsx(s2,{isOpen:_,onClose:()=>{P(!1),z(null)},onSubmit:Pe,client:A}),f.jsx(n2,{isOpen:l,onClose:()=>c(!1),receipt:u}),f.jsx(a2,{isOpen:q,onClose:()=>{N(!1),Z(null)},onSubmit:at,receipt:U}),f.jsx(QI,{isOpen:F,onClose:()=>E(!1),onOrderCreated:Ia}),f.jsx(y5,{isOpen:j,onClose:()=>V(!1),onSubmit:fa}),f.jsx("div",{className:"bg-white shadow-sm",children:f.jsx("div",{className:"container mx-auto px-4 py-3",children:f.jsx("img",{src:e5,alt:"Enoterra Logo",className:"h-32"})})}),f.jsx("div",{className:"bg-gray-100",children:f.jsx("div",{className:"container mx-auto px-4",children:f.jsx("div",{className:"flex items-center h-14",children:f.jsx("div",{className:"flex space-x-4",children:b.map(ae=>f.jsx("div",{draggable:!0,onDragStart:()=>xe(ae),onDragOver:$e,onDrop:()=>G(ae),className:`relative -mb-px cursor-pointer ${C.activeTab===ae?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${x===ae?"opacity-50":""}`,onClick:()=>ue(ae),children:f.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:be(ae)})},ae))})})})}),f.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:f.jsxs("div",{className:"container mx-auto px-4 py-6",children:[f.jsxs("div",{className:"flex items-start -mt-2",children:[C.activeTab==="inventory"&&f.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[f.jsxs("div",{className:"flex",children:[f.jsx("button",{onClick:()=>he("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjęcie towaru"}),f.jsx("button",{onClick:()=>he("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupów"}),f.jsx("button",{onClick:()=>he("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${C.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz płatności"})]}),C.activeSubTab==="przyjecie"&&f.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>s(!0),children:[f.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:f.jsx(Rs,{size:16})}),f.jsx("div",{className:"px-2",children:f.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),f.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[f.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:f.jsx(Ub,{size:16})}),f.jsx("div",{className:"px-2",children:f.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),f.jsx(r5,{receipts:C.productReceipts,products:C.products,onDelete:yt,onEdit:tt,onUpdate:at})]}),C.activeSubTab==="analiza"&&f.jsx("div",{className:"flex flex-col gap-4",children:f.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[f.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupów"}),f.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupów będzie dostępna wkrótce."})]})}),C.activeSubTab==="kalendarz"&&f.jsx("div",{className:"flex flex-col gap-4 mt-6",children:f.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[f.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz płatności"}),f.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza płatności będzie dostępna wkrótce."})]})})]}),C.activeTab==="inventory"&&f.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:C.sheets.map(ae=>f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("button",{onClick:Ee=>_e(ae),title:"Клик: открыть файл в новой вкладке",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:ae.fileName})},ae.fileName))}),C.activeTab==="inventory"&&C.showTable&&C.activeSheet&&f.jsx("div",{className:"mt-6 bg-white",children:f.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:f.jsx(aI,{data:C.activeSheet.data})})}),C.activeTab==="clients"&&f.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[f.jsx("div",{className:"flex items-center gap-4",children:f.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>n(!0),children:[f.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:f.jsx(Rs,{size:16})}),f.jsx("div",{className:"px-2",children:f.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),f.jsx(a5,{clients:C.clients,onDelete:ct,onEdit:ae=>{z(ae),P(!0)},onUpdate:Pe},`clients-${oe}-${Y||"none"}`)]}),C.activeTab==="orders"&&f.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[f.jsx("div",{className:"mb-4",children:f.jsx("div",{className:"w-1/2 mx-auto",children:f.jsx(sI,{onSearch:pt})})}),f.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[f.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>E(!0),children:[f.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:f.jsx(Rs,{size:16})}),f.jsx("div",{className:"px-2",children:f.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),f.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>V(!0),children:[f.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:f.jsx(vt,{size:16})}),f.jsx("div",{className:"px-2",children:f.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]})]}),f.jsx(JI,{onViewOrder:ae=>{console.log("View order:",ae)},onEditOrder:ae=>{console.log("Edit order:",ae)},onDeleteOrder:ae=>{console.log("Delete order:",ae)},onUpdateOrder:qe,refreshTrigger:Q})]}),C.activeTab==="inventoryStatus"&&f.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:f.jsx(v5,{productReceipts:C.productReceipts})})]}),y&&f.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:y})]})})]})}vy(document.getElementById("root")).render(f.jsx(S.StrictMode,{children:f.jsx(w5,{})}));
