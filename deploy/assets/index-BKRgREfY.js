function ib(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Qu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function lb(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var U0={exports:{}},el={},$0={exports:{}},Dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hm;function cb(){if(hm)return Dt;hm=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function g(I){return I===null||typeof I!="object"?null:(I=m&&I[m]||I["@@iterator"],typeof I=="function"?I:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function k(I,P,ce){this.props=I,this.context=P,this.refs=b,this.updater=ce||v}k.prototype.isReactComponent={},k.prototype.setState=function(I,P){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,P,"setState")},k.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function C(){}C.prototype=k.prototype;function D(I,P,ce){this.props=I,this.context=P,this.refs=b,this.updater=ce||v}var E=D.prototype=new C;E.constructor=D,w(E,k.prototype),E.isPureReactComponent=!0;var Y=Array.isArray,ee=Object.prototype.hasOwnProperty,G={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function H(I,P,ce){var A,T={},j=null,N=null;if(P!=null)for(A in P.ref!==void 0&&(N=P.ref),P.key!==void 0&&(j=""+P.key),P)ee.call(P,A)&&!F.hasOwnProperty(A)&&(T[A]=P[A]);var W=arguments.length-2;if(W===1)T.children=ce;else if(1<W){for(var z=Array(W),O=0;O<W;O++)z[O]=arguments[O+2];T.children=z}if(I&&I.defaultProps)for(A in W=I.defaultProps,W)T[A]===void 0&&(T[A]=W[A]);return{$$typeof:e,type:I,key:j,ref:N,props:T,_owner:G.current}}function U(I,P){return{$$typeof:e,type:I.type,key:P,ref:I.ref,props:I.props,_owner:I._owner}}function ae(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function J(I){var P={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(ce){return P[ce]})}var V=/\/+/g;function de(I,P){return typeof I=="object"&&I!==null&&I.key!=null?J(""+I.key):P.toString(36)}function ue(I,P,ce,A,T){var j=typeof I;(j==="undefined"||j==="boolean")&&(I=null);var N=!1;if(I===null)N=!0;else switch(j){case"string":case"number":N=!0;break;case"object":switch(I.$$typeof){case e:case n:N=!0}}if(N)return N=I,T=T(N),I=A===""?"."+de(N,0):A,Y(T)?(ce="",I!=null&&(ce=I.replace(V,"$&/")+"/"),ue(T,P,ce,"",function(O){return O})):T!=null&&(ae(T)&&(T=U(T,ce+(!T.key||N&&N.key===T.key?"":(""+T.key).replace(V,"$&/")+"/")+I)),P.push(T)),1;if(N=0,A=A===""?".":A+":",Y(I))for(var W=0;W<I.length;W++){j=I[W];var z=A+de(j,W);N+=ue(j,P,ce,z,T)}else if(z=g(I),typeof z=="function")for(I=z.call(I),W=0;!(j=I.next()).done;)j=j.value,z=A+de(j,W++),N+=ue(j,P,ce,z,T);else if(j==="object")throw P=String(I),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.");return N}function le(I,P,ce){if(I==null)return I;var A=[],T=0;return ue(I,A,"","",function(j){return P.call(ce,j,T++)}),A}function pe(I){if(I._status===-1){var P=I._result;P=P(),P.then(function(ce){(I._status===0||I._status===-1)&&(I._status=1,I._result=ce)},function(ce){(I._status===0||I._status===-1)&&(I._status=2,I._result=ce)}),I._status===-1&&(I._status=0,I._result=P)}if(I._status===1)return I._result.default;throw I._result}var q={current:null},oe={transition:null},B={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:oe,ReactCurrentOwner:G};function re(){throw Error("act(...) is not supported in production builds of React.")}return Dt.Children={map:le,forEach:function(I,P,ce){le(I,function(){P.apply(this,arguments)},ce)},count:function(I){var P=0;return le(I,function(){P++}),P},toArray:function(I){return le(I,function(P){return P})||[]},only:function(I){if(!ae(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},Dt.Component=k,Dt.Fragment=t,Dt.Profiler=a,Dt.PureComponent=D,Dt.StrictMode=r,Dt.Suspense=f,Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,Dt.act=re,Dt.cloneElement=function(I,P,ce){if(I==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+I+".");var A=w({},I.props),T=I.key,j=I.ref,N=I._owner;if(P!=null){if(P.ref!==void 0&&(j=P.ref,N=G.current),P.key!==void 0&&(T=""+P.key),I.type&&I.type.defaultProps)var W=I.type.defaultProps;for(z in P)ee.call(P,z)&&!F.hasOwnProperty(z)&&(A[z]=P[z]===void 0&&W!==void 0?W[z]:P[z])}var z=arguments.length-2;if(z===1)A.children=ce;else if(1<z){W=Array(z);for(var O=0;O<z;O++)W[O]=arguments[O+2];A.children=W}return{$$typeof:e,type:I.type,key:T,ref:j,props:A,_owner:N}},Dt.createContext=function(I){return I={$$typeof:l,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},I.Provider={$$typeof:o,_context:I},I.Consumer=I},Dt.createElement=H,Dt.createFactory=function(I){var P=H.bind(null,I);return P.type=I,P},Dt.createRef=function(){return{current:null}},Dt.forwardRef=function(I){return{$$typeof:c,render:I}},Dt.isValidElement=ae,Dt.lazy=function(I){return{$$typeof:p,_payload:{_status:-1,_result:I},_init:pe}},Dt.memo=function(I,P){return{$$typeof:h,type:I,compare:P===void 0?null:P}},Dt.startTransition=function(I){var P=oe.transition;oe.transition={};try{I()}finally{oe.transition=P}},Dt.unstable_act=re,Dt.useCallback=function(I,P){return q.current.useCallback(I,P)},Dt.useContext=function(I){return q.current.useContext(I)},Dt.useDebugValue=function(){},Dt.useDeferredValue=function(I){return q.current.useDeferredValue(I)},Dt.useEffect=function(I,P){return q.current.useEffect(I,P)},Dt.useId=function(){return q.current.useId()},Dt.useImperativeHandle=function(I,P,ce){return q.current.useImperativeHandle(I,P,ce)},Dt.useInsertionEffect=function(I,P){return q.current.useInsertionEffect(I,P)},Dt.useLayoutEffect=function(I,P){return q.current.useLayoutEffect(I,P)},Dt.useMemo=function(I,P){return q.current.useMemo(I,P)},Dt.useReducer=function(I,P,ce){return q.current.useReducer(I,P,ce)},Dt.useRef=function(I){return q.current.useRef(I)},Dt.useState=function(I){return q.current.useState(I)},Dt.useSyncExternalStore=function(I,P,ce){return q.current.useSyncExternalStore(I,P,ce)},Dt.useTransition=function(){return q.current.useTransition()},Dt.version="18.3.1",Dt}var xm;function jl(){return xm||(xm=1,$0.exports=cb()),$0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm;function ub(){if(mm)return el;mm=1;var e=jl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,h){var p,m={},g=null,v=null;h!==void 0&&(g=""+h),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(v=f.ref);for(p in f)r.call(f,p)&&!o.hasOwnProperty(p)&&(m[p]=f[p]);if(c&&c.defaultProps)for(p in f=c.defaultProps,f)m[p]===void 0&&(m[p]=f[p]);return{$$typeof:n,type:c,key:g,ref:v,props:m,_owner:a.current}}return el.Fragment=t,el.jsx=l,el.jsxs=l,el}var gm;function db(){return gm||(gm=1,U0.exports=ub()),U0.exports}var u=db(),S=jl();const De=Qu(S),Iv=ib({__proto__:null,default:De},[S]);var Gc={},H0={exports:{}},yn={},Y0={exports:{}},V0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vm;function fb(){return vm||(vm=1,(function(e){function n(oe,B){var re=oe.length;oe.push(B);e:for(;0<re;){var I=re-1>>>1,P=oe[I];if(0<a(P,B))oe[I]=B,oe[re]=P,re=I;else break e}}function t(oe){return oe.length===0?null:oe[0]}function r(oe){if(oe.length===0)return null;var B=oe[0],re=oe.pop();if(re!==B){oe[0]=re;e:for(var I=0,P=oe.length,ce=P>>>1;I<ce;){var A=2*(I+1)-1,T=oe[A],j=A+1,N=oe[j];if(0>a(T,re))j<P&&0>a(N,T)?(oe[I]=N,oe[j]=re,I=j):(oe[I]=T,oe[A]=re,I=A);else if(j<P&&0>a(N,re))oe[I]=N,oe[j]=re,I=j;else break e}}return B}function a(oe,B){var re=oe.sortIndex-B.sortIndex;return re!==0?re:oe.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],h=[],p=1,m=null,g=3,v=!1,w=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(oe){for(var B=t(h);B!==null;){if(B.callback===null)r(h);else if(B.startTime<=oe)r(h),B.sortIndex=B.expirationTime,n(f,B);else break;B=t(h)}}function Y(oe){if(b=!1,E(oe),!w)if(t(f)!==null)w=!0,pe(ee);else{var B=t(h);B!==null&&q(Y,B.startTime-oe)}}function ee(oe,B){w=!1,b&&(b=!1,C(H),H=-1),v=!0;var re=g;try{for(E(B),m=t(f);m!==null&&(!(m.expirationTime>B)||oe&&!J());){var I=m.callback;if(typeof I=="function"){m.callback=null,g=m.priorityLevel;var P=I(m.expirationTime<=B);B=e.unstable_now(),typeof P=="function"?m.callback=P:m===t(f)&&r(f),E(B)}else r(f);m=t(f)}if(m!==null)var ce=!0;else{var A=t(h);A!==null&&q(Y,A.startTime-B),ce=!1}return ce}finally{m=null,g=re,v=!1}}var G=!1,F=null,H=-1,U=5,ae=-1;function J(){return!(e.unstable_now()-ae<U)}function V(){if(F!==null){var oe=e.unstable_now();ae=oe;var B=!0;try{B=F(!0,oe)}finally{B?de():(G=!1,F=null)}}else G=!1}var de;if(typeof D=="function")de=function(){D(V)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,le=ue.port2;ue.port1.onmessage=V,de=function(){le.postMessage(null)}}else de=function(){k(V,0)};function pe(oe){F=oe,G||(G=!0,de())}function q(oe,B){H=k(function(){oe(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){w||v||(w=!0,pe(ee))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(oe){switch(g){case 1:case 2:case 3:var B=3;break;default:B=g}var re=g;g=B;try{return oe()}finally{g=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,B){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var re=g;g=oe;try{return B()}finally{g=re}},e.unstable_scheduleCallback=function(oe,B,re){var I=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?I+re:I):re=I,oe){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=re+P,oe={id:p++,callback:B,priorityLevel:oe,startTime:re,expirationTime:P,sortIndex:-1},re>I?(oe.sortIndex=re,n(h,oe),t(f)===null&&oe===t(h)&&(b?(C(H),H=-1):b=!0,q(Y,re-I))):(oe.sortIndex=P,n(f,oe),w||v||(w=!0,pe(ee))),oe},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(oe){var B=g;return function(){var re=g;g=B;try{return oe.apply(this,arguments)}finally{g=re}}}})(V0)),V0}var ym;function pb(){return ym||(ym=1,Y0.exports=fb()),Y0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wm;function hb(){if(wm)return yn;wm=1;var e=jl(),n=pb();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,d=1;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function g(s){return f.call(m,s)?!0:f.call(p,s)?!1:h.test(s)?m[s]=!0:(p[s]=!0,!1)}function v(s,i,d,x){if(d!==null&&d.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return x?!1:d!==null?!d.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function w(s,i,d,x){if(i===null||typeof i>"u"||v(s,i,d,x))return!0;if(x)return!1;if(d!==null)switch(d.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function b(s,i,d,x,y,_,M){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=x,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=s,this.type=i,this.sanitizeURL=_,this.removeEmptyString=M}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){k[s]=new b(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];k[i]=new b(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){k[s]=new b(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){k[s]=new b(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){k[s]=new b(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){k[s]=new b(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){k[s]=new b(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){k[s]=new b(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){k[s]=new b(s,5,!1,s.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function D(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(C,D);k[i]=new b(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(C,D);k[i]=new b(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(C,D);k[i]=new b(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){k[s]=new b(s,1,!1,s.toLowerCase(),null,!1,!1)}),k.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){k[s]=new b(s,1,!1,s.toLowerCase(),null,!0,!0)});function E(s,i,d,x){var y=k.hasOwnProperty(i)?k[i]:null;(y!==null?y.type!==0:x||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(w(i,d,y,x)&&(d=null),x||y===null?g(i)&&(d===null?s.removeAttribute(i):s.setAttribute(i,""+d)):y.mustUseProperty?s[y.propertyName]=d===null?y.type===3?!1:"":d:(i=y.attributeName,x=y.attributeNamespace,d===null?s.removeAttribute(i):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,x?s.setAttributeNS(x,i,d):s.setAttribute(i,d))))}var Y=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ee=Symbol.for("react.element"),G=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),ae=Symbol.for("react.provider"),J=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),de=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),le=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),oe=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=oe&&s[oe]||s["@@iterator"],typeof s=="function"?s:null)}var re=Object.assign,I;function P(s){if(I===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);I=i&&i[1]||""}return`
`+I+s}var ce=!1;function A(s,i){if(!s||ce)return"";ce=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Ce){var x=Ce}Reflect.construct(s,[],i)}else{try{i.call()}catch(Ce){x=Ce}s.call(i.prototype)}else{try{throw Error()}catch(Ce){x=Ce}s()}}catch(Ce){if(Ce&&x&&typeof Ce.stack=="string"){for(var y=Ce.stack.split(`
`),_=x.stack.split(`
`),M=y.length-1,ie=_.length-1;1<=M&&0<=ie&&y[M]!==_[ie];)ie--;for(;1<=M&&0<=ie;M--,ie--)if(y[M]!==_[ie]){if(M!==1||ie!==1)do if(M--,ie--,0>ie||y[M]!==_[ie]){var xe=`
`+y[M].replace(" at new "," at ");return s.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",s.displayName)),xe}while(1<=M&&0<=ie);break}}}finally{ce=!1,Error.prepareStackTrace=d}return(s=s?s.displayName||s.name:"")?P(s):""}function T(s){switch(s.tag){case 5:return P(s.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return s=A(s.type,!1),s;case 11:return s=A(s.type.render,!1),s;case 1:return s=A(s.type,!0),s;default:return""}}function j(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case F:return"Fragment";case G:return"Portal";case U:return"Profiler";case H:return"StrictMode";case de:return"Suspense";case ue:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case J:return(s.displayName||"Context")+".Consumer";case ae:return(s._context.displayName||"Context")+".Provider";case V:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case le:return i=s.displayName||null,i!==null?i:j(s.type)||"Memo";case pe:i=s._payload,s=s._init;try{return j(s(i))}catch{}}return null}function N(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(i);case 8:return i===H?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function W(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function z(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function O(s){var i=z(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),x=""+s[i];if(!s.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,_=d.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return y.call(this)},set:function(M){x=""+M,_.call(this,M)}}),Object.defineProperty(s,i,{enumerable:d.enumerable}),{getValue:function(){return x},setValue:function(M){x=""+M},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function se(s){s._valueTracker||(s._valueTracker=O(s))}function L(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var d=i.getValue(),x="";return s&&(x=z(s)?s.checked?"true":"false":s.value),s=x,s!==d?(i.setValue(s),!0):!1}function Oe(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function je(s,i){var d=i.checked;return re({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??s._wrapperState.initialChecked})}function Ke(s,i){var d=i.defaultValue==null?"":i.defaultValue,x=i.checked!=null?i.checked:i.defaultChecked;d=W(i.value!=null?i.value:d),s._wrapperState={initialChecked:x,initialValue:d,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Qe(s,i){i=i.checked,i!=null&&E(s,"checked",i,!1)}function he(s,i){Qe(s,i);var d=W(i.value),x=i.type;if(d!=null)x==="number"?(d===0&&s.value===""||s.value!=d)&&(s.value=""+d):s.value!==""+d&&(s.value=""+d);else if(x==="submit"||x==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?Pe(s,i.type,d):i.hasOwnProperty("defaultValue")&&Pe(s,i.type,W(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Ne(s,i,d){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var x=i.type;if(!(x!=="submit"&&x!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,d||i===s.value||(s.value=i),s.defaultValue=i}d=s.name,d!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,d!==""&&(s.name=d)}function Pe(s,i,d){(i!=="number"||Oe(s.ownerDocument)!==s)&&(d==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+d&&(s.defaultValue=""+d))}var _e=Array.isArray;function Je(s,i,d,x){if(s=s.options,i){i={};for(var y=0;y<d.length;y++)i["$"+d[y]]=!0;for(d=0;d<s.length;d++)y=i.hasOwnProperty("$"+s[d].value),s[d].selected!==y&&(s[d].selected=y),y&&x&&(s[d].defaultSelected=!0)}else{for(d=""+W(d),i=null,y=0;y<s.length;y++){if(s[y].value===d){s[y].selected=!0,x&&(s[y].defaultSelected=!0);return}i!==null||s[y].disabled||(i=s[y])}i!==null&&(i.selected=!0)}}function ft(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return re({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function ut(s,i){var d=i.value;if(d==null){if(d=i.children,i=i.defaultValue,d!=null){if(i!=null)throw Error(t(92));if(_e(d)){if(1<d.length)throw Error(t(93));d=d[0]}i=d}i==null&&(i=""),d=i}s._wrapperState={initialValue:W(d)}}function ht(s,i){var d=W(i.value),x=W(i.defaultValue);d!=null&&(d=""+d,d!==s.value&&(s.value=d),i.defaultValue==null&&s.defaultValue!==d&&(s.defaultValue=d)),x!=null&&(s.defaultValue=""+x)}function Ot(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Yt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jt(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Yt(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Lt,Xt=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,d,x,y){MSApp.execUnsafeLocalFunction(function(){return s(i,d,x,y)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Lt=Lt||document.createElement("div"),Lt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Lt.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function dt(s,i){if(i){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=i;return}}s.textContent=i}var Et={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qt=["Webkit","ms","Moz","O"];Object.keys(Et).forEach(function(s){qt.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),Et[i]=Et[s]})});function Tt(s,i,d){return i==null||typeof i=="boolean"||i===""?"":d||typeof i!="number"||i===0||Et.hasOwnProperty(s)&&Et[s]?(""+i).trim():i+"px"}function Zt(s,i){s=s.style;for(var d in i)if(i.hasOwnProperty(d)){var x=d.indexOf("--")===0,y=Tt(d,i[d],x);d==="float"&&(d="cssFloat"),x?s.setProperty(d,y):s[d]=y}}var Ft=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(s,i){if(i){if(Ft[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function qe(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vt=null;function bt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var fe=null,Re=null,ze=null;function X(s){if(s=Li(s)){if(typeof fe!="function")throw Error(t(280));var i=s.stateNode;i&&(i=cc(i),fe(s.stateNode,s.type,i))}}function me(s){Re?ze?ze.push(s):ze=[s]:Re=s}function Te(){if(Re){var s=Re,i=ze;if(ze=Re=null,X(s),i)for(s=0;s<i.length;s++)X(i[s])}}function Ae(s,i){return s(i)}function Be(){}var et=!1;function pt(s,i,d){if(et)return s(i,d);et=!0;try{return Ae(s,i,d)}finally{et=!1,(Re!==null||ze!==null)&&(Be(),Te())}}function Wt(s,i){var d=s.stateNode;if(d===null)return null;var x=cc(d);if(x===null)return null;d=x[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(t(231,i,typeof d));return d}var Ge=!1;if(c)try{var tt={};Object.defineProperty(tt,"passive",{get:function(){Ge=!0}}),window.addEventListener("test",tt,tt),window.removeEventListener("test",tt,tt)}catch{Ge=!1}function Me(s,i,d,x,y,_,M,ie,xe){var Ce=Array.prototype.slice.call(arguments,3);try{i.apply(d,Ce)}catch(Le){this.onError(Le)}}var rt=!1,kt=null,R=!1,te=null,K={onError:function(s){rt=!0,kt=s}};function Q(s,i,d,x,y,_,M,ie,xe){rt=!1,kt=null,Me.apply(K,arguments)}function Z(s,i,d,x,y,_,M,ie,xe){if(Q.apply(this,arguments),rt){if(rt){var Ce=kt;rt=!1,kt=null}else throw Error(t(198));R||(R=!0,te=Ce)}}function ne(s){var i=s,d=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(d=i.return),s=i.return;while(s)}return i.tag===3?d:null}function ke(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Fe(s){if(ne(s)!==s)throw Error(t(188))}function we(s){var i=s.alternate;if(!i){if(i=ne(s),i===null)throw Error(t(188));return i!==s?null:s}for(var d=s,x=i;;){var y=d.return;if(y===null)break;var _=y.alternate;if(_===null){if(x=y.return,x!==null){d=x;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===d)return Fe(y),s;if(_===x)return Fe(y),i;_=_.sibling}throw Error(t(188))}if(d.return!==x.return)d=y,x=_;else{for(var M=!1,ie=y.child;ie;){if(ie===d){M=!0,d=y,x=_;break}if(ie===x){M=!0,x=y,d=_;break}ie=ie.sibling}if(!M){for(ie=_.child;ie;){if(ie===d){M=!0,d=_,x=y;break}if(ie===x){M=!0,x=_,d=y;break}ie=ie.sibling}if(!M)throw Error(t(189))}}if(d.alternate!==x)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?s:i}function Se(s){return s=we(s),s!==null?Ee(s):null}function Ee(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=Ee(s);if(i!==null)return i;s=s.sibling}return null}var We=n.unstable_scheduleCallback,Ze=n.unstable_cancelCallback,Ue=n.unstable_shouldYield,$e=n.unstable_requestPaint,Ye=n.unstable_now,gt=n.unstable_getCurrentPriorityLevel,Vt=n.unstable_ImmediatePriority,$t=n.unstable_UserBlockingPriority,mr=n.unstable_NormalPriority,Ls=n.unstable_LowPriority,rs=n.unstable_IdlePriority,da=null,jr=null;function wi(s){if(jr&&typeof jr.onCommitFiberRoot=="function")try{jr.onCommitFiberRoot(da,s,void 0,(s.current.flags&128)===128)}catch{}}var gr=Math.clz32?Math.clz32:Ew,_w=Math.log,Sw=Math.LN2;function Ew(s){return s>>>=0,s===0?32:31-(_w(s)/Sw|0)|0}var Yl=64,Vl=4194304;function ki(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Kl(s,i){var d=s.pendingLanes;if(d===0)return 0;var x=0,y=s.suspendedLanes,_=s.pingedLanes,M=d&268435455;if(M!==0){var ie=M&~y;ie!==0?x=ki(ie):(_&=M,_!==0&&(x=ki(_)))}else M=d&~y,M!==0?x=ki(M):_!==0&&(x=ki(_));if(x===0)return 0;if(i!==0&&i!==x&&(i&y)===0&&(y=x&-x,_=i&-i,y>=_||y===16&&(_&4194240)!==0))return i;if((x&4)!==0&&(x|=d&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=x;0<i;)d=31-gr(i),y=1<<d,x|=s[d],i&=~y;return x}function Nw(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cw(s,i){for(var d=s.suspendedLanes,x=s.pingedLanes,y=s.expirationTimes,_=s.pendingLanes;0<_;){var M=31-gr(_),ie=1<<M,xe=y[M];xe===-1?((ie&d)===0||(ie&x)!==0)&&(y[M]=Nw(ie,i)):xe<=i&&(s.expiredLanes|=ie),_&=~ie}}function cd(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Yp(){var s=Yl;return Yl<<=1,(Yl&4194240)===0&&(Yl=64),s}function ud(s){for(var i=[],d=0;31>d;d++)i.push(s);return i}function bi(s,i,d){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-gr(i),s[i]=d}function Tw(s,i){var d=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var x=s.eventTimes;for(s=s.expirationTimes;0<d;){var y=31-gr(d),_=1<<y;i[y]=0,x[y]=-1,s[y]=-1,d&=~_}}function dd(s,i){var d=s.entangledLanes|=i;for(s=s.entanglements;d;){var x=31-gr(d),y=1<<x;y&i|s[x]&i&&(s[x]|=i),d&=~y}}var Kt=0;function Vp(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Kp,fd,Gp,Qp,Xp,pd=!1,Gl=[],ns=null,as=null,ss=null,_i=new Map,Si=new Map,os=[],Dw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qp(s,i){switch(s){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":ss=null;break;case"pointerover":case"pointerout":_i.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Si.delete(i.pointerId)}}function Ei(s,i,d,x,y,_){return s===null||s.nativeEvent!==_?(s={blockedOn:i,domEventName:d,eventSystemFlags:x,nativeEvent:_,targetContainers:[y]},i!==null&&(i=Li(i),i!==null&&fd(i)),s):(s.eventSystemFlags|=x,i=s.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),s)}function Fw(s,i,d,x,y){switch(i){case"focusin":return ns=Ei(ns,s,i,d,x,y),!0;case"dragenter":return as=Ei(as,s,i,d,x,y),!0;case"mouseover":return ss=Ei(ss,s,i,d,x,y),!0;case"pointerover":var _=y.pointerId;return _i.set(_,Ei(_i.get(_)||null,s,i,d,x,y)),!0;case"gotpointercapture":return _=y.pointerId,Si.set(_,Ei(Si.get(_)||null,s,i,d,x,y)),!0}return!1}function Zp(s){var i=Bs(s.target);if(i!==null){var d=ne(i);if(d!==null){if(i=d.tag,i===13){if(i=ke(d),i!==null){s.blockedOn=i,Xp(s.priority,function(){Gp(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ql(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var d=xd(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(d===null){d=s.nativeEvent;var x=new d.constructor(d.type,d);vt=x,d.target.dispatchEvent(x),vt=null}else return i=Li(d),i!==null&&fd(i),s.blockedOn=d,!1;i.shift()}return!0}function Jp(s,i,d){Ql(s)&&d.delete(i)}function jw(){pd=!1,ns!==null&&Ql(ns)&&(ns=null),as!==null&&Ql(as)&&(as=null),ss!==null&&Ql(ss)&&(ss=null),_i.forEach(Jp),Si.forEach(Jp)}function Ni(s,i){s.blockedOn===i&&(s.blockedOn=null,pd||(pd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,jw)))}function Ci(s){function i(y){return Ni(y,s)}if(0<Gl.length){Ni(Gl[0],s);for(var d=1;d<Gl.length;d++){var x=Gl[d];x.blockedOn===s&&(x.blockedOn=null)}}for(ns!==null&&Ni(ns,s),as!==null&&Ni(as,s),ss!==null&&Ni(ss,s),_i.forEach(i),Si.forEach(i),d=0;d<os.length;d++)x=os[d],x.blockedOn===s&&(x.blockedOn=null);for(;0<os.length&&(d=os[0],d.blockedOn===null);)Zp(d),d.blockedOn===null&&os.shift()}var No=Y.ReactCurrentBatchConfig,Xl=!0;function Pw(s,i,d,x){var y=Kt,_=No.transition;No.transition=null;try{Kt=1,hd(s,i,d,x)}finally{Kt=y,No.transition=_}}function Aw(s,i,d,x){var y=Kt,_=No.transition;No.transition=null;try{Kt=4,hd(s,i,d,x)}finally{Kt=y,No.transition=_}}function hd(s,i,d,x){if(Xl){var y=xd(s,i,d,x);if(y===null)Pd(s,i,x,ql,d),qp(s,x);else if(Fw(y,s,i,d,x))x.stopPropagation();else if(qp(s,x),i&4&&-1<Dw.indexOf(s)){for(;y!==null;){var _=Li(y);if(_!==null&&Kp(_),_=xd(s,i,d,x),_===null&&Pd(s,i,x,ql,d),_===y)break;y=_}y!==null&&x.stopPropagation()}else Pd(s,i,x,null,d)}}var ql=null;function xd(s,i,d,x){if(ql=null,s=bt(x),s=Bs(s),s!==null)if(i=ne(s),i===null)s=null;else if(d=i.tag,d===13){if(s=ke(i),s!==null)return s;s=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return ql=s,null}function eh(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gt()){case Vt:return 1;case $t:return 4;case mr:case Ls:return 16;case rs:return 536870912;default:return 16}default:return 16}}var is=null,md=null,Zl=null;function th(){if(Zl)return Zl;var s,i=md,d=i.length,x,y="value"in is?is.value:is.textContent,_=y.length;for(s=0;s<d&&i[s]===y[s];s++);var M=d-s;for(x=1;x<=M&&i[d-x]===y[_-x];x++);return Zl=y.slice(s,1<x?1-x:void 0)}function Jl(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ec(){return!0}function rh(){return!1}function kn(s){function i(d,x,y,_,M){this._reactName=d,this._targetInst=y,this.type=x,this.nativeEvent=_,this.target=M,this.currentTarget=null;for(var ie in s)s.hasOwnProperty(ie)&&(d=s[ie],this[ie]=d?d(_):_[ie]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ec:rh,this.isPropagationStopped=rh,this}return re(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=ec)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=ec)},persist:function(){},isPersistent:ec}),i}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gd=kn(Co),Ti=re({},Co,{view:0,detail:0}),Ow=kn(Ti),vd,yd,Di,tc=re({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Di&&(Di&&s.type==="mousemove"?(vd=s.screenX-Di.screenX,yd=s.screenY-Di.screenY):yd=vd=0,Di=s),vd)},movementY:function(s){return"movementY"in s?s.movementY:yd}}),nh=kn(tc),Rw=re({},tc,{dataTransfer:0}),zw=kn(Rw),Mw=re({},Ti,{relatedTarget:0}),wd=kn(Mw),Iw=re({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),Lw=kn(Iw),Bw=re({},Co,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ww=kn(Bw),Uw=re({},Co,{data:0}),ah=kn(Uw),$w={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vw(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Yw[s])?!!i[s]:!1}function kd(){return Vw}var Kw=re({},Ti,{key:function(s){if(s.key){var i=$w[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Jl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Hw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kd,charCode:function(s){return s.type==="keypress"?Jl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Jl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Gw=kn(Kw),Qw=re({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sh=kn(Qw),Xw=re({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kd}),qw=kn(Xw),Zw=re({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jw=kn(Zw),ek=re({},tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),tk=kn(ek),rk=[9,13,27,32],bd=c&&"CompositionEvent"in window,Fi=null;c&&"documentMode"in document&&(Fi=document.documentMode);var nk=c&&"TextEvent"in window&&!Fi,oh=c&&(!bd||Fi&&8<Fi&&11>=Fi),ih=" ",lh=!1;function ch(s,i){switch(s){case"keyup":return rk.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uh(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var To=!1;function ak(s,i){switch(s){case"compositionend":return uh(i);case"keypress":return i.which!==32?null:(lh=!0,ih);case"textInput":return s=i.data,s===ih&&lh?null:s;default:return null}}function sk(s,i){if(To)return s==="compositionend"||!bd&&ch(s,i)?(s=th(),Zl=md=is=null,To=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return oh&&i.locale!=="ko"?null:i.data;default:return null}}var ok={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!ok[s.type]:i==="textarea"}function fh(s,i,d,x){me(x),i=oc(i,"onChange"),0<i.length&&(d=new gd("onChange","change",null,d,x),s.push({event:d,listeners:i}))}var ji=null,Pi=null;function ik(s){Fh(s,0)}function rc(s){var i=Ao(s);if(L(i))return s}function lk(s,i){if(s==="change")return i}var ph=!1;if(c){var _d;if(c){var Sd="oninput"in document;if(!Sd){var hh=document.createElement("div");hh.setAttribute("oninput","return;"),Sd=typeof hh.oninput=="function"}_d=Sd}else _d=!1;ph=_d&&(!document.documentMode||9<document.documentMode)}function xh(){ji&&(ji.detachEvent("onpropertychange",mh),Pi=ji=null)}function mh(s){if(s.propertyName==="value"&&rc(Pi)){var i=[];fh(i,Pi,s,bt(s)),pt(ik,i)}}function ck(s,i,d){s==="focusin"?(xh(),ji=i,Pi=d,ji.attachEvent("onpropertychange",mh)):s==="focusout"&&xh()}function uk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return rc(Pi)}function dk(s,i){if(s==="click")return rc(i)}function fk(s,i){if(s==="input"||s==="change")return rc(i)}function pk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Qn=typeof Object.is=="function"?Object.is:pk;function Ai(s,i){if(Qn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var d=Object.keys(s),x=Object.keys(i);if(d.length!==x.length)return!1;for(x=0;x<d.length;x++){var y=d[x];if(!f.call(i,y)||!Qn(s[y],i[y]))return!1}return!0}function gh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function vh(s,i){var d=gh(s);s=0;for(var x;d;){if(d.nodeType===3){if(x=s+d.textContent.length,s<=i&&x>=i)return{node:d,offset:i-s};s=x}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=gh(d)}}function yh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?yh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function wh(){for(var s=window,i=Oe();i instanceof s.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)s=i.contentWindow;else break;i=Oe(s.document)}return i}function Ed(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function hk(s){var i=wh(),d=s.focusedElem,x=s.selectionRange;if(i!==d&&d&&d.ownerDocument&&yh(d.ownerDocument.documentElement,d)){if(x!==null&&Ed(d)){if(i=x.start,s=x.end,s===void 0&&(s=i),"selectionStart"in d)d.selectionStart=i,d.selectionEnd=Math.min(s,d.value.length);else if(s=(i=d.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var y=d.textContent.length,_=Math.min(x.start,y);x=x.end===void 0?_:Math.min(x.end,y),!s.extend&&_>x&&(y=x,x=_,_=y),y=vh(d,_);var M=vh(d,x);y&&M&&(s.rangeCount!==1||s.anchorNode!==y.node||s.anchorOffset!==y.offset||s.focusNode!==M.node||s.focusOffset!==M.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),s.removeAllRanges(),_>x?(s.addRange(i),s.extend(M.node,M.offset)):(i.setEnd(M.node,M.offset),s.addRange(i)))}}for(i=[],s=d;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<i.length;d++)s=i[d],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var xk=c&&"documentMode"in document&&11>=document.documentMode,Do=null,Nd=null,Oi=null,Cd=!1;function kh(s,i,d){var x=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Cd||Do==null||Do!==Oe(x)||(x=Do,"selectionStart"in x&&Ed(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Oi&&Ai(Oi,x)||(Oi=x,x=oc(Nd,"onSelect"),0<x.length&&(i=new gd("onSelect","select",null,i,d),s.push({event:i,listeners:x}),i.target=Do)))}function nc(s,i){var d={};return d[s.toLowerCase()]=i.toLowerCase(),d["Webkit"+s]="webkit"+i,d["Moz"+s]="moz"+i,d}var Fo={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Td={},bh={};c&&(bh=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function ac(s){if(Td[s])return Td[s];if(!Fo[s])return s;var i=Fo[s],d;for(d in i)if(i.hasOwnProperty(d)&&d in bh)return Td[s]=i[d];return s}var _h=ac("animationend"),Sh=ac("animationiteration"),Eh=ac("animationstart"),Nh=ac("transitionend"),Ch=new Map,Th="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ls(s,i){Ch.set(s,i),o(i,[s])}for(var Dd=0;Dd<Th.length;Dd++){var Fd=Th[Dd],mk=Fd.toLowerCase(),gk=Fd[0].toUpperCase()+Fd.slice(1);ls(mk,"on"+gk)}ls(_h,"onAnimationEnd"),ls(Sh,"onAnimationIteration"),ls(Eh,"onAnimationStart"),ls("dblclick","onDoubleClick"),ls("focusin","onFocus"),ls("focusout","onBlur"),ls(Nh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function Dh(s,i,d){var x=s.type||"unknown-event";s.currentTarget=d,Z(x,i,void 0,s),s.currentTarget=null}function Fh(s,i){i=(i&4)!==0;for(var d=0;d<s.length;d++){var x=s[d],y=x.event;x=x.listeners;e:{var _=void 0;if(i)for(var M=x.length-1;0<=M;M--){var ie=x[M],xe=ie.instance,Ce=ie.currentTarget;if(ie=ie.listener,xe!==_&&y.isPropagationStopped())break e;Dh(y,ie,Ce),_=xe}else for(M=0;M<x.length;M++){if(ie=x[M],xe=ie.instance,Ce=ie.currentTarget,ie=ie.listener,xe!==_&&y.isPropagationStopped())break e;Dh(y,ie,Ce),_=xe}}}if(R)throw s=te,R=!1,te=null,s}function nr(s,i){var d=i[Id];d===void 0&&(d=i[Id]=new Set);var x=s+"__bubble";d.has(x)||(jh(i,s,2,!1),d.add(x))}function jd(s,i,d){var x=0;i&&(x|=4),jh(d,s,x,i)}var sc="_reactListening"+Math.random().toString(36).slice(2);function zi(s){if(!s[sc]){s[sc]=!0,r.forEach(function(d){d!=="selectionchange"&&(vk.has(d)||jd(d,!1,s),jd(d,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[sc]||(i[sc]=!0,jd("selectionchange",!1,i))}}function jh(s,i,d,x){switch(eh(i)){case 1:var y=Pw;break;case 4:y=Aw;break;default:y=hd}d=y.bind(null,i,d,s),y=void 0,!Ge||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),x?y!==void 0?s.addEventListener(i,d,{capture:!0,passive:y}):s.addEventListener(i,d,!0):y!==void 0?s.addEventListener(i,d,{passive:y}):s.addEventListener(i,d,!1)}function Pd(s,i,d,x,y){var _=x;if((i&1)===0&&(i&2)===0&&x!==null)e:for(;;){if(x===null)return;var M=x.tag;if(M===3||M===4){var ie=x.stateNode.containerInfo;if(ie===y||ie.nodeType===8&&ie.parentNode===y)break;if(M===4)for(M=x.return;M!==null;){var xe=M.tag;if((xe===3||xe===4)&&(xe=M.stateNode.containerInfo,xe===y||xe.nodeType===8&&xe.parentNode===y))return;M=M.return}for(;ie!==null;){if(M=Bs(ie),M===null)return;if(xe=M.tag,xe===5||xe===6){x=_=M;continue e}ie=ie.parentNode}}x=x.return}pt(function(){var Ce=_,Le=bt(d),Ve=[];e:{var Ie=Ch.get(s);if(Ie!==void 0){var at=gd,ot=s;switch(s){case"keypress":if(Jl(d)===0)break e;case"keydown":case"keyup":at=Gw;break;case"focusin":ot="focus",at=wd;break;case"focusout":ot="blur",at=wd;break;case"beforeblur":case"afterblur":at=wd;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=nh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=zw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=qw;break;case _h:case Sh:case Eh:at=Lw;break;case Nh:at=Jw;break;case"scroll":at=Ow;break;case"wheel":at=tk;break;case"copy":case"cut":case"paste":at=Ww;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=sh}var it=(i&4)!==0,vr=!it&&s==="scroll",ye=it?Ie!==null?Ie+"Capture":null:Ie;it=[];for(var ge=Ce,be;ge!==null;){be=ge;var Xe=be.stateNode;if(be.tag===5&&Xe!==null&&(be=Xe,ye!==null&&(Xe=Wt(ge,ye),Xe!=null&&it.push(Mi(ge,Xe,be)))),vr)break;ge=ge.return}0<it.length&&(Ie=new at(Ie,ot,null,d,Le),Ve.push({event:Ie,listeners:it}))}}if((i&7)===0){e:{if(Ie=s==="mouseover"||s==="pointerover",at=s==="mouseout"||s==="pointerout",Ie&&d!==vt&&(ot=d.relatedTarget||d.fromElement)&&(Bs(ot)||ot[Ra]))break e;if((at||Ie)&&(Ie=Le.window===Le?Le:(Ie=Le.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,at?(ot=d.relatedTarget||d.toElement,at=Ce,ot=ot?Bs(ot):null,ot!==null&&(vr=ne(ot),ot!==vr||ot.tag!==5&&ot.tag!==6)&&(ot=null)):(at=null,ot=Ce),at!==ot)){if(it=nh,Xe="onMouseLeave",ye="onMouseEnter",ge="mouse",(s==="pointerout"||s==="pointerover")&&(it=sh,Xe="onPointerLeave",ye="onPointerEnter",ge="pointer"),vr=at==null?Ie:Ao(at),be=ot==null?Ie:Ao(ot),Ie=new it(Xe,ge+"leave",at,d,Le),Ie.target=vr,Ie.relatedTarget=be,Xe=null,Bs(Le)===Ce&&(it=new it(ye,ge+"enter",ot,d,Le),it.target=be,it.relatedTarget=vr,Xe=it),vr=Xe,at&&ot)t:{for(it=at,ye=ot,ge=0,be=it;be;be=jo(be))ge++;for(be=0,Xe=ye;Xe;Xe=jo(Xe))be++;for(;0<ge-be;)it=jo(it),ge--;for(;0<be-ge;)ye=jo(ye),be--;for(;ge--;){if(it===ye||ye!==null&&it===ye.alternate)break t;it=jo(it),ye=jo(ye)}it=null}else it=null;at!==null&&Ph(Ve,Ie,at,it,!1),ot!==null&&vr!==null&&Ph(Ve,vr,ot,it,!0)}}e:{if(Ie=Ce?Ao(Ce):window,at=Ie.nodeName&&Ie.nodeName.toLowerCase(),at==="select"||at==="input"&&Ie.type==="file")var lt=lk;else if(dh(Ie))if(ph)lt=fk;else{lt=uk;var xt=ck}else(at=Ie.nodeName)&&at.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(lt=dk);if(lt&&(lt=lt(s,Ce))){fh(Ve,lt,d,Le);break e}xt&&xt(s,Ie,Ce),s==="focusout"&&(xt=Ie._wrapperState)&&xt.controlled&&Ie.type==="number"&&Pe(Ie,"number",Ie.value)}switch(xt=Ce?Ao(Ce):window,s){case"focusin":(dh(xt)||xt.contentEditable==="true")&&(Do=xt,Nd=Ce,Oi=null);break;case"focusout":Oi=Nd=Do=null;break;case"mousedown":Cd=!0;break;case"contextmenu":case"mouseup":case"dragend":Cd=!1,kh(Ve,d,Le);break;case"selectionchange":if(xk)break;case"keydown":case"keyup":kh(Ve,d,Le)}var mt;if(bd)e:{switch(s){case"compositionstart":var wt="onCompositionStart";break e;case"compositionend":wt="onCompositionEnd";break e;case"compositionupdate":wt="onCompositionUpdate";break e}wt=void 0}else To?ch(s,d)&&(wt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(wt="onCompositionStart");wt&&(oh&&d.locale!=="ko"&&(To||wt!=="onCompositionStart"?wt==="onCompositionEnd"&&To&&(mt=th()):(is=Le,md="value"in is?is.value:is.textContent,To=!0)),xt=oc(Ce,wt),0<xt.length&&(wt=new ah(wt,s,null,d,Le),Ve.push({event:wt,listeners:xt}),mt?wt.data=mt:(mt=uh(d),mt!==null&&(wt.data=mt)))),(mt=nk?ak(s,d):sk(s,d))&&(Ce=oc(Ce,"onBeforeInput"),0<Ce.length&&(Le=new ah("onBeforeInput","beforeinput",null,d,Le),Ve.push({event:Le,listeners:Ce}),Le.data=mt))}Fh(Ve,i)})}function Mi(s,i,d){return{instance:s,listener:i,currentTarget:d}}function oc(s,i){for(var d=i+"Capture",x=[];s!==null;){var y=s,_=y.stateNode;y.tag===5&&_!==null&&(y=_,_=Wt(s,d),_!=null&&x.unshift(Mi(s,_,y)),_=Wt(s,i),_!=null&&x.push(Mi(s,_,y))),s=s.return}return x}function jo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Ph(s,i,d,x,y){for(var _=i._reactName,M=[];d!==null&&d!==x;){var ie=d,xe=ie.alternate,Ce=ie.stateNode;if(xe!==null&&xe===x)break;ie.tag===5&&Ce!==null&&(ie=Ce,y?(xe=Wt(d,_),xe!=null&&M.unshift(Mi(d,xe,ie))):y||(xe=Wt(d,_),xe!=null&&M.push(Mi(d,xe,ie)))),d=d.return}M.length!==0&&s.push({event:i,listeners:M})}var yk=/\r\n?/g,wk=/\u0000|\uFFFD/g;function Ah(s){return(typeof s=="string"?s:""+s).replace(yk,`
`).replace(wk,"")}function ic(s,i,d){if(i=Ah(i),Ah(s)!==i&&d)throw Error(t(425))}function lc(){}var Ad=null,Od=null;function Rd(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var zd=typeof setTimeout=="function"?setTimeout:void 0,kk=typeof clearTimeout=="function"?clearTimeout:void 0,Oh=typeof Promise=="function"?Promise:void 0,bk=typeof queueMicrotask=="function"?queueMicrotask:typeof Oh<"u"?function(s){return Oh.resolve(null).then(s).catch(_k)}:zd;function _k(s){setTimeout(function(){throw s})}function Md(s,i){var d=i,x=0;do{var y=d.nextSibling;if(s.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(x===0){s.removeChild(y),Ci(i);return}x--}else d!=="$"&&d!=="$?"&&d!=="$!"||x++;d=y}while(d);Ci(i)}function cs(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Rh(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return s;i--}else d==="/$"&&i++}s=s.previousSibling}return null}var Po=Math.random().toString(36).slice(2),fa="__reactFiber$"+Po,Ii="__reactProps$"+Po,Ra="__reactContainer$"+Po,Id="__reactEvents$"+Po,Sk="__reactListeners$"+Po,Ek="__reactHandles$"+Po;function Bs(s){var i=s[fa];if(i)return i;for(var d=s.parentNode;d;){if(i=d[Ra]||d[fa]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(s=Rh(s);s!==null;){if(d=s[fa])return d;s=Rh(s)}return i}s=d,d=s.parentNode}return null}function Li(s){return s=s[fa]||s[Ra],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Ao(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function cc(s){return s[Ii]||null}var Ld=[],Oo=-1;function us(s){return{current:s}}function ar(s){0>Oo||(s.current=Ld[Oo],Ld[Oo]=null,Oo--)}function er(s,i){Oo++,Ld[Oo]=s.current,s.current=i}var ds={},Hr=us(ds),hn=us(!1),Ws=ds;function Ro(s,i){var d=s.type.contextTypes;if(!d)return ds;var x=s.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===i)return x.__reactInternalMemoizedMaskedChildContext;var y={},_;for(_ in d)y[_]=i[_];return x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=y),y}function xn(s){return s=s.childContextTypes,s!=null}function uc(){ar(hn),ar(Hr)}function zh(s,i,d){if(Hr.current!==ds)throw Error(t(168));er(Hr,i),er(hn,d)}function Mh(s,i,d){var x=s.stateNode;if(i=i.childContextTypes,typeof x.getChildContext!="function")return d;x=x.getChildContext();for(var y in x)if(!(y in i))throw Error(t(108,N(s)||"Unknown",y));return re({},d,x)}function dc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ds,Ws=Hr.current,er(Hr,s),er(hn,hn.current),!0}function Ih(s,i,d){var x=s.stateNode;if(!x)throw Error(t(169));d?(s=Mh(s,i,Ws),x.__reactInternalMemoizedMergedChildContext=s,ar(hn),ar(Hr),er(Hr,s)):ar(hn),er(hn,d)}var za=null,fc=!1,Bd=!1;function Lh(s){za===null?za=[s]:za.push(s)}function Nk(s){fc=!0,Lh(s)}function fs(){if(!Bd&&za!==null){Bd=!0;var s=0,i=Kt;try{var d=za;for(Kt=1;s<d.length;s++){var x=d[s];do x=x(!0);while(x!==null)}za=null,fc=!1}catch(y){throw za!==null&&(za=za.slice(s+1)),We(Vt,fs),y}finally{Kt=i,Bd=!1}}return null}var zo=[],Mo=0,pc=null,hc=0,Fn=[],jn=0,Us=null,Ma=1,Ia="";function $s(s,i){zo[Mo++]=hc,zo[Mo++]=pc,pc=s,hc=i}function Bh(s,i,d){Fn[jn++]=Ma,Fn[jn++]=Ia,Fn[jn++]=Us,Us=s;var x=Ma;s=Ia;var y=32-gr(x)-1;x&=~(1<<y),d+=1;var _=32-gr(i)+y;if(30<_){var M=y-y%5;_=(x&(1<<M)-1).toString(32),x>>=M,y-=M,Ma=1<<32-gr(i)+y|d<<y|x,Ia=_+s}else Ma=1<<_|d<<y|x,Ia=s}function Wd(s){s.return!==null&&($s(s,1),Bh(s,1,0))}function Ud(s){for(;s===pc;)pc=zo[--Mo],zo[Mo]=null,hc=zo[--Mo],zo[Mo]=null;for(;s===Us;)Us=Fn[--jn],Fn[jn]=null,Ia=Fn[--jn],Fn[jn]=null,Ma=Fn[--jn],Fn[jn]=null}var bn=null,_n=null,or=!1,Xn=null;function Wh(s,i){var d=Rn(5,null,null,0);d.elementType="DELETED",d.stateNode=i,d.return=s,i=s.deletions,i===null?(s.deletions=[d],s.flags|=16):i.push(d)}function Uh(s,i){switch(s.tag){case 5:var d=s.type;return i=i.nodeType!==1||d.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,bn=s,_n=cs(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,bn=s,_n=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(d=Us!==null?{id:Ma,overflow:Ia}:null,s.memoizedState={dehydrated:i,treeContext:d,retryLane:1073741824},d=Rn(18,null,null,0),d.stateNode=i,d.return=s,s.child=d,bn=s,_n=null,!0):!1;default:return!1}}function $d(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Hd(s){if(or){var i=_n;if(i){var d=i;if(!Uh(s,i)){if($d(s))throw Error(t(418));i=cs(d.nextSibling);var x=bn;i&&Uh(s,i)?Wh(x,d):(s.flags=s.flags&-4097|2,or=!1,bn=s)}}else{if($d(s))throw Error(t(418));s.flags=s.flags&-4097|2,or=!1,bn=s}}}function $h(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;bn=s}function xc(s){if(s!==bn)return!1;if(!or)return $h(s),or=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Rd(s.type,s.memoizedProps)),i&&(i=_n)){if($d(s))throw Hh(),Error(t(418));for(;i;)Wh(s,i),i=cs(i.nextSibling)}if($h(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"){if(i===0){_n=cs(s.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++}s=s.nextSibling}_n=null}}else _n=bn?cs(s.stateNode.nextSibling):null;return!0}function Hh(){for(var s=_n;s;)s=cs(s.nextSibling)}function Io(){_n=bn=null,or=!1}function Yd(s){Xn===null?Xn=[s]:Xn.push(s)}var Ck=Y.ReactCurrentBatchConfig;function Bi(s,i,d){if(s=d.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var x=d.stateNode}if(!x)throw Error(t(147,s));var y=x,_=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===_?i.ref:(i=function(M){var ie=y.refs;M===null?delete ie[_]:ie[_]=M},i._stringRef=_,i)}if(typeof s!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,s))}return s}function mc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Yh(s){var i=s._init;return i(s._payload)}function Vh(s){function i(ye,ge){if(s){var be=ye.deletions;be===null?(ye.deletions=[ge],ye.flags|=16):be.push(ge)}}function d(ye,ge){if(!s)return null;for(;ge!==null;)i(ye,ge),ge=ge.sibling;return null}function x(ye,ge){for(ye=new Map;ge!==null;)ge.key!==null?ye.set(ge.key,ge):ye.set(ge.index,ge),ge=ge.sibling;return ye}function y(ye,ge){return ye=ws(ye,ge),ye.index=0,ye.sibling=null,ye}function _(ye,ge,be){return ye.index=be,s?(be=ye.alternate,be!==null?(be=be.index,be<ge?(ye.flags|=2,ge):be):(ye.flags|=2,ge)):(ye.flags|=1048576,ge)}function M(ye){return s&&ye.alternate===null&&(ye.flags|=2),ye}function ie(ye,ge,be,Xe){return ge===null||ge.tag!==6?(ge=z0(be,ye.mode,Xe),ge.return=ye,ge):(ge=y(ge,be),ge.return=ye,ge)}function xe(ye,ge,be,Xe){var lt=be.type;return lt===F?Le(ye,ge,be.props.children,Xe,be.key):ge!==null&&(ge.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===pe&&Yh(lt)===ge.type)?(Xe=y(ge,be.props),Xe.ref=Bi(ye,ge,be),Xe.return=ye,Xe):(Xe=Bc(be.type,be.key,be.props,null,ye.mode,Xe),Xe.ref=Bi(ye,ge,be),Xe.return=ye,Xe)}function Ce(ye,ge,be,Xe){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==be.containerInfo||ge.stateNode.implementation!==be.implementation?(ge=M0(be,ye.mode,Xe),ge.return=ye,ge):(ge=y(ge,be.children||[]),ge.return=ye,ge)}function Le(ye,ge,be,Xe,lt){return ge===null||ge.tag!==7?(ge=qs(be,ye.mode,Xe,lt),ge.return=ye,ge):(ge=y(ge,be),ge.return=ye,ge)}function Ve(ye,ge,be){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=z0(""+ge,ye.mode,be),ge.return=ye,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case ee:return be=Bc(ge.type,ge.key,ge.props,null,ye.mode,be),be.ref=Bi(ye,null,ge),be.return=ye,be;case G:return ge=M0(ge,ye.mode,be),ge.return=ye,ge;case pe:var Xe=ge._init;return Ve(ye,Xe(ge._payload),be)}if(_e(ge)||B(ge))return ge=qs(ge,ye.mode,be,null),ge.return=ye,ge;mc(ye,ge)}return null}function Ie(ye,ge,be,Xe){var lt=ge!==null?ge.key:null;if(typeof be=="string"&&be!==""||typeof be=="number")return lt!==null?null:ie(ye,ge,""+be,Xe);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case ee:return be.key===lt?xe(ye,ge,be,Xe):null;case G:return be.key===lt?Ce(ye,ge,be,Xe):null;case pe:return lt=be._init,Ie(ye,ge,lt(be._payload),Xe)}if(_e(be)||B(be))return lt!==null?null:Le(ye,ge,be,Xe,null);mc(ye,be)}return null}function at(ye,ge,be,Xe,lt){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number")return ye=ye.get(be)||null,ie(ge,ye,""+Xe,lt);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case ee:return ye=ye.get(Xe.key===null?be:Xe.key)||null,xe(ge,ye,Xe,lt);case G:return ye=ye.get(Xe.key===null?be:Xe.key)||null,Ce(ge,ye,Xe,lt);case pe:var xt=Xe._init;return at(ye,ge,be,xt(Xe._payload),lt)}if(_e(Xe)||B(Xe))return ye=ye.get(be)||null,Le(ge,ye,Xe,lt,null);mc(ge,Xe)}return null}function ot(ye,ge,be,Xe){for(var lt=null,xt=null,mt=ge,wt=ge=0,Or=null;mt!==null&&wt<be.length;wt++){mt.index>wt?(Or=mt,mt=null):Or=mt.sibling;var Bt=Ie(ye,mt,be[wt],Xe);if(Bt===null){mt===null&&(mt=Or);break}s&&mt&&Bt.alternate===null&&i(ye,mt),ge=_(Bt,ge,wt),xt===null?lt=Bt:xt.sibling=Bt,xt=Bt,mt=Or}if(wt===be.length)return d(ye,mt),or&&$s(ye,wt),lt;if(mt===null){for(;wt<be.length;wt++)mt=Ve(ye,be[wt],Xe),mt!==null&&(ge=_(mt,ge,wt),xt===null?lt=mt:xt.sibling=mt,xt=mt);return or&&$s(ye,wt),lt}for(mt=x(ye,mt);wt<be.length;wt++)Or=at(mt,ye,wt,be[wt],Xe),Or!==null&&(s&&Or.alternate!==null&&mt.delete(Or.key===null?wt:Or.key),ge=_(Or,ge,wt),xt===null?lt=Or:xt.sibling=Or,xt=Or);return s&&mt.forEach(function(ks){return i(ye,ks)}),or&&$s(ye,wt),lt}function it(ye,ge,be,Xe){var lt=B(be);if(typeof lt!="function")throw Error(t(150));if(be=lt.call(be),be==null)throw Error(t(151));for(var xt=lt=null,mt=ge,wt=ge=0,Or=null,Bt=be.next();mt!==null&&!Bt.done;wt++,Bt=be.next()){mt.index>wt?(Or=mt,mt=null):Or=mt.sibling;var ks=Ie(ye,mt,Bt.value,Xe);if(ks===null){mt===null&&(mt=Or);break}s&&mt&&ks.alternate===null&&i(ye,mt),ge=_(ks,ge,wt),xt===null?lt=ks:xt.sibling=ks,xt=ks,mt=Or}if(Bt.done)return d(ye,mt),or&&$s(ye,wt),lt;if(mt===null){for(;!Bt.done;wt++,Bt=be.next())Bt=Ve(ye,Bt.value,Xe),Bt!==null&&(ge=_(Bt,ge,wt),xt===null?lt=Bt:xt.sibling=Bt,xt=Bt);return or&&$s(ye,wt),lt}for(mt=x(ye,mt);!Bt.done;wt++,Bt=be.next())Bt=at(mt,ye,wt,Bt.value,Xe),Bt!==null&&(s&&Bt.alternate!==null&&mt.delete(Bt.key===null?wt:Bt.key),ge=_(Bt,ge,wt),xt===null?lt=Bt:xt.sibling=Bt,xt=Bt);return s&&mt.forEach(function(ob){return i(ye,ob)}),or&&$s(ye,wt),lt}function vr(ye,ge,be,Xe){if(typeof be=="object"&&be!==null&&be.type===F&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case ee:e:{for(var lt=be.key,xt=ge;xt!==null;){if(xt.key===lt){if(lt=be.type,lt===F){if(xt.tag===7){d(ye,xt.sibling),ge=y(xt,be.props.children),ge.return=ye,ye=ge;break e}}else if(xt.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===pe&&Yh(lt)===xt.type){d(ye,xt.sibling),ge=y(xt,be.props),ge.ref=Bi(ye,xt,be),ge.return=ye,ye=ge;break e}d(ye,xt);break}else i(ye,xt);xt=xt.sibling}be.type===F?(ge=qs(be.props.children,ye.mode,Xe,be.key),ge.return=ye,ye=ge):(Xe=Bc(be.type,be.key,be.props,null,ye.mode,Xe),Xe.ref=Bi(ye,ge,be),Xe.return=ye,ye=Xe)}return M(ye);case G:e:{for(xt=be.key;ge!==null;){if(ge.key===xt)if(ge.tag===4&&ge.stateNode.containerInfo===be.containerInfo&&ge.stateNode.implementation===be.implementation){d(ye,ge.sibling),ge=y(ge,be.children||[]),ge.return=ye,ye=ge;break e}else{d(ye,ge);break}else i(ye,ge);ge=ge.sibling}ge=M0(be,ye.mode,Xe),ge.return=ye,ye=ge}return M(ye);case pe:return xt=be._init,vr(ye,ge,xt(be._payload),Xe)}if(_e(be))return ot(ye,ge,be,Xe);if(B(be))return it(ye,ge,be,Xe);mc(ye,be)}return typeof be=="string"&&be!==""||typeof be=="number"?(be=""+be,ge!==null&&ge.tag===6?(d(ye,ge.sibling),ge=y(ge,be),ge.return=ye,ye=ge):(d(ye,ge),ge=z0(be,ye.mode,Xe),ge.return=ye,ye=ge),M(ye)):d(ye,ge)}return vr}var Lo=Vh(!0),Kh=Vh(!1),gc=us(null),vc=null,Bo=null,Vd=null;function Kd(){Vd=Bo=vc=null}function Gd(s){var i=gc.current;ar(gc),s._currentValue=i}function Qd(s,i,d){for(;s!==null;){var x=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,x!==null&&(x.childLanes|=i)):x!==null&&(x.childLanes&i)!==i&&(x.childLanes|=i),s===d)break;s=s.return}}function Wo(s,i){vc=s,Vd=Bo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(mn=!0),s.firstContext=null)}function Pn(s){var i=s._currentValue;if(Vd!==s)if(s={context:s,memoizedValue:i,next:null},Bo===null){if(vc===null)throw Error(t(308));Bo=s,vc.dependencies={lanes:0,firstContext:s}}else Bo=Bo.next=s;return i}var Hs=null;function Xd(s){Hs===null?Hs=[s]:Hs.push(s)}function Gh(s,i,d,x){var y=i.interleaved;return y===null?(d.next=d,Xd(i)):(d.next=y.next,y.next=d),i.interleaved=d,La(s,x)}function La(s,i){s.lanes|=i;var d=s.alternate;for(d!==null&&(d.lanes|=i),d=s,s=s.return;s!==null;)s.childLanes|=i,d=s.alternate,d!==null&&(d.childLanes|=i),d=s,s=s.return;return d.tag===3?d.stateNode:null}var ps=!1;function qd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Ba(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function hs(s,i,d){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Rt&2)!==0){var y=x.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),x.pending=i,La(s,d)}return y=x.interleaved,y===null?(i.next=i,Xd(x)):(i.next=y.next,y.next=i),x.interleaved=i,La(s,d)}function yc(s,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194240)!==0)){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,dd(s,d)}}function Xh(s,i){var d=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,d===x)){var y=null,_=null;if(d=d.firstBaseUpdate,d!==null){do{var M={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};_===null?y=_=M:_=_.next=M,d=d.next}while(d!==null);_===null?y=_=i:_=_.next=i}else y=_=i;d={baseState:x.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:x.shared,effects:x.effects},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=i:s.next=i,d.lastBaseUpdate=i}function wc(s,i,d,x){var y=s.updateQueue;ps=!1;var _=y.firstBaseUpdate,M=y.lastBaseUpdate,ie=y.shared.pending;if(ie!==null){y.shared.pending=null;var xe=ie,Ce=xe.next;xe.next=null,M===null?_=Ce:M.next=Ce,M=xe;var Le=s.alternate;Le!==null&&(Le=Le.updateQueue,ie=Le.lastBaseUpdate,ie!==M&&(ie===null?Le.firstBaseUpdate=Ce:ie.next=Ce,Le.lastBaseUpdate=xe))}if(_!==null){var Ve=y.baseState;M=0,Le=Ce=xe=null,ie=_;do{var Ie=ie.lane,at=ie.eventTime;if((x&Ie)===Ie){Le!==null&&(Le=Le.next={eventTime:at,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var ot=s,it=ie;switch(Ie=i,at=d,it.tag){case 1:if(ot=it.payload,typeof ot=="function"){Ve=ot.call(at,Ve,Ie);break e}Ve=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=it.payload,Ie=typeof ot=="function"?ot.call(at,Ve,Ie):ot,Ie==null)break e;Ve=re({},Ve,Ie);break e;case 2:ps=!0}}ie.callback!==null&&ie.lane!==0&&(s.flags|=64,Ie=y.effects,Ie===null?y.effects=[ie]:Ie.push(ie))}else at={eventTime:at,lane:Ie,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},Le===null?(Ce=Le=at,xe=Ve):Le=Le.next=at,M|=Ie;if(ie=ie.next,ie===null){if(ie=y.shared.pending,ie===null)break;Ie=ie,ie=Ie.next,Ie.next=null,y.lastBaseUpdate=Ie,y.shared.pending=null}}while(!0);if(Le===null&&(xe=Ve),y.baseState=xe,y.firstBaseUpdate=Ce,y.lastBaseUpdate=Le,i=y.shared.interleaved,i!==null){y=i;do M|=y.lane,y=y.next;while(y!==i)}else _===null&&(y.shared.lanes=0);Ks|=M,s.lanes=M,s.memoizedState=Ve}}function qh(s,i,d){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var x=s[i],y=x.callback;if(y!==null){if(x.callback=null,x=d,typeof y!="function")throw Error(t(191,y));y.call(x)}}}var Wi={},pa=us(Wi),Ui=us(Wi),$i=us(Wi);function Ys(s){if(s===Wi)throw Error(t(174));return s}function Zd(s,i){switch(er($i,i),er(Ui,s),er(pa,Wi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Jt(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=Jt(i,s)}ar(pa),er(pa,i)}function Uo(){ar(pa),ar(Ui),ar($i)}function Zh(s){Ys($i.current);var i=Ys(pa.current),d=Jt(i,s.type);i!==d&&(er(Ui,s),er(pa,d))}function Jd(s){Ui.current===s&&(ar(pa),ar(Ui))}var cr=us(0);function kc(s){for(var i=s;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var e0=[];function t0(){for(var s=0;s<e0.length;s++)e0[s]._workInProgressVersionPrimary=null;e0.length=0}var bc=Y.ReactCurrentDispatcher,r0=Y.ReactCurrentBatchConfig,Vs=0,ur=null,Nr=null,Pr=null,_c=!1,Hi=!1,Yi=0,Tk=0;function Yr(){throw Error(t(321))}function n0(s,i){if(i===null)return!1;for(var d=0;d<i.length&&d<s.length;d++)if(!Qn(s[d],i[d]))return!1;return!0}function a0(s,i,d,x,y,_){if(Vs=_,ur=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,bc.current=s===null||s.memoizedState===null?Pk:Ak,s=d(x,y),Hi){_=0;do{if(Hi=!1,Yi=0,25<=_)throw Error(t(301));_+=1,Pr=Nr=null,i.updateQueue=null,bc.current=Ok,s=d(x,y)}while(Hi)}if(bc.current=Nc,i=Nr!==null&&Nr.next!==null,Vs=0,Pr=Nr=ur=null,_c=!1,i)throw Error(t(300));return s}function s0(){var s=Yi!==0;return Yi=0,s}function ha(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pr===null?ur.memoizedState=Pr=s:Pr=Pr.next=s,Pr}function An(){if(Nr===null){var s=ur.alternate;s=s!==null?s.memoizedState:null}else s=Nr.next;var i=Pr===null?ur.memoizedState:Pr.next;if(i!==null)Pr=i,Nr=s;else{if(s===null)throw Error(t(310));Nr=s,s={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Pr===null?ur.memoizedState=Pr=s:Pr=Pr.next=s}return Pr}function Vi(s,i){return typeof i=="function"?i(s):i}function o0(s){var i=An(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=Nr,y=x.baseQueue,_=d.pending;if(_!==null){if(y!==null){var M=y.next;y.next=_.next,_.next=M}x.baseQueue=y=_,d.pending=null}if(y!==null){_=y.next,x=x.baseState;var ie=M=null,xe=null,Ce=_;do{var Le=Ce.lane;if((Vs&Le)===Le)xe!==null&&(xe=xe.next={lane:0,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null}),x=Ce.hasEagerState?Ce.eagerState:s(x,Ce.action);else{var Ve={lane:Le,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null};xe===null?(ie=xe=Ve,M=x):xe=xe.next=Ve,ur.lanes|=Le,Ks|=Le}Ce=Ce.next}while(Ce!==null&&Ce!==_);xe===null?M=x:xe.next=ie,Qn(x,i.memoizedState)||(mn=!0),i.memoizedState=x,i.baseState=M,i.baseQueue=xe,d.lastRenderedState=x}if(s=d.interleaved,s!==null){y=s;do _=y.lane,ur.lanes|=_,Ks|=_,y=y.next;while(y!==s)}else y===null&&(d.lanes=0);return[i.memoizedState,d.dispatch]}function i0(s){var i=An(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=d.dispatch,y=d.pending,_=i.memoizedState;if(y!==null){d.pending=null;var M=y=y.next;do _=s(_,M.action),M=M.next;while(M!==y);Qn(_,i.memoizedState)||(mn=!0),i.memoizedState=_,i.baseQueue===null&&(i.baseState=_),d.lastRenderedState=_}return[_,x]}function Jh(){}function ex(s,i){var d=ur,x=An(),y=i(),_=!Qn(x.memoizedState,y);if(_&&(x.memoizedState=y,mn=!0),x=x.queue,l0(nx.bind(null,d,x,s),[s]),x.getSnapshot!==i||_||Pr!==null&&Pr.memoizedState.tag&1){if(d.flags|=2048,Ki(9,rx.bind(null,d,x,y,i),void 0,null),Ar===null)throw Error(t(349));(Vs&30)!==0||tx(d,i,y)}return y}function tx(s,i,d){s.flags|=16384,s={getSnapshot:i,value:d},i=ur.updateQueue,i===null?(i={lastEffect:null,stores:null},ur.updateQueue=i,i.stores=[s]):(d=i.stores,d===null?i.stores=[s]:d.push(s))}function rx(s,i,d,x){i.value=d,i.getSnapshot=x,ax(i)&&sx(s)}function nx(s,i,d){return d(function(){ax(i)&&sx(s)})}function ax(s){var i=s.getSnapshot;s=s.value;try{var d=i();return!Qn(s,d)}catch{return!0}}function sx(s){var i=La(s,1);i!==null&&ea(i,s,1,-1)}function ox(s){var i=ha();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:s},i.queue=s,s=s.dispatch=jk.bind(null,ur,s),[i.memoizedState,s]}function Ki(s,i,d,x){return s={tag:s,create:i,destroy:d,deps:x,next:null},i=ur.updateQueue,i===null?(i={lastEffect:null,stores:null},ur.updateQueue=i,i.lastEffect=s.next=s):(d=i.lastEffect,d===null?i.lastEffect=s.next=s:(x=d.next,d.next=s,s.next=x,i.lastEffect=s)),s}function ix(){return An().memoizedState}function Sc(s,i,d,x){var y=ha();ur.flags|=s,y.memoizedState=Ki(1|i,d,void 0,x===void 0?null:x)}function Ec(s,i,d,x){var y=An();x=x===void 0?null:x;var _=void 0;if(Nr!==null){var M=Nr.memoizedState;if(_=M.destroy,x!==null&&n0(x,M.deps)){y.memoizedState=Ki(i,d,_,x);return}}ur.flags|=s,y.memoizedState=Ki(1|i,d,_,x)}function lx(s,i){return Sc(8390656,8,s,i)}function l0(s,i){return Ec(2048,8,s,i)}function cx(s,i){return Ec(4,2,s,i)}function ux(s,i){return Ec(4,4,s,i)}function dx(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function fx(s,i,d){return d=d!=null?d.concat([s]):null,Ec(4,4,dx.bind(null,i,s),d)}function c0(){}function px(s,i){var d=An();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&n0(i,x[1])?x[0]:(d.memoizedState=[s,i],s)}function hx(s,i){var d=An();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&n0(i,x[1])?x[0]:(s=s(),d.memoizedState=[s,i],s)}function xx(s,i,d){return(Vs&21)===0?(s.baseState&&(s.baseState=!1,mn=!0),s.memoizedState=d):(Qn(d,i)||(d=Yp(),ur.lanes|=d,Ks|=d,s.baseState=!0),i)}function Dk(s,i){var d=Kt;Kt=d!==0&&4>d?d:4,s(!0);var x=r0.transition;r0.transition={};try{s(!1),i()}finally{Kt=d,r0.transition=x}}function mx(){return An().memoizedState}function Fk(s,i,d){var x=vs(s);if(d={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null},gx(s))vx(i,d);else if(d=Gh(s,i,d,x),d!==null){var y=rn();ea(d,s,x,y),yx(d,i,x)}}function jk(s,i,d){var x=vs(s),y={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null};if(gx(s))vx(i,y);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=i.lastRenderedReducer,_!==null))try{var M=i.lastRenderedState,ie=_(M,d);if(y.hasEagerState=!0,y.eagerState=ie,Qn(ie,M)){var xe=i.interleaved;xe===null?(y.next=y,Xd(i)):(y.next=xe.next,xe.next=y),i.interleaved=y;return}}catch{}finally{}d=Gh(s,i,y,x),d!==null&&(y=rn(),ea(d,s,x,y),yx(d,i,x))}}function gx(s){var i=s.alternate;return s===ur||i!==null&&i===ur}function vx(s,i){Hi=_c=!0;var d=s.pending;d===null?i.next=i:(i.next=d.next,d.next=i),s.pending=i}function yx(s,i,d){if((d&4194240)!==0){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,dd(s,d)}}var Nc={readContext:Pn,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},Pk={readContext:Pn,useCallback:function(s,i){return ha().memoizedState=[s,i===void 0?null:i],s},useContext:Pn,useEffect:lx,useImperativeHandle:function(s,i,d){return d=d!=null?d.concat([s]):null,Sc(4194308,4,dx.bind(null,i,s),d)},useLayoutEffect:function(s,i){return Sc(4194308,4,s,i)},useInsertionEffect:function(s,i){return Sc(4,2,s,i)},useMemo:function(s,i){var d=ha();return i=i===void 0?null:i,s=s(),d.memoizedState=[s,i],s},useReducer:function(s,i,d){var x=ha();return i=d!==void 0?d(i):i,x.memoizedState=x.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},x.queue=s,s=s.dispatch=Fk.bind(null,ur,s),[x.memoizedState,s]},useRef:function(s){var i=ha();return s={current:s},i.memoizedState=s},useState:ox,useDebugValue:c0,useDeferredValue:function(s){return ha().memoizedState=s},useTransition:function(){var s=ox(!1),i=s[0];return s=Dk.bind(null,s[1]),ha().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,d){var x=ur,y=ha();if(or){if(d===void 0)throw Error(t(407));d=d()}else{if(d=i(),Ar===null)throw Error(t(349));(Vs&30)!==0||tx(x,i,d)}y.memoizedState=d;var _={value:d,getSnapshot:i};return y.queue=_,lx(nx.bind(null,x,_,s),[s]),x.flags|=2048,Ki(9,rx.bind(null,x,_,d,i),void 0,null),d},useId:function(){var s=ha(),i=Ar.identifierPrefix;if(or){var d=Ia,x=Ma;d=(x&~(1<<32-gr(x)-1)).toString(32)+d,i=":"+i+"R"+d,d=Yi++,0<d&&(i+="H"+d.toString(32)),i+=":"}else d=Tk++,i=":"+i+"r"+d.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Ak={readContext:Pn,useCallback:px,useContext:Pn,useEffect:l0,useImperativeHandle:fx,useInsertionEffect:cx,useLayoutEffect:ux,useMemo:hx,useReducer:o0,useRef:ix,useState:function(){return o0(Vi)},useDebugValue:c0,useDeferredValue:function(s){var i=An();return xx(i,Nr.memoizedState,s)},useTransition:function(){var s=o0(Vi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Jh,useSyncExternalStore:ex,useId:mx,unstable_isNewReconciler:!1},Ok={readContext:Pn,useCallback:px,useContext:Pn,useEffect:l0,useImperativeHandle:fx,useInsertionEffect:cx,useLayoutEffect:ux,useMemo:hx,useReducer:i0,useRef:ix,useState:function(){return i0(Vi)},useDebugValue:c0,useDeferredValue:function(s){var i=An();return Nr===null?i.memoizedState=s:xx(i,Nr.memoizedState,s)},useTransition:function(){var s=i0(Vi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Jh,useSyncExternalStore:ex,useId:mx,unstable_isNewReconciler:!1};function qn(s,i){if(s&&s.defaultProps){i=re({},i),s=s.defaultProps;for(var d in s)i[d]===void 0&&(i[d]=s[d]);return i}return i}function u0(s,i,d,x){i=s.memoizedState,d=d(x,i),d=d==null?i:re({},i,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var Cc={isMounted:function(s){return(s=s._reactInternals)?ne(s)===s:!1},enqueueSetState:function(s,i,d){s=s._reactInternals;var x=rn(),y=vs(s),_=Ba(x,y);_.payload=i,d!=null&&(_.callback=d),i=hs(s,_,y),i!==null&&(ea(i,s,y,x),yc(i,s,y))},enqueueReplaceState:function(s,i,d){s=s._reactInternals;var x=rn(),y=vs(s),_=Ba(x,y);_.tag=1,_.payload=i,d!=null&&(_.callback=d),i=hs(s,_,y),i!==null&&(ea(i,s,y,x),yc(i,s,y))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var d=rn(),x=vs(s),y=Ba(d,x);y.tag=2,i!=null&&(y.callback=i),i=hs(s,y,x),i!==null&&(ea(i,s,x,d),yc(i,s,x))}};function wx(s,i,d,x,y,_,M){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,_,M):i.prototype&&i.prototype.isPureReactComponent?!Ai(d,x)||!Ai(y,_):!0}function kx(s,i,d){var x=!1,y=ds,_=i.contextType;return typeof _=="object"&&_!==null?_=Pn(_):(y=xn(i)?Ws:Hr.current,x=i.contextTypes,_=(x=x!=null)?Ro(s,y):ds),i=new i(d,_),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Cc,s.stateNode=i,i._reactInternals=s,x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=y,s.__reactInternalMemoizedMaskedChildContext=_),i}function bx(s,i,d,x){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,x),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,x),i.state!==s&&Cc.enqueueReplaceState(i,i.state,null)}function d0(s,i,d,x){var y=s.stateNode;y.props=d,y.state=s.memoizedState,y.refs={},qd(s);var _=i.contextType;typeof _=="object"&&_!==null?y.context=Pn(_):(_=xn(i)?Ws:Hr.current,y.context=Ro(s,_)),y.state=s.memoizedState,_=i.getDerivedStateFromProps,typeof _=="function"&&(u0(s,i,_,d),y.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Cc.enqueueReplaceState(y,y.state,null),wc(s,d,y,x),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308)}function $o(s,i){try{var d="",x=i;do d+=T(x),x=x.return;while(x);var y=d}catch(_){y=`
Error generating stack: `+_.message+`
`+_.stack}return{value:s,source:i,stack:y,digest:null}}function f0(s,i,d){return{value:s,source:null,stack:d??null,digest:i??null}}function p0(s,i){try{console.error(i.value)}catch(d){setTimeout(function(){throw d})}}var Rk=typeof WeakMap=="function"?WeakMap:Map;function _x(s,i,d){d=Ba(-1,d),d.tag=3,d.payload={element:null};var x=i.value;return d.callback=function(){Oc||(Oc=!0,T0=x),p0(s,i)},d}function Sx(s,i,d){d=Ba(-1,d),d.tag=3;var x=s.type.getDerivedStateFromError;if(typeof x=="function"){var y=i.value;d.payload=function(){return x(y)},d.callback=function(){p0(s,i)}}var _=s.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(d.callback=function(){p0(s,i),typeof x!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var M=i.stack;this.componentDidCatch(i.value,{componentStack:M!==null?M:""})}),d}function Ex(s,i,d){var x=s.pingCache;if(x===null){x=s.pingCache=new Rk;var y=new Set;x.set(i,y)}else y=x.get(i),y===void 0&&(y=new Set,x.set(i,y));y.has(d)||(y.add(d),s=Qk.bind(null,s,i,d),i.then(s,s))}function Nx(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Cx(s,i,d,x,y){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(i=Ba(-1,1),i.tag=2,hs(d,i,1))),d.lanes|=1),s):(s.flags|=65536,s.lanes=y,s)}var zk=Y.ReactCurrentOwner,mn=!1;function tn(s,i,d,x){i.child=s===null?Kh(i,null,d,x):Lo(i,s.child,d,x)}function Tx(s,i,d,x,y){d=d.render;var _=i.ref;return Wo(i,y),x=a0(s,i,d,x,_,y),d=s0(),s!==null&&!mn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Wa(s,i,y)):(or&&d&&Wd(i),i.flags|=1,tn(s,i,x,y),i.child)}function Dx(s,i,d,x,y){if(s===null){var _=d.type;return typeof _=="function"&&!R0(_)&&_.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(i.tag=15,i.type=_,Fx(s,i,_,x,y)):(s=Bc(d.type,null,x,i,i.mode,y),s.ref=i.ref,s.return=i,i.child=s)}if(_=s.child,(s.lanes&y)===0){var M=_.memoizedProps;if(d=d.compare,d=d!==null?d:Ai,d(M,x)&&s.ref===i.ref)return Wa(s,i,y)}return i.flags|=1,s=ws(_,x),s.ref=i.ref,s.return=i,i.child=s}function Fx(s,i,d,x,y){if(s!==null){var _=s.memoizedProps;if(Ai(_,x)&&s.ref===i.ref)if(mn=!1,i.pendingProps=x=_,(s.lanes&y)!==0)(s.flags&131072)!==0&&(mn=!0);else return i.lanes=s.lanes,Wa(s,i,y)}return h0(s,i,d,x,y)}function jx(s,i,d){var x=i.pendingProps,y=x.children,_=s!==null?s.memoizedState:null;if(x.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},er(Yo,Sn),Sn|=d;else{if((d&1073741824)===0)return s=_!==null?_.baseLanes|d:d,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,er(Yo,Sn),Sn|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=_!==null?_.baseLanes:d,er(Yo,Sn),Sn|=x}else _!==null?(x=_.baseLanes|d,i.memoizedState=null):x=d,er(Yo,Sn),Sn|=x;return tn(s,i,y,d),i.child}function Px(s,i){var d=i.ref;(s===null&&d!==null||s!==null&&s.ref!==d)&&(i.flags|=512,i.flags|=2097152)}function h0(s,i,d,x,y){var _=xn(d)?Ws:Hr.current;return _=Ro(i,_),Wo(i,y),d=a0(s,i,d,x,_,y),x=s0(),s!==null&&!mn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Wa(s,i,y)):(or&&x&&Wd(i),i.flags|=1,tn(s,i,d,y),i.child)}function Ax(s,i,d,x,y){if(xn(d)){var _=!0;dc(i)}else _=!1;if(Wo(i,y),i.stateNode===null)Dc(s,i),kx(i,d,x),d0(i,d,x,y),x=!0;else if(s===null){var M=i.stateNode,ie=i.memoizedProps;M.props=ie;var xe=M.context,Ce=d.contextType;typeof Ce=="object"&&Ce!==null?Ce=Pn(Ce):(Ce=xn(d)?Ws:Hr.current,Ce=Ro(i,Ce));var Le=d.getDerivedStateFromProps,Ve=typeof Le=="function"||typeof M.getSnapshotBeforeUpdate=="function";Ve||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(ie!==x||xe!==Ce)&&bx(i,M,x,Ce),ps=!1;var Ie=i.memoizedState;M.state=Ie,wc(i,x,M,y),xe=i.memoizedState,ie!==x||Ie!==xe||hn.current||ps?(typeof Le=="function"&&(u0(i,d,Le,x),xe=i.memoizedState),(ie=ps||wx(i,d,ie,x,Ie,xe,Ce))?(Ve||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(i.flags|=4194308)):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=x,i.memoizedState=xe),M.props=x,M.state=xe,M.context=Ce,x=ie):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),x=!1)}else{M=i.stateNode,Qh(s,i),ie=i.memoizedProps,Ce=i.type===i.elementType?ie:qn(i.type,ie),M.props=Ce,Ve=i.pendingProps,Ie=M.context,xe=d.contextType,typeof xe=="object"&&xe!==null?xe=Pn(xe):(xe=xn(d)?Ws:Hr.current,xe=Ro(i,xe));var at=d.getDerivedStateFromProps;(Le=typeof at=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(ie!==Ve||Ie!==xe)&&bx(i,M,x,xe),ps=!1,Ie=i.memoizedState,M.state=Ie,wc(i,x,M,y);var ot=i.memoizedState;ie!==Ve||Ie!==ot||hn.current||ps?(typeof at=="function"&&(u0(i,d,at,x),ot=i.memoizedState),(Ce=ps||wx(i,d,Ce,x,Ie,ot,xe)||!1)?(Le||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(x,ot,xe),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(x,ot,xe)),typeof M.componentDidUpdate=="function"&&(i.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof M.componentDidUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=1024),i.memoizedProps=x,i.memoizedState=ot),M.props=x,M.state=ot,M.context=xe,x=Ce):(typeof M.componentDidUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=1024),x=!1)}return x0(s,i,d,x,_,y)}function x0(s,i,d,x,y,_){Px(s,i);var M=(i.flags&128)!==0;if(!x&&!M)return y&&Ih(i,d,!1),Wa(s,i,_);x=i.stateNode,zk.current=i;var ie=M&&typeof d.getDerivedStateFromError!="function"?null:x.render();return i.flags|=1,s!==null&&M?(i.child=Lo(i,s.child,null,_),i.child=Lo(i,null,ie,_)):tn(s,i,ie,_),i.memoizedState=x.state,y&&Ih(i,d,!0),i.child}function Ox(s){var i=s.stateNode;i.pendingContext?zh(s,i.pendingContext,i.pendingContext!==i.context):i.context&&zh(s,i.context,!1),Zd(s,i.containerInfo)}function Rx(s,i,d,x,y){return Io(),Yd(y),i.flags|=256,tn(s,i,d,x),i.child}var m0={dehydrated:null,treeContext:null,retryLane:0};function g0(s){return{baseLanes:s,cachePool:null,transitions:null}}function zx(s,i,d){var x=i.pendingProps,y=cr.current,_=!1,M=(i.flags&128)!==0,ie;if((ie=M)||(ie=s!==null&&s.memoizedState===null?!1:(y&2)!==0),ie?(_=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(y|=1),er(cr,y&1),s===null)return Hd(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(M=x.children,s=x.fallback,_?(x=i.mode,_=i.child,M={mode:"hidden",children:M},(x&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=M):_=Wc(M,x,0,null),s=qs(s,x,d,null),_.return=i,s.return=i,_.sibling=s,i.child=_,i.child.memoizedState=g0(d),i.memoizedState=m0,s):v0(i,M));if(y=s.memoizedState,y!==null&&(ie=y.dehydrated,ie!==null))return Mk(s,i,M,x,ie,y,d);if(_){_=x.fallback,M=i.mode,y=s.child,ie=y.sibling;var xe={mode:"hidden",children:x.children};return(M&1)===0&&i.child!==y?(x=i.child,x.childLanes=0,x.pendingProps=xe,i.deletions=null):(x=ws(y,xe),x.subtreeFlags=y.subtreeFlags&14680064),ie!==null?_=ws(ie,_):(_=qs(_,M,d,null),_.flags|=2),_.return=i,x.return=i,x.sibling=_,i.child=x,x=_,_=i.child,M=s.child.memoizedState,M=M===null?g0(d):{baseLanes:M.baseLanes|d,cachePool:null,transitions:M.transitions},_.memoizedState=M,_.childLanes=s.childLanes&~d,i.memoizedState=m0,x}return _=s.child,s=_.sibling,x=ws(_,{mode:"visible",children:x.children}),(i.mode&1)===0&&(x.lanes=d),x.return=i,x.sibling=null,s!==null&&(d=i.deletions,d===null?(i.deletions=[s],i.flags|=16):d.push(s)),i.child=x,i.memoizedState=null,x}function v0(s,i){return i=Wc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Tc(s,i,d,x){return x!==null&&Yd(x),Lo(i,s.child,null,d),s=v0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Mk(s,i,d,x,y,_,M){if(d)return i.flags&256?(i.flags&=-257,x=f0(Error(t(422))),Tc(s,i,M,x)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(_=x.fallback,y=i.mode,x=Wc({mode:"visible",children:x.children},y,0,null),_=qs(_,y,M,null),_.flags|=2,x.return=i,_.return=i,x.sibling=_,i.child=x,(i.mode&1)!==0&&Lo(i,s.child,null,M),i.child.memoizedState=g0(M),i.memoizedState=m0,_);if((i.mode&1)===0)return Tc(s,i,M,null);if(y.data==="$!"){if(x=y.nextSibling&&y.nextSibling.dataset,x)var ie=x.dgst;return x=ie,_=Error(t(419)),x=f0(_,x,void 0),Tc(s,i,M,x)}if(ie=(M&s.childLanes)!==0,mn||ie){if(x=Ar,x!==null){switch(M&-M){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(x.suspendedLanes|M))!==0?0:y,y!==0&&y!==_.retryLane&&(_.retryLane=y,La(s,y),ea(x,s,y,-1))}return O0(),x=f0(Error(t(421))),Tc(s,i,M,x)}return y.data==="$?"?(i.flags|=128,i.child=s.child,i=Xk.bind(null,s),y._reactRetry=i,null):(s=_.treeContext,_n=cs(y.nextSibling),bn=i,or=!0,Xn=null,s!==null&&(Fn[jn++]=Ma,Fn[jn++]=Ia,Fn[jn++]=Us,Ma=s.id,Ia=s.overflow,Us=i),i=v0(i,x.children),i.flags|=4096,i)}function Mx(s,i,d){s.lanes|=i;var x=s.alternate;x!==null&&(x.lanes|=i),Qd(s.return,i,d)}function y0(s,i,d,x,y){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:x,tail:d,tailMode:y}:(_.isBackwards=i,_.rendering=null,_.renderingStartTime=0,_.last=x,_.tail=d,_.tailMode=y)}function Ix(s,i,d){var x=i.pendingProps,y=x.revealOrder,_=x.tail;if(tn(s,i,x.children,d),x=cr.current,(x&2)!==0)x=x&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Mx(s,d,i);else if(s.tag===19)Mx(s,d,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}if(er(cr,x),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(d=i.child,y=null;d!==null;)s=d.alternate,s!==null&&kc(s)===null&&(y=d),d=d.sibling;d=y,d===null?(y=i.child,i.child=null):(y=d.sibling,d.sibling=null),y0(i,!1,y,d,_);break;case"backwards":for(d=null,y=i.child,i.child=null;y!==null;){if(s=y.alternate,s!==null&&kc(s)===null){i.child=y;break}s=y.sibling,y.sibling=d,d=y,y=s}y0(i,!0,d,null,_);break;case"together":y0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Dc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Wa(s,i,d){if(s!==null&&(i.dependencies=s.dependencies),Ks|=i.lanes,(d&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,d=ws(s,s.pendingProps),i.child=d,d.return=i;s.sibling!==null;)s=s.sibling,d=d.sibling=ws(s,s.pendingProps),d.return=i;d.sibling=null}return i.child}function Ik(s,i,d){switch(i.tag){case 3:Ox(i),Io();break;case 5:Zh(i);break;case 1:xn(i.type)&&dc(i);break;case 4:Zd(i,i.stateNode.containerInfo);break;case 10:var x=i.type._context,y=i.memoizedProps.value;er(gc,x._currentValue),x._currentValue=y;break;case 13:if(x=i.memoizedState,x!==null)return x.dehydrated!==null?(er(cr,cr.current&1),i.flags|=128,null):(d&i.child.childLanes)!==0?zx(s,i,d):(er(cr,cr.current&1),s=Wa(s,i,d),s!==null?s.sibling:null);er(cr,cr.current&1);break;case 19:if(x=(d&i.childLanes)!==0,(s.flags&128)!==0){if(x)return Ix(s,i,d);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),er(cr,cr.current),x)break;return null;case 22:case 23:return i.lanes=0,jx(s,i,d)}return Wa(s,i,d)}var Lx,w0,Bx,Wx;Lx=function(s,i){for(var d=i.child;d!==null;){if(d.tag===5||d.tag===6)s.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break;for(;d.sibling===null;){if(d.return===null||d.return===i)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},w0=function(){},Bx=function(s,i,d,x){var y=s.memoizedProps;if(y!==x){s=i.stateNode,Ys(pa.current);var _=null;switch(d){case"input":y=je(s,y),x=je(s,x),_=[];break;case"select":y=re({},y,{value:void 0}),x=re({},x,{value:void 0}),_=[];break;case"textarea":y=ft(s,y),x=ft(s,x),_=[];break;default:typeof y.onClick!="function"&&typeof x.onClick=="function"&&(s.onclick=lc)}ve(d,x);var M;d=null;for(Ce in y)if(!x.hasOwnProperty(Ce)&&y.hasOwnProperty(Ce)&&y[Ce]!=null)if(Ce==="style"){var ie=y[Ce];for(M in ie)ie.hasOwnProperty(M)&&(d||(d={}),d[M]="")}else Ce!=="dangerouslySetInnerHTML"&&Ce!=="children"&&Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&Ce!=="autoFocus"&&(a.hasOwnProperty(Ce)?_||(_=[]):(_=_||[]).push(Ce,null));for(Ce in x){var xe=x[Ce];if(ie=y?.[Ce],x.hasOwnProperty(Ce)&&xe!==ie&&(xe!=null||ie!=null))if(Ce==="style")if(ie){for(M in ie)!ie.hasOwnProperty(M)||xe&&xe.hasOwnProperty(M)||(d||(d={}),d[M]="");for(M in xe)xe.hasOwnProperty(M)&&ie[M]!==xe[M]&&(d||(d={}),d[M]=xe[M])}else d||(_||(_=[]),_.push(Ce,d)),d=xe;else Ce==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,ie=ie?ie.__html:void 0,xe!=null&&ie!==xe&&(_=_||[]).push(Ce,xe)):Ce==="children"?typeof xe!="string"&&typeof xe!="number"||(_=_||[]).push(Ce,""+xe):Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ce)?(xe!=null&&Ce==="onScroll"&&nr("scroll",s),_||ie===xe||(_=[])):(_=_||[]).push(Ce,xe))}d&&(_=_||[]).push("style",d);var Ce=_;(i.updateQueue=Ce)&&(i.flags|=4)}},Wx=function(s,i,d,x){d!==x&&(i.flags|=4)};function Gi(s,i){if(!or)switch(s.tailMode){case"hidden":i=s.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Vr(s){var i=s.alternate!==null&&s.alternate.child===s.child,d=0,x=0;if(i)for(var y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags&14680064,x|=y.flags&14680064,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags,x|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=x,s.childLanes=d,i}function Lk(s,i,d){var x=i.pendingProps;switch(Ud(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(i),null;case 1:return xn(i.type)&&uc(),Vr(i),null;case 3:return x=i.stateNode,Uo(),ar(hn),ar(Hr),t0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(s===null||s.child===null)&&(xc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Xn!==null&&(j0(Xn),Xn=null))),w0(s,i),Vr(i),null;case 5:Jd(i);var y=Ys($i.current);if(d=i.type,s!==null&&i.stateNode!=null)Bx(s,i,d,x,y),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!x){if(i.stateNode===null)throw Error(t(166));return Vr(i),null}if(s=Ys(pa.current),xc(i)){x=i.stateNode,d=i.type;var _=i.memoizedProps;switch(x[fa]=i,x[Ii]=_,s=(i.mode&1)!==0,d){case"dialog":nr("cancel",x),nr("close",x);break;case"iframe":case"object":case"embed":nr("load",x);break;case"video":case"audio":for(y=0;y<Ri.length;y++)nr(Ri[y],x);break;case"source":nr("error",x);break;case"img":case"image":case"link":nr("error",x),nr("load",x);break;case"details":nr("toggle",x);break;case"input":Ke(x,_),nr("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!_.multiple},nr("invalid",x);break;case"textarea":ut(x,_),nr("invalid",x)}ve(d,_),y=null;for(var M in _)if(_.hasOwnProperty(M)){var ie=_[M];M==="children"?typeof ie=="string"?x.textContent!==ie&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,ie,s),y=["children",ie]):typeof ie=="number"&&x.textContent!==""+ie&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,ie,s),y=["children",""+ie]):a.hasOwnProperty(M)&&ie!=null&&M==="onScroll"&&nr("scroll",x)}switch(d){case"input":se(x),Ne(x,_,!0);break;case"textarea":se(x),Ot(x);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(x.onclick=lc)}x=y,i.updateQueue=x,x!==null&&(i.flags|=4)}else{M=y.nodeType===9?y:y.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Yt(d)),s==="http://www.w3.org/1999/xhtml"?d==="script"?(s=M.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof x.is=="string"?s=M.createElement(d,{is:x.is}):(s=M.createElement(d),d==="select"&&(M=s,x.multiple?M.multiple=!0:x.size&&(M.size=x.size))):s=M.createElementNS(s,d),s[fa]=i,s[Ii]=x,Lx(s,i,!1,!1),i.stateNode=s;e:{switch(M=qe(d,x),d){case"dialog":nr("cancel",s),nr("close",s),y=x;break;case"iframe":case"object":case"embed":nr("load",s),y=x;break;case"video":case"audio":for(y=0;y<Ri.length;y++)nr(Ri[y],s);y=x;break;case"source":nr("error",s),y=x;break;case"img":case"image":case"link":nr("error",s),nr("load",s),y=x;break;case"details":nr("toggle",s),y=x;break;case"input":Ke(s,x),y=je(s,x),nr("invalid",s);break;case"option":y=x;break;case"select":s._wrapperState={wasMultiple:!!x.multiple},y=re({},x,{value:void 0}),nr("invalid",s);break;case"textarea":ut(s,x),y=ft(s,x),nr("invalid",s);break;default:y=x}ve(d,y),ie=y;for(_ in ie)if(ie.hasOwnProperty(_)){var xe=ie[_];_==="style"?Zt(s,xe):_==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,xe!=null&&Xt(s,xe)):_==="children"?typeof xe=="string"?(d!=="textarea"||xe!=="")&&dt(s,xe):typeof xe=="number"&&dt(s,""+xe):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(a.hasOwnProperty(_)?xe!=null&&_==="onScroll"&&nr("scroll",s):xe!=null&&E(s,_,xe,M))}switch(d){case"input":se(s),Ne(s,x,!1);break;case"textarea":se(s),Ot(s);break;case"option":x.value!=null&&s.setAttribute("value",""+W(x.value));break;case"select":s.multiple=!!x.multiple,_=x.value,_!=null?Je(s,!!x.multiple,_,!1):x.defaultValue!=null&&Je(s,!!x.multiple,x.defaultValue,!0);break;default:typeof y.onClick=="function"&&(s.onclick=lc)}switch(d){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Vr(i),null;case 6:if(s&&i.stateNode!=null)Wx(s,i,s.memoizedProps,x);else{if(typeof x!="string"&&i.stateNode===null)throw Error(t(166));if(d=Ys($i.current),Ys(pa.current),xc(i)){if(x=i.stateNode,d=i.memoizedProps,x[fa]=i,(_=x.nodeValue!==d)&&(s=bn,s!==null))switch(s.tag){case 3:ic(x.nodeValue,d,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ic(x.nodeValue,d,(s.mode&1)!==0)}_&&(i.flags|=4)}else x=(d.nodeType===9?d:d.ownerDocument).createTextNode(x),x[fa]=i,i.stateNode=x}return Vr(i),null;case 13:if(ar(cr),x=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(or&&_n!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Hh(),Io(),i.flags|=98560,_=!1;else if(_=xc(i),x!==null&&x.dehydrated!==null){if(s===null){if(!_)throw Error(t(318));if(_=i.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[fa]=i}else Io(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Vr(i),_=!1}else Xn!==null&&(j0(Xn),Xn=null),_=!0;if(!_)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=d,i):(x=x!==null,x!==(s!==null&&s.memoizedState!==null)&&x&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(cr.current&1)!==0?Cr===0&&(Cr=3):O0())),i.updateQueue!==null&&(i.flags|=4),Vr(i),null);case 4:return Uo(),w0(s,i),s===null&&zi(i.stateNode.containerInfo),Vr(i),null;case 10:return Gd(i.type._context),Vr(i),null;case 17:return xn(i.type)&&uc(),Vr(i),null;case 19:if(ar(cr),_=i.memoizedState,_===null)return Vr(i),null;if(x=(i.flags&128)!==0,M=_.rendering,M===null)if(x)Gi(_,!1);else{if(Cr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(M=kc(s),M!==null){for(i.flags|=128,Gi(_,!1),x=M.updateQueue,x!==null&&(i.updateQueue=x,i.flags|=4),i.subtreeFlags=0,x=d,d=i.child;d!==null;)_=d,s=x,_.flags&=14680066,M=_.alternate,M===null?(_.childLanes=0,_.lanes=s,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=M.childLanes,_.lanes=M.lanes,_.child=M.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=M.memoizedProps,_.memoizedState=M.memoizedState,_.updateQueue=M.updateQueue,_.type=M.type,s=M.dependencies,_.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),d=d.sibling;return er(cr,cr.current&1|2),i.child}s=s.sibling}_.tail!==null&&Ye()>Vo&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304)}else{if(!x)if(s=kc(M),s!==null){if(i.flags|=128,x=!0,d=s.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),Gi(_,!0),_.tail===null&&_.tailMode==="hidden"&&!M.alternate&&!or)return Vr(i),null}else 2*Ye()-_.renderingStartTime>Vo&&d!==1073741824&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304);_.isBackwards?(M.sibling=i.child,i.child=M):(d=_.last,d!==null?d.sibling=M:i.child=M,_.last=M)}return _.tail!==null?(i=_.tail,_.rendering=i,_.tail=i.sibling,_.renderingStartTime=Ye(),i.sibling=null,d=cr.current,er(cr,x?d&1|2:d&1),i):(Vr(i),null);case 22:case 23:return A0(),x=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==x&&(i.flags|=8192),x&&(i.mode&1)!==0?(Sn&1073741824)!==0&&(Vr(i),i.subtreeFlags&6&&(i.flags|=8192)):Vr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Bk(s,i){switch(Ud(i),i.tag){case 1:return xn(i.type)&&uc(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Uo(),ar(hn),ar(Hr),t0(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Jd(i),null;case 13:if(ar(cr),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Io()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return ar(cr),null;case 4:return Uo(),null;case 10:return Gd(i.type._context),null;case 22:case 23:return A0(),null;case 24:return null;default:return null}}var Fc=!1,Kr=!1,Wk=typeof WeakSet=="function"?WeakSet:Set,st=null;function Ho(s,i){var d=s.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(x){fr(s,i,x)}else d.current=null}function k0(s,i,d){try{d()}catch(x){fr(s,i,x)}}var Ux=!1;function Uk(s,i){if(Ad=Xl,s=wh(),Ed(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var x=d.getSelection&&d.getSelection();if(x&&x.rangeCount!==0){d=x.anchorNode;var y=x.anchorOffset,_=x.focusNode;x=x.focusOffset;try{d.nodeType,_.nodeType}catch{d=null;break e}var M=0,ie=-1,xe=-1,Ce=0,Le=0,Ve=s,Ie=null;t:for(;;){for(var at;Ve!==d||y!==0&&Ve.nodeType!==3||(ie=M+y),Ve!==_||x!==0&&Ve.nodeType!==3||(xe=M+x),Ve.nodeType===3&&(M+=Ve.nodeValue.length),(at=Ve.firstChild)!==null;)Ie=Ve,Ve=at;for(;;){if(Ve===s)break t;if(Ie===d&&++Ce===y&&(ie=M),Ie===_&&++Le===x&&(xe=M),(at=Ve.nextSibling)!==null)break;Ve=Ie,Ie=Ve.parentNode}Ve=at}d=ie===-1||xe===-1?null:{start:ie,end:xe}}else d=null}d=d||{start:0,end:0}}else d=null;for(Od={focusedElem:s,selectionRange:d},Xl=!1,st=i;st!==null;)if(i=st,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,st=s;else for(;st!==null;){i=st;try{var ot=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ot!==null){var it=ot.memoizedProps,vr=ot.memoizedState,ye=i.stateNode,ge=ye.getSnapshotBeforeUpdate(i.elementType===i.type?it:qn(i.type,it),vr);ye.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var be=i.stateNode.containerInfo;be.nodeType===1?be.textContent="":be.nodeType===9&&be.documentElement&&be.removeChild(be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Xe){fr(i,i.return,Xe)}if(s=i.sibling,s!==null){s.return=i.return,st=s;break}st=i.return}return ot=Ux,Ux=!1,ot}function Qi(s,i,d){var x=i.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var y=x=x.next;do{if((y.tag&s)===s){var _=y.destroy;y.destroy=void 0,_!==void 0&&k0(i,d,_)}y=y.next}while(y!==x)}}function jc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var d=i=i.next;do{if((d.tag&s)===s){var x=d.create;d.destroy=x()}d=d.next}while(d!==i)}}function b0(s){var i=s.ref;if(i!==null){var d=s.stateNode;switch(s.tag){case 5:s=d;break;default:s=d}typeof i=="function"?i(s):i.current=s}}function $x(s){var i=s.alternate;i!==null&&(s.alternate=null,$x(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[fa],delete i[Ii],delete i[Id],delete i[Sk],delete i[Ek])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Hx(s){return s.tag===5||s.tag===3||s.tag===4}function Yx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Hx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.nodeType===8?d.parentNode.insertBefore(s,i):d.insertBefore(s,i):(d.nodeType===8?(i=d.parentNode,i.insertBefore(s,d)):(i=d,i.appendChild(s)),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=lc));else if(x!==4&&(s=s.child,s!==null))for(_0(s,i,d),s=s.sibling;s!==null;)_0(s,i,d),s=s.sibling}function S0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.insertBefore(s,i):d.appendChild(s);else if(x!==4&&(s=s.child,s!==null))for(S0(s,i,d),s=s.sibling;s!==null;)S0(s,i,d),s=s.sibling}var Ir=null,Zn=!1;function xs(s,i,d){for(d=d.child;d!==null;)Vx(s,i,d),d=d.sibling}function Vx(s,i,d){if(jr&&typeof jr.onCommitFiberUnmount=="function")try{jr.onCommitFiberUnmount(da,d)}catch{}switch(d.tag){case 5:Kr||Ho(d,i);case 6:var x=Ir,y=Zn;Ir=null,xs(s,i,d),Ir=x,Zn=y,Ir!==null&&(Zn?(s=Ir,d=d.stateNode,s.nodeType===8?s.parentNode.removeChild(d):s.removeChild(d)):Ir.removeChild(d.stateNode));break;case 18:Ir!==null&&(Zn?(s=Ir,d=d.stateNode,s.nodeType===8?Md(s.parentNode,d):s.nodeType===1&&Md(s,d),Ci(s)):Md(Ir,d.stateNode));break;case 4:x=Ir,y=Zn,Ir=d.stateNode.containerInfo,Zn=!0,xs(s,i,d),Ir=x,Zn=y;break;case 0:case 11:case 14:case 15:if(!Kr&&(x=d.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){y=x=x.next;do{var _=y,M=_.destroy;_=_.tag,M!==void 0&&((_&2)!==0||(_&4)!==0)&&k0(d,i,M),y=y.next}while(y!==x)}xs(s,i,d);break;case 1:if(!Kr&&(Ho(d,i),x=d.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=d.memoizedProps,x.state=d.memoizedState,x.componentWillUnmount()}catch(ie){fr(d,i,ie)}xs(s,i,d);break;case 21:xs(s,i,d);break;case 22:d.mode&1?(Kr=(x=Kr)||d.memoizedState!==null,xs(s,i,d),Kr=x):xs(s,i,d);break;default:xs(s,i,d)}}function Kx(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var d=s.stateNode;d===null&&(d=s.stateNode=new Wk),i.forEach(function(x){var y=qk.bind(null,s,x);d.has(x)||(d.add(x),x.then(y,y))})}}function Jn(s,i){var d=i.deletions;if(d!==null)for(var x=0;x<d.length;x++){var y=d[x];try{var _=s,M=i,ie=M;e:for(;ie!==null;){switch(ie.tag){case 5:Ir=ie.stateNode,Zn=!1;break e;case 3:Ir=ie.stateNode.containerInfo,Zn=!0;break e;case 4:Ir=ie.stateNode.containerInfo,Zn=!0;break e}ie=ie.return}if(Ir===null)throw Error(t(160));Vx(_,M,y),Ir=null,Zn=!1;var xe=y.alternate;xe!==null&&(xe.return=null),y.return=null}catch(Ce){fr(y,i,Ce)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Gx(i,s),i=i.sibling}function Gx(s,i){var d=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Jn(i,s),xa(s),x&4){try{Qi(3,s,s.return),jc(3,s)}catch(it){fr(s,s.return,it)}try{Qi(5,s,s.return)}catch(it){fr(s,s.return,it)}}break;case 1:Jn(i,s),xa(s),x&512&&d!==null&&Ho(d,d.return);break;case 5:if(Jn(i,s),xa(s),x&512&&d!==null&&Ho(d,d.return),s.flags&32){var y=s.stateNode;try{dt(y,"")}catch(it){fr(s,s.return,it)}}if(x&4&&(y=s.stateNode,y!=null)){var _=s.memoizedProps,M=d!==null?d.memoizedProps:_,ie=s.type,xe=s.updateQueue;if(s.updateQueue=null,xe!==null)try{ie==="input"&&_.type==="radio"&&_.name!=null&&Qe(y,_),qe(ie,M);var Ce=qe(ie,_);for(M=0;M<xe.length;M+=2){var Le=xe[M],Ve=xe[M+1];Le==="style"?Zt(y,Ve):Le==="dangerouslySetInnerHTML"?Xt(y,Ve):Le==="children"?dt(y,Ve):E(y,Le,Ve,Ce)}switch(ie){case"input":he(y,_);break;case"textarea":ht(y,_);break;case"select":var Ie=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!_.multiple;var at=_.value;at!=null?Je(y,!!_.multiple,at,!1):Ie!==!!_.multiple&&(_.defaultValue!=null?Je(y,!!_.multiple,_.defaultValue,!0):Je(y,!!_.multiple,_.multiple?[]:"",!1))}y[Ii]=_}catch(it){fr(s,s.return,it)}}break;case 6:if(Jn(i,s),xa(s),x&4){if(s.stateNode===null)throw Error(t(162));y=s.stateNode,_=s.memoizedProps;try{y.nodeValue=_}catch(it){fr(s,s.return,it)}}break;case 3:if(Jn(i,s),xa(s),x&4&&d!==null&&d.memoizedState.isDehydrated)try{Ci(i.containerInfo)}catch(it){fr(s,s.return,it)}break;case 4:Jn(i,s),xa(s);break;case 13:Jn(i,s),xa(s),y=s.child,y.flags&8192&&(_=y.memoizedState!==null,y.stateNode.isHidden=_,!_||y.alternate!==null&&y.alternate.memoizedState!==null||(C0=Ye())),x&4&&Kx(s);break;case 22:if(Le=d!==null&&d.memoizedState!==null,s.mode&1?(Kr=(Ce=Kr)||Le,Jn(i,s),Kr=Ce):Jn(i,s),xa(s),x&8192){if(Ce=s.memoizedState!==null,(s.stateNode.isHidden=Ce)&&!Le&&(s.mode&1)!==0)for(st=s,Le=s.child;Le!==null;){for(Ve=st=Le;st!==null;){switch(Ie=st,at=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:Qi(4,Ie,Ie.return);break;case 1:Ho(Ie,Ie.return);var ot=Ie.stateNode;if(typeof ot.componentWillUnmount=="function"){x=Ie,d=Ie.return;try{i=x,ot.props=i.memoizedProps,ot.state=i.memoizedState,ot.componentWillUnmount()}catch(it){fr(x,d,it)}}break;case 5:Ho(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){qx(Ve);continue}}at!==null?(at.return=Ie,st=at):qx(Ve)}Le=Le.sibling}e:for(Le=null,Ve=s;;){if(Ve.tag===5){if(Le===null){Le=Ve;try{y=Ve.stateNode,Ce?(_=y.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(ie=Ve.stateNode,xe=Ve.memoizedProps.style,M=xe!=null&&xe.hasOwnProperty("display")?xe.display:null,ie.style.display=Tt("display",M))}catch(it){fr(s,s.return,it)}}}else if(Ve.tag===6){if(Le===null)try{Ve.stateNode.nodeValue=Ce?"":Ve.memoizedProps}catch(it){fr(s,s.return,it)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===s)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===s)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===s)break e;Le===Ve&&(Le=null),Ve=Ve.return}Le===Ve&&(Le=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:Jn(i,s),xa(s),x&4&&Kx(s);break;case 21:break;default:Jn(i,s),xa(s)}}function xa(s){var i=s.flags;if(i&2){try{e:{for(var d=s.return;d!==null;){if(Hx(d)){var x=d;break e}d=d.return}throw Error(t(160))}switch(x.tag){case 5:var y=x.stateNode;x.flags&32&&(dt(y,""),x.flags&=-33);var _=Yx(s);S0(s,_,y);break;case 3:case 4:var M=x.stateNode.containerInfo,ie=Yx(s);_0(s,ie,M);break;default:throw Error(t(161))}}catch(xe){fr(s,s.return,xe)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function $k(s,i,d){st=s,Qx(s)}function Qx(s,i,d){for(var x=(s.mode&1)!==0;st!==null;){var y=st,_=y.child;if(y.tag===22&&x){var M=y.memoizedState!==null||Fc;if(!M){var ie=y.alternate,xe=ie!==null&&ie.memoizedState!==null||Kr;ie=Fc;var Ce=Kr;if(Fc=M,(Kr=xe)&&!Ce)for(st=y;st!==null;)M=st,xe=M.child,M.tag===22&&M.memoizedState!==null?Zx(y):xe!==null?(xe.return=M,st=xe):Zx(y);for(;_!==null;)st=_,Qx(_),_=_.sibling;st=y,Fc=ie,Kr=Ce}Xx(s)}else(y.subtreeFlags&8772)!==0&&_!==null?(_.return=y,st=_):Xx(s)}}function Xx(s){for(;st!==null;){var i=st;if((i.flags&8772)!==0){var d=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Kr||jc(5,i);break;case 1:var x=i.stateNode;if(i.flags&4&&!Kr)if(d===null)x.componentDidMount();else{var y=i.elementType===i.type?d.memoizedProps:qn(i.type,d.memoizedProps);x.componentDidUpdate(y,d.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var _=i.updateQueue;_!==null&&qh(i,_,x);break;case 3:var M=i.updateQueue;if(M!==null){if(d=null,i.child!==null)switch(i.child.tag){case 5:d=i.child.stateNode;break;case 1:d=i.child.stateNode}qh(i,M,d)}break;case 5:var ie=i.stateNode;if(d===null&&i.flags&4){d=ie;var xe=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":xe.autoFocus&&d.focus();break;case"img":xe.src&&(d.src=xe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Ce=i.alternate;if(Ce!==null){var Le=Ce.memoizedState;if(Le!==null){var Ve=Le.dehydrated;Ve!==null&&Ci(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kr||i.flags&512&&b0(i)}catch(Ie){fr(i,i.return,Ie)}}if(i===s){st=null;break}if(d=i.sibling,d!==null){d.return=i.return,st=d;break}st=i.return}}function qx(s){for(;st!==null;){var i=st;if(i===s){st=null;break}var d=i.sibling;if(d!==null){d.return=i.return,st=d;break}st=i.return}}function Zx(s){for(;st!==null;){var i=st;try{switch(i.tag){case 0:case 11:case 15:var d=i.return;try{jc(4,i)}catch(xe){fr(i,d,xe)}break;case 1:var x=i.stateNode;if(typeof x.componentDidMount=="function"){var y=i.return;try{x.componentDidMount()}catch(xe){fr(i,y,xe)}}var _=i.return;try{b0(i)}catch(xe){fr(i,_,xe)}break;case 5:var M=i.return;try{b0(i)}catch(xe){fr(i,M,xe)}}}catch(xe){fr(i,i.return,xe)}if(i===s){st=null;break}var ie=i.sibling;if(ie!==null){ie.return=i.return,st=ie;break}st=i.return}}var Hk=Math.ceil,Pc=Y.ReactCurrentDispatcher,E0=Y.ReactCurrentOwner,On=Y.ReactCurrentBatchConfig,Rt=0,Ar=null,br=null,Lr=0,Sn=0,Yo=us(0),Cr=0,Xi=null,Ks=0,Ac=0,N0=0,qi=null,gn=null,C0=0,Vo=1/0,Ua=null,Oc=!1,T0=null,ms=null,Rc=!1,gs=null,zc=0,Zi=0,D0=null,Mc=-1,Ic=0;function rn(){return(Rt&6)!==0?Ye():Mc!==-1?Mc:Mc=Ye()}function vs(s){return(s.mode&1)===0?1:(Rt&2)!==0&&Lr!==0?Lr&-Lr:Ck.transition!==null?(Ic===0&&(Ic=Yp()),Ic):(s=Kt,s!==0||(s=window.event,s=s===void 0?16:eh(s.type)),s)}function ea(s,i,d,x){if(50<Zi)throw Zi=0,D0=null,Error(t(185));bi(s,d,x),((Rt&2)===0||s!==Ar)&&(s===Ar&&((Rt&2)===0&&(Ac|=d),Cr===4&&ys(s,Lr)),vn(s,x),d===1&&Rt===0&&(i.mode&1)===0&&(Vo=Ye()+500,fc&&fs()))}function vn(s,i){var d=s.callbackNode;Cw(s,i);var x=Kl(s,s===Ar?Lr:0);if(x===0)d!==null&&Ze(d),s.callbackNode=null,s.callbackPriority=0;else if(i=x&-x,s.callbackPriority!==i){if(d!=null&&Ze(d),i===1)s.tag===0?Nk(em.bind(null,s)):Lh(em.bind(null,s)),bk(function(){(Rt&6)===0&&fs()}),d=null;else{switch(Vp(x)){case 1:d=Vt;break;case 4:d=$t;break;case 16:d=mr;break;case 536870912:d=rs;break;default:d=mr}d=lm(d,Jx.bind(null,s))}s.callbackPriority=i,s.callbackNode=d}}function Jx(s,i){if(Mc=-1,Ic=0,(Rt&6)!==0)throw Error(t(327));var d=s.callbackNode;if(Ko()&&s.callbackNode!==d)return null;var x=Kl(s,s===Ar?Lr:0);if(x===0)return null;if((x&30)!==0||(x&s.expiredLanes)!==0||i)i=Lc(s,x);else{i=x;var y=Rt;Rt|=2;var _=rm();(Ar!==s||Lr!==i)&&(Ua=null,Vo=Ye()+500,Qs(s,i));do try{Kk();break}catch(ie){tm(s,ie)}while(!0);Kd(),Pc.current=_,Rt=y,br!==null?i=0:(Ar=null,Lr=0,i=Cr)}if(i!==0){if(i===2&&(y=cd(s),y!==0&&(x=y,i=F0(s,y))),i===1)throw d=Xi,Qs(s,0),ys(s,x),vn(s,Ye()),d;if(i===6)ys(s,x);else{if(y=s.current.alternate,(x&30)===0&&!Yk(y)&&(i=Lc(s,x),i===2&&(_=cd(s),_!==0&&(x=_,i=F0(s,_))),i===1))throw d=Xi,Qs(s,0),ys(s,x),vn(s,Ye()),d;switch(s.finishedWork=y,s.finishedLanes=x,i){case 0:case 1:throw Error(t(345));case 2:Xs(s,gn,Ua);break;case 3:if(ys(s,x),(x&130023424)===x&&(i=C0+500-Ye(),10<i)){if(Kl(s,0)!==0)break;if(y=s.suspendedLanes,(y&x)!==x){rn(),s.pingedLanes|=s.suspendedLanes&y;break}s.timeoutHandle=zd(Xs.bind(null,s,gn,Ua),i);break}Xs(s,gn,Ua);break;case 4:if(ys(s,x),(x&4194240)===x)break;for(i=s.eventTimes,y=-1;0<x;){var M=31-gr(x);_=1<<M,M=i[M],M>y&&(y=M),x&=~_}if(x=y,x=Ye()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*Hk(x/1960))-x,10<x){s.timeoutHandle=zd(Xs.bind(null,s,gn,Ua),x);break}Xs(s,gn,Ua);break;case 5:Xs(s,gn,Ua);break;default:throw Error(t(329))}}}return vn(s,Ye()),s.callbackNode===d?Jx.bind(null,s):null}function F0(s,i){var d=qi;return s.current.memoizedState.isDehydrated&&(Qs(s,i).flags|=256),s=Lc(s,i),s!==2&&(i=gn,gn=d,i!==null&&j0(i)),s}function j0(s){gn===null?gn=s:gn.push.apply(gn,s)}function Yk(s){for(var i=s;;){if(i.flags&16384){var d=i.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var x=0;x<d.length;x++){var y=d[x],_=y.getSnapshot;y=y.value;try{if(!Qn(_(),y))return!1}catch{return!1}}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ys(s,i){for(i&=~N0,i&=~Ac,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var d=31-gr(i),x=1<<d;s[d]=-1,i&=~x}}function em(s){if((Rt&6)!==0)throw Error(t(327));Ko();var i=Kl(s,0);if((i&1)===0)return vn(s,Ye()),null;var d=Lc(s,i);if(s.tag!==0&&d===2){var x=cd(s);x!==0&&(i=x,d=F0(s,x))}if(d===1)throw d=Xi,Qs(s,0),ys(s,i),vn(s,Ye()),d;if(d===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Xs(s,gn,Ua),vn(s,Ye()),null}function P0(s,i){var d=Rt;Rt|=1;try{return s(i)}finally{Rt=d,Rt===0&&(Vo=Ye()+500,fc&&fs())}}function Gs(s){gs!==null&&gs.tag===0&&(Rt&6)===0&&Ko();var i=Rt;Rt|=1;var d=On.transition,x=Kt;try{if(On.transition=null,Kt=1,s)return s()}finally{Kt=x,On.transition=d,Rt=i,(Rt&6)===0&&fs()}}function A0(){Sn=Yo.current,ar(Yo)}function Qs(s,i){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;if(d!==-1&&(s.timeoutHandle=-1,kk(d)),br!==null)for(d=br.return;d!==null;){var x=d;switch(Ud(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&uc();break;case 3:Uo(),ar(hn),ar(Hr),t0();break;case 5:Jd(x);break;case 4:Uo();break;case 13:ar(cr);break;case 19:ar(cr);break;case 10:Gd(x.type._context);break;case 22:case 23:A0()}d=d.return}if(Ar=s,br=s=ws(s.current,null),Lr=Sn=i,Cr=0,Xi=null,N0=Ac=Ks=0,gn=qi=null,Hs!==null){for(i=0;i<Hs.length;i++)if(d=Hs[i],x=d.interleaved,x!==null){d.interleaved=null;var y=x.next,_=d.pending;if(_!==null){var M=_.next;_.next=y,x.next=M}d.pending=x}Hs=null}return s}function tm(s,i){do{var d=br;try{if(Kd(),bc.current=Nc,_c){for(var x=ur.memoizedState;x!==null;){var y=x.queue;y!==null&&(y.pending=null),x=x.next}_c=!1}if(Vs=0,Pr=Nr=ur=null,Hi=!1,Yi=0,E0.current=null,d===null||d.return===null){Cr=1,Xi=i,br=null;break}e:{var _=s,M=d.return,ie=d,xe=i;if(i=Lr,ie.flags|=32768,xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var Ce=xe,Le=ie,Ve=Le.tag;if((Le.mode&1)===0&&(Ve===0||Ve===11||Ve===15)){var Ie=Le.alternate;Ie?(Le.updateQueue=Ie.updateQueue,Le.memoizedState=Ie.memoizedState,Le.lanes=Ie.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var at=Nx(M);if(at!==null){at.flags&=-257,Cx(at,M,ie,_,i),at.mode&1&&Ex(_,Ce,i),i=at,xe=Ce;var ot=i.updateQueue;if(ot===null){var it=new Set;it.add(xe),i.updateQueue=it}else ot.add(xe);break e}else{if((i&1)===0){Ex(_,Ce,i),O0();break e}xe=Error(t(426))}}else if(or&&ie.mode&1){var vr=Nx(M);if(vr!==null){(vr.flags&65536)===0&&(vr.flags|=256),Cx(vr,M,ie,_,i),Yd($o(xe,ie));break e}}_=xe=$o(xe,ie),Cr!==4&&(Cr=2),qi===null?qi=[_]:qi.push(_),_=M;do{switch(_.tag){case 3:_.flags|=65536,i&=-i,_.lanes|=i;var ye=_x(_,xe,i);Xh(_,ye);break e;case 1:ie=xe;var ge=_.type,be=_.stateNode;if((_.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||be!==null&&typeof be.componentDidCatch=="function"&&(ms===null||!ms.has(be)))){_.flags|=65536,i&=-i,_.lanes|=i;var Xe=Sx(_,ie,i);Xh(_,Xe);break e}}_=_.return}while(_!==null)}am(d)}catch(lt){i=lt,br===d&&d!==null&&(br=d=d.return);continue}break}while(!0)}function rm(){var s=Pc.current;return Pc.current=Nc,s===null?Nc:s}function O0(){(Cr===0||Cr===3||Cr===2)&&(Cr=4),Ar===null||(Ks&268435455)===0&&(Ac&268435455)===0||ys(Ar,Lr)}function Lc(s,i){var d=Rt;Rt|=2;var x=rm();(Ar!==s||Lr!==i)&&(Ua=null,Qs(s,i));do try{Vk();break}catch(y){tm(s,y)}while(!0);if(Kd(),Rt=d,Pc.current=x,br!==null)throw Error(t(261));return Ar=null,Lr=0,Cr}function Vk(){for(;br!==null;)nm(br)}function Kk(){for(;br!==null&&!Ue();)nm(br)}function nm(s){var i=im(s.alternate,s,Sn);s.memoizedProps=s.pendingProps,i===null?am(s):br=i,E0.current=null}function am(s){var i=s;do{var d=i.alternate;if(s=i.return,(i.flags&32768)===0){if(d=Lk(d,i,Sn),d!==null){br=d;return}}else{if(d=Bk(d,i),d!==null){d.flags&=32767,br=d;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Cr=6,br=null;return}}if(i=i.sibling,i!==null){br=i;return}br=i=s}while(i!==null);Cr===0&&(Cr=5)}function Xs(s,i,d){var x=Kt,y=On.transition;try{On.transition=null,Kt=1,Gk(s,i,d,x)}finally{On.transition=y,Kt=x}return null}function Gk(s,i,d,x){do Ko();while(gs!==null);if((Rt&6)!==0)throw Error(t(327));d=s.finishedWork;var y=s.finishedLanes;if(d===null)return null;if(s.finishedWork=null,s.finishedLanes=0,d===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var _=d.lanes|d.childLanes;if(Tw(s,_),s===Ar&&(br=Ar=null,Lr=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Rc||(Rc=!0,lm(mr,function(){return Ko(),null})),_=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||_){_=On.transition,On.transition=null;var M=Kt;Kt=1;var ie=Rt;Rt|=4,E0.current=null,Uk(s,d),Gx(d,s),hk(Od),Xl=!!Ad,Od=Ad=null,s.current=d,$k(d),$e(),Rt=ie,Kt=M,On.transition=_}else s.current=d;if(Rc&&(Rc=!1,gs=s,zc=y),_=s.pendingLanes,_===0&&(ms=null),wi(d.stateNode),vn(s,Ye()),i!==null)for(x=s.onRecoverableError,d=0;d<i.length;d++)y=i[d],x(y.value,{componentStack:y.stack,digest:y.digest});if(Oc)throw Oc=!1,s=T0,T0=null,s;return(zc&1)!==0&&s.tag!==0&&Ko(),_=s.pendingLanes,(_&1)!==0?s===D0?Zi++:(Zi=0,D0=s):Zi=0,fs(),null}function Ko(){if(gs!==null){var s=Vp(zc),i=On.transition,d=Kt;try{if(On.transition=null,Kt=16>s?16:s,gs===null)var x=!1;else{if(s=gs,gs=null,zc=0,(Rt&6)!==0)throw Error(t(331));var y=Rt;for(Rt|=4,st=s.current;st!==null;){var _=st,M=_.child;if((st.flags&16)!==0){var ie=_.deletions;if(ie!==null){for(var xe=0;xe<ie.length;xe++){var Ce=ie[xe];for(st=Ce;st!==null;){var Le=st;switch(Le.tag){case 0:case 11:case 15:Qi(8,Le,_)}var Ve=Le.child;if(Ve!==null)Ve.return=Le,st=Ve;else for(;st!==null;){Le=st;var Ie=Le.sibling,at=Le.return;if($x(Le),Le===Ce){st=null;break}if(Ie!==null){Ie.return=at,st=Ie;break}st=at}}}var ot=_.alternate;if(ot!==null){var it=ot.child;if(it!==null){ot.child=null;do{var vr=it.sibling;it.sibling=null,it=vr}while(it!==null)}}st=_}}if((_.subtreeFlags&2064)!==0&&M!==null)M.return=_,st=M;else e:for(;st!==null;){if(_=st,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Qi(9,_,_.return)}var ye=_.sibling;if(ye!==null){ye.return=_.return,st=ye;break e}st=_.return}}var ge=s.current;for(st=ge;st!==null;){M=st;var be=M.child;if((M.subtreeFlags&2064)!==0&&be!==null)be.return=M,st=be;else e:for(M=ge;st!==null;){if(ie=st,(ie.flags&2048)!==0)try{switch(ie.tag){case 0:case 11:case 15:jc(9,ie)}}catch(lt){fr(ie,ie.return,lt)}if(ie===M){st=null;break e}var Xe=ie.sibling;if(Xe!==null){Xe.return=ie.return,st=Xe;break e}st=ie.return}}if(Rt=y,fs(),jr&&typeof jr.onPostCommitFiberRoot=="function")try{jr.onPostCommitFiberRoot(da,s)}catch{}x=!0}return x}finally{Kt=d,On.transition=i}}return!1}function sm(s,i,d){i=$o(d,i),i=_x(s,i,1),s=hs(s,i,1),i=rn(),s!==null&&(bi(s,1,i),vn(s,i))}function fr(s,i,d){if(s.tag===3)sm(s,s,d);else for(;i!==null;){if(i.tag===3){sm(i,s,d);break}else if(i.tag===1){var x=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(ms===null||!ms.has(x))){s=$o(d,s),s=Sx(i,s,1),i=hs(i,s,1),s=rn(),i!==null&&(bi(i,1,s),vn(i,s));break}}i=i.return}}function Qk(s,i,d){var x=s.pingCache;x!==null&&x.delete(i),i=rn(),s.pingedLanes|=s.suspendedLanes&d,Ar===s&&(Lr&d)===d&&(Cr===4||Cr===3&&(Lr&130023424)===Lr&&500>Ye()-C0?Qs(s,0):N0|=d),vn(s,i)}function om(s,i){i===0&&((s.mode&1)===0?i=1:(i=Vl,Vl<<=1,(Vl&130023424)===0&&(Vl=4194304)));var d=rn();s=La(s,i),s!==null&&(bi(s,i,d),vn(s,d))}function Xk(s){var i=s.memoizedState,d=0;i!==null&&(d=i.retryLane),om(s,d)}function qk(s,i){var d=0;switch(s.tag){case 13:var x=s.stateNode,y=s.memoizedState;y!==null&&(d=y.retryLane);break;case 19:x=s.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(i),om(s,d)}var im;im=function(s,i,d){if(s!==null)if(s.memoizedProps!==i.pendingProps||hn.current)mn=!0;else{if((s.lanes&d)===0&&(i.flags&128)===0)return mn=!1,Ik(s,i,d);mn=(s.flags&131072)!==0}else mn=!1,or&&(i.flags&1048576)!==0&&Bh(i,hc,i.index);switch(i.lanes=0,i.tag){case 2:var x=i.type;Dc(s,i),s=i.pendingProps;var y=Ro(i,Hr.current);Wo(i,d),y=a0(null,i,x,s,y,d);var _=s0();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,xn(x)?(_=!0,dc(i)):_=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,qd(i),y.updater=Cc,i.stateNode=y,y._reactInternals=i,d0(i,x,s,d),i=x0(null,i,x,!0,_,d)):(i.tag=0,or&&_&&Wd(i),tn(null,i,y,d),i=i.child),i;case 16:x=i.elementType;e:{switch(Dc(s,i),s=i.pendingProps,y=x._init,x=y(x._payload),i.type=x,y=i.tag=Jk(x),s=qn(x,s),y){case 0:i=h0(null,i,x,s,d);break e;case 1:i=Ax(null,i,x,s,d);break e;case 11:i=Tx(null,i,x,s,d);break e;case 14:i=Dx(null,i,x,qn(x.type,s),d);break e}throw Error(t(306,x,""))}return i;case 0:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),h0(s,i,x,y,d);case 1:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),Ax(s,i,x,y,d);case 3:e:{if(Ox(i),s===null)throw Error(t(387));x=i.pendingProps,_=i.memoizedState,y=_.element,Qh(s,i),wc(i,x,null,d);var M=i.memoizedState;if(x=M.element,_.isDehydrated)if(_={element:x,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},i.updateQueue.baseState=_,i.memoizedState=_,i.flags&256){y=$o(Error(t(423)),i),i=Rx(s,i,x,d,y);break e}else if(x!==y){y=$o(Error(t(424)),i),i=Rx(s,i,x,d,y);break e}else for(_n=cs(i.stateNode.containerInfo.firstChild),bn=i,or=!0,Xn=null,d=Kh(i,null,x,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Io(),x===y){i=Wa(s,i,d);break e}tn(s,i,x,d)}i=i.child}return i;case 5:return Zh(i),s===null&&Hd(i),x=i.type,y=i.pendingProps,_=s!==null?s.memoizedProps:null,M=y.children,Rd(x,y)?M=null:_!==null&&Rd(x,_)&&(i.flags|=32),Px(s,i),tn(s,i,M,d),i.child;case 6:return s===null&&Hd(i),null;case 13:return zx(s,i,d);case 4:return Zd(i,i.stateNode.containerInfo),x=i.pendingProps,s===null?i.child=Lo(i,null,x,d):tn(s,i,x,d),i.child;case 11:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),Tx(s,i,x,y,d);case 7:return tn(s,i,i.pendingProps,d),i.child;case 8:return tn(s,i,i.pendingProps.children,d),i.child;case 12:return tn(s,i,i.pendingProps.children,d),i.child;case 10:e:{if(x=i.type._context,y=i.pendingProps,_=i.memoizedProps,M=y.value,er(gc,x._currentValue),x._currentValue=M,_!==null)if(Qn(_.value,M)){if(_.children===y.children&&!hn.current){i=Wa(s,i,d);break e}}else for(_=i.child,_!==null&&(_.return=i);_!==null;){var ie=_.dependencies;if(ie!==null){M=_.child;for(var xe=ie.firstContext;xe!==null;){if(xe.context===x){if(_.tag===1){xe=Ba(-1,d&-d),xe.tag=2;var Ce=_.updateQueue;if(Ce!==null){Ce=Ce.shared;var Le=Ce.pending;Le===null?xe.next=xe:(xe.next=Le.next,Le.next=xe),Ce.pending=xe}}_.lanes|=d,xe=_.alternate,xe!==null&&(xe.lanes|=d),Qd(_.return,d,i),ie.lanes|=d;break}xe=xe.next}}else if(_.tag===10)M=_.type===i.type?null:_.child;else if(_.tag===18){if(M=_.return,M===null)throw Error(t(341));M.lanes|=d,ie=M.alternate,ie!==null&&(ie.lanes|=d),Qd(M,d,i),M=_.sibling}else M=_.child;if(M!==null)M.return=_;else for(M=_;M!==null;){if(M===i){M=null;break}if(_=M.sibling,_!==null){_.return=M.return,M=_;break}M=M.return}_=M}tn(s,i,y.children,d),i=i.child}return i;case 9:return y=i.type,x=i.pendingProps.children,Wo(i,d),y=Pn(y),x=x(y),i.flags|=1,tn(s,i,x,d),i.child;case 14:return x=i.type,y=qn(x,i.pendingProps),y=qn(x.type,y),Dx(s,i,x,y,d);case 15:return Fx(s,i,i.type,i.pendingProps,d);case 17:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),Dc(s,i),i.tag=1,xn(x)?(s=!0,dc(i)):s=!1,Wo(i,d),kx(i,x,y),d0(i,x,y,d),x0(null,i,x,!0,s,d);case 19:return Ix(s,i,d);case 22:return jx(s,i,d)}throw Error(t(156,i.tag))};function lm(s,i){return We(s,i)}function Zk(s,i,d,x){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(s,i,d,x){return new Zk(s,i,d,x)}function R0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Jk(s){if(typeof s=="function")return R0(s)?1:0;if(s!=null){if(s=s.$$typeof,s===V)return 11;if(s===le)return 14}return 2}function ws(s,i){var d=s.alternate;return d===null?(d=Rn(s.tag,i,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=i,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&14680064,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,i=s.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d}function Bc(s,i,d,x,y,_){var M=2;if(x=s,typeof s=="function")R0(s)&&(M=1);else if(typeof s=="string")M=5;else e:switch(s){case F:return qs(d.children,y,_,i);case H:M=8,y|=8;break;case U:return s=Rn(12,d,i,y|2),s.elementType=U,s.lanes=_,s;case de:return s=Rn(13,d,i,y),s.elementType=de,s.lanes=_,s;case ue:return s=Rn(19,d,i,y),s.elementType=ue,s.lanes=_,s;case q:return Wc(d,y,_,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ae:M=10;break e;case J:M=9;break e;case V:M=11;break e;case le:M=14;break e;case pe:M=16,x=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Rn(M,d,i,y),i.elementType=s,i.type=x,i.lanes=_,i}function qs(s,i,d,x){return s=Rn(7,s,x,i),s.lanes=d,s}function Wc(s,i,d,x){return s=Rn(22,s,x,i),s.elementType=q,s.lanes=d,s.stateNode={isHidden:!1},s}function z0(s,i,d){return s=Rn(6,s,null,i),s.lanes=d,s}function M0(s,i,d){return i=Rn(4,s.children!==null?s.children:[],s.key,i),i.lanes=d,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function eb(s,i,d,x,y){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ud(0),this.expirationTimes=ud(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ud(0),this.identifierPrefix=x,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function I0(s,i,d,x,y,_,M,ie,xe){return s=new eb(s,i,d,ie,xe),i===1?(i=1,_===!0&&(i|=8)):i=0,_=Rn(3,null,null,i),s.current=_,_.stateNode=s,_.memoizedState={element:x,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},qd(_),s}function tb(s,i,d){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:x==null?null:""+x,children:s,containerInfo:i,implementation:d}}function cm(s){if(!s)return ds;s=s._reactInternals;e:{if(ne(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(xn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var d=s.type;if(xn(d))return Mh(s,d,i)}return i}function um(s,i,d,x,y,_,M,ie,xe){return s=I0(d,x,!0,s,y,_,M,ie,xe),s.context=cm(null),d=s.current,x=rn(),y=vs(d),_=Ba(x,y),_.callback=i??null,hs(d,_,y),s.current.lanes=y,bi(s,y,x),vn(s,x),s}function Uc(s,i,d,x){var y=i.current,_=rn(),M=vs(y);return d=cm(d),i.context===null?i.context=d:i.pendingContext=d,i=Ba(_,M),i.payload={element:s},x=x===void 0?null:x,x!==null&&(i.callback=x),s=hs(y,i,M),s!==null&&(ea(s,y,M,_),yc(s,y,M)),M}function $c(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function dm(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<i?d:i}}function L0(s,i){dm(s,i),(s=s.alternate)&&dm(s,i)}function rb(){return null}var fm=typeof reportError=="function"?reportError:function(s){console.error(s)};function B0(s){this._internalRoot=s}Hc.prototype.render=B0.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));Uc(s,i,null,null)},Hc.prototype.unmount=B0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Gs(function(){Uc(null,s,null,null)}),i[Ra]=null}};function Hc(s){this._internalRoot=s}Hc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Qp();s={blockedOn:null,target:s,priority:i};for(var d=0;d<os.length&&i!==0&&i<os[d].priority;d++);os.splice(d,0,s),d===0&&Zp(s)}};function W0(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Yc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pm(){}function nb(s,i,d,x,y){if(y){if(typeof x=="function"){var _=x;x=function(){var Ce=$c(M);_.call(Ce)}}var M=um(i,x,s,0,null,!1,!1,"",pm);return s._reactRootContainer=M,s[Ra]=M.current,zi(s.nodeType===8?s.parentNode:s),Gs(),M}for(;y=s.lastChild;)s.removeChild(y);if(typeof x=="function"){var ie=x;x=function(){var Ce=$c(xe);ie.call(Ce)}}var xe=I0(s,0,!1,null,null,!1,!1,"",pm);return s._reactRootContainer=xe,s[Ra]=xe.current,zi(s.nodeType===8?s.parentNode:s),Gs(function(){Uc(i,xe,d,x)}),xe}function Vc(s,i,d,x,y){var _=d._reactRootContainer;if(_){var M=_;if(typeof y=="function"){var ie=y;y=function(){var xe=$c(M);ie.call(xe)}}Uc(i,M,s,y)}else M=nb(d,i,s,y,x);return $c(M)}Kp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var d=ki(i.pendingLanes);d!==0&&(dd(i,d|1),vn(i,Ye()),(Rt&6)===0&&(Vo=Ye()+500,fs()))}break;case 13:Gs(function(){var x=La(s,1);if(x!==null){var y=rn();ea(x,s,1,y)}}),L0(s,1)}},fd=function(s){if(s.tag===13){var i=La(s,134217728);if(i!==null){var d=rn();ea(i,s,134217728,d)}L0(s,134217728)}},Gp=function(s){if(s.tag===13){var i=vs(s),d=La(s,i);if(d!==null){var x=rn();ea(d,s,i,x)}L0(s,i)}},Qp=function(){return Kt},Xp=function(s,i){var d=Kt;try{return Kt=s,i()}finally{Kt=d}},fe=function(s,i,d){switch(i){case"input":if(he(s,d),i=d.name,d.type==="radio"&&i!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<d.length;i++){var x=d[i];if(x!==s&&x.form===s.form){var y=cc(x);if(!y)throw Error(t(90));L(x),he(x,y)}}}break;case"textarea":ht(s,d);break;case"select":i=d.value,i!=null&&Je(s,!!d.multiple,i,!1)}},Ae=P0,Be=Gs;var ab={usingClientEntryPoint:!1,Events:[Li,Ao,cc,me,Te,P0]},Ji={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sb={bundleType:Ji.bundleType,version:Ji.version,rendererPackageName:Ji.rendererPackageName,rendererConfig:Ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Y.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Se(s),s===null?null:s.stateNode},findFiberByHostInstance:Ji.findFiberByHostInstance||rb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kc.isDisabled&&Kc.supportsFiber)try{da=Kc.inject(sb),jr=Kc}catch{}}return yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ab,yn.createPortal=function(s,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W0(i))throw Error(t(200));return tb(s,i,null,d)},yn.createRoot=function(s,i){if(!W0(s))throw Error(t(299));var d=!1,x="",y=fm;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(x=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=I0(s,1,!1,null,null,d,!1,x,y),s[Ra]=i.current,zi(s.nodeType===8?s.parentNode:s),new B0(i)},yn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Se(i),s=s===null?null:s.stateNode,s},yn.flushSync=function(s){return Gs(s)},yn.hydrate=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!0,d)},yn.hydrateRoot=function(s,i,d){if(!W0(s))throw Error(t(405));var x=d!=null&&d.hydratedSources||null,y=!1,_="",M=fm;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onRecoverableError!==void 0&&(M=d.onRecoverableError)),i=um(i,null,s,1,d??null,y,!1,_,M),s[Ra]=i.current,zi(s),x)for(s=0;s<x.length;s++)d=x[s],y=d._getVersion,y=y(d._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[d,y]:i.mutableSourceEagerHydrationData.push(d,y);return new Hc(i)},yn.render=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!1,d)},yn.unmountComponentAtNode=function(s){if(!Yc(s))throw Error(t(40));return s._reactRootContainer?(Gs(function(){Vc(null,null,s,!1,function(){s._reactRootContainer=null,s[Ra]=null})}),!0):!1},yn.unstable_batchedUpdates=P0,yn.unstable_renderSubtreeIntoContainer=function(s,i,d,x){if(!Yc(d))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Vc(s,i,d,!1,x)},yn.version="18.3.1-next-f1338f8080-20240426",yn}var km;function qf(){if(km)return H0.exports;km=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),H0.exports=hb(),H0.exports}var bm;function xb(){if(bm)return Gc;bm=1;var e=qf();return Gc.createRoot=e.createRoot,Gc.hydrateRoot=e.hydrateRoot,Gc}var mb=xb();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Dn=(e,n)=>{const t=S.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...h},p)=>S.createElement("svg",{ref:p,...gb,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${vb(e)}`,c].join(" "),...h},[...n.map(([m,g])=>S.createElement(m,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Dn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=Dn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Dn("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=Dn("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Dn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=Dn("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=Dn("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Dn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=Dn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=Dn("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Dn("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=Dn("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=Dn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Qc={exports:{}},bs={},K0={exports:{}},G0,_m;function Sb(){if(_m)return G0;_m=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return G0=e,G0}var Q0,Sm;function Eb(){if(Sm)return Q0;Sm=1;var e=Sb();function n(){}function t(){}return t.resetWarningCache=n,Q0=function(){function r(l,c,f,h,p,m){if(m!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},Q0}var Em;function Lv(){return Em||(Em=1,K0.exports=Eb()()),K0.exports}var Xc={exports:{}},zn={},qc={exports:{}},Nm;function Bv(){return Nm||(Nm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(m,g){return g.getPropertyValue("overflow")!=="visible"||m.scrollWidth<=0&&m.scrollHeight<=0}function l(m){var g=m.offsetWidth<=0&&m.offsetHeight<=0;if(g&&!m.innerHTML)return!0;try{var v=window.getComputedStyle(m),w=v.getPropertyValue("display");return g?w!==r&&o(m,v):w===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(m){for(var g=m,v=m.getRootNode&&m.getRootNode();g&&g!==document.body;){if(v&&g===v&&(g=v.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(m,g){var v=m.nodeName.toLowerCase(),w=a.test(v)&&!m.disabled||v==="a"&&m.href||g;return w&&c(m)}function h(m){var g=m.getAttribute("tabindex");g===null&&(g=void 0);var v=isNaN(g);return(v||g>=0)&&f(m,!v)}function p(m){var g=[].slice.call(m.querySelectorAll("*"),0).reduce(function(v,w){return v.concat(w.shadowRoot?p(w.shadowRoot):[w])},[]);return g.filter(h)}e.exports=n.default})(qc,qc.exports)),qc.exports}var Cm;function Nb(){if(Cm)return zn;Cm=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.resetState=l,zn.log=c,zn.handleBlur=f,zn.handleFocus=h,zn.markForFocusLater=p,zn.returnFocus=m,zn.popWithoutFocus=g,zn.setupScopedFocus=v,zn.teardownScopedFocus=w;var e=Bv(),n=t(e);function t(b){return b&&b.__esModule?b:{default:b}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function h(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var b=(0,n.default)(a)[0]||a;b.focus()}},0)}}function p(){r.push(document.activeElement)}function m(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=null;try{r.length!==0&&(k=r.pop(),k.focus({preventScroll:b}));return}catch{console.warn(["You tried to return focus to",k,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function v(b){a=b,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",h,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",h))}function w(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",h)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",h))}return zn}var Zc={exports:{}},Tm;function Cb(){return Tm||(Tm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=Bv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var h=(0,r.default)(c);if(!h.length){f.preventDefault();return}var p=void 0,m=f.shiftKey,g=h[0],v=h[h.length-1],w=o();if(c===w){if(!m)return;p=v}if(v===w&&!m&&(p=g),g===w&&m&&(p=v),p){f.preventDefault(),p.focus();return}var b=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),k=b!=null&&b[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(k){var C=h.indexOf(w);if(C>-1&&(C+=m?-1:1),p=h[C],typeof p>"u"){f.preventDefault(),p=m?v:g,p.focus();return}f.preventDefault(),p.focus()}}e.exports=n.default})(Zc,Zc.exports)),Zc.exports}var ta={},X0,Dm;function Tb(){if(Dm)return X0;Dm=1;var e=function(){};return X0=e,X0}var ma={},q0={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Fm;function Db(){return Fm||(Fm=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(q0)),q0.exports}var jm;function rp(){if(jm)return ma;jm=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.canUseDOM=ma.SafeNodeList=ma.SafeHTMLCollection=void 0;var e=Db(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return ma.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},ma.SafeNodeList=r.canUseDOM?window.NodeList:{},ma.canUseDOM=r.canUseDOM,ma.default=a,ma}var Pm;function Wv(){if(Pm)return ta;Pm=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.resetState=o,ta.log=l,ta.assertNodeList=c,ta.setElement=f,ta.validateElement=h,ta.hide=p,ta.show=m,ta.documentNotReadyOrSSRTesting=g;var e=Tb(),n=r(e),t=rp();function r(v){return v&&v.__esModule?v:{default:v}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(v){return v.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(v){return v.removeAttribute("aria-hidden")})),a=null}function l(){}function c(v,w){if(!v||!v.length)throw new Error("react-modal: No elements were found for selector "+w+".")}function f(v){var w=v;if(typeof w=="string"&&t.canUseDOM){var b=document.querySelectorAll(w);c(b,w),w=b}return a=w||a,a}function h(v){var w=v||a;return w?Array.isArray(w)||w instanceof HTMLCollection||w instanceof NodeList?w:[w]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function p(v){var w=!0,b=!1,k=void 0;try{for(var C=h(v)[Symbol.iterator](),D;!(w=(D=C.next()).done);w=!0){var E=D.value;E.setAttribute("aria-hidden","true")}}catch(Y){b=!0,k=Y}finally{try{!w&&C.return&&C.return()}finally{if(b)throw k}}}function m(v){var w=!0,b=!1,k=void 0;try{for(var C=h(v)[Symbol.iterator](),D;!(w=(D=C.next()).done);w=!0){var E=D.value;E.removeAttribute("aria-hidden")}}catch(Y){b=!0,k=Y}finally{try{!w&&C.return&&C.return()}finally{if(b)throw k}}}function g(){a=null}return ta}var Zs={},Am;function Fb(){if(Am)return Zs;Am=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.resetState=r,Zs.log=a;var e={},n={};function t(h,p){h.classList.remove(p)}function r(){var h=document.getElementsByTagName("html")[0];for(var p in e)t(h,e[p]);var m=document.body;for(var g in n)t(m,n[g]);e={},n={}}function a(){}var o=function(p,m){return p[m]||(p[m]=0),p[m]+=1,m},l=function(p,m){return p[m]&&(p[m]-=1),m},c=function(p,m,g){g.forEach(function(v){o(m,v),p.add(v)})},f=function(p,m,g){g.forEach(function(v){l(m,v),m[v]===0&&p.remove(v)})};return Zs.add=function(p,m){return c(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs.remove=function(p,m){return f(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs}var Go={},Om;function Uv(){if(Om)return Go;Om=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.log=r,Go.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return Go.default=t,Go}var tl={},Rm;function jb(){if(Rm)return tl;Rm=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.resetState=l,tl.log=c;var e=Uv(),n=t(e);function t(p){return p&&p.__esModule?p:{default:p}}var r=void 0,a=void 0,o=[];function l(){for(var p=[r,a],m=0;m<p.length;m++){var g=p[m];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var p=[r,a],m=0;m<p.length;m++){var g=p[m],v=g||{};console.log(v.nodeName,v.className,v.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function h(p,m){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=m,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(h),tl}var zm;function Pb(){return zm||(zm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(ue){for(var le=1;le<arguments.length;le++){var pe=arguments[le];for(var q in pe)Object.prototype.hasOwnProperty.call(pe,q)&&(ue[q]=pe[q])}return ue},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ue){return typeof ue}:function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue},a=(function(){function ue(le,pe){for(var q=0;q<pe.length;q++){var oe=pe[q];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(le,oe.key,oe)}}return function(le,pe,q){return pe&&ue(le.prototype,pe),q&&ue(le,q),le}})(),o=jl(),l=Lv(),c=ee(l),f=Nb(),h=Y(f),p=Cb(),m=ee(p),g=Wv(),v=Y(g),w=Fb(),b=Y(w),k=rp(),C=ee(k),D=Uv(),E=ee(D);jb();function Y(ue){if(ue&&ue.__esModule)return ue;var le={};if(ue!=null)for(var pe in ue)Object.prototype.hasOwnProperty.call(ue,pe)&&(le[pe]=ue[pe]);return le.default=ue,le}function ee(ue){return ue&&ue.__esModule?ue:{default:ue}}function G(ue,le){if(!(ue instanceof le))throw new TypeError("Cannot call a class as a function")}function F(ue,le){if(!ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le&&(typeof le=="object"||typeof le=="function")?le:ue}function H(ue,le){if(typeof le!="function"&&le!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof le);ue.prototype=Object.create(le&&le.prototype,{constructor:{value:ue,enumerable:!1,writable:!0,configurable:!0}}),le&&(Object.setPrototypeOf?Object.setPrototypeOf(ue,le):ue.__proto__=le)}var U={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},ae=function(le){return le.code==="Tab"||le.keyCode===9},J=function(le){return le.code==="Escape"||le.keyCode===27},V=0,de=(function(ue){H(le,ue);function le(pe){G(this,le);var q=F(this,(le.__proto__||Object.getPrototypeOf(le)).call(this,pe));return q.setOverlayRef=function(oe){q.overlay=oe,q.props.overlayRef&&q.props.overlayRef(oe)},q.setContentRef=function(oe){q.content=oe,q.props.contentRef&&q.props.contentRef(oe)},q.afterClose=function(){var oe=q.props,B=oe.appElement,re=oe.ariaHideApp,I=oe.htmlOpenClassName,P=oe.bodyOpenClassName,ce=oe.parentSelector,A=ce&&ce().ownerDocument||document;P&&b.remove(A.body,P),I&&b.remove(A.getElementsByTagName("html")[0],I),re&&V>0&&(V-=1,V===0&&v.show(B)),q.props.shouldFocusAfterRender&&(q.props.shouldReturnFocusAfterClose?(h.returnFocus(q.props.preventScroll),h.teardownScopedFocus()):h.popWithoutFocus()),q.props.onAfterClose&&q.props.onAfterClose(),E.default.deregister(q)},q.open=function(){q.beforeOpen(),q.state.afterOpen&&q.state.beforeClose?(clearTimeout(q.closeTimer),q.setState({beforeClose:!1})):(q.props.shouldFocusAfterRender&&(h.setupScopedFocus(q.node),h.markForFocusLater()),q.setState({isOpen:!0},function(){q.openAnimationFrame=requestAnimationFrame(function(){q.setState({afterOpen:!0}),q.props.isOpen&&q.props.onAfterOpen&&q.props.onAfterOpen({overlayEl:q.overlay,contentEl:q.content})})}))},q.close=function(){q.props.closeTimeoutMS>0?q.closeWithTimeout():q.closeWithoutTimeout()},q.focusContent=function(){return q.content&&!q.contentHasFocus()&&q.content.focus({preventScroll:!0})},q.closeWithTimeout=function(){var oe=Date.now()+q.props.closeTimeoutMS;q.setState({beforeClose:!0,closesAt:oe},function(){q.closeTimer=setTimeout(q.closeWithoutTimeout,q.state.closesAt-Date.now())})},q.closeWithoutTimeout=function(){q.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},q.afterClose)},q.handleKeyDown=function(oe){ae(oe)&&(0,m.default)(q.content,oe),q.props.shouldCloseOnEsc&&J(oe)&&(oe.stopPropagation(),q.requestClose(oe))},q.handleOverlayOnClick=function(oe){q.shouldClose===null&&(q.shouldClose=!0),q.shouldClose&&q.props.shouldCloseOnOverlayClick&&(q.ownerHandlesClose()?q.requestClose(oe):q.focusContent()),q.shouldClose=null},q.handleContentOnMouseUp=function(){q.shouldClose=!1},q.handleOverlayOnMouseDown=function(oe){!q.props.shouldCloseOnOverlayClick&&oe.target==q.overlay&&oe.preventDefault()},q.handleContentOnClick=function(){q.shouldClose=!1},q.handleContentOnMouseDown=function(){q.shouldClose=!1},q.requestClose=function(oe){return q.ownerHandlesClose()&&q.props.onRequestClose(oe)},q.ownerHandlesClose=function(){return q.props.onRequestClose},q.shouldBeClosed=function(){return!q.state.isOpen&&!q.state.beforeClose},q.contentHasFocus=function(){return document.activeElement===q.content||q.content.contains(document.activeElement)},q.buildClassName=function(oe,B){var re=(typeof B>"u"?"undefined":r(B))==="object"?B:{base:U[oe],afterOpen:U[oe]+"--after-open",beforeClose:U[oe]+"--before-close"},I=re.base;return q.state.afterOpen&&(I=I+" "+re.afterOpen),q.state.beforeClose&&(I=I+" "+re.beforeClose),typeof B=="string"&&B?I+" "+B:I},q.attributesFromObject=function(oe,B){return Object.keys(B).reduce(function(re,I){return re[oe+"-"+I]=B[I],re},{})},q.state={afterOpen:!1,beforeClose:!1},q.shouldClose=null,q.moveFromContentToOverlay=null,q}return a(le,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(q,oe){this.props.isOpen&&!q.isOpen?this.open():!this.props.isOpen&&q.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!oe.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var q=this.props,oe=q.appElement,B=q.ariaHideApp,re=q.htmlOpenClassName,I=q.bodyOpenClassName,P=q.parentSelector,ce=P&&P().ownerDocument||document;I&&b.add(ce.body,I),re&&b.add(ce.getElementsByTagName("html")[0],re),B&&(V+=1,v.hide(oe)),E.default.register(this)}},{key:"render",value:function(){var q=this.props,oe=q.id,B=q.className,re=q.overlayClassName,I=q.defaultStyles,P=q.children,ce=B?{}:I.content,A=re?{}:I.overlay;if(this.shouldBeClosed())return null;var T={ref:this.setOverlayRef,className:this.buildClassName("overlay",re),style:t({},A,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},j=t({id:oe,ref:this.setContentRef,style:t({},ce,this.props.style.content),className:this.buildClassName("content",B),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),N=this.props.contentElement(j,P);return this.props.overlayElement(T,N)}}]),le})(o.Component);de.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},de.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(C.default),c.default.instanceOf(k.SafeHTMLCollection),c.default.instanceOf(k.SafeNodeList),c.default.arrayOf(c.default.instanceOf(C.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=de,e.exports=n.default})(Xc,Xc.exports)),Xc.exports}function $v(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Hv(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function Yv(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}$v.__suppressDeprecationWarning=!0;Hv.__suppressDeprecationWarning=!0;Yv.__suppressDeprecationWarning=!0;function Ab(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=$v,n.componentWillReceiveProps=Hv),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=Yv;var c=n.componentDidUpdate;n.componentDidUpdate=function(h,p,m){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:m;c.call(this,h,p,g)}}return e}const Ob=Object.freeze(Object.defineProperty({__proto__:null,polyfill:Ab},Symbol.toStringTag,{value:"Module"})),Rb=lb(Ob);var Mm;function zb(){if(Mm)return bs;Mm=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.bodyOpenClassName=bs.portalClassName=void 0;var e=Object.assign||function(J){for(var V=1;V<arguments.length;V++){var de=arguments[V];for(var ue in de)Object.prototype.hasOwnProperty.call(de,ue)&&(J[ue]=de[ue])}return J},n=(function(){function J(V,de){for(var ue=0;ue<de.length;ue++){var le=de[ue];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(V,le.key,le)}}return function(V,de,ue){return de&&J(V.prototype,de),ue&&J(V,ue),V}})(),t=jl(),r=k(t),a=qf(),o=k(a),l=Lv(),c=k(l),f=Pb(),h=k(f),p=Wv(),m=b(p),g=rp(),v=k(g),w=Rb;function b(J){if(J&&J.__esModule)return J;var V={};if(J!=null)for(var de in J)Object.prototype.hasOwnProperty.call(J,de)&&(V[de]=J[de]);return V.default=J,V}function k(J){return J&&J.__esModule?J:{default:J}}function C(J,V){if(!(J instanceof V))throw new TypeError("Cannot call a class as a function")}function D(J,V){if(!J)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return V&&(typeof V=="object"||typeof V=="function")?V:J}function E(J,V){if(typeof V!="function"&&V!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof V);J.prototype=Object.create(V&&V.prototype,{constructor:{value:J,enumerable:!1,writable:!0,configurable:!0}}),V&&(Object.setPrototypeOf?Object.setPrototypeOf(J,V):J.__proto__=V)}var Y=bs.portalClassName="ReactModalPortal",ee=bs.bodyOpenClassName="ReactModal__Body--open",G=g.canUseDOM&&o.default.createPortal!==void 0,F=function(V){return document.createElement(V)},H=function(){return G?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function U(J){return J()}var ae=(function(J){E(V,J);function V(){var de,ue,le,pe;C(this,V);for(var q=arguments.length,oe=Array(q),B=0;B<q;B++)oe[B]=arguments[B];return pe=(ue=(le=D(this,(de=V.__proto__||Object.getPrototypeOf(V)).call.apply(de,[this].concat(oe))),le),le.removePortal=function(){!G&&o.default.unmountComponentAtNode(le.node);var re=U(le.props.parentSelector);re&&re.contains(le.node)?re.removeChild(le.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},le.portalRef=function(re){le.portal=re},le.renderPortal=function(re){var I=H(),P=I(le,r.default.createElement(h.default,e({defaultStyles:V.defaultStyles},re)),le.node);le.portalRef(P)},ue),D(le,pe)}return n(V,[{key:"componentDidMount",value:function(){if(g.canUseDOM){G||(this.node=F("div")),this.node.className=this.props.portalClassName;var ue=U(this.props.parentSelector);ue.appendChild(this.node),!G&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(ue){var le=U(ue.parentSelector),pe=U(this.props.parentSelector);return{prevParent:le,nextParent:pe}}},{key:"componentDidUpdate",value:function(ue,le,pe){if(g.canUseDOM){var q=this.props,oe=q.isOpen,B=q.portalClassName;ue.portalClassName!==B&&(this.node.className=B);var re=pe.prevParent,I=pe.nextParent;I!==re&&(re.removeChild(this.node),I.appendChild(this.node)),!(!ue.isOpen&&!oe)&&!G&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var ue=this.portal.state,le=Date.now(),pe=ue.isOpen&&this.props.closeTimeoutMS&&(ue.closesAt||le+this.props.closeTimeoutMS);pe?(ue.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,pe-le)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!G)return null;!this.node&&G&&(this.node=F("div"));var ue=H();return ue(r.default.createElement(h.default,e({ref:this.portalRef,defaultStyles:V.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(ue){m.setElement(ue)}}]),V})(t.Component);return ae.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(v.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(v.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},ae.defaultProps={isOpen:!1,portalClassName:Y,bodyOpenClassName:ee,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(V,de){return r.default.createElement("div",V,de)},contentElement:function(V,de){return r.default.createElement("div",V,de)}},ae.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,w.polyfill)(ae),bs.default=ae,bs}var Im;function Mb(){return Im||(Im=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=zb(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Qc,Qc.exports)),Qc.exports}var Ib=Mb();const sr=Qu(Ib);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Vv=1252,Lb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],np={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ap=function(e){Lb.indexOf(e)!=-1&&(Vv=np[0]=e)};function Bb(){ap(1252)}var sa=function(e){ap(e)};function Kv(){sa(1200),Bb()}function Lm(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function Wb(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Gv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var al=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?Wb(e.slice(2)):n==254&&t==255?Gv(e.slice(2)):n==65279?e.slice(1):e},Jc=function(n){return String.fromCharCode(n)},Bm=function(n){return String.fromCharCode(n)},wl,Cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wm(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,r=e.charCodeAt(h++),l=(t&3)<<4|r>>4,a=e.charCodeAt(h++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=Cs.charAt(o)+Cs.charAt(l)+Cs.charAt(c)+Cs.charAt(f);return n}function Tn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=Cs.indexOf(e.charAt(h++)),l=Cs.indexOf(e.charAt(h++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=Cs.indexOf(e.charAt(h++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=Cs.indexOf(e.charAt(h++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var jt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),vo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function As(e){return jt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Um(e){return jt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var aa=function(n){return jt?vo(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function yo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function sp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return sp(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var Es=jt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:vo(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Ub(e){for(var n=[],t=0,r=e.length+250,a=As(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=As(65535),r=65530)}return n.push(a.slice(0,t)),Es(n)}var dn=/\u0000/g,sl=/[\u0001-\u0006]/g;function ri(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function oa(e,n){var t=""+e;return t.length>=n?t:pr("0",n-t.length)+t}function op(e,n){var t=""+e;return t.length>=n?t:pr(" ",n-t.length)+t}function Su(e,n){var t=""+e;return t.length>=n?t:t+pr(" ",n-t.length)}function $b(e,n){var t=""+Math.round(e);return t.length>=n?t:pr("0",n-t.length)+t}function Hb(e,n){var t=""+e;return t.length>=n?t:pr("0",n-t.length)+t}var $m=Math.pow(2,32);function Qo(e,n){if(e>$m||e<-$m)return $b(e,n);var t=Math.round(e);return Hb(t,n)}function Eu(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Hm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Z0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Yb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var St={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ym={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Nu(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,h=0,p=0,m=Math.floor(a);h<n&&(m=Math.floor(a),c=m*l+o,p=m*h+f,!(a-m<5e-8));)a=1/(a-m),o=l,l=c,f=h,h=p;if(p>n&&(h>n?(p=f,c=o):(p=h,c=l)),!t)return[0,r*c,p];var g=Math.floor(r*c/p);return[g,r*c-g*p,p]}function to(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=Zb(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var Qv=new Date(1899,11,31,0,0,0),Kb=Qv.getTime(),Gb=new Date(1900,2,1,0,0,0);function Xv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=Gb&&(t+=1440*60*1e3),(t-(Kb+(e.getTimezoneOffset()-Qv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ip(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Xb(e){var n=e<0?12:11,t=ip(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function qb(e){var n=ip(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function kl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=Xb(e):n===10?t=e.toFixed(10).substr(0,12):t=qb(e),ip(Qb(t.toUpperCase()))}function uo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):kl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Vn(14,Xv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function Zb(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Jb(e,n,t,r){var a="",o=0,l=0,c=t.y,f,h=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,h=n.length;break;case 3:return Z0[t.m-1][1];case 5:return Z0[t.m-1][0];default:return Z0[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,h=n.length;break;case 3:return Hm[t.q][0];default:return Hm[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?oa(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=oa(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:f=c,h=1;break}var p=h>0?oa(f,h):"";return p}function Ts(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var qv=/%/g;function e2(e,n,t){var r=n.replace(qv,""),a=n.length-r.length;return Va(e,r,t*Math.pow(10,2*a))+pr("%",a)}function t2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Va(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Zv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Zv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Jv=/# (\?+)( ?)\/( ?)(\d+)/;function r2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?pr(" ",e[1].length+1+e[4].length):op(l,e[1].length)+e[2]+"/"+e[3]+oa(c,e[4].length))}function n2(e,n,t){return t+(n===0?"":""+n)+pr(" ",e[1].length+2+e[4].length)}var ey=/^#*0*\.([0#]+)/,ty=/\).*[0#]/,ry=/\(###\) ###\\?-####/;function nn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Vm(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Km(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function a2(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function s2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ln(e,n,t){if(e.charCodeAt(0)===40&&!n.match(ty)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ln("n",r,t):"("+Ln("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return t2(e,n,t);if(n.indexOf("%")!==-1)return e2(e,n,t);if(n.indexOf("E")!==-1)return Zv(n,t);if(n.charCodeAt(0)===36)return"$"+Ln(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+Qo(f,n.length);if(n.match(/^[#?]+$/))return a=Qo(t,0),a==="0"&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(Jv))return r2(o,f,h);if(n.match(/^#+0+$/))return h+Qo(f,n.length-n.indexOf("0"));if(o=n.match(ey))return a=Vm(t,o[1].length).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+pr("0",nn(o[1]).length-b.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+Vm(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Ts(Qo(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ln(e,n,-t):Ts(""+(Math.floor(t)+a2(t,o[1].length)))+"."+oa(Km(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return Ln(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(Ln(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(n.match(ry))return a=Ln(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Nu(f,Math.pow(10,l)-1,!1),a=""+h,p=Va("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Su(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Nu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?op(c[1],l)+o[2]+"/"+o[3]+Su(c[2],l):pr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=Qo(t,0),n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Km(t,o[1].length),t<0?"-"+Ln(e,n,-t):Ts(s2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?oa(0,3-w.length):"")+w})+"."+oa(l,o[1].length);switch(n){case"###,##0.00":return Ln(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var v=Ts(Qo(f,0));return v!=="0"?h+v:"";case"###,###.00":return Ln(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ln(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function o2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Va(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function i2(e,n,t){var r=n.replace(qv,""),a=n.length-r.length;return Va(e,r,t*Math.pow(10,2*a))+pr("%",a)}function ny(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+ny(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function va(e,n,t){if(e.charCodeAt(0)===40&&!n.match(ty)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?va("n",r,t):"("+va("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return o2(e,n,t);if(n.indexOf("%")!==-1)return i2(e,n,t);if(n.indexOf("E")!==-1)return ny(n,t);if(n.charCodeAt(0)===36)return"$"+va(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+oa(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(Jv))return n2(o,f,h);if(n.match(/^#+0+$/))return h+oa(f,n.length-n.indexOf("0"));if(o=n.match(ey))return a=(""+t).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])),a=a.replace(/\.(\d*)$/,function(w,b){return"."+b+pr("0",nn(o[1]).length-b.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Ts(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+va(e,n,-t):Ts(""+t)+"."+pr("0",o[1].length);if(o=n.match(/^#,#*,#0/))return va(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(va(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(n.match(ry))return a=va(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Nu(f,Math.pow(10,l)-1,!1),a=""+h,p=Va("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Su(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Nu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?op(c[1],l)+o[2]+"/"+o[3]+Su(c[2],l):pr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+va(e,n,-t):Ts(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?oa(0,3-w.length):"")+w})+"."+oa(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var v=Ts(""+f);return v!=="0"?h+v:"";default:if(n.match(/\.[0#?]*$/))return va(e,n.slice(0,n.lastIndexOf(".")),t)+nn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Va(e,n,t){return(t|0)===t?va(e,n,t):Ln(e,n,t)}function l2(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var ay=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mi(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":Eu(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(ay))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function c2(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",h,p,m,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!Eu(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(m=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(m);a[a.length]={t:"t",v:o},++l;break;case"\\":var v=e.charAt(++l),w=v==="("||v===")"?v:"t";a[a.length]={t:w,v},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=to(n,t,e.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=to(n,t),h==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"":var b={t:c,v:c};if(h==null&&(h=to(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(b.v=h.H>=12?"P":"A"),b.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(b.v=h.H>=12?"PM":"AM"),b.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="/"?(h!=null&&(b.v=h.H>=12?"":""),b.t="T",l+=5,g="h"):(b.t="t",++l),h==null&&b.t==="T")return"";a[a.length]=b,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(ay)){if(h==null&&(h=to(n,t),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",mi(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var k=0,C=0,D;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",k<1&&(k=1);break;case"s":(D=a[l].v.match(/\.0+$/))&&(C=Math.max(C,D[0].length-1)),k<3&&(k=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",k<2&&(k=2));break;case"X":break;case"Z":k<1&&a[l].v.match(/[Hh]/)&&(k=1),k<2&&a[l].v.match(/[Mm]/)&&(k=2),k<3&&a[l].v.match(/[Ss]/)&&(k=3)}switch(k){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var E="",Y;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=Jb(a[l].t.charCodeAt(0),a[l].v,h,C),a[l].t="t";break;case"n":case"?":for(Y=l+1;a[Y]!=null&&((c=a[Y].t)==="?"||c==="D"||(c===" "||c==="t")&&a[Y+1]!=null&&(a[Y+1].t==="?"||a[Y+1].t==="t"&&a[Y+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[Y].v==="/"||a[Y].v===" "&&a[Y+1]!=null&&a[Y+1].t=="?"));)a[l].v+=a[Y].v,a[Y]={v:"",t:";"},++Y;E+=a[l].v,l=Y-1;break;case"G":a[l].t="t",a[l].v=uo(n,t);break}var ee="",G,F;if(E.length>0){E.charCodeAt(0)==40?(G=n<0&&E.charCodeAt(0)===45?-n:n,F=Va("n",E,G)):(G=n<0&&r>1?-n:n,F=Va("n",E,G),G<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),Y=F.length-1;var H=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){H=l;break}var U=a.length;if(H===a.length&&F.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(Y>=a[l].v.length-1?(Y-=a[l].v.length,a[l].v=F.substr(Y+1,a[l].v.length)):Y<0?a[l].v="":(a[l].v=F.substr(0,Y+1),Y=-1),a[l].t="t",U=l);Y>=0&&U<a.length&&(a[U].v=F.substr(0,Y+1)+a[U].v)}else if(H!==a.length&&F.indexOf("E")===-1){for(Y=F.indexOf(".")-1,l=H;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===H?a[l].v.indexOf(".")-1:a[l].v.length-1,ee=a[l].v.substr(p+1);p>=0;--p)Y>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(ee=F.charAt(Y--)+ee);a[l].v=ee,a[l].t="t",U=l}for(Y>=0&&U<a.length&&(a[U].v=F.substr(0,Y+1)+a[U].v),Y=F.indexOf(".")+1,l=H;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==H)){for(p=a[l].v.indexOf(".")>-1&&l===H?a[l].v.indexOf(".")+1:0,ee=a[l].v.substr(0,p);p<a[l].v.length;++p)Y<F.length&&(ee+=F.charAt(Y++));a[l].v=ee,a[l].t="t",U=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(G=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=Va(a[l].t,a[l].v,G),a[l].t="t");var ae="";for(l=0;l!==a.length;++l)a[l]!=null&&(ae+=a[l].v);return ae}var Gm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Qm(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function u2(e,n){var t=l2(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Gm),c=t[1].match(Gm);return Qm(n,l)?[r,t[0]]:Qm(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Vn(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:St)[e],r==null&&(r=t.table&&t.table[Ym[e]]||St[Ym[e]]),r==null&&(r=Vb[e]||"General");break}if(Eu(r,0))return uo(n,t);n instanceof Date&&(n=Xv(n,t.date1904));var a=u2(r,n);if(Eu(a[1]))return uo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return c2(a[1],n,t,a[0])}function ao(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(St[t]==null){n<0&&(n=t);continue}if(St[t]==e){n=t;break}}n<0&&(n=391)}return St[n]=e,n}function sy(){St=Yb()}var d2={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},oy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function f2(e){var n=typeof e=="number"?St[e]:e;return n=n.replace(oy,"(\\d+)"),new RegExp("^"+n+"$")}function p2(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(oy)||[]).forEach(function(m,g){var v=parseInt(t[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=v;break;case"d":o=v;break;case"h":l=v;break;case"s":f=v;break;case"m":l>=0?c=v:a=v;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?h:r==-1&&a==-1&&o==-1?p:h+"T"+p}var h2=(function(){var e={};e.version="1.2.0";function n(){for(var F=0,H=new Array(256),U=0;U!=256;++U)F=U,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,H[U]=F;return typeof Int32Array<"u"?new Int32Array(H):H}var t=n();function r(F){var H=0,U=0,ae=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)J[ae]=F[ae];for(ae=0;ae!=256;++ae)for(U=F[ae],H=256+ae;H<4096;H+=256)U=J[H]=U>>>8^F[U&255];var V=[];for(ae=1;ae!=16;++ae)V[ae-1]=typeof Int32Array<"u"?J.subarray(ae*256,ae*256+256):J.slice(ae*256,ae*256+256);return V}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],h=a[4],p=a[5],m=a[6],g=a[7],v=a[8],w=a[9],b=a[10],k=a[11],C=a[12],D=a[13],E=a[14];function Y(F,H){for(var U=H^-1,ae=0,J=F.length;ae<J;)U=U>>>8^t[(U^F.charCodeAt(ae++))&255];return~U}function ee(F,H){for(var U=H^-1,ae=F.length-15,J=0;J<ae;)U=E[F[J++]^U&255]^D[F[J++]^U>>8&255]^C[F[J++]^U>>16&255]^k[F[J++]^U>>>24]^b[F[J++]]^w[F[J++]]^v[F[J++]]^g[F[J++]]^m[F[J++]]^p[F[J++]]^h[F[J++]]^f[F[J++]]^c[F[J++]]^l[F[J++]]^o[F[J++]]^t[F[J++]];for(ae+=15;J<ae;)U=U>>>8^t[(U^F[J++])&255];return~U}function G(F,H){for(var U=H^-1,ae=0,J=F.length,V=0,de=0;ae<J;)V=F.charCodeAt(ae++),V<128?U=U>>>8^t[(U^V)&255]:V<2048?(U=U>>>8^t[(U^(192|V>>6&31))&255],U=U>>>8^t[(U^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,de=F.charCodeAt(ae++)&1023,U=U>>>8^t[(U^(240|V>>8&7))&255],U=U>>>8^t[(U^(128|V>>2&63))&255],U=U>>>8^t[(U^(128|de>>6&15|(V&3)<<4))&255],U=U>>>8^t[(U^(128|de&63))&255]):(U=U>>>8^t[(U^(224|V>>12&15))&255],U=U>>>8^t[(U^(128|V>>6&63))&255],U=U>>>8^t[(U^(128|V&63))&255]);return~U}return e.table=t,e.bstr=Y,e.buf=ee,e.str=G,e})(),Pt=(function(){var n={};n.version="1.2.1";function t(R,te){for(var K=R.split("/"),Q=te.split("/"),Z=0,ne=0,ke=Math.min(K.length,Q.length);Z<ke;++Z){if(ne=K[Z].length-Q[Z].length)return ne;if(K[Z]!=Q[Z])return K[Z]<Q[Z]?-1:1}return K.length-Q.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var te=R.lastIndexOf("/");return te===-1?R:R.slice(0,te+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var te=R.lastIndexOf("/");return te===-1?R:R.slice(te+1)}function o(R,te){typeof te=="string"&&(te=new Date(te));var K=te.getHours();K=K<<6|te.getMinutes(),K=K<<5|te.getSeconds()>>>1,R.write_shift(2,K);var Q=te.getFullYear()-1980;Q=Q<<4|te.getMonth()+1,Q=Q<<5|te.getDate(),R.write_shift(2,Q)}function l(R){var te=R.read_shift(2)&65535,K=R.read_shift(2)&65535,Q=new Date,Z=K&31;K>>>=5;var ne=K&15;K>>>=4,Q.setMilliseconds(0),Q.setFullYear(K+1980),Q.setMonth(ne-1),Q.setDate(Z);var ke=te&31;te>>>=5;var Fe=te&63;return te>>>=6,Q.setHours(te),Q.setMinutes(Fe),Q.setSeconds(ke<<1),Q}function c(R){Br(R,0);for(var te={},K=0;R.l<=R.length-4;){var Q=R.read_shift(2),Z=R.read_shift(2),ne=R.l+Z,ke={};switch(Q){case 21589:K=R.read_shift(1),K&1&&(ke.mtime=R.read_shift(4)),Z>5&&(K&2&&(ke.atime=R.read_shift(4)),K&4&&(ke.ctime=R.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}R.l=ne,te[Q]=ke}return te}var f;function h(){return f||(f={})}function p(R,te){if(R[0]==80&&R[1]==75)return fe(R,te);if((R[0]|32)==109&&(R[1]|32)==105)return pt(R,te);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var K=3,Q=512,Z=0,ne=0,ke=0,Fe=0,we=0,Se=[],Ee=R.slice(0,512);Br(Ee,0);var We=m(Ee);switch(K=We[0],K){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(We[1]==0)return fe(R,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Q!==512&&(Ee=R.slice(0,Q),Br(Ee,28));var Ze=R.slice(0,Q);g(Ee,K);var Ue=Ee.read_shift(4,"i");if(K===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);Ee.l+=4,ke=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),Fe=Ee.read_shift(4,"i"),Z=Ee.read_shift(4,"i"),we=Ee.read_shift(4,"i"),ne=Ee.read_shift(4,"i");for(var $e=-1,Ye=0;Ye<109&&($e=Ee.read_shift(4,"i"),!($e<0));++Ye)Se[Ye]=$e;var gt=v(R,Q);k(we,ne,gt,Q,Se);var Vt=D(gt,ke,Se,Q);Vt[ke].name="!Directory",Z>0&&Fe!==de&&(Vt[Fe].name="!MiniFAT"),Vt[Se[0]].name="!FAT",Vt.fat_addrs=Se,Vt.ssz=Q;var $t={},mr=[],Ls=[],rs=[];E(ke,Vt,gt,mr,Z,$t,Ls,Fe),w(Ls,rs,mr),mr.shift();var da={FileIndex:Ls,FullPaths:rs};return te&&te.raw&&(da.raw={header:Ze,sectors:gt}),da}function m(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(ue,"Header Signature: "),R.l+=16;var te=R.read_shift(2,"u");return[R.read_shift(2,"u"),te]}function g(R,te){var K=9;switch(R.l+=2,K=R.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function v(R,te){for(var K=Math.ceil(R.length/te)-1,Q=[],Z=1;Z<K;++Z)Q[Z-1]=R.slice(Z*te,(Z+1)*te);return Q[K-1]=R.slice(K*te),Q}function w(R,te,K){for(var Q=0,Z=0,ne=0,ke=0,Fe=0,we=K.length,Se=[],Ee=[];Q<we;++Q)Se[Q]=Ee[Q]=Q,te[Q]=K[Q];for(;Fe<Ee.length;++Fe)Q=Ee[Fe],Z=R[Q].L,ne=R[Q].R,ke=R[Q].C,Se[Q]===Q&&(Z!==-1&&Se[Z]!==Z&&(Se[Q]=Se[Z]),ne!==-1&&Se[ne]!==ne&&(Se[Q]=Se[ne])),ke!==-1&&(Se[ke]=Q),Z!==-1&&Q!=Se[Q]&&(Se[Z]=Se[Q],Ee.lastIndexOf(Z)<Fe&&Ee.push(Z)),ne!==-1&&Q!=Se[Q]&&(Se[ne]=Se[Q],Ee.lastIndexOf(ne)<Fe&&Ee.push(ne));for(Q=1;Q<we;++Q)Se[Q]===Q&&(ne!==-1&&Se[ne]!==ne?Se[Q]=Se[ne]:Z!==-1&&Se[Z]!==Z&&(Se[Q]=Se[Z]));for(Q=1;Q<we;++Q)if(R[Q].type!==0){if(Fe=Q,Fe!=Se[Fe])do Fe=Se[Fe],te[Q]=te[Fe]+"/"+te[Q];while(Fe!==0&&Se[Fe]!==-1&&Fe!=Se[Fe]);Se[Q]=-1}for(te[0]+="/",Q=1;Q<we;++Q)R[Q].type!==2&&(te[Q]+="/")}function b(R,te,K){for(var Q=R.start,Z=R.size,ne=[],ke=Q;K&&Z>0&&ke>=0;)ne.push(te.slice(ke*V,ke*V+V)),Z-=V,ke=eo(K,ke*4);return ne.length===0?Tr(0):Es(ne).slice(0,R.size)}function k(R,te,K,Q,Z){var ne=de;if(R===de){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ke=K[R],Fe=(Q>>>2)-1;if(!ke)return;for(var we=0;we<Fe&&(ne=eo(ke,we*4))!==de;++we)Z.push(ne);k(eo(ke,Q-4),te-1,K,Q,Z)}}function C(R,te,K,Q,Z){var ne=[],ke=[];Z||(Z=[]);var Fe=Q-1,we=0,Se=0;for(we=te;we>=0;){Z[we]=!0,ne[ne.length]=we,ke.push(R[we]);var Ee=K[Math.floor(we*4/Q)];if(Se=we*4&Fe,Q<4+Se)throw new Error("FAT boundary crossed: "+we+" 4 "+Q);if(!R[Ee])break;we=eo(R[Ee],Se)}return{nodes:ne,data:sg([ke])}}function D(R,te,K,Q){var Z=R.length,ne=[],ke=[],Fe=[],we=[],Se=Q-1,Ee=0,We=0,Ze=0,Ue=0;for(Ee=0;Ee<Z;++Ee)if(Fe=[],Ze=Ee+te,Ze>=Z&&(Ze-=Z),!ke[Ze]){we=[];var $e=[];for(We=Ze;We>=0;){$e[We]=!0,ke[We]=!0,Fe[Fe.length]=We,we.push(R[We]);var Ye=K[Math.floor(We*4/Q)];if(Ue=We*4&Se,Q<4+Ue)throw new Error("FAT boundary crossed: "+We+" 4 "+Q);if(!R[Ye]||(We=eo(R[Ye],Ue),$e[We]))break}ne[Ze]={nodes:Fe,data:sg([we])}}return ne}function E(R,te,K,Q,Z,ne,ke,Fe){for(var we=0,Se=Q.length?2:0,Ee=te[R].data,We=0,Ze=0,Ue;We<Ee.length;We+=128){var $e=Ee.slice(We,We+128);Br($e,64),Ze=$e.read_shift(2),Ue=fp($e,0,Ze-Se),Q.push(Ue);var Ye={name:Ue,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},gt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);gt!==0&&(Ye.ct=Y($e,$e.l-8));var Vt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);Vt!==0&&(Ye.mt=Y($e,$e.l-8)),Ye.start=$e.read_shift(4,"i"),Ye.size=$e.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=de,Ye.name=""),Ye.type===5?(we=Ye.start,Z>0&&we!==de&&(te[we].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",te[Ye.start]===void 0&&(te[Ye.start]=C(K,Ye.start,te.fat_addrs,te.ssz)),te[Ye.start].name=Ye.name,Ye.content=te[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:we!==de&&Ye.start!==de&&te[we]&&(Ye.content=b(Ye,te[we].data,(te[Fe]||{}).data))),Ye.content&&Br(Ye.content,0),ne[Ue]=Ye,ke.push(Ye)}}function Y(R,te){return new Date((En(R,te+4)/1e7*Math.pow(2,32)+En(R,te)/1e7-11644473600)*1e3)}function ee(R,te){return h(),p(f.readFileSync(R),te)}function G(R,te){var K=te&&te.type;switch(K||jt&&Buffer.isBuffer(R)&&(K="buffer"),K||"base64"){case"file":return ee(R,te);case"base64":return p(aa(Tn(R)),te);case"binary":return p(aa(R),te)}return p(R,te)}function F(R,te){var K=te||{},Q=K.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=Q+"/",R.FileIndex[0]={name:Q,type:5}),K.CLSID&&(R.FileIndex[0].clsid=K.CLSID),H(R)}function H(R){var te="Sh33tJ5";if(!Pt.find(R,"/"+te)){var K=Tr(4);K[0]=55,K[1]=K[3]=50,K[2]=54,R.FileIndex.push({name:te,type:2,content:K,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+te),U(R)}}function U(R,te){F(R);for(var K=!1,Q=!1,Z=R.FullPaths.length-1;Z>=0;--Z){var ne=R.FileIndex[Z];switch(ne.type){case 0:Q?K=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(ne.R*ne.L*ne.C)&&(K=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!te)){var ke=new Date(1987,1,19),Fe=0,we=Object.create?Object.create(null):{},Se=[];for(Z=0;Z<R.FullPaths.length;++Z)we[R.FullPaths[Z]]=!0,R.FileIndex[Z].type!==0&&Se.push([R.FullPaths[Z],R.FileIndex[Z]]);for(Z=0;Z<Se.length;++Z){var Ee=r(Se[Z][0]);Q=we[Ee],Q||(Se.push([Ee,{name:a(Ee).replace("/",""),type:1,clsid:pe,ct:ke,mt:ke,content:null}]),we[Ee]=!0)}for(Se.sort(function(Ue,$e){return t(Ue[0],$e[0])}),R.FullPaths=[],R.FileIndex=[],Z=0;Z<Se.length;++Z)R.FullPaths[Z]=Se[Z][0],R.FileIndex[Z]=Se[Z][1];for(Z=0;Z<Se.length;++Z){var We=R.FileIndex[Z],Ze=R.FullPaths[Z];if(We.name=a(Ze).replace("/",""),We.L=We.R=We.C=-(We.color=1),We.size=We.content?We.content.length:0,We.start=0,We.clsid=We.clsid||pe,Z===0)We.C=Se.length>1?1:-1,We.size=0,We.type=5;else if(Ze.slice(-1)=="/"){for(Fe=Z+1;Fe<Se.length&&r(R.FullPaths[Fe])!=Ze;++Fe);for(We.C=Fe>=Se.length?-1:Fe,Fe=Z+1;Fe<Se.length&&r(R.FullPaths[Fe])!=r(Ze);++Fe);We.R=Fe>=Se.length?-1:Fe,We.type=1}else r(R.FullPaths[Z+1]||"")==r(Ze)&&(We.R=Z+1),We.type=2}}}function ae(R,te){var K=te||{};if(K.fileType=="mad")return Wt(R,K);switch(U(R),K.fileType){case"zip":return ze(R,K)}var Q=(function(Ue){for(var $e=0,Ye=0,gt=0;gt<Ue.FileIndex.length;++gt){var Vt=Ue.FileIndex[gt];if(Vt.content){var $t=Vt.content.length;$t>0&&($t<4096?$e+=$t+63>>6:Ye+=$t+511>>9)}}for(var mr=Ue.FullPaths.length+3>>2,Ls=$e+7>>3,rs=$e+127>>7,da=Ls+Ye+mr+rs,jr=da+127>>7,wi=jr<=109?0:Math.ceil((jr-109)/127);da+jr+wi+127>>7>jr;)wi=++jr<=109?0:Math.ceil((jr-109)/127);var gr=[1,wi,jr,rs,mr,Ye,$e,0];return Ue.FileIndex[0].size=$e<<6,gr[7]=(Ue.FileIndex[0].start=gr[0]+gr[1]+gr[2]+gr[3]+gr[4]+gr[5])+(gr[6]+7>>3),gr})(R),Z=Tr(Q[7]<<9),ne=0,ke=0;{for(ne=0;ne<8;++ne)Z.write_shift(1,le[ne]);for(ne=0;ne<8;++ne)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),ne=0;ne<3;++ne)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,Q[2]),Z.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:de),Z.write_shift(4,Q[3]),Z.write_shift(-4,Q[1]?Q[0]-1:de),Z.write_shift(4,Q[1]),ne=0;ne<109;++ne)Z.write_shift(-4,ne<Q[2]?Q[1]+ne:-1)}if(Q[1])for(ke=0;ke<Q[1];++ke){for(;ne<236+ke*127;++ne)Z.write_shift(-4,ne<Q[2]?Q[1]+ne:-1);Z.write_shift(-4,ke===Q[1]-1?de:ke+1)}var Fe=function(Ue){for(ke+=Ue;ne<ke-1;++ne)Z.write_shift(-4,ne+1);Ue&&(++ne,Z.write_shift(-4,de))};for(ke=ne=0,ke+=Q[1];ne<ke;++ne)Z.write_shift(-4,q.DIFSECT);for(ke+=Q[2];ne<ke;++ne)Z.write_shift(-4,q.FATSECT);Fe(Q[3]),Fe(Q[4]);for(var we=0,Se=0,Ee=R.FileIndex[0];we<R.FileIndex.length;++we)Ee=R.FileIndex[we],Ee.content&&(Se=Ee.content.length,!(Se<4096)&&(Ee.start=ke,Fe(Se+511>>9)));for(Fe(Q[6]+7>>3);Z.l&511;)Z.write_shift(-4,q.ENDOFCHAIN);for(ke=ne=0,we=0;we<R.FileIndex.length;++we)Ee=R.FileIndex[we],Ee.content&&(Se=Ee.content.length,!(!Se||Se>=4096)&&(Ee.start=ke,Fe(Se+63>>6)));for(;Z.l&511;)Z.write_shift(-4,q.ENDOFCHAIN);for(ne=0;ne<Q[4]<<2;++ne){var We=R.FullPaths[ne];if(!We||We.length===0){for(we=0;we<17;++we)Z.write_shift(4,0);for(we=0;we<3;++we)Z.write_shift(4,-1);for(we=0;we<12;++we)Z.write_shift(4,0);continue}Ee=R.FileIndex[ne],ne===0&&(Ee.start=Ee.size?Ee.start-1:de);var Ze=ne===0&&K.root||Ee.name;if(Se=2*(Ze.length+1),Z.write_shift(64,Ze,"utf16le"),Z.write_shift(2,Se),Z.write_shift(1,Ee.type),Z.write_shift(1,Ee.color),Z.write_shift(-4,Ee.L),Z.write_shift(-4,Ee.R),Z.write_shift(-4,Ee.C),Ee.clsid)Z.write_shift(16,Ee.clsid,"hex");else for(we=0;we<4;++we)Z.write_shift(4,0);Z.write_shift(4,Ee.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,Ee.start),Z.write_shift(4,Ee.size),Z.write_shift(4,0)}for(ne=1;ne<R.FileIndex.length;++ne)if(Ee=R.FileIndex[ne],Ee.size>=4096)if(Z.l=Ee.start+1<<9,jt&&Buffer.isBuffer(Ee.content))Ee.content.copy(Z,Z.l,0,Ee.size),Z.l+=Ee.size+511&-512;else{for(we=0;we<Ee.size;++we)Z.write_shift(1,Ee.content[we]);for(;we&511;++we)Z.write_shift(1,0)}for(ne=1;ne<R.FileIndex.length;++ne)if(Ee=R.FileIndex[ne],Ee.size>0&&Ee.size<4096)if(jt&&Buffer.isBuffer(Ee.content))Ee.content.copy(Z,Z.l,0,Ee.size),Z.l+=Ee.size+63&-64;else{for(we=0;we<Ee.size;++we)Z.write_shift(1,Ee.content[we]);for(;we&63;++we)Z.write_shift(1,0)}if(jt)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function J(R,te){var K=R.FullPaths.map(function(we){return we.toUpperCase()}),Q=K.map(function(we){var Se=we.split("/");return Se[Se.length-(we.slice(-1)=="/"?2:1)]}),Z=!1;te.charCodeAt(0)===47?(Z=!0,te=K[0].slice(0,-1)+te):Z=te.indexOf("/")!==-1;var ne=te.toUpperCase(),ke=Z===!0?K.indexOf(ne):Q.indexOf(ne);if(ke!==-1)return R.FileIndex[ke];var Fe=!ne.match(sl);for(ne=ne.replace(dn,""),Fe&&(ne=ne.replace(sl,"!")),ke=0;ke<K.length;++ke)if((Fe?K[ke].replace(sl,"!"):K[ke]).replace(dn,"")==ne||(Fe?Q[ke].replace(sl,"!"):Q[ke]).replace(dn,"")==ne)return R.FileIndex[ke];return null}var V=64,de=-2,ue="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:de,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(R,te,K){h();var Q=ae(R,K);f.writeFileSync(te,Q)}function B(R){for(var te=new Array(R.length),K=0;K<R.length;++K)te[K]=String.fromCharCode(R[K]);return te.join("")}function re(R,te){var K=ae(R,te);switch(te&&te.type||"buffer"){case"file":return h(),f.writeFileSync(te.filename,K),K;case"binary":return typeof K=="string"?K:B(K);case"base64":return Wm(typeof K=="string"?K:B(K));case"buffer":if(jt)return Buffer.isBuffer(K)?K:vo(K);case"array":return typeof K=="string"?aa(K):K}return K}var I;function P(R){try{var te=R.InflateRaw,K=new te;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)I=R;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function ce(R,te){if(!I)return vt(R,te);var K=I.InflateRaw,Q=new K,Z=Q._processChunk(R.slice(R.l),Q._finishFlushFlag);return R.l+=Q.bytesRead,Z}function A(R){return I?I.deflateRawSync(R):dt(R)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function W(R){var te=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(te>>16|te>>8|te)&255}for(var z=typeof Uint8Array<"u",O=z?new Uint8Array(256):[],se=0;se<256;++se)O[se]=W(se);function L(R,te){var K=O[R&255];return te<=8?K>>>8-te:(K=K<<8|O[R>>8&255],te<=16?K>>>16-te:(K=K<<8|O[R>>16&255],K>>>24-te))}function Oe(R,te){var K=te&7,Q=te>>>3;return(R[Q]|(K<=6?0:R[Q+1]<<8))>>>K&3}function je(R,te){var K=te&7,Q=te>>>3;return(R[Q]|(K<=5?0:R[Q+1]<<8))>>>K&7}function Ke(R,te){var K=te&7,Q=te>>>3;return(R[Q]|(K<=4?0:R[Q+1]<<8))>>>K&15}function Qe(R,te){var K=te&7,Q=te>>>3;return(R[Q]|(K<=3?0:R[Q+1]<<8))>>>K&31}function he(R,te){var K=te&7,Q=te>>>3;return(R[Q]|(K<=1?0:R[Q+1]<<8))>>>K&127}function Ne(R,te,K){var Q=te&7,Z=te>>>3,ne=(1<<K)-1,ke=R[Z]>>>Q;return K<8-Q||(ke|=R[Z+1]<<8-Q,K<16-Q)||(ke|=R[Z+2]<<16-Q,K<24-Q)||(ke|=R[Z+3]<<24-Q),ke&ne}function Pe(R,te,K){var Q=te&7,Z=te>>>3;return Q<=5?R[Z]|=(K&7)<<Q:(R[Z]|=K<<Q&255,R[Z+1]=(K&7)>>8-Q),te+3}function _e(R,te,K){var Q=te&7,Z=te>>>3;return K=(K&1)<<Q,R[Z]|=K,te+1}function Je(R,te,K){var Q=te&7,Z=te>>>3;return K<<=Q,R[Z]|=K&255,K>>>=8,R[Z+1]=K,te+8}function ft(R,te,K){var Q=te&7,Z=te>>>3;return K<<=Q,R[Z]|=K&255,K>>>=8,R[Z+1]=K&255,R[Z+2]=K>>>8,te+16}function ut(R,te){var K=R.length,Q=2*K>te?2*K:te+5,Z=0;if(K>=te)return R;if(jt){var ne=Um(Q);if(R.copy)R.copy(ne);else for(;Z<R.length;++Z)ne[Z]=R[Z];return ne}else if(z){var ke=new Uint8Array(Q);if(ke.set)ke.set(R);else for(;Z<K;++Z)ke[Z]=R[Z];return ke}return R.length=Q,R}function ht(R){for(var te=new Array(R),K=0;K<R;++K)te[K]=0;return te}function Ot(R,te,K){var Q=1,Z=0,ne=0,ke=0,Fe=0,we=R.length,Se=z?new Uint16Array(32):ht(32);for(ne=0;ne<32;++ne)Se[ne]=0;for(ne=we;ne<K;++ne)R[ne]=0;we=R.length;var Ee=z?new Uint16Array(we):ht(we);for(ne=0;ne<we;++ne)Se[Z=R[ne]]++,Q<Z&&(Q=Z),Ee[ne]=0;for(Se[0]=0,ne=1;ne<=Q;++ne)Se[ne+16]=Fe=Fe+Se[ne-1]<<1;for(ne=0;ne<we;++ne)Fe=R[ne],Fe!=0&&(Ee[ne]=Se[Fe+16]++);var We=0;for(ne=0;ne<we;++ne)if(We=R[ne],We!=0)for(Fe=L(Ee[ne],Q)>>Q-We,ke=(1<<Q+4-We)-1;ke>=0;--ke)te[Fe|ke<<We]=We&15|ne<<4;return Q}var Yt=z?new Uint16Array(512):ht(512),Jt=z?new Uint16Array(32):ht(32);if(!z){for(var Lt=0;Lt<512;++Lt)Yt[Lt]=0;for(Lt=0;Lt<32;++Lt)Jt[Lt]=0}(function(){for(var R=[],te=0;te<32;te++)R.push(5);Ot(R,Jt,32);var K=[];for(te=0;te<=143;te++)K.push(8);for(;te<=255;te++)K.push(9);for(;te<=279;te++)K.push(7);for(;te<=287;te++)K.push(8);Ot(K,Yt,288)})();var Xt=(function(){for(var te=z?new Uint8Array(32768):[],K=0,Q=0;K<N.length-1;++K)for(;Q<N[K+1];++Q)te[Q]=K;for(;Q<32768;++Q)te[Q]=29;var Z=z?new Uint8Array(259):[];for(K=0,Q=0;K<j.length-1;++K)for(;Q<j[K+1];++Q)Z[Q]=K;function ne(Fe,we){for(var Se=0;Se<Fe.length;){var Ee=Math.min(65535,Fe.length-Se),We=Se+Ee==Fe.length;for(we.write_shift(1,+We),we.write_shift(2,Ee),we.write_shift(2,~Ee&65535);Ee-- >0;)we[we.l++]=Fe[Se++]}return we.l}function ke(Fe,we){for(var Se=0,Ee=0,We=z?new Uint16Array(32768):[];Ee<Fe.length;){var Ze=Math.min(65535,Fe.length-Ee);if(Ze<10){for(Se=Pe(we,Se,+(Ee+Ze==Fe.length)),Se&7&&(Se+=8-(Se&7)),we.l=Se/8|0,we.write_shift(2,Ze),we.write_shift(2,~Ze&65535);Ze-- >0;)we[we.l++]=Fe[Ee++];Se=we.l*8;continue}Se=Pe(we,Se,+(Ee+Ze==Fe.length)+2);for(var Ue=0;Ze-- >0;){var $e=Fe[Ee];Ue=(Ue<<5^$e)&32767;var Ye=-1,gt=0;if((Ye=We[Ue])&&(Ye|=Ee&-32768,Ye>Ee&&(Ye-=32768),Ye<Ee))for(;Fe[Ye+gt]==Fe[Ee+gt]&&gt<250;)++gt;if(gt>2){$e=Z[gt],$e<=22?Se=Je(we,Se,O[$e+1]>>1)-1:(Je(we,Se,3),Se+=5,Je(we,Se,O[$e-23]>>5),Se+=3);var Vt=$e<8?0:$e-4>>2;Vt>0&&(ft(we,Se,gt-j[$e]),Se+=Vt),$e=te[Ee-Ye],Se=Je(we,Se,O[$e]>>3),Se-=3;var $t=$e<4?0:$e-2>>1;$t>0&&(ft(we,Se,Ee-Ye-N[$e]),Se+=$t);for(var mr=0;mr<gt;++mr)We[Ue]=Ee&32767,Ue=(Ue<<5^Fe[Ee])&32767,++Ee;Ze-=gt-1}else $e<=143?$e=$e+48:Se=_e(we,Se,1),Se=Je(we,Se,O[$e]),We[Ue]=Ee&32767,++Ee}Se=Je(we,Se,0)-1}return we.l=(Se+7)/8|0,we.l}return function(we,Se){return we.length<8?ne(we,Se):ke(we,Se)}})();function dt(R){var te=Tr(50+Math.floor(R.length*1.1)),K=Xt(R,te);return te.slice(0,K)}var Et=z?new Uint16Array(32768):ht(32768),qt=z?new Uint16Array(32768):ht(32768),Tt=z?new Uint16Array(128):ht(128),Zt=1,Ft=1;function ve(R,te){var K=Qe(R,te)+257;te+=5;var Q=Qe(R,te)+1;te+=5;var Z=Ke(R,te)+4;te+=4;for(var ne=0,ke=z?new Uint8Array(19):ht(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,Se=z?new Uint8Array(8):ht(8),Ee=z?new Uint8Array(8):ht(8),We=ke.length,Ze=0;Ze<Z;++Ze)ke[T[Ze]]=ne=je(R,te),we<ne&&(we=ne),Se[ne]++,te+=3;var Ue=0;for(Se[0]=0,Ze=1;Ze<=we;++Ze)Ee[Ze]=Ue=Ue+Se[Ze-1]<<1;for(Ze=0;Ze<We;++Ze)(Ue=ke[Ze])!=0&&(Fe[Ze]=Ee[Ue]++);var $e=0;for(Ze=0;Ze<We;++Ze)if($e=ke[Ze],$e!=0){Ue=O[Fe[Ze]]>>8-$e;for(var Ye=(1<<7-$e)-1;Ye>=0;--Ye)Tt[Ue|Ye<<$e]=$e&7|Ze<<3}var gt=[];for(we=1;gt.length<K+Q;)switch(Ue=Tt[he(R,te)],te+=Ue&7,Ue>>>=3){case 16:for(ne=3+Oe(R,te),te+=2,Ue=gt[gt.length-1];ne-- >0;)gt.push(Ue);break;case 17:for(ne=3+je(R,te),te+=3;ne-- >0;)gt.push(0);break;case 18:for(ne=11+he(R,te),te+=7;ne-- >0;)gt.push(0);break;default:gt.push(Ue),we<Ue&&(we=Ue);break}var Vt=gt.slice(0,K),$t=gt.slice(K);for(Ze=K;Ze<286;++Ze)Vt[Ze]=0;for(Ze=Q;Ze<30;++Ze)$t[Ze]=0;return Zt=Ot(Vt,Et,286),Ft=Ot($t,qt,30),te}function qe(R,te){if(R[0]==3&&!(R[1]&3))return[As(te),2];for(var K=0,Q=0,Z=Um(te||1<<18),ne=0,ke=Z.length>>>0,Fe=0,we=0;(Q&1)==0;){if(Q=je(R,K),K+=3,Q>>>1)Q>>1==1?(Fe=9,we=5):(K=ve(R,K),Fe=Zt,we=Ft);else{K&7&&(K+=8-(K&7));var Se=R[K>>>3]|R[(K>>>3)+1]<<8;if(K+=32,Se>0)for(!te&&ke<ne+Se&&(Z=ut(Z,ne+Se),ke=Z.length);Se-- >0;)Z[ne++]=R[K>>>3],K+=8;continue}for(;;){!te&&ke<ne+32767&&(Z=ut(Z,ne+32767),ke=Z.length);var Ee=Ne(R,K,Fe),We=Q>>>1==1?Yt[Ee]:Et[Ee];if(K+=We&15,We>>>=4,(We>>>8&255)===0)Z[ne++]=We;else{if(We==256)break;We-=257;var Ze=We<8?0:We-4>>2;Ze>5&&(Ze=0);var Ue=ne+j[We];Ze>0&&(Ue+=Ne(R,K,Ze),K+=Ze),Ee=Ne(R,K,we),We=Q>>>1==1?Jt[Ee]:qt[Ee],K+=We&15,We>>>=4;var $e=We<4?0:We-2>>1,Ye=N[We];for($e>0&&(Ye+=Ne(R,K,$e),K+=$e),!te&&ke<Ue&&(Z=ut(Z,Ue+100),ke=Z.length);ne<Ue;)Z[ne]=Z[ne-Ye],++ne}}}return te?[Z,K+7>>>3]:[Z.slice(0,ne),K+7>>>3]}function vt(R,te){var K=R.slice(R.l||0),Q=qe(K,te);return R.l+=Q[1],Q[0]}function bt(R,te){if(R)typeof console<"u"&&console.error(te);else throw new Error(te)}function fe(R,te){var K=R;Br(K,0);var Q=[],Z=[],ne={FileIndex:Q,FullPaths:Z};F(ne,{root:te.root});for(var ke=K.length-4;(K[ke]!=80||K[ke+1]!=75||K[ke+2]!=5||K[ke+3]!=6)&&ke>=0;)--ke;K.l=ke+4,K.l+=4;var Fe=K.read_shift(2);K.l+=6;var we=K.read_shift(4);for(K.l=we,ke=0;ke<Fe;++ke){K.l+=20;var Se=K.read_shift(4),Ee=K.read_shift(4),We=K.read_shift(2),Ze=K.read_shift(2),Ue=K.read_shift(2);K.l+=8;var $e=K.read_shift(4),Ye=c(K.slice(K.l+We,K.l+We+Ze));K.l+=We+Ze+Ue;var gt=K.l;K.l=$e+4,Re(K,Se,Ee,ne,Ye),K.l=gt}return ne}function Re(R,te,K,Q,Z){R.l+=2;var ne=R.read_shift(2),ke=R.read_shift(2),Fe=l(R);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var we=R.read_shift(4),Se=R.read_shift(4),Ee=R.read_shift(4),We=R.read_shift(2),Ze=R.read_shift(2),Ue="",$e=0;$e<We;++$e)Ue+=String.fromCharCode(R[R.l++]);if(Ze){var Ye=c(R.slice(R.l,R.l+Ze));(Ye[21589]||{}).mt&&(Fe=Ye[21589].mt),((Z||{})[21589]||{}).mt&&(Fe=Z[21589].mt)}R.l+=Ze;var gt=R.slice(R.l,R.l+Se);switch(ke){case 8:gt=ce(R,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Vt=!1;ne&8&&(we=R.read_shift(4),we==134695760&&(we=R.read_shift(4),Vt=!0),Se=R.read_shift(4),Ee=R.read_shift(4)),Se!=te&&bt(Vt,"Bad compressed size: "+te+" != "+Se),Ee!=K&&bt(Vt,"Bad uncompressed size: "+K+" != "+Ee),tt(Q,Ue,gt,{unsafe:!0,mt:Fe})}function ze(R,te){var K=te||{},Q=[],Z=[],ne=Tr(1),ke=K.compression?8:0,Fe=0,we=0,Se=0,Ee=0,We=0,Ze=R.FullPaths[0],Ue=Ze,$e=R.FileIndex[0],Ye=[],gt=0;for(we=1;we<R.FullPaths.length;++we)if(Ue=R.FullPaths[we].slice(Ze.length),$e=R.FileIndex[we],!(!$e.size||!$e.content||Ue=="Sh33tJ5")){var Vt=Ee,$t=Tr(Ue.length);for(Se=0;Se<Ue.length;++Se)$t.write_shift(1,Ue.charCodeAt(Se)&127);$t=$t.slice(0,$t.l),Ye[We]=h2.buf($e.content,0);var mr=$e.content;ke==8&&(mr=A(mr)),ne=Tr(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,Fe),ne.write_shift(2,ke),$e.mt?o(ne,$e.mt):ne.write_shift(4,0),ne.write_shift(-4,Ye[We]),ne.write_shift(4,mr.length),ne.write_shift(4,$e.content.length),ne.write_shift(2,$t.length),ne.write_shift(2,0),Ee+=ne.length,Q.push(ne),Ee+=$t.length,Q.push($t),Ee+=mr.length,Q.push(mr),ne=Tr(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,Fe),ne.write_shift(2,ke),ne.write_shift(4,0),ne.write_shift(-4,Ye[We]),ne.write_shift(4,mr.length),ne.write_shift(4,$e.content.length),ne.write_shift(2,$t.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,Vt),gt+=ne.l,Z.push(ne),gt+=$t.length,Z.push($t),++We}return ne=Tr(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,We),ne.write_shift(2,We),ne.write_shift(4,gt),ne.write_shift(4,Ee),ne.write_shift(2,0),Es([Es(Q),Es(Z),ne])}var X={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function me(R,te){if(R.ctype)return R.ctype;var K=R.name||"",Q=K.match(/\.([^\.]+)$/);return Q&&X[Q[1]]||te&&(Q=(K=te).match(/[\.\\]([^\.\\])+$/),Q&&X[Q[1]])?X[Q[1]]:"application/octet-stream"}function Te(R){for(var te=Wm(R),K=[],Q=0;Q<te.length;Q+=76)K.push(te.slice(Q,Q+76));return K.join(`\r
`)+`\r
`}function Ae(R){var te=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var Ee=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Q=te.split(`\r
`),Z=0;Z<Q.length;++Z){var ne=Q[Z];if(ne.length==0){K.push("");continue}for(var ke=0;ke<ne.length;){var Fe=76,we=ne.slice(ke,ke+Fe);we.charAt(Fe-1)=="="?Fe--:we.charAt(Fe-2)=="="?Fe-=2:we.charAt(Fe-3)=="="&&(Fe-=3),we=ne.slice(ke,ke+Fe),ke+=Fe,ke<ne.length&&(we+="="),K.push(we)}}return K.join(`\r
`)}function Be(R){for(var te=[],K=0;K<R.length;++K){for(var Q=R[K];K<=R.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+R[++K];te.push(Q)}for(var Z=0;Z<te.length;++Z)te[Z]=te[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return aa(te.join(`\r
`))}function et(R,te,K){for(var Q="",Z="",ne="",ke,Fe=0;Fe<10;++Fe){var we=te[Fe];if(!we||we.match(/^\s*$/))break;var Se=we.match(/^(.*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":Q=Se[2].trim();break;case"content-type":ne=Se[2].trim();break;case"content-transfer-encoding":Z=Se[2].trim();break}}switch(++Fe,Z.toLowerCase()){case"base64":ke=aa(Tn(te.slice(Fe).join("")));break;case"quoted-printable":ke=Be(te.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var Ee=tt(R,Q.slice(K.length),ke,{unsafe:!0});ne&&(Ee.ctype=ne)}function pt(R,te){if(B(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=te&&te.root||"",Q=(jt&&Buffer.isBuffer(R)?R.toString("binary"):B(R)).split(`\r
`),Z=0,ne="";for(Z=0;Z<Q.length;++Z)if(ne=Q[Z],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),K||(K=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),ne.slice(0,K.length)!=K););var ke=(Q[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Fe="--"+(ke[1]||""),we=[],Se=[],Ee={FileIndex:we,FullPaths:Se};F(Ee);var We,Ze=0;for(Z=0;Z<Q.length;++Z){var Ue=Q[Z];Ue!==Fe&&Ue!==Fe+"--"||(Ze++&&et(Ee,Q.slice(We,Z),K),We=Z)}return Ee}function Wt(R,te){var K=te||{},Q=K.boundary||"SheetJS";Q="------="+Q;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],ne=R.FullPaths[0],ke=ne,Fe=R.FileIndex[0],we=1;we<R.FullPaths.length;++we)if(ke=R.FullPaths[we].slice(ne.length),Fe=R.FileIndex[we],!(!Fe.size||!Fe.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gt){return"_x"+gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gt){return"_u"+gt.charCodeAt(0).toString(16)+"_"});for(var Se=Fe.content,Ee=jt&&Buffer.isBuffer(Se)?Se.toString("binary"):B(Se),We=0,Ze=Math.min(1024,Ee.length),Ue=0,$e=0;$e<=Ze;++$e)(Ue=Ee.charCodeAt($e))>=32&&Ue<128&&++We;var Ye=We>=Ze*4/5;Z.push(Q),Z.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ke),Z.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),Z.push("Content-Type: "+me(Fe,ke)),Z.push(""),Z.push(Ye?Ae(Ee):Te(Ee))}return Z.push(Q+`--\r
`),Z.join(`\r
`)}function Ge(R){var te={};return F(te,R),te}function tt(R,te,K,Q){var Z=Q&&Q.unsafe;Z||F(R);var ne=!Z&&Pt.find(R,te);if(!ne){var ke=R.FullPaths[0];te.slice(0,ke.length)==ke?ke=te:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+te).replace("//","/")),ne={name:a(te),type:2},R.FileIndex.push(ne),R.FullPaths.push(ke),Z||Pt.utils.cfb_gc(R)}return ne.content=K,ne.size=K?K.length:0,Q&&(Q.CLSID&&(ne.clsid=Q.CLSID),Q.mt&&(ne.mt=Q.mt),Q.ct&&(ne.ct=Q.ct)),ne}function Me(R,te){F(R);var K=Pt.find(R,te);if(K){for(var Q=0;Q<R.FileIndex.length;++Q)if(R.FileIndex[Q]==K)return R.FileIndex.splice(Q,1),R.FullPaths.splice(Q,1),!0}return!1}function rt(R,te,K){F(R);var Q=Pt.find(R,te);if(Q){for(var Z=0;Z<R.FileIndex.length;++Z)if(R.FileIndex[Z]==Q)return R.FileIndex[Z].name=a(K),R.FullPaths[Z]=K,!0}return!1}function kt(R){U(R,!0)}return n.find=J,n.read=G,n.parse=p,n.write=re,n.writeFile=oe,n.utils={cfb_new:Ge,cfb_add:tt,cfb_del:Me,cfb_mov:rt,cfb_gc:kt,ReadShift:ul,CheckField:Ty,prep_blob:Br,bconcat:Es,use_zlib:P,_deflateRaw:dt,_inflateRaw:vt,consts:q},n})();function x2(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ca(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function lp(e){for(var n=[],t=Ca(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var Cu=new Date(1899,11,30,0,0,0);function fn(e,n){var t=e.getTime(),r=Cu.getTime()+(e.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var iy=new Date,m2=Cu.getTime()+(iy.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4,Xm=iy.getTimezoneOffset();function Xu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+m2),n.getTimezoneOffset()!==Xm&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Xm)*6e4),n}function g2(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var qm=new Date("2017-02-19T19:06:09.000Z"),ly=isNaN(qm.getFullYear())?new Date("2/19/17"):qm,v2=ly.getFullYear()==2017;function zr(e,n){var t=new Date(e);if(v2)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(ly.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function fo(e,n){if(jt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return il(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return il(Gv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return il(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return il(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=Ur(e[t]));return n}function pr(e,n){for(var t="";t.length<n;)t+=e;return t}function ia(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var y2=["january","february","march","april","may","june","july","august","september","october","november","december"];function li(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&y2.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var w2=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function cy(e){return e?e.content&&e.type?fo(e.content,!0):e.data?al(e.data):e.asNodeBuffer&&jt?al(e.asNodeBuffer().toString("binary")):e.asBinary?al(e.asBinary()):e._data&&e._data.getContent?al(fo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function uy(e){if(!e)return null;if(e.data)return Lm(e.data);if(e.asNodeBuffer&&jt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Lm(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function k2(e){return e&&e.name.slice(-4)===".bin"?uy(e):cy(e)}function Bn(e,n){for(var t=e.FullPaths||Ca(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function cp(e,n){var t=Bn(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function Sr(e,n,t){if(!t)return k2(cp(e,n));if(!n)return null;try{return Sr(e,n)}catch{return null}}function Nn(e,n,t){if(!t)return cy(cp(e,n));if(!n)return null;try{return Nn(e,n)}catch{return null}}function b2(e,n,t){return uy(cp(e,n))}function Zm(e){for(var n=e.FullPaths||Ca(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function _2(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return jt?r=vo(t):r=Ub(t),Pt.utils.cfb_add(e,n,r)}Pt.utils.cfb_add(e,n,t)}else e.file(n,t)}function dy(e,n){switch(n.type){case"base64":return Pt.read(e,{type:"base64"});case"binary":return Pt.read(e,{type:"binary"});case"buffer":case"array":return Pt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ol(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var fy=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,S2=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Jm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,E2=/<[^>]*>/g,en=fy.match(Jm)?Jm:E2,N2=/<\w*:/,C2=/<(\/?)\w+:/;function yt(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(S2),c=0,f="",h=0,p="",m="",g=1;if(l)for(h=0;h!=l.length;++h){for(m=l[h],o=0;o!=m.length&&m.charCodeAt(o)!==61;++o);for(p=m.slice(0,o).trim();m.charCodeAt(o+1)==32;)++o;for(g=(a=m.charCodeAt(o+1))==34||a==39?1:0,f=m.slice(o+1+g,m.length-g),c=0;c!=p.length&&p.charCodeAt(c)!==58;++c);if(c===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=f,r[p.toLowerCase()]=f;else{var v=(c===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(c+1);if(r[v]&&p.slice(c-3,c)=="ext")continue;r[v]=f,r[v.toLowerCase()]=f}}return r}function Da(e){return e.replace(C2,"<$1")}var py={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},T2=lp(py),It=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return py[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),D2=/[&<>'"]/g,F2=/[\u0000-\u001f]/g;function up(e){var n=e+"";return n.replace(D2,function(t){return T2[t]}).replace(/\n/g,"<br/>").replace(F2,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var eg=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function ir(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function J0(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function tg(e){var n=As(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function rg(e){return vo(e,"binary").toString("utf8")}var eu="foo bar baz",rr=jt&&(rg(eu)==J0(eu)&&rg||tg(eu)==J0(eu)&&tg)||J0,il=jt?function(e){return vo(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},bl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),hy=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),j2=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),P2=/<\/?(?:vt:)?variant>/g,A2=/<(?:vt:)([^>]*)>([\s\S]*)</;function ng(e,n){var t=yt(e),r=e.match(j2(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(P2,"").match(A2);l&&a.push({v:rr(l[2]),t:l[1]})}),a}var O2=/(^\s|\s$|\n)/;function R2(e){return Ca(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function z2(e,n,t){return"<"+e+(t!=null?R2(t):"")+(n!=null?(n.match(O2)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function dp(e){if(jt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return rr(yo(sp(e)));throw new Error("Bad input format: expected Buffer or string")}var _l=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,M2={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},I2=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function L2(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function B2(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var ag=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},sg=jt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:vo(n)})):ag(e)}:ag,og=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(Ya(e,a)));return r.join("").replace(dn,"")},fp=jt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(dn,""):og(e,n,t)}:og,ig=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},xy=jt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):ig(e,n,t)}:ig,lg=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Zo(e,a)));return r.join("")},Al=jt?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):lg(n,t,r)}:lg,my=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},gy=my,vy=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},yy=vy,wy=function(e,n){var t=2*En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},ky=wy,by=function(n,t){var r=En(n,t);return r>0?fp(n,t+4,t+4+r):""},_y=by,Sy=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t):""},Ey=Sy,Ny=function(e,n){return L2(e,n)},Tu=Ny,Cy=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};jt&&(gy=function(n,t){if(!Buffer.isBuffer(n))return my(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},yy=function(n,t){if(!Buffer.isBuffer(n))return vy(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},ky=function(n,t){if(!Buffer.isBuffer(n))return wy(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},_y=function(n,t){if(!Buffer.isBuffer(n))return by(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},Ey=function(n,t){if(!Buffer.isBuffer(n))return Sy(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Tu=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):Ny(n,t)},Cy=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Zo=function(e,n){return e[n]},Ya=function(e,n){return e[n+1]*256+e[n]},W2=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},En=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},eo=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},U2=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ul(e,n){var t="",r,a,o=[],l,c,f,h;switch(n){case"dbcs":if(h=this.l,jt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(Ya(this,h)),h+=2;e*=2;break;case"utf8":t=Al(this,this.l,this.l+e);break;case"utf16le":e*=2,t=fp(this,this.l,this.l+e);break;case"wstr":return ul.call(this,e,"dbcs");case"lpstr-ansi":t=gy(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":t=yy(this,this.l),e=4+En(this,this.l);break;case"lpwstr":t=ky(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),t=_y(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),t=Ey(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Zo(this,this.l+e++))!==0;)o.push(Jc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=Ya(this,this.l+e))!==0;)o.push(Jc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Ya(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Zo(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return r=Zo(this,this.l),this.l++,r;case 2:return r=(n==="i"?W2:Ya)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?eo:U2)(this,this.l),this.l+=4,r):(a=En(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Tu(this,this.l):a=Tu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=xy(this,this.l,e);break}}return this.l+=e,t}var $2=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},H2=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},Y2=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function V2(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)Y2(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,$2(this,n,this.l);break;case 8:if(r=8,t==="f"){B2(this,n,this.l);break}case 16:break;case-4:r=4,H2(this,n,this.l);break}return this.l+=r,this}function Ty(e,n){var t=xy(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Br(e,n){e.l=n,e.read_shift=ul,e.chk=Ty,e.write_shift=V2}function Jr(e,n){e.l+=n}function Tr(e){var n=As(e);return Br(n,0),n}function ts(e,n,t){if(e){var r,a,o;Br(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var h=Ou[c]||Ou[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var p=h.f&&h.f(e,o,t);if(e.l=f,n(p,h,c))return}}}function Nf(){var e=[],n=jt?256:2048,t=function(h){var p=Tr(h);return Br(p,0),p},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=t(Math.max(h+1,n)))},l=function(){return a(),Es(e)},c=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function dl(e,n,t){var r=Ur(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function cg(e,n,t){var r=Ur(e);return r.s=dl(r.s,n.s,t),r.e=dl(r.e,n.s,t),r}function fl(e,n){if(e.cRel&&e.c<0)for(e=Ur(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Ur(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=_t(e);return!e.cRel&&e.cRel!=null&&(t=Q2(t)),!e.rRel&&e.rRel!=null&&(t=K2(t)),t}function ef(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dr(e.s.c)+":"+(e.e.cRel?"":"$")+Dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$r(e.s.r)+":"+(e.e.rRel?"":"$")+$r(e.e.r):fl(e.s,n.biff)+":"+fl(e.e,n.biff)}function pp(e){return parseInt(G2(e),10)-1}function $r(e){return""+(e+1)}function K2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function G2(e){return e.replace(/\$(\d+)$/,"$1")}function hp(e){for(var n=X2(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Dr(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function Q2(e){return e.replace(/^([A-Z])/,"$$$1")}function X2(e){return e.replace(/^\$([A-Z])/,"$1")}function q2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function _t(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function gi(e){var n=e.indexOf(":");return n==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,n)),e:ln(e.slice(n+1))}}function At(e,n){return typeof n>"u"||typeof n=="number"?At(e.s,e.e):(typeof e!="string"&&(e=_t(e)),typeof n!="string"&&(n=_t(n)),e==n?e:e+":"+n)}function hr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function ug(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Vn(e.z,t?fn(n):n)}catch{}try{return e.w=Vn((e.XF||{}).numFmtId||(t?14:0),t?fn(n):n)}catch{return""+n}}function Ja(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?bo[e.v]||e.v:n==null?ug(e,e.v):ug(e,n))}function Ms(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function Dy(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=hr(o["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),l==-1&&(h.e.r=l=p.e.r+1)}for(var m=0;m!=n.length;++m)if(n[m]){if(!Array.isArray(n[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[m].length;++g)if(!(typeof n[m][g]>"u")){var v={v:n[m][g]},w=l+m,b=c+g;if(h.s.r>w&&(h.s.r=w),h.s.c>b&&(h.s.c=b),h.e.r<w&&(h.e.r=w),h.e.c<b&&(h.e.c=b),n[m][g]&&typeof n[m][g]=="object"&&!Array.isArray(n[m][g])&&!(n[m][g]instanceof Date))v=n[m][g];else if(Array.isArray(v.v)&&(v.f=n[m][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(r.nullError)v.t="e",v.v=0;else if(r.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=r.dateNF||St[14],r.cellDates?(v.t="d",v.w=Vn(v.z,fn(v.v))):(v.t="n",v.v=fn(v.v),v.w=Vn(v.z,v.v))):v.t="s";if(a)o[w]||(o[w]=[]),o[w][b]&&o[w][b].z&&(v.z=o[w][b].z),o[w][b]=v;else{var k=_t({c:b,r:w});o[k]&&o[k].z&&(v.z=o[k].z),o[k]=v}}}return h.s.c<1e7&&(o["!ref"]=At(h)),o}function vi(e,n){return Dy(null,e,n)}function Z2(e){return e.read_shift(4,"i")}function Zr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function J2(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function xp(e,n){var t=e.l,r=e.read_shift(1),a=Zr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(J2(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var e_=xp;function Gn(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function wo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var t_=Zr;function mp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var r_=Zr,Cf=mp;function gp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Tu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):eo(n,0)>>2;return t?a/100:a}function Fy(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var ko=Fy;function Xr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function n_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var h=so[a];h&&(n.rgb=El(h));break;case 2:n.rgb=El([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function a_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function jy(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function s_(e){return jy(e,1)}function o_(e){return jy(e,2)}var vp=2,wn=3,tu=11,dg=12,Du=19,ru=64,i_=65,l_=71,c_=4108,u_=4126,Rr=80,Py=81,d_=[Rr,Py],f_={1:{n:"CodePage",t:vp},2:{n:"Category",t:Rr},3:{n:"PresentationFormat",t:Rr},4:{n:"ByteCount",t:wn},5:{n:"LineCount",t:wn},6:{n:"ParagraphCount",t:wn},7:{n:"SlideCount",t:wn},8:{n:"NoteCount",t:wn},9:{n:"HiddenCount",t:wn},10:{n:"MultimediaClipCount",t:wn},11:{n:"ScaleCrop",t:tu},12:{n:"HeadingPairs",t:c_},13:{n:"TitlesOfParts",t:u_},14:{n:"Manager",t:Rr},15:{n:"Company",t:Rr},16:{n:"LinksUpToDate",t:tu},17:{n:"CharacterCount",t:wn},19:{n:"SharedDoc",t:tu},22:{n:"HyperlinksChanged",t:tu},23:{n:"AppVersion",t:wn,p:"version"},24:{n:"DigSig",t:i_},26:{n:"ContentType",t:Rr},27:{n:"ContentStatus",t:Rr},28:{n:"Language",t:Rr},29:{n:"Version",t:Rr},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},p_={1:{n:"CodePage",t:vp},2:{n:"Title",t:Rr},3:{n:"Subject",t:Rr},4:{n:"Author",t:Rr},5:{n:"Keywords",t:Rr},6:{n:"Comments",t:Rr},7:{n:"Template",t:Rr},8:{n:"LastAuthor",t:Rr},9:{n:"RevNumber",t:Rr},10:{n:"EditTime",t:ru},11:{n:"LastPrinted",t:ru},12:{n:"CreatedDate",t:ru},13:{n:"ModifiedDate",t:ru},14:{n:"PageCount",t:wn},15:{n:"WordCount",t:wn},16:{n:"CharCount",t:wn},17:{n:"Thumbnail",t:l_},18:{n:"Application",t:Rr},19:{n:"DocSecurity",t:wn},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},fg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},h_=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function x_(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var m_=x_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),so=Ur(m_),bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ay={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function g_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function v_(e){var n=g_();if(!e||!e.match)return n;var t={};if((e.match(en)||[]).forEach(function(r){var a=yt(r);switch(a[0].replace(N2,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[pg[a.ContentType]]!==void 0&&n[pg[a.ContentType]].push(a.PartName);break}}),n.xmlns!==M2.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var ei={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tf(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function pl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(en)||[]).forEach(function(a){var o=yt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:ol(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var y_="application/vnd.oasis.opendocument.spreadsheet";function w_(e,n){for(var t=dp(e),r,a;r=_l.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=yt(r[0],!1),a.path=="/"&&a.type!==y_)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var hl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],k_=(function(){for(var e=new Array(hl.length),n=0;n<hl.length;++n){var t=hl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function Oy(e){var n={};e=rr(e);for(var t=0;t<hl.length;++t){var r=hl[t],a=e.match(k_[t]);a!=null&&a.length>0&&(n[r[1]]=It(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=zr(n[r[1]]))}return n}var b_=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Ry(e,n,t,r){var a=[];if(typeof e=="string")a=ng(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(p){return{v:p}}));var l=typeof n=="string"?ng(n,r).map(function(p){return p.v}):n,c=0,f=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function __(e,n,t){var r={};return n||(n={}),e=rr(e),b_.forEach(function(a){var o=(e.match(bl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=It(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&Ry(r.HeadingPairs,r.TitlesOfParts,n,t),n}var S_=/<[^>]+>[^<]*/g;function E_(e,n){var t={},r="",a=e.match(S_);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=yt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=It(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),p=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[r]=It(p);break;case"bool":t[r]=ir(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(p);break;case"filetime":case"date":t[r]=zr(p);break;case"cy":case"error":t[r]=It(p);break;default:if(h.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var N_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},tf;function C_(e,n,t){tf||(tf=lp(N_)),n=tf[n]||n,e[n]=t}function yp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zy(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function My(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function Iy(e,n,t){return n===31?My(e):zy(e,n,t)}function Df(e,n,t){return Iy(e,n,t===!1?0:4)}function T_(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return Iy(e,n,0)}function D_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(dn,""),e.l-a&2&&(e.l+=2)}return t}function F_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(dn,"");return t}function j_(e){var n=e.l,t=Fu(e,Py);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Fu(e,wn);return[t,r]}function P_(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(j_(e));return t}function hg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(dn,"").replace(sl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function Ly(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function A_(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Fu(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==dg&&r!==n&&d_.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===dg?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return zy(e,r,4).replace(dn,"");case 31:return My(e);case 64:return yp(e);case 65:return Ly(e);case 71:return A_(e);case 80:return Df(e,r,!o.raw).replace(dn,"");case 81:return T_(e,r).replace(dn,"");case 4108:return P_(e);case 4126:case 4127:return r==4127?D_(e):F_(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function xg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,h={};for(l=0;l!=a;++l){var p=e.read_shift(4),m=e.read_shift(4);o[l]=[p,m+t]}o.sort(function(D,E){return D[1]-E[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var v=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,v=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(v=!1,e.l=o[l][1]),v)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var w=n[o[l][0]];if(g[w.n]=Fu(e,w.t,{raw:!0}),w.p==="version"&&(g[w.n]=String(g[w.n]>>16)+"."+("0000"+String(g[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(g[w.n]){case 0:g[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:sa(c=g[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[w.n])}}else if(o[l][0]===1){if(c=g.CodePage=Fu(e,vp),sa(c),f!==-1){var b=e.l;e.l=o[f][1],h=hg(e,c),e.l=b}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}h=hg(e,c)}else{var k=h[o[l][0]],C;switch(e[e.l]){case 65:e.l+=4,C=Ly(e);break;case 30:e.l+=4,C=Df(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=Df(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=yr(e,4);break;case 64:e.l+=4,C=zr(yp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[k]=C}}return e.l=t+r,g}function mg(e,n,t){var r=e.content;if(!r)return{};Br(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),p=r.read_shift(16);if(p!==Pt.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var m=xg(r,n),g={SystemIdentifier:h};for(var v in m)g[v]=m[v];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var w;try{w=xg(r,null)}catch{}for(v in w)g[v]=w[v];return g.FMTID=[o,l],g}function _s(e,n){return e.read_shift(n),null}function O_(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function yr(e,n){return e.read_shift(n)===1}function Er(e){return e.read_shift(2,"u")}function By(e,n){return O_(e,n,Er)}function R_(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Ol(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function z_(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",p=n===0?"":e.read_shift(n,h);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function po(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Rl(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):po(e,r,t)}function _o(e,n,t){if(t.biff>5)return Rl(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function M_(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function I_(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(dn,"");return r&&(e.l+=24),a}function L_(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(dn,"");return t+l}function B_(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return I_(e);case"0303000000000000c000000000000046":return L_(e);default:throw new Error("Unsupported Moniker "+t)}}function nu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(dn,""):"";return t}function W_(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,h="",p,m;a&16&&(o=nu(e,t-e.l)),a&128&&(l=nu(e,t-e.l)),(a&257)===257&&(c=nu(e,t-e.l)),(a&257)===1&&(f=B_(e,t-e.l)),a&8&&(h=nu(e,t-e.l)),a&32&&(p=e.read_shift(16)),a&64&&(m=yp(e)),e.l=t;var g=l||c||f||"";g&&h&&(g+="#"+h),g||(g="#"+h),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return p&&(v.guid=p),m&&(v.time=m),o&&(v.Tooltip=o),v}function Wy(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function Uy(e,n){var t=Wy(e);return t[3]=0,t}function Fa(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function U_(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function $_(e,n,t){return n===0?"":_o(e,n,t)}function H_(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function $y(e){var n=e.read_shift(2),t=gp(e);return[n,t]}function Y_(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Ol(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function qu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function Hy(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var V_=Hy;function Yy(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function K_(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function G_(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Gr(e){e.l+=2,e.l+=e.read_shift(2)}var Q_={0:Gr,4:Gr,5:Gr,6:Gr,7:G_,8:Gr,9:Gr,10:Gr,11:Gr,12:Gr,13:K_,14:Gr,15:Gr,16:Gr,17:Gr,18:Gr,19:Gr,20:Gr,21:Yy};function X_(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push(Q_[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function au(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function q_(e,n){return n===0||e.read_shift(2),1200}function Z_(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=_o(e,0,t);return e.read_shift(n+r-e.l),a}function J_(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function eS(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Ol(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function tS(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(z_(e));return o.Count=r,o.Unique=a,o}function rS(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function nS(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function aS(e){var n=U_(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function sS(e){return e.read_shift(2),e.read_shift(4)}function gg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function oS(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),h=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:h}}function iS(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function lS(){}function cS(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Ol(e,0,t),r}function uS(e){var n=Fa(e);return n.isst=e.read_shift(4),n}function dS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=Fa(e);t.biff==2&&e.l++;var o=Rl(e,r-e.l,t);return a.val=o,a}function fS(e,n,t){var r=e.read_shift(2),a=_o(e,0,t);return[r,a]}var pS=_o;function vg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function hS(e){var n=e.read_shift(2),t=e.read_shift(2),r=$y(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function xS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push($y(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function mS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function gS(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=h_[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function vS(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=gS(e,n,r.fStyle,t),r}function yS(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function yg(e,n,t){var r=Fa(e);(t.biff==2||n==9)&&++e.l;var a=R_(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function wS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Fa(e),a=Xr(e);return r.val=a,r}var wg=$_;function kS(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=po(e,o),c=[];r>e.l;)c.push(Rl(e));return[o,a,l,c]}function kg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=Y_(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var bS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function bg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=po(e,l,t);a&32&&(h=bS[h.charCodeAt(0)]);var p=r-e.l;t&&t.biff==2&&--p;var m=r==e.l||c===0||!(p>0)?[]:nT(e,p,t,c);return{chKey:o,Name:h,itab:f,rgce:m}}function Vy(e,n,t){if(t.biff<8)return _S(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(H_(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function _S(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Ol(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function SS(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=po(e,r,t),l=po(e,a,t);return[o,l]}function ES(e,n,t){var r=Hy(e);e.l++;var a=e.read_shift(1);return n-=8,[aT(e,n,t),a,r]}function _g(e,n,t){var r=V_(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,tT(e,n,t)]}function NS(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function CS(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=_o(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function TS(e,n,t){return CS(e,n,t)}function DS(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(qu(e));return t}function FS(e,n,t){if(t&&t.biff<8)return PS(e,n,t);var r=Yy(e),a=X_(e,n-22,r[1]);return{cmo:r,ft:a}}var jS={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function PS(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((jS[r]||Jr)(e,n,t)),{cmo:[a,r,o],ft:l}}function AS(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=M_(e,6,t);var c=e.read_shift(2);e.read_shift(2),Er(e,2);var f=e.read_shift(2);e.l+=f;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],m=po(e,e.lens[h+1]-e.lens[h]-1);if(a+=m,a.length>=(p?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function OS(e,n){var t=qu(e);e.l+=16;var r=W_(e,n-24);return[t,r]}function RS(e,n){e.read_shift(2);var t=qu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(dn,""),[t,r]}function zS(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=fg[t]||t,t=e.read_shift(2),n[1]=fg[t]||t,n}function MS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(Uy(e));return t}function IS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(Uy(e));return t}function LS(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Ky(e,n,t){if(!t.cellStyles)return Jr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var h={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(h.level=f>>8&7),h}function BS(e,n){var t={};return n<32||(e.l+=16,t.header=Xr(e),t.footer=Xr(e),e.l+=2),t}function WS(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var US=Fa,$S=By,HS=Rl;function YS(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function VS(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Fa(e);++e.l;var a=_o(e,n-7,t);return r.t="str",r.val=a,r}function KS(e){var n=Fa(e);++e.l;var t=Xr(e);return n.t="n",n.val=t,n}function GS(e){var n=Fa(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function QS(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function XS(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function qS(e,n,t){var r=e.l+n,a=Fa(e),o=e.read_shift(2),l=po(e,o,t);return e.l=r,a.t="str",a.val=l,a}var ZS=[2,3,48,49,131,139,140,245],Sg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=lp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var h=[],p=As(1);switch(f.type){case"base64":p=aa(Tn(c));break;case"binary":p=aa(c);break;case"buffer":case"array":p=c;break}Br(p,0);var m=p.read_shift(1),g=!!(m&136),v=!1,w=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var b=0,k=521;m==2&&(b=p.read_shift(2)),p.l+=3,m!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),m!=2&&(k=p.read_shift(2));var C=p.read_shift(2),D=f.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(D=e[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var E=[],Y={},ee=Math.min(p.length,m==2?521:k-10-(v?264:0)),G=w?32:11;p.l<ee&&p[p.l]!=13;)switch(Y={},Y.name=wl.utils.decode(D,p.slice(p.l,p.l+G)).replace(/[\u0000\r\n].*$/g,""),p.l+=G,Y.type=String.fromCharCode(p.read_shift(1)),m!=2&&!w&&(Y.offset=p.read_shift(4)),Y.len=p.read_shift(1),m==2&&(Y.offset=p.read_shift(2)),Y.dec=p.read_shift(1),Y.name.length&&E.push(Y),m!=2&&(p.l+=w?13:14),Y.type){case"B":(!v||Y.len!=8)&&f.WTF&&console.log("Skipping "+Y.name+":"+Y.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+Y.name+":"+Y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Y.type)}if(p[p.l]!==13&&(p.l=k-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=k;var F=0,H=0;for(h[0]=[],H=0;H!=E.length;++H)h[0][H]=E[H].name;for(;b-- >0;){if(p[p.l]===42){p.l+=C;continue}for(++p.l,h[++F]=[],H=0,H=0;H!=E.length;++H){var U=p.slice(p.l,p.l+E[H].len);p.l+=E[H].len,Br(U,0);var ae=wl.utils.decode(D,U);switch(E[H].type){case"C":ae.trim().length&&(h[F][H]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?h[F][H]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):h[F][H]=ae;break;case"F":h[F][H]=parseFloat(ae.trim());break;case"+":case"I":h[F][H]=w?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":h[F][H]=!0;break;case"N":case"F":h[F][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[F][H]="##MEMO##"+(w?parseInt(ae.trim(),10):U.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(h[F][H]=+ae||0);break;case"@":h[F][H]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":h[F][H]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":h[F][H]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[F][H]=-U.read_shift(-8,"f");break;case"B":if(v&&E[H].len==8){h[F][H]=U.read_shift(8,"f");break}case"G":case"P":U.l+=E[H].len;break;case"0":if(E[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[H].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=E,h}function r(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var p=vi(t(c,h),h);return p["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,p}function a(c,f){try{return Ms(r(c,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var h=f||{};if(+h.codepage>=0&&sa(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Nf(),m=zf(c,{header:1,raw:!0,cellDates:!0}),g=m[0],v=m.slice(1),w=c["!cols"]||[],b=0,k=0,C=0,D=1;for(b=0;b<g.length;++b){if(((w[b]||{}).DBF||{}).name){g[b]=w[b].DBF.name,++C;continue}if(g[b]!=null){if(++C,typeof g[b]=="number"&&(g[b]=g[b].toString(10)),typeof g[b]!="string")throw new Error("DBF Invalid column name "+g[b]+" |"+typeof g[b]+"|");if(g.indexOf(g[b])!==b){for(k=0;k<1024;++k)if(g.indexOf(g[b]+"_"+k)==-1){g[b]+="_"+k;break}}}}var E=hr(c["!ref"]),Y=[],ee=[],G=[];for(b=0;b<=E.e.c-E.s.c;++b){var F="",H="",U=0,ae=[];for(k=0;k<v.length;++k)v[k][b]!=null&&ae.push(v[k][b]);if(ae.length==0||g[b]==null){Y[b]="?";continue}for(k=0;k<ae.length;++k){switch(typeof ae[k]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=ae[k]instanceof Date?"D":"C";break;default:H="C"}U=Math.max(U,String(ae[k]).length),F=F&&F!=H?"C":H}U>250&&(U=250),H=((w[b]||{}).DBF||{}).type,H=="C"&&w[b].DBF.len>U&&(U=w[b].DBF.len),F=="B"&&H=="N"&&(F="N",G[b]=w[b].DBF.dec,U=w[b].DBF.len),ee[b]=F=="C"||H=="N"?U:o[F]||0,D+=ee[b],Y[b]=F}var J=p.next(32);for(J.write_shift(4,318902576),J.write_shift(4,v.length),J.write_shift(2,296+32*C),J.write_shift(2,D),b=0;b<4;++b)J.write_shift(4,0);for(J.write_shift(4,0|(+n[Vv]||3)<<8),b=0,k=0;b<g.length;++b)if(g[b]!=null){var V=p.next(32),de=(g[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,de,"sbcs"),V.write_shift(1,Y[b]=="?"?"C":Y[b],"sbcs"),V.write_shift(4,k),V.write_shift(1,ee[b]||o[Y[b]]||0),V.write_shift(1,G[b]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),k+=ee[b]||o[Y[b]]||0}var ue=p.next(264);for(ue.write_shift(4,13),b=0;b<65;++b)ue.write_shift(4,0);for(b=0;b<v.length;++b){var le=p.next(D);for(le.write_shift(1,0),k=0;k<g.length;++k)if(g[k]!=null)switch(Y[k]){case"L":le.write_shift(1,v[b][k]==null?63:v[b][k]?84:70);break;case"B":le.write_shift(8,v[b][k]||0,"f");break;case"N":var pe="0";for(typeof v[b][k]=="number"&&(pe=v[b][k].toFixed(G[k]||0)),C=0;C<ee[k]-pe.length;++C)le.write_shift(1,32);le.write_shift(1,pe,"sbcs");break;case"D":v[b][k]?(le.write_shift(4,("0000"+v[b][k].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(v[b][k].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+v[b][k].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var q=String(v[b][k]!=null?v[b][k]:"").slice(0,ee[k]);for(le.write_shift(1,q,"sbcs"),C=0;C<ee[k]-q.length;++C)le.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),JS=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ca(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,v){var w=e[v];return typeof w=="number"?Bm(w):w},r=function(g,v,w){var b=v.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?g:Bm(b)};e["|"]=254;function a(g,v){switch(v.type){case"base64":return o(Tn(g),v);case"binary":return o(g,v);case"buffer":return o(jt&&Buffer.isBuffer(g)?g.toString("binary"):yo(g),v);case"array":return o(fo(g),v)}throw new Error("Unrecognized type "+v.type)}function o(g,v){var w=g.split(/[\n\r]+/),b=-1,k=-1,C=0,D=0,E=[],Y=[],ee=null,G={},F=[],H=[],U=[],ae=0,J;for(+v.codepage>=0&&sa(+v.codepage);C!==w.length;++C){ae=0;var V=w[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),de=V.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),ue=de[0],le;if(V.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":de[1].charAt(0)=="P"&&Y.push(V.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,q=!1,oe=!1,B=!1,re=-1,I=-1;for(D=1;D<de.length;++D)switch(de[D].charAt(0)){case"A":break;case"X":k=parseInt(de[D].slice(1))-1,q=!0;break;case"Y":for(b=parseInt(de[D].slice(1))-1,q||(k=0),J=E.length;J<=b;++J)E[J]=[];break;case"K":le=de[D].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(ia(le))?isNaN(li(le).getDate())||(le=zr(le)):(le=ia(le),ee!==null&&mi(ee)&&(le=Xu(le))),pe=!0;break;case"E":B=!0;var P=ni(de[D].slice(1),{r:b,c:k});E[b][k]=[E[b][k],P];break;case"S":oe=!0,E[b][k]=[E[b][k],"S5S"];break;case"G":break;case"R":re=parseInt(de[D].slice(1))-1;break;case"C":I=parseInt(de[D].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+V)}if(pe&&(E[b][k]&&E[b][k].length==2?E[b][k][0]=le:E[b][k]=le,ee=null),oe){if(B)throw new Error("SYLK shared formula cannot have own formula");var ce=re>-1&&E[re][I];if(!ce||!ce[1])throw new Error("SYLK shared formula cannot find base");E[b][k][1]=n1(ce[1],{r:b-re,c:k-I})}break;case"F":var A=0;for(D=1;D<de.length;++D)switch(de[D].charAt(0)){case"X":k=parseInt(de[D].slice(1))-1,++A;break;case"Y":for(b=parseInt(de[D].slice(1))-1,J=E.length;J<=b;++J)E[J]=[];break;case"M":ae=parseInt(de[D].slice(1))/20;break;case"F":break;case"G":break;case"P":ee=Y[parseInt(de[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=de[D].slice(1).split(" "),J=parseInt(U[0],10);J<=parseInt(U[1],10);++J)ae=parseInt(U[2],10),H[J-1]=ae===0?{hidden:!0}:{wch:ae},ci(H[J-1]);break;case"C":k=parseInt(de[D].slice(1))-1,H[k]||(H[k]={});break;case"R":b=parseInt(de[D].slice(1))-1,F[b]||(F[b]={}),ae>0?(F[b].hpt=ae,F[b].hpx=Nl(ae)):ae===0&&(F[b].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+V)}A<1&&(ee=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+V)}}return F.length>0&&(G["!rows"]=F),H.length>0&&(G["!cols"]=H),v&&v.sheetRows&&(E=E.slice(0,v.sheetRows)),[E,G]}function l(g,v){var w=a(g,v),b=w[0],k=w[1],C=vi(b,v);return Ca(k).forEach(function(D){C[D]=k[D]}),C}function c(g,v){return Ms(l(g,v),v)}function f(g,v,w,b){var k="C;Y"+(w+1)+";X"+(b+1)+";K";switch(g.t){case"n":k+=g.v||0,g.f&&!g.F&&(k+=";E"+LN(g.f,{r:w,c:b}));break;case"b":k+=g.v?"TRUE":"FALSE";break;case"e":k+=g.w||g.v;break;case"d":k+='"'+(g.w||g.v)+'"';break;case"s":k+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return k}function h(g,v){v.forEach(function(w,b){var k="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?k+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Pu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Au(w.wpx)),typeof w.wch=="number"&&(k+=Math.round(w.wch))),k.charAt(k.length-1)!=" "&&g.push(k)})}function p(g,v){v.forEach(function(w,b){var k="F;";w.hidden?k+="M0;":w.hpt?k+="M"+20*w.hpt+";":w.hpx&&(k+="M"+20*e1(w.hpx)+";"),k.length>2&&g.push(k+"R"+(b+1))})}function m(g,v){var w=["ID;PWXL;N;E"],b=[],k=hr(g["!ref"]),C,D=Array.isArray(g),E=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),g["!cols"]&&h(w,g["!cols"]),g["!rows"]&&p(w,g["!rows"]),w.push("B;Y"+(k.e.r-k.s.r+1)+";X"+(k.e.c-k.s.c+1)+";D"+[k.s.c,k.s.r,k.e.c,k.e.r].join(" "));for(var Y=k.s.r;Y<=k.e.r;++Y)for(var ee=k.s.c;ee<=k.e.c;++ee){var G=_t({r:Y,c:ee});C=D?(g[Y]||[])[ee]:g[G],!(!C||C.v==null&&(!C.f||C.F))&&b.push(f(C,g,Y,ee))}return w.join(E)+E+b.join(E)+E+"E"+E}return{to_workbook:c,to_sheet:l,from_sheet:m}})(),eE=(function(){function e(o,l){switch(l.type){case"base64":return n(Tn(o),l);case"binary":return n(o,l);case"buffer":return n(jt&&Buffer.isBuffer(o)?o.toString("binary"):yo(o),l);case"array":return n(fo(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,h=-1,p=0,m=[];p!==c.length;++p){if(c[p].trim()==="BOT"){m[++f]=[],h=0;continue}if(!(f<0)){var g=c[p].trim().split(","),v=g[0],w=g[1];++p;for(var b=c[p]||"";(b.match(/["]/g)||[]).length&1&&p<c.length-1;)b+=`
`+c[++p];switch(b=b.trim(),+v){case-1:if(b==="BOT"){m[++f]=[],h=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?m[f][h]=!0:b==="FALSE"?m[f][h]=!1:isNaN(ia(w))?isNaN(li(w).getDate())?m[f][h]=w:m[f][h]=zr(w):m[f][h]=ia(w),++h;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),m[f][h++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function t(o,l){return vi(e(o,l),l)}function r(o,l){return Ms(t(o,l),l)}var a=(function(){var o=function(f,h,p,m,g){f.push(h),f.push(p+","+m),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,h,p,m){f.push(h+","+p),f.push(h==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var h=[],p=hr(f["!ref"]),m,g=Array.isArray(f);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,p.e.r-p.s.r+1,""),o(h,"TUPLES",0,p.e.c-p.s.c+1,""),o(h,"DATA",0,0,"");for(var v=p.s.r;v<=p.e.r;++v){l(h,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var b=_t({r:v,c:w});if(m=g?(f[v]||[])[w]:f[b],!m){l(h,1,0,"");continue}switch(m.t){case"n":var k=m.w;!k&&m.v!=null&&(k=m.v),k==null?m.f&&!m.F?l(h,1,0,"="+m.f):l(h,1,0,""):l(h,0,k,"V");break;case"b":l(h,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Vn(m.z||St[14],fn(zr(m.v)))),l(h,0,m.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var C=`\r
`,D=h.join(C);return D}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),tE=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(m,g){for(var v=m.split(`
`),w=-1,b=-1,k=0,C=[];k!==v.length;++k){var D=v[k].trim().split(":");if(D[0]==="cell"){var E=ln(D[1]);if(C.length<=E.r)for(w=C.length;w<=E.r;++w)C[w]||(C[w]=[]);switch(w=E.r,b=E.c,D[2]){case"t":C[w][b]=e(D[3]);break;case"v":C[w][b]=+D[3];break;case"vtf":var Y=D[D.length-1];case"vtc":switch(D[3]){case"nl":C[w][b]=!!+D[4];break;default:C[w][b]=+D[4];break}D[2]=="vtf"&&(C[w][b]=[C[w][b],Y])}}}return g&&g.sheetRows&&(C=C.slice(0,g.sheetRows)),C}function r(m,g){return vi(t(m,g),g)}function a(m,g){return Ms(r(m,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var g=[],v=[],w,b="",k=gi(m["!ref"]),C=Array.isArray(m),D=k.s.r;D<=k.e.r;++D)for(var E=k.s.c;E<=k.e.c;++E)if(b=_t({r:D,c:E}),w=C?(m[D]||[])[E]:m[b],!(!w||w.v==null||w.t==="z")){switch(v=["cell",b,"t"],w.t){case"s":case"str":v.push(n(w.v));break;case"n":w.f?(v[2]="vtf",v[3]="n",v[4]=w.v,v[5]=n(w.f)):(v[2]="v",v[3]=w.v);break;case"b":v[2]="vt"+(w.f?"f":"c"),v[3]="nl",v[4]=w.v?"1":"0",v[5]=n(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var Y=fn(zr(w.v));v[2]="vtc",v[3]="nd",v[4]=""+Y,v[5]=w.w||Vn(w.z||St[14],Y);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(k.e.c-k.s.c+1)+":r:"+(k.e.r-k.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(m){return[o,l,c,l,h(m),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:p}})(),Sl=(function(){function e(p,m,g,v,w){w.raw?m[g][v]=p:p===""||(p==="TRUE"?m[g][v]=!0:p==="FALSE"?m[g][v]=!1:isNaN(ia(p))?isNaN(li(p).getDate())?m[g][v]=p:m[g][v]=zr(p):m[g][v]=ia(p))}function n(p,m){var g=m||{},v=[];if(!p||p.length===0)return v;for(var w=p.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var k=10,C=0,D=0;D<=b;++D)C=w[D].indexOf(" "),C==-1?C=w[D].length:C++,k=Math.max(k,C);for(D=0;D<=b;++D){v[D]=[];var E=0;for(e(w[D].slice(0,k).trim(),v,D,E,g),E=1;E<=(w[D].length-k)/10+1;++E)e(w[D].slice(k+(E-1)*10,k+E*10).trim(),v,D,E,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(p){for(var m={},g=!1,v=0,w=0;v<p.length;++v)(w=p.charCodeAt(v))==34?g=!g:!g&&w in t&&(m[w]=(m[w]||0)+1);w=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&w.push([m[v],v]);if(!w.length){m=r;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&w.push([m[v],v])}return w.sort(function(b,k){return b[0]-k[0]||r[b[1]]-r[k[1]]}),t[w.pop()[1]]||44}function o(p,m){var g=m||{},v="",w=g.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(v=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(v=p.charAt(4),p=p.slice(6)):v=a(p.slice(0,1024)):g&&g.FS?v=g.FS:v=a(p.slice(0,1024));var k=0,C=0,D=0,E=0,Y=0,ee=v.charCodeAt(0),G=!1,F=0,H=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var U=g.dateNF!=null?f2(g.dateNF):null;function ae(){var J=p.slice(E,Y),V={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)V.t="z";else if(g.raw)V.t="s",V.v=J;else if(J.trim().length===0)V.t="s",V.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(V.t="s",V.v=J.slice(2,-1).replace(/""/g,'"')):WN(J)?(V.t="n",V.f=J.slice(1)):(V.t="s",V.v=J);else if(J=="TRUE")V.t="b",V.v=!0;else if(J=="FALSE")V.t="b",V.v=!1;else if(!isNaN(D=ia(J)))V.t="n",g.cellText!==!1&&(V.w=J),V.v=D;else if(!isNaN(li(J).getDate())||U&&J.match(U)){V.z=g.dateNF||St[14];var de=0;U&&J.match(U)&&(J=p2(J,g.dateNF,J.match(U)||[]),de=1),g.cellDates?(V.t="d",V.v=zr(J,de)):(V.t="n",V.v=fn(zr(J,de))),g.cellText!==!1&&(V.w=Vn(V.z,V.v instanceof Date?fn(V.v):V.v)),g.cellNF||delete V.z}else V.t="s",V.v=J;if(V.t=="z"||(g.dense?(w[k]||(w[k]=[]),w[k][C]=V):w[_t({c:C,r:k})]=V),E=Y+1,H=p.charCodeAt(E),b.e.c<C&&(b.e.c=C),b.e.r<k&&(b.e.r=k),F==ee)++C;else if(C=0,++k,g.sheetRows&&g.sheetRows<=k)return!0}e:for(;Y<p.length;++Y)switch(F=p.charCodeAt(Y)){case 34:H===34&&(G=!G);break;case ee:case 10:case 13:if(!G&&ae())break e;break}return Y-E>0&&ae(),w["!ref"]=At(b),w}function l(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,m):vi(n(p,m),m)}function c(p,m){var g="",v=m.type=="string"?[0,0,0,0]:Cp(p,m);switch(m.type){case"base64":g=Tn(p);break;case"binary":g=p;break;case"buffer":m.codepage==65001?g=p.toString("utf8"):m.codepage&&typeof wl<"u"||(g=jt&&Buffer.isBuffer(p)?p.toString("binary"):yo(p));break;case"array":g=fo(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=rr(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=rr(g):m.type=="binary"&&typeof wl<"u",g.slice(0,19)=="socialcalc:version:"?tE.to_sheet(m.type=="string"?g:rr(g),m):l(g,m)}function f(p,m){return Ms(c(p,m),m)}function h(p){for(var m=[],g=hr(p["!ref"]),v,w=Array.isArray(p),b=g.s.r;b<=g.e.r;++b){for(var k=[],C=g.s.c;C<=g.e.c;++C){var D=_t({r:b,c:C});if(v=w?(p[b]||[])[C]:p[D],!v||v.v==null){k.push("          ");continue}for(var E=(v.w||(Ja(v),v.w)||"").slice(0,10);E.length<10;)E+=" ";k.push(E+(C===0?" ":""))}m.push(k.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})();function rE(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=JS.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return Sl.to_workbook(e,n)}}var xl=(function(){function e(P,ce,A){if(P){Br(P,P.l||0);for(var T=A.Enum||re;P.l<P.length;){var j=P.read_shift(2),N=T[j]||T[65535],W=P.read_shift(2),z=P.l+W,O=N.f&&N.f(P,W,A);if(P.l=z,ce(O,N,j))return}}}function n(P,ce){switch(ce.type){case"base64":return t(aa(Tn(P)),ce);case"binary":return t(aa(P),ce);case"buffer":case"array":return t(P,ce)}throw"Unsupported type "+ce.type}function t(P,ce){if(!P)return P;var A=ce||{},T=A.dense?[]:{},j="Sheet1",N="",W=0,z={},O=[],se=[],L={s:{r:0,c:0},e:{r:0,c:0}},Oe=A.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)A.Enum=re,e(P,function(he,Ne,Pe){switch(Pe){case 0:A.vers=he,he>=4096&&(A.qpro=!0);break;case 6:L=he;break;case 204:he&&(N=he);break;case 222:N=he;break;case 15:case 51:A.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:Pe==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=A.dateNF||St[14],A.cellDates&&(he[1].t="d",he[1].v=Xu(he[1].v))),A.qpro&&he[3]>W&&(T["!ref"]=At(L),z[j]=T,O.push(j),T=A.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},W=he[3],j=N||"Sheet"+(W+1),N="");var _e=A.dense?(T[he[0].r]||[])[he[0].c]:T[_t(he[0])];if(_e){_e.t=he[1].t,_e.v=he[1].v,he[1].z!=null&&(_e.z=he[1].z),he[1].f!=null&&(_e.f=he[1].f);break}A.dense?(T[he[0].r]||(T[he[0].r]=[]),T[he[0].r][he[0].c]=he[1]):T[_t(he[0])]=he[1];break}},A);else if(P[2]==26||P[2]==14)A.Enum=I,P[2]==14&&(A.qpro=!0,P.l=0),e(P,function(he,Ne,Pe){switch(Pe){case 204:j=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>W&&(T["!ref"]=At(L),z[j]=T,O.push(j),T=A.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},W=he[3],j="Sheet"+(W+1)),Oe>0&&he[0].r>=Oe)break;A.dense?(T[he[0].r]||(T[he[0].r]=[]),T[he[0].r][he[0].c]=he[1]):T[_t(he[0])]=he[1],L.e.c<he[0].c&&(L.e.c=he[0].c),L.e.r<he[0].r&&(L.e.r=he[0].r);break;case 27:he[14e3]&&(se[he[14e3][0]]=he[14e3][1]);break;case 1537:se[he[0]]=he[1],he[0]==W&&(j=he[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(T["!ref"]=At(L),z[N||j]=T,O.push(N||j),!se.length)return{SheetNames:O,Sheets:z};for(var je={},Ke=[],Qe=0;Qe<se.length;++Qe)z[O[Qe]]?(Ke.push(se[Qe]||O[Qe]),je[se[Qe]]=z[se[Qe]]||z[O[Qe]]):(Ke.push(se[Qe]),je[se[Qe]]={"!ref":"A1"});return{SheetNames:Ke,Sheets:je}}function r(P,ce){var A=ce||{};if(+A.codepage>=0&&sa(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var T=Nf(),j=hr(P["!ref"]),N=Array.isArray(P),W=[];na(T,0,o(1030)),na(T,6,f(j));for(var z=Math.min(j.e.r,8191),O=j.s.r;O<=z;++O)for(var se=$r(O),L=j.s.c;L<=j.e.c;++L){O===j.s.r&&(W[L]=Dr(L));var Oe=W[L]+se,je=N?(P[O]||[])[L]:P[Oe];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?na(T,13,v(O,L,je.v)):na(T,14,b(O,L,je.v));else{var Ke=Ja(je);na(T,15,m(O,L,Ke.slice(0,239)))}}return na(T,1),T.end()}function a(P,ce){var A=ce||{};if(+A.codepage>=0&&sa(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var T=Nf();na(T,0,l(P));for(var j=0,N=0;j<P.SheetNames.length;++j)(P.Sheets[P.SheetNames[j]]||{})["!ref"]&&na(T,27,B(P.SheetNames[j],N++));var W=0;for(j=0;j<P.SheetNames.length;++j){var z=P.Sheets[P.SheetNames[j]];if(!(!z||!z["!ref"])){for(var O=hr(z["!ref"]),se=Array.isArray(z),L=[],Oe=Math.min(O.e.r,8191),je=O.s.r;je<=Oe;++je)for(var Ke=$r(je),Qe=O.s.c;Qe<=O.e.c;++Qe){je===O.s.r&&(L[Qe]=Dr(Qe));var he=L[Qe]+Ke,Ne=se?(z[je]||[])[Qe]:z[he];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")na(T,23,ae(je,Qe,W,Ne.v));else{var Pe=Ja(Ne);na(T,22,F(je,Qe,W,Pe.slice(0,239)))}}++W}}return na(T,1),T.end()}function o(P){var ce=Tr(2);return ce.write_shift(2,P),ce}function l(P){var ce=Tr(26);ce.write_shift(2,4096),ce.write_shift(2,4),ce.write_shift(4,0);for(var A=0,T=0,j=0,N=0;N<P.SheetNames.length;++N){var W=P.SheetNames[N],z=P.Sheets[W];if(!(!z||!z["!ref"])){++j;var O=gi(z["!ref"]);A<O.e.r&&(A=O.e.r),T<O.e.c&&(T=O.e.c)}}return A>8191&&(A=8191),ce.write_shift(2,A),ce.write_shift(1,j),ce.write_shift(1,T),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(1,1),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(4,0),ce}function c(P,ce,A){var T={s:{c:0,r:0},e:{c:0,r:0}};return ce==8&&A.qpro?(T.s.c=P.read_shift(1),P.l++,T.s.r=P.read_shift(2),T.e.c=P.read_shift(1),P.l++,T.e.r=P.read_shift(2),T):(T.s.c=P.read_shift(2),T.s.r=P.read_shift(2),ce==12&&A.qpro&&(P.l+=2),T.e.c=P.read_shift(2),T.e.r=P.read_shift(2),ce==12&&A.qpro&&(P.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function f(P){var ce=Tr(8);return ce.write_shift(2,P.s.c),ce.write_shift(2,P.s.r),ce.write_shift(2,P.e.c),ce.write_shift(2,P.e.r),ce}function h(P,ce,A){var T=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(T[0].c=P.read_shift(1),T[3]=P.read_shift(1),T[0].r=P.read_shift(2),P.l+=2):(T[2]=P.read_shift(1),T[0].c=P.read_shift(2),T[0].r=P.read_shift(2)),T}function p(P,ce,A){var T=P.l+ce,j=h(P,ce,A);if(j[1].t="s",A.vers==20768){P.l++;var N=P.read_shift(1);return j[1].v=P.read_shift(N,"utf8"),j}return A.qpro&&P.l++,j[1].v=P.read_shift(T-P.l,"cstr"),j}function m(P,ce,A){var T=Tr(7+A.length);T.write_shift(1,255),T.write_shift(2,ce),T.write_shift(2,P),T.write_shift(1,39);for(var j=0;j<T.length;++j){var N=A.charCodeAt(j);T.write_shift(1,N>=128?95:N)}return T.write_shift(1,0),T}function g(P,ce,A){var T=h(P,ce,A);return T[1].v=P.read_shift(2,"i"),T}function v(P,ce,A){var T=Tr(7);return T.write_shift(1,255),T.write_shift(2,ce),T.write_shift(2,P),T.write_shift(2,A,"i"),T}function w(P,ce,A){var T=h(P,ce,A);return T[1].v=P.read_shift(8,"f"),T}function b(P,ce,A){var T=Tr(13);return T.write_shift(1,255),T.write_shift(2,ce),T.write_shift(2,P),T.write_shift(8,A,"f"),T}function k(P,ce,A){var T=P.l+ce,j=h(P,ce,A);if(j[1].v=P.read_shift(8,"f"),A.qpro)P.l=T;else{var N=P.read_shift(2);Y(P.slice(P.l,P.l+N),j),P.l+=N}return j}function C(P,ce,A){var T=ce&32768;return ce&=-32769,ce=(T?P:0)+(ce>=8192?ce-16384:ce),(T?"":"$")+(A?Dr(ce):$r(ce))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Y(P,ce){Br(P,0);for(var A=[],T=0,j="",N="",W="",z="";P.l<P.length;){var O=P[P.l++];switch(O){case 0:A.push(P.read_shift(8,"f"));break;case 1:N=C(ce[0].c,P.read_shift(2),!0),j=C(ce[0].r,P.read_shift(2),!1),A.push(N+j);break;case 2:{var se=C(ce[0].c,P.read_shift(2),!0),L=C(ce[0].r,P.read_shift(2),!1);N=C(ce[0].c,P.read_shift(2),!0),j=C(ce[0].r,P.read_shift(2),!1),A.push(se+L+":"+N+j)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(P.read_shift(2));break;case 6:{for(var Oe="";O=P[P.l++];)Oe+=String.fromCharCode(O);A.push('"'+Oe.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:z=A.pop(),W=A.pop(),A.push(["AND","OR"][O-20]+"("+W+","+z+")");break;default:if(O<32&&E[O])z=A.pop(),W=A.pop(),A.push(W+E[O]+z);else if(D[O]){if(T=D[O][1],T==69&&(T=P[P.l++]),T>A.length){console.error("WK1 bad formula parse 0x"+O.toString(16)+":|"+A.join("|")+"|");return}var je=A.slice(-T);A.length-=T,A.push(D[O][0]+"("+je.join(",")+")")}else return O<=7?console.error("WK1 invalid opcode "+O.toString(16)):O<=24?console.error("WK1 unsupported op "+O.toString(16)):O<=30?console.error("WK1 invalid opcode "+O.toString(16)):O<=115?console.error("WK1 unsupported function opcode "+O.toString(16)):console.error("WK1 unrecognized opcode "+O.toString(16))}}A.length==1?ce[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function ee(P){var ce=[{c:0,r:0},{t:"n",v:0},0];return ce[0].r=P.read_shift(2),ce[3]=P[P.l++],ce[0].c=P[P.l++],ce}function G(P,ce){var A=ee(P);return A[1].t="s",A[1].v=P.read_shift(ce-4,"cstr"),A}function F(P,ce,A,T){var j=Tr(6+T.length);j.write_shift(2,P),j.write_shift(1,A),j.write_shift(1,ce),j.write_shift(1,39);for(var N=0;N<T.length;++N){var W=T.charCodeAt(N);j.write_shift(1,W>=128?95:W)}return j.write_shift(1,0),j}function H(P,ce){var A=ee(P);A[1].v=P.read_shift(2);var T=A[1].v>>1;if(A[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return A[1].v=T,A}function U(P,ce){var A=ee(P),T=P.read_shift(4),j=P.read_shift(4),N=P.read_shift(2);if(N==65535)return T===0&&j===3221225472?(A[1].t="e",A[1].v=15):T===0&&j===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var W=N&32768;return N=(N&32767)-16446,A[1].v=(1-W*2)*(j*Math.pow(2,N+32)+T*Math.pow(2,N)),A}function ae(P,ce,A,T){var j=Tr(14);if(j.write_shift(2,P),j.write_shift(1,A),j.write_shift(1,ce),T==0)return j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,65535),j;var N=0,W=0,z=0,O=0;return T<0&&(N=1,T=-T),W=Math.log2(T)|0,T/=Math.pow(2,W-31),O=T>>>0,(O&2147483648)==0&&(T/=2,++W,O=T>>>0),T-=O,O|=2147483648,O>>>=0,T*=Math.pow(2,32),z=T>>>0,j.write_shift(4,z),j.write_shift(4,O),W+=16383+(N?32768:0),j.write_shift(2,W),j}function J(P,ce){var A=U(P);return P.l+=ce-14,A}function V(P,ce){var A=ee(P),T=P.read_shift(4);return A[1].v=T>>6,A}function de(P,ce){var A=ee(P),T=P.read_shift(8,"f");return A[1].v=T,A}function ue(P,ce){var A=de(P);return P.l+=ce-10,A}function le(P,ce){return P[P.l+ce-1]==0?P.read_shift(ce,"cstr"):""}function pe(P,ce){var A=P[P.l++];A>ce-1&&(A=ce-1);for(var T="";T.length<A;)T+=String.fromCharCode(P[P.l++]);return T}function q(P,ce,A){if(!(!A.qpro||ce<21)){var T=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var j=P.read_shift(ce-21,"cstr");return[T,j]}}function oe(P,ce){for(var A={},T=P.l+ce;P.l<T;){var j=P.read_shift(2);if(j==14e3){for(A[j]=[0,""],A[j][0]=P.read_shift(2);P[P.l];)A[j][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return A}function B(P,ce){var A=Tr(5+P.length);A.write_shift(2,14e3),A.write_shift(2,ce);for(var T=0;T<P.length;++T){var j=P.charCodeAt(T);A[A.l++]=j>127?95:j}return A[A.l++]=0,A}var re={0:{n:"BOF",f:Er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:k},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:de},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function nE(e){var n={},t=e.match(en),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=yt(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=np[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var aE=(function(){var e=bl("t"),n=bl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:It(l[1])},f=o.match(n);return f&&(c.s=nE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),sE=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),oE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,iE=/<(?:\w+:)?r>/,lE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function wp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=It(rr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=rr(e),t&&(r.h=up(r.t))):e.match(iE)&&(r.r=rr(e),r.t=It(rr((e.replace(lE,"").match(oE)||[]).join("").replace(en,""))),t&&(r.h=sE(aE(r.r)))),r):{t:""}}var cE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uE=/<(?:\w+:)?(?:si|sstItem)>/g,dE=/<\/(?:\w+:)?(?:si|sstItem)>/;function fE(e,n){var t=[],r="";if(!e)return t;var a=e.match(cE);if(a){r=a[2].replace(uE,"").split(dE);for(var o=0;o!=r.length;++o){var l=wp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=yt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function pE(e){return[e.read_shift(4),e.read_shift(4)]}function hE(e,n){var t=[],r=!1;return ts(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Gy(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Ka(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function xE(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Ka(e,4),n.U=Ka(e,4),n.W=Ka(e,4),n}function mE(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function gE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(mE(e));return n}function vE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function yE(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Ka(e,4),n.U=Ka(e,4),n.W=Ka(e,4),n}function wE(e){var n=yE(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Qy(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function Xy(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function kE(e){var n=Ka(e);switch(n.Minor){case 2:return[n.Minor,bE(e)];case 3:return[n.Minor,_E()];case 4:return[n.Minor,SE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function bE(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=Qy(e,t),a=Xy(e,e.length-e.l);return{t:"Std",h:r,v:a}}function _E(){throw new Error("File is password-protected: ECMA-376 Extensible")}function SE(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(en,function(o){var l=yt(o);switch(Da(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function EE(e,n){var t={},r=t.EncryptionVersionInfo=Ka(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=Qy(e,a),n-=a,t.EncryptionVerifier=Xy(e,n),t}function NE(e){var n={},t=n.EncryptionVersionInfo=Ka(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function CE(e){var n=0,t,r=Gy(e),a=r.length+1,o,l,c,f,h;for(t=As(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,h=c|f,n=h^l;return n^52811}var qy=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var p=l[h],m=0;m!=7;++m)p&64&&(c^=t[f]),p*=2,--f;return c};return function(l){for(var c=Gy(l),f=o(c),h=c.length,p=As(16),m=0;m!=16;++m)p[m]=0;var g,v,w;for((h&1)===1&&(g=f>>8,p[h]=a(e[0],g),--h,g=f&255,v=c[c.length-1],p[h]=a(v,g));h>0;)--h,g=f>>8,p[h]=a(c[h],g),--h,g=f&255,p[h]=a(c[h],g);for(h=15,w=15-c.length;w>0;)g=f>>8,p[h]=a(e[w],g),--h,--w,g=f&255,p[h]=a(c[h],g),--h,--w;return p}})(),TE=function(e,n,t,r,a){a||(a=n),r||(r=qy(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},DE=function(e){var n=0,t=qy(e);return function(r){var a=TE("",r,n,t);return n=a[1],a[0]}};function FE(e,n,t,r){var a={key:Er(e),verificationBytes:Er(e)};return t.password&&(a.verifier=CE(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=DE(t.password)),a}function jE(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=NE(e):r.Data=EE(e,n),r}function PE(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?jE(e,n-2,r):FE(e,t.biff>=8?n:n-2,t,r),r}var AE=(function(){function e(a,o){switch(o.type){case"base64":return n(Tn(a),o);case"binary":return n(a,o);case"buffer":return n(jt&&Buffer.isBuffer(a)?a.toString("binary"):yo(a),o);case"array":return n(fo(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,m){Array.isArray(c)&&(c[m]=[]);for(var g=/\\\w+\b/g,v=0,w,b=-1;w=g.exec(p);){switch(w[0]){case"\\cell":var k=p.slice(v,g.lastIndex-w[0].length);if(k[0]==" "&&(k=k.slice(1)),++b,k.length){var C={v:k,t:"s"};Array.isArray(c)?c[m][b]=C:c[_t({r:m,c:b})]=C}break}v=g.lastIndex}b>h.e.c&&(h.e.c=b)}),c["!ref"]=At(h),c}function t(a,o){return Ms(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=hr(a["!ref"]),c,f=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var m=_t({r:h,c:p});c=f?(a[h]||[])[p]:a[m],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Ja(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function OE(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function El(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function RE(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,h=a+o;switch(f=l/(h>1?2-h:h),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,h/2]}function zE(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function ju(e,n){if(n===0)return e;var t=RE(OE(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),El(zE(t))}var Zy=6,ME=15,IE=1,sn=Zy;function Pu(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function Au(e){return Math.floor((e-5)/sn*100+.5)/100}function Ff(e){return Math.round((e*sn+5)/sn*256)/256}function rf(e){return Ff(Au(Pu(e)))}function kp(e){var n=Math.abs(e-rf(e)),t=sn;if(n>.005)for(sn=IE;sn<ME;++sn)Math.abs(e-rf(e))<=n&&(n=Math.abs(e-rf(e)),t=sn);sn=t}function ci(e){e.width?(e.wpx=Pu(e.width),e.wch=Au(e.wpx),e.MDW=sn):e.wpx?(e.wch=Au(e.wpx),e.width=Ff(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Ff(e.wch),e.wpx=Pu(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var LE=96,Jy=LE;function e1(e){return e*96/Jy}function Nl(e){return e*Jy/96}var BE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function WE(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=yt(l);switch(Da(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=ir(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=ir(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function UE(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=yt(l);switch(Da(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function $E(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=yt(l);switch(Da(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=rr(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?ir(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?ir(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?ir(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?ir(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?ir(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?ir(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?ir(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=np[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=ir(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=so[a.color.index];a.color.index==81&&(f=so[1]),f||(f=so[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=ju(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function HE(e,n,t){n.NumberFmt=[];for(var r=Ca(St),a=0;a<r.length;++a)n.NumberFmt[r[a]]=St[r[a]];var o=e[0].match(en);if(o)for(a=0;a<o.length;++a){var l=yt(o[a]);switch(Da(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=It(rr(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}ao(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var su=["numFmtId","fillId","fontId","borderId","xfId"],ou=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function YE(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(en)||[]).forEach(function(o){var l=yt(o),c=0;switch(Da(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<su.length;++c)r[su[c]]&&(r[su[c]]=parseInt(r[su[c]],10));for(c=0;c<ou.length;++c)r[ou[c]]&&(r[ou[c]]=ir(r[ou[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=ir(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var VE=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,h){var p={};if(!c)return p;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(n))&&HE(m,p,h),(m=c.match(a))&&$E(m,p,f,h),(m=c.match(r))&&UE(m,p,f,h),(m=c.match(o))&&WE(m,p,f,h),(m=c.match(t))&&YE(m,p,h),p}})();function KE(e,n){var t=e.read_shift(2),r=Zr(e);return[t,r]}function GE(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=a_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=n_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Zr(e),r}var QE=Jr;function XE(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var qE=Jr;function ZE(e,n,t){var r={};r.NumberFmt=[];for(var a in St)r.NumberFmt[a]=St[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return ts(e,function(f,h,p){switch(p){case 44:r.NumberFmt[f[0]]=f[1],ao(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=ju(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(p);else if(h.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var JE=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function eN(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(en)||[]).forEach(function(a){var o=yt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[JE.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function tN(){}function rN(){}var nN=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,aN=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,sN=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function oN(e,n,t){n.themeElements={};var r;[["clrScheme",nN,eN],["fontScheme",aN,tN],["fmtScheme",sN,rN]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var iN=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function t1(e,n){(!e||e.length===0)&&(e=lN());var t,r={};if(!(t=e.match(iN)))throw new Error("themeElements not found in theme");return oN(t[0],r,n),r.raw=e,r}function lN(e,n){var t=[fy];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function cN(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=dy(o,{type:"array"})}catch{return}var c=Nn(l,"theme/theme/theme1.xml",!0);if(c)return t1(c,t)}}function uN(e){return e.read_shift(4)}function dN(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=fN(e,4);break;case 2:n.xclrValue=Wy(e);break;case 3:n.xclrValue=uN(e);break;case 4:e.l+=4;break}return e.l+=8,n}function fN(e,n){return Jr(e,n)}function pN(e,n){return Jr(e,n)}function hN(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=dN(e);break;case 6:r[1]=pN(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function xN(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(hN(e,t-e.l));return{ixfe:r,ext:o}}function mN(e,n){n.forEach(function(t){t[0]})}function gN(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zr(e)}}function vN(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function yN(e){return e.l+=4,e.read_shift(4)!=0}function wN(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return ts(e,function(f,h,p){switch(p){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?r.Cell.push({type:r.Types[m[0]-1].name,index:m[1]}):c==0&&r.Value.push({type:r.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function kN(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(en,function(c){var f=yt(c);switch(Da(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==f.name&&(l=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function bN(e){var n=[];if(!e)return n;var t=1;return(e.match(en)||[]).forEach(function(r){var a=yt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function _N(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=_t(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function SN(e,n,t){var r=[];return ts(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function EN(e,n,t,r){if(!e)return e;var a=r||{},o=!1;ts(e,function(c,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function NN(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function Eg(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=ln(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=hr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var h=At(f);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:t};l.h&&(p.h=l.h);for(var m=o.c.length-1;m>=0;--m){if(!t&&o.c[m].T)return;t&&!o.c[m].T&&o.c.splice(m,1)}if(t&&r){for(m=0;m<r.length;++m)if(p.a==r[m].id){p.a=r[m].name||p.a;break}}o.c.push(p)})}function CN(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=yt(c[0]),h={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=ln(f.ref);if(!(n.sheetRows&&n.sheetRows<=p.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&wp(m[1])||{r:"",t:"",h:""};h.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),h.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(h.h=g.h),r.push(h)}}}}),r}function TN(e,n){var t=[],r=!1,a={},o=0;return e.replace(en,function(c,f){var h=yt(c);switch(Da(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function DN(e,n){var t=[],r=!1;return e.replace(en,function(o){var l=yt(o);switch(Da(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function FN(e){var n={};n.iauthor=e.read_shift(4);var t=ko(e);return n.rfx=t.s,n.ref=_t(t.s),e.l+=16,n}var jN=Zr;function PN(e,n){var t=[],r=[],a={},o=!1;return ts(e,function(c,f,h){switch(h){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var AN="application/vnd.ms-office.vbaProject";function ON(e){var n=Pt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pt.utils.cfb_add(n,a,e.FileIndex[r].content)}}),Pt.write(n)}function RN(){return{"!type":"dialog"}}function zN(){return{"!type":"dialog"}}function MN(){return{"!type":"macro"}}function IN(){return{"!type":"macro"}}var ni=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return c?p+=n.c:--p,f?h+=n.r:--h,a+(c?"":"$")+Dr(p)+(f?"":"$")+$r(h)}return function(a,o){return n=o,a.replace(e,t)}})(),r1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,LN=(function(){return function(n,t){return n.replace(r1,function(r,a,o,l,c,f){var h=hp(l)-(o?0:t.c),p=pp(f)-(c?0:t.r),m=p==0?"":c?p+1:"["+p+"]",g=h==0?"":o?h+1:"["+h+"]";return a+"R"+m+"C"+g})}})();function n1(e,n){return e.replace(r1,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Dr(hp(o)+n.c))+(l=="$"?l+c:$r(pp(c)+n.r))})}function BN(e,n,t){var r=gi(n),a=r.s,o=ln(t),l={r:o.r-a.r,c:o.c-a.c};return n1(e,l)}function WN(e){return e.length!=1}function Ng(e){return e.replace(/_xlfn\./g,"")}function _r(e){e.l+=1}function Os(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function a1(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return s1(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Os(e),c=Os(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function s1(e){var n=Os(e),t=Os(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function UN(e,n,t){if(t.biff<8)return s1(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=Os(e),l=Os(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function o1(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return $N(e);var r=e.read_shift(t&&t.biff==12?4:2),a=Os(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function $N(e){var n=Os(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function HN(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function YN(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return VN(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function VN(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function KN(e,n,t){var r=(e[e.l++]&96)>>5,a=a1(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function GN(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=a1(e,o,t);return[r,a,l]}function QN(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function XN(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function qN(e,n,t){var r=(e[e.l++]&96)>>5,a=UN(e,n-1,t);return[r,a]}function ZN(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Cg(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function JN(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function eC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function tC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function rC(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function nC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function i1(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function aC(e){return e.read_shift(2),i1(e)}function sC(e){return e.read_shift(2),i1(e)}function oC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=o1(e,0,t);return[r,a]}function iC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=YN(e,0,t);return[r,a]}function lC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=o1(e,0,t);return[r,a,o]}function cC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[uT[a],u1[a],r]}function uC(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:dC(e);return[a,(o[0]===0?u1:cT)[o[1]]]}function dC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function fC(e,n,t){e.l+=t&&t.biff==2?3:4}function pC(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function hC(e){return e.l++,bo[e.read_shift(1)]}function xC(e){return e.l++,e.read_shift(2)}function mC(e){return e.l++,e.read_shift(1)!==0}function gC(e){return e.l++,Xr(e)}function vC(e,n,t){return e.l++,Ol(e,n-1,t)}function yC(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=yr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=bo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Xr(e);break;case 2:t[1]=_o(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function wC(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?ko:qu)(e));return a}function kC(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=yC(e,t.biff);return l}function bC(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function _C(e,n,t){if(t.biff==5)return SC(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function SC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function EC(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function NC(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function CC(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function TC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var DC=Jr,FC=Jr,jC=Jr;function zl(e,n,t){return e.l+=2,[HN(e)]}function bp(e){return e.l+=6,[]}var PC=zl,AC=bp,OC=bp,RC=zl;function l1(e){return e.l+=2,[Er(e),e.read_shift(2)&1]}var zC=zl,MC=l1,IC=bp,LC=zl,BC=zl,WC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function UC(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=WC[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function $C(e){return e.l+=2,[e.read_shift(4)]}function HC(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function YC(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function VC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function KC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function GC(e){return e.l+=4,[0,0]}var Tg={1:{n:"PtgExp",f:pC},2:{n:"PtgTbl",f:jC},3:{n:"PtgAdd",f:_r},4:{n:"PtgSub",f:_r},5:{n:"PtgMul",f:_r},6:{n:"PtgDiv",f:_r},7:{n:"PtgPower",f:_r},8:{n:"PtgConcat",f:_r},9:{n:"PtgLt",f:_r},10:{n:"PtgLe",f:_r},11:{n:"PtgEq",f:_r},12:{n:"PtgGe",f:_r},13:{n:"PtgGt",f:_r},14:{n:"PtgNe",f:_r},15:{n:"PtgIsect",f:_r},16:{n:"PtgUnion",f:_r},17:{n:"PtgRange",f:_r},18:{n:"PtgUplus",f:_r},19:{n:"PtgUminus",f:_r},20:{n:"PtgPercent",f:_r},21:{n:"PtgParen",f:_r},22:{n:"PtgMissArg",f:_r},23:{n:"PtgStr",f:vC},26:{n:"PtgSheet",f:HC},27:{n:"PtgEndSheet",f:YC},28:{n:"PtgErr",f:hC},29:{n:"PtgBool",f:mC},30:{n:"PtgInt",f:xC},31:{n:"PtgNum",f:gC},32:{n:"PtgArray",f:ZN},33:{n:"PtgFunc",f:cC},34:{n:"PtgFuncVar",f:uC},35:{n:"PtgName",f:bC},36:{n:"PtgRef",f:oC},37:{n:"PtgArea",f:KN},38:{n:"PtgMemArea",f:EC},39:{n:"PtgMemErr",f:DC},40:{n:"PtgMemNoMem",f:FC},41:{n:"PtgMemFunc",f:NC},42:{n:"PtgRefErr",f:CC},43:{n:"PtgAreaErr",f:QN},44:{n:"PtgRefN",f:iC},45:{n:"PtgAreaN",f:qN},46:{n:"PtgMemAreaN",f:VC},47:{n:"PtgMemNoMemN",f:KC},57:{n:"PtgNameX",f:_C},58:{n:"PtgRef3d",f:lC},59:{n:"PtgArea3d",f:GN},60:{n:"PtgRefErr3d",f:TC},61:{n:"PtgAreaErr3d",f:XN},255:{}},QC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},XC={1:{n:"PtgElfLel",f:l1},2:{n:"PtgElfRw",f:LC},3:{n:"PtgElfCol",f:PC},6:{n:"PtgElfRwV",f:BC},7:{n:"PtgElfColV",f:RC},10:{n:"PtgElfRadical",f:zC},11:{n:"PtgElfRadicalS",f:IC},13:{n:"PtgElfColS",f:AC},15:{n:"PtgElfColSV",f:OC},16:{n:"PtgElfRadicalLel",f:MC},25:{n:"PtgList",f:UC},29:{n:"PtgSxName",f:$C},255:{}},qC={0:{n:"PtgAttrNoop",f:GC},1:{n:"PtgAttrSemi",f:nC},2:{n:"PtgAttrIf",f:tC},4:{n:"PtgAttrChoose",f:JN},8:{n:"PtgAttrGoto",f:eC},16:{n:"PtgAttrSum",f:fC},32:{n:"PtgAttrBaxcel",f:Cg},33:{n:"PtgAttrBaxcel",f:Cg},64:{n:"PtgAttrSpace",f:aC},65:{n:"PtgAttrSpaceSemi",f:sC},128:{n:"PtgAttrIfError",f:rC},255:{}};function Ml(e,n,t,r){if(r.biff<8)return Jr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=kC(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=wC(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(Jr(e,n)),o}function Il(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Tg[o]||Tg[QC[o]],(o===24||o===25)&&(a=(o===24?XC:qC)[e[e.l+1]]),!a||!a.f?Jr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function ZC(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var JC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function eT(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function c1(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Dg(e,n,t){var r=c1(e,n,t);return r=="#REF"?r:eT(r,t)}function Qr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,h,p,m=0,g=0,v,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,k="",C=0,D=e[0].length;C<D;++C){var E=e[0][C];switch(E[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),b>=0){switch(e[0][b][1][0]){case 0:k=pr(" ",e[0][b][1][1]);break;case 1:k=pr("\r",e[0][b][1][1]);break;default:if(k="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}h=h+k,b=-1}c.push(h+JC[E[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=dl(E[1][1],l,a),c.push(fl(p,o));break;case"PtgRefN":p=t?dl(E[1][1],t,a):E[1][1],c.push(fl(p,o));break;case"PtgRef3d":m=E[1][1],p=dl(E[1][2],l,a),w=Dg(r,m,a),c.push(w+"!"+fl(p,o));break;case"PtgFunc":case"PtgFuncVar":var Y=E[1][0],ee=E[1][1];Y||(Y=0),Y&=127;var G=Y==0?[]:c.slice(-Y);c.length-=Y,ee==="User"&&(ee=G.shift()),c.push(ee+"("+G.join(",")+")");break;case"PtgBool":c.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(E[1]);break;case"PtgNum":c.push(String(E[1]));break;case"PtgStr":c.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(E[1]);break;case"PtgAreaN":v=cg(E[1][1],t?{s:t}:l,a),c.push(ef(v,a));break;case"PtgArea":v=cg(E[1][1],l,a),c.push(ef(v,a));break;case"PtgArea3d":m=E[1][1],v=E[1][2],w=Dg(r,m,a),c.push(w+"!"+ef(v,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var F=(r.names||[])[g-1]||(r[0]||[])[g],H=F?F.Name:"SH33TJSNAME"+String(g);H&&H.slice(0,6)=="_xlfn."&&!a.xlfn&&(H=H.slice(6)),c.push(H);break;case"PtgNameX":var U=E[1][1];g=E[1][2];var ae;if(a.biff<=5)U<0&&(U=-U),r[U]&&(ae=r[U][g]);else{var J="";if(((r[U]||[])[0]||[])[0]==14849||(((r[U]||[])[0]||[])[0]==1025?r[U][g]&&r[U][g].itab>0&&(J=r.SheetNames[r[U][g].itab-1]+"!"):J=r.SheetNames[g-1]+"!"),r[U]&&r[U][g])J+=r[U][g].Name;else if(r[0]&&r[0][g])J+=r[0][g].Name;else{var V=(c1(r,U,a)||"").split(";;");V[g-1]?J=V[g-1]:J+="SH33TJSERRX"}c.push(J);break}ae||(ae={Name:"SH33TJSERRY"}),c.push(ae.Name);break;case"PtgParen":var de="(",ue=")";if(b>=0){switch(k="",e[0][b][1][0]){case 2:de=pr(" ",e[0][b][1][1])+de;break;case 3:de=pr("\r",e[0][b][1][1])+de;break;case 4:ue=pr(" ",e[0][b][1][1])+ue;break;case 5:ue=pr("\r",e[0][b][1][1])+ue;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}c.push(de+c.pop()+ue);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:E[1][1],r:E[1][0]};var le={c:t.c,r:t.r};if(r.sharedf[_t(p)]){var pe=r.sharedf[_t(p)];c.push(Qr(pe,l,le,r,a))}else{var q=!1;for(f=0;f!=r.arrayf.length;++f)if(h=r.arrayf[f],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Qr(h[1],l,le,r,a)),q=!0;break}q||c.push(E[1])}break;case"PtgArray":c.push("{"+ZC(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&oe.indexOf(e[0][C][0])==-1){E=e[0][b];var B=!0;switch(E[1][0]){case 4:B=!1;case 0:k=pr(" ",E[1][1]);break;case 5:B=!1;case 1:k=pr("\r",E[1][1]);break;default:if(k="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}c.push((B?k:"")+c.pop()+(B?"":k)),b=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function tT(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=Il(e,l,t);return n!==l+a&&(o=Ml(e,n-l-a,c,t)),e.l=r,[c,o]}function rT(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=Il(e,l,t);return n!==l+a&&(o=Ml(e,n-l-a,c,t)),e.l=r,[c,o]}function nT(e,n,t,r){var a=e.l+n,o=Il(e,r,t),l;return a!==e.l&&(l=Ml(e,a-e.l,o,t)),[o,l]}function aT(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=Il(e,o,t);return o==65535?[[],Jr(e,n-2)]:(n!==o+2&&(a=Ml(e,r-o-2,l,t)),[l,a])}function sT(e){var n;if(Ya(e,e.l+6)!==65535)return[Xr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function nf(e,n,t){var r=e.l+n,a=Fa(e);t.biff==2&&++e.l;var o=sT(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=rT(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function Zu(e,n,t){var r=e.read_shift(4),a=Il(e,r,t),o=e.read_shift(4),l=o>0?Ml(e,o,a,t):null;return[a,l]}var oT=Zu,Ju=Zu,iT=Zu,lT=Zu,cT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},u1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},uT={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function af(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var ml={},ai={};function gl(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function d1(e,n,t,r,a,o){try{r.cellNF&&(e.z=St[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=zr(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(St[n]==null&&ao(d2[n]||"General",n),e.t==="e")e.w=e.w||bo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v);else if(e.t==="d"){var l=fn(e.v);(l|0)===l?e.w=l.toString(10):e.w=kl(l)}else{if(e.v===void 0)return"";e.w=uo(e.v,ai)}else e.t==="d"?e.w=Vn(n,fn(e.v),ai):e.w=Vn(n,e.v,ai)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ju(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ju(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function dT(e,n){var t=hr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=At(t))}var fT=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pT=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hT=/<(?:\w:)?hyperlink [^>]*>/mg,xT=/"(\w*:\w*)"/,mT=/<(?:\w:)?col\b[^>]*[\/]?>/g,gT=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vT=/<(?:\w:)?pageMargins[^>]*\/>/g,f1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yT=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,wT=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kT(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",m=e.match(pT);m?(h=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):h=p=e;var g=h.match(f1);g?_p(g[0],c,a,t):(g=h.match(yT))&&bT(g[0],g[1]||"",c,a,t);var v=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var w=h.slice(v,v+50).match(xT);w&&dT(c,w[1])}var b=h.match(wT);b&&b[1]&&TT(b[1],a);var k=[];if(n.cellStyles){var C=h.match(mT);C&&ET(k,C)}m&&DT(m[1],c,n,f,o,l);var D=p.match(gT);D&&(c["!autofilter"]=NT(D[0]));var E=[],Y=p.match(fT);if(Y)for(v=0;v!=Y.length;++v)E[v]=hr(Y[v].slice(Y[v].indexOf('"')+1));var ee=p.match(hT);ee&&_T(c,ee,r);var G=p.match(vT);if(G&&(c["!margins"]=ST(yt(G[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=At(f)),n.sheetRows>0&&c["!ref"]){var F=hr(c["!ref"]);n.sheetRows<=+F.e.r&&(F.e.r=n.sheetRows-1,F.e.r>f.e.r&&(F.e.r=f.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>f.e.c&&(F.e.c=f.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=At(F))}return k.length>0&&(c["!cols"]=k),E.length>0&&(c["!merges"]=E),c}function _p(e,n,t,r){var a=yt(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=It(rr(a.codeName)))}function bT(e,n,t,r,a){_p(e.slice(0,e.indexOf(">")),t,r,a)}function _T(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=yt(rr(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+It(o.location))):(o.Target="#"+It(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=hr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var h=c.s.c;h<=c.e.c;++h){var p=_t({c:h,r:f});r?(e[f]||(e[f]=[]),e[f][h]||(e[f][h]={t:"z",v:void 0}),e[f][h].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function ST(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function ET(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=yt(n[r],!0);a.hidden&&(a.hidden=ir(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,kp(a.width)),ci(a);o<=l;)e[o++]=Ur(a)}}function NT(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var CT=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function TT(e,n){n.Views||(n.Views=[{}]),(e.match(CT)||[]).forEach(function(t,r){var a=yt(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),ir(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var DT=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=bl("v"),l=bl("f");return function(f,h,p,m,g,v){for(var w=0,b="",k=[],C=[],D=0,E=0,Y=0,ee="",G,F,H=0,U=0,ae,J,V=0,de=0,ue=Array.isArray(v.CellXf),le,pe=[],q=[],oe=Array.isArray(h),B=[],re={},I=!1,P=!!p.sheetStubs,ce=f.split(n),A=0,T=ce.length;A!=T;++A){b=ce[A].trim();var j=b.length;if(j!==0){var N=0;e:for(w=0;w<j;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(F=yt(b.slice(N,w),!0),H=F.r!=null?parseInt(F.r,10):H+1,U=-1,p.sheetRows&&p.sheetRows<H)continue;re={},I=!1,F.ht&&(I=!0,re.hpt=parseFloat(F.ht),re.hpx=Nl(re.hpt)),F.hidden=="1"&&(I=!0,re.hidden=!0),F.outlineLevel!=null&&(I=!0,re.level=+F.outlineLevel),I&&(B[H-1]=re)}break;case"<":N=w;break}if(N>=w)break;if(F=yt(b.slice(N,w),!0),H=F.r!=null?parseInt(F.r,10):H+1,U=-1,!(p.sheetRows&&p.sheetRows<H)){m.s.r>H-1&&(m.s.r=H-1),m.e.r<H-1&&(m.e.r=H-1),p&&p.cellStyles&&(re={},I=!1,F.ht&&(I=!0,re.hpt=parseFloat(F.ht),re.hpx=Nl(re.hpt)),F.hidden=="1"&&(I=!0,re.hidden=!0),F.outlineLevel!=null&&(I=!0,re.level=+F.outlineLevel),I&&(B[H-1]=re)),k=b.slice(w).split(e);for(var W=0;W!=k.length&&k[W].trim().charAt(0)=="<";++W);for(k=k.slice(W),w=0;w!=k.length;++w)if(b=k[w].trim(),b.length!==0){if(C=b.match(t),D=w,E=0,Y=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,C!=null&&C.length===2){for(D=0,ee=C[1],E=0;E!=ee.length&&!((Y=ee.charCodeAt(E)-64)<1||Y>26);++E)D=26*D+Y;--D,U=D}else++U;for(E=0;E!=b.length&&b.charCodeAt(E)!==62;++E);if(++E,F=yt(b.slice(0,E),!0),F.r||(F.r=_t({r:H-1,c:U})),ee=b.slice(E),G={t:""},(C=ee.match(o))!=null&&C[1]!==""&&(G.v=It(C[1])),p.cellFormula){if((C=ee.match(l))!=null&&C[1]!==""){if(G.f=It(rr(C[1])).replace(/\r\n/g,`
`),p.xlfn||(G.f=Ng(G.f)),C[0].indexOf('t="array"')>-1)G.F=(ee.match(a)||[])[1],G.F.indexOf(":")>-1&&pe.push([hr(G.F),G.F]);else if(C[0].indexOf('t="shared"')>-1){J=yt(C[0]);var z=It(rr(C[1]));p.xlfn||(z=Ng(z)),q[parseInt(J.si,10)]=[J,z,F.r]}}else(C=ee.match(/<f[^>]*\/>/))&&(J=yt(C[0]),q[J.si]&&(G.f=BN(q[J.si][1],q[J.si][2],F.r)));var O=ln(F.r);for(E=0;E<pe.length;++E)O.r>=pe[E][0].s.r&&O.r<=pe[E][0].e.r&&O.c>=pe[E][0].s.c&&O.c<=pe[E][0].e.c&&(G.F=pe[E][1])}if(F.t==null&&G.v===void 0)if(G.f||G.F)G.v=0,G.t="n";else if(P)G.t="z";else continue;else G.t=F.t||"n";switch(m.s.c>U&&(m.s.c=U),m.e.c<U&&(m.e.c=U),G.t){case"n":if(G.v==""||G.v==null){if(!P)continue;G.t="z"}else G.v=parseFloat(G.v);break;case"s":if(typeof G.v>"u"){if(!P)continue;G.t="z"}else ae=ml[parseInt(G.v,10)],G.v=ae.t,G.r=ae.r,p.cellHTML&&(G.h=ae.h);break;case"str":G.t="s",G.v=G.v!=null?rr(G.v):"",p.cellHTML&&(G.h=up(G.v));break;case"inlineStr":C=ee.match(r),G.t="s",C!=null&&(ae=wp(C[1]))?(G.v=ae.t,p.cellHTML&&(G.h=ae.h)):G.v="";break;case"b":G.v=ir(G.v);break;case"d":p.cellDates?G.v=zr(G.v,1):(G.v=fn(zr(G.v,1)),G.t="n");break;case"e":(!p||p.cellText!==!1)&&(G.w=G.v),G.v=Ay[G.v];break}if(V=de=0,le=null,ue&&F.s!==void 0&&(le=v.CellXf[F.s],le!=null&&(le.numFmtId!=null&&(V=le.numFmtId),p.cellStyles&&le.fillId!=null&&(de=le.fillId))),d1(G,V,de,p,g,v),p.cellDates&&ue&&G.t=="n"&&mi(St[V])&&(G.t="d",G.v=Xu(G.v)),F.cm&&p.xlmeta){var se=(p.xlmeta.Cell||[])[+F.cm-1];se&&se.type=="XLDAPR"&&(G.D=!0)}if(oe){var L=ln(F.r);h[L.r]||(h[L.r]=[]),h[L.r][L.c]=G}else h[F.r]=G}}}}B.length>0&&(h["!rows"]=B)}})();function FT(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var jT=ko;function PT(){}function AT(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=t_(e),t}function OT(e){var n=Gn(e);return[n]}function RT(e){var n=wo(e);return[n]}function zT(e){var n=Gn(e),t=e.read_shift(1);return[n,t,"b"]}function MT(e){var n=wo(e),t=e.read_shift(1);return[n,t,"b"]}function IT(e){var n=Gn(e),t=e.read_shift(1);return[n,t,"e"]}function LT(e){var n=wo(e),t=e.read_shift(1);return[n,t,"e"]}function BT(e){var n=Gn(e),t=e.read_shift(4);return[n,t,"s"]}function WT(e){var n=wo(e),t=e.read_shift(4);return[n,t,"s"]}function UT(e){var n=Gn(e),t=Xr(e);return[n,t,"n"]}function p1(e){var n=wo(e),t=Xr(e);return[n,t,"n"]}function $T(e){var n=Gn(e),t=gp(e);return[n,t,"n"]}function HT(e){var n=wo(e),t=gp(e);return[n,t,"n"]}function YT(e){var n=Gn(e),t=xp(e);return[n,t,"is"]}function VT(e){var n=Gn(e),t=Zr(e);return[n,t,"str"]}function KT(e){var n=wo(e),t=Zr(e);return[n,t,"str"]}function GT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}function QT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}function XT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=Xr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}function qT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=Zr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}var ZT=ko;function JT(e,n){var t=e.l+n,r=ko(e),a=mp(e),o=Zr(e),l=Zr(e),c=Zr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function eD(){}function tD(e,n,t){var r=e.l+n,a=Fy(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=oT(e,r-e.l,t);l[1]=c}else e.l=r;return l}function rD(e,n,t){var r=e.l+n,a=ko(e),o=[a];if(t.cellFormula){var l=lT(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var nD=["left","right","top","bottom","header","footer"];function aD(e){var n={};return nD.forEach(function(t){n[t]=Xr(e)}),n}function sD(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function oD(){}function iD(){}function lD(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,v,w,b,k,C,D,E,Y,ee,G=[];c.biff=12,c["!row"]=0;var F=0,H=!1,U=[],ae={},J=c.supbooks||a.supbooks||[[]];if(J.sharedf=ae,J.arrayf=U,J.SheetNames=a.SheetNames||a.Sheets.map(function(oe){return oe.name}),!c.supbooks&&(c.supbooks=J,a.Names))for(var V=0;V<a.Names.length;++V)J[0][V+1]=a.Names[V];var de=[],ue=[],le=!1;Ou[16]={n:"BrtShortReal",f:p1};var pe;if(ts(e,function(B,re,I){if(!g)switch(I){case 148:h=B;break;case 0:v=B,c.sheetRows&&c.sheetRows<=v.r&&(g=!0),Y=$r(k=v.r),c["!row"]=v.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=Nl(B.hpt)),ue[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:B[2]},B[2]){case"n":w.v=B[1];break;case"s":E=ml[B[1]],w.v=E.t,w.r=E.r;break;case"b":w.v=!!B[1];break;case"e":w.v=B[1],c.cellText!==!1&&(w.w=bo[w.v]);break;case"str":w.t="s",w.v=B[1];break;case"is":w.t="s",w.v=B[1].t;break}if((b=l.CellXf[B[0].iStyleRef])&&d1(w,b.numFmtId,null,c,o,l),C=B[0].c==-1?C+1:B[0].c,c.dense?(f[k]||(f[k]=[]),f[k][C]=w):f[Dr(C)+Y]=w,c.cellFormula){for(H=!1,F=0;F<U.length;++F){var P=U[F];v.r>=P[0].s.r&&v.r<=P[0].e.r&&C>=P[0].s.c&&C<=P[0].e.c&&(w.F=At(P[0]),H=!0)}!H&&B.length>3&&(w.f=B[3])}if(p.s.r>v.r&&(p.s.r=v.r),p.s.c>C&&(p.s.c=C),p.e.r<v.r&&(p.e.r=v.r),p.e.c<C&&(p.e.c=C),c.cellDates&&b&&w.t=="n"&&mi(St[b.numFmtId])){var ce=to(w.v);ce&&(w.t="d",w.v=new Date(ce.y,ce.m-1,ce.d,ce.H,ce.M,ce.S,ce.u))}pe&&(pe.type=="XLDAPR"&&(w.D=!0),pe=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;w={t:"z",v:void 0},C=B[0].c==-1?C+1:B[0].c,c.dense?(f[k]||(f[k]=[]),f[k][C]=w):f[Dr(C)+Y]=w,p.s.r>v.r&&(p.s.r=v.r),p.s.c>C&&(p.s.c=C),p.e.r<v.r&&(p.e.r=v.r),p.e.c<C&&(p.e.c=C),pe&&(pe.type=="XLDAPR"&&(w.D=!0),pe=void 0);break;case 176:G.push(B);break;case 49:pe=((c.xlmeta||{}).Cell||[])[B-1];break;case 494:var A=r["!id"][B.relId];for(A?(B.Target=A.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=A):B.relId==""&&(B.Target="#"+B.loc),k=B.rfx.s.r;k<=B.rfx.e.r;++k)for(C=B.rfx.s.c;C<=B.rfx.e.c;++C)c.dense?(f[k]||(f[k]=[]),f[k][C]||(f[k][C]={t:"z",v:void 0}),f[k][C].l=B):(D=_t({c:C,r:k}),f[D]||(f[D]={t:"z",v:void 0}),f[D].l=B);break;case 426:if(!c.cellFormula)break;U.push(B),ee=c.dense?f[k][C]:f[Dr(C)+Y],ee.f=Qr(B[1],p,{r:v.r,c:C},J,c),ee.F=At(B[0]);break;case 427:if(!c.cellFormula)break;ae[_t(B[0].s)]=B[1],ee=c.dense?f[k][C]:f[Dr(C)+Y],ee.f=Qr(B[1],p,{r:v.r,c:C},J,c);break;case 60:if(!c.cellStyles)break;for(;B.e>=B.s;)de[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},le||(le=!0,kp(B.w/256)),ci(de[B.e+1]);break;case 161:f["!autofilter"]={ref:At(B)};break;case 476:f["!margins"]=B;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),B.name&&(a.Sheets[t].CodeName=B.name),(B.above||B.left)&&(f["!outline"]={above:B.above,left:B.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),B.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!re.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=At(h||p)),c.sheetRows&&f["!ref"]){var q=hr(f["!ref"]);c.sheetRows<=+q.e.r&&(q.e.r=c.sheetRows-1,q.e.r>p.e.r&&(q.e.r=p.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>p.e.c&&(q.e.c=p.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),f["!fullref"]=f["!ref"],f["!ref"]=At(q))}return G.length>0&&(f["!merges"]=G),de.length>0&&(f["!cols"]=de),ue.length>0&&(f["!rows"]=ue),f}function cD(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=It((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function uD(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=cD(m);p.s.r=p.s.c=0,p.e.c=c,h=Dr(c),g[0].forEach(function(v,w){l[h+$r(w)]={t:"n",v,z:g[1]},f=w}),p.e.r<f&&(p.e.r=f),++c}),c>0&&(l["!ref"]=At(p)),l}function dD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(f1);return c&&_p(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function fD(e,n){e.l+=10;var t=Zr(e);return{name:t}}function pD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ts(e,function(f,h,p){switch(p){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var h1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],hD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xD=[],mD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jg(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=ir(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Pg(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=ir(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function x1(e){Pg(e.WBProps,h1),Pg(e.CalcPr,mD),jg(e.WBView,hD),jg(e.Sheets,xD),ai.date1904=ir(e.WBProps.date1904)}var gD="][*?/\\".split("");function vD(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return gD.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var yD=/<\w+:workbook/;function wD(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(en,function(f,h){var p=yt(f);switch(Da(p[0])){case"<?xml":break;case"<workbook":f.match(yD)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":h1.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":t.WBProps[m[0]]=ir(p[m[0]]);break;case"int":t.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:t.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(t.WBProps.CodeName=rr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=It(rr(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=rr(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),ir(p.hidden||"0")&&(o.Hidden=!0),l=h+f.length;break;case"</definedName>":o.Ref=It(rr(e.slice(l,h))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),I2.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return x1(t),t}function kD(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Cf(e),t.name=Zr(e),t}function bD(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?Zr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function _D(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function SD(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=r_(e),l=iT(e,0,t),c=mp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function ED(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ou[16]={n:"BrtFRTArchID$",f:_D},ts(e,function(f,h,p){switch(p){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Qr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(p),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},n),x1(t),t.Names=o,t.supbooks=l,t}function ND(e,n,t){return n.slice(-4)===".bin"?ED(e,t):wD(e,t)}function CD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?lD(e,r,t,a,o,l,c):kT(e,r,t,a,o,l,c)}function TD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?pD(e,r,t,a,o):dD(e,r,t,a,o)}function DD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?MN():IN()}function FD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?RN():zN()}function jD(e,n,t,r){return n.slice(-4)===".bin"?ZE(e,t,r):VE(e,t,r)}function PD(e,n,t){return t1(e,t)}function AD(e,n,t){return n.slice(-4)===".bin"?hE(e,t):fE(e,t)}function OD(e,n,t){return n.slice(-4)===".bin"?PN(e,t):CN(e,t)}function RD(e,n,t){return n.slice(-4)===".bin"?SN(e):bN(e)}function zD(e,n,t,r){return t.slice(-4)===".bin"?EN(e,n,t,r):void 0}function MD(e,n,t){return n.slice(-4)===".bin"?wN(e,n,t):kN(e,n,t)}var m1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,g1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ra(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(m1),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(g1),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function ID(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(m1),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(g1),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var vl;function LD(e,n){var t=vl[e]||It(e);return t==="General"?uo(n):Vn(t,n)}function BD(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ir(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=zr(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[It(n)]=a}function WD(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=LD(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=vl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&mi(r)){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function UD(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=BE[r.Pattern]||r.Pattern)}e[n.ID]=n}function $D(e,n,t,r,a,o,l,c,f,h){var p="General",m=r.StyleID,g={};h=h||{};var v=[],w=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&l&&(m=l.StyleID);o[m]!==void 0&&(o[m].nf&&(p=o[m].nf),o[m].Interior&&v.push(o[m].Interior),!!o[m].Parent);)m=o[m].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=ir(e);break;case"String":r.t="s",r.r=eg(It(e)),r.v=e.indexOf("<")>-1?It(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(zr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=It(e):r.v<60&&(r.v=r.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Ay[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=eg(n||e));break}if(WD(r,p,h),h.cellFormula!==!1)if(r.Formula){var b=It(r.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),r.f=ni(b,a),delete r.Formula,r.ArrayRange=="RC"?r.F=ni("RC:RC",a):r.ArrayRange&&(r.F=ni(r.ArrayRange,a),f.push([hr(r.F),r.F]))}else for(w=0;w<f.length;++w)a.r>=f[w][0].s.r&&a.r<=f[w][0].e.r&&a.c>=f[w][0].s.c&&a.c<=f[w][0].e.c&&(r.F=f[w][1]);h.cellStyles&&(v.forEach(function(k){!g.patternType&&k.patternType&&(g.patternType=k.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function HD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sf(e,n){var t=n||{};sy();var r=al(dp(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=rr(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Ur(t);return l.type="string",Sl.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ne){a.indexOf("<"+Ne)>=0&&(o=!0)}),o)return JD(r,t);vl={"General Number":"General","General Date":St[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":St[15],"Short Date":St[14],"Long Time":St[19],"Medium Time":St[18],"Short Time":St[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:St[2],Standard:St[4],Percent:St[10],Scientific:St[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],h,p={},m=[],g=t.dense?[]:{},v="",w={},b={},k=ra('<Data ss:Type="String">'),C=0,D=0,E=0,Y={s:{r:2e6,c:2e6},e:{r:0,c:0}},ee={},G={},F="",H=0,U=[],ae={},J={},V=0,de=[],ue=[],le={},pe=[],q,oe=!1,B=[],re=[],I={},P=0,ce=0,A={Sheets:[],WBProps:{date1904:!1}},T={};_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var j="";c=_l.exec(r);)switch(c[3]=(j=c[3]).toLowerCase()){case"data":if(j=="data"){if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?$D(r.slice(C,c.index),F,k,f[f.length-1][0]=="comment"?le:w,{c:D,r:E},ee,pe[D],b,B,t):(F="",k=ra(c[0]),C=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ue.length>0&&(w.c=ue),(!t.sheetRows||t.sheetRows>E)&&w.v!==void 0&&(t.dense?(g[E]||(g[E]=[]),g[E][D]=w):g[Dr(D)+$r(E)]=w),w.HRef&&(w.l={Target:It(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(P=D+(parseInt(w.MergeAcross,10)|0),ce=E+(parseInt(w.MergeDown,10)|0),U.push({s:{c:D,r:E},e:{c:P,r:ce}})),!t.sheetStubs)w.MergeAcross?D=P+1:++D;else if(w.MergeAcross||w.MergeDown){for(var N=D;N<=P;++N)for(var W=E;W<=ce;++W)(N>D||W>E)&&(t.dense?(g[W]||(g[W]=[]),g[W][N]={t:"z"}):g[Dr(N)+$r(W)]={t:"z"});D=P+1}else++D;else w=ID(c[0]),w.Index&&(D=+w.Index-1),D<Y.s.c&&(Y.s.c=D),D>Y.e.c&&(Y.e.c=D),c[0].slice(-2)==="/>"&&++D,ue=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(E<Y.s.r&&(Y.s.r=E),E>Y.e.r&&(Y.e.r=E),c[0].slice(-2)==="/>"&&(b=ra(c[0]),b.Index&&(E=+b.Index-1)),D=0,++E):(b=ra(c[0]),b.Index&&(E=+b.Index-1),I={},(b.AutoFitHeight=="0"||b.Height)&&(I.hpx=parseInt(b.Height,10),I.hpt=e1(I.hpx),re[E]=I),b.Hidden=="1"&&(I.hidden=!0,re[E]=I));break;case"worksheet":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));m.push(v),Y.s.r<=Y.e.r&&Y.s.c<=Y.e.c&&(g["!ref"]=At(Y),t.sheetRows&&t.sheetRows<=Y.e.r&&(g["!fullref"]=g["!ref"],Y.e.r=t.sheetRows-1,g["!ref"]=At(Y))),U.length&&(g["!merges"]=U),pe.length>0&&(g["!cols"]=pe),re.length>0&&(g["!rows"]=re),p[v]=g}else Y={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=D=0,f.push([c[3],!1]),h=ra(c[0]),v=It(h.Name),g=t.dense?[]:{},U=[],B=[],re=[],T={name:v,Hidden:0},A.Sheets.push(T);break;case"table":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),pe=[],oe=!1}break;case"style":c[1]==="/"?UD(ee,G,t):G=ra(c[0]);break;case"numberformat":G.nf=It(ra(c[0]).Format||"General"),vl[G.nf]&&(G.nf=vl[G.nf]);for(var z=0;z!=392&&St[z]!=G.nf;++z);if(z==392){for(z=57;z!=392;++z)if(St[z]==null){ao(G.nf,z);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(q=ra(c[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!oe&&q.wpx>10){oe=!0,sn=Zy;for(var O=0;O<pe.length;++O)pe[O]&&ci(pe[O])}oe&&ci(q),pe[q.Index-1||pe.length]=q;for(var se=0;se<+q.Span;++se)pe[pe.length]=Ur(q);break;case"namedrange":if(c[1]==="/")break;A.Names||(A.Names=[]);var L=yt(c[0]),Oe={Name:L.Name,Ref:ni(L.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(Oe.Sheet=A.Sheets.length-1),A.Names.push(Oe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=r.slice(H,c.index):H=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;G.Interior=ra(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?C_(ae,j,r.slice(V,c.index)):V=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));HD(le),ue.push(le)}else f.push([c[3],!1]),h=ra(c[0]),le={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var je=ra(c[0]);g["!autofilter"]={ref:ni(je.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return Ig(r,t);var Ke=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ke=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ke=!1}break;case"excelworkbook":switch(c[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ke=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Ke=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(V,c.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else V=c.index+c[0].length;break;case"header":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+yt(c[0]).Margin)||(g["!margins"].header=+yt(c[0]).Margin);break;case"footer":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+yt(c[0]).Margin)||(g["!margins"].footer=+yt(c[0]).Margin);break;case"pagemargins":var Qe=yt(c[0]);g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+Qe.Top)||(g["!margins"].top=+Qe.Top),isNaN(+Qe.Left)||(g["!margins"].left=+Qe.Left),isNaN(+Qe.Right)||(g["!margins"].right=+Qe.Right),isNaN(+Qe.Bottom)||(g["!margins"].bottom=+Qe.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ke=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ke=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ke=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ke=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ke=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ke=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ke=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ke=!1}break;case"smarttags":break;default:Ke=!1;break}if(Ke||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?BD(J,j,de,r.slice(V,c.index)):(de=c,V=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var he={};return!t.bookSheets&&!t.bookProps&&(he.Sheets=p),he.SheetNames=m,he.Workbook=A,he.SSF=Ur(St),he.Props=ae,he.Custprops=J,he}function jf(e,n){switch(Np(n=n||{}),n.type||"base64"){case"base64":return sf(Tn(e),n);case"binary":case"buffer":case"file":return sf(e,n);case"array":return sf(yo(e),n)}}function YD(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=s_(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=o_(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var VD=[60,1084,2066,2165,2175];function KD(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=Ya(t,t.l),h=Pf[f],p=0;h!=null&&VD.indexOf(f)>-1;)o=Ya(t,t.l+2),p=t.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),c=t.slice(p,t.l+4+o),l.push(c),t.l+=4+o,h=Pf[f=Ya(t,t.l)];var m=Es(l);Br(m,0);var g=0;m.lens=[];for(var v=0;v<l.length;++v)m.lens.push(g),g+=l[v].length;if(m.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+r;return n.f(m,m.length,a)}function ga(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=St[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=Vn(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&mi(St[r]||String(r))){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function iu(e,n,t){return{v:e,ixfe:n,t}}function GD(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],h="",p={},m,g="",v,w,b,k,C={},D=[],E,Y,ee=[],G=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},H={},U=function(dt){return dt<8?so[dt]:dt<64&&G[dt-8]||so[dt]},ae=function(dt,Et,qt){var Tt=Et.XF.data;if(!(!Tt||!Tt.patternType||!qt||!qt.cellStyles)){Et.s={},Et.s.patternType=Tt.patternType;var Zt;(Zt=El(U(Tt.icvFore)))&&(Et.s.fgColor={rgb:Zt}),(Zt=El(U(Tt.icvBack)))&&(Et.s.bgColor={rgb:Zt})}},J=function(dt,Et,qt){if(!(I>1)&&!(qt.sheetRows&&dt.r>=qt.sheetRows)){if(qt.cellStyles&&Et.XF&&Et.XF.data&&ae(dt,Et,qt),delete Et.ixfe,delete Et.XF,m=dt,g=_t(dt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<l.s.r&&(l.s.r=dt.r),dt.c<l.s.c&&(l.s.c=dt.c),dt.r+1>l.e.r&&(l.e.r=dt.r+1),dt.c+1>l.e.c&&(l.e.c=dt.c+1),qt.cellFormula&&Et.f){for(var Tt=0;Tt<D.length;++Tt)if(!(D[Tt][0].s.c>dt.c||D[Tt][0].s.r>dt.r)&&!(D[Tt][0].e.c<dt.c||D[Tt][0].e.r<dt.r)){Et.F=At(D[Tt][0]),(D[Tt][0].s.c!=dt.c||D[Tt][0].s.r!=dt.r)&&delete Et.f,Et.f&&(Et.f=""+Qr(D[Tt][1],l,dt,B,V));break}}qt.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=Et):a[g]=Et}},V={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:D,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(V.password=n.password);var de,ue=[],le=[],pe=[],q=[],oe=!1,B=[];B.SheetNames=V.snames,B.sharedf=V.sharedf,B.arrayf=V.arrayf,B.names=[],B.XTI=[];var re=0,I=0,P=0,ce=[],A=[],T;V.codepage=1200,sa(1200);for(var j=!1;e.l<e.length-1;){var N=e.l,W=e.read_shift(2);if(W===0&&re===10)break;var z=e.l===e.length?0:e.read_shift(2),O=Pf[W];if(O&&O.f){if(n.bookSheets&&re===133&&W!==133)break;if(re=W,O.r===2||O.r==12){var se=e.read_shift(2);if(z-=2,!V.enc&&se!==W&&((se&255)<<8|se>>8)!==W)throw new Error("rt mismatch: "+se+"!="+W);O.r==12&&(e.l+=10,z-=10)}var L={};if(W===10?L=O.f(e,z,V):L=KD(W,O,e,z,V),I==0&&[9,521,1033,2057].indexOf(re)===-1)continue;switch(W){case 34:t.opts.Date1904=F.WBProps.date1904=L;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=L,!n.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=L;break;case 66:var Oe=Number(L);switch(Oe){case 21010:Oe=1200;break;case 32768:Oe=1e4;break;case 32769:Oe=1252;break}sa(V.codepage=Oe),j=!0;break;case 317:V.rrtabid=L;break;case 25:V.winlocked=L;break;case 439:t.opts.RefreshAll=L;break;case 12:t.opts.CalcCount=L;break;case 16:t.opts.CalcDelta=L;break;case 17:t.opts.CalcIter=L;break;case 13:t.opts.CalcMode=L;break;case 14:t.opts.CalcPrecision=L;break;case 95:t.opts.CalcSaveRecalc=L;break;case 15:V.CalcRefMode=L;break;case 2211:t.opts.FullCalc=L;break;case 129:L.fDialog&&(a["!type"]="dialog"),L.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),L.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:ee.push(L);break;case 430:B.push([L]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(L);break;case 24:case 536:T={Name:L.Name,Ref:Qr(L.rgce,l,null,B,V)},L.itab>0&&(T.Sheet=L.itab-1),B.names.push(T),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(A[L.itab-1]={ref:At(L.rgce[0][0][1][2])});break;case 22:V.ExternCount=L;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(L),B.XTI=B.XTI.concat(L);break;case 2196:if(V.biff<8)break;T!=null&&(T.Comment=L[1]);break;case 18:a["!protect"]=L;break;case 19:L!==0&&V.WTF&&console.error("Password verifier: "+L);break;case 133:o[L.pos]=L,V.snames.push(L.name);break;case 10:{if(--I)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=At(l),n.sheetRows&&n.sheetRows<=l.e.r){var je=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=At(l),l.e.r=je}l.e.r++,l.e.c++}ue.length>0&&(a["!merges"]=ue),le.length>0&&(a["!objects"]=le),pe.length>0&&(a["!cols"]=pe),q.length>0&&(a["!rows"]=q),F.Sheets.push(H)}h===""?p=a:r[h]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),V.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(V.biff=5,j=!0,sa(V.codepage=28591)),V.biff==8&&L.BIFFVer==0&&L.dt==16&&(V.biff=2),I++)break;if(a=n.dense?[]:{},V.biff<8&&!j&&(j=!0,sa(V.codepage=n.codepage||1252)),V.biff<5||L.BIFFVer==0&&L.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ke={pos:e.l-z,name:h};o[Ke.pos]=Ke,V.snames.push(h)}else h=(o[N]||{name:""}).name;L.dt==32&&(a["!type"]="chart"),L.dt==64&&(a["!type"]="macro"),ue=[],le=[],V.arrayf=D=[],pe=[],q=[],oe=!1,H={Hidden:(o[N]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[L.r]||[])[L.c]:a[_t({c:L.c,r:L.r})])&&++L.c,E={ixfe:L.ixfe,XF:ee[L.ixfe]||{},v:L.val,t:"n"},P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:L.c,r:L.r},E,n);break;case 5:case 517:E={ixfe:L.ixfe,XF:ee[L.ixfe],v:L.val,t:L.t},P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:L.c,r:L.r},E,n);break;case 638:E={ixfe:L.ixfe,XF:ee[L.ixfe],v:L.rknum,t:"n"},P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:L.c,r:L.r},E,n);break;case 189:for(var Qe=L.c;Qe<=L.C;++Qe){var he=L.rkrec[Qe-L.c][0];E={ixfe:he,XF:ee[he],v:L.rkrec[Qe-L.c][1],t:"n"},P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:Qe,r:L.r},E,n)}break;case 6:case 518:case 1030:{if(L.val=="String"){c=L;break}if(E=iu(L.val,L.cell.ixfe,L.tt),E.XF=ee[E.ixfe],n.cellFormula){var Ne=L.formula;if(Ne&&Ne[0]&&Ne[0][0]&&Ne[0][0][0]=="PtgExp"){var Pe=Ne[0][0][1][0],_e=Ne[0][0][1][1],Je=_t({r:Pe,c:_e});C[Je]?E.f=""+Qr(L.formula,l,L.cell,B,V):E.F=((n.dense?(a[Pe]||[])[_e]:a[Je])||{}).F}else E.f=""+Qr(L.formula,l,L.cell,B,V)}P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J(L.cell,E,n),c=L}break;case 7:case 519:if(c)c.val=L,E=iu(L,c.cell.ixfe,"s"),E.XF=ee[E.ixfe],n.cellFormula&&(E.f=""+Qr(c.formula,l,c.cell,B,V)),P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J(c.cell,E,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{D.push(L);var ft=_t(L[0].s);if(v=n.dense?(a[L[0].s.r]||[])[L[0].s.c]:a[ft],n.cellFormula&&v){if(!c||!ft||!v)break;v.f=""+Qr(L[1],l,L[0],B,V),v.F=At(L[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;C[_t(c.cell)]=L[0],v=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[_t(c.cell)],(v||{}).f=""+Qr(L[0],l,m,B,V)}}break;case 253:E=iu(f[L.isst].t,L.ixfe,"s"),f[L.isst].h&&(E.h=f[L.isst].h),E.XF=ee[E.ixfe],P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:L.c,r:L.r},E,n);break;case 513:n.sheetStubs&&(E={ixfe:L.ixfe,XF:ee[L.ixfe],t:"z"},P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:L.c,r:L.r},E,n));break;case 190:if(n.sheetStubs)for(var ut=L.c;ut<=L.C;++ut){var ht=L.ixfe[ut-L.c];E={ixfe:ht,XF:ee[ht],t:"z"},P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:ut,r:L.r},E,n)}break;case 214:case 516:case 4:E=iu(L.val,L.ixfe,"s"),E.XF=ee[E.ixfe],P>0&&(E.z=ce[E.ixfe>>8&63]),ga(E,n,t.opts.Date1904),J({c:L.c,r:L.r},E,n);break;case 0:case 512:I===1&&(l=L);break;case 252:f=L;break;case 1054:if(V.biff==4){ce[P++]=L[1];for(var Ot=0;Ot<P+163&&St[Ot]!=L[1];++Ot);Ot>=163&&ao(L[1],P+163)}else ao(L[1],L[0]);break;case 30:{ce[P++]=L;for(var Yt=0;Yt<P+163&&St[Yt]!=L;++Yt);Yt>=163&&ao(L,P+163)}break;case 229:ue=ue.concat(L);break;case 93:le[L.cmo[0]]=V.lastobj=L;break;case 438:V.lastobj.TxO=L;break;case 127:V.lastobj.ImData=L;break;case 440:for(k=L[0].s.r;k<=L[0].e.r;++k)for(b=L[0].s.c;b<=L[0].e.c;++b)v=n.dense?(a[k]||[])[b]:a[_t({c:b,r:k})],v&&(v.l=L[1]);break;case 2048:for(k=L[0].s.r;k<=L[0].e.r;++k)for(b=L[0].s.c;b<=L[0].e.c;++b)v=n.dense?(a[k]||[])[b]:a[_t({c:b,r:k})],v&&v.l&&(v.l.Tooltip=L[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;v=n.dense?(a[L[0].r]||[])[L[0].c]:a[_t(L[0])];var Jt=le[L[2]];v||(n.dense?(a[L[0].r]||(a[L[0].r]=[]),v=a[L[0].r][L[0].c]={t:"z"}):v=a[_t(L[0])]={t:"z"},l.e.r=Math.max(l.e.r,L[0].r),l.s.r=Math.min(l.s.r,L[0].r),l.e.c=Math.max(l.e.c,L[0].c),l.s.c=Math.min(l.s.c,L[0].c)),v.c||(v.c=[]),w={a:L[1],t:Jt.TxO.t},v.c.push(w)}break;case 2173:mN(ee[L.ixfe],L.ext);break;case 125:{if(!V.cellStyles)break;for(;L.e>=L.s;)pe[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},oe||(oe=!0,kp(L.w/256)),ci(pe[L.e+1])}break;case 520:{var Lt={};L.level!=null&&(q[L.r]=Lt,Lt.level=L.level),L.hidden&&(q[L.r]=Lt,Lt.hidden=!0),L.hpt&&(q[L.r]=Lt,Lt.hpt=L.hpt,Lt.hpx=Nl(L.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||gl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=L;break;case 161:a["!margins"]||gl(a["!margins"]={}),a["!margins"].header=L.header,a["!margins"].footer=L.footer;break;case 574:L.RTL&&(F.Views[0].RTL=!0);break;case 146:G=L;break;case 2198:de=L;break;case 140:Y=L;break;case 442:h?H.CodeName=L||H.name:F.WBProps.CodeName=L||"ThisWorkbook";break}}else O||console.error("Missing Info for XLS Record 0x"+W.toString(16)),e.l+=z}return t.SheetNames=Ca(o).sort(function(Xt,dt){return Number(Xt)-Number(dt)}).map(function(Xt){return o[Xt].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&A.forEach(function(Xt,dt){t.Sheets[t.SheetNames[dt]]["!autofilter"]=Xt}),t.Strings=f,t.SSF=Ur(St),V.enc&&(t.Encryption=V.enc),de&&(t.Themes=de),t.Metadata={},Y!==void 0&&(t.Metadata.Country=Y),B.names.length>0&&(F.Names=B.names),t.Workbook=F,t}var Ag={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function QD(e,n,t){var r=Pt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=mg(r,f_,Ag.DSI);for(var o in a)n[o]=a[o]}catch(h){if(t.WTF)throw h}var l=Pt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=mg(l,p_,Ag.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(h){if(t.WTF)throw h}n.HeadingPairs&&n.TitlesOfParts&&(Ry(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function v1(e,n){n||(n={}),Np(n),Kv(),n.codepage&&ap(n.codepage);var t,r;if(e.FullPaths){if(Pt.find(e,"/encryption"))throw new Error("File is password-protected");t=Pt.find(e,"!CompObj"),r=Pt.find(e,"/Workbook")||Pt.find(e,"/Book")}else{switch(n.type){case"base64":e=aa(Tn(e));break;case"binary":e=aa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Br(e,0),r={content:e}}var a,o;if(t&&YD(t),n.bookProps&&!n.bookSheets)a={};else{var l=jt?"buffer":"array";if(r&&r.content)a=GD(r.content,n);else if((o=Pt.find(e,"PerfectOffice_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else if((o=Pt.find(e,"NativeContent_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else throw(o=Pt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&Pt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=ON(e))}var c={};return e.FullPaths&&QD(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Ou={0:{f:FT},1:{f:OT},2:{f:$T},3:{f:IT},4:{f:zT},5:{f:UT},6:{f:VT},7:{f:BT},8:{f:qT},9:{f:XT},10:{f:GT},11:{f:QT},12:{f:RT},13:{f:HT},14:{f:LT},15:{f:MT},16:{f:p1},17:{f:KT},18:{f:WT},19:{f:xp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:SD},40:{},42:{},43:{f:GE},44:{f:KE},45:{f:QE},46:{f:qE},47:{f:XE},48:{},49:{f:Z2},50:{},51:{f:vN},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ky},62:{f:YT},63:{f:_N},64:{f:oD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:AT},148:{f:jT,p:16},151:{f:eD},152:{},153:{f:bD},154:{},155:{},156:{f:kD},157:{},158:{},159:{T:1,f:pE},160:{T:-1},161:{T:1,f:ko},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ZT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gN},336:{T:-1},337:{f:yN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Vy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:tD},427:{f:rD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:aD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:PT},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jN},633:{T:1},634:{T:-1},635:{T:1,f:FN},636:{T:-1},637:{f:e_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:iD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Pf={6:{f:nf},10:{f:_s},12:{f:Er},13:{f:Er},14:{f:yr},15:{f:yr},16:{f:Xr},17:{f:yr},18:{f:yr},19:{f:Er},20:{f:wg},21:{f:wg},23:{f:Vy},24:{f:bg},25:{f:yr},26:{},27:{},28:{f:TS},29:{},34:{f:yr},35:{f:kg},38:{f:Xr},39:{f:Xr},40:{f:Xr},41:{f:Xr},42:{f:yr},43:{f:yr},47:{f:PE},49:{f:cS},51:{f:Er},60:{},61:{f:oS},64:{f:yr},65:{f:lS},66:{f:Er},77:{},80:{},81:{},82:{},85:{f:Er},89:{},90:{},91:{},92:{f:Z_},93:{f:FS},94:{},95:{f:yr},96:{},97:{},99:{f:yr},125:{f:Ky},128:{f:yS},129:{f:J_},130:{f:Er},131:{f:yr},132:{f:yr},133:{f:eS},134:{},140:{f:zS},141:{f:Er},144:{},146:{f:IS},151:{},152:{},153:{},154:{},155:{},156:{f:Er},157:{},158:{},160:{f:$S},161:{f:BS},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:xS},190:{f:mS},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:yr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Er},220:{},221:{f:yr},222:{},224:{f:vS},225:{f:q_},226:{f:_s},227:{},229:{f:DS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:tS},253:{f:uS},255:{f:rS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:By},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yr},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:kS},431:{f:yr},432:{},433:{},434:{},437:{},438:{f:AS},439:{f:yr},440:{f:OS},441:{},442:{f:Rl},443:{},444:{f:Er},445:{},446:{},448:{f:_s},449:{f:sS,r:2},450:{f:_s},512:{f:vg},513:{f:US},515:{f:wS},516:{f:dS},517:{f:yg},519:{f:HS},520:{f:nS},523:{},545:{f:_g},549:{f:gg},566:{},574:{f:iS},638:{f:hS},659:{},1048:{},1054:{f:fS},1084:{},1212:{f:ES},2048:{f:RS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:au},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:LS,r:12},2173:{f:xN,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:SS,r:12},2197:{},2198:{f:cN,r:12},2199:{},2200:{},2201:{},2202:{f:NS,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:aS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:WS},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:MS},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:vg},1:{},2:{f:GS},3:{f:KS},4:{f:VS},5:{f:yg},7:{f:QS},8:{},9:{f:au},11:{},22:{f:Er},30:{f:pS},31:{},32:{},33:{f:_g},36:{},37:{f:gg},50:{f:XS},62:{},52:{},67:{},68:{f:Er},69:{},86:{},126:{},127:{f:YS},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qS},223:{},234:{},354:{},421:{},518:{f:nf},521:{f:au},536:{f:bg},547:{f:kg},561:{},579:{},1030:{f:nf},1033:{f:au},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function na(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&Cy(t)&&e.push(t)}}function Og(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=w2(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,m=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<f.length;++l){var b=f[l].trim(),k=b.slice(0,3).toLowerCase();if(k=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(k!="<td"&&k!="<th")){var C=b.split(/<\/t[dh]>/i);for(c=0;c<C.length;++c){var D=C[c].trim();if(D.match(/<t[dh]/i)){for(var E=D,Y=0;E.charAt(0)=="<"&&(Y=E.indexOf(">"))>-1;)E=E.slice(Y+1);for(var ee=0;ee<w.length;++ee){var G=w[ee];G.s.c==p&&G.s.r<h&&h<=G.e.r&&(p=G.e.c+1,ee=-1)}var F=yt(D.slice(0,D.indexOf(">")));g=F.colspan?+F.colspan:1,((m=+F.rowspan)>1||g>1)&&w.push({s:{r:h,c:p},e:{r:h+(m||1)-1,c:p+g-1}});var H=F.t||F["data-t"]||"";if(!E.length){p+=g;continue}if(E=hy(E),v.s.r>h&&(v.s.r=h),v.e.r<h&&(v.e.r=h),v.s.c>p&&(v.s.c=p),v.e.c<p&&(v.e.c=p),!E.length){p+=g;continue}var U={t:"s",v:E};t.raw||!E.trim().length||H=="s"||(E==="TRUE"?U={t:"b",v:!0}:E==="FALSE"?U={t:"b",v:!1}:isNaN(ia(E))?isNaN(li(E).getDate())||(U={t:"d",v:zr(E)},t.cellDates||(U={t:"n",v:fn(U.v)}),U.z=t.dateNF||St[14]):U={t:"n",v:ia(E)}),t.dense?(r[h]||(r[h]=[]),r[h][p]=U):r[_t({r:h,c:p})]=U,p+=g}}}}return r["!ref"]=At(v),w.length&&(r["!merges"]=w),r}function XD(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>l)&&!(a[h].e.r<t||a[h].e.c<l)){if(a[h].s.r<t||a[h].s.c<l){c=-1;break}c=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(c<0)){var p=_t({r:t,c:l}),m=r.dense?(e[t]||[])[l]:e[p],g=m&&m.v!=null&&(m.h||up(m.w||(Ja(m),m.w)||""))||"",v={};c>1&&(v.rowspan=c),f>1&&(v.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),v.id=(r.id||"sjs")+"-"+p,o.push(z2("td",g,v))}}var w="<tr>";return w+o.join("")+"</tr>"}var qD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ZD="</body></html>";function JD(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ms(Og(t[0],n),n);var r=Tp();return t.forEach(function(a,o){Dp(r,Og(a,n),"Sheet"+(o+1))}),r}function e4(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function t4(e,n){var t=n||{},r=t.header!=null?t.header:qD,a=t.footer!=null?t.footer:ZD,o=[r],l=gi(e["!ref"]);t.dense=Array.isArray(e),o.push(e4(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(XD(e,l,c,t));return o.push("</table>"+a),o.join("")}function y1(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var p=gi(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),a==-1&&(h.e.r=a=p.e.r+1)}var m=[],g=0,v=e["!rows"]||(e["!rows"]=[]),w=0,b=0,k=0,C=0,D=0,E=0;for(e["!cols"]||(e["!cols"]=[]);w<c.length&&b<f;++w){var Y=c[w];if(Rg(Y)){if(r.display)continue;v[b]={hidden:!0}}var ee=Y.children;for(k=C=0;k<ee.length;++k){var G=ee[k];if(!(r.display&&Rg(G))){var F=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):hy(G.innerHTML),H=G.getAttribute("data-z")||G.getAttribute("z");for(g=0;g<m.length;++g){var U=m[g];U.s.c==C+o&&U.s.r<b+a&&b+a<=U.e.r&&(C=U.e.c+1-o,g=-1)}E=+G.getAttribute("colspan")||1,((D=+G.getAttribute("rowspan")||1)>1||E>1)&&m.push({s:{r:b+a,c:C+o},e:{r:b+a+(D||1)-1,c:C+o+(E||1)-1}});var ae={t:"s",v:F},J=G.getAttribute("data-t")||G.getAttribute("t")||"";F!=null&&(F.length==0?ae.t=J||"z":r.raw||F.trim().length==0||J=="s"||(F==="TRUE"?ae={t:"b",v:!0}:F==="FALSE"?ae={t:"b",v:!1}:isNaN(ia(F))?isNaN(li(F).getDate())||(ae={t:"d",v:zr(F)},r.cellDates||(ae={t:"n",v:fn(ae.v)}),ae.z=r.dateNF||St[14]):ae={t:"n",v:ia(F)})),ae.z===void 0&&H!=null&&(ae.z=H);var V="",de=G.getElementsByTagName("A");if(de&&de.length)for(var ue=0;ue<de.length&&!(de[ue].hasAttribute("href")&&(V=de[ue].getAttribute("href"),V.charAt(0)!="#"));++ue);V&&V.charAt(0)!="#"&&(ae.l={Target:V}),r.dense?(e[b+a]||(e[b+a]=[]),e[b+a][C+o]=ae):e[_t({c:C+o,r:b+a})]=ae,h.e.c<C+o&&(h.e.c=C+o),C+=E}}++b}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),h.e.r=Math.max(h.e.r,b-1+a),e["!ref"]=At(h),b>=f&&(e["!fullref"]=At((h.e.r=c.length-w+b-1+a,h))),e}function w1(e,n){var t=n||{},r=t.dense?[]:{};return y1(r,e,n)}function r4(e,n){return Ms(w1(e,n),n)}function Rg(e){var n="",t=n4(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function n4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function a4(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=It(n.replace(/<[^>]*>/g,""));return[t]}var zg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function k1(e,n){var t=n||{},r=dp(e),a=[],o,l,c={name:""},f="",h=0,p,m,g={},v=[],w=t.dense?[]:{},b,k,C={value:""},D="",E=0,Y=[],ee=-1,G=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},H=0,U={},ae=[],J={},V=0,de=0,ue=[],le=1,pe=1,q=[],oe={Names:[]},B={},re=["",""],I=[],P={},ce="",A=0,T=!1,j=!1,N=0;for(_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=_l.exec(r);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?w["!ref"]=At(F):w["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=F.e.r&&(w["!fullref"]=w["!ref"],F.e.r=t.sheetRows-1,w["!ref"]=At(F)),ae.length&&(w["!merges"]=ae),ue.length&&(w["!rows"]=ue),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),v.push(p.name),g[p.name]=w,j=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=yt(b[0],!1),ee=G=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,w=t.dense?[]:{},ae=[],ue=[],j=!0);break;case"table-row-group":b[1]==="/"?--H:++H;break;case"table-row":case"":if(b[1]==="/"){ee+=le,le=1;break}if(m=yt(b[0],!1),m.?ee=m.-1:ee==-1&&(ee=0),le=+m["number-rows-repeated"]||1,le<10)for(N=0;N<le;++N)H>0&&(ue[ee+N]={level:H});G=-1;break;case"covered-table-cell":b[1]!=="/"&&++G,t.sheetStubs&&(t.dense?(w[ee]||(w[ee]=[]),w[ee][G]={t:"z"}):w[_t({r:ee,c:G})]={t:"z"}),D="",Y=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++G,C=yt(b[0],!1),pe=parseInt(C["number-columns-repeated"]||"1",10),k={t:"z",v:null},C.formula&&t.cellFormula!=!1&&(k.f=Fg(It(C.formula))),(C.||C["value-type"])=="string"&&(k.t="s",k.v=It(C["string-value"]||""),t.dense?(w[ee]||(w[ee]=[]),w[ee][G]=k):w[_t({r:ee,c:G})]=k),G+=pe-1;else if(b[1]!=="/"){++G,D="",E=0,Y=[],pe=1;var W=le?ee+le-1:ee;if(G>F.e.c&&(F.e.c=G),G<F.s.c&&(F.s.c=G),ee<F.s.r&&(F.s.r=ee),W>F.e.r&&(F.e.r=W),C=yt(b[0],!1),I=[],P={},k={t:C.||C["value-type"],v:null},t.cellFormula)if(C.formula&&(C.formula=It(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(V=parseInt(C["number-matrix-rows-spanned"],10)||0,de=parseInt(C["number-matrix-columns-spanned"],10)||0,J={s:{r:ee,c:G},e:{r:ee+V-1,c:G+de-1}},k.F=At(J),q.push([J,k.F])),C.formula)k.f=Fg(C.formula);else for(N=0;N<q.length;++N)ee>=q[N][0].s.r&&ee<=q[N][0].e.r&&G>=q[N][0].s.c&&G<=q[N][0].e.c&&(k.F=q[N][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(V=parseInt(C["number-rows-spanned"],10)||0,de=parseInt(C["number-columns-spanned"],10)||0,J={s:{r:ee,c:G},e:{r:ee+V-1,c:G+de-1}},ae.push(J)),C["number-columns-repeated"]&&(pe=parseInt(C["number-columns-repeated"],10)),k.t){case"boolean":k.t="b",k.v=ir(C["boolean-value"]);break;case"float":k.t="n",k.v=parseFloat(C.value);break;case"percentage":k.t="n",k.v=parseFloat(C.value);break;case"currency":k.t="n",k.v=parseFloat(C.value);break;case"date":k.t="d",k.v=zr(C["date-value"]),t.cellDates||(k.t="n",k.v=fn(k.v)),k.z="m/d/yy";break;case"time":k.t="n",k.v=g2(C["time-value"])/86400,t.cellDates&&(k.t="d",k.v=Xu(k.v)),k.z="HH:MM:SS";break;case"number":k.t="n",k.v=parseFloat(C.);break;default:if(k.t==="string"||k.t==="text"||!k.t)k.t="s",C["string-value"]!=null&&(D=It(C["string-value"]),Y=[]);else throw new Error("Unsupported value type "+k.t)}}else{if(T=!1,k.t==="s"&&(k.v=D||"",Y.length&&(k.R=Y),T=E==0),B.Target&&(k.l=B),I.length>0&&(k.c=I,I=[]),D&&t.cellText!==!1&&(k.w=D),T&&(k.t="z",delete k.v),(!T||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=ee))for(var z=0;z<le;++z){if(pe=parseInt(C["number-columns-repeated"]||"1",10),t.dense)for(w[ee+z]||(w[ee+z]=[]),w[ee+z][G]=z==0?k:Ur(k);--pe>0;)w[ee+z][G+pe]=Ur(k);else for(w[_t({r:ee+z,c:G})]=k;--pe>0;)w[_t({r:ee+z,c:G+pe})]=Ur(k);F.e.c<=G&&(F.e.c=G)}pe=parseInt(C["number-columns-repeated"]||"1",10),G+=pe-1,pe=0,k={},D="",Y=[]}B={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o;P.t=D,Y.length&&(P.R=Y),P.a=ce,I.push(P)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);ce="",A=0,D="",E=0,Y=[];break;case"creator":b[1]==="/"?ce=r.slice(A,b.index):A=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);D="",E=0,Y=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(U[c.name]=f,(o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(f="",c=yt(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=yt(b[0],!1),f+=zg[b[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=yt(b[0],!1),f+=zg[b[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(h,b.index);break}else h=b.index+b[0].length;break;case"named-range":l=yt(b[0],!1),re=af(l["cell-range-address"]);var O={Name:l.name,Ref:re[0]+"!"+re[1]};j&&(O.Sheet=v.length),oe.Names.push(O);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!C||!C["string-value"])){var se=a4(r.slice(E,b.index));D=(D.length>0?D+`
`:"")+se[0]}else yt(b[0],!1),E=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{re=af(yt(b[0])["target-range-address"]),g[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(B=yt(b[0],!1),!B.href)break;B.Target=It(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(re=af(B.Target.slice(1)),B.Target="#"+re[0]+"!"+re[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(b)}}var L={Sheets:g,SheetNames:v,Workbook:oe};return t.bookSheets&&delete L.Sheets,L}function Mg(e,n){n=n||{},Bn(e,"META-INF/manifest.xml")&&w_(Sr(e,"META-INF/manifest.xml"),n);var t=Nn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=k1(rr(t),n);return Bn(e,"meta.xml")&&(r.Props=Oy(Sr(e,"meta.xml"))),r}function Ig(e,n){return k1(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Sp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Af(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):rr(yo(e))}function Of(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function Lg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function s4(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Cl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Fr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function qr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Cl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Cl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:c,type:o};n[a]==null?n[a]=[h]:n[a].push(h)}return n}function Ep(e,n){return e?.map(function(t){return n(t.data)})||[]}function o4(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Cl(e,r),o=qr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Fr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=qr(c.data),h=Fr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(n=o[3])!=null&&n[0]&&(l.merge=Fr(o[3][0].data)>>>0>0),t.push(l)}return t}function i4(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Cl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,h=0;if(o==1?(h=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(h=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Of(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var p=Of(a);if(p.length!=r)throw new Error("Unexpected length: ".concat(p.length," != ").concat(r));return p}function l4(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(i4(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Of(n)}function c4(e,n,t,r){var a=Sp(e),o=a.getUint32(4,!0),l=(r>1?12:8)+Lg(o&(r>1?3470:398))*4,c=-1,f=-1,h=NaN,p=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=Lg(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(h=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:h};break;case 3:m={t:"s",v:n[f]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:t[c]};else if(f>-1)m={t:"s",v:n[f]};else if(!isNaN(h))m={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function u4(e,n,t){var r=Sp(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,h=NaN,p=new Date(2001,0,1);a&1&&(f=s4(e,o),o+=16),a&2&&(h=r.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:n[c]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function d4(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return c4(e,n,t,e[0]);case 5:return u4(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fs(e){var n=qr(e);return Cl(n[1][0].data)}function Bg(e,n){var t=qr(n.data),r=Fr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=qr(l.data),f=Fr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Af(c[3][0].data);break;case 8:{var h=e[Fs(c[9][0].data)][0],p=qr(h.data),m=e[Fs(p[1][0].data)][0],g=Fr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=qr(m.data);o[f]=v[3].map(function(w){return Af(w.data)}).join("")}break}}),o}function f4(e,n){var t,r,a,o,l,c,f,h,p,m,g,v,w,b,k=qr(e),C=Fr(k[1][0].data)>>>0,D=Fr(k[2][0].data)>>>0,E=((r=(t=k[8])==null?void 0:t[0])==null?void 0:r.data)&&Fr(k[8][0].data)>0||!1,Y,ee;if((o=(a=k[7])==null?void 0:a[0])!=null&&o.data&&n!=0)Y=(c=(l=k[7])==null?void 0:l[0])==null?void 0:c.data,ee=(h=(f=k[6])==null?void 0:f[0])==null?void 0:h.data;else if((m=(p=k[4])==null?void 0:p[0])!=null&&m.data&&n!=1)Y=(v=(g=k[4])==null?void 0:g[0])==null?void 0:v.data,ee=(b=(w=k[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var G=E?4:1,F=Sp(Y),H=[],U=0;U<Y.length/2;++U){var ae=F.getUint16(U*2,!0);ae<65535&&H.push([U,ae])}if(H.length!=D)throw"Expected ".concat(D," cells, found ").concat(H.length);var J=[];for(U=0;U<H.length-1;++U)J[H[U][0]]=ee.subarray(H[U][1]*G,H[U+1][1]*G);return H.length>=1&&(J[H[H.length-1][0]]=ee.subarray(H[H.length-1][1]*G)),{R:C,cells:J}}function p4(e,n){var t,r=qr(n.data),a=(t=r?.[7])!=null&&t[0]?Fr(r[7][0].data)>>>0>0?1:0:-1,o=Ep(r[5],function(l){return f4(l,a)});return{nrows:Fr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,h){if(l[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));l[c.R][h]=f}),l},[])}}function h4(e,n,t){var r,a=qr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Fr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Fr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=At(o);var l=qr(a[4][0].data),c=Bg(e,e[Fs(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?Bg(e,e[Fs(l[17][0].data)][0]):[],h=qr(l[3][0].data),p=0;h[1].forEach(function(m){var g=qr(m.data),v=e[Fs(g[2][0].data)][0],w=Fr(v.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=p4(e,v);b.data.forEach(function(k,C){k.forEach(function(D,E){var Y=_t({r:p+C,c:E}),ee=d4(D,c,f);ee&&(t[Y]=ee)})}),p+=b.nrows})}function x4(e,n){var t=qr(n.data),r={"!ref":"A1"},a=e[Fs(t[2][0].data)],o=Fr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return h4(e,a[0],r),r}function m4(e,n){var t,r=qr(n.data),a={name:(t=r[1])!=null&&t[0]?Af(r[1][0].data):"",sheets:[]},o=Ep(r[2],Fs);return o.forEach(function(l){e[l].forEach(function(c){var f=Fr(c.meta[1][0].data);f==6e3&&a.sheets.push(x4(e,c))})}),a}function g4(e,n){var t=Tp(),r=qr(n.data),a=Ep(r[1],Fs);if(a.forEach(function(o){e[o].forEach(function(l){var c=Fr(l.meta[1][0].data);if(c==2){var f=m4(e,l);f.sheets.forEach(function(h,p){Dp(t,h,p==0?f.name:f.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function of(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=l4(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var p;try{p=o4(h)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){o[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Fr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(h){var p=Fr(h.meta[1][0].data)>>>0;if(p==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return g4(o,c)}function v4(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Np(e){v4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function y4(e){return ei.WS.indexOf(e)>-1?"sheet":e==ei.CS?"chart":e==ei.DS?"dialog":e==ei.MS?"macro":e&&e.length?e:"sheet"}function w4(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,y4(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function k4(e,n,t,r,a,o,l,c,f,h,p,m){try{o[r]=pl(Nn(e,t,!0),n);var g=Sr(e,n),v;switch(c){case"sheet":v=CD(g,n,a,f,o[r],h,p,m);break;case"chart":if(v=TD(g,n,a,f,o[r],h,p,m),!v||!v["!drawel"])break;var w=ol(v["!drawel"].Target,n),b=Tf(w),k=NN(Nn(e,w,!0),pl(Nn(e,b,!0),w)),C=ol(k,w),D=Tf(C);v=uD(Nn(e,C,!0),C,f,pl(Nn(e,D,!0),C),h,v);break;case"macro":v=DD(g,n,a,f,o[r],h,p,m);break;case"dialog":v=FD(g,n,a,f,o[r],h,p,m);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=v;var E=[];o&&o[r]&&Ca(o[r]).forEach(function(Y){var ee="";if(o[r][Y].Type==ei.CMNT){ee=ol(o[r][Y].Target,n);var G=OD(Sr(e,ee,!0),ee,f);if(!G||!G.length)return;Eg(v,G,!1)}o[r][Y].Type==ei.TCMNT&&(ee=ol(o[r][Y].Target,n),E=E.concat(TN(Sr(e,ee,!0),f)))}),E&&E.length&&Eg(v,E,!0,f.people||[])}catch(Y){if(f.WTF)throw Y}}function Mn(e){return e.charAt(0)=="/"?e.slice(1):e}function b4(e,n){if(sy(),n=n||{},Np(n),Bn(e,"META-INF/manifest.xml")||Bn(e,"objectdata.xml"))return Mg(e,n);if(Bn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof of<"u"){if(e.FileIndex)return of(e);var t=Pt.utils.cfb_new();return Zm(e).forEach(function(ue){_2(t,ue,b2(e,ue))}),of(t)}throw new Error("Unsupported NUMBERS file")}if(!Bn(e,"[Content_Types].xml"))throw Bn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Bn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Zm(e),a=v_(Nn(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Sr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Sr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},h={};if(!n.bookSheets&&!n.bookProps){if(ml=[],a.sst)try{ml=AD(Sr(e,Mn(a.sst)),a.sst,n)}catch(ue){if(n.WTF)throw ue}n.cellStyles&&a.themes.length&&(f=PD(Nn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(h=jD(Sr(e,Mn(a.style)),a.style,f,n))}a.links.map(function(ue){try{var le=pl(Nn(e,Tf(Mn(ue))),ue);return zD(Sr(e,Mn(ue)),le,ue,n)}catch{}});var p=ND(Sr(e,Mn(a.workbooks[0])),a.workbooks[0],n),m={},g="";a.coreprops.length&&(g=Sr(e,Mn(a.coreprops[0]),!0),g&&(m=Oy(g)),a.extprops.length!==0&&(g=Sr(e,Mn(a.extprops[0]),!0),g&&__(g,m,n)));var v={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=Nn(e,Mn(a.custprops[0]),!0),g&&(v=E_(g,n)));var w={};if((n.bookSheets||n.bookProps)&&(p.Sheets?l=p.Sheets.map(function(le){return le.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),n.bookProps&&(w.Props=m,w.Custprops=v),n.bookSheets&&typeof l<"u"&&(w.SheetNames=l),n.bookSheets?w.SheetNames:n.bookProps))return w;l={};var b={};n.bookDeps&&a.calcchain&&(b=RD(Sr(e,Mn(a.calcchain)),a.calcchain));var k=0,C={},D,E;{var Y=p.Sheets;m.Worksheets=Y.length,m.SheetNames=[];for(var ee=0;ee!=Y.length;++ee)m.SheetNames[ee]=Y[ee].name}var G=o?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),H=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Bn(e,H)||(H="xl/_rels/workbook."+G+".rels");var U=pl(Nn(e,H,!0),H.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=MD(Sr(e,Mn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=DN(Sr(e,Mn(a.people[0])),n)),U&&(U=w4(U,p.Sheets));var ae=Sr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(k=0;k!=m.Worksheets;++k){var J="sheet";if(U&&U[k]?(D="xl/"+U[k][1].replace(/[\/]?xl\//,""),Bn(e,D)||(D=U[k][1]),Bn(e,D)||(D=H.replace(/_rels\/.*$/,"")+U[k][1]),J=U[k][2]):(D="xl/worksheets/sheet"+(k+1-ae)+"."+G,D=D.replace(/sheet0\./,"sheet.")),E=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(k!=n.sheets)continue e;break;case"string":if(m.SheetNames[k].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var V=!1,de=0;de!=n.sheets.length;++de)typeof n.sheets[de]=="number"&&n.sheets[de]==k&&(V=1),typeof n.sheets[de]=="string"&&n.sheets[de].toLowerCase()==m.SheetNames[k].toLowerCase()&&(V=1);if(!V)continue e}}k4(e,D,E,m.SheetNames[k],k,C,l,J,n,p,f,h)}return w={Directory:a,Workbook:p,Props:m,Custprops:v,Deps:b,Sheets:l,SheetNames:m.SheetNames,Strings:ml,Styles:h,Themes:f,SSF:Ur(St)},n&&n.bookFiles&&(e.files?(w.keys=r,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(ue,le){ue=ue.replace(/^Root Entry[\/]/,""),w.keys.push(ue),w.files[ue]=e.FileIndex[le]}))),n&&n.bookVBA&&(a.vba.length>0?w.vbaraw=Sr(e,Mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===AN&&(w.vbaraw=Sr(e,"xl/vbaProject.bin",!0))),w}function _4(e,n){var t=n||{},r="Workbook",a=Pt.find(e,r);try{if(r="/!DataSpaces/Version",a=Pt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(xE(a.content),r="/!DataSpaces/DataSpaceMap",a=Pt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=gE(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Pt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=vE(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Pt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);wE(a.content)}catch{}if(r="/EncryptionInfo",a=Pt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=kE(a.content);if(r="/EncryptedPackage",a=Pt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Cp(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Tn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function S4(e,n){return Pt.find(e,"EncryptedPackage")?_4(e,n):v1(e,n)}function E4(e,n){var t,r=e,a=n||{};return a.type||(a.type=jt&&Buffer.isBuffer(e)?"buffer":"base64"),t=dy(r,a),b4(t,a)}function b1(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return jf(e.slice(t),n);default:break e}return Sl.to_workbook(e,n)}function N4(e,n){var t="",r=Cp(e,n);switch(n.type){case"base64":t=Tn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=fo(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=rr(t)),n.type="binary",b1(t,n)}function C4(e,n){var t=e;return n.type=="base64"&&(t=Tn(t)),t=wl.utils.decode(1200,t.slice(2),"str"),n.type="binary",b1(t,n)}function T4(e){return e.match(/[^\x00-\x7F]/)?il(e):e}function lf(e,n,t,r){return r?(t.type="string",Sl.to_workbook(e,t)):Sl.to_workbook(n,t)}function Rf(e,n){Kv();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rf(new Uint8Array(e),(t=Ur(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ai={},t.dateNF&&(ai.dateNF=t.dateNF),t.type||(t.type=jt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=jt?"buffer":"binary",r=x2(e),typeof Uint8Array<"u"&&!jt&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=T4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=Ur(t),t.type="array",Rf(sp(r),t)}switch((a=Cp(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return S4(Pt.read(r,t),t);break;case 9:if(a[1]<=8)return v1(r,t);break;case 60:return jf(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return rE(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return eE.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?E4(r,t):lf(e,r,t,o);case 239:return a[3]===60?jf(r,t):lf(e,r,t,o);case 255:if(a[1]===254)return C4(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return xl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return xl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return Sg.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return AE.to_workbook(r,t);break;case 10:case 13:case 32:return N4(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ZS.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Sg.to_workbook(r,t):lf(e,r,t,o)}function D4(e,n,t,r,a,o,l,c){var f=$r(t),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var v=n.s.c;v<=n.e.c;++v){var w=l?e[t][v]:e[r[v]+f];if(w===void 0||w.t===void 0){if(h===void 0)continue;o[v]!=null&&(g[o[v]]=h);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[v]!=null){if(b==null)if(w.t=="e"&&b===null)g[o[v]]=null;else if(h!==void 0)g[o[v]]=h;else if(p&&b===null)g[o[v]]=null;else continue;else g[o[v]]=p&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?b:Ja(w,b,c);b!=null&&(m=!1)}}return{row:g,isempty:m}}function zf(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof p){case"string":f=hr(p);break;case"number":f=hr(e["!ref"]),f.s.r=p;break;default:f=p}r>0&&(a=0);var m=$r(f.s.r),g=[],v=[],w=0,b=0,k=Array.isArray(e),C=f.s.r,D=0,E={};k&&!e[C]&&(e[C]=[]);var Y=h.skipHidden&&e["!cols"]||[],ee=h.skipHidden&&e["!rows"]||[];for(D=f.s.c;D<=f.e.c;++D)if(!(Y[D]||{}).hidden)switch(g[D]=Dr(D),t=k?e[C][D]:e[g[D]+m],r){case 1:o[D]=D-f.s.c;break;case 2:o[D]=g[D];break;case 3:o[D]=h.header[D-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ja(t,null,h),b=E[l]||0,!b)E[l]=1;else{do c=l+"_"+b++;while(E[c]);E[l]=b,E[c]=1}o[D]=c}for(C=f.s.r+a;C<=f.e.r;++C)if(!(ee[C]||{}).hidden){var G=D4(e,f,C,g,r,o,k,h);(G.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(v[w++]=G.row)}return v.length=w,v}var Wg=/"/g;function F4(e,n,t,r,a,o,l,c){for(var f=!0,h=[],p="",m=$r(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var v=c.dense?(e[t]||[])[g]:e[r[g]+m];if(v==null)p="";else if(v.v!=null){f=!1,p=""+(c.rawNumbers&&v.t=="n"?v.v:Ja(v,null,c));for(var w=0,b=0;w!==p.length;++w)if((b=p.charCodeAt(w))===a||b===o||b===34||c.forceQuotes){p='"'+p.replace(Wg,'""')+'"';break}p=="ID"&&(p='"ID"')}else v.f!=null&&!v.F?(f=!1,p="="+v.f,p.indexOf(",")>=0&&(p='"'+p.replace(Wg,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&f?null:h.join(l)}function _1(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=hr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),p="",m=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],v=r.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(g[w]||{}).hidden||(m[w]=Dr(w));for(var b=0,k=a.s.r;k<=a.e.r;++k)(v[k]||{}).hidden||(p=F4(e,a,k,m,l,f,o,r),p!=null&&(r.strip&&(p=p.replace(h,"")),(p||r.blankrows!==!1)&&t.push((b++?c:"")+p)));return delete r.dense,t.join("")}function j4(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=_1(e,n);return t}function P4(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=hr(e["!ref"]),o="",l=[],c,f=[],h=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Dr(c);for(var p=a.s.r;p<=a.e.r;++p)for(o=$r(p),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=h?(e[p]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function S1(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}var h,p={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var m=hr(o["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),l==-1&&(l=m.e.r+1,p.e.r=l+n.length-1+a)}else l==-1&&(l=0,p.e.r=n.length-1+a);var g=r.header||[],v=0;n.forEach(function(b,k){Ca(b).forEach(function(C){(v=g.indexOf(C))==-1&&(g[v=g.length]=C);var D=b[C],E="z",Y="",ee=_t({c:c+v,r:l+k+a});h=Tl(o,ee),D&&typeof D=="object"&&!(D instanceof Date)?o[ee]=D:(typeof D=="number"?E="n":typeof D=="boolean"?E="b":typeof D=="string"?E="s":D instanceof Date?(E="d",r.cellDates||(E="n",D=fn(D)),Y=r.dateNF||St[14]):D===null&&r.nullError&&(E="e",D=0),h?(h.t=E,h.v=D,delete h.w,delete h.R,Y&&(h.z=Y)):o[ee]=h={t:E,v:D},Y&&(h.z=Y))})}),p.e.c=Math.max(p.e.c,c+g.length-1);var w=$r(l);if(a)for(v=0;v<g.length;++v)o[Dr(v+c)+w]={t:"s",v:g[v]};return o["!ref"]=At(p),o}function A4(e,n){return S1(null,e,n)}function Tl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=ln(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Tl(e,_t(n)):Tl(e,_t({r:n,c:t||0}))}function O4(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Tp(){return{SheetNames:[],Sheets:{}}}function Dp(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(vD(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function R4(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=O4(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function z4(e,n){return e.z=n,e}function E1(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function M4(e,n,t){return E1(e,"#"+n,t)}function I4(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function L4(e,n,t,r){for(var a=typeof n!="string"?n:hr(n),o=typeof n=="string"?n:At(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Tl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var B4={encode_col:Dr,encode_row:$r,encode_cell:_t,encode_range:At,decode_col:hp,decode_row:pp,split_cell:q2,decode_cell:ln,decode_range:gi,format_cell:Ja,sheet_add_aoa:Dy,sheet_add_json:S1,sheet_add_dom:y1,aoa_to_sheet:vi,json_to_sheet:A4,table_to_sheet:w1,table_to_book:r4,sheet_to_csv:_1,sheet_to_txt:j4,sheet_to_json:zf,sheet_to_html:t4,sheet_to_formulae:P4,sheet_to_row_object_array:zf,sheet_get_cell:Tl,book_new:Tp,book_append_sheet:Dp,book_set_sheet_visibility:R4,cell_set_number_format:z4,cell_set_hyperlink:E1,cell_set_internal_link:M4,cell_add_comment:I4,sheet_set_array_formula:L4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const W4=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=S.useState(null),o=S.useRef(null),l=h=>{const p=h.target.files?.[0];p&&a(p)},c=()=>{if(r){const h=new FileReader;h.onload=p=>{try{const m=new Uint8Array(p.target?.result),g=Rf(m,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const v=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",v);const w=B4.sheet_to_json(v,{header:1});console.log("Parsed JSON data:",w);const b={headers:w[0],rows:w.slice(1)};console.log("Prepared file data:",b),t(r.name,b),f()}catch(m){console.error("Error reading Excel file:",m)}},h.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return u.jsx(sr,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Zaaduj plik Excel"}),u.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-2 overflow-hidden",children:u.jsx("div",{children:u.jsxs("div",{className:"relative mt-8",children:[u.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&u.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[u.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),u.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Zaaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Zaaduj"})]})]})})},U4=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>u.jsx(sr,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:u.jsxs("div",{className:"h-full flex items-center justify-between",children:[u.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastpi "',r,'"?']}),u.jsxs("div",{className:"flex space-x-2 shrink-0",children:[u.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),u.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastp"})]})]})});function N1(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=N1(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Wr(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=N1(e))&&(r&&(r+=" "),r+=n);return r}const C1=6048e5,$4=864e5,ed=6e4,td=36e5,H4=1e3,Ug=Symbol.for("constructDateFrom");function Qt(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Ug in e?e[Ug](n):e instanceof Date?new e.constructor(n):new Date(n)}function ct(e,n){return Qt(n||e,e)}function la(e,n,t){const r=ct(e,t?.in);return isNaN(n)?Qt(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function ca(e,n,t){const r=ct(e,t?.in);if(isNaN(n))return Qt(e,NaN);if(!n)return r;const a=r.getDate(),o=Qt(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function T1(e,n,t){return Qt(e,+ct(e)+n)}function Y4(e,n,t){return T1(e,n*td)}let V4={};function So(){return V4}function ua(e,n){const t=So(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=ct(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function ui(e,n){return ua(e,{...n,weekStartsOn:1})}function D1(e,n){const t=ct(e,n?.in),r=t.getFullYear(),a=Qt(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=ui(a),l=Qt(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=ui(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Ru(e){const n=ct(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function ja(e,...n){const t=Qt.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function ho(e,n){const t=ct(e,n?.in);return t.setHours(0,0,0,0),t}function di(e,n,t){const[r,a]=ja(t?.in,e,n),o=ho(r),l=ho(a),c=+o-Ru(o),f=+l-Ru(l);return Math.round((c-f)/$4)}function K4(e,n){const t=D1(e,n),r=Qt(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),ui(r)}function Mf(e,n,t){const r=ct(e,t?.in);return r.setTime(r.getTime()+n*ed),r}function Fp(e,n,t){return ca(e,n*3,t)}function G4(e,n,t){return T1(e,n*1e3)}function zu(e,n,t){return la(e,n*7,t)}function Ga(e,n,t){return ca(e,n*12,t)}function $g(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Qt.bind(null,a));const o=ct(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Qt(r,t||NaN)}function Hg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Qt.bind(null,a));const o=ct(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Qt(r,t||NaN)}function Q4(e,n,t){const[r,a]=ja(t?.in,e,n);return+ho(r)==+ho(a)}function Qa(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Mu(e){return!(!Qa(e)&&typeof e!="number"||isNaN(+ct(e)))}function Iu(e,n,t){const[r,a]=ja(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function oo(e,n){const t=ct(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function Lu(e,n,t){const[r,a]=ja(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=oo(r)-oo(a);return o*4+l}function Bu(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function X4(e,n,t){const[r,a]=ja(t?.in,e,n),o=Yg(r,a),l=Math.abs(di(r,a));r.setDate(r.getDate()-o*l);const c=+(Yg(r,a)===-o),f=o*(l-c);return f===0?0:f}function Yg(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function F1(e,n){const t=ct(e,n?.in);return t.setHours(23,59,59,999),t}function j1(e,n){const t=ct(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function If(e,n){const t=ct(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function P1(e,n){const t=ct(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function A1(e,n){const t=ct(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function rd(e,n){const t=ct(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function q4(e,n){const t=So(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=ct(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const Z4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},J4=(e,n,t)=>{let r;const a=Z4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function si(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const e3={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t3={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},r3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},n3={date:si({formats:e3,defaultWidth:"full"}),time:si({formats:t3,defaultWidth:"full"}),dateTime:si({formats:r3,defaultWidth:"full"})},a3={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},s3=(e,n,t,r)=>a3[e];function ka(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const o3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},i3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},l3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},c3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},u3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},d3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},f3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},p3={ordinalNumber:f3,era:ka({values:o3,defaultWidth:"wide"}),quarter:ka({values:i3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ka({values:l3,defaultWidth:"wide"}),day:ka({values:c3,defaultWidth:"wide"}),dayPeriod:ka({values:u3,defaultWidth:"wide",formattingValues:d3,defaultFormattingWidth:"wide"})};function ba(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?x3(c,m=>m.test(l)):h3(c,m=>m.test(l));let h;h=e.valueCallback?e.valueCallback(f):f,h=t.valueCallback?t.valueCallback(h):h;const p=n.slice(l.length);return{value:h,rest:p}}}function h3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function x3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function O1(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const m3=/^(\d+)(th|st|nd|rd)?/i,g3=/\d+/i,v3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},y3={any:[/^b/i,/^(a|c)/i]},w3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},k3={any:[/1/i,/2/i,/3/i,/4/i]},b3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},S3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},E3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},N3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},C3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},T3={ordinalNumber:O1({matchPattern:m3,parsePattern:g3,valueCallback:e=>parseInt(e,10)}),era:ba({matchPatterns:v3,defaultMatchWidth:"wide",parsePatterns:y3,defaultParseWidth:"any"}),quarter:ba({matchPatterns:w3,defaultMatchWidth:"wide",parsePatterns:k3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ba({matchPatterns:b3,defaultMatchWidth:"wide",parsePatterns:_3,defaultParseWidth:"any"}),day:ba({matchPatterns:S3,defaultMatchWidth:"wide",parsePatterns:E3,defaultParseWidth:"any"}),dayPeriod:ba({matchPatterns:N3,defaultMatchWidth:"any",parsePatterns:C3,defaultParseWidth:"any"})},R1={code:"en-US",formatDistance:J4,formatLong:n3,formatRelative:s3,localize:p3,match:T3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function D3(e,n){const t=ct(e,n?.in);return di(t,rd(t))+1}function jp(e,n){const t=ct(e,n?.in),r=+ui(t)-+K4(t);return Math.round(r/C1)+1}function Pp(e,n){const t=ct(e,n?.in),r=t.getFullYear(),a=So(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Qt(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=ua(l,n),f=Qt(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const h=ua(f,n);return+t>=+c?r+1:+t>=+h?r:r-1}function F3(e,n){const t=So(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Pp(e,n),o=Qt(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),ua(o,n)}function z1(e,n){const t=ct(e,n?.in),r=+ua(t,n)-+F3(t,n);return Math.round(r/C1)+1}function Gt(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const Ss={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Gt(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Gt(t+1,2)},d(e,n){return Gt(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Gt(e.getHours()%12||12,n.length)},H(e,n){return Gt(e.getHours(),n.length)},m(e,n){return Gt(e.getMinutes(),n.length)},s(e,n){return Gt(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Gt(a,n.length)}},Xo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Vg={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return Ss.y(e,n)},Y:function(e,n,t,r){const a=Pp(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Gt(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Gt(o,n.length)},R:function(e,n){const t=D1(e);return Gt(t,n.length)},u:function(e,n){const t=e.getFullYear();return Gt(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Gt(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Gt(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return Ss.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Gt(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=z1(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Gt(a,n.length)},I:function(e,n,t){const r=jp(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Gt(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Ss.d(e,n)},D:function(e,n,t){const r=D3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Gt(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Gt(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Gt(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Gt(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Xo.noon:r===0?a=Xo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Xo.evening:r>=12?a=Xo.afternoon:r>=4?a=Xo.morning:a=Xo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Ss.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Ss.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Gt(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Gt(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ss.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Ss.s(e,n)},S:function(e,n){return Ss.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Gg(r);case"XXXX":case"XX":return Js(r);case"XXXXX":case"XXX":default:return Js(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Gg(r);case"xxxx":case"xx":return Js(r);case"xxxxx":case"xxx":default:return Js(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Kg(r,":");case"OOOO":default:return"GMT"+Js(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Kg(r,":");case"zzzz":default:return"GMT"+Js(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Gt(r,n.length)},T:function(e,n,t){return Gt(+e,n.length)}};function Kg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Gt(o,2)}function Gg(e,n){return e%60===0?(e>0?"-":"+")+Gt(Math.abs(e)/60,2):Js(e,n)}function Js(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Gt(Math.trunc(r/60),2),o=Gt(r%60,2);return t+a+n+o}const Qg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},M1=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},j3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Qg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Qg(r,n)).replace("{{time}}",M1(a,n))},Lf={p:M1,P:j3},P3=/^D+$/,A3=/^Y+$/,O3=["D","DD","YY","YYYY"];function R3(e){return P3.test(e)}function z3(e){return A3.test(e)}function M3(e,n,t){const r=I3(e,n,t);if(console.warn(r),O3.includes(e))throw new RangeError(r)}function I3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const L3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,B3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,W3=/^'([^]*?)'?$/,U3=/''/g,$3=/[a-zA-Z]/;function Xg(e,n,t){const r=So(),a=t?.locale??r.locale??R1,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=ct(e,t?.in);if(!Mu(c))throw new RangeError("Invalid time value");let f=n.match(B3).map(p=>{const m=p[0];if(m==="p"||m==="P"){const g=Lf[m];return g(p,a.formatLong)}return p}).join("").match(L3).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const m=p[0];if(m==="'")return{isToken:!1,value:H3(p)};if(Vg[m])return{isToken:!0,value:p};if(m.match($3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const h={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(p=>{if(!p.isToken)return p.value;const m=p.value;(!t?.useAdditionalWeekYearTokens&&z3(m)||!t?.useAdditionalDayOfYearTokens&&R3(m))&&M3(m,n,String(e));const g=Vg[m[0]];return g(c,m,a.localize,h)}).join("")}function H3(e){const n=e.match(W3);return n?n[1].replace(U3,"'"):e}function qg(e,n){return ct(e,n?.in).getDate()}function Y3(e,n){return ct(e,n?.in).getDay()}function V3(e,n){const t=ct(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Qt(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function K3(){return Object.assign({},So())}function Xa(e,n){return ct(e,n?.in).getHours()}function G3(e,n){const t=ct(e,n?.in).getDay();return t===0?7:t}function qa(e,n){return ct(e,n?.in).getMinutes()}function cn(e,n){return ct(e,n?.in).getMonth()}function js(e){return ct(e).getSeconds()}function Bf(e){return+ct(e)}function Ct(e,n){return ct(e,n?.in).getFullYear()}function Rs(e,n){return+ct(e)>+ct(n)}function xo(e,n){return+ct(e)<+ct(n)}function Q3(e,n){return+ct(e)==+ct(n)}function X3(e,n){const t=q3(n)?new n(0):Qt(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function q3(e){return typeof e=="function"&&e.prototype?.constructor===e}const Z3=10;class I1{subPriority=0;validate(n,t){return!0}}class J3 extends I1{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class eF extends I1{priority=Z3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Qt(t,r))}set(n,t){return t.timestampIsSet?n:Qt(n,X3(n,this.context))}}class Ut{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new J3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class tF extends Ut{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const wr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},_a={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function kr(e,n){return e&&{value:n(e.value),rest:e.rest}}function dr(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function Sa(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*td+o*ed+l*H4),rest:n.slice(t[0].length)}}function L1(e){return dr(wr.anyDigitsSigned,e)}function xr(e,n){switch(e){case 1:return dr(wr.singleDigit,n);case 2:return dr(wr.twoDigits,n);case 3:return dr(wr.threeDigits,n);case 4:return dr(wr.fourDigits,n);default:return dr(new RegExp("^\\d{1,"+e+"}"),n)}}function Wu(e,n){switch(e){case 1:return dr(wr.singleDigitSigned,n);case 2:return dr(wr.twoDigitsSigned,n);case 3:return dr(wr.threeDigitsSigned,n);case 4:return dr(wr.fourDigitsSigned,n);default:return dr(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Ap(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function B1(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function W1(e){return e%400===0||e%4===0&&e%100!==0}class rF extends Ut{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return kr(xr(4,n),a);case"yo":return kr(r.ordinalNumber(n,{unit:"year"}),a);default:return kr(xr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=B1(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class nF extends Ut{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return kr(xr(4,n),a);case"Yo":return kr(r.ordinalNumber(n,{unit:"year"}),a);default:return kr(xr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=Pp(n,a);if(r.isTwoDigitYear){const c=B1(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),ua(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),ua(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class aF extends Ut{priority=130;parse(n,t){return Wu(t==="R"?4:t.length,n)}set(n,t,r){const a=Qt(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),ui(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class sF extends Ut{priority=130;parse(n,t){return Wu(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class oF extends Ut{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return xr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class iF extends Ut{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return xr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class lF extends Ut{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return kr(dr(wr.month,n),a);case"MM":return kr(xr(2,n),a);case"Mo":return kr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class cF extends Ut{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return kr(dr(wr.month,n),a);case"LL":return kr(xr(2,n),a);case"Lo":return kr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function uF(e,n,t){const r=ct(e,t?.in),a=z1(r,t)-n;return r.setDate(r.getDate()-a*7),ct(r,t?.in)}class dF extends Ut{priority=100;parse(n,t,r){switch(t){case"w":return dr(wr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return ua(uF(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function fF(e,n,t){const r=ct(e,t?.in),a=jp(r,t)-n;return r.setDate(r.getDate()-a*7),r}class pF extends Ut{priority=100;parse(n,t,r){switch(t){case"I":return dr(wr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return ui(fF(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const hF=[31,28,31,30,31,30,31,31,30,31,30,31],xF=[31,29,31,30,31,30,31,31,30,31,30,31];class mF extends Ut{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return dr(wr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return xr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=W1(r),o=n.getMonth();return a?t>=1&&t<=xF[o]:t>=1&&t<=hF[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class gF extends Ut{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return dr(wr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return xr(t.length,n)}}validate(n,t){const r=n.getFullYear();return W1(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Op(e,n,t){const r=So(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=ct(e,t?.in),l=o.getDay(),f=(n%7+7)%7,h=7-a,p=n<0||n>6?n-(l+h)%7:(f+h)%7-(l+h)%7;return la(o,p,t)}class vF extends Ut{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class yF extends Ut{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return kr(xr(t.length,n),o);case"eo":return kr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class wF extends Ut{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return kr(xr(t.length,n),o);case"co":return kr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function kF(e,n,t){const r=ct(e,t?.in),a=G3(r,t),o=n-a;return la(r,o,t)}class bF extends Ut{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return xr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return kr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return kr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return kr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return kr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=kF(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class _F extends Ut{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class SF extends Ut{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class EF extends Ut{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class NF extends Ut{priority=70;parse(n,t,r){switch(t){case"h":return dr(wr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class CF extends Ut{priority=70;parse(n,t,r){switch(t){case"H":return dr(wr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class TF extends Ut{priority=70;parse(n,t,r){switch(t){case"K":return dr(wr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class DF extends Ut{priority=70;parse(n,t,r){switch(t){case"k":return dr(wr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class FF extends Ut{priority=60;parse(n,t,r){switch(t){case"m":return dr(wr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class jF extends Ut{priority=50;parse(n,t,r){switch(t){case"s":return dr(wr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class PF extends Ut{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return kr(xr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class AF extends Ut{priority=10;parse(n,t){switch(t){case"X":return Sa(_a.basicOptionalMinutes,n);case"XX":return Sa(_a.basic,n);case"XXXX":return Sa(_a.basicOptionalSeconds,n);case"XXXXX":return Sa(_a.extendedOptionalSeconds,n);case"XXX":default:return Sa(_a.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Qt(n,n.getTime()-Ru(n)-r)}incompatibleTokens=["t","T","x"]}class OF extends Ut{priority=10;parse(n,t){switch(t){case"x":return Sa(_a.basicOptionalMinutes,n);case"xx":return Sa(_a.basic,n);case"xxxx":return Sa(_a.basicOptionalSeconds,n);case"xxxxx":return Sa(_a.extendedOptionalSeconds,n);case"xxx":default:return Sa(_a.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Qt(n,n.getTime()-Ru(n)-r)}incompatibleTokens=["t","T","X"]}class RF extends Ut{priority=40;parse(n){return L1(n)}set(n,t,r){return[Qt(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class zF extends Ut{priority=20;parse(n){return L1(n)}set(n,t,r){return[Qt(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const MF={G:new tF,y:new rF,Y:new nF,R:new aF,u:new sF,Q:new oF,q:new iF,M:new lF,L:new cF,w:new dF,I:new pF,d:new mF,D:new gF,E:new vF,e:new yF,c:new wF,i:new bF,a:new _F,b:new SF,B:new EF,h:new NF,H:new CF,K:new TF,k:new DF,m:new FF,s:new jF,S:new PF,X:new AF,x:new OF,t:new RF,T:new zF},IF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,LF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,BF=/^'([^]*?)'?$/,WF=/''/g,UF=/\S/,$F=/[a-zA-Z]/;function HF(e,n,t,r){const a=()=>Qt(r?.in||t,NaN),o=K3(),l=r?.locale??o.locale??R1,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():ct(t,r?.in);const h={firstWeekContainsDate:c,weekStartsOn:f,locale:l},p=[new eF(r?.in,t)],m=n.match(LF).map(k=>{const C=k[0];if(C in Lf){const D=Lf[C];return D(k,l.formatLong)}return k}).join("").match(IF),g=[];for(let k of m){const C=k[0],D=MF[C];if(D){const{incompatibleTokens:E}=D;if(Array.isArray(E)){const ee=g.find(G=>E.includes(G.token)||G.token===C);if(ee)throw new RangeError(`The format string mustn't contain \`${ee.fullToken}\` and \`${k}\` at the same time`)}else if(D.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${k}\` and any other token at the same time`);g.push({token:C,fullToken:k});const Y=D.run(e,k,l.match,h);if(!Y)return a();p.push(Y.setter),e=Y.rest}else{if(C.match($F))throw new RangeError("Format string contains an unescaped latin alphabet character `"+C+"`");if(k==="''"?k="'":C==="'"&&(k=YF(k)),e.indexOf(k)===0)e=e.slice(k.length);else return a()}}if(e.length>0&&UF.test(e))return a();const v=p.map(k=>k.priority).sort((k,C)=>C-k).filter((k,C,D)=>D.indexOf(k)===C).map(k=>p.filter(C=>C.priority===k).sort((C,D)=>D.subPriority-C.subPriority)).map(k=>k[0]);let w=ct(t,r?.in);if(isNaN(+w))return a();const b={};for(const k of v){if(!k.validate(w,h))return a();const C=k.set(w,b,h);Array.isArray(C)?(w=C[0],Object.assign(b,C[1])):w=C}return w}function YF(e){return e.match(BF)[1].replace(WF,"'")}function VF(e,n,t){const[r,a]=ja(t?.in,e,n);return+ua(r,t)==+ua(a,t)}function KF(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function GF(e,n,t){const[r,a]=ja(t?.in,e,n);return+If(r)==+If(a)}function QF(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Dl(e,n,t){const r=+ct(e,t?.in),[a,o]=[+ct(n.start,t?.in),+ct(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function XF(e,n,t){return la(e,-1,t)}function qF(e,n){const t=()=>Qt(n?.in,NaN),a=tj(e);let o;if(a.date){const h=rj(a.date,2);o=nj(h.restDateString,h.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=aj(a.time),isNaN(c)))return t();if(a.timezone){if(f=sj(a.timezone),isNaN(f))return t()}else{const h=new Date(l+c),p=ct(0,n?.in);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return ct(l+c+f,n?.in)}const lu={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ZF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,JF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ej=/^([+-])(\d{2})(?::?(\d{2}))?$/;function tj(e){const n={},t=e.split(lu.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],lu.timeZoneDelimiter.test(n.date)&&(n.date=e.split(lu.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=lu.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function rj(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function nj(e,n){if(n===null)return new Date(NaN);const t=e.match(ZF);if(!t)return new Date(NaN);const r=!!t[4],a=rl(t[1]),o=rl(t[2])-1,l=rl(t[3]),c=rl(t[4]),f=rl(t[5])-1;if(r)return uj(n,c,f)?oj(n,c,f):new Date(NaN);{const h=new Date(0);return!lj(n,o,l)||!cj(n,a)?new Date(NaN):(h.setUTCFullYear(n,o,Math.max(a,l)),h)}}function rl(e){return e?parseInt(e):1}function aj(e){const n=e.match(JF);if(!n)return NaN;const t=cf(n[1]),r=cf(n[2]),a=cf(n[3]);return dj(t,r,a)?t*td+r*ed+a*1e3:NaN}function cf(e){return e&&parseFloat(e.replace(",","."))||0}function sj(e){if(e==="Z")return 0;const n=e.match(ej);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return fj(r,a)?t*(r*td+a*ed):NaN}function oj(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const ij=[31,null,31,30,31,30,31,31,30,31,30,31];function U1(e){return e%400===0||e%4===0&&e%100!==0}function lj(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(ij[n]||(U1(e)?29:28))}function cj(e,n){return n>=1&&n<=(U1(e)?366:365)}function uj(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function dj(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function fj(e,n){return n>=0&&n<=59}function Un(e,n,t){const r=ct(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Qt(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=V3(l);return r.setMonth(n,Math.min(o,c)),r}function gu(e,n,t){const r=ct(e,t?.in);return r.setHours(n),r}function vu(e,n,t){const r=ct(e,t?.in);return r.setMinutes(n),r}function Jo(e,n,t){const r=ct(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Un(r,r.getMonth()+o*3)}function yu(e,n,t){const r=ct(e,t?.in);return r.setSeconds(n),r}function ya(e,n,t){const r=ct(e,t?.in);return isNaN(+r)?Qt(e,NaN):(r.setFullYear(n),r)}function io(e,n,t){return ca(e,-n,t)}function $1(e,n,t){return Fp(e,-1,t)}function Zg(e,n,t){return zu(e,-1,t)}function fi(e,n,t){return Ga(e,-n,t)}function nd(){return typeof window<"u"}function yi(e){return H1(e)?(e.nodeName||"").toLowerCase():"#document"}function Cn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Pa(e){var n;return(n=(H1(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function H1(e){return nd()?e instanceof Node||e instanceof Cn(e).Node:!1}function un(e){return nd()?e instanceof Element||e instanceof Cn(e).Element:!1}function Ta(e){return nd()?e instanceof HTMLElement||e instanceof Cn(e).HTMLElement:!1}function Jg(e){return!nd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Cn(e).ShadowRoot}function Ll(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Kn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function pj(e){return["table","td","th"].includes(yi(e))}function ad(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Rp(e){const n=zp(),t=un(e)?Kn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function hj(e){let n=zs(e);for(;Ta(n)&&!pi(n);){if(Rp(n))return n;if(ad(n))return null;n=zs(n)}return null}function zp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function pi(e){return["html","body","#document"].includes(yi(e))}function Kn(e){return Cn(e).getComputedStyle(e)}function sd(e){return un(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function zs(e){if(yi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Jg(e)&&e.host||Pa(e);return Jg(n)?n.host:n}function Y1(e){const n=zs(e);return pi(n)?e.ownerDocument?e.ownerDocument.body:e.body:Ta(n)&&Ll(n)?n:Y1(n)}function Fl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=Y1(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Cn(a);if(o){const c=Wf(l);return n.concat(l,l.visualViewport||[],Ll(a)?a:[],c&&t?Fl(c):[])}return n.concat(a,Fl(a,[],t))}function Wf(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const hi=Math.min,lo=Math.max,Uu=Math.round,cu=Math.floor,Na=e=>({x:e,y:e}),xj={left:"right",right:"left",bottom:"top",top:"bottom"},mj={start:"end",end:"start"};function Uf(e,n,t){return lo(e,hi(n,t))}function Bl(e,n){return typeof e=="function"?e(n):e}function mo(e){return e.split("-")[0]}function Wl(e){return e.split("-")[1]}function V1(e){return e==="x"?"y":"x"}function Mp(e){return e==="y"?"height":"width"}function co(e){return["top","bottom"].includes(mo(e))?"y":"x"}function Ip(e){return V1(co(e))}function gj(e,n,t){t===void 0&&(t=!1);const r=Wl(e),a=Ip(e),o=Mp(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=$u(l)),[l,$u(l)]}function vj(e){const n=$u(e);return[$f(e),n,$f(n)]}function $f(e){return e.replace(/start|end/g,n=>mj[n])}function yj(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function wj(e,n,t,r){const a=Wl(e);let o=yj(mo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map($f)))),o}function $u(e){return e.replace(/left|right|bottom|top/g,n=>xj[n])}function kj(e){return{top:0,right:0,bottom:0,left:0,...e}}function K1(e){return typeof e!="number"?kj(e):{top:e,right:e,bottom:e,left:e}}function Hu(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var Yu=typeof document<"u"?S.useLayoutEffect:S.useEffect;const bj={...Iv},_j=bj.useInsertionEffect,Sj=_j||(e=>e());function Ej(e){const n=S.useRef(()=>{});return Sj(()=>{n.current=e}),S.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var G1=qf();const Nj=Qu(G1);function ev(e,n,t){let{reference:r,floating:a}=e;const o=co(n),l=Ip(n),c=Mp(l),f=mo(n),h=o==="y",p=r.x+r.width/2-a.width/2,m=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let v;switch(f){case"top":v={x:p,y:r.y-a.height};break;case"bottom":v={x:p,y:r.y+r.height};break;case"right":v={x:r.x+r.width,y:m};break;case"left":v={x:r.x-a.width,y:m};break;default:v={x:r.x,y:r.y}}switch(Wl(n)){case"start":v[l]-=g*(t&&h?-1:1);break;case"end":v[l]+=g*(t&&h?-1:1);break}return v}const Cj=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let h=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:p,y:m}=ev(h,r,f),g=r,v={},w=0;for(let b=0;b<c.length;b++){const{name:k,fn:C}=c[b],{x:D,y:E,data:Y,reset:ee}=await C({x:p,y:m,initialPlacement:r,placement:g,strategy:a,middlewareData:v,rects:h,platform:l,elements:{reference:e,floating:n}});p=D??p,m=E??m,v={...v,[k]:{...v[k],...Y}},ee&&w<=50&&(w++,typeof ee=="object"&&(ee.placement&&(g=ee.placement),ee.rects&&(h=ee.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):ee.rects),{x:p,y:m}=ev(h,g,f)),b=-1)}return{x:p,y:m,placement:g,strategy:a,middlewareData:v}};async function Q1(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:m="floating",altBoundary:g=!1,padding:v=0}=Bl(n,e),w=K1(v),k=c[g?m==="floating"?"reference":"floating":m],C=Hu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(k)))==null||t?k:k.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:h,rootBoundary:p,strategy:f})),D=m==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),Y=await(o.isElement==null?void 0:o.isElement(E))?await(o.getScale==null?void 0:o.getScale(E))||{x:1,y:1}:{x:1,y:1},ee=Hu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:D,offsetParent:E,strategy:f}):D);return{top:(C.top-ee.top+w.top)/Y.y,bottom:(ee.bottom-C.bottom+w.bottom)/Y.y,left:(C.left-ee.left+w.left)/Y.x,right:(ee.right-C.right+w.right)/Y.x}}const Tj=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:h,padding:p=0}=Bl(e,n)||{};if(h==null)return{};const m=K1(p),g={x:t,y:r},v=Ip(a),w=Mp(v),b=await l.getDimensions(h),k=v==="y",C=k?"top":"left",D=k?"bottom":"right",E=k?"clientHeight":"clientWidth",Y=o.reference[w]+o.reference[v]-g[v]-o.floating[w],ee=g[v]-o.reference[v],G=await(l.getOffsetParent==null?void 0:l.getOffsetParent(h));let F=G?G[E]:0;(!F||!await(l.isElement==null?void 0:l.isElement(G)))&&(F=c.floating[E]||o.floating[w]);const H=Y/2-ee/2,U=F/2-b[w]/2-1,ae=hi(m[C],U),J=hi(m[D],U),V=ae,de=F-b[w]-J,ue=F/2-b[w]/2+H,le=Uf(V,ue,de),pe=!f.arrow&&Wl(a)!=null&&ue!==le&&o.reference[w]/2-(ue<V?ae:J)-b[w]/2<0,q=pe?ue<V?ue-V:ue-de:0;return{[v]:g[v]+q,data:{[v]:le,centerOffset:ue-le-q,...pe&&{alignmentOffset:q}},reset:pe}}}),Dj=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:h}=n,{mainAxis:p=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:b=!0,...k}=Bl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const C=mo(a),D=co(c),E=mo(c)===c,Y=await(f.isRTL==null?void 0:f.isRTL(h.floating)),ee=g||(E||!b?[$u(c)]:vj(c)),G=w!=="none";!g&&G&&ee.push(...wj(c,b,w,Y));const F=[c,...ee],H=await Q1(n,k),U=[];let ae=((r=o.flip)==null?void 0:r.overflows)||[];if(p&&U.push(H[C]),m){const le=gj(a,l,Y);U.push(H[le[0]],H[le[1]])}if(ae=[...ae,{placement:a,overflows:U}],!U.every(le=>le<=0)){var J,V;const le=(((J=o.flip)==null?void 0:J.index)||0)+1,pe=F[le];if(pe){var de;const oe=m==="alignment"?D!==co(pe):!1,B=((de=ae[0])==null?void 0:de.overflows[0])>0;if(!oe||B)return{data:{index:le,overflows:ae},reset:{placement:pe}}}let q=(V=ae.filter(oe=>oe.overflows[0]<=0).sort((oe,B)=>oe.overflows[1]-B.overflows[1])[0])==null?void 0:V.placement;if(!q)switch(v){case"bestFit":{var ue;const oe=(ue=ae.filter(B=>{if(G){const re=co(B.placement);return re===D||re==="y"}return!0}).map(B=>[B.placement,B.overflows.filter(re=>re>0).reduce((re,I)=>re+I,0)]).sort((B,re)=>B[1]-re[1])[0])==null?void 0:ue[0];oe&&(q=oe);break}case"initialPlacement":q=c;break}if(a!==q)return{reset:{placement:q}}}return{}}}};async function Fj(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=mo(t),c=Wl(t),f=co(t)==="y",h=["left","top"].includes(l)?-1:1,p=o&&f?-1:1,m=Bl(n,e);let{mainAxis:g,crossAxis:v,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof w=="number"&&(v=c==="end"?w*-1:w),f?{x:v*p,y:g*h}:{x:g*h,y:v*p}}const jj=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await Fj(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},Pj=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:k=>{let{x:C,y:D}=k;return{x:C,y:D}}},...f}=Bl(e,n),h={x:t,y:r},p=await Q1(n,f),m=co(mo(a)),g=V1(m);let v=h[g],w=h[m];if(o){const k=g==="y"?"top":"left",C=g==="y"?"bottom":"right",D=v+p[k],E=v-p[C];v=Uf(D,v,E)}if(l){const k=m==="y"?"top":"left",C=m==="y"?"bottom":"right",D=w+p[k],E=w-p[C];w=Uf(D,w,E)}const b=c.fn({...n,[g]:v,[m]:w});return{...b,data:{x:b.x-t,y:b.y-r,enabled:{[g]:o,[m]:l}}}}}};function X1(e){const n=Kn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Ta(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=Uu(t)!==o||Uu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function Lp(e){return un(e)?e:e.contextElement}function oi(e){const n=Lp(e);if(!Ta(n))return Na(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=X1(n);let l=(o?Uu(t.width):t.width)/r,c=(o?Uu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const Aj=Na(0);function q1(e){const n=Cn(e);return!zp()||!n.visualViewport?Aj:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Oj(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Cn(e)?!1:n}function go(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=Lp(e);let l=Na(1);n&&(r?un(r)&&(l=oi(r)):l=oi(e));const c=Oj(o,t,r)?q1(o):Na(0);let f=(a.left+c.x)/l.x,h=(a.top+c.y)/l.y,p=a.width/l.x,m=a.height/l.y;if(o){const g=Cn(o),v=r&&un(r)?Cn(r):r;let w=g,b=Wf(w);for(;b&&r&&v!==w;){const k=oi(b),C=b.getBoundingClientRect(),D=Kn(b),E=C.left+(b.clientLeft+parseFloat(D.paddingLeft))*k.x,Y=C.top+(b.clientTop+parseFloat(D.paddingTop))*k.y;f*=k.x,h*=k.y,p*=k.x,m*=k.y,f+=E,h+=Y,w=Cn(b),b=Wf(w)}}return Hu({width:p,height:m,x:f,y:h})}function Bp(e,n){const t=sd(e).scrollLeft;return n?n.left+t:go(Pa(e)).left+t}function Z1(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:Bp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function Rj(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Pa(r),c=n?ad(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},h=Na(1);const p=Na(0),m=Ta(r);if((m||!m&&!o)&&((yi(r)!=="body"||Ll(l))&&(f=sd(r)),Ta(r))){const v=go(r);h=oi(r),p.x=v.x+r.clientLeft,p.y=v.y+r.clientTop}const g=l&&!m&&!o?Z1(l,f,!0):Na(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-f.scrollLeft*h.x+p.x+g.x,y:t.y*h.y-f.scrollTop*h.y+p.y+g.y}}function zj(e){return Array.from(e.getClientRects())}function Mj(e){const n=Pa(e),t=sd(e),r=e.ownerDocument.body,a=lo(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=lo(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+Bp(e);const c=-t.scrollTop;return Kn(r).direction==="rtl"&&(l+=lo(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function Ij(e,n){const t=Cn(e),r=Pa(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const h=zp();(!h||h&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function Lj(e,n){const t=go(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Ta(e)?oi(e):Na(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,h=r*o.y;return{width:l,height:c,x:f,y:h}}function tv(e,n,t){let r;if(n==="viewport")r=Ij(e,t);else if(n==="document")r=Mj(Pa(e));else if(un(n))r=Lj(n,t);else{const a=q1(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Hu(r)}function J1(e,n){const t=zs(e);return t===n||!un(t)||pi(t)?!1:Kn(t).position==="fixed"||J1(t,n)}function Bj(e,n){const t=n.get(e);if(t)return t;let r=Fl(e,[],!1).filter(c=>un(c)&&yi(c)!=="body"),a=null;const o=Kn(e).position==="fixed";let l=o?zs(e):e;for(;un(l)&&!pi(l);){const c=Kn(l),f=Rp(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Ll(l)&&!f&&J1(e,l))?r=r.filter(p=>p!==l):a=c,l=zs(l)}return n.set(e,r),r}function Wj(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?ad(n)?[]:Bj(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((h,p)=>{const m=tv(n,p,a);return h.top=lo(m.top,h.top),h.right=hi(m.right,h.right),h.bottom=hi(m.bottom,h.bottom),h.left=lo(m.left,h.left),h},tv(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function Uj(e){const{width:n,height:t}=X1(e);return{width:n,height:t}}function $j(e,n,t){const r=Ta(n),a=Pa(n),o=t==="fixed",l=go(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=Na(0);function h(){f.x=Bp(a)}if(r||!r&&!o)if((yi(n)!=="body"||Ll(a))&&(c=sd(n)),r){const v=go(n,!0,o,n);f.x=v.x+n.clientLeft,f.y=v.y+n.clientTop}else a&&h();o&&!r&&a&&h();const p=a&&!r&&!o?Z1(a,c):Na(0),m=l.left+c.scrollLeft-f.x-p.x,g=l.top+c.scrollTop-f.y-p.y;return{x:m,y:g,width:l.width,height:l.height}}function uf(e){return Kn(e).position==="static"}function rv(e,n){if(!Ta(e)||Kn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Pa(e)===t&&(t=t.ownerDocument.body),t}function ew(e,n){const t=Cn(e);if(ad(e))return t;if(!Ta(e)){let a=zs(e);for(;a&&!pi(a);){if(un(a)&&!uf(a))return a;a=zs(a)}return t}let r=rv(e,n);for(;r&&pj(r)&&uf(r);)r=rv(r,n);return r&&pi(r)&&uf(r)&&!Rp(r)?t:r||hj(e)||t}const Hj=async function(e){const n=this.getOffsetParent||ew,t=this.getDimensions,r=await t(e.floating);return{reference:$j(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Yj(e){return Kn(e).direction==="rtl"}const Vj={convertOffsetParentRelativeRectToViewportRelativeRect:Rj,getDocumentElement:Pa,getClippingRect:Wj,getOffsetParent:ew,getElementRects:Hj,getClientRects:zj,getDimensions:Uj,getScale:oi,isElement:un,isRTL:Yj};function tw(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function Kj(e,n){let t=null,r;const a=Pa(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const h=e.getBoundingClientRect(),{left:p,top:m,width:g,height:v}=h;if(c||n(),!g||!v)return;const w=cu(m),b=cu(a.clientWidth-(p+g)),k=cu(a.clientHeight-(m+v)),C=cu(p),E={rootMargin:-w+"px "+-b+"px "+-k+"px "+-C+"px",threshold:lo(0,hi(1,f))||1};let Y=!0;function ee(G){const F=G[0].intersectionRatio;if(F!==f){if(!Y)return l();F?l(!1,F):r=setTimeout(()=>{l(!1,1e-7)},1e3)}F===1&&!tw(h,e.getBoundingClientRect())&&l(),Y=!1}try{t=new IntersectionObserver(ee,{...E,root:a.ownerDocument})}catch{t=new IntersectionObserver(ee,E)}t.observe(e)}return l(!0),o}function rw(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,h=Lp(e),p=a||o?[...h?Fl(h):[],...Fl(n)]:[];p.forEach(C=>{a&&C.addEventListener("scroll",t,{passive:!0}),o&&C.addEventListener("resize",t)});const m=h&&c?Kj(h,t):null;let g=-1,v=null;l&&(v=new ResizeObserver(C=>{let[D]=C;D&&D.target===h&&v&&(v.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var E;(E=v)==null||E.observe(n)})),t()}),h&&!f&&v.observe(h),v.observe(n));let w,b=f?go(e):null;f&&k();function k(){const C=go(e);b&&!tw(b,C)&&t(),b=C,w=requestAnimationFrame(k)}return t(),()=>{var C;p.forEach(D=>{a&&D.removeEventListener("scroll",t),o&&D.removeEventListener("resize",t)}),m?.(),(C=v)==null||C.disconnect(),v=null,f&&cancelAnimationFrame(w)}}const nw=jj,Gj=Pj,aw=Dj,Hf=Tj,Yf=(e,n,t)=>{const r=new Map,a={platform:Vj,...t},o={...a.platform,_c:r};return Cj(e,n,{...a,platform:o})};var wu=typeof document<"u"?S.useLayoutEffect:S.useEffect;function Vu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Vu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Vu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function sw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function nv(e,n){const t=sw(e);return Math.round(n*t)/t}function df(e){const n=S.useRef(e);return wu(()=>{n.current=e}),n}function Qj(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:h}=e,[p,m]=S.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,v]=S.useState(r);Vu(g,r)||v(r);const[w,b]=S.useState(null),[k,C]=S.useState(null),D=S.useCallback(oe=>{oe!==G.current&&(G.current=oe,b(oe))},[]),E=S.useCallback(oe=>{oe!==F.current&&(F.current=oe,C(oe))},[]),Y=o||w,ee=l||k,G=S.useRef(null),F=S.useRef(null),H=S.useRef(p),U=f!=null,ae=df(f),J=df(a),V=df(h),de=S.useCallback(()=>{if(!G.current||!F.current)return;const oe={placement:n,strategy:t,middleware:g};J.current&&(oe.platform=J.current),Yf(G.current,F.current,oe).then(B=>{const re={...B,isPositioned:V.current!==!1};ue.current&&!Vu(H.current,re)&&(H.current=re,G1.flushSync(()=>{m(re)}))})},[g,n,t,J,V]);wu(()=>{h===!1&&H.current.isPositioned&&(H.current.isPositioned=!1,m(oe=>({...oe,isPositioned:!1})))},[h]);const ue=S.useRef(!1);wu(()=>(ue.current=!0,()=>{ue.current=!1}),[]),wu(()=>{if(Y&&(G.current=Y),ee&&(F.current=ee),Y&&ee){if(ae.current)return ae.current(Y,ee,de);de()}},[Y,ee,de,ae,U]);const le=S.useMemo(()=>({reference:G,floating:F,setReference:D,setFloating:E}),[D,E]),pe=S.useMemo(()=>({reference:Y,floating:ee}),[Y,ee]),q=S.useMemo(()=>{const oe={position:t,left:0,top:0};if(!pe.floating)return oe;const B=nv(pe.floating,p.x),re=nv(pe.floating,p.y);return c?{...oe,transform:"translate("+B+"px, "+re+"px)",...sw(pe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:B,top:re}},[t,c,pe.floating,p.x,p.y]);return S.useMemo(()=>({...p,update:de,refs:le,elements:pe,floatingStyles:q}),[p,de,le,pe,q])}const Xj=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?Hf({element:r.current,padding:a}).fn(t):{}:r?Hf({element:r,padding:a}).fn(t):{}}}},qj=(e,n)=>({...nw(e),options:[e,n]}),Zj=(e,n)=>({...aw(e),options:[e,n]}),Jj=(e,n)=>({...Xj(e),options:[e,n]}),eP={...Iv};let av=!1,tP=0;const sv=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+tP++;function rP(){const[e,n]=S.useState(()=>av?sv():void 0);return Yu(()=>{e==null&&n(sv())},[]),S.useEffect(()=>{av=!0},[]),e}const nP=eP.useId,ow=nP||rP,aP=S.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:m,stroke:g,d:v,style:{transform:w,...b}={},...k}=n,C=ow(),[D,E]=S.useState(!1);if(Yu(()=>{if(!a)return;Kn(a).direction==="rtl"&&E(!0)},[a]),!a)return null;const[Y,ee]=r.split("-"),G=Y==="top"||Y==="bottom";let F=m;(G&&l!=null&&l.x||!G&&l!=null&&l.y)&&(F=null);const H=p*2,U=H/2,ae=c/2*(h/-8+1),J=f/2*h/4,V=!!v,de=F&&ee==="end"?"bottom":"top";let ue=F&&ee==="end"?"right":"left";F&&D&&(ue=ee==="end"?"left":"right");const le=o?.x!=null?F||o.x:"",pe=o?.y!=null?F||o.y:"",q=v||"M0,0"+(" H"+c)+(" L"+(c-ae)+","+(f-J))+(" Q"+c/2+","+f+" "+ae+","+(f-J))+" Z",oe={top:V?"rotate(180deg)":"",left:V?"rotate(90deg)":"rotate(-90deg)",bottom:V?"":"rotate(180deg)",right:V?"rotate(-90deg)":"rotate(90deg)"}[Y];return u.jsxs("svg",{...k,"aria-hidden":!0,ref:t,width:V?c:c+H,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[ue]:le,[de]:pe,[Y]:G||V?"100%":"calc(100% - "+H/2+"px)",transform:[oe,w].filter(B=>!!B).join(" "),...b},children:[H>0&&u.jsx("path",{clipPath:"url(#"+C+")",fill:"none",stroke:g,strokeWidth:H+(v?0:1),d:q}),u.jsx("path",{stroke:H&&!v?k.fill:"none",d:q}),u.jsx("clipPath",{id:C,children:u.jsx("rect",{x:-U,y:U*(V?-1:1),width:c+H,height:c})})]})});function sP(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const oP=S.createContext(null),iP=S.createContext(null),lP=()=>{var e;return((e=S.useContext(oP))==null?void 0:e.id)||null},cP=()=>S.useContext(iP);function uP(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=ow(),o=S.useRef({}),[l]=S.useState(()=>sP()),c=lP()!=null,[f,h]=S.useState(r.reference),p=Ej((v,w,b)=>{o.current.openEvent=v?w:void 0,l.emit("openchange",{open:v,event:w,reason:b,nested:c}),t?.(v,w,b)}),m=S.useMemo(()=>({setPositionReference:h}),[]),g=S.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return S.useMemo(()=>({dataRef:o,open:n,onOpenChange:p,elements:g,events:l,floatingId:a,refs:m}),[n,p,g,l,a,m])}function dP(e){e===void 0&&(e={});const{nodeId:n}=e,t=uP({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=S.useState(null),[c,f]=S.useState(null),p=a?.domReference||o,m=S.useRef(null),g=cP();Yu(()=>{p&&(m.current=p)},[p]);const v=Qj({...e,elements:{...a,...c&&{reference:c}}}),w=S.useCallback(E=>{const Y=un(E)?{getBoundingClientRect:()=>E.getBoundingClientRect(),getClientRects:()=>E.getClientRects(),contextElement:E}:E;f(Y),v.refs.setReference(Y)},[v.refs]),b=S.useCallback(E=>{(un(E)||E===null)&&(m.current=E,l(E)),(un(v.refs.reference.current)||v.refs.reference.current===null||E!==null&&!un(E))&&v.refs.setReference(E)},[v.refs]),k=S.useMemo(()=>({...v.refs,setReference:b,setPositionReference:w,domReference:m}),[v.refs,b,w]),C=S.useMemo(()=>({...v.elements,domReference:p}),[v.elements,p]),D=S.useMemo(()=>({...v,...r,refs:k,elements:C,nodeId:n}),[v,k,C,n,r]);return Yu(()=>{r.dataRef.current.floatingContext=D;const E=g?.nodesRef.current.find(Y=>Y.id===n);E&&(E.context=D)}),S.useMemo(()=>({...v,context:D,refs:k,elements:C}),[v,k,C,D])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Vf=function(n,t){return Vf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},Vf(n,t)};function Mr(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Vf(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var Mt=function(){return Mt=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Mt.apply(this,arguments)};function Ea(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var fP=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return De.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},pP=function(e,n){var t=S.useRef(null),r=S.useRef(e);r.current=e;var a=S.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return S.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},od=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=pP(t,l);return De.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},nt;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(nt||(nt={}));function Wp(){var e=typeof window<"u"?window:globalThis;return e}var Ul=12;function Ht(e){if(e==null)return new Date;var n=typeof e=="string"?qF(e):ct(e);return id(n)?n:new Date}function ff(e,n,t,r,a){a===void 0&&(a=Ht());for(var o=xi(t)||xi(Up()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var h=f[c],p=HF(e,h,a,{locale:o});if(id(p)&&(!r||e===lr(p,h,t)))return p}return null}function id(e,n){return Mu(e)&&!xo(e,new Date("1/1/1800"))}function lr(e,n,t){if(t==="en")return Xg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?xi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||xi(Up()),Xg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Wn(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&lr(e,a,r)||""}function hP(e,n,t){if(!e)return"";var r=Wn(e,t),a=n?Wn(n,t):"";return"".concat(r," - ").concat(a)}function xP(e,n){if(!e?.length)return"";var t=e[0]?Wn(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=Wn(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function pf(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return gu(vu(yu(e,c),o),r)}function mP(e){return jp(e)}function gP(e,n){return lr(e,"ddd",n)}function ku(e){return ho(e)}function Ps(e,n,t){var r=xi(n||Up());return ua(e,{locale:r,weekStartsOn:t})}function Za(e){return P1(e)}function ll(e){return rd(e)}function ov(e){return If(e)}function iv(){return ho(Ht())}function lv(e){return F1(e)}function vP(e){return q4(e)}function yP(e){return j1(e)}function wa(e,n){return e&&n?QF(e,n):!e&&!n}function an(e,n){return e&&n?KF(e,n):!e&&!n}function Ku(e,n){return e&&n?GF(e,n):!e&&!n}function zt(e,n){return e&&n?Q4(e,n):!e&&!n}function ro(e,n){return e&&n?Q3(e,n):!e&&!n}function cl(e,n,t){var r,a=ho(n),o=F1(t);try{r=Dl(e,{start:a,end:o})}catch{r=!1}return r}function Aa(e,n){var t=Wp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function Up(){var e=Wp();return e.__localeId__}function xi(e){if(typeof e=="string"){var n=Wp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function wP(e,n,t){return n(lr(e,"EEEE",t))}function kP(e,n){return lr(e,"EEEEEE",n)}function bP(e,n){return lr(e,"EEE",n)}function $p(e,n){return lr(Un(Ht(),e),"LLLL",n)}function iw(e,n){return lr(Un(Ht(),e),"LLL",n)}function _P(e,n){return lr(Jo(Ht(),e),"QQQ",n)}function $n(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,h=t.filterDate;return $l(e,{minDate:r,maxDate:a})||o&&o.some(function(p){return p instanceof Date?zt(e,p):zt(e,p.date)})||l&&l.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||c&&!c.some(function(p){return zt(e,p)})||f&&!f.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||h&&!h(Ht(e))||!1}function Hp(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Dl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?zt(e,o):zt(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function lw(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return $l(e,{minDate:r?P1(r):void 0,maxDate:a?j1(a):void 0})||o?.some(function(f){return an(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return an(e,f)})||c&&!c(Ht(e))||!1}function uu(e,n,t,r){var a=Ct(e),o=cn(e),l=Ct(n),c=cn(n),f=Ct(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function SP(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return $l(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return an(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return an(c,e)})||!1}function du(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return $l(e,{minDate:r,maxDate:a})||o?.some(function(f){return Ku(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return Ku(e,f)})||c&&!c(Ht(e))||!1}function fu(e,n,t){if(!n||!t||!Mu(n)||!Mu(t))return!1;var r=Ct(n),a=Ct(t);return r<=e&&a>=e}function bu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return $l(f,{minDate:r?rd(r):void 0,maxDate:a?A1(a):void 0})||o?.some(function(h){return wa(f,h instanceof Date?h:h.date)})||l&&!l.some(function(h){return wa(f,h)})||c&&!c(Ht(f))||!1}function pu(e,n,t,r){var a=Ct(e),o=oo(e),l=Ct(n),c=oo(n),f=Ct(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function $l(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&di(e,a)<0||o&&di(e,o)>0)!==null&&t!==void 0?t:!1}function cv(e,n){return n.some(function(t){return Xa(t)===Xa(e)&&qa(t)===qa(e)&&js(t)===js(e)})}function uv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&cv(e,r)||a&&!cv(e,a)||o&&!o(e)||!1}function dv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Ht();a=gu(a,Xa(e)),a=vu(a,qa(e)),a=yu(a,js(e));var o=Ht();o=gu(o,Xa(t)),o=vu(o,qa(t)),o=yu(o,js(t));var l=Ht();l=gu(l,Xa(r)),l=vu(l,qa(r)),l=yu(l,js(r));var c;try{c=!Dl(a,{start:o,end:l})}catch{c=!1}return c}function fv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=io(e,1);return r&&Iu(r,o)>0||a&&a.every(function(l){return Iu(l,o)>0})||!1}function pv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=ca(e,1);return r&&Iu(o,r)>0||a&&a.every(function(l){return Iu(o,l)>0})||!1}function EP(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=rd(e),l=$1(o);return r&&Lu(r,l)>0||a&&a.every(function(c){return Lu(c,l)>0})||!1}function NP(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=A1(e),l=Fp(o,1);return r&&Lu(l,r)>0||a&&a.every(function(c){return Lu(l,c)>0})||!1}function hv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=fi(e,1);return r&&Bu(r,o)>0||a&&a.every(function(l){return Bu(l,o)>0})||!1}function CP(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=ll(fi(e,o)),c=Ds(l,o).endPeriod,f=r&&Ct(r);return f&&f>c||!1}function xv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ga(e,1);return r&&Bu(o,r)>0||a&&a.every(function(l){return Bu(o,l)>0})||!1}function TP(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=Ga(e,o),c=Ds(l,o).startPeriod,f=r&&Ct(r);return f&&f<c||!1}function cw(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)>=0});return Hg(r)}else return t?Hg(t):n}function uw(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)<=0});return $g(r)}else return t?$g(t):n}function mv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Qa(l)){var c=lr(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var h=Object.keys(l),p=(t=h[0])!==null&&t!==void 0?t:"",m=l[p];if(typeof p=="string"&&Array.isArray(m))for(var g=0,v=m.length;g<v;g++){var w=m[g];if(w){var c=lr(w,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(p)||(f.push(p),r.set(c,f))}}}}return r}function DP(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function FP(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Qa(a)){var l=lr(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&DP(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?Ea(Ea([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function jP(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,h=a[c];h&&(f=Y4(f,Xa(h)),f=Mf(f,qa(h)),f=G4(f,js(h)));var p=Mf(e,(t+1)*r);Rs(f,n)&&xo(f,p)&&h!=null&&l.push(h)}return l}function gv(e){return e<10?"0".concat(e):"".concat(e)}function Ds(e,n){n===void 0&&(n=Ul);var t=Math.ceil(Ct(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function PP(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function vv(e){var n=e.getSeconds(),t=e.getMilliseconds();return ct(e.getTime()-n*1e3-t)}function AP(e,n){return vv(e).getTime()===vv(n).getTime()}function yv(e){if(!Qa(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function wv(e,n){if(!Qa(e)||!Qa(n))throw new Error("Invalid date received");var t=yv(e),r=yv(n);return xo(t,r)}function dw(e){return e.key===nt.Space}var OP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=De.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),h=f?c:new Date;if(a?.includes(":")){var p=a.split(":"),m=p[0],g=p[1];h.setHours(Number(m)),h.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,h)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?S.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):De.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var h;(h=r.inputRef.current)===null||h===void 0||h.focus()},required:!0,value:a,onChange:function(h){r.onTimeChange(h.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return De.createElement("div",{className:"react-datepicker__input-time-container"},De.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),De.createElement("div",{className:"react-datepicker-time__input-container"},De.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(S.Component),RP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=S.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===nt.Space&&(r.preventDefault(),r.key=nt.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return zt(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),$n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Hp(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return zt(t.props.day,Ps(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&zt(r,Ps(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=lr(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=lr(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:cl(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,h=a.selectsDisabledDaysInRange,p=a.startDate,m=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!h&&t.isDisabled()?!1:l&&m&&(xo(g,m)||ro(g,m))?cl(o,g,m):c&&p&&!m&&(Rs(g,p)||ro(g,p))||f&&p&&!m&&(Rs(g,p)||ro(g,p))?cl(o,p,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?zt(o,f):zt(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,h=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?zt(o,h):zt(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:zt(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:zt(l,a)},t.isWeekend=function(){var r=Y3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===cn(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(cn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Ht())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Wr("react-datepicker__day",a,"react-datepicker__day--"+gP(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,h=t.isDisabled()||t.isExcluded()?f:l;return"".concat(h," ").concat(lr(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=lr(a,"MM.dd.yyyy"),h=[];return l.has(f)&&h.push.apply(h,l.get(f).holidayNames),t.isExcluded()&&h.push(c?.filter(function(p){return p instanceof Date?zt(p,a):zt(p?.date,a)}).map(function(p){if(!(p instanceof Date))return p?.message})),h.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&zt(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(qg(t.props.day),t.props.day):qg(t.props.day)},t.render=function(){return De.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&De.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(S.Component),zP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=S.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===nt.Space&&(r.preventDefault(),r.key=nt.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!zt(t.props.date,t.props.selected)&&zt(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||zt(t.props.date,t.props.selected)&&zt(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&zt(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&zt(this.props.date,this.props.selected)};return De.createElement("div",{ref:this.weekNumberEl,className:Wr(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(S.Component),MP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return $n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,h=new Date(r),p=0;p<7;p++){var m=new Date(r);m.setDate(m.getDate()+p);var g=!t.isDisabled(m);if(g){h=m;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(h,a,o),t.props.showWeekPicker&&t.handleDayClick(h,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):mP(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=la(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=la(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(De.createElement(zP,Mt({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=la(r,c);return De.createElement(RP,Mt({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Ps(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!zt(t.startOfWeek(),t.props.selected)&&zt(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":zt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return De.createElement("div",{className:Wr(t)},this.renderDays())},n})(S.Component),nl,IP=6,ii={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},hf=(nl={},nl[ii.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},nl[ii.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},nl[ii.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},nl),hu=1;function kv(e,n){return e?ii.FOUR_COLUMNS:n?ii.TWO_COLUMNS:ii.THREE_COLUMNS}var LP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=Ea([],Array(12),!0).map(function(){return S.createRef()}),t.QUARTER_REFS=Ea([],Array(4),!0).map(function(){return S.createRef()}),t.isDisabled=function(r){return $n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return Hp(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Un(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Ku(Jo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Un(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Ku(Jo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?uu(g,m,r,l):f&&p||h&&p&&!m?uu(p,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,h=Un(l,r),p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?an(h,p):an(h,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,h=o.selectsRange,p=Un(l,r),m=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||h?an(p,m):an(p,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?pu(g,m,r,l):f&&p||h&&p&&!m?pu(p,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=la(r,6);return an(r,a)||an(o,a)},t.isCurrentMonth=function(r,a){return Ct(r)===Ct(Ht())&&a===cn(Ht())},t.isCurrentQuarter=function(r,a){return Ct(r)===Ct(Ht())&&a===oo(Ht())},t.isSelectedMonth=function(r,a,o){return cn(o)===a&&Ct(r)===Ct(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return oo(r)===a&&Ct(r)===Ct(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Ps(Za(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(w){return t.props.showWeekPicker?Ps(w,t.props.locale,t.props.calendarStartDay):t.props.preSelection},h=function(w){return t.props.showWeekPicker?Ps(w,t.props.locale,t.props.calendarStartDay):t.props.selected},p=t.props.selected?h(t.props.selected):void 0,m=t.props.preSelection?f(t.props.preSelection):void 0;r.push(De.createElement(MP,Mt({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:cn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:p,preSelection:m,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=zu(c,1);var g=a&&o>=IP,v=!a&&!t.isWeekInMonth(c);if(g||v)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Za(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Za(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,h=c.preSelection,p=c.setPreSelection,m=c.minDate,g=c.maxDate,v=c.showFourColumnMonthYearPicker,w=c.showTwoColumnMonthYearPicker;if(h){var b=kv(v,w),k=t.getVerticalOffset(b),C=(l=hf[b])===null||l===void 0?void 0:l.grid,D=function(F,H,U){var ae,J,V=H,de=U;switch(F){case nt.ArrowRight:V=ca(H,hu),de=U===11?0:U+hu;break;case nt.ArrowLeft:V=io(H,hu),de=U===0?11:U-hu;break;case nt.ArrowUp:V=io(H,k),de=!((ae=C?.[0])===null||ae===void 0)&&ae.includes(U)?U+12-k:U-k;break;case nt.ArrowDown:V=ca(H,k),de=!((J=C?.[C.length-1])===null||J===void 0)&&J.includes(U)?U-12+k:U+k;break}return{newCalculatedDate:V,newCalculatedMonth:de}},E=function(F,H,U){for(var ae=40,J=F,V=!1,de=0,ue=D(J,H,U),le=ue.newCalculatedDate,pe=ue.newCalculatedMonth;!V;){if(de>=ae){le=H,pe=U;break}if(m&&le<m){J=nt.ArrowRight;var q=D(J,le,pe);le=q.newCalculatedDate,pe=q.newCalculatedMonth}if(g&&le>g){J=nt.ArrowLeft;var q=D(J,le,pe);le=q.newCalculatedDate,pe=q.newCalculatedMonth}if(SP(le,t.props)){var q=D(J,le,pe);le=q.newCalculatedDate,pe=q.newCalculatedMonth}else V=!0;de++}return{newCalculatedDate:le,newCalculatedMonth:pe}};if(a===nt.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),p?.(f));return}var Y=E(a,h,o),ee=Y.newCalculatedDate,G=Y.newCalculatedMonth;switch(a){case nt.ArrowRight:case nt.ArrowLeft:case nt.ArrowUp:case nt.ArrowDown:t.handleMonthNavigation(G,ee);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=hf[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==nt.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Jo(t.props.day,a);du(o,t.props)||t.handleDayClick(ov(o),r)},t.onQuarterMouseEnter=function(r){var a=Jo(t.props.day,r);du(a,t.props)||t.handleDayMouseEnter(ov(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case nt.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case nt.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Fp(t.props.preSelection,1));break;case nt.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,$1(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=Un(l,r);return{isDisabled:(a=(c||f||h||p)&&lw(m,t.props))!==null&&a!==void 0?a:!1,labelDate:m}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,h=a.monthClassName,p=h?h(Un(o,r)):void 0,m=t.getSelection();return Wr("react-datepicker__month-text","react-datepicker__month-".concat(r),p,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":m?t.isSelectMonthInList(o,r,m):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=cn(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=oo(t.props.preSelection),o=du(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,h=a.day,p=a.locale,m=Un(h,r),g=t.isDisabled(m)||t.isExcluded(m)?f:l;return"".concat(g," ").concat(lr(m,"MMMM yyyy",p))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,h=a.minDate,p=a.maxDate,m=a.excludeDates,g=a.includeDates,v=a.filterDate,w=a.preSelection,b=a.disabledKeyboardNavigation,k=(h||p||m||g||v)&&du(Jo(o,r),t.props);return Wr("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":k,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!b&&w&&t.isSelectedQuarter(o,r,w)&&!k,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?pu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,h=iw(r,c),p=$p(r,c);return l?l(r,h,p,f):o?p:h},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=_P(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,h=(r=hf[kv(l,o)])===null||r===void 0?void 0:r.grid;return h?.map(function(p,m){return De.createElement("div",{className:"react-datepicker__month-wrapper",key:m},p.map(function(g,v){return De.createElement("div",{ref:t.MONTH_REFS[g],key:v,onClick:function(w){t.onMonthClick(w,g)},onKeyDown:function(w){dw(w)&&(w.preventDefault(),w.key=nt.Enter),t.onMonthKeyDown(w,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return De.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return De.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(h){t.onQuarterClick(h,c)},onKeyDown:function(h){t.onQuarterKeyDown(h,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,h=r.showWeekPicker;return Wr("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":h})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return De.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(lr(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(S.Component),BP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return De.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?De.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return De.createElement(od,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(S.Component),WP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return De.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return De.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return De.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},De.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),De.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return De.createElement(BP,Mt({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return iw(o,t.props.locale)}:function(o){return $p(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return De.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(S.Component);function UP(e,n){for(var t=[],r=Za(e),a=Za(n);!Rs(r,a);)t.push(Ht(r)),r=ca(r,1);return t}var $P=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=Bf(a),l=wa(r.props.date,a)&&an(r.props.date,a);return De.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?De.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",lr(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:UP(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Wr({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return De.createElement(od,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(S.Component),HP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Za(t.props.minDate),a=Za(t.props.maxDate),o=[];!Rs(r,a);){var l=Bf(r);o.push(De.createElement("option",{key:l,value:l},lr(r,t.props.dateFormat,t.props.locale))),r=ca(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return De.createElement("select",{value:Bf(Za(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=lr(t.props.date,t.props.dateFormat,t.props.locale);return De.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},De.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),De.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return De.createElement($P,Mt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Ht(r);wa(t.props.date,a)&&an(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return De.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(S.Component),YP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&dv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&uv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&AP(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&dv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&uv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(Xa(r)*3600+qa(r)*60+js(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===nt.Space&&(r.preventDefault(),r.key=nt.Enter),(r.key===nt.ArrowUp||r.key===nt.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===nt.ArrowDown||r.key===nt.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===nt.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Ht(),f=ku(c),h=t.props.injectTimes&&t.props.injectTimes.sort(function(k,C){return k.getTime()-C.getTime()}),p=60*PP(c),m=p/l,g=0;g<m;g++){var v=Mf(f,g*l);if(a.push(v),h){var w=jP(f,v,g,l,h);a=a.concat(w)}}var b=a.reduce(function(k,C){return C.getTime()<=c.getTime()?C:k},a[0]);return a.map(function(k){return De.createElement("li",{key:k.valueOf(),onClick:t.handleClick.bind(t,k),className:t.liClasses(k),ref:function(C){k===b&&(t.centerLi=C)},onKeyDown:function(C){t.handleOnKeyDown(C,k)},tabIndex:k===b?0:-1,role:"option","aria-selected":t.isSelectedTime(k)?"true":void 0,"aria-disabled":t.isDisabledTime(k)?"true":void 0},lr(k,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?De.createElement(De.Fragment,null):De.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},De.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return De.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),De.createElement("div",{className:"react-datepicker__time"},De.createElement("div",{className:"react-datepicker__time-box"},De.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(S.Component),bv=3,VP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=Ea([],Array(r.props.yearItemNumber),!0).map(function(){return S.createRef()}),r.isDisabled=function(a){return $n(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return Hp(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,h,p=r.props,m=p.date,g=p.yearItemNumber;if(!(m===void 0||g===void 0)){var v=Ds(m,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-v<0?r.updateFocusOnPaginate(g-(v-a)):a-v>=g?r.updateFocusOnPaginate(Math.abs(g-(a-v))):(h=(f=r.YEAR_REFS[a-v])===null||f===void 0?void 0:f.current)===null||h===void 0||h.focus())}},r.isSameDay=function(a,o){return zt(a,o)},r.isCurrentYear=function(a){return a===Ct(Ht())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&wa(ya(Ht(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&wa(ya(Ht(),a),r.props.endDate)},r.isInRange=function(a){return fu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,h=o.startDate,p=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&p?fu(a,r.selectingDate(),p):c&&h||f&&h&&!p?fu(a,h,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,h=ya(Ht(),a);return f?wa(h,(o=r.selectingDate())!==null&&o!==void 0?o:null):wa(h,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,h=l.selectsRange,p=ya(Ht(),a);return f||h?wa(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):wa(p,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,h=o.includeDates,p=o.filterDate,m=ll(ya(r.props.date,a)),g=(l||c||f||h||p)&&bu(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!zt(m,ll(r.props.selected))&&zt(m,ll(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(h){return a===Ct(h)}):!c||a===Ct(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ll(ya(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,h=r.props,p=h.date,m=h.yearItemNumber,g=h.handleOnKeyDown;if(f!==nt.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case nt.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case nt.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Ga(r.props.preSelection,1));break;case nt.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,fi(r.props.preSelection,1));break;case nt.ArrowUp:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var v=Ds(p,m).startPeriod,w=bv,b=o-w;if(b<v){var k=m%w;o>=v&&o<v+k?w=k:w+=k,b=o-w}r.handleYearNavigation(b,fi(r.props.preSelection,w));break}case nt.ArrowDown:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var C=Ds(p,m).endPeriod,w=bv,b=o+w;if(b>C){var k=m%w;o<=C&&o>C-k?w=k:w+=k,b=o+w}r.handleYearNavigation(b,Ga(r.props.preSelection,w));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=o.filterDate,g=o.yearClassName;return Wr("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(ya(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||h||p||m)&&bu(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=Ct(r.props.preSelection),l=bu(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var h=Ds(o,l),p=h.startPeriod,m=h.endPeriod,g=function(b){r.push(De.createElement("div",{ref:v.YEAR_REFS[b-p],onClick:function(k){t.onYearClick(k,b)},onKeyDown:function(k){dw(k)&&(k.preventDefault(),k.key=nt.Enter),t.onYearKeyDown(k,b)},tabIndex:Number(v.getYearTabIndex(b)),className:v.getYearClassNames(b),onMouseEnter:v.props.usePointerEvent?void 0:function(k){return c(k,b)},onPointerEnter:v.props.usePointerEvent?function(k){return c(k,b)}:void 0,onMouseLeave:v.props.usePointerEvent?void 0:function(k){return f(k,b)},onPointerLeave:v.props.usePointerEvent?function(k){return f(k,b)}:void 0,key:b,"aria-current":v.isCurrentYear(b)?"date":void 0},v.getYearContent(b)))},v=this,w=p;w<=m;w++)g(w);return De.createElement("div",{className:"react-datepicker__year"},De.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(S.Component);function KP(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=Ct(t)<=l),r&&c&&(c=Ct(r)>=l),c&&a.push(l)}return a}var GP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(m){return De.createElement("div",{className:c===m?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:m,onClick:r.onChange.bind(r,m),"aria-selected":c===m?"true":void 0},c===m?De.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",m)}),h=r.props.minDate?Ct(r.props.minDate):null,p=r.props.maxDate?Ct(r.props.maxDate):null;return(!p||!r.state.yearsList.find(function(m){return m===p}))&&f.unshift(De.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},De.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!h||!r.state.yearsList.find(function(m){return m===h}))&&f.push(De.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},De.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(h){return h+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:KP(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=S.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Wr({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return De.createElement(od,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(S.Component),QP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?Ct(t.props.minDate):1900,a=t.props.maxDate?Ct(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(De.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return De.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return De.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},De.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),De.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return De.createElement(GP,Mt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return De.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(S.Component),XP=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],qP=function(e){var n=(e.className||"").split(/\s+/);return XP.some(function(t){return n.indexOf(t)>=0})},ZP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;qP(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=cw(r.props),h=uw(r.props),p=Ht(),m=c||l||o;return m||(f&&xo(p,f)?f:h&&Rs(p,h)?h:p)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:ca(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:io(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:ya(Ht(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!$n(a,r.props))return a;for(var o=Za(a),l=yP(a),c=X4(l,o),f=null,h=0;h<=c;h++){var p=la(o,h);if(!$n(p,r.props)){f=p;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:ya(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Un(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:ya(Un(l,cn(a)),Ct(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Ps(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(De.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=la(o,c),h=r.formatWeekday(f,r.props.locale),p=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return De.createElement("div",{key:c,"aria-label":lr(f,"EEEE",r.props.locale),className:Wr("react-datepicker__day-name",p)},h)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?wP(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?bP(a,o):kP(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:fi(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,p=io(r.state.date,h),m;switch(!0){case r.props.showMonthYearPicker:m=hv(r.state.date,r.props);break;case r.props.showYearPicker:m=CP(r.state.date,r.props);break;case r.props.showQuarterYearPicker:m=EP(r.state.date,r.props);break;default:m=fv(p,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&m||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],v=["react-datepicker__navigation","react-datepicker__navigation--previous"],w=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(w=r.decreaseYear),m&&r.props.showDisabledMonthNavigation&&(v.push("react-datepicker__navigation--previous--disabled"),w=void 0);var b=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,k=r.props,C=k.previousMonthButtonLabel,D=C===void 0?n.defaultProps.previousMonthButtonLabel:C,E=k.previousYearButtonLabel,Y=E===void 0?n.defaultProps.previousYearButtonLabel:E,ee=r.props,G=ee.previousMonthAriaLabel,F=G===void 0?typeof D=="string"?D:"Previous Month":G,H=ee.previousYearAriaLabel,U=H===void 0?typeof Y=="string"?Y:"Previous Year":H;return De.createElement("button",{type:"button",className:v.join(" "),onClick:w,onKeyDown:r.props.handleOnKeyDown,"aria-label":b?U:F},De.createElement("span",{className:g.join(" ")},b?Y:D))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Ga(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=xv(r.state.date,r.props);break;case r.props.showYearPicker:o=TP(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=NP(r.state.date,r.props);break;default:o=pv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,m=p.nextMonthButtonLabel,g=m===void 0?n.defaultProps.nextMonthButtonLabel:m,v=p.nextYearButtonLabel,w=v===void 0?n.defaultProps.nextYearButtonLabel:v,b=r.props,k=b.nextMonthAriaLabel,C=k===void 0?typeof g=="string"?g:"Next Month":k,D=b.nextYearAriaLabel,E=D===void 0?typeof w=="string"?w:"Next Year":D;return De.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":h?E:C},De.createElement("span",{className:c.join(" ")},h?w:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),De.createElement("h2",{className:o.join(" ")},lr(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return De.createElement(QP,Mt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:Ct(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return De.createElement(WP,Mt({},n.defaultProps,r.props,{month:cn(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return De.createElement(HP,Mt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(iv(),a),r.props.setPreSelection&&r.props.setPreSelection(iv())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return De.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return De.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),De.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),De.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var h=fv(r.state.date,r.props),p=pv(r.state.date,r.props),m=hv(r.state.date,r.props),g=xv(r.state.date,r.props),v=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return De.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,Mt(Mt({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:p,prevYearButtonDisabled:m,nextYearButtonDisabled:g})),v&&De.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,h=f===void 0?n.defaultProps.yearItemNumber:f,p=Ds(o,h),m=p.startPeriod,g=p.endPeriod;return De.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(m," - ").concat(g):Ct(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ga(r.state.date,f):io(r.state.date,f),p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,m=0;m<c;++m){var g=m-p+f,v=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ga(h,g):ca(h,g),w="month-".concat(m),b=m<c-1,k=m>0;l.push(De.createElement("div",{key:w,ref:function(C){r.monthContainer=C??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:v,i:m}),De.createElement(LP,Mt({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:v,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:m,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:b,monthShowsDuplicateDaysStart:k}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return De.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),De.createElement(VP,Mt({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return De.createElement(YP,Mt({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&id(a)&&!!r.props.selected,l=o?"".concat(gv(a.getHours()),":").concat(gv(a.getMinutes())):"";if(r.props.showTimeInput)return De.createElement(OP,Mt({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=Ds(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=Ct(r.state.date):f="".concat($p(cn(r.state.date),r.props.locale)," ").concat(Ct(r.state.date)),De.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return De.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=S.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:Ul}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!zt(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!an(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!zt(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||fP;return De.createElement(od,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},De.createElement("div",{style:{display:"contents"},ref:this.containerRef},De.createElement(t,{className:Wr("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(S.Component),JP=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return De.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(De.isValidElement(n)){var l=n;return De.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return De.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},De.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},fw=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return Nj.createPortal(this.props.children,this.el)},n})(S.Component),eA="[tabindex], a, button, input, select, textarea",tA=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},pw=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(eA),1,-1).filter(tA)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=S.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?De.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},De.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,De.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(S.Component);function rA(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=S.useRef(null),l=dP(Mt({open:!a,whileElementsMounted:rw,placement:t.popperPlacement,middleware:Ea([Zj({padding:15}),qj(10),Jj({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=Mt(Mt({},t),{hidePopper:a,popperProps:Mt(Mt({},l),{arrowRef:o})});return De.createElement(e,Mt({},c))};return n}var nA=(function(e){Mr(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,h=t.enableTabLoop,p=t.popperOnKeyDown,m=t.portalId,g=t.portalHost,v=t.popperProps,w=t.showArrow,b=void 0;if(!l){var k=Wr("react-datepicker-popper",r);b=De.createElement(pw,{enableTabLoop:h},De.createElement("div",{ref:v.refs.setFloating,style:v.floatingStyles,className:k,"data-placement":v.placement,onKeyDown:p},c,w&&De.createElement(aP,{ref:v.arrowRef,context:v.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(b=S.createElement(this.props.popperContainer,{},b)),m&&!l&&(b=De.createElement(fw,{portalId:m,portalHost:g},b));var C=Wr("react-datepicker-wrapper",a);return De.createElement(De.Fragment,null,De.createElement("div",{ref:v.refs.setReference,className:C},f),b)},n})(S.Component),aA=rA(nA),_v="react-datepicker-ignore-onclickoutside";function sA(e,n){return e&&n?cn(e)!==cn(n)||Ct(e)!==Ct(n):e!==n}var xf="Date input not valid.",pn=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Ht()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return id(c)?Ea(Ea([],o,!0),[Mt(Mt({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=cw(r.props),c=uw(r.props),f=l&&xo(o,ku(l))?l:c&&Rs(o,lv(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:mv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(Mt(Mt({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(Mt(Mt({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:mf},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Qa(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var m=h[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,h),!m||typeof m.isDefaultPrevented!="function"||m.isDefaultPrevented()))){r.setState({inputValue:m?.target instanceof HTMLInputElement?m.target.value:null,lastPreSelectChange:oA});var g=r.props,v=g.selectsRange,w=g.startDate,b=g.endDate,k=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,C=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,D=m?.target instanceof HTMLInputElement?m.target.value:"";if(v){var E=D.split("-",2).map(function(J){return J.trim()}),Y=E[0],ee=E[1],G=ff(Y??"",k,r.props.locale,C),F=ff(ee??"",k,r.props.locale,C),H=w?.getTime()!==G?.getTime(),U=b?.getTime()!==F?.getTime();if(!H&&!U||G&&$n(G,r.props)||F&&$n(F,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[G,F],m)}else{var ae=ff(D,k,r.props.locale,C,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(ae||!D)&&r.setSelected(ae,m,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,h=c.endDate;f&&!h&&(r.props.swapRange||!wv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,h,p=a;if(r.props.showYearPicker){if(p!==null&&bu(Ct(p),r.props))return}else if(r.props.showMonthYearPicker){if(p!==null&&lw(p,r.props))return}else if(p!==null&&$n(p,r.props))return;var m=r.props,g=m.onChange,v=m.selectsRange,w=m.startDate,b=m.endDate,k=m.selectsMultiple,C=m.selectedDates,D=m.minTime,E=m.swapRange;if(!ro(r.props.selected,p)||r.props.allowSameDay||v||k)if(p!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(p=pf(p,{hour:Xa(r.props.selected),minute:qa(r.props.selected),second:js(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&D&&(p=pf(p,{hour:D.getHours(),minute:D.getMinutes(),second:D.getSeconds()})),r.props.inline||r.setState({preSelection:p}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),v){var Y=!w&&!b,ee=w&&!b,G=w&&b;Y?g?.([p,null],o):ee&&(p===null?g?.([null,null],o):wv(p,w)?g?.(E?[p,w]:[p,null],o):g?.([w,p],o)),G&&g?.([p,null],o)}else if(k){if(p!==null)if(!C?.length)g?.([p],o);else{var F=C.some(function(U){return zt(U,p)});if(F){var H=C.filter(function(U){return!zt(U,p)});g?.(H,o)}else g?.(Ea(Ea([],C,!0),[p],!1),o)}}else g?.(p,o);l||((h=(f=r.props).onSelect)===null||h===void 0||h.call(f,p,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Qa(r.props.minDate),l=Qa(r.props.maxDate),c=!0;if(a){var f=ku(a);if(o&&l)c=cl(a,r.props.minDate,r.props.maxDate);else if(o){var h=ku(r.props.minDate);c=Rs(a,h)||ro(f,h)}else if(l){var p=lv(r.props.maxDate);c=xo(a,p)||ro(f,p)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:pf(c,{hour:Xa(a),minute:qa(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,h,p;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var m=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(m===nt.ArrowDown||m===nt.ArrowUp||m===nt.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(m===nt.ArrowDown||m===nt.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',v=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);v instanceof HTMLElement&&v.focus({preventScroll:!0});return}var w=Ht(r.state.preSelection);m===nt.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===mf?(r.handleSelect(w,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(w)):r.setOpen(!1)):m===nt.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):m===nt.Tab&&r.setOpen(!1),r.inputOk()||(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:xf})}},r.onPortalKeyDown=function(a){var o=a.key;o===nt.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,h,p,m=r.props,g=m.minDate,v=m.maxDate,w=m.disabledKeyboardNavigation,b=m.showWeekPicker,k=m.shouldCloseOnSelect,C=m.locale,D=m.calendarStartDay,E=m.adjustDateOnChange,Y=m.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!w){var ee=a.key,G=a.shiftKey,F=Ht(r.state.preSelection),H=function(le,pe){var q=pe;switch(le){case nt.ArrowRight:q=b?zu(pe,1):la(pe,1);break;case nt.ArrowLeft:q=b?Zg(pe):XF(pe);break;case nt.ArrowUp:q=Zg(pe);break;case nt.ArrowDown:q=zu(pe,1);break;case nt.PageUp:q=G?fi(pe,1):io(pe,1);break;case nt.PageDown:q=G?Ga(pe,1):ca(pe,1);break;case nt.Home:q=Ps(pe,C,D);break;case nt.End:q=vP(pe);break}return q},U=function(le,pe){for(var q=40,oe=le,B=!1,re=0,I=H(le,pe);!B;){if(re>=q){I=pe;break}g&&I<g&&(oe=nt.ArrowRight,I=$n(g,r.props)?H(oe,I):g),v&&I>v&&(oe=nt.ArrowLeft,I=$n(v,r.props)?H(oe,I):v),$n(I,r.props)?((oe===nt.PageUp||oe===nt.Home)&&(oe=nt.ArrowRight),(oe===nt.PageDown||oe===nt.End)&&(oe=nt.ArrowLeft),I=H(oe,I)):B=!0,re++}return I};if(ee===nt.Enter){a.preventDefault(),r.handleSelect(F,a),!k&&r.setPreSelection(F);return}else if(ee===nt.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:xf});return}var ae=null;switch(ee){case nt.ArrowLeft:case nt.ArrowRight:case nt.ArrowUp:case nt.ArrowDown:case nt.PageUp:case nt.PageDown:case nt.Home:case nt.End:ae=U(ee,F);break}if(!ae){(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:xf});return}if(a.preventDefault(),r.setState({lastPreSelectChange:mf}),E&&r.setSelected(ae),r.setPreSelection(ae),Y){var J=cn(F),V=cn(ae),de=Ct(F),ue=Ct(ae);J!==V||de!==ue?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===nt.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:De.createElement(ZP,Mt({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:FP(r.modifyHolidays()),outsideClickIgnoreClass:_v,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,h=f?"PPPPp":"PPPP",p;return r.props.selectsRange?p="Selected start date: ".concat(Wn(r.props.startDate,{dateFormat:h,locale:c}),". ").concat(r.props.endDate?"End date: "+Wn(r.props.endDate,{dateFormat:h,locale:c}):""):r.props.showTimeSelectOnly?p="Selected time: ".concat(Wn(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?p="Selected year: ".concat(Wn(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?p="Selected month: ".concat(Wn(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?p="Selected quarter: ".concat(Wn(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):p="Selected date: ".concat(Wn(r.props.selected,{dateFormat:h,locale:c})),De.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},p)},r.renderDateInput=function(){var a,o,l,c=Wr(r.props.className,(a={},a[_v]=r.state.open,a)),f=r.props.customInput||De.createElement("input",{type:"text"}),h=r.props.customInputRef||"ref",p=r.props,m=p.dateFormat,g=m===void 0?n.defaultProps.dateFormat:m,v=p.locale,w=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?hP(r.props.startDate,r.props.endDate,{dateFormat:g,locale:v}):r.props.selectsMultiple?xP((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:v}):Wn(r.props.selected,{dateFormat:g,locale:v});return S.cloneElement(f,(o={},o[h]=function(b){r.input=b},o.value=w,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Wr(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,h=a.endDate,p=a.clearButtonTitle,m=a.clearButtonClassName,g=m===void 0?"":m,v=a.ariaLabelClose,w=v===void 0?"Close":v,b=a.selectedDates;return o&&(c!=null||f!=null||h!=null||b?.length)?De.createElement("button",{type:"button",className:Wr("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":w,onClick:r.onClearClick,title:p,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:Ul,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&sA(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:mv(this.props.highlightDates)}),!r.focused&&!ro(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),De.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&De.createElement(JP,Mt({icon:a,className:Wr(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?De.createElement(pw,{enableTabLoop:this.props.enableTabLoop},De.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=De.createElement(fw,Mt({portalId:this.props.portalId},this.props),r)),De.createElement("div",null,this.renderInputContainer(),r)}return De.createElement(aA,Mt({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(S.Component),oA="input",mf="navigate";const iA={lessThanXSeconds:{one:{regular:"mniej ni sekunda",past:"mniej ni sekund",future:"mniej ni sekund"},twoFour:"mniej ni {{count}} sekundy",other:"mniej ni {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekund",future:"sekund"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"p minuty",twoFour:"p minuty",other:"p minuty"},lessThanXMinutes:{one:{regular:"mniej ni minuta",past:"mniej ni minut",future:"mniej ni minut"},twoFour:"mniej ni {{count}} minuty",other:"mniej ni {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minut",future:"minut"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"okoo godziny",past:"okoo godziny",future:"okoo godzin"},twoFour:"okoo {{count}} godziny",other:"okoo {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzin",future:"godzin"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzie",past:"dzie",future:"1 dzie"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"okoo tygodnia",twoFour:"okoo {{count}} tygodni",other:"okoo {{count}} tygodni"},xWeeks:{one:"tydzie",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"okoo miesic",twoFour:"okoo {{count}} miesice",other:"okoo {{count}} miesicy"},xMonths:{one:"miesic",twoFour:"{{count}} miesice",other:"{{count}} miesicy"},aboutXYears:{one:"okoo rok",twoFour:"okoo {{count}} lata",other:"okoo {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function lA(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function gf(e,n,t){const r=lA(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const cA=(e,n,t)=>{const r=iA[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+gf(r,n,"future"):gf(r,n,"past")+" temu":gf(r,n,"regular")},uA={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},dA={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},fA={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pA={date:si({formats:uA,defaultWidth:"full"}),time:si({formats:dA,defaultWidth:"full"}),dateTime:si({formats:fA,defaultWidth:"full"})},hA={masculine:"ostatni",feminine:"ostatnia"},xA={masculine:"ten",feminine:"ta"},mA={masculine:"nastpny",feminine:"nastpna"},gA={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function Sv(e,n,t,r){let a;if(VF(n,t,r))a=xA;else if(e==="lastWeek")a=hA;else if(e==="nextWeek")a=mA;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=gA[o];return`'${a[l]}' eeee 'o' p`}const vA={lastWeek:Sv,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:Sv,other:"P"},yA=(e,n,t,r)=>{const a=vA[e];return typeof a=="function"?a(e,n,t,r):a},wA={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed nasz er","naszej ery"]},kA={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwarta","II kwarta","III kwarta","IV kwarta"]},bA={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"]},_A={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrzenia","padziernika","listopada","grudnia"]},SA={narrow:["N","P","W","","C","P","S"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},EA={narrow:["n","p","w","","c","p","s"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},NA={narrow:{am:"a",pm:"p",midnight:"pn.",noon:"po",morning:"rano",afternoon:"popo.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"}},CA={narrow:{am:"a",pm:"p",midnight:"o pn.",noon:"w po.",morning:"rano",afternoon:"po po.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"}},TA=(e,n)=>String(e),DA={ordinalNumber:TA,era:ka({values:wA,defaultWidth:"wide"}),quarter:ka({values:kA,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ka({values:bA,defaultWidth:"wide",formattingValues:_A,defaultFormattingWidth:"wide"}),day:ka({values:SA,defaultWidth:"wide",formattingValues:EA,defaultFormattingWidth:"wide"}),dayPeriod:ka({values:NA,defaultWidth:"wide",formattingValues:CA,defaultFormattingWidth:"wide"})},FA=/^(\d+)?/i,jA=/\d+/i,PA={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(|a)\s*er(|a)|naszej\s*ery)/i},AA={any:[/^p/i,/^n/i]},OA={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(|l)/i},RA={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},zA={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(|z)|lis|gru)/i,wide:/^(stycznia|stycze(|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(|n)|wrze(|s)nia|wrzesie(|n)|pa(|z)dziernika|pa(|z)dziernik|listopada|listopad|grudnia|grudzie(|n))/i},MA={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},IA={narrow:/^[npwcs]/i,short:/^(nie|pon|wto|(|s)ro|czw|pi(|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(|l)ek|wtorek|(|s)roda|czwartek|pi(|a)tek|sobota)/i},LA={narrow:[/^n/i,/^p/i,/^w/i,/^/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pi/i,/^so/i]},BA={narrow:/^(^a$|^p$|p(|l)n\.?|o\s*p(|l)n\.?|po(|l)\.?|w\s*po(|l)\.?|po\s*po(|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|p(|l)noc|o\s*p(|l)nocy|po(|l)udnie|w\s*po(|l)udnie|popo(|l)udnie|po\s*po(|l)udniu|rano|wieczr|wieczorem|noc|w\s*nocy)/i},WA={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i}},UA={ordinalNumber:O1({matchPattern:FA,parsePattern:jA,valueCallback:e=>parseInt(e,10)}),era:ba({matchPatterns:PA,defaultMatchWidth:"wide",parsePatterns:AA,defaultParseWidth:"any"}),quarter:ba({matchPatterns:OA,defaultMatchWidth:"wide",parsePatterns:RA,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ba({matchPatterns:zA,defaultMatchWidth:"wide",parsePatterns:MA,defaultParseWidth:"any"}),day:ba({matchPatterns:IA,defaultMatchWidth:"wide",parsePatterns:LA,defaultParseWidth:"any"}),dayPeriod:ba({matchPatterns:BA,defaultMatchWidth:"any",parsePatterns:WA,defaultParseWidth:"any"})},Oa={code:"pl",formatDistance:cA,formatLong:pA,formatRelative:yA,localize:DA,match:UA,options:{weekStartsOn:1,firstWeekContainsDate:4}};Aa("pl",Oa);const vf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],$A=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],HA=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=S.useState(null),[o,l]=S.useState(""),[c,f]=S.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[h,p]=S.useState(""),[m,g]=S.useState(null),[v,w]=S.useState(null),b=S.useRef(null),k=S.useRef(null),[C,D]=S.useState(null),[E,Y]=S.useState(null),[ee,G]=S.useState("0,00"),[F,H]=S.useState("0,00"),[U,ae]=S.useState("0,00"),J=()=>{const j=c.reduce((W,z)=>{const O=parseFloat(z.ilosc.toString().replace(",","."))||0;return W+O},0),N=parseFloat(h.replace(",","."))||0;return j>0?(N/j).toFixed(2):"0,00"},V=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},de=j=>{if(c.length>1){const N=[...c];N.splice(j,1),f(N)}},ue=j=>{const N=[...c];N[j].showDataWaznosci=!N[j].showDataWaznosci,f(N)},le=j=>{const N=j.target.files?.[0];console.log(" Product file selected:",N),N&&N.type==="application/pdf"?(g(N),console.log(" Product invoice set:",N.name)):console.log(" Invalid product file type:",N?.type)},pe=j=>{const N=j.target.files?.[0];console.log(" Transport file selected:",N),N&&N.type==="application/pdf"?(w(N),console.log(" Transport invoice set:",N.name)):console.log(" Invalid transport file type:",N?.type)},q=()=>{b.current?.click()},oe=()=>{k.current?.click()},B=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",h),console.log("productRows:",c),!r||!c.some(je=>je.kod&&je.nazwa&&je.ilosc&&je.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(je=>je.kod&&je.nazwa&&je.ilosc&&je.cena));return}const j=parseFloat(ee.replace(",","."))||1,N=c.reduce((je,Ke)=>je+(parseFloat(Ke.ilosc)||0),0),W=N>0?parseFloat(h.replace(",","."))/N*j:0,z=c.filter(je=>je.kod&&je.nazwa&&je.ilosc&&je.cena).map(je=>({kod:je.kod,nazwa:je.nazwa,kod_kreskowy:je.kod_kreskowy||"",ilosc:parseFloat(je.ilosc)||0,cena:parseFloat(je.cena.replace(",","."))||0,dataWaznosci:je.dataWaznosci?je.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:je.typ||void 0,objetosc:je.objetosc||void 0,deliveryCostPerUnitPln:W,podatekAkcyzowyPerLiter:parseFloat(F.replace(",","."))||0}));console.log("formattedProducts:",z);const O=z.reduce((je,Ke)=>je+Ke.ilosc*Ke.cena,0),se=parseFloat(h.replace(",","."))||0,L=parseFloat(U.replace(",","."))||0,Oe=O*(1-L/100);console.log("totalValue:",O),console.log("rabat:",L+"%"),console.log("wartoscZRabatem:",Oe),console.log("deliveryCost:",se),console.log(" Files to submit:",{productInvoice:m,transportInvoice:v}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:Oe,kosztDostawy:se,aktualnyKurs:ee,podatekAkcyzowy:F,rabat:U,products:z,productInvoice:m||null,transportInvoice:v||null}),re()},re=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),p(""),l(""),G("0,00"),H("0,00"),ae("0,00"),g(null),w(null),n()},I=()=>c.reduce((j,N)=>{const W=parseFloat(N.ilosc)||0,z=parseFloat(N.cena.replace(",","."))||0;return j+W*z},0).toFixed(2),P=(j,N)=>{const W=[...c];W[j].typ=N,f(W),D(null)},ce=j=>{D(C===j?null:j)},A=j=>{Y(E===j?null:j)},T=(j,N)=>{const W=[...c];W[j].objetosc=N,f(W),Y(null)};return S.useEffect(()=>{const j=W=>{const z=W.target;if(!z.closest(".react-datepicker")&&!z.closest('button[title*="wanoci"]')){const O=[...c];let se=!1;O.forEach(L=>{L.showDataWaznosci&&(L.showDataWaznosci=!1,se=!0)}),se&&f(O)}C!==null&&(z.closest(".dropdown-container")||D(null)),E!==null&&(z.closest(".dropdown-container")||Y(null))},N=W=>{W.key==="Escape"&&(D(null),Y(null))};return document.addEventListener("mousedown",j),document.addEventListener("keydown",N),()=>{document.removeEventListener("mousedown",j),document.removeEventListener("keydown",N)}},[C,E,c]),u.jsx(sr,{isOpen:e,onRequestClose:re,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),u.jsx("button",{onClick:re,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx(pn,{selected:r,onChange:j=>a(j),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:h,onKeyPress:j=>{const N=String.fromCharCode(j.which);(!/[\d,]/.test(N)||N===","&&j.target.value.includes(",")||j.target.value===""&&N===",")&&j.preventDefault()},onChange:j=>{const N=j.target,W=N.selectionStart??0;let z=N.value.replace(/[^\d,]/g,"");if(z===""){p("");return}if(!z.includes(","))z=z+",00";else{const[se,L]=z.split(",");L&&L.length>2&&(z=`${se},${L.slice(0,2)}`)}p(z),requestAnimationFrame(()=>{const se=Math.min(W,z.length);N.setSelectionRange(se,se)})},className:"w-[70%] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:le,className:"hidden",ref:b}),u.jsx("button",{type:"button",onClick:q,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(tp,{className:"h-4 w-4 text-gray-500"})}),m&&u.jsx("a",{href:URL.createObjectURL(m),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:m.name,children:m.name})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:pe,className:"hidden",ref:k}),u.jsx("button",{type:"button",onClick:oe,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Jf,{className:"h-4 w-4 text-gray-500"})}),v&&u.jsx("a",{href:URL.createObjectURL(v),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:v.name,children:v.name})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:o,onChange:j=>l(j.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[J().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:ee,onChange:j=>G(j.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:F,onChange:j=>H(j.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:U,onChange:j=>ae(j.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((j,N)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:j.kod,onChange:W=>{const z=[...c];z[N].kod=W.target.value,f(z)}}),N===c.length-1&&u.jsx("button",{onClick:V,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(Hn,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:j.nazwa,onChange:W=>{const z=[...c];z[N].nazwa=W.target.value,f(z)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:j.kod_kreskowy,onChange:W=>{const z=[...c];z[N].kod_kreskowy=W.target.value,f(z)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:j.ilosc,onChange:W=>{const z=[...c],O=W.target.value;(O===""||/^\d*$/.test(O))&&(z[N].ilosc=O,f(z))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:j.cena,onKeyPress:W=>{const z=String.fromCharCode(W.which);(!/[\d,]/.test(z)||z===","&&W.target.value.includes(",")||W.target.value===""&&z===",")&&W.preventDefault()},onChange:W=>{const z=W.target,O=z.selectionStart??0;let se=W.target.value.replace(/[^\d,]/g,"");if(se===""){const je=[...c];je[N].cena="",f(je);return}if(!se.includes(","))se=se+",00";else{const[je,Ke]=se.split(",");Ke&&Ke.length>2&&(se=`${je},${Ke.slice(0,2)}`)}const Oe=[...c];Oe[N].cena=se,f(Oe),requestAnimationFrame(()=>{const je=Math.min(O,se.length);z.setSelectionRange(je,je)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const W=parseFloat(j.ilosc)||0,z=parseFloat(j.cena.replace(",","."))||0;return(W*z).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>ue(N),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${j.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:j.dataWaznosci?`Termin wanoci: ${j.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(Zf,{size:16})}),u.jsx("button",{onClick:()=>de(N),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(Nt,{size:16})})]}),j.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx(pn,{selected:j.dataWaznosci,onChange:W=>{const z=[...c];z[N].dataWaznosci=W,z[N].showDataWaznosci=!1,f(z)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const W=[...c];W[N].showDataWaznosci=!1,f(W)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>ce(N),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${j.typ&&vf.find(W=>W.value===j.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:j.typ&&vf.find(W=>W.value===j.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),C===N&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:W=>W.stopPropagation(),children:vf.map(W=>u.jsx("button",{type:"button",onClick:()=>P(N,W.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${W.color}`,children:W.label},W.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${N>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>A(N),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${j.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:j.objetosc||"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E===N&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:W=>W.stopPropagation(),style:{maxWidth:"200px"},children:$A.map(W=>u.jsx("button",{type:"button",onClick:()=>T(N,W.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:W.label},W.value))})]})]})]},N))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[I().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(j=>j.kod&&j.nazwa&&j.ilosc&&j.cena)}),B()},disabled:!r||!c.some(j=>j.kod&&j.nazwa&&j.ilosc&&j.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(j=>j.kod&&j.nazwa&&j.ilosc&&j.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},YA=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilo"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilo"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsx("tr",{children:o.map((c,f)=>u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>u.jsx("tr",{children:c.map((h,p)=>u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:h},p))},f))})]})})},VA=({onSearch:e})=>{const[n,t]=S.useState(""),[r,a]=S.useState([]),[o,l]=S.useState(!1);return S.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),u.jsxs("div",{className:"w-full relative",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktw...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsxs("div",{className:"text-center py-4",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"adowanie..."})]})}):r.length>0?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:u.jsxs("table",{className:"w-full table-fixed",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),u.jsx("th",{className:"w-[70%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilo"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc})]},f))})]})}):n?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynik"})}):null]})};let KA={data:""},GA=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||KA,QA=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,XA=/\/\*[^]*?\*\/|  +/g,Ev=/\n+/g,Ns=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?Ns(l,o):o+"{"+Ns(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=Ns(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Ns.p?Ns.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},$a={},hw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+hw(e[t]);return n}return e},qA=(e,n,t,r,a)=>{let o=hw(e),l=$a[o]||($a[o]=(f=>{let h=0,p=11;for(;h<f.length;)p=101*p+f.charCodeAt(h++)>>>0;return"go"+p})(o));if(!$a[l]){let f=o!==e?e:(h=>{let p,m,g=[{}];for(;p=QA.exec(h.replace(XA,""));)p[4]?g.shift():p[3]?(m=p[3].replace(Ev," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][p[1]]=p[2].replace(Ev," ").trim();return g[0]})(e);$a[l]=Ns(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&$a.g?$a.g:null;return t&&($a.g=$a[l]),((f,h,p,m)=>{m?h.data=h.data.replace(m,f):h.data.indexOf(f)===-1&&(h.data=p?f+h.data:h.data+f)})($a[l],n,r,c),l},ZA=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":Ns(c,""):c===!1?"":c}return r+a+(l??"")},"");function ld(e){let n=this||{},t=e.call?e(n.p):e;return qA(t.unshift?t.raw?ZA(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,GA(n.target),n.g,n.o,n.k)}let xw,Kf,Gf;ld.bind({g:1});let es=ld.bind({k:1});function JA(e,n,t,r){Ns.p=n,xw=e,Kf=t,Gf=r}function Is(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Kf&&Kf()},c),t.o=/ *go\d+/.test(f),c.className=ld.apply(t,r)+(f?" "+f:"");let h=e;return e[0]&&(h=c.as||e,delete c.as),Gf&&h[0]&&Gf(c),xw(h,c)}return a}}var eO=e=>typeof e=="function",Gu=(e,n)=>eO(e)?e(n):e,tO=(()=>{let e=0;return()=>(++e).toString()})(),mw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),rO=20,gw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,rO)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return gw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},_u=[],no={toasts:[],pausedAt:void 0},Eo=e=>{no=gw(no,e),_u.forEach(n=>{n(no)})},nO={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},aO=(e={})=>{let[n,t]=S.useState(no),r=S.useRef(no);S.useEffect(()=>(r.current!==no&&t(no),_u.push(t),()=>{let o=_u.indexOf(t);o>-1&&_u.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||nO[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},sO=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||tO()}),Hl=e=>(n,t)=>{let r=sO(n,e,t);return Eo({type:2,toast:r}),r.id},on=(e,n)=>Hl("blank")(e,n);on.error=Hl("error");on.success=Hl("success");on.loading=Hl("loading");on.custom=Hl("custom");on.dismiss=e=>{Eo({type:3,toastId:e})};on.remove=e=>Eo({type:4,toastId:e});on.promise=(e,n,t)=>{let r=on.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?Gu(n.success,a):void 0;return o?on.success(o,{id:r,...t,...t?.success}):on.dismiss(r),a}).catch(a=>{let o=n.error?Gu(n.error,a):void 0;o?on.error(o,{id:r,...t,...t?.error}):on.dismiss(r)}),e};var oO=(e,n)=>{Eo({type:1,toast:{id:e,height:n}})},iO=()=>{Eo({type:5,time:Date.now()})},yl=new Map,lO=1e3,cO=(e,n=lO)=>{if(yl.has(e))return;let t=setTimeout(()=>{yl.delete(e),Eo({type:4,toastId:e})},n);yl.set(e,t)},uO=e=>{let{toasts:n,pausedAt:t}=aO(e);S.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&on.dismiss(c.id);return}return setTimeout(()=>on.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=S.useCallback(()=>{t&&Eo({type:6,time:Date.now()})},[t]),a=S.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:h}=l||{},p=n.filter(v=>(v.position||h)===(o.position||h)&&v.height),m=p.findIndex(v=>v.id===o.id),g=p.filter((v,w)=>w<m&&v.visible).length;return p.filter(v=>v.visible).slice(...c?[g+1]:[0,g]).reduce((v,w)=>v+(w.height||0)+f,0)},[n]);return S.useEffect(()=>{n.forEach(o=>{if(o.dismissed)cO(o.id,o.removeDelay);else{let l=yl.get(o.id);l&&(clearTimeout(l),yl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:oO,startPause:iO,endPause:r,calculateOffset:a}}},dO=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,fO=es`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,pO=es`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,hO=Is("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${fO} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${pO} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,xO=es`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,mO=Is("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${xO} 1s linear infinite;
`,gO=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,vO=es`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,yO=Is("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${gO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${vO} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,wO=Is("div")`
  position: absolute;
`,kO=Is("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,bO=es`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,_O=Is("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${bO} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,SO=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?S.createElement(_O,null,n):n:t==="blank"?null:S.createElement(kO,null,S.createElement(mO,{...r}),t!=="loading"&&S.createElement(wO,null,t==="error"?S.createElement(hO,{...r}):S.createElement(yO,{...r})))},EO=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,NO=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,CO="0%{opacity:0;} 100%{opacity:1;}",TO="0%{opacity:1;} 100%{opacity:0;}",DO=Is("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,FO=Is("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,jO=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=mw()?[CO,TO]:[EO(t),NO(t)];return{animation:n?`${es(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${es(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},PO=S.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?jO(e.position||n||"top-center",e.visible):{opacity:0},o=S.createElement(SO,{toast:e}),l=S.createElement(FO,{...e.ariaProps},Gu(e.message,e));return S.createElement(DO,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):S.createElement(S.Fragment,null,o,l))});JA(S.createElement);var AO=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=S.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return S.createElement("div",{ref:o,className:n,style:t},a)},OO=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:mw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},RO=ld`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,xu=16,zO=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=uO(t);return S.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:xu,left:xu,right:xu,bottom:xu,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(h=>{let p=h.position||n,m=f.calculateOffset(h,{reverseOrder:e,gutter:r,defaultPosition:n}),g=OO(p,m);return S.createElement(AO,{id:h.id,key:h.id,onHeightUpdate:f.updateHeight,className:h.visible?RO:"",style:g},h.type==="custom"?Gu(h.message,h):a?a(h):S.createElement(PO,{toast:h,position:p}))}))},He=on;Aa("pl",Oa);const MO=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log(" OrderModal render - isOpen:",e);const[r,a]=S.useState(null),[o,l]=S.useState(""),[c,f]=S.useState(""),[h,p]=S.useState([]),[m,g]=S.useState(null),[v,w]=S.useState(!1),[b,k]=S.useState([]),[C,D]=S.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[E,Y]=S.useState(null),[ee,G]=S.useState(!1),[F,H]=S.useState(!1),[U,ae]=S.useState(null),[J,V]=S.useState(new Set),de=S.useRef(null),ue=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],le=()=>{const A=Math.max(...C.map(T=>T.id))+1;D([...C,{id:A,searchQuery:"",selectedProduct:null,typ:""}])},pe=A=>{C.length>1&&D(T=>T.filter(j=>j.id!==A))},q=()=>{console.log(" OrderModal handleClose called"),a(null),l(""),f(""),p([]),g(null),k([]),D([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),Y(null),G(!1),H(!1),ae(null),V(new Set),de.current=null,n()};S.useEffect(()=>{e&&(console.log(" OrderModal opened - clearing state"),a(null),l(""),f(""),p([]),g(null),k([]),D([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),Y(null),G(!1),H(!1),ae(null),V(new Set),de.current=null)},[e]),S.useEffect(()=>{const T=setTimeout(async()=>{if(c.trim().length<2){p([]);return}w(!0);try{const j=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!j.ok)throw new Error("Failed to fetch clients");const N=await j.json();p(N)}catch(j){console.error("Error searching clients:",j),p([])}finally{w(!1)}},300);return()=>clearTimeout(T)},[c]),S.useEffect(()=>{const T=setTimeout(async()=>{if(E===null||!C.find(j=>j.id===E)?.searchQuery.trim()){k([]);return}G(!0);try{const j=C.find(se=>se.id===E)?.searchQuery||"",N=m?`/api/working-sheets/search?query=${encodeURIComponent(j)}&client_id=${m.id}`:`/api/working-sheets/search?query=${encodeURIComponent(j)}`,W=await fetch(N);if(!W.ok)throw new Error("Failed to fetch products");const O=(await W.json()).map(se=>({kod:se.kod,nazwa:se.nazwa,ilosc:se.ilosc.toString(),kodKreskowy:"",selectedQuantity:0,ilosc_reserved:se.ilosc_reserved||0,ilosc_client_reserved:se.ilosc_client_reserved||0}));k(O)}catch(j){console.error("Error searching products:",j),k([])}finally{G(!1)}},300);return()=>clearTimeout(T)},[C,E,m]),S.useEffect(()=>{const A=j=>{const N=j.target;U!==null&&(N.closest(".dropdown-container")||ae(null))},T=j=>{j.key==="Escape"&&ae(null)};return U!==null&&(document.addEventListener("mousedown",A),document.addEventListener("keydown",T)),()=>{document.removeEventListener("mousedown",A),document.removeEventListener("keydown",T)}},[U]);const oe=(A,T)=>{console.log(" handleProductSelect called for fieldId:",A,"product:",T.kod),D(j=>j.map(W=>W.id===A?{...W,selectedProduct:T,searchQuery:`${T.kod} - ${T.nazwa.includes(" (samples)")?T.nazwa.replace(" (samples)","")+" (samples)":T.nazwa}`}:W)),k([]),Y(null),console.log(" Products list cleared, activeSearchId reset")},B=A=>{ae(U===A?null:A)},re=(A,T)=>{D(j=>j.map(N=>N.id===A?{...N,typ:T}:N)),ae(null)},I=()=>C.filter(A=>A.selectedProduct).reduce((A,T)=>{const j=T.selectedProduct?.selectedQuantity||0;return A+j},0),P=()=>{if(!r||!o.trim()||!m)return!1;const A=C.filter(j=>j.selectedProduct);return!(A.length===0||A.some(j=>!j.selectedProduct?.selectedQuantity||j.selectedProduct.selectedQuantity<=0)||A.some(j=>!j.typ)||Array.from(J).some(j=>{const W=C.find(z=>z.id===j)?.selectedProduct;return W?(W.ilosc_client_reserved||0)===0:!1}))},ce=async()=>{const A=C.filter(z=>z.selectedProduct).map(z=>({kod:z.selectedProduct.kod,nazwa:z.selectedProduct.nazwa,ilosc:z.selectedProduct.selectedQuantity||0,typ:z.typ}));if(!r){He.error("Wybierz dat zamwienia");return}if(!o.trim()){He.error("Wprowad numer zamwienia");return}if(!m){He.error("Wybierz klienta");return}if(A.length===0){He.error("Dodaj produkty");return}if(A.some(z=>!z.ilosc)){He.error("Wprowad ilo dla wszystkich produktw");return}if(A.some(z=>!z.typ)){He.error("Wybierz typ dla wszystkich produktw");return}V(new Set);const T=r.getDate().toString().padStart(2,"0"),j=(r.getMonth()+1).toString().padStart(2,"0"),N=r.getFullYear(),W=`${o.trim()}_${T}_${j}_${N}`;H(!0);try{const z=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:m.nazwa,order_number:W,products:A})});if(!z.ok){const O=await z.json();if(z.status===400&&O.error.includes("Insufficient quantity")){const se=O.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(se){const[,L,Oe,je]=se;He.error(`Niewystarczajca ilo produktu ${L}. Dostpne: ${Oe}, Zamwione: ${je}`)}else He.error(O.error)}else throw new Error("Failed to create order");return}He.success("Zamwienie zostao dodane"),q(),t&&t()}catch(z){console.error("Error creating order:",z),He.error("Wystpi bd podczas dodawania zamwienia")}finally{H(!1)}};return u.jsx(sr,{isOpen:e,onRequestClose:q,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamwienia"}),u.jsx("button",{onClick:q,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx(pn,{selected:r,onChange:A=>a(A),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px] ml-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsx("input",{type:"text",value:o,onChange:A=>l(A.target.value),placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:c,onChange:A=>f(A.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),v&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),h.length>0&&!m&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:h.map(A=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(A),f(A.nazwa),p([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:A.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:A.firma})]})},A.id))})]}),m&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.firma})]}),m.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.adres})]}),m.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.kontakt})]})]}),u.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Nt,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),C.map(A=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:A.searchQuery,onChange:T=>{const j=T.target.value;console.log(" Product search input changed for fieldId:",A.id,"value:",j),D(N=>N.map(W=>W.id===A.id?{...W,searchQuery:j,selectedProduct:null}:W)),Y(A.id)},onFocus:()=>Y(A.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:A.selectedProduct?.selectedQuantity||"",onChange:T=>{const j=T.target.value,N=j===""?0:Math.max(1,parseInt(j)||0);D(W=>{const z=W.map(se=>se.id===A.id&&se.selectedProduct?{...se,selectedProduct:{...se.selectedProduct,selectedQuantity:N}}:se);de.current=null;const O=z.find(se=>se.id===A.id);if(O?.selectedProduct){const se=O.selectedProduct.kod,L=parseInt(O.selectedProduct.ilosc)||0,Oe=O.selectedProduct.ilosc_reserved||0,je=O.selectedProduct.ilosc_client_reserved||0,Ke=z.filter(_e=>_e.selectedProduct?.kod===se),Qe=Ke.reduce((_e,Je)=>_e+(Je.selectedProduct?.selectedQuantity||0),0),he=Ke.length>1;let Ne,Pe;je>0?(Ne=je,Pe=!0):(Ne=Math.max(0,L-Oe),Pe=!1),N===0?V(_e=>{const Je=new Set(_e);return Je.delete(A.id),Je}):Qe>Ne?(V(_e=>{const Je=new Set(_e);return Je.add(A.id),Je}),Pe?he?He.error(`Przekroczono ilo w rezerwacji towaru. cznie w zamwieniu: ${Qe} szt., dostpne w rezerwacji: ${Ne} szt.`):He.error(`Przekroczono ilo w rezerwacji towaru. Dostpne: ${Ne} szt.`):Oe>0?he?He.error(`Niewystarczajca ilo towaru - cznie w zamwieniu: ${Qe}, dostpne: ${Ne} (na magazynie: ${L}, z nich w rezerwacji: ${Oe})`):He.error(`Niewystarczajca ilo towaru - dostpne: ${Ne} (na magazynie: ${L}, z nich w rezerwacji: ${Oe})`):he?He.error(`Niewystarczajca ilo towaru - cznie w zamwieniu: ${Qe}, dostpne: ${Ne} (na magazynie: ${L})`):He.error(`Niewystarczajca ilo towaru - dostpne: ${Ne} (na magazynie: ${L})`)):V(_e=>{const Je=new Set(_e);return Je.delete(A.id),Je})}else V(se=>{const L=new Set(se);return L.delete(A.id),L});return z})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${J.has(A.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>B(A.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${A.typ&&ue.find(T=>T.value===A.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:A.typ&&ue.find(T=>T.value===A.typ)?.label||"Typ"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),U===A.id&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:T=>T.stopPropagation(),children:ue.map(T=>u.jsx("button",{type:"button",onClick:()=>re(A.id,T.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${T.color}`,children:T.label},T.value))})]}),C.length>1&&u.jsx("button",{onClick:()=>pe(A.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Nt,{size:16})})]}),A.id===Math.max(...C.map(T=>T.id))&&u.jsx("button",{onClick:le,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),ee&&E===A.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),b.length>0&&E===A.id&&!A.selectedProduct&&A.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:b.map((T,j)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>oe(A.id,{...T,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.kod}),T.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:T.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:T.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",T.ilosc]}),(T.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",T.ilosc_reserved??0]})]})},`${T.kod}-${T.nazwa||""}-${j}`))})]},A.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:ce,disabled:F||!P(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${F||!P()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:F?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:I()})]})]})})},IO=({isOpen:e,onClose:n,order:t})=>{const[r,a]=S.useState(null),[o,l]=S.useState(null),[c,f]=S.useState(!1),h=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],p=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}];S.useEffect(()=>{e&&t&&(m(),g())},[e,t]);const m=async()=>{if(t){f(!0);try{const k=await fetch(`/api/orders/${t.id}`);if(!k.ok)throw new Error("Failed to load order details");const C=await k.json();a(C)}catch(k){console.error("Error loading order details:",k)}finally{f(!1)}}},g=async()=>{if(t)try{const k=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(k.ok){const C=await k.json();l(C)}}catch(k){console.error("Error loading client data:",k)}},v=k=>new Date(k).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const w=r||t,b=async()=>{if(!(!t||!w))try{const k=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!k.ok)throw new Error("Failed to generate PDF");const C=await k.blob(),D=window.URL.createObjectURL(C),E=document.createElement("a");E.href=D;const Y=o?o.nazwa:w.klient,ee=`${Y}_${w.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",Y),console.log("Order number:",w.numer_zamowienia),console.log("Generated filename:",ee),E.download=ee,document.body.appendChild(E),E.click(),window.URL.revokeObjectURL(D),document.body.removeChild(E)}catch(k){console.error("Error generating PDF:",k),alert("Bd podczas generowania PDF")}};return u.jsx(sr,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:w.typ==="odpisanie"?"Szczegy odpisania":"Szczegy zamwienia"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:w.typ==="odpisanie"?"Numer odpisania:":"Numer zamwienia:"}),u.jsx("p",{className:"text-sm font-bold text-gray-900",children:w.numer_zamowienia})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),u.jsx("p",{className:"text-gray-900",children:v(w.data_utworzenia||"")})]})]})}),o&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:w.typ==="odpisanie"?"Produkty w odpisaniu":"Produkty w zamwieniu"}),w.products&&w.products.length>0?u.jsx("div",{children:u.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:w.typ==="odpisanie"?"Powd":"Typ"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.products.map(k=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:k.kod}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:k.nazwa})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:k.kod_kreskowy||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:k.ilosc}),u.jsx("td",{className:"px-4 py-2 text-xs w-20",children:k.typ?u.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${w.typ==="odpisanie"?p.find(C=>C.value===k.typ)?.color:h.find(C=>C.value===k.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:w.typ==="odpisanie"?p.find(C=>C.value===k.typ)?.label||k.typ:h.find(C=>C.value===k.typ)?.label||k.typ}):u.jsx("span",{className:"text-gray-500",children:"-"})})]},k.id))})]})}):u.jsx("p",{className:"text-xs text-gray-500",children:w.typ==="odpisanie"?"Brak produktw w odpisaniu":"Brak produktw w zamwieniu"})]})]})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:w.laczna_ilosc})]}),u.jsx("div",{className:"absolute bottom-4 left-4",children:u.jsx("button",{onClick:b,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};Aa("pl",Oa);const yf=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],wf=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}],LO=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=S.useState(""),[l,c]=S.useState(""),[f,h]=S.useState(""),[p,m]=S.useState(null),[g,v]=S.useState([{kod:"",nazwa:"",ilosc:"",typ:""}]),[w,b]=S.useState(null),[k,C]=S.useState(""),[D,E]=S.useState([]),[Y,ee]=S.useState(!1),[G,F]=S.useState(null),[H,U]=S.useState([]),[ae,J]=S.useState(!1),[V,de]=S.useState(null),[ue,le]=S.useState(new Set),pe=async(T,j)=>{try{const N=T.map(z=>z.kod).filter(z=>z.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",N),console.log("Client ID for reservations:",j),N.length===0)return;const W=[];for(const z of N){const O=j?`/api/working-sheets/search?query=${encodeURIComponent(z)}&client_id=${j}`:`/api/working-sheets/search?query=${encodeURIComponent(z)}`,se=await fetch(O);if(!se.ok)continue;const Oe=(await se.json()).find(je=>je.kod===z);Oe&&(W.push(Oe),console.log(`Found product for ${z}:`,Oe))}console.log("Found products with reservations:",W),E(W),v(z=>z.map(O=>{const se=W.find(L=>L.kod===O.kod);return se?{...O,availableQuantity:parseInt(se.ilosc)||0,ilosc_reserved:se.ilosc_reserved||0,ilosc_client_reserved:se.ilosc_client_reserved||0,originalIlosc:parseInt(O.ilosc)||0}:O})),console.log(" Final loaded products info for order editing:",W)}catch(N){console.error(" Error loading products info:",N)}};S.useEffect(()=>{if(e&&r){if(o(r.klient),C(r.klient),r.typ==="odpisanie"){const j=r.numer_zamowienia.match(/^(OP\d+)/);j?h(j[1]):fetch("/api/writeoffs/next-number-only").then(N=>{if(!N.ok)throw new Error("Failed to fetch next number");return N.json()}).then(N=>{N.numer_odpisania?h(N.numer_odpisania):h("OP001")}).catch(N=>{console.error(" Error fetching next write-off number:",N),h("OP001")})}if(c(r.numer_zamowienia),r.data_utworzenia){const j=new Date(r.data_utworzenia);m(j),console.log(" Loaded order date:",j)}else m(null);const T=r.products&&r.products.length>0?r.products.map(j=>({kod:j.kod||"",nazwa:j.nazwa||"",ilosc:(j.ilosc||0).toString(),typ:j.typ||"",originalIlosc:j.ilosc||0})):[{kod:"",nazwa:"",ilosc:"",typ:""}];console.log("Order products from backend:",r.products),console.log("Formatted products:",T),v(T),r.klient&&r.typ!=="odpisanie"?fetch(`/api/clients/search?q=${encodeURIComponent(r.klient)}`).then(j=>j.ok?j.json():[]).then(j=>{const N=j.find(W=>W.nazwa?.toLowerCase()===r.klient.toLowerCase());N?(de(N),console.log(" Loaded client with id:",N.id),T.length>0&&T[0].kod&&pe(T,N.id)):(de({nazwa:r.klient}),T.length>0&&T[0].kod&&pe(T))}).catch(j=>{console.error(" Error loading client:",j),de({nazwa:r.klient}),T.length>0&&T[0].kod&&pe(T)}):(de({nazwa:r.klient}),T.length>0&&T[0].kod&&pe(T))}else h("")},[e,r]),S.useEffect(()=>{if(r?.typ==="odpisanie"&&f&&p){const T=String(p.getDate()).padStart(2,"0"),j=String(p.getMonth()+1).padStart(2,"0"),N=p.getFullYear(),W=`${f}_${T}_${j}_${N}`;c(W)}},[f,p,r?.typ]),S.useEffect(()=>{const j=setTimeout(async()=>{if(G===null||!g.find((N,W)=>W===G)?.nazwa.trim()){E([]);return}ee(!0);try{const N=g.find((L,Oe)=>Oe===G)?.nazwa||"";if(!N.trim()){E([]),ee(!1);return}const W=V?.id?`/api/working-sheets/search?query=${encodeURIComponent(N)}&client_id=${V.id}`:`/api/working-sheets/search?query=${encodeURIComponent(N)}`,z=await fetch(W);if(!z.ok)throw new Error("Failed to fetch products");const se=(await z.json()).map(L=>({kod:L.kod,nazwa:L.nazwa||"",ilosc:L.ilosc?L.ilosc.toString():"0",status:L.status||null,ilosc_reserved:L.ilosc_reserved||0,ilosc_client_reserved:L.ilosc_client_reserved||0}));E(se)}catch(N){console.error("Error searching products:",N),E([])}finally{ee(!1)}},300);return()=>clearTimeout(j)},[g,G,V]),S.useEffect(()=>{const j=setTimeout(async()=>{if(k.trim().length<2){U([]);return}J(!0);try{const N=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!N.ok)throw new Error("Failed to fetch clients");const W=await N.json();U(W)}catch(N){console.error("Error searching clients:",N),U([])}finally{J(!1)}},300);return()=>clearTimeout(j)},[k]),S.useEffect(()=>{const T=N=>{const W=N.target;w!==null&&(W.closest(".dropdown-container")||b(null))},j=N=>{N.key==="Escape"&&b(null)};return w!==null&&(document.addEventListener("mousedown",T),document.addEventListener("keydown",j)),()=>{document.removeEventListener("mousedown",T),document.removeEventListener("keydown",j)}},[w]);const q=()=>{v([...g,{kod:"",nazwa:"",ilosc:"",typ:""}])},oe=T=>{g.length>1&&v(g.filter((j,N)=>N!==T))},B=(T,j)=>{const N=[...g];N[T].typ=j,v(N),b(null)},re=T=>{b(w===T?null:T)},I=(T,j)=>{console.log(" EditOrderModal handleProductSelect called for index:",T,"product:",j.kod),console.log(" Product data:",j);const N=[...g];N[T]={...N[T],kod:j.kod,nazwa:j.nazwa,typ:j.typ||"sztuki",availableQuantity:parseInt(j.ilosc)||0,ilosc_reserved:j.ilosc_reserved||0,ilosc_client_reserved:j.ilosc_client_reserved||0,originalIlosc:0},v(N);const W=[...D],z=W.findIndex(O=>O.kod===j.kod);z>=0?W[z]=j:W.push(j),E(W),F(null),console.log(" EditOrderModal Products list cleared, activeSearchId reset")},P=async(T,j)=>{const N=new Set;for(let W=0;W<T.length;W++){const z=T[W],O=parseInt(z.ilosc)||0,se=g.findIndex(Je=>Je.kod===z.kod&&Je.nazwa===z.nazwa&&Je.ilosc===z.ilosc);if(se===-1){console.warn(` Could not find actual index for product ${z.kod}`);continue}const L=g[se],Oe=j.find(Je=>Je.kod===z.kod),je=Oe?.ilosc||L.availableQuantity||0,Ke=Oe?.ilosc_reserved||L.ilosc_reserved||0,Qe=Oe?.ilosc_client_reserved||L.ilosc_client_reserved||0,he=r?.products?.find(Je=>Je.kod===z.kod),Ne=he&&he.ilosc||0,Pe=je+Ne;let _e;if(Qe>0){const Je=Pe-Ke;_e=Qe+Math.max(0,Je)}else _e=Pe-Ke;console.log(`Product ${se} (valid index ${W}):`,{kod:z.kod,requested:O,totalOnStock:je,originalQuantityInOrder:Ne,availableForEdit:Pe,reservedQuantity:Ke,clientReservedQuantity:Qe,maxAllowed:_e,hasError:O>_e}),O>_e&&(N.add(se),console.log(` Error for product ${se}: requested ${O} > maxAllowed ${_e}`),Qe>0?He.error(`Produkt ${z.kod}: przekroczono ilo w rezerwacji. Dostpne: ${_e} szt.`):Ke>0?He.error(`Produkt ${z.kod}: niewystarczajca ilo - dostpne: ${_e} (na magazynie: ${Pe}, z nich w rezerwacji: ${Ke})`):He.error(`Produkt ${z.kod}: niewystarczajca ilo - dostpne: ${_e}`))}return N},ce=async T=>{if(T.preventDefault(),!r)return;if(!a.trim()){He.error("Wprowad nazw klienta");return}if(!l.trim()){He.error(r?.typ==="odpisanie"?"Wprowad numer odpisania":"Wprowad numer zamwienia");return}const j=g.filter(z=>z.kod.trim()&&z.nazwa.trim()&&z.ilosc.trim()&&z.typ.trim());if(j.length===0){He.error(r?.typ==="odpisanie"?"Dodaj produkty do odpisania":"Dodaj produkty do zamwienia");return}if(j.some(z=>!z.ilosc||!z.typ)){He.error("Wprowad ilo i typ dla wszystkich produktw");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",j),console.log("products (stock info):",D),console.log("products.length:",D.length),D.length===0){console.log(" Products info is empty, reloading...");try{const z=await fetch("/api/working-sheets");if(z.ok){const O=await z.json();console.log("Reloaded all products:",O),E(O);const se=await P(j,O);if(se.size>0){le(se);return}else le(new Set);console.log(" Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),He.error("Bd podczas adowania informacji o produktach");return}}catch(z){console.error("Error reloading products:",z),He.error("Bd podczas adowania informacji o produktach");return}}const N=await P(j,D);if(N.size>0){le(N);return}else le(new Set);const W=j.map(z=>({kod:z.kod,nazwa:z.nazwa,ilosc:parseInt(z.ilosc)||0,typ:z.typ}));console.log("Sending products data:",W);try{const z=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:W})});if(!z.ok){const O=await z.json();throw new Error(O.error||"Failed to update order")}He.success(r?.typ==="odpisanie"?"Odpisanie zostao zaktualizowane":"Zamwienie zostao zaktualizowane"),A(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:W})}catch(z){console.error("Error updating order:",z),He.error("Wystpi bd podczas aktualizacji zamwienia")}},A=()=>{o(""),C(""),de(null),U([]),c(""),m(null),v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),b(null),E([]),F(null),n()};return r?u.jsx(sr,{isOpen:e,onRequestClose:A,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:r?.typ==="odpisanie"?"Edytuj odpisanie":"Edytuj zamwienie"}),u.jsx("button",{type:"button",onClick:A,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("form",{onSubmit:ce,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex space-x-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx(pn,{selected:p,onChange:T=>m(T),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:r?.typ==="odpisanie"?"Numer odpisania":"Numer zamwienia"}),u.jsx("input",{type:"text",value:l,onChange:T=>c(T.target.value),readOnly:r?.typ==="odpisanie",placeholder:r?.typ==="odpisanie"?"Wprowad numer odpisania":"Wprowad numer zamwienia",className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${r?.typ==="odpisanie"?"bg-gray-100":""}`})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),r?.typ==="odpisanie"?u.jsx("input",{type:"text",value:"VEIS",readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100"}):u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:k,onChange:T=>C(T.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),r?.typ!=="odpisanie"&&ae&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),r?.typ!=="odpisanie"&&H.length>0&&!V&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:H.map(T=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{de(T),C(T.nazwa),o(T.nazwa),U([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:T.firma})]})},T.id))})]}),r?.typ!=="odpisanie"&&V&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:V.nazwa})]}),V.firma&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:V.firma})]}),V.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:V.adres})]}),V.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:V.kontakt})]})]}),u.jsx("button",{type:"button",onClick:()=>{de(null),C(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Nt,{size:16})})]})})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),g.map((T,j)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:`relative flex-1 ${r?.typ==="odpisanie"?"max-w-[65%]":"max-w-[70%]"}`,children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:T.nazwa,onChange:N=>{const W=N.target.value;console.log(" EditOrderModal Product search input changed for index:",j,"value:",W);const z=[...g];z[j].nazwa=W,v(z),F(j)},onFocus:()=>F(j),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:T.ilosc,onChange:N=>{const W=N.target.value,z=parseInt(W)||0,O=[...g];if(O[j].ilosc=W,v(O),r?.typ!=="odpisanie"&&T.kod){const se=T.originalIlosc||0,L=T.availableQuantity||0,Oe=T.ilosc_reserved||0,je=T.ilosc_client_reserved||0,Ke=L+se;let Qe,he=!1;if(je>0){const Ne=Ke-Oe;Qe=je+Math.max(0,Ne),he=!0}else Qe=Ke-Oe;z>Qe?(le(Ne=>{const Pe=new Set(Ne);return Pe.add(j),Pe}),he?He.error(`Przekroczono ilo w rezerwacji. Dostpne: ${Qe} szt.`):Oe>0?He.error(`Niewystarczajca ilo - dostpne: ${Qe} (na magazynie: ${Ke}, z nich w rezerwacji: ${Oe})`):He.error(`Niewystarczajca ilo - dostpne: ${Qe} (na magazynie: ${Ke})`)):le(Ne=>{const Pe=new Set(Ne);return Pe.delete(j),Pe})}else if(ue.has(j)){const se=new Set(ue);se.delete(j),le(se)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${ue.has(j)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:`${r?.typ==="odpisanie"?"w-32":"w-24"} ml-2 relative dropdown-container`,children:[u.jsxs("button",{type:"button",onClick:()=>re(j),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${T.typ&&(r?.typ==="odpisanie"?wf.find(N=>N.value===T.typ)?.color:yf.find(N=>N.value===T.typ)?.color)||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:T.typ&&(r?.typ==="odpisanie"?wf.find(N=>N.value===T.typ)?.label:yf.find(N=>N.value===T.typ)?.label)||(r?.typ==="odpisanie"?"Powd":"Typ")}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w===j&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:N=>N.stopPropagation(),children:(r?.typ==="odpisanie"?wf:yf).map(N=>u.jsx("button",{type:"button",onClick:()=>B(j,N.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${N.color}`,children:N.label},N.value))})]}),g.length>1&&u.jsx("button",{type:"button",onClick:()=>oe(j),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Nt,{size:16})})]}),j===g.length-1&&u.jsx("button",{type:"button",onClick:q,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),Y&&G===j&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),D.length>0&&G===j&&T.nazwa.trim()&&u.jsx("div",{className:`absolute z-50 mt-1 ${r?.typ==="odpisanie"?"w-[65%]":"w-[70%]"} bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200`,children:D.map(N=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>I(j,N),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:N.kod}),N.nazwa&&N.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:N.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:N.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",N.ilosc]}),(N.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",N.ilosc_reserved??0]})]})},N.kod))})]},j))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:A,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:ce,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null};Aa("pl",Oa);const BO=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const r=parseInt(t[1],10),a=parseInt(t[2],10)-1,o=parseInt(t[3],10),l=new Date(o,a,r);if(!isNaN(l.getTime()))return l}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},WO=[{value:0,label:"0%"},{value:5,label:"5%"},{value:8,label:"8%"},{value:23,label:"23%"}],UO=({isOpen:e,onClose:n,onSuccess:t,orderData:r})=>{const[a,o]=S.useState(null),[l,c]=S.useState(null),[f,h]=S.useState(""),[p,m]=S.useState(""),[g,v]=S.useState(""),[w,b]=S.useState([{kod:"",nazwa:"",ilosc:"",cena_netto:"",rabat:"",vat:23}]),[k,C]=S.useState(0),[D,E]=S.useState(!1),[Y,ee]=S.useState(null),[G,F]=S.useState([]),[H,U]=S.useState(null),[ae,J]=S.useState(!1),V=async()=>{try{const N=await fetch("/api/working-sheets");if(!N.ok){console.error(" Failed to fetch working sheets");return}const W=await N.json(),z=new Map;W.forEach(O=>{if(O.kod&&O.cena_sprzedazy!==null&&O.cena_sprzedazy!==void 0){const se=Number(O.cena_sprzedazy);isNaN(se)||z.set(O.kod,se)}}),b(O=>O.map(se=>{if(se.kod&&z.has(se.kod)){const L=z.get(se.kod),Oe=L%1===0?`${L.toFixed(0)},00`:L.toFixed(2).replace(".",",");return{...se,cena_netto:Oe}}return se})),console.log(" Prices loaded from working_sheets")}catch(N){console.error(" Error loading prices from working_sheets:",N)}};S.useEffect(()=>{if(e)if(fetch("/api/invoices/next-number-only").then(N=>{if(!N.ok)throw new Error("Failed to fetch next number");return N.json()}).then(N=>{N.numer_faktury?(h(N.numer_faktury),console.log(" Set invoice base number to:",N.numer_faktury)):h("001")}).catch(N=>{console.error(" Error fetching next invoice number:",N),h("001")}),r){v(r.klient);const W=BO(r.numer_zamowienia)||new Date;if(o(W),c(W),r.products&&r.products.length>0){const z=r.products.filter(O=>O.typ==="sprzedaz"||O.typ==="probka");if(z.length>0){const O=z.map(se=>({kod:se.kod,nazwa:se.nazwa,ilosc:se.ilosc.toString(),cena_netto:"",rabat:se.typ==="probka"?"30":"",vat:23}));b(O),C(O.length),V()}}}else{const N=new Date;o(N),c(N)}else o(null),c(null),h(""),m(""),v(""),b([{kod:"",nazwa:"",ilosc:"",cena_netto:"",rabat:"",vat:23}]),C(0)},[e,r]),S.useEffect(()=>{if(f&&a){const N=a.getMonth()+1,W=a.getFullYear(),z=`FV ${f}/${N}/${W}`;m(z)}else if(f&&!a){const N=new Date().getMonth()+1,W=new Date().getFullYear(),z=`FV ${f}/${N}/${W}`;m(z)}},[f,a]),S.useEffect(()=>{const N=z=>{const O=z.target;Y!==null&&(O.closest(".dropdown-container")||ee(null)),H!==null&&(O.closest(".product-search-container")||(U(null),F([])))},W=z=>{z.key==="Escape"&&(ee(null),U(null),F([]))};return document.addEventListener("mousedown",N),document.addEventListener("keydown",W),()=>{document.removeEventListener("mousedown",N),document.removeEventListener("keydown",W)}},[Y,H]),S.useEffect(()=>{const W=setTimeout(async()=>{if(H===null||H<k){F([]);return}const O=w[H]?.searchQuery||"";if(O.trim().length<1){F([]);return}J(!0);try{const se=await fetch(`/api/working-sheets/search-simple?query=${encodeURIComponent(O)}`);if(!se.ok)throw new Error("Failed to fetch products");const Oe=(await se.json()).map(je=>({kod:je.kod,nazwa:je.nazwa,cena_sprzedazy:je.cena_sprzedazy}));F(Oe)}catch(se){console.error("Error searching products:",se),F([])}finally{J(!1)}},300);return()=>clearTimeout(W)},[H,w,k]);const de=()=>{b([...w,{kod:"",nazwa:"",ilosc:"",cena_netto:"",rabat:"",vat:23,searchQuery:""}])},ue=N=>{if(!(N<k)&&w.length>1){const W=[...w];W.splice(N,1),b(W)}},le=N=>{ee(Y===N?null:N)},pe=(N,W)=>{const z=[...w];z[N].vat=W,b(z),ee(null)},q=(N,W)=>{const z=[...w],O=W.cena_sprzedazy,se=O!=null?O%1===0?`${O.toFixed(0)},00`:O.toFixed(2).replace(".",","):"";z[N]={...z[N],kod:W.kod,nazwa:W.nazwa,cena_netto:se,searchQuery:`${W.kod} - ${W.nazwa}`},b(z),F([]),U(null)},oe=N=>{const W=parseFloat(N.ilosc)||0,z=parseFloat(N.cena_netto.replace(",","."))||0,O=parseFloat(N.rabat.replace(",","."))||0;return W*z*(1-O/100)},B=N=>{const W=parseFloat(N.ilosc)||0,z=parseFloat(N.cena_netto.replace(",","."))||0,O=parseFloat(N.rabat.replace(",","."))||0;return W*z*(O/100)},re=()=>w.reduce((N,W)=>N+B(W),0).toFixed(2),I=N=>oe(N)*(1+N.vat/100),P=()=>w.reduce((N,W)=>N+oe(W),0).toFixed(2),ce=()=>w.reduce((N,W)=>{const z=oe(W),O=I(W);return N+(O-z)},0).toFixed(2),A=()=>w.reduce((N,W)=>N+I(W),0).toFixed(2),T=async()=>{if(!a||!g||!w.some(N=>N.nazwa&&N.ilosc&&N.cena_netto)){He.error("Prosz wypeni wszystkie wymagane pola");return}E(!0);try{const N=w.filter(O=>O.nazwa&&O.ilosc&&O.cena_netto).map(O=>({kod:O.kod,nazwa:O.nazwa,ilosc:parseFloat(O.ilosc)||0,cena_netto:parseFloat(O.cena_netto.replace(",","."))||0,rabat:parseFloat(O.rabat.replace(",","."))||0,vat:O.vat})),W={data_faktury:a.toLocaleDateString("en-CA"),numer_faktury:p,klient:g,order_id:r?.id??void 0,numer_zamowienia:r?.numer_zamowienia??void 0,termin_platnosci:l?l.toLocaleDateString("en-CA"):void 0,products:N,suma_netto:parseFloat(P()),suma_vat:parseFloat(ce()),total:parseFloat(A()),rabat_suma:parseFloat(re())},z=await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)});if(!z.ok){const O=await z.json().catch(()=>({}));throw new Error(O.error||`HTTP ${z.status}`)}He.success(`Faktura zostaa utworzona: ${p}`),t?.(),j()}catch(N){console.error("Error creating invoice:",N),He.error(N instanceof Error?N.message:"Bd podczas tworzenia faktury")}finally{E(!1)}},j=()=>{o(null),c(null),h(""),m(""),v(""),b([{kod:"",nazwa:"",ilosc:"",cena_netto:"",rabat:"",vat:23}]),C(0),E(!1),ee(null),F([]),U(null),J(!1),n()};return u.jsx(sr,{isOpen:e,onRequestClose:j,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Utwrz faktur VAT"}),u.jsx("button",{onClick:j,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[120px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data faktury"}),u.jsx(pn,{selected:a,onChange:N=>o(N),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-center",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[123px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer faktury"}),u.jsx("input",{type:"text",value:p,onChange:N=>m(N.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"FV XXX/M/YYYY"})]}),u.jsxs("div",{className:"w-[250px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsx("input",{type:"text",value:g,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed",placeholder:"Nazwa klienta"})]}),u.jsxs("div",{className:"w-[120px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Termin patnoci"}),u.jsx(pn,{selected:l,onChange:N=>c(N),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-center",placeholderText:"Wybierz dat",popperClassName:"z-50"})]})]})}),u.jsx("div",{className:`space-y-2 pb-8 ${w.length>=8?"overflow-y-auto max-h-[280px] pr-2":"overflow-visible"}`,children:w.map((N,W)=>u.jsxs("div",{className:"relative product-search-container",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[38%]",children:[W===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),W<k?u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed",placeholder:"Nazwa produktu",value:N.nazwa,readOnly:!0}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",style:{top:W===0?"28px":"0"},children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Wyszukaj produkt...",value:N.searchQuery||N.nazwa,onChange:z=>{const O=[...w];O[W].searchQuery=z.target.value,O[W].nazwa="",O[W].kod="",O[W].cena_netto="",b(O),U(W)},onFocus:()=>U(W)}),ae&&H===W&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",style:{top:W===0?"calc(50% + 14px)":"50%"},children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),G.length>0&&H===W&&(N.searchQuery?.trim()||"")&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:G.map((z,O)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>q(W,z),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:z.kod}),u.jsx("span",{className:"text-[10px] text-gray-500",children:z.nazwa})]})},`${z.kod}-${O}`))})]})]}),u.jsxs("div",{className:"w-16 ml-2",children:[W===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Ilo"}),u.jsx("input",{type:"number",className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${W<k?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,placeholder:"0",value:N.ilosc,readOnly:W<k,onChange:z=>{const O=[...w],se=z.target.value;(se===""||/^\d*$/.test(se))&&(O[W].ilosc=se,b(O))}})]}),u.jsxs("div",{className:"w-24 ml-2",children:[W===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena netto"}),u.jsx("input",{type:"text",value:N.cena_netto,onKeyPress:z=>{const O=String.fromCharCode(z.which);(!/[\d,]/.test(O)||O===","&&z.target.value.includes(",")||z.target.value===""&&O===",")&&z.preventDefault()},onChange:z=>{const O=z.target,se=O.selectionStart??0;let L=z.target.value.replace(/[^\d,]/g,"");if(L===""){const Ke=[...w];Ke[W].cena_netto="",b(Ke);return}if(!L.includes(","))L=L+",00";else{const[Ke,Qe]=L.split(",");Qe&&Qe.length>2&&(L=`${Ke},${Qe.slice(0,2)}`)}const je=[...w];je[W].cena_netto=L,b(je),requestAnimationFrame(()=>{const Ke=Math.min(se,L.length);O.setSelectionRange(Ke,Ke)})},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})]}),u.jsxs("div",{className:"w-16 ml-2",children:[W===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat %"}),u.jsx("input",{type:"text",value:N.rabat,onKeyPress:z=>{const O=String.fromCharCode(z.which);(!/[\d,]/.test(O)||O===","&&z.target.value.includes(",")||z.target.value===""&&O===",")&&z.preventDefault()},onChange:z=>{const O=[...w];O[W].rabat=z.target.value.replace(/[^\d,]/g,""),b(O)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0"})]}),u.jsxs("div",{className:"w-20 ml-2 relative dropdown-container",children:[W===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"VAT"}),u.jsxs("button",{type:"button",onClick:()=>le(W),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between bg-white",children:[u.jsxs("span",{className:"truncate",children:[N.vat,"%"]}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Y===W&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:z=>z.stopPropagation(),children:WO.map(z=>u.jsx("button",{type:"button",onClick:()=>pe(W,z.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:z.label},z.value))})]}),u.jsxs("div",{className:"w-24 ml-2",children:[W===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Wart. netto"}),u.jsx("input",{type:"text",value:oe(N).toFixed(2).replace(".",","),readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"0,00"})]}),u.jsxs("div",{className:"w-24 ml-2",children:[W===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Wart. brutto"}),u.jsx("input",{type:"text",value:I(N).toFixed(2).replace(".",","),readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"0,00"})]}),w.length>1&&W>=k&&u.jsx("button",{onClick:()=>ue(W),className:`ml-2 text-red-400 hover:text-red-600 ${W===0?"mt-[28px]":""}`,title:"Usu pozycj",children:u.jsx(Nt,{size:16})})]}),W===w.length-1&&u.jsx("button",{onClick:de,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})})]},W))})]}),u.jsxs("div",{className:"absolute bottom-8 right-12 flex flex-col items-start gap-1",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs text-gray-700 mr-2",children:"Kwota rabatu:"}),u.jsxs("span",{className:"text-xs text-gray-900",children:[re().replace(".",",")," z"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs text-gray-700 mr-2",children:"Kwota netto:"}),u.jsxs("span",{className:"text-xs text-gray-900",children:[P().replace(".",",")," z"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs text-gray-700 mr-2",children:"Kwota VAT:"}),u.jsxs("span",{className:"text-xs text-gray-900",children:[ce().replace(".",",")," z"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs font-bold text-gray-700 mr-2",children:"Razem (PLN):"}),u.jsxs("span",{className:"text-xs font-bold text-gray-900",children:[A().replace(".",",")," z"]})]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:T,disabled:D||!a||!g||!w.some(N=>N.nazwa&&N.ilosc&&N.cena_netto),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora ${D||!a||!g||!w.some(N=>N.nazwa&&N.ilosc&&N.cena_netto)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:D?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})})]})})},mu=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const r=parseInt(t[1],10),a=parseInt(t[2],10)-1,o=parseInt(t[3],10),l=new Date(o,a,r);if(!isNaN(l.getTime()))return l}return null}catch{return null}},$O=({onDeleteOrder:e,onUpdateOrder:n,onInvoiceCreated:t,refreshTrigger:r})=>{const[a,o]=S.useState([]),[l,c]=S.useState(!0),[f,h]=S.useState(null),[p,m]=S.useState(null),[g,v]=S.useState(!1),[w,b]=S.useState(!1),[k,C]=S.useState(null),[D,E]=S.useState(!1),[Y,ee]=S.useState(null),[G,F]=S.useState(""),[H,U]=S.useState({}),[ae,J]=S.useState(!1),[V,de]=S.useState(null),[ue,le]=S.useState("data_utworzenia"),[pe,q]=S.useState("desc"),[oe,B]=S.useState(""),[re,I]=S.useState(""),[P,ce]=S.useState(""),[A,T]=S.useState(""),j=async()=>{try{console.log(" Starting to load orders..."),c(!0),h(null),console.log(" Fetching from /api/orders-with-products...");const ve=await fetch("/api/orders-with-products");if(console.log(" Response status:",ve.status),console.log(" Response ok:",ve.ok),!ve.ok)throw new Error(`HTTP error! status: ${ve.status}`);const qe=await ve.json();console.log(" Raw data received:",qe),console.log(" Raw data length:",qe.length);const vt=qe.map(bt=>({id:bt.id,klient:bt.klient,numer_zamowienia:bt.numer_zamowienia,data_utworzenia:bt.data_utworzenia,laczna_ilosc:bt.laczna_ilosc,typ:bt.typ||"zamowienie",numer_zwrotu:bt.numer_zwrotu||null,numer_faktury:bt.numer_faktury??null,products:bt.products||[]}));console.log(" Transformed orders:",vt),console.log(" Orders count:",vt.length),o(vt)}catch(ve){console.error(" Error loading orders:",ve),h("Failed to load orders")}finally{c(!1)}};S.useEffect(()=>{j()},[]),S.useEffect(()=>{r&&j()},[r]);const N=ve=>new Date(ve).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),W=ve=>{m(ve),v(!0)},z=ve=>{ve.numer_faktury||(C(ve),b(!0))},O=ve=>{ve.numer_faktury||(de(ve),J(!0))},se=async ve=>{if(console.log("OrdersList handleEditSubmit called with data:",ve),n)n(ve);else try{console.log("Sending PUT request to update order:",ve);const qe=await fetch(`/api/orders/${ve.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)});if(!qe.ok)throw new Error(`HTTP error! status: ${qe.status}`);He.success("Zamwienie zostao zaktualizowane"),j()}catch(qe){console.error("Error updating order:",qe),He.error("Bd podczas aktualizacji zamwienia")}},L=ve=>{ee(ve),E(!0),F("")},Oe=async()=>{if(G==="5202"){if(Y?.id)try{e&&e(Y.id);const ve=await fetch(`/api/orders/${Y.id}`,{method:"DELETE"});if(!ve.ok)throw new Error(`HTTP error! status: ${ve.status}`);const qe=await ve.json();console.log("Order deleted:",qe),He.success("Zamwienie zostao usunite"),j()}catch(ve){console.error("Error deleting order:",ve),He.error("Bd podczas usuwania zamwienia")}je()}else He.error("Nieprawidowe haso"),F("")},je=()=>{E(!1),ee(null),F("")},Ke=ve=>{ve.key==="Enter"&&Oe()},Qe=async ve=>{try{console.log("    WMS  backend, orderId:",ve.id);const qe=await fetch("/api/wms/send-shipment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:ve.id})}),vt=await qe.json();if(!qe.ok)throw new Error(vt.error||`HTTP ${qe.status}`);return console.log("   backend:",vt),He.success(`   WMS: ${vt.wmsShipmentId||""}`),!0}catch(qe){return console.error("    WMS:",qe),He.error(`   WMS: ${qe instanceof Error?qe.message:" "}`),!1}},he=async(ve,qe)=>{const vt=a.find(fe=>fe.id===ve);if(!vt)return;const bt=H[ve]||"przygotowane";if(bt==="przygotowane"&&qe==="wysane"){const fe=He.loading("  WMS..."),Re=await Qe(vt);if(He.dismiss(fe),!Re)return}U(fe=>({...fe,[ve]:qe})),(bt!=="przygotowane"||qe!=="wysane")&&He.success(`Status zamwienia zmieniony na: ${qe}`)},Ne=ve=>{ue===ve?q(pe==="asc"?"desc":"asc"):(le(ve),q("asc"))},Pe=ve=>a.filter(qe=>{if(ve.klient!==void 0&&ve.klient&&qe.klient!==ve.klient||ve.typ!==void 0&&ve.typ&&(qe.typ||"zamowienie")!==ve.typ)return!1;const vt=mu(qe.numer_zamowienia);return vt?!(ve.year&&vt.getFullYear().toString()!==ve.year||ve.month&&(vt.getMonth()+1).toString().padStart(2,"0")!==ve.month):!(ve.year||ve.month)}),_e=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],Je={zamowienie:"Zamwienie",zwrot:"Zwrot",odpisanie:"Odpisanie"},ft=Pe({typ:A||void 0,year:oe||void 0,month:re||void 0}),ut=new Set(ft.map(ve=>ve.klient).filter(Boolean)),ht=Array.from(ut).sort((ve,qe)=>ve.localeCompare(qe));P&&!ut.has(P)&&(ht.push(P),ht.sort((ve,qe)=>ve.localeCompare(qe)));const Ot=Pe({klient:P||void 0,year:oe||void 0,month:re||void 0}),Yt=new Set(Ot.map(ve=>ve.typ||"zamowienie")),Jt=Array.from(Yt).map(ve=>({value:ve,label:Je[ve]||ve}));A&&!Yt.has(A)&&Jt.push({value:A,label:Je[A]||A});const Lt=Pe({klient:P||void 0,typ:A||void 0,month:re||void 0}),Xt=new Set(Lt.map(ve=>mu(ve.numer_zamowienia)).filter(ve=>ve!==null).map(ve=>ve.getFullYear().toString())),dt=Array.from(Xt).sort((ve,qe)=>parseInt(qe)-parseInt(ve));oe&&!Xt.has(oe)&&(dt.push(oe),dt.sort((ve,qe)=>parseInt(qe)-parseInt(ve)));const Et=Pe({klient:P||void 0,typ:A||void 0,year:oe||void 0}),qt=new Set(Et.map(ve=>mu(ve.numer_zamowienia)).filter(ve=>ve!==null).map(ve=>(ve.getMonth()+1).toString().padStart(2,"0"))),Tt=_e.filter(ve=>qt.has(ve.value));if(re&&!qt.has(re)){const ve=_e.find(qe=>qe.value===re);ve&&Tt.push(ve),Tt.sort((qe,vt)=>qe.value.localeCompare(vt.value))}const Ft=a.filter(ve=>{if(P&&ve.klient!==P||A&&(ve.typ||"zamowienie")!==A)return!1;const qe=mu(ve.numer_zamowienia);return qe?!(oe&&qe.getFullYear().toString()!==oe||re&&(qe.getMonth()+1).toString().padStart(2,"0")!==re):!oe&&!re}).sort((ve,qe)=>{let vt,bt;switch(ue){case"numer_zamowienia":vt=(ve.numer_zamowienia||"").toLowerCase(),bt=(qe.numer_zamowienia||"").toLowerCase();break;case"klient":vt=(ve.klient||"").toLowerCase(),bt=(qe.klient||"").toLowerCase();break;case"laczna_ilosc":vt=ve.laczna_ilosc,bt=qe.laczna_ilosc;break;case"data_utworzenia":vt=new Date(ve.data_utworzenia),bt=new Date(qe.data_utworzenia);break;default:vt=ve[ue]||"",bt=qe[ue]||""}return typeof vt=="string"&&typeof bt=="string"?pe==="asc"?vt.localeCompare(bt):bt.localeCompare(vt):typeof vt=="number"&&typeof bt=="number"?pe==="asc"?vt-bt:bt-vt:vt instanceof Date&&bt instanceof Date?pe==="asc"?vt.getTime()-bt.getTime():bt.getTime()-vt.getTime():0});return l?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie zamwie..."})}):f?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",f]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsxs("thead",{className:"sticky top-0 z-10",children:[u.jsxs("tr",{className:"bg-white border-b border-gray-200",children:[u.jsx("th",{colSpan:5,className:"px-8 py-2 font-sora"}),u.jsx("th",{className:"px-4 py-2 text-right font-sora bg-white",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:P,onChange:ve=>ce(ve.target.value),className:"block px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300 truncate",style:{fontFamily:"Sora, sans-serif",direction:"ltr",width:"145px",minWidth:"145px",maxWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Klient"}),ht.map(ve=>u.jsx("option",{value:ve,style:{fontFamily:"Sora, sans-serif"},children:ve},ve))]}),u.jsxs("select",{value:A,onChange:ve=>T(ve.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Typ"}),Jt.map(ve=>u.jsx("option",{value:ve.value,style:{fontFamily:"Sora, sans-serif"},children:ve.label},ve.value))]})]})})]}),u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ne("numer_zamowienia"),children:"Numer zamwienia"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ne("klient"),children:"Klient"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ne("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ne("laczna_ilosc"),children:"czna ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ne("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:oe,onChange:ve=>B(ve.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),dt.map(ve=>u.jsx("option",{value:ve,style:{fontFamily:"Sora, sans-serif"},children:ve},ve))]}),u.jsxs("select",{value:re,onChange:ve=>I(ve.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Miesic"}),Tt.map(ve=>u.jsx("option",{value:ve.value,style:{fontFamily:"Sora, sans-serif"},children:ve.label},ve.value))]})]})})]})]}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ft.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamwie"})}):Ft.map(ve=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.numer_zamowienia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.klient}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ve.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":ve.typ==="odpisanie"?"bg-green-100 text-green-800 border border-green-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:ve.typ==="zwrot"?"Zwrot":ve.typ==="odpisanie"?"Odpisanie":"Zamwienie"})}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.laczna_ilosc}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:N(ve.data_utworzenia)}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:qe=>{qe.preventDefault(),qe.stopPropagation(),W(ve)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(ep,{size:16})}),u.jsx("button",{type:"button",onClick:qe=>{qe.preventDefault(),qe.stopPropagation(),O(ve)},disabled:!!ve.numer_faktury,className:ve.numer_faktury?"text-purple-600 font-semibold text-sm cursor-default opacity-100 disabled:opacity-100 disabled:cursor-default":"text-purple-200 hover:text-purple-400 focus:outline-none font-semibold text-sm",title:ve.numer_faktury?ve.numer_faktury:"Utwrz faktur",children:"FV"}),u.jsx("button",{type:"button",onClick:qe=>{qe.preventDefault(),qe.stopPropagation(),z(ve)},disabled:!!ve.numer_faktury,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:ve.numer_faktury?"Edytowanie niedostpne (utworzono faktur)":"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:qe=>{qe.preventDefault(),qe.stopPropagation(),L(ve)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Nt,{size:16})})]}),u.jsxs("select",{value:H[ve.id]||"przygotowane",onChange:qe=>{qe.preventDefault(),qe.stopPropagation(),he(ve.id,qe.target.value)},onClick:qe=>qe.stopPropagation(),className:"px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-0 focus:border-gray-300 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"przygotowane",children:"Przygotowane"}),u.jsx("option",{value:"wysane",children:"Wysane"})]})]})})]},ve.id))})]})}),u.jsx(sr,{isOpen:D,onRequestClose:je,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:je,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:G,onChange:ve=>F(ve.target.value),onKeyPress:Ke,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:je,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:Oe,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(IO,{isOpen:g,onClose:()=>v(!1),order:p}),u.jsx(LO,{isOpen:w,onClose:()=>{b(!1),C(null)},onSubmit:ve=>{se(ve),b(!1),C(null)},order:k}),u.jsx(UO,{isOpen:ae,onClose:()=>{J(!1),de(null)},onSuccess:()=>{t?.(),j()},orderData:V})]})},Nv=e=>{if(!e)return"";const n=new Date(e);return isNaN(n.getTime())?e:n.toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"})},HO=({refreshTrigger:e})=>{const[n,t]=S.useState([]),[r,a]=S.useState(!0),[o,l]=S.useState(null),c=async()=>{try{a(!0),l(null);const f=await fetch("/api/invoices");if(!f.ok)throw new Error("Bd adowania faktur");const h=await f.json();t(h)}catch(f){l(f instanceof Error?f.message:"Bd adowania faktur"),t([])}finally{a(!1)}};return S.useEffect(()=>{c()},[]),S.useEffect(()=>{e!=null&&c()},[e]),r?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500 font-sora",children:"adowanie faktur..."})}):o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500 font-sora",children:["Bd: ",o]})}):u.jsx("div",{className:"space-y-4",children:u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Numer faktury"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Data faktury"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Termin patnoci"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Klient"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Kwota netto"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Kwota brutto"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak faktur"})}):n.map(f=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 whitespace-nowrap text-sm text-gray-900 font-sora",children:f.numer_faktury}),u.jsx("td",{className:"px-8 py-3 whitespace-nowrap text-sm text-gray-600 font-sora",children:Nv(f.data_faktury)}),u.jsx("td",{className:"px-8 py-3 whitespace-nowrap text-sm text-gray-600 font-sora",children:f.termin_platnosci?Nv(f.termin_platnosci):""}),u.jsx("td",{className:"px-8 py-3 whitespace-nowrap text-sm text-gray-600 font-sora",children:f.klient_nazwa}),u.jsx("td",{className:"px-8 py-3 whitespace-nowrap text-sm text-gray-600 font-sora",children:typeof f.suma_netto=="number"?f.suma_netto.toFixed(2).replace(".",",")+" z":""}),u.jsx("td",{className:"px-8 py-3 whitespace-nowrap text-sm text-gray-600 font-sora",children:typeof f.suma_brutto=="number"?f.suma_brutto.toFixed(2).replace(".",",")+" z":f.suma_brutto})]},f.id))})]})})})},YO=({isOpen:e,onClose:n,reservation:t})=>{const[r,a]=De.useState({x:0,y:0}),[o,l]=De.useState(!1),c=De.useRef({x:0,y:0});De.useEffect(()=>{const p=g=>{o&&a({x:g.clientX-c.current.x,y:g.clientY-c.current.y})},m=()=>l(!1);return o&&(window.addEventListener("mousemove",p),window.addEventListener("mouseup",m)),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m)}},[o]);const f=p=>{p.target.closest("button")||p.target.closest("input")||(l(!0),c.current={x:p.clientX-r.x,y:p.clientY-r.y})};if(!t)return null;const h=p=>new Date(p).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"});return u.jsx(sr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${r.x}px), calc(-50% + ${r.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:f,style:{cursor:o?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy rezerwacji"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Numer rezerwacji"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.numer_rezerwacji})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data utworzenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_utworzenia)})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Klient"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.klient})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakoczenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_zakonczenia)})]})]}),t.komentarz&&u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Komentarz"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.komentarz})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[220px]",children:"Nazwa"}),(t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa")&&u.jsx("th",{className:"py-2 text-left w-[85px]"}),u.jsx("th",{className:"px-2 py-2 text-center w-[70px]",children:"Pozostao"}),u.jsx("th",{className:"px-2 py-2 text-center w-[60px]",children:"Wydane"}),u.jsx("th",{className:"px-2 py-2 text-center w-[90px]",children:"Zarezerwowane"})]})}),u.jsx("tbody",{children:t.products&&t.products.length>0?t.products.map(p=>{const m=p.ilosc_wydane??0,g=p.ilosc-m,v=t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa";return u.jsxs("tr",{className:v?"opacity-50":"",children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:p.product_kod}),u.jsx("td",{className:"px-2 py-2 w-[220px] break-words leading-tight",children:p.product_nazwa}),t.status==="anulowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-red-600 font-medium",children:"anulowana"})}),t.status==="zrealizowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-blue-600 font-medium",children:"zrealizowana"})}),t.status==="wygasa"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-gray-600 font-medium",children:"wygasa"})}),u.jsx("td",{className:"px-2 py-2 w-[70px] text-center",children:u.jsx("span",{className:g>0&&!v?"text-green-600 font-medium":"text-gray-400",children:g})}),u.jsx("td",{className:`px-2 py-2 w-[60px] text-center ${v?"text-gray-400":"text-red-600"}`,children:m}),u.jsx("td",{className:"px-2 py-2 w-[90px] text-center",children:p.ilosc})]},p.id)}):u.jsx("tr",{children:u.jsx("td",{colSpan:t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa"?6:5,className:"px-2 py-4 text-center text-gray-500",children:"Brak produktw"})})})]})]})]})]})})};Aa("pl",Oa);const VO=({isOpen:e,onClose:n,onSubmit:t,reservation:r})=>{const[a,o]=S.useState(""),[l,c]=S.useState(""),[f,h]=S.useState(null),[p,m]=S.useState(null),[g,v]=S.useState("aktywna"),[w,b]=S.useState(""),[k,C]=S.useState([{kod:"",nazwa:"",ilosc:""}]),[D,E]=S.useState([]),[Y,ee]=S.useState([]),[G,F]=S.useState(!1),[H,U]=S.useState(null),[ae,J]=S.useState([]),[V,de]=S.useState(!1),[ue,le]=S.useState(null),[pe,q]=S.useState(""),[oe,B]=S.useState(new Set),[re,I]=S.useState(!1),P=S.useRef(null);S.useEffect(()=>{e&&(async()=>{try{const O=await fetch("/api/working-sheets/search?query=");if(O.ok){const se=await O.json();ee(se)}}catch(O){console.error("Error loading stock info:",O)}})()},[e]),S.useEffect(()=>{if(e&&r)if(o(r.klient),q(r.klient),le({nazwa:r.klient,firma:r.firma}),c(r.numer_rezerwacji),v(r.status),b(r.komentarz||""),B(new Set),P.current=null,r.data_utworzenia&&h(new Date(r.data_utworzenia)),r.data_zakonczenia&&m(new Date(r.data_zakonczenia)),r.products&&r.products.length>0){const z=r.products.map(se=>({kod:se.product_kod||"",nazwa:se.product_nazwa||"",ilosc:(se.ilosc||0).toString(),originalIlosc:se.ilosc||0,iloscWydane:se.ilosc_wydane||0}));C(z);const O=r.products.some(se=>(se.ilosc_wydane||0)>0);I(O)}else C([{kod:"",nazwa:"",ilosc:""}]),I(!1)},[e,r]),S.useEffect(()=>{const O=setTimeout(async()=>{if(H===null||!k.find((se,L)=>L===H)?.nazwa.trim()){E([]);return}F(!0);try{const se=k.find((je,Ke)=>Ke===H)?.nazwa||"";if(!se.trim()){E([]),F(!1);return}const L=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(se)}`);if(!L.ok)throw new Error("Failed to fetch products");const Oe=await L.json();E(Oe)}catch(se){console.error("Error searching products:",se),E([])}finally{F(!1)}},300);return()=>clearTimeout(O)},[k,H]),S.useEffect(()=>{const O=setTimeout(async()=>{if(pe.trim().length<2){J([]);return}de(!0);try{const se=await fetch(`/api/clients/search?q=${encodeURIComponent(pe)}`);if(!se.ok)throw new Error("Failed to fetch clients");const L=await se.json();J(L)}catch(se){console.error("Error searching clients:",se),J([])}finally{de(!1)}},300);return()=>clearTimeout(O)},[pe]);const ce=()=>{C([...k,{kod:"",nazwa:"",ilosc:""}])},A=(z,O)=>{const se=[...k];se[z]={...se[z],kod:O.kod,nazwa:O.nazwa},C(se),U(null),Y.findIndex(Oe=>Oe.kod===O.kod)<0&&ee([...Y,O])},T=(z,O)=>{const se=[...k];se[z].ilosc=O,C(se);const L=se[z],Oe=parseInt(O)||0,je=L.originalIlosc||0,Ke=L.iloscWydane||0;if(P.current=null,!O.trim()||Oe===0){B(Je=>{const ft=new Set(Je);return ft.delete(z),ft});return}const Qe=Y.find(Je=>Je.kod===L.kod),he=Qe?.ilosc||0,Ne=Qe?.ilosc_reserved||0,Pe=he-Ne+je;let _e=null;Oe<Ke?_e=`Nie mona zmniejszy poniej wydanej iloci (${Ke} szt.)`:L.kod&&Oe>Pe&&(_e=`Niewystarczajca ilo - dostpne do rezerwacji: ${Math.max(0,Pe-je)} szt.`),B(Je=>{const ft=new Set(Je);return _e?ft.add(z):ft.delete(z),ft}),_e&&He.error(_e)},j=()=>{if(!ue||!a.trim()||!p||oe.size>0||k.filter(O=>O.kod.trim()&&O.nazwa.trim()&&O.ilosc.trim()).length===0)return!1;for(let O=0;O<k.length;O++){const se=k[O];if(!se.kod.trim()||!se.nazwa.trim()||!se.ilosc.trim())continue;const L=parseInt(se.ilosc)||0,Oe=se.iloscWydane||0,je=se.originalIlosc||0;if(L<Oe)return!1;if(L>je&&se.kod){const Ke=Y.find(Pe=>Pe.kod===se.kod),Qe=Ke?.ilosc||0,he=Ke?.ilosc_reserved||0,Ne=Qe-he+je;if(L>Ne)return!1}}return!0},N=async z=>{if(z.preventDefault(),!r)return;if(!ue||!a.trim()){He.error("Wybierz klienta");return}if(!l.trim()){He.error("Wprowad numer rezerwacji");return}if(!p){He.error("Wybierz dat zakoczenia");return}const O=k.filter(L=>L.kod.trim()&&L.nazwa.trim()&&L.ilosc.trim());if(O.length===0){He.error("Dodaj produkty do rezerwacji");return}if(!j()){He.error("Popraw bdy w formularzu");return}const se=O.map(L=>({kod:L.kod,nazwa:L.nazwa,ilosc:parseInt(L.ilosc)||0,originalIlosc:L.originalIlosc||0,iloscWydane:L.iloscWydane||0}));try{const L=await fetch(`/api/reservations/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_rezerwacji:l.trim(),data_utworzenia:f?f.toISOString().split("T")[0]:null,data_zakonczenia:p.toISOString().split("T")[0],status:g,komentarz:w.trim()||null,products:se})});if(!L.ok){const Oe=await L.json();throw new Error(Oe.error||"Failed to update reservation")}He.success("Rezerwacja zostaa zaktualizowana"),W(),t()}catch(L){console.error("Error updating reservation:",L),He.error(L.message||"Wystpi bd podczas aktualizacji rezerwacji")}},W=()=>{o(""),q(""),le(null),J([]),c(""),h(null),m(null),v("aktywna"),b(""),C([{kod:"",nazwa:"",ilosc:""}]),E([]),ee([]),U(null),B(new Set),I(!1),P.current=null,n()};return r?u.jsx(sr,{isOpen:e,onRequestClose:W,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj rezerwacj"}),u.jsx("button",{type:"button",onClick:W,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("form",{onSubmit:N,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx(pn,{selected:f,onChange:()=>{},locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholderText:"Wybierz dat",popperClassName:"z-50",disabled:!0})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:l,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx(pn,{selected:p,onChange:z=>m(z),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:f||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:pe,onChange:z=>{re||(q(z.target.value),ue&&(le(null),o("")))},placeholder:"Wyszukaj klienta...",disabled:re,title:re?"Nie mona zmieni klienta - cz towaru zostaa ju wydana":"",className:`w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${re?"bg-gray-50 cursor-not-allowed":""}`}),V&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),ae.length>0&&!ue&&!re&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:ae.map(z=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{le(z),q(z.nazwa),o(z.nazwa),J([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:z.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:z.firma})]})},z.id))}),ue&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:ue.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:ue.firma})]}),!re&&u.jsx("button",{type:"button",onClick:()=>{le(null),q(""),o("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(Nt,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:w,onChange:z=>b(z.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),k.map((z,O)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:z.nazwa,onChange:se=>{const L=[...k];L[O].nazwa=se.target.value,L[O].kod="",C(L),U(O)},onFocus:()=>U(O),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",disabled:(z.iloscWydane??0)>0})]}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:z.iloscWydane||1,placeholder:"Ilo",value:z.ilosc,onChange:se=>T(O,se.target.value),className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${oe.has(O)?"border-red-500 bg-red-50":"border-gray-300"}`})})]}),O===k.length-1&&u.jsx("button",{type:"button",onClick:ce,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),G&&H===O&&u.jsx("div",{className:"absolute right-24 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),D.length>0&&H===O&&z.nazwa.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[calc(100%-6rem)] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:D.map(se=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>A(O,se),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:se.kod}),se.nazwa&&se.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:se.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:se.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",se.ilosc]}),(se.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",se.ilosc_reserved??0]})]})},se.kod))})]},O))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:W,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:N,disabled:!j(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora ${j()?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:"Zapisz zmiany"})]})]})}):null},KO=({refreshTrigger:e})=>{const[n,t]=S.useState([]),[r,a]=S.useState(!0),[o,l]=S.useState(null),[c,f]=S.useState(null),[h,p]=S.useState(!1),[m,g]=S.useState(!1),[v,w]=S.useState(null),[b,k]=S.useState(!1),[C,D]=S.useState(null),[E,Y]=S.useState("data_utworzenia"),[ee,G]=S.useState("desc"),[F,H]=S.useState(""),[U,ae]=S.useState(""),[J,V]=S.useState(""),[de,ue]=S.useState(""),le=async()=>{try{console.log(" Starting to load reservations..."),a(!0),l(null),console.log(" Fetching from /api/reservations-with-products...");const O=await fetch("/api/reservations-with-products");if(console.log(" Response status:",O.status),!O.ok)throw new Error(`HTTP error! status: ${O.status}`);const se=await O.json();console.log(" Raw data received:",se),console.log(" Raw data length:",se.length);const L=se.map(Oe=>({id:Oe.id,numer_rezerwacji:Oe.numer_rezerwacji,klient:Oe.klient||"",firma:Oe.firma||"",data_utworzenia:Oe.data_utworzenia,data_zakonczenia:Oe.data_zakonczenia,status:Oe.status||"aktywna",komentarz:Oe.komentarz||null,laczna_ilosc:Oe.laczna_ilosc||0,products:Oe.products||[]}));console.log(" Transformed reservations:",L),console.log(" Reservations count:",L.length),t(L)}catch(O){console.error(" Error loading reservations:",O),l("Failed to load reservations")}finally{a(!1)}};S.useEffect(()=>{le()},[]),S.useEffect(()=>{e&&le()},[e]);const pe=O=>new Date(O).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"}),q=O=>{f(O),p(!0)},oe=O=>{w(O),g(!0)},B=O=>{D(O),k(!0)},re=async()=>{if(C)try{const O=await fetch(`/api/reservations/${C.id}/cancel`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!O.ok){const se=await O.json();throw new Error(se.error||"Failed to cancel reservation")}He.success("Rezerwacja zostaa anulowana"),k(!1),D(null),le()}catch(O){console.error("Error cancelling reservation:",O),He.error(O.message||"Wystpi bd podczas anulowania rezerwacji")}},I=O=>{E===O?G(ee==="asc"?"desc":"asc"):(Y(O),G("asc"))},P=Array.from(new Set(n.map(O=>new Date(O.data_utworzenia).getFullYear().toString()))).sort((O,se)=>parseInt(se)-parseInt(O)),ce=Array.from(new Set(n.map(O=>O.klient).filter(Boolean))).sort(),A=Array.from(new Set(n.map(O=>O.status).filter(Boolean))).sort(),T=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],j=new Set(n.map(O=>(new Date(O.data_utworzenia).getMonth()+1).toString().padStart(2,"0"))),N=T.filter(O=>j.has(O.value)),z=n.filter(O=>!(F&&new Date(O.data_utworzenia).getFullYear().toString()!==F||U&&(new Date(O.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==U||J&&O.klient!==J||de&&O.status!==de)).sort((O,se)=>{let L,Oe;switch(E){case"numer_rezerwacji":L=(O.numer_rezerwacji||"").toLowerCase(),Oe=(se.numer_rezerwacji||"").toLowerCase();break;case"klient":L=(O.klient||"").toLowerCase(),Oe=(se.klient||"").toLowerCase();break;case"status":L=(O.status||"").toLowerCase(),Oe=(se.status||"").toLowerCase();break;case"laczna_ilosc":L=O.laczna_ilosc,Oe=se.laczna_ilosc;break;case"data_utworzenia":L=new Date(O.data_utworzenia),Oe=new Date(se.data_utworzenia);break;case"data_zakonczenia":L=new Date(O.data_zakonczenia),Oe=new Date(se.data_zakonczenia);break;default:L=O[E]||"",Oe=se[E]||""}return typeof L=="string"&&typeof Oe=="string"?ee==="asc"?L.localeCompare(Oe):Oe.localeCompare(L):typeof L=="number"&&typeof Oe=="number"?ee==="asc"?L-Oe:Oe-L:L instanceof Date&&Oe instanceof Date?ee==="asc"?L.getTime()-Oe.getTime():Oe.getTime()-L.getTime():0});return r?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie rezerwacji..."})}):o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",o]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-end",children:u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1",children:[u.jsxs("select",{value:J,onChange:O=>V(O.target.value),className:"block px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300 truncate",style:{fontFamily:"Sora, sans-serif",direction:"ltr",width:"145px",minWidth:"145px",maxWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Klient"}),ce.map(O=>u.jsx("option",{value:O,style:{fontFamily:"Sora, sans-serif"},children:O},O))]}),u.jsxs("select",{value:de,onChange:O=>ue(O.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Status"}),A.map(O=>u.jsx("option",{value:O,style:{fontFamily:"Sora, sans-serif"},children:O},O))]}),u.jsxs("select",{value:F,onChange:O=>H(O.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),P.map(O=>u.jsx("option",{value:O,style:{fontFamily:"Sora, sans-serif"},children:O},O))]}),u.jsxs("select",{value:U,onChange:O=>ae(O.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Miesic"}),N.map(O=>u.jsx("option",{value:O.value,style:{fontFamily:"Sora, sans-serif"},children:O.label},O.value))]})]}),(J||de||F||U)&&u.jsx("button",{onClick:()=>{V(""),ue(""),H(""),ae("")},className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})}),u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("numer_rezerwacji"),children:"Numer rezerwacji"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("klient"),children:"Klient"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("data_zakonczenia"),children:"Data zakoczenia"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("status"),children:"Status"}),u.jsx("th",{className:"px-8 py-4 border-b border-gray-200 bg-gray-50"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak rezerwacji"})}):z.map(O=>u.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>q(O),children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:O.numer_rezerwacji}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:O.klient}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:pe(O.data_utworzenia)}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:pe(O.data_zakonczenia)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-left",children:u.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded ${O.status==="aktywna"?"bg-green-100 text-green-800":O.status==="anulowana"?"bg-red-100 text-red-800":O.status==="zrealizowana"?"bg-blue-100 text-blue-800":O.status==="wygasa"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:O.status})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-sora",children:u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:se=>{se.preventDefault(),se.stopPropagation(),O.status==="aktywna"&&oe(O)},className:"text-green-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:text-green-600 hover:text-green-800",title:O.status==="aktywna"?"Edytuj":void 0,disabled:O.status!=="aktywna",children:u.jsx(Pl,{size:16})}),O.status==="aktywna"&&u.jsx("button",{type:"button",onClick:se=>{se.preventDefault(),se.stopPropagation(),B(O)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Anuluj rezerwacj",children:u.jsx(_b,{size:16})})]})})]},O.id))})]})}),u.jsx(YO,{isOpen:h,onClose:()=>p(!1),reservation:c}),u.jsx(VO,{isOpen:m,onClose:()=>{g(!1),w(null)},onSubmit:()=>{g(!1),w(null),le()},reservation:v}),u.jsx(sr,{isOpen:b,onRequestClose:()=>{k(!1),D(null)},style:{content:{width:"320px",height:"170px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800"}),u.jsx("button",{onClick:()=>{k(!1),D(null)},className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-4 text-center",children:"Czy na pewno chcesz anulowa rezerwacj?"}),u.jsxs("div",{className:"flex justify-center gap-3 mt-auto",children:[u.jsx("button",{type:"button",onClick:()=>{k(!1),D(null)},className:"px-3 py-1.5 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200 font-sora",children:"Nie"}),u.jsx("button",{type:"button",onClick:re,className:"px-3 py-1.5 text-xs text-white bg-blue-500 rounded hover:bg-blue-600 font-sora",children:"Tak"})]})]})})]})};var kf={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Cv;function GO(){return Cv||(Cv=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(kf)),kf.exports}var QO=GO();const Qf=Qu(QO);var Tv={};const XO="react-tooltip-core-styles",qO="react-tooltip-base-styles",Dv={core:!1,base:!1};function Fv({css:e,id:n=qO,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Dv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Tv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Tv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=XO),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Dv[t]=!0}const jv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[nw(Number(a)),aw({fallbackAxisSideDirection:"start"}),Gj({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const h=l;return t?(h.push(Hf({element:t,padding:5})),Yf(e,n,{placement:r,strategy:o,middleware:h}).then((({x:p,y:m,placement:g,middlewareData:v})=>{var w,b;const k={left:`${p}px`,top:`${m}px`,border:c},{x:C,y:D}=(w=v.arrow)!==null&&w!==void 0?w:{x:0,y:0},E=(b={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&b!==void 0?b:"bottom",Y=c&&{borderBottom:c,borderRight:c};let ee=0;if(c){const G=`${c}`.match(/(\d+)px/);ee=G?.[1]?Number(G[1]):1}return{tooltipStyles:k,tooltipArrowStyles:{left:C!=null?`${C}px`:"",top:D!=null?`${D}px`:"",right:"",bottom:"",...Y,[E]:`-${f/2+ee}px`},place:g}}))):Yf(e,n,{placement:"bottom",strategy:o,middleware:h}).then((({x:p,y:m,placement:g})=>({tooltipStyles:{left:`${p}px`,top:`${m}px`},tooltipArrowStyles:{},place:g})))},Pv=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),Av=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Ov=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Xf=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Xf(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Ov(e)||!Ov(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Xf(e[a],n[a])))},ZO=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Rv=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(ZO(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},JO=typeof window<"u"?S.useLayoutEffect:S.useEffect,In=e=>{e.current&&(clearTimeout(e.current),e.current=null)},e5="DEFAULT_TOOLTIP_ID",t5={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},r5=S.createContext({getTooltipData:()=>t5});function vw(e=e5){return S.useContext(r5).getTooltipData(e)}var qo={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},bf={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const n5=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:h=["hover"],openOnClick:p=!1,positionStrategy:m="absolute",middlewares:g,wrapper:v,delayShow:w=0,delayHide:b=0,float:k=!1,hidden:C=!1,noArrow:D=!1,clickable:E=!1,closeOnEsc:Y=!1,closeOnScroll:ee=!1,closeOnResize:G=!1,openEvents:F,closeEvents:H,globalCloseEvents:U,imperativeModeOnly:ae,style:J,position:V,afterShow:de,afterHide:ue,disableTooltip:le,content:pe,contentWrapperRef:q,isOpen:oe,defaultIsOpen:B=!1,setIsOpen:re,activeAnchor:I,setActiveAnchor:P,border:ce,opacity:A,arrowColor:T,arrowSize:j=8,role:N="tooltip"})=>{var W;const z=S.useRef(null),O=S.useRef(null),se=S.useRef(null),L=S.useRef(null),Oe=S.useRef(null),[je,Ke]=S.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[Qe,he]=S.useState(!1),[Ne,Pe]=S.useState(!1),[_e,Je]=S.useState(null),ft=S.useRef(!1),ut=S.useRef(null),{anchorRefs:ht,setActiveAnchor:Ot}=vw(n),Yt=S.useRef(!1),[Jt,Lt]=S.useState([]),Xt=S.useRef(!1),dt=p||h.includes("click"),Et=dt||F?.click||F?.dblclick||F?.mousedown,qt=F?{...F}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!F&&dt&&Object.assign(qt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const Tt=H?{...H}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!H&&dt&&Object.assign(Tt,{mouseleave:!1,blur:!1,mouseout:!1});const Zt=U?{...U}:{escape:Y||!1,scroll:ee||!1,resize:G||!1,clickOutsideAnchor:Et||!1};ae&&(Object.assign(qt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(Tt,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(Zt,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),JO((()=>(Xt.current=!0,()=>{Xt.current=!1})),[]);const Ft=Ge=>{Xt.current&&(Ge&&Pe(!0),setTimeout((()=>{Xt.current&&(re?.(Ge),oe===void 0&&he(Ge))}),10))};S.useEffect((()=>{if(oe===void 0)return()=>null;oe&&Pe(!0);const Ge=setTimeout((()=>{he(oe)}),10);return()=>{clearTimeout(Ge)}}),[oe]),S.useEffect((()=>{if(Qe!==ft.current)if(In(Oe),ft.current=Qe,Qe)de?.();else{const Ge=(tt=>{const Me=tt.match(/^([\d.]+)(ms|s)$/);if(!Me)return 0;const[,rt,kt]=Me;return Number(rt)*(kt==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));Oe.current=setTimeout((()=>{Pe(!1),Je(null),ue?.()}),Ge+25)}}),[Qe]);const ve=Ge=>{Ke((tt=>Xf(tt,Ge)?tt:Ge))},qe=(Ge=w)=>{In(se),Ne?Ft(!0):se.current=setTimeout((()=>{Ft(!0)}),Ge)},vt=(Ge=b)=>{In(L),L.current=setTimeout((()=>{Yt.current||Ft(!1)}),Ge)},bt=Ge=>{var tt;if(!Ge)return;const Me=(tt=Ge.currentTarget)!==null&&tt!==void 0?tt:Ge.target;if(!Me?.isConnected)return P(null),void Ot({current:null});w?qe():Ft(!0),P(Me),Ot({current:Me}),In(L)},fe=()=>{E?vt(b||100):b?vt():Ft(!1),In(se)},Re=({x:Ge,y:tt})=>{var Me;const rt={getBoundingClientRect:()=>({x:Ge,y:tt,width:0,height:0,top:tt,left:Ge,right:Ge,bottom:tt})};jv({place:(Me=_e?.place)!==null&&Me!==void 0?Me:c,offset:f,elementReference:rt,tooltipReference:z.current,tooltipArrowReference:O.current,strategy:m,middlewares:g,border:ce,arrowSize:j}).then((kt=>{ve(kt)}))},ze=Ge=>{if(!Ge)return;const tt=Ge,Me={x:tt.clientX,y:tt.clientY};Re(Me),ut.current=Me},X=Ge=>{var tt;if(!Qe)return;const Me=Ge.target;Me.isConnected&&(!((tt=z.current)===null||tt===void 0)&&tt.contains(Me)||[document.querySelector(`[id='${o}']`),...Jt].some((rt=>rt?.contains(Me)))||(Ft(!1),In(se)))},me=Av(bt,50),Te=Av(fe,50),Ae=Ge=>{Te.cancel(),me(Ge)},Be=()=>{me.cancel(),Te()},et=S.useCallback((()=>{var Ge,tt;const Me=(Ge=_e?.position)!==null&&Ge!==void 0?Ge:V;Me?Re(Me):k?ut.current&&Re(ut.current):I?.isConnected&&jv({place:(tt=_e?.place)!==null&&tt!==void 0?tt:c,offset:f,elementReference:I,tooltipReference:z.current,tooltipArrowReference:O.current,strategy:m,middlewares:g,border:ce,arrowSize:j}).then((rt=>{Xt.current&&ve(rt)}))}),[Qe,I,pe,J,c,_e?.place,f,m,V,_e?.position,k,j]);S.useEffect((()=>{var Ge,tt;const Me=new Set(ht);Jt.forEach((Ue=>{le?.(Ue)||Me.add({current:Ue})}));const rt=document.querySelector(`[id='${o}']`);rt&&!le?.(rt)&&Me.add({current:rt});const kt=()=>{Ft(!1)},R=Rv(I),te=Rv(z.current);Zt.scroll&&(window.addEventListener("scroll",kt),R?.addEventListener("scroll",kt),te?.addEventListener("scroll",kt));let K=null;Zt.resize?window.addEventListener("resize",kt):I&&z.current&&(K=rw(I,z.current,et,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const Q=Ue=>{Ue.key==="Escape"&&Ft(!1)};Zt.escape&&window.addEventListener("keydown",Q),Zt.clickOutsideAnchor&&window.addEventListener("click",X);const Z=[],ne=Ue=>!!(Ue?.target&&I?.contains(Ue.target)),ke=Ue=>{Qe&&ne(Ue)||bt(Ue)},Fe=Ue=>{Qe&&ne(Ue)&&fe()},we=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],Se=["click","dblclick","mousedown","mouseup"];Object.entries(qt).forEach((([Ue,$e])=>{$e&&(we.includes(Ue)?Z.push({event:Ue,listener:Ae}):Se.includes(Ue)&&Z.push({event:Ue,listener:ke}))})),Object.entries(Tt).forEach((([Ue,$e])=>{$e&&(we.includes(Ue)?Z.push({event:Ue,listener:Be}):Se.includes(Ue)&&Z.push({event:Ue,listener:Fe}))})),k&&Z.push({event:"pointermove",listener:ze});const Ee=()=>{Yt.current=!0},We=()=>{Yt.current=!1,fe()},Ze=E&&(Tt.mouseout||Tt.mouseleave);return Ze&&((Ge=z.current)===null||Ge===void 0||Ge.addEventListener("mouseover",Ee),(tt=z.current)===null||tt===void 0||tt.addEventListener("mouseout",We)),Z.forEach((({event:Ue,listener:$e})=>{Me.forEach((Ye=>{var gt;(gt=Ye.current)===null||gt===void 0||gt.addEventListener(Ue,$e)}))})),()=>{var Ue,$e;Zt.scroll&&(window.removeEventListener("scroll",kt),R?.removeEventListener("scroll",kt),te?.removeEventListener("scroll",kt)),Zt.resize?window.removeEventListener("resize",kt):K?.(),Zt.clickOutsideAnchor&&window.removeEventListener("click",X),Zt.escape&&window.removeEventListener("keydown",Q),Ze&&((Ue=z.current)===null||Ue===void 0||Ue.removeEventListener("mouseover",Ee),($e=z.current)===null||$e===void 0||$e.removeEventListener("mouseout",We)),Z.forEach((({event:Ye,listener:gt})=>{Me.forEach((Vt=>{var $t;($t=Vt.current)===null||$t===void 0||$t.removeEventListener(Ye,gt)}))}))}}),[I,et,Ne,ht,Jt,F,H,U,dt,w,b]),S.useEffect((()=>{var Ge,tt;let Me=(tt=(Ge=_e?.anchorSelect)!==null&&Ge!==void 0?Ge:l)!==null&&tt!==void 0?tt:"";!Me&&n&&(Me=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const rt=new MutationObserver((kt=>{const R=[],te=[];kt.forEach((K=>{if(K.type==="attributes"&&K.attributeName==="data-tooltip-id"&&(K.target.getAttribute("data-tooltip-id")===n?R.push(K.target):K.oldValue===n&&te.push(K.target)),K.type==="childList"){if(I){const Q=[...K.removedNodes].filter((Z=>Z.nodeType===1));if(Me)try{te.push(...Q.filter((Z=>Z.matches(Me)))),te.push(...Q.flatMap((Z=>[...Z.querySelectorAll(Me)])))}catch{}Q.some((Z=>{var ne;return!!(!((ne=Z?.contains)===null||ne===void 0)&&ne.call(Z,I))&&(Pe(!1),Ft(!1),P(null),In(se),In(L),!0)}))}if(Me)try{const Q=[...K.addedNodes].filter((Z=>Z.nodeType===1));R.push(...Q.filter((Z=>Z.matches(Me)))),R.push(...Q.flatMap((Z=>[...Z.querySelectorAll(Me)])))}catch{}}})),(R.length||te.length)&&Lt((K=>[...K.filter((Q=>!te.includes(Q))),...R]))}));return rt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{rt.disconnect()}}),[n,l,_e?.anchorSelect,I]),S.useEffect((()=>{et()}),[et]),S.useEffect((()=>{if(!q?.current)return()=>null;const Ge=new ResizeObserver((()=>{setTimeout((()=>et()))}));return Ge.observe(q.current),()=>{Ge.disconnect()}}),[pe,q?.current]),S.useEffect((()=>{var Ge;const tt=document.querySelector(`[id='${o}']`),Me=[...Jt,tt];I&&Me.includes(I)||P((Ge=Jt[0])!==null&&Ge!==void 0?Ge:tt)}),[o,Jt,I]),S.useEffect((()=>(B&&Ft(!0),()=>{In(se),In(L)})),[]),S.useEffect((()=>{var Ge;let tt=(Ge=_e?.anchorSelect)!==null&&Ge!==void 0?Ge:l;if(!tt&&n&&(tt=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),tt)try{const Me=Array.from(document.querySelectorAll(tt));Lt(Me)}catch{Lt([])}}),[n,l,_e?.anchorSelect]),S.useEffect((()=>{se.current&&(In(se),qe(w))}),[w]);const pt=(W=_e?.content)!==null&&W!==void 0?W:pe,Wt=Qe&&Object.keys(je.tooltipStyles).length>0;return S.useImperativeHandle(e,(()=>({open:Ge=>{if(Ge?.anchorSelect)try{document.querySelector(Ge.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ge.anchorSelect}" is not a valid CSS selector`)}Je(Ge??null),Ge?.delay?qe(Ge.delay):Ft(!0)},close:Ge=>{Ge?.delay?vt(Ge.delay):Ft(!1)},activeAnchor:I,place:je.place,isOpen:!!(Ne&&!C&&pt&&Wt)}))),Ne&&!C&&pt?De.createElement(v,{id:n,role:N,className:Qf("react-tooltip",qo.tooltip,bf.tooltip,bf[a],t,`react-tooltip__place-${je.place}`,qo[Wt?"show":"closing"],Wt?"react-tooltip__show":"react-tooltip__closing",m==="fixed"&&qo.fixed,E&&qo.clickable),onTransitionEnd:Ge=>{In(Oe),Qe||Ge.propertyName!=="opacity"||(Pe(!1),Je(null),ue?.())},style:{...J,...je.tooltipStyles,opacity:A!==void 0&&Wt?A:void 0},ref:z},pt,De.createElement(v,{className:Qf("react-tooltip-arrow",qo.arrow,bf.arrow,r,D&&qo.noArrow),style:{...je.tooltipArrowStyles,background:T?`linear-gradient(to right bottom, transparent 50%, ${T} 50%)`:void 0,"--rt-arrow-size":`${j}px`},ref:O})):null},a5=({content:e})=>De.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),ti=De.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:h="top",offset:p=10,wrapper:m="div",children:g=null,events:v=["hover"],openOnClick:w=!1,positionStrategy:b="absolute",middlewares:k,delayShow:C=0,delayHide:D=0,float:E=!1,hidden:Y=!1,noArrow:ee=!1,clickable:G=!1,closeOnEsc:F=!1,closeOnScroll:H=!1,closeOnResize:U=!1,openEvents:ae,closeEvents:J,globalCloseEvents:V,imperativeModeOnly:de=!1,style:ue,position:le,isOpen:pe,defaultIsOpen:q=!1,disableStyleInjection:oe=!1,border:B,opacity:re,arrowColor:I,arrowSize:P,setIsOpen:ce,afterShow:A,afterHide:T,disableTooltip:j,role:N="tooltip"},W)=>{const[z,O]=S.useState(r),[se,L]=S.useState(a),[Oe,je]=S.useState(h),[Ke,Qe]=S.useState(f),[he,Ne]=S.useState(p),[Pe,_e]=S.useState(C),[Je,ft]=S.useState(D),[ut,ht]=S.useState(E),[Ot,Yt]=S.useState(Y),[Jt,Lt]=S.useState(m),[Xt,dt]=S.useState(v),[Et,qt]=S.useState(b),[Tt,Zt]=S.useState(null),[Ft,ve]=S.useState(null),qe=S.useRef(oe),{anchorRefs:vt,activeAnchor:bt}=vw(e),fe=Te=>Te?.getAttributeNames().reduce(((Ae,Be)=>{var et;return Be.startsWith("data-tooltip-")&&(Ae[Be.replace(/^data-tooltip-/,"")]=(et=Te?.getAttribute(Be))!==null&&et!==void 0?et:null),Ae}),{}),Re=Te=>{const Ae={place:Be=>{var et;je((et=Be)!==null&&et!==void 0?et:h)},content:Be=>{O(Be??r)},html:Be=>{L(Be??a)},variant:Be=>{var et;Qe((et=Be)!==null&&et!==void 0?et:f)},offset:Be=>{Ne(Be===null?p:Number(Be))},wrapper:Be=>{var et;Lt((et=Be)!==null&&et!==void 0?et:m)},events:Be=>{const et=Be?.split(" ");dt(et??v)},"position-strategy":Be=>{var et;qt((et=Be)!==null&&et!==void 0?et:b)},"delay-show":Be=>{_e(Be===null?C:Number(Be))},"delay-hide":Be=>{ft(Be===null?D:Number(Be))},float:Be=>{ht(Be===null?E:Be==="true")},hidden:Be=>{Yt(Be===null?Y:Be==="true")},"class-name":Be=>{Zt(Be)}};Object.values(Ae).forEach((Be=>Be(null))),Object.entries(Te).forEach((([Be,et])=>{var pt;(pt=Ae[Be])===null||pt===void 0||pt.call(Ae,et)}))};S.useEffect((()=>{O(r)}),[r]),S.useEffect((()=>{L(a)}),[a]),S.useEffect((()=>{je(h)}),[h]),S.useEffect((()=>{Qe(f)}),[f]),S.useEffect((()=>{Ne(p)}),[p]),S.useEffect((()=>{_e(C)}),[C]),S.useEffect((()=>{ft(D)}),[D]),S.useEffect((()=>{ht(E)}),[E]),S.useEffect((()=>{Yt(Y)}),[Y]),S.useEffect((()=>{qt(b)}),[b]),S.useEffect((()=>{qe.current!==oe&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[oe]),S.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:oe==="core",disableBase:oe}}))}),[]),S.useEffect((()=>{var Te;const Ae=new Set(vt);let Be=t;if(!Be&&e&&(Be=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),Be)try{document.querySelectorAll(Be).forEach((tt=>{Ae.add({current:tt})}))}catch{console.warn(`[react-tooltip] "${Be}" is not a valid CSS selector`)}const et=document.querySelector(`[id='${n}']`);if(et&&Ae.add({current:et}),!Ae.size)return()=>null;const pt=(Te=Ft??et)!==null&&Te!==void 0?Te:bt.current,Wt=new MutationObserver((tt=>{tt.forEach((Me=>{var rt;if(!pt||Me.type!=="attributes"||!(!((rt=Me.attributeName)===null||rt===void 0)&&rt.startsWith("data-tooltip-")))return;const kt=fe(pt);Re(kt)}))})),Ge={attributes:!0,childList:!1,subtree:!1};if(pt){const tt=fe(pt);Re(tt),Wt.observe(pt,Ge)}return()=>{Wt.disconnect()}}),[vt,bt,Ft,n,t]),S.useEffect((()=>{ue?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),B&&!Pv("border",`${B}`)&&console.warn(`[react-tooltip] "${B}" is not a valid \`border\`.`),ue?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),re&&!Pv("opacity",`${re}`)&&console.warn(`[react-tooltip] "${re}" is not a valid \`opacity\`.`)}),[]);let ze=g;const X=S.useRef(null);if(o){const Te=o({content:Ft?.getAttribute("data-tooltip-content")||z||null,activeAnchor:Ft});ze=Te?De.createElement("div",{ref:X,className:"react-tooltip-content-wrapper"},Te):null}else z&&(ze=z);se&&(ze=De.createElement(a5,{content:se}));const me={forwardRef:W,id:e,anchorId:n,anchorSelect:t,className:Qf(l,Tt),classNameArrow:c,content:ze,contentWrapperRef:X,place:Oe,variant:Ke,offset:he,wrapper:Jt,events:Xt,openOnClick:w,positionStrategy:Et,middlewares:k,delayShow:Pe,delayHide:Je,float:ut,hidden:Ot,noArrow:ee,clickable:G,closeOnEsc:F,closeOnScroll:H,closeOnResize:U,openEvents:ae,closeEvents:J,globalCloseEvents:V,imperativeModeOnly:de,style:ue,position:le,isOpen:pe,defaultIsOpen:q,border:B,opacity:re,arrowColor:I,arrowSize:P,setIsOpen:ce,afterShow:A,afterHide:T,disableTooltip:j,activeAnchor:Ft,setActiveAnchor:Te=>ve(Te),role:N};return De.createElement(n5,{...me})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Fv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Fv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));const s5="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",yw=({isOpen:e,onClose:n,product:t})=>t?u.jsx(sr,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[u.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:u.jsx(Nt,{size:24})}),u.jsx("h2",{className:"text-xl font-semibold mb-4",children:" "}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.nazwa]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.ilosc]}),u.jsxs("p",{children:[u.jsx("strong",{children:". :"})," ",t.jednostka_miary]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod_kreskowy]}),t.data_waznosci&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.data_waznosci]}),t.waga_netto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_netto," "]}),t.waga_brutto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_brutto," "]}),t.objetosc&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.objetosc," "]}),t.opis&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.opis]})]})]})}):null,Ha="",ww=({isOpen:e,onClose:n,receipt:t})=>{const[r]=De.useState(null),[a,o]=De.useState(!1),[l,c]=De.useState({x:0,y:0}),[f,h]=De.useState(!1),p=De.useRef({x:0,y:0});De.useEffect(()=>{const v=b=>{f&&c({x:b.clientX-p.current.x,y:b.clientY-p.current.y})},w=()=>h(!1);return f&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",w)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",w)}},[f]);const m=v=>{v.target.closest("button")||v.target.closest("input")||(h(!0),p.current={x:v.clientX-l.x,y:v.clientY-l.y})};if(!t)return null;let g=[];if(Array.isArray(t.products))g=t.products;else if(typeof t.products=="string")try{g=JSON.parse(t.products)}catch{g=[]}return u.jsxs(sr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${l.x}px), calc(-50% + ${l.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:m,style:{cursor:f?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy zakupu"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Warto"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," "]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," "]})]})]}),(t.productInvoice||t.transportInvoice)&&u.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ha}/uploads/${t.productInvoice}`;console.log(" Opening product invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(tp,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ha}/uploads/${t.transportInvoice}`;console.log(" Opening transport invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(Jf,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),u.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),u.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilo"}),u.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),u.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Warto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data wanoci"})]})}),u.jsx("tbody",{children:g.map((v,w)=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.kod}),u.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:v.nazwa}),u.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:v.kod_kreskowy||"-"}),u.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:v.ilosc}),u.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[v.cena," "]}),u.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(v.ilosc*v.cena).toFixed(2).replace(".",",")," "]}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const b=v.typ;return b?{czerwone:"Czerwone",biale:"Biae",musujace:"Musujce",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment",rozowe:"Rowe",slodkie:"Sodkie",aksesoria:"Aksesoria",amber:"Amber"}[b]||b:"-"})()}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.objetosc||"-"}),u.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:v.dataWaznosci?typeof v.dataWaznosci=="number"?new Date(v.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(v.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},w))})]})]})]}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),u.jsx(yw,{isOpen:a,onClose:()=>o(!1),product:r})]})},o5=({isOpen:e,onClose:n,onAdd:t,initialData:r})=>{const[a,o]=S.useState(""),[l,c]=S.useState(""),[f,h]=S.useState(""),[p,m]=S.useState(""),[g,v]=S.useState("");S.useEffect(()=>{console.log(" useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log(" Setting initial data from props"),o(r.firma),c(r.nazwa),h(r.adres),m(r.czas_dostawy),v(r.kontakt)):e&&!r&&console.log(" Modal opened without initial data - keeping current values")},[e,r]);const w=()=>{if(console.log(" handleSubmit called with values:",{firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g}),console.log(" Trimmed values:",{firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()}),!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()){console.log(" Validation failed: some fields are empty");return}const k={firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()};console.log(" Submitting client data:",k),t(k),b()},b=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(sr,{isOpen:e,onRequestClose:b,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),u.jsx("button",{onClick:b,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:k=>{console.log(" firma onChange:",k.target.value),o(k.target.value)},placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:k=>c(k.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:k=>m(k.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:k=>v(k.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:w,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};Aa("pl",Oa);const _f=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],zv=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],kw=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=S.useState(null),[l,c]=S.useState(""),[f,h]=S.useState({x:0,y:0}),[p,m]=S.useState(!1),[g,v]=S.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),w=S.useRef({x:0,y:0}),[b,k]=S.useState(""),[C,D]=S.useState(null),[E,Y]=S.useState(null),[ee,G]=S.useState(null),[F,H]=S.useState(null),U=S.useRef(null),ae=S.useRef(null),[J,V]=S.useState(null),[de,ue]=S.useState(null),[le,pe]=S.useState("0,00"),[q,oe]=S.useState("0,00"),[B,re]=S.useState("0,00"),I=()=>{const he=g.reduce((Pe,_e)=>{const Je=parseFloat(_e.ilosc.toString().replace(",","."))||0;return Pe+Je},0),Ne=parseFloat(b.replace(",","."))||0;return he>0?(Ne/he).toFixed(2):"0,00"};S.useEffect(()=>{if(e&&r){let he=[];if(r.products)if(typeof r.products=="string")try{he=JSON.parse(r.products)}catch(Ne){console.error("Error parsing products JSON:",Ne),he=[]}else Array.isArray(r.products)&&(he=r.products);if(Array.isArray(he)&&he.length>0){let Ne=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[_e,Je,ft]=r.dataPrzyjecia.split("/");Ne=new Date(parseInt(ft),parseInt(Je)-1,parseInt(_e))}else r.dataPrzyjecia.includes("-")?Ne=new Date(r.dataPrzyjecia):Ne=new Date(r.dataPrzyjecia);if(o(Ne),c(r.sprzedawca||""),k((r.kosztDostawy||0).toFixed(2).replace(".",",")),r.aktualny_kurs!==void 0&&r.aktualny_kurs!==null)pe(Number(r.aktualny_kurs).toFixed(2).replace(".",","));else if(r.aktualnyKurs!==void 0&&r.aktualnyKurs!==null)pe(String(r.aktualnyKurs).replace(".",","));else{const _e=he.reduce((ht,Ot)=>ht+(Ot.ilosc||0),0),Je=_e?r.kosztDostawy/_e:0,ft=he[0]?.deliveryCostPerUnitPln||0,ut=Je?ft/Je:1;pe(ut.toFixed(2).replace(".",","))}if(r.podatek_akcyzowy!==void 0&&r.podatek_akcyzowy!==null)oe(Number(r.podatek_akcyzowy).toFixed(2).replace(".",","));else if(r.podatekAkcyzowy!==void 0&&r.podatekAkcyzowy!==null)oe(String(r.podatekAkcyzowy).replace(".",","));else{const _e=he[0]?.podatekAkcyzowyPerLiter??he[0]?.podatekAkcyzowy??he[0]?.podatek_akcyzowy??0;oe(_e.toFixed(2).replace(".",","))}r.rabat!==void 0&&r.rabat!==null?re(Number(r.rabat).toFixed(2).replace(".",",")):re("0,00");const Pe=he.map(_e=>({kod:_e.kod||"",nazwa:_e.nazwa||"",kod_kreskowy:_e.kod_kreskowy||_e.ean||"",ilosc:(_e.ilosc||0).toString(),cena:(_e.cena||0).toFixed(2).replace(".",","),dataWaznosci:_e.dataWaznosci||"",showDataWaznosci:!1,typ:_e.typ||_e.typTowaru||"",objetosc:_e.objetosc||""}));v(Pe.length>0?Pe:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),G(r.productInvoice||null),H(r.transportInvoice||null),D(null),Y(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),k(""),D(null),Y(null),G(null),H(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),k(""),D(null),Y(null),G(null),H(null)},[e,r]),S.useEffect(()=>{const he=Pe=>{const _e=Pe.target;if(!_e.closest(".dropdown-container")&&!_e.closest('button[onclick*="toggleDropdown"]')&&V(null),!_e.closest(".objetosc-dropdown-container")&&!_e.closest('button[onclick*="toggleObjetoscDropdown"]')&&ue(null),!_e.closest(".react-datepicker")&&!_e.closest('button[title*="wanoci"]')){const Je=[...g];let ft=!1;Je.forEach(ut=>{ut.showDataWaznosci&&(ut.showDataWaznosci=!1,ft=!0)}),ft&&v(Je)}},Ne=Pe=>{if(Pe.key==="Escape"){V(null),ue(null);const _e=[...g];let Je=!1;_e.forEach(ft=>{ft.showDataWaznosci&&(ft.showDataWaznosci=!1,Je=!0)}),Je&&v(_e)}};return document.addEventListener("mousedown",he),document.addEventListener("keydown",Ne),()=>{document.removeEventListener("mousedown",he),document.removeEventListener("keydown",Ne)}},[g]);const P=()=>{v([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},ce=he=>{if(g.length>1){const Ne=[...g];Ne.splice(he,1),v(Ne)}},A=he=>{const Ne=[...g];Ne[he].showDataWaznosci=!Ne[he].showDataWaznosci,v(Ne)},T=(he,Ne)=>{const Pe=[...g];Pe[he].typ=Ne,v(Pe),V(null)},j=he=>{V(J===he?null:he)},N=(he,Ne)=>{const Pe=[...g];Pe[he].objetosc=Ne,v(Pe),ue(null)},W=he=>{ue(de===he?null:he)},z=he=>{he.target.closest("button")||he.target.closest("input")||he.target.closest(".react-datepicker")||he.target.closest('[role="button"]')||he.target.closest(".react-datepicker__input-container")||(m(!0),w.current={x:he.clientX-f.x,y:he.clientY-f.y})};S.useEffect(()=>{const he=Pe=>{p&&requestAnimationFrame(()=>{h({x:Pe.clientX-w.current.x,y:Pe.clientY-w.current.y})})},Ne=()=>{m(!1)};return p&&(window.addEventListener("mousemove",he),window.addEventListener("mouseup",Ne)),()=>{window.removeEventListener("mousemove",he),window.removeEventListener("mouseup",Ne)}},[p]);const O=he=>{const Ne=he.target.files?.[0];console.log(" Product file selected (edit):",Ne),Ne&&Ne.type==="application/pdf"?(D(Ne),console.log(" Product invoice set (edit):",Ne.name)):console.log(" Invalid product file type (edit):",Ne?.type)},se=he=>{const Ne=he.target.files?.[0];console.log(" Transport file selected (edit):",Ne),Ne&&Ne.type==="application/pdf"?(Y(Ne),console.log(" Transport invoice set (edit):",Ne.name)):console.log(" Invalid transport file type (edit):",Ne?.type)},L=()=>{U.current?.click()},Oe=()=>{ae.current?.click()},je=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const he=g.filter(ut=>ut.kod&&ut.nazwa&&ut.ilosc&&ut.cena);if(console.log("productRows:",g),console.log("validProducts:",he),console.log("validProducts.length:",he.length),he.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const Ne=he.map(ut=>({kod:ut.kod,nazwa:ut.nazwa,kod_kreskowy:ut.kod_kreskowy||"",ilosc:parseFloat(ut.ilosc)||0,cena:parseFloat(ut.cena.replace(",","."))||0,dataWaznosci:ut.dataWaznosci||void 0,typ:ut.typ||void 0,objetosc:ut.objetosc?parseFloat(ut.objetosc):void 0})),Pe=Ne.reduce((ut,ht)=>ut+ht.ilosc*ht.cena,0),_e=parseFloat(b.replace(",","."))||0,Je=parseFloat(B.replace(",","."))||0,ft=Pe*(1-Je/100);console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ft,rabat:Je+"%",kosztDostawy:_e,products:Ne}),console.log(" Files to submit (edit):",{productInvoice:C,transportInvoice:E}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ft,kosztDostawy:_e,aktualnyKurs:parseFloat(le.replace(",","."))||1,podatekAkcyzowy:parseFloat(q.replace(",","."))||0,rabat:Je,products:Ne,productInvoice:C||null,transportInvoice:E||null}),Ke()},Ke=()=>{o(null),h({x:0,y:0}),v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k(""),c(""),D(null),Y(null),G(null),H(null),n()},Qe=()=>g.reduce((he,Ne)=>{const Pe=parseFloat(Ne.ilosc)||0,_e=parseFloat(Ne.cena.replace(",","."))||0;return he+Pe*_e},0).toFixed(2);return u.jsx(sr,{isOpen:e,onRequestClose:Ke,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:z,style:{cursor:p?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:he=>he.stopPropagation(),children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),u.jsx("button",{type:"button",onClick:he=>{he.preventDefault(),he.stopPropagation(),Ke()},className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx(pn,{selected:a,onChange:he=>o(he),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:b,onKeyPress:he=>{const Ne=String.fromCharCode(he.which);(!/[\d,]/.test(Ne)||Ne===","&&he.target.value.includes(",")||he.target.value===""&&Ne===",")&&he.preventDefault()},onChange:he=>{const Ne=he.target,Pe=Ne.selectionStart??0;let _e=Ne.value.replace(/[^\d,]/g,"");if(_e===""){k("");return}if(!_e.includes(","))_e=_e+",00";else{const[ft,ut]=_e.split(",");ut&&ut.length>2&&(_e=`${ft},${ut.slice(0,2)}`)}k(_e),requestAnimationFrame(()=>{const ft=Math.min(Pe,_e.length);Ne.setSelectionRange(ft,ft)})},className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:O,className:"hidden",ref:U}),u.jsx("button",{type:"button",onClick:L,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(tp,{className:"h-4 w-4 text-gray-500"})}),C&&u.jsx("a",{href:URL.createObjectURL(C),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:C.name,children:C.name}),!C&&ee&&u.jsx("a",{href:`${Ha}${ee}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:se,className:"hidden",ref:ae}),u.jsx("button",{type:"button",onClick:Oe,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Jf,{className:"h-4 w-4 text-gray-500"})}),E&&u.jsx("a",{href:URL.createObjectURL(E),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:E.name,children:E.name}),!E&&F&&u.jsx("a",{href:`${Ha}${F}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:l,onChange:he=>c(he.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[I().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:le,onChange:he=>pe(he.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-8 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:q,onChange:he=>oe(he.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:B,onChange:he=>re(he.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((he,Ne)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:he.kod,onChange:Pe=>{const _e=[...g];_e[Ne].kod=Pe.target.value,v(_e)}}),Ne===g.length-1&&u.jsx("button",{onClick:P,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(Hn,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:he.nazwa,onChange:Pe=>{const _e=[...g];_e[Ne].nazwa=Pe.target.value,v(_e)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:he.kod_kreskowy,onChange:Pe=>{const _e=[...g];_e[Ne].kod_kreskowy=Pe.target.value,v(_e)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:he.ilosc,onChange:Pe=>{const _e=[...g],Je=Pe.target.value;(Je===""||/^\d*$/.test(Je))&&(_e[Ne].ilosc=Je,v(_e))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:he.cena,onKeyPress:Pe=>{const _e=String.fromCharCode(Pe.which);(!/[\d,]/.test(_e)||_e===","&&Pe.target.value.includes(",")||Pe.target.value===""&&_e===",")&&Pe.preventDefault()},onChange:Pe=>{const _e=Pe.target,Je=_e.selectionStart??0;let ft=Pe.target.value.replace(/[^\d,]/g,"");if(ft===""){const Ot=[...g];Ot[Ne].cena="",v(Ot);return}if(!ft.includes(","))ft=ft+",00";else{const[Ot,Yt]=ft.split(",");Yt&&Yt.length>2&&(ft=`${Ot},${Yt.slice(0,2)}`)}const ht=[...g];ht[Ne].cena=ft,v(ht),requestAnimationFrame(()=>{const Ot=Math.min(Je,ft.length);_e.setSelectionRange(Ot,Ot)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const Pe=parseFloat(he.ilosc)||0,_e=parseFloat(he.cena.replace(",","."))||0;return(Pe*_e).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>A(Ne),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${he.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:he.dataWaznosci?`Termin wanoci: ${he.dataWaznosci}`:"Dodaj termin wanoci",children:u.jsx(Zf,{size:16})}),u.jsx("button",{onClick:()=>ce(Ne),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(Nt,{size:16})})]}),he.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx(pn,{selected:he.dataWaznosci?new Date(he.dataWaznosci):null,onChange:Pe=>{const _e=[...g];_e[Ne].dataWaznosci=Pe?Pe.toISOString().split("T")[0]:"",_e[Ne].showDataWaznosci=!1,v(_e)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const Pe=[...g];Pe[Ne].showDataWaznosci=!1,v(Pe)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>j(Ne),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${he.typ&&_f.find(Pe=>Pe.value===he.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:he.typ&&_f.find(Pe=>Pe.value===he.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),J===Ne&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:Pe=>Pe.stopPropagation(),children:_f.map(Pe=>u.jsx("button",{type:"button",onClick:()=>T(Ne,Pe.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${Pe.color}`,children:Pe.label},Pe.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>W(Ne),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${he.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:he.objetosc?zv.find(Pe=>Pe.value===he.objetosc)?.label||he.objetosc:"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),de===Ne&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:Pe=>Pe.stopPropagation(),style:{maxWidth:"200px"},children:zv.map(Pe=>u.jsx("button",{type:"button",onClick:()=>N(Ne,Pe.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:Pe.label},Pe.value))})]})]})]},Ne))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[Qe().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:je,disabled:!a||!g.some(he=>he.kod&&he.nazwa&&he.ilosc&&he.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(he=>he.kod&&he.nazwa&&he.ilosc&&he.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},i5=({receipts:e,onDelete:n,onUpdate:t,selectedCategory:r=""})=>{const[a,o]=S.useState(null),[l,c]=S.useState(!1),[f,h]=S.useState(!1),[p,m]=S.useState(null),[g,v]=S.useState(!1),[w,b]=S.useState(null),[k,C]=S.useState(""),[D,E]=S.useState({x:0,y:0}),[Y,ee]=S.useState(!1),G=S.useRef({x:0,y:0}),[F,H]=S.useState("dataPrzyjecia"),[U,ae]=S.useState("desc"),[J,V]=S.useState(""),[de,ue]=S.useState(""),le=N=>{o(N),c(!0)},pe=N=>{m(N),h(!0)},q=N=>{b(N),v(!0),C("")},oe=()=>{k==="5202"?(w?.id&&(n(w.id),He.success("Zapis zosta usunity")),B()):(He.error("Nieprawidowe haso"),C(""))},B=()=>{v(!1),b(null),C(""),E({x:0,y:0})},re=N=>{N.key==="Enter"&&oe()},I=N=>{F===N?ae(U==="asc"?"desc":"asc"):(H(N),ae("asc"))},P=N=>{N.target.closest("button")||N.target.closest("input")||(ee(!0),G.current={x:N.clientX-D.x,y:N.clientY-D.y})};S.useEffect(()=>{const N=z=>{Y&&requestAnimationFrame(()=>{E({x:z.clientX-G.current.x,y:z.clientY-G.current.y})})},W=()=>{ee(!1)};return Y&&(window.addEventListener("mousemove",N),window.addEventListener("mouseup",W)),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",W)}},[Y]);const ce=Array.from(new Set(e.map(N=>new Date(N.dataPrzyjecia).getFullYear().toString()))).sort((N,W)=>parseInt(W)-parseInt(N)),A=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],j=e.filter(N=>{if(r)if(typeof N.products=="string")try{if(!JSON.parse(N.products).some(O=>O.typ===r))return!1}catch{return!1}else if(Array.isArray(N.products)){if(!N.products.some(z=>z.typ===r))return!1}else return!1;return!(J&&new Date(N.dataPrzyjecia).getFullYear().toString()!==J||de&&(new Date(N.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==de)}).sort((N,W)=>{let z,O;switch(F){case"dataPrzyjecia":z=new Date(N.dataPrzyjecia),O=new Date(W.dataPrzyjecia);break;case"sprzedawca":z=(N.sprzedawca||"").toLowerCase(),O=(W.sprzedawca||"").toLowerCase();break;case"wartosc":z=N.wartosc,O=W.wartosc;break;case"kosztDostawy":z=N.kosztDostawy,O=W.kosztDostawy;break;default:z=N[F]||"",O=W[F]||""}return typeof z=="string"&&typeof O=="string"?U==="asc"?z.localeCompare(O):O.localeCompare(z):typeof z=="number"&&typeof O=="number"?U==="asc"?z-O:O-z:z instanceof Date&&O instanceof Date?U==="asc"?z.getTime()-O.getTime():O.getTime()-z.getTime():0});return u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("dataPrzyjecia"),children:"Data zakupu"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("sprzedawca"),children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("wartosc"),children:"Warto"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("kosztDostawy"),children:"Koszt dostawy"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:J,onChange:N=>V(N.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),ce.map(N=>u.jsx("option",{value:N,style:{fontFamily:"Sora, sans-serif"},children:N},N))]}),u.jsxs("select",{value:de,onChange:N=>ue(N.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Miesic"}),A.map(N=>u.jsx("option",{value:N.value,style:{fontFamily:"Sora, sans-serif"},children:N.label},N.value))]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(N=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:N.dataPrzyjecia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:N.sprzedawca}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[N.wartosc.toFixed(2)," "]}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[N.kosztDostawy.toFixed(2)," "]}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:W=>{W.preventDefault(),W.stopPropagation(),le(N)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(ep,{size:16})}),u.jsx("button",{type:"button",onClick:W=>{W.preventDefault(),W.stopPropagation(),pe(N)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:W=>{W.preventDefault(),W.stopPropagation(),q(N)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Nt,{size:16})})]})})]},N.id))})]})}),u.jsx(sr,{isOpen:g,onRequestClose:B,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${D.x}px), calc(-50% + ${D.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:P,style:{cursor:Y?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:B,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:k,onChange:N=>C(N.target.value),onKeyPress:re,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:B,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:oe,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(ww,{isOpen:l,onClose:()=>c(!1),receipt:a}),u.jsx(kw,{isOpen:f,onClose:()=>{h(!1),m(null)},onSubmit:N=>{t({...N,productInvoice:N.productInvoice??void 0,transportInvoice:N.transportInvoice??void 0}),h(!1),m(null)},receipt:p?{id:p.id||0,dataPrzyjecia:p.dataPrzyjecia,sprzedawca:p.sprzedawca,wartosc:p.wartosc,kosztDostawy:p.kosztDostawy,aktualnyKurs:p.aktualnyKurs,podatekAkcyzowy:p.podatekAkcyzowy,aktualny_kurs:p.aktualny_kurs,podatek_akcyzowy:p.podatek_akcyzowy,products:p.products,productInvoice:p.productInvoice,transportInvoice:p.transportInvoice}:null})]})},l5=({isOpen:e,onClose:n,client:t})=>t?u.jsx(sr,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy klienta"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,bw=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=S.useState(""),[l,c]=S.useState(""),[f,h]=S.useState(""),[p,m]=S.useState(""),[g,v]=S.useState("");S.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),h(r.adres||""),m(r.czas_dostawy||""),v(r.kontakt||"")):(o(""),c(""),h(""),m(""),v(""))},[e,r]);const w=async()=>{if(a.trim()&&l.trim()&&f.trim()&&p.trim()&&g.trim()&&r){const k={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g};t(k),b()}},b=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(sr,{isOpen:e,onRequestClose:b,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),u.jsx("button",{onClick:b,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:k=>o(k.target.value),placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:k=>c(k.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:k=>m(k.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:k=>v(k.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:w,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},c5=({clients:e,onDelete:n,onUpdate:t})=>{console.log(" ClientsList render - clients:",e),console.log(" ClientsList render - clients length:",e.length),console.log(" ClientsList render - first client:",e[0]),console.log(" ClientsList render - all clients:",e.map(B=>({id:B.id,firma:B.firma,nazwa:B.nazwa})));const[r,a]=S.useState(null),[o,l]=S.useState(!1),[c,f]=S.useState(!1),[h,p]=S.useState(null),[m,g]=S.useState(!1),[v,w]=S.useState(null),[b,k]=S.useState(""),[C,D]=S.useState({x:0,y:0}),[E,Y]=S.useState(!1),ee=S.useRef({x:0,y:0}),[G,F]=S.useState(""),[H,U]=S.useState("asc");S.useEffect(()=>{console.log(" ClientsList useEffect - clients changed:",e),console.log(" ClientsList useEffect - clients length:",e.length)},[e]);const ae=B=>{a(B),l(!0)},J=B=>{p(B),f(!0)},V=B=>{w(B),g(!0),k("")},de=()=>{b==="5202"?(v?.id&&n(v.id),ue()):(He.error("Nieprawidowe haso"),k(""))},ue=()=>{g(!1),w(null),k(""),D({x:0,y:0})},le=B=>{B.key==="Enter"&&de()},pe=B=>{G===B?U(H==="asc"?"desc":"asc"):(F(B),U("asc"))},q=B=>{B.target.closest("button")||B.target.closest("input")||(Y(!0),ee.current={x:B.clientX-C.x,y:B.clientY-C.y})};S.useEffect(()=>{const B=I=>{E&&requestAnimationFrame(()=>{D({x:I.clientX-ee.current.x,y:I.clientY-ee.current.y})})},re=()=>{Y(!1)};return E&&(window.addEventListener("mousemove",B),window.addEventListener("mouseup",re)),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",re)}},[E]),console.log(" Sorting logic - sortField:",G,"sortDirection:",H),console.log(" Sorting logic - clients length:",e.length);const oe=G?[...e].sort((B,re)=>{let I,P;switch(G){case"firma":I=(B.firma||"").toLowerCase(),P=(re.firma||"").toLowerCase();break;case"nazwa":I=(B.nazwa||"").toLowerCase(),P=(re.nazwa||"").toLowerCase();break;case"adres":I=(B.adres||"").toLowerCase(),P=(re.adres||"").toLowerCase();break;case"czas_dostawy":I=(B.czas_dostawy||"").toLowerCase(),P=(re.czas_dostawy||"").toLowerCase();break;case"kontakt":I=(B.kontakt||"").toLowerCase(),P=(re.kontakt||"").toLowerCase();break;default:I=B[G]||"",P=re[G]||""}return typeof I=="string"&&typeof P=="string"?H==="asc"?I.localeCompare(P):P.localeCompare(I):0}):e;return console.log(" Final sortedClients length:",oe.length),console.log(" Final sortedClients first:",oe[0]),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${G==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>pe("firma"),children:["Nazwa firmy ",G==="firma"&&(H==="asc"?"":"")]}),u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${G==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>pe("nazwa"),children:["Nazwa ",G==="nazwa"&&(H==="asc"?"":"")]}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("adres"),children:"Adres"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("czas_dostawy"),children:"Czas dostawy"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("kontakt"),children:"Kontakt"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:G&&u.jsx("button",{onClick:()=>{F(""),U("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:" ",children:""})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:oe.map((B,re)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.firma}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.nazwa}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.adres}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.czas_dostawy}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.kontakt}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),ae(B)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(ep,{size:16})}),u.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),J(B)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),V(B)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Nt,{size:16})})]})})]},B.id||`client-${re}`))})]})}),u.jsx(sr,{isOpen:m,onRequestClose:ue,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${C.x}px), calc(-50% + ${C.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:q,style:{cursor:E?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:ue,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:b,onChange:B=>k(B.target.value),onKeyPress:le,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:ue,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:de,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(l5,{isOpen:o,onClose:()=>l(!1),client:r}),u.jsx(bw,{isOpen:c,onClose:()=>{f(!1),p(null)},onSubmit:B=>{t(B),f(!1),p(null)},client:h})]})};Aa("pl",Oa);const Sf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],u5=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],d5=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=S.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:"",koszt_dostawy_per_unit:"",podatek_akcyzowy_per_liter:"2.22",kurs:"4.25"}),[l,c]=S.useState(!1),[f,h]=S.useState(!1),[p,m]=S.useState(!1),[g,v]=S.useState(!1),[w,b]=S.useState(null);S.useEffect(()=>{if(t){const F=async()=>{try{const H=await fetch(`/api/working-sheets/kurs/${encodeURIComponent(t.kod)}`);if(H.ok){const U=await H.json();console.log(` Loaded exchange rate for ${t.kod}: ${U.kurs}`),o(ae=>({...ae,kurs:U.kurs.toString()}))}else console.warn(` Failed to load exchange rate for ${t.kod}, using default 4.25`)}catch(H){console.error("Error loading exchange rate:",H)}};if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const H=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(H).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():"",koszt_dostawy_per_unit:t.koszt_dostawy_per_unit?t.koszt_dostawy_per_unit.toString():"",podatek_akcyzowy_per_liter:t.podatek_akcyzowy&&t.objetosc&&t.objetosc>0?(t.podatek_akcyzowy/t.objetosc).toFixed(2):"2.22",kurs:"4.25"}),F(),t.data_waznosci){let H;if(typeof t.data_waznosci=="string")H=new Date(t.data_waznosci);else{const U=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;H=new Date(U)}b(isNaN(H.getTime())?null:H)}else b(null)}},[t]);const k=F=>{o(H=>({...H,typ:F})),h(!1)},C=()=>{h(!f)},D=F=>{o(H=>({...H,objetosc:F})),m(!1)},E=()=>{m(!p)},Y=()=>{v(!g)},ee=F=>{b(F),o(H=>({...H,data_waznosci:F?F.toISOString().split("T")[0]:""})),v(!1)};S.useEffect(()=>{const F=U=>{const ae=U.target;f&&!ae.closest(".dropdown-container")&&h(!1),p&&!ae.closest(".dropdown-container")&&m(!1),g&&!ae.closest(".react-datepicker")&&!ae.closest('button[title*="wanoci"]')&&v(!1)},H=U=>{U.key==="Escape"&&(h(!1),m(!1),v(!1))};return(f||p||g)&&(document.addEventListener("mousedown",F),document.addEventListener("keydown",H)),()=>{document.removeEventListener("mousedown",F),document.removeEventListener("keydown",H)}},[f,p,g]);const G=async F=>{if(F&&F.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(String(a.objetosc||"0").replace(",","."))||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(String(a.cena||"0").replace(",","."))||void 0,cena_sprzedazy:parseFloat(String(a.cena_sprzedazy||"0").replace(",","."))||void 0,koszt_dostawy_per_unit:parseFloat(String(a.koszt_dostawy_per_unit||"0").replace(",","."))||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(String(a.podatek_akcyzowy_per_liter||"0").replace(",","."))*parseFloat(String(a.objetosc||"0").replace(",",".")):void 0,kurs:parseFloat(a.kurs)||4.25})})).ok)throw new Error("Failed to update item");const U={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0,koszt_dostawy_per_unit:parseFloat(a.koszt_dostawy_per_unit)||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(a.podatek_akcyzowy_per_liter)*parseFloat(a.objetosc):void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(ae){console.error("Error creating price history record:",ae)}r(U),He.success("Pozycja zostaa zaktualizowana pomylnie"),n()}catch(H){console.error("Error updating item:",H),He.error("Bd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:u.jsx(sr,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycj"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsx("form",{onSubmit:G,className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),u.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-[2]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:a.sprzedawca,onChange:F=>o(H=>({...H,sprzedawca:F.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:C,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&Sf.find(F=>F.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:a.typ&&Sf.find(F=>F.value===a.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:F=>F.stopPropagation(),children:Sf.map(F=>u.jsx("button",{type:"button",onClick:()=>k(F.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${F.color}`,children:F.label},F.value))})]})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:E,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[u.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:F=>F.stopPropagation(),children:u5.map(F=>u.jsx("button",{type:"button",onClick:()=>D(F.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:F.label},F.value))})]})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data wanoci"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:w?w.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz dat",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),u.jsx("button",{type:"button",onClick:Y,className:`p-1 focus:outline-none ${w?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:w?`Termin wanoci: ${w.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(Zf,{size:16})})]}),g&&u.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:u.jsx(pn,{selected:w,onChange:ee,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>v(!1)})})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa ()"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:F=>o(H=>({...H,cena:F.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzeday (z)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:F=>o(H=>({...H,cena_sprzedazy:F.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]}),u.jsx("div",{className:"flex gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kurs walutowy"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.kurs,onChange:F=>o(H=>({...H,kurs:F.target.value})),placeholder:"4.25",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.koszt_dostawy_per_unit,onChange:F=>o(H=>({...H,koszt_dostawy_per_unit:F.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.podatek_akcyzowy_per_liter,onChange:F=>o(H=>({...H,podatek_akcyzowy_per_liter:F.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:G,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},f5=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .resizable-table {
    table-layout: fixed !important;
    width: max-content !important;
    min-width: 100% !important;
  }
  
  .resizable-table th,
  .resizable-table td {
    box-sizing: border-box !important;
    overflow: visible !important;
  }
  
  /* no generic resizable columns */
`,Ef=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],Mv=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}return""}catch(n){return console.error("Error extracting date from order number:",n),""}},p5=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},h5=({refreshTrigger:e,productReceipts:n=[]})=>{S.useEffect(()=>{const X=document.createElement("style");return X.textContent=f5,document.head.appendChild(X),()=>{document.head.removeChild(X)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=S.useState([]),[a,o]=S.useState([]),[l,c]=S.useState([]),[f,h]=S.useState(!0),[p,m]=S.useState(null),[g,v]=S.useState(!1),[w,b]=S.useState(null),[k,C]=S.useState(""),[D,E]=S.useState(""),[Y,ee]=S.useState(()=>localStorage.getItem("sortField")||"nazwa"),[G,F]=S.useState(()=>localStorage.getItem("sortDirection")||"asc"),[H,U]=S.useState([]),[ae,J]=S.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[V,de]=S.useState(!1),[ue,le]=S.useState(null),[pe,q]=S.useState({}),[oe,B]=S.useState({}),[re,I]=S.useState({}),[P,ce]=S.useState({}),[A,T]=S.useState({}),[j,N]=S.useState(()=>{const X=localStorage.getItem("columnWidths");if(X)try{return JSON.parse(X)}catch(me){console.error("Error parsing saved column widths:",me)}return{nazwa:250}}),[W,z]=S.useState(null),[O,se]=S.useState(0),[L,Oe]=S.useState(0),[je,Ke]=S.useState(!1),Qe=S.useRef(null),[he,Ne]=S.useState(()=>{const X=new Date;return`${X.getFullYear()}-${String(X.getMonth()+1).padStart(2,"0")}-${String(X.getDate()).padStart(2,"0")}`});S.useEffect(()=>{const X=()=>{const Te=new Date,Ae=`${Te.getFullYear()}-${String(Te.getMonth()+1).padStart(2,"0")}-${String(Te.getDate()).padStart(2,"0")}`;Ne(Be=>Be!==Ae?(console.log(` Date changed: ${Be}  ${Ae}, triggering averageSalesCache recalculation`),Ae):Be)};X();const me=setInterval(X,6e4);return()=>clearInterval(me)},[]);const Pe=S.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const X=new Map;try{for(const me of n)if(Array.isArray(me.products))for(const Te of me.products)Te.kod&&!X.has(Te.kod)&&X.set(Te.kod,me.sprzedawca)}catch(me){console.error("Error building sprzedawcaCache:",me)}return console.log("sprzedawcaCache built with",X.size,"entries"),X},[n]),_e=S.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const X=new Map;try{for(const me of t){const Te=A[me.kod],Ae=Te?new Date(Te):null;if(Ae&&!isNaN(Ae.getTime())){const et=Math.max(1,Math.ceil((new Date().getTime()-Ae.getTime())/(1e3*60*60*24))),pt=a.filter(Wt=>Wt.kod===me.kod).reduce((Wt,Ge)=>Wt+Ge.ilosc,0);X.set(me.kod,pt/et)}else X.set(me.kod,0)}}catch(me){console.error("Error building averageSalesCache:",me)}return console.log("averageSalesCache built with",X.size,"entries"),X},[t,a,A,he]),Je=async()=>{try{const X=await fetch("/api/products");if(X.ok){const me=await X.json(),Te={};me.forEach(Ae=>{Ae.status!=="samples"&&(Te[Ae.kod]||(Te[Ae.kod]=[]),Te[Ae.kod].push({cena:Ae.cena,ilosc_aktualna:Ae.ilosc_aktualna,data_zmiany:Ae.updated_at||Ae.created_at}))}),Object.keys(Te).forEach(Ae=>{Te[Ae].sort((Be,et)=>new Date(et.data_zmiany).getTime()-new Date(Be.data_zmiany).getTime())}),q(Te)}}catch(X){console.error("Error loading all products:",X)}},ft=X=>{const me=a.filter(Ae=>Ae.kod===X);if(me.length===0)return null;let Te=null;return me.forEach(Ae=>{let Be=null;Ae.numer_zamowienia&&(Be=p5(Ae.numer_zamowienia)),!Be&&Ae.created_at&&(Be=new Date(Ae.created_at)),Be&&(!Te||Be>Te)&&(Te=Be)}),Te},ut=async()=>{try{console.log("Starting loadInventory..."),h(!0),m(null),console.log("Fetching working-sheets...");const X=await fetch("/api/working-sheets");if(!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const me=await X.json();console.log("Inventory data from server:",me.length,"items"),me.length>0&&(console.log("First item keys:",Object.keys(me[0])),console.log("First item typ value:",me[0].typ),me[0].data_waznosci&&(console.log("First item data_waznosci:",me[0].data_waznosci),console.log("First item data_waznosci type:",typeof me[0].data_waznosci),console.log("First item data_waznosci formatted:",Re(me[0].data_waznosci)))),r(me),console.log("Fetching orders...");const Te=await fetch("/api/orders");if(!Te.ok)throw new Error(`HTTP error! status: ${Te.status}`);const Ae=await Te.json();console.log("Orders data from server:",Ae.length,"items"),c(Ae),console.log("Fetching orders-with-products...");const Be=await fetch("/api/orders-with-products");if(!Be.ok)throw new Error(`HTTP error! status: ${Be.status}`);const et=await Be.json();console.log("Orders with products from server:",et.length,"items");const pt=[];et.forEach(Me=>{Me.products&&Me.products.forEach(rt=>{pt.push({...rt,orderId:Me.id,created_at:rt.created_at||Me.data_utworzenia,numer_zamowienia:Me.numer_zamowienia})})}),console.log("Total order products:",pt.length),o(pt),await Je();const Wt=await fetch("/api/products/samples-count");if(Wt.ok){const Me=await Wt.json(),rt={};Me.forEach(kt=>{rt[kt.kod]=kt.total_ilosc||0}),B(rt)}try{const Me=await fetch("/api/products/reservations-count");if(Me.ok){const rt=await Me.json(),kt={};rt.forEach(R=>{kt[R.kod]=R.total_ilosc||0}),I(kt),console.log(" Reservations count loaded:",kt)}else console.error(" Failed to load reservations count:",Me.status)}catch(Me){console.error(" Error loading reservations count:",Me)}const Ge=await fetch("/api/products/wartosc-towaru");if(Ge.ok){const Me=await Ge.json(),rt={};Me.forEach(kt=>{rt[kt.kod]=kt.wartosc||0}),ce(rt)}const tt=await fetch("/api/products/oldest-date");if(tt.ok){const Me=await tt.json(),rt={};Me.forEach(kt=>{rt[kt.kod]=kt.oldest_created_at||""}),T(rt),console.log(" Oldest product dates loaded:",Object.keys(rt).length)}console.log("loadInventory completed successfully")}catch(X){console.error("Error loading inventory:",X),m(`Failed to load inventory: ${X instanceof Error?X.message:"Unknown error"}`)}finally{h(!1)}};S.useEffect(()=>{ut()},[]),S.useEffect(()=>{e&&ut()},[e]);const ht=X=>{if(Y===X){const me=G==="asc"?"desc":"asc";F(me),localStorage.setItem("sortDirection",me)}else ee(X),F("asc"),localStorage.setItem("sortField",X),localStorage.setItem("sortDirection","asc")},Ot=X=>{const me=Ef.find(Te=>Te.value===X);return me?me.color:"bg-gray-100 text-gray-800 border-gray-200"},Yt=X=>X===1/0?"bg-gray-100 text-gray-800 border-gray-200":X<=30?"bg-red-100 text-gray-800 border-red-200":X<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",Jt=S.useMemo(()=>{const X=new Set;return t.forEach(me=>{const Te=me.sprzedawca||Pe.get(me.kod);Te&&X.add(Te)}),Array.from(X).sort()},[t,Pe]),Lt=S.useMemo(()=>{const X=new Set;return t.forEach(me=>{me.typ&&X.add(me.typ)}),Array.from(X).sort()},[t]),Xt=S.useMemo(()=>{const X=new Set;return t.forEach(me=>{me.objetosc&&X.add(me.objetosc.toString())}),Array.from(X).sort((me,Te)=>parseFloat(me)-parseFloat(Te))},[t]),dt=S.useMemo(()=>{const X=new Set;return t.forEach(me=>{if(me.ilosc===0)X.add("brak");else{const Te=_e.get(me.kod)||0,Ae=Te<=0?1/0:Math.floor(me.ilosc/Te),Be=Ae===1/0?"Brak danych":Ae<=30?"mao":Ae<=60?"rednie":"duo";X.add(Be)}}),Array.from(X).sort()},[t,_e]),Et=t.filter(X=>{if(!(X.kod.toLowerCase().includes(D.toLowerCase())||X.nazwa.toLowerCase().includes(D.toLowerCase())||X.kod_kreskowy&&X.kod_kreskowy.toLowerCase().includes(D.toLowerCase()))||ae.sprzedawca&&(X.sprzedawca||Pe.get(X.kod))!==ae.sprzedawca||ae.typ&&X.typ!==ae.typ||ae.objetosc&&X.objetosc?.toString()!==ae.objetosc)return!1;if(ae.status){let Te;if(X.ilosc===0)Te="brak";else{const Ae=_e.get(X.kod)||0,Be=Ae<=0?1/0:Math.floor(X.ilosc/Ae);Te=Be===1/0?"Brak danych":Be<=30?"mao":Be<=60?"rednie":"duo"}if(Te!==ae.status)return!1}return!0}).sort((X,me)=>{let Te,Ae;switch(Y){case"sprzedawca":Te=X.sprzedawca||Pe.get(X.kod)||"",Ae=me.sprzedawca||Pe.get(me.kod)||"";break;case"cena":Te=X.cena||0,Ae=me.cena||0;break;case"cena_sprzedazy":Te=X.cena_sprzedazy||0,Ae=me.cena_sprzedazy||0;break;case"koszt_wlasny":Te=X.koszt_wlasny||0,Ae=me.koszt_wlasny||0;break;case"srednieZuzycie":Te=_e.get(X.kod)||0,Ae=_e.get(me.kod)||0;break;case"dniPozostalo":const Be=_e.get(X.kod)||0,et=_e.get(me.kod)||0;Te=Be<=0?1/0:Math.floor(X.ilosc/Be),Ae=et<=0?1/0:Math.floor(me.ilosc/et);break;case"dataWyczerpania":if(X.ilosc===0){const Me=ft(X.kod);Te=Me?Me.getTime():0}else{const Me=_e.get(X.kod)||0,rt=Me<=0?1/0:Math.floor(X.ilosc/Me);Te=rt===1/0?1/0:new Date().setDate(new Date().getDate()+rt)}if(me.ilosc===0){const Me=ft(me.kod);Ae=Me?Me.getTime():0}else{const Me=_e.get(me.kod)||0,rt=Me<=0?1/0:Math.floor(me.ilosc/Me);Ae=rt===1/0?1/0:new Date().setDate(new Date().getDate()+rt)}break;case"status":const pt=Me=>{if(Me.ilosc===0)return 0;const rt=_e.get(Me.kod)||0,kt=rt<=0?1/0:Math.floor(Me.ilosc/rt);return kt===1/0?4:kt<=30?1:kt<=60?2:3};Te=pt(X),Ae=pt(me);break;case"typ":Te=X.typ||"",Ae=me.typ||"";break;case"objetosc":Te=X.objetosc||0,Ae=me.objetosc||0;break;case"dataWaznosci":const Wt=Me=>{if(!Me)return 0;let rt;if(typeof Me=="string")rt=new Date(Me);else if(typeof Me=="number")Me<1e12?rt=new Date(Me*1e3):rt=new Date(Me);else return 0;return isNaN(rt.getTime())?0:rt.getTime()};Te=Wt(X.data_waznosci),Ae=Wt(me.data_waznosci);break;case"sprzedaze":const Ge=a.filter(Me=>Me.kod===X.kod).length,tt=a.filter(Me=>Me.kod===me.kod).length;Te=Ge,Ae=tt;break;default:Te=X[Y],Ae=me[Y]}return typeof Te=="string"&&typeof Ae=="string"?G==="asc"?Te.localeCompare(Ae):Ae.localeCompare(Te):typeof Te=="number"&&typeof Ae=="number"?G==="asc"?Te-Ae:Ae-Te:0}),qt=X=>{U(X?Et.map(me=>me.id):[])},Tt=(X,me)=>{U(Te=>me?[...Te,X]:Te.filter(Ae=>Ae!==X))},Zt=(X,me)=>{X.preventDefault(),X.stopPropagation(),console.log(" Mouse down on column:",me,"X:",X.clientX,"Current width:",j[me]),z(me),se(X.clientX),Oe(j[me]),Ke(!1),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},Ft=X=>{if(W){const me=X.clientX-O,Te=Math.max(50,L+me);console.log(" Mouse move:","DeltaX:",me,"NewWidth:",Te,"Column:",W),Math.abs(me)>3&&Ke(!0);const Ae={...j,[W]:Te};N(Ae),localStorage.setItem("columnWidths",JSON.stringify(Ae))}},ve=()=>{console.log(" Mouse up - finishing resize"),z(null),se(0),Oe(0),document.body.style.cursor="",document.body.style.userSelect="",setTimeout(()=>{Ke(!1)},100)};S.useEffect(()=>{if(W)return document.addEventListener("mousemove",Ft),document.addEventListener("mouseup",ve),()=>{document.removeEventListener("mousemove",Ft),document.removeEventListener("mouseup",ve)}},[W,O,L]);const qe=()=>{if(H.length!==1){He.error("Wybierz dokadnie jedn pozycj do edycji");return}const X=t.find(me=>me.id===H[0]);X&&(le(X),de(!0))},vt=async()=>{try{const X=await fetch("/api/inventory/report/pdf");if(!X.ok)throw new Error("   ");const me=await X.blob(),Te=window.URL.createObjectURL(me),Ae=document.createElement("a");Ae.href=Te;const Be=X.headers.get("Content-Disposition");let et="raport_stanow_magazynowych.pdf";if(Be){const pt=Be.match(/filename="?(.+)"?/i);pt&&(et=pt[1])}Ae.download=et,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),setTimeout(()=>window.URL.revokeObjectURL(Te),100)}catch(X){console.error("Error generating report:",X)}},bt=X=>{r(me=>me.map(Te=>Te.id===X.id?X:Te)),U([])},fe=Et.length>0&&Et.every(X=>H.includes(X.id)),Re=X=>{if(!X)return"-";let me;if(typeof X=="string")me=new Date(X);else if(typeof X=="number")X<1e12?me=new Date(X*1e3):me=new Date(X);else return"-";return isNaN(me.getTime())?"-":me.toLocaleDateString("pl-PL")},ze=H.length>0?t.filter(X=>H.includes(X.id)):[];return f?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("p",{className:"text-red-600 font-sora",children:p}),u.jsx("button",{onClick:ut,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[u.jsxs("div",{className:"relative w-full max-w-xs",children:[u.jsx(Yn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),u.jsx("input",{type:"text",value:D,onChange:X=>E(X.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),u.jsx("button",{onClick:qe,disabled:H.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{onClick:vt,className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Raport stanw magazynowych",children:u.jsx(wb,{size:16})})]}),u.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykuw"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:ze.length})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"czna ilo towaru"}),u.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:ze.length>0?ze.reduce((X,me)=>X+(me.ilosc||0),0):0})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru fakturowa"}),u.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[ze.length>0?ze.reduce((X,me)=>X+(P[me.kod]||0),0).toFixed(2):"0.00"," "]})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru w sprzeday"}),u.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[ze.length>0?ze.reduce((X,me)=>{const Te=me.cena_sprzedazy||0,Ae=me.ilosc||0;return X+Te*Ae},0).toFixed(2):"0.00"," z"]})]})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.sprzedawca,onChange:X=>J(me=>({...me,sprzedawca:X.target.value})),className:"block px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300 truncate",style:{fontFamily:"Sora, sans-serif",direction:"ltr",width:"145px",minWidth:"145px",maxWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Sprzedawca"}),Jt.map(X=>u.jsx("option",{value:X,style:{fontFamily:"Sora, sans-serif"},children:X},X))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.typ,onChange:X=>J(me=>({...me,typ:X.target.value})),className:"block px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300 truncate",style:{fontFamily:"Sora, sans-serif",direction:"ltr",width:"145px",minWidth:"145px",maxWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Typ"}),Lt.map(X=>u.jsx("option",{value:X,style:{fontFamily:"Sora, sans-serif"},children:Ef.find(me=>me.value===X)?.label||X},X))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.objetosc,onChange:X=>J(me=>({...me,objetosc:X.target.value})),className:"block px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300 truncate",style:{fontFamily:"Sora, sans-serif",direction:"ltr",width:"145px",minWidth:"145px",maxWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Objto"}),Xt.map(X=>u.jsxs("option",{value:X,style:{fontFamily:"Sora, sans-serif"},children:[X," l"]},X))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.status,onChange:X=>J(me=>({...me,status:X.target.value})),className:"block px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300 truncate",style:{fontFamily:"Sora, sans-serif",direction:"ltr",width:"145px",minWidth:"145px",maxWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Status"}),dt.map(X=>u.jsx("option",{value:X,style:{fontFamily:"Sora, sans-serif"},children:X},X))]})})]}),(ae.sprzedawca||ae.typ||ae.objetosc||ae.status)&&u.jsx("button",{onClick:()=>J({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})]}),u.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:u.jsx("div",{className:"w-full overflow-x-auto overflow-y-scroll max-h-[500px] relative",style:{zIndex:1},children:u.jsxs("table",{className:"w-full resizable-table",ref:Qe,children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsx("input",{type:"checkbox",checked:fe,onChange:X=>qt(X.target.checked)})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ht("kod"),style:{width:"100px"},children:"Kod"}),u.jsxs("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 relative",onClick:()=>{je||ht("nazwa")},style:{width:`${j.nazwa}px`},children:["Nazwa",u.jsx("div",{className:`absolute top-0 right-0 h-full cursor-col-resize hover:bg-blue-500 transition-opacity z-10 ${W==="nazwa"?"bg-blue-500 opacity-100":"opacity-0 hover:opacity-100"}`,style:{width:"2px"},onMouseDown:X=>{X.preventDefault(),X.stopPropagation(),Zt(X,"nazwa")}})]}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ht("sprzedawca"),style:{width:"120px"},children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ht("ilosc"),children:"Ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ht("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ht("objetosc"),children:"Objto"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>ht("cena"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena",u.jsx("br",{}),"fakturowa"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>ht("koszt_wlasny"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Koszt",u.jsx("br",{}),"wasny"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>ht("cena_sprzedazy"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena w",u.jsx("br",{}),"sprzeday"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>ht("dataWaznosci"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data",u.jsx("br",{}),"wanoci"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ht("sprzedaze"),children:"Sprzedae"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>ht("srednieZuzycie"),style:{width:"100px"},children:u.jsxs("div",{className:"whitespace-normal",children:["rednie",u.jsx("br",{}),"zuycie/dzie"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>ht("dniPozostalo"),style:{width:"80px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Dni",u.jsx("br",{}),"pozostao"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>ht("dataWyczerpania"),style:{width:"110px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data wyczerpania",u.jsx("br",{}),"zapasw"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ht("status"),children:"Status"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Et.map(X=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:u.jsx("input",{type:"checkbox",checked:H.includes(X.id),onChange:me=>Tt(X.id,me.target.checked)})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:"100px"},children:u.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:X.kod})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:`${j.nazwa}px`},children:u.jsx("div",{className:"break-words leading-tight max-h-12 overflow-hidden",children:X.nazwa})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",style:{width:"120px"},children:X.sprzedawca||Pe.get(X.kod)||""}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`ilosc-tooltip-${X.kod}`,children:[X.ilosc,u.jsx(ti,{id:`ilosc-tooltip-${X.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"samples:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[oe[X.kod]||0," szt"]})]}),re[X.kod]>0&&u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"rezerwacja:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[re[X.kod]," szt"]})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:X.typ?u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Ot(X.typ)}`,children:Ef.find(me=>me.value===X.typ)?.label||X.typ}):"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:X.objetosc?`${X.objetosc} l`:"-"}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${X.kod}`,onMouseEnter:()=>{pe[X.kod]||Je()},children:[X.cena!=null?`${X.cena.toFixed(2)} `:"-",u.jsx(ti,{id:`price-tooltip-${X.kod}`,className:"max-w-md",place:"top",children:u.jsxs("div",{className:"font-sora",children:[u.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),pe[X.kod]&&pe[X.kod].length>0?pe[X.kod].map((me,Te)=>u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:me.cena!=null?`${me.cena.toFixed(2)} `:"N/A"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:["(",me.ilosc_aktualna," szt.)"]})]},Te)):u.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`koszt-tooltip-${X.kod}`,children:[X.koszt_wlasny!=null?`${X.koszt_wlasny.toFixed(2)} z`:"-",u.jsx(ti,{id:`koszt-tooltip-${X.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"transport:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:X.koszt_dostawy_per_unit!=null?`${X.koszt_dostawy_per_unit.toFixed(2)} z`:"0,00 z"})]}),u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"akcyza:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:X.podatek_akcyzowy!=null?`${X.podatek_akcyzowy.toFixed(2)} z`:"0,00 z"})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:X.cena_sprzedazy!=null?`${X.cena_sprzedazy.toFixed(2)} z`:"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:Re(X.data_waznosci)}),u.jsx("td",{className:"px-8 py-4 text-center text-xs text-gray-600 font-sora leading-tight align-middle whitespace-nowrap",children:(()=>{const me=a.filter(et=>et.kod===X.kod);console.log(`Sales for ${X.kod}:`,me.length);const Te={};me.forEach(et=>{const pt=l.find(tt=>tt.id===et.orderId),Wt=pt?pt.klient:"";let Ge="";pt&&pt.numer_zamowienia&&(Ge=Mv(pt.numer_zamowienia)),!Ge&&pt&&(Ge=new Date(pt.data_utworzenia).toLocaleDateString("pl-PL")),!Ge&&et.created_at&&(Ge=new Date(et.created_at).toLocaleDateString("pl-PL")),Te[et.orderId]||(Te[et.orderId]={qty:0,klient:Wt,date:Ge}),Te[et.orderId].qty+=et.ilosc});const Ae=Object.entries(Te).sort(([,et],[,pt])=>{const Wt=new Date(et.date.split(".").reverse().join("-"));return new Date(pt.date.split(".").reverse().join("-")).getTime()-Wt.getTime()});if(console.log(`Sales array for ${X.kod}:`,Ae.length),Ae.length===0)return u.jsx("div",{className:"text-gray-400",children:"-"});const Be=Ae.slice(0,3);return u.jsx("div",{className:"flex items-center justify-center",children:u.jsxs("div",{className:"relative cursor-pointer",children:[u.jsx(bb,{size:16,className:"text-blue-300 hover:text-blue-400 transition-colors focus:outline-none","data-tooltip-id":`sales-tooltip-${X.kod}`,onClick:et=>{et.stopPropagation(),b(X.kod),v(!0)},tabIndex:0,onMouseDown:et=>et.preventDefault()}),u.jsx(ti,{id:`sales-tooltip-${X.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!1,children:u.jsx("div",{className:"font-sora",children:Be.map(([et,pt])=>u.jsx("div",{className:"mb-1",children:pt.date&&pt.klient?u.jsxs("div",{children:[pt.date.split(".").slice(0,2).join(".")," | ",pt.klient,": ",u.jsx("span",{className:"text-gray-500",children:pt.qty})]}):u.jsxs("div",{className:"text-gray-500",children:["Ilo: ",pt.qty]})},et))})})]})})})()}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(()=>{const me=_e.get(X.kod)||0;return me>=1?me.toFixed(2):me>=.1?me.toFixed(3):me.toFixed(4)})(),"/dzie"]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const me=_e.get(X.kod)||0,Te=me<=0?1/0:Math.floor(X.ilosc/me);return Te===1/0?"":Te})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(X.ilosc===0){const Be=ft(X.kod);return Be?Be.toLocaleDateString("pl-PL"):"-"}const me=_e.get(X.kod)||0,Te=me<=0?1/0:Math.floor(X.ilosc/me);if(Te===1/0)return"-";const Ae=new Date;return Ae.setDate(Ae.getDate()+Te),Ae.toLocaleDateString("pl-PL")})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(X.ilosc===0)return u.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border bg-gray-100 text-gray-600 border-gray-300",children:"brak"});const me=_e.get(X.kod)||0,Te=me<=0?1/0:Math.floor(X.ilosc/me),Ae=Te===1/0?"Brak danych":Te<=30?"mao":Te<=60?"rednie":"duo";return u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Yt(Te)}`,children:Ae})})()})]},X.id))})]})})}),u.jsx(d5,{isOpen:V,onClose:()=>{de(!1),le(null)},item:ue,onSave:bt}),(()=>{let X=0;if(w){const tt=new Set;a.forEach(Me=>{Me.kod===w&&tt.add(Me.orderId)}),X=l.filter(Me=>tt.has(Me.id)).length}const me=40,Te=48,Ae=40,Be=40,et=7,pt=et*Be,Wt=X===0?150:me+Te+Ae+Math.max(X,et)*Be+20,Ge=Math.min(Math.max(Wt,me+Te+Ae+pt+20),window.innerHeight*.9);return u.jsx(sr,{isOpen:g,onRequestClose:()=>{v(!1),b(null)},style:{content:{width:"400px",height:`${Ge}px`,maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},contentLabel:"Zamwienia",children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-start mb-8 select-none",children:[u.jsx("h2",{className:"text-xs font-semibold text-gray-800 pr-4 break-words leading-tight",children:w?t.find(tt=>tt.kod===w)?.nazwa||w:""}),u.jsx("button",{onClick:()=>{v(!1),b(null),C("")},className:"text-red-500 focus:outline-none flex-shrink-0",children:u.jsx(Nt,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:w&&(()=>{const tt=new Set;a.forEach(R=>{R.kod===w&&tt.add(R.orderId)});let Me=l.filter(R=>tt.has(R.id));k.trim()&&(Me=Me.filter(R=>R.klient===k));const kt=Me.map(R=>{const te=a.filter(Q=>Q.orderId===R.id&&Q.kod===w).reduce((Q,Z)=>Q+Z.ilosc,0);let K="";return R.numer_zamowienia&&(K=Mv(R.numer_zamowienia)),!K&&R.data_utworzenia&&(K=new Date(R.data_utworzenia).toLocaleDateString("pl-PL")),{...R,date:K,totalQty:te}}).sort((R,te)=>{if(R.date&&te.date){const K=new Date(R.date.split(".").reverse().join("-"));return new Date(te.date.split(".").reverse().join("-")).getTime()-K.getTime()}return 0});return kt.length===0?u.jsx("p",{className:"text-xs text-gray-500",children:"Brak zamwie dla tego towaru"}):u.jsx("div",{children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-purple-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Zamwienia"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Klient"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-0"})]})}),u.jsx("tbody",{className:"bg-white",children:kt.map(R=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium",children:R.numer_zamowienia||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:R.klient||"-"})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:R.totalQty}),u.jsx("td",{})]},R.id))})]})})})()}),w&&(()=>{const tt=new Set;a.forEach(rt=>{rt.kod===w&&tt.add(rt.orderId)});const Me=l.filter(rt=>tt.has(rt.id)).map(rt=>rt.klient).filter((rt,kt,R)=>rt&&R.indexOf(rt)===kt).sort();return u.jsx("div",{className:"mt-6 pt-4",children:u.jsx("div",{className:"flex items-center space-x-2",children:u.jsxs("select",{value:k,onChange:rt=>C(rt.target.value),className:"block px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300 truncate",style:{fontFamily:"Sora, sans-serif",direction:"ltr",width:"145px",minWidth:"145px",maxWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Klient"}),Me.map(rt=>u.jsx("option",{value:rt,style:{fontFamily:"Sora, sans-serif"},children:rt},rt))]})})})})()]})})})()]})};Aa("pl",Oa);const x5=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=S.useState(new Date),[o,l]=S.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=S.useState([]),[,h]=S.useState(new Set),[p,m]=S.useState(!1),[g,v]=S.useState(""),[w,b]=S.useState(""),[k,C]=S.useState(!1),[D,E]=S.useState(null);S.useEffect(()=>{const U=setTimeout(async()=>{if(g.trim().length<2||k){f([]);return}m(!0);try{const ae=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(g)}`);if(!ae.ok)throw new Error("Failed to fetch orders");const J=await ae.json();if(J&&J.length>0){const V=J.map(de=>({id:de.id,nazwa:`Zamwienie: ${de.numer_zamowienia}`,kod:de.klient,klient:de.klient,numer_zamowienia:de.numer_zamowienia,products:de.products||[]}));f(V)}else f([])}catch(ae){console.error("Error searching orders:",ae),f([])}finally{m(!1)}},300);return()=>clearTimeout(U)},[g,k]);const Y=(H,U)=>{if(H.numer_zamowienia){if(b(H.klient),E(H.id),H.products&&H.products.length>0){const ae=H.products.map(J=>({nazwa:J.nazwa,ilosc:J.ilosc,original_ilosc:J.ilosc,powod_zwrotu:""}));l(ae)}f([]),v(H.numer_zamowienia),C(!0),He.success("Zamwienie wybrane")}else{const ae=[...o];ae[U]={...ae[U],nazwa:H.nazwa,ilosc:0,original_ilosc:0},l(ae)}},ee=()=>{const H=new Set;return o.forEach((U,ae)=>{const J=U.original_ilosc,V=o[ae].ilosc;!U.nazwa.trim()||!V||V<=0||!U.powod_zwrotu?H.add(ae):V>J&&(H.add(ae),He.error(`Ilo zwrotu (${V}) nie moe przekracza iloci w zamwieniu (${J})`))}),h(H),H.size===0},G=async()=>{if(!ee()){He.error("Prosz wypeni wszystkie wymagane pola");return}try{const H={klient:w,data_zwrotu:r,products:o,orderId:D},U=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)});if(!U.ok){const J=await U.json();throw new Error(J.error||"Failed to create return")}const ae=await U.json();console.log("Return created:",ae),t(H),He.success(`Zwrot zosta utworzony: ${ae.numer_zwrotu}`),n(),v(""),b(""),C(!1),E(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)}catch(H){console.error("Error creating return:",H),He.error("Bd podczas tworzenia zwrotu")}},F=()=>{n(),v(""),b(""),C(!1),E(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)};return u.jsx(sr,{isOpen:e,onRequestClose:F,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),u.jsx("button",{onClick:F,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),u.jsx(pn,{selected:r,onChange:H=>a(H||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:g,onChange:H=>{v(H.target.value),C(!1),E(null)},placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),p&&u.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&g.trim().length>=2&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(H=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>Y(H,-1),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-[10px]",children:H.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",H.klient]})]})},H.id))})]})]})]})}),w&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),u.jsx("p",{className:"text-xs text-gray-900",children:w})]})}),u.jsx("button",{onClick:()=>b(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Nt,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((H,U)=>u.jsx("div",{className:"relative",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"relative flex-1 max-w-[50%]",children:u.jsx("input",{type:"text",value:H.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:"1",max:H.original_ilosc,value:o[U].ilosc||"",onChange:ae=>{const J=[...o],V=ae.target.value===""?0:parseInt(ae.target.value)||0;J[U]={...J[U],ilosc:V},l(J)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilo"})}),u.jsx("div",{className:"w-40 ml-2",children:u.jsxs("select",{value:o[U].powod_zwrotu,onChange:ae=>{const J=[...o];J[U]={...J[U],powod_zwrotu:ae.target.value},l(J)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[u.jsx("option",{value:"",children:"Powd zwrotu"}),u.jsx("option",{value:"Bd w zamwieniu",children:"Bd w zamwieniu"}),u.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),u.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&u.jsx("button",{onClick:()=>{const ae=o.filter((J,V)=>V!==U);l(ae)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Nt,{size:16})})]})},U))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:G,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwrz zwrot"})}),u.jsx("div",{className:"absolute bottom-4 right-4",children:u.jsx("button",{onClick:F,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})};Aa("pl",Oa);const m5=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=S.useState(new Date),[o,l]=S.useState(""),[c,f]=S.useState(""),[h,p]=S.useState([{kod:"",nazwa:"",ilosc:0,powod:""}]),[m,g]=S.useState([]),[v,w]=S.useState(new Set),[b,k]=S.useState(new Set),[C,D]=S.useState(!1),[E,Y]=S.useState(null),[ee,G]=S.useState(null),[F,H]=S.useState(!1),U=S.useRef(null),ae=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}];S.useEffect(()=>{e?fetch("/api/writeoffs/next-number-only").then(B=>{if(!B.ok)throw new Error("Failed to fetch next number");return B.json()}).then(B=>{B.numer_odpisania?(l(B.numer_odpisania),console.log(" Set write-off base number to:",B.numer_odpisania)):l("OP001")}).catch(B=>{console.error(" Error fetching next write-off number:",B),l("OP001")}):(l(""),f(""))},[e]),S.useEffect(()=>{if(o&&r){const B=String(r.getDate()).padStart(2,"0"),re=String(r.getMonth()+1).padStart(2,"0"),I=r.getFullYear(),P=`${o}_${B}_${re}_${I}`;f(P)}},[o,r]),S.useEffect(()=>{const re=setTimeout(async()=>{if(E===null){g([]);return}const I=h[E];if(!I||!I.nazwa||I.nazwa.trim().length<2||I.kod){g([]);return}D(!0);try{const P=I.nazwa,ce=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(P)}`);if(!ce.ok)throw new Error("Failed to fetch products");const T=(await ce.json()).map(j=>({kod:j.kod,nazwa:j.nazwa,ilosc:j.ilosc?.toString()||"0"}));g(T)}catch(P){console.error("Error searching products:",P),g([])}finally{D(!1)}},300);return()=>clearTimeout(re)},[h,E]),S.useEffect(()=>{const B=I=>{const P=I.target;ee!==null&&(P.closest(".dropdown-container")||G(null))},re=I=>{I.key==="Escape"&&G(null)};return ee!==null&&(document.addEventListener("mousedown",B),document.addEventListener("keydown",re)),()=>{document.removeEventListener("mousedown",B),document.removeEventListener("keydown",re)}},[ee]);const J=(B,re)=>{const I=[...h],P=parseInt(B.ilosc)||0;I[re]={...I[re],kod:B.kod,nazwa:`${B.kod} - ${B.nazwa}`,ilosc:0,availableQuantity:P},p(I),g([]),Y(null),w(ce=>{const A=new Set(ce);return A.delete(re),A}),k(ce=>{const A=new Set(ce);return A.delete(re),A})},V=B=>{G(ee===B?null:B)},de=(B,re)=>{const I=[...h];I[B]={...I[B],powod:re},p(I),G(null)},ue=()=>{p([...h,{kod:"",nazwa:"",ilosc:0,powod:""}])},le=()=>c?h.every(B=>B.nazwa.trim()&&B.ilosc&&B.ilosc>0&&B.powod):!1,pe=()=>{const B=new Set;return h.forEach((re,I)=>{(!re.nazwa.trim()||!re.ilosc||re.ilosc<=0||!re.powod)&&B.add(I)}),w(B),B.size===0},q=async()=>{if(!pe()){He.error("Prosz wypeni wszystkie wymagane pola");return}if(!c){He.error("Brak numeru odpisania");return}H(!0);try{const B={data_odpisania:r.toISOString(),numer_odpisania:c,products:h},re=await fetch("/api/writeoffs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!re.ok){const P=await re.json();throw new Error(P.error||"Failed to create write-off")}const I=await re.json();console.log("Write-off created:",I),t(B),He.success(`Odpisanie zostao utworzone: ${c}`),oe()}catch(B){console.error("Error creating write-off:",B),He.error("Bd podczas tworzenia odpisania")}finally{H(!1)}},oe=()=>{n(),a(new Date),l(""),f(""),p([{kod:"",nazwa:"",ilosc:0,powod:""}]),w(new Set),k(new Set),g([]),Y(null),G(null),H(!1)};return u.jsx(sr,{isOpen:e,onRequestClose:oe,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Odpisanie towaru"}),u.jsx("button",{onClick:oe,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4 mb-12",children:u.jsxs("div",{className:"flex items-end gap-6",children:[u.jsxs("div",{className:"w-[140px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data odpisania"}),u.jsx(pn,{selected:r,onChange:B=>a(B||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[120px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsx("input",{type:"text",value:"VEIS",readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed"})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer odpisania"}),u.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed"})]})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do odpisania"}),h.map((B,re)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"relative flex-1 max-w-[65%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:B.nazwa,onChange:I=>{const P=I.target.value,ce=[...h];ce[re]={...ce[re],nazwa:P,kod:"",ilosc:0,powod:"",availableQuantity:void 0},p(ce),Y(re),k(A=>{const T=new Set(A);return T.delete(re),T})},onFocus:()=>Y(re),className:`w-full pl-10 pr-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs ${v.has(re)?"border-red-500 bg-red-50":"border-gray-300"}`,placeholder:"Wyszukaj produkty..."}),C&&E===re&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),m.length>0&&E===re&&B.nazwa.trim().length>=2&&!B.kod&&u.jsx("div",{className:"absolute z-50 mt-1 w-[65%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map((I,P)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>J(I,re),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:I.kod}),u.jsx("span",{className:"text-[10px] text-gray-500",children:I.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",I.ilosc]})]})},`${I.kod}-${P}`))})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",value:B.ilosc||"",onChange:I=>{const P=I.target.value,ce=P===""?0:Math.max(1,parseInt(P)||0),A=[...h];if(A[re]={...A[re],ilosc:ce},p(A),U.current=null,B.kod&&B.availableQuantity!==void 0){const T=B.availableQuantity;ce===0?k(j=>{const N=new Set(j);return N.delete(re),N}):ce>T?(k(j=>{const N=new Set(j);return N.add(re),N}),U.current!==re&&(U.current=re,He.error(`Niewystarczajca ilo - dostpne: ${T} (na magazynie: ${T})`))):k(j=>{const N=new Set(j);return N.delete(re),N})}else k(T=>{const j=new Set(T);return j.delete(re),j})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${b.has(re)?"border-red-500 bg-red-50":"border-gray-300"}`,placeholder:"Ilo"})}),u.jsxs("div",{className:"w-32 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>V(re),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${B.powod&&ae.find(I=>I.value===B.powod)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:B.powod?ae.find(I=>I.value===B.powod)?.label||B.powod:"Powd"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ee===re&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:I=>I.stopPropagation(),children:ae.map(I=>u.jsx("button",{type:"button",onClick:()=>de(re,I.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${I.color}`,children:I.label},I.value))})]}),h.length>1&&u.jsx("button",{onClick:()=>{const I=h.filter((P,ce)=>ce!==re);p(I)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Nt,{size:16})})]}),re===h.length-1&&u.jsx("button",{type:"button",onClick:ue,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})})]},re))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:q,disabled:F||!le(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${F||!le()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:F?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Tworzenie..."]}):"Utwrz odpisanie"})})]})})};Aa("pl",Oa);const g5=({isOpen:e,onClose:n,onReservationCreated:t})=>{console.log(" CreateReservationModal render - isOpen:",e);const[r,a]=S.useState(null),[o,l]=S.useState(null),[c,f]=S.useState(""),[h,p]=S.useState(""),[m,g]=S.useState([]),[v,w]=S.useState(null),[b,k]=S.useState(!1),[C,D]=S.useState([]),[E,Y]=S.useState([{id:1,searchQuery:"",selectedProduct:null}]),[ee,G]=S.useState(null),[F,H]=S.useState(!1),[U,ae]=S.useState(!1),[J,V]=S.useState(new Set),[de,ue]=S.useState(""),le=S.useRef(null),pe=S.useRef(""),q=()=>{const A=Math.max(...E.map(T=>T.id))+1;Y([...E,{id:A,searchQuery:"",selectedProduct:null}])},oe=A=>{E.length>1&&Y(T=>T.filter(j=>j.id!==A))},B=()=>{console.log(" CreateReservationModal handleClose called"),a(null),l(null),f(""),p(""),g([]),w(null),D([]),Y([{id:1,searchQuery:"",selectedProduct:null}]),G(null),H(!1),ae(!1),V(new Set),ue(""),le.current=null,n()};S.useEffect(()=>{if(e){console.log(" CreateReservationModal opened - clearing state and generating number"),a(null),l(null),p(""),g([]),w(null),D([]),Y([{id:1,searchQuery:"",selectedProduct:null}]),G(null),H(!1),ae(!1),V(new Set),ue(""),le.current=null;const A=new Date,T=A.getDate().toString().padStart(2,"0"),j=(A.getMonth()+1).toString().padStart(2,"0"),N=A.getFullYear();console.log(" Fetching next reservation number from:",`${Ha}/api/reservations/next-number-only`),fetch(`${Ha}/api/reservations/next-number-only`).then(W=>{if(console.log(" Response status:",W.status),!W.ok)throw new Error(`HTTP error! status: ${W.status}`);return W.json()}).then(W=>{if(console.log(" Received data:",W),W.numer_rezerwacji){pe.current=W.numer_rezerwacji;const z=`${W.numer_rezerwacji}_${T}_${j}_${N}`;f(z),console.log(" Set reservation number to:",z)}else console.warn(" No numer_rezerwacji in response, using fallback"),pe.current="R001",f(`R001_${T}_${j}_${N}`)}).catch(W=>{console.error(" Error fetching next reservation number:",W),pe.current="R001",f(`R001_${T}_${j}_${N}`)})}else f(""),pe.current=""},[e]),S.useEffect(()=>{const T=setTimeout(async()=>{if(h.trim().length<2){g([]);return}k(!0);try{const j=await fetch(`${Ha}/api/clients/search?q=${encodeURIComponent(h)}`);if(!j.ok)throw new Error("Failed to fetch clients");const N=await j.json();g(N)}catch(j){console.error("Error searching clients:",j),g([])}finally{k(!1)}},300);return()=>clearTimeout(T)},[h]),S.useEffect(()=>{const T=setTimeout(async()=>{if(ee===null||!E.find(j=>j.id===ee)?.searchQuery.trim()){D([]);return}H(!0);try{const j=E.find(O=>O.id===ee)?.searchQuery||"",N=await fetch(`${Ha}/api/working-sheets/search?query=${encodeURIComponent(j)}`);if(!N.ok)throw new Error("Failed to fetch products");const z=(await N.json()).map(O=>({kod:O.kod,nazwa:O.nazwa,ilosc:O.ilosc.toString(),kodKreskowy:O.kod_kreskowy||"",selectedQuantity:0,ilosc_reserved:O.ilosc_reserved||0}));D(z)}catch(j){console.error("Error searching products:",j),D([])}finally{H(!1)}},300);return()=>clearTimeout(T)},[E,ee]),S.useEffect(()=>{if(pe.current)if(r){const A=r.getDate().toString().padStart(2,"0"),T=(r.getMonth()+1).toString().padStart(2,"0"),j=r.getFullYear(),N=`${pe.current}_${A}_${T}_${j}`;f(N)}else{const A=new Date,T=A.getDate().toString().padStart(2,"0"),j=(A.getMonth()+1).toString().padStart(2,"0"),N=A.getFullYear(),W=`${pe.current}_${T}_${j}_${N}`;f(W)}},[r]);const re=(A,T)=>{console.log(" handleProductSelect called for fieldId:",A,"product:",T.kod),Y(j=>j.map(W=>W.id===A?{...W,selectedProduct:T,searchQuery:`${T.kod} - ${T.nazwa.includes(" (samples)")?T.nazwa.replace(" (samples)","")+" (samples)":T.nazwa}`}:W)),D([]),G(null),console.log(" Products list cleared, activeSearchId reset")},I=()=>E.filter(A=>A.selectedProduct).reduce((A,T)=>{const j=T.selectedProduct?.selectedQuantity||0;return A+j},0),P=()=>{if(!r||!o||!v||!c.trim())return!1;const A=E.filter(T=>T.selectedProduct);return!(A.length===0||A.some(T=>!T.selectedProduct?.selectedQuantity||T.selectedProduct.selectedQuantity<=0)||J.size>0)},ce=async()=>{const A=E.filter(T=>T.selectedProduct).map(T=>({product_kod:T.selectedProduct.kod,product_nazwa:T.selectedProduct.nazwa,kod_kreskowy:T.selectedProduct.kodKreskowy||"",ilosc:T.selectedProduct.selectedQuantity||0}));if(!r){He.error("Wybierz dat rezerwacji");return}if(!o){He.error("Wybierz dat zakoczenia rezerwacji");return}if(o<r){He.error("Data zakoczenia nie moe by wczeniejsza ni data rezerwacji");return}if(!v){He.error("Wybierz klienta");return}if(A.length===0){He.error("Dodaj produkty");return}if(A.some(T=>!T.ilosc||T.ilosc<=0)){He.error("Wprowad ilo dla wszystkich produktw");return}V(new Set),ae(!0);try{const T=await fetch(`${Ha}/api/reservations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:v.id,numer_rezerwacji:c,data_utworzenia:r.toISOString().split("T")[0],data_zakonczenia:o.toISOString().split("T")[0],komentarz:de.trim()||null,products:A})});if(!T.ok){const j=await T.text();let N="Failed to create reservation";try{const W=JSON.parse(j);N=W.details?.message||W.error||N}catch{console.error("Non-JSON error response when creating reservation:",j)}throw new Error(N)}He.success("Rezerwacja zostaa utworzona"),B(),t&&t()}catch(T){console.error("Error creating reservation:",T),He.error(T.message||"Wystpi bd podczas tworzenia rezerwacji")}finally{ae(!1)}};return u.jsx(sr,{isOpen:e,onRequestClose:B,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"visible",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie rezerwacji"}),u.jsx("button",{onClick:B,className:"text-red-500 focus:outline-none",children:u.jsx(Nt,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx(pn,{selected:r,onChange:A=>a(A),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx(pn,{selected:o,onChange:A=>l(A),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:r||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:h,onChange:A=>{p(A.target.value),v&&w(null)},placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),b&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),m.length>0&&!v&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map(A=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{w(A),p(A.nazwa),g([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:A.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:A.firma})]})},A.id))}),v&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.firma})]}),u.jsx("button",{onClick:()=>{w(null),p("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(Nt,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:de,onChange:A=>ue(A.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),E.map(A=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:A.searchQuery,onChange:T=>{const j=T.target.value;console.log(" Product search input changed for fieldId:",A.id,"value:",j),Y(N=>N.map(W=>W.id===A.id?{...W,searchQuery:j,selectedProduct:null}:W)),G(A.id)},onFocus:()=>G(A.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-8",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:A.selectedProduct?.selectedQuantity||"",onChange:T=>{const j=T.target.value,N=j===""?0:Math.max(1,parseInt(j)||0);Y(W=>{const z=W.map(se=>se.id===A.id&&se.selectedProduct?{...se,selectedProduct:{...se.selectedProduct,selectedQuantity:N}}:se);le.current=null;const O=z.find(se=>se.id===A.id);if(O?.selectedProduct){const se=parseInt(O.selectedProduct.ilosc)||0,L=O.selectedProduct.ilosc_reserved||0,Oe=Math.max(0,se-L);N===0?V(je=>{const Ke=new Set(je);return Ke.delete(A.id),Ke}):N>Oe?(V(je=>{const Ke=new Set(je);return Ke.add(A.id),Ke}),L>0?He.error(`Niewystarczajca ilo - dostpne: ${Oe} (na magazynie: ${se}, z nich w rezerwacji: ${L})`):He.error(`Niewystarczajca ilo - dostpne: ${Oe} (na magazynie: ${se})`)):V(je=>{const Ke=new Set(je);return Ke.delete(A.id),Ke})}else V(se=>{const L=new Set(se);return L.delete(A.id),L});return z})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${J.has(A.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),E.length>1&&u.jsx("button",{onClick:()=>oe(A.id),className:"ml-4 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Nt,{size:16})})]}),A.id===Math.max(...E.map(T=>T.id))&&u.jsx("button",{onClick:q,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),F&&ee===A.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),C.length>0&&ee===A.id&&!A.selectedProduct&&A.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:C.map((T,j)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>re(A.id,{...T,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.kod}),T.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:T.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:T.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",T.ilosc]}),(T.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",T.ilosc_reserved??0]})]})},`${T.kod}-${T.nazwa||""}-${j}`))})]},A.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:ce,disabled:U||!P(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${U||!P()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:U?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:I()})]})]})})},v5=e=>(e(!0),!0);sr.setAppElement("#root");const y5=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
  }
`,tr="";console.log("API_URL configured as:",tr);function w5(){const[e,n]=S.useState(!1),[t,r]=S.useState(!1),[a,o]=S.useState(!1),[l,c]=S.useState(!1),[f,h]=S.useState(!1),[p,m]=S.useState(!1),[g,v]=S.useState(null),[w,b]=S.useState(null),[k,C]=S.useState(["inventory","clients","orders","inventoryStatus"]),[D,E]=S.useState(()=>{const fe=localStorage.getItem("activeTab")||"inventory",Re=localStorage.getItem("activeSubTab"),ze=["inventory","clients","orders","inventoryStatus"],X=["przyjecie","analiza","kalendarz","wydanie","rezerwacje","analiza_towarow","faktury"],me=ze.includes(fe)?fe:"inventory";let Te="przyjecie";me==="orders"&&(Te="wydanie");const Ae=Re&&X.includes(Re)?Re:Te;return{sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:me,activeSubTab:Ae,isDbInitialized:!1}}),[Y,ee]=S.useState(!1),[G,F]=S.useState(!1),[H,U]=S.useState(!1),[ae,J]=S.useState(!1),[V,de]=S.useState(!1),[ue,le]=S.useState(null),[pe,q]=S.useState(!1),[oe,B]=S.useState(null),[re,I]=S.useState(0),[P,ce]=S.useState(0),[A,T]=S.useState(0),[j,N]=S.useState(0),[W,z]=S.useState([]),[O,se]=S.useState(!1),[L,Oe]=S.useState(null),[je,Ke]=S.useState(null);S.useEffect(()=>{(async()=>{try{console.log(" Starting data loading process..."),console.log(" API_URL:",tr),console.log(" Loading clients...");const Re=await Zt();console.log(" Clients loaded:",Re.length),console.log(" Loading products...");const ze=await Ft();console.log(" Products loaded:",ze.length),console.log(" Loading product receipts...");const X=await ve();console.log(" Product receipts loaded:",X.length),console.log(" Updating app state with loaded data..."),console.log(" Setting clients:",Re),E(me=>{const Te={...me,clients:Re,products:ze,productReceipts:X};return console.log(" New app state:",Te),Te}),console.log(" App state updated successfully"),console.log(" Final data counts:"),console.log("   - Clients:",Re.length),console.log("   - Products:",ze.length),console.log("   - Product Receipts:",X.length)}catch(Re){console.error(" Error loading data:",Re),He.error("Bd podczas adowania danych")}finally{console.log(" Data loading process completed")}})()},[]),S.useEffect(()=>{const fe=document.createElement("style");return fe.textContent=y5,document.head.appendChild(fe),()=>{document.head.contains(fe)&&document.head.removeChild(fe)}},[]),S.useEffect(()=>{if(!D.isDbInitialized)return;console.log(" useEffect triggered - clients changed:",D.clients.length),(async()=>{const Re={sheets:D.sheets,sheetsData:D.sheetsData,activeSheet:D.activeSheet,showTable:D.showTable,clients:D.clients,products:D.products,productReceipts:D.productReceipts};try{localStorage.setItem("appState",JSON.stringify(Re)),console.log("App state saved to localStorage")}catch(ze){console.error("Error saving state to localStorage:",ze)}})()},[D.sheetsData,D.sheets,D.activeSheet,D.showTable,D.clients,D.products,D.productReceipts]);const Qe=async()=>{try{console.log(" Loading sheets from database..."),console.log(" Making request to:",`${tr}/api/original-sheets`);const fe=await fetch(`${tr}/api/original-sheets`);if(console.log(" Sheets response status:",fe.status),!fe.ok)throw new Error(`HTTP error! status: ${fe.status}`);const Re=await fe.json();console.log(" Received sheets from server:",Re),console.log(" Sheets count:",Re.length);const ze=Re.map(X=>({fileName:X.fileName,data:{headers:X.data.headers,rows:X.data.rows}}));console.log(" Processed sheets:",ze),console.log(" Processed sheets count:",ze.length),E(X=>({...X,sheets:ze,sheetsData:ze,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log(" App state updated with sheets data")}catch(fe){console.error("     :",fe),He.error("    ")}finally{console.log(" Loading sheets completed")}};S.useEffect(()=>{Qe()},[]);const he=async(fe,Re)=>{console.log("handleExcelUpload called with:",{newFileName:fe,fileData:Re});try{const ze=await fetch(`${tr}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:fe,data:Re})});if(!ze.ok){if(ze.status===409){He.error("Moe by tylko jeden plik Excel. Usu istniejcy plik przed zaadowaniem nowego.");return}throw new Error(`HTTP error! status: ${ze.status}`)}await Qe(),n(!1)}catch(ze){console.error("Error saving file data:",ze),He.error("Bd podczas zapisywania danych pliku")}},Ne=fe=>{const Re=`${tr}/api/download_file/${encodeURIComponent(fe.fileName)}`;window.open(Re,"_blank")},Pe=fe=>{b(fe)},_e=fe=>{fe.preventDefault()},Je=fe=>{!w||w===fe||(C(Re=>{const ze=[...Re],X=ze.indexOf(w),me=ze.indexOf(fe);return ze.splice(X,1),ze.splice(me,0,w),ze}),b(null))},ft=fe=>{if(fe==="inventory"||fe==="clients"||fe==="orders"||fe==="inventoryStatus"){const Re=fe==="inventory"?"przyjecie":fe==="orders"?"wydanie":null;localStorage.setItem("activeTab",fe),Re&&localStorage.setItem("activeSubTab",Re),E(ze=>({...ze,activeTab:fe,activeSubTab:Re}))}},ut=fe=>{localStorage.setItem("activeSubTab",fe),E(Re=>({...Re,activeSubTab:fe}))};S.useEffect(()=>{D.activeSubTab==="analiza_towarow"&&qt()},[D.activeSubTab,A]);const ht=fe=>{switch(fe){case"inventory":return"Zakup towarw";case"clients":return"Klienci";case"orders":return"Sprzeda towarw";case"inventoryStatus":return"Stany magazynowe";default:return fe}},Ot=()=>{c(!1),n(!1)},Yt=async fe=>{try{console.log(" Starting handleAddProduct..."),console.log(" Received data:",fe),console.log(" Files check:",{hasProductInvoice:!!fe.productInvoice,hasTransportInvoice:!!fe.transportInvoice,productInvoice:fe.productInvoice,transportInvoice:fe.transportInvoice}),console.log(" Making request to:",`${tr}/api/product-receipts`);let Re;if(fe.productInvoice||fe.transportInvoice){console.log(" Files detected, using FormData...");const me=new FormData,Te={date:fe.date,sprzedawca:fe.sprzedawca,wartosc:fe.wartosc,kosztDostawy:fe.kosztDostawy,aktualnyKurs:fe.aktualnyKurs,podatekAkcyzowy:fe.podatekAkcyzowy,products:fe.products};me.append("data",JSON.stringify(Te)),console.log(" JSON data:",Te),fe.productInvoice&&(me.append("productInvoice",fe.productInvoice),console.log(" Product invoice added:",fe.productInvoice.name)),fe.transportInvoice&&(me.append("transportInvoice",fe.transportInvoice),console.log(" Transport invoice added:",fe.transportInvoice.name)),console.log(" FormData entries:");for(let[Ae,Be]of me.entries())console.log(`  ${Ae}:`,Be);Re=await fetch(`${tr}/api/product-receipts`,{method:"POST",body:me})}else{console.log(" No files, using JSON...");const me={date:fe.date,sprzedawca:fe.sprzedawca,wartosc:fe.wartosc,kosztDostawy:fe.kosztDostawy,aktualnyKurs:fe.aktualnyKurs,podatekAkcyzowy:fe.podatekAkcyzowy,products:fe.products};console.log(" JSON data:",me),Re=await fetch(`${tr}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)})}if(console.log(" Response status:",Re.status),console.log(" Response headers:",Re.headers),!Re.ok){const me=await Re.text();throw console.error(" Response error text:",me),new Error(`Failed to save product receipt: ${Re.status} - ${me}`)}const ze=await Re.json();if(console.log(" Saved receipt:",ze),ze.workingSheetsUpdated||ze.workingSheetsInserted){let me="Dodano nowy towar";ze.workingSheetsUpdated>0&&(me+=` (${ze.workingSheetsUpdated}    working sheets)`),ze.workingSheetsInserted>0&&(me+=` (${ze.workingSheetsInserted}     working sheets)`),He.success(me)}else He.success("Dodano nowy towar");console.log(" Loading updated receipts...");const X=await ve();console.log(" Updated receipts:",X),console.log(" Updating app state..."),E(me=>{const Te={...me,productReceipts:X};return console.log(" New app state:",Te),Te}),o(!1)}catch(Re){console.error(" Error adding product:",Re),He.error("Wystpi bd podczas dodawania towaru")}},Jt=async fe=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",fe),console.log(" Files check (update):",{hasProductInvoice:!!fe.productInvoice,hasTransportInvoice:!!fe.transportInvoice,productInvoice:fe.productInvoice,transportInvoice:fe.transportInvoice});try{let Re;if(fe.productInvoice||fe.transportInvoice){console.log(" Files detected (update), using FormData...");const Te=new FormData,Ae={date:fe.date,sprzedawca:fe.sprzedawca,wartosc:fe.wartosc,kosztDostawy:fe.kosztDostawy,products:fe.products};Te.append("data",JSON.stringify(Ae)),console.log(" JSON data (update):",Ae),fe.productInvoice&&(Te.append("productInvoice",fe.productInvoice),console.log(" Product invoice added (update):",fe.productInvoice.name)),fe.transportInvoice&&(Te.append("transportInvoice",fe.transportInvoice),console.log(" Transport invoice added (update):",fe.transportInvoice.name)),console.log(" FormData entries (update):");for(let[Be,et]of Te.entries())console.log(`  ${Be}:`,et);Re=await fetch(`${tr}/api/product-receipts/${fe.id}`,{method:"PUT",body:Te})}else console.log(" No files (update), using JSON..."),Re=await fetch(`${tr}/api/product-receipts/${fe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:fe.date,sprzedawca:fe.sprzedawca,wartosc:fe.wartosc,kosztDostawy:fe.kosztDostawy,aktualnyKurs:fe.aktualnyKurs,podatekAkcyzowy:fe.podatekAkcyzowy,products:fe.products})});if(!Re.ok)throw new Error("Failed to update product receipt");const ze=await Re.json();console.log("Updated receipt:",ze),console.log("Loading updated receipts...");const X=await ve();console.log("Updated receipts:",X),console.log("Loading updated products...");const me=await Ft();console.log("Updated products:",me),console.log("Updating app state..."),E(Te=>{const Ae={...Te,productReceipts:X,products:me};return console.log("New app state:",Ae),Ae}),He.success("Zakup zosta zaktualizowany"),de(!1),le(null),h(!1),v(null)}catch(Re){console.error("Error updating product receipt:",Re),He.error("Wystpi bd podczas aktualizacji zakupu")}},Lt=async fe=>{try{if(!(await fetch(`${tr}/api/product-receipts/${fe}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const ze=await ve(),X=await Ft();E(me=>({...me,productReceipts:ze,products:X})),He.success("Zakup zosta usunity")}catch(Re){console.error("Error deleting receipt:",Re),He.error("Wystpi bd podczas usuwania zakupu")}},Xt=async fe=>{try{const Re=await fetch(`${tr}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(fe)});if(!Re.ok)throw new Error("Failed to add client");const ze=await Re.json(),X={...fe,id:ze.id};E(me=>({...me,clients:[...me.clients,X]})),ce(me=>me+1),He.success("Klient zosta dodany")}catch(Re){console.error("Error adding client:",Re),He.error("Bd podczas dodawania klienta")}},dt=async fe=>{try{if(!(await fetch(`${tr}/api/clients/${fe}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");E(ze=>({...ze,clients:ze.clients.filter(X=>X.id!==fe)})),ce(ze=>ze+1),He.success("Klient zosta usunity")}catch(Re){console.error("Error deleting client:",Re),He.error("Bd podczas usuwania klienta")}},Et=async fe=>{try{console.log(" handleUpdateClient called with data:",fe);const Re=await fetch(`${tr}/api/clients/${fe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(fe)});if(!Re.ok)throw new Error("Failed to update client");const ze=await Re.json();console.log(" Client updated in database:",ze),console.log(" Updated client fields:",{id:ze.id,firma:ze.firma,nazwa:ze.nazwa,adres:ze.adres,czas_dostawy:ze.czas_dostawy,kontakt:ze.kontakt}),E(X=>{console.log(" Updating app state..."),console.log(" Previous clients:",X.clients),console.log(" Updated client data:",ze);const me=X.clients.map(Ae=>Ae.id===fe.id?(console.log(" Updating client:",Ae.id,"from:",Ae,"to:",{...Ae,...ze}),{id:Ae.id,firma:ze.firma||Ae.firma,nazwa:ze.nazwa||Ae.nazwa,adres:ze.adres||Ae.adres,czas_dostawy:ze.czas_dostawy||Ae.czas_dostawy,kontakt:ze.kontakt||Ae.kontakt}):{...Ae});console.log(" New clients array:",me);const Te={...X,clients:me};return console.log(" New app state:",Te),Te}),He.success("Klient zosta zaktualizowany"),setTimeout(()=>{E(X=>(console.log(" Force update after timeout"),{...X})),ce(X=>X+1),Ke(fe.id),Zt().then(X=>{E(me=>({...me,clients:X})),ce(me=>me+1)})},100)}catch(Re){console.error("Error updating client:",Re),He.error("Bd podczas aktualizacji klienta")}},qt=async()=>{try{se(!0),Oe(null);const fe=await fetch(`${tr}/api/reservations/active-products`);if(!fe.ok)throw new Error(`HTTP ${fe.status}`);const Re=await fe.json();console.log(" Active reservation products loaded:",Re.length),z(Re)}catch(fe){console.error(" Error loading analysis products:",fe),Oe(fe.message||"Bd adowania danych")}finally{se(!1)}},Tt=async fe=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",fe),console.log("Products data:",JSON.stringify(fe.products,null,2));try{const Re=await fetch(`${tr}/api/orders/${fe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(fe)});if(!Re.ok)throw new Error("Failed to update order");const ze=await Re.json();console.log("Updated order result:",ze),He.success("Zamwienie zostao zaktualizowane"),I(X=>X+1)}catch(Re){console.error("Error updating order:",Re),He.error("Bd podczas aktualizacji zamwienia")}},Zt=async()=>{try{console.log(" Loading clients from:",`${tr}/api/clients`);const fe=await fetch(`${tr}/api/clients`);if(console.log(" Clients response status:",fe.status),!fe.ok)throw new Error(`HTTP error! status: ${fe.status}`);const Re=await fe.json();return console.log(" Loaded clients:",Re.length,"records"),console.log(" First client:",Re[0]),Re}catch(fe){return console.error(" Error loading clients:",fe),[]}},Ft=async()=>{try{console.log(" Loading products from:",`${tr}/api/products`);const fe=await fetch(`${tr}/api/products`);if(console.log(" Products response status:",fe.status),!fe.ok)throw new Error(`HTTP error! status: ${fe.status}`);const Re=await fe.json();console.log(" Loaded products:",Re.length,"records"),console.log(" First product:",Re[0]);const ze=Re.map(X=>({kod:X.kod,nazwa:X.nazwa,ilosc:X.ilosc,jednostka_miary:X.jednostka_miary||"",kod_kreskowy:X.kod_kreskowy||"",data_waznosci:X.data_waznosci??void 0,archiwalny:X.archiwalny,rezerwacje:X.rezerwacje,ilosc_na_poleceniach:X.ilosc_na_poleceniach,waga_netto:X.waga_netto,waga_brutto:X.waga_brutto,objetosc:X.objetosc,opis:X.opis}));return console.log(" Processed products:",ze.length,"records"),ze}catch(fe){return console.error(" Error loading products:",fe),[]}},ve=async()=>{try{console.log(" Loading product receipts from:",`${tr}/api/product-receipts`);const fe=await fetch(`${tr}/api/product-receipts`);if(console.log(" Product receipts response status:",fe.status),!fe.ok)throw new Error(`HTTP error! status: ${fe.status}`);const Re=await fe.json();return console.log(" Loaded product receipts:",Re.length,"records"),Re.map(ze=>({id:ze.id,dataPrzyjecia:ze.dataPrzyjecia,sprzedawca:ze.sprzedawca||"",wartosc:ze.wartosc||0,kosztDostawy:ze.kosztDostawy||0,aktualny_kurs:ze.aktualny_kurs,podatek_akcyzowy:ze.podatek_akcyzowy,aktualnyKurs:ze.aktualnyKurs,podatekAkcyzowy:ze.podatekAkcyzowy,products:ze.products||[],productInvoice:ze.productInvoice,transportInvoice:ze.transportInvoice}))}catch(fe){return console.error(" Error loading product receipts:",fe),[]}},qe=async fe=>{try{console.log(" Searching working_sheets with query:",fe),console.log(" Making request to:",`${tr}/api/working-sheets/search?query=${encodeURIComponent(fe)}`);const Re=await fetch(`${tr}/api/working-sheets/search?query=${encodeURIComponent(fe)}`);if(console.log(" Search response status:",Re.status),!Re.ok)throw new Error(`HTTP error! status: ${Re.status}`);const ze=await Re.json();return console.log(" Search results:",ze.length,"items found"),ze.map(me=>({kod:me.kod,nazwa:me.nazwa,ilosc:me.ilosc.toString(),kodKreskowy:me.kod_kreskowy||""}))}catch(Re){return console.error(" Error searching working_sheets:",Re),[]}},vt=()=>{I(fe=>fe+1)},bt=()=>{I(fe=>fe+1)};return u.jsxs("div",{className:"min-h-screen bg-gray-100",children:[u.jsx(zO,{position:"top-right"}),u.jsx(yw,{isOpen:ae,onClose:()=>J(!1),product:null}),u.jsx(W4,{isOpen:e,onClose:()=>n(!1),onUpload:he}),u.jsx(U4,{isOpen:l,onClose:()=>c(!1),fileName:"",onConfirm:Ot}),u.jsx(HA,{isOpen:a,onClose:()=>o(!1),onSubmit:Yt}),u.jsx(o5,{isOpen:t,onClose:()=>r(!1),onAdd:Xt}),u.jsx(bw,{isOpen:pe,onClose:()=>{q(!1),B(null)},onSubmit:Et,client:oe}),u.jsx(ww,{isOpen:f,onClose:()=>h(!1),receipt:g}),u.jsx(kw,{isOpen:V,onClose:()=>{de(!1),le(null)},onSubmit:Jt,receipt:ue}),u.jsx(MO,{isOpen:Y,onClose:()=>ee(!1),onOrderCreated:vt}),u.jsx(x5,{isOpen:G,onClose:()=>F(!1),onSubmit:bt}),u.jsx(m5,{isOpen:H,onClose:()=>U(!1),onSubmit:()=>{U(!1),I(fe=>fe+1)}}),u.jsx(g5,{isOpen:p,onClose:()=>m(!1),onReservationCreated:()=>{T(fe=>fe+1),m(!1)},apiUrl:tr}),u.jsx("div",{className:"bg-white shadow-sm",children:u.jsx("div",{className:"container mx-auto px-4 py-3",children:u.jsx("img",{src:s5,alt:"Enoterra Logo",className:"h-32"})})}),u.jsx("div",{className:"bg-gray-100",children:u.jsx("div",{className:"container mx-auto px-4",children:u.jsx("div",{className:"flex items-center h-14",children:u.jsx("div",{className:"flex space-x-4",children:k.map(fe=>u.jsx("div",{draggable:!0,onDragStart:()=>Pe(fe),onDragOver:_e,onDrop:()=>Je(fe),className:`relative -mb-px cursor-pointer ${D.activeTab===fe?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${w===fe?"opacity-50":""}`,onClick:()=>ft(fe),children:u.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:ht(fe)})},fe))})})})}),u.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:u.jsx("div",{className:"container mx-auto px-4 py-6",children:u.jsxs("div",{className:"flex items-start -mt-2",children:[D.activeTab==="inventory"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>ut("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${D.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjcie towarw"}),u.jsx("button",{onClick:()=>ut("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${D.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupw"}),u.jsx("button",{onClick:()=>ut("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${D.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz patnoci"})]}),D.activeSubTab==="przyjecie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>v5(n),children:[u.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:u.jsx(yb,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),u.jsx(i5,{receipts:D.productReceipts,onDelete:Lt,onUpdate:Jt})]}),D.activeSubTab==="analiza"&&u.jsx("div",{className:"flex flex-col gap-4",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupw"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupw bdzie dostpna wkrtce."})]})}),D.activeSubTab==="kalendarz"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz patnoci"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza patnoci bdzie dostpna wkrtce."})]})})]}),D.activeTab==="inventory"&&u.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:D.sheets.map(fe=>u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("button",{onClick:()=>Ne(fe),title:":     ",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:fe.fileName})},fe.fileName))}),D.activeTab==="inventory"&&D.showTable&&D.activeSheet&&u.jsx("div",{className:"mt-6 bg-white",children:u.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:u.jsx(YA,{data:D.activeSheet.data})})}),D.activeTab==="clients"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),u.jsx(c5,{clients:D.clients,onDelete:dt,onUpdate:Et},`clients-${P}-${je||"none"}`)]}),D.activeTab==="orders"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>ut("wydanie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${D.activeSubTab==="wydanie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Wydanie towarw"}),u.jsx("button",{onClick:()=>ut("rezerwacje"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${D.activeSubTab==="rezerwacje"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Rezerwacje"}),u.jsx("button",{onClick:()=>ut("analiza_towarow"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${D.activeSubTab==="analiza_towarow"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza towarw"}),u.jsx("button",{onClick:()=>ut("faktury"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${D.activeSubTab==="faktury"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Faktury"})]}),D.activeSubTab==="wydanie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsx("div",{className:"mb-4",children:u.jsx("div",{className:"w-1/2 mx-auto",children:u.jsx(VA,{onSearch:qe})})}),u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>ee(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>F(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:u.jsx(Nt,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>U(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-orange-500 rounded-full flex items-center justify-center text-white",title:"Odpisanie",children:u.jsx(kb,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Odpisanie towaru"})})]})]}),u.jsx($O,{onDeleteOrder:fe=>{console.log("Delete order:",fe)},onUpdateOrder:Tt,onInvoiceCreated:()=>N(fe=>fe+1),refreshTrigger:re})]}),D.activeSubTab==="rezerwacje"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>m(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj rezerwacj"})})]})}),u.jsx(KO,{refreshTrigger:A})]}),D.activeSubTab==="analiza_towarow"&&u.jsxs("div",{className:"space-y-4 mt-6",children:[O&&u.jsx("div",{className:"text-gray-600 font-sora text-sm",children:"adowanie danych..."}),L&&u.jsx("div",{className:"text-red-600 font-sora text-sm",children:L}),!O&&!L&&u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Kod"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Nazwa"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Pozostao"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Wydane"}),u.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Zarezerwowane"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.filter(fe=>{const Re=fe.ilosc??0,ze=fe.ilosc_wydane??0;return Re-ze>0}).length>0?W.filter(fe=>{const Re=fe.ilosc??0,ze=fe.ilosc_wydane??0;return Re-ze>0}).map((fe,Re)=>{const ze=fe.ilosc??0,X=fe.ilosc_wydane??0,me=ze-X,Te=fe.product_kod??"",Ae=fe.product_nazwa??"",Be=fe.klienci||[];return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:Te}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:Ae}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center",children:u.jsx("span",{className:me>0?"text-green-600 font-medium":"text-gray-400",children:me})}),u.jsxs("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center text-red-600 cursor-pointer","data-tooltip-id":`wydane-tooltip-${fe.product_kod}-${Re}`,children:[X,X>0&&u.jsx(ti,{id:`wydane-tooltip-${fe.product_kod}-${Re}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:fe.zamowienia_z_iloscia&&fe.zamowienia_z_iloscia.length>0?fe.zamowienia_z_iloscia.map((et,pt)=>u.jsxs("div",{className:pt===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:et.numer_zamowienia}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[et.ilosc," szt"]})]},pt)):u.jsx("div",{children:"Brak danych o zamwieniach"})})})]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center cursor-pointer","data-tooltip-id":`zarezerwowane-tooltip-${fe.product_kod}-${Re}`,children:[ze,Be.length>0&&u.jsx(ti,{id:`zarezerwowane-tooltip-${fe.product_kod}-${Re}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:Be.map((et,pt)=>u.jsxs("div",{className:pt===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:et.klient||""}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[et.ilosc??0," szt"]})]},pt))})})]})]},`${fe.product_kod}-${Re}`)}):u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak towarw w aktywnych rezerwacjach"})})})]})})]}),D.activeSubTab==="faktury"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6 w-full",children:u.jsx(HO,{refreshTrigger:j})})]}),D.activeTab==="inventoryStatus"&&u.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:u.jsx(h5,{productReceipts:D.productReceipts})})]})})})]})}mb.createRoot(document.getElementById("root")).render(u.jsx(S.StrictMode,{children:u.jsx(w5,{})}));
