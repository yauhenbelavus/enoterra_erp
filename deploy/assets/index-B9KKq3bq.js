function s2(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Gu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o2(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var W0={exports:{}},el={},U0={exports:{}},St={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pm;function i2(){if(pm)return St;pm=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function g(I){return I===null||typeof I!="object"?null:(I=m&&I[m]||I["@@iterator"],typeof I=="function"?I:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function b(I,j,re){this.props=I,this.context=j,this.refs=w,this.updater=re||v}b.prototype.isReactComponent={},b.prototype.setState=function(I,j){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,j,"setState")},b.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function E(){}E.prototype=b.prototype;function N(I,j,re){this.props=I,this.context=j,this.refs=w,this.updater=re||v}var S=N.prototype=new E;S.constructor=N,k(S,b.prototype),S.isPureReactComponent=!0;var z=Array.isArray,te=Object.prototype.hasOwnProperty,V={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function H(I,j,re){var T,F={},O=null,R=null;if(j!=null)for(T in j.ref!==void 0&&(R=j.ref),j.key!==void 0&&(O=""+j.key),j)te.call(j,T)&&!D.hasOwnProperty(T)&&(F[T]=j[T]);var J=arguments.length-2;if(J===1)F.children=re;else if(1<J){for(var Z=Array(J),U=0;U<J;U++)Z[U]=arguments[U+2];F.children=Z}if(I&&I.defaultProps)for(T in J=I.defaultProps,J)F[T]===void 0&&(F[T]=J[T]);return{$$typeof:e,type:I,key:O,ref:R,props:F,_owner:V.current}}function L(I,j){return{$$typeof:e,type:I.type,key:j,ref:I.ref,props:I.props,_owner:I._owner}}function ae(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function Q(I){var j={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(re){return j[re]})}var Y=/\/+/g;function ue(I,j){return typeof I=="object"&&I!==null&&I.key!=null?Q(""+I.key):j.toString(36)}function le(I,j,re,T,F){var O=typeof I;(O==="undefined"||O==="boolean")&&(I=null);var R=!1;if(I===null)R=!0;else switch(O){case"string":case"number":R=!0;break;case"object":switch(I.$$typeof){case e:case n:R=!0}}if(R)return R=I,F=F(R),I=T===""?"."+ue(R,0):T,z(F)?(re="",I!=null&&(re=I.replace(Y,"$&/")+"/"),le(F,j,re,"",function(U){return U})):F!=null&&(ae(F)&&(F=L(F,re+(!F.key||R&&R.key===F.key?"":(""+F.key).replace(Y,"$&/")+"/")+I)),j.push(F)),1;if(R=0,T=T===""?".":T+":",z(I))for(var J=0;J<I.length;J++){O=I[J];var Z=T+ue(O,J);R+=le(O,j,re,Z,F)}else if(Z=g(I),typeof Z=="function")for(I=Z.call(I),J=0;!(O=I.next()).done;)O=O.value,Z=T+ue(O,J++),R+=le(O,j,re,Z,F);else if(O==="object")throw j=String(I),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return R}function oe(I,j,re){if(I==null)return I;var T=[],F=0;return le(I,T,"","",function(O){return j.call(re,O,F++)}),T}function pe(I){if(I._status===-1){var j=I._result;j=j(),j.then(function(re){(I._status===0||I._status===-1)&&(I._status=1,I._result=re)},function(re){(I._status===0||I._status===-1)&&(I._status=2,I._result=re)}),I._status===-1&&(I._status=0,I._result=j)}if(I._status===1)return I._result.default;throw I._result}var G={current:null},ie={transition:null},B={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:ie,ReactCurrentOwner:V};function de(){throw Error("act(...) is not supported in production builds of React.")}return St.Children={map:oe,forEach:function(I,j,re){oe(I,function(){j.apply(this,arguments)},re)},count:function(I){var j=0;return oe(I,function(){j++}),j},toArray:function(I){return oe(I,function(j){return j})||[]},only:function(I){if(!ae(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},St.Component=b,St.Fragment=t,St.Profiler=a,St.PureComponent=N,St.StrictMode=r,St.Suspense=f,St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,St.act=de,St.cloneElement=function(I,j,re){if(I==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+I+".");var T=k({},I.props),F=I.key,O=I.ref,R=I._owner;if(j!=null){if(j.ref!==void 0&&(O=j.ref,R=V.current),j.key!==void 0&&(F=""+j.key),I.type&&I.type.defaultProps)var J=I.type.defaultProps;for(Z in j)te.call(j,Z)&&!D.hasOwnProperty(Z)&&(T[Z]=j[Z]===void 0&&J!==void 0?J[Z]:j[Z])}var Z=arguments.length-2;if(Z===1)T.children=re;else if(1<Z){J=Array(Z);for(var U=0;U<Z;U++)J[U]=arguments[U+2];T.children=J}return{$$typeof:e,type:I.type,key:F,ref:O,props:T,_owner:R}},St.createContext=function(I){return I={$$typeof:l,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},I.Provider={$$typeof:o,_context:I},I.Consumer=I},St.createElement=H,St.createFactory=function(I){var j=H.bind(null,I);return j.type=I,j},St.createRef=function(){return{current:null}},St.forwardRef=function(I){return{$$typeof:c,render:I}},St.isValidElement=ae,St.lazy=function(I){return{$$typeof:p,_payload:{_status:-1,_result:I},_init:pe}},St.memo=function(I,j){return{$$typeof:h,type:I,compare:j===void 0?null:j}},St.startTransition=function(I){var j=ie.transition;ie.transition={};try{I()}finally{ie.transition=j}},St.unstable_act=de,St.useCallback=function(I,j){return G.current.useCallback(I,j)},St.useContext=function(I){return G.current.useContext(I)},St.useDebugValue=function(){},St.useDeferredValue=function(I){return G.current.useDeferredValue(I)},St.useEffect=function(I,j){return G.current.useEffect(I,j)},St.useId=function(){return G.current.useId()},St.useImperativeHandle=function(I,j,re){return G.current.useImperativeHandle(I,j,re)},St.useInsertionEffect=function(I,j){return G.current.useInsertionEffect(I,j)},St.useLayoutEffect=function(I,j){return G.current.useLayoutEffect(I,j)},St.useMemo=function(I,j){return G.current.useMemo(I,j)},St.useReducer=function(I,j,re){return G.current.useReducer(I,j,re)},St.useRef=function(I){return G.current.useRef(I)},St.useState=function(I){return G.current.useState(I)},St.useSyncExternalStore=function(I,j,re){return G.current.useSyncExternalStore(I,j,re)},St.useTransition=function(){return G.current.useTransition()},St.version="18.3.1",St}var hm;function jl(){return hm||(hm=1,U0.exports=i2()),U0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xm;function l2(){if(xm)return el;xm=1;var e=jl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,h){var p,m={},g=null,v=null;h!==void 0&&(g=""+h),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(v=f.ref);for(p in f)r.call(f,p)&&!o.hasOwnProperty(p)&&(m[p]=f[p]);if(c&&c.defaultProps)for(p in f=c.defaultProps,f)m[p]===void 0&&(m[p]=f[p]);return{$$typeof:n,type:c,key:g,ref:v,props:m,_owner:a.current}}return el.Fragment=t,el.jsx=l,el.jsxs=l,el}var mm;function c2(){return mm||(mm=1,W0.exports=l2()),W0.exports}var u=c2(),C=jl();const Te=Gu(C),Mv=s2({__proto__:null,default:Te},[C]);var Gc={},H0={exports:{}},vn={},$0={exports:{}},Y0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gm;function u2(){return gm||(gm=1,(function(e){function n(ie,B){var de=ie.length;ie.push(B);e:for(;0<de;){var I=de-1>>>1,j=ie[I];if(0<a(j,B))ie[I]=B,ie[de]=j,de=I;else break e}}function t(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var B=ie[0],de=ie.pop();if(de!==B){ie[0]=de;e:for(var I=0,j=ie.length,re=j>>>1;I<re;){var T=2*(I+1)-1,F=ie[T],O=T+1,R=ie[O];if(0>a(F,de))O<j&&0>a(R,F)?(ie[I]=R,ie[O]=de,I=O):(ie[I]=F,ie[T]=de,I=T);else if(O<j&&0>a(R,de))ie[I]=R,ie[O]=de,I=O;else break e}}return B}function a(ie,B){var de=ie.sortIndex-B.sortIndex;return de!==0?de:ie.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],h=[],p=1,m=null,g=3,v=!1,k=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(ie){for(var B=t(h);B!==null;){if(B.callback===null)r(h);else if(B.startTime<=ie)r(h),B.sortIndex=B.expirationTime,n(f,B);else break;B=t(h)}}function z(ie){if(w=!1,S(ie),!k)if(t(f)!==null)k=!0,pe(te);else{var B=t(h);B!==null&&G(z,B.startTime-ie)}}function te(ie,B){k=!1,w&&(w=!1,E(H),H=-1),v=!0;var de=g;try{for(S(B),m=t(f);m!==null&&(!(m.expirationTime>B)||ie&&!Q());){var I=m.callback;if(typeof I=="function"){m.callback=null,g=m.priorityLevel;var j=I(m.expirationTime<=B);B=e.unstable_now(),typeof j=="function"?m.callback=j:m===t(f)&&r(f),S(B)}else r(f);m=t(f)}if(m!==null)var re=!0;else{var T=t(h);T!==null&&G(z,T.startTime-B),re=!1}return re}finally{m=null,g=de,v=!1}}var V=!1,D=null,H=-1,L=5,ae=-1;function Q(){return!(e.unstable_now()-ae<L)}function Y(){if(D!==null){var ie=e.unstable_now();ae=ie;var B=!0;try{B=D(!0,ie)}finally{B?ue():(V=!1,D=null)}}else V=!1}var ue;if(typeof N=="function")ue=function(){N(Y)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,oe=le.port2;le.port1.onmessage=Y,ue=function(){oe.postMessage(null)}}else ue=function(){b(Y,0)};function pe(ie){D=ie,V||(V=!0,ue())}function G(ie,B){H=b(function(){ie(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){k||v||(k=!0,pe(te))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(ie){switch(g){case 1:case 2:case 3:var B=3;break;default:B=g}var de=g;g=B;try{return ie()}finally{g=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,B){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var de=g;g=ie;try{return B()}finally{g=de}},e.unstable_scheduleCallback=function(ie,B,de){var I=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?I+de:I):de=I,ie){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=de+j,ie={id:p++,callback:B,priorityLevel:ie,startTime:de,expirationTime:j,sortIndex:-1},de>I?(ie.sortIndex=de,n(h,ie),t(f)===null&&ie===t(h)&&(w?(E(H),H=-1):w=!0,G(z,de-I))):(ie.sortIndex=j,n(f,ie),k||v||(k=!0,pe(te))),ie},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(ie){var B=g;return function(){var de=g;g=B;try{return ie.apply(this,arguments)}finally{g=de}}}})(Y0)),Y0}var vm;function d2(){return vm||(vm=1,$0.exports=u2()),$0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ym;function f2(){if(ym)return vn;ym=1;var e=jl(),n=d2();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,d=1;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function g(s){return f.call(m,s)?!0:f.call(p,s)?!1:h.test(s)?m[s]=!0:(p[s]=!0,!1)}function v(s,i,d,x){if(d!==null&&d.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return x?!1:d!==null?!d.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function k(s,i,d,x){if(i===null||typeof i>"u"||v(s,i,d,x))return!0;if(x)return!1;if(d!==null)switch(d.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function w(s,i,d,x,y,_,A){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=x,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=s,this.type=i,this.sanitizeURL=_,this.removeEmptyString=A}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){b[s]=new w(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];b[i]=new w(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){b[s]=new w(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){b[s]=new w(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){b[s]=new w(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){b[s]=new w(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){b[s]=new w(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){b[s]=new w(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){b[s]=new w(s,5,!1,s.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function N(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(E,N);b[i]=new w(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(E,N);b[i]=new w(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(E,N);b[i]=new w(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){b[s]=new w(s,1,!1,s.toLowerCase(),null,!1,!1)}),b.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){b[s]=new w(s,1,!1,s.toLowerCase(),null,!0,!0)});function S(s,i,d,x){var y=b.hasOwnProperty(i)?b[i]:null;(y!==null?y.type!==0:x||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,d,y,x)&&(d=null),x||y===null?g(i)&&(d===null?s.removeAttribute(i):s.setAttribute(i,""+d)):y.mustUseProperty?s[y.propertyName]=d===null?y.type===3?!1:"":d:(i=y.attributeName,x=y.attributeNamespace,d===null?s.removeAttribute(i):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,x?s.setAttributeNS(x,i,d):s.setAttribute(i,d))))}var z=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),V=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),ae=Symbol.for("react.provider"),Q=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),ie=Symbol.iterator;function B(s){return s===null||typeof s!="object"?null:(s=ie&&s[ie]||s["@@iterator"],typeof s=="function"?s:null)}var de=Object.assign,I;function j(s){if(I===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);I=i&&i[1]||""}return`
`+I+s}var re=!1;function T(s,i){if(!s||re)return"";re=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Ce){var x=Ce}Reflect.construct(s,[],i)}else{try{i.call()}catch(Ce){x=Ce}s.call(i.prototype)}else{try{throw Error()}catch(Ce){x=Ce}s()}}catch(Ce){if(Ce&&x&&typeof Ce.stack=="string"){for(var y=Ce.stack.split(`
`),_=x.stack.split(`
`),A=y.length-1,se=_.length-1;1<=A&&0<=se&&y[A]!==_[se];)se--;for(;1<=A&&0<=se;A--,se--)if(y[A]!==_[se]){if(A!==1||se!==1)do if(A--,se--,0>se||y[A]!==_[se]){var fe=`
`+y[A].replace(" at new "," at ");return s.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",s.displayName)),fe}while(1<=A&&0<=se);break}}}finally{re=!1,Error.prepareStackTrace=d}return(s=s?s.displayName||s.name:"")?j(s):""}function F(s){switch(s.tag){case 5:return j(s.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return s=T(s.type,!1),s;case 11:return s=T(s.type.render,!1),s;case 1:return s=T(s.type,!0),s;default:return""}}function O(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case V:return"Portal";case L:return"Profiler";case H:return"StrictMode";case ue:return"Suspense";case le:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Q:return(s.displayName||"Context")+".Consumer";case ae:return(s._context.displayName||"Context")+".Provider";case Y:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case oe:return i=s.displayName||null,i!==null?i:O(s.type)||"Memo";case pe:i=s._payload,s=s._init;try{return O(s(i))}catch{}}return null}function R(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return O(i);case 8:return i===H?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function J(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Z(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function U(s){var i=Z(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),x=""+s[i];if(!s.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,_=d.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return y.call(this)},set:function(A){x=""+A,_.call(this,A)}}),Object.defineProperty(s,i,{enumerable:d.enumerable}),{getValue:function(){return x},setValue:function(A){x=""+A},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function xe(s){s._valueTracker||(s._valueTracker=U(s))}function M(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var d=i.getValue(),x="";return s&&(x=Z(s)?s.checked?"true":"false":s.value),s=x,s!==d?(i.setValue(s),!0):!1}function ve(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function ye(s,i){var d=i.checked;return de({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??s._wrapperState.initialChecked})}function Me(s,i){var d=i.defaultValue==null?"":i.defaultValue,x=i.checked!=null?i.checked:i.defaultChecked;d=J(i.value!=null?i.value:d),s._wrapperState={initialChecked:x,initialValue:d,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Pe(s,i){i=i.checked,i!=null&&S(s,"checked",i,!1)}function ce(s,i){Pe(s,i);var d=J(i.value),x=i.type;if(d!=null)x==="number"?(d===0&&s.value===""||s.value!=d)&&(s.value=""+d):s.value!==""+d&&(s.value=""+d);else if(x==="submit"||x==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?Re(s,i.type,d):i.hasOwnProperty("defaultValue")&&Re(s,i.type,J(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Fe(s,i,d){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var x=i.type;if(!(x!=="submit"&&x!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,d||i===s.value||(s.value=i),s.defaultValue=i}d=s.name,d!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,d!==""&&(s.name=d)}function Re(s,i,d){(i!=="number"||ve(s.ownerDocument)!==s)&&(d==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+d&&(s.defaultValue=""+d))}var De=Array.isArray;function lt(s,i,d,x){if(s=s.options,i){i={};for(var y=0;y<d.length;y++)i["$"+d[y]]=!0;for(d=0;d<s.length;d++)y=i.hasOwnProperty("$"+s[d].value),s[d].selected!==y&&(s[d].selected=y),y&&x&&(s[d].defaultSelected=!0)}else{for(d=""+J(d),i=null,y=0;y<s.length;y++){if(s[y].value===d){s[y].selected=!0,x&&(s[y].defaultSelected=!0);return}i!==null||s[y].disabled||(i=s[y])}i!==null&&(i.selected=!0)}}function ft(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return de({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function gt(s,i){var d=i.value;if(d==null){if(d=i.children,i=i.defaultValue,d!=null){if(i!=null)throw Error(t(92));if(De(d)){if(1<d.length)throw Error(t(93));d=d[0]}i=d}i==null&&(i=""),d=i}s._wrapperState={initialValue:J(d)}}function Nt(s,i){var d=J(i.value),x=J(i.defaultValue);d!=null&&(d=""+d,d!==s.value&&(s.value=d),i.defaultValue==null&&s.defaultValue!==d&&(s.defaultValue=d)),x!=null&&(s.defaultValue=""+x)}function zt(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Qt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qt(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Qt(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Bt,rr=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,d,x,y){MSApp.execUnsafeLocalFunction(function(){return s(i,d,x,y)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Bt=Bt||document.createElement("div"),Bt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Bt.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function ut(s,i){if(i){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=i;return}}s.textContent=i}var _t={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ht=["Webkit","ms","Moz","O"];Object.keys(_t).forEach(function(s){Ht.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),_t[i]=_t[s]})});function Dt(s,i,d){return i==null||typeof i=="boolean"||i===""?"":d||typeof i!="number"||i===0||_t.hasOwnProperty(s)&&_t[s]?(""+i).trim():i+"px"}function Zt(s,i){s=s.style;for(var d in i)if(i.hasOwnProperty(d)){var x=d.indexOf("--")===0,y=Dt(d,i[d],x);d==="float"&&(d="cssFloat"),x?s.setProperty(d,y):s[d]=y}}var $t=de({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function he(s,i){if(i){if($t[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Oe(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ie=null;function X(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var me=null,Ne=null,Ae=null;function et(s){if(s=Li(s)){if(typeof me!="function")throw Error(t(280));var i=s.stateNode;i&&(i=cc(i),me(s.stateNode,s.type,i))}}function at(s){Ne?Ae?Ae.push(s):Ae=[s]:Ne=s}function dt(){if(Ne){var s=Ne,i=Ae;if(Ae=Ne=null,et(s),i)for(s=0;s<i.length;s++)et(i[s])}}function Et(s,i){return s(i)}function qe(){}var Ze=!1;function tt(s,i,d){if(Ze)return s(i,d);Ze=!0;try{return Et(s,i,d)}finally{Ze=!1,(Ne!==null||Ae!==null)&&(qe(),dt())}}function ct(s,i){var d=s.stateNode;if(d===null)return null;var x=cc(d);if(x===null)return null;d=x[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(t(231,i,typeof d));return d}var Ve=!1;if(c)try{var Ge={};Object.defineProperty(Ge,"passive",{get:function(){Ve=!0}}),window.addEventListener("test",Ge,Ge),window.removeEventListener("test",Ge,Ge)}catch{Ve=!1}function pt(s,i,d,x,y,_,A,se,fe){var Ce=Array.prototype.slice.call(arguments,3);try{i.apply(d,Ce)}catch(Le){this.onError(Le)}}var Ft=!1,Yt=null,P=!1,ee=null,W={onError:function(s){Ft=!0,Yt=s}};function K(s,i,d,x,y,_,A,se,fe){Ft=!1,Yt=null,pt.apply(W,arguments)}function q(s,i,d,x,y,_,A,se,fe){if(K.apply(this,arguments),Ft){if(Ft){var Ce=Yt;Ft=!1,Yt=null}else throw Error(t(198));P||(P=!0,ee=Ce)}}function ne(s){var i=s,d=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(d=i.return),s=i.return;while(s)}return i.tag===3?d:null}function be(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function je(s){if(ne(s)!==s)throw Error(t(188))}function ke(s){var i=s.alternate;if(!i){if(i=ne(s),i===null)throw Error(t(188));return i!==s?null:s}for(var d=s,x=i;;){var y=d.return;if(y===null)break;var _=y.alternate;if(_===null){if(x=y.return,x!==null){d=x;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===d)return je(y),s;if(_===x)return je(y),i;_=_.sibling}throw Error(t(188))}if(d.return!==x.return)d=y,x=_;else{for(var A=!1,se=y.child;se;){if(se===d){A=!0,d=y,x=_;break}if(se===x){A=!0,x=y,d=_;break}se=se.sibling}if(!A){for(se=_.child;se;){if(se===d){A=!0,d=_,x=y;break}if(se===x){A=!0,x=_,d=y;break}se=se.sibling}if(!A)throw Error(t(189))}}if(d.alternate!==x)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?s:i}function Se(s){return s=ke(s),s!==null?Ee(s):null}function Ee(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=Ee(s);if(i!==null)return i;s=s.sibling}return null}var Be=n.unstable_scheduleCallback,Ke=n.unstable_cancelCallback,We=n.unstable_shouldYield,Ue=n.unstable_requestPaint,He=n.unstable_now,mt=n.unstable_getCurrentPriorityLevel,Vt=n.unstable_ImmediatePriority,Wt=n.unstable_UserBlockingPriority,mr=n.unstable_NormalPriority,Ls=n.unstable_LowPriority,es=n.unstable_IdlePriority,ca=null,jr=null;function wi(s){if(jr&&typeof jr.onCommitFiberRoot=="function")try{jr.onCommitFiberRoot(ca,s,void 0,(s.current.flags&128)===128)}catch{}}var gr=Math.clz32?Math.clz32:_w,kw=Math.log,bw=Math.LN2;function _w(s){return s>>>=0,s===0?32:31-(kw(s)/bw|0)|0}var Yl=64,Vl=4194304;function ki(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Kl(s,i){var d=s.pendingLanes;if(d===0)return 0;var x=0,y=s.suspendedLanes,_=s.pingedLanes,A=d&268435455;if(A!==0){var se=A&~y;se!==0?x=ki(se):(_&=A,_!==0&&(x=ki(_)))}else A=d&~y,A!==0?x=ki(A):_!==0&&(x=ki(_));if(x===0)return 0;if(i!==0&&i!==x&&(i&y)===0&&(y=x&-x,_=i&-i,y>=_||y===16&&(_&4194240)!==0))return i;if((x&4)!==0&&(x|=d&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=x;0<i;)d=31-gr(i),y=1<<d,x|=s[d],i&=~y;return x}function Sw(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ew(s,i){for(var d=s.suspendedLanes,x=s.pingedLanes,y=s.expirationTimes,_=s.pendingLanes;0<_;){var A=31-gr(_),se=1<<A,fe=y[A];fe===-1?((se&d)===0||(se&x)!==0)&&(y[A]=Sw(se,i)):fe<=i&&(s.expiredLanes|=se),_&=~se}}function ld(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function $p(){var s=Yl;return Yl<<=1,(Yl&4194240)===0&&(Yl=64),s}function cd(s){for(var i=[],d=0;31>d;d++)i.push(s);return i}function bi(s,i,d){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-gr(i),s[i]=d}function Cw(s,i){var d=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var x=s.eventTimes;for(s=s.expirationTimes;0<d;){var y=31-gr(d),_=1<<y;i[y]=0,x[y]=-1,s[y]=-1,d&=~_}}function ud(s,i){var d=s.entangledLanes|=i;for(s=s.entanglements;d;){var x=31-gr(d),y=1<<x;y&i|s[x]&i&&(s[x]|=i),d&=~y}}var Kt=0;function Yp(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Vp,dd,Kp,Gp,Xp,fd=!1,Gl=[],ts=null,rs=null,ns=null,_i=new Map,Si=new Map,as=[],Tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qp(s,i){switch(s){case"focusin":case"focusout":ts=null;break;case"dragenter":case"dragleave":rs=null;break;case"mouseover":case"mouseout":ns=null;break;case"pointerover":case"pointerout":_i.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Si.delete(i.pointerId)}}function Ei(s,i,d,x,y,_){return s===null||s.nativeEvent!==_?(s={blockedOn:i,domEventName:d,eventSystemFlags:x,nativeEvent:_,targetContainers:[y]},i!==null&&(i=Li(i),i!==null&&dd(i)),s):(s.eventSystemFlags|=x,i=s.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),s)}function Nw(s,i,d,x,y){switch(i){case"focusin":return ts=Ei(ts,s,i,d,x,y),!0;case"dragenter":return rs=Ei(rs,s,i,d,x,y),!0;case"mouseover":return ns=Ei(ns,s,i,d,x,y),!0;case"pointerover":var _=y.pointerId;return _i.set(_,Ei(_i.get(_)||null,s,i,d,x,y)),!0;case"gotpointercapture":return _=y.pointerId,Si.set(_,Ei(Si.get(_)||null,s,i,d,x,y)),!0}return!1}function qp(s){var i=Bs(s.target);if(i!==null){var d=ne(i);if(d!==null){if(i=d.tag,i===13){if(i=be(d),i!==null){s.blockedOn=i,Xp(s.priority,function(){Kp(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xl(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var d=hd(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(d===null){d=s.nativeEvent;var x=new d.constructor(d.type,d);Ie=x,d.target.dispatchEvent(x),Ie=null}else return i=Li(d),i!==null&&dd(i),s.blockedOn=d,!1;i.shift()}return!0}function Zp(s,i,d){Xl(s)&&d.delete(i)}function Dw(){fd=!1,ts!==null&&Xl(ts)&&(ts=null),rs!==null&&Xl(rs)&&(rs=null),ns!==null&&Xl(ns)&&(ns=null),_i.forEach(Zp),Si.forEach(Zp)}function Ci(s,i){s.blockedOn===i&&(s.blockedOn=null,fd||(fd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Dw)))}function Ti(s){function i(y){return Ci(y,s)}if(0<Gl.length){Ci(Gl[0],s);for(var d=1;d<Gl.length;d++){var x=Gl[d];x.blockedOn===s&&(x.blockedOn=null)}}for(ts!==null&&Ci(ts,s),rs!==null&&Ci(rs,s),ns!==null&&Ci(ns,s),_i.forEach(i),Si.forEach(i),d=0;d<as.length;d++)x=as[d],x.blockedOn===s&&(x.blockedOn=null);for(;0<as.length&&(d=as[0],d.blockedOn===null);)qp(d),d.blockedOn===null&&as.shift()}var Co=z.ReactCurrentBatchConfig,Ql=!0;function Fw(s,i,d,x){var y=Kt,_=Co.transition;Co.transition=null;try{Kt=1,pd(s,i,d,x)}finally{Kt=y,Co.transition=_}}function jw(s,i,d,x){var y=Kt,_=Co.transition;Co.transition=null;try{Kt=4,pd(s,i,d,x)}finally{Kt=y,Co.transition=_}}function pd(s,i,d,x){if(Ql){var y=hd(s,i,d,x);if(y===null)jd(s,i,x,ql,d),Qp(s,x);else if(Nw(y,s,i,d,x))x.stopPropagation();else if(Qp(s,x),i&4&&-1<Tw.indexOf(s)){for(;y!==null;){var _=Li(y);if(_!==null&&Vp(_),_=hd(s,i,d,x),_===null&&jd(s,i,x,ql,d),_===y)break;y=_}y!==null&&x.stopPropagation()}else jd(s,i,x,null,d)}}var ql=null;function hd(s,i,d,x){if(ql=null,s=X(x),s=Bs(s),s!==null)if(i=ne(s),i===null)s=null;else if(d=i.tag,d===13){if(s=be(i),s!==null)return s;s=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return ql=s,null}function Jp(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case Vt:return 1;case Wt:return 4;case mr:case Ls:return 16;case es:return 536870912;default:return 16}default:return 16}}var ss=null,xd=null,Zl=null;function eh(){if(Zl)return Zl;var s,i=xd,d=i.length,x,y="value"in ss?ss.value:ss.textContent,_=y.length;for(s=0;s<d&&i[s]===y[s];s++);var A=d-s;for(x=1;x<=A&&i[d-x]===y[_-x];x++);return Zl=y.slice(s,1<x?1-x:void 0)}function Jl(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ec(){return!0}function th(){return!1}function wn(s){function i(d,x,y,_,A){this._reactName=d,this._targetInst=y,this.type=x,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var se in s)s.hasOwnProperty(se)&&(d=s[se],this[se]=d?d(_):_[se]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ec:th,this.isPropagationStopped=th,this}return de(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=ec)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=ec)},persist:function(){},isPersistent:ec}),i}var To={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},md=wn(To),Ni=de({},To,{view:0,detail:0}),Aw=wn(Ni),gd,vd,Di,tc=de({},Ni,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Di&&(Di&&s.type==="mousemove"?(gd=s.screenX-Di.screenX,vd=s.screenY-Di.screenY):vd=gd=0,Di=s),gd)},movementY:function(s){return"movementY"in s?s.movementY:vd}}),rh=wn(tc),Pw=de({},tc,{dataTransfer:0}),Ow=wn(Pw),Rw=de({},Ni,{relatedTarget:0}),yd=wn(Rw),Mw=de({},To,{animationName:0,elapsedTime:0,pseudoElement:0}),Iw=wn(Mw),zw=de({},To,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Lw=wn(zw),Bw=de({},To,{data:0}),nh=wn(Bw),Ww={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $w(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Hw[s])?!!i[s]:!1}function wd(){return $w}var Yw=de({},Ni,{key:function(s){if(s.key){var i=Ww[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Jl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Uw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wd,charCode:function(s){return s.type==="keypress"?Jl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Jl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Vw=wn(Yw),Kw=de({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ah=wn(Kw),Gw=de({},Ni,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wd}),Xw=wn(Gw),Qw=de({},To,{propertyName:0,elapsedTime:0,pseudoElement:0}),qw=wn(Qw),Zw=de({},tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Jw=wn(Zw),ek=[9,13,27,32],kd=c&&"CompositionEvent"in window,Fi=null;c&&"documentMode"in document&&(Fi=document.documentMode);var tk=c&&"TextEvent"in window&&!Fi,sh=c&&(!kd||Fi&&8<Fi&&11>=Fi),oh=" ",ih=!1;function lh(s,i){switch(s){case"keyup":return ek.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ch(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var No=!1;function rk(s,i){switch(s){case"compositionend":return ch(i);case"keypress":return i.which!==32?null:(ih=!0,oh);case"textInput":return s=i.data,s===oh&&ih?null:s;default:return null}}function nk(s,i){if(No)return s==="compositionend"||!kd&&lh(s,i)?(s=eh(),Zl=xd=ss=null,No=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return sh&&i.locale!=="ko"?null:i.data;default:return null}}var ak={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!ak[s.type]:i==="textarea"}function dh(s,i,d,x){at(x),i=oc(i,"onChange"),0<i.length&&(d=new md("onChange","change",null,d,x),s.push({event:d,listeners:i}))}var ji=null,Ai=null;function sk(s){Dh(s,0)}function rc(s){var i=Po(s);if(M(i))return s}function ok(s,i){if(s==="change")return i}var fh=!1;if(c){var bd;if(c){var _d="oninput"in document;if(!_d){var ph=document.createElement("div");ph.setAttribute("oninput","return;"),_d=typeof ph.oninput=="function"}bd=_d}else bd=!1;fh=bd&&(!document.documentMode||9<document.documentMode)}function hh(){ji&&(ji.detachEvent("onpropertychange",xh),Ai=ji=null)}function xh(s){if(s.propertyName==="value"&&rc(Ai)){var i=[];dh(i,Ai,s,X(s)),tt(sk,i)}}function ik(s,i,d){s==="focusin"?(hh(),ji=i,Ai=d,ji.attachEvent("onpropertychange",xh)):s==="focusout"&&hh()}function lk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return rc(Ai)}function ck(s,i){if(s==="click")return rc(i)}function uk(s,i){if(s==="input"||s==="change")return rc(i)}function dk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Kn=typeof Object.is=="function"?Object.is:dk;function Pi(s,i){if(Kn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var d=Object.keys(s),x=Object.keys(i);if(d.length!==x.length)return!1;for(x=0;x<d.length;x++){var y=d[x];if(!f.call(i,y)||!Kn(s[y],i[y]))return!1}return!0}function mh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function gh(s,i){var d=mh(s);s=0;for(var x;d;){if(d.nodeType===3){if(x=s+d.textContent.length,s<=i&&x>=i)return{node:d,offset:i-s};s=x}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=mh(d)}}function vh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?vh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function yh(){for(var s=window,i=ve();i instanceof s.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)s=i.contentWindow;else break;i=ve(s.document)}return i}function Sd(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function fk(s){var i=yh(),d=s.focusedElem,x=s.selectionRange;if(i!==d&&d&&d.ownerDocument&&vh(d.ownerDocument.documentElement,d)){if(x!==null&&Sd(d)){if(i=x.start,s=x.end,s===void 0&&(s=i),"selectionStart"in d)d.selectionStart=i,d.selectionEnd=Math.min(s,d.value.length);else if(s=(i=d.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var y=d.textContent.length,_=Math.min(x.start,y);x=x.end===void 0?_:Math.min(x.end,y),!s.extend&&_>x&&(y=x,x=_,_=y),y=gh(d,_);var A=gh(d,x);y&&A&&(s.rangeCount!==1||s.anchorNode!==y.node||s.anchorOffset!==y.offset||s.focusNode!==A.node||s.focusOffset!==A.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),s.removeAllRanges(),_>x?(s.addRange(i),s.extend(A.node,A.offset)):(i.setEnd(A.node,A.offset),s.addRange(i)))}}for(i=[],s=d;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<i.length;d++)s=i[d],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var pk=c&&"documentMode"in document&&11>=document.documentMode,Do=null,Ed=null,Oi=null,Cd=!1;function wh(s,i,d){var x=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Cd||Do==null||Do!==ve(x)||(x=Do,"selectionStart"in x&&Sd(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Oi&&Pi(Oi,x)||(Oi=x,x=oc(Ed,"onSelect"),0<x.length&&(i=new md("onSelect","select",null,i,d),s.push({event:i,listeners:x}),i.target=Do)))}function nc(s,i){var d={};return d[s.toLowerCase()]=i.toLowerCase(),d["Webkit"+s]="webkit"+i,d["Moz"+s]="moz"+i,d}var Fo={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Td={},kh={};c&&(kh=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function ac(s){if(Td[s])return Td[s];if(!Fo[s])return s;var i=Fo[s],d;for(d in i)if(i.hasOwnProperty(d)&&d in kh)return Td[s]=i[d];return s}var bh=ac("animationend"),_h=ac("animationiteration"),Sh=ac("animationstart"),Eh=ac("transitionend"),Ch=new Map,Th="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function os(s,i){Ch.set(s,i),o(i,[s])}for(var Nd=0;Nd<Th.length;Nd++){var Dd=Th[Nd],hk=Dd.toLowerCase(),xk=Dd[0].toUpperCase()+Dd.slice(1);os(hk,"on"+xk)}os(bh,"onAnimationEnd"),os(_h,"onAnimationIteration"),os(Sh,"onAnimationStart"),os("dblclick","onDoubleClick"),os("focusin","onFocus"),os("focusout","onBlur"),os(Eh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function Nh(s,i,d){var x=s.type||"unknown-event";s.currentTarget=d,q(x,i,void 0,s),s.currentTarget=null}function Dh(s,i){i=(i&4)!==0;for(var d=0;d<s.length;d++){var x=s[d],y=x.event;x=x.listeners;e:{var _=void 0;if(i)for(var A=x.length-1;0<=A;A--){var se=x[A],fe=se.instance,Ce=se.currentTarget;if(se=se.listener,fe!==_&&y.isPropagationStopped())break e;Nh(y,se,Ce),_=fe}else for(A=0;A<x.length;A++){if(se=x[A],fe=se.instance,Ce=se.currentTarget,se=se.listener,fe!==_&&y.isPropagationStopped())break e;Nh(y,se,Ce),_=fe}}}if(P)throw s=ee,P=!1,ee=null,s}function nr(s,i){var d=i[Id];d===void 0&&(d=i[Id]=new Set);var x=s+"__bubble";d.has(x)||(Fh(i,s,2,!1),d.add(x))}function Fd(s,i,d){var x=0;i&&(x|=4),Fh(d,s,x,i)}var sc="_reactListening"+Math.random().toString(36).slice(2);function Mi(s){if(!s[sc]){s[sc]=!0,r.forEach(function(d){d!=="selectionchange"&&(mk.has(d)||Fd(d,!1,s),Fd(d,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[sc]||(i[sc]=!0,Fd("selectionchange",!1,i))}}function Fh(s,i,d,x){switch(Jp(i)){case 1:var y=Fw;break;case 4:y=jw;break;default:y=pd}d=y.bind(null,i,d,s),y=void 0,!Ve||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),x?y!==void 0?s.addEventListener(i,d,{capture:!0,passive:y}):s.addEventListener(i,d,!0):y!==void 0?s.addEventListener(i,d,{passive:y}):s.addEventListener(i,d,!1)}function jd(s,i,d,x,y){var _=x;if((i&1)===0&&(i&2)===0&&x!==null)e:for(;;){if(x===null)return;var A=x.tag;if(A===3||A===4){var se=x.stateNode.containerInfo;if(se===y||se.nodeType===8&&se.parentNode===y)break;if(A===4)for(A=x.return;A!==null;){var fe=A.tag;if((fe===3||fe===4)&&(fe=A.stateNode.containerInfo,fe===y||fe.nodeType===8&&fe.parentNode===y))return;A=A.return}for(;se!==null;){if(A=Bs(se),A===null)return;if(fe=A.tag,fe===5||fe===6){x=_=A;continue e}se=se.parentNode}}x=x.return}tt(function(){var Ce=_,Le=X(d),$e=[];e:{var ze=Ch.get(s);if(ze!==void 0){var Je=md,nt=s;switch(s){case"keypress":if(Jl(d)===0)break e;case"keydown":case"keyup":Je=Vw;break;case"focusin":nt="focus",Je=yd;break;case"focusout":nt="blur",Je=yd;break;case"beforeblur":case"afterblur":Je=yd;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Je=rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Je=Ow;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Je=Xw;break;case bh:case _h:case Sh:Je=Iw;break;case Eh:Je=qw;break;case"scroll":Je=Aw;break;case"wheel":Je=Jw;break;case"copy":case"cut":case"paste":Je=Lw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Je=ah}var st=(i&4)!==0,vr=!st&&s==="scroll",we=st?ze!==null?ze+"Capture":null:ze;st=[];for(var ge=Ce,_e;ge!==null;){_e=ge;var Ye=_e.stateNode;if(_e.tag===5&&Ye!==null&&(_e=Ye,we!==null&&(Ye=ct(ge,we),Ye!=null&&st.push(Ii(ge,Ye,_e)))),vr)break;ge=ge.return}0<st.length&&(ze=new Je(ze,nt,null,d,Le),$e.push({event:ze,listeners:st}))}}if((i&7)===0){e:{if(ze=s==="mouseover"||s==="pointerover",Je=s==="mouseout"||s==="pointerout",ze&&d!==Ie&&(nt=d.relatedTarget||d.fromElement)&&(Bs(nt)||nt[Pa]))break e;if((Je||ze)&&(ze=Le.window===Le?Le:(ze=Le.ownerDocument)?ze.defaultView||ze.parentWindow:window,Je?(nt=d.relatedTarget||d.toElement,Je=Ce,nt=nt?Bs(nt):null,nt!==null&&(vr=ne(nt),nt!==vr||nt.tag!==5&&nt.tag!==6)&&(nt=null)):(Je=null,nt=Ce),Je!==nt)){if(st=rh,Ye="onMouseLeave",we="onMouseEnter",ge="mouse",(s==="pointerout"||s==="pointerover")&&(st=ah,Ye="onPointerLeave",we="onPointerEnter",ge="pointer"),vr=Je==null?ze:Po(Je),_e=nt==null?ze:Po(nt),ze=new st(Ye,ge+"leave",Je,d,Le),ze.target=vr,ze.relatedTarget=_e,Ye=null,Bs(Le)===Ce&&(st=new st(we,ge+"enter",nt,d,Le),st.target=_e,st.relatedTarget=vr,Ye=st),vr=Ye,Je&&nt)t:{for(st=Je,we=nt,ge=0,_e=st;_e;_e=jo(_e))ge++;for(_e=0,Ye=we;Ye;Ye=jo(Ye))_e++;for(;0<ge-_e;)st=jo(st),ge--;for(;0<_e-ge;)we=jo(we),_e--;for(;ge--;){if(st===we||we!==null&&st===we.alternate)break t;st=jo(st),we=jo(we)}st=null}else st=null;Je!==null&&jh($e,ze,Je,st,!1),nt!==null&&vr!==null&&jh($e,vr,nt,st,!0)}}e:{if(ze=Ce?Po(Ce):window,Je=ze.nodeName&&ze.nodeName.toLowerCase(),Je==="select"||Je==="input"&&ze.type==="file")var ot=ok;else if(uh(ze))if(fh)ot=uk;else{ot=lk;var ht=ik}else(Je=ze.nodeName)&&Je.toLowerCase()==="input"&&(ze.type==="checkbox"||ze.type==="radio")&&(ot=ck);if(ot&&(ot=ot(s,Ce))){dh($e,ot,d,Le);break e}ht&&ht(s,ze,Ce),s==="focusout"&&(ht=ze._wrapperState)&&ht.controlled&&ze.type==="number"&&Re(ze,"number",ze.value)}switch(ht=Ce?Po(Ce):window,s){case"focusin":(uh(ht)||ht.contentEditable==="true")&&(Do=ht,Ed=Ce,Oi=null);break;case"focusout":Oi=Ed=Do=null;break;case"mousedown":Cd=!0;break;case"contextmenu":case"mouseup":case"dragend":Cd=!1,wh($e,d,Le);break;case"selectionchange":if(pk)break;case"keydown":case"keyup":wh($e,d,Le)}var xt;if(kd)e:{switch(s){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else No?lh(s,d)&&(yt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(yt="onCompositionStart");yt&&(sh&&d.locale!=="ko"&&(No||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&No&&(xt=eh()):(ss=Le,xd="value"in ss?ss.value:ss.textContent,No=!0)),ht=oc(Ce,yt),0<ht.length&&(yt=new nh(yt,s,null,d,Le),$e.push({event:yt,listeners:ht}),xt?yt.data=xt:(xt=ch(d),xt!==null&&(yt.data=xt)))),(xt=tk?rk(s,d):nk(s,d))&&(Ce=oc(Ce,"onBeforeInput"),0<Ce.length&&(Le=new nh("onBeforeInput","beforeinput",null,d,Le),$e.push({event:Le,listeners:Ce}),Le.data=xt))}Dh($e,i)})}function Ii(s,i,d){return{instance:s,listener:i,currentTarget:d}}function oc(s,i){for(var d=i+"Capture",x=[];s!==null;){var y=s,_=y.stateNode;y.tag===5&&_!==null&&(y=_,_=ct(s,d),_!=null&&x.unshift(Ii(s,_,y)),_=ct(s,i),_!=null&&x.push(Ii(s,_,y))),s=s.return}return x}function jo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function jh(s,i,d,x,y){for(var _=i._reactName,A=[];d!==null&&d!==x;){var se=d,fe=se.alternate,Ce=se.stateNode;if(fe!==null&&fe===x)break;se.tag===5&&Ce!==null&&(se=Ce,y?(fe=ct(d,_),fe!=null&&A.unshift(Ii(d,fe,se))):y||(fe=ct(d,_),fe!=null&&A.push(Ii(d,fe,se)))),d=d.return}A.length!==0&&s.push({event:i,listeners:A})}var gk=/\r\n?/g,vk=/\u0000|\uFFFD/g;function Ah(s){return(typeof s=="string"?s:""+s).replace(gk,`
`).replace(vk,"")}function ic(s,i,d){if(i=Ah(i),Ah(s)!==i&&d)throw Error(t(425))}function lc(){}var Ad=null,Pd=null;function Od(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Rd=typeof setTimeout=="function"?setTimeout:void 0,yk=typeof clearTimeout=="function"?clearTimeout:void 0,Ph=typeof Promise=="function"?Promise:void 0,wk=typeof queueMicrotask=="function"?queueMicrotask:typeof Ph<"u"?function(s){return Ph.resolve(null).then(s).catch(kk)}:Rd;function kk(s){setTimeout(function(){throw s})}function Md(s,i){var d=i,x=0;do{var y=d.nextSibling;if(s.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(x===0){s.removeChild(y),Ti(i);return}x--}else d!=="$"&&d!=="$?"&&d!=="$!"||x++;d=y}while(d);Ti(i)}function is(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Oh(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return s;i--}else d==="/$"&&i++}s=s.previousSibling}return null}var Ao=Math.random().toString(36).slice(2),ua="__reactFiber$"+Ao,zi="__reactProps$"+Ao,Pa="__reactContainer$"+Ao,Id="__reactEvents$"+Ao,bk="__reactListeners$"+Ao,_k="__reactHandles$"+Ao;function Bs(s){var i=s[ua];if(i)return i;for(var d=s.parentNode;d;){if(i=d[Pa]||d[ua]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(s=Oh(s);s!==null;){if(d=s[ua])return d;s=Oh(s)}return i}s=d,d=s.parentNode}return null}function Li(s){return s=s[ua]||s[Pa],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Po(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function cc(s){return s[zi]||null}var zd=[],Oo=-1;function ls(s){return{current:s}}function ar(s){0>Oo||(s.current=zd[Oo],zd[Oo]=null,Oo--)}function Jt(s,i){Oo++,zd[Oo]=s.current,s.current=i}var cs={},$r=ls(cs),pn=ls(!1),Ws=cs;function Ro(s,i){var d=s.type.contextTypes;if(!d)return cs;var x=s.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===i)return x.__reactInternalMemoizedMaskedChildContext;var y={},_;for(_ in d)y[_]=i[_];return x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=y),y}function hn(s){return s=s.childContextTypes,s!=null}function uc(){ar(pn),ar($r)}function Rh(s,i,d){if($r.current!==cs)throw Error(t(168));Jt($r,i),Jt(pn,d)}function Mh(s,i,d){var x=s.stateNode;if(i=i.childContextTypes,typeof x.getChildContext!="function")return d;x=x.getChildContext();for(var y in x)if(!(y in i))throw Error(t(108,R(s)||"Unknown",y));return de({},d,x)}function dc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||cs,Ws=$r.current,Jt($r,s),Jt(pn,pn.current),!0}function Ih(s,i,d){var x=s.stateNode;if(!x)throw Error(t(169));d?(s=Mh(s,i,Ws),x.__reactInternalMemoizedMergedChildContext=s,ar(pn),ar($r),Jt($r,s)):ar(pn),Jt(pn,d)}var Oa=null,fc=!1,Ld=!1;function zh(s){Oa===null?Oa=[s]:Oa.push(s)}function Sk(s){fc=!0,zh(s)}function us(){if(!Ld&&Oa!==null){Ld=!0;var s=0,i=Kt;try{var d=Oa;for(Kt=1;s<d.length;s++){var x=d[s];do x=x(!0);while(x!==null)}Oa=null,fc=!1}catch(y){throw Oa!==null&&(Oa=Oa.slice(s+1)),Be(Vt,us),y}finally{Kt=i,Ld=!1}}return null}var Mo=[],Io=0,pc=null,hc=0,Nn=[],Dn=0,Us=null,Ra=1,Ma="";function Hs(s,i){Mo[Io++]=hc,Mo[Io++]=pc,pc=s,hc=i}function Lh(s,i,d){Nn[Dn++]=Ra,Nn[Dn++]=Ma,Nn[Dn++]=Us,Us=s;var x=Ra;s=Ma;var y=32-gr(x)-1;x&=~(1<<y),d+=1;var _=32-gr(i)+y;if(30<_){var A=y-y%5;_=(x&(1<<A)-1).toString(32),x>>=A,y-=A,Ra=1<<32-gr(i)+y|d<<y|x,Ma=_+s}else Ra=1<<_|d<<y|x,Ma=s}function Bd(s){s.return!==null&&(Hs(s,1),Lh(s,1,0))}function Wd(s){for(;s===pc;)pc=Mo[--Io],Mo[Io]=null,hc=Mo[--Io],Mo[Io]=null;for(;s===Us;)Us=Nn[--Dn],Nn[Dn]=null,Ma=Nn[--Dn],Nn[Dn]=null,Ra=Nn[--Dn],Nn[Dn]=null}var kn=null,bn=null,sr=!1,Gn=null;function Bh(s,i){var d=Pn(5,null,null,0);d.elementType="DELETED",d.stateNode=i,d.return=s,i=s.deletions,i===null?(s.deletions=[d],s.flags|=16):i.push(d)}function Wh(s,i){switch(s.tag){case 5:var d=s.type;return i=i.nodeType!==1||d.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,kn=s,bn=is(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,kn=s,bn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(d=Us!==null?{id:Ra,overflow:Ma}:null,s.memoizedState={dehydrated:i,treeContext:d,retryLane:1073741824},d=Pn(18,null,null,0),d.stateNode=i,d.return=s,s.child=d,kn=s,bn=null,!0):!1;default:return!1}}function Ud(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Hd(s){if(sr){var i=bn;if(i){var d=i;if(!Wh(s,i)){if(Ud(s))throw Error(t(418));i=is(d.nextSibling);var x=kn;i&&Wh(s,i)?Bh(x,d):(s.flags=s.flags&-4097|2,sr=!1,kn=s)}}else{if(Ud(s))throw Error(t(418));s.flags=s.flags&-4097|2,sr=!1,kn=s}}}function Uh(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;kn=s}function xc(s){if(s!==kn)return!1;if(!sr)return Uh(s),sr=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Od(s.type,s.memoizedProps)),i&&(i=bn)){if(Ud(s))throw Hh(),Error(t(418));for(;i;)Bh(s,i),i=is(i.nextSibling)}if(Uh(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"){if(i===0){bn=is(s.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++}s=s.nextSibling}bn=null}}else bn=kn?is(s.stateNode.nextSibling):null;return!0}function Hh(){for(var s=bn;s;)s=is(s.nextSibling)}function zo(){bn=kn=null,sr=!1}function $d(s){Gn===null?Gn=[s]:Gn.push(s)}var Ek=z.ReactCurrentBatchConfig;function Bi(s,i,d){if(s=d.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var x=d.stateNode}if(!x)throw Error(t(147,s));var y=x,_=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===_?i.ref:(i=function(A){var se=y.refs;A===null?delete se[_]:se[_]=A},i._stringRef=_,i)}if(typeof s!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,s))}return s}function mc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function $h(s){var i=s._init;return i(s._payload)}function Yh(s){function i(we,ge){if(s){var _e=we.deletions;_e===null?(we.deletions=[ge],we.flags|=16):_e.push(ge)}}function d(we,ge){if(!s)return null;for(;ge!==null;)i(we,ge),ge=ge.sibling;return null}function x(we,ge){for(we=new Map;ge!==null;)ge.key!==null?we.set(ge.key,ge):we.set(ge.index,ge),ge=ge.sibling;return we}function y(we,ge){return we=vs(we,ge),we.index=0,we.sibling=null,we}function _(we,ge,_e){return we.index=_e,s?(_e=we.alternate,_e!==null?(_e=_e.index,_e<ge?(we.flags|=2,ge):_e):(we.flags|=2,ge)):(we.flags|=1048576,ge)}function A(we){return s&&we.alternate===null&&(we.flags|=2),we}function se(we,ge,_e,Ye){return ge===null||ge.tag!==6?(ge=R0(_e,we.mode,Ye),ge.return=we,ge):(ge=y(ge,_e),ge.return=we,ge)}function fe(we,ge,_e,Ye){var ot=_e.type;return ot===D?Le(we,ge,_e.props.children,Ye,_e.key):ge!==null&&(ge.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===pe&&$h(ot)===ge.type)?(Ye=y(ge,_e.props),Ye.ref=Bi(we,ge,_e),Ye.return=we,Ye):(Ye=Bc(_e.type,_e.key,_e.props,null,we.mode,Ye),Ye.ref=Bi(we,ge,_e),Ye.return=we,Ye)}function Ce(we,ge,_e,Ye){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==_e.containerInfo||ge.stateNode.implementation!==_e.implementation?(ge=M0(_e,we.mode,Ye),ge.return=we,ge):(ge=y(ge,_e.children||[]),ge.return=we,ge)}function Le(we,ge,_e,Ye,ot){return ge===null||ge.tag!==7?(ge=qs(_e,we.mode,Ye,ot),ge.return=we,ge):(ge=y(ge,_e),ge.return=we,ge)}function $e(we,ge,_e){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=R0(""+ge,we.mode,_e),ge.return=we,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case te:return _e=Bc(ge.type,ge.key,ge.props,null,we.mode,_e),_e.ref=Bi(we,null,ge),_e.return=we,_e;case V:return ge=M0(ge,we.mode,_e),ge.return=we,ge;case pe:var Ye=ge._init;return $e(we,Ye(ge._payload),_e)}if(De(ge)||B(ge))return ge=qs(ge,we.mode,_e,null),ge.return=we,ge;mc(we,ge)}return null}function ze(we,ge,_e,Ye){var ot=ge!==null?ge.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number")return ot!==null?null:se(we,ge,""+_e,Ye);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case te:return _e.key===ot?fe(we,ge,_e,Ye):null;case V:return _e.key===ot?Ce(we,ge,_e,Ye):null;case pe:return ot=_e._init,ze(we,ge,ot(_e._payload),Ye)}if(De(_e)||B(_e))return ot!==null?null:Le(we,ge,_e,Ye,null);mc(we,_e)}return null}function Je(we,ge,_e,Ye,ot){if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number")return we=we.get(_e)||null,se(ge,we,""+Ye,ot);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case te:return we=we.get(Ye.key===null?_e:Ye.key)||null,fe(ge,we,Ye,ot);case V:return we=we.get(Ye.key===null?_e:Ye.key)||null,Ce(ge,we,Ye,ot);case pe:var ht=Ye._init;return Je(we,ge,_e,ht(Ye._payload),ot)}if(De(Ye)||B(Ye))return we=we.get(_e)||null,Le(ge,we,Ye,ot,null);mc(ge,Ye)}return null}function nt(we,ge,_e,Ye){for(var ot=null,ht=null,xt=ge,yt=ge=0,Or=null;xt!==null&&yt<_e.length;yt++){xt.index>yt?(Or=xt,xt=null):Or=xt.sibling;var It=ze(we,xt,_e[yt],Ye);if(It===null){xt===null&&(xt=Or);break}s&&xt&&It.alternate===null&&i(we,xt),ge=_(It,ge,yt),ht===null?ot=It:ht.sibling=It,ht=It,xt=Or}if(yt===_e.length)return d(we,xt),sr&&Hs(we,yt),ot;if(xt===null){for(;yt<_e.length;yt++)xt=$e(we,_e[yt],Ye),xt!==null&&(ge=_(xt,ge,yt),ht===null?ot=xt:ht.sibling=xt,ht=xt);return sr&&Hs(we,yt),ot}for(xt=x(we,xt);yt<_e.length;yt++)Or=Je(xt,we,yt,_e[yt],Ye),Or!==null&&(s&&Or.alternate!==null&&xt.delete(Or.key===null?yt:Or.key),ge=_(Or,ge,yt),ht===null?ot=Or:ht.sibling=Or,ht=Or);return s&&xt.forEach(function(ys){return i(we,ys)}),sr&&Hs(we,yt),ot}function st(we,ge,_e,Ye){var ot=B(_e);if(typeof ot!="function")throw Error(t(150));if(_e=ot.call(_e),_e==null)throw Error(t(151));for(var ht=ot=null,xt=ge,yt=ge=0,Or=null,It=_e.next();xt!==null&&!It.done;yt++,It=_e.next()){xt.index>yt?(Or=xt,xt=null):Or=xt.sibling;var ys=ze(we,xt,It.value,Ye);if(ys===null){xt===null&&(xt=Or);break}s&&xt&&ys.alternate===null&&i(we,xt),ge=_(ys,ge,yt),ht===null?ot=ys:ht.sibling=ys,ht=ys,xt=Or}if(It.done)return d(we,xt),sr&&Hs(we,yt),ot;if(xt===null){for(;!It.done;yt++,It=_e.next())It=$e(we,It.value,Ye),It!==null&&(ge=_(It,ge,yt),ht===null?ot=It:ht.sibling=It,ht=It);return sr&&Hs(we,yt),ot}for(xt=x(we,xt);!It.done;yt++,It=_e.next())It=Je(xt,we,yt,It.value,Ye),It!==null&&(s&&It.alternate!==null&&xt.delete(It.key===null?yt:It.key),ge=_(It,ge,yt),ht===null?ot=It:ht.sibling=It,ht=It);return s&&xt.forEach(function(a2){return i(we,a2)}),sr&&Hs(we,yt),ot}function vr(we,ge,_e,Ye){if(typeof _e=="object"&&_e!==null&&_e.type===D&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case te:e:{for(var ot=_e.key,ht=ge;ht!==null;){if(ht.key===ot){if(ot=_e.type,ot===D){if(ht.tag===7){d(we,ht.sibling),ge=y(ht,_e.props.children),ge.return=we,we=ge;break e}}else if(ht.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===pe&&$h(ot)===ht.type){d(we,ht.sibling),ge=y(ht,_e.props),ge.ref=Bi(we,ht,_e),ge.return=we,we=ge;break e}d(we,ht);break}else i(we,ht);ht=ht.sibling}_e.type===D?(ge=qs(_e.props.children,we.mode,Ye,_e.key),ge.return=we,we=ge):(Ye=Bc(_e.type,_e.key,_e.props,null,we.mode,Ye),Ye.ref=Bi(we,ge,_e),Ye.return=we,we=Ye)}return A(we);case V:e:{for(ht=_e.key;ge!==null;){if(ge.key===ht)if(ge.tag===4&&ge.stateNode.containerInfo===_e.containerInfo&&ge.stateNode.implementation===_e.implementation){d(we,ge.sibling),ge=y(ge,_e.children||[]),ge.return=we,we=ge;break e}else{d(we,ge);break}else i(we,ge);ge=ge.sibling}ge=M0(_e,we.mode,Ye),ge.return=we,we=ge}return A(we);case pe:return ht=_e._init,vr(we,ge,ht(_e._payload),Ye)}if(De(_e))return nt(we,ge,_e,Ye);if(B(_e))return st(we,ge,_e,Ye);mc(we,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,ge!==null&&ge.tag===6?(d(we,ge.sibling),ge=y(ge,_e),ge.return=we,we=ge):(d(we,ge),ge=R0(_e,we.mode,Ye),ge.return=we,we=ge),A(we)):d(we,ge)}return vr}var Lo=Yh(!0),Vh=Yh(!1),gc=ls(null),vc=null,Bo=null,Yd=null;function Vd(){Yd=Bo=vc=null}function Kd(s){var i=gc.current;ar(gc),s._currentValue=i}function Gd(s,i,d){for(;s!==null;){var x=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,x!==null&&(x.childLanes|=i)):x!==null&&(x.childLanes&i)!==i&&(x.childLanes|=i),s===d)break;s=s.return}}function Wo(s,i){vc=s,Yd=Bo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(xn=!0),s.firstContext=null)}function Fn(s){var i=s._currentValue;if(Yd!==s)if(s={context:s,memoizedValue:i,next:null},Bo===null){if(vc===null)throw Error(t(308));Bo=s,vc.dependencies={lanes:0,firstContext:s}}else Bo=Bo.next=s;return i}var $s=null;function Xd(s){$s===null?$s=[s]:$s.push(s)}function Kh(s,i,d,x){var y=i.interleaved;return y===null?(d.next=d,Xd(i)):(d.next=y.next,y.next=d),i.interleaved=d,Ia(s,x)}function Ia(s,i){s.lanes|=i;var d=s.alternate;for(d!==null&&(d.lanes|=i),d=s,s=s.return;s!==null;)s.childLanes|=i,d=s.alternate,d!==null&&(d.childLanes|=i),d=s,s=s.return;return d.tag===3?d.stateNode:null}var ds=!1;function Qd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function za(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function fs(s,i,d){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Pt&2)!==0){var y=x.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),x.pending=i,Ia(s,d)}return y=x.interleaved,y===null?(i.next=i,Xd(x)):(i.next=y.next,y.next=i),x.interleaved=i,Ia(s,d)}function yc(s,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194240)!==0)){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,ud(s,d)}}function Xh(s,i){var d=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,d===x)){var y=null,_=null;if(d=d.firstBaseUpdate,d!==null){do{var A={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};_===null?y=_=A:_=_.next=A,d=d.next}while(d!==null);_===null?y=_=i:_=_.next=i}else y=_=i;d={baseState:x.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:x.shared,effects:x.effects},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=i:s.next=i,d.lastBaseUpdate=i}function wc(s,i,d,x){var y=s.updateQueue;ds=!1;var _=y.firstBaseUpdate,A=y.lastBaseUpdate,se=y.shared.pending;if(se!==null){y.shared.pending=null;var fe=se,Ce=fe.next;fe.next=null,A===null?_=Ce:A.next=Ce,A=fe;var Le=s.alternate;Le!==null&&(Le=Le.updateQueue,se=Le.lastBaseUpdate,se!==A&&(se===null?Le.firstBaseUpdate=Ce:se.next=Ce,Le.lastBaseUpdate=fe))}if(_!==null){var $e=y.baseState;A=0,Le=Ce=fe=null,se=_;do{var ze=se.lane,Je=se.eventTime;if((x&ze)===ze){Le!==null&&(Le=Le.next={eventTime:Je,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var nt=s,st=se;switch(ze=i,Je=d,st.tag){case 1:if(nt=st.payload,typeof nt=="function"){$e=nt.call(Je,$e,ze);break e}$e=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=st.payload,ze=typeof nt=="function"?nt.call(Je,$e,ze):nt,ze==null)break e;$e=de({},$e,ze);break e;case 2:ds=!0}}se.callback!==null&&se.lane!==0&&(s.flags|=64,ze=y.effects,ze===null?y.effects=[se]:ze.push(se))}else Je={eventTime:Je,lane:ze,tag:se.tag,payload:se.payload,callback:se.callback,next:null},Le===null?(Ce=Le=Je,fe=$e):Le=Le.next=Je,A|=ze;if(se=se.next,se===null){if(se=y.shared.pending,se===null)break;ze=se,se=ze.next,ze.next=null,y.lastBaseUpdate=ze,y.shared.pending=null}}while(!0);if(Le===null&&(fe=$e),y.baseState=fe,y.firstBaseUpdate=Ce,y.lastBaseUpdate=Le,i=y.shared.interleaved,i!==null){y=i;do A|=y.lane,y=y.next;while(y!==i)}else _===null&&(y.shared.lanes=0);Ks|=A,s.lanes=A,s.memoizedState=$e}}function Qh(s,i,d){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var x=s[i],y=x.callback;if(y!==null){if(x.callback=null,x=d,typeof y!="function")throw Error(t(191,y));y.call(x)}}}var Wi={},da=ls(Wi),Ui=ls(Wi),Hi=ls(Wi);function Ys(s){if(s===Wi)throw Error(t(174));return s}function qd(s,i){switch(Jt(Hi,i),Jt(Ui,s),Jt(da,Wi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:qt(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=qt(i,s)}ar(da),Jt(da,i)}function Uo(){ar(da),ar(Ui),ar(Hi)}function qh(s){Ys(Hi.current);var i=Ys(da.current),d=qt(i,s.type);i!==d&&(Jt(Ui,s),Jt(da,d))}function Zd(s){Ui.current===s&&(ar(da),ar(Ui))}var lr=ls(0);function kc(s){for(var i=s;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Jd=[];function e0(){for(var s=0;s<Jd.length;s++)Jd[s]._workInProgressVersionPrimary=null;Jd.length=0}var bc=z.ReactCurrentDispatcher,t0=z.ReactCurrentBatchConfig,Vs=0,cr=null,Cr=null,Ar=null,_c=!1,$i=!1,Yi=0,Ck=0;function Yr(){throw Error(t(321))}function r0(s,i){if(i===null)return!1;for(var d=0;d<i.length&&d<s.length;d++)if(!Kn(s[d],i[d]))return!1;return!0}function n0(s,i,d,x,y,_){if(Vs=_,cr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,bc.current=s===null||s.memoizedState===null?Fk:jk,s=d(x,y),$i){_=0;do{if($i=!1,Yi=0,25<=_)throw Error(t(301));_+=1,Ar=Cr=null,i.updateQueue=null,bc.current=Ak,s=d(x,y)}while($i)}if(bc.current=Cc,i=Cr!==null&&Cr.next!==null,Vs=0,Ar=Cr=cr=null,_c=!1,i)throw Error(t(300));return s}function a0(){var s=Yi!==0;return Yi=0,s}function fa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?cr.memoizedState=Ar=s:Ar=Ar.next=s,Ar}function jn(){if(Cr===null){var s=cr.alternate;s=s!==null?s.memoizedState:null}else s=Cr.next;var i=Ar===null?cr.memoizedState:Ar.next;if(i!==null)Ar=i,Cr=s;else{if(s===null)throw Error(t(310));Cr=s,s={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},Ar===null?cr.memoizedState=Ar=s:Ar=Ar.next=s}return Ar}function Vi(s,i){return typeof i=="function"?i(s):i}function s0(s){var i=jn(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=Cr,y=x.baseQueue,_=d.pending;if(_!==null){if(y!==null){var A=y.next;y.next=_.next,_.next=A}x.baseQueue=y=_,d.pending=null}if(y!==null){_=y.next,x=x.baseState;var se=A=null,fe=null,Ce=_;do{var Le=Ce.lane;if((Vs&Le)===Le)fe!==null&&(fe=fe.next={lane:0,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null}),x=Ce.hasEagerState?Ce.eagerState:s(x,Ce.action);else{var $e={lane:Le,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null};fe===null?(se=fe=$e,A=x):fe=fe.next=$e,cr.lanes|=Le,Ks|=Le}Ce=Ce.next}while(Ce!==null&&Ce!==_);fe===null?A=x:fe.next=se,Kn(x,i.memoizedState)||(xn=!0),i.memoizedState=x,i.baseState=A,i.baseQueue=fe,d.lastRenderedState=x}if(s=d.interleaved,s!==null){y=s;do _=y.lane,cr.lanes|=_,Ks|=_,y=y.next;while(y!==s)}else y===null&&(d.lanes=0);return[i.memoizedState,d.dispatch]}function o0(s){var i=jn(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=d.dispatch,y=d.pending,_=i.memoizedState;if(y!==null){d.pending=null;var A=y=y.next;do _=s(_,A.action),A=A.next;while(A!==y);Kn(_,i.memoizedState)||(xn=!0),i.memoizedState=_,i.baseQueue===null&&(i.baseState=_),d.lastRenderedState=_}return[_,x]}function Zh(){}function Jh(s,i){var d=cr,x=jn(),y=i(),_=!Kn(x.memoizedState,y);if(_&&(x.memoizedState=y,xn=!0),x=x.queue,i0(rx.bind(null,d,x,s),[s]),x.getSnapshot!==i||_||Ar!==null&&Ar.memoizedState.tag&1){if(d.flags|=2048,Ki(9,tx.bind(null,d,x,y,i),void 0,null),Pr===null)throw Error(t(349));(Vs&30)!==0||ex(d,i,y)}return y}function ex(s,i,d){s.flags|=16384,s={getSnapshot:i,value:d},i=cr.updateQueue,i===null?(i={lastEffect:null,stores:null},cr.updateQueue=i,i.stores=[s]):(d=i.stores,d===null?i.stores=[s]:d.push(s))}function tx(s,i,d,x){i.value=d,i.getSnapshot=x,nx(i)&&ax(s)}function rx(s,i,d){return d(function(){nx(i)&&ax(s)})}function nx(s){var i=s.getSnapshot;s=s.value;try{var d=i();return!Kn(s,d)}catch{return!0}}function ax(s){var i=Ia(s,1);i!==null&&Zn(i,s,1,-1)}function sx(s){var i=fa();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:s},i.queue=s,s=s.dispatch=Dk.bind(null,cr,s),[i.memoizedState,s]}function Ki(s,i,d,x){return s={tag:s,create:i,destroy:d,deps:x,next:null},i=cr.updateQueue,i===null?(i={lastEffect:null,stores:null},cr.updateQueue=i,i.lastEffect=s.next=s):(d=i.lastEffect,d===null?i.lastEffect=s.next=s:(x=d.next,d.next=s,s.next=x,i.lastEffect=s)),s}function ox(){return jn().memoizedState}function Sc(s,i,d,x){var y=fa();cr.flags|=s,y.memoizedState=Ki(1|i,d,void 0,x===void 0?null:x)}function Ec(s,i,d,x){var y=jn();x=x===void 0?null:x;var _=void 0;if(Cr!==null){var A=Cr.memoizedState;if(_=A.destroy,x!==null&&r0(x,A.deps)){y.memoizedState=Ki(i,d,_,x);return}}cr.flags|=s,y.memoizedState=Ki(1|i,d,_,x)}function ix(s,i){return Sc(8390656,8,s,i)}function i0(s,i){return Ec(2048,8,s,i)}function lx(s,i){return Ec(4,2,s,i)}function cx(s,i){return Ec(4,4,s,i)}function ux(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function dx(s,i,d){return d=d!=null?d.concat([s]):null,Ec(4,4,ux.bind(null,i,s),d)}function l0(){}function fx(s,i){var d=jn();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&r0(i,x[1])?x[0]:(d.memoizedState=[s,i],s)}function px(s,i){var d=jn();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&r0(i,x[1])?x[0]:(s=s(),d.memoizedState=[s,i],s)}function hx(s,i,d){return(Vs&21)===0?(s.baseState&&(s.baseState=!1,xn=!0),s.memoizedState=d):(Kn(d,i)||(d=$p(),cr.lanes|=d,Ks|=d,s.baseState=!0),i)}function Tk(s,i){var d=Kt;Kt=d!==0&&4>d?d:4,s(!0);var x=t0.transition;t0.transition={};try{s(!1),i()}finally{Kt=d,t0.transition=x}}function xx(){return jn().memoizedState}function Nk(s,i,d){var x=ms(s);if(d={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null},mx(s))gx(i,d);else if(d=Kh(s,i,d,x),d!==null){var y=rn();Zn(d,s,x,y),vx(d,i,x)}}function Dk(s,i,d){var x=ms(s),y={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null};if(mx(s))gx(i,y);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=i.lastRenderedReducer,_!==null))try{var A=i.lastRenderedState,se=_(A,d);if(y.hasEagerState=!0,y.eagerState=se,Kn(se,A)){var fe=i.interleaved;fe===null?(y.next=y,Xd(i)):(y.next=fe.next,fe.next=y),i.interleaved=y;return}}catch{}finally{}d=Kh(s,i,y,x),d!==null&&(y=rn(),Zn(d,s,x,y),vx(d,i,x))}}function mx(s){var i=s.alternate;return s===cr||i!==null&&i===cr}function gx(s,i){$i=_c=!0;var d=s.pending;d===null?i.next=i:(i.next=d.next,d.next=i),s.pending=i}function vx(s,i,d){if((d&4194240)!==0){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,ud(s,d)}}var Cc={readContext:Fn,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},Fk={readContext:Fn,useCallback:function(s,i){return fa().memoizedState=[s,i===void 0?null:i],s},useContext:Fn,useEffect:ix,useImperativeHandle:function(s,i,d){return d=d!=null?d.concat([s]):null,Sc(4194308,4,ux.bind(null,i,s),d)},useLayoutEffect:function(s,i){return Sc(4194308,4,s,i)},useInsertionEffect:function(s,i){return Sc(4,2,s,i)},useMemo:function(s,i){var d=fa();return i=i===void 0?null:i,s=s(),d.memoizedState=[s,i],s},useReducer:function(s,i,d){var x=fa();return i=d!==void 0?d(i):i,x.memoizedState=x.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},x.queue=s,s=s.dispatch=Nk.bind(null,cr,s),[x.memoizedState,s]},useRef:function(s){var i=fa();return s={current:s},i.memoizedState=s},useState:sx,useDebugValue:l0,useDeferredValue:function(s){return fa().memoizedState=s},useTransition:function(){var s=sx(!1),i=s[0];return s=Tk.bind(null,s[1]),fa().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,d){var x=cr,y=fa();if(sr){if(d===void 0)throw Error(t(407));d=d()}else{if(d=i(),Pr===null)throw Error(t(349));(Vs&30)!==0||ex(x,i,d)}y.memoizedState=d;var _={value:d,getSnapshot:i};return y.queue=_,ix(rx.bind(null,x,_,s),[s]),x.flags|=2048,Ki(9,tx.bind(null,x,_,d,i),void 0,null),d},useId:function(){var s=fa(),i=Pr.identifierPrefix;if(sr){var d=Ma,x=Ra;d=(x&~(1<<32-gr(x)-1)).toString(32)+d,i=":"+i+"R"+d,d=Yi++,0<d&&(i+="H"+d.toString(32)),i+=":"}else d=Ck++,i=":"+i+"r"+d.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},jk={readContext:Fn,useCallback:fx,useContext:Fn,useEffect:i0,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:px,useReducer:s0,useRef:ox,useState:function(){return s0(Vi)},useDebugValue:l0,useDeferredValue:function(s){var i=jn();return hx(i,Cr.memoizedState,s)},useTransition:function(){var s=s0(Vi)[0],i=jn().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:xx,unstable_isNewReconciler:!1},Ak={readContext:Fn,useCallback:fx,useContext:Fn,useEffect:i0,useImperativeHandle:dx,useInsertionEffect:lx,useLayoutEffect:cx,useMemo:px,useReducer:o0,useRef:ox,useState:function(){return o0(Vi)},useDebugValue:l0,useDeferredValue:function(s){var i=jn();return Cr===null?i.memoizedState=s:hx(i,Cr.memoizedState,s)},useTransition:function(){var s=o0(Vi)[0],i=jn().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:xx,unstable_isNewReconciler:!1};function Xn(s,i){if(s&&s.defaultProps){i=de({},i),s=s.defaultProps;for(var d in s)i[d]===void 0&&(i[d]=s[d]);return i}return i}function c0(s,i,d,x){i=s.memoizedState,d=d(x,i),d=d==null?i:de({},i,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var Tc={isMounted:function(s){return(s=s._reactInternals)?ne(s)===s:!1},enqueueSetState:function(s,i,d){s=s._reactInternals;var x=rn(),y=ms(s),_=za(x,y);_.payload=i,d!=null&&(_.callback=d),i=fs(s,_,y),i!==null&&(Zn(i,s,y,x),yc(i,s,y))},enqueueReplaceState:function(s,i,d){s=s._reactInternals;var x=rn(),y=ms(s),_=za(x,y);_.tag=1,_.payload=i,d!=null&&(_.callback=d),i=fs(s,_,y),i!==null&&(Zn(i,s,y,x),yc(i,s,y))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var d=rn(),x=ms(s),y=za(d,x);y.tag=2,i!=null&&(y.callback=i),i=fs(s,y,x),i!==null&&(Zn(i,s,x,d),yc(i,s,x))}};function yx(s,i,d,x,y,_,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,_,A):i.prototype&&i.prototype.isPureReactComponent?!Pi(d,x)||!Pi(y,_):!0}function wx(s,i,d){var x=!1,y=cs,_=i.contextType;return typeof _=="object"&&_!==null?_=Fn(_):(y=hn(i)?Ws:$r.current,x=i.contextTypes,_=(x=x!=null)?Ro(s,y):cs),i=new i(d,_),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Tc,s.stateNode=i,i._reactInternals=s,x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=y,s.__reactInternalMemoizedMaskedChildContext=_),i}function kx(s,i,d,x){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,x),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,x),i.state!==s&&Tc.enqueueReplaceState(i,i.state,null)}function u0(s,i,d,x){var y=s.stateNode;y.props=d,y.state=s.memoizedState,y.refs={},Qd(s);var _=i.contextType;typeof _=="object"&&_!==null?y.context=Fn(_):(_=hn(i)?Ws:$r.current,y.context=Ro(s,_)),y.state=s.memoizedState,_=i.getDerivedStateFromProps,typeof _=="function"&&(c0(s,i,_,d),y.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Tc.enqueueReplaceState(y,y.state,null),wc(s,d,y,x),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308)}function Ho(s,i){try{var d="",x=i;do d+=F(x),x=x.return;while(x);var y=d}catch(_){y=`
Error generating stack: `+_.message+`
`+_.stack}return{value:s,source:i,stack:y,digest:null}}function d0(s,i,d){return{value:s,source:null,stack:d??null,digest:i??null}}function f0(s,i){try{console.error(i.value)}catch(d){setTimeout(function(){throw d})}}var Pk=typeof WeakMap=="function"?WeakMap:Map;function bx(s,i,d){d=za(-1,d),d.tag=3,d.payload={element:null};var x=i.value;return d.callback=function(){Oc||(Oc=!0,T0=x),f0(s,i)},d}function _x(s,i,d){d=za(-1,d),d.tag=3;var x=s.type.getDerivedStateFromError;if(typeof x=="function"){var y=i.value;d.payload=function(){return x(y)},d.callback=function(){f0(s,i)}}var _=s.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(d.callback=function(){f0(s,i),typeof x!="function"&&(hs===null?hs=new Set([this]):hs.add(this));var A=i.stack;this.componentDidCatch(i.value,{componentStack:A!==null?A:""})}),d}function Sx(s,i,d){var x=s.pingCache;if(x===null){x=s.pingCache=new Pk;var y=new Set;x.set(i,y)}else y=x.get(i),y===void 0&&(y=new Set,x.set(i,y));y.has(d)||(y.add(d),s=Kk.bind(null,s,i,d),i.then(s,s))}function Ex(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Cx(s,i,d,x,y){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(i=za(-1,1),i.tag=2,fs(d,i,1))),d.lanes|=1),s):(s.flags|=65536,s.lanes=y,s)}var Ok=z.ReactCurrentOwner,xn=!1;function tn(s,i,d,x){i.child=s===null?Vh(i,null,d,x):Lo(i,s.child,d,x)}function Tx(s,i,d,x,y){d=d.render;var _=i.ref;return Wo(i,y),x=n0(s,i,d,x,_,y),d=a0(),s!==null&&!xn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,La(s,i,y)):(sr&&d&&Bd(i),i.flags|=1,tn(s,i,x,y),i.child)}function Nx(s,i,d,x,y){if(s===null){var _=d.type;return typeof _=="function"&&!O0(_)&&_.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(i.tag=15,i.type=_,Dx(s,i,_,x,y)):(s=Bc(d.type,null,x,i,i.mode,y),s.ref=i.ref,s.return=i,i.child=s)}if(_=s.child,(s.lanes&y)===0){var A=_.memoizedProps;if(d=d.compare,d=d!==null?d:Pi,d(A,x)&&s.ref===i.ref)return La(s,i,y)}return i.flags|=1,s=vs(_,x),s.ref=i.ref,s.return=i,i.child=s}function Dx(s,i,d,x,y){if(s!==null){var _=s.memoizedProps;if(Pi(_,x)&&s.ref===i.ref)if(xn=!1,i.pendingProps=x=_,(s.lanes&y)!==0)(s.flags&131072)!==0&&(xn=!0);else return i.lanes=s.lanes,La(s,i,y)}return p0(s,i,d,x,y)}function Fx(s,i,d){var x=i.pendingProps,y=x.children,_=s!==null?s.memoizedState:null;if(x.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(Yo,_n),_n|=d;else{if((d&1073741824)===0)return s=_!==null?_.baseLanes|d:d,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Jt(Yo,_n),_n|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=_!==null?_.baseLanes:d,Jt(Yo,_n),_n|=x}else _!==null?(x=_.baseLanes|d,i.memoizedState=null):x=d,Jt(Yo,_n),_n|=x;return tn(s,i,y,d),i.child}function jx(s,i){var d=i.ref;(s===null&&d!==null||s!==null&&s.ref!==d)&&(i.flags|=512,i.flags|=2097152)}function p0(s,i,d,x,y){var _=hn(d)?Ws:$r.current;return _=Ro(i,_),Wo(i,y),d=n0(s,i,d,x,_,y),x=a0(),s!==null&&!xn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,La(s,i,y)):(sr&&x&&Bd(i),i.flags|=1,tn(s,i,d,y),i.child)}function Ax(s,i,d,x,y){if(hn(d)){var _=!0;dc(i)}else _=!1;if(Wo(i,y),i.stateNode===null)Dc(s,i),wx(i,d,x),u0(i,d,x,y),x=!0;else if(s===null){var A=i.stateNode,se=i.memoizedProps;A.props=se;var fe=A.context,Ce=d.contextType;typeof Ce=="object"&&Ce!==null?Ce=Fn(Ce):(Ce=hn(d)?Ws:$r.current,Ce=Ro(i,Ce));var Le=d.getDerivedStateFromProps,$e=typeof Le=="function"||typeof A.getSnapshotBeforeUpdate=="function";$e||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(se!==x||fe!==Ce)&&kx(i,A,x,Ce),ds=!1;var ze=i.memoizedState;A.state=ze,wc(i,x,A,y),fe=i.memoizedState,se!==x||ze!==fe||pn.current||ds?(typeof Le=="function"&&(c0(i,d,Le,x),fe=i.memoizedState),(se=ds||yx(i,d,se,x,ze,fe,Ce))?($e||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(i.flags|=4194308)):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=x,i.memoizedState=fe),A.props=x,A.state=fe,A.context=Ce,x=se):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),x=!1)}else{A=i.stateNode,Gh(s,i),se=i.memoizedProps,Ce=i.type===i.elementType?se:Xn(i.type,se),A.props=Ce,$e=i.pendingProps,ze=A.context,fe=d.contextType,typeof fe=="object"&&fe!==null?fe=Fn(fe):(fe=hn(d)?Ws:$r.current,fe=Ro(i,fe));var Je=d.getDerivedStateFromProps;(Le=typeof Je=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(se!==$e||ze!==fe)&&kx(i,A,x,fe),ds=!1,ze=i.memoizedState,A.state=ze,wc(i,x,A,y);var nt=i.memoizedState;se!==$e||ze!==nt||pn.current||ds?(typeof Je=="function"&&(c0(i,d,Je,x),nt=i.memoizedState),(Ce=ds||yx(i,d,Ce,x,ze,nt,fe)||!1)?(Le||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(x,nt,fe),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(x,nt,fe)),typeof A.componentDidUpdate=="function"&&(i.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof A.componentDidUpdate!="function"||se===s.memoizedProps&&ze===s.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||se===s.memoizedProps&&ze===s.memoizedState||(i.flags|=1024),i.memoizedProps=x,i.memoizedState=nt),A.props=x,A.state=nt,A.context=fe,x=Ce):(typeof A.componentDidUpdate!="function"||se===s.memoizedProps&&ze===s.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||se===s.memoizedProps&&ze===s.memoizedState||(i.flags|=1024),x=!1)}return h0(s,i,d,x,_,y)}function h0(s,i,d,x,y,_){jx(s,i);var A=(i.flags&128)!==0;if(!x&&!A)return y&&Ih(i,d,!1),La(s,i,_);x=i.stateNode,Ok.current=i;var se=A&&typeof d.getDerivedStateFromError!="function"?null:x.render();return i.flags|=1,s!==null&&A?(i.child=Lo(i,s.child,null,_),i.child=Lo(i,null,se,_)):tn(s,i,se,_),i.memoizedState=x.state,y&&Ih(i,d,!0),i.child}function Px(s){var i=s.stateNode;i.pendingContext?Rh(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Rh(s,i.context,!1),qd(s,i.containerInfo)}function Ox(s,i,d,x,y){return zo(),$d(y),i.flags|=256,tn(s,i,d,x),i.child}var x0={dehydrated:null,treeContext:null,retryLane:0};function m0(s){return{baseLanes:s,cachePool:null,transitions:null}}function Rx(s,i,d){var x=i.pendingProps,y=lr.current,_=!1,A=(i.flags&128)!==0,se;if((se=A)||(se=s!==null&&s.memoizedState===null?!1:(y&2)!==0),se?(_=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(y|=1),Jt(lr,y&1),s===null)return Hd(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(A=x.children,s=x.fallback,_?(x=i.mode,_=i.child,A={mode:"hidden",children:A},(x&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=A):_=Wc(A,x,0,null),s=qs(s,x,d,null),_.return=i,s.return=i,_.sibling=s,i.child=_,i.child.memoizedState=m0(d),i.memoizedState=x0,s):g0(i,A));if(y=s.memoizedState,y!==null&&(se=y.dehydrated,se!==null))return Rk(s,i,A,x,se,y,d);if(_){_=x.fallback,A=i.mode,y=s.child,se=y.sibling;var fe={mode:"hidden",children:x.children};return(A&1)===0&&i.child!==y?(x=i.child,x.childLanes=0,x.pendingProps=fe,i.deletions=null):(x=vs(y,fe),x.subtreeFlags=y.subtreeFlags&14680064),se!==null?_=vs(se,_):(_=qs(_,A,d,null),_.flags|=2),_.return=i,x.return=i,x.sibling=_,i.child=x,x=_,_=i.child,A=s.child.memoizedState,A=A===null?m0(d):{baseLanes:A.baseLanes|d,cachePool:null,transitions:A.transitions},_.memoizedState=A,_.childLanes=s.childLanes&~d,i.memoizedState=x0,x}return _=s.child,s=_.sibling,x=vs(_,{mode:"visible",children:x.children}),(i.mode&1)===0&&(x.lanes=d),x.return=i,x.sibling=null,s!==null&&(d=i.deletions,d===null?(i.deletions=[s],i.flags|=16):d.push(s)),i.child=x,i.memoizedState=null,x}function g0(s,i){return i=Wc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Nc(s,i,d,x){return x!==null&&$d(x),Lo(i,s.child,null,d),s=g0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Rk(s,i,d,x,y,_,A){if(d)return i.flags&256?(i.flags&=-257,x=d0(Error(t(422))),Nc(s,i,A,x)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(_=x.fallback,y=i.mode,x=Wc({mode:"visible",children:x.children},y,0,null),_=qs(_,y,A,null),_.flags|=2,x.return=i,_.return=i,x.sibling=_,i.child=x,(i.mode&1)!==0&&Lo(i,s.child,null,A),i.child.memoizedState=m0(A),i.memoizedState=x0,_);if((i.mode&1)===0)return Nc(s,i,A,null);if(y.data==="$!"){if(x=y.nextSibling&&y.nextSibling.dataset,x)var se=x.dgst;return x=se,_=Error(t(419)),x=d0(_,x,void 0),Nc(s,i,A,x)}if(se=(A&s.childLanes)!==0,xn||se){if(x=Pr,x!==null){switch(A&-A){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(x.suspendedLanes|A))!==0?0:y,y!==0&&y!==_.retryLane&&(_.retryLane=y,Ia(s,y),Zn(x,s,y,-1))}return P0(),x=d0(Error(t(421))),Nc(s,i,A,x)}return y.data==="$?"?(i.flags|=128,i.child=s.child,i=Gk.bind(null,s),y._reactRetry=i,null):(s=_.treeContext,bn=is(y.nextSibling),kn=i,sr=!0,Gn=null,s!==null&&(Nn[Dn++]=Ra,Nn[Dn++]=Ma,Nn[Dn++]=Us,Ra=s.id,Ma=s.overflow,Us=i),i=g0(i,x.children),i.flags|=4096,i)}function Mx(s,i,d){s.lanes|=i;var x=s.alternate;x!==null&&(x.lanes|=i),Gd(s.return,i,d)}function v0(s,i,d,x,y){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:x,tail:d,tailMode:y}:(_.isBackwards=i,_.rendering=null,_.renderingStartTime=0,_.last=x,_.tail=d,_.tailMode=y)}function Ix(s,i,d){var x=i.pendingProps,y=x.revealOrder,_=x.tail;if(tn(s,i,x.children,d),x=lr.current,(x&2)!==0)x=x&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Mx(s,d,i);else if(s.tag===19)Mx(s,d,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}if(Jt(lr,x),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(d=i.child,y=null;d!==null;)s=d.alternate,s!==null&&kc(s)===null&&(y=d),d=d.sibling;d=y,d===null?(y=i.child,i.child=null):(y=d.sibling,d.sibling=null),v0(i,!1,y,d,_);break;case"backwards":for(d=null,y=i.child,i.child=null;y!==null;){if(s=y.alternate,s!==null&&kc(s)===null){i.child=y;break}s=y.sibling,y.sibling=d,d=y,y=s}v0(i,!0,d,null,_);break;case"together":v0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Dc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function La(s,i,d){if(s!==null&&(i.dependencies=s.dependencies),Ks|=i.lanes,(d&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,d=vs(s,s.pendingProps),i.child=d,d.return=i;s.sibling!==null;)s=s.sibling,d=d.sibling=vs(s,s.pendingProps),d.return=i;d.sibling=null}return i.child}function Mk(s,i,d){switch(i.tag){case 3:Px(i),zo();break;case 5:qh(i);break;case 1:hn(i.type)&&dc(i);break;case 4:qd(i,i.stateNode.containerInfo);break;case 10:var x=i.type._context,y=i.memoizedProps.value;Jt(gc,x._currentValue),x._currentValue=y;break;case 13:if(x=i.memoizedState,x!==null)return x.dehydrated!==null?(Jt(lr,lr.current&1),i.flags|=128,null):(d&i.child.childLanes)!==0?Rx(s,i,d):(Jt(lr,lr.current&1),s=La(s,i,d),s!==null?s.sibling:null);Jt(lr,lr.current&1);break;case 19:if(x=(d&i.childLanes)!==0,(s.flags&128)!==0){if(x)return Ix(s,i,d);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Jt(lr,lr.current),x)break;return null;case 22:case 23:return i.lanes=0,Fx(s,i,d)}return La(s,i,d)}var zx,y0,Lx,Bx;zx=function(s,i){for(var d=i.child;d!==null;){if(d.tag===5||d.tag===6)s.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break;for(;d.sibling===null;){if(d.return===null||d.return===i)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},y0=function(){},Lx=function(s,i,d,x){var y=s.memoizedProps;if(y!==x){s=i.stateNode,Ys(da.current);var _=null;switch(d){case"input":y=ye(s,y),x=ye(s,x),_=[];break;case"select":y=de({},y,{value:void 0}),x=de({},x,{value:void 0}),_=[];break;case"textarea":y=ft(s,y),x=ft(s,x),_=[];break;default:typeof y.onClick!="function"&&typeof x.onClick=="function"&&(s.onclick=lc)}he(d,x);var A;d=null;for(Ce in y)if(!x.hasOwnProperty(Ce)&&y.hasOwnProperty(Ce)&&y[Ce]!=null)if(Ce==="style"){var se=y[Ce];for(A in se)se.hasOwnProperty(A)&&(d||(d={}),d[A]="")}else Ce!=="dangerouslySetInnerHTML"&&Ce!=="children"&&Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&Ce!=="autoFocus"&&(a.hasOwnProperty(Ce)?_||(_=[]):(_=_||[]).push(Ce,null));for(Ce in x){var fe=x[Ce];if(se=y?.[Ce],x.hasOwnProperty(Ce)&&fe!==se&&(fe!=null||se!=null))if(Ce==="style")if(se){for(A in se)!se.hasOwnProperty(A)||fe&&fe.hasOwnProperty(A)||(d||(d={}),d[A]="");for(A in fe)fe.hasOwnProperty(A)&&se[A]!==fe[A]&&(d||(d={}),d[A]=fe[A])}else d||(_||(_=[]),_.push(Ce,d)),d=fe;else Ce==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,se=se?se.__html:void 0,fe!=null&&se!==fe&&(_=_||[]).push(Ce,fe)):Ce==="children"?typeof fe!="string"&&typeof fe!="number"||(_=_||[]).push(Ce,""+fe):Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ce)?(fe!=null&&Ce==="onScroll"&&nr("scroll",s),_||se===fe||(_=[])):(_=_||[]).push(Ce,fe))}d&&(_=_||[]).push("style",d);var Ce=_;(i.updateQueue=Ce)&&(i.flags|=4)}},Bx=function(s,i,d,x){d!==x&&(i.flags|=4)};function Gi(s,i){if(!sr)switch(s.tailMode){case"hidden":i=s.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Vr(s){var i=s.alternate!==null&&s.alternate.child===s.child,d=0,x=0;if(i)for(var y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags&14680064,x|=y.flags&14680064,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags,x|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=x,s.childLanes=d,i}function Ik(s,i,d){var x=i.pendingProps;switch(Wd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(i),null;case 1:return hn(i.type)&&uc(),Vr(i),null;case 3:return x=i.stateNode,Uo(),ar(pn),ar($r),e0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(s===null||s.child===null)&&(xc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Gn!==null&&(F0(Gn),Gn=null))),y0(s,i),Vr(i),null;case 5:Zd(i);var y=Ys(Hi.current);if(d=i.type,s!==null&&i.stateNode!=null)Lx(s,i,d,x,y),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!x){if(i.stateNode===null)throw Error(t(166));return Vr(i),null}if(s=Ys(da.current),xc(i)){x=i.stateNode,d=i.type;var _=i.memoizedProps;switch(x[ua]=i,x[zi]=_,s=(i.mode&1)!==0,d){case"dialog":nr("cancel",x),nr("close",x);break;case"iframe":case"object":case"embed":nr("load",x);break;case"video":case"audio":for(y=0;y<Ri.length;y++)nr(Ri[y],x);break;case"source":nr("error",x);break;case"img":case"image":case"link":nr("error",x),nr("load",x);break;case"details":nr("toggle",x);break;case"input":Me(x,_),nr("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!_.multiple},nr("invalid",x);break;case"textarea":gt(x,_),nr("invalid",x)}he(d,_),y=null;for(var A in _)if(_.hasOwnProperty(A)){var se=_[A];A==="children"?typeof se=="string"?x.textContent!==se&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,se,s),y=["children",se]):typeof se=="number"&&x.textContent!==""+se&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,se,s),y=["children",""+se]):a.hasOwnProperty(A)&&se!=null&&A==="onScroll"&&nr("scroll",x)}switch(d){case"input":xe(x),Fe(x,_,!0);break;case"textarea":xe(x),zt(x);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(x.onclick=lc)}x=y,i.updateQueue=x,x!==null&&(i.flags|=4)}else{A=y.nodeType===9?y:y.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Qt(d)),s==="http://www.w3.org/1999/xhtml"?d==="script"?(s=A.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof x.is=="string"?s=A.createElement(d,{is:x.is}):(s=A.createElement(d),d==="select"&&(A=s,x.multiple?A.multiple=!0:x.size&&(A.size=x.size))):s=A.createElementNS(s,d),s[ua]=i,s[zi]=x,zx(s,i,!1,!1),i.stateNode=s;e:{switch(A=Oe(d,x),d){case"dialog":nr("cancel",s),nr("close",s),y=x;break;case"iframe":case"object":case"embed":nr("load",s),y=x;break;case"video":case"audio":for(y=0;y<Ri.length;y++)nr(Ri[y],s);y=x;break;case"source":nr("error",s),y=x;break;case"img":case"image":case"link":nr("error",s),nr("load",s),y=x;break;case"details":nr("toggle",s),y=x;break;case"input":Me(s,x),y=ye(s,x),nr("invalid",s);break;case"option":y=x;break;case"select":s._wrapperState={wasMultiple:!!x.multiple},y=de({},x,{value:void 0}),nr("invalid",s);break;case"textarea":gt(s,x),y=ft(s,x),nr("invalid",s);break;default:y=x}he(d,y),se=y;for(_ in se)if(se.hasOwnProperty(_)){var fe=se[_];_==="style"?Zt(s,fe):_==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,fe!=null&&rr(s,fe)):_==="children"?typeof fe=="string"?(d!=="textarea"||fe!=="")&&ut(s,fe):typeof fe=="number"&&ut(s,""+fe):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(a.hasOwnProperty(_)?fe!=null&&_==="onScroll"&&nr("scroll",s):fe!=null&&S(s,_,fe,A))}switch(d){case"input":xe(s),Fe(s,x,!1);break;case"textarea":xe(s),zt(s);break;case"option":x.value!=null&&s.setAttribute("value",""+J(x.value));break;case"select":s.multiple=!!x.multiple,_=x.value,_!=null?lt(s,!!x.multiple,_,!1):x.defaultValue!=null&&lt(s,!!x.multiple,x.defaultValue,!0);break;default:typeof y.onClick=="function"&&(s.onclick=lc)}switch(d){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Vr(i),null;case 6:if(s&&i.stateNode!=null)Bx(s,i,s.memoizedProps,x);else{if(typeof x!="string"&&i.stateNode===null)throw Error(t(166));if(d=Ys(Hi.current),Ys(da.current),xc(i)){if(x=i.stateNode,d=i.memoizedProps,x[ua]=i,(_=x.nodeValue!==d)&&(s=kn,s!==null))switch(s.tag){case 3:ic(x.nodeValue,d,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ic(x.nodeValue,d,(s.mode&1)!==0)}_&&(i.flags|=4)}else x=(d.nodeType===9?d:d.ownerDocument).createTextNode(x),x[ua]=i,i.stateNode=x}return Vr(i),null;case 13:if(ar(lr),x=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(sr&&bn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Hh(),zo(),i.flags|=98560,_=!1;else if(_=xc(i),x!==null&&x.dehydrated!==null){if(s===null){if(!_)throw Error(t(318));if(_=i.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[ua]=i}else zo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Vr(i),_=!1}else Gn!==null&&(F0(Gn),Gn=null),_=!0;if(!_)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=d,i):(x=x!==null,x!==(s!==null&&s.memoizedState!==null)&&x&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(lr.current&1)!==0?Tr===0&&(Tr=3):P0())),i.updateQueue!==null&&(i.flags|=4),Vr(i),null);case 4:return Uo(),y0(s,i),s===null&&Mi(i.stateNode.containerInfo),Vr(i),null;case 10:return Kd(i.type._context),Vr(i),null;case 17:return hn(i.type)&&uc(),Vr(i),null;case 19:if(ar(lr),_=i.memoizedState,_===null)return Vr(i),null;if(x=(i.flags&128)!==0,A=_.rendering,A===null)if(x)Gi(_,!1);else{if(Tr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(A=kc(s),A!==null){for(i.flags|=128,Gi(_,!1),x=A.updateQueue,x!==null&&(i.updateQueue=x,i.flags|=4),i.subtreeFlags=0,x=d,d=i.child;d!==null;)_=d,s=x,_.flags&=14680066,A=_.alternate,A===null?(_.childLanes=0,_.lanes=s,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=A.childLanes,_.lanes=A.lanes,_.child=A.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=A.memoizedProps,_.memoizedState=A.memoizedState,_.updateQueue=A.updateQueue,_.type=A.type,s=A.dependencies,_.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),d=d.sibling;return Jt(lr,lr.current&1|2),i.child}s=s.sibling}_.tail!==null&&He()>Vo&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304)}else{if(!x)if(s=kc(A),s!==null){if(i.flags|=128,x=!0,d=s.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),Gi(_,!0),_.tail===null&&_.tailMode==="hidden"&&!A.alternate&&!sr)return Vr(i),null}else 2*He()-_.renderingStartTime>Vo&&d!==1073741824&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304);_.isBackwards?(A.sibling=i.child,i.child=A):(d=_.last,d!==null?d.sibling=A:i.child=A,_.last=A)}return _.tail!==null?(i=_.tail,_.rendering=i,_.tail=i.sibling,_.renderingStartTime=He(),i.sibling=null,d=lr.current,Jt(lr,x?d&1|2:d&1),i):(Vr(i),null);case 22:case 23:return A0(),x=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==x&&(i.flags|=8192),x&&(i.mode&1)!==0?(_n&1073741824)!==0&&(Vr(i),i.subtreeFlags&6&&(i.flags|=8192)):Vr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function zk(s,i){switch(Wd(i),i.tag){case 1:return hn(i.type)&&uc(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Uo(),ar(pn),ar($r),e0(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Zd(i),null;case 13:if(ar(lr),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));zo()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return ar(lr),null;case 4:return Uo(),null;case 10:return Kd(i.type._context),null;case 22:case 23:return A0(),null;case 24:return null;default:return null}}var Fc=!1,Kr=!1,Lk=typeof WeakSet=="function"?WeakSet:Set,rt=null;function $o(s,i){var d=s.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(x){fr(s,i,x)}else d.current=null}function w0(s,i,d){try{d()}catch(x){fr(s,i,x)}}var Wx=!1;function Bk(s,i){if(Ad=Ql,s=yh(),Sd(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var x=d.getSelection&&d.getSelection();if(x&&x.rangeCount!==0){d=x.anchorNode;var y=x.anchorOffset,_=x.focusNode;x=x.focusOffset;try{d.nodeType,_.nodeType}catch{d=null;break e}var A=0,se=-1,fe=-1,Ce=0,Le=0,$e=s,ze=null;t:for(;;){for(var Je;$e!==d||y!==0&&$e.nodeType!==3||(se=A+y),$e!==_||x!==0&&$e.nodeType!==3||(fe=A+x),$e.nodeType===3&&(A+=$e.nodeValue.length),(Je=$e.firstChild)!==null;)ze=$e,$e=Je;for(;;){if($e===s)break t;if(ze===d&&++Ce===y&&(se=A),ze===_&&++Le===x&&(fe=A),(Je=$e.nextSibling)!==null)break;$e=ze,ze=$e.parentNode}$e=Je}d=se===-1||fe===-1?null:{start:se,end:fe}}else d=null}d=d||{start:0,end:0}}else d=null;for(Pd={focusedElem:s,selectionRange:d},Ql=!1,rt=i;rt!==null;)if(i=rt,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,rt=s;else for(;rt!==null;){i=rt;try{var nt=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(nt!==null){var st=nt.memoizedProps,vr=nt.memoizedState,we=i.stateNode,ge=we.getSnapshotBeforeUpdate(i.elementType===i.type?st:Xn(i.type,st),vr);we.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var _e=i.stateNode.containerInfo;_e.nodeType===1?_e.textContent="":_e.nodeType===9&&_e.documentElement&&_e.removeChild(_e.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ye){fr(i,i.return,Ye)}if(s=i.sibling,s!==null){s.return=i.return,rt=s;break}rt=i.return}return nt=Wx,Wx=!1,nt}function Xi(s,i,d){var x=i.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var y=x=x.next;do{if((y.tag&s)===s){var _=y.destroy;y.destroy=void 0,_!==void 0&&w0(i,d,_)}y=y.next}while(y!==x)}}function jc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var d=i=i.next;do{if((d.tag&s)===s){var x=d.create;d.destroy=x()}d=d.next}while(d!==i)}}function k0(s){var i=s.ref;if(i!==null){var d=s.stateNode;switch(s.tag){case 5:s=d;break;default:s=d}typeof i=="function"?i(s):i.current=s}}function Ux(s){var i=s.alternate;i!==null&&(s.alternate=null,Ux(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[ua],delete i[zi],delete i[Id],delete i[bk],delete i[_k])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Hx(s){return s.tag===5||s.tag===3||s.tag===4}function $x(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Hx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function b0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.nodeType===8?d.parentNode.insertBefore(s,i):d.insertBefore(s,i):(d.nodeType===8?(i=d.parentNode,i.insertBefore(s,d)):(i=d,i.appendChild(s)),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=lc));else if(x!==4&&(s=s.child,s!==null))for(b0(s,i,d),s=s.sibling;s!==null;)b0(s,i,d),s=s.sibling}function _0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.insertBefore(s,i):d.appendChild(s);else if(x!==4&&(s=s.child,s!==null))for(_0(s,i,d),s=s.sibling;s!==null;)_0(s,i,d),s=s.sibling}var zr=null,Qn=!1;function ps(s,i,d){for(d=d.child;d!==null;)Yx(s,i,d),d=d.sibling}function Yx(s,i,d){if(jr&&typeof jr.onCommitFiberUnmount=="function")try{jr.onCommitFiberUnmount(ca,d)}catch{}switch(d.tag){case 5:Kr||$o(d,i);case 6:var x=zr,y=Qn;zr=null,ps(s,i,d),zr=x,Qn=y,zr!==null&&(Qn?(s=zr,d=d.stateNode,s.nodeType===8?s.parentNode.removeChild(d):s.removeChild(d)):zr.removeChild(d.stateNode));break;case 18:zr!==null&&(Qn?(s=zr,d=d.stateNode,s.nodeType===8?Md(s.parentNode,d):s.nodeType===1&&Md(s,d),Ti(s)):Md(zr,d.stateNode));break;case 4:x=zr,y=Qn,zr=d.stateNode.containerInfo,Qn=!0,ps(s,i,d),zr=x,Qn=y;break;case 0:case 11:case 14:case 15:if(!Kr&&(x=d.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){y=x=x.next;do{var _=y,A=_.destroy;_=_.tag,A!==void 0&&((_&2)!==0||(_&4)!==0)&&w0(d,i,A),y=y.next}while(y!==x)}ps(s,i,d);break;case 1:if(!Kr&&($o(d,i),x=d.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=d.memoizedProps,x.state=d.memoizedState,x.componentWillUnmount()}catch(se){fr(d,i,se)}ps(s,i,d);break;case 21:ps(s,i,d);break;case 22:d.mode&1?(Kr=(x=Kr)||d.memoizedState!==null,ps(s,i,d),Kr=x):ps(s,i,d);break;default:ps(s,i,d)}}function Vx(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var d=s.stateNode;d===null&&(d=s.stateNode=new Lk),i.forEach(function(x){var y=Xk.bind(null,s,x);d.has(x)||(d.add(x),x.then(y,y))})}}function qn(s,i){var d=i.deletions;if(d!==null)for(var x=0;x<d.length;x++){var y=d[x];try{var _=s,A=i,se=A;e:for(;se!==null;){switch(se.tag){case 5:zr=se.stateNode,Qn=!1;break e;case 3:zr=se.stateNode.containerInfo,Qn=!0;break e;case 4:zr=se.stateNode.containerInfo,Qn=!0;break e}se=se.return}if(zr===null)throw Error(t(160));Yx(_,A,y),zr=null,Qn=!1;var fe=y.alternate;fe!==null&&(fe.return=null),y.return=null}catch(Ce){fr(y,i,Ce)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Kx(i,s),i=i.sibling}function Kx(s,i){var d=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(qn(i,s),pa(s),x&4){try{Xi(3,s,s.return),jc(3,s)}catch(st){fr(s,s.return,st)}try{Xi(5,s,s.return)}catch(st){fr(s,s.return,st)}}break;case 1:qn(i,s),pa(s),x&512&&d!==null&&$o(d,d.return);break;case 5:if(qn(i,s),pa(s),x&512&&d!==null&&$o(d,d.return),s.flags&32){var y=s.stateNode;try{ut(y,"")}catch(st){fr(s,s.return,st)}}if(x&4&&(y=s.stateNode,y!=null)){var _=s.memoizedProps,A=d!==null?d.memoizedProps:_,se=s.type,fe=s.updateQueue;if(s.updateQueue=null,fe!==null)try{se==="input"&&_.type==="radio"&&_.name!=null&&Pe(y,_),Oe(se,A);var Ce=Oe(se,_);for(A=0;A<fe.length;A+=2){var Le=fe[A],$e=fe[A+1];Le==="style"?Zt(y,$e):Le==="dangerouslySetInnerHTML"?rr(y,$e):Le==="children"?ut(y,$e):S(y,Le,$e,Ce)}switch(se){case"input":ce(y,_);break;case"textarea":Nt(y,_);break;case"select":var ze=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!_.multiple;var Je=_.value;Je!=null?lt(y,!!_.multiple,Je,!1):ze!==!!_.multiple&&(_.defaultValue!=null?lt(y,!!_.multiple,_.defaultValue,!0):lt(y,!!_.multiple,_.multiple?[]:"",!1))}y[zi]=_}catch(st){fr(s,s.return,st)}}break;case 6:if(qn(i,s),pa(s),x&4){if(s.stateNode===null)throw Error(t(162));y=s.stateNode,_=s.memoizedProps;try{y.nodeValue=_}catch(st){fr(s,s.return,st)}}break;case 3:if(qn(i,s),pa(s),x&4&&d!==null&&d.memoizedState.isDehydrated)try{Ti(i.containerInfo)}catch(st){fr(s,s.return,st)}break;case 4:qn(i,s),pa(s);break;case 13:qn(i,s),pa(s),y=s.child,y.flags&8192&&(_=y.memoizedState!==null,y.stateNode.isHidden=_,!_||y.alternate!==null&&y.alternate.memoizedState!==null||(C0=He())),x&4&&Vx(s);break;case 22:if(Le=d!==null&&d.memoizedState!==null,s.mode&1?(Kr=(Ce=Kr)||Le,qn(i,s),Kr=Ce):qn(i,s),pa(s),x&8192){if(Ce=s.memoizedState!==null,(s.stateNode.isHidden=Ce)&&!Le&&(s.mode&1)!==0)for(rt=s,Le=s.child;Le!==null;){for($e=rt=Le;rt!==null;){switch(ze=rt,Je=ze.child,ze.tag){case 0:case 11:case 14:case 15:Xi(4,ze,ze.return);break;case 1:$o(ze,ze.return);var nt=ze.stateNode;if(typeof nt.componentWillUnmount=="function"){x=ze,d=ze.return;try{i=x,nt.props=i.memoizedProps,nt.state=i.memoizedState,nt.componentWillUnmount()}catch(st){fr(x,d,st)}}break;case 5:$o(ze,ze.return);break;case 22:if(ze.memoizedState!==null){Qx($e);continue}}Je!==null?(Je.return=ze,rt=Je):Qx($e)}Le=Le.sibling}e:for(Le=null,$e=s;;){if($e.tag===5){if(Le===null){Le=$e;try{y=$e.stateNode,Ce?(_=y.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(se=$e.stateNode,fe=$e.memoizedProps.style,A=fe!=null&&fe.hasOwnProperty("display")?fe.display:null,se.style.display=Dt("display",A))}catch(st){fr(s,s.return,st)}}}else if($e.tag===6){if(Le===null)try{$e.stateNode.nodeValue=Ce?"":$e.memoizedProps}catch(st){fr(s,s.return,st)}}else if(($e.tag!==22&&$e.tag!==23||$e.memoizedState===null||$e===s)&&$e.child!==null){$e.child.return=$e,$e=$e.child;continue}if($e===s)break e;for(;$e.sibling===null;){if($e.return===null||$e.return===s)break e;Le===$e&&(Le=null),$e=$e.return}Le===$e&&(Le=null),$e.sibling.return=$e.return,$e=$e.sibling}}break;case 19:qn(i,s),pa(s),x&4&&Vx(s);break;case 21:break;default:qn(i,s),pa(s)}}function pa(s){var i=s.flags;if(i&2){try{e:{for(var d=s.return;d!==null;){if(Hx(d)){var x=d;break e}d=d.return}throw Error(t(160))}switch(x.tag){case 5:var y=x.stateNode;x.flags&32&&(ut(y,""),x.flags&=-33);var _=$x(s);_0(s,_,y);break;case 3:case 4:var A=x.stateNode.containerInfo,se=$x(s);b0(s,se,A);break;default:throw Error(t(161))}}catch(fe){fr(s,s.return,fe)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Wk(s,i,d){rt=s,Gx(s)}function Gx(s,i,d){for(var x=(s.mode&1)!==0;rt!==null;){var y=rt,_=y.child;if(y.tag===22&&x){var A=y.memoizedState!==null||Fc;if(!A){var se=y.alternate,fe=se!==null&&se.memoizedState!==null||Kr;se=Fc;var Ce=Kr;if(Fc=A,(Kr=fe)&&!Ce)for(rt=y;rt!==null;)A=rt,fe=A.child,A.tag===22&&A.memoizedState!==null?qx(y):fe!==null?(fe.return=A,rt=fe):qx(y);for(;_!==null;)rt=_,Gx(_),_=_.sibling;rt=y,Fc=se,Kr=Ce}Xx(s)}else(y.subtreeFlags&8772)!==0&&_!==null?(_.return=y,rt=_):Xx(s)}}function Xx(s){for(;rt!==null;){var i=rt;if((i.flags&8772)!==0){var d=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Kr||jc(5,i);break;case 1:var x=i.stateNode;if(i.flags&4&&!Kr)if(d===null)x.componentDidMount();else{var y=i.elementType===i.type?d.memoizedProps:Xn(i.type,d.memoizedProps);x.componentDidUpdate(y,d.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var _=i.updateQueue;_!==null&&Qh(i,_,x);break;case 3:var A=i.updateQueue;if(A!==null){if(d=null,i.child!==null)switch(i.child.tag){case 5:d=i.child.stateNode;break;case 1:d=i.child.stateNode}Qh(i,A,d)}break;case 5:var se=i.stateNode;if(d===null&&i.flags&4){d=se;var fe=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":fe.autoFocus&&d.focus();break;case"img":fe.src&&(d.src=fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Ce=i.alternate;if(Ce!==null){var Le=Ce.memoizedState;if(Le!==null){var $e=Le.dehydrated;$e!==null&&Ti($e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kr||i.flags&512&&k0(i)}catch(ze){fr(i,i.return,ze)}}if(i===s){rt=null;break}if(d=i.sibling,d!==null){d.return=i.return,rt=d;break}rt=i.return}}function Qx(s){for(;rt!==null;){var i=rt;if(i===s){rt=null;break}var d=i.sibling;if(d!==null){d.return=i.return,rt=d;break}rt=i.return}}function qx(s){for(;rt!==null;){var i=rt;try{switch(i.tag){case 0:case 11:case 15:var d=i.return;try{jc(4,i)}catch(fe){fr(i,d,fe)}break;case 1:var x=i.stateNode;if(typeof x.componentDidMount=="function"){var y=i.return;try{x.componentDidMount()}catch(fe){fr(i,y,fe)}}var _=i.return;try{k0(i)}catch(fe){fr(i,_,fe)}break;case 5:var A=i.return;try{k0(i)}catch(fe){fr(i,A,fe)}}}catch(fe){fr(i,i.return,fe)}if(i===s){rt=null;break}var se=i.sibling;if(se!==null){se.return=i.return,rt=se;break}rt=i.return}}var Uk=Math.ceil,Ac=z.ReactCurrentDispatcher,S0=z.ReactCurrentOwner,An=z.ReactCurrentBatchConfig,Pt=0,Pr=null,br=null,Lr=0,_n=0,Yo=ls(0),Tr=0,Qi=null,Ks=0,Pc=0,E0=0,qi=null,mn=null,C0=0,Vo=1/0,Ba=null,Oc=!1,T0=null,hs=null,Rc=!1,xs=null,Mc=0,Zi=0,N0=null,Ic=-1,zc=0;function rn(){return(Pt&6)!==0?He():Ic!==-1?Ic:Ic=He()}function ms(s){return(s.mode&1)===0?1:(Pt&2)!==0&&Lr!==0?Lr&-Lr:Ek.transition!==null?(zc===0&&(zc=$p()),zc):(s=Kt,s!==0||(s=window.event,s=s===void 0?16:Jp(s.type)),s)}function Zn(s,i,d,x){if(50<Zi)throw Zi=0,N0=null,Error(t(185));bi(s,d,x),((Pt&2)===0||s!==Pr)&&(s===Pr&&((Pt&2)===0&&(Pc|=d),Tr===4&&gs(s,Lr)),gn(s,x),d===1&&Pt===0&&(i.mode&1)===0&&(Vo=He()+500,fc&&us()))}function gn(s,i){var d=s.callbackNode;Ew(s,i);var x=Kl(s,s===Pr?Lr:0);if(x===0)d!==null&&Ke(d),s.callbackNode=null,s.callbackPriority=0;else if(i=x&-x,s.callbackPriority!==i){if(d!=null&&Ke(d),i===1)s.tag===0?Sk(Jx.bind(null,s)):zh(Jx.bind(null,s)),wk(function(){(Pt&6)===0&&us()}),d=null;else{switch(Yp(x)){case 1:d=Vt;break;case 4:d=Wt;break;case 16:d=mr;break;case 536870912:d=es;break;default:d=mr}d=im(d,Zx.bind(null,s))}s.callbackPriority=i,s.callbackNode=d}}function Zx(s,i){if(Ic=-1,zc=0,(Pt&6)!==0)throw Error(t(327));var d=s.callbackNode;if(Ko()&&s.callbackNode!==d)return null;var x=Kl(s,s===Pr?Lr:0);if(x===0)return null;if((x&30)!==0||(x&s.expiredLanes)!==0||i)i=Lc(s,x);else{i=x;var y=Pt;Pt|=2;var _=tm();(Pr!==s||Lr!==i)&&(Ba=null,Vo=He()+500,Xs(s,i));do try{Yk();break}catch(se){em(s,se)}while(!0);Vd(),Ac.current=_,Pt=y,br!==null?i=0:(Pr=null,Lr=0,i=Tr)}if(i!==0){if(i===2&&(y=ld(s),y!==0&&(x=y,i=D0(s,y))),i===1)throw d=Qi,Xs(s,0),gs(s,x),gn(s,He()),d;if(i===6)gs(s,x);else{if(y=s.current.alternate,(x&30)===0&&!Hk(y)&&(i=Lc(s,x),i===2&&(_=ld(s),_!==0&&(x=_,i=D0(s,_))),i===1))throw d=Qi,Xs(s,0),gs(s,x),gn(s,He()),d;switch(s.finishedWork=y,s.finishedLanes=x,i){case 0:case 1:throw Error(t(345));case 2:Qs(s,mn,Ba);break;case 3:if(gs(s,x),(x&130023424)===x&&(i=C0+500-He(),10<i)){if(Kl(s,0)!==0)break;if(y=s.suspendedLanes,(y&x)!==x){rn(),s.pingedLanes|=s.suspendedLanes&y;break}s.timeoutHandle=Rd(Qs.bind(null,s,mn,Ba),i);break}Qs(s,mn,Ba);break;case 4:if(gs(s,x),(x&4194240)===x)break;for(i=s.eventTimes,y=-1;0<x;){var A=31-gr(x);_=1<<A,A=i[A],A>y&&(y=A),x&=~_}if(x=y,x=He()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*Uk(x/1960))-x,10<x){s.timeoutHandle=Rd(Qs.bind(null,s,mn,Ba),x);break}Qs(s,mn,Ba);break;case 5:Qs(s,mn,Ba);break;default:throw Error(t(329))}}}return gn(s,He()),s.callbackNode===d?Zx.bind(null,s):null}function D0(s,i){var d=qi;return s.current.memoizedState.isDehydrated&&(Xs(s,i).flags|=256),s=Lc(s,i),s!==2&&(i=mn,mn=d,i!==null&&F0(i)),s}function F0(s){mn===null?mn=s:mn.push.apply(mn,s)}function Hk(s){for(var i=s;;){if(i.flags&16384){var d=i.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var x=0;x<d.length;x++){var y=d[x],_=y.getSnapshot;y=y.value;try{if(!Kn(_(),y))return!1}catch{return!1}}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function gs(s,i){for(i&=~E0,i&=~Pc,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var d=31-gr(i),x=1<<d;s[d]=-1,i&=~x}}function Jx(s){if((Pt&6)!==0)throw Error(t(327));Ko();var i=Kl(s,0);if((i&1)===0)return gn(s,He()),null;var d=Lc(s,i);if(s.tag!==0&&d===2){var x=ld(s);x!==0&&(i=x,d=D0(s,x))}if(d===1)throw d=Qi,Xs(s,0),gs(s,i),gn(s,He()),d;if(d===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Qs(s,mn,Ba),gn(s,He()),null}function j0(s,i){var d=Pt;Pt|=1;try{return s(i)}finally{Pt=d,Pt===0&&(Vo=He()+500,fc&&us())}}function Gs(s){xs!==null&&xs.tag===0&&(Pt&6)===0&&Ko();var i=Pt;Pt|=1;var d=An.transition,x=Kt;try{if(An.transition=null,Kt=1,s)return s()}finally{Kt=x,An.transition=d,Pt=i,(Pt&6)===0&&us()}}function A0(){_n=Yo.current,ar(Yo)}function Xs(s,i){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;if(d!==-1&&(s.timeoutHandle=-1,yk(d)),br!==null)for(d=br.return;d!==null;){var x=d;switch(Wd(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&uc();break;case 3:Uo(),ar(pn),ar($r),e0();break;case 5:Zd(x);break;case 4:Uo();break;case 13:ar(lr);break;case 19:ar(lr);break;case 10:Kd(x.type._context);break;case 22:case 23:A0()}d=d.return}if(Pr=s,br=s=vs(s.current,null),Lr=_n=i,Tr=0,Qi=null,E0=Pc=Ks=0,mn=qi=null,$s!==null){for(i=0;i<$s.length;i++)if(d=$s[i],x=d.interleaved,x!==null){d.interleaved=null;var y=x.next,_=d.pending;if(_!==null){var A=_.next;_.next=y,x.next=A}d.pending=x}$s=null}return s}function em(s,i){do{var d=br;try{if(Vd(),bc.current=Cc,_c){for(var x=cr.memoizedState;x!==null;){var y=x.queue;y!==null&&(y.pending=null),x=x.next}_c=!1}if(Vs=0,Ar=Cr=cr=null,$i=!1,Yi=0,S0.current=null,d===null||d.return===null){Tr=1,Qi=i,br=null;break}e:{var _=s,A=d.return,se=d,fe=i;if(i=Lr,se.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Ce=fe,Le=se,$e=Le.tag;if((Le.mode&1)===0&&($e===0||$e===11||$e===15)){var ze=Le.alternate;ze?(Le.updateQueue=ze.updateQueue,Le.memoizedState=ze.memoizedState,Le.lanes=ze.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var Je=Ex(A);if(Je!==null){Je.flags&=-257,Cx(Je,A,se,_,i),Je.mode&1&&Sx(_,Ce,i),i=Je,fe=Ce;var nt=i.updateQueue;if(nt===null){var st=new Set;st.add(fe),i.updateQueue=st}else nt.add(fe);break e}else{if((i&1)===0){Sx(_,Ce,i),P0();break e}fe=Error(t(426))}}else if(sr&&se.mode&1){var vr=Ex(A);if(vr!==null){(vr.flags&65536)===0&&(vr.flags|=256),Cx(vr,A,se,_,i),$d(Ho(fe,se));break e}}_=fe=Ho(fe,se),Tr!==4&&(Tr=2),qi===null?qi=[_]:qi.push(_),_=A;do{switch(_.tag){case 3:_.flags|=65536,i&=-i,_.lanes|=i;var we=bx(_,fe,i);Xh(_,we);break e;case 1:se=fe;var ge=_.type,_e=_.stateNode;if((_.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||_e!==null&&typeof _e.componentDidCatch=="function"&&(hs===null||!hs.has(_e)))){_.flags|=65536,i&=-i,_.lanes|=i;var Ye=_x(_,se,i);Xh(_,Ye);break e}}_=_.return}while(_!==null)}nm(d)}catch(ot){i=ot,br===d&&d!==null&&(br=d=d.return);continue}break}while(!0)}function tm(){var s=Ac.current;return Ac.current=Cc,s===null?Cc:s}function P0(){(Tr===0||Tr===3||Tr===2)&&(Tr=4),Pr===null||(Ks&268435455)===0&&(Pc&268435455)===0||gs(Pr,Lr)}function Lc(s,i){var d=Pt;Pt|=2;var x=tm();(Pr!==s||Lr!==i)&&(Ba=null,Xs(s,i));do try{$k();break}catch(y){em(s,y)}while(!0);if(Vd(),Pt=d,Ac.current=x,br!==null)throw Error(t(261));return Pr=null,Lr=0,Tr}function $k(){for(;br!==null;)rm(br)}function Yk(){for(;br!==null&&!We();)rm(br)}function rm(s){var i=om(s.alternate,s,_n);s.memoizedProps=s.pendingProps,i===null?nm(s):br=i,S0.current=null}function nm(s){var i=s;do{var d=i.alternate;if(s=i.return,(i.flags&32768)===0){if(d=Ik(d,i,_n),d!==null){br=d;return}}else{if(d=zk(d,i),d!==null){d.flags&=32767,br=d;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Tr=6,br=null;return}}if(i=i.sibling,i!==null){br=i;return}br=i=s}while(i!==null);Tr===0&&(Tr=5)}function Qs(s,i,d){var x=Kt,y=An.transition;try{An.transition=null,Kt=1,Vk(s,i,d,x)}finally{An.transition=y,Kt=x}return null}function Vk(s,i,d,x){do Ko();while(xs!==null);if((Pt&6)!==0)throw Error(t(327));d=s.finishedWork;var y=s.finishedLanes;if(d===null)return null;if(s.finishedWork=null,s.finishedLanes=0,d===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var _=d.lanes|d.childLanes;if(Cw(s,_),s===Pr&&(br=Pr=null,Lr=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Rc||(Rc=!0,im(mr,function(){return Ko(),null})),_=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||_){_=An.transition,An.transition=null;var A=Kt;Kt=1;var se=Pt;Pt|=4,S0.current=null,Bk(s,d),Kx(d,s),fk(Pd),Ql=!!Ad,Pd=Ad=null,s.current=d,Wk(d),Ue(),Pt=se,Kt=A,An.transition=_}else s.current=d;if(Rc&&(Rc=!1,xs=s,Mc=y),_=s.pendingLanes,_===0&&(hs=null),wi(d.stateNode),gn(s,He()),i!==null)for(x=s.onRecoverableError,d=0;d<i.length;d++)y=i[d],x(y.value,{componentStack:y.stack,digest:y.digest});if(Oc)throw Oc=!1,s=T0,T0=null,s;return(Mc&1)!==0&&s.tag!==0&&Ko(),_=s.pendingLanes,(_&1)!==0?s===N0?Zi++:(Zi=0,N0=s):Zi=0,us(),null}function Ko(){if(xs!==null){var s=Yp(Mc),i=An.transition,d=Kt;try{if(An.transition=null,Kt=16>s?16:s,xs===null)var x=!1;else{if(s=xs,xs=null,Mc=0,(Pt&6)!==0)throw Error(t(331));var y=Pt;for(Pt|=4,rt=s.current;rt!==null;){var _=rt,A=_.child;if((rt.flags&16)!==0){var se=_.deletions;if(se!==null){for(var fe=0;fe<se.length;fe++){var Ce=se[fe];for(rt=Ce;rt!==null;){var Le=rt;switch(Le.tag){case 0:case 11:case 15:Xi(8,Le,_)}var $e=Le.child;if($e!==null)$e.return=Le,rt=$e;else for(;rt!==null;){Le=rt;var ze=Le.sibling,Je=Le.return;if(Ux(Le),Le===Ce){rt=null;break}if(ze!==null){ze.return=Je,rt=ze;break}rt=Je}}}var nt=_.alternate;if(nt!==null){var st=nt.child;if(st!==null){nt.child=null;do{var vr=st.sibling;st.sibling=null,st=vr}while(st!==null)}}rt=_}}if((_.subtreeFlags&2064)!==0&&A!==null)A.return=_,rt=A;else e:for(;rt!==null;){if(_=rt,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Xi(9,_,_.return)}var we=_.sibling;if(we!==null){we.return=_.return,rt=we;break e}rt=_.return}}var ge=s.current;for(rt=ge;rt!==null;){A=rt;var _e=A.child;if((A.subtreeFlags&2064)!==0&&_e!==null)_e.return=A,rt=_e;else e:for(A=ge;rt!==null;){if(se=rt,(se.flags&2048)!==0)try{switch(se.tag){case 0:case 11:case 15:jc(9,se)}}catch(ot){fr(se,se.return,ot)}if(se===A){rt=null;break e}var Ye=se.sibling;if(Ye!==null){Ye.return=se.return,rt=Ye;break e}rt=se.return}}if(Pt=y,us(),jr&&typeof jr.onPostCommitFiberRoot=="function")try{jr.onPostCommitFiberRoot(ca,s)}catch{}x=!0}return x}finally{Kt=d,An.transition=i}}return!1}function am(s,i,d){i=Ho(d,i),i=bx(s,i,1),s=fs(s,i,1),i=rn(),s!==null&&(bi(s,1,i),gn(s,i))}function fr(s,i,d){if(s.tag===3)am(s,s,d);else for(;i!==null;){if(i.tag===3){am(i,s,d);break}else if(i.tag===1){var x=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(hs===null||!hs.has(x))){s=Ho(d,s),s=_x(i,s,1),i=fs(i,s,1),s=rn(),i!==null&&(bi(i,1,s),gn(i,s));break}}i=i.return}}function Kk(s,i,d){var x=s.pingCache;x!==null&&x.delete(i),i=rn(),s.pingedLanes|=s.suspendedLanes&d,Pr===s&&(Lr&d)===d&&(Tr===4||Tr===3&&(Lr&130023424)===Lr&&500>He()-C0?Xs(s,0):E0|=d),gn(s,i)}function sm(s,i){i===0&&((s.mode&1)===0?i=1:(i=Vl,Vl<<=1,(Vl&130023424)===0&&(Vl=4194304)));var d=rn();s=Ia(s,i),s!==null&&(bi(s,i,d),gn(s,d))}function Gk(s){var i=s.memoizedState,d=0;i!==null&&(d=i.retryLane),sm(s,d)}function Xk(s,i){var d=0;switch(s.tag){case 13:var x=s.stateNode,y=s.memoizedState;y!==null&&(d=y.retryLane);break;case 19:x=s.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(i),sm(s,d)}var om;om=function(s,i,d){if(s!==null)if(s.memoizedProps!==i.pendingProps||pn.current)xn=!0;else{if((s.lanes&d)===0&&(i.flags&128)===0)return xn=!1,Mk(s,i,d);xn=(s.flags&131072)!==0}else xn=!1,sr&&(i.flags&1048576)!==0&&Lh(i,hc,i.index);switch(i.lanes=0,i.tag){case 2:var x=i.type;Dc(s,i),s=i.pendingProps;var y=Ro(i,$r.current);Wo(i,d),y=n0(null,i,x,s,y,d);var _=a0();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,hn(x)?(_=!0,dc(i)):_=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Qd(i),y.updater=Tc,i.stateNode=y,y._reactInternals=i,u0(i,x,s,d),i=h0(null,i,x,!0,_,d)):(i.tag=0,sr&&_&&Bd(i),tn(null,i,y,d),i=i.child),i;case 16:x=i.elementType;e:{switch(Dc(s,i),s=i.pendingProps,y=x._init,x=y(x._payload),i.type=x,y=i.tag=qk(x),s=Xn(x,s),y){case 0:i=p0(null,i,x,s,d);break e;case 1:i=Ax(null,i,x,s,d);break e;case 11:i=Tx(null,i,x,s,d);break e;case 14:i=Nx(null,i,x,Xn(x.type,s),d);break e}throw Error(t(306,x,""))}return i;case 0:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),p0(s,i,x,y,d);case 1:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),Ax(s,i,x,y,d);case 3:e:{if(Px(i),s===null)throw Error(t(387));x=i.pendingProps,_=i.memoizedState,y=_.element,Gh(s,i),wc(i,x,null,d);var A=i.memoizedState;if(x=A.element,_.isDehydrated)if(_={element:x,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},i.updateQueue.baseState=_,i.memoizedState=_,i.flags&256){y=Ho(Error(t(423)),i),i=Ox(s,i,x,d,y);break e}else if(x!==y){y=Ho(Error(t(424)),i),i=Ox(s,i,x,d,y);break e}else for(bn=is(i.stateNode.containerInfo.firstChild),kn=i,sr=!0,Gn=null,d=Vh(i,null,x,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(zo(),x===y){i=La(s,i,d);break e}tn(s,i,x,d)}i=i.child}return i;case 5:return qh(i),s===null&&Hd(i),x=i.type,y=i.pendingProps,_=s!==null?s.memoizedProps:null,A=y.children,Od(x,y)?A=null:_!==null&&Od(x,_)&&(i.flags|=32),jx(s,i),tn(s,i,A,d),i.child;case 6:return s===null&&Hd(i),null;case 13:return Rx(s,i,d);case 4:return qd(i,i.stateNode.containerInfo),x=i.pendingProps,s===null?i.child=Lo(i,null,x,d):tn(s,i,x,d),i.child;case 11:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),Tx(s,i,x,y,d);case 7:return tn(s,i,i.pendingProps,d),i.child;case 8:return tn(s,i,i.pendingProps.children,d),i.child;case 12:return tn(s,i,i.pendingProps.children,d),i.child;case 10:e:{if(x=i.type._context,y=i.pendingProps,_=i.memoizedProps,A=y.value,Jt(gc,x._currentValue),x._currentValue=A,_!==null)if(Kn(_.value,A)){if(_.children===y.children&&!pn.current){i=La(s,i,d);break e}}else for(_=i.child,_!==null&&(_.return=i);_!==null;){var se=_.dependencies;if(se!==null){A=_.child;for(var fe=se.firstContext;fe!==null;){if(fe.context===x){if(_.tag===1){fe=za(-1,d&-d),fe.tag=2;var Ce=_.updateQueue;if(Ce!==null){Ce=Ce.shared;var Le=Ce.pending;Le===null?fe.next=fe:(fe.next=Le.next,Le.next=fe),Ce.pending=fe}}_.lanes|=d,fe=_.alternate,fe!==null&&(fe.lanes|=d),Gd(_.return,d,i),se.lanes|=d;break}fe=fe.next}}else if(_.tag===10)A=_.type===i.type?null:_.child;else if(_.tag===18){if(A=_.return,A===null)throw Error(t(341));A.lanes|=d,se=A.alternate,se!==null&&(se.lanes|=d),Gd(A,d,i),A=_.sibling}else A=_.child;if(A!==null)A.return=_;else for(A=_;A!==null;){if(A===i){A=null;break}if(_=A.sibling,_!==null){_.return=A.return,A=_;break}A=A.return}_=A}tn(s,i,y.children,d),i=i.child}return i;case 9:return y=i.type,x=i.pendingProps.children,Wo(i,d),y=Fn(y),x=x(y),i.flags|=1,tn(s,i,x,d),i.child;case 14:return x=i.type,y=Xn(x,i.pendingProps),y=Xn(x.type,y),Nx(s,i,x,y,d);case 15:return Dx(s,i,i.type,i.pendingProps,d);case 17:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:Xn(x,y),Dc(s,i),i.tag=1,hn(x)?(s=!0,dc(i)):s=!1,Wo(i,d),wx(i,x,y),u0(i,x,y,d),h0(null,i,x,!0,s,d);case 19:return Ix(s,i,d);case 22:return Fx(s,i,d)}throw Error(t(156,i.tag))};function im(s,i){return Be(s,i)}function Qk(s,i,d,x){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,i,d,x){return new Qk(s,i,d,x)}function O0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function qk(s){if(typeof s=="function")return O0(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Y)return 11;if(s===oe)return 14}return 2}function vs(s,i){var d=s.alternate;return d===null?(d=Pn(s.tag,i,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=i,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&14680064,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,i=s.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d}function Bc(s,i,d,x,y,_){var A=2;if(x=s,typeof s=="function")O0(s)&&(A=1);else if(typeof s=="string")A=5;else e:switch(s){case D:return qs(d.children,y,_,i);case H:A=8,y|=8;break;case L:return s=Pn(12,d,i,y|2),s.elementType=L,s.lanes=_,s;case ue:return s=Pn(13,d,i,y),s.elementType=ue,s.lanes=_,s;case le:return s=Pn(19,d,i,y),s.elementType=le,s.lanes=_,s;case G:return Wc(d,y,_,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ae:A=10;break e;case Q:A=9;break e;case Y:A=11;break e;case oe:A=14;break e;case pe:A=16,x=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Pn(A,d,i,y),i.elementType=s,i.type=x,i.lanes=_,i}function qs(s,i,d,x){return s=Pn(7,s,x,i),s.lanes=d,s}function Wc(s,i,d,x){return s=Pn(22,s,x,i),s.elementType=G,s.lanes=d,s.stateNode={isHidden:!1},s}function R0(s,i,d){return s=Pn(6,s,null,i),s.lanes=d,s}function M0(s,i,d){return i=Pn(4,s.children!==null?s.children:[],s.key,i),i.lanes=d,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function Zk(s,i,d,x,y){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cd(0),this.expirationTimes=cd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cd(0),this.identifierPrefix=x,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function I0(s,i,d,x,y,_,A,se,fe){return s=new Zk(s,i,d,se,fe),i===1?(i=1,_===!0&&(i|=8)):i=0,_=Pn(3,null,null,i),s.current=_,_.stateNode=s,_.memoizedState={element:x,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qd(_),s}function Jk(s,i,d){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:V,key:x==null?null:""+x,children:s,containerInfo:i,implementation:d}}function lm(s){if(!s)return cs;s=s._reactInternals;e:{if(ne(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(hn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var d=s.type;if(hn(d))return Mh(s,d,i)}return i}function cm(s,i,d,x,y,_,A,se,fe){return s=I0(d,x,!0,s,y,_,A,se,fe),s.context=lm(null),d=s.current,x=rn(),y=ms(d),_=za(x,y),_.callback=i??null,fs(d,_,y),s.current.lanes=y,bi(s,y,x),gn(s,x),s}function Uc(s,i,d,x){var y=i.current,_=rn(),A=ms(y);return d=lm(d),i.context===null?i.context=d:i.pendingContext=d,i=za(_,A),i.payload={element:s},x=x===void 0?null:x,x!==null&&(i.callback=x),s=fs(y,i,A),s!==null&&(Zn(s,y,A,_),yc(s,y,A)),A}function Hc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function um(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<i?d:i}}function z0(s,i){um(s,i),(s=s.alternate)&&um(s,i)}function e2(){return null}var dm=typeof reportError=="function"?reportError:function(s){console.error(s)};function L0(s){this._internalRoot=s}$c.prototype.render=L0.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));Uc(s,i,null,null)},$c.prototype.unmount=L0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Gs(function(){Uc(null,s,null,null)}),i[Pa]=null}};function $c(s){this._internalRoot=s}$c.prototype.unstable_scheduleHydration=function(s){if(s){var i=Gp();s={blockedOn:null,target:s,priority:i};for(var d=0;d<as.length&&i!==0&&i<as[d].priority;d++);as.splice(d,0,s),d===0&&qp(s)}};function B0(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Yc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function fm(){}function t2(s,i,d,x,y){if(y){if(typeof x=="function"){var _=x;x=function(){var Ce=Hc(A);_.call(Ce)}}var A=cm(i,x,s,0,null,!1,!1,"",fm);return s._reactRootContainer=A,s[Pa]=A.current,Mi(s.nodeType===8?s.parentNode:s),Gs(),A}for(;y=s.lastChild;)s.removeChild(y);if(typeof x=="function"){var se=x;x=function(){var Ce=Hc(fe);se.call(Ce)}}var fe=I0(s,0,!1,null,null,!1,!1,"",fm);return s._reactRootContainer=fe,s[Pa]=fe.current,Mi(s.nodeType===8?s.parentNode:s),Gs(function(){Uc(i,fe,d,x)}),fe}function Vc(s,i,d,x,y){var _=d._reactRootContainer;if(_){var A=_;if(typeof y=="function"){var se=y;y=function(){var fe=Hc(A);se.call(fe)}}Uc(i,A,s,y)}else A=t2(d,i,s,y,x);return Hc(A)}Vp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var d=ki(i.pendingLanes);d!==0&&(ud(i,d|1),gn(i,He()),(Pt&6)===0&&(Vo=He()+500,us()))}break;case 13:Gs(function(){var x=Ia(s,1);if(x!==null){var y=rn();Zn(x,s,1,y)}}),z0(s,1)}},dd=function(s){if(s.tag===13){var i=Ia(s,134217728);if(i!==null){var d=rn();Zn(i,s,134217728,d)}z0(s,134217728)}},Kp=function(s){if(s.tag===13){var i=ms(s),d=Ia(s,i);if(d!==null){var x=rn();Zn(d,s,i,x)}z0(s,i)}},Gp=function(){return Kt},Xp=function(s,i){var d=Kt;try{return Kt=s,i()}finally{Kt=d}},me=function(s,i,d){switch(i){case"input":if(ce(s,d),i=d.name,d.type==="radio"&&i!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<d.length;i++){var x=d[i];if(x!==s&&x.form===s.form){var y=cc(x);if(!y)throw Error(t(90));M(x),ce(x,y)}}}break;case"textarea":Nt(s,d);break;case"select":i=d.value,i!=null&&lt(s,!!d.multiple,i,!1)}},Et=j0,qe=Gs;var r2={usingClientEntryPoint:!1,Events:[Li,Po,cc,at,dt,j0]},Ji={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},n2={bundleType:Ji.bundleType,version:Ji.version,rendererPackageName:Ji.rendererPackageName,rendererConfig:Ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:z.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Se(s),s===null?null:s.stateNode},findFiberByHostInstance:Ji.findFiberByHostInstance||e2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kc.isDisabled&&Kc.supportsFiber)try{ca=Kc.inject(n2),jr=Kc}catch{}}return vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r2,vn.createPortal=function(s,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B0(i))throw Error(t(200));return Jk(s,i,null,d)},vn.createRoot=function(s,i){if(!B0(s))throw Error(t(299));var d=!1,x="",y=dm;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(x=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=I0(s,1,!1,null,null,d,!1,x,y),s[Pa]=i.current,Mi(s.nodeType===8?s.parentNode:s),new L0(i)},vn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Se(i),s=s===null?null:s.stateNode,s},vn.flushSync=function(s){return Gs(s)},vn.hydrate=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!0,d)},vn.hydrateRoot=function(s,i,d){if(!B0(s))throw Error(t(405));var x=d!=null&&d.hydratedSources||null,y=!1,_="",A=dm;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onRecoverableError!==void 0&&(A=d.onRecoverableError)),i=cm(i,null,s,1,d??null,y,!1,_,A),s[Pa]=i.current,Mi(s),x)for(s=0;s<x.length;s++)d=x[s],y=d._getVersion,y=y(d._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[d,y]:i.mutableSourceEagerHydrationData.push(d,y);return new $c(i)},vn.render=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!1,d)},vn.unmountComponentAtNode=function(s){if(!Yc(s))throw Error(t(40));return s._reactRootContainer?(Gs(function(){Vc(null,null,s,!1,function(){s._reactRootContainer=null,s[Pa]=null})}),!0):!1},vn.unstable_batchedUpdates=j0,vn.unstable_renderSubtreeIntoContainer=function(s,i,d,x){if(!Yc(d))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Vc(s,i,d,!1,x)},vn.version="18.3.1-next-f1338f8080-20240426",vn}var wm;function Qf(){if(wm)return H0.exports;wm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),H0.exports=f2(),H0.exports}var km;function p2(){if(km)return Gc;km=1;var e=Qf();return Gc.createRoot=e.createRoot,Gc.hydrateRoot=e.hydrateRoot,Gc}var h2=p2();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var x2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Yn=(e,n)=>{const t=C.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...h},p)=>C.createElement("svg",{ref:p,...x2,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${m2(e)}`,c].join(" "),...h},[...n.map(([m,g])=>C.createElement(m,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=Yn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Yn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=Yn("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=Yn("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=Yn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Yn("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=Yn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=Yn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=Yn("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=Yn("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=Yn("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Yn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Xc={exports:{}},ws={},V0={exports:{}},K0,bm;function k2(){if(bm)return K0;bm=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K0=e,K0}var G0,_m;function b2(){if(_m)return G0;_m=1;var e=k2();function n(){}function t(){}return t.resetWarningCache=n,G0=function(){function r(l,c,f,h,p,m){if(m!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},G0}var Sm;function Iv(){return Sm||(Sm=1,V0.exports=b2()()),V0.exports}var Qc={exports:{}},On={},qc={exports:{}},Em;function zv(){return Em||(Em=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(m,g){return g.getPropertyValue("overflow")!=="visible"||m.scrollWidth<=0&&m.scrollHeight<=0}function l(m){var g=m.offsetWidth<=0&&m.offsetHeight<=0;if(g&&!m.innerHTML)return!0;try{var v=window.getComputedStyle(m),k=v.getPropertyValue("display");return g?k!==r&&o(m,v):k===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(m){for(var g=m,v=m.getRootNode&&m.getRootNode();g&&g!==document.body;){if(v&&g===v&&(g=v.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(m,g){var v=m.nodeName.toLowerCase(),k=a.test(v)&&!m.disabled||v==="a"&&m.href||g;return k&&c(m)}function h(m){var g=m.getAttribute("tabindex");g===null&&(g=void 0);var v=isNaN(g);return(v||g>=0)&&f(m,!v)}function p(m){var g=[].slice.call(m.querySelectorAll("*"),0).reduce(function(v,k){return v.concat(k.shadowRoot?p(k.shadowRoot):[k])},[]);return g.filter(h)}e.exports=n.default})(qc,qc.exports)),qc.exports}var Cm;function _2(){if(Cm)return On;Cm=1,Object.defineProperty(On,"__esModule",{value:!0}),On.resetState=l,On.log=c,On.handleBlur=f,On.handleFocus=h,On.markForFocusLater=p,On.returnFocus=m,On.popWithoutFocus=g,On.setupScopedFocus=v,On.teardownScopedFocus=k;var e=zv(),n=t(e);function t(w){return w&&w.__esModule?w:{default:w}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function h(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var w=(0,n.default)(a)[0]||a;w.focus()}},0)}}function p(){r.push(document.activeElement)}function m(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,b=null;try{r.length!==0&&(b=r.pop(),b.focus({preventScroll:w}));return}catch{console.warn(["You tried to return focus to",b,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function v(w){a=w,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",h,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",h))}function k(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",h)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",h))}return On}var Zc={exports:{}},Tm;function S2(){return Tm||(Tm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=zv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var h=(0,r.default)(c);if(!h.length){f.preventDefault();return}var p=void 0,m=f.shiftKey,g=h[0],v=h[h.length-1],k=o();if(c===k){if(!m)return;p=v}if(v===k&&!m&&(p=g),g===k&&m&&(p=v),p){f.preventDefault(),p.focus();return}var w=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),b=w!=null&&w[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(b){var E=h.indexOf(k);if(E>-1&&(E+=m?-1:1),p=h[E],typeof p>"u"){f.preventDefault(),p=m?v:g,p.focus();return}f.preventDefault(),p.focus()}}e.exports=n.default})(Zc,Zc.exports)),Zc.exports}var Jn={},X0,Nm;function E2(){if(Nm)return X0;Nm=1;var e=function(){};return X0=e,X0}var ha={},Q0={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Dm;function C2(){return Dm||(Dm=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(Q0)),Q0.exports}var Fm;function tp(){if(Fm)return ha;Fm=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.canUseDOM=ha.SafeNodeList=ha.SafeHTMLCollection=void 0;var e=C2(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return ha.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},ha.SafeNodeList=r.canUseDOM?window.NodeList:{},ha.canUseDOM=r.canUseDOM,ha.default=a,ha}var jm;function Lv(){if(jm)return Jn;jm=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.resetState=o,Jn.log=l,Jn.assertNodeList=c,Jn.setElement=f,Jn.validateElement=h,Jn.hide=p,Jn.show=m,Jn.documentNotReadyOrSSRTesting=g;var e=E2(),n=r(e),t=tp();function r(v){return v&&v.__esModule?v:{default:v}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(v){return v.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(v){return v.removeAttribute("aria-hidden")})),a=null}function l(){}function c(v,k){if(!v||!v.length)throw new Error("react-modal: No elements were found for selector "+k+".")}function f(v){var k=v;if(typeof k=="string"&&t.canUseDOM){var w=document.querySelectorAll(k);c(w,k),k=w}return a=k||a,a}function h(v){var k=v||a;return k?Array.isArray(k)||k instanceof HTMLCollection||k instanceof NodeList?k:[k]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function p(v){var k=!0,w=!1,b=void 0;try{for(var E=h(v)[Symbol.iterator](),N;!(k=(N=E.next()).done);k=!0){var S=N.value;S.setAttribute("aria-hidden","true")}}catch(z){w=!0,b=z}finally{try{!k&&E.return&&E.return()}finally{if(w)throw b}}}function m(v){var k=!0,w=!1,b=void 0;try{for(var E=h(v)[Symbol.iterator](),N;!(k=(N=E.next()).done);k=!0){var S=N.value;S.removeAttribute("aria-hidden")}}catch(z){w=!0,b=z}finally{try{!k&&E.return&&E.return()}finally{if(w)throw b}}}function g(){a=null}return Jn}var Zs={},Am;function T2(){if(Am)return Zs;Am=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.resetState=r,Zs.log=a;var e={},n={};function t(h,p){h.classList.remove(p)}function r(){var h=document.getElementsByTagName("html")[0];for(var p in e)t(h,e[p]);var m=document.body;for(var g in n)t(m,n[g]);e={},n={}}function a(){}var o=function(p,m){return p[m]||(p[m]=0),p[m]+=1,m},l=function(p,m){return p[m]&&(p[m]-=1),m},c=function(p,m,g){g.forEach(function(v){o(m,v),p.add(v)})},f=function(p,m,g){g.forEach(function(v){l(m,v),m[v]===0&&p.remove(v)})};return Zs.add=function(p,m){return c(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs.remove=function(p,m){return f(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs}var Go={},Pm;function Bv(){if(Pm)return Go;Pm=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.log=r,Go.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return Go.default=t,Go}var tl={},Om;function N2(){if(Om)return tl;Om=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.resetState=l,tl.log=c;var e=Bv(),n=t(e);function t(p){return p&&p.__esModule?p:{default:p}}var r=void 0,a=void 0,o=[];function l(){for(var p=[r,a],m=0;m<p.length;m++){var g=p[m];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var p=[r,a],m=0;m<p.length;m++){var g=p[m],v=g||{};console.log(v.nodeName,v.className,v.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function h(p,m){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=m,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(h),tl}var Rm;function D2(){return Rm||(Rm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(le){for(var oe=1;oe<arguments.length;oe++){var pe=arguments[oe];for(var G in pe)Object.prototype.hasOwnProperty.call(pe,G)&&(le[G]=pe[G])}return le},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(le){return typeof le}:function(le){return le&&typeof Symbol=="function"&&le.constructor===Symbol&&le!==Symbol.prototype?"symbol":typeof le},a=(function(){function le(oe,pe){for(var G=0;G<pe.length;G++){var ie=pe[G];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(oe,ie.key,ie)}}return function(oe,pe,G){return pe&&le(oe.prototype,pe),G&&le(oe,G),oe}})(),o=jl(),l=Iv(),c=te(l),f=_2(),h=z(f),p=S2(),m=te(p),g=Lv(),v=z(g),k=T2(),w=z(k),b=tp(),E=te(b),N=Bv(),S=te(N);N2();function z(le){if(le&&le.__esModule)return le;var oe={};if(le!=null)for(var pe in le)Object.prototype.hasOwnProperty.call(le,pe)&&(oe[pe]=le[pe]);return oe.default=le,oe}function te(le){return le&&le.__esModule?le:{default:le}}function V(le,oe){if(!(le instanceof oe))throw new TypeError("Cannot call a class as a function")}function D(le,oe){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return oe&&(typeof oe=="object"||typeof oe=="function")?oe:le}function H(le,oe){if(typeof oe!="function"&&oe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof oe);le.prototype=Object.create(oe&&oe.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),oe&&(Object.setPrototypeOf?Object.setPrototypeOf(le,oe):le.__proto__=oe)}var L={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},ae=function(oe){return oe.code==="Tab"||oe.keyCode===9},Q=function(oe){return oe.code==="Escape"||oe.keyCode===27},Y=0,ue=(function(le){H(oe,le);function oe(pe){V(this,oe);var G=D(this,(oe.__proto__||Object.getPrototypeOf(oe)).call(this,pe));return G.setOverlayRef=function(ie){G.overlay=ie,G.props.overlayRef&&G.props.overlayRef(ie)},G.setContentRef=function(ie){G.content=ie,G.props.contentRef&&G.props.contentRef(ie)},G.afterClose=function(){var ie=G.props,B=ie.appElement,de=ie.ariaHideApp,I=ie.htmlOpenClassName,j=ie.bodyOpenClassName,re=ie.parentSelector,T=re&&re().ownerDocument||document;j&&w.remove(T.body,j),I&&w.remove(T.getElementsByTagName("html")[0],I),de&&Y>0&&(Y-=1,Y===0&&v.show(B)),G.props.shouldFocusAfterRender&&(G.props.shouldReturnFocusAfterClose?(h.returnFocus(G.props.preventScroll),h.teardownScopedFocus()):h.popWithoutFocus()),G.props.onAfterClose&&G.props.onAfterClose(),S.default.deregister(G)},G.open=function(){G.beforeOpen(),G.state.afterOpen&&G.state.beforeClose?(clearTimeout(G.closeTimer),G.setState({beforeClose:!1})):(G.props.shouldFocusAfterRender&&(h.setupScopedFocus(G.node),h.markForFocusLater()),G.setState({isOpen:!0},function(){G.openAnimationFrame=requestAnimationFrame(function(){G.setState({afterOpen:!0}),G.props.isOpen&&G.props.onAfterOpen&&G.props.onAfterOpen({overlayEl:G.overlay,contentEl:G.content})})}))},G.close=function(){G.props.closeTimeoutMS>0?G.closeWithTimeout():G.closeWithoutTimeout()},G.focusContent=function(){return G.content&&!G.contentHasFocus()&&G.content.focus({preventScroll:!0})},G.closeWithTimeout=function(){var ie=Date.now()+G.props.closeTimeoutMS;G.setState({beforeClose:!0,closesAt:ie},function(){G.closeTimer=setTimeout(G.closeWithoutTimeout,G.state.closesAt-Date.now())})},G.closeWithoutTimeout=function(){G.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},G.afterClose)},G.handleKeyDown=function(ie){ae(ie)&&(0,m.default)(G.content,ie),G.props.shouldCloseOnEsc&&Q(ie)&&(ie.stopPropagation(),G.requestClose(ie))},G.handleOverlayOnClick=function(ie){G.shouldClose===null&&(G.shouldClose=!0),G.shouldClose&&G.props.shouldCloseOnOverlayClick&&(G.ownerHandlesClose()?G.requestClose(ie):G.focusContent()),G.shouldClose=null},G.handleContentOnMouseUp=function(){G.shouldClose=!1},G.handleOverlayOnMouseDown=function(ie){!G.props.shouldCloseOnOverlayClick&&ie.target==G.overlay&&ie.preventDefault()},G.handleContentOnClick=function(){G.shouldClose=!1},G.handleContentOnMouseDown=function(){G.shouldClose=!1},G.requestClose=function(ie){return G.ownerHandlesClose()&&G.props.onRequestClose(ie)},G.ownerHandlesClose=function(){return G.props.onRequestClose},G.shouldBeClosed=function(){return!G.state.isOpen&&!G.state.beforeClose},G.contentHasFocus=function(){return document.activeElement===G.content||G.content.contains(document.activeElement)},G.buildClassName=function(ie,B){var de=(typeof B>"u"?"undefined":r(B))==="object"?B:{base:L[ie],afterOpen:L[ie]+"--after-open",beforeClose:L[ie]+"--before-close"},I=de.base;return G.state.afterOpen&&(I=I+" "+de.afterOpen),G.state.beforeClose&&(I=I+" "+de.beforeClose),typeof B=="string"&&B?I+" "+B:I},G.attributesFromObject=function(ie,B){return Object.keys(B).reduce(function(de,I){return de[ie+"-"+I]=B[I],de},{})},G.state={afterOpen:!1,beforeClose:!1},G.shouldClose=null,G.moveFromContentToOverlay=null,G}return a(oe,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(G,ie){this.props.isOpen&&!G.isOpen?this.open():!this.props.isOpen&&G.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!ie.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var G=this.props,ie=G.appElement,B=G.ariaHideApp,de=G.htmlOpenClassName,I=G.bodyOpenClassName,j=G.parentSelector,re=j&&j().ownerDocument||document;I&&w.add(re.body,I),de&&w.add(re.getElementsByTagName("html")[0],de),B&&(Y+=1,v.hide(ie)),S.default.register(this)}},{key:"render",value:function(){var G=this.props,ie=G.id,B=G.className,de=G.overlayClassName,I=G.defaultStyles,j=G.children,re=B?{}:I.content,T=de?{}:I.overlay;if(this.shouldBeClosed())return null;var F={ref:this.setOverlayRef,className:this.buildClassName("overlay",de),style:t({},T,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},O=t({id:ie,ref:this.setContentRef,style:t({},re,this.props.style.content),className:this.buildClassName("content",B),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),R=this.props.contentElement(O,j);return this.props.overlayElement(F,R)}}]),oe})(o.Component);ue.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},ue.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(E.default),c.default.instanceOf(b.SafeHTMLCollection),c.default.instanceOf(b.SafeNodeList),c.default.arrayOf(c.default.instanceOf(E.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=ue,e.exports=n.default})(Qc,Qc.exports)),Qc.exports}function Wv(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Uv(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function Hv(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}Wv.__suppressDeprecationWarning=!0;Uv.__suppressDeprecationWarning=!0;Hv.__suppressDeprecationWarning=!0;function F2(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=Wv,n.componentWillReceiveProps=Uv),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=Hv;var c=n.componentDidUpdate;n.componentDidUpdate=function(h,p,m){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:m;c.call(this,h,p,g)}}return e}const j2=Object.freeze(Object.defineProperty({__proto__:null,polyfill:F2},Symbol.toStringTag,{value:"Module"})),A2=o2(j2);var Mm;function P2(){if(Mm)return ws;Mm=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.bodyOpenClassName=ws.portalClassName=void 0;var e=Object.assign||function(Q){for(var Y=1;Y<arguments.length;Y++){var ue=arguments[Y];for(var le in ue)Object.prototype.hasOwnProperty.call(ue,le)&&(Q[le]=ue[le])}return Q},n=(function(){function Q(Y,ue){for(var le=0;le<ue.length;le++){var oe=ue[le];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(Y,oe.key,oe)}}return function(Y,ue,le){return ue&&Q(Y.prototype,ue),le&&Q(Y,le),Y}})(),t=jl(),r=b(t),a=Qf(),o=b(a),l=Iv(),c=b(l),f=D2(),h=b(f),p=Lv(),m=w(p),g=tp(),v=b(g),k=A2;function w(Q){if(Q&&Q.__esModule)return Q;var Y={};if(Q!=null)for(var ue in Q)Object.prototype.hasOwnProperty.call(Q,ue)&&(Y[ue]=Q[ue]);return Y.default=Q,Y}function b(Q){return Q&&Q.__esModule?Q:{default:Q}}function E(Q,Y){if(!(Q instanceof Y))throw new TypeError("Cannot call a class as a function")}function N(Q,Y){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y&&(typeof Y=="object"||typeof Y=="function")?Y:Q}function S(Q,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Y);Q.prototype=Object.create(Y&&Y.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),Y&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,Y):Q.__proto__=Y)}var z=ws.portalClassName="ReactModalPortal",te=ws.bodyOpenClassName="ReactModal__Body--open",V=g.canUseDOM&&o.default.createPortal!==void 0,D=function(Y){return document.createElement(Y)},H=function(){return V?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function L(Q){return Q()}var ae=(function(Q){S(Y,Q);function Y(){var ue,le,oe,pe;E(this,Y);for(var G=arguments.length,ie=Array(G),B=0;B<G;B++)ie[B]=arguments[B];return pe=(le=(oe=N(this,(ue=Y.__proto__||Object.getPrototypeOf(Y)).call.apply(ue,[this].concat(ie))),oe),oe.removePortal=function(){!V&&o.default.unmountComponentAtNode(oe.node);var de=L(oe.props.parentSelector);de&&de.contains(oe.node)?de.removeChild(oe.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},oe.portalRef=function(de){oe.portal=de},oe.renderPortal=function(de){var I=H(),j=I(oe,r.default.createElement(h.default,e({defaultStyles:Y.defaultStyles},de)),oe.node);oe.portalRef(j)},le),N(oe,pe)}return n(Y,[{key:"componentDidMount",value:function(){if(g.canUseDOM){V||(this.node=D("div")),this.node.className=this.props.portalClassName;var le=L(this.props.parentSelector);le.appendChild(this.node),!V&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(le){var oe=L(le.parentSelector),pe=L(this.props.parentSelector);return{prevParent:oe,nextParent:pe}}},{key:"componentDidUpdate",value:function(le,oe,pe){if(g.canUseDOM){var G=this.props,ie=G.isOpen,B=G.portalClassName;le.portalClassName!==B&&(this.node.className=B);var de=pe.prevParent,I=pe.nextParent;I!==de&&(de.removeChild(this.node),I.appendChild(this.node)),!(!le.isOpen&&!ie)&&!V&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var le=this.portal.state,oe=Date.now(),pe=le.isOpen&&this.props.closeTimeoutMS&&(le.closesAt||oe+this.props.closeTimeoutMS);pe?(le.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,pe-oe)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!V)return null;!this.node&&V&&(this.node=D("div"));var le=H();return le(r.default.createElement(h.default,e({ref:this.portalRef,defaultStyles:Y.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(le){m.setElement(le)}}]),Y})(t.Component);return ae.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(v.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(v.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},ae.defaultProps={isOpen:!1,portalClassName:z,bodyOpenClassName:te,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(Y,ue){return r.default.createElement("div",Y,ue)},contentElement:function(Y,ue){return r.default.createElement("div",Y,ue)}},ae.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,k.polyfill)(ae),ws.default=ae,ws}var Im;function O2(){return Im||(Im=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=P2(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Xc,Xc.exports)),Xc.exports}var R2=O2();const dr=Gu(R2);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $v=1252,M2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},np=function(e){M2.indexOf(e)!=-1&&($v=rp[0]=e)};function I2(){np(1252)}var na=function(e){np(e)};function Yv(){na(1200),I2()}function zm(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function z2(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Vv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var al=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?z2(e.slice(2)):n==254&&t==255?Vv(e.slice(2)):n==65279?e.slice(1):e},Jc=function(n){return String.fromCharCode(n)},Lm=function(n){return String.fromCharCode(n)},wl,Es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bm(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,r=e.charCodeAt(h++),l=(t&3)<<4|r>>4,a=e.charCodeAt(h++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=Es.charAt(o)+Es.charAt(l)+Es.charAt(c)+Es.charAt(f);return n}function Tn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=Es.indexOf(e.charAt(h++)),l=Es.indexOf(e.charAt(h++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=Es.indexOf(e.charAt(h++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=Es.indexOf(e.charAt(h++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),vo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function js(e){return Tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Wm(e){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ra=function(n){return Tt?vo(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function yo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function ap(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ap(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var _s=Tt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:vo(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function L2(e){for(var n=[],t=0,r=e.length+250,a=js(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=js(65535),r=65530)}return n.push(a.slice(0,t)),_s(n)}var dn=/\u0000/g,sl=/[\u0001-\u0006]/g;function ri(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function aa(e,n){var t=""+e;return t.length>=n?t:pr("0",n-t.length)+t}function sp(e,n){var t=""+e;return t.length>=n?t:pr(" ",n-t.length)+t}function _u(e,n){var t=""+e;return t.length>=n?t:t+pr(" ",n-t.length)}function B2(e,n){var t=""+Math.round(e);return t.length>=n?t:pr("0",n-t.length)+t}function W2(e,n){var t=""+e;return t.length>=n?t:pr("0",n-t.length)+t}var Um=Math.pow(2,32);function Xo(e,n){if(e>Um||e<-Um)return B2(e,n);var t=Math.round(e);return W2(t,n)}function Su(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Hm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],q0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function U2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},$m={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},H2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Eu(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,h=0,p=0,m=Math.floor(a);h<n&&(m=Math.floor(a),c=m*l+o,p=m*h+f,!(a-m<5e-8));)a=1/(a-m),o=l,l=c,f=h,h=p;if(p>n&&(h>n?(p=f,c=o):(p=h,c=l)),!t)return[0,r*c,p];var g=Math.floor(r*c/p);return[g,r*c-g*p,p]}function to(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=X2(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var Kv=new Date(1899,11,31,0,0,0),$2=Kv.getTime(),Y2=new Date(1900,2,1,0,0,0);function Gv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=Y2&&(t+=1440*60*1e3),(t-($2+(e.getTimezoneOffset()-Kv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function op(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function V2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function K2(e){var n=e<0?12:11,t=op(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function G2(e){var n=op(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function kl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=K2(e):n===10?t=e.toFixed(10).substr(0,12):t=G2(e),op(V2(t.toUpperCase()))}function uo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):kl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,Gv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function X2(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Q2(e,n,t,r){var a="",o=0,l=0,c=t.y,f,h=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,h=n.length;break;case 3:return q0[t.m-1][1];case 5:return q0[t.m-1][0];default:return q0[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,h=n.length;break;case 3:return Hm[t.q][0];default:return Hm[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?aa(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=aa(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:f=c,h=1;break}var p=h>0?aa(f,h):"";return p}function Cs(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Xv=/%/g;function q2(e,n,t){var r=n.replace(Xv,""),a=n.length-r.length;return $a(e,r,t*Math.pow(10,2*a))+pr("%",a)}function Z2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return $a(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Qv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Qv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var qv=/# (\?+)( ?)\/( ?)(\d+)/;function J2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?pr(" ",e[1].length+1+e[4].length):sp(l,e[1].length)+e[2]+"/"+e[3]+aa(c,e[4].length))}function eb(e,n,t){return t+(n===0?"":""+n)+pr(" ",e[1].length+2+e[4].length)}var Zv=/^#*0*\.([0#]+)/,Jv=/\).*[0#]/,e1=/\(###\) ###\\?-####/;function nn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Ym(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Vm(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function tb(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function rb(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function In(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Jv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?In("n",r,t):"("+In("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return Z2(e,n,t);if(n.indexOf("%")!==-1)return q2(e,n,t);if(n.indexOf("E")!==-1)return Qv(n,t);if(n.charCodeAt(0)===36)return"$"+In(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+Xo(f,n.length);if(n.match(/^[#?]+$/))return a=Xo(t,0),a==="0"&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(qv))return J2(o,f,h);if(n.match(/^#+0+$/))return h+Xo(f,n.length-n.indexOf("0"));if(o=n.match(Zv))return a=Ym(t,o[1].length).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+pr("0",nn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+Ym(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Cs(Xo(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+In(e,n,-t):Cs(""+(Math.floor(t)+tb(t,o[1].length)))+"."+aa(Vm(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return In(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(In(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(e1))return a=In(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Eu(f,Math.pow(10,l)-1,!1),a=""+h,p=$a("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=_u(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Eu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+_u(c[2],l):pr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=Xo(t,0),n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Vm(t,o[1].length),t<0?"-"+In(e,n,-t):Cs(rb(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?aa(0,3-k.length):"")+k})+"."+aa(l,o[1].length);switch(n){case"###,##0.00":return In(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var v=Cs(Xo(f,0));return v!=="0"?h+v:"";case"###,###.00":return In(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return In(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function nb(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return $a(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function ab(e,n,t){var r=n.replace(Xv,""),a=n.length-r.length;return $a(e,r,t*Math.pow(10,2*a))+pr("%",a)}function t1(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+t1(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ma(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Jv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ma("n",r,t):"("+ma("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return nb(e,n,t);if(n.indexOf("%")!==-1)return ab(e,n,t);if(n.indexOf("E")!==-1)return t1(n,t);if(n.charCodeAt(0)===36)return"$"+ma(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+aa(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(qv))return eb(o,f,h);if(n.match(/^#+0+$/))return h+aa(f,n.length-n.indexOf("0"));if(o=n.match(Zv))return a=(""+t).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])),a=a.replace(/\.(\d*)$/,function(k,w){return"."+w+pr("0",nn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Cs(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):Cs(""+t)+"."+pr("0",o[1].length);if(o=n.match(/^#,#*,#0/))return ma(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(ma(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(e1))return a=ma(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Eu(f,Math.pow(10,l)-1,!1),a=""+h,p=$a("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=_u(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Eu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+_u(c[2],l):pr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):Cs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?aa(0,3-k.length):"")+k})+"."+aa(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var v=Cs(""+f);return v!=="0"?h+v:"";default:if(n.match(/\.[0#?]*$/))return ma(e,n.slice(0,n.lastIndexOf(".")),t)+nn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function $a(e,n,t){return(t|0)===t?ma(e,n,t):In(e,n,t)}function sb(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var r1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mi(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":Su(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(r1))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function ob(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",h,p,m,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!Su(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(m=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(m);a[a.length]={t:"t",v:o},++l;break;case"\\":var v=e.charAt(++l),k=v==="("||v===")"?v:"t";a[a.length]={t:k,v},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=to(n,t,e.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=to(n,t),h==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"":var w={t:c,v:c};if(h==null&&(h=to(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?"P":"A"),w.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="/"?(h!=null&&(w.v=h.H>=12?"":""),w.t="T",l+=5,g="h"):(w.t="t",++l),h==null&&w.t==="T")return"";a[a.length]=w,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(r1)){if(h==null&&(h=to(n,t),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",mi(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var b=0,E=0,N;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",b<1&&(b=1);break;case"s":(N=a[l].v.match(/\.0+$/))&&(E=Math.max(E,N[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[l].v.match(/[Hh]/)&&(b=1),b<2&&a[l].v.match(/[Mm]/)&&(b=2),b<3&&a[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var S="",z;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=Q2(a[l].t.charCodeAt(0),a[l].v,h,E),a[l].t="t";break;case"n":case"?":for(z=l+1;a[z]!=null&&((c=a[z].t)==="?"||c==="D"||(c===" "||c==="t")&&a[z+1]!=null&&(a[z+1].t==="?"||a[z+1].t==="t"&&a[z+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[z].v==="/"||a[z].v===" "&&a[z+1]!=null&&a[z+1].t=="?"));)a[l].v+=a[z].v,a[z]={v:"",t:";"},++z;S+=a[l].v,l=z-1;break;case"G":a[l].t="t",a[l].v=uo(n,t);break}var te="",V,D;if(S.length>0){S.charCodeAt(0)==40?(V=n<0&&S.charCodeAt(0)===45?-n:n,D=$a("n",S,V)):(V=n<0&&r>1?-n:n,D=$a("n",S,V),V<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),z=D.length-1;var H=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){H=l;break}var L=a.length;if(H===a.length&&D.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(z>=a[l].v.length-1?(z-=a[l].v.length,a[l].v=D.substr(z+1,a[l].v.length)):z<0?a[l].v="":(a[l].v=D.substr(0,z+1),z=-1),a[l].t="t",L=l);z>=0&&L<a.length&&(a[L].v=D.substr(0,z+1)+a[L].v)}else if(H!==a.length&&D.indexOf("E")===-1){for(z=D.indexOf(".")-1,l=H;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===H?a[l].v.indexOf(".")-1:a[l].v.length-1,te=a[l].v.substr(p+1);p>=0;--p)z>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(te=D.charAt(z--)+te);a[l].v=te,a[l].t="t",L=l}for(z>=0&&L<a.length&&(a[L].v=D.substr(0,z+1)+a[L].v),z=D.indexOf(".")+1,l=H;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==H)){for(p=a[l].v.indexOf(".")>-1&&l===H?a[l].v.indexOf(".")+1:0,te=a[l].v.substr(0,p);p<a[l].v.length;++p)z<D.length&&(te+=D.charAt(z++));a[l].v=te,a[l].t="t",L=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(V=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=$a(a[l].t,a[l].v,V),a[l].t="t");var ae="";for(l=0;l!==a.length;++l)a[l]!=null&&(ae+=a[l].v);return ae}var Km=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gm(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function ib(e,n){var t=sb(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Km),c=t[1].match(Km);return Gm(n,l)?[r,t[0]]:Gm(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Un(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:kt)[e],r==null&&(r=t.table&&t.table[$m[e]]||kt[$m[e]]),r==null&&(r=H2[e]||"General");break}if(Su(r,0))return uo(n,t);n instanceof Date&&(n=Gv(n,t.date1904));var a=ib(r,n);if(Su(a[1]))return uo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return ob(a[1],n,t,a[0])}function ao(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(kt[t]==null){n<0&&(n=t);continue}if(kt[t]==e){n=t;break}}n<0&&(n=391)}return kt[n]=e,n}function n1(){kt=U2()}var lb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},a1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cb(e){var n=typeof e=="number"?kt[e]:e;return n=n.replace(a1,"(\\d+)"),new RegExp("^"+n+"$")}function ub(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(a1)||[]).forEach(function(m,g){var v=parseInt(t[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=v;break;case"d":o=v;break;case"h":l=v;break;case"s":f=v;break;case"m":l>=0?c=v:a=v;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?h:r==-1&&a==-1&&o==-1?p:h+"T"+p}var db=(function(){var e={};e.version="1.2.0";function n(){for(var D=0,H=new Array(256),L=0;L!=256;++L)D=L,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,H[L]=D;return typeof Int32Array<"u"?new Int32Array(H):H}var t=n();function r(D){var H=0,L=0,ae=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)Q[ae]=D[ae];for(ae=0;ae!=256;++ae)for(L=D[ae],H=256+ae;H<4096;H+=256)L=Q[H]=L>>>8^D[L&255];var Y=[];for(ae=1;ae!=16;++ae)Y[ae-1]=typeof Int32Array<"u"?Q.subarray(ae*256,ae*256+256):Q.slice(ae*256,ae*256+256);return Y}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],h=a[4],p=a[5],m=a[6],g=a[7],v=a[8],k=a[9],w=a[10],b=a[11],E=a[12],N=a[13],S=a[14];function z(D,H){for(var L=H^-1,ae=0,Q=D.length;ae<Q;)L=L>>>8^t[(L^D.charCodeAt(ae++))&255];return~L}function te(D,H){for(var L=H^-1,ae=D.length-15,Q=0;Q<ae;)L=S[D[Q++]^L&255]^N[D[Q++]^L>>8&255]^E[D[Q++]^L>>16&255]^b[D[Q++]^L>>>24]^w[D[Q++]]^k[D[Q++]]^v[D[Q++]]^g[D[Q++]]^m[D[Q++]]^p[D[Q++]]^h[D[Q++]]^f[D[Q++]]^c[D[Q++]]^l[D[Q++]]^o[D[Q++]]^t[D[Q++]];for(ae+=15;Q<ae;)L=L>>>8^t[(L^D[Q++])&255];return~L}function V(D,H){for(var L=H^-1,ae=0,Q=D.length,Y=0,ue=0;ae<Q;)Y=D.charCodeAt(ae++),Y<128?L=L>>>8^t[(L^Y)&255]:Y<2048?(L=L>>>8^t[(L^(192|Y>>6&31))&255],L=L>>>8^t[(L^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,ue=D.charCodeAt(ae++)&1023,L=L>>>8^t[(L^(240|Y>>8&7))&255],L=L>>>8^t[(L^(128|Y>>2&63))&255],L=L>>>8^t[(L^(128|ue>>6&15|(Y&3)<<4))&255],L=L>>>8^t[(L^(128|ue&63))&255]):(L=L>>>8^t[(L^(224|Y>>12&15))&255],L=L>>>8^t[(L^(128|Y>>6&63))&255],L=L>>>8^t[(L^(128|Y&63))&255]);return~L}return e.table=t,e.bstr=z,e.buf=te,e.str=V,e})(),jt=(function(){var n={};n.version="1.2.1";function t(P,ee){for(var W=P.split("/"),K=ee.split("/"),q=0,ne=0,be=Math.min(W.length,K.length);q<be;++q){if(ne=W[q].length-K[q].length)return ne;if(W[q]!=K[q])return W[q]<K[q]?-1:1}return W.length-K.length}function r(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:r(P.slice(0,-1));var ee=P.lastIndexOf("/");return ee===-1?P:P.slice(0,ee+1)}function a(P){if(P.charAt(P.length-1)=="/")return a(P.slice(0,-1));var ee=P.lastIndexOf("/");return ee===-1?P:P.slice(ee+1)}function o(P,ee){typeof ee=="string"&&(ee=new Date(ee));var W=ee.getHours();W=W<<6|ee.getMinutes(),W=W<<5|ee.getSeconds()>>>1,P.write_shift(2,W);var K=ee.getFullYear()-1980;K=K<<4|ee.getMonth()+1,K=K<<5|ee.getDate(),P.write_shift(2,K)}function l(P){var ee=P.read_shift(2)&65535,W=P.read_shift(2)&65535,K=new Date,q=W&31;W>>>=5;var ne=W&15;W>>>=4,K.setMilliseconds(0),K.setFullYear(W+1980),K.setMonth(ne-1),K.setDate(q);var be=ee&31;ee>>>=5;var je=ee&63;return ee>>>=6,K.setHours(ee),K.setMinutes(je),K.setSeconds(be<<1),K}function c(P){Br(P,0);for(var ee={},W=0;P.l<=P.length-4;){var K=P.read_shift(2),q=P.read_shift(2),ne=P.l+q,be={};switch(K){case 21589:W=P.read_shift(1),W&1&&(be.mtime=P.read_shift(4)),q>5&&(W&2&&(be.atime=P.read_shift(4)),W&4&&(be.ctime=P.read_shift(4))),be.mtime&&(be.mt=new Date(be.mtime*1e3));break}P.l=ne,ee[K]=be}return ee}var f;function h(){return f||(f={})}function p(P,ee){if(P[0]==80&&P[1]==75)return me(P,ee);if((P[0]|32)==109&&(P[1]|32)==105)return tt(P,ee);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var W=3,K=512,q=0,ne=0,be=0,je=0,ke=0,Se=[],Ee=P.slice(0,512);Br(Ee,0);var Be=m(Ee);switch(W=Be[0],W){case 3:K=512;break;case 4:K=4096;break;case 0:if(Be[1]==0)return me(P,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}K!==512&&(Ee=P.slice(0,K),Br(Ee,28));var Ke=P.slice(0,K);g(Ee,W);var We=Ee.read_shift(4,"i");if(W===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);Ee.l+=4,be=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),je=Ee.read_shift(4,"i"),q=Ee.read_shift(4,"i"),ke=Ee.read_shift(4,"i"),ne=Ee.read_shift(4,"i");for(var Ue=-1,He=0;He<109&&(Ue=Ee.read_shift(4,"i"),!(Ue<0));++He)Se[He]=Ue;var mt=v(P,K);b(ke,ne,mt,K,Se);var Vt=N(mt,be,Se,K);Vt[be].name="!Directory",q>0&&je!==ue&&(Vt[je].name="!MiniFAT"),Vt[Se[0]].name="!FAT",Vt.fat_addrs=Se,Vt.ssz=K;var Wt={},mr=[],Ls=[],es=[];S(be,Vt,mt,mr,q,Wt,Ls,je),k(Ls,es,mr),mr.shift();var ca={FileIndex:Ls,FullPaths:es};return ee&&ee.raw&&(ca.raw={header:Ke,sectors:mt}),ca}function m(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(le,"Header Signature: "),P.l+=16;var ee=P.read_shift(2,"u");return[P.read_shift(2,"u"),ee]}function g(P,ee){var W=9;switch(P.l+=2,W=P.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function v(P,ee){for(var W=Math.ceil(P.length/ee)-1,K=[],q=1;q<W;++q)K[q-1]=P.slice(q*ee,(q+1)*ee);return K[W-1]=P.slice(W*ee),K}function k(P,ee,W){for(var K=0,q=0,ne=0,be=0,je=0,ke=W.length,Se=[],Ee=[];K<ke;++K)Se[K]=Ee[K]=K,ee[K]=W[K];for(;je<Ee.length;++je)K=Ee[je],q=P[K].L,ne=P[K].R,be=P[K].C,Se[K]===K&&(q!==-1&&Se[q]!==q&&(Se[K]=Se[q]),ne!==-1&&Se[ne]!==ne&&(Se[K]=Se[ne])),be!==-1&&(Se[be]=K),q!==-1&&K!=Se[K]&&(Se[q]=Se[K],Ee.lastIndexOf(q)<je&&Ee.push(q)),ne!==-1&&K!=Se[K]&&(Se[ne]=Se[K],Ee.lastIndexOf(ne)<je&&Ee.push(ne));for(K=1;K<ke;++K)Se[K]===K&&(ne!==-1&&Se[ne]!==ne?Se[K]=Se[ne]:q!==-1&&Se[q]!==q&&(Se[K]=Se[q]));for(K=1;K<ke;++K)if(P[K].type!==0){if(je=K,je!=Se[je])do je=Se[je],ee[K]=ee[je]+"/"+ee[K];while(je!==0&&Se[je]!==-1&&je!=Se[je]);Se[K]=-1}for(ee[0]+="/",K=1;K<ke;++K)P[K].type!==2&&(ee[K]+="/")}function w(P,ee,W){for(var K=P.start,q=P.size,ne=[],be=K;W&&q>0&&be>=0;)ne.push(ee.slice(be*Y,be*Y+Y)),q-=Y,be=eo(W,be*4);return ne.length===0?Nr(0):_s(ne).slice(0,P.size)}function b(P,ee,W,K,q){var ne=ue;if(P===ue){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var be=W[P],je=(K>>>2)-1;if(!be)return;for(var ke=0;ke<je&&(ne=eo(be,ke*4))!==ue;++ke)q.push(ne);b(eo(be,K-4),ee-1,W,K,q)}}function E(P,ee,W,K,q){var ne=[],be=[];q||(q=[]);var je=K-1,ke=0,Se=0;for(ke=ee;ke>=0;){q[ke]=!0,ne[ne.length]=ke,be.push(P[ke]);var Ee=W[Math.floor(ke*4/K)];if(Se=ke*4&je,K<4+Se)throw new Error("FAT boundary crossed: "+ke+" 4 "+K);if(!P[Ee])break;ke=eo(P[Ee],Se)}return{nodes:ne,data:ag([be])}}function N(P,ee,W,K){var q=P.length,ne=[],be=[],je=[],ke=[],Se=K-1,Ee=0,Be=0,Ke=0,We=0;for(Ee=0;Ee<q;++Ee)if(je=[],Ke=Ee+ee,Ke>=q&&(Ke-=q),!be[Ke]){ke=[];var Ue=[];for(Be=Ke;Be>=0;){Ue[Be]=!0,be[Be]=!0,je[je.length]=Be,ke.push(P[Be]);var He=W[Math.floor(Be*4/K)];if(We=Be*4&Se,K<4+We)throw new Error("FAT boundary crossed: "+Be+" 4 "+K);if(!P[He]||(Be=eo(P[He],We),Ue[Be]))break}ne[Ke]={nodes:je,data:ag([ke])}}return ne}function S(P,ee,W,K,q,ne,be,je){for(var ke=0,Se=K.length?2:0,Ee=ee[P].data,Be=0,Ke=0,We;Be<Ee.length;Be+=128){var Ue=Ee.slice(Be,Be+128);Br(Ue,64),Ke=Ue.read_shift(2),We=dp(Ue,0,Ke-Se),K.push(We);var He={name:We,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},mt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);mt!==0&&(He.ct=z(Ue,Ue.l-8));var Vt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Vt!==0&&(He.mt=z(Ue,Ue.l-8)),He.start=Ue.read_shift(4,"i"),He.size=Ue.read_shift(4,"i"),He.size<0&&He.start<0&&(He.size=He.type=0,He.start=ue,He.name=""),He.type===5?(ke=He.start,q>0&&ke!==ue&&(ee[ke].name="!StreamData")):He.size>=4096?(He.storage="fat",ee[He.start]===void 0&&(ee[He.start]=E(W,He.start,ee.fat_addrs,ee.ssz)),ee[He.start].name=He.name,He.content=ee[He.start].data.slice(0,He.size)):(He.storage="minifat",He.size<0?He.size=0:ke!==ue&&He.start!==ue&&ee[ke]&&(He.content=w(He,ee[ke].data,(ee[je]||{}).data))),He.content&&Br(He.content,0),ne[We]=He,be.push(He)}}function z(P,ee){return new Date((Sn(P,ee+4)/1e7*Math.pow(2,32)+Sn(P,ee)/1e7-11644473600)*1e3)}function te(P,ee){return h(),p(f.readFileSync(P),ee)}function V(P,ee){var W=ee&&ee.type;switch(W||Tt&&Buffer.isBuffer(P)&&(W="buffer"),W||"base64"){case"file":return te(P,ee);case"base64":return p(ra(Tn(P)),ee);case"binary":return p(ra(P),ee)}return p(P,ee)}function D(P,ee){var W=ee||{},K=W.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=K+"/",P.FileIndex[0]={name:K,type:5}),W.CLSID&&(P.FileIndex[0].clsid=W.CLSID),H(P)}function H(P){var ee="Sh33tJ5";if(!jt.find(P,"/"+ee)){var W=Nr(4);W[0]=55,W[1]=W[3]=50,W[2]=54,P.FileIndex.push({name:ee,type:2,content:W,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+ee),L(P)}}function L(P,ee){D(P);for(var W=!1,K=!1,q=P.FullPaths.length-1;q>=0;--q){var ne=P.FileIndex[q];switch(ne.type){case 0:K?W=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(ne.R*ne.L*ne.C)&&(W=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!ee)){var be=new Date(1987,1,19),je=0,ke=Object.create?Object.create(null):{},Se=[];for(q=0;q<P.FullPaths.length;++q)ke[P.FullPaths[q]]=!0,P.FileIndex[q].type!==0&&Se.push([P.FullPaths[q],P.FileIndex[q]]);for(q=0;q<Se.length;++q){var Ee=r(Se[q][0]);K=ke[Ee],K||(Se.push([Ee,{name:a(Ee).replace("/",""),type:1,clsid:pe,ct:be,mt:be,content:null}]),ke[Ee]=!0)}for(Se.sort(function(We,Ue){return t(We[0],Ue[0])}),P.FullPaths=[],P.FileIndex=[],q=0;q<Se.length;++q)P.FullPaths[q]=Se[q][0],P.FileIndex[q]=Se[q][1];for(q=0;q<Se.length;++q){var Be=P.FileIndex[q],Ke=P.FullPaths[q];if(Be.name=a(Ke).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||pe,q===0)Be.C=Se.length>1?1:-1,Be.size=0,Be.type=5;else if(Ke.slice(-1)=="/"){for(je=q+1;je<Se.length&&r(P.FullPaths[je])!=Ke;++je);for(Be.C=je>=Se.length?-1:je,je=q+1;je<Se.length&&r(P.FullPaths[je])!=r(Ke);++je);Be.R=je>=Se.length?-1:je,Be.type=1}else r(P.FullPaths[q+1]||"")==r(Ke)&&(Be.R=q+1),Be.type=2}}}function ae(P,ee){var W=ee||{};if(W.fileType=="mad")return ct(P,W);switch(L(P),W.fileType){case"zip":return Ae(P,W)}var K=(function(We){for(var Ue=0,He=0,mt=0;mt<We.FileIndex.length;++mt){var Vt=We.FileIndex[mt];if(Vt.content){var Wt=Vt.content.length;Wt>0&&(Wt<4096?Ue+=Wt+63>>6:He+=Wt+511>>9)}}for(var mr=We.FullPaths.length+3>>2,Ls=Ue+7>>3,es=Ue+127>>7,ca=Ls+He+mr+es,jr=ca+127>>7,wi=jr<=109?0:Math.ceil((jr-109)/127);ca+jr+wi+127>>7>jr;)wi=++jr<=109?0:Math.ceil((jr-109)/127);var gr=[1,wi,jr,es,mr,He,Ue,0];return We.FileIndex[0].size=Ue<<6,gr[7]=(We.FileIndex[0].start=gr[0]+gr[1]+gr[2]+gr[3]+gr[4]+gr[5])+(gr[6]+7>>3),gr})(P),q=Nr(K[7]<<9),ne=0,be=0;{for(ne=0;ne<8;++ne)q.write_shift(1,oe[ne]);for(ne=0;ne<8;++ne)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),ne=0;ne<3;++ne)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,K[2]),q.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:ue),q.write_shift(4,K[3]),q.write_shift(-4,K[1]?K[0]-1:ue),q.write_shift(4,K[1]),ne=0;ne<109;++ne)q.write_shift(-4,ne<K[2]?K[1]+ne:-1)}if(K[1])for(be=0;be<K[1];++be){for(;ne<236+be*127;++ne)q.write_shift(-4,ne<K[2]?K[1]+ne:-1);q.write_shift(-4,be===K[1]-1?ue:be+1)}var je=function(We){for(be+=We;ne<be-1;++ne)q.write_shift(-4,ne+1);We&&(++ne,q.write_shift(-4,ue))};for(be=ne=0,be+=K[1];ne<be;++ne)q.write_shift(-4,G.DIFSECT);for(be+=K[2];ne<be;++ne)q.write_shift(-4,G.FATSECT);je(K[3]),je(K[4]);for(var ke=0,Se=0,Ee=P.FileIndex[0];ke<P.FileIndex.length;++ke)Ee=P.FileIndex[ke],Ee.content&&(Se=Ee.content.length,!(Se<4096)&&(Ee.start=be,je(Se+511>>9)));for(je(K[6]+7>>3);q.l&511;)q.write_shift(-4,G.ENDOFCHAIN);for(be=ne=0,ke=0;ke<P.FileIndex.length;++ke)Ee=P.FileIndex[ke],Ee.content&&(Se=Ee.content.length,!(!Se||Se>=4096)&&(Ee.start=be,je(Se+63>>6)));for(;q.l&511;)q.write_shift(-4,G.ENDOFCHAIN);for(ne=0;ne<K[4]<<2;++ne){var Be=P.FullPaths[ne];if(!Be||Be.length===0){for(ke=0;ke<17;++ke)q.write_shift(4,0);for(ke=0;ke<3;++ke)q.write_shift(4,-1);for(ke=0;ke<12;++ke)q.write_shift(4,0);continue}Ee=P.FileIndex[ne],ne===0&&(Ee.start=Ee.size?Ee.start-1:ue);var Ke=ne===0&&W.root||Ee.name;if(Se=2*(Ke.length+1),q.write_shift(64,Ke,"utf16le"),q.write_shift(2,Se),q.write_shift(1,Ee.type),q.write_shift(1,Ee.color),q.write_shift(-4,Ee.L),q.write_shift(-4,Ee.R),q.write_shift(-4,Ee.C),Ee.clsid)q.write_shift(16,Ee.clsid,"hex");else for(ke=0;ke<4;++ke)q.write_shift(4,0);q.write_shift(4,Ee.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,Ee.start),q.write_shift(4,Ee.size),q.write_shift(4,0)}for(ne=1;ne<P.FileIndex.length;++ne)if(Ee=P.FileIndex[ne],Ee.size>=4096)if(q.l=Ee.start+1<<9,Tt&&Buffer.isBuffer(Ee.content))Ee.content.copy(q,q.l,0,Ee.size),q.l+=Ee.size+511&-512;else{for(ke=0;ke<Ee.size;++ke)q.write_shift(1,Ee.content[ke]);for(;ke&511;++ke)q.write_shift(1,0)}for(ne=1;ne<P.FileIndex.length;++ne)if(Ee=P.FileIndex[ne],Ee.size>0&&Ee.size<4096)if(Tt&&Buffer.isBuffer(Ee.content))Ee.content.copy(q,q.l,0,Ee.size),q.l+=Ee.size+63&-64;else{for(ke=0;ke<Ee.size;++ke)q.write_shift(1,Ee.content[ke]);for(;ke&63;++ke)q.write_shift(1,0)}if(Tt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function Q(P,ee){var W=P.FullPaths.map(function(ke){return ke.toUpperCase()}),K=W.map(function(ke){var Se=ke.split("/");return Se[Se.length-(ke.slice(-1)=="/"?2:1)]}),q=!1;ee.charCodeAt(0)===47?(q=!0,ee=W[0].slice(0,-1)+ee):q=ee.indexOf("/")!==-1;var ne=ee.toUpperCase(),be=q===!0?W.indexOf(ne):K.indexOf(ne);if(be!==-1)return P.FileIndex[be];var je=!ne.match(sl);for(ne=ne.replace(dn,""),je&&(ne=ne.replace(sl,"!")),be=0;be<W.length;++be)if((je?W[be].replace(sl,"!"):W[be]).replace(dn,"")==ne||(je?K[be].replace(sl,"!"):K[be]).replace(dn,"")==ne)return P.FileIndex[be];return null}var Y=64,ue=-2,le="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(P,ee,W){h();var K=ae(P,W);f.writeFileSync(ee,K)}function B(P){for(var ee=new Array(P.length),W=0;W<P.length;++W)ee[W]=String.fromCharCode(P[W]);return ee.join("")}function de(P,ee){var W=ae(P,ee);switch(ee&&ee.type||"buffer"){case"file":return h(),f.writeFileSync(ee.filename,W),W;case"binary":return typeof W=="string"?W:B(W);case"base64":return Bm(typeof W=="string"?W:B(W));case"buffer":if(Tt)return Buffer.isBuffer(W)?W:vo(W);case"array":return typeof W=="string"?ra(W):W}return W}var I;function j(P){try{var ee=P.InflateRaw,W=new ee;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)I=P;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function re(P,ee){if(!I)return Ie(P,ee);var W=I.InflateRaw,K=new W,q=K._processChunk(P.slice(P.l),K._finishFlushFlag);return P.l+=K.bytesRead,q}function T(P){return I?I.deflateRawSync(P):ut(P)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(P){var ee=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var Z=typeof Uint8Array<"u",U=Z?new Uint8Array(256):[],xe=0;xe<256;++xe)U[xe]=J(xe);function M(P,ee){var W=U[P&255];return ee<=8?W>>>8-ee:(W=W<<8|U[P>>8&255],ee<=16?W>>>16-ee:(W=W<<8|U[P>>16&255],W>>>24-ee))}function ve(P,ee){var W=ee&7,K=ee>>>3;return(P[K]|(W<=6?0:P[K+1]<<8))>>>W&3}function ye(P,ee){var W=ee&7,K=ee>>>3;return(P[K]|(W<=5?0:P[K+1]<<8))>>>W&7}function Me(P,ee){var W=ee&7,K=ee>>>3;return(P[K]|(W<=4?0:P[K+1]<<8))>>>W&15}function Pe(P,ee){var W=ee&7,K=ee>>>3;return(P[K]|(W<=3?0:P[K+1]<<8))>>>W&31}function ce(P,ee){var W=ee&7,K=ee>>>3;return(P[K]|(W<=1?0:P[K+1]<<8))>>>W&127}function Fe(P,ee,W){var K=ee&7,q=ee>>>3,ne=(1<<W)-1,be=P[q]>>>K;return W<8-K||(be|=P[q+1]<<8-K,W<16-K)||(be|=P[q+2]<<16-K,W<24-K)||(be|=P[q+3]<<24-K),be&ne}function Re(P,ee,W){var K=ee&7,q=ee>>>3;return K<=5?P[q]|=(W&7)<<K:(P[q]|=W<<K&255,P[q+1]=(W&7)>>8-K),ee+3}function De(P,ee,W){var K=ee&7,q=ee>>>3;return W=(W&1)<<K,P[q]|=W,ee+1}function lt(P,ee,W){var K=ee&7,q=ee>>>3;return W<<=K,P[q]|=W&255,W>>>=8,P[q+1]=W,ee+8}function ft(P,ee,W){var K=ee&7,q=ee>>>3;return W<<=K,P[q]|=W&255,W>>>=8,P[q+1]=W&255,P[q+2]=W>>>8,ee+16}function gt(P,ee){var W=P.length,K=2*W>ee?2*W:ee+5,q=0;if(W>=ee)return P;if(Tt){var ne=Wm(K);if(P.copy)P.copy(ne);else for(;q<P.length;++q)ne[q]=P[q];return ne}else if(Z){var be=new Uint8Array(K);if(be.set)be.set(P);else for(;q<W;++q)be[q]=P[q];return be}return P.length=K,P}function Nt(P){for(var ee=new Array(P),W=0;W<P;++W)ee[W]=0;return ee}function zt(P,ee,W){var K=1,q=0,ne=0,be=0,je=0,ke=P.length,Se=Z?new Uint16Array(32):Nt(32);for(ne=0;ne<32;++ne)Se[ne]=0;for(ne=ke;ne<W;++ne)P[ne]=0;ke=P.length;var Ee=Z?new Uint16Array(ke):Nt(ke);for(ne=0;ne<ke;++ne)Se[q=P[ne]]++,K<q&&(K=q),Ee[ne]=0;for(Se[0]=0,ne=1;ne<=K;++ne)Se[ne+16]=je=je+Se[ne-1]<<1;for(ne=0;ne<ke;++ne)je=P[ne],je!=0&&(Ee[ne]=Se[je+16]++);var Be=0;for(ne=0;ne<ke;++ne)if(Be=P[ne],Be!=0)for(je=M(Ee[ne],K)>>K-Be,be=(1<<K+4-Be)-1;be>=0;--be)ee[je|be<<Be]=Be&15|ne<<4;return K}var Qt=Z?new Uint16Array(512):Nt(512),qt=Z?new Uint16Array(32):Nt(32);if(!Z){for(var Bt=0;Bt<512;++Bt)Qt[Bt]=0;for(Bt=0;Bt<32;++Bt)qt[Bt]=0}(function(){for(var P=[],ee=0;ee<32;ee++)P.push(5);zt(P,qt,32);var W=[];for(ee=0;ee<=143;ee++)W.push(8);for(;ee<=255;ee++)W.push(9);for(;ee<=279;ee++)W.push(7);for(;ee<=287;ee++)W.push(8);zt(W,Qt,288)})();var rr=(function(){for(var ee=Z?new Uint8Array(32768):[],W=0,K=0;W<R.length-1;++W)for(;K<R[W+1];++K)ee[K]=W;for(;K<32768;++K)ee[K]=29;var q=Z?new Uint8Array(259):[];for(W=0,K=0;W<O.length-1;++W)for(;K<O[W+1];++K)q[K]=W;function ne(je,ke){for(var Se=0;Se<je.length;){var Ee=Math.min(65535,je.length-Se),Be=Se+Ee==je.length;for(ke.write_shift(1,+Be),ke.write_shift(2,Ee),ke.write_shift(2,~Ee&65535);Ee-- >0;)ke[ke.l++]=je[Se++]}return ke.l}function be(je,ke){for(var Se=0,Ee=0,Be=Z?new Uint16Array(32768):[];Ee<je.length;){var Ke=Math.min(65535,je.length-Ee);if(Ke<10){for(Se=Re(ke,Se,+(Ee+Ke==je.length)),Se&7&&(Se+=8-(Se&7)),ke.l=Se/8|0,ke.write_shift(2,Ke),ke.write_shift(2,~Ke&65535);Ke-- >0;)ke[ke.l++]=je[Ee++];Se=ke.l*8;continue}Se=Re(ke,Se,+(Ee+Ke==je.length)+2);for(var We=0;Ke-- >0;){var Ue=je[Ee];We=(We<<5^Ue)&32767;var He=-1,mt=0;if((He=Be[We])&&(He|=Ee&-32768,He>Ee&&(He-=32768),He<Ee))for(;je[He+mt]==je[Ee+mt]&&mt<250;)++mt;if(mt>2){Ue=q[mt],Ue<=22?Se=lt(ke,Se,U[Ue+1]>>1)-1:(lt(ke,Se,3),Se+=5,lt(ke,Se,U[Ue-23]>>5),Se+=3);var Vt=Ue<8?0:Ue-4>>2;Vt>0&&(ft(ke,Se,mt-O[Ue]),Se+=Vt),Ue=ee[Ee-He],Se=lt(ke,Se,U[Ue]>>3),Se-=3;var Wt=Ue<4?0:Ue-2>>1;Wt>0&&(ft(ke,Se,Ee-He-R[Ue]),Se+=Wt);for(var mr=0;mr<mt;++mr)Be[We]=Ee&32767,We=(We<<5^je[Ee])&32767,++Ee;Ke-=mt-1}else Ue<=143?Ue=Ue+48:Se=De(ke,Se,1),Se=lt(ke,Se,U[Ue]),Be[We]=Ee&32767,++Ee}Se=lt(ke,Se,0)-1}return ke.l=(Se+7)/8|0,ke.l}return function(ke,Se){return ke.length<8?ne(ke,Se):be(ke,Se)}})();function ut(P){var ee=Nr(50+Math.floor(P.length*1.1)),W=rr(P,ee);return ee.slice(0,W)}var _t=Z?new Uint16Array(32768):Nt(32768),Ht=Z?new Uint16Array(32768):Nt(32768),Dt=Z?new Uint16Array(128):Nt(128),Zt=1,$t=1;function he(P,ee){var W=Pe(P,ee)+257;ee+=5;var K=Pe(P,ee)+1;ee+=5;var q=Me(P,ee)+4;ee+=4;for(var ne=0,be=Z?new Uint8Array(19):Nt(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,Se=Z?new Uint8Array(8):Nt(8),Ee=Z?new Uint8Array(8):Nt(8),Be=be.length,Ke=0;Ke<q;++Ke)be[F[Ke]]=ne=ye(P,ee),ke<ne&&(ke=ne),Se[ne]++,ee+=3;var We=0;for(Se[0]=0,Ke=1;Ke<=ke;++Ke)Ee[Ke]=We=We+Se[Ke-1]<<1;for(Ke=0;Ke<Be;++Ke)(We=be[Ke])!=0&&(je[Ke]=Ee[We]++);var Ue=0;for(Ke=0;Ke<Be;++Ke)if(Ue=be[Ke],Ue!=0){We=U[je[Ke]]>>8-Ue;for(var He=(1<<7-Ue)-1;He>=0;--He)Dt[We|He<<Ue]=Ue&7|Ke<<3}var mt=[];for(ke=1;mt.length<W+K;)switch(We=Dt[ce(P,ee)],ee+=We&7,We>>>=3){case 16:for(ne=3+ve(P,ee),ee+=2,We=mt[mt.length-1];ne-- >0;)mt.push(We);break;case 17:for(ne=3+ye(P,ee),ee+=3;ne-- >0;)mt.push(0);break;case 18:for(ne=11+ce(P,ee),ee+=7;ne-- >0;)mt.push(0);break;default:mt.push(We),ke<We&&(ke=We);break}var Vt=mt.slice(0,W),Wt=mt.slice(W);for(Ke=W;Ke<286;++Ke)Vt[Ke]=0;for(Ke=K;Ke<30;++Ke)Wt[Ke]=0;return Zt=zt(Vt,_t,286),$t=zt(Wt,Ht,30),ee}function Oe(P,ee){if(P[0]==3&&!(P[1]&3))return[js(ee),2];for(var W=0,K=0,q=Wm(ee||1<<18),ne=0,be=q.length>>>0,je=0,ke=0;(K&1)==0;){if(K=ye(P,W),W+=3,K>>>1)K>>1==1?(je=9,ke=5):(W=he(P,W),je=Zt,ke=$t);else{W&7&&(W+=8-(W&7));var Se=P[W>>>3]|P[(W>>>3)+1]<<8;if(W+=32,Se>0)for(!ee&&be<ne+Se&&(q=gt(q,ne+Se),be=q.length);Se-- >0;)q[ne++]=P[W>>>3],W+=8;continue}for(;;){!ee&&be<ne+32767&&(q=gt(q,ne+32767),be=q.length);var Ee=Fe(P,W,je),Be=K>>>1==1?Qt[Ee]:_t[Ee];if(W+=Be&15,Be>>>=4,(Be>>>8&255)===0)q[ne++]=Be;else{if(Be==256)break;Be-=257;var Ke=Be<8?0:Be-4>>2;Ke>5&&(Ke=0);var We=ne+O[Be];Ke>0&&(We+=Fe(P,W,Ke),W+=Ke),Ee=Fe(P,W,ke),Be=K>>>1==1?qt[Ee]:Ht[Ee],W+=Be&15,Be>>>=4;var Ue=Be<4?0:Be-2>>1,He=R[Be];for(Ue>0&&(He+=Fe(P,W,Ue),W+=Ue),!ee&&be<We&&(q=gt(q,We+100),be=q.length);ne<We;)q[ne]=q[ne-He],++ne}}}return ee?[q,W+7>>>3]:[q.slice(0,ne),W+7>>>3]}function Ie(P,ee){var W=P.slice(P.l||0),K=Oe(W,ee);return P.l+=K[1],K[0]}function X(P,ee){if(P)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function me(P,ee){var W=P;Br(W,0);var K=[],q=[],ne={FileIndex:K,FullPaths:q};D(ne,{root:ee.root});for(var be=W.length-4;(W[be]!=80||W[be+1]!=75||W[be+2]!=5||W[be+3]!=6)&&be>=0;)--be;W.l=be+4,W.l+=4;var je=W.read_shift(2);W.l+=6;var ke=W.read_shift(4);for(W.l=ke,be=0;be<je;++be){W.l+=20;var Se=W.read_shift(4),Ee=W.read_shift(4),Be=W.read_shift(2),Ke=W.read_shift(2),We=W.read_shift(2);W.l+=8;var Ue=W.read_shift(4),He=c(W.slice(W.l+Be,W.l+Be+Ke));W.l+=Be+Ke+We;var mt=W.l;W.l=Ue+4,Ne(W,Se,Ee,ne,He),W.l=mt}return ne}function Ne(P,ee,W,K,q){P.l+=2;var ne=P.read_shift(2),be=P.read_shift(2),je=l(P);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var ke=P.read_shift(4),Se=P.read_shift(4),Ee=P.read_shift(4),Be=P.read_shift(2),Ke=P.read_shift(2),We="",Ue=0;Ue<Be;++Ue)We+=String.fromCharCode(P[P.l++]);if(Ke){var He=c(P.slice(P.l,P.l+Ke));(He[21589]||{}).mt&&(je=He[21589].mt),((q||{})[21589]||{}).mt&&(je=q[21589].mt)}P.l+=Ke;var mt=P.slice(P.l,P.l+Se);switch(be){case 8:mt=re(P,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+be)}var Vt=!1;ne&8&&(ke=P.read_shift(4),ke==134695760&&(ke=P.read_shift(4),Vt=!0),Se=P.read_shift(4),Ee=P.read_shift(4)),Se!=ee&&X(Vt,"Bad compressed size: "+ee+" != "+Se),Ee!=W&&X(Vt,"Bad uncompressed size: "+W+" != "+Ee),Ge(K,We,mt,{unsafe:!0,mt:je})}function Ae(P,ee){var W=ee||{},K=[],q=[],ne=Nr(1),be=W.compression?8:0,je=0,ke=0,Se=0,Ee=0,Be=0,Ke=P.FullPaths[0],We=Ke,Ue=P.FileIndex[0],He=[],mt=0;for(ke=1;ke<P.FullPaths.length;++ke)if(We=P.FullPaths[ke].slice(Ke.length),Ue=P.FileIndex[ke],!(!Ue.size||!Ue.content||We=="Sh33tJ5")){var Vt=Ee,Wt=Nr(We.length);for(Se=0;Se<We.length;++Se)Wt.write_shift(1,We.charCodeAt(Se)&127);Wt=Wt.slice(0,Wt.l),He[Be]=db.buf(Ue.content,0);var mr=Ue.content;be==8&&(mr=T(mr)),ne=Nr(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,je),ne.write_shift(2,be),Ue.mt?o(ne,Ue.mt):ne.write_shift(4,0),ne.write_shift(-4,He[Be]),ne.write_shift(4,mr.length),ne.write_shift(4,Ue.content.length),ne.write_shift(2,Wt.length),ne.write_shift(2,0),Ee+=ne.length,K.push(ne),Ee+=Wt.length,K.push(Wt),Ee+=mr.length,K.push(mr),ne=Nr(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,je),ne.write_shift(2,be),ne.write_shift(4,0),ne.write_shift(-4,He[Be]),ne.write_shift(4,mr.length),ne.write_shift(4,Ue.content.length),ne.write_shift(2,Wt.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,Vt),mt+=ne.l,q.push(ne),mt+=Wt.length,q.push(Wt),++Be}return ne=Nr(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,Be),ne.write_shift(2,Be),ne.write_shift(4,mt),ne.write_shift(4,Ee),ne.write_shift(2,0),_s([_s(K),_s(q),ne])}var et={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function at(P,ee){if(P.ctype)return P.ctype;var W=P.name||"",K=W.match(/\.([^\.]+)$/);return K&&et[K[1]]||ee&&(K=(W=ee).match(/[\.\\]([^\.\\])+$/),K&&et[K[1]])?et[K[1]]:"application/octet-stream"}function dt(P){for(var ee=Bm(P),W=[],K=0;K<ee.length;K+=76)W.push(ee.slice(K,K+76));return W.join(`\r
`)+`\r
`}function Et(P){var ee=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var Ee=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],K=ee.split(`\r
`),q=0;q<K.length;++q){var ne=K[q];if(ne.length==0){W.push("");continue}for(var be=0;be<ne.length;){var je=76,ke=ne.slice(be,be+je);ke.charAt(je-1)=="="?je--:ke.charAt(je-2)=="="?je-=2:ke.charAt(je-3)=="="&&(je-=3),ke=ne.slice(be,be+je),be+=je,be<ne.length&&(ke+="="),W.push(ke)}}return W.join(`\r
`)}function qe(P){for(var ee=[],W=0;W<P.length;++W){for(var K=P[W];W<=P.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+P[++W];ee.push(K)}for(var q=0;q<ee.length;++q)ee[q]=ee[q].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return ra(ee.join(`\r
`))}function Ze(P,ee,W){for(var K="",q="",ne="",be,je=0;je<10;++je){var ke=ee[je];if(!ke||ke.match(/^\s*$/))break;var Se=ke.match(/^(.*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":K=Se[2].trim();break;case"content-type":ne=Se[2].trim();break;case"content-transfer-encoding":q=Se[2].trim();break}}switch(++je,q.toLowerCase()){case"base64":be=ra(Tn(ee.slice(je).join("")));break;case"quoted-printable":be=qe(ee.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var Ee=Ge(P,K.slice(W.length),be,{unsafe:!0});ne&&(Ee.ctype=ne)}function tt(P,ee){if(B(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=ee&&ee.root||"",K=(Tt&&Buffer.isBuffer(P)?P.toString("binary"):B(P)).split(`\r
`),q=0,ne="";for(q=0;q<K.length;++q)if(ne=K[q],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),W||(W=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),ne.slice(0,W.length)!=W););var be=(K[1]||"").match(/boundary="(.*?)"/);if(!be)throw new Error("MAD cannot find boundary");var je="--"+(be[1]||""),ke=[],Se=[],Ee={FileIndex:ke,FullPaths:Se};D(Ee);var Be,Ke=0;for(q=0;q<K.length;++q){var We=K[q];We!==je&&We!==je+"--"||(Ke++&&Ze(Ee,K.slice(Be,q),W),Be=q)}return Ee}function ct(P,ee){var W=ee||{},K=W.boundary||"SheetJS";K="------="+K;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],ne=P.FullPaths[0],be=ne,je=P.FileIndex[0],ke=1;ke<P.FullPaths.length;++ke)if(be=P.FullPaths[ke].slice(ne.length),je=P.FileIndex[ke],!(!je.size||!je.content||be=="Sh33tJ5")){be=be.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var Se=je.content,Ee=Tt&&Buffer.isBuffer(Se)?Se.toString("binary"):B(Se),Be=0,Ke=Math.min(1024,Ee.length),We=0,Ue=0;Ue<=Ke;++Ue)(We=Ee.charCodeAt(Ue))>=32&&We<128&&++Be;var He=Be>=Ke*4/5;q.push(K),q.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+be),q.push("Content-Transfer-Encoding: "+(He?"quoted-printable":"base64")),q.push("Content-Type: "+at(je,be)),q.push(""),q.push(He?Et(Ee):dt(Ee))}return q.push(K+`--\r
`),q.join(`\r
`)}function Ve(P){var ee={};return D(ee,P),ee}function Ge(P,ee,W,K){var q=K&&K.unsafe;q||D(P);var ne=!q&&jt.find(P,ee);if(!ne){var be=P.FullPaths[0];ee.slice(0,be.length)==be?be=ee:(be.slice(-1)!="/"&&(be+="/"),be=(be+ee).replace("//","/")),ne={name:a(ee),type:2},P.FileIndex.push(ne),P.FullPaths.push(be),q||jt.utils.cfb_gc(P)}return ne.content=W,ne.size=W?W.length:0,K&&(K.CLSID&&(ne.clsid=K.CLSID),K.mt&&(ne.mt=K.mt),K.ct&&(ne.ct=K.ct)),ne}function pt(P,ee){D(P);var W=jt.find(P,ee);if(W){for(var K=0;K<P.FileIndex.length;++K)if(P.FileIndex[K]==W)return P.FileIndex.splice(K,1),P.FullPaths.splice(K,1),!0}return!1}function Ft(P,ee,W){D(P);var K=jt.find(P,ee);if(K){for(var q=0;q<P.FileIndex.length;++q)if(P.FileIndex[q]==K)return P.FileIndex[q].name=a(W),P.FullPaths[q]=W,!0}return!1}function Yt(P){L(P,!0)}return n.find=Q,n.read=V,n.parse=p,n.write=de,n.writeFile=ie,n.utils={cfb_new:Ve,cfb_add:Ge,cfb_del:pt,cfb_mov:Ft,cfb_gc:Yt,ReadShift:ul,CheckField:C1,prep_blob:Br,bconcat:_s,use_zlib:j,_deflateRaw:ut,_inflateRaw:Ie,consts:G},n})();function fb(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ta(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function ip(e){for(var n=[],t=Ta(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var Cu=new Date(1899,11,30,0,0,0);function fn(e,n){var t=e.getTime(),r=Cu.getTime()+(e.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var s1=new Date,pb=Cu.getTime()+(s1.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4,Xm=s1.getTimezoneOffset();function Xu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+pb),n.getTimezoneOffset()!==Xm&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Xm)*6e4),n}function hb(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var Qm=new Date("2017-02-19T19:06:09.000Z"),o1=isNaN(Qm.getFullYear())?new Date("2/19/17"):Qm,xb=o1.getFullYear()==2017;function Mr(e,n){var t=new Date(e);if(xb)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(o1.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function fo(e,n){if(Tt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return il(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return il(Vv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return il(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return il(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=Ur(e[t]));return n}function pr(e,n){for(var t="";t.length<n;)t+=e;return t}function sa(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var mb=["january","february","march","april","may","june","july","august","september","october","november","december"];function li(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&mb.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var gb=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function i1(e){return e?e.content&&e.type?fo(e.content,!0):e.data?al(e.data):e.asNodeBuffer&&Tt?al(e.asNodeBuffer().toString("binary")):e.asBinary?al(e.asBinary()):e._data&&e._data.getContent?al(fo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function l1(e){if(!e)return null;if(e.data)return zm(e.data);if(e.asNodeBuffer&&Tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?zm(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function vb(e){return e&&e.name.slice(-4)===".bin"?l1(e):i1(e)}function zn(e,n){for(var t=e.FullPaths||Ta(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function lp(e,n){var t=zn(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function Sr(e,n,t){if(!t)return vb(lp(e,n));if(!n)return null;try{return Sr(e,n)}catch{return null}}function En(e,n,t){if(!t)return i1(lp(e,n));if(!n)return null;try{return En(e,n)}catch{return null}}function yb(e,n,t){return l1(lp(e,n))}function qm(e){for(var n=e.FullPaths||Ta(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function wb(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return Tt?r=vo(t):r=L2(t),jt.utils.cfb_add(e,n,r)}jt.utils.cfb_add(e,n,t)}else e.file(n,t)}function c1(e,n){switch(n.type){case"base64":return jt.read(e,{type:"base64"});case"binary":return jt.read(e,{type:"binary"});case"buffer":case"array":return jt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ol(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var u1=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kb=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Zm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,bb=/<[^>]*>/g,en=u1.match(Zm)?Zm:bb,_b=/<\w*:/,Sb=/<(\/?)\w+:/;function vt(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(kb),c=0,f="",h=0,p="",m="",g=1;if(l)for(h=0;h!=l.length;++h){for(m=l[h],o=0;o!=m.length&&m.charCodeAt(o)!==61;++o);for(p=m.slice(0,o).trim();m.charCodeAt(o+1)==32;)++o;for(g=(a=m.charCodeAt(o+1))==34||a==39?1:0,f=m.slice(o+1+g,m.length-g),c=0;c!=p.length&&p.charCodeAt(c)!==58;++c);if(c===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=f,r[p.toLowerCase()]=f;else{var v=(c===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(c+1);if(r[v]&&p.slice(c-3,c)=="ext")continue;r[v]=f,r[v.toLowerCase()]=f}}return r}function Da(e){return e.replace(Sb,"<$1")}var d1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Eb=ip(d1),Mt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return d1[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),Cb=/[&<>'"]/g,Tb=/[\u0000-\u001f]/g;function cp(e){var n=e+"";return n.replace(Cb,function(t){return Eb[t]}).replace(/\n/g,"<br/>").replace(Tb,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Jm=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function or(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Z0(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function eg(e){var n=js(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function tg(e){return vo(e,"binary").toString("utf8")}var eu="foo bar baz",tr=Tt&&(tg(eu)==Z0(eu)&&tg||eg(eu)==Z0(eu)&&eg)||Z0,il=Tt?function(e){return vo(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},bl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),f1=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),Nb=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),Db=/<\/?(?:vt:)?variant>/g,Fb=/<(?:vt:)([^>]*)>([\s\S]*)</;function rg(e,n){var t=vt(e),r=e.match(Nb(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(Db,"").match(Fb);l&&a.push({v:tr(l[2]),t:l[1]})}),a}var jb=/(^\s|\s$|\n)/;function Ab(e){return Ta(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function Pb(e,n,t){return"<"+e+(t!=null?Ab(t):"")+(n!=null?(n.match(jb)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function up(e){if(Tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return tr(yo(ap(e)));throw new Error("Bad input format: expected Buffer or string")}var _l=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ob={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Rb=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Mb(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function Ib(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var ng=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},ag=Tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:vo(n)})):ng(e)}:ng,sg=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(Ha(e,a)));return r.join("").replace(dn,"")},dp=Tt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(dn,""):sg(e,n,t)}:sg,og=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},p1=Tt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):og(e,n,t)}:og,ig=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Zo(e,a)));return r.join("")},Pl=Tt?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):ig(n,t,r)}:ig,h1=function(e,n){var t=Sn(e,n);return t>0?Pl(e,n+4,n+4+t-1):""},x1=h1,m1=function(e,n){var t=Sn(e,n);return t>0?Pl(e,n+4,n+4+t-1):""},g1=m1,v1=function(e,n){var t=2*Sn(e,n);return t>0?Pl(e,n+4,n+4+t-1):""},y1=v1,w1=function(n,t){var r=Sn(n,t);return r>0?dp(n,t+4,t+4+r):""},k1=w1,b1=function(e,n){var t=Sn(e,n);return t>0?Pl(e,n+4,n+4+t):""},_1=b1,S1=function(e,n){return Mb(e,n)},Tu=S1,E1=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Tt&&(x1=function(n,t){if(!Buffer.isBuffer(n))return h1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},g1=function(n,t){if(!Buffer.isBuffer(n))return m1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},y1=function(n,t){if(!Buffer.isBuffer(n))return v1(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},k1=function(n,t){if(!Buffer.isBuffer(n))return w1(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},_1=function(n,t){if(!Buffer.isBuffer(n))return b1(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Tu=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):S1(n,t)},E1=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Zo=function(e,n){return e[n]},Ha=function(e,n){return e[n+1]*256+e[n]},zb=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},Sn=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},eo=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},Lb=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ul(e,n){var t="",r,a,o=[],l,c,f,h;switch(n){case"dbcs":if(h=this.l,Tt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(Ha(this,h)),h+=2;e*=2;break;case"utf8":t=Pl(this,this.l,this.l+e);break;case"utf16le":e*=2,t=dp(this,this.l,this.l+e);break;case"wstr":return ul.call(this,e,"dbcs");case"lpstr-ansi":t=x1(this,this.l),e=4+Sn(this,this.l);break;case"lpstr-cp":t=g1(this,this.l),e=4+Sn(this,this.l);break;case"lpwstr":t=y1(this,this.l),e=4+2*Sn(this,this.l);break;case"lpp4":e=4+Sn(this,this.l),t=k1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Sn(this,this.l),t=_1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Zo(this,this.l+e++))!==0;)o.push(Jc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=Ha(this,this.l+e))!==0;)o.push(Jc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Ha(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Zo(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return r=Zo(this,this.l),this.l++,r;case 2:return r=(n==="i"?zb:Ha)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?eo:Lb)(this,this.l),this.l+=4,r):(a=Sn(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Tu(this,this.l):a=Tu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=p1(this,this.l,e);break}}return this.l+=e,t}var Bb=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},Wb=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},Ub=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function Hb(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)Ub(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,Bb(this,n,this.l);break;case 8:if(r=8,t==="f"){Ib(this,n,this.l);break}case 16:break;case-4:r=4,Wb(this,n,this.l);break}return this.l+=r,this}function C1(e,n){var t=p1(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Br(e,n){e.l=n,e.read_shift=ul,e.chk=C1,e.write_shift=Hb}function Jr(e,n){e.l+=n}function Nr(e){var n=js(e);return Br(n,0),n}function Ja(e,n,t){if(e){var r,a,o;Br(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var h=Pu[c]||Pu[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var p=h.f&&h.f(e,o,t);if(e.l=f,n(p,h,c))return}}}function Ef(){var e=[],n=Tt?256:2048,t=function(h){var p=Nr(h);return Br(p,0),p},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=t(Math.max(h+1,n)))},l=function(){return a(),_s(e)},c=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function dl(e,n,t){var r=Ur(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function lg(e,n,t){var r=Ur(e);return r.s=dl(r.s,n.s,t),r.e=dl(r.e,n.s,t),r}function fl(e,n){if(e.cRel&&e.c<0)for(e=Ur(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Ur(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=wt(e);return!e.cRel&&e.cRel!=null&&(t=Vb(t)),!e.rRel&&e.rRel!=null&&(t=$b(t)),t}function J0(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dr(e.s.c)+":"+(e.e.cRel?"":"$")+Dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Hr(e.s.r)+":"+(e.e.rRel?"":"$")+Hr(e.e.r):fl(e.s,n.biff)+":"+fl(e.e,n.biff)}function fp(e){return parseInt(Yb(e),10)-1}function Hr(e){return""+(e+1)}function $b(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Yb(e){return e.replace(/\$(\d+)$/,"$1")}function pp(e){for(var n=Kb(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Dr(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function Vb(e){return e.replace(/^([A-Z])/,"$$$1")}function Kb(e){return e.replace(/^\$([A-Z])/,"$1")}function Gb(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function wt(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function gi(e){var n=e.indexOf(":");return n==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,n)),e:ln(e.slice(n+1))}}function At(e,n){return typeof n>"u"||typeof n=="number"?At(e.s,e.e):(typeof e!="string"&&(e=wt(e)),typeof n!="string"&&(n=wt(n)),e==n?e:e+":"+n)}function hr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function cg(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,t?fn(n):n)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(t?14:0),t?fn(n):n)}catch{return""+n}}function qa(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?bo[e.v]||e.v:n==null?cg(e,e.v):cg(e,n))}function Rs(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function T1(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=hr(o["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),l==-1&&(h.e.r=l=p.e.r+1)}for(var m=0;m!=n.length;++m)if(n[m]){if(!Array.isArray(n[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[m].length;++g)if(!(typeof n[m][g]>"u")){var v={v:n[m][g]},k=l+m,w=c+g;if(h.s.r>k&&(h.s.r=k),h.s.c>w&&(h.s.c=w),h.e.r<k&&(h.e.r=k),h.e.c<w&&(h.e.c=w),n[m][g]&&typeof n[m][g]=="object"&&!Array.isArray(n[m][g])&&!(n[m][g]instanceof Date))v=n[m][g];else if(Array.isArray(v.v)&&(v.f=n[m][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(r.nullError)v.t="e",v.v=0;else if(r.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=r.dateNF||kt[14],r.cellDates?(v.t="d",v.w=Un(v.z,fn(v.v))):(v.t="n",v.v=fn(v.v),v.w=Un(v.z,v.v))):v.t="s";if(a)o[k]||(o[k]=[]),o[k][w]&&o[k][w].z&&(v.z=o[k][w].z),o[k][w]=v;else{var b=wt({c:w,r:k});o[b]&&o[b].z&&(v.z=o[b].z),o[b]=v}}}return h.s.c<1e7&&(o["!ref"]=At(h)),o}function vi(e,n){return T1(null,e,n)}function Xb(e){return e.read_shift(4,"i")}function Zr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function Qb(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hp(e,n){var t=e.l,r=e.read_shift(1),a=Zr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(Qb(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var qb=hp;function Vn(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function wo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var Zb=Zr;function xp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var Jb=Zr,Cf=xp;function mp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Tu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):eo(n,0)>>2;return t?a/100:a}function N1(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var ko=N1;function Qr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function e_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var h=so[a];h&&(n.rgb=El(h));break;case 2:n.rgb=El([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function t_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function D1(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function r_(e){return D1(e,1)}function n_(e){return D1(e,2)}var gp=2,yn=3,tu=11,ug=12,Nu=19,ru=64,a_=65,s_=71,o_=4108,i_=4126,Rr=80,F1=81,l_=[Rr,F1],c_={1:{n:"CodePage",t:gp},2:{n:"Category",t:Rr},3:{n:"PresentationFormat",t:Rr},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:tu},12:{n:"HeadingPairs",t:o_},13:{n:"TitlesOfParts",t:i_},14:{n:"Manager",t:Rr},15:{n:"Company",t:Rr},16:{n:"LinksUpToDate",t:tu},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:tu},22:{n:"HyperlinksChanged",t:tu},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:a_},26:{n:"ContentType",t:Rr},27:{n:"ContentStatus",t:Rr},28:{n:"Language",t:Rr},29:{n:"Version",t:Rr},255:{},2147483648:{n:"Locale",t:Nu},2147483651:{n:"Behavior",t:Nu},1919054434:{}},u_={1:{n:"CodePage",t:gp},2:{n:"Title",t:Rr},3:{n:"Subject",t:Rr},4:{n:"Author",t:Rr},5:{n:"Keywords",t:Rr},6:{n:"Comments",t:Rr},7:{n:"Template",t:Rr},8:{n:"LastAuthor",t:Rr},9:{n:"RevNumber",t:Rr},10:{n:"EditTime",t:ru},11:{n:"LastPrinted",t:ru},12:{n:"CreatedDate",t:ru},13:{n:"ModifiedDate",t:ru},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:s_},18:{n:"Application",t:Rr},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:Nu},2147483651:{n:"Behavior",t:Nu},1919054434:{}},dg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},d_=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function f_(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var p_=f_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),so=Ur(p_),bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},j1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},fg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function h_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function x_(e){var n=h_();if(!e||!e.match)return n;var t={};if((e.match(en)||[]).forEach(function(r){var a=vt(r);switch(a[0].replace(_b,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[fg[a.ContentType]]!==void 0&&n[fg[a.ContentType]].push(a.PartName);break}}),n.xmlns!==Ob.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var ei={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tf(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function pl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(en)||[]).forEach(function(a){var o=vt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:ol(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var m_="application/vnd.oasis.opendocument.spreadsheet";function g_(e,n){for(var t=up(e),r,a;r=_l.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=vt(r[0],!1),a.path=="/"&&a.type!==m_)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var hl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],v_=(function(){for(var e=new Array(hl.length),n=0;n<hl.length;++n){var t=hl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function A1(e){var n={};e=tr(e);for(var t=0;t<hl.length;++t){var r=hl[t],a=e.match(v_[t]);a!=null&&a.length>0&&(n[r[1]]=Mt(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=Mr(n[r[1]]))}return n}var y_=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function P1(e,n,t,r){var a=[];if(typeof e=="string")a=rg(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(p){return{v:p}}));var l=typeof n=="string"?rg(n,r).map(function(p){return p.v}):n,c=0,f=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function w_(e,n,t){var r={};return n||(n={}),e=tr(e),y_.forEach(function(a){var o=(e.match(bl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=Mt(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&P1(r.HeadingPairs,r.TitlesOfParts,n,t),n}var k_=/<[^>]+>[^<]*/g;function b_(e,n){var t={},r="",a=e.match(k_);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=vt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Mt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),p=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[r]=Mt(p);break;case"bool":t[r]=or(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(p);break;case"filetime":case"date":t[r]=Mr(p);break;case"cy":case"error":t[r]=Mt(p);break;default:if(h.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var __={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ef;function S_(e,n,t){ef||(ef=ip(__)),n=ef[n]||n,e[n]=t}function vp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function O1(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function R1(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function M1(e,n,t){return n===31?R1(e):O1(e,n,t)}function Nf(e,n,t){return M1(e,n,t===!1?0:4)}function E_(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return M1(e,n,0)}function C_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(dn,""),e.l-a&2&&(e.l+=2)}return t}function T_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(dn,"");return t}function N_(e){var n=e.l,t=Du(e,F1);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Du(e,yn);return[t,r]}function D_(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(N_(e));return t}function pg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(dn,"").replace(sl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function I1(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function F_(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Du(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==ug&&r!==n&&l_.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===ug?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return O1(e,r,4).replace(dn,"");case 31:return R1(e);case 64:return vp(e);case 65:return I1(e);case 71:return F_(e);case 80:return Nf(e,r,!o.raw).replace(dn,"");case 81:return E_(e,r).replace(dn,"");case 4108:return D_(e);case 4126:case 4127:return r==4127?C_(e):T_(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function hg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,h={};for(l=0;l!=a;++l){var p=e.read_shift(4),m=e.read_shift(4);o[l]=[p,m+t]}o.sort(function(N,S){return N[1]-S[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var v=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,v=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(v=!1,e.l=o[l][1]),v)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var k=n[o[l][0]];if(g[k.n]=Du(e,k.t,{raw:!0}),k.p==="version"&&(g[k.n]=String(g[k.n]>>16)+"."+("0000"+String(g[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(g[k.n]){case 0:g[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:na(c=g[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[k.n])}}else if(o[l][0]===1){if(c=g.CodePage=Du(e,gp),na(c),f!==-1){var w=e.l;e.l=o[f][1],h=pg(e,c),e.l=w}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}h=pg(e,c)}else{var b=h[o[l][0]],E;switch(e[e.l]){case 65:e.l+=4,E=I1(e);break;case 30:e.l+=4,E=Nf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=Nf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=yr(e,4);break;case 64:e.l+=4,E=Mr(vp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[b]=E}}return e.l=t+r,g}function xg(e,n,t){var r=e.content;if(!r)return{};Br(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),p=r.read_shift(16);if(p!==jt.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var m=hg(r,n),g={SystemIdentifier:h};for(var v in m)g[v]=m[v];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var k;try{k=hg(r,null)}catch{}for(v in k)g[v]=k[v];return g.FMTID=[o,l],g}function ks(e,n){return e.read_shift(n),null}function j_(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function yr(e,n){return e.read_shift(n)===1}function Er(e){return e.read_shift(2,"u")}function z1(e,n){return j_(e,n,Er)}function A_(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Ol(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function P_(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",p=n===0?"":e.read_shift(n,h);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function po(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Rl(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):po(e,r,t)}function _o(e,n,t){if(t.biff>5)return Rl(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function O_(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function R_(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(dn,"");return r&&(e.l+=24),a}function M_(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(dn,"");return t+l}function I_(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return R_(e);case"0303000000000000c000000000000046":return M_(e);default:throw new Error("Unsupported Moniker "+t)}}function nu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(dn,""):"";return t}function z_(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,h="",p,m;a&16&&(o=nu(e,t-e.l)),a&128&&(l=nu(e,t-e.l)),(a&257)===257&&(c=nu(e,t-e.l)),(a&257)===1&&(f=I_(e,t-e.l)),a&8&&(h=nu(e,t-e.l)),a&32&&(p=e.read_shift(16)),a&64&&(m=vp(e)),e.l=t;var g=l||c||f||"";g&&h&&(g+="#"+h),g||(g="#"+h),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return p&&(v.guid=p),m&&(v.time=m),o&&(v.Tooltip=o),v}function L1(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function B1(e,n){var t=L1(e);return t[3]=0,t}function Fa(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function L_(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function B_(e,n,t){return n===0?"":_o(e,n,t)}function W_(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function W1(e){var n=e.read_shift(2),t=mp(e);return[n,t]}function U_(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Ol(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function Qu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function U1(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var H_=U1;function H1(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function $_(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function Y_(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Gr(e){e.l+=2,e.l+=e.read_shift(2)}var V_={0:Gr,4:Gr,5:Gr,6:Gr,7:Y_,8:Gr,9:Gr,10:Gr,11:Gr,12:Gr,13:$_,14:Gr,15:Gr,16:Gr,17:Gr,18:Gr,19:Gr,20:Gr,21:H1};function K_(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push(V_[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function au(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function G_(e,n){return n===0||e.read_shift(2),1200}function X_(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=_o(e,0,t);return e.read_shift(n+r-e.l),a}function Q_(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function q_(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Ol(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function Z_(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(P_(e));return o.Count=r,o.Unique=a,o}function J_(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function eS(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function tS(e){var n=L_(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function rS(e){return e.read_shift(2),e.read_shift(4)}function mg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function nS(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),h=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:h}}function aS(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function sS(){}function oS(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Ol(e,0,t),r}function iS(e){var n=Fa(e);return n.isst=e.read_shift(4),n}function lS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=Fa(e);t.biff==2&&e.l++;var o=Rl(e,r-e.l,t);return a.val=o,a}function cS(e,n,t){var r=e.read_shift(2),a=_o(e,0,t);return[r,a]}var uS=_o;function gg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function dS(e){var n=e.read_shift(2),t=e.read_shift(2),r=W1(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function fS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(W1(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function pS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function hS(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=d_[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function xS(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=hS(e,n,r.fStyle,t),r}function mS(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function vg(e,n,t){var r=Fa(e);(t.biff==2||n==9)&&++e.l;var a=A_(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function gS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Fa(e),a=Qr(e);return r.val=a,r}var yg=B_;function vS(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=po(e,o),c=[];r>e.l;)c.push(Rl(e));return[o,a,l,c]}function wg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=U_(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var yS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=po(e,l,t);a&32&&(h=yS[h.charCodeAt(0)]);var p=r-e.l;t&&t.biff==2&&--p;var m=r==e.l||c===0||!(p>0)?[]:eN(e,p,t,c);return{chKey:o,Name:h,itab:f,rgce:m}}function $1(e,n,t){if(t.biff<8)return wS(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(W_(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function wS(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Ol(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function kS(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=po(e,r,t),l=po(e,a,t);return[o,l]}function bS(e,n,t){var r=U1(e);e.l++;var a=e.read_shift(1);return n-=8,[tN(e,n,t),a,r]}function bg(e,n,t){var r=H_(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,ZT(e,n,t)]}function _S(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function SS(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=_o(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function ES(e,n,t){return SS(e,n,t)}function CS(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(Qu(e));return t}function TS(e,n,t){if(t&&t.biff<8)return DS(e,n,t);var r=H1(e),a=K_(e,n-22,r[1]);return{cmo:r,ft:a}}var NS={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function DS(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((NS[r]||Jr)(e,n,t)),{cmo:[a,r,o],ft:l}}function FS(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=O_(e,6,t);var c=e.read_shift(2);e.read_shift(2),Er(e,2);var f=e.read_shift(2);e.l+=f;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],m=po(e,e.lens[h+1]-e.lens[h]-1);if(a+=m,a.length>=(p?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function jS(e,n){var t=Qu(e);e.l+=16;var r=z_(e,n-24);return[t,r]}function AS(e,n){e.read_shift(2);var t=Qu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(dn,""),[t,r]}function PS(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=dg[t]||t,t=e.read_shift(2),n[1]=dg[t]||t,n}function OS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(B1(e));return t}function RS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(B1(e));return t}function MS(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Y1(e,n,t){if(!t.cellStyles)return Jr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var h={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(h.level=f>>8&7),h}function IS(e,n){var t={};return n<32||(e.l+=16,t.header=Qr(e),t.footer=Qr(e),e.l+=2),t}function zS(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var LS=Fa,BS=z1,WS=Rl;function US(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function HS(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Fa(e);++e.l;var a=_o(e,n-7,t);return r.t="str",r.val=a,r}function $S(e){var n=Fa(e);++e.l;var t=Qr(e);return n.t="n",n.val=t,n}function YS(e){var n=Fa(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function VS(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function KS(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function GS(e,n,t){var r=e.l+n,a=Fa(e),o=e.read_shift(2),l=po(e,o,t);return e.l=r,a.t="str",a.val=l,a}var XS=[2,3,48,49,131,139,140,245],_g=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=ip({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var h=[],p=js(1);switch(f.type){case"base64":p=ra(Tn(c));break;case"binary":p=ra(c);break;case"buffer":case"array":p=c;break}Br(p,0);var m=p.read_shift(1),g=!!(m&136),v=!1,k=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var w=0,b=521;m==2&&(w=p.read_shift(2)),p.l+=3,m!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),m!=2&&(b=p.read_shift(2));var E=p.read_shift(2),N=f.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(N=e[p[p.l]]),p.l+=1,p.l+=2),k&&(p.l+=36);for(var S=[],z={},te=Math.min(p.length,m==2?521:b-10-(v?264:0)),V=k?32:11;p.l<te&&p[p.l]!=13;)switch(z={},z.name=wl.utils.decode(N,p.slice(p.l,p.l+V)).replace(/[\u0000\r\n].*$/g,""),p.l+=V,z.type=String.fromCharCode(p.read_shift(1)),m!=2&&!k&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),m==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&S.push(z),m!=2&&(p.l+=k?13:14),z.type){case"B":(!v||z.len!=8)&&f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=b-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=b;var D=0,H=0;for(h[0]=[],H=0;H!=S.length;++H)h[0][H]=S[H].name;for(;w-- >0;){if(p[p.l]===42){p.l+=E;continue}for(++p.l,h[++D]=[],H=0,H=0;H!=S.length;++H){var L=p.slice(p.l,p.l+S[H].len);p.l+=S[H].len,Br(L,0);var ae=wl.utils.decode(N,L);switch(S[H].type){case"C":ae.trim().length&&(h[D][H]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?h[D][H]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):h[D][H]=ae;break;case"F":h[D][H]=parseFloat(ae.trim());break;case"+":case"I":h[D][H]=k?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":h[D][H]=!0;break;case"N":case"F":h[D][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[D][H]="##MEMO##"+(k?parseInt(ae.trim(),10):L.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(h[D][H]=+ae||0);break;case"@":h[D][H]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":h[D][H]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":h[D][H]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[D][H]=-L.read_shift(-8,"f");break;case"B":if(v&&S[H].len==8){h[D][H]=L.read_shift(8,"f");break}case"G":case"P":L.l+=S[H].len;break;case"0":if(S[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[H].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=S,h}function r(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var p=vi(t(c,h),h);return p["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,p}function a(c,f){try{return Rs(r(c,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var h=f||{};if(+h.codepage>=0&&na(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ef(),m=Rf(c,{header:1,raw:!0,cellDates:!0}),g=m[0],v=m.slice(1),k=c["!cols"]||[],w=0,b=0,E=0,N=1;for(w=0;w<g.length;++w){if(((k[w]||{}).DBF||{}).name){g[w]=k[w].DBF.name,++E;continue}if(g[w]!=null){if(++E,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(b=0;b<1024;++b)if(g.indexOf(g[w]+"_"+b)==-1){g[w]+="_"+b;break}}}}var S=hr(c["!ref"]),z=[],te=[],V=[];for(w=0;w<=S.e.c-S.s.c;++w){var D="",H="",L=0,ae=[];for(b=0;b<v.length;++b)v[b][w]!=null&&ae.push(v[b][w]);if(ae.length==0||g[w]==null){z[w]="?";continue}for(b=0;b<ae.length;++b){switch(typeof ae[b]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=ae[b]instanceof Date?"D":"C";break;default:H="C"}L=Math.max(L,String(ae[b]).length),D=D&&D!=H?"C":H}L>250&&(L=250),H=((k[w]||{}).DBF||{}).type,H=="C"&&k[w].DBF.len>L&&(L=k[w].DBF.len),D=="B"&&H=="N"&&(D="N",V[w]=k[w].DBF.dec,L=k[w].DBF.len),te[w]=D=="C"||H=="N"?L:o[D]||0,N+=te[w],z[w]=D}var Q=p.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,v.length),Q.write_shift(2,296+32*E),Q.write_shift(2,N),w=0;w<4;++w)Q.write_shift(4,0);for(Q.write_shift(4,0|(+n[$v]||3)<<8),w=0,b=0;w<g.length;++w)if(g[w]!=null){var Y=p.next(32),ue=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,ue,"sbcs"),Y.write_shift(1,z[w]=="?"?"C":z[w],"sbcs"),Y.write_shift(4,b),Y.write_shift(1,te[w]||o[z[w]]||0),Y.write_shift(1,V[w]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),b+=te[w]||o[z[w]]||0}var le=p.next(264);for(le.write_shift(4,13),w=0;w<65;++w)le.write_shift(4,0);for(w=0;w<v.length;++w){var oe=p.next(N);for(oe.write_shift(1,0),b=0;b<g.length;++b)if(g[b]!=null)switch(z[b]){case"L":oe.write_shift(1,v[w][b]==null?63:v[w][b]?84:70);break;case"B":oe.write_shift(8,v[w][b]||0,"f");break;case"N":var pe="0";for(typeof v[w][b]=="number"&&(pe=v[w][b].toFixed(V[b]||0)),E=0;E<te[b]-pe.length;++E)oe.write_shift(1,32);oe.write_shift(1,pe,"sbcs");break;case"D":v[w][b]?(oe.write_shift(4,("0000"+v[w][b].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(v[w][b].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+v[w][b].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var G=String(v[w][b]!=null?v[w][b]:"").slice(0,te[b]);for(oe.write_shift(1,G,"sbcs"),E=0;E<te[b]-G.length;++E)oe.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),QS=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ta(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,v){var k=e[v];return typeof k=="number"?Lm(k):k},r=function(g,v,k){var w=v.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?g:Lm(w)};e["|"]=254;function a(g,v){switch(v.type){case"base64":return o(Tn(g),v);case"binary":return o(g,v);case"buffer":return o(Tt&&Buffer.isBuffer(g)?g.toString("binary"):yo(g),v);case"array":return o(fo(g),v)}throw new Error("Unrecognized type "+v.type)}function o(g,v){var k=g.split(/[\n\r]+/),w=-1,b=-1,E=0,N=0,S=[],z=[],te=null,V={},D=[],H=[],L=[],ae=0,Q;for(+v.codepage>=0&&na(+v.codepage);E!==k.length;++E){ae=0;var Y=k[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),ue=Y.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),le=ue[0],oe;if(Y.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&z.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,G=!1,ie=!1,B=!1,de=-1,I=-1;for(N=1;N<ue.length;++N)switch(ue[N].charAt(0)){case"A":break;case"X":b=parseInt(ue[N].slice(1))-1,G=!0;break;case"Y":for(w=parseInt(ue[N].slice(1))-1,G||(b=0),Q=S.length;Q<=w;++Q)S[Q]=[];break;case"K":oe=ue[N].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(sa(oe))?isNaN(li(oe).getDate())||(oe=Mr(oe)):(oe=sa(oe),te!==null&&mi(te)&&(oe=Xu(oe))),pe=!0;break;case"E":B=!0;var j=ni(ue[N].slice(1),{r:w,c:b});S[w][b]=[S[w][b],j];break;case"S":ie=!0,S[w][b]=[S[w][b],"S5S"];break;case"G":break;case"R":de=parseInt(ue[N].slice(1))-1;break;case"C":I=parseInt(ue[N].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}if(pe&&(S[w][b]&&S[w][b].length==2?S[w][b][0]=oe:S[w][b]=oe,te=null),ie){if(B)throw new Error("SYLK shared formula cannot have own formula");var re=de>-1&&S[de][I];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");S[w][b][1]=ty(re[1],{r:w-de,c:b-I})}break;case"F":var T=0;for(N=1;N<ue.length;++N)switch(ue[N].charAt(0)){case"X":b=parseInt(ue[N].slice(1))-1,++T;break;case"Y":for(w=parseInt(ue[N].slice(1))-1,Q=S.length;Q<=w;++Q)S[Q]=[];break;case"M":ae=parseInt(ue[N].slice(1))/20;break;case"F":break;case"G":break;case"P":te=z[parseInt(ue[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=ue[N].slice(1).split(" "),Q=parseInt(L[0],10);Q<=parseInt(L[1],10);++Q)ae=parseInt(L[2],10),H[Q-1]=ae===0?{hidden:!0}:{wch:ae},ci(H[Q-1]);break;case"C":b=parseInt(ue[N].slice(1))-1,H[b]||(H[b]={});break;case"R":w=parseInt(ue[N].slice(1))-1,D[w]||(D[w]={}),ae>0?(D[w].hpt=ae,D[w].hpx=Cl(ae)):ae===0&&(D[w].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}T<1&&(te=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}}return D.length>0&&(V["!rows"]=D),H.length>0&&(V["!cols"]=H),v&&v.sheetRows&&(S=S.slice(0,v.sheetRows)),[S,V]}function l(g,v){var k=a(g,v),w=k[0],b=k[1],E=vi(w,v);return Ta(b).forEach(function(N){E[N]=b[N]}),E}function c(g,v){return Rs(l(g,v),v)}function f(g,v,k,w){var b="C;Y"+(k+1)+";X"+(w+1)+";K";switch(g.t){case"n":b+=g.v||0,g.f&&!g.F&&(b+=";E"+MC(g.f,{r:k,c:w}));break;case"b":b+=g.v?"TRUE":"FALSE";break;case"e":b+=g.w||g.v;break;case"d":b+='"'+(g.w||g.v)+'"';break;case"s":b+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function h(g,v){v.forEach(function(k,w){var b="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?b+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=ju(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Au(k.wpx)),typeof k.wch=="number"&&(b+=Math.round(k.wch))),b.charAt(b.length-1)!=" "&&g.push(b)})}function p(g,v){v.forEach(function(k,w){var b="F;";k.hidden?b+="M0;":k.hpt?b+="M"+20*k.hpt+";":k.hpx&&(b+="M"+20*Z1(k.hpx)+";"),b.length>2&&g.push(b+"R"+(w+1))})}function m(g,v){var k=["ID;PWXL;N;E"],w=[],b=hr(g["!ref"]),E,N=Array.isArray(g),S=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),g["!cols"]&&h(k,g["!cols"]),g["!rows"]&&p(k,g["!rows"]),k.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var z=b.s.r;z<=b.e.r;++z)for(var te=b.s.c;te<=b.e.c;++te){var V=wt({r:z,c:te});E=N?(g[z]||[])[te]:g[V],!(!E||E.v==null&&(!E.f||E.F))&&w.push(f(E,g,z,te))}return k.join(S)+S+w.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:l,from_sheet:m}})(),qS=(function(){function e(o,l){switch(l.type){case"base64":return n(Tn(o),l);case"binary":return n(o,l);case"buffer":return n(Tt&&Buffer.isBuffer(o)?o.toString("binary"):yo(o),l);case"array":return n(fo(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,h=-1,p=0,m=[];p!==c.length;++p){if(c[p].trim()==="BOT"){m[++f]=[],h=0;continue}if(!(f<0)){var g=c[p].trim().split(","),v=g[0],k=g[1];++p;for(var w=c[p]||"";(w.match(/["]/g)||[]).length&1&&p<c.length-1;)w+=`
`+c[++p];switch(w=w.trim(),+v){case-1:if(w==="BOT"){m[++f]=[],h=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?m[f][h]=!0:w==="FALSE"?m[f][h]=!1:isNaN(sa(k))?isNaN(li(k).getDate())?m[f][h]=k:m[f][h]=Mr(k):m[f][h]=sa(k),++h;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),m[f][h++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function t(o,l){return vi(e(o,l),l)}function r(o,l){return Rs(t(o,l),l)}var a=(function(){var o=function(f,h,p,m,g){f.push(h),f.push(p+","+m),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,h,p,m){f.push(h+","+p),f.push(h==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var h=[],p=hr(f["!ref"]),m,g=Array.isArray(f);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,p.e.r-p.s.r+1,""),o(h,"TUPLES",0,p.e.c-p.s.c+1,""),o(h,"DATA",0,0,"");for(var v=p.s.r;v<=p.e.r;++v){l(h,-1,0,"BOT");for(var k=p.s.c;k<=p.e.c;++k){var w=wt({r:v,c:k});if(m=g?(f[v]||[])[k]:f[w],!m){l(h,1,0,"");continue}switch(m.t){case"n":var b=m.w;!b&&m.v!=null&&(b=m.v),b==null?m.f&&!m.F?l(h,1,0,"="+m.f):l(h,1,0,""):l(h,0,b,"V");break;case"b":l(h,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Un(m.z||kt[14],fn(Mr(m.v)))),l(h,0,m.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var E=`\r
`,N=h.join(E);return N}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),ZS=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(m,g){for(var v=m.split(`
`),k=-1,w=-1,b=0,E=[];b!==v.length;++b){var N=v[b].trim().split(":");if(N[0]==="cell"){var S=ln(N[1]);if(E.length<=S.r)for(k=E.length;k<=S.r;++k)E[k]||(E[k]=[]);switch(k=S.r,w=S.c,N[2]){case"t":E[k][w]=e(N[3]);break;case"v":E[k][w]=+N[3];break;case"vtf":var z=N[N.length-1];case"vtc":switch(N[3]){case"nl":E[k][w]=!!+N[4];break;default:E[k][w]=+N[4];break}N[2]=="vtf"&&(E[k][w]=[E[k][w],z])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function r(m,g){return vi(t(m,g),g)}function a(m,g){return Rs(r(m,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var g=[],v=[],k,w="",b=gi(m["!ref"]),E=Array.isArray(m),N=b.s.r;N<=b.e.r;++N)for(var S=b.s.c;S<=b.e.c;++S)if(w=wt({r:N,c:S}),k=E?(m[N]||[])[S]:m[w],!(!k||k.v==null||k.t==="z")){switch(v=["cell",w,"t"],k.t){case"s":case"str":v.push(n(k.v));break;case"n":k.f?(v[2]="vtf",v[3]="n",v[4]=k.v,v[5]=n(k.f)):(v[2]="v",v[3]=k.v);break;case"b":v[2]="vt"+(k.f?"f":"c"),v[3]="nl",v[4]=k.v?"1":"0",v[5]=n(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var z=fn(Mr(k.v));v[2]="vtc",v[3]="nd",v[4]=""+z,v[5]=k.w||Un(k.z||kt[14],z);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(m){return[o,l,c,l,h(m),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:p}})(),Sl=(function(){function e(p,m,g,v,k){k.raw?m[g][v]=p:p===""||(p==="TRUE"?m[g][v]=!0:p==="FALSE"?m[g][v]=!1:isNaN(sa(p))?isNaN(li(p).getDate())?m[g][v]=p:m[g][v]=Mr(p):m[g][v]=sa(p))}function n(p,m){var g=m||{},v=[];if(!p||p.length===0)return v;for(var k=p.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var b=10,E=0,N=0;N<=w;++N)E=k[N].indexOf(" "),E==-1?E=k[N].length:E++,b=Math.max(b,E);for(N=0;N<=w;++N){v[N]=[];var S=0;for(e(k[N].slice(0,b).trim(),v,N,S,g),S=1;S<=(k[N].length-b)/10+1;++S)e(k[N].slice(b+(S-1)*10,b+S*10).trim(),v,N,S,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(p){for(var m={},g=!1,v=0,k=0;v<p.length;++v)(k=p.charCodeAt(v))==34?g=!g:!g&&k in t&&(m[k]=(m[k]||0)+1);k=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&k.push([m[v],v]);if(!k.length){m=r;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&k.push([m[v],v])}return k.sort(function(w,b){return w[0]-b[0]||r[w[1]]-r[b[1]]}),t[k.pop()[1]]||44}function o(p,m){var g=m||{},v="",k=g.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(v=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(v=p.charAt(4),p=p.slice(6)):v=a(p.slice(0,1024)):g&&g.FS?v=g.FS:v=a(p.slice(0,1024));var b=0,E=0,N=0,S=0,z=0,te=v.charCodeAt(0),V=!1,D=0,H=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var L=g.dateNF!=null?cb(g.dateNF):null;function ae(){var Q=p.slice(S,z),Y={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=Q;else if(Q.trim().length===0)Y.t="s",Y.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(Y.t="s",Y.v=Q.slice(2,-1).replace(/""/g,'"')):zC(Q)?(Y.t="n",Y.f=Q.slice(1)):(Y.t="s",Y.v=Q);else if(Q=="TRUE")Y.t="b",Y.v=!0;else if(Q=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(N=sa(Q)))Y.t="n",g.cellText!==!1&&(Y.w=Q),Y.v=N;else if(!isNaN(li(Q).getDate())||L&&Q.match(L)){Y.z=g.dateNF||kt[14];var ue=0;L&&Q.match(L)&&(Q=ub(Q,g.dateNF,Q.match(L)||[]),ue=1),g.cellDates?(Y.t="d",Y.v=Mr(Q,ue)):(Y.t="n",Y.v=fn(Mr(Q,ue))),g.cellText!==!1&&(Y.w=Un(Y.z,Y.v instanceof Date?fn(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=Q;if(Y.t=="z"||(g.dense?(k[b]||(k[b]=[]),k[b][E]=Y):k[wt({c:E,r:b})]=Y),S=z+1,H=p.charCodeAt(S),w.e.c<E&&(w.e.c=E),w.e.r<b&&(w.e.r=b),D==te)++E;else if(E=0,++b,g.sheetRows&&g.sheetRows<=b)return!0}e:for(;z<p.length;++z)switch(D=p.charCodeAt(z)){case 34:H===34&&(V=!V);break;case te:case 10:case 13:if(!V&&ae())break e;break}return z-S>0&&ae(),k["!ref"]=At(w),k}function l(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,m):vi(n(p,m),m)}function c(p,m){var g="",v=m.type=="string"?[0,0,0,0]:Cp(p,m);switch(m.type){case"base64":g=Tn(p);break;case"binary":g=p;break;case"buffer":m.codepage==65001?g=p.toString("utf8"):m.codepage&&typeof wl<"u"||(g=Tt&&Buffer.isBuffer(p)?p.toString("binary"):yo(p));break;case"array":g=fo(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=tr(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=tr(g):m.type=="binary"&&typeof wl<"u",g.slice(0,19)=="socialcalc:version:"?ZS.to_sheet(m.type=="string"?g:tr(g),m):l(g,m)}function f(p,m){return Rs(c(p,m),m)}function h(p){for(var m=[],g=hr(p["!ref"]),v,k=Array.isArray(p),w=g.s.r;w<=g.e.r;++w){for(var b=[],E=g.s.c;E<=g.e.c;++E){var N=wt({r:w,c:E});if(v=k?(p[w]||[])[E]:p[N],!v||v.v==null){b.push("          ");continue}for(var S=(v.w||(qa(v),v.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(E===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})();function JS(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=QS.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return Sl.to_workbook(e,n)}}var xl=(function(){function e(j,re,T){if(j){Br(j,j.l||0);for(var F=T.Enum||de;j.l<j.length;){var O=j.read_shift(2),R=F[O]||F[65535],J=j.read_shift(2),Z=j.l+J,U=R.f&&R.f(j,J,T);if(j.l=Z,re(U,R,O))return}}}function n(j,re){switch(re.type){case"base64":return t(ra(Tn(j)),re);case"binary":return t(ra(j),re);case"buffer":case"array":return t(j,re)}throw"Unsupported type "+re.type}function t(j,re){if(!j)return j;var T=re||{},F=T.dense?[]:{},O="Sheet1",R="",J=0,Z={},U=[],xe=[],M={s:{r:0,c:0},e:{r:0,c:0}},ve=T.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)T.Enum=de,e(j,function(ce,Fe,Re){switch(Re){case 0:T.vers=ce,ce>=4096&&(T.qpro=!0);break;case 6:M=ce;break;case 204:ce&&(R=ce);break;case 222:R=ce;break;case 15:case 51:T.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:Re==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=T.dateNF||kt[14],T.cellDates&&(ce[1].t="d",ce[1].v=Xu(ce[1].v))),T.qpro&&ce[3]>J&&(F["!ref"]=At(M),Z[O]=F,U.push(O),F=T.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},J=ce[3],O=R||"Sheet"+(J+1),R="");var De=T.dense?(F[ce[0].r]||[])[ce[0].c]:F[wt(ce[0])];if(De){De.t=ce[1].t,De.v=ce[1].v,ce[1].z!=null&&(De.z=ce[1].z),ce[1].f!=null&&(De.f=ce[1].f);break}T.dense?(F[ce[0].r]||(F[ce[0].r]=[]),F[ce[0].r][ce[0].c]=ce[1]):F[wt(ce[0])]=ce[1];break}},T);else if(j[2]==26||j[2]==14)T.Enum=I,j[2]==14&&(T.qpro=!0,j.l=0),e(j,function(ce,Fe,Re){switch(Re){case 204:O=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>J&&(F["!ref"]=At(M),Z[O]=F,U.push(O),F=T.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},J=ce[3],O="Sheet"+(J+1)),ve>0&&ce[0].r>=ve)break;T.dense?(F[ce[0].r]||(F[ce[0].r]=[]),F[ce[0].r][ce[0].c]=ce[1]):F[wt(ce[0])]=ce[1],M.e.c<ce[0].c&&(M.e.c=ce[0].c),M.e.r<ce[0].r&&(M.e.r=ce[0].r);break;case 27:ce[14e3]&&(xe[ce[14e3][0]]=ce[14e3][1]);break;case 1537:xe[ce[0]]=ce[1],ce[0]==J&&(O=ce[1]);break}},T);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(F["!ref"]=At(M),Z[R||O]=F,U.push(R||O),!xe.length)return{SheetNames:U,Sheets:Z};for(var ye={},Me=[],Pe=0;Pe<xe.length;++Pe)Z[U[Pe]]?(Me.push(xe[Pe]||U[Pe]),ye[xe[Pe]]=Z[xe[Pe]]||Z[U[Pe]]):(Me.push(xe[Pe]),ye[xe[Pe]]={"!ref":"A1"});return{SheetNames:Me,Sheets:ye}}function r(j,re){var T=re||{};if(+T.codepage>=0&&na(+T.codepage),T.type=="string")throw new Error("Cannot write WK1 to JS string");var F=Ef(),O=hr(j["!ref"]),R=Array.isArray(j),J=[];ta(F,0,o(1030)),ta(F,6,f(O));for(var Z=Math.min(O.e.r,8191),U=O.s.r;U<=Z;++U)for(var xe=Hr(U),M=O.s.c;M<=O.e.c;++M){U===O.s.r&&(J[M]=Dr(M));var ve=J[M]+xe,ye=R?(j[U]||[])[M]:j[ve];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?ta(F,13,v(U,M,ye.v)):ta(F,14,w(U,M,ye.v));else{var Me=qa(ye);ta(F,15,m(U,M,Me.slice(0,239)))}}return ta(F,1),F.end()}function a(j,re){var T=re||{};if(+T.codepage>=0&&na(+T.codepage),T.type=="string")throw new Error("Cannot write WK3 to JS string");var F=Ef();ta(F,0,l(j));for(var O=0,R=0;O<j.SheetNames.length;++O)(j.Sheets[j.SheetNames[O]]||{})["!ref"]&&ta(F,27,B(j.SheetNames[O],R++));var J=0;for(O=0;O<j.SheetNames.length;++O){var Z=j.Sheets[j.SheetNames[O]];if(!(!Z||!Z["!ref"])){for(var U=hr(Z["!ref"]),xe=Array.isArray(Z),M=[],ve=Math.min(U.e.r,8191),ye=U.s.r;ye<=ve;++ye)for(var Me=Hr(ye),Pe=U.s.c;Pe<=U.e.c;++Pe){ye===U.s.r&&(M[Pe]=Dr(Pe));var ce=M[Pe]+Me,Fe=xe?(Z[ye]||[])[Pe]:Z[ce];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")ta(F,23,ae(ye,Pe,J,Fe.v));else{var Re=qa(Fe);ta(F,22,D(ye,Pe,J,Re.slice(0,239)))}}++J}}return ta(F,1),F.end()}function o(j){var re=Nr(2);return re.write_shift(2,j),re}function l(j){var re=Nr(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var T=0,F=0,O=0,R=0;R<j.SheetNames.length;++R){var J=j.SheetNames[R],Z=j.Sheets[J];if(!(!Z||!Z["!ref"])){++O;var U=gi(Z["!ref"]);T<U.e.r&&(T=U.e.r),F<U.e.c&&(F=U.e.c)}}return T>8191&&(T=8191),re.write_shift(2,T),re.write_shift(1,O),re.write_shift(1,F),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function c(j,re,T){var F={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&T.qpro?(F.s.c=j.read_shift(1),j.l++,F.s.r=j.read_shift(2),F.e.c=j.read_shift(1),j.l++,F.e.r=j.read_shift(2),F):(F.s.c=j.read_shift(2),F.s.r=j.read_shift(2),re==12&&T.qpro&&(j.l+=2),F.e.c=j.read_shift(2),F.e.r=j.read_shift(2),re==12&&T.qpro&&(j.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function f(j){var re=Nr(8);return re.write_shift(2,j.s.c),re.write_shift(2,j.s.r),re.write_shift(2,j.e.c),re.write_shift(2,j.e.r),re}function h(j,re,T){var F=[{c:0,r:0},{t:"n",v:0},0,0];return T.qpro&&T.vers!=20768?(F[0].c=j.read_shift(1),F[3]=j.read_shift(1),F[0].r=j.read_shift(2),j.l+=2):(F[2]=j.read_shift(1),F[0].c=j.read_shift(2),F[0].r=j.read_shift(2)),F}function p(j,re,T){var F=j.l+re,O=h(j,re,T);if(O[1].t="s",T.vers==20768){j.l++;var R=j.read_shift(1);return O[1].v=j.read_shift(R,"utf8"),O}return T.qpro&&j.l++,O[1].v=j.read_shift(F-j.l,"cstr"),O}function m(j,re,T){var F=Nr(7+T.length);F.write_shift(1,255),F.write_shift(2,re),F.write_shift(2,j),F.write_shift(1,39);for(var O=0;O<F.length;++O){var R=T.charCodeAt(O);F.write_shift(1,R>=128?95:R)}return F.write_shift(1,0),F}function g(j,re,T){var F=h(j,re,T);return F[1].v=j.read_shift(2,"i"),F}function v(j,re,T){var F=Nr(7);return F.write_shift(1,255),F.write_shift(2,re),F.write_shift(2,j),F.write_shift(2,T,"i"),F}function k(j,re,T){var F=h(j,re,T);return F[1].v=j.read_shift(8,"f"),F}function w(j,re,T){var F=Nr(13);return F.write_shift(1,255),F.write_shift(2,re),F.write_shift(2,j),F.write_shift(8,T,"f"),F}function b(j,re,T){var F=j.l+re,O=h(j,re,T);if(O[1].v=j.read_shift(8,"f"),T.qpro)j.l=F;else{var R=j.read_shift(2);z(j.slice(j.l,j.l+R),O),j.l+=R}return O}function E(j,re,T){var F=re&32768;return re&=-32769,re=(F?j:0)+(re>=8192?re-16384:re),(F?"":"$")+(T?Dr(re):Hr(re))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(j,re){Br(j,0);for(var T=[],F=0,O="",R="",J="",Z="";j.l<j.length;){var U=j[j.l++];switch(U){case 0:T.push(j.read_shift(8,"f"));break;case 1:R=E(re[0].c,j.read_shift(2),!0),O=E(re[0].r,j.read_shift(2),!1),T.push(R+O);break;case 2:{var xe=E(re[0].c,j.read_shift(2),!0),M=E(re[0].r,j.read_shift(2),!1);R=E(re[0].c,j.read_shift(2),!0),O=E(re[0].r,j.read_shift(2),!1),T.push(xe+M+":"+R+O)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:T.push("("+T.pop()+")");break;case 5:T.push(j.read_shift(2));break;case 6:{for(var ve="";U=j[j.l++];)ve+=String.fromCharCode(U);T.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:T.push("-"+T.pop());break;case 23:T.push("+"+T.pop());break;case 22:T.push("NOT("+T.pop()+")");break;case 20:case 21:Z=T.pop(),J=T.pop(),T.push(["AND","OR"][U-20]+"("+J+","+Z+")");break;default:if(U<32&&S[U])Z=T.pop(),J=T.pop(),T.push(J+S[U]+Z);else if(N[U]){if(F=N[U][1],F==69&&(F=j[j.l++]),F>T.length){console.error("WK1 bad formula parse 0x"+U.toString(16)+":|"+T.join("|")+"|");return}var ye=T.slice(-F);T.length-=F,T.push(N[U][0]+"("+ye.join(",")+")")}else return U<=7?console.error("WK1 invalid opcode "+U.toString(16)):U<=24?console.error("WK1 unsupported op "+U.toString(16)):U<=30?console.error("WK1 invalid opcode "+U.toString(16)):U<=115?console.error("WK1 unsupported function opcode "+U.toString(16)):console.error("WK1 unrecognized opcode "+U.toString(16))}}T.length==1?re[1].f=""+T[0]:console.error("WK1 bad formula parse |"+T.join("|")+"|")}function te(j){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=j.read_shift(2),re[3]=j[j.l++],re[0].c=j[j.l++],re}function V(j,re){var T=te(j);return T[1].t="s",T[1].v=j.read_shift(re-4,"cstr"),T}function D(j,re,T,F){var O=Nr(6+F.length);O.write_shift(2,j),O.write_shift(1,T),O.write_shift(1,re),O.write_shift(1,39);for(var R=0;R<F.length;++R){var J=F.charCodeAt(R);O.write_shift(1,J>=128?95:J)}return O.write_shift(1,0),O}function H(j,re){var T=te(j);T[1].v=j.read_shift(2);var F=T[1].v>>1;if(T[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return T[1].v=F,T}function L(j,re){var T=te(j),F=j.read_shift(4),O=j.read_shift(4),R=j.read_shift(2);if(R==65535)return F===0&&O===3221225472?(T[1].t="e",T[1].v=15):F===0&&O===3489660928?(T[1].t="e",T[1].v=42):T[1].v=0,T;var J=R&32768;return R=(R&32767)-16446,T[1].v=(1-J*2)*(O*Math.pow(2,R+32)+F*Math.pow(2,R)),T}function ae(j,re,T,F){var O=Nr(14);if(O.write_shift(2,j),O.write_shift(1,T),O.write_shift(1,re),F==0)return O.write_shift(4,0),O.write_shift(4,0),O.write_shift(2,65535),O;var R=0,J=0,Z=0,U=0;return F<0&&(R=1,F=-F),J=Math.log2(F)|0,F/=Math.pow(2,J-31),U=F>>>0,(U&2147483648)==0&&(F/=2,++J,U=F>>>0),F-=U,U|=2147483648,U>>>=0,F*=Math.pow(2,32),Z=F>>>0,O.write_shift(4,Z),O.write_shift(4,U),J+=16383+(R?32768:0),O.write_shift(2,J),O}function Q(j,re){var T=L(j);return j.l+=re-14,T}function Y(j,re){var T=te(j),F=j.read_shift(4);return T[1].v=F>>6,T}function ue(j,re){var T=te(j),F=j.read_shift(8,"f");return T[1].v=F,T}function le(j,re){var T=ue(j);return j.l+=re-10,T}function oe(j,re){return j[j.l+re-1]==0?j.read_shift(re,"cstr"):""}function pe(j,re){var T=j[j.l++];T>re-1&&(T=re-1);for(var F="";F.length<T;)F+=String.fromCharCode(j[j.l++]);return F}function G(j,re,T){if(!(!T.qpro||re<21)){var F=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var O=j.read_shift(re-21,"cstr");return[F,O]}}function ie(j,re){for(var T={},F=j.l+re;j.l<F;){var O=j.read_shift(2);if(O==14e3){for(T[O]=[0,""],T[O][0]=j.read_shift(2);j[j.l];)T[O][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return T}function B(j,re){var T=Nr(5+j.length);T.write_shift(2,14e3),T.write_shift(2,re);for(var F=0;F<j.length;++F){var O=j.charCodeAt(F);T[T.l++]=O>127?95:O}return T[T.l++]=0,T}var de={0:{n:"BOF",f:Er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:G},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function eE(e){var n={},t=e.match(en),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=vt(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=rp[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var tE=(function(){var e=bl("t"),n=bl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:Mt(l[1])},f=o.match(n);return f&&(c.s=eE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),rE=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),nE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,aE=/<(?:\w+:)?r>/,sE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Mt(tr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=tr(e),t&&(r.h=cp(r.t))):e.match(aE)&&(r.r=tr(e),r.t=Mt(tr((e.replace(sE,"").match(nE)||[]).join("").replace(en,""))),t&&(r.h=rE(tE(r.r)))),r):{t:""}}var oE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,iE=/<(?:\w+:)?(?:si|sstItem)>/g,lE=/<\/(?:\w+:)?(?:si|sstItem)>/;function cE(e,n){var t=[],r="";if(!e)return t;var a=e.match(oE);if(a){r=a[2].replace(iE,"").split(lE);for(var o=0;o!=r.length;++o){var l=yp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=vt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function uE(e){return[e.read_shift(4),e.read_shift(4)]}function dE(e,n){var t=[],r=!1;return Ja(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function V1(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Ya(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function fE(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Ya(e,4),n.U=Ya(e,4),n.W=Ya(e,4),n}function pE(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function hE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(pE(e));return n}function xE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function mE(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Ya(e,4),n.U=Ya(e,4),n.W=Ya(e,4),n}function gE(e){var n=mE(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function K1(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function G1(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function vE(e){var n=Ya(e);switch(n.Minor){case 2:return[n.Minor,yE(e)];case 3:return[n.Minor,wE()];case 4:return[n.Minor,kE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function yE(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=K1(e,t),a=G1(e,e.length-e.l);return{t:"Std",h:r,v:a}}function wE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function kE(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(en,function(o){var l=vt(o);switch(Da(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function bE(e,n){var t={},r=t.EncryptionVersionInfo=Ya(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=K1(e,a),n-=a,t.EncryptionVerifier=G1(e,n),t}function _E(e){var n={},t=n.EncryptionVersionInfo=Ya(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function SE(e){var n=0,t,r=V1(e),a=r.length+1,o,l,c,f,h;for(t=js(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,h=c|f,n=h^l;return n^52811}var X1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var p=l[h],m=0;m!=7;++m)p&64&&(c^=t[f]),p*=2,--f;return c};return function(l){for(var c=V1(l),f=o(c),h=c.length,p=js(16),m=0;m!=16;++m)p[m]=0;var g,v,k;for((h&1)===1&&(g=f>>8,p[h]=a(e[0],g),--h,g=f&255,v=c[c.length-1],p[h]=a(v,g));h>0;)--h,g=f>>8,p[h]=a(c[h],g),--h,g=f&255,p[h]=a(c[h],g);for(h=15,k=15-c.length;k>0;)g=f>>8,p[h]=a(e[k],g),--h,--k,g=f&255,p[h]=a(c[h],g),--h,--k;return p}})(),EE=function(e,n,t,r,a){a||(a=n),r||(r=X1(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},CE=function(e){var n=0,t=X1(e);return function(r){var a=EE("",r,n,t);return n=a[1],a[0]}};function TE(e,n,t,r){var a={key:Er(e),verificationBytes:Er(e)};return t.password&&(a.verifier=SE(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=CE(t.password)),a}function NE(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=_E(e):r.Data=bE(e,n),r}function DE(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?NE(e,n-2,r):TE(e,t.biff>=8?n:n-2,t,r),r}var FE=(function(){function e(a,o){switch(o.type){case"base64":return n(Tn(a),o);case"binary":return n(a,o);case"buffer":return n(Tt&&Buffer.isBuffer(a)?a.toString("binary"):yo(a),o);case"array":return n(fo(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,m){Array.isArray(c)&&(c[m]=[]);for(var g=/\\\w+\b/g,v=0,k,w=-1;k=g.exec(p);){switch(k[0]){case"\\cell":var b=p.slice(v,g.lastIndex-k[0].length);if(b[0]==" "&&(b=b.slice(1)),++w,b.length){var E={v:b,t:"s"};Array.isArray(c)?c[m][w]=E:c[wt({r:m,c:w})]=E}break}v=g.lastIndex}w>h.e.c&&(h.e.c=w)}),c["!ref"]=At(h),c}function t(a,o){return Rs(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=hr(a["!ref"]),c,f=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var m=wt({r:h,c:p});c=f?(a[h]||[])[p]:a[m],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(qa(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function jE(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function El(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function AE(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,h=a+o;switch(f=l/(h>1?2-h:h),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,h/2]}function PE(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function Fu(e,n){if(n===0)return e;var t=AE(jE(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),El(PE(t))}var Q1=6,OE=15,RE=1,sn=Q1;function ju(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function Au(e){return Math.floor((e-5)/sn*100+.5)/100}function Df(e){return Math.round((e*sn+5)/sn*256)/256}function tf(e){return Df(Au(ju(e)))}function wp(e){var n=Math.abs(e-tf(e)),t=sn;if(n>.005)for(sn=RE;sn<OE;++sn)Math.abs(e-tf(e))<=n&&(n=Math.abs(e-tf(e)),t=sn);sn=t}function ci(e){e.width?(e.wpx=ju(e.width),e.wch=Au(e.wpx),e.MDW=sn):e.wpx?(e.wch=Au(e.wpx),e.width=Df(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Df(e.wch),e.wpx=ju(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var ME=96,q1=ME;function Z1(e){return e*96/q1}function Cl(e){return e*q1/96}var IE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zE(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=vt(l);switch(Da(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=or(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=or(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function LE(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=vt(l);switch(Da(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function BE(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=vt(l);switch(Da(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=tr(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?or(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?or(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?or(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?or(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?or(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?or(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?or(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=rp[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=or(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=so[a.color.index];a.color.index==81&&(f=so[1]),f||(f=so[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Fu(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function WE(e,n,t){n.NumberFmt=[];for(var r=Ta(kt),a=0;a<r.length;++a)n.NumberFmt[r[a]]=kt[r[a]];var o=e[0].match(en);if(o)for(a=0;a<o.length;++a){var l=vt(o[a]);switch(Da(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Mt(tr(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}ao(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var su=["numFmtId","fillId","fontId","borderId","xfId"],ou=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function UE(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(en)||[]).forEach(function(o){var l=vt(o),c=0;switch(Da(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<su.length;++c)r[su[c]]&&(r[su[c]]=parseInt(r[su[c]],10));for(c=0;c<ou.length;++c)r[ou[c]]&&(r[ou[c]]=or(r[ou[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=or(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var HE=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,h){var p={};if(!c)return p;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(n))&&WE(m,p,h),(m=c.match(a))&&BE(m,p,f,h),(m=c.match(r))&&LE(m,p,f,h),(m=c.match(o))&&zE(m,p,f,h),(m=c.match(t))&&UE(m,p,h),p}})();function $E(e,n){var t=e.read_shift(2),r=Zr(e);return[t,r]}function YE(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=t_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=e_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Zr(e),r}var VE=Jr;function KE(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var GE=Jr;function XE(e,n,t){var r={};r.NumberFmt=[];for(var a in kt)r.NumberFmt[a]=kt[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return Ja(e,function(f,h,p){switch(p){case 44:r.NumberFmt[f[0]]=f[1],ao(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=Fu(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(p);else if(h.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var QE=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function qE(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(en)||[]).forEach(function(a){var o=vt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[QE.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function ZE(){}function JE(){}var eC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,tC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,rC=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function nC(e,n,t){n.themeElements={};var r;[["clrScheme",eC,qE],["fontScheme",tC,ZE],["fmtScheme",rC,JE]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var aC=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function J1(e,n){(!e||e.length===0)&&(e=sC());var t,r={};if(!(t=e.match(aC)))throw new Error("themeElements not found in theme");return nC(t[0],r,n),r.raw=e,r}function sC(e,n){var t=[u1];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function oC(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=c1(o,{type:"array"})}catch{return}var c=En(l,"theme/theme/theme1.xml",!0);if(c)return J1(c,t)}}function iC(e){return e.read_shift(4)}function lC(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=cC(e,4);break;case 2:n.xclrValue=L1(e);break;case 3:n.xclrValue=iC(e);break;case 4:e.l+=4;break}return e.l+=8,n}function cC(e,n){return Jr(e,n)}function uC(e,n){return Jr(e,n)}function dC(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=lC(e);break;case 6:r[1]=uC(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function fC(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(dC(e,t-e.l));return{ixfe:r,ext:o}}function pC(e,n){n.forEach(function(t){t[0]})}function hC(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zr(e)}}function xC(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function mC(e){return e.l+=4,e.read_shift(4)!=0}function gC(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return Ja(e,function(f,h,p){switch(p){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?r.Cell.push({type:r.Types[m[0]-1].name,index:m[1]}):c==0&&r.Value.push({type:r.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function vC(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(en,function(c){var f=vt(c);switch(Da(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==f.name&&(l=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function yC(e){var n=[];if(!e)return n;var t=1;return(e.match(en)||[]).forEach(function(r){var a=vt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function wC(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=wt(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function kC(e,n,t){var r=[];return Ja(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function bC(e,n,t,r){if(!e)return e;var a=r||{},o=!1;Ja(e,function(c,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function _C(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function Sg(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=ln(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=hr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var h=At(f);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:t};l.h&&(p.h=l.h);for(var m=o.c.length-1;m>=0;--m){if(!t&&o.c[m].T)return;t&&!o.c[m].T&&o.c.splice(m,1)}if(t&&r){for(m=0;m<r.length;++m)if(p.a==r[m].id){p.a=r[m].name||p.a;break}}o.c.push(p)})}function SC(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=vt(c[0]),h={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=ln(f.ref);if(!(n.sheetRows&&n.sheetRows<=p.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&yp(m[1])||{r:"",t:"",h:""};h.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),h.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(h.h=g.h),r.push(h)}}}}),r}function EC(e,n){var t=[],r=!1,a={},o=0;return e.replace(en,function(c,f){var h=vt(c);switch(Da(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function CC(e,n){var t=[],r=!1;return e.replace(en,function(o){var l=vt(o);switch(Da(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function TC(e){var n={};n.iauthor=e.read_shift(4);var t=ko(e);return n.rfx=t.s,n.ref=wt(t.s),e.l+=16,n}var NC=Zr;function DC(e,n){var t=[],r=[],a={},o=!1;return Ja(e,function(c,f,h){switch(h){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var FC="application/vnd.ms-office.vbaProject";function jC(e){var n=jt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");jt.utils.cfb_add(n,a,e.FileIndex[r].content)}}),jt.write(n)}function AC(){return{"!type":"dialog"}}function PC(){return{"!type":"dialog"}}function OC(){return{"!type":"macro"}}function RC(){return{"!type":"macro"}}var ni=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return c?p+=n.c:--p,f?h+=n.r:--h,a+(c?"":"$")+Dr(p)+(f?"":"$")+Hr(h)}return function(a,o){return n=o,a.replace(e,t)}})(),ey=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,MC=(function(){return function(n,t){return n.replace(ey,function(r,a,o,l,c,f){var h=pp(l)-(o?0:t.c),p=fp(f)-(c?0:t.r),m=p==0?"":c?p+1:"["+p+"]",g=h==0?"":o?h+1:"["+h+"]";return a+"R"+m+"C"+g})}})();function ty(e,n){return e.replace(ey,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Dr(pp(o)+n.c))+(l=="$"?l+c:Hr(fp(c)+n.r))})}function IC(e,n,t){var r=gi(n),a=r.s,o=ln(t),l={r:o.r-a.r,c:o.c-a.c};return ty(e,l)}function zC(e){return e.length!=1}function Eg(e){return e.replace(/_xlfn\./g,"")}function _r(e){e.l+=1}function As(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function ry(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return ny(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=As(e),c=As(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function ny(e){var n=As(e),t=As(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function LC(e,n,t){if(t.biff<8)return ny(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=As(e),l=As(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ay(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return BC(e);var r=e.read_shift(t&&t.biff==12?4:2),a=As(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function BC(e){var n=As(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function WC(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function UC(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return HC(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function HC(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function $C(e,n,t){var r=(e[e.l++]&96)>>5,a=ry(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function YC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=ry(e,o,t);return[r,a,l]}function VC(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function KC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function GC(e,n,t){var r=(e[e.l++]&96)>>5,a=LC(e,n-1,t);return[r,a]}function XC(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Cg(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function QC(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function qC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function ZC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function JC(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function eT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function sy(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function tT(e){return e.read_shift(2),sy(e)}function rT(e){return e.read_shift(2),sy(e)}function nT(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=ay(e,0,t);return[r,a]}function aT(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=UC(e,0,t);return[r,a]}function sT(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=ay(e,0,t);return[r,a,o]}function oT(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[iN[a],ly[a],r]}function iT(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:lT(e);return[a,(o[0]===0?ly:oN)[o[1]]]}function lT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function cT(e,n,t){e.l+=t&&t.biff==2?3:4}function uT(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function dT(e){return e.l++,bo[e.read_shift(1)]}function fT(e){return e.l++,e.read_shift(2)}function pT(e){return e.l++,e.read_shift(1)!==0}function hT(e){return e.l++,Qr(e)}function xT(e,n,t){return e.l++,Ol(e,n-1,t)}function mT(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=yr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=bo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Qr(e);break;case 2:t[1]=_o(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function gT(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?ko:Qu)(e));return a}function vT(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=mT(e,t.biff);return l}function yT(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function wT(e,n,t){if(t.biff==5)return kT(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function kT(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function bT(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function _T(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function ST(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function ET(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var CT=Jr,TT=Jr,NT=Jr;function Ml(e,n,t){return e.l+=2,[WC(e)]}function kp(e){return e.l+=6,[]}var DT=Ml,FT=kp,jT=kp,AT=Ml;function oy(e){return e.l+=2,[Er(e),e.read_shift(2)&1]}var PT=Ml,OT=oy,RT=kp,MT=Ml,IT=Ml,zT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function LT(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=zT[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function BT(e){return e.l+=2,[e.read_shift(4)]}function WT(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function UT(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function HT(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function $T(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function YT(e){return e.l+=4,[0,0]}var Tg={1:{n:"PtgExp",f:uT},2:{n:"PtgTbl",f:NT},3:{n:"PtgAdd",f:_r},4:{n:"PtgSub",f:_r},5:{n:"PtgMul",f:_r},6:{n:"PtgDiv",f:_r},7:{n:"PtgPower",f:_r},8:{n:"PtgConcat",f:_r},9:{n:"PtgLt",f:_r},10:{n:"PtgLe",f:_r},11:{n:"PtgEq",f:_r},12:{n:"PtgGe",f:_r},13:{n:"PtgGt",f:_r},14:{n:"PtgNe",f:_r},15:{n:"PtgIsect",f:_r},16:{n:"PtgUnion",f:_r},17:{n:"PtgRange",f:_r},18:{n:"PtgUplus",f:_r},19:{n:"PtgUminus",f:_r},20:{n:"PtgPercent",f:_r},21:{n:"PtgParen",f:_r},22:{n:"PtgMissArg",f:_r},23:{n:"PtgStr",f:xT},26:{n:"PtgSheet",f:WT},27:{n:"PtgEndSheet",f:UT},28:{n:"PtgErr",f:dT},29:{n:"PtgBool",f:pT},30:{n:"PtgInt",f:fT},31:{n:"PtgNum",f:hT},32:{n:"PtgArray",f:XC},33:{n:"PtgFunc",f:oT},34:{n:"PtgFuncVar",f:iT},35:{n:"PtgName",f:yT},36:{n:"PtgRef",f:nT},37:{n:"PtgArea",f:$C},38:{n:"PtgMemArea",f:bT},39:{n:"PtgMemErr",f:CT},40:{n:"PtgMemNoMem",f:TT},41:{n:"PtgMemFunc",f:_T},42:{n:"PtgRefErr",f:ST},43:{n:"PtgAreaErr",f:VC},44:{n:"PtgRefN",f:aT},45:{n:"PtgAreaN",f:GC},46:{n:"PtgMemAreaN",f:HT},47:{n:"PtgMemNoMemN",f:$T},57:{n:"PtgNameX",f:wT},58:{n:"PtgRef3d",f:sT},59:{n:"PtgArea3d",f:YC},60:{n:"PtgRefErr3d",f:ET},61:{n:"PtgAreaErr3d",f:KC},255:{}},VT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},KT={1:{n:"PtgElfLel",f:oy},2:{n:"PtgElfRw",f:MT},3:{n:"PtgElfCol",f:DT},6:{n:"PtgElfRwV",f:IT},7:{n:"PtgElfColV",f:AT},10:{n:"PtgElfRadical",f:PT},11:{n:"PtgElfRadicalS",f:RT},13:{n:"PtgElfColS",f:FT},15:{n:"PtgElfColSV",f:jT},16:{n:"PtgElfRadicalLel",f:OT},25:{n:"PtgList",f:LT},29:{n:"PtgSxName",f:BT},255:{}},GT={0:{n:"PtgAttrNoop",f:YT},1:{n:"PtgAttrSemi",f:eT},2:{n:"PtgAttrIf",f:ZC},4:{n:"PtgAttrChoose",f:QC},8:{n:"PtgAttrGoto",f:qC},16:{n:"PtgAttrSum",f:cT},32:{n:"PtgAttrBaxcel",f:Cg},33:{n:"PtgAttrBaxcel",f:Cg},64:{n:"PtgAttrSpace",f:tT},65:{n:"PtgAttrSpaceSemi",f:rT},128:{n:"PtgAttrIfError",f:JC},255:{}};function Il(e,n,t,r){if(r.biff<8)return Jr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=vT(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=gT(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(Jr(e,n)),o}function zl(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Tg[o]||Tg[VT[o]],(o===24||o===25)&&(a=(o===24?KT:GT)[e[e.l+1]]),!a||!a.f?Jr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function XT(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var QT={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function qT(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function iy(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Ng(e,n,t){var r=iy(e,n,t);return r=="#REF"?r:qT(r,t)}function Xr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,h,p,m=0,g=0,v,k="";if(!e[0]||!e[0][0])return"";for(var w=-1,b="",E=0,N=e[0].length;E<N;++E){var S=e[0][E];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),w>=0){switch(e[0][w][1][0]){case 0:b=pr(" ",e[0][w][1][1]);break;case 1:b=pr("\r",e[0][w][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}h=h+b,w=-1}c.push(h+QT[S[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=dl(S[1][1],l,a),c.push(fl(p,o));break;case"PtgRefN":p=t?dl(S[1][1],t,a):S[1][1],c.push(fl(p,o));break;case"PtgRef3d":m=S[1][1],p=dl(S[1][2],l,a),k=Ng(r,m,a),c.push(k+"!"+fl(p,o));break;case"PtgFunc":case"PtgFuncVar":var z=S[1][0],te=S[1][1];z||(z=0),z&=127;var V=z==0?[]:c.slice(-z);c.length-=z,te==="User"&&(te=V.shift()),c.push(te+"("+V.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":v=lg(S[1][1],t?{s:t}:l,a),c.push(J0(v,a));break;case"PtgArea":v=lg(S[1][1],l,a),c.push(J0(v,a));break;case"PtgArea3d":m=S[1][1],v=S[1][2],k=Ng(r,m,a),c.push(k+"!"+J0(v,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=S[1][2];var D=(r.names||[])[g-1]||(r[0]||[])[g],H=D?D.Name:"SH33TJSNAME"+String(g);H&&H.slice(0,6)=="_xlfn."&&!a.xlfn&&(H=H.slice(6)),c.push(H);break;case"PtgNameX":var L=S[1][1];g=S[1][2];var ae;if(a.biff<=5)L<0&&(L=-L),r[L]&&(ae=r[L][g]);else{var Q="";if(((r[L]||[])[0]||[])[0]==14849||(((r[L]||[])[0]||[])[0]==1025?r[L][g]&&r[L][g].itab>0&&(Q=r.SheetNames[r[L][g].itab-1]+"!"):Q=r.SheetNames[g-1]+"!"),r[L]&&r[L][g])Q+=r[L][g].Name;else if(r[0]&&r[0][g])Q+=r[0][g].Name;else{var Y=(iy(r,L,a)||"").split(";;");Y[g-1]?Q=Y[g-1]:Q+="SH33TJSERRX"}c.push(Q);break}ae||(ae={Name:"SH33TJSERRY"}),c.push(ae.Name);break;case"PtgParen":var ue="(",le=")";if(w>=0){switch(b="",e[0][w][1][0]){case 2:ue=pr(" ",e[0][w][1][1])+ue;break;case 3:ue=pr("\r",e[0][w][1][1])+ue;break;case 4:le=pr(" ",e[0][w][1][1])+le;break;case 5:le=pr("\r",e[0][w][1][1])+le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}c.push(ue+c.pop()+le);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var oe={c:t.c,r:t.r};if(r.sharedf[wt(p)]){var pe=r.sharedf[wt(p)];c.push(Xr(pe,l,oe,r,a))}else{var G=!1;for(f=0;f!=r.arrayf.length;++f)if(h=r.arrayf[f],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Xr(h[1],l,oe,r,a)),G=!0;break}G||c.push(S[1])}break;case"PtgArray":c.push("{"+XT(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&ie.indexOf(e[0][E][0])==-1){S=e[0][w];var B=!0;switch(S[1][0]){case 4:B=!1;case 0:b=pr(" ",S[1][1]);break;case 5:B=!1;case 1:b=pr("\r",S[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((B?b:"")+c.pop()+(B?"":b)),w=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function ZT(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=zl(e,l,t);return n!==l+a&&(o=Il(e,n-l-a,c,t)),e.l=r,[c,o]}function JT(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=zl(e,l,t);return n!==l+a&&(o=Il(e,n-l-a,c,t)),e.l=r,[c,o]}function eN(e,n,t,r){var a=e.l+n,o=zl(e,r,t),l;return a!==e.l&&(l=Il(e,a-e.l,o,t)),[o,l]}function tN(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=zl(e,o,t);return o==65535?[[],Jr(e,n-2)]:(n!==o+2&&(a=Il(e,r-o-2,l,t)),[l,a])}function rN(e){var n;if(Ha(e,e.l+6)!==65535)return[Qr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function rf(e,n,t){var r=e.l+n,a=Fa(e);t.biff==2&&++e.l;var o=rN(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=JT(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function qu(e,n,t){var r=e.read_shift(4),a=zl(e,r,t),o=e.read_shift(4),l=o>0?Il(e,o,a,t):null;return[a,l]}var nN=qu,Zu=qu,aN=qu,sN=qu,oN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ly={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function nf(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var ml={},ai={};function gl(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function cy(e,n,t,r,a,o){try{r.cellNF&&(e.z=kt[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Mr(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(kt[n]==null&&ao(lb[n]||"General",n),e.t==="e")e.w=e.w||bo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v);else if(e.t==="d"){var l=fn(e.v);(l|0)===l?e.w=l.toString(10):e.w=kl(l)}else{if(e.v===void 0)return"";e.w=uo(e.v,ai)}else e.t==="d"?e.w=Un(n,fn(e.v),ai):e.w=Un(n,e.v,ai)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Fu(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Fu(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function lN(e,n){var t=hr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=At(t))}var cN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uN=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dN=/<(?:\w:)?hyperlink [^>]*>/mg,fN=/"(\w*:\w*)"/,pN=/<(?:\w:)?col\b[^>]*[\/]?>/g,hN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xN=/<(?:\w:)?pageMargins[^>]*\/>/g,uy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,mN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,gN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vN(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",m=e.match(uN);m?(h=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):h=p=e;var g=h.match(uy);g?bp(g[0],c,a,t):(g=h.match(mN))&&yN(g[0],g[1]||"",c,a,t);var v=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var k=h.slice(v,v+50).match(fN);k&&lN(c,k[1])}var w=h.match(gN);w&&w[1]&&EN(w[1],a);var b=[];if(n.cellStyles){var E=h.match(pN);E&&bN(b,E)}m&&CN(m[1],c,n,f,o,l);var N=p.match(hN);N&&(c["!autofilter"]=_N(N[0]));var S=[],z=p.match(cN);if(z)for(v=0;v!=z.length;++v)S[v]=hr(z[v].slice(z[v].indexOf('"')+1));var te=p.match(dN);te&&wN(c,te,r);var V=p.match(xN);if(V&&(c["!margins"]=kN(vt(V[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=At(f)),n.sheetRows>0&&c["!ref"]){var D=hr(c["!ref"]);n.sheetRows<=+D.e.r&&(D.e.r=n.sheetRows-1,D.e.r>f.e.r&&(D.e.r=f.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>f.e.c&&(D.e.c=f.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),c["!fullref"]=c["!ref"],c["!ref"]=At(D))}return b.length>0&&(c["!cols"]=b),S.length>0&&(c["!merges"]=S),c}function bp(e,n,t,r){var a=vt(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=Mt(tr(a.codeName)))}function yN(e,n,t,r,a){bp(e.slice(0,e.indexOf(">")),t,r,a)}function wN(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=vt(tr(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Mt(o.location))):(o.Target="#"+Mt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=hr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var h=c.s.c;h<=c.e.c;++h){var p=wt({c:h,r:f});r?(e[f]||(e[f]=[]),e[f][h]||(e[f][h]={t:"z",v:void 0}),e[f][h].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function kN(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function bN(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=vt(n[r],!0);a.hidden&&(a.hidden=or(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,wp(a.width)),ci(a);o<=l;)e[o++]=Ur(a)}}function _N(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var SN=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function EN(e,n){n.Views||(n.Views=[{}]),(e.match(SN)||[]).forEach(function(t,r){var a=vt(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),or(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var CN=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=bl("v"),l=bl("f");return function(f,h,p,m,g,v){for(var k=0,w="",b=[],E=[],N=0,S=0,z=0,te="",V,D,H=0,L=0,ae,Q,Y=0,ue=0,le=Array.isArray(v.CellXf),oe,pe=[],G=[],ie=Array.isArray(h),B=[],de={},I=!1,j=!!p.sheetStubs,re=f.split(n),T=0,F=re.length;T!=F;++T){w=re[T].trim();var O=w.length;if(O!==0){var R=0;e:for(k=0;k<O;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(p&&p.cellStyles){if(D=vt(w.slice(R,k),!0),H=D.r!=null?parseInt(D.r,10):H+1,L=-1,p.sheetRows&&p.sheetRows<H)continue;de={},I=!1,D.ht&&(I=!0,de.hpt=parseFloat(D.ht),de.hpx=Cl(de.hpt)),D.hidden=="1"&&(I=!0,de.hidden=!0),D.outlineLevel!=null&&(I=!0,de.level=+D.outlineLevel),I&&(B[H-1]=de)}break;case"<":R=k;break}if(R>=k)break;if(D=vt(w.slice(R,k),!0),H=D.r!=null?parseInt(D.r,10):H+1,L=-1,!(p.sheetRows&&p.sheetRows<H)){m.s.r>H-1&&(m.s.r=H-1),m.e.r<H-1&&(m.e.r=H-1),p&&p.cellStyles&&(de={},I=!1,D.ht&&(I=!0,de.hpt=parseFloat(D.ht),de.hpx=Cl(de.hpt)),D.hidden=="1"&&(I=!0,de.hidden=!0),D.outlineLevel!=null&&(I=!0,de.level=+D.outlineLevel),I&&(B[H-1]=de)),b=w.slice(k).split(e);for(var J=0;J!=b.length&&b[J].trim().charAt(0)=="<";++J);for(b=b.slice(J),k=0;k!=b.length;++k)if(w=b[k].trim(),w.length!==0){if(E=w.match(t),N=k,S=0,z=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,E!=null&&E.length===2){for(N=0,te=E[1],S=0;S!=te.length&&!((z=te.charCodeAt(S)-64)<1||z>26);++S)N=26*N+z;--N,L=N}else++L;for(S=0;S!=w.length&&w.charCodeAt(S)!==62;++S);if(++S,D=vt(w.slice(0,S),!0),D.r||(D.r=wt({r:H-1,c:L})),te=w.slice(S),V={t:""},(E=te.match(o))!=null&&E[1]!==""&&(V.v=Mt(E[1])),p.cellFormula){if((E=te.match(l))!=null&&E[1]!==""){if(V.f=Mt(tr(E[1])).replace(/\r\n/g,`
`),p.xlfn||(V.f=Eg(V.f)),E[0].indexOf('t="array"')>-1)V.F=(te.match(a)||[])[1],V.F.indexOf(":")>-1&&pe.push([hr(V.F),V.F]);else if(E[0].indexOf('t="shared"')>-1){Q=vt(E[0]);var Z=Mt(tr(E[1]));p.xlfn||(Z=Eg(Z)),G[parseInt(Q.si,10)]=[Q,Z,D.r]}}else(E=te.match(/<f[^>]*\/>/))&&(Q=vt(E[0]),G[Q.si]&&(V.f=IC(G[Q.si][1],G[Q.si][2],D.r)));var U=ln(D.r);for(S=0;S<pe.length;++S)U.r>=pe[S][0].s.r&&U.r<=pe[S][0].e.r&&U.c>=pe[S][0].s.c&&U.c<=pe[S][0].e.c&&(V.F=pe[S][1])}if(D.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(j)V.t="z";else continue;else V.t=D.t||"n";switch(m.s.c>L&&(m.s.c=L),m.e.c<L&&(m.e.c=L),V.t){case"n":if(V.v==""||V.v==null){if(!j)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!j)continue;V.t="z"}else ae=ml[parseInt(V.v,10)],V.v=ae.t,V.r=ae.r,p.cellHTML&&(V.h=ae.h);break;case"str":V.t="s",V.v=V.v!=null?tr(V.v):"",p.cellHTML&&(V.h=cp(V.v));break;case"inlineStr":E=te.match(r),V.t="s",E!=null&&(ae=yp(E[1]))?(V.v=ae.t,p.cellHTML&&(V.h=ae.h)):V.v="";break;case"b":V.v=or(V.v);break;case"d":p.cellDates?V.v=Mr(V.v,1):(V.v=fn(Mr(V.v,1)),V.t="n");break;case"e":(!p||p.cellText!==!1)&&(V.w=V.v),V.v=j1[V.v];break}if(Y=ue=0,oe=null,le&&D.s!==void 0&&(oe=v.CellXf[D.s],oe!=null&&(oe.numFmtId!=null&&(Y=oe.numFmtId),p.cellStyles&&oe.fillId!=null&&(ue=oe.fillId))),cy(V,Y,ue,p,g,v),p.cellDates&&le&&V.t=="n"&&mi(kt[Y])&&(V.t="d",V.v=Xu(V.v)),D.cm&&p.xlmeta){var xe=(p.xlmeta.Cell||[])[+D.cm-1];xe&&xe.type=="XLDAPR"&&(V.D=!0)}if(ie){var M=ln(D.r);h[M.r]||(h[M.r]=[]),h[M.r][M.c]=V}else h[D.r]=V}}}}B.length>0&&(h["!rows"]=B)}})();function TN(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var NN=ko;function DN(){}function FN(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=Zb(e),t}function jN(e){var n=Vn(e);return[n]}function AN(e){var n=wo(e);return[n]}function PN(e){var n=Vn(e),t=e.read_shift(1);return[n,t,"b"]}function ON(e){var n=wo(e),t=e.read_shift(1);return[n,t,"b"]}function RN(e){var n=Vn(e),t=e.read_shift(1);return[n,t,"e"]}function MN(e){var n=wo(e),t=e.read_shift(1);return[n,t,"e"]}function IN(e){var n=Vn(e),t=e.read_shift(4);return[n,t,"s"]}function zN(e){var n=wo(e),t=e.read_shift(4);return[n,t,"s"]}function LN(e){var n=Vn(e),t=Qr(e);return[n,t,"n"]}function dy(e){var n=wo(e),t=Qr(e);return[n,t,"n"]}function BN(e){var n=Vn(e),t=mp(e);return[n,t,"n"]}function WN(e){var n=wo(e),t=mp(e);return[n,t,"n"]}function UN(e){var n=Vn(e),t=hp(e);return[n,t,"is"]}function HN(e){var n=Vn(e),t=Zr(e);return[n,t,"str"]}function $N(e){var n=wo(e),t=Zr(e);return[n,t,"str"]}function YN(e,n,t){var r=e.l+n,a=Vn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}function VN(e,n,t){var r=e.l+n,a=Vn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}function KN(e,n,t){var r=e.l+n,a=Vn(e);a.r=t["!row"];var o=Qr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}function GN(e,n,t){var r=e.l+n,a=Vn(e);a.r=t["!row"];var o=Zr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}var XN=ko;function QN(e,n){var t=e.l+n,r=ko(e),a=xp(e),o=Zr(e),l=Zr(e),c=Zr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function qN(){}function ZN(e,n,t){var r=e.l+n,a=N1(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=nN(e,r-e.l,t);l[1]=c}else e.l=r;return l}function JN(e,n,t){var r=e.l+n,a=ko(e),o=[a];if(t.cellFormula){var l=sN(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var eD=["left","right","top","bottom","header","footer"];function tD(e){var n={};return eD.forEach(function(t){n[t]=Qr(e)}),n}function rD(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function nD(){}function aD(){}function sD(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,v,k,w,b,E,N,S,z,te,V=[];c.biff=12,c["!row"]=0;var D=0,H=!1,L=[],ae={},Q=c.supbooks||a.supbooks||[[]];if(Q.sharedf=ae,Q.arrayf=L,Q.SheetNames=a.SheetNames||a.Sheets.map(function(ie){return ie.name}),!c.supbooks&&(c.supbooks=Q,a.Names))for(var Y=0;Y<a.Names.length;++Y)Q[0][Y+1]=a.Names[Y];var ue=[],le=[],oe=!1;Pu[16]={n:"BrtShortReal",f:dy};var pe;if(Ja(e,function(B,de,I){if(!g)switch(I){case 148:h=B;break;case 0:v=B,c.sheetRows&&c.sheetRows<=v.r&&(g=!0),z=Hr(b=v.r),c["!row"]=v.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=Cl(B.hpt)),le[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:B[2]},B[2]){case"n":k.v=B[1];break;case"s":S=ml[B[1]],k.v=S.t,k.r=S.r;break;case"b":k.v=!!B[1];break;case"e":k.v=B[1],c.cellText!==!1&&(k.w=bo[k.v]);break;case"str":k.t="s",k.v=B[1];break;case"is":k.t="s",k.v=B[1].t;break}if((w=l.CellXf[B[0].iStyleRef])&&cy(k,w.numFmtId,null,c,o,l),E=B[0].c==-1?E+1:B[0].c,c.dense?(f[b]||(f[b]=[]),f[b][E]=k):f[Dr(E)+z]=k,c.cellFormula){for(H=!1,D=0;D<L.length;++D){var j=L[D];v.r>=j[0].s.r&&v.r<=j[0].e.r&&E>=j[0].s.c&&E<=j[0].e.c&&(k.F=At(j[0]),H=!0)}!H&&B.length>3&&(k.f=B[3])}if(p.s.r>v.r&&(p.s.r=v.r),p.s.c>E&&(p.s.c=E),p.e.r<v.r&&(p.e.r=v.r),p.e.c<E&&(p.e.c=E),c.cellDates&&w&&k.t=="n"&&mi(kt[w.numFmtId])){var re=to(k.v);re&&(k.t="d",k.v=new Date(re.y,re.m-1,re.d,re.H,re.M,re.S,re.u))}pe&&(pe.type=="XLDAPR"&&(k.D=!0),pe=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;k={t:"z",v:void 0},E=B[0].c==-1?E+1:B[0].c,c.dense?(f[b]||(f[b]=[]),f[b][E]=k):f[Dr(E)+z]=k,p.s.r>v.r&&(p.s.r=v.r),p.s.c>E&&(p.s.c=E),p.e.r<v.r&&(p.e.r=v.r),p.e.c<E&&(p.e.c=E),pe&&(pe.type=="XLDAPR"&&(k.D=!0),pe=void 0);break;case 176:V.push(B);break;case 49:pe=((c.xlmeta||{}).Cell||[])[B-1];break;case 494:var T=r["!id"][B.relId];for(T?(B.Target=T.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=T):B.relId==""&&(B.Target="#"+B.loc),b=B.rfx.s.r;b<=B.rfx.e.r;++b)for(E=B.rfx.s.c;E<=B.rfx.e.c;++E)c.dense?(f[b]||(f[b]=[]),f[b][E]||(f[b][E]={t:"z",v:void 0}),f[b][E].l=B):(N=wt({c:E,r:b}),f[N]||(f[N]={t:"z",v:void 0}),f[N].l=B);break;case 426:if(!c.cellFormula)break;L.push(B),te=c.dense?f[b][E]:f[Dr(E)+z],te.f=Xr(B[1],p,{r:v.r,c:E},Q,c),te.F=At(B[0]);break;case 427:if(!c.cellFormula)break;ae[wt(B[0].s)]=B[1],te=c.dense?f[b][E]:f[Dr(E)+z],te.f=Xr(B[1],p,{r:v.r,c:E},Q,c);break;case 60:if(!c.cellStyles)break;for(;B.e>=B.s;)ue[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},oe||(oe=!0,wp(B.w/256)),ci(ue[B.e+1]);break;case 161:f["!autofilter"]={ref:At(B)};break;case 476:f["!margins"]=B;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),B.name&&(a.Sheets[t].CodeName=B.name),(B.above||B.left)&&(f["!outline"]={above:B.above,left:B.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),B.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!de.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=At(h||p)),c.sheetRows&&f["!ref"]){var G=hr(f["!ref"]);c.sheetRows<=+G.e.r&&(G.e.r=c.sheetRows-1,G.e.r>p.e.r&&(G.e.r=p.e.r),G.e.r<G.s.r&&(G.s.r=G.e.r),G.e.c>p.e.c&&(G.e.c=p.e.c),G.e.c<G.s.c&&(G.s.c=G.e.c),f["!fullref"]=f["!ref"],f["!ref"]=At(G))}return V.length>0&&(f["!merges"]=V),ue.length>0&&(f["!cols"]=ue),le.length>0&&(f["!rows"]=le),f}function oD(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=Mt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function iD(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=oD(m);p.s.r=p.s.c=0,p.e.c=c,h=Dr(c),g[0].forEach(function(v,k){l[h+Hr(k)]={t:"n",v,z:g[1]},f=k}),p.e.r<f&&(p.e.r=f),++c}),c>0&&(l["!ref"]=At(p)),l}function lD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(uy);return c&&bp(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function cD(e,n){e.l+=10;var t=Zr(e);return{name:t}}function uD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Ja(e,function(f,h,p){switch(p){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var fy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],fD=[],pD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Fg(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=or(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function jg(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=or(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function py(e){jg(e.WBProps,fy),jg(e.CalcPr,pD),Fg(e.WBView,dD),Fg(e.Sheets,fD),ai.date1904=or(e.WBProps.date1904)}var hD="][*?/\\".split("");function xD(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return hD.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var mD=/<\w+:workbook/;function gD(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(en,function(f,h){var p=vt(f);switch(Da(p[0])){case"<?xml":break;case"<workbook":f.match(mD)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fy.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":t.WBProps[m[0]]=or(p[m[0]]);break;case"int":t.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:t.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(t.WBProps.CodeName=tr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Mt(tr(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=tr(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),or(p.hidden||"0")&&(o.Hidden=!0),l=h+f.length;break;case"</definedName>":o.Ref=Mt(tr(e.slice(l,h))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),Rb.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return py(t),t}function vD(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Cf(e),t.name=Zr(e),t}function yD(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?Zr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function wD(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function kD(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=Jb(e),l=aN(e,0,t),c=xp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function bD(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Pu[16]={n:"BrtFRTArchID$",f:wD},Ja(e,function(f,h,p){switch(p){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Xr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(p),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},n),py(t),t.Names=o,t.supbooks=l,t}function _D(e,n,t){return n.slice(-4)===".bin"?bD(e,t):gD(e,t)}function SD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?sD(e,r,t,a,o,l,c):vN(e,r,t,a,o,l,c)}function ED(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?uD(e,r,t,a,o):lD(e,r,t,a,o)}function CD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?OC():RC()}function TD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?AC():PC()}function ND(e,n,t,r){return n.slice(-4)===".bin"?XE(e,t,r):HE(e,t,r)}function DD(e,n,t){return J1(e,t)}function FD(e,n,t){return n.slice(-4)===".bin"?dE(e,t):cE(e,t)}function jD(e,n,t){return n.slice(-4)===".bin"?DC(e,t):SC(e,t)}function AD(e,n,t){return n.slice(-4)===".bin"?kC(e):yC(e)}function PD(e,n,t,r){return t.slice(-4)===".bin"?bC(e,n,t,r):void 0}function OD(e,n,t){return n.slice(-4)===".bin"?gC(e,n,t):vC(e,n,t)}var hy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ea(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(hy),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(xy),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function RD(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(hy),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(xy),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var vl;function MD(e,n){var t=vl[e]||Mt(e);return t==="General"?uo(n):Un(t,n)}function ID(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=or(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Mr(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Mt(n)]=a}function zD(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=MD(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=vl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&mi(r)){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function LD(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=IE[r.Pattern]||r.Pattern)}e[n.ID]=n}function BD(e,n,t,r,a,o,l,c,f,h){var p="General",m=r.StyleID,g={};h=h||{};var v=[],k=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&l&&(m=l.StyleID);o[m]!==void 0&&(o[m].nf&&(p=o[m].nf),o[m].Interior&&v.push(o[m].Interior),!!o[m].Parent);)m=o[m].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=or(e);break;case"String":r.t="s",r.r=Jm(Mt(e)),r.v=e.indexOf("<")>-1?Mt(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Mr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Mt(e):r.v<60&&(r.v=r.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=j1[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=Jm(n||e));break}if(zD(r,p,h),h.cellFormula!==!1)if(r.Formula){var w=Mt(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=ni(w,a),delete r.Formula,r.ArrayRange=="RC"?r.F=ni("RC:RC",a):r.ArrayRange&&(r.F=ni(r.ArrayRange,a),f.push([hr(r.F),r.F]))}else for(k=0;k<f.length;++k)a.r>=f[k][0].s.r&&a.r<=f[k][0].e.r&&a.c>=f[k][0].s.c&&a.c<=f[k][0].e.c&&(r.F=f[k][1]);h.cellStyles&&(v.forEach(function(b){!g.patternType&&b.patternType&&(g.patternType=b.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function WD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function af(e,n){var t=n||{};n1();var r=al(up(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=tr(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Ur(t);return l.type="string",Sl.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Fe){a.indexOf("<"+Fe)>=0&&(o=!0)}),o)return QD(r,t);vl={"General Number":"General","General Date":kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kt[15],"Short Date":kt[14],"Long Time":kt[19],"Medium Time":kt[18],"Short Time":kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kt[2],Standard:kt[4],Percent:kt[10],Scientific:kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],h,p={},m=[],g=t.dense?[]:{},v="",k={},w={},b=ea('<Data ss:Type="String">'),E=0,N=0,S=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},V={},D="",H=0,L=[],ae={},Q={},Y=0,ue=[],le=[],oe={},pe=[],G,ie=!1,B=[],de=[],I={},j=0,re=0,T={Sheets:[],WBProps:{date1904:!1}},F={};_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var O="";c=_l.exec(r);)switch(c[3]=(O=c[3]).toLowerCase()){case"data":if(O=="data"){if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?BD(r.slice(E,c.index),D,b,f[f.length-1][0]=="comment"?oe:k,{c:N,r:S},te,pe[N],w,B,t):(D="",b=ea(c[0]),E=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(le.length>0&&(k.c=le),(!t.sheetRows||t.sheetRows>S)&&k.v!==void 0&&(t.dense?(g[S]||(g[S]=[]),g[S][N]=k):g[Dr(N)+Hr(S)]=k),k.HRef&&(k.l={Target:Mt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(j=N+(parseInt(k.MergeAcross,10)|0),re=S+(parseInt(k.MergeDown,10)|0),L.push({s:{c:N,r:S},e:{c:j,r:re}})),!t.sheetStubs)k.MergeAcross?N=j+1:++N;else if(k.MergeAcross||k.MergeDown){for(var R=N;R<=j;++R)for(var J=S;J<=re;++J)(R>N||J>S)&&(t.dense?(g[J]||(g[J]=[]),g[J][R]={t:"z"}):g[Dr(R)+Hr(J)]={t:"z"});N=j+1}else++N;else k=RD(c[0]),k.Index&&(N=+k.Index-1),N<z.s.c&&(z.s.c=N),N>z.e.c&&(z.e.c=N),c[0].slice(-2)==="/>"&&++N,le=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<z.s.r&&(z.s.r=S),S>z.e.r&&(z.e.r=S),c[0].slice(-2)==="/>"&&(w=ea(c[0]),w.Index&&(S=+w.Index-1)),N=0,++S):(w=ea(c[0]),w.Index&&(S=+w.Index-1),I={},(w.AutoFitHeight=="0"||w.Height)&&(I.hpx=parseInt(w.Height,10),I.hpt=Z1(I.hpx),de[S]=I),w.Hidden=="1"&&(I.hidden=!0,de[S]=I));break;case"worksheet":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));m.push(v),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(g["!ref"]=At(z),t.sheetRows&&t.sheetRows<=z.e.r&&(g["!fullref"]=g["!ref"],z.e.r=t.sheetRows-1,g["!ref"]=At(z))),L.length&&(g["!merges"]=L),pe.length>0&&(g["!cols"]=pe),de.length>0&&(g["!rows"]=de),p[v]=g}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=N=0,f.push([c[3],!1]),h=ea(c[0]),v=Mt(h.Name),g=t.dense?[]:{},L=[],B=[],de=[],F={name:v,Hidden:0},T.Sheets.push(F);break;case"table":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),pe=[],ie=!1}break;case"style":c[1]==="/"?LD(te,V,t):V=ea(c[0]);break;case"numberformat":V.nf=Mt(ea(c[0]).Format||"General"),vl[V.nf]&&(V.nf=vl[V.nf]);for(var Z=0;Z!=392&&kt[Z]!=V.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(kt[Z]==null){ao(V.nf,Z);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(G=ea(c[0]),G.Hidden&&(G.hidden=!0,delete G.Hidden),G.Width&&(G.wpx=parseInt(G.Width,10)),!ie&&G.wpx>10){ie=!0,sn=Q1;for(var U=0;U<pe.length;++U)pe[U]&&ci(pe[U])}ie&&ci(G),pe[G.Index-1||pe.length]=G;for(var xe=0;xe<+G.Span;++xe)pe[pe.length]=Ur(G);break;case"namedrange":if(c[1]==="/")break;T.Names||(T.Names=[]);var M=vt(c[0]),ve={Name:M.Name,Ref:ni(M.RefersTo.slice(1),{r:0,c:0})};T.Sheets.length>0&&(ve.Sheet=T.Sheets.length-1),T.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?D+=r.slice(H,c.index):H=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;V.Interior=ea(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?S_(ae,O,r.slice(Y,c.index)):Y=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));WD(oe),le.push(oe)}else f.push([c[3],!1]),h=ea(c[0]),oe={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ye=ea(c[0]);g["!autofilter"]={ref:ni(ye.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return Ig(r,t);var Me=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Me=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Me=!1}break;case"excelworkbook":switch(c[3]){case"date1904":T.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Me=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Me=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(Y,c.index)){case"SheetHidden":F.Hidden=1;break;case"SheetVeryHidden":F.Hidden=2;break}else Y=c.index+c[0].length;break;case"header":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+vt(c[0]).Margin)||(g["!margins"].header=+vt(c[0]).Margin);break;case"footer":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+vt(c[0]).Margin)||(g["!margins"].footer=+vt(c[0]).Margin);break;case"pagemargins":var Pe=vt(c[0]);g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+Pe.Top)||(g["!margins"].top=+Pe.Top),isNaN(+Pe.Left)||(g["!margins"].left=+Pe.Left),isNaN(+Pe.Right)||(g["!margins"].right=+Pe.Right),isNaN(+Pe.Bottom)||(g["!margins"].bottom=+Pe.Bottom);break;case"displayrighttoleft":T.Views||(T.Views=[]),T.Views[0]||(T.Views[0]={}),T.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Me=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Me=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Me=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Me=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Me=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Me=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Me=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Me=!1}break;case"smarttags":break;default:Me=!1;break}if(Me||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?ID(Q,O,ue,r.slice(Y,c.index)):(ue=c,Y=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var ce={};return!t.bookSheets&&!t.bookProps&&(ce.Sheets=p),ce.SheetNames=m,ce.Workbook=T,ce.SSF=Ur(kt),ce.Props=ae,ce.Custprops=Q,ce}function Ff(e,n){switch(Ep(n=n||{}),n.type||"base64"){case"base64":return af(Tn(e),n);case"binary":case"buffer":case"file":return af(e,n);case"array":return af(yo(e),n)}}function UD(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=r_(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=n_(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var HD=[60,1084,2066,2165,2175];function $D(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=Ha(t,t.l),h=jf[f],p=0;h!=null&&HD.indexOf(f)>-1;)o=Ha(t,t.l+2),p=t.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),c=t.slice(p,t.l+4+o),l.push(c),t.l+=4+o,h=jf[f=Ha(t,t.l)];var m=_s(l);Br(m,0);var g=0;m.lens=[];for(var v=0;v<l.length;++v)m.lens.push(g),g+=l[v].length;if(m.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+r;return n.f(m,m.length,a)}function xa(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=kt[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=Un(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&mi(kt[r]||String(r))){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function iu(e,n,t){return{v:e,ixfe:n,t}}function YD(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],h="",p={},m,g="",v,k,w,b,E={},N=[],S,z,te=[],V=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},H={},L=function(ut){return ut<8?so[ut]:ut<64&&V[ut-8]||so[ut]},ae=function(ut,_t,Ht){var Dt=_t.XF.data;if(!(!Dt||!Dt.patternType||!Ht||!Ht.cellStyles)){_t.s={},_t.s.patternType=Dt.patternType;var Zt;(Zt=El(L(Dt.icvFore)))&&(_t.s.fgColor={rgb:Zt}),(Zt=El(L(Dt.icvBack)))&&(_t.s.bgColor={rgb:Zt})}},Q=function(ut,_t,Ht){if(!(I>1)&&!(Ht.sheetRows&&ut.r>=Ht.sheetRows)){if(Ht.cellStyles&&_t.XF&&_t.XF.data&&ae(ut,_t,Ht),delete _t.ixfe,delete _t.XF,m=ut,g=wt(ut),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<l.s.r&&(l.s.r=ut.r),ut.c<l.s.c&&(l.s.c=ut.c),ut.r+1>l.e.r&&(l.e.r=ut.r+1),ut.c+1>l.e.c&&(l.e.c=ut.c+1),Ht.cellFormula&&_t.f){for(var Dt=0;Dt<N.length;++Dt)if(!(N[Dt][0].s.c>ut.c||N[Dt][0].s.r>ut.r)&&!(N[Dt][0].e.c<ut.c||N[Dt][0].e.r<ut.r)){_t.F=At(N[Dt][0]),(N[Dt][0].s.c!=ut.c||N[Dt][0].s.r!=ut.r)&&delete _t.f,_t.f&&(_t.f=""+Xr(N[Dt][1],l,ut,B,Y));break}}Ht.dense?(a[ut.r]||(a[ut.r]=[]),a[ut.r][ut.c]=_t):a[g]=_t}},Y={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(Y.password=n.password);var ue,le=[],oe=[],pe=[],G=[],ie=!1,B=[];B.SheetNames=Y.snames,B.sharedf=Y.sharedf,B.arrayf=Y.arrayf,B.names=[],B.XTI=[];var de=0,I=0,j=0,re=[],T=[],F;Y.codepage=1200,na(1200);for(var O=!1;e.l<e.length-1;){var R=e.l,J=e.read_shift(2);if(J===0&&de===10)break;var Z=e.l===e.length?0:e.read_shift(2),U=jf[J];if(U&&U.f){if(n.bookSheets&&de===133&&J!==133)break;if(de=J,U.r===2||U.r==12){var xe=e.read_shift(2);if(Z-=2,!Y.enc&&xe!==J&&((xe&255)<<8|xe>>8)!==J)throw new Error("rt mismatch: "+xe+"!="+J);U.r==12&&(e.l+=10,Z-=10)}var M={};if(J===10?M=U.f(e,Z,Y):M=$D(J,U,e,Z,Y),I==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(J){case 34:t.opts.Date1904=D.WBProps.date1904=M;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=M,!n.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=M;break;case 66:var ve=Number(M);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}na(Y.codepage=ve),O=!0;break;case 317:Y.rrtabid=M;break;case 25:Y.winlocked=M;break;case 439:t.opts.RefreshAll=M;break;case 12:t.opts.CalcCount=M;break;case 16:t.opts.CalcDelta=M;break;case 17:t.opts.CalcIter=M;break;case 13:t.opts.CalcMode=M;break;case 14:t.opts.CalcPrecision=M;break;case 95:t.opts.CalcSaveRecalc=M;break;case 15:Y.CalcRefMode=M;break;case 2211:t.opts.FullCalc=M;break;case 129:M.fDialog&&(a["!type"]="dialog"),M.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),M.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:te.push(M);break;case 430:B.push([M]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(M);break;case 24:case 536:F={Name:M.Name,Ref:Xr(M.rgce,l,null,B,Y)},M.itab>0&&(F.Sheet=M.itab-1),B.names.push(F),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(T[M.itab-1]={ref:At(M.rgce[0][0][1][2])});break;case 22:Y.ExternCount=M;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(M),B.XTI=B.XTI.concat(M);break;case 2196:if(Y.biff<8)break;F!=null&&(F.Comment=M[1]);break;case 18:a["!protect"]=M;break;case 19:M!==0&&Y.WTF&&console.error("Password verifier: "+M);break;case 133:o[M.pos]=M,Y.snames.push(M.name);break;case 10:{if(--I)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=At(l),n.sheetRows&&n.sheetRows<=l.e.r){var ye=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=At(l),l.e.r=ye}l.e.r++,l.e.c++}le.length>0&&(a["!merges"]=le),oe.length>0&&(a["!objects"]=oe),pe.length>0&&(a["!cols"]=pe),G.length>0&&(a["!rows"]=G),D.Sheets.push(H)}h===""?p=a:r[h]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),Y.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(Y.biff=5,O=!0,na(Y.codepage=28591)),Y.biff==8&&M.BIFFVer==0&&M.dt==16&&(Y.biff=2),I++)break;if(a=n.dense?[]:{},Y.biff<8&&!O&&(O=!0,na(Y.codepage=n.codepage||1252)),Y.biff<5||M.BIFFVer==0&&M.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Me={pos:e.l-Z,name:h};o[Me.pos]=Me,Y.snames.push(h)}else h=(o[R]||{name:""}).name;M.dt==32&&(a["!type"]="chart"),M.dt==64&&(a["!type"]="macro"),le=[],oe=[],Y.arrayf=N=[],pe=[],G=[],ie=!1,H={Hidden:(o[R]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[M.r]||[])[M.c]:a[wt({c:M.c,r:M.r})])&&++M.c,S={ixfe:M.ixfe,XF:te[M.ixfe]||{},v:M.val,t:"n"},j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:M.c,r:M.r},S,n);break;case 5:case 517:S={ixfe:M.ixfe,XF:te[M.ixfe],v:M.val,t:M.t},j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:M.c,r:M.r},S,n);break;case 638:S={ixfe:M.ixfe,XF:te[M.ixfe],v:M.rknum,t:"n"},j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:M.c,r:M.r},S,n);break;case 189:for(var Pe=M.c;Pe<=M.C;++Pe){var ce=M.rkrec[Pe-M.c][0];S={ixfe:ce,XF:te[ce],v:M.rkrec[Pe-M.c][1],t:"n"},j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:Pe,r:M.r},S,n)}break;case 6:case 518:case 1030:{if(M.val=="String"){c=M;break}if(S=iu(M.val,M.cell.ixfe,M.tt),S.XF=te[S.ixfe],n.cellFormula){var Fe=M.formula;if(Fe&&Fe[0]&&Fe[0][0]&&Fe[0][0][0]=="PtgExp"){var Re=Fe[0][0][1][0],De=Fe[0][0][1][1],lt=wt({r:Re,c:De});E[lt]?S.f=""+Xr(M.formula,l,M.cell,B,Y):S.F=((n.dense?(a[Re]||[])[De]:a[lt])||{}).F}else S.f=""+Xr(M.formula,l,M.cell,B,Y)}j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q(M.cell,S,n),c=M}break;case 7:case 519:if(c)c.val=M,S=iu(M,c.cell.ixfe,"s"),S.XF=te[S.ixfe],n.cellFormula&&(S.f=""+Xr(c.formula,l,c.cell,B,Y)),j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q(c.cell,S,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(M);var ft=wt(M[0].s);if(v=n.dense?(a[M[0].s.r]||[])[M[0].s.c]:a[ft],n.cellFormula&&v){if(!c||!ft||!v)break;v.f=""+Xr(M[1],l,M[0],B,Y),v.F=At(M[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;E[wt(c.cell)]=M[0],v=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[wt(c.cell)],(v||{}).f=""+Xr(M[0],l,m,B,Y)}}break;case 253:S=iu(f[M.isst].t,M.ixfe,"s"),f[M.isst].h&&(S.h=f[M.isst].h),S.XF=te[S.ixfe],j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:M.c,r:M.r},S,n);break;case 513:n.sheetStubs&&(S={ixfe:M.ixfe,XF:te[M.ixfe],t:"z"},j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:M.c,r:M.r},S,n));break;case 190:if(n.sheetStubs)for(var gt=M.c;gt<=M.C;++gt){var Nt=M.ixfe[gt-M.c];S={ixfe:Nt,XF:te[Nt],t:"z"},j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:gt,r:M.r},S,n)}break;case 214:case 516:case 4:S=iu(M.val,M.ixfe,"s"),S.XF=te[S.ixfe],j>0&&(S.z=re[S.ixfe>>8&63]),xa(S,n,t.opts.Date1904),Q({c:M.c,r:M.r},S,n);break;case 0:case 512:I===1&&(l=M);break;case 252:f=M;break;case 1054:if(Y.biff==4){re[j++]=M[1];for(var zt=0;zt<j+163&&kt[zt]!=M[1];++zt);zt>=163&&ao(M[1],j+163)}else ao(M[1],M[0]);break;case 30:{re[j++]=M;for(var Qt=0;Qt<j+163&&kt[Qt]!=M;++Qt);Qt>=163&&ao(M,j+163)}break;case 229:le=le.concat(M);break;case 93:oe[M.cmo[0]]=Y.lastobj=M;break;case 438:Y.lastobj.TxO=M;break;case 127:Y.lastobj.ImData=M;break;case 440:for(b=M[0].s.r;b<=M[0].e.r;++b)for(w=M[0].s.c;w<=M[0].e.c;++w)v=n.dense?(a[b]||[])[w]:a[wt({c:w,r:b})],v&&(v.l=M[1]);break;case 2048:for(b=M[0].s.r;b<=M[0].e.r;++b)for(w=M[0].s.c;w<=M[0].e.c;++w)v=n.dense?(a[b]||[])[w]:a[wt({c:w,r:b})],v&&v.l&&(v.l.Tooltip=M[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;v=n.dense?(a[M[0].r]||[])[M[0].c]:a[wt(M[0])];var qt=oe[M[2]];v||(n.dense?(a[M[0].r]||(a[M[0].r]=[]),v=a[M[0].r][M[0].c]={t:"z"}):v=a[wt(M[0])]={t:"z"},l.e.r=Math.max(l.e.r,M[0].r),l.s.r=Math.min(l.s.r,M[0].r),l.e.c=Math.max(l.e.c,M[0].c),l.s.c=Math.min(l.s.c,M[0].c)),v.c||(v.c=[]),k={a:M[1],t:qt.TxO.t},v.c.push(k)}break;case 2173:pC(te[M.ixfe],M.ext);break;case 125:{if(!Y.cellStyles)break;for(;M.e>=M.s;)pe[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},ie||(ie=!0,wp(M.w/256)),ci(pe[M.e+1])}break;case 520:{var Bt={};M.level!=null&&(G[M.r]=Bt,Bt.level=M.level),M.hidden&&(G[M.r]=Bt,Bt.hidden=!0),M.hpt&&(G[M.r]=Bt,Bt.hpt=M.hpt,Bt.hpx=Cl(M.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||gl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=M;break;case 161:a["!margins"]||gl(a["!margins"]={}),a["!margins"].header=M.header,a["!margins"].footer=M.footer;break;case 574:M.RTL&&(D.Views[0].RTL=!0);break;case 146:V=M;break;case 2198:ue=M;break;case 140:z=M;break;case 442:h?H.CodeName=M||H.name:D.WBProps.CodeName=M||"ThisWorkbook";break}}else U||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=Z}return t.SheetNames=Ta(o).sort(function(rr,ut){return Number(rr)-Number(ut)}).map(function(rr){return o[rr].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&T.forEach(function(rr,ut){t.Sheets[t.SheetNames[ut]]["!autofilter"]=rr}),t.Strings=f,t.SSF=Ur(kt),Y.enc&&(t.Encryption=Y.enc),ue&&(t.Themes=ue),t.Metadata={},z!==void 0&&(t.Metadata.Country=z),B.names.length>0&&(D.Names=B.names),t.Workbook=D,t}var Ag={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function VD(e,n,t){var r=jt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=xg(r,c_,Ag.DSI);for(var o in a)n[o]=a[o]}catch(h){if(t.WTF)throw h}var l=jt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=xg(l,u_,Ag.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(h){if(t.WTF)throw h}n.HeadingPairs&&n.TitlesOfParts&&(P1(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function my(e,n){n||(n={}),Ep(n),Yv(),n.codepage&&np(n.codepage);var t,r;if(e.FullPaths){if(jt.find(e,"/encryption"))throw new Error("File is password-protected");t=jt.find(e,"!CompObj"),r=jt.find(e,"/Workbook")||jt.find(e,"/Book")}else{switch(n.type){case"base64":e=ra(Tn(e));break;case"binary":e=ra(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Br(e,0),r={content:e}}var a,o;if(t&&UD(t),n.bookProps&&!n.bookSheets)a={};else{var l=Tt?"buffer":"array";if(r&&r.content)a=YD(r.content,n);else if((o=jt.find(e,"PerfectOffice_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else if((o=jt.find(e,"NativeContent_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else throw(o=jt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&jt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=jC(e))}var c={};return e.FullPaths&&VD(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Pu={0:{f:TN},1:{f:jN},2:{f:BN},3:{f:RN},4:{f:PN},5:{f:LN},6:{f:HN},7:{f:IN},8:{f:GN},9:{f:KN},10:{f:YN},11:{f:VN},12:{f:AN},13:{f:WN},14:{f:MN},15:{f:ON},16:{f:dy},17:{f:$N},18:{f:zN},19:{f:hp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:kD},40:{},42:{},43:{f:YE},44:{f:$E},45:{f:VE},46:{f:GE},47:{f:KE},48:{},49:{f:Xb},50:{},51:{f:xC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Y1},62:{f:UN},63:{f:wC},64:{f:nD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:FN},148:{f:NN,p:16},151:{f:qN},152:{},153:{f:yD},154:{},155:{},156:{f:vD},157:{},158:{},159:{T:1,f:uE},160:{T:-1},161:{T:1,f:ko},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:hC},336:{T:-1},337:{f:mC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZN},427:{f:JN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:DN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:QN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:NC},633:{T:1},634:{T:-1},635:{T:1,f:TC},636:{T:-1},637:{f:qb},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:aD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jf={6:{f:rf},10:{f:ks},12:{f:Er},13:{f:Er},14:{f:yr},15:{f:yr},16:{f:Qr},17:{f:yr},18:{f:yr},19:{f:Er},20:{f:yg},21:{f:yg},23:{f:$1},24:{f:kg},25:{f:yr},26:{},27:{},28:{f:ES},29:{},34:{f:yr},35:{f:wg},38:{f:Qr},39:{f:Qr},40:{f:Qr},41:{f:Qr},42:{f:yr},43:{f:yr},47:{f:DE},49:{f:oS},51:{f:Er},60:{},61:{f:nS},64:{f:yr},65:{f:sS},66:{f:Er},77:{},80:{},81:{},82:{},85:{f:Er},89:{},90:{},91:{},92:{f:X_},93:{f:TS},94:{},95:{f:yr},96:{},97:{},99:{f:yr},125:{f:Y1},128:{f:mS},129:{f:Q_},130:{f:Er},131:{f:yr},132:{f:yr},133:{f:q_},134:{},140:{f:PS},141:{f:Er},144:{},146:{f:RS},151:{},152:{},153:{},154:{},155:{},156:{f:Er},157:{},158:{},160:{f:BS},161:{f:IS},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:fS},190:{f:pS},193:{f:ks},197:{},198:{},199:{},200:{},201:{},202:{f:yr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Er},220:{},221:{f:yr},222:{},224:{f:xS},225:{f:G_},226:{f:ks},227:{},229:{f:CS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z_},253:{f:iS},255:{f:J_},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:z1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yr},353:{f:ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vS},431:{f:yr},432:{},433:{},434:{},437:{},438:{f:FS},439:{f:yr},440:{f:jS},441:{},442:{f:Rl},443:{},444:{f:Er},445:{},446:{},448:{f:ks},449:{f:rS,r:2},450:{f:ks},512:{f:gg},513:{f:LS},515:{f:gS},516:{f:lS},517:{f:vg},519:{f:WS},520:{f:eS},523:{},545:{f:bg},549:{f:mg},566:{},574:{f:aS},638:{f:dS},659:{},1048:{},1054:{f:cS},1084:{},1212:{f:bS},2048:{f:AS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:au},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:MS,r:12},2173:{f:fC,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:kS,r:12},2197:{},2198:{f:oC,r:12},2199:{},2200:{},2201:{},2202:{f:_S,r:12},2203:{f:ks},2204:{},2205:{},2206:{},2207:{},2211:{f:tS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:zS},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OS},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gg},1:{},2:{f:YS},3:{f:$S},4:{f:HS},5:{f:vg},7:{f:VS},8:{},9:{f:au},11:{},22:{f:Er},30:{f:uS},31:{},32:{},33:{f:bg},36:{},37:{f:mg},50:{f:KS},62:{},52:{},67:{},68:{f:Er},69:{},86:{},126:{},127:{f:US},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:GS},223:{},234:{},354:{},421:{},518:{f:rf},521:{f:au},536:{f:kg},547:{f:wg},561:{},579:{},1030:{f:rf},1033:{f:au},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ta(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&E1(t)&&e.push(t)}}function Pg(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=gb(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,m=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<f.length;++l){var w=f[l].trim(),b=w.slice(0,3).toLowerCase();if(b=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(b!="<td"&&b!="<th")){var E=w.split(/<\/t[dh]>/i);for(c=0;c<E.length;++c){var N=E[c].trim();if(N.match(/<t[dh]/i)){for(var S=N,z=0;S.charAt(0)=="<"&&(z=S.indexOf(">"))>-1;)S=S.slice(z+1);for(var te=0;te<k.length;++te){var V=k[te];V.s.c==p&&V.s.r<h&&h<=V.e.r&&(p=V.e.c+1,te=-1)}var D=vt(N.slice(0,N.indexOf(">")));g=D.colspan?+D.colspan:1,((m=+D.rowspan)>1||g>1)&&k.push({s:{r:h,c:p},e:{r:h+(m||1)-1,c:p+g-1}});var H=D.t||D["data-t"]||"";if(!S.length){p+=g;continue}if(S=f1(S),v.s.r>h&&(v.s.r=h),v.e.r<h&&(v.e.r=h),v.s.c>p&&(v.s.c=p),v.e.c<p&&(v.e.c=p),!S.length){p+=g;continue}var L={t:"s",v:S};t.raw||!S.trim().length||H=="s"||(S==="TRUE"?L={t:"b",v:!0}:S==="FALSE"?L={t:"b",v:!1}:isNaN(sa(S))?isNaN(li(S).getDate())||(L={t:"d",v:Mr(S)},t.cellDates||(L={t:"n",v:fn(L.v)}),L.z=t.dateNF||kt[14]):L={t:"n",v:sa(S)}),t.dense?(r[h]||(r[h]=[]),r[h][p]=L):r[wt({r:h,c:p})]=L,p+=g}}}}return r["!ref"]=At(v),k.length&&(r["!merges"]=k),r}function KD(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>l)&&!(a[h].e.r<t||a[h].e.c<l)){if(a[h].s.r<t||a[h].s.c<l){c=-1;break}c=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(c<0)){var p=wt({r:t,c:l}),m=r.dense?(e[t]||[])[l]:e[p],g=m&&m.v!=null&&(m.h||cp(m.w||(qa(m),m.w)||""))||"",v={};c>1&&(v.rowspan=c),f>1&&(v.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),v.id=(r.id||"sjs")+"-"+p,o.push(Pb("td",g,v))}}var k="<tr>";return k+o.join("")+"</tr>"}var GD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XD="</body></html>";function QD(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Rs(Pg(t[0],n),n);var r=Tp();return t.forEach(function(a,o){Np(r,Pg(a,n),"Sheet"+(o+1))}),r}function qD(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function ZD(e,n){var t=n||{},r=t.header!=null?t.header:GD,a=t.footer!=null?t.footer:XD,o=[r],l=gi(e["!ref"]);t.dense=Array.isArray(e),o.push(qD(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(KD(e,l,c,t));return o.push("</table>"+a),o.join("")}function gy(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var p=gi(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),a==-1&&(h.e.r=a=p.e.r+1)}var m=[],g=0,v=e["!rows"]||(e["!rows"]=[]),k=0,w=0,b=0,E=0,N=0,S=0;for(e["!cols"]||(e["!cols"]=[]);k<c.length&&w<f;++k){var z=c[k];if(Og(z)){if(r.display)continue;v[w]={hidden:!0}}var te=z.children;for(b=E=0;b<te.length;++b){var V=te[b];if(!(r.display&&Og(V))){var D=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):f1(V.innerHTML),H=V.getAttribute("data-z")||V.getAttribute("z");for(g=0;g<m.length;++g){var L=m[g];L.s.c==E+o&&L.s.r<w+a&&w+a<=L.e.r&&(E=L.e.c+1-o,g=-1)}S=+V.getAttribute("colspan")||1,((N=+V.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:w+a,c:E+o},e:{r:w+a+(N||1)-1,c:E+o+(S||1)-1}});var ae={t:"s",v:D},Q=V.getAttribute("data-t")||V.getAttribute("t")||"";D!=null&&(D.length==0?ae.t=Q||"z":r.raw||D.trim().length==0||Q=="s"||(D==="TRUE"?ae={t:"b",v:!0}:D==="FALSE"?ae={t:"b",v:!1}:isNaN(sa(D))?isNaN(li(D).getDate())||(ae={t:"d",v:Mr(D)},r.cellDates||(ae={t:"n",v:fn(ae.v)}),ae.z=r.dateNF||kt[14]):ae={t:"n",v:sa(D)})),ae.z===void 0&&H!=null&&(ae.z=H);var Y="",ue=V.getElementsByTagName("A");if(ue&&ue.length)for(var le=0;le<ue.length&&!(ue[le].hasAttribute("href")&&(Y=ue[le].getAttribute("href"),Y.charAt(0)!="#"));++le);Y&&Y.charAt(0)!="#"&&(ae.l={Target:Y}),r.dense?(e[w+a]||(e[w+a]=[]),e[w+a][E+o]=ae):e[wt({c:E+o,r:w+a})]=ae,h.e.c<E+o&&(h.e.c=E+o),E+=S}}++w}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),h.e.r=Math.max(h.e.r,w-1+a),e["!ref"]=At(h),w>=f&&(e["!fullref"]=At((h.e.r=c.length-k+w-1+a,h))),e}function vy(e,n){var t=n||{},r=t.dense?[]:{};return gy(r,e,n)}function JD(e,n){return Rs(vy(e,n),n)}function Og(e){var n="",t=e4(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function e4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function t4(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Mt(n.replace(/<[^>]*>/g,""));return[t]}var Rg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yy(e,n){var t=n||{},r=up(e),a=[],o,l,c={name:""},f="",h=0,p,m,g={},v=[],k=t.dense?[]:{},w,b,E={value:""},N="",S=0,z=[],te=-1,V=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},H=0,L={},ae=[],Q={},Y=0,ue=0,le=[],oe=1,pe=1,G=[],ie={Names:[]},B={},de=["",""],I=[],j={},re="",T=0,F=!1,O=!1,R=0;for(_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=_l.exec(r);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?k["!ref"]=At(D):k["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=D.e.r&&(k["!fullref"]=k["!ref"],D.e.r=t.sheetRows-1,k["!ref"]=At(D)),ae.length&&(k["!merges"]=ae),le.length&&(k["!rows"]=le),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),v.push(p.name),g[p.name]=k,O=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=vt(w[0],!1),te=V=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,k=t.dense?[]:{},ae=[],le=[],O=!0);break;case"table-row-group":w[1]==="/"?--H:++H;break;case"table-row":case"":if(w[1]==="/"){te+=oe,oe=1;break}if(m=vt(w[0],!1),m.?te=m.-1:te==-1&&(te=0),oe=+m["number-rows-repeated"]||1,oe<10)for(R=0;R<oe;++R)H>0&&(le[te+R]={level:H});V=-1;break;case"covered-table-cell":w[1]!=="/"&&++V,t.sheetStubs&&(t.dense?(k[te]||(k[te]=[]),k[te][V]={t:"z"}):k[wt({r:te,c:V})]={t:"z"}),N="",z=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++V,E=vt(w[0],!1),pe=parseInt(E["number-columns-repeated"]||"1",10),b={t:"z",v:null},E.formula&&t.cellFormula!=!1&&(b.f=Dg(Mt(E.formula))),(E.||E["value-type"])=="string"&&(b.t="s",b.v=Mt(E["string-value"]||""),t.dense?(k[te]||(k[te]=[]),k[te][V]=b):k[wt({r:te,c:V})]=b),V+=pe-1;else if(w[1]!=="/"){++V,N="",S=0,z=[],pe=1;var J=oe?te+oe-1:te;if(V>D.e.c&&(D.e.c=V),V<D.s.c&&(D.s.c=V),te<D.s.r&&(D.s.r=te),J>D.e.r&&(D.e.r=J),E=vt(w[0],!1),I=[],j={},b={t:E.||E["value-type"],v:null},t.cellFormula)if(E.formula&&(E.formula=Mt(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(Y=parseInt(E["number-matrix-rows-spanned"],10)||0,ue=parseInt(E["number-matrix-columns-spanned"],10)||0,Q={s:{r:te,c:V},e:{r:te+Y-1,c:V+ue-1}},b.F=At(Q),G.push([Q,b.F])),E.formula)b.f=Dg(E.formula);else for(R=0;R<G.length;++R)te>=G[R][0].s.r&&te<=G[R][0].e.r&&V>=G[R][0].s.c&&V<=G[R][0].e.c&&(b.F=G[R][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(Y=parseInt(E["number-rows-spanned"],10)||0,ue=parseInt(E["number-columns-spanned"],10)||0,Q={s:{r:te,c:V},e:{r:te+Y-1,c:V+ue-1}},ae.push(Q)),E["number-columns-repeated"]&&(pe=parseInt(E["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=or(E["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(E.value);break;case"percentage":b.t="n",b.v=parseFloat(E.value);break;case"currency":b.t="n",b.v=parseFloat(E.value);break;case"date":b.t="d",b.v=Mr(E["date-value"]),t.cellDates||(b.t="n",b.v=fn(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=hb(E["time-value"])/86400,t.cellDates&&(b.t="d",b.v=Xu(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(E.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",E["string-value"]!=null&&(N=Mt(E["string-value"]),z=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(F=!1,b.t==="s"&&(b.v=N||"",z.length&&(b.R=z),F=S==0),B.Target&&(b.l=B),I.length>0&&(b.c=I,I=[]),N&&t.cellText!==!1&&(b.w=N),F&&(b.t="z",delete b.v),(!F||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=te))for(var Z=0;Z<oe;++Z){if(pe=parseInt(E["number-columns-repeated"]||"1",10),t.dense)for(k[te+Z]||(k[te+Z]=[]),k[te+Z][V]=Z==0?b:Ur(b);--pe>0;)k[te+Z][V+pe]=Ur(b);else for(k[wt({r:te+Z,c:V})]=b;--pe>0;)k[wt({r:te+Z,c:V+pe})]=Ur(b);D.e.c<=V&&(D.e.c=V)}pe=parseInt(E["number-columns-repeated"]||"1",10),V+=pe-1,pe=0,b={},N="",z=[]}B={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o;j.t=N,z.length&&(j.R=z),j.a=re,I.push(j)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);re="",T=0,N="",S=0,z=[];break;case"creator":w[1]==="/"?re=r.slice(T,w.index):T=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);N="",S=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(L[c.name]=f,(o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",c=vt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=vt(w[0],!1),f+=Rg[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=vt(w[0],!1),f+=Rg[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(h,w.index);break}else h=w.index+w[0].length;break;case"named-range":l=vt(w[0],!1),de=nf(l["cell-range-address"]);var U={Name:l.name,Ref:de[0]+"!"+de[1]};O&&(U.Sheet=v.length),ie.Names.push(U);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!E||!E["string-value"])){var xe=t4(r.slice(S,w.index));N=(N.length>0?N+`
`:"")+xe[0]}else vt(w[0],!1),S=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{de=nf(vt(w[0])["target-range-address"]),g[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(B=vt(w[0],!1),!B.href)break;B.Target=Mt(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(de=nf(B.Target.slice(1)),B.Target="#"+de[0]+"!"+de[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(w)}}var M={Sheets:g,SheetNames:v,Workbook:ie};return t.bookSheets&&delete M.Sheets,M}function Mg(e,n){n=n||{},zn(e,"META-INF/manifest.xml")&&g_(Sr(e,"META-INF/manifest.xml"),n);var t=En(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=yy(tr(t),n);return zn(e,"meta.xml")&&(r.Props=A1(Sr(e,"meta.xml"))),r}function Ig(e,n){return yy(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _p(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Af(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):tr(yo(e))}function Pf(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function zg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function r4(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Tl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Fr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function qr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Tl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Tl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:c,type:o};n[a]==null?n[a]=[h]:n[a].push(h)}return n}function Sp(e,n){return e?.map(function(t){return n(t.data)})||[]}function n4(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Tl(e,r),o=qr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Fr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=qr(c.data),h=Fr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(n=o[3])!=null&&n[0]&&(l.merge=Fr(o[3][0].data)>>>0>0),t.push(l)}return t}function a4(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Tl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,h=0;if(o==1?(h=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(h=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Pf(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var p=Pf(a);if(p.length!=r)throw new Error("Unexpected length: ".concat(p.length," != ").concat(r));return p}function s4(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(a4(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Pf(n)}function o4(e,n,t,r){var a=_p(e),o=a.getUint32(4,!0),l=(r>1?12:8)+zg(o&(r>1?3470:398))*4,c=-1,f=-1,h=NaN,p=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=zg(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(h=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:h};break;case 3:m={t:"s",v:n[f]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:t[c]};else if(f>-1)m={t:"s",v:n[f]};else if(!isNaN(h))m={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function i4(e,n,t){var r=_p(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,h=NaN,p=new Date(2001,0,1);a&1&&(f=r4(e,o),o+=16),a&2&&(h=r.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:n[c]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function l4(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return o4(e,n,t,e[0]);case 5:return i4(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ns(e){var n=qr(e);return Tl(n[1][0].data)}function Lg(e,n){var t=qr(n.data),r=Fr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=qr(l.data),f=Fr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Af(c[3][0].data);break;case 8:{var h=e[Ns(c[9][0].data)][0],p=qr(h.data),m=e[Ns(p[1][0].data)][0],g=Fr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=qr(m.data);o[f]=v[3].map(function(k){return Af(k.data)}).join("")}break}}),o}function c4(e,n){var t,r,a,o,l,c,f,h,p,m,g,v,k,w,b=qr(e),E=Fr(b[1][0].data)>>>0,N=Fr(b[2][0].data)>>>0,S=((r=(t=b[8])==null?void 0:t[0])==null?void 0:r.data)&&Fr(b[8][0].data)>0||!1,z,te;if((o=(a=b[7])==null?void 0:a[0])!=null&&o.data&&n!=0)z=(c=(l=b[7])==null?void 0:l[0])==null?void 0:c.data,te=(h=(f=b[6])==null?void 0:f[0])==null?void 0:h.data;else if((m=(p=b[4])==null?void 0:p[0])!=null&&m.data&&n!=1)z=(v=(g=b[4])==null?void 0:g[0])==null?void 0:v.data,te=(w=(k=b[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var V=S?4:1,D=_p(z),H=[],L=0;L<z.length/2;++L){var ae=D.getUint16(L*2,!0);ae<65535&&H.push([L,ae])}if(H.length!=N)throw"Expected ".concat(N," cells, found ").concat(H.length);var Q=[];for(L=0;L<H.length-1;++L)Q[H[L][0]]=te.subarray(H[L][1]*V,H[L+1][1]*V);return H.length>=1&&(Q[H[H.length-1][0]]=te.subarray(H[H.length-1][1]*V)),{R:E,cells:Q}}function u4(e,n){var t,r=qr(n.data),a=(t=r?.[7])!=null&&t[0]?Fr(r[7][0].data)>>>0>0?1:0:-1,o=Sp(r[5],function(l){return c4(l,a)});return{nrows:Fr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,h){if(l[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));l[c.R][h]=f}),l},[])}}function d4(e,n,t){var r,a=qr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Fr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Fr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=At(o);var l=qr(a[4][0].data),c=Lg(e,e[Ns(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?Lg(e,e[Ns(l[17][0].data)][0]):[],h=qr(l[3][0].data),p=0;h[1].forEach(function(m){var g=qr(m.data),v=e[Ns(g[2][0].data)][0],k=Fr(v.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=u4(e,v);w.data.forEach(function(b,E){b.forEach(function(N,S){var z=wt({r:p+E,c:S}),te=l4(N,c,f);te&&(t[z]=te)})}),p+=w.nrows})}function f4(e,n){var t=qr(n.data),r={"!ref":"A1"},a=e[Ns(t[2][0].data)],o=Fr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return d4(e,a[0],r),r}function p4(e,n){var t,r=qr(n.data),a={name:(t=r[1])!=null&&t[0]?Af(r[1][0].data):"",sheets:[]},o=Sp(r[2],Ns);return o.forEach(function(l){e[l].forEach(function(c){var f=Fr(c.meta[1][0].data);f==6e3&&a.sheets.push(f4(e,c))})}),a}function h4(e,n){var t=Tp(),r=qr(n.data),a=Sp(r[1],Ns);if(a.forEach(function(o){e[o].forEach(function(l){var c=Fr(l.meta[1][0].data);if(c==2){var f=p4(e,l);f.sheets.forEach(function(h,p){Np(t,h,p==0?f.name:f.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function sf(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=s4(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var p;try{p=n4(h)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){o[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Fr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(h){var p=Fr(h.meta[1][0].data)>>>0;if(p==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return h4(o,c)}function x4(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Ep(e){x4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function m4(e){return ei.WS.indexOf(e)>-1?"sheet":e==ei.CS?"chart":e==ei.DS?"dialog":e==ei.MS?"macro":e&&e.length?e:"sheet"}function g4(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,m4(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function v4(e,n,t,r,a,o,l,c,f,h,p,m){try{o[r]=pl(En(e,t,!0),n);var g=Sr(e,n),v;switch(c){case"sheet":v=SD(g,n,a,f,o[r],h,p,m);break;case"chart":if(v=ED(g,n,a,f,o[r],h,p,m),!v||!v["!drawel"])break;var k=ol(v["!drawel"].Target,n),w=Tf(k),b=_C(En(e,k,!0),pl(En(e,w,!0),k)),E=ol(b,k),N=Tf(E);v=iD(En(e,E,!0),E,f,pl(En(e,N,!0),E),h,v);break;case"macro":v=CD(g,n,a,f,o[r],h,p,m);break;case"dialog":v=TD(g,n,a,f,o[r],h,p,m);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=v;var S=[];o&&o[r]&&Ta(o[r]).forEach(function(z){var te="";if(o[r][z].Type==ei.CMNT){te=ol(o[r][z].Target,n);var V=jD(Sr(e,te,!0),te,f);if(!V||!V.length)return;Sg(v,V,!1)}o[r][z].Type==ei.TCMNT&&(te=ol(o[r][z].Target,n),S=S.concat(EC(Sr(e,te,!0),f)))}),S&&S.length&&Sg(v,S,!0,f.people||[])}catch(z){if(f.WTF)throw z}}function Rn(e){return e.charAt(0)=="/"?e.slice(1):e}function y4(e,n){if(n1(),n=n||{},Ep(n),zn(e,"META-INF/manifest.xml")||zn(e,"objectdata.xml"))return Mg(e,n);if(zn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof sf<"u"){if(e.FileIndex)return sf(e);var t=jt.utils.cfb_new();return qm(e).forEach(function(le){wb(t,le,yb(e,le))}),sf(t)}throw new Error("Unsupported NUMBERS file")}if(!zn(e,"[Content_Types].xml"))throw zn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):zn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=qm(e),a=x_(En(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Sr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Sr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},h={};if(!n.bookSheets&&!n.bookProps){if(ml=[],a.sst)try{ml=FD(Sr(e,Rn(a.sst)),a.sst,n)}catch(le){if(n.WTF)throw le}n.cellStyles&&a.themes.length&&(f=DD(En(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(h=ND(Sr(e,Rn(a.style)),a.style,f,n))}a.links.map(function(le){try{var oe=pl(En(e,Tf(Rn(le))),le);return PD(Sr(e,Rn(le)),oe,le,n)}catch{}});var p=_D(Sr(e,Rn(a.workbooks[0])),a.workbooks[0],n),m={},g="";a.coreprops.length&&(g=Sr(e,Rn(a.coreprops[0]),!0),g&&(m=A1(g)),a.extprops.length!==0&&(g=Sr(e,Rn(a.extprops[0]),!0),g&&w_(g,m,n)));var v={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=En(e,Rn(a.custprops[0]),!0),g&&(v=b_(g,n)));var k={};if((n.bookSheets||n.bookProps)&&(p.Sheets?l=p.Sheets.map(function(oe){return oe.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),n.bookProps&&(k.Props=m,k.Custprops=v),n.bookSheets&&typeof l<"u"&&(k.SheetNames=l),n.bookSheets?k.SheetNames:n.bookProps))return k;l={};var w={};n.bookDeps&&a.calcchain&&(w=AD(Sr(e,Rn(a.calcchain)),a.calcchain));var b=0,E={},N,S;{var z=p.Sheets;m.Worksheets=z.length,m.SheetNames=[];for(var te=0;te!=z.length;++te)m.SheetNames[te]=z[te].name}var V=o?"bin":"xml",D=a.workbooks[0].lastIndexOf("/"),H=(a.workbooks[0].slice(0,D+1)+"_rels/"+a.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");zn(e,H)||(H="xl/_rels/workbook."+V+".rels");var L=pl(En(e,H,!0),H.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=OD(Sr(e,Rn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=CC(Sr(e,Rn(a.people[0])),n)),L&&(L=g4(L,p.Sheets));var ae=Sr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=m.Worksheets;++b){var Q="sheet";if(L&&L[b]?(N="xl/"+L[b][1].replace(/[\/]?xl\//,""),zn(e,N)||(N=L[b][1]),zn(e,N)||(N=H.replace(/_rels\/.*$/,"")+L[b][1]),Q=L[b][2]):(N="xl/worksheets/sheet"+(b+1-ae)+"."+V,N=N.replace(/sheet0\./,"sheet.")),S=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(b!=n.sheets)continue e;break;case"string":if(m.SheetNames[b].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var Y=!1,ue=0;ue!=n.sheets.length;++ue)typeof n.sheets[ue]=="number"&&n.sheets[ue]==b&&(Y=1),typeof n.sheets[ue]=="string"&&n.sheets[ue].toLowerCase()==m.SheetNames[b].toLowerCase()&&(Y=1);if(!Y)continue e}}v4(e,N,S,m.SheetNames[b],b,E,l,Q,n,p,f,h)}return k={Directory:a,Workbook:p,Props:m,Custprops:v,Deps:w,Sheets:l,SheetNames:m.SheetNames,Strings:ml,Styles:h,Themes:f,SSF:Ur(kt)},n&&n.bookFiles&&(e.files?(k.keys=r,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(le,oe){le=le.replace(/^Root Entry[\/]/,""),k.keys.push(le),k.files[le]=e.FileIndex[oe]}))),n&&n.bookVBA&&(a.vba.length>0?k.vbaraw=Sr(e,Rn(a.vba[0]),!0):a.defaults&&a.defaults.bin===FC&&(k.vbaraw=Sr(e,"xl/vbaProject.bin",!0))),k}function w4(e,n){var t=n||{},r="Workbook",a=jt.find(e,r);try{if(r="/!DataSpaces/Version",a=jt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(fE(a.content),r="/!DataSpaces/DataSpaceMap",a=jt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=hE(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=jt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=xE(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=jt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);gE(a.content)}catch{}if(r="/EncryptionInfo",a=jt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=vE(a.content);if(r="/EncryptedPackage",a=jt.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Cp(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Tn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function k4(e,n){return jt.find(e,"EncryptedPackage")?w4(e,n):my(e,n)}function b4(e,n){var t,r=e,a=n||{};return a.type||(a.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),t=c1(r,a),y4(t,a)}function wy(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Ff(e.slice(t),n);default:break e}return Sl.to_workbook(e,n)}function _4(e,n){var t="",r=Cp(e,n);switch(n.type){case"base64":t=Tn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=fo(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=tr(t)),n.type="binary",wy(t,n)}function S4(e,n){var t=e;return n.type=="base64"&&(t=Tn(t)),t=wl.utils.decode(1200,t.slice(2),"str"),n.type="binary",wy(t,n)}function E4(e){return e.match(/[^\x00-\x7F]/)?il(e):e}function of(e,n,t,r){return r?(t.type="string",Sl.to_workbook(e,t)):Sl.to_workbook(n,t)}function Of(e,n){Yv();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Of(new Uint8Array(e),(t=Ur(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ai={},t.dateNF&&(ai.dateNF=t.dateNF),t.type||(t.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Tt?"buffer":"binary",r=fb(e),typeof Uint8Array<"u"&&!Tt&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=E4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=Ur(t),t.type="array",Of(ap(r),t)}switch((a=Cp(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return k4(jt.read(r,t),t);break;case 9:if(a[1]<=8)return my(r,t);break;case 60:return Ff(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return JS(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return qS.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?b4(r,t):of(e,r,t,o);case 239:return a[3]===60?Ff(r,t):of(e,r,t,o);case 255:if(a[1]===254)return S4(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return xl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return xl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return _g.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return FE.to_workbook(r,t);break;case 10:case 13:case 32:return _4(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XS.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?_g.to_workbook(r,t):of(e,r,t,o)}function C4(e,n,t,r,a,o,l,c){var f=Hr(t),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var v=n.s.c;v<=n.e.c;++v){var k=l?e[t][v]:e[r[v]+f];if(k===void 0||k.t===void 0){if(h===void 0)continue;o[v]!=null&&(g[o[v]]=h);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(o[v]!=null){if(w==null)if(k.t=="e"&&w===null)g[o[v]]=null;else if(h!==void 0)g[o[v]]=h;else if(p&&w===null)g[o[v]]=null;else continue;else g[o[v]]=p&&(k.t!=="n"||k.t==="n"&&c.rawNumbers!==!1)?w:qa(k,w,c);w!=null&&(m=!1)}}return{row:g,isempty:m}}function Rf(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof p){case"string":f=hr(p);break;case"number":f=hr(e["!ref"]),f.s.r=p;break;default:f=p}r>0&&(a=0);var m=Hr(f.s.r),g=[],v=[],k=0,w=0,b=Array.isArray(e),E=f.s.r,N=0,S={};b&&!e[E]&&(e[E]=[]);var z=h.skipHidden&&e["!cols"]||[],te=h.skipHidden&&e["!rows"]||[];for(N=f.s.c;N<=f.e.c;++N)if(!(z[N]||{}).hidden)switch(g[N]=Dr(N),t=b?e[E][N]:e[g[N]+m],r){case 1:o[N]=N-f.s.c;break;case 2:o[N]=g[N];break;case 3:o[N]=h.header[N-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=qa(t,null,h),w=S[l]||0,!w)S[l]=1;else{do c=l+"_"+w++;while(S[c]);S[l]=w,S[c]=1}o[N]=c}for(E=f.s.r+a;E<=f.e.r;++E)if(!(te[E]||{}).hidden){var V=C4(e,f,E,g,r,o,b,h);(V.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(v[k++]=V.row)}return v.length=k,v}var Bg=/"/g;function T4(e,n,t,r,a,o,l,c){for(var f=!0,h=[],p="",m=Hr(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var v=c.dense?(e[t]||[])[g]:e[r[g]+m];if(v==null)p="";else if(v.v!=null){f=!1,p=""+(c.rawNumbers&&v.t=="n"?v.v:qa(v,null,c));for(var k=0,w=0;k!==p.length;++k)if((w=p.charCodeAt(k))===a||w===o||w===34||c.forceQuotes){p='"'+p.replace(Bg,'""')+'"';break}p=="ID"&&(p='"ID"')}else v.f!=null&&!v.F?(f=!1,p="="+v.f,p.indexOf(",")>=0&&(p='"'+p.replace(Bg,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&f?null:h.join(l)}function ky(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=hr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),p="",m=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],v=r.skipHidden&&e["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(g[k]||{}).hidden||(m[k]=Dr(k));for(var w=0,b=a.s.r;b<=a.e.r;++b)(v[b]||{}).hidden||(p=T4(e,a,b,m,l,f,o,r),p!=null&&(r.strip&&(p=p.replace(h,"")),(p||r.blankrows!==!1)&&t.push((w++?c:"")+p)));return delete r.dense,t.join("")}function N4(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=ky(e,n);return t}function D4(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=hr(e["!ref"]),o="",l=[],c,f=[],h=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Dr(c);for(var p=a.s.r;p<=a.e.r;++p)for(o=Hr(p),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=h?(e[p]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function by(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}var h,p={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var m=hr(o["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),l==-1&&(l=m.e.r+1,p.e.r=l+n.length-1+a)}else l==-1&&(l=0,p.e.r=n.length-1+a);var g=r.header||[],v=0;n.forEach(function(w,b){Ta(w).forEach(function(E){(v=g.indexOf(E))==-1&&(g[v=g.length]=E);var N=w[E],S="z",z="",te=wt({c:c+v,r:l+b+a});h=Nl(o,te),N&&typeof N=="object"&&!(N instanceof Date)?o[te]=N:(typeof N=="number"?S="n":typeof N=="boolean"?S="b":typeof N=="string"?S="s":N instanceof Date?(S="d",r.cellDates||(S="n",N=fn(N)),z=r.dateNF||kt[14]):N===null&&r.nullError&&(S="e",N=0),h?(h.t=S,h.v=N,delete h.w,delete h.R,z&&(h.z=z)):o[te]=h={t:S,v:N},z&&(h.z=z))})}),p.e.c=Math.max(p.e.c,c+g.length-1);var k=Hr(l);if(a)for(v=0;v<g.length;++v)o[Dr(v+c)+k]={t:"s",v:g[v]};return o["!ref"]=At(p),o}function F4(e,n){return by(null,e,n)}function Nl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=ln(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Nl(e,wt(n)):Nl(e,wt({r:n,c:t||0}))}function j4(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Tp(){return{SheetNames:[],Sheets:{}}}function Np(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(xD(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function A4(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=j4(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function P4(e,n){return e.z=n,e}function _y(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function O4(e,n,t){return _y(e,"#"+n,t)}function R4(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function M4(e,n,t,r){for(var a=typeof n!="string"?n:hr(n),o=typeof n=="string"?n:At(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Nl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var I4={encode_col:Dr,encode_row:Hr,encode_cell:wt,encode_range:At,decode_col:pp,decode_row:fp,split_cell:Gb,decode_cell:ln,decode_range:gi,format_cell:qa,sheet_add_aoa:T1,sheet_add_json:by,sheet_add_dom:gy,aoa_to_sheet:vi,json_to_sheet:F4,table_to_sheet:vy,table_to_book:JD,sheet_to_csv:ky,sheet_to_txt:N4,sheet_to_json:Rf,sheet_to_html:ZD,sheet_to_formulae:D4,sheet_to_row_object_array:Rf,sheet_get_cell:Nl,book_new:Tp,book_append_sheet:Np,book_set_sheet_visibility:A4,cell_set_number_format:P4,cell_set_hyperlink:_y,cell_set_internal_link:O4,cell_add_comment:R4,sheet_set_array_formula:M4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const z4=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=C.useState(null),o=C.useRef(null),l=h=>{const p=h.target.files?.[0];p&&a(p)},c=()=>{if(r){const h=new FileReader;h.onload=p=>{try{const m=new Uint8Array(p.target?.result),g=Of(m,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const v=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",v);const k=I4.sheet_to_json(v,{header:1});console.log("Parsed JSON data:",k);const w={headers:k[0],rows:k.slice(1)};console.log("Prepared file data:",w),t(r.name,w),f()}catch(m){console.error("Error reading Excel file:",m)}},h.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return u.jsx(dr,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Zaaduj plik Excel"}),u.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-2 overflow-hidden",children:u.jsx("div",{children:u.jsxs("div",{className:"relative mt-8",children:[u.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&u.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[u.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),u.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Zaaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Zaaduj"})]})]})})},L4=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>u.jsx(dr,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:u.jsxs("div",{className:"h-full flex items-center justify-between",children:[u.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastpi "',r,'"?']}),u.jsxs("div",{className:"flex space-x-2 shrink-0",children:[u.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),u.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastp"})]})]})});function Sy(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=Sy(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Wr(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=Sy(e))&&(r&&(r+=" "),r+=n);return r}const Ey=6048e5,B4=864e5,Ju=6e4,ed=36e5,W4=1e3,Wg=Symbol.for("constructDateFrom");function Xt(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Wg in e?e[Wg](n):e instanceof Date?new e.constructor(n):new Date(n)}function it(e,n){return Xt(n||e,e)}function oa(e,n,t){const r=it(e,t?.in);return isNaN(n)?Xt(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function ia(e,n,t){const r=it(e,t?.in);if(isNaN(n))return Xt(e,NaN);if(!n)return r;const a=r.getDate(),o=Xt(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function Cy(e,n,t){return Xt(e,+it(e)+n)}function U4(e,n,t){return Cy(e,n*ed)}let H4={};function So(){return H4}function la(e,n){const t=So(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=it(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function ui(e,n){return la(e,{...n,weekStartsOn:1})}function Ty(e,n){const t=it(e,n?.in),r=t.getFullYear(),a=Xt(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=ui(a),l=Xt(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=ui(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Ou(e){const n=it(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function ja(e,...n){const t=Xt.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function ho(e,n){const t=it(e,n?.in);return t.setHours(0,0,0,0),t}function di(e,n,t){const[r,a]=ja(t?.in,e,n),o=ho(r),l=ho(a),c=+o-Ou(o),f=+l-Ou(l);return Math.round((c-f)/B4)}function $4(e,n){const t=Ty(e,n),r=Xt(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),ui(r)}function Mf(e,n,t){const r=it(e,t?.in);return r.setTime(r.getTime()+n*Ju),r}function Dp(e,n,t){return ia(e,n*3,t)}function Y4(e,n,t){return Cy(e,n*1e3)}function Ru(e,n,t){return oa(e,n*7,t)}function Va(e,n,t){return ia(e,n*12,t)}function Ug(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Xt.bind(null,a));const o=it(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Xt(r,t||NaN)}function Hg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Xt.bind(null,a));const o=it(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Xt(r,t||NaN)}function V4(e,n,t){const[r,a]=ja(t?.in,e,n);return+ho(r)==+ho(a)}function Ka(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Mu(e){return!(!Ka(e)&&typeof e!="number"||isNaN(+it(e)))}function Iu(e,n,t){const[r,a]=ja(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function oo(e,n){const t=it(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function zu(e,n,t){const[r,a]=ja(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=oo(r)-oo(a);return o*4+l}function Lu(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function K4(e,n,t){const[r,a]=ja(t?.in,e,n),o=$g(r,a),l=Math.abs(di(r,a));r.setDate(r.getDate()-o*l);const c=+($g(r,a)===-o),f=o*(l-c);return f===0?0:f}function $g(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function Ny(e,n){const t=it(e,n?.in);return t.setHours(23,59,59,999),t}function Dy(e,n){const t=it(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function If(e,n){const t=it(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function Fy(e,n){const t=it(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function jy(e,n){const t=it(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function td(e,n){const t=it(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function G4(e,n){const t=So(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=it(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const X4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Q4=(e,n,t)=>{let r;const a=X4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function si(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const q4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Z4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},J4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},e3={date:si({formats:q4,defaultWidth:"full"}),time:si({formats:Z4,defaultWidth:"full"}),dateTime:si({formats:J4,defaultWidth:"full"})},t3={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},r3=(e,n,t,r)=>t3[e];function ya(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const n3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},a3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},s3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},o3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},i3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},l3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},c3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},u3={ordinalNumber:c3,era:ya({values:n3,defaultWidth:"wide"}),quarter:ya({values:a3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ya({values:s3,defaultWidth:"wide"}),day:ya({values:o3,defaultWidth:"wide"}),dayPeriod:ya({values:i3,defaultWidth:"wide",formattingValues:l3,defaultFormattingWidth:"wide"})};function wa(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?f3(c,m=>m.test(l)):d3(c,m=>m.test(l));let h;h=e.valueCallback?e.valueCallback(f):f,h=t.valueCallback?t.valueCallback(h):h;const p=n.slice(l.length);return{value:h,rest:p}}}function d3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function f3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function Ay(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const p3=/^(\d+)(th|st|nd|rd)?/i,h3=/\d+/i,x3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},m3={any:[/^b/i,/^(a|c)/i]},g3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},v3={any:[/1/i,/2/i,/3/i,/4/i]},y3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},w3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},k3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},b3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},_3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},S3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},E3={ordinalNumber:Ay({matchPattern:p3,parsePattern:h3,valueCallback:e=>parseInt(e,10)}),era:wa({matchPatterns:x3,defaultMatchWidth:"wide",parsePatterns:m3,defaultParseWidth:"any"}),quarter:wa({matchPatterns:g3,defaultMatchWidth:"wide",parsePatterns:v3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:wa({matchPatterns:y3,defaultMatchWidth:"wide",parsePatterns:w3,defaultParseWidth:"any"}),day:wa({matchPatterns:k3,defaultMatchWidth:"wide",parsePatterns:b3,defaultParseWidth:"any"}),dayPeriod:wa({matchPatterns:_3,defaultMatchWidth:"any",parsePatterns:S3,defaultParseWidth:"any"})},Py={code:"en-US",formatDistance:Q4,formatLong:e3,formatRelative:r3,localize:u3,match:E3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function C3(e,n){const t=it(e,n?.in);return di(t,td(t))+1}function Fp(e,n){const t=it(e,n?.in),r=+ui(t)-+$4(t);return Math.round(r/Ey)+1}function jp(e,n){const t=it(e,n?.in),r=t.getFullYear(),a=So(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Xt(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=la(l,n),f=Xt(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const h=la(f,n);return+t>=+c?r+1:+t>=+h?r:r-1}function T3(e,n){const t=So(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=jp(e,n),o=Xt(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),la(o,n)}function Oy(e,n){const t=it(e,n?.in),r=+la(t,n)-+T3(t,n);return Math.round(r/Ey)+1}function Gt(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const bs={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Gt(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Gt(t+1,2)},d(e,n){return Gt(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Gt(e.getHours()%12||12,n.length)},H(e,n){return Gt(e.getHours(),n.length)},m(e,n){return Gt(e.getMinutes(),n.length)},s(e,n){return Gt(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Gt(a,n.length)}},Qo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Yg={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return bs.y(e,n)},Y:function(e,n,t,r){const a=jp(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Gt(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Gt(o,n.length)},R:function(e,n){const t=Ty(e);return Gt(t,n.length)},u:function(e,n){const t=e.getFullYear();return Gt(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Gt(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Gt(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return bs.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Gt(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=Oy(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Gt(a,n.length)},I:function(e,n,t){const r=Fp(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Gt(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):bs.d(e,n)},D:function(e,n,t){const r=C3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Gt(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Gt(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Gt(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Gt(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Qo.noon:r===0?a=Qo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Qo.evening:r>=12?a=Qo.afternoon:r>=4?a=Qo.morning:a=Qo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return bs.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):bs.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Gt(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Gt(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):bs.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):bs.s(e,n)},S:function(e,n){return bs.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Kg(r);case"XXXX":case"XX":return Js(r);case"XXXXX":case"XXX":default:return Js(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Kg(r);case"xxxx":case"xx":return Js(r);case"xxxxx":case"xxx":default:return Js(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Vg(r,":");case"OOOO":default:return"GMT"+Js(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Vg(r,":");case"zzzz":default:return"GMT"+Js(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Gt(r,n.length)},T:function(e,n,t){return Gt(+e,n.length)}};function Vg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Gt(o,2)}function Kg(e,n){return e%60===0?(e>0?"-":"+")+Gt(Math.abs(e)/60,2):Js(e,n)}function Js(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Gt(Math.trunc(r/60),2),o=Gt(r%60,2);return t+a+n+o}const Gg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},Ry=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},N3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Gg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Gg(r,n)).replace("{{time}}",Ry(a,n))},zf={p:Ry,P:N3},D3=/^D+$/,F3=/^Y+$/,j3=["D","DD","YY","YYYY"];function A3(e){return D3.test(e)}function P3(e){return F3.test(e)}function O3(e,n,t){const r=R3(e,n,t);if(console.warn(r),j3.includes(e))throw new RangeError(r)}function R3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const M3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,I3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,z3=/^'([^]*?)'?$/,L3=/''/g,B3=/[a-zA-Z]/;function Xg(e,n,t){const r=So(),a=t?.locale??r.locale??Py,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=it(e,t?.in);if(!Mu(c))throw new RangeError("Invalid time value");let f=n.match(I3).map(p=>{const m=p[0];if(m==="p"||m==="P"){const g=zf[m];return g(p,a.formatLong)}return p}).join("").match(M3).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const m=p[0];if(m==="'")return{isToken:!1,value:W3(p)};if(Yg[m])return{isToken:!0,value:p};if(m.match(B3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const h={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(p=>{if(!p.isToken)return p.value;const m=p.value;(!t?.useAdditionalWeekYearTokens&&P3(m)||!t?.useAdditionalDayOfYearTokens&&A3(m))&&O3(m,n,String(e));const g=Yg[m[0]];return g(c,m,a.localize,h)}).join("")}function W3(e){const n=e.match(z3);return n?n[1].replace(L3,"'"):e}function Qg(e,n){return it(e,n?.in).getDate()}function U3(e,n){return it(e,n?.in).getDay()}function H3(e,n){const t=it(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Xt(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function $3(){return Object.assign({},So())}function Ga(e,n){return it(e,n?.in).getHours()}function Y3(e,n){const t=it(e,n?.in).getDay();return t===0?7:t}function Xa(e,n){return it(e,n?.in).getMinutes()}function cn(e,n){return it(e,n?.in).getMonth()}function Ds(e){return it(e).getSeconds()}function Lf(e){return+it(e)}function bt(e,n){return it(e,n?.in).getFullYear()}function Ps(e,n){return+it(e)>+it(n)}function xo(e,n){return+it(e)<+it(n)}function V3(e,n){return+it(e)==+it(n)}function K3(e,n){const t=G3(n)?new n(0):Xt(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function G3(e){return typeof e=="function"&&e.prototype?.constructor===e}const X3=10;class My{subPriority=0;validate(n,t){return!0}}class Q3 extends My{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class q3 extends My{priority=X3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Xt(t,r))}set(n,t){return t.timestampIsSet?n:Xt(n,K3(n,this.context))}}class Lt{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new Q3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class Z3 extends Lt{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const wr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ka={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function kr(e,n){return e&&{value:n(e.value),rest:e.rest}}function ur(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function ba(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*ed+o*Ju+l*W4),rest:n.slice(t[0].length)}}function Iy(e){return ur(wr.anyDigitsSigned,e)}function xr(e,n){switch(e){case 1:return ur(wr.singleDigit,n);case 2:return ur(wr.twoDigits,n);case 3:return ur(wr.threeDigits,n);case 4:return ur(wr.fourDigits,n);default:return ur(new RegExp("^\\d{1,"+e+"}"),n)}}function Bu(e,n){switch(e){case 1:return ur(wr.singleDigitSigned,n);case 2:return ur(wr.twoDigitsSigned,n);case 3:return ur(wr.threeDigitsSigned,n);case 4:return ur(wr.fourDigitsSigned,n);default:return ur(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Ap(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function zy(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function Ly(e){return e%400===0||e%4===0&&e%100!==0}class J3 extends Lt{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return kr(xr(4,n),a);case"yo":return kr(r.ordinalNumber(n,{unit:"year"}),a);default:return kr(xr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=zy(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class eF extends Lt{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return kr(xr(4,n),a);case"Yo":return kr(r.ordinalNumber(n,{unit:"year"}),a);default:return kr(xr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=jp(n,a);if(r.isTwoDigitYear){const c=zy(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),la(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),la(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class tF extends Lt{priority=130;parse(n,t){return Bu(t==="R"?4:t.length,n)}set(n,t,r){const a=Xt(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),ui(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class rF extends Lt{priority=130;parse(n,t){return Bu(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class nF extends Lt{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return xr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class aF extends Lt{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return xr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class sF extends Lt{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return kr(ur(wr.month,n),a);case"MM":return kr(xr(2,n),a);case"Mo":return kr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class oF extends Lt{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return kr(ur(wr.month,n),a);case"LL":return kr(xr(2,n),a);case"Lo":return kr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function iF(e,n,t){const r=it(e,t?.in),a=Oy(r,t)-n;return r.setDate(r.getDate()-a*7),it(r,t?.in)}class lF extends Lt{priority=100;parse(n,t,r){switch(t){case"w":return ur(wr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return la(iF(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function cF(e,n,t){const r=it(e,t?.in),a=Fp(r,t)-n;return r.setDate(r.getDate()-a*7),r}class uF extends Lt{priority=100;parse(n,t,r){switch(t){case"I":return ur(wr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return ui(cF(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const dF=[31,28,31,30,31,30,31,31,30,31,30,31],fF=[31,29,31,30,31,30,31,31,30,31,30,31];class pF extends Lt{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return ur(wr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return xr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=Ly(r),o=n.getMonth();return a?t>=1&&t<=fF[o]:t>=1&&t<=dF[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class hF extends Lt{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return ur(wr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return xr(t.length,n)}}validate(n,t){const r=n.getFullYear();return Ly(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Pp(e,n,t){const r=So(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=it(e,t?.in),l=o.getDay(),f=(n%7+7)%7,h=7-a,p=n<0||n>6?n-(l+h)%7:(f+h)%7-(l+h)%7;return oa(o,p,t)}class xF extends Lt{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class mF extends Lt{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return kr(xr(t.length,n),o);case"eo":return kr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class gF extends Lt{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return kr(xr(t.length,n),o);case"co":return kr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function vF(e,n,t){const r=it(e,t?.in),a=Y3(r,t),o=n-a;return oa(r,o,t)}class yF extends Lt{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return xr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return kr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return kr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return kr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return kr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=vF(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class wF extends Lt{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class kF extends Lt{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class bF extends Lt{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class _F extends Lt{priority=70;parse(n,t,r){switch(t){case"h":return ur(wr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class SF extends Lt{priority=70;parse(n,t,r){switch(t){case"H":return ur(wr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class EF extends Lt{priority=70;parse(n,t,r){switch(t){case"K":return ur(wr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class CF extends Lt{priority=70;parse(n,t,r){switch(t){case"k":return ur(wr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class TF extends Lt{priority=60;parse(n,t,r){switch(t){case"m":return ur(wr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class NF extends Lt{priority=50;parse(n,t,r){switch(t){case"s":return ur(wr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class DF extends Lt{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return kr(xr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class FF extends Lt{priority=10;parse(n,t){switch(t){case"X":return ba(ka.basicOptionalMinutes,n);case"XX":return ba(ka.basic,n);case"XXXX":return ba(ka.basicOptionalSeconds,n);case"XXXXX":return ba(ka.extendedOptionalSeconds,n);case"XXX":default:return ba(ka.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Xt(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","x"]}class jF extends Lt{priority=10;parse(n,t){switch(t){case"x":return ba(ka.basicOptionalMinutes,n);case"xx":return ba(ka.basic,n);case"xxxx":return ba(ka.basicOptionalSeconds,n);case"xxxxx":return ba(ka.extendedOptionalSeconds,n);case"xxx":default:return ba(ka.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Xt(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","X"]}class AF extends Lt{priority=40;parse(n){return Iy(n)}set(n,t,r){return[Xt(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class PF extends Lt{priority=20;parse(n){return Iy(n)}set(n,t,r){return[Xt(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const OF={G:new Z3,y:new J3,Y:new eF,R:new tF,u:new rF,Q:new nF,q:new aF,M:new sF,L:new oF,w:new lF,I:new uF,d:new pF,D:new hF,E:new xF,e:new mF,c:new gF,i:new yF,a:new wF,b:new kF,B:new bF,h:new _F,H:new SF,K:new EF,k:new CF,m:new TF,s:new NF,S:new DF,X:new FF,x:new jF,t:new AF,T:new PF},RF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,MF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,IF=/^'([^]*?)'?$/,zF=/''/g,LF=/\S/,BF=/[a-zA-Z]/;function WF(e,n,t,r){const a=()=>Xt(r?.in||t,NaN),o=$3(),l=r?.locale??o.locale??Py,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():it(t,r?.in);const h={firstWeekContainsDate:c,weekStartsOn:f,locale:l},p=[new q3(r?.in,t)],m=n.match(MF).map(b=>{const E=b[0];if(E in zf){const N=zf[E];return N(b,l.formatLong)}return b}).join("").match(RF),g=[];for(let b of m){const E=b[0],N=OF[E];if(N){const{incompatibleTokens:S}=N;if(Array.isArray(S)){const te=g.find(V=>S.includes(V.token)||V.token===E);if(te)throw new RangeError(`The format string mustn't contain \`${te.fullToken}\` and \`${b}\` at the same time`)}else if(N.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${b}\` and any other token at the same time`);g.push({token:E,fullToken:b});const z=N.run(e,b,l.match,h);if(!z)return a();p.push(z.setter),e=z.rest}else{if(E.match(BF))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");if(b==="''"?b="'":E==="'"&&(b=UF(b)),e.indexOf(b)===0)e=e.slice(b.length);else return a()}}if(e.length>0&&LF.test(e))return a();const v=p.map(b=>b.priority).sort((b,E)=>E-b).filter((b,E,N)=>N.indexOf(b)===E).map(b=>p.filter(E=>E.priority===b).sort((E,N)=>N.subPriority-E.subPriority)).map(b=>b[0]);let k=it(t,r?.in);if(isNaN(+k))return a();const w={};for(const b of v){if(!b.validate(k,h))return a();const E=b.set(k,w,h);Array.isArray(E)?(k=E[0],Object.assign(w,E[1])):k=E}return k}function UF(e){return e.match(IF)[1].replace(zF,"'")}function HF(e,n,t){const[r,a]=ja(t?.in,e,n);return+la(r,t)==+la(a,t)}function $F(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function YF(e,n,t){const[r,a]=ja(t?.in,e,n);return+If(r)==+If(a)}function VF(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Dl(e,n,t){const r=+it(e,t?.in),[a,o]=[+it(n.start,t?.in),+it(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function KF(e,n,t){return oa(e,-1,t)}function GF(e,n){const t=()=>Xt(n?.in,NaN),a=ZF(e);let o;if(a.date){const h=JF(a.date,2);o=ej(h.restDateString,h.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=tj(a.time),isNaN(c)))return t();if(a.timezone){if(f=rj(a.timezone),isNaN(f))return t()}else{const h=new Date(l+c),p=it(0,n?.in);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return it(l+c+f,n?.in)}const lu={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},XF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,QF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,qF=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ZF(e){const n={},t=e.split(lu.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],lu.timeZoneDelimiter.test(n.date)&&(n.date=e.split(lu.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=lu.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function JF(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function ej(e,n){if(n===null)return new Date(NaN);const t=e.match(XF);if(!t)return new Date(NaN);const r=!!t[4],a=rl(t[1]),o=rl(t[2])-1,l=rl(t[3]),c=rl(t[4]),f=rl(t[5])-1;if(r)return ij(n,c,f)?nj(n,c,f):new Date(NaN);{const h=new Date(0);return!sj(n,o,l)||!oj(n,a)?new Date(NaN):(h.setUTCFullYear(n,o,Math.max(a,l)),h)}}function rl(e){return e?parseInt(e):1}function tj(e){const n=e.match(QF);if(!n)return NaN;const t=lf(n[1]),r=lf(n[2]),a=lf(n[3]);return lj(t,r,a)?t*ed+r*Ju+a*1e3:NaN}function lf(e){return e&&parseFloat(e.replace(",","."))||0}function rj(e){if(e==="Z")return 0;const n=e.match(qF);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return cj(r,a)?t*(r*ed+a*Ju):NaN}function nj(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const aj=[31,null,31,30,31,30,31,31,30,31,30,31];function By(e){return e%400===0||e%4===0&&e%100!==0}function sj(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(aj[n]||(By(e)?29:28))}function oj(e,n){return n>=1&&n<=(By(e)?366:365)}function ij(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function lj(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function cj(e,n){return n>=0&&n<=59}function Bn(e,n,t){const r=it(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Xt(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=H3(l);return r.setMonth(n,Math.min(o,c)),r}function mu(e,n,t){const r=it(e,t?.in);return r.setHours(n),r}function gu(e,n,t){const r=it(e,t?.in);return r.setMinutes(n),r}function Jo(e,n,t){const r=it(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Bn(r,r.getMonth()+o*3)}function vu(e,n,t){const r=it(e,t?.in);return r.setSeconds(n),r}function ga(e,n,t){const r=it(e,t?.in);return isNaN(+r)?Xt(e,NaN):(r.setFullYear(n),r)}function io(e,n,t){return ia(e,-n,t)}function Wy(e,n,t){return Dp(e,-1,t)}function qg(e,n,t){return Ru(e,-1,t)}function fi(e,n,t){return Va(e,-n,t)}function rd(){return typeof window<"u"}function yi(e){return Uy(e)?(e.nodeName||"").toLowerCase():"#document"}function Cn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Aa(e){var n;return(n=(Uy(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function Uy(e){return rd()?e instanceof Node||e instanceof Cn(e).Node:!1}function un(e){return rd()?e instanceof Element||e instanceof Cn(e).Element:!1}function Na(e){return rd()?e instanceof HTMLElement||e instanceof Cn(e).HTMLElement:!1}function Zg(e){return!rd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Cn(e).ShadowRoot}function Ll(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Hn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function uj(e){return["table","td","th"].includes(yi(e))}function nd(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Op(e){const n=Rp(),t=un(e)?Hn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function dj(e){let n=Os(e);for(;Na(n)&&!pi(n);){if(Op(n))return n;if(nd(n))return null;n=Os(n)}return null}function Rp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function pi(e){return["html","body","#document"].includes(yi(e))}function Hn(e){return Cn(e).getComputedStyle(e)}function ad(e){return un(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Os(e){if(yi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Zg(e)&&e.host||Aa(e);return Zg(n)?n.host:n}function Hy(e){const n=Os(e);return pi(n)?e.ownerDocument?e.ownerDocument.body:e.body:Na(n)&&Ll(n)?n:Hy(n)}function Fl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=Hy(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Cn(a);if(o){const c=Bf(l);return n.concat(l,l.visualViewport||[],Ll(a)?a:[],c&&t?Fl(c):[])}return n.concat(a,Fl(a,[],t))}function Bf(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const hi=Math.min,lo=Math.max,Wu=Math.round,cu=Math.floor,Ea=e=>({x:e,y:e}),fj={left:"right",right:"left",bottom:"top",top:"bottom"},pj={start:"end",end:"start"};function Wf(e,n,t){return lo(e,hi(n,t))}function Bl(e,n){return typeof e=="function"?e(n):e}function mo(e){return e.split("-")[0]}function Wl(e){return e.split("-")[1]}function $y(e){return e==="x"?"y":"x"}function Mp(e){return e==="y"?"height":"width"}function co(e){return["top","bottom"].includes(mo(e))?"y":"x"}function Ip(e){return $y(co(e))}function hj(e,n,t){t===void 0&&(t=!1);const r=Wl(e),a=Ip(e),o=Mp(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=Uu(l)),[l,Uu(l)]}function xj(e){const n=Uu(e);return[Uf(e),n,Uf(n)]}function Uf(e){return e.replace(/start|end/g,n=>pj[n])}function mj(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function gj(e,n,t,r){const a=Wl(e);let o=mj(mo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map(Uf)))),o}function Uu(e){return e.replace(/left|right|bottom|top/g,n=>fj[n])}function vj(e){return{top:0,right:0,bottom:0,left:0,...e}}function Yy(e){return typeof e!="number"?vj(e):{top:e,right:e,bottom:e,left:e}}function Hu(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var $u=typeof document<"u"?C.useLayoutEffect:C.useEffect;const yj={...Mv},wj=yj.useInsertionEffect,kj=wj||(e=>e());function bj(e){const n=C.useRef(()=>{});return kj(()=>{n.current=e}),C.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var Vy=Qf();const _j=Gu(Vy);function Jg(e,n,t){let{reference:r,floating:a}=e;const o=co(n),l=Ip(n),c=Mp(l),f=mo(n),h=o==="y",p=r.x+r.width/2-a.width/2,m=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let v;switch(f){case"top":v={x:p,y:r.y-a.height};break;case"bottom":v={x:p,y:r.y+r.height};break;case"right":v={x:r.x+r.width,y:m};break;case"left":v={x:r.x-a.width,y:m};break;default:v={x:r.x,y:r.y}}switch(Wl(n)){case"start":v[l]-=g*(t&&h?-1:1);break;case"end":v[l]+=g*(t&&h?-1:1);break}return v}const Sj=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let h=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:p,y:m}=Jg(h,r,f),g=r,v={},k=0;for(let w=0;w<c.length;w++){const{name:b,fn:E}=c[w],{x:N,y:S,data:z,reset:te}=await E({x:p,y:m,initialPlacement:r,placement:g,strategy:a,middlewareData:v,rects:h,platform:l,elements:{reference:e,floating:n}});p=N??p,m=S??m,v={...v,[b]:{...v[b],...z}},te&&k<=50&&(k++,typeof te=="object"&&(te.placement&&(g=te.placement),te.rects&&(h=te.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):te.rects),{x:p,y:m}=Jg(h,g,f)),w=-1)}return{x:p,y:m,placement:g,strategy:a,middlewareData:v}};async function Ky(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:m="floating",altBoundary:g=!1,padding:v=0}=Bl(n,e),k=Yy(v),b=c[g?m==="floating"?"reference":"floating":m],E=Hu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(b)))==null||t?b:b.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:h,rootBoundary:p,strategy:f})),N=m==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),z=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},te=Hu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:N,offsetParent:S,strategy:f}):N);return{top:(E.top-te.top+k.top)/z.y,bottom:(te.bottom-E.bottom+k.bottom)/z.y,left:(E.left-te.left+k.left)/z.x,right:(te.right-E.right+k.right)/z.x}}const Ej=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:h,padding:p=0}=Bl(e,n)||{};if(h==null)return{};const m=Yy(p),g={x:t,y:r},v=Ip(a),k=Mp(v),w=await l.getDimensions(h),b=v==="y",E=b?"top":"left",N=b?"bottom":"right",S=b?"clientHeight":"clientWidth",z=o.reference[k]+o.reference[v]-g[v]-o.floating[k],te=g[v]-o.reference[v],V=await(l.getOffsetParent==null?void 0:l.getOffsetParent(h));let D=V?V[S]:0;(!D||!await(l.isElement==null?void 0:l.isElement(V)))&&(D=c.floating[S]||o.floating[k]);const H=z/2-te/2,L=D/2-w[k]/2-1,ae=hi(m[E],L),Q=hi(m[N],L),Y=ae,ue=D-w[k]-Q,le=D/2-w[k]/2+H,oe=Wf(Y,le,ue),pe=!f.arrow&&Wl(a)!=null&&le!==oe&&o.reference[k]/2-(le<Y?ae:Q)-w[k]/2<0,G=pe?le<Y?le-Y:le-ue:0;return{[v]:g[v]+G,data:{[v]:oe,centerOffset:le-oe-G,...pe&&{alignmentOffset:G}},reset:pe}}}),Cj=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:h}=n,{mainAxis:p=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:w=!0,...b}=Bl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const E=mo(a),N=co(c),S=mo(c)===c,z=await(f.isRTL==null?void 0:f.isRTL(h.floating)),te=g||(S||!w?[Uu(c)]:xj(c)),V=k!=="none";!g&&V&&te.push(...gj(c,w,k,z));const D=[c,...te],H=await Ky(n,b),L=[];let ae=((r=o.flip)==null?void 0:r.overflows)||[];if(p&&L.push(H[E]),m){const oe=hj(a,l,z);L.push(H[oe[0]],H[oe[1]])}if(ae=[...ae,{placement:a,overflows:L}],!L.every(oe=>oe<=0)){var Q,Y;const oe=(((Q=o.flip)==null?void 0:Q.index)||0)+1,pe=D[oe];if(pe){var ue;const ie=m==="alignment"?N!==co(pe):!1,B=((ue=ae[0])==null?void 0:ue.overflows[0])>0;if(!ie||B)return{data:{index:oe,overflows:ae},reset:{placement:pe}}}let G=(Y=ae.filter(ie=>ie.overflows[0]<=0).sort((ie,B)=>ie.overflows[1]-B.overflows[1])[0])==null?void 0:Y.placement;if(!G)switch(v){case"bestFit":{var le;const ie=(le=ae.filter(B=>{if(V){const de=co(B.placement);return de===N||de==="y"}return!0}).map(B=>[B.placement,B.overflows.filter(de=>de>0).reduce((de,I)=>de+I,0)]).sort((B,de)=>B[1]-de[1])[0])==null?void 0:le[0];ie&&(G=ie);break}case"initialPlacement":G=c;break}if(a!==G)return{reset:{placement:G}}}return{}}}};async function Tj(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=mo(t),c=Wl(t),f=co(t)==="y",h=["left","top"].includes(l)?-1:1,p=o&&f?-1:1,m=Bl(n,e);let{mainAxis:g,crossAxis:v,alignmentAxis:k}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof k=="number"&&(v=c==="end"?k*-1:k),f?{x:v*p,y:g*h}:{x:g*h,y:v*p}}const Nj=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await Tj(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},Dj=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:b=>{let{x:E,y:N}=b;return{x:E,y:N}}},...f}=Bl(e,n),h={x:t,y:r},p=await Ky(n,f),m=co(mo(a)),g=$y(m);let v=h[g],k=h[m];if(o){const b=g==="y"?"top":"left",E=g==="y"?"bottom":"right",N=v+p[b],S=v-p[E];v=Wf(N,v,S)}if(l){const b=m==="y"?"top":"left",E=m==="y"?"bottom":"right",N=k+p[b],S=k-p[E];k=Wf(N,k,S)}const w=c.fn({...n,[g]:v,[m]:k});return{...w,data:{x:w.x-t,y:w.y-r,enabled:{[g]:o,[m]:l}}}}}};function Gy(e){const n=Hn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Na(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=Wu(t)!==o||Wu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function zp(e){return un(e)?e:e.contextElement}function oi(e){const n=zp(e);if(!Na(n))return Ea(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Gy(n);let l=(o?Wu(t.width):t.width)/r,c=(o?Wu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const Fj=Ea(0);function Xy(e){const n=Cn(e);return!Rp()||!n.visualViewport?Fj:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function jj(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Cn(e)?!1:n}function go(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=zp(e);let l=Ea(1);n&&(r?un(r)&&(l=oi(r)):l=oi(e));const c=jj(o,t,r)?Xy(o):Ea(0);let f=(a.left+c.x)/l.x,h=(a.top+c.y)/l.y,p=a.width/l.x,m=a.height/l.y;if(o){const g=Cn(o),v=r&&un(r)?Cn(r):r;let k=g,w=Bf(k);for(;w&&r&&v!==k;){const b=oi(w),E=w.getBoundingClientRect(),N=Hn(w),S=E.left+(w.clientLeft+parseFloat(N.paddingLeft))*b.x,z=E.top+(w.clientTop+parseFloat(N.paddingTop))*b.y;f*=b.x,h*=b.y,p*=b.x,m*=b.y,f+=S,h+=z,k=Cn(w),w=Bf(k)}}return Hu({width:p,height:m,x:f,y:h})}function Lp(e,n){const t=ad(e).scrollLeft;return n?n.left+t:go(Aa(e)).left+t}function Qy(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:Lp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function Aj(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Aa(r),c=n?nd(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},h=Ea(1);const p=Ea(0),m=Na(r);if((m||!m&&!o)&&((yi(r)!=="body"||Ll(l))&&(f=ad(r)),Na(r))){const v=go(r);h=oi(r),p.x=v.x+r.clientLeft,p.y=v.y+r.clientTop}const g=l&&!m&&!o?Qy(l,f,!0):Ea(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-f.scrollLeft*h.x+p.x+g.x,y:t.y*h.y-f.scrollTop*h.y+p.y+g.y}}function Pj(e){return Array.from(e.getClientRects())}function Oj(e){const n=Aa(e),t=ad(e),r=e.ownerDocument.body,a=lo(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=lo(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+Lp(e);const c=-t.scrollTop;return Hn(r).direction==="rtl"&&(l+=lo(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function Rj(e,n){const t=Cn(e),r=Aa(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const h=Rp();(!h||h&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function Mj(e,n){const t=go(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Na(e)?oi(e):Ea(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,h=r*o.y;return{width:l,height:c,x:f,y:h}}function ev(e,n,t){let r;if(n==="viewport")r=Rj(e,t);else if(n==="document")r=Oj(Aa(e));else if(un(n))r=Mj(n,t);else{const a=Xy(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Hu(r)}function qy(e,n){const t=Os(e);return t===n||!un(t)||pi(t)?!1:Hn(t).position==="fixed"||qy(t,n)}function Ij(e,n){const t=n.get(e);if(t)return t;let r=Fl(e,[],!1).filter(c=>un(c)&&yi(c)!=="body"),a=null;const o=Hn(e).position==="fixed";let l=o?Os(e):e;for(;un(l)&&!pi(l);){const c=Hn(l),f=Op(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Ll(l)&&!f&&qy(e,l))?r=r.filter(p=>p!==l):a=c,l=Os(l)}return n.set(e,r),r}function zj(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?nd(n)?[]:Ij(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((h,p)=>{const m=ev(n,p,a);return h.top=lo(m.top,h.top),h.right=hi(m.right,h.right),h.bottom=hi(m.bottom,h.bottom),h.left=lo(m.left,h.left),h},ev(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function Lj(e){const{width:n,height:t}=Gy(e);return{width:n,height:t}}function Bj(e,n,t){const r=Na(n),a=Aa(n),o=t==="fixed",l=go(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=Ea(0);function h(){f.x=Lp(a)}if(r||!r&&!o)if((yi(n)!=="body"||Ll(a))&&(c=ad(n)),r){const v=go(n,!0,o,n);f.x=v.x+n.clientLeft,f.y=v.y+n.clientTop}else a&&h();o&&!r&&a&&h();const p=a&&!r&&!o?Qy(a,c):Ea(0),m=l.left+c.scrollLeft-f.x-p.x,g=l.top+c.scrollTop-f.y-p.y;return{x:m,y:g,width:l.width,height:l.height}}function cf(e){return Hn(e).position==="static"}function tv(e,n){if(!Na(e)||Hn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Aa(e)===t&&(t=t.ownerDocument.body),t}function Zy(e,n){const t=Cn(e);if(nd(e))return t;if(!Na(e)){let a=Os(e);for(;a&&!pi(a);){if(un(a)&&!cf(a))return a;a=Os(a)}return t}let r=tv(e,n);for(;r&&uj(r)&&cf(r);)r=tv(r,n);return r&&pi(r)&&cf(r)&&!Op(r)?t:r||dj(e)||t}const Wj=async function(e){const n=this.getOffsetParent||Zy,t=this.getDimensions,r=await t(e.floating);return{reference:Bj(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Uj(e){return Hn(e).direction==="rtl"}const Hj={convertOffsetParentRelativeRectToViewportRelativeRect:Aj,getDocumentElement:Aa,getClippingRect:zj,getOffsetParent:Zy,getElementRects:Wj,getClientRects:Pj,getDimensions:Lj,getScale:oi,isElement:un,isRTL:Uj};function Jy(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function $j(e,n){let t=null,r;const a=Aa(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const h=e.getBoundingClientRect(),{left:p,top:m,width:g,height:v}=h;if(c||n(),!g||!v)return;const k=cu(m),w=cu(a.clientWidth-(p+g)),b=cu(a.clientHeight-(m+v)),E=cu(p),S={rootMargin:-k+"px "+-w+"px "+-b+"px "+-E+"px",threshold:lo(0,hi(1,f))||1};let z=!0;function te(V){const D=V[0].intersectionRatio;if(D!==f){if(!z)return l();D?l(!1,D):r=setTimeout(()=>{l(!1,1e-7)},1e3)}D===1&&!Jy(h,e.getBoundingClientRect())&&l(),z=!1}try{t=new IntersectionObserver(te,{...S,root:a.ownerDocument})}catch{t=new IntersectionObserver(te,S)}t.observe(e)}return l(!0),o}function ew(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,h=zp(e),p=a||o?[...h?Fl(h):[],...Fl(n)]:[];p.forEach(E=>{a&&E.addEventListener("scroll",t,{passive:!0}),o&&E.addEventListener("resize",t)});const m=h&&c?$j(h,t):null;let g=-1,v=null;l&&(v=new ResizeObserver(E=>{let[N]=E;N&&N.target===h&&v&&(v.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var S;(S=v)==null||S.observe(n)})),t()}),h&&!f&&v.observe(h),v.observe(n));let k,w=f?go(e):null;f&&b();function b(){const E=go(e);w&&!Jy(w,E)&&t(),w=E,k=requestAnimationFrame(b)}return t(),()=>{var E;p.forEach(N=>{a&&N.removeEventListener("scroll",t),o&&N.removeEventListener("resize",t)}),m?.(),(E=v)==null||E.disconnect(),v=null,f&&cancelAnimationFrame(k)}}const tw=Nj,Yj=Dj,rw=Cj,Hf=Ej,$f=(e,n,t)=>{const r=new Map,a={platform:Hj,...t},o={...a.platform,_c:r};return Sj(e,n,{...a,platform:o})};var yu=typeof document<"u"?C.useLayoutEffect:C.useEffect;function Yu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Yu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Yu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function nw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function rv(e,n){const t=nw(e);return Math.round(n*t)/t}function uf(e){const n=C.useRef(e);return yu(()=>{n.current=e}),n}function Vj(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:h}=e,[p,m]=C.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,v]=C.useState(r);Yu(g,r)||v(r);const[k,w]=C.useState(null),[b,E]=C.useState(null),N=C.useCallback(ie=>{ie!==V.current&&(V.current=ie,w(ie))},[]),S=C.useCallback(ie=>{ie!==D.current&&(D.current=ie,E(ie))},[]),z=o||k,te=l||b,V=C.useRef(null),D=C.useRef(null),H=C.useRef(p),L=f!=null,ae=uf(f),Q=uf(a),Y=uf(h),ue=C.useCallback(()=>{if(!V.current||!D.current)return;const ie={placement:n,strategy:t,middleware:g};Q.current&&(ie.platform=Q.current),$f(V.current,D.current,ie).then(B=>{const de={...B,isPositioned:Y.current!==!1};le.current&&!Yu(H.current,de)&&(H.current=de,Vy.flushSync(()=>{m(de)}))})},[g,n,t,Q,Y]);yu(()=>{h===!1&&H.current.isPositioned&&(H.current.isPositioned=!1,m(ie=>({...ie,isPositioned:!1})))},[h]);const le=C.useRef(!1);yu(()=>(le.current=!0,()=>{le.current=!1}),[]),yu(()=>{if(z&&(V.current=z),te&&(D.current=te),z&&te){if(ae.current)return ae.current(z,te,ue);ue()}},[z,te,ue,ae,L]);const oe=C.useMemo(()=>({reference:V,floating:D,setReference:N,setFloating:S}),[N,S]),pe=C.useMemo(()=>({reference:z,floating:te}),[z,te]),G=C.useMemo(()=>{const ie={position:t,left:0,top:0};if(!pe.floating)return ie;const B=rv(pe.floating,p.x),de=rv(pe.floating,p.y);return c?{...ie,transform:"translate("+B+"px, "+de+"px)",...nw(pe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:B,top:de}},[t,c,pe.floating,p.x,p.y]);return C.useMemo(()=>({...p,update:ue,refs:oe,elements:pe,floatingStyles:G}),[p,ue,oe,pe,G])}const Kj=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?Hf({element:r.current,padding:a}).fn(t):{}:r?Hf({element:r,padding:a}).fn(t):{}}}},Gj=(e,n)=>({...tw(e),options:[e,n]}),Xj=(e,n)=>({...rw(e),options:[e,n]}),Qj=(e,n)=>({...Kj(e),options:[e,n]}),qj={...Mv};let nv=!1,Zj=0;const av=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Zj++;function Jj(){const[e,n]=C.useState(()=>nv?av():void 0);return $u(()=>{e==null&&n(av())},[]),C.useEffect(()=>{nv=!0},[]),e}const eA=qj.useId,aw=eA||Jj,tA=C.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:m,stroke:g,d:v,style:{transform:k,...w}={},...b}=n,E=aw(),[N,S]=C.useState(!1);if($u(()=>{if(!a)return;Hn(a).direction==="rtl"&&S(!0)},[a]),!a)return null;const[z,te]=r.split("-"),V=z==="top"||z==="bottom";let D=m;(V&&l!=null&&l.x||!V&&l!=null&&l.y)&&(D=null);const H=p*2,L=H/2,ae=c/2*(h/-8+1),Q=f/2*h/4,Y=!!v,ue=D&&te==="end"?"bottom":"top";let le=D&&te==="end"?"right":"left";D&&N&&(le=te==="end"?"left":"right");const oe=o?.x!=null?D||o.x:"",pe=o?.y!=null?D||o.y:"",G=v||"M0,0"+(" H"+c)+(" L"+(c-ae)+","+(f-Q))+(" Q"+c/2+","+f+" "+ae+","+(f-Q))+" Z",ie={top:Y?"rotate(180deg)":"",left:Y?"rotate(90deg)":"rotate(-90deg)",bottom:Y?"":"rotate(180deg)",right:Y?"rotate(-90deg)":"rotate(90deg)"}[z];return u.jsxs("svg",{...b,"aria-hidden":!0,ref:t,width:Y?c:c+H,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[le]:oe,[ue]:pe,[z]:V||Y?"100%":"calc(100% - "+H/2+"px)",transform:[ie,k].filter(B=>!!B).join(" "),...w},children:[H>0&&u.jsx("path",{clipPath:"url(#"+E+")",fill:"none",stroke:g,strokeWidth:H+(v?0:1),d:G}),u.jsx("path",{stroke:H&&!v?b.fill:"none",d:G}),u.jsx("clipPath",{id:E,children:u.jsx("rect",{x:-L,y:L*(Y?-1:1),width:c+H,height:c})})]})});function rA(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const nA=C.createContext(null),aA=C.createContext(null),sA=()=>{var e;return((e=C.useContext(nA))==null?void 0:e.id)||null},oA=()=>C.useContext(aA);function iA(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=aw(),o=C.useRef({}),[l]=C.useState(()=>rA()),c=sA()!=null,[f,h]=C.useState(r.reference),p=bj((v,k,w)=>{o.current.openEvent=v?k:void 0,l.emit("openchange",{open:v,event:k,reason:w,nested:c}),t?.(v,k,w)}),m=C.useMemo(()=>({setPositionReference:h}),[]),g=C.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return C.useMemo(()=>({dataRef:o,open:n,onOpenChange:p,elements:g,events:l,floatingId:a,refs:m}),[n,p,g,l,a,m])}function lA(e){e===void 0&&(e={});const{nodeId:n}=e,t=iA({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=C.useState(null),[c,f]=C.useState(null),p=a?.domReference||o,m=C.useRef(null),g=oA();$u(()=>{p&&(m.current=p)},[p]);const v=Vj({...e,elements:{...a,...c&&{reference:c}}}),k=C.useCallback(S=>{const z=un(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),getClientRects:()=>S.getClientRects(),contextElement:S}:S;f(z),v.refs.setReference(z)},[v.refs]),w=C.useCallback(S=>{(un(S)||S===null)&&(m.current=S,l(S)),(un(v.refs.reference.current)||v.refs.reference.current===null||S!==null&&!un(S))&&v.refs.setReference(S)},[v.refs]),b=C.useMemo(()=>({...v.refs,setReference:w,setPositionReference:k,domReference:m}),[v.refs,w,k]),E=C.useMemo(()=>({...v.elements,domReference:p}),[v.elements,p]),N=C.useMemo(()=>({...v,...r,refs:b,elements:E,nodeId:n}),[v,b,E,n,r]);return $u(()=>{r.dataRef.current.floatingContext=N;const S=g?.nodesRef.current.find(z=>z.id===n);S&&(S.context=N)}),C.useMemo(()=>({...v,context:N,refs:b,elements:E}),[v,b,E,N])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Yf=function(n,t){return Yf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},Yf(n,t)};function Ir(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Yf(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var Rt=function(){return Rt=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Rt.apply(this,arguments)};function Sa(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var cA=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return Te.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},uA=function(e,n){var t=C.useRef(null),r=C.useRef(e);r.current=e;var a=C.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return C.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},sd=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=uA(t,l);return Te.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},Qe;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(Qe||(Qe={}));function Bp(){var e=typeof window<"u"?window:globalThis;return e}var Ul=12;function Ut(e){if(e==null)return new Date;var n=typeof e=="string"?GF(e):it(e);return od(n)?n:new Date}function df(e,n,t,r,a){a===void 0&&(a=Ut());for(var o=xi(t)||xi(Wp()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var h=f[c],p=WF(e,h,a,{locale:o});if(od(p)&&(!r||e===ir(p,h,t)))return p}return null}function od(e,n){return Mu(e)&&!xo(e,new Date("1/1/1800"))}function ir(e,n,t){if(t==="en")return Xg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?xi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||xi(Wp()),Xg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Ln(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&ir(e,a,r)||""}function dA(e,n,t){if(!e)return"";var r=Ln(e,t),a=n?Ln(n,t):"";return"".concat(r," - ").concat(a)}function fA(e,n){if(!e?.length)return"";var t=e[0]?Ln(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=Ln(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function ff(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return mu(gu(vu(e,c),o),r)}function pA(e){return Fp(e)}function hA(e,n){return ir(e,"ddd",n)}function wu(e){return ho(e)}function Fs(e,n,t){var r=xi(n||Wp());return la(e,{locale:r,weekStartsOn:t})}function Qa(e){return Fy(e)}function ll(e){return td(e)}function sv(e){return If(e)}function ov(){return ho(Ut())}function iv(e){return Ny(e)}function xA(e){return G4(e)}function mA(e){return Dy(e)}function va(e,n){return e&&n?VF(e,n):!e&&!n}function an(e,n){return e&&n?$F(e,n):!e&&!n}function Vu(e,n){return e&&n?YF(e,n):!e&&!n}function Ot(e,n){return e&&n?V4(e,n):!e&&!n}function ro(e,n){return e&&n?V3(e,n):!e&&!n}function cl(e,n,t){var r,a=ho(n),o=Ny(t);try{r=Dl(e,{start:a,end:o})}catch{r=!1}return r}function Ms(e,n){var t=Bp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function Wp(){var e=Bp();return e.__localeId__}function xi(e){if(typeof e=="string"){var n=Bp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function gA(e,n,t){return n(ir(e,"EEEE",t))}function vA(e,n){return ir(e,"EEEEEE",n)}function yA(e,n){return ir(e,"EEE",n)}function Up(e,n){return ir(Bn(Ut(),e),"LLLL",n)}function sw(e,n){return ir(Bn(Ut(),e),"LLL",n)}function wA(e,n){return ir(Jo(Ut(),e),"QQQ",n)}function Wn(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,h=t.filterDate;return Hl(e,{minDate:r,maxDate:a})||o&&o.some(function(p){return p instanceof Date?Ot(e,p):Ot(e,p.date)})||l&&l.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||c&&!c.some(function(p){return Ot(e,p)})||f&&!f.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||h&&!h(Ut(e))||!1}function Hp(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Dl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?Ot(e,o):Ot(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function ow(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Hl(e,{minDate:r?Fy(r):void 0,maxDate:a?Dy(a):void 0})||o?.some(function(f){return an(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return an(e,f)})||c&&!c(Ut(e))||!1}function uu(e,n,t,r){var a=bt(e),o=cn(e),l=bt(n),c=cn(n),f=bt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function kA(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return Hl(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return an(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return an(c,e)})||!1}function du(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Hl(e,{minDate:r,maxDate:a})||o?.some(function(f){return Vu(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return Vu(e,f)})||c&&!c(Ut(e))||!1}function fu(e,n,t){if(!n||!t||!Mu(n)||!Mu(t))return!1;var r=bt(n),a=bt(t);return r<=e&&a>=e}function ku(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return Hl(f,{minDate:r?td(r):void 0,maxDate:a?jy(a):void 0})||o?.some(function(h){return va(f,h instanceof Date?h:h.date)})||l&&!l.some(function(h){return va(f,h)})||c&&!c(Ut(f))||!1}function pu(e,n,t,r){var a=bt(e),o=oo(e),l=bt(n),c=oo(n),f=bt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function Hl(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&di(e,a)<0||o&&di(e,o)>0)!==null&&t!==void 0?t:!1}function lv(e,n){return n.some(function(t){return Ga(t)===Ga(e)&&Xa(t)===Xa(e)&&Ds(t)===Ds(e)})}function cv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&lv(e,r)||a&&!lv(e,a)||o&&!o(e)||!1}function uv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Ut();a=mu(a,Ga(e)),a=gu(a,Xa(e)),a=vu(a,Ds(e));var o=Ut();o=mu(o,Ga(t)),o=gu(o,Xa(t)),o=vu(o,Ds(t));var l=Ut();l=mu(l,Ga(r)),l=gu(l,Xa(r)),l=vu(l,Ds(r));var c;try{c=!Dl(a,{start:o,end:l})}catch{c=!1}return c}function dv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=io(e,1);return r&&Iu(r,o)>0||a&&a.every(function(l){return Iu(l,o)>0})||!1}function fv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=ia(e,1);return r&&Iu(o,r)>0||a&&a.every(function(l){return Iu(o,l)>0})||!1}function bA(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=td(e),l=Wy(o);return r&&zu(r,l)>0||a&&a.every(function(c){return zu(c,l)>0})||!1}function _A(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=jy(e),l=Dp(o,1);return r&&zu(l,r)>0||a&&a.every(function(c){return zu(l,c)>0})||!1}function pv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=fi(e,1);return r&&Lu(r,o)>0||a&&a.every(function(l){return Lu(l,o)>0})||!1}function SA(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=ll(fi(e,o)),c=Ts(l,o).endPeriod,f=r&&bt(r);return f&&f>c||!1}function hv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Va(e,1);return r&&Lu(o,r)>0||a&&a.every(function(l){return Lu(o,l)>0})||!1}function EA(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=Va(e,o),c=Ts(l,o).startPeriod,f=r&&bt(r);return f&&f<c||!1}function iw(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)>=0});return Hg(r)}else return t?Hg(t):n}function lw(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)<=0});return Ug(r)}else return t?Ug(t):n}function xv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Ka(l)){var c=ir(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var h=Object.keys(l),p=(t=h[0])!==null&&t!==void 0?t:"",m=l[p];if(typeof p=="string"&&Array.isArray(m))for(var g=0,v=m.length;g<v;g++){var k=m[g];if(k){var c=ir(k,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(p)||(f.push(p),r.set(c,f))}}}}return r}function CA(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function TA(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Ka(a)){var l=ir(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&CA(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?Sa(Sa([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function NA(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,h=a[c];h&&(f=U4(f,Ga(h)),f=Mf(f,Xa(h)),f=Y4(f,Ds(h)));var p=Mf(e,(t+1)*r);Ps(f,n)&&xo(f,p)&&h!=null&&l.push(h)}return l}function mv(e){return e<10?"0".concat(e):"".concat(e)}function Ts(e,n){n===void 0&&(n=Ul);var t=Math.ceil(bt(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function DA(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function gv(e){var n=e.getSeconds(),t=e.getMilliseconds();return it(e.getTime()-n*1e3-t)}function FA(e,n){return gv(e).getTime()===gv(n).getTime()}function vv(e){if(!Ka(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function yv(e,n){if(!Ka(e)||!Ka(n))throw new Error("Invalid date received");var t=vv(e),r=vv(n);return xo(t,r)}function cw(e){return e.key===Qe.Space}var jA=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=Te.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),h=f?c:new Date;if(a?.includes(":")){var p=a.split(":"),m=p[0],g=p[1];h.setHours(Number(m)),h.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,h)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?C.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):Te.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var h;(h=r.inputRef.current)===null||h===void 0||h.focus()},required:!0,value:a,onChange:function(h){r.onTimeChange(h.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return Te.createElement("div",{className:"react-datepicker__input-time-container"},Te.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),Te.createElement("div",{className:"react-datepicker-time__input-container"},Te.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(C.Component),AA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=C.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Qe.Space&&(r.preventDefault(),r.key=Qe.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return Ot(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Hp(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Ot(t.props.day,Fs(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&Ot(r,Fs(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=ir(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=ir(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:cl(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,h=a.selectsDisabledDaysInRange,p=a.startDate,m=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!h&&t.isDisabled()?!1:l&&m&&(xo(g,m)||ro(g,m))?cl(o,g,m):c&&p&&!m&&(Ps(g,p)||ro(g,p))||f&&p&&!m&&(Ps(g,p)||ro(g,p))?cl(o,p,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?Ot(o,f):Ot(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,h=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?Ot(o,h):Ot(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Ot(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Ot(l,a)},t.isWeekend=function(){var r=U3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===cn(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(cn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Ut())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Wr("react-datepicker__day",a,"react-datepicker__day--"+hA(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,h=t.isDisabled()||t.isExcluded()?f:l;return"".concat(h," ").concat(ir(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=ir(a,"MM.dd.yyyy"),h=[];return l.has(f)&&h.push.apply(h,l.get(f).holidayNames),t.isExcluded()&&h.push(c?.filter(function(p){return p instanceof Date?Ot(p,a):Ot(p?.date,a)}).map(function(p){if(!(p instanceof Date))return p?.message})),h.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&Ot(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Qg(t.props.day),t.props.day):Qg(t.props.day)},t.render=function(){return Te.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&Te.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(C.Component),PA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=C.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Qe.Space&&(r.preventDefault(),r.key=Qe.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Ot(t.props.date,t.props.selected)&&Ot(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Ot(t.props.date,t.props.selected)&&Ot(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&Ot(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&Ot(this.props.date,this.props.selected)};return Te.createElement("div",{ref:this.weekNumberEl,className:Wr(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(C.Component),OA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,h=new Date(r),p=0;p<7;p++){var m=new Date(r);m.setDate(m.getDate()+p);var g=!t.isDisabled(m);if(g){h=m;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(h,a,o),t.props.showWeekPicker&&t.handleDayClick(h,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):pA(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=oa(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=oa(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(Te.createElement(PA,Rt({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=oa(r,c);return Te.createElement(AA,Rt({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Fs(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Ot(t.startOfWeek(),t.props.selected)&&Ot(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Ot(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return Te.createElement("div",{className:Wr(t)},this.renderDays())},n})(C.Component),nl,RA=6,ii={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},pf=(nl={},nl[ii.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},nl[ii.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},nl[ii.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},nl),hu=1;function wv(e,n){return e?ii.FOUR_COLUMNS:n?ii.TWO_COLUMNS:ii.THREE_COLUMNS}var MA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=Sa([],Array(12),!0).map(function(){return C.createRef()}),t.QUARTER_REFS=Sa([],Array(4),!0).map(function(){return C.createRef()}),t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return Hp(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Bn(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Vu(Jo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Bn(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Vu(Jo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?uu(g,m,r,l):f&&p||h&&p&&!m?uu(p,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,h=Bn(l,r),p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?an(h,p):an(h,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,h=o.selectsRange,p=Bn(l,r),m=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||h?an(p,m):an(p,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?pu(g,m,r,l):f&&p||h&&p&&!m?pu(p,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=oa(r,6);return an(r,a)||an(o,a)},t.isCurrentMonth=function(r,a){return bt(r)===bt(Ut())&&a===cn(Ut())},t.isCurrentQuarter=function(r,a){return bt(r)===bt(Ut())&&a===oo(Ut())},t.isSelectedMonth=function(r,a,o){return cn(o)===a&&bt(r)===bt(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return oo(r)===a&&bt(r)===bt(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Fs(Qa(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(k){return t.props.showWeekPicker?Fs(k,t.props.locale,t.props.calendarStartDay):t.props.preSelection},h=function(k){return t.props.showWeekPicker?Fs(k,t.props.locale,t.props.calendarStartDay):t.props.selected},p=t.props.selected?h(t.props.selected):void 0,m=t.props.preSelection?f(t.props.preSelection):void 0;r.push(Te.createElement(OA,Rt({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:cn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:p,preSelection:m,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=Ru(c,1);var g=a&&o>=RA,v=!a&&!t.isWeekInMonth(c);if(g||v)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Qa(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Qa(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,h=c.preSelection,p=c.setPreSelection,m=c.minDate,g=c.maxDate,v=c.showFourColumnMonthYearPicker,k=c.showTwoColumnMonthYearPicker;if(h){var w=wv(v,k),b=t.getVerticalOffset(w),E=(l=pf[w])===null||l===void 0?void 0:l.grid,N=function(D,H,L){var ae,Q,Y=H,ue=L;switch(D){case Qe.ArrowRight:Y=ia(H,hu),ue=L===11?0:L+hu;break;case Qe.ArrowLeft:Y=io(H,hu),ue=L===0?11:L-hu;break;case Qe.ArrowUp:Y=io(H,b),ue=!((ae=E?.[0])===null||ae===void 0)&&ae.includes(L)?L+12-b:L-b;break;case Qe.ArrowDown:Y=ia(H,b),ue=!((Q=E?.[E.length-1])===null||Q===void 0)&&Q.includes(L)?L-12+b:L+b;break}return{newCalculatedDate:Y,newCalculatedMonth:ue}},S=function(D,H,L){for(var ae=40,Q=D,Y=!1,ue=0,le=N(Q,H,L),oe=le.newCalculatedDate,pe=le.newCalculatedMonth;!Y;){if(ue>=ae){oe=H,pe=L;break}if(m&&oe<m){Q=Qe.ArrowRight;var G=N(Q,oe,pe);oe=G.newCalculatedDate,pe=G.newCalculatedMonth}if(g&&oe>g){Q=Qe.ArrowLeft;var G=N(Q,oe,pe);oe=G.newCalculatedDate,pe=G.newCalculatedMonth}if(kA(oe,t.props)){var G=N(Q,oe,pe);oe=G.newCalculatedDate,pe=G.newCalculatedMonth}else Y=!0;ue++}return{newCalculatedDate:oe,newCalculatedMonth:pe}};if(a===Qe.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),p?.(f));return}var z=S(a,h,o),te=z.newCalculatedDate,V=z.newCalculatedMonth;switch(a){case Qe.ArrowRight:case Qe.ArrowLeft:case Qe.ArrowUp:case Qe.ArrowDown:t.handleMonthNavigation(V,te);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=pf[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==Qe.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Jo(t.props.day,a);du(o,t.props)||t.handleDayClick(sv(o),r)},t.onQuarterMouseEnter=function(r){var a=Jo(t.props.day,r);du(a,t.props)||t.handleDayMouseEnter(sv(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case Qe.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case Qe.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Dp(t.props.preSelection,1));break;case Qe.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,Wy(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=Bn(l,r);return{isDisabled:(a=(c||f||h||p)&&ow(m,t.props))!==null&&a!==void 0?a:!1,labelDate:m}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,h=a.monthClassName,p=h?h(Bn(o,r)):void 0,m=t.getSelection();return Wr("react-datepicker__month-text","react-datepicker__month-".concat(r),p,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":m?t.isSelectMonthInList(o,r,m):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=cn(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=oo(t.props.preSelection),o=du(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,h=a.day,p=a.locale,m=Bn(h,r),g=t.isDisabled(m)||t.isExcluded(m)?f:l;return"".concat(g," ").concat(ir(m,"MMMM yyyy",p))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,h=a.minDate,p=a.maxDate,m=a.excludeDates,g=a.includeDates,v=a.filterDate,k=a.preSelection,w=a.disabledKeyboardNavigation,b=(h||p||m||g||v)&&du(Jo(o,r),t.props);return Wr("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":b,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!w&&k&&t.isSelectedQuarter(o,r,k)&&!b,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?pu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,h=sw(r,c),p=Up(r,c);return l?l(r,h,p,f):o?p:h},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=wA(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,h=(r=pf[wv(l,o)])===null||r===void 0?void 0:r.grid;return h?.map(function(p,m){return Te.createElement("div",{className:"react-datepicker__month-wrapper",key:m},p.map(function(g,v){return Te.createElement("div",{ref:t.MONTH_REFS[g],key:v,onClick:function(k){t.onMonthClick(k,g)},onKeyDown:function(k){cw(k)&&(k.preventDefault(),k.key=Qe.Enter),t.onMonthKeyDown(k,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return Te.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return Te.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(h){t.onQuarterClick(h,c)},onKeyDown:function(h){t.onQuarterKeyDown(h,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,h=r.showWeekPicker;return Wr("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":h})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return Te.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(ir(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(C.Component),IA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return Te.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?Te.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return Te.createElement(sd,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(C.Component),zA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return Te.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return Te.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},Te.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return Te.createElement(IA,Rt({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return sw(o,t.props.locale)}:function(o){return Up(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return Te.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(C.Component);function LA(e,n){for(var t=[],r=Qa(e),a=Qa(n);!Ps(r,a);)t.push(Ut(r)),r=ia(r,1);return t}var BA=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=Lf(a),l=va(r.props.date,a)&&an(r.props.date,a);return Te.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?Te.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",ir(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:LA(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Wr({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return Te.createElement(sd,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(C.Component),WA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Qa(t.props.minDate),a=Qa(t.props.maxDate),o=[];!Ps(r,a);){var l=Lf(r);o.push(Te.createElement("option",{key:l,value:l},ir(r,t.props.dateFormat,t.props.locale))),r=ia(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Te.createElement("select",{value:Lf(Qa(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=ir(t.props.date,t.props.dateFormat,t.props.locale);return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},Te.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return Te.createElement(BA,Rt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Ut(r);va(t.props.date,a)&&an(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Te.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(C.Component),UA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&FA(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(Ga(r)*3600+Xa(r)*60+Ds(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===Qe.Space&&(r.preventDefault(),r.key=Qe.Enter),(r.key===Qe.ArrowUp||r.key===Qe.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===Qe.ArrowDown||r.key===Qe.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===Qe.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Ut(),f=wu(c),h=t.props.injectTimes&&t.props.injectTimes.sort(function(b,E){return b.getTime()-E.getTime()}),p=60*DA(c),m=p/l,g=0;g<m;g++){var v=Mf(f,g*l);if(a.push(v),h){var k=NA(f,v,g,l,h);a=a.concat(k)}}var w=a.reduce(function(b,E){return E.getTime()<=c.getTime()?E:b},a[0]);return a.map(function(b){return Te.createElement("li",{key:b.valueOf(),onClick:t.handleClick.bind(t,b),className:t.liClasses(b),ref:function(E){b===w&&(t.centerLi=E)},onKeyDown:function(E){t.handleOnKeyDown(E,b)},tabIndex:b===w?0:-1,role:"option","aria-selected":t.isSelectedTime(b)?"true":void 0,"aria-disabled":t.isDisabledTime(b)?"true":void 0},ir(b,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?Te.createElement(Te.Fragment,null):Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},Te.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return Te.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),Te.createElement("div",{className:"react-datepicker__time"},Te.createElement("div",{className:"react-datepicker__time-box"},Te.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(C.Component),kv=3,HA=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=Sa([],Array(r.props.yearItemNumber),!0).map(function(){return C.createRef()}),r.isDisabled=function(a){return Wn(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return Hp(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,h,p=r.props,m=p.date,g=p.yearItemNumber;if(!(m===void 0||g===void 0)){var v=Ts(m,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-v<0?r.updateFocusOnPaginate(g-(v-a)):a-v>=g?r.updateFocusOnPaginate(Math.abs(g-(a-v))):(h=(f=r.YEAR_REFS[a-v])===null||f===void 0?void 0:f.current)===null||h===void 0||h.focus())}},r.isSameDay=function(a,o){return Ot(a,o)},r.isCurrentYear=function(a){return a===bt(Ut())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&va(ga(Ut(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&va(ga(Ut(),a),r.props.endDate)},r.isInRange=function(a){return fu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,h=o.startDate,p=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&p?fu(a,r.selectingDate(),p):c&&h||f&&h&&!p?fu(a,h,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,h=ga(Ut(),a);return f?va(h,(o=r.selectingDate())!==null&&o!==void 0?o:null):va(h,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,h=l.selectsRange,p=ga(Ut(),a);return f||h?va(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):va(p,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,h=o.includeDates,p=o.filterDate,m=ll(ga(r.props.date,a)),g=(l||c||f||h||p)&&ku(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Ot(m,ll(r.props.selected))&&Ot(m,ll(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(h){return a===bt(h)}):!c||a===bt(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ll(ga(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,h=r.props,p=h.date,m=h.yearItemNumber,g=h.handleOnKeyDown;if(f!==Qe.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case Qe.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case Qe.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Va(r.props.preSelection,1));break;case Qe.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,fi(r.props.preSelection,1));break;case Qe.ArrowUp:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var v=Ts(p,m).startPeriod,k=kv,w=o-k;if(w<v){var b=m%k;o>=v&&o<v+b?k=b:k+=b,w=o-k}r.handleYearNavigation(w,fi(r.props.preSelection,k));break}case Qe.ArrowDown:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var E=Ts(p,m).endPeriod,k=kv,w=o+k;if(w>E){var b=m%k;o<=E&&o>E-b?k=b:k+=b,w=o+k}r.handleYearNavigation(w,Va(r.props.preSelection,k));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=o.filterDate,g=o.yearClassName;return Wr("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(ga(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||h||p||m)&&ku(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=bt(r.props.preSelection),l=ku(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var h=Ts(o,l),p=h.startPeriod,m=h.endPeriod,g=function(w){r.push(Te.createElement("div",{ref:v.YEAR_REFS[w-p],onClick:function(b){t.onYearClick(b,w)},onKeyDown:function(b){cw(b)&&(b.preventDefault(),b.key=Qe.Enter),t.onYearKeyDown(b,w)},tabIndex:Number(v.getYearTabIndex(w)),className:v.getYearClassNames(w),onMouseEnter:v.props.usePointerEvent?void 0:function(b){return c(b,w)},onPointerEnter:v.props.usePointerEvent?function(b){return c(b,w)}:void 0,onMouseLeave:v.props.usePointerEvent?void 0:function(b){return f(b,w)},onPointerLeave:v.props.usePointerEvent?function(b){return f(b,w)}:void 0,key:w,"aria-current":v.isCurrentYear(w)?"date":void 0},v.getYearContent(w)))},v=this,k=p;k<=m;k++)g(k);return Te.createElement("div",{className:"react-datepicker__year"},Te.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(C.Component);function $A(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=bt(t)<=l),r&&c&&(c=bt(r)>=l),c&&a.push(l)}return a}var YA=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(m){return Te.createElement("div",{className:c===m?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:m,onClick:r.onChange.bind(r,m),"aria-selected":c===m?"true":void 0},c===m?Te.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",m)}),h=r.props.minDate?bt(r.props.minDate):null,p=r.props.maxDate?bt(r.props.maxDate):null;return(!p||!r.state.yearsList.find(function(m){return m===p}))&&f.unshift(Te.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!h||!r.state.yearsList.find(function(m){return m===h}))&&f.push(Te.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(h){return h+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:$A(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=C.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Wr({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return Te.createElement(sd,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(C.Component),VA=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?bt(t.props.minDate):1900,a=t.props.maxDate?bt(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(Te.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Te.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},Te.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return Te.createElement(YA,Rt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Te.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(C.Component),KA=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],GA=function(e){var n=(e.className||"").split(/\s+/);return KA.some(function(t){return n.indexOf(t)>=0})},XA=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;GA(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=iw(r.props),h=lw(r.props),p=Ut(),m=c||l||o;return m||(f&&xo(p,f)?f:h&&Ps(p,h)?h:p)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:ia(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:io(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:ga(Ut(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!Wn(a,r.props))return a;for(var o=Qa(a),l=mA(a),c=K4(l,o),f=null,h=0;h<=c;h++){var p=oa(o,h);if(!Wn(p,r.props)){f=p;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:ga(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Bn(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:ga(Bn(l,cn(a)),bt(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Fs(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(Te.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=oa(o,c),h=r.formatWeekday(f,r.props.locale),p=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return Te.createElement("div",{key:c,"aria-label":ir(f,"EEEE",r.props.locale),className:Wr("react-datepicker__day-name",p)},h)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?gA(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?yA(a,o):vA(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:fi(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,p=io(r.state.date,h),m;switch(!0){case r.props.showMonthYearPicker:m=pv(r.state.date,r.props);break;case r.props.showYearPicker:m=SA(r.state.date,r.props);break;case r.props.showQuarterYearPicker:m=bA(r.state.date,r.props);break;default:m=dv(p,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&m||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],v=["react-datepicker__navigation","react-datepicker__navigation--previous"],k=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(k=r.decreaseYear),m&&r.props.showDisabledMonthNavigation&&(v.push("react-datepicker__navigation--previous--disabled"),k=void 0);var w=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,b=r.props,E=b.previousMonthButtonLabel,N=E===void 0?n.defaultProps.previousMonthButtonLabel:E,S=b.previousYearButtonLabel,z=S===void 0?n.defaultProps.previousYearButtonLabel:S,te=r.props,V=te.previousMonthAriaLabel,D=V===void 0?typeof N=="string"?N:"Previous Month":V,H=te.previousYearAriaLabel,L=H===void 0?typeof z=="string"?z:"Previous Year":H;return Te.createElement("button",{type:"button",className:v.join(" "),onClick:k,onKeyDown:r.props.handleOnKeyDown,"aria-label":w?L:D},Te.createElement("span",{className:g.join(" ")},w?z:N))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Va(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=hv(r.state.date,r.props);break;case r.props.showYearPicker:o=EA(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=_A(r.state.date,r.props);break;default:o=fv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,m=p.nextMonthButtonLabel,g=m===void 0?n.defaultProps.nextMonthButtonLabel:m,v=p.nextYearButtonLabel,k=v===void 0?n.defaultProps.nextYearButtonLabel:v,w=r.props,b=w.nextMonthAriaLabel,E=b===void 0?typeof g=="string"?g:"Next Month":b,N=w.nextYearAriaLabel,S=N===void 0?typeof k=="string"?k:"Next Year":N;return Te.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":h?S:E},Te.createElement("span",{className:c.join(" ")},h?k:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),Te.createElement("h2",{className:o.join(" ")},ir(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return Te.createElement(VA,Rt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:bt(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return Te.createElement(zA,Rt({},n.defaultProps,r.props,{month:cn(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return Te.createElement(WA,Rt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(ov(),a),r.props.setPreSelection&&r.props.setPreSelection(ov())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return Te.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return Te.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),Te.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),Te.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var h=dv(r.state.date,r.props),p=fv(r.state.date,r.props),m=pv(r.state.date,r.props),g=hv(r.state.date,r.props),v=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,Rt(Rt({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:p,prevYearButtonDisabled:m,nextYearButtonDisabled:g})),v&&Te.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,h=f===void 0?n.defaultProps.yearItemNumber:f,p=Ts(o,h),m=p.startPeriod,g=p.endPeriod;return Te.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(m," - ").concat(g):bt(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Va(r.state.date,f):io(r.state.date,f),p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,m=0;m<c;++m){var g=m-p+f,v=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Va(h,g):ia(h,g),k="month-".concat(m),w=m<c-1,b=m>0;l.push(Te.createElement("div",{key:k,ref:function(E){r.monthContainer=E??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:v,i:m}),Te.createElement(MA,Rt({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:v,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:m,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:w,monthShowsDuplicateDaysStart:b}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return Te.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),Te.createElement(HA,Rt({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return Te.createElement(UA,Rt({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&od(a)&&!!r.props.selected,l=o?"".concat(mv(a.getHours()),":").concat(mv(a.getMinutes())):"";if(r.props.showTimeInput)return Te.createElement(jA,Rt({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=Ts(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=bt(r.state.date):f="".concat(Up(cn(r.state.date),r.props.locale)," ").concat(bt(r.state.date)),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return Te.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=C.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:Ul}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!Ot(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!an(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!Ot(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||cA;return Te.createElement(sd,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},Te.createElement("div",{style:{display:"contents"},ref:this.containerRef},Te.createElement(t,{className:Wr("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(C.Component),QA=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return Te.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(Te.isValidElement(n)){var l=n;return Te.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return Te.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},Te.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},uw=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return _j.createPortal(this.props.children,this.el)},n})(C.Component),qA="[tabindex], a, button, input, select, textarea",ZA=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},dw=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(qA),1,-1).filter(ZA)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=C.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?Te.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},Te.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,Te.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(C.Component);function JA(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=C.useRef(null),l=lA(Rt({open:!a,whileElementsMounted:ew,placement:t.popperPlacement,middleware:Sa([Xj({padding:15}),Gj(10),Qj({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=Rt(Rt({},t),{hidePopper:a,popperProps:Rt(Rt({},l),{arrowRef:o})});return Te.createElement(e,Rt({},c))};return n}var eP=(function(e){Ir(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,h=t.enableTabLoop,p=t.popperOnKeyDown,m=t.portalId,g=t.portalHost,v=t.popperProps,k=t.showArrow,w=void 0;if(!l){var b=Wr("react-datepicker-popper",r);w=Te.createElement(dw,{enableTabLoop:h},Te.createElement("div",{ref:v.refs.setFloating,style:v.floatingStyles,className:b,"data-placement":v.placement,onKeyDown:p},c,k&&Te.createElement(tA,{ref:v.arrowRef,context:v.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(w=C.createElement(this.props.popperContainer,{},w)),m&&!l&&(w=Te.createElement(uw,{portalId:m,portalHost:g},w));var E=Wr("react-datepicker-wrapper",a);return Te.createElement(Te.Fragment,null,Te.createElement("div",{ref:v.refs.setReference,className:E},f),w)},n})(C.Component),tP=JA(eP),bv="react-datepicker-ignore-onclickoutside";function rP(e,n){return e&&n?cn(e)!==cn(n)||bt(e)!==bt(n):e!==n}var hf="Date input not valid.",$n=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Ut()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return od(c)?Sa(Sa([],o,!0),[Rt(Rt({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=iw(r.props),c=lw(r.props),f=l&&xo(o,wu(l))?l:c&&Ps(o,iv(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:xv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(Rt(Rt({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(Rt(Rt({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:xf},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Ka(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var m=h[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,h),!m||typeof m.isDefaultPrevented!="function"||m.isDefaultPrevented()))){r.setState({inputValue:m?.target instanceof HTMLInputElement?m.target.value:null,lastPreSelectChange:nP});var g=r.props,v=g.selectsRange,k=g.startDate,w=g.endDate,b=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,E=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,N=m?.target instanceof HTMLInputElement?m.target.value:"";if(v){var S=N.split("-",2).map(function(Q){return Q.trim()}),z=S[0],te=S[1],V=df(z??"",b,r.props.locale,E),D=df(te??"",b,r.props.locale,E),H=k?.getTime()!==V?.getTime(),L=w?.getTime()!==D?.getTime();if(!H&&!L||V&&Wn(V,r.props)||D&&Wn(D,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[V,D],m)}else{var ae=df(N,b,r.props.locale,E,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(ae||!N)&&r.setSelected(ae,m,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,h=c.endDate;f&&!h&&(r.props.swapRange||!yv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,h,p=a;if(r.props.showYearPicker){if(p!==null&&ku(bt(p),r.props))return}else if(r.props.showMonthYearPicker){if(p!==null&&ow(p,r.props))return}else if(p!==null&&Wn(p,r.props))return;var m=r.props,g=m.onChange,v=m.selectsRange,k=m.startDate,w=m.endDate,b=m.selectsMultiple,E=m.selectedDates,N=m.minTime,S=m.swapRange;if(!ro(r.props.selected,p)||r.props.allowSameDay||v||b)if(p!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(p=ff(p,{hour:Ga(r.props.selected),minute:Xa(r.props.selected),second:Ds(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&N&&(p=ff(p,{hour:N.getHours(),minute:N.getMinutes(),second:N.getSeconds()})),r.props.inline||r.setState({preSelection:p}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),v){var z=!k&&!w,te=k&&!w,V=k&&w;z?g?.([p,null],o):te&&(p===null?g?.([null,null],o):yv(p,k)?g?.(S?[p,k]:[p,null],o):g?.([k,p],o)),V&&g?.([p,null],o)}else if(b){if(p!==null)if(!E?.length)g?.([p],o);else{var D=E.some(function(L){return Ot(L,p)});if(D){var H=E.filter(function(L){return!Ot(L,p)});g?.(H,o)}else g?.(Sa(Sa([],E,!0),[p],!1),o)}}else g?.(p,o);l||((h=(f=r.props).onSelect)===null||h===void 0||h.call(f,p,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Ka(r.props.minDate),l=Ka(r.props.maxDate),c=!0;if(a){var f=wu(a);if(o&&l)c=cl(a,r.props.minDate,r.props.maxDate);else if(o){var h=wu(r.props.minDate);c=Ps(a,h)||ro(f,h)}else if(l){var p=iv(r.props.maxDate);c=xo(a,p)||ro(f,p)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:ff(c,{hour:Ga(a),minute:Xa(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,h,p;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var m=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(m===Qe.ArrowDown||m===Qe.ArrowUp||m===Qe.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(m===Qe.ArrowDown||m===Qe.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',v=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);v instanceof HTMLElement&&v.focus({preventScroll:!0});return}var k=Ut(r.state.preSelection);m===Qe.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===xf?(r.handleSelect(k,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(k)):r.setOpen(!1)):m===Qe.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):m===Qe.Tab&&r.setOpen(!1),r.inputOk()||(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hf})}},r.onPortalKeyDown=function(a){var o=a.key;o===Qe.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,h,p,m=r.props,g=m.minDate,v=m.maxDate,k=m.disabledKeyboardNavigation,w=m.showWeekPicker,b=m.shouldCloseOnSelect,E=m.locale,N=m.calendarStartDay,S=m.adjustDateOnChange,z=m.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!k){var te=a.key,V=a.shiftKey,D=Ut(r.state.preSelection),H=function(oe,pe){var G=pe;switch(oe){case Qe.ArrowRight:G=w?Ru(pe,1):oa(pe,1);break;case Qe.ArrowLeft:G=w?qg(pe):KF(pe);break;case Qe.ArrowUp:G=qg(pe);break;case Qe.ArrowDown:G=Ru(pe,1);break;case Qe.PageUp:G=V?fi(pe,1):io(pe,1);break;case Qe.PageDown:G=V?Va(pe,1):ia(pe,1);break;case Qe.Home:G=Fs(pe,E,N);break;case Qe.End:G=xA(pe);break}return G},L=function(oe,pe){for(var G=40,ie=oe,B=!1,de=0,I=H(oe,pe);!B;){if(de>=G){I=pe;break}g&&I<g&&(ie=Qe.ArrowRight,I=Wn(g,r.props)?H(ie,I):g),v&&I>v&&(ie=Qe.ArrowLeft,I=Wn(v,r.props)?H(ie,I):v),Wn(I,r.props)?((ie===Qe.PageUp||ie===Qe.Home)&&(ie=Qe.ArrowRight),(ie===Qe.PageDown||ie===Qe.End)&&(ie=Qe.ArrowLeft),I=H(ie,I)):B=!0,de++}return I};if(te===Qe.Enter){a.preventDefault(),r.handleSelect(D,a),!b&&r.setPreSelection(D);return}else if(te===Qe.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:hf});return}var ae=null;switch(te){case Qe.ArrowLeft:case Qe.ArrowRight:case Qe.ArrowUp:case Qe.ArrowDown:case Qe.PageUp:case Qe.PageDown:case Qe.Home:case Qe.End:ae=L(te,D);break}if(!ae){(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hf});return}if(a.preventDefault(),r.setState({lastPreSelectChange:xf}),S&&r.setSelected(ae),r.setPreSelection(ae),z){var Q=cn(D),Y=cn(ae),ue=bt(D),le=bt(ae);Q!==Y||ue!==le?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===Qe.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:Te.createElement(XA,Rt({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:TA(r.modifyHolidays()),outsideClickIgnoreClass:bv,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,h=f?"PPPPp":"PPPP",p;return r.props.selectsRange?p="Selected start date: ".concat(Ln(r.props.startDate,{dateFormat:h,locale:c}),". ").concat(r.props.endDate?"End date: "+Ln(r.props.endDate,{dateFormat:h,locale:c}):""):r.props.showTimeSelectOnly?p="Selected time: ".concat(Ln(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?p="Selected year: ".concat(Ln(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?p="Selected month: ".concat(Ln(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?p="Selected quarter: ".concat(Ln(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):p="Selected date: ".concat(Ln(r.props.selected,{dateFormat:h,locale:c})),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},p)},r.renderDateInput=function(){var a,o,l,c=Wr(r.props.className,(a={},a[bv]=r.state.open,a)),f=r.props.customInput||Te.createElement("input",{type:"text"}),h=r.props.customInputRef||"ref",p=r.props,m=p.dateFormat,g=m===void 0?n.defaultProps.dateFormat:m,v=p.locale,k=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?dA(r.props.startDate,r.props.endDate,{dateFormat:g,locale:v}):r.props.selectsMultiple?fA((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:v}):Ln(r.props.selected,{dateFormat:g,locale:v});return C.cloneElement(f,(o={},o[h]=function(w){r.input=w},o.value=k,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Wr(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,h=a.endDate,p=a.clearButtonTitle,m=a.clearButtonClassName,g=m===void 0?"":m,v=a.ariaLabelClose,k=v===void 0?"Close":v,w=a.selectedDates;return o&&(c!=null||f!=null||h!=null||w?.length)?Te.createElement("button",{type:"button",className:Wr("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":k,onClick:r.onClearClick,title:p,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:Ul,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&rP(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:xv(this.props.highlightDates)}),!r.focused&&!ro(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),Te.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&Te.createElement(QA,Rt({icon:a,className:Wr(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?Te.createElement(dw,{enableTabLoop:this.props.enableTabLoop},Te.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=Te.createElement(uw,Rt({portalId:this.props.portalId},this.props),r)),Te.createElement("div",null,this.renderInputContainer(),r)}return Te.createElement(tP,Rt({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(C.Component),nP="input",xf="navigate";const aP={lessThanXSeconds:{one:{regular:"mniej ni sekunda",past:"mniej ni sekund",future:"mniej ni sekund"},twoFour:"mniej ni {{count}} sekundy",other:"mniej ni {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekund",future:"sekund"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"p minuty",twoFour:"p minuty",other:"p minuty"},lessThanXMinutes:{one:{regular:"mniej ni minuta",past:"mniej ni minut",future:"mniej ni minut"},twoFour:"mniej ni {{count}} minuty",other:"mniej ni {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minut",future:"minut"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"okoo godziny",past:"okoo godziny",future:"okoo godzin"},twoFour:"okoo {{count}} godziny",other:"okoo {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzin",future:"godzin"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzie",past:"dzie",future:"1 dzie"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"okoo tygodnia",twoFour:"okoo {{count}} tygodni",other:"okoo {{count}} tygodni"},xWeeks:{one:"tydzie",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"okoo miesic",twoFour:"okoo {{count}} miesice",other:"okoo {{count}} miesicy"},xMonths:{one:"miesic",twoFour:"{{count}} miesice",other:"{{count}} miesicy"},aboutXYears:{one:"okoo rok",twoFour:"okoo {{count}} lata",other:"okoo {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function sP(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function mf(e,n,t){const r=sP(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const oP=(e,n,t)=>{const r=aP[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+mf(r,n,"future"):mf(r,n,"past")+" temu":mf(r,n,"regular")},iP={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},lP={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},cP={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},uP={date:si({formats:iP,defaultWidth:"full"}),time:si({formats:lP,defaultWidth:"full"}),dateTime:si({formats:cP,defaultWidth:"full"})},dP={masculine:"ostatni",feminine:"ostatnia"},fP={masculine:"ten",feminine:"ta"},pP={masculine:"nastpny",feminine:"nastpna"},hP={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function _v(e,n,t,r){let a;if(HF(n,t,r))a=fP;else if(e==="lastWeek")a=dP;else if(e==="nextWeek")a=pP;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=hP[o];return`'${a[l]}' eeee 'o' p`}const xP={lastWeek:_v,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:_v,other:"P"},mP=(e,n,t,r)=>{const a=xP[e];return typeof a=="function"?a(e,n,t,r):a},gP={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed nasz er","naszej ery"]},vP={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwarta","II kwarta","III kwarta","IV kwarta"]},yP={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"]},wP={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrzenia","padziernika","listopada","grudnia"]},kP={narrow:["N","P","W","","C","P","S"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},bP={narrow:["n","p","w","","c","p","s"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},_P={narrow:{am:"a",pm:"p",midnight:"pn.",noon:"po",morning:"rano",afternoon:"popo.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"}},SP={narrow:{am:"a",pm:"p",midnight:"o pn.",noon:"w po.",morning:"rano",afternoon:"po po.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"}},EP=(e,n)=>String(e),CP={ordinalNumber:EP,era:ya({values:gP,defaultWidth:"wide"}),quarter:ya({values:vP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ya({values:yP,defaultWidth:"wide",formattingValues:wP,defaultFormattingWidth:"wide"}),day:ya({values:kP,defaultWidth:"wide",formattingValues:bP,defaultFormattingWidth:"wide"}),dayPeriod:ya({values:_P,defaultWidth:"wide",formattingValues:SP,defaultFormattingWidth:"wide"})},TP=/^(\d+)?/i,NP=/\d+/i,DP={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(|a)\s*er(|a)|naszej\s*ery)/i},FP={any:[/^p/i,/^n/i]},jP={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(|l)/i},AP={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},PP={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(|z)|lis|gru)/i,wide:/^(stycznia|stycze(|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(|n)|wrze(|s)nia|wrzesie(|n)|pa(|z)dziernika|pa(|z)dziernik|listopada|listopad|grudnia|grudzie(|n))/i},OP={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},RP={narrow:/^[npwcs]/i,short:/^(nie|pon|wto|(|s)ro|czw|pi(|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(|l)ek|wtorek|(|s)roda|czwartek|pi(|a)tek|sobota)/i},MP={narrow:[/^n/i,/^p/i,/^w/i,/^/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pi/i,/^so/i]},IP={narrow:/^(^a$|^p$|p(|l)n\.?|o\s*p(|l)n\.?|po(|l)\.?|w\s*po(|l)\.?|po\s*po(|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|p(|l)noc|o\s*p(|l)nocy|po(|l)udnie|w\s*po(|l)udnie|popo(|l)udnie|po\s*po(|l)udniu|rano|wieczr|wieczorem|noc|w\s*nocy)/i},zP={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i}},LP={ordinalNumber:Ay({matchPattern:TP,parsePattern:NP,valueCallback:e=>parseInt(e,10)}),era:wa({matchPatterns:DP,defaultMatchWidth:"wide",parsePatterns:FP,defaultParseWidth:"any"}),quarter:wa({matchPatterns:jP,defaultMatchWidth:"wide",parsePatterns:AP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:wa({matchPatterns:PP,defaultMatchWidth:"wide",parsePatterns:OP,defaultParseWidth:"any"}),day:wa({matchPatterns:RP,defaultMatchWidth:"wide",parsePatterns:MP,defaultParseWidth:"any"}),dayPeriod:wa({matchPatterns:IP,defaultMatchWidth:"any",parsePatterns:zP,defaultParseWidth:"any"})},Is={code:"pl",formatDistance:oP,formatLong:uP,formatRelative:mP,localize:CP,match:LP,options:{weekStartsOn:1,firstWeekContainsDate:4}};Ms("pl",Is);const gf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],BP=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],WP=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=C.useState(null),[o,l]=C.useState(""),[c,f]=C.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[h,p]=C.useState(""),[m,g]=C.useState(null),[v,k]=C.useState(null),w=C.useRef(null),b=C.useRef(null),[E,N]=C.useState(null),[S,z]=C.useState(null),[te,V]=C.useState("0,00"),[D,H]=C.useState("0,00"),[L,ae]=C.useState("0,00"),Q=()=>{const O=c.reduce((J,Z)=>{const U=parseFloat(Z.ilosc.toString().replace(",","."))||0;return J+U},0),R=parseFloat(h.replace(",","."))||0;return O>0?(R/O).toFixed(2):"0,00"},Y=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},ue=O=>{if(c.length>1){const R=[...c];R.splice(O,1),f(R)}},le=O=>{const R=[...c];R[O].showDataWaznosci=!R[O].showDataWaznosci,f(R)},oe=O=>{const R=O.target.files?.[0];console.log(" Product file selected:",R),R&&R.type==="application/pdf"?(g(R),console.log(" Product invoice set:",R.name)):console.log(" Invalid product file type:",R?.type)},pe=O=>{const R=O.target.files?.[0];console.log(" Transport file selected:",R),R&&R.type==="application/pdf"?(k(R),console.log(" Transport invoice set:",R.name)):console.log(" Invalid transport file type:",R?.type)},G=()=>{w.current?.click()},ie=()=>{b.current?.click()},B=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",h),console.log("productRows:",c),!r||!c.some(ye=>ye.kod&&ye.nazwa&&ye.ilosc&&ye.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(ye=>ye.kod&&ye.nazwa&&ye.ilosc&&ye.cena));return}const O=parseFloat(te.replace(",","."))||1,R=c.reduce((ye,Me)=>ye+(parseFloat(Me.ilosc)||0),0),J=R>0?parseFloat(h.replace(",","."))/R*O:0,Z=c.filter(ye=>ye.kod&&ye.nazwa&&ye.ilosc&&ye.cena).map(ye=>({kod:ye.kod,nazwa:ye.nazwa,kod_kreskowy:ye.kod_kreskowy||"",ilosc:parseFloat(ye.ilosc)||0,cena:parseFloat(ye.cena.replace(",","."))||0,dataWaznosci:ye.dataWaznosci?ye.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:ye.typ||void 0,objetosc:ye.objetosc||void 0,deliveryCostPerUnitPln:J,podatekAkcyzowyPerLiter:parseFloat(D.replace(",","."))||0}));console.log("formattedProducts:",Z);const U=Z.reduce((ye,Me)=>ye+Me.ilosc*Me.cena,0),xe=parseFloat(h.replace(",","."))||0,M=parseFloat(L.replace(",","."))||0,ve=U*(1-M/100);console.log("totalValue:",U),console.log("rabat:",M+"%"),console.log("wartoscZRabatem:",ve),console.log("deliveryCost:",xe),console.log(" Files to submit:",{productInvoice:m,transportInvoice:v}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:ve,kosztDostawy:xe,aktualnyKurs:te,podatekAkcyzowy:D,rabat:L,products:Z,productInvoice:m||null,transportInvoice:v||null}),de()},de=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),p(""),l(""),V("0,00"),H("0,00"),ae("0,00"),g(null),k(null),n()},I=()=>c.reduce((O,R)=>{const J=parseFloat(R.ilosc)||0,Z=parseFloat(R.cena.replace(",","."))||0;return O+J*Z},0).toFixed(2),j=(O,R)=>{const J=[...c];J[O].typ=R,f(J),N(null)},re=O=>{N(E===O?null:O)},T=O=>{z(S===O?null:O)},F=(O,R)=>{const J=[...c];J[O].objetosc=R,f(J),z(null)};return C.useEffect(()=>{const O=J=>{const Z=J.target;if(!Z.closest(".react-datepicker")&&!Z.closest('button[title*="wanoci"]')){const U=[...c];let xe=!1;U.forEach(M=>{M.showDataWaznosci&&(M.showDataWaznosci=!1,xe=!0)}),xe&&f(U)}E!==null&&(Z.closest(".dropdown-container")||N(null)),S!==null&&(Z.closest(".dropdown-container")||z(null))},R=J=>{J.key==="Escape"&&(N(null),z(null))};return document.addEventListener("mousedown",O),document.addEventListener("keydown",R),()=>{document.removeEventListener("mousedown",O),document.removeEventListener("keydown",R)}},[E,S,c]),u.jsx(dr,{isOpen:e,onRequestClose:de,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),u.jsx("button",{onClick:de,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx($n,{selected:r,onChange:O=>a(O),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:h,onKeyPress:O=>{const R=String.fromCharCode(O.which);(!/[\d,]/.test(R)||R===","&&O.target.value.includes(",")||O.target.value===""&&R===",")&&O.preventDefault()},onChange:O=>{const R=O.target,J=R.selectionStart??0;let Z=R.value.replace(/[^\d,]/g,"");if(Z===""){p("");return}if(!Z.includes(","))Z=Z+",00";else{const[xe,M]=Z.split(",");M&&M.length>2&&(Z=`${xe},${M.slice(0,2)}`)}p(Z),requestAnimationFrame(()=>{const xe=Math.min(J,Z.length);R.setSelectionRange(xe,xe)})},className:"w-[70%] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:oe,className:"hidden",ref:w}),u.jsx("button",{type:"button",onClick:G,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),m&&u.jsx("a",{href:URL.createObjectURL(m),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:m.name,children:m.name})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:pe,className:"hidden",ref:b}),u.jsx("button",{type:"button",onClick:ie,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Zf,{className:"h-4 w-4 text-gray-500"})}),v&&u.jsx("a",{href:URL.createObjectURL(v),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:v.name,children:v.name})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:o,onChange:O=>l(O.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[Q().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:te,onChange:O=>V(O.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:D,onChange:O=>H(O.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:L,onChange:O=>ae(O.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((O,R)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:O.kod,onChange:J=>{const Z=[...c];Z[R].kod=J.target.value,f(Z)}}),R===c.length-1&&u.jsx("button",{onClick:Y,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(_a,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:O.nazwa,onChange:J=>{const Z=[...c];Z[R].nazwa=J.target.value,f(Z)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:O.kod_kreskowy,onChange:J=>{const Z=[...c];Z[R].kod_kreskowy=J.target.value,f(Z)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:O.ilosc,onChange:J=>{const Z=[...c],U=J.target.value;(U===""||/^\d*$/.test(U))&&(Z[R].ilosc=U,f(Z))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:O.cena,onKeyPress:J=>{const Z=String.fromCharCode(J.which);(!/[\d,]/.test(Z)||Z===","&&J.target.value.includes(",")||J.target.value===""&&Z===",")&&J.preventDefault()},onChange:J=>{const Z=J.target,U=Z.selectionStart??0;let xe=J.target.value.replace(/[^\d,]/g,"");if(xe===""){const ye=[...c];ye[R].cena="",f(ye);return}if(!xe.includes(","))xe=xe+",00";else{const[ye,Me]=xe.split(",");Me&&Me.length>2&&(xe=`${ye},${Me.slice(0,2)}`)}const ve=[...c];ve[R].cena=xe,f(ve),requestAnimationFrame(()=>{const ye=Math.min(U,xe.length);Z.setSelectionRange(ye,ye)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const J=parseFloat(O.ilosc)||0,Z=parseFloat(O.cena.replace(",","."))||0;return(J*Z).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>le(R),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${O.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:O.dataWaznosci?`Termin wanoci: ${O.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(qf,{size:16})}),u.jsx("button",{onClick:()=>ue(R),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(Ct,{size:16})})]}),O.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx($n,{selected:O.dataWaznosci,onChange:J=>{const Z=[...c];Z[R].dataWaznosci=J,Z[R].showDataWaznosci=!1,f(Z)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const J=[...c];J[R].showDataWaznosci=!1,f(J)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>re(R),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${O.typ&&gf.find(J=>J.value===O.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:O.typ&&gf.find(J=>J.value===O.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E===R&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:J=>J.stopPropagation(),children:gf.map(J=>u.jsx("button",{type:"button",onClick:()=>j(R,J.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${J.color}`,children:J.label},J.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${R>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>T(R),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${O.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:O.objetosc||"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),S===R&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:J=>J.stopPropagation(),style:{maxWidth:"200px"},children:BP.map(J=>u.jsx("button",{type:"button",onClick:()=>F(R,J.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:J.label},J.value))})]})]})]},R))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[I().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(O=>O.kod&&O.nazwa&&O.ilosc&&O.cena)}),B()},disabled:!r||!c.some(O=>O.kod&&O.nazwa&&O.ilosc&&O.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(O=>O.kod&&O.nazwa&&O.ilosc&&O.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},UP=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilo"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilo"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsx("tr",{children:o.map((c,f)=>u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>u.jsx("tr",{children:c.map((h,p)=>u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:h},p))},f))})]})})},HP=({onSearch:e})=>{const[n,t]=C.useState(""),[r,a]=C.useState([]),[o,l]=C.useState(!1);return C.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),u.jsxs("div",{className:"w-full relative",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktw...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsxs("div",{className:"text-center py-4",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"adowanie..."})]})}):r.length>0?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:u.jsxs("table",{className:"w-full table-fixed",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),u.jsx("th",{className:"w-[70%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilo"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc})]},f))})]})}):n?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynik"})}):null]})};let $P={data:""},YP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||$P,VP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,KP=/\/\*[^]*?\*\/|  +/g,Sv=/\n+/g,Ss=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?Ss(l,o):o+"{"+Ss(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=Ss(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Ss.p?Ss.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},Wa={},fw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+fw(e[t]);return n}return e},GP=(e,n,t,r,a)=>{let o=fw(e),l=Wa[o]||(Wa[o]=(f=>{let h=0,p=11;for(;h<f.length;)p=101*p+f.charCodeAt(h++)>>>0;return"go"+p})(o));if(!Wa[l]){let f=o!==e?e:(h=>{let p,m,g=[{}];for(;p=VP.exec(h.replace(KP,""));)p[4]?g.shift():p[3]?(m=p[3].replace(Sv," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][p[1]]=p[2].replace(Sv," ").trim();return g[0]})(e);Wa[l]=Ss(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&Wa.g?Wa.g:null;return t&&(Wa.g=Wa[l]),((f,h,p,m)=>{m?h.data=h.data.replace(m,f):h.data.indexOf(f)===-1&&(h.data=p?f+h.data:h.data+f)})(Wa[l],n,r,c),l},XP=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":Ss(c,""):c===!1?"":c}return r+a+(l??"")},"");function id(e){let n=this||{},t=e.call?e(n.p):e;return GP(t.unshift?t.raw?XP(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,YP(n.target),n.g,n.o,n.k)}let pw,Vf,Kf;id.bind({g:1});let Za=id.bind({k:1});function QP(e,n,t,r){Ss.p=n,pw=e,Vf=t,Kf=r}function zs(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Vf&&Vf()},c),t.o=/ *go\d+/.test(f),c.className=id.apply(t,r)+(f?" "+f:"");let h=e;return e[0]&&(h=c.as||e,delete c.as),Kf&&h[0]&&Kf(c),pw(h,c)}return a}}var qP=e=>typeof e=="function",Ku=(e,n)=>qP(e)?e(n):e,ZP=(()=>{let e=0;return()=>(++e).toString()})(),hw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),JP=20,xw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,JP)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return xw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},bu=[],no={toasts:[],pausedAt:void 0},Eo=e=>{no=xw(no,e),bu.forEach(n=>{n(no)})},eO={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},tO=(e={})=>{let[n,t]=C.useState(no),r=C.useRef(no);C.useEffect(()=>(r.current!==no&&t(no),bu.push(t),()=>{let o=bu.indexOf(t);o>-1&&bu.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||eO[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},rO=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||ZP()}),$l=e=>(n,t)=>{let r=rO(n,e,t);return Eo({type:2,toast:r}),r.id},on=(e,n)=>$l("blank")(e,n);on.error=$l("error");on.success=$l("success");on.loading=$l("loading");on.custom=$l("custom");on.dismiss=e=>{Eo({type:3,toastId:e})};on.remove=e=>Eo({type:4,toastId:e});on.promise=(e,n,t)=>{let r=on.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?Ku(n.success,a):void 0;return o?on.success(o,{id:r,...t,...t?.success}):on.dismiss(r),a}).catch(a=>{let o=n.error?Ku(n.error,a):void 0;o?on.error(o,{id:r,...t,...t?.error}):on.dismiss(r)}),e};var nO=(e,n)=>{Eo({type:1,toast:{id:e,height:n}})},aO=()=>{Eo({type:5,time:Date.now()})},yl=new Map,sO=1e3,oO=(e,n=sO)=>{if(yl.has(e))return;let t=setTimeout(()=>{yl.delete(e),Eo({type:4,toastId:e})},n);yl.set(e,t)},iO=e=>{let{toasts:n,pausedAt:t}=tO(e);C.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&on.dismiss(c.id);return}return setTimeout(()=>on.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=C.useCallback(()=>{t&&Eo({type:6,time:Date.now()})},[t]),a=C.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:h}=l||{},p=n.filter(v=>(v.position||h)===(o.position||h)&&v.height),m=p.findIndex(v=>v.id===o.id),g=p.filter((v,k)=>k<m&&v.visible).length;return p.filter(v=>v.visible).slice(...c?[g+1]:[0,g]).reduce((v,k)=>v+(k.height||0)+f,0)},[n]);return C.useEffect(()=>{n.forEach(o=>{if(o.dismissed)oO(o.id,o.removeDelay);else{let l=yl.get(o.id);l&&(clearTimeout(l),yl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:nO,startPause:aO,endPause:r,calculateOffset:a}}},lO=Za`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,cO=Za`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,uO=Za`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,dO=zs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${lO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${cO} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${uO} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,fO=Za`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,pO=zs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${fO} 1s linear infinite;
`,hO=Za`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,xO=Za`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,mO=zs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${hO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${xO} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,gO=zs("div")`
  position: absolute;
`,vO=zs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,yO=Za`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,wO=zs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${yO} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,kO=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?C.createElement(wO,null,n):n:t==="blank"?null:C.createElement(vO,null,C.createElement(pO,{...r}),t!=="loading"&&C.createElement(gO,null,t==="error"?C.createElement(dO,{...r}):C.createElement(mO,{...r})))},bO=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,_O=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,SO="0%{opacity:0;} 100%{opacity:1;}",EO="0%{opacity:1;} 100%{opacity:0;}",CO=zs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,TO=zs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,NO=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=hw()?[SO,EO]:[bO(t),_O(t)];return{animation:n?`${Za(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Za(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},DO=C.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?NO(e.position||n||"top-center",e.visible):{opacity:0},o=C.createElement(kO,{toast:e}),l=C.createElement(TO,{...e.ariaProps},Ku(e.message,e));return C.createElement(CO,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):C.createElement(C.Fragment,null,o,l))});QP(C.createElement);var FO=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=C.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return C.createElement("div",{ref:o,className:n,style:t},a)},jO=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},AO=id`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,xu=16,PO=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=iO(t);return C.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:xu,left:xu,right:xu,bottom:xu,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(h=>{let p=h.position||n,m=f.calculateOffset(h,{reverseOrder:e,gutter:r,defaultPosition:n}),g=jO(p,m);return C.createElement(FO,{id:h.id,key:h.id,onHeightUpdate:f.updateHeight,className:h.visible?AO:"",style:g},h.type==="custom"?Ku(h.message,h):a?a(h):C.createElement(DO,{toast:h,position:p}))}))},Xe=on;Ms("pl",Is);const OO=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log(" OrderModal render - isOpen:",e);const[r,a]=C.useState(null),[o,l]=C.useState(""),[c,f]=C.useState(""),[h,p]=C.useState([]),[m,g]=C.useState(null),[v,k]=C.useState(!1),[w,b]=C.useState([]),[E,N]=C.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[S,z]=C.useState(null),[te,V]=C.useState(!1),[D,H]=C.useState(!1),[L,ae]=C.useState(null),[Q,Y]=C.useState(new Set),ue=C.useRef(null),le=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],oe=()=>{const T=Math.max(...E.map(F=>F.id))+1;N([...E,{id:T,searchQuery:"",selectedProduct:null,typ:""}])},pe=T=>{E.length>1&&N(F=>F.filter(O=>O.id!==T))},G=()=>{console.log(" OrderModal handleClose called"),a(null),l(""),f(""),p([]),g(null),b([]),N([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),z(null),V(!1),H(!1),ae(null),Y(new Set),ue.current=null,n()};C.useEffect(()=>{e&&(console.log(" OrderModal opened - clearing state"),a(null),l(""),f(""),p([]),g(null),b([]),N([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),z(null),V(!1),H(!1),ae(null),Y(new Set),ue.current=null)},[e]),C.useEffect(()=>{const F=setTimeout(async()=>{if(c.trim().length<2){p([]);return}k(!0);try{const O=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!O.ok)throw new Error("Failed to fetch clients");const R=await O.json();p(R)}catch(O){console.error("Error searching clients:",O),p([])}finally{k(!1)}},300);return()=>clearTimeout(F)},[c]),C.useEffect(()=>{const F=setTimeout(async()=>{if(S===null||!E.find(O=>O.id===S)?.searchQuery.trim()){b([]);return}V(!0);try{const O=E.find(xe=>xe.id===S)?.searchQuery||"",R=m?`/api/working-sheets/search?query=${encodeURIComponent(O)}&client_id=${m.id}`:`/api/working-sheets/search?query=${encodeURIComponent(O)}`,J=await fetch(R);if(!J.ok)throw new Error("Failed to fetch products");const U=(await J.json()).map(xe=>({kod:xe.kod,nazwa:xe.nazwa,ilosc:xe.ilosc.toString(),kodKreskowy:"",selectedQuantity:0,ilosc_reserved:xe.ilosc_reserved||0,ilosc_client_reserved:xe.ilosc_client_reserved||0}));b(U)}catch(O){console.error("Error searching products:",O),b([])}finally{V(!1)}},300);return()=>clearTimeout(F)},[E,S,m]),C.useEffect(()=>{const T=O=>{const R=O.target;L!==null&&(R.closest(".dropdown-container")||ae(null))},F=O=>{O.key==="Escape"&&ae(null)};return L!==null&&(document.addEventListener("mousedown",T),document.addEventListener("keydown",F)),()=>{document.removeEventListener("mousedown",T),document.removeEventListener("keydown",F)}},[L]);const ie=(T,F)=>{console.log(" handleProductSelect called for fieldId:",T,"product:",F.kod),N(O=>O.map(J=>J.id===T?{...J,selectedProduct:F,searchQuery:`${F.kod} - ${F.nazwa.includes(" (samples)")?F.nazwa.replace(" (samples)","")+" (samples)":F.nazwa}`}:J)),b([]),z(null),console.log(" Products list cleared, activeSearchId reset")},B=T=>{ae(L===T?null:T)},de=(T,F)=>{N(O=>O.map(R=>R.id===T?{...R,typ:F}:R)),ae(null)},I=()=>E.filter(T=>T.selectedProduct).reduce((T,F)=>{const O=F.selectedProduct?.selectedQuantity||0;return T+O},0),j=()=>{if(!r||!o.trim()||!m)return!1;const T=E.filter(O=>O.selectedProduct);return!(T.length===0||T.some(O=>!O.selectedProduct?.selectedQuantity||O.selectedProduct.selectedQuantity<=0)||T.some(O=>!O.typ)||Array.from(Q).some(O=>{const J=E.find(Z=>Z.id===O)?.selectedProduct;return J?(J.ilosc_client_reserved||0)===0:!1}))},re=async()=>{const T=E.filter(Z=>Z.selectedProduct).map(Z=>({kod:Z.selectedProduct.kod,nazwa:Z.selectedProduct.nazwa,ilosc:Z.selectedProduct.selectedQuantity||0,typ:Z.typ}));if(!r){Xe.error("Wybierz dat zamwienia");return}if(!o.trim()){Xe.error("Wprowad numer zamwienia");return}if(!m){Xe.error("Wybierz klienta");return}if(T.length===0){Xe.error("Dodaj produkty");return}if(T.some(Z=>!Z.ilosc)){Xe.error("Wprowad ilo dla wszystkich produktw");return}if(T.some(Z=>!Z.typ)){Xe.error("Wybierz typ dla wszystkich produktw");return}Y(new Set);const F=r.getDate().toString().padStart(2,"0"),O=(r.getMonth()+1).toString().padStart(2,"0"),R=r.getFullYear(),J=`${o.trim()}_${F}_${O}_${R}`;H(!0);try{const Z=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:m.nazwa,order_number:J,products:T})});if(!Z.ok){const U=await Z.json();if(Z.status===400&&U.error.includes("Insufficient quantity")){const xe=U.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(xe){const[,M,ve,ye]=xe;Xe.error(`Niewystarczajca ilo produktu ${M}. Dostpne: ${ve}, Zamwione: ${ye}`)}else Xe.error(U.error)}else throw new Error("Failed to create order");return}Xe.success("Zamwienie zostao dodane"),G(),t&&t()}catch(Z){console.error("Error creating order:",Z),Xe.error("Wystpi bd podczas dodawania zamwienia")}finally{H(!1)}};return u.jsx(dr,{isOpen:e,onRequestClose:G,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamwienia"}),u.jsx("button",{onClick:G,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx($n,{selected:r,onChange:T=>a(T),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px] ml-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsx("input",{type:"text",value:o,onChange:T=>l(T.target.value),placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:c,onChange:T=>f(T.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),v&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),h.length>0&&!m&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:h.map(T=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(T),f(T.nazwa),p([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:T.firma})]})},T.id))})]}),m&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.firma})]}),m.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.adres})]}),m.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.kontakt})]})]}),u.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Ct,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),E.map(T=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:T.searchQuery,onChange:F=>{const O=F.target.value;console.log(" Product search input changed for fieldId:",T.id,"value:",O),N(R=>R.map(J=>J.id===T.id?{...J,searchQuery:O,selectedProduct:null}:J)),z(T.id)},onFocus:()=>z(T.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:T.selectedProduct?.selectedQuantity||"",onChange:F=>{const O=F.target.value,R=O===""?0:Math.max(1,parseInt(O)||0);N(J=>{const Z=J.map(xe=>xe.id===T.id&&xe.selectedProduct?{...xe,selectedProduct:{...xe.selectedProduct,selectedQuantity:R}}:xe);ue.current=null;const U=Z.find(xe=>xe.id===T.id);if(U?.selectedProduct){const xe=parseInt(U.selectedProduct.ilosc)||0,M=U.selectedProduct.ilosc_reserved||0,ve=U.selectedProduct.ilosc_client_reserved||0;let ye,Me;ve>0?(ye=ve,Me=!0):(ye=Math.max(0,xe-M),Me=!1),R===0?Y(Pe=>{const ce=new Set(Pe);return ce.delete(T.id),ce}):R>ye?(Y(Pe=>{const ce=new Set(Pe);return ce.add(T.id),ce}),Me?Xe.error(`Przekroczono ilo w rezerwacji. Dostpne: ${ye} szt.`):M>0?Xe.error(`Niewystarczajca ilo - dostpne: ${ye} (na magazynie: ${xe}, z nich w rezerwacji: ${M})`):Xe.error(`Niewystarczajca ilo - dostpne: ${ye} (na magazynie: ${xe})`)):Y(Pe=>{const ce=new Set(Pe);return ce.delete(T.id),ce})}else Y(xe=>{const M=new Set(xe);return M.delete(T.id),M});return Z})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${Q.has(T.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>B(T.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${T.typ&&le.find(F=>F.value===T.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:T.typ&&le.find(F=>F.value===T.typ)?.label||"Typ"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),L===T.id&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:F=>F.stopPropagation(),children:le.map(F=>u.jsx("button",{type:"button",onClick:()=>de(T.id,F.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${F.color}`,children:F.label},F.value))})]}),E.length>1&&u.jsx("button",{onClick:()=>pe(T.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),T.id===Math.max(...E.map(F=>F.id))&&u.jsx("button",{onClick:oe,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(_a,{size:16})}),te&&S===T.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),w.length>0&&S===T.id&&!T.selectedProduct&&T.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:w.map((F,O)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>ie(T.id,{...F,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:F.kod}),F.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:F.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:F.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",F.ilosc]}),(F.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",F.ilosc_reserved??0]})]})},`${F.kod}-${F.nazwa||""}-${O}`))})]},T.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:re,disabled:D||!j(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${D||!j()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:D?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:I()})]})]})})},RO=({isOpen:e,onClose:n,order:t})=>{const[r,a]=C.useState(null),[o,l]=C.useState(null),[c,f]=C.useState(!1),h=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}];C.useEffect(()=>{e&&t&&(p(),m())},[e,t]);const p=async()=>{if(t){f(!0);try{const w=await fetch(`/api/orders/${t.id}`);if(!w.ok)throw new Error("Failed to load order details");const b=await w.json();a(b)}catch(w){console.error("Error loading order details:",w)}finally{f(!1)}}},m=async()=>{if(t)try{const w=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(w.ok){const b=await w.json();l(b)}}catch(w){console.error("Error loading client data:",w)}},g=w=>new Date(w).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const v=r||t,k=async()=>{if(!(!t||!v))try{const w=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!w.ok)throw new Error("Failed to generate PDF");const b=await w.blob(),E=window.URL.createObjectURL(b),N=document.createElement("a");N.href=E;const S=o?o.nazwa:v.klient,z=`${S}_${v.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",S),console.log("Order number:",v.numer_zamowienia),console.log("Generated filename:",z),N.download=z,document.body.appendChild(N),N.click(),window.URL.revokeObjectURL(E),document.body.removeChild(N)}catch(w){console.error("Error generating PDF:",w),alert("Bd podczas generowania PDF")}};return u.jsx(dr,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy zamwienia"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Numer zamwienia:"}),u.jsx("p",{className:"text-sm font-bold text-gray-900",children:v.numer_zamowienia})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),u.jsx("p",{className:"text-gray-900",children:g(v.data_utworzenia||"")})]})]})}),o&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Produkty w zamwieniu"}),v.products&&v.products.length>0?u.jsx("div",{children:u.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Typ"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.products.map(w=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:w.kod}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:w.nazwa})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:w.kod_kreskowy||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:w.ilosc}),u.jsx("td",{className:"px-4 py-2 text-xs w-20",children:w.typ?u.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${h.find(b=>b.value===w.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:h.find(b=>b.value===w.typ)?.label||w.typ}):u.jsx("span",{className:"text-gray-500",children:"-"})})]},w.id))})]})}):u.jsx("p",{className:"text-xs text-gray-500",children:"Brak produktw w zamwieniu"})]})]})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:v.laczna_ilosc})]}),u.jsx("div",{className:"absolute bottom-4 left-4",children:u.jsx("button",{onClick:k,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};Ms("pl",Is);const vf=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],MO=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=C.useState(""),[l,c]=C.useState(""),[f,h]=C.useState(null),[p,m]=C.useState([{kod:"",nazwa:"",ilosc:"",typ:""}]),[g,v]=C.useState(null),[k,w]=C.useState(""),[b,E]=C.useState([]),[N,S]=C.useState(!1),[z,te]=C.useState(null),[V,D]=C.useState([]),[H,L]=C.useState(!1),[ae,Q]=C.useState(null),[Y,ue]=C.useState(new Set),le=async re=>{try{const T=re.map(J=>J.kod).filter(J=>J.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",T),T.length===0)return;const F=await fetch("/api/working-sheets");if(!F.ok)throw new Error("Failed to fetch working sheets");const O=await F.json();console.log("All working sheets products:",O);const R=T.map(J=>{const Z=O.find(U=>U.kod===J);return console.log(`Found product for ${J}:`,Z),Z}).filter(J=>J!==void 0);console.log("Found products for order:",R),E(R),console.log(" Final loaded products info for order editing:",R)}catch(T){console.error(" Error loading products info:",T)}};C.useEffect(()=>{if(e&&r){if(o(r.klient),w(r.klient),Q({nazwa:r.klient}),c(r.numer_zamowienia),r.data_utworzenia){const re=new Date(r.data_utworzenia);h(re),console.log(" Loaded order date:",re)}else h(null);if(r.products&&r.products.length>0){console.log("Order products from backend:",r.products);const re=r.products.map(T=>({kod:T.kod||"",nazwa:T.nazwa||"",ilosc:(T.ilosc||0).toString(),typ:T.typ||""}));console.log("Formatted products:",re),m(re),console.log(" About to load products info for:",re),le(re)}else m([{kod:"",nazwa:"",ilosc:"",typ:""}])}},[e,r]),C.useEffect(()=>{const T=setTimeout(async()=>{if(z===null||!p.find((F,O)=>O===z)?.nazwa.trim()){E([]);return}S(!0);try{const F=p.find((Z,U)=>U===z)?.nazwa||"";if(!F.trim()){E([]),S(!1);return}const O=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(F)}`);if(!O.ok)throw new Error("Failed to fetch products");const J=(await O.json()).map(Z=>({kod:Z.kod,nazwa:Z.nazwa||"",ilosc:Z.ilosc?Z.ilosc.toString():"0",status:Z.status||null}));E(J)}catch(F){console.error("Error searching products:",F),E([])}finally{S(!1)}},300);return()=>clearTimeout(T)},[p,z]),C.useEffect(()=>{const T=setTimeout(async()=>{if(k.trim().length<2){D([]);return}L(!0);try{const F=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!F.ok)throw new Error("Failed to fetch clients");const O=await F.json();D(O)}catch(F){console.error("Error searching clients:",F),D([])}finally{L(!1)}},300);return()=>clearTimeout(T)},[k]),C.useEffect(()=>{const re=F=>{const O=F.target;g!==null&&(O.closest(".dropdown-container")||v(null))},T=F=>{F.key==="Escape"&&v(null)};return g!==null&&(document.addEventListener("mousedown",re),document.addEventListener("keydown",T)),()=>{document.removeEventListener("mousedown",re),document.removeEventListener("keydown",T)}},[g]);const oe=()=>{m([...p,{kod:"",nazwa:"",ilosc:"",typ:""}])},pe=re=>{p.length>1&&m(p.filter((T,F)=>F!==re))},G=(re,T)=>{const F=[...p];F[re].typ=T,m(F),v(null)},ie=re=>{v(g===re?null:re)},B=(re,T)=>{console.log(" EditOrderModal handleProductSelect called for index:",re,"product:",T.kod);const F=[...p];F[re]={...F[re],kod:T.kod,nazwa:T.nazwa,typ:T.typ||"sztuki"},m(F);const O=[...b],R=O.findIndex(J=>J.kod===T.kod);R>=0?O[R]=T:O.push(T),E(O),te(null),console.log(" EditOrderModal Products list cleared, activeSearchId reset")},de=async(re,T)=>{const F=new Set;for(let O=0;O<re.length;O++){const R=re[O],J=parseInt(R.ilosc)||0,Z=p.findIndex(Pe=>Pe.kod===R.kod&&Pe.nazwa===R.nazwa&&Pe.ilosc===R.ilosc);if(Z===-1){console.warn(` Could not find actual index for product ${R.kod}`);continue}const xe=T.find(Pe=>Pe.kod===R.kod)?.ilosc||0,M=r?.products?.find(Pe=>Pe.kod===R.kod),ve=M&&M.ilosc||0;let ye;J>ve?(ye=J-ve,console.log(` Increasing order: ${ve}  ${J}, need additional: ${ye}`)):(ye=J,console.log(` Decreasing order: ${ve}  ${J}, checking total available`));const Me=xe+(J<=ve?ve:0);console.log(`Product ${Z} (valid index ${O}):`,{kod:R.kod,requested:J,availableOnStock:xe,reservedInOrder:ve,requiredFromStock:ye,totalAvailable:Me,hasError:ye>Me}),ye>Me&&(F.add(Z),console.log(` Error for product ${Z}: required ${ye} > available ${Me}`))}return F},I=async re=>{if(re.preventDefault(),!r)return;if(!a.trim()){Xe.error("Wprowad nazw klienta");return}if(!l.trim()){Xe.error("Wprowad numer zamwienia");return}const T=p.filter(R=>R.kod.trim()&&R.nazwa.trim()&&R.ilosc.trim()&&R.typ.trim());if(T.length===0){Xe.error("Dodaj produkty do zamwienia");return}if(T.some(R=>!R.ilosc||!R.typ)){Xe.error("Wprowad ilo i typ dla wszystkich produktw");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",T),console.log("products (stock info):",b),console.log("products.length:",b.length),b.length===0){console.log(" Products info is empty, reloading...");try{const R=await fetch("/api/working-sheets");if(R.ok){const J=await R.json();console.log("Reloaded all products:",J),E(J);const Z=await de(T,J);if(Z.size>0){ue(Z);return}else ue(new Set);console.log(" Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),Xe.error("Bd podczas adowania informacji o produktach");return}}catch(R){console.error("Error reloading products:",R),Xe.error("Bd podczas adowania informacji o produktach");return}}const F=await de(T,b);if(F.size>0){ue(F);return}else ue(new Set);const O=T.map(R=>({kod:R.kod,nazwa:R.nazwa,ilosc:parseInt(R.ilosc)||0,typ:R.typ}));console.log("Sending products data:",O);try{const R=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:O})});if(!R.ok){const J=await R.json();throw new Error(J.error||"Failed to update order")}Xe.success("Zamwienie zostao zaktualizowane"),j(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:O})}catch(R){console.error("Error updating order:",R),Xe.error("Wystpi bd podczas aktualizacji zamwienia")}},j=()=>{o(""),w(""),Q(null),D([]),c(""),h(null),m([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),v(null),E([]),te(null),n()};return r?u.jsx(dr,{isOpen:e,onRequestClose:j,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj zamwienie"}),u.jsx("button",{type:"button",onClick:j,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("form",{onSubmit:I,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex space-x-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx($n,{selected:f,onChange:re=>h(re),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsx("input",{type:"text",value:l,onChange:re=>c(re.target.value),placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:k,onChange:re=>w(re.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),H&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),V.length>0&&!ae&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:V.map(re=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{Q(re),w(re.nazwa),o(re.nazwa),D([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:re.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:re.firma})]})},re.id))})]}),ae&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:ae.nazwa})]}),ae.firma&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:ae.firma})]}),ae.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:ae.adres})]}),ae.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:ae.kontakt})]})]}),u.jsx("button",{type:"button",onClick:()=>{Q(null),w(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Ct,{size:16})})]})})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),p.map((re,T)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:re.nazwa,onChange:F=>{const O=F.target.value;console.log(" EditOrderModal Product search input changed for index:",T,"value:",O);const R=[...p];R[T].nazwa=O,m(R),te(T)},onFocus:()=>te(T),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:re.ilosc,onChange:F=>{const O=[...p];if(O[T].ilosc=F.target.value,m(O),Y.has(T)){const R=new Set(Y);R.delete(T),ue(R)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${Y.has(T)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>ie(T),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${re.typ&&vf.find(F=>F.value===re.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:re.typ&&vf.find(F=>F.value===re.typ)?.label||"Typ"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g===T&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:F=>F.stopPropagation(),children:vf.map(F=>u.jsx("button",{type:"button",onClick:()=>G(T,F.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${F.color}`,children:F.label},F.value))})]}),p.length>1&&u.jsx("button",{type:"button",onClick:()=>pe(T),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),T===p.length-1&&u.jsx("button",{type:"button",onClick:oe,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(_a,{size:16})}),N&&z===T&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),b.length>0&&z===T&&re.nazwa.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:b.map(F=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>B(T,F),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:F.kod}),F.nazwa&&F.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:F.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:F.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",F.ilosc]})]})},F.kod))})]},T))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:j,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:I,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null},IO=({onDeleteOrder:e,onUpdateOrder:n,refreshTrigger:t})=>{const[r,a]=C.useState([]),[o,l]=C.useState(!0),[c,f]=C.useState(null),[h,p]=C.useState(null),[m,g]=C.useState(!1),[v,k]=C.useState(!1),[w,b]=C.useState(null),[E,N]=C.useState(!1),[S,z]=C.useState(null),[te,V]=C.useState(""),[D,H]=C.useState({}),[L,ae]=C.useState("data_utworzenia"),[Q,Y]=C.useState("desc"),[ue,le]=C.useState(""),[oe,pe]=C.useState(""),G=async()=>{try{console.log(" Starting to load orders..."),l(!0),f(null),console.log(" Fetching from /api/orders-with-products...");const ve=await fetch("/api/orders-with-products");if(console.log(" Response status:",ve.status),console.log(" Response ok:",ve.ok),!ve.ok)throw new Error(`HTTP error! status: ${ve.status}`);const ye=await ve.json();console.log(" Raw data received:",ye),console.log(" Raw data length:",ye.length);const Me=ye.map(Pe=>({id:Pe.id,klient:Pe.klient,numer_zamowienia:Pe.numer_zamowienia,data_utworzenia:Pe.data_utworzenia,laczna_ilosc:Pe.laczna_ilosc,typ:Pe.typ||"zamowienie",numer_zwrotu:Pe.numer_zwrotu||null,products:Pe.products||[]}));console.log(" Transformed orders:",Me),console.log(" Orders count:",Me.length),a(Me)}catch(ve){console.error(" Error loading orders:",ve),f("Failed to load orders")}finally{l(!1)}};C.useEffect(()=>{G()},[]),C.useEffect(()=>{t&&G()},[t]);const ie=ve=>new Date(ve).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),B=ve=>{p(ve),g(!0)},de=ve=>{b(ve),k(!0)},I=async ve=>{if(console.log("OrdersList handleEditSubmit called with data:",ve),n)n(ve);else try{console.log("Sending PUT request to update order:",ve);const ye=await fetch(`/api/orders/${ve.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)});if(!ye.ok)throw new Error(`HTTP error! status: ${ye.status}`);Xe.success("Zamwienie zostao zaktualizowane"),G()}catch(ye){console.error("Error updating order:",ye),Xe.error("Bd podczas aktualizacji zamwienia")}},j=ve=>{z(ve),N(!0),V("")},re=async()=>{if(te==="5202"){if(S?.id)try{e&&e(S.id);const ve=await fetch(`/api/orders/${S.id}`,{method:"DELETE"});if(!ve.ok)throw new Error(`HTTP error! status: ${ve.status}`);const ye=await ve.json();console.log("Order deleted:",ye),Xe.success("Zamwienie zostao usunite"),G()}catch(ve){console.error("Error deleting order:",ve),Xe.error("Bd podczas usuwania zamwienia")}T()}else Xe.error("Nieprawidowe haso"),V("")},T=()=>{N(!1),z(null),V("")},F=ve=>{ve.key==="Enter"&&re()},O=async ve=>{try{console.log("    WMS  backend, orderId:",ve.id);const ye=await fetch("/api/wms/send-shipment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:ve.id})}),Me=await ye.json();if(!ye.ok)throw new Error(Me.error||`HTTP ${ye.status}`);return console.log("   backend:",Me),Xe.success(`   WMS: ${Me.wmsShipmentId||""}`),!0}catch(ye){return console.error("    WMS:",ye),Xe.error(`   WMS: ${ye instanceof Error?ye.message:" "}`),!1}},R=async(ve,ye)=>{const Me=r.find(ce=>ce.id===ve);if(!Me)return;const Pe=D[ve]||"przygotowane";if(Pe==="przygotowane"&&ye==="wysane"){const ce=Xe.loading("  WMS..."),Fe=await O(Me);if(Xe.dismiss(ce),!Fe)return}H(ce=>({...ce,[ve]:ye})),(Pe!=="przygotowane"||ye!=="wysane")&&Xe.success(`Status zamwienia zmieniony na: ${ye}`)},J=ve=>{L===ve?Y(Q==="asc"?"desc":"asc"):(ae(ve),Y("asc"))},Z=Array.from(new Set(r.map(ve=>new Date(ve.data_utworzenia).getFullYear().toString()))).sort((ve,ye)=>parseInt(ye)-parseInt(ve)),U=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],M=r.filter(ve=>!(ue&&new Date(ve.data_utworzenia).getFullYear().toString()!==ue||oe&&(new Date(ve.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==oe)).sort((ve,ye)=>{let Me,Pe;switch(L){case"numer_zamowienia":Me=(ve.numer_zamowienia||"").toLowerCase(),Pe=(ye.numer_zamowienia||"").toLowerCase();break;case"klient":Me=(ve.klient||"").toLowerCase(),Pe=(ye.klient||"").toLowerCase();break;case"laczna_ilosc":Me=ve.laczna_ilosc,Pe=ye.laczna_ilosc;break;case"data_utworzenia":Me=new Date(ve.data_utworzenia),Pe=new Date(ye.data_utworzenia);break;default:Me=ve[L]||"",Pe=ye[L]||""}return typeof Me=="string"&&typeof Pe=="string"?Q==="asc"?Me.localeCompare(Pe):Pe.localeCompare(Me):typeof Me=="number"&&typeof Pe=="number"?Q==="asc"?Me-Pe:Pe-Me:Me instanceof Date&&Pe instanceof Date?Q==="asc"?Me.getTime()-Pe.getTime():Pe.getTime()-Me.getTime():0});return o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie zamwie..."})}):c?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",c]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>J("numer_zamowienia"),children:"Numer zamwienia"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>J("klient"),children:"Klient"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>J("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>J("laczna_ilosc"),children:"czna ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>J("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:ue,onChange:ve=>le(ve.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),Z.map(ve=>u.jsx("option",{value:ve,style:{fontFamily:"Sora, sans-serif"},children:ve},ve))]}),u.jsxs("select",{value:oe,onChange:ve=>pe(ve.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[u.jsx("option",{value:"",children:"Msc"}),U.map(ve=>u.jsx("option",{value:ve.value,style:{fontFamily:"Sora, sans-serif"},children:ve.value},ve.value))]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamwie"})}):M.map(ve=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.numer_zamowienia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.klient}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ve.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:ve.typ==="zwrot"?"Zwrot":"Zamwienie"})}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.laczna_ilosc}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ie(ve.data_utworzenia)}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:ye=>{ye.preventDefault(),ye.stopPropagation(),B(ve)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(Jf,{size:16})}),u.jsx("button",{type:"button",onClick:ye=>{ye.preventDefault(),ye.stopPropagation(),de(ve)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Al,{size:16})}),u.jsx("button",{type:"button",onClick:ye=>{ye.preventDefault(),ye.stopPropagation(),j(ve)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Ct,{size:16})})]}),u.jsxs("select",{value:D[ve.id]||"przygotowane",onChange:ye=>{ye.preventDefault(),ye.stopPropagation(),R(ve.id,ye.target.value)},onClick:ye=>ye.stopPropagation(),className:"px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"przygotowane",children:"Przygotowane"}),u.jsx("option",{value:"wysane",children:"Wysane"})]})]})})]},ve.id))})]})}),u.jsx(dr,{isOpen:E,onRequestClose:T,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:T,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:te,onChange:ve=>V(ve.target.value),onKeyPress:F,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:T,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:re,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(RO,{isOpen:m,onClose:()=>g(!1),order:h}),u.jsx(MO,{isOpen:v,onClose:()=>{k(!1),b(null)},onSubmit:ve=>{I(ve),k(!1),b(null)},order:w})]})},zO=({isOpen:e,onClose:n,reservation:t})=>{const[r,a]=Te.useState({x:0,y:0}),[o,l]=Te.useState(!1),c=Te.useRef({x:0,y:0});Te.useEffect(()=>{const p=g=>{o&&a({x:g.clientX-c.current.x,y:g.clientY-c.current.y})},m=()=>l(!1);return o&&(window.addEventListener("mousemove",p),window.addEventListener("mouseup",m)),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m)}},[o]);const f=p=>{p.target.closest("button")||p.target.closest("input")||(l(!0),c.current={x:p.clientX-r.x,y:p.clientY-r.y})};if(!t)return null;const h=p=>new Date(p).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"});return u.jsx(dr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${r.x}px), calc(-50% + ${r.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:f,style:{cursor:o?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy rezerwacji"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Numer rezerwacji"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.numer_rezerwacji})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data utworzenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_utworzenia)})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Klient"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.klient})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakoczenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_zakonczenia)})]})]}),t.komentarz&&u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Komentarz"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.komentarz})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[220px]",children:"Nazwa"}),(t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa")&&u.jsx("th",{className:"py-2 text-left w-[85px]"}),u.jsx("th",{className:"px-2 py-2 text-center w-[70px]",children:"Pozostao"}),u.jsx("th",{className:"px-2 py-2 text-center w-[60px]",children:"Wydane"}),u.jsx("th",{className:"px-2 py-2 text-center w-[90px]",children:"Zarezerwowane"})]})}),u.jsx("tbody",{children:t.products&&t.products.length>0?t.products.map(p=>{const m=p.ilosc_wydane??0,g=p.ilosc-m,v=t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa";return u.jsxs("tr",{className:v?"opacity-50":"",children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:p.product_kod}),u.jsx("td",{className:"px-2 py-2 w-[220px] break-words leading-tight",children:p.product_nazwa}),t.status==="anulowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-red-600 font-medium",children:"anulowana"})}),t.status==="zrealizowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-blue-600 font-medium",children:"zrealizowana"})}),t.status==="wygasa"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-gray-600 font-medium",children:"wygasa"})}),u.jsx("td",{className:"px-2 py-2 w-[70px] text-center",children:u.jsx("span",{className:g>0&&!v?"text-green-600 font-medium":"text-gray-400",children:g})}),u.jsx("td",{className:`px-2 py-2 w-[60px] text-center ${v?"text-gray-400":"text-red-600"}`,children:m}),u.jsx("td",{className:"px-2 py-2 w-[90px] text-center",children:p.ilosc})]},p.id)}):u.jsx("tr",{children:u.jsx("td",{colSpan:t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa"?6:5,className:"px-2 py-4 text-center text-gray-500",children:"Brak produktw"})})})]})]})]})]})})};Ms("pl",Is);const LO=({isOpen:e,onClose:n,onSubmit:t,reservation:r})=>{const[a,o]=C.useState(""),[l,c]=C.useState(""),[f,h]=C.useState(null),[p,m]=C.useState(null),[g,v]=C.useState("aktywna"),[k,w]=C.useState(""),[b,E]=C.useState([{kod:"",nazwa:"",ilosc:""}]),[N,S]=C.useState([]),[z,te]=C.useState([]),[V,D]=C.useState(!1),[H,L]=C.useState(null),[ae,Q]=C.useState([]),[Y,ue]=C.useState(!1),[le,oe]=C.useState(null),[pe,G]=C.useState(""),[ie,B]=C.useState(new Set),[de,I]=C.useState(!1),j=C.useRef(null);C.useEffect(()=>{e&&(async()=>{try{const U=await fetch("/api/working-sheets/search?query=");if(U.ok){const xe=await U.json();te(xe)}}catch(U){console.error("Error loading stock info:",U)}})()},[e]),C.useEffect(()=>{if(e&&r)if(o(r.klient),G(r.klient),oe({nazwa:r.klient,firma:r.firma}),c(r.numer_rezerwacji),v(r.status),w(r.komentarz||""),B(new Set),j.current=null,r.data_utworzenia&&h(new Date(r.data_utworzenia)),r.data_zakonczenia&&m(new Date(r.data_zakonczenia)),r.products&&r.products.length>0){const Z=r.products.map(xe=>({kod:xe.product_kod||"",nazwa:xe.product_nazwa||"",ilosc:(xe.ilosc||0).toString(),originalIlosc:xe.ilosc||0,iloscWydane:xe.ilosc_wydane||0}));E(Z);const U=r.products.some(xe=>(xe.ilosc_wydane||0)>0);I(U)}else E([{kod:"",nazwa:"",ilosc:""}]),I(!1)},[e,r]),C.useEffect(()=>{const U=setTimeout(async()=>{if(H===null||!b.find((xe,M)=>M===H)?.nazwa.trim()){S([]);return}D(!0);try{const xe=b.find((ye,Me)=>Me===H)?.nazwa||"";if(!xe.trim()){S([]),D(!1);return}const M=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(xe)}`);if(!M.ok)throw new Error("Failed to fetch products");const ve=await M.json();S(ve)}catch(xe){console.error("Error searching products:",xe),S([])}finally{D(!1)}},300);return()=>clearTimeout(U)},[b,H]),C.useEffect(()=>{const U=setTimeout(async()=>{if(pe.trim().length<2){Q([]);return}ue(!0);try{const xe=await fetch(`/api/clients/search?q=${encodeURIComponent(pe)}`);if(!xe.ok)throw new Error("Failed to fetch clients");const M=await xe.json();Q(M)}catch(xe){console.error("Error searching clients:",xe),Q([])}finally{ue(!1)}},300);return()=>clearTimeout(U)},[pe]);const re=()=>{E([...b,{kod:"",nazwa:"",ilosc:""}])},T=(Z,U)=>{const xe=[...b];xe[Z]={...xe[Z],kod:U.kod,nazwa:U.nazwa},E(xe),L(null),z.findIndex(ve=>ve.kod===U.kod)<0&&te([...z,U])},F=(Z,U)=>{const xe=[...b];xe[Z].ilosc=U,E(xe);const M=xe[Z],ve=parseInt(U)||0,ye=M.originalIlosc||0,Me=M.iloscWydane||0;if(j.current=null,!U.trim()||ve===0){B(lt=>{const ft=new Set(lt);return ft.delete(Z),ft});return}const Pe=z.find(lt=>lt.kod===M.kod),ce=Pe?.ilosc||0,Fe=Pe?.ilosc_reserved||0,Re=ce-Fe+ye;let De=null;ve<Me?De=`Nie mona zmniejszy poniej wydanej iloci (${Me} szt.)`:M.kod&&ve>Re&&(De=`Niewystarczajca ilo - dostpne do rezerwacji: ${Math.max(0,Re-ye)} szt.`),B(lt=>{const ft=new Set(lt);return De?ft.add(Z):ft.delete(Z),ft}),De&&Xe.error(De)},O=()=>{if(!le||!a.trim()||!p||ie.size>0||b.filter(U=>U.kod.trim()&&U.nazwa.trim()&&U.ilosc.trim()).length===0)return!1;for(let U=0;U<b.length;U++){const xe=b[U];if(!xe.kod.trim()||!xe.nazwa.trim()||!xe.ilosc.trim())continue;const M=parseInt(xe.ilosc)||0,ve=xe.iloscWydane||0,ye=xe.originalIlosc||0;if(M<ve)return!1;if(M>ye&&xe.kod){const Me=z.find(Re=>Re.kod===xe.kod),Pe=Me?.ilosc||0,ce=Me?.ilosc_reserved||0,Fe=Pe-ce+ye;if(M>Fe)return!1}}return!0},R=async Z=>{if(Z.preventDefault(),!r)return;if(!le||!a.trim()){Xe.error("Wybierz klienta");return}if(!l.trim()){Xe.error("Wprowad numer rezerwacji");return}if(!p){Xe.error("Wybierz dat zakoczenia");return}const U=b.filter(M=>M.kod.trim()&&M.nazwa.trim()&&M.ilosc.trim());if(U.length===0){Xe.error("Dodaj produkty do rezerwacji");return}if(!O()){Xe.error("Popraw bdy w formularzu");return}const xe=U.map(M=>({kod:M.kod,nazwa:M.nazwa,ilosc:parseInt(M.ilosc)||0,originalIlosc:M.originalIlosc||0,iloscWydane:M.iloscWydane||0}));try{const M=await fetch(`/api/reservations/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_rezerwacji:l.trim(),data_utworzenia:f?f.toISOString().split("T")[0]:null,data_zakonczenia:p.toISOString().split("T")[0],status:g,komentarz:k.trim()||null,products:xe})});if(!M.ok){const ve=await M.json();throw new Error(ve.error||"Failed to update reservation")}Xe.success("Rezerwacja zostaa zaktualizowana"),J(),t()}catch(M){console.error("Error updating reservation:",M),Xe.error(M.message||"Wystpi bd podczas aktualizacji rezerwacji")}},J=()=>{o(""),G(""),oe(null),Q([]),c(""),h(null),m(null),v("aktywna"),w(""),E([{kod:"",nazwa:"",ilosc:""}]),S([]),te([]),L(null),B(new Set),I(!1),j.current=null,n()};return r?u.jsx(dr,{isOpen:e,onRequestClose:J,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj rezerwacj"}),u.jsx("button",{type:"button",onClick:J,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("form",{onSubmit:R,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx($n,{selected:f,onChange:()=>{},locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholderText:"Wybierz dat",popperClassName:"z-50",disabled:!0})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:l,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx($n,{selected:p,onChange:Z=>m(Z),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:f||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:pe,onChange:Z=>{de||(G(Z.target.value),le&&(oe(null),o("")))},placeholder:"Wyszukaj klienta...",disabled:de,title:de?"Nie mona zmieni klienta - cz towaru zostaa ju wydana":"",className:`w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${de?"bg-gray-50 cursor-not-allowed":""}`}),Y&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),ae.length>0&&!le&&!de&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:ae.map(Z=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{oe(Z),G(Z.nazwa),o(Z.nazwa),Q([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:Z.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:Z.firma})]})},Z.id))}),le&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:le.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:le.firma})]}),!de&&u.jsx("button",{type:"button",onClick:()=>{oe(null),G(""),o("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(Ct,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:k,onChange:Z=>w(Z.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),b.map((Z,U)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:Z.nazwa,onChange:xe=>{const M=[...b];M[U].nazwa=xe.target.value,M[U].kod="",E(M),L(U)},onFocus:()=>L(U),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",disabled:(Z.iloscWydane??0)>0})]}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:Z.iloscWydane||1,placeholder:"Ilo",value:Z.ilosc,onChange:xe=>F(U,xe.target.value),className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${ie.has(U)?"border-red-500 bg-red-50":"border-gray-300"}`})})]}),U===b.length-1&&u.jsx("button",{type:"button",onClick:re,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(_a,{size:16})}),V&&H===U&&u.jsx("div",{className:"absolute right-24 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),N.length>0&&H===U&&Z.nazwa.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[calc(100%-6rem)] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:N.map(xe=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>T(U,xe),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:xe.kod}),xe.nazwa&&xe.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:xe.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:xe.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",xe.ilosc]}),(xe.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",xe.ilosc_reserved??0]})]})},xe.kod))})]},U))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:J,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:R,disabled:!O(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora ${O()?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:"Zapisz zmiany"})]})]})}):null},BO=({refreshTrigger:e})=>{const[n,t]=C.useState([]),[r,a]=C.useState(!0),[o,l]=C.useState(null),[c,f]=C.useState(null),[h,p]=C.useState(!1),[m,g]=C.useState(!1),[v,k]=C.useState(null),[w,b]=C.useState(!1),[E,N]=C.useState(null),[S,z]=C.useState("data_utworzenia"),[te,V]=C.useState("desc"),[D,H]=C.useState(""),[L,ae]=C.useState(""),[Q,Y]=C.useState(""),[ue,le]=C.useState(""),oe=async()=>{try{console.log(" Starting to load reservations..."),a(!0),l(null),console.log(" Fetching from /api/reservations-with-products...");const U=await fetch("/api/reservations-with-products");if(console.log(" Response status:",U.status),!U.ok)throw new Error(`HTTP error! status: ${U.status}`);const xe=await U.json();console.log(" Raw data received:",xe),console.log(" Raw data length:",xe.length);const M=xe.map(ve=>({id:ve.id,numer_rezerwacji:ve.numer_rezerwacji,klient:ve.klient||"",firma:ve.firma||"",data_utworzenia:ve.data_utworzenia,data_zakonczenia:ve.data_zakonczenia,status:ve.status||"aktywna",komentarz:ve.komentarz||null,laczna_ilosc:ve.laczna_ilosc||0,products:ve.products||[]}));console.log(" Transformed reservations:",M),console.log(" Reservations count:",M.length),t(M)}catch(U){console.error(" Error loading reservations:",U),l("Failed to load reservations")}finally{a(!1)}};C.useEffect(()=>{oe()},[]),C.useEffect(()=>{e&&oe()},[e]);const pe=U=>new Date(U).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"}),G=U=>{f(U),p(!0)},ie=U=>{k(U),g(!0)},B=U=>{N(U),b(!0)},de=async()=>{if(E)try{const U=await fetch(`/api/reservations/${E.id}/cancel`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!U.ok){const xe=await U.json();throw new Error(xe.error||"Failed to cancel reservation")}Xe.success("Rezerwacja zostaa anulowana"),b(!1),N(null),oe()}catch(U){console.error("Error cancelling reservation:",U),Xe.error(U.message||"Wystpi bd podczas anulowania rezerwacji")}},I=U=>{S===U?V(te==="asc"?"desc":"asc"):(z(U),V("asc"))},j=Array.from(new Set(n.map(U=>new Date(U.data_utworzenia).getFullYear().toString()))).sort((U,xe)=>parseInt(xe)-parseInt(U)),re=Array.from(new Set(n.map(U=>U.klient).filter(Boolean))).sort(),T=Array.from(new Set(n.map(U=>U.status).filter(Boolean))).sort(),F=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],O=new Set(n.map(U=>(new Date(U.data_utworzenia).getMonth()+1).toString().padStart(2,"0"))),R=F.filter(U=>O.has(U.value)),Z=n.filter(U=>!(D&&new Date(U.data_utworzenia).getFullYear().toString()!==D||L&&(new Date(U.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==L||Q&&U.klient!==Q||ue&&U.status!==ue)).sort((U,xe)=>{let M,ve;switch(S){case"numer_rezerwacji":M=(U.numer_rezerwacji||"").toLowerCase(),ve=(xe.numer_rezerwacji||"").toLowerCase();break;case"klient":M=(U.klient||"").toLowerCase(),ve=(xe.klient||"").toLowerCase();break;case"status":M=(U.status||"").toLowerCase(),ve=(xe.status||"").toLowerCase();break;case"laczna_ilosc":M=U.laczna_ilosc,ve=xe.laczna_ilosc;break;case"data_utworzenia":M=new Date(U.data_utworzenia),ve=new Date(xe.data_utworzenia);break;case"data_zakonczenia":M=new Date(U.data_zakonczenia),ve=new Date(xe.data_zakonczenia);break;default:M=U[S]||"",ve=xe[S]||""}return typeof M=="string"&&typeof ve=="string"?te==="asc"?M.localeCompare(ve):ve.localeCompare(M):typeof M=="number"&&typeof ve=="number"?te==="asc"?M-ve:ve-M:M instanceof Date&&ve instanceof Date?te==="asc"?M.getTime()-ve.getTime():ve.getTime()-M.getTime():0});return r?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie rezerwacji..."})}):o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",o]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-end",children:u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1",children:[u.jsxs("select",{value:Q,onChange:U=>Y(U.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Klient"}),re.map(U=>u.jsx("option",{value:U,children:U},U))]}),u.jsxs("select",{value:ue,onChange:U=>le(U.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Status"}),T.map(U=>u.jsx("option",{value:U,children:U},U))]}),u.jsxs("select",{value:D,onChange:U=>H(U.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Rok"}),j.map(U=>u.jsx("option",{value:U,children:U},U))]}),u.jsxs("select",{value:L,onChange:U=>ae(U.target.value),className:"w-32 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Miesic"}),R.map(U=>u.jsx("option",{value:U.value,children:U.label},U.value))]})]}),(Q||ue||D||L)&&u.jsx("button",{onClick:()=>{Y(""),le(""),H(""),ae("")},className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})}),u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("numer_rezerwacji"),children:"Numer rezerwacji"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("klient"),children:"Klient"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("data_zakonczenia"),children:"Data zakoczenia"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("status"),children:"Status"}),u.jsx("th",{className:"px-8 py-4 border-b border-gray-200 bg-gray-50"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak rezerwacji"})}):Z.map(U=>u.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>G(U),children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:U.numer_rezerwacji}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:U.klient}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:pe(U.data_utworzenia)}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:pe(U.data_zakonczenia)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-left",children:u.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded ${U.status==="aktywna"?"bg-green-100 text-green-800":U.status==="anulowana"?"bg-red-100 text-red-800":U.status==="zrealizowana"?"bg-blue-100 text-blue-800":U.status==="wygasa"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:U.status})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-sora",children:u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:xe=>{xe.preventDefault(),xe.stopPropagation(),U.status==="aktywna"&&ie(U)},className:"text-green-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:text-green-600 hover:text-green-800",title:U.status==="aktywna"?"Edytuj":void 0,disabled:U.status!=="aktywna",children:u.jsx(Al,{size:16})}),U.status==="aktywna"&&u.jsx("button",{type:"button",onClick:xe=>{xe.preventDefault(),xe.stopPropagation(),B(U)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Anuluj rezerwacj",children:u.jsx(w2,{size:16})})]})})]},U.id))})]})}),u.jsx(zO,{isOpen:h,onClose:()=>p(!1),reservation:c}),u.jsx(LO,{isOpen:m,onClose:()=>{g(!1),k(null)},onSubmit:()=>{g(!1),k(null),oe()},reservation:v}),u.jsx(dr,{isOpen:w,onRequestClose:()=>{b(!1),N(null)},style:{content:{width:"320px",height:"170px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800"}),u.jsx("button",{onClick:()=>{b(!1),N(null)},className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-4 text-center",children:"Czy na pewno chcesz anulowa rezerwacj?"}),u.jsxs("div",{className:"flex justify-center gap-3 mt-auto",children:[u.jsx("button",{type:"button",onClick:()=>{b(!1),N(null)},className:"px-3 py-1.5 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200 font-sora",children:"Nie"}),u.jsx("button",{type:"button",onClick:de,className:"px-3 py-1.5 text-xs text-white bg-blue-500 rounded hover:bg-blue-600 font-sora",children:"Tak"})]})]})})]})};var yf={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Ev;function WO(){return Ev||(Ev=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(yf)),yf.exports}var UO=WO();const Gf=Gu(UO);var Cv={};const HO="react-tooltip-core-styles",$O="react-tooltip-base-styles",Tv={core:!1,base:!1};function Nv({css:e,id:n=$O,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Tv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Cv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Cv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=HO),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Tv[t]=!0}const Dv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[tw(Number(a)),rw({fallbackAxisSideDirection:"start"}),Yj({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const h=l;return t?(h.push(Hf({element:t,padding:5})),$f(e,n,{placement:r,strategy:o,middleware:h}).then((({x:p,y:m,placement:g,middlewareData:v})=>{var k,w;const b={left:`${p}px`,top:`${m}px`,border:c},{x:E,y:N}=(k=v.arrow)!==null&&k!==void 0?k:{x:0,y:0},S=(w={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&w!==void 0?w:"bottom",z=c&&{borderBottom:c,borderRight:c};let te=0;if(c){const V=`${c}`.match(/(\d+)px/);te=V?.[1]?Number(V[1]):1}return{tooltipStyles:b,tooltipArrowStyles:{left:E!=null?`${E}px`:"",top:N!=null?`${N}px`:"",right:"",bottom:"",...z,[S]:`-${f/2+te}px`},place:g}}))):$f(e,n,{placement:"bottom",strategy:o,middleware:h}).then((({x:p,y:m,placement:g})=>({tooltipStyles:{left:`${p}px`,top:`${m}px`},tooltipArrowStyles:{},place:g})))},Fv=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),jv=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Av=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Xf=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Xf(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Av(e)||!Av(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Xf(e[a],n[a])))},YO=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Pv=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(YO(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},VO=typeof window<"u"?C.useLayoutEffect:C.useEffect,Mn=e=>{e.current&&(clearTimeout(e.current),e.current=null)},KO="DEFAULT_TOOLTIP_ID",GO={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},XO=C.createContext({getTooltipData:()=>GO});function mw(e=KO){return C.useContext(XO).getTooltipData(e)}var qo={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},wf={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const QO=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:h=["hover"],openOnClick:p=!1,positionStrategy:m="absolute",middlewares:g,wrapper:v,delayShow:k=0,delayHide:w=0,float:b=!1,hidden:E=!1,noArrow:N=!1,clickable:S=!1,closeOnEsc:z=!1,closeOnScroll:te=!1,closeOnResize:V=!1,openEvents:D,closeEvents:H,globalCloseEvents:L,imperativeModeOnly:ae,style:Q,position:Y,afterShow:ue,afterHide:le,disableTooltip:oe,content:pe,contentWrapperRef:G,isOpen:ie,defaultIsOpen:B=!1,setIsOpen:de,activeAnchor:I,setActiveAnchor:j,border:re,opacity:T,arrowColor:F,arrowSize:O=8,role:R="tooltip"})=>{var J;const Z=C.useRef(null),U=C.useRef(null),xe=C.useRef(null),M=C.useRef(null),ve=C.useRef(null),[ye,Me]=C.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[Pe,ce]=C.useState(!1),[Fe,Re]=C.useState(!1),[De,lt]=C.useState(null),ft=C.useRef(!1),gt=C.useRef(null),{anchorRefs:Nt,setActiveAnchor:zt}=mw(n),Qt=C.useRef(!1),[qt,Bt]=C.useState([]),rr=C.useRef(!1),ut=p||h.includes("click"),_t=ut||D?.click||D?.dblclick||D?.mousedown,Ht=D?{...D}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!D&&ut&&Object.assign(Ht,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const Dt=H?{...H}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!H&&ut&&Object.assign(Dt,{mouseleave:!1,blur:!1,mouseout:!1});const Zt=L?{...L}:{escape:z||!1,scroll:te||!1,resize:V||!1,clickOutsideAnchor:_t||!1};ae&&(Object.assign(Ht,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(Dt,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(Zt,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),VO((()=>(rr.current=!0,()=>{rr.current=!1})),[]);const $t=Ve=>{rr.current&&(Ve&&Re(!0),setTimeout((()=>{rr.current&&(de?.(Ve),ie===void 0&&ce(Ve))}),10))};C.useEffect((()=>{if(ie===void 0)return()=>null;ie&&Re(!0);const Ve=setTimeout((()=>{ce(ie)}),10);return()=>{clearTimeout(Ve)}}),[ie]),C.useEffect((()=>{if(Pe!==ft.current)if(Mn(ve),ft.current=Pe,Pe)ue?.();else{const Ve=(Ge=>{const pt=Ge.match(/^([\d.]+)(ms|s)$/);if(!pt)return 0;const[,Ft,Yt]=pt;return Number(Ft)*(Yt==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));ve.current=setTimeout((()=>{Re(!1),lt(null),le?.()}),Ve+25)}}),[Pe]);const he=Ve=>{Me((Ge=>Xf(Ge,Ve)?Ge:Ve))},Oe=(Ve=k)=>{Mn(xe),Fe?$t(!0):xe.current=setTimeout((()=>{$t(!0)}),Ve)},Ie=(Ve=w)=>{Mn(M),M.current=setTimeout((()=>{Qt.current||$t(!1)}),Ve)},X=Ve=>{var Ge;if(!Ve)return;const pt=(Ge=Ve.currentTarget)!==null&&Ge!==void 0?Ge:Ve.target;if(!pt?.isConnected)return j(null),void zt({current:null});k?Oe():$t(!0),j(pt),zt({current:pt}),Mn(M)},me=()=>{S?Ie(w||100):w?Ie():$t(!1),Mn(xe)},Ne=({x:Ve,y:Ge})=>{var pt;const Ft={getBoundingClientRect:()=>({x:Ve,y:Ge,width:0,height:0,top:Ge,left:Ve,right:Ve,bottom:Ge})};Dv({place:(pt=De?.place)!==null&&pt!==void 0?pt:c,offset:f,elementReference:Ft,tooltipReference:Z.current,tooltipArrowReference:U.current,strategy:m,middlewares:g,border:re,arrowSize:O}).then((Yt=>{he(Yt)}))},Ae=Ve=>{if(!Ve)return;const Ge=Ve,pt={x:Ge.clientX,y:Ge.clientY};Ne(pt),gt.current=pt},et=Ve=>{var Ge;if(!Pe)return;const pt=Ve.target;pt.isConnected&&(!((Ge=Z.current)===null||Ge===void 0)&&Ge.contains(pt)||[document.querySelector(`[id='${o}']`),...qt].some((Ft=>Ft?.contains(pt)))||($t(!1),Mn(xe)))},at=jv(X,50),dt=jv(me,50),Et=Ve=>{dt.cancel(),at(Ve)},qe=()=>{at.cancel(),dt()},Ze=C.useCallback((()=>{var Ve,Ge;const pt=(Ve=De?.position)!==null&&Ve!==void 0?Ve:Y;pt?Ne(pt):b?gt.current&&Ne(gt.current):I?.isConnected&&Dv({place:(Ge=De?.place)!==null&&Ge!==void 0?Ge:c,offset:f,elementReference:I,tooltipReference:Z.current,tooltipArrowReference:U.current,strategy:m,middlewares:g,border:re,arrowSize:O}).then((Ft=>{rr.current&&he(Ft)}))}),[Pe,I,pe,Q,c,De?.place,f,m,Y,De?.position,b,O]);C.useEffect((()=>{var Ve,Ge;const pt=new Set(Nt);qt.forEach((We=>{oe?.(We)||pt.add({current:We})}));const Ft=document.querySelector(`[id='${o}']`);Ft&&!oe?.(Ft)&&pt.add({current:Ft});const Yt=()=>{$t(!1)},P=Pv(I),ee=Pv(Z.current);Zt.scroll&&(window.addEventListener("scroll",Yt),P?.addEventListener("scroll",Yt),ee?.addEventListener("scroll",Yt));let W=null;Zt.resize?window.addEventListener("resize",Yt):I&&Z.current&&(W=ew(I,Z.current,Ze,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const K=We=>{We.key==="Escape"&&$t(!1)};Zt.escape&&window.addEventListener("keydown",K),Zt.clickOutsideAnchor&&window.addEventListener("click",et);const q=[],ne=We=>!!(We?.target&&I?.contains(We.target)),be=We=>{Pe&&ne(We)||X(We)},je=We=>{Pe&&ne(We)&&me()},ke=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],Se=["click","dblclick","mousedown","mouseup"];Object.entries(Ht).forEach((([We,Ue])=>{Ue&&(ke.includes(We)?q.push({event:We,listener:Et}):Se.includes(We)&&q.push({event:We,listener:be}))})),Object.entries(Dt).forEach((([We,Ue])=>{Ue&&(ke.includes(We)?q.push({event:We,listener:qe}):Se.includes(We)&&q.push({event:We,listener:je}))})),b&&q.push({event:"pointermove",listener:Ae});const Ee=()=>{Qt.current=!0},Be=()=>{Qt.current=!1,me()},Ke=S&&(Dt.mouseout||Dt.mouseleave);return Ke&&((Ve=Z.current)===null||Ve===void 0||Ve.addEventListener("mouseover",Ee),(Ge=Z.current)===null||Ge===void 0||Ge.addEventListener("mouseout",Be)),q.forEach((({event:We,listener:Ue})=>{pt.forEach((He=>{var mt;(mt=He.current)===null||mt===void 0||mt.addEventListener(We,Ue)}))})),()=>{var We,Ue;Zt.scroll&&(window.removeEventListener("scroll",Yt),P?.removeEventListener("scroll",Yt),ee?.removeEventListener("scroll",Yt)),Zt.resize?window.removeEventListener("resize",Yt):W?.(),Zt.clickOutsideAnchor&&window.removeEventListener("click",et),Zt.escape&&window.removeEventListener("keydown",K),Ke&&((We=Z.current)===null||We===void 0||We.removeEventListener("mouseover",Ee),(Ue=Z.current)===null||Ue===void 0||Ue.removeEventListener("mouseout",Be)),q.forEach((({event:He,listener:mt})=>{pt.forEach((Vt=>{var Wt;(Wt=Vt.current)===null||Wt===void 0||Wt.removeEventListener(He,mt)}))}))}}),[I,Ze,Fe,Nt,qt,D,H,L,ut,k,w]),C.useEffect((()=>{var Ve,Ge;let pt=(Ge=(Ve=De?.anchorSelect)!==null&&Ve!==void 0?Ve:l)!==null&&Ge!==void 0?Ge:"";!pt&&n&&(pt=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const Ft=new MutationObserver((Yt=>{const P=[],ee=[];Yt.forEach((W=>{if(W.type==="attributes"&&W.attributeName==="data-tooltip-id"&&(W.target.getAttribute("data-tooltip-id")===n?P.push(W.target):W.oldValue===n&&ee.push(W.target)),W.type==="childList"){if(I){const K=[...W.removedNodes].filter((q=>q.nodeType===1));if(pt)try{ee.push(...K.filter((q=>q.matches(pt)))),ee.push(...K.flatMap((q=>[...q.querySelectorAll(pt)])))}catch{}K.some((q=>{var ne;return!!(!((ne=q?.contains)===null||ne===void 0)&&ne.call(q,I))&&(Re(!1),$t(!1),j(null),Mn(xe),Mn(M),!0)}))}if(pt)try{const K=[...W.addedNodes].filter((q=>q.nodeType===1));P.push(...K.filter((q=>q.matches(pt)))),P.push(...K.flatMap((q=>[...q.querySelectorAll(pt)])))}catch{}}})),(P.length||ee.length)&&Bt((W=>[...W.filter((K=>!ee.includes(K))),...P]))}));return Ft.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{Ft.disconnect()}}),[n,l,De?.anchorSelect,I]),C.useEffect((()=>{Ze()}),[Ze]),C.useEffect((()=>{if(!G?.current)return()=>null;const Ve=new ResizeObserver((()=>{setTimeout((()=>Ze()))}));return Ve.observe(G.current),()=>{Ve.disconnect()}}),[pe,G?.current]),C.useEffect((()=>{var Ve;const Ge=document.querySelector(`[id='${o}']`),pt=[...qt,Ge];I&&pt.includes(I)||j((Ve=qt[0])!==null&&Ve!==void 0?Ve:Ge)}),[o,qt,I]),C.useEffect((()=>(B&&$t(!0),()=>{Mn(xe),Mn(M)})),[]),C.useEffect((()=>{var Ve;let Ge=(Ve=De?.anchorSelect)!==null&&Ve!==void 0?Ve:l;if(!Ge&&n&&(Ge=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),Ge)try{const pt=Array.from(document.querySelectorAll(Ge));Bt(pt)}catch{Bt([])}}),[n,l,De?.anchorSelect]),C.useEffect((()=>{xe.current&&(Mn(xe),Oe(k))}),[k]);const tt=(J=De?.content)!==null&&J!==void 0?J:pe,ct=Pe&&Object.keys(ye.tooltipStyles).length>0;return C.useImperativeHandle(e,(()=>({open:Ve=>{if(Ve?.anchorSelect)try{document.querySelector(Ve.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ve.anchorSelect}" is not a valid CSS selector`)}lt(Ve??null),Ve?.delay?Oe(Ve.delay):$t(!0)},close:Ve=>{Ve?.delay?Ie(Ve.delay):$t(!1)},activeAnchor:I,place:ye.place,isOpen:!!(Fe&&!E&&tt&&ct)}))),Fe&&!E&&tt?Te.createElement(v,{id:n,role:R,className:Gf("react-tooltip",qo.tooltip,wf.tooltip,wf[a],t,`react-tooltip__place-${ye.place}`,qo[ct?"show":"closing"],ct?"react-tooltip__show":"react-tooltip__closing",m==="fixed"&&qo.fixed,S&&qo.clickable),onTransitionEnd:Ve=>{Mn(ve),Pe||Ve.propertyName!=="opacity"||(Re(!1),lt(null),le?.())},style:{...Q,...ye.tooltipStyles,opacity:T!==void 0&&ct?T:void 0},ref:Z},tt,Te.createElement(v,{className:Gf("react-tooltip-arrow",qo.arrow,wf.arrow,r,N&&qo.noArrow),style:{...ye.tooltipArrowStyles,background:F?`linear-gradient(to right bottom, transparent 50%, ${F} 50%)`:void 0,"--rt-arrow-size":`${O}px`},ref:U})):null},qO=({content:e})=>Te.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),ti=Te.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:h="top",offset:p=10,wrapper:m="div",children:g=null,events:v=["hover"],openOnClick:k=!1,positionStrategy:w="absolute",middlewares:b,delayShow:E=0,delayHide:N=0,float:S=!1,hidden:z=!1,noArrow:te=!1,clickable:V=!1,closeOnEsc:D=!1,closeOnScroll:H=!1,closeOnResize:L=!1,openEvents:ae,closeEvents:Q,globalCloseEvents:Y,imperativeModeOnly:ue=!1,style:le,position:oe,isOpen:pe,defaultIsOpen:G=!1,disableStyleInjection:ie=!1,border:B,opacity:de,arrowColor:I,arrowSize:j,setIsOpen:re,afterShow:T,afterHide:F,disableTooltip:O,role:R="tooltip"},J)=>{const[Z,U]=C.useState(r),[xe,M]=C.useState(a),[ve,ye]=C.useState(h),[Me,Pe]=C.useState(f),[ce,Fe]=C.useState(p),[Re,De]=C.useState(E),[lt,ft]=C.useState(N),[gt,Nt]=C.useState(S),[zt,Qt]=C.useState(z),[qt,Bt]=C.useState(m),[rr,ut]=C.useState(v),[_t,Ht]=C.useState(w),[Dt,Zt]=C.useState(null),[$t,he]=C.useState(null),Oe=C.useRef(ie),{anchorRefs:Ie,activeAnchor:X}=mw(e),me=dt=>dt?.getAttributeNames().reduce(((Et,qe)=>{var Ze;return qe.startsWith("data-tooltip-")&&(Et[qe.replace(/^data-tooltip-/,"")]=(Ze=dt?.getAttribute(qe))!==null&&Ze!==void 0?Ze:null),Et}),{}),Ne=dt=>{const Et={place:qe=>{var Ze;ye((Ze=qe)!==null&&Ze!==void 0?Ze:h)},content:qe=>{U(qe??r)},html:qe=>{M(qe??a)},variant:qe=>{var Ze;Pe((Ze=qe)!==null&&Ze!==void 0?Ze:f)},offset:qe=>{Fe(qe===null?p:Number(qe))},wrapper:qe=>{var Ze;Bt((Ze=qe)!==null&&Ze!==void 0?Ze:m)},events:qe=>{const Ze=qe?.split(" ");ut(Ze??v)},"position-strategy":qe=>{var Ze;Ht((Ze=qe)!==null&&Ze!==void 0?Ze:w)},"delay-show":qe=>{De(qe===null?E:Number(qe))},"delay-hide":qe=>{ft(qe===null?N:Number(qe))},float:qe=>{Nt(qe===null?S:qe==="true")},hidden:qe=>{Qt(qe===null?z:qe==="true")},"class-name":qe=>{Zt(qe)}};Object.values(Et).forEach((qe=>qe(null))),Object.entries(dt).forEach((([qe,Ze])=>{var tt;(tt=Et[qe])===null||tt===void 0||tt.call(Et,Ze)}))};C.useEffect((()=>{U(r)}),[r]),C.useEffect((()=>{M(a)}),[a]),C.useEffect((()=>{ye(h)}),[h]),C.useEffect((()=>{Pe(f)}),[f]),C.useEffect((()=>{Fe(p)}),[p]),C.useEffect((()=>{De(E)}),[E]),C.useEffect((()=>{ft(N)}),[N]),C.useEffect((()=>{Nt(S)}),[S]),C.useEffect((()=>{Qt(z)}),[z]),C.useEffect((()=>{Ht(w)}),[w]),C.useEffect((()=>{Oe.current!==ie&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[ie]),C.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:ie==="core",disableBase:ie}}))}),[]),C.useEffect((()=>{var dt;const Et=new Set(Ie);let qe=t;if(!qe&&e&&(qe=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),qe)try{document.querySelectorAll(qe).forEach((Ge=>{Et.add({current:Ge})}))}catch{console.warn(`[react-tooltip] "${qe}" is not a valid CSS selector`)}const Ze=document.querySelector(`[id='${n}']`);if(Ze&&Et.add({current:Ze}),!Et.size)return()=>null;const tt=(dt=$t??Ze)!==null&&dt!==void 0?dt:X.current,ct=new MutationObserver((Ge=>{Ge.forEach((pt=>{var Ft;if(!tt||pt.type!=="attributes"||!(!((Ft=pt.attributeName)===null||Ft===void 0)&&Ft.startsWith("data-tooltip-")))return;const Yt=me(tt);Ne(Yt)}))})),Ve={attributes:!0,childList:!1,subtree:!1};if(tt){const Ge=me(tt);Ne(Ge),ct.observe(tt,Ve)}return()=>{ct.disconnect()}}),[Ie,X,$t,n,t]),C.useEffect((()=>{le?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),B&&!Fv("border",`${B}`)&&console.warn(`[react-tooltip] "${B}" is not a valid \`border\`.`),le?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),de&&!Fv("opacity",`${de}`)&&console.warn(`[react-tooltip] "${de}" is not a valid \`opacity\`.`)}),[]);let Ae=g;const et=C.useRef(null);if(o){const dt=o({content:$t?.getAttribute("data-tooltip-content")||Z||null,activeAnchor:$t});Ae=dt?Te.createElement("div",{ref:et,className:"react-tooltip-content-wrapper"},dt):null}else Z&&(Ae=Z);xe&&(Ae=Te.createElement(qO,{content:xe}));const at={forwardRef:J,id:e,anchorId:n,anchorSelect:t,className:Gf(l,Dt),classNameArrow:c,content:Ae,contentWrapperRef:et,place:ve,variant:Me,offset:ce,wrapper:qt,events:rr,openOnClick:k,positionStrategy:_t,middlewares:b,delayShow:Re,delayHide:lt,float:gt,hidden:zt,noArrow:te,clickable:V,closeOnEsc:D,closeOnScroll:H,closeOnResize:L,openEvents:ae,closeEvents:Q,globalCloseEvents:Y,imperativeModeOnly:ue,style:le,position:oe,isOpen:pe,defaultIsOpen:G,border:B,opacity:de,arrowColor:I,arrowSize:j,setIsOpen:re,afterShow:T,afterHide:F,disableTooltip:O,activeAnchor:$t,setActiveAnchor:dt=>he(dt),role:R};return Te.createElement(QO,{...at})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Nv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Nv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));const ZO="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",gw=({isOpen:e,onClose:n,product:t})=>t?u.jsx(dr,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[u.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:u.jsx(Ct,{size:24})}),u.jsx("h2",{className:"text-xl font-semibold mb-4",children:" "}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.nazwa]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.ilosc]}),u.jsxs("p",{children:[u.jsx("strong",{children:". :"})," ",t.jednostka_miary]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod_kreskowy]}),t.data_waznosci&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.data_waznosci]}),t.waga_netto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_netto," "]}),t.waga_brutto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_brutto," "]}),t.objetosc&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.objetosc," "]}),t.opis&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.opis]})]})]})}):null,Ua="",vw=({isOpen:e,onClose:n,receipt:t})=>{const[r]=Te.useState(null),[a,o]=Te.useState(!1),[l,c]=Te.useState({x:0,y:0}),[f,h]=Te.useState(!1),p=Te.useRef({x:0,y:0});Te.useEffect(()=>{const v=w=>{f&&c({x:w.clientX-p.current.x,y:w.clientY-p.current.y})},k=()=>h(!1);return f&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",k)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",k)}},[f]);const m=v=>{v.target.closest("button")||v.target.closest("input")||(h(!0),p.current={x:v.clientX-l.x,y:v.clientY-l.y})};if(!t)return null;let g=[];if(Array.isArray(t.products))g=t.products;else if(typeof t.products=="string")try{g=JSON.parse(t.products)}catch{g=[]}return u.jsxs(dr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${l.x}px), calc(-50% + ${l.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:m,style:{cursor:f?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy zakupu"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Warto"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," "]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," "]})]})]}),(t.productInvoice||t.transportInvoice)&&u.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ua}/uploads/${t.productInvoice}`;console.log(" Opening product invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(ep,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ua}/uploads/${t.transportInvoice}`;console.log(" Opening transport invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(Zf,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),u.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),u.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilo"}),u.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),u.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Warto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data wanoci"})]})}),u.jsx("tbody",{children:g.map((v,k)=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.kod}),u.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:v.nazwa}),u.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:v.kod_kreskowy||"-"}),u.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:v.ilosc}),u.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[v.cena," "]}),u.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(v.ilosc*v.cena).toFixed(2).replace(".",",")," "]}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const w=v.typ;return w?{czerwone:"Czerwone",biale:"Biae",musujace:"Musujce",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment",rozowe:"Rowe",slodkie:"Sodkie",aksesoria:"Aksesoria",amber:"Amber"}[w]||w:"-"})()}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.objetosc||"-"}),u.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:v.dataWaznosci?typeof v.dataWaznosci=="number"?new Date(v.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(v.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},k))})]})]})]}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),u.jsx(gw,{isOpen:a,onClose:()=>o(!1),product:r})]})},JO=({isOpen:e,onClose:n,onAdd:t,initialData:r})=>{const[a,o]=C.useState(""),[l,c]=C.useState(""),[f,h]=C.useState(""),[p,m]=C.useState(""),[g,v]=C.useState("");C.useEffect(()=>{console.log(" useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log(" Setting initial data from props"),o(r.firma),c(r.nazwa),h(r.adres),m(r.czas_dostawy),v(r.kontakt)):e&&!r&&console.log(" Modal opened without initial data - keeping current values")},[e,r]);const k=()=>{if(console.log(" handleSubmit called with values:",{firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g}),console.log(" Trimmed values:",{firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()}),!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()){console.log(" Validation failed: some fields are empty");return}const b={firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()};console.log(" Submitting client data:",b),t(b),w()},w=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(dr,{isOpen:e,onRequestClose:w,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),u.jsx("button",{onClick:w,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:b=>{console.log(" firma onChange:",b.target.value),o(b.target.value)},placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:b=>h(b.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:b=>m(b.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:b=>v(b.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:k,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};Ms("pl",Is);const kf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],Ov=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],yw=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=C.useState(null),[l,c]=C.useState(""),[f,h]=C.useState({x:0,y:0}),[p,m]=C.useState(!1),[g,v]=C.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k=C.useRef({x:0,y:0}),[w,b]=C.useState(""),[E,N]=C.useState(null),[S,z]=C.useState(null),[te,V]=C.useState(null),[D,H]=C.useState(null),L=C.useRef(null),ae=C.useRef(null),[Q,Y]=C.useState(null),[ue,le]=C.useState(null),[oe,pe]=C.useState("0,00"),[G,ie]=C.useState("0,00"),[B,de]=C.useState("0,00"),I=()=>{const ce=g.reduce((Re,De)=>{const lt=parseFloat(De.ilosc.toString().replace(",","."))||0;return Re+lt},0),Fe=parseFloat(w.replace(",","."))||0;return ce>0?(Fe/ce).toFixed(2):"0,00"};C.useEffect(()=>{if(e&&r){let ce=[];if(r.products)if(typeof r.products=="string")try{ce=JSON.parse(r.products)}catch(Fe){console.error("Error parsing products JSON:",Fe),ce=[]}else Array.isArray(r.products)&&(ce=r.products);if(Array.isArray(ce)&&ce.length>0){let Fe=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[De,lt,ft]=r.dataPrzyjecia.split("/");Fe=new Date(parseInt(ft),parseInt(lt)-1,parseInt(De))}else r.dataPrzyjecia.includes("-")?Fe=new Date(r.dataPrzyjecia):Fe=new Date(r.dataPrzyjecia);if(o(Fe),c(r.sprzedawca||""),b((r.kosztDostawy||0).toFixed(2).replace(".",",")),r.aktualny_kurs!==void 0&&r.aktualny_kurs!==null)pe(Number(r.aktualny_kurs).toFixed(2).replace(".",","));else if(r.aktualnyKurs!==void 0&&r.aktualnyKurs!==null)pe(String(r.aktualnyKurs).replace(".",","));else{const De=ce.reduce((Nt,zt)=>Nt+(zt.ilosc||0),0),lt=De?r.kosztDostawy/De:0,ft=ce[0]?.deliveryCostPerUnitPln||0,gt=lt?ft/lt:1;pe(gt.toFixed(2).replace(".",","))}if(r.podatek_akcyzowy!==void 0&&r.podatek_akcyzowy!==null)ie(Number(r.podatek_akcyzowy).toFixed(2).replace(".",","));else if(r.podatekAkcyzowy!==void 0&&r.podatekAkcyzowy!==null)ie(String(r.podatekAkcyzowy).replace(".",","));else{const De=ce[0]?.podatekAkcyzowyPerLiter??ce[0]?.podatekAkcyzowy??ce[0]?.podatek_akcyzowy??0;ie(De.toFixed(2).replace(".",","))}r.rabat!==void 0&&r.rabat!==null?de(Number(r.rabat).toFixed(2).replace(".",",")):de("0,00");const Re=ce.map(De=>({kod:De.kod||"",nazwa:De.nazwa||"",kod_kreskowy:De.kod_kreskowy||De.ean||"",ilosc:(De.ilosc||0).toString(),cena:(De.cena||0).toFixed(2).replace(".",","),dataWaznosci:De.dataWaznosci||"",showDataWaznosci:!1,typ:De.typ||De.typTowaru||"",objetosc:De.objetosc||""}));v(Re.length>0?Re:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),V(r.productInvoice||null),H(r.transportInvoice||null),N(null),z(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),b(""),N(null),z(null),V(null),H(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),b(""),N(null),z(null),V(null),H(null)},[e,r]),C.useEffect(()=>{const ce=Re=>{const De=Re.target;if(!De.closest(".dropdown-container")&&!De.closest('button[onclick*="toggleDropdown"]')&&Y(null),!De.closest(".objetosc-dropdown-container")&&!De.closest('button[onclick*="toggleObjetoscDropdown"]')&&le(null),!De.closest(".react-datepicker")&&!De.closest('button[title*="wanoci"]')){const lt=[...g];let ft=!1;lt.forEach(gt=>{gt.showDataWaznosci&&(gt.showDataWaznosci=!1,ft=!0)}),ft&&v(lt)}},Fe=Re=>{if(Re.key==="Escape"){Y(null),le(null);const De=[...g];let lt=!1;De.forEach(ft=>{ft.showDataWaznosci&&(ft.showDataWaznosci=!1,lt=!0)}),lt&&v(De)}};return document.addEventListener("mousedown",ce),document.addEventListener("keydown",Fe),()=>{document.removeEventListener("mousedown",ce),document.removeEventListener("keydown",Fe)}},[g]);const j=()=>{v([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},re=ce=>{if(g.length>1){const Fe=[...g];Fe.splice(ce,1),v(Fe)}},T=ce=>{const Fe=[...g];Fe[ce].showDataWaznosci=!Fe[ce].showDataWaznosci,v(Fe)},F=(ce,Fe)=>{const Re=[...g];Re[ce].typ=Fe,v(Re),Y(null)},O=ce=>{Y(Q===ce?null:ce)},R=(ce,Fe)=>{const Re=[...g];Re[ce].objetosc=Fe,v(Re),le(null)},J=ce=>{le(ue===ce?null:ce)},Z=ce=>{ce.target.closest("button")||ce.target.closest("input")||ce.target.closest(".react-datepicker")||ce.target.closest('[role="button"]')||ce.target.closest(".react-datepicker__input-container")||(m(!0),k.current={x:ce.clientX-f.x,y:ce.clientY-f.y})};C.useEffect(()=>{const ce=Re=>{p&&requestAnimationFrame(()=>{h({x:Re.clientX-k.current.x,y:Re.clientY-k.current.y})})},Fe=()=>{m(!1)};return p&&(window.addEventListener("mousemove",ce),window.addEventListener("mouseup",Fe)),()=>{window.removeEventListener("mousemove",ce),window.removeEventListener("mouseup",Fe)}},[p]);const U=ce=>{const Fe=ce.target.files?.[0];console.log(" Product file selected (edit):",Fe),Fe&&Fe.type==="application/pdf"?(N(Fe),console.log(" Product invoice set (edit):",Fe.name)):console.log(" Invalid product file type (edit):",Fe?.type)},xe=ce=>{const Fe=ce.target.files?.[0];console.log(" Transport file selected (edit):",Fe),Fe&&Fe.type==="application/pdf"?(z(Fe),console.log(" Transport invoice set (edit):",Fe.name)):console.log(" Invalid transport file type (edit):",Fe?.type)},M=()=>{L.current?.click()},ve=()=>{ae.current?.click()},ye=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const ce=g.filter(gt=>gt.kod&&gt.nazwa&&gt.ilosc&&gt.cena);if(console.log("productRows:",g),console.log("validProducts:",ce),console.log("validProducts.length:",ce.length),ce.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const Fe=ce.map(gt=>({kod:gt.kod,nazwa:gt.nazwa,kod_kreskowy:gt.kod_kreskowy||"",ilosc:parseFloat(gt.ilosc)||0,cena:parseFloat(gt.cena.replace(",","."))||0,dataWaznosci:gt.dataWaznosci||void 0,typ:gt.typ||void 0,objetosc:gt.objetosc?parseFloat(gt.objetosc):void 0})),Re=Fe.reduce((gt,Nt)=>gt+Nt.ilosc*Nt.cena,0),De=parseFloat(w.replace(",","."))||0,lt=parseFloat(B.replace(",","."))||0,ft=Re*(1-lt/100);console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ft,rabat:lt+"%",kosztDostawy:De,products:Fe}),console.log(" Files to submit (edit):",{productInvoice:E,transportInvoice:S}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ft,kosztDostawy:De,aktualnyKurs:parseFloat(oe.replace(",","."))||1,podatekAkcyzowy:parseFloat(G.replace(",","."))||0,rabat:lt,products:Fe,productInvoice:E||null,transportInvoice:S||null}),Me()},Me=()=>{o(null),h({x:0,y:0}),v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),b(""),c(""),N(null),z(null),V(null),H(null),n()},Pe=()=>g.reduce((ce,Fe)=>{const Re=parseFloat(Fe.ilosc)||0,De=parseFloat(Fe.cena.replace(",","."))||0;return ce+Re*De},0).toFixed(2);return u.jsx(dr,{isOpen:e,onRequestClose:Me,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:Z,style:{cursor:p?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:ce=>ce.stopPropagation(),children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),u.jsx("button",{type:"button",onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),Me()},className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx($n,{selected:a,onChange:ce=>o(ce),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:w,onKeyPress:ce=>{const Fe=String.fromCharCode(ce.which);(!/[\d,]/.test(Fe)||Fe===","&&ce.target.value.includes(",")||ce.target.value===""&&Fe===",")&&ce.preventDefault()},onChange:ce=>{const Fe=ce.target,Re=Fe.selectionStart??0;let De=Fe.value.replace(/[^\d,]/g,"");if(De===""){b("");return}if(!De.includes(","))De=De+",00";else{const[ft,gt]=De.split(",");gt&&gt.length>2&&(De=`${ft},${gt.slice(0,2)}`)}b(De),requestAnimationFrame(()=>{const ft=Math.min(Re,De.length);Fe.setSelectionRange(ft,ft)})},className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:U,className:"hidden",ref:L}),u.jsx("button",{type:"button",onClick:M,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),E&&u.jsx("a",{href:URL.createObjectURL(E),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:E.name,children:E.name}),!E&&te&&u.jsx("a",{href:`${Ua}${te}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:xe,className:"hidden",ref:ae}),u.jsx("button",{type:"button",onClick:ve,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Zf,{className:"h-4 w-4 text-gray-500"})}),S&&u.jsx("a",{href:URL.createObjectURL(S),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:S.name,children:S.name}),!S&&D&&u.jsx("a",{href:`${Ua}${D}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:l,onChange:ce=>c(ce.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[I().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:oe,onChange:ce=>pe(ce.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-8 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:G,onChange:ce=>ie(ce.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:B,onChange:ce=>de(ce.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((ce,Fe)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:ce.kod,onChange:Re=>{const De=[...g];De[Fe].kod=Re.target.value,v(De)}}),Fe===g.length-1&&u.jsx("button",{onClick:j,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(_a,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:ce.nazwa,onChange:Re=>{const De=[...g];De[Fe].nazwa=Re.target.value,v(De)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:ce.kod_kreskowy,onChange:Re=>{const De=[...g];De[Fe].kod_kreskowy=Re.target.value,v(De)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:ce.ilosc,onChange:Re=>{const De=[...g],lt=Re.target.value;(lt===""||/^\d*$/.test(lt))&&(De[Fe].ilosc=lt,v(De))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:ce.cena,onKeyPress:Re=>{const De=String.fromCharCode(Re.which);(!/[\d,]/.test(De)||De===","&&Re.target.value.includes(",")||Re.target.value===""&&De===",")&&Re.preventDefault()},onChange:Re=>{const De=Re.target,lt=De.selectionStart??0;let ft=Re.target.value.replace(/[^\d,]/g,"");if(ft===""){const zt=[...g];zt[Fe].cena="",v(zt);return}if(!ft.includes(","))ft=ft+",00";else{const[zt,Qt]=ft.split(",");Qt&&Qt.length>2&&(ft=`${zt},${Qt.slice(0,2)}`)}const Nt=[...g];Nt[Fe].cena=ft,v(Nt),requestAnimationFrame(()=>{const zt=Math.min(lt,ft.length);De.setSelectionRange(zt,zt)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const Re=parseFloat(ce.ilosc)||0,De=parseFloat(ce.cena.replace(",","."))||0;return(Re*De).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>T(Fe),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${ce.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:ce.dataWaznosci?`Termin wanoci: ${ce.dataWaznosci}`:"Dodaj termin wanoci",children:u.jsx(qf,{size:16})}),u.jsx("button",{onClick:()=>re(Fe),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(Ct,{size:16})})]}),ce.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx($n,{selected:ce.dataWaznosci?new Date(ce.dataWaznosci):null,onChange:Re=>{const De=[...g];De[Fe].dataWaznosci=Re?Re.toISOString().split("T")[0]:"",De[Fe].showDataWaznosci=!1,v(De)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const Re=[...g];Re[Fe].showDataWaznosci=!1,v(Re)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>O(Fe),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${ce.typ&&kf.find(Re=>Re.value===ce.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:ce.typ&&kf.find(Re=>Re.value===ce.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Q===Fe&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:Re=>Re.stopPropagation(),children:kf.map(Re=>u.jsx("button",{type:"button",onClick:()=>F(Fe,Re.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${Re.color}`,children:Re.label},Re.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Fe>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>J(Fe),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${ce.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:ce.objetosc?Ov.find(Re=>Re.value===ce.objetosc)?.label||ce.objetosc:"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ue===Fe&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:Re=>Re.stopPropagation(),style:{maxWidth:"200px"},children:Ov.map(Re=>u.jsx("button",{type:"button",onClick:()=>R(Fe,Re.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:Re.label},Re.value))})]})]})]},Fe))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[Pe().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:ye,disabled:!a||!g.some(ce=>ce.kod&&ce.nazwa&&ce.ilosc&&ce.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(ce=>ce.kod&&ce.nazwa&&ce.ilosc&&ce.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},eR=({receipts:e,onDelete:n,onUpdate:t,selectedCategory:r=""})=>{const[a,o]=C.useState(null),[l,c]=C.useState(!1),[f,h]=C.useState(!1),[p,m]=C.useState(null),[g,v]=C.useState(!1),[k,w]=C.useState(null),[b,E]=C.useState(""),[N,S]=C.useState({x:0,y:0}),[z,te]=C.useState(!1),V=C.useRef({x:0,y:0}),[D,H]=C.useState("dataPrzyjecia"),[L,ae]=C.useState("desc"),[Q,Y]=C.useState(""),[ue,le]=C.useState(""),oe=R=>{o(R),c(!0)},pe=R=>{m(R),h(!0)},G=R=>{w(R),v(!0),E("")},ie=()=>{b==="5202"?(k?.id&&(n(k.id),Xe.success("Zapis zosta usunity")),B()):(Xe.error("Nieprawidowe haso"),E(""))},B=()=>{v(!1),w(null),E(""),S({x:0,y:0})},de=R=>{R.key==="Enter"&&ie()},I=R=>{D===R?ae(L==="asc"?"desc":"asc"):(H(R),ae("asc"))},j=R=>{R.target.closest("button")||R.target.closest("input")||(te(!0),V.current={x:R.clientX-N.x,y:R.clientY-N.y})};C.useEffect(()=>{const R=Z=>{z&&requestAnimationFrame(()=>{S({x:Z.clientX-V.current.x,y:Z.clientY-V.current.y})})},J=()=>{te(!1)};return z&&(window.addEventListener("mousemove",R),window.addEventListener("mouseup",J)),()=>{window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",J)}},[z]);const re=Array.from(new Set(e.map(R=>new Date(R.dataPrzyjecia).getFullYear().toString()))).sort((R,J)=>parseInt(J)-parseInt(R)),T=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],O=e.filter(R=>{if(r)if(typeof R.products=="string")try{if(!JSON.parse(R.products).some(U=>U.typ===r))return!1}catch{return!1}else if(Array.isArray(R.products)){if(!R.products.some(Z=>Z.typ===r))return!1}else return!1;return!(Q&&new Date(R.dataPrzyjecia).getFullYear().toString()!==Q||ue&&(new Date(R.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==ue)}).sort((R,J)=>{let Z,U;switch(D){case"dataPrzyjecia":Z=new Date(R.dataPrzyjecia),U=new Date(J.dataPrzyjecia);break;case"sprzedawca":Z=(R.sprzedawca||"").toLowerCase(),U=(J.sprzedawca||"").toLowerCase();break;case"wartosc":Z=R.wartosc,U=J.wartosc;break;case"kosztDostawy":Z=R.kosztDostawy,U=J.kosztDostawy;break;default:Z=R[D]||"",U=J[D]||""}return typeof Z=="string"&&typeof U=="string"?L==="asc"?Z.localeCompare(U):U.localeCompare(Z):typeof Z=="number"&&typeof U=="number"?L==="asc"?Z-U:U-Z:Z instanceof Date&&U instanceof Date?L==="asc"?Z.getTime()-U.getTime():U.getTime()-Z.getTime():0});return u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("dataPrzyjecia"),children:"Data zakupu"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("sprzedawca"),children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("wartosc"),children:"Warto"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("kosztDostawy"),children:"Koszt dostawy"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:Q,onChange:R=>Y(R.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),re.map(R=>u.jsx("option",{value:R,style:{fontFamily:"Sora, sans-serif"},children:R},R))]}),u.jsxs("select",{value:ue,onChange:R=>le(R.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Msc"}),T.map(R=>u.jsx("option",{value:R.value,style:{fontFamily:"Sora, sans-serif"},children:R.label},R.value))]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(R=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:R.dataPrzyjecia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:R.sprzedawca}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[R.wartosc.toFixed(2)," "]}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[R.kosztDostawy.toFixed(2)," "]}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:J=>{J.preventDefault(),J.stopPropagation(),oe(R)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(Jf,{size:16})}),u.jsx("button",{type:"button",onClick:J=>{J.preventDefault(),J.stopPropagation(),pe(R)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Al,{size:16})}),u.jsx("button",{type:"button",onClick:J=>{J.preventDefault(),J.stopPropagation(),G(R)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Ct,{size:16})})]})})]},R.id))})]})}),u.jsx(dr,{isOpen:g,onRequestClose:B,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${N.x}px), calc(-50% + ${N.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:j,style:{cursor:z?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:B,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:b,onChange:R=>E(R.target.value),onKeyPress:de,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:B,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:ie,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(vw,{isOpen:l,onClose:()=>c(!1),receipt:a}),u.jsx(yw,{isOpen:f,onClose:()=>{h(!1),m(null)},onSubmit:R=>{t({...R,productInvoice:R.productInvoice??void 0,transportInvoice:R.transportInvoice??void 0}),h(!1),m(null)},receipt:p?{id:p.id||0,dataPrzyjecia:p.dataPrzyjecia,sprzedawca:p.sprzedawca,wartosc:p.wartosc,kosztDostawy:p.kosztDostawy,aktualnyKurs:p.aktualnyKurs,podatekAkcyzowy:p.podatekAkcyzowy,aktualny_kurs:p.aktualny_kurs,podatek_akcyzowy:p.podatek_akcyzowy,products:p.products,productInvoice:p.productInvoice,transportInvoice:p.transportInvoice}:null})]})},tR=({isOpen:e,onClose:n,client:t})=>t?u.jsx(dr,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy klienta"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,ww=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=C.useState(""),[l,c]=C.useState(""),[f,h]=C.useState(""),[p,m]=C.useState(""),[g,v]=C.useState("");C.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),h(r.adres||""),m(r.czas_dostawy||""),v(r.kontakt||"")):(o(""),c(""),h(""),m(""),v(""))},[e,r]);const k=async()=>{if(a.trim()&&l.trim()&&f.trim()&&p.trim()&&g.trim()&&r){const b={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g};t(b),w()}},w=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(dr,{isOpen:e,onRequestClose:w,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),u.jsx("button",{onClick:w,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:b=>o(b.target.value),placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:b=>h(b.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:b=>m(b.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:b=>v(b.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:k,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},rR=({clients:e,onDelete:n,onUpdate:t})=>{console.log(" ClientsList render - clients:",e),console.log(" ClientsList render - clients length:",e.length),console.log(" ClientsList render - first client:",e[0]),console.log(" ClientsList render - all clients:",e.map(B=>({id:B.id,firma:B.firma,nazwa:B.nazwa})));const[r,a]=C.useState(null),[o,l]=C.useState(!1),[c,f]=C.useState(!1),[h,p]=C.useState(null),[m,g]=C.useState(!1),[v,k]=C.useState(null),[w,b]=C.useState(""),[E,N]=C.useState({x:0,y:0}),[S,z]=C.useState(!1),te=C.useRef({x:0,y:0}),[V,D]=C.useState(""),[H,L]=C.useState("asc");C.useEffect(()=>{console.log(" ClientsList useEffect - clients changed:",e),console.log(" ClientsList useEffect - clients length:",e.length)},[e]);const ae=B=>{a(B),l(!0)},Q=B=>{p(B),f(!0)},Y=B=>{k(B),g(!0),b("")},ue=()=>{w==="5202"?(v?.id&&n(v.id),le()):(Xe.error("Nieprawidowe haso"),b(""))},le=()=>{g(!1),k(null),b(""),N({x:0,y:0})},oe=B=>{B.key==="Enter"&&ue()},pe=B=>{V===B?L(H==="asc"?"desc":"asc"):(D(B),L("asc"))},G=B=>{B.target.closest("button")||B.target.closest("input")||(z(!0),te.current={x:B.clientX-E.x,y:B.clientY-E.y})};C.useEffect(()=>{const B=I=>{S&&requestAnimationFrame(()=>{N({x:I.clientX-te.current.x,y:I.clientY-te.current.y})})},de=()=>{z(!1)};return S&&(window.addEventListener("mousemove",B),window.addEventListener("mouseup",de)),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",de)}},[S]),console.log(" Sorting logic - sortField:",V,"sortDirection:",H),console.log(" Sorting logic - clients length:",e.length);const ie=V?[...e].sort((B,de)=>{let I,j;switch(V){case"firma":I=(B.firma||"").toLowerCase(),j=(de.firma||"").toLowerCase();break;case"nazwa":I=(B.nazwa||"").toLowerCase(),j=(de.nazwa||"").toLowerCase();break;case"adres":I=(B.adres||"").toLowerCase(),j=(de.adres||"").toLowerCase();break;case"czas_dostawy":I=(B.czas_dostawy||"").toLowerCase(),j=(de.czas_dostawy||"").toLowerCase();break;case"kontakt":I=(B.kontakt||"").toLowerCase(),j=(de.kontakt||"").toLowerCase();break;default:I=B[V]||"",j=de[V]||""}return typeof I=="string"&&typeof j=="string"?H==="asc"?I.localeCompare(j):j.localeCompare(I):0}):e;return console.log(" Final sortedClients length:",ie.length),console.log(" Final sortedClients first:",ie[0]),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${V==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>pe("firma"),children:["Nazwa firmy ",V==="firma"&&(H==="asc"?"":"")]}),u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${V==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>pe("nazwa"),children:["Nazwa ",V==="nazwa"&&(H==="asc"?"":"")]}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("adres"),children:"Adres"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("czas_dostawy"),children:"Czas dostawy"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("kontakt"),children:"Kontakt"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:V&&u.jsx("button",{onClick:()=>{D(""),L("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:" ",children:""})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map((B,de)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.firma}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.nazwa}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.adres}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.czas_dostawy}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:B.kontakt}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),ae(B)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(Jf,{size:16})}),u.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),Q(B)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Al,{size:16})}),u.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),Y(B)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Ct,{size:16})})]})})]},B.id||`client-${de}`))})]})}),u.jsx(dr,{isOpen:m,onRequestClose:le,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${E.x}px), calc(-50% + ${E.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:G,style:{cursor:S?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:le,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:w,onChange:B=>b(B.target.value),onKeyPress:oe,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:le,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:ue,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(tR,{isOpen:o,onClose:()=>l(!1),client:r}),u.jsx(ww,{isOpen:c,onClose:()=>{f(!1),p(null)},onSubmit:B=>{t(B),f(!1),p(null)},client:h})]})};Ms("pl",Is);const bf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],nR=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],aR=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=C.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:"",koszt_dostawy_per_unit:"",podatek_akcyzowy_per_liter:"2.22",kurs:"4.25"}),[l,c]=C.useState(!1),[f,h]=C.useState(!1),[p,m]=C.useState(!1),[g,v]=C.useState(!1),[k,w]=C.useState(null);C.useEffect(()=>{if(t)if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const D=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(D).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():"",koszt_dostawy_per_unit:t.koszt_dostawy_per_unit?t.koszt_dostawy_per_unit.toString():"",podatek_akcyzowy_per_liter:t.podatek_akcyzowy&&t.objetosc&&t.objetosc>0?(t.podatek_akcyzowy/t.objetosc).toFixed(2):"2.22",kurs:"4.25"}),t.data_waznosci){let D;if(typeof t.data_waznosci=="string")D=new Date(t.data_waznosci);else{const H=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;D=new Date(H)}w(isNaN(D.getTime())?null:D)}else w(null)},[t]);const b=D=>{o(H=>({...H,typ:D})),h(!1)},E=()=>{h(!f)},N=D=>{o(H=>({...H,objetosc:D})),m(!1)},S=()=>{m(!p)},z=()=>{v(!g)},te=D=>{w(D),o(H=>({...H,data_waznosci:D?D.toISOString().split("T")[0]:""})),v(!1)};C.useEffect(()=>{const D=L=>{const ae=L.target;f&&!ae.closest(".dropdown-container")&&h(!1),p&&!ae.closest(".dropdown-container")&&m(!1),g&&!ae.closest(".react-datepicker")&&!ae.closest('button[title*="wanoci"]')&&v(!1)},H=L=>{L.key==="Escape"&&(h(!1),m(!1),v(!1))};return(f||p||g)&&(document.addEventListener("mousedown",D),document.addEventListener("keydown",H)),()=>{document.removeEventListener("mousedown",D),document.removeEventListener("keydown",H)}},[f,p,g]);const V=async D=>{if(D&&D.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(String(a.objetosc||"0").replace(",","."))||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(String(a.cena||"0").replace(",","."))||void 0,cena_sprzedazy:parseFloat(String(a.cena_sprzedazy||"0").replace(",","."))||void 0,koszt_dostawy_per_unit:parseFloat(String(a.koszt_dostawy_per_unit||"0").replace(",","."))||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(String(a.podatek_akcyzowy_per_liter||"0").replace(",","."))*parseFloat(String(a.objetosc||"0").replace(",",".")):void 0,kurs:parseFloat(a.kurs)||4.25})})).ok)throw new Error("Failed to update item");const L={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0,koszt_dostawy_per_unit:parseFloat(a.koszt_dostawy_per_unit)||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(a.podatek_akcyzowy_per_liter)*parseFloat(a.objetosc):void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(ae){console.error("Error creating price history record:",ae)}r(L),Xe.success("Pozycja zostaa zaktualizowana pomylnie"),n()}catch(H){console.error("Error updating item:",H),Xe.error("Bd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:u.jsx(dr,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycj"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("form",{onSubmit:V,className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),u.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-[2]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:a.sprzedawca,onChange:D=>o(H=>({...H,sprzedawca:D.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:E,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&bf.find(D=>D.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:a.typ&&bf.find(D=>D.value===a.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:D=>D.stopPropagation(),children:bf.map(D=>u.jsx("button",{type:"button",onClick:()=>b(D.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${D.color}`,children:D.label},D.value))})]})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:S,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[u.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:D=>D.stopPropagation(),children:nR.map(D=>u.jsx("button",{type:"button",onClick:()=>N(D.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:D.label},D.value))})]})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data wanoci"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:k?k.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz dat",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),u.jsx("button",{type:"button",onClick:z,className:`p-1 focus:outline-none ${k?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:k?`Termin wanoci: ${k.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(qf,{size:16})})]}),g&&u.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:u.jsx($n,{selected:k,onChange:te,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>v(!1)})})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa ()"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:D=>o(H=>({...H,cena:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzeday (z)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:D=>o(H=>({...H,cena_sprzedazy:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]}),u.jsx("div",{className:"flex gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kurs walutowy"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.kurs,onChange:D=>o(H=>({...H,kurs:D.target.value})),placeholder:"4.25",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.koszt_dostawy_per_unit,onChange:D=>o(H=>({...H,koszt_dostawy_per_unit:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.podatek_akcyzowy_per_liter,onChange:D=>o(H=>({...H,podatek_akcyzowy_per_liter:D.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:V,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},sR=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .resizable-table {
    table-layout: fixed !important;
    width: max-content !important;
    min-width: 100% !important;
  }
  
  .resizable-table th,
  .resizable-table td {
    box-sizing: border-box !important;
    overflow: visible !important;
  }
  
  /* no generic resizable columns */
`,_f=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],Rv=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}return""}catch(n){return console.error("Error extracting date from order number:",n),""}},Sf=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},oR=({refreshTrigger:e,productReceipts:n=[]})=>{C.useEffect(()=>{const X=document.createElement("style");return X.textContent=sR,document.head.appendChild(X),()=>{document.head.removeChild(X)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=C.useState([]),[a,o]=C.useState([]),[l,c]=C.useState([]),[f,h]=C.useState(!0),[p,m]=C.useState(null),[g,v]=C.useState(!1),[k,w]=C.useState(null),[b,E]=C.useState(""),[N,S]=C.useState(""),[z,te]=C.useState(()=>localStorage.getItem("sortField")||"nazwa"),[V,D]=C.useState(()=>localStorage.getItem("sortDirection")||"asc"),[H,L]=C.useState([]),[ae,Q]=C.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[Y,ue]=C.useState(!1),[le,oe]=C.useState(null),[pe,G]=C.useState({}),[ie,B]=C.useState({}),[de,I]=C.useState({}),[j,re]=C.useState({}),[T,F]=C.useState(()=>{const X=localStorage.getItem("columnWidths");if(X)try{return JSON.parse(X)}catch(me){console.error("Error parsing saved column widths:",me)}return{nazwa:250}}),[O,R]=C.useState(null),[J,Z]=C.useState(0),[U,xe]=C.useState(0),[M,ve]=C.useState(!1),ye=C.useRef(null),Me=C.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const X=new Map;try{for(const me of n)if(Array.isArray(me.products))for(const Ne of me.products)Ne.kod&&!X.has(Ne.kod)&&X.set(Ne.kod,me.sprzedawca)}catch(me){console.error("Error building sprzedawcaCache:",me)}return console.log("sprzedawcaCache built with",X.size,"entries"),X},[n]),Pe=C.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const X=new Map;try{const me=Ne=>{let Ae=null;return n.forEach(et=>{if(Array.isArray(et.products)&&et.products.some(at=>at.kod===Ne)){const at=new Date(et.dataPrzyjecia);(!Ae||at<Ae)&&(Ae=at)}}),a.forEach(et=>{if(et.kod===Ne){let at=null;et.numer_zamowienia&&(at=Sf(et.numer_zamowienia)),!at&&et.created_at&&(at=new Date(et.created_at)),at&&(!Ae||at<Ae)&&(Ae=at)}}),Ae};for(const Ne of t){const Ae=me(Ne.kod);if(Ae){const at=Math.max(1,Math.ceil((new Date().getTime()-Ae.getTime())/(1e3*60*60*24))),dt=a.filter(Et=>Et.kod!==Ne.kod?!1:Et.numer_zamowienia?Sf(Et.numer_zamowienia)!==null:Et.created_at!==null).reduce((Et,qe)=>Et+qe.ilosc,0);X.set(Ne.kod,dt/at)}else X.set(Ne.kod,0)}}catch(me){console.error("Error building averageSalesCache:",me)}return console.log("averageSalesCache built with",X.size,"entries"),X},[t,a,n]),ce=async()=>{try{const X=await fetch("/api/products");if(X.ok){const me=await X.json(),Ne={};me.forEach(Ae=>{Ae.status!=="samples"&&(Ne[Ae.kod]||(Ne[Ae.kod]=[]),Ne[Ae.kod].push({cena:Ae.cena,ilosc_aktualna:Ae.ilosc_aktualna,data_zmiany:Ae.updated_at||Ae.created_at}))}),Object.keys(Ne).forEach(Ae=>{Ne[Ae].sort((et,at)=>new Date(at.data_zmiany).getTime()-new Date(et.data_zmiany).getTime())}),G(Ne)}}catch(X){console.error("Error loading all products:",X)}},Fe=X=>{const me=a.filter(Ae=>Ae.kod===X);if(me.length===0)return null;let Ne=null;return me.forEach(Ae=>{let et=null;Ae.numer_zamowienia&&(et=Sf(Ae.numer_zamowienia)),!et&&Ae.created_at&&(et=new Date(Ae.created_at)),et&&(!Ne||et>Ne)&&(Ne=et)}),Ne},Re=async()=>{try{console.log("Starting loadInventory..."),h(!0),m(null),console.log("Fetching working-sheets...");const X=await fetch("/api/working-sheets");if(!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const me=await X.json();console.log("Inventory data from server:",me.length,"items"),me.length>0&&(console.log("First item keys:",Object.keys(me[0])),console.log("First item typ value:",me[0].typ),me[0].data_waznosci&&(console.log("First item data_waznosci:",me[0].data_waznosci),console.log("First item data_waznosci type:",typeof me[0].data_waznosci),console.log("First item data_waznosci formatted:",Oe(me[0].data_waznosci)))),r(me),console.log("Fetching orders...");const Ne=await fetch("/api/orders");if(!Ne.ok)throw new Error(`HTTP error! status: ${Ne.status}`);const Ae=await Ne.json();console.log("Orders data from server:",Ae.length,"items"),c(Ae),console.log("Fetching orders-with-products...");const et=await fetch("/api/orders-with-products");if(!et.ok)throw new Error(`HTTP error! status: ${et.status}`);const at=await et.json();console.log("Orders with products from server:",at.length,"items");const dt=[];at.forEach(Ze=>{Ze.products&&Ze.products.forEach(tt=>{dt.push({...tt,orderId:Ze.id,created_at:tt.created_at||Ze.data_utworzenia,numer_zamowienia:Ze.numer_zamowienia})})}),console.log("Total order products:",dt.length),o(dt),await ce();const Et=await fetch("/api/products/samples-count");if(Et.ok){const Ze=await Et.json(),tt={};Ze.forEach(ct=>{tt[ct.kod]=ct.total_ilosc||0}),B(tt)}try{const Ze=await fetch("/api/products/reservations-count");if(Ze.ok){const tt=await Ze.json(),ct={};tt.forEach(Ve=>{ct[Ve.kod]=Ve.total_ilosc||0}),I(ct),console.log(" Reservations count loaded:",ct)}else console.error(" Failed to load reservations count:",Ze.status)}catch(Ze){console.error(" Error loading reservations count:",Ze)}const qe=await fetch("/api/products/wartosc-towaru");if(qe.ok){const Ze=await qe.json(),tt={};Ze.forEach(ct=>{tt[ct.kod]=ct.wartosc||0}),re(tt)}console.log("loadInventory completed successfully")}catch(X){console.error("Error loading inventory:",X),m(`Failed to load inventory: ${X instanceof Error?X.message:"Unknown error"}`)}finally{h(!1)}};C.useEffect(()=>{Re()},[]),C.useEffect(()=>{e&&Re()},[e]);const De=X=>{if(z===X){const me=V==="asc"?"desc":"asc";D(me),localStorage.setItem("sortDirection",me)}else te(X),D("asc"),localStorage.setItem("sortField",X),localStorage.setItem("sortDirection","asc")},lt=X=>{const me=_f.find(Ne=>Ne.value===X);return me?me.color:"bg-gray-100 text-gray-800 border-gray-200"},ft=X=>X===1/0?"bg-gray-100 text-gray-800 border-gray-200":X<=30?"bg-red-100 text-gray-800 border-red-200":X<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",gt=C.useMemo(()=>{const X=new Set;return t.forEach(me=>{const Ne=me.sprzedawca||Me.get(me.kod);Ne&&X.add(Ne)}),Array.from(X).sort()},[t,Me]),Nt=C.useMemo(()=>{const X=new Set;return t.forEach(me=>{me.typ&&X.add(me.typ)}),Array.from(X).sort()},[t]),zt=C.useMemo(()=>{const X=new Set;return t.forEach(me=>{me.objetosc&&X.add(me.objetosc.toString())}),Array.from(X).sort((me,Ne)=>parseFloat(me)-parseFloat(Ne))},[t]),Qt=C.useMemo(()=>{const X=new Set;return t.forEach(me=>{if(me.ilosc===0)X.add("brak");else{const Ne=Pe.get(me.kod)||0,Ae=Ne<=0?1/0:Math.floor(me.ilosc/Ne),et=Ae===1/0?"Brak danych":Ae<=30?"mao":Ae<=60?"rednie":"duo";X.add(et)}}),Array.from(X).sort()},[t,Pe]),qt=t.filter(X=>{if(!(X.kod.toLowerCase().includes(N.toLowerCase())||X.nazwa.toLowerCase().includes(N.toLowerCase())||X.kod_kreskowy&&X.kod_kreskowy.toLowerCase().includes(N.toLowerCase()))||ae.sprzedawca&&(X.sprzedawca||Me.get(X.kod))!==ae.sprzedawca||ae.typ&&X.typ!==ae.typ||ae.objetosc&&X.objetosc?.toString()!==ae.objetosc)return!1;if(ae.status){let Ne;if(X.ilosc===0)Ne="brak";else{const Ae=Pe.get(X.kod)||0,et=Ae<=0?1/0:Math.floor(X.ilosc/Ae);Ne=et===1/0?"Brak danych":et<=30?"mao":et<=60?"rednie":"duo"}if(Ne!==ae.status)return!1}return!0}).sort((X,me)=>{let Ne,Ae;switch(z){case"sprzedawca":Ne=X.sprzedawca||Me.get(X.kod)||"",Ae=me.sprzedawca||Me.get(me.kod)||"";break;case"cena":Ne=X.cena||0,Ae=me.cena||0;break;case"cena_sprzedazy":Ne=X.cena_sprzedazy||0,Ae=me.cena_sprzedazy||0;break;case"koszt_wlasny":Ne=X.koszt_wlasny||0,Ae=me.koszt_wlasny||0;break;case"srednieZuzycie":Ne=Pe.get(X.kod)||0,Ae=Pe.get(me.kod)||0;break;case"dniPozostalo":const et=Pe.get(X.kod)||0,at=Pe.get(me.kod)||0;Ne=et<=0?1/0:Math.floor(X.ilosc/et),Ae=at<=0?1/0:Math.floor(me.ilosc/at);break;case"dataWyczerpania":if(X.ilosc===0){const tt=Fe(X.kod);Ne=tt?tt.getTime():0}else{const tt=Pe.get(X.kod)||0,ct=tt<=0?1/0:Math.floor(X.ilosc/tt);Ne=ct===1/0?1/0:new Date().setDate(new Date().getDate()+ct)}if(me.ilosc===0){const tt=Fe(me.kod);Ae=tt?tt.getTime():0}else{const tt=Pe.get(me.kod)||0,ct=tt<=0?1/0:Math.floor(me.ilosc/tt);Ae=ct===1/0?1/0:new Date().setDate(new Date().getDate()+ct)}break;case"status":const dt=tt=>{if(tt.ilosc===0)return 0;const ct=Pe.get(tt.kod)||0,Ve=ct<=0?1/0:Math.floor(tt.ilosc/ct);return Ve===1/0?4:Ve<=30?1:Ve<=60?2:3};Ne=dt(X),Ae=dt(me);break;case"typ":Ne=X.typ||"",Ae=me.typ||"";break;case"objetosc":Ne=X.objetosc||0,Ae=me.objetosc||0;break;case"dataWaznosci":const Et=tt=>{if(!tt)return 0;let ct;if(typeof tt=="string")ct=new Date(tt);else if(typeof tt=="number")tt<1e12?ct=new Date(tt*1e3):ct=new Date(tt);else return 0;return isNaN(ct.getTime())?0:ct.getTime()};Ne=Et(X.data_waznosci),Ae=Et(me.data_waznosci);break;case"sprzedaze":const qe=a.filter(tt=>tt.kod===X.kod).length,Ze=a.filter(tt=>tt.kod===me.kod).length;Ne=qe,Ae=Ze;break;default:Ne=X[z],Ae=me[z]}return typeof Ne=="string"&&typeof Ae=="string"?V==="asc"?Ne.localeCompare(Ae):Ae.localeCompare(Ne):typeof Ne=="number"&&typeof Ae=="number"?V==="asc"?Ne-Ae:Ae-Ne:0}),Bt=X=>{L(X?qt.map(me=>me.id):[])},rr=(X,me)=>{L(Ne=>me?[...Ne,X]:Ne.filter(Ae=>Ae!==X))},ut=(X,me)=>{X.preventDefault(),X.stopPropagation(),console.log(" Mouse down on column:",me,"X:",X.clientX,"Current width:",T[me]),R(me),Z(X.clientX),xe(T[me]),ve(!1),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},_t=X=>{if(O){const me=X.clientX-J,Ne=Math.max(50,U+me);console.log(" Mouse move:","DeltaX:",me,"NewWidth:",Ne,"Column:",O),Math.abs(me)>3&&ve(!0);const Ae={...T,[O]:Ne};F(Ae),localStorage.setItem("columnWidths",JSON.stringify(Ae))}},Ht=()=>{console.log(" Mouse up - finishing resize"),R(null),Z(0),xe(0),document.body.style.cursor="",document.body.style.userSelect="",setTimeout(()=>{ve(!1)},100)};C.useEffect(()=>{if(O)return document.addEventListener("mousemove",_t),document.addEventListener("mouseup",Ht),()=>{document.removeEventListener("mousemove",_t),document.removeEventListener("mouseup",Ht)}},[O,J,U]);const Dt=()=>{if(H.length!==1){Xe.error("Wybierz dokadnie jedn pozycj do edycji");return}const X=t.find(me=>me.id===H[0]);X&&(oe(X),ue(!0))},Zt=async()=>{try{const X=await fetch("/api/inventory/report/pdf");if(!X.ok)throw new Error("   ");const me=await X.blob(),Ne=window.URL.createObjectURL(me),Ae=document.createElement("a");Ae.href=Ne;const et=X.headers.get("Content-Disposition");let at="raport_stanow_magazynowych.pdf";if(et){const dt=et.match(/filename="?(.+)"?/i);dt&&(at=dt[1])}Ae.download=at,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),setTimeout(()=>window.URL.revokeObjectURL(Ne),100)}catch(X){console.error("Error generating report:",X)}},$t=X=>{r(me=>me.map(Ne=>Ne.id===X.id?X:Ne)),L([])},he=qt.length>0&&qt.every(X=>H.includes(X.id)),Oe=X=>{if(!X)return"-";let me;if(typeof X=="string")me=new Date(X);else if(typeof X=="number")X<1e12?me=new Date(X*1e3):me=new Date(X);else return"-";return isNaN(me.getTime())?"-":me.toLocaleDateString("pl-PL")},Ie=H.length>0?t.filter(X=>H.includes(X.id)):[];return f?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("p",{className:"text-red-600 font-sora",children:p}),u.jsx("button",{onClick:Re,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[u.jsxs("div",{className:"relative w-full max-w-xs",children:[u.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),u.jsx("input",{type:"text",value:N,onChange:X=>S(X.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),u.jsx("button",{onClick:Dt,disabled:H.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:u.jsx(Al,{size:16})}),u.jsx("button",{onClick:Zt,className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Raport stanw magazynowych",children:u.jsx(v2,{size:16})})]}),u.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykuw"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:Ie.length})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"czna ilo towaru"}),u.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:Ie.length>0?Ie.reduce((X,me)=>X+(me.ilosc||0),0):0})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru fakturowa"}),u.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[Ie.length>0?Ie.reduce((X,me)=>X+(j[me.kod]||0),0).toFixed(2):"0.00"," "]})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru w sprzeday"}),u.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[Ie.length>0?Ie.reduce((X,me)=>{const Ne=me.cena_sprzedazy||0,Ae=me.ilosc||0;return X+Ne*Ae},0).toFixed(2):"0.00"," z"]})]})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.sprzedawca,onChange:X=>Q(me=>({...me,sprzedawca:X.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Sprzedawca"}),gt.map(X=>u.jsx("option",{value:X,children:X},X))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.typ,onChange:X=>Q(me=>({...me,typ:X.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Typ"}),Nt.map(X=>u.jsx("option",{value:X,children:_f.find(me=>me.value===X)?.label||X},X))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.objetosc,onChange:X=>Q(me=>({...me,objetosc:X.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Objto"}),zt.map(X=>u.jsxs("option",{value:X,children:[X," l"]},X))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ae.status,onChange:X=>Q(me=>({...me,status:X.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[u.jsx("option",{value:"",children:"Status"}),Qt.map(X=>u.jsx("option",{value:X,children:X},X))]})})]}),(ae.sprzedawca||ae.typ||ae.objetosc||ae.status)&&u.jsx("button",{onClick:()=>Q({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})]}),u.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:u.jsx("div",{className:"w-full overflow-x-auto overflow-y-scroll max-h-[500px] relative",style:{zIndex:1},children:u.jsxs("table",{className:"w-full resizable-table",ref:ye,children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsx("input",{type:"checkbox",checked:he,onChange:X=>Bt(X.target.checked)})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("kod"),style:{width:"100px"},children:"Kod"}),u.jsxs("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 relative",onClick:()=>{M||De("nazwa")},style:{width:`${T.nazwa}px`},children:["Nazwa",u.jsx("div",{className:`absolute top-0 right-0 h-full cursor-col-resize hover:bg-blue-500 transition-opacity z-10 ${O==="nazwa"?"bg-blue-500 opacity-100":"opacity-0 hover:opacity-100"}`,style:{width:"2px"},onMouseDown:X=>{X.preventDefault(),X.stopPropagation(),ut(X,"nazwa")}})]}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("sprzedawca"),style:{width:"120px"},children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("ilosc"),children:"Ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("objetosc"),children:"Objto"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("cena"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena",u.jsx("br",{}),"fakturowa"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("koszt_wlasny"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Koszt",u.jsx("br",{}),"wasny"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("cena_sprzedazy"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena w",u.jsx("br",{}),"sprzeday"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("dataWaznosci"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data",u.jsx("br",{}),"wanoci"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("sprzedaze"),children:"Sprzedae"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("srednieZuzycie"),style:{width:"100px"},children:u.jsxs("div",{className:"whitespace-normal",children:["rednie",u.jsx("br",{}),"zuycie/dzie"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("dniPozostalo"),style:{width:"80px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Dni",u.jsx("br",{}),"pozostao"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("dataWyczerpania"),style:{width:"110px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data wyczerpania",u.jsx("br",{}),"zapasw"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("status"),children:"Status"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:qt.map(X=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:u.jsx("input",{type:"checkbox",checked:H.includes(X.id),onChange:me=>rr(X.id,me.target.checked)})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:"100px"},children:u.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:X.kod})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:`${T.nazwa}px`},children:u.jsx("div",{className:"break-words leading-tight max-h-12 overflow-hidden",children:X.nazwa})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",style:{width:"120px"},children:X.sprzedawca||Me.get(X.kod)||""}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`ilosc-tooltip-${X.kod}`,children:[X.ilosc,u.jsx(ti,{id:`ilosc-tooltip-${X.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"samples:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[ie[X.kod]||0," szt"]})]}),de[X.kod]>0&&u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"rezerwacja:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[de[X.kod]," szt"]})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:X.typ?u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${lt(X.typ)}`,children:_f.find(me=>me.value===X.typ)?.label||X.typ}):"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:X.objetosc?`${X.objetosc} l`:"-"}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${X.kod}`,onMouseEnter:()=>{pe[X.kod]||ce()},children:[X.cena!=null?`${X.cena.toFixed(2)} `:"-",u.jsx(ti,{id:`price-tooltip-${X.kod}`,className:"max-w-md",place:"top",children:u.jsxs("div",{className:"font-sora",children:[u.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),pe[X.kod]&&pe[X.kod].length>0?pe[X.kod].map((me,Ne)=>u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:me.cena!=null?`${me.cena.toFixed(2)} `:"N/A"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:["(",me.ilosc_aktualna," szt.)"]})]},Ne)):u.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`koszt-tooltip-${X.kod}`,children:[X.koszt_wlasny!=null?`${X.koszt_wlasny.toFixed(2)} z`:"-",u.jsx(ti,{id:`koszt-tooltip-${X.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"transport:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:X.koszt_dostawy_per_unit!=null?`${X.koszt_dostawy_per_unit.toFixed(2)} z`:"0,00 z"})]}),u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"akcyza:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:X.podatek_akcyzowy!=null?`${X.podatek_akcyzowy.toFixed(2)} z`:"0,00 z"})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:X.cena_sprzedazy!=null?`${X.cena_sprzedazy.toFixed(2)} z`:"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:Oe(X.data_waznosci)}),u.jsx("td",{className:"px-8 py-4 text-center text-xs text-gray-600 font-sora leading-tight align-middle whitespace-nowrap",children:(()=>{const me=a.filter(at=>at.kod===X.kod);console.log(`Sales for ${X.kod}:`,me.length);const Ne={};me.forEach(at=>{const dt=l.find(Ze=>Ze.id===at.orderId),Et=dt?dt.klient:"";let qe="";dt&&dt.numer_zamowienia&&(qe=Rv(dt.numer_zamowienia)),!qe&&dt&&(qe=new Date(dt.data_utworzenia).toLocaleDateString("pl-PL")),!qe&&at.created_at&&(qe=new Date(at.created_at).toLocaleDateString("pl-PL")),Ne[at.orderId]||(Ne[at.orderId]={qty:0,klient:Et,date:qe}),Ne[at.orderId].qty+=at.ilosc});const Ae=Object.entries(Ne).sort(([,at],[,dt])=>{const Et=new Date(at.date.split(".").reverse().join("-"));return new Date(dt.date.split(".").reverse().join("-")).getTime()-Et.getTime()});if(console.log(`Sales array for ${X.kod}:`,Ae.length),Ae.length===0)return u.jsx("div",{className:"text-gray-400",children:"-"});const et=Ae.slice(0,3);return u.jsx("div",{className:"flex items-center justify-center",children:u.jsxs("div",{className:"relative cursor-pointer",children:[u.jsx(y2,{size:16,className:"text-blue-300 hover:text-blue-400 transition-colors focus:outline-none","data-tooltip-id":`sales-tooltip-${X.kod}`,onClick:at=>{at.stopPropagation(),w(X.kod),v(!0)},tabIndex:0,onMouseDown:at=>at.preventDefault()}),u.jsx(ti,{id:`sales-tooltip-${X.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!1,children:u.jsx("div",{className:"font-sora",children:et.map(([at,dt])=>u.jsx("div",{className:"mb-1",children:dt.date&&dt.klient?u.jsxs("div",{children:[dt.date.split(".").slice(0,2).join(".")," | ",dt.klient,": ",u.jsx("span",{className:"text-gray-500",children:dt.qty})]}):u.jsxs("div",{className:"text-gray-500",children:["Ilo: ",dt.qty]})},at))})})]})})})()}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(Pe.get(X.kod)||0).toFixed(2),"/dzie"]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const me=Pe.get(X.kod)||0,Ne=me<=0?1/0:Math.floor(X.ilosc/me);return Ne===1/0?"":Ne})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(X.ilosc===0){const et=Fe(X.kod);return et?et.toLocaleDateString("pl-PL"):"-"}const me=Pe.get(X.kod)||0,Ne=me<=0?1/0:Math.floor(X.ilosc/me);if(Ne===1/0)return"-";const Ae=new Date;return Ae.setDate(Ae.getDate()+Ne),Ae.toLocaleDateString("pl-PL")})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(X.ilosc===0)return u.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border bg-gray-100 text-gray-600 border-gray-300",children:"brak"});const me=Pe.get(X.kod)||0,Ne=me<=0?1/0:Math.floor(X.ilosc/me),Ae=Ne===1/0?"Brak danych":Ne<=30?"mao":Ne<=60?"rednie":"duo";return u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${ft(Ne)}`,children:Ae})})()})]},X.id))})]})})}),u.jsx(aR,{isOpen:Y,onClose:()=>{ue(!1),oe(null)},item:le,onSave:$t}),(()=>{let X=0;if(k){const Ze=new Set;a.forEach(tt=>{tt.kod===k&&Ze.add(tt.orderId)}),X=l.filter(tt=>Ze.has(tt.id)).length}const me=40,Ne=48,Ae=40,et=40,at=7,dt=at*et,Et=X===0?150:me+Ne+Ae+Math.max(X,at)*et+20,qe=Math.min(Math.max(Et,me+Ne+Ae+dt+20),window.innerHeight*.9);return u.jsx(dr,{isOpen:g,onRequestClose:()=>{v(!1),w(null)},style:{content:{width:"400px",height:`${qe}px`,maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},contentLabel:"Zamwienia",children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-start mb-8 select-none",children:[u.jsx("h2",{className:"text-xs font-semibold text-gray-800 pr-4 break-words leading-tight",children:k?t.find(Ze=>Ze.kod===k)?.nazwa||k:""}),u.jsx("button",{onClick:()=>{v(!1),w(null),E("")},className:"text-red-500 focus:outline-none flex-shrink-0",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:k&&(()=>{const Ze=new Set;a.forEach(Ge=>{Ge.kod===k&&Ze.add(Ge.orderId)});let tt=l.filter(Ge=>Ze.has(Ge.id));b.trim()&&(tt=tt.filter(Ge=>Ge.klient===b));const Ve=tt.map(Ge=>{const pt=a.filter(Yt=>Yt.orderId===Ge.id&&Yt.kod===k).reduce((Yt,P)=>Yt+P.ilosc,0);let Ft="";return Ge.numer_zamowienia&&(Ft=Rv(Ge.numer_zamowienia)),!Ft&&Ge.data_utworzenia&&(Ft=new Date(Ge.data_utworzenia).toLocaleDateString("pl-PL")),{...Ge,date:Ft,totalQty:pt}}).sort((Ge,pt)=>{if(Ge.date&&pt.date){const Ft=new Date(Ge.date.split(".").reverse().join("-"));return new Date(pt.date.split(".").reverse().join("-")).getTime()-Ft.getTime()}return 0});return Ve.length===0?u.jsx("p",{className:"text-xs text-gray-500",children:"Brak zamwie dla tego towaru"}):u.jsx("div",{children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-purple-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Zamwienia"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Klient"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-0"})]})}),u.jsx("tbody",{className:"bg-white",children:Ve.map(Ge=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium",children:Ge.numer_zamowienia||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:Ge.klient||"-"})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:Ge.totalQty}),u.jsx("td",{})]},Ge.id))})]})})})()}),k&&(()=>{const Ze=new Set;a.forEach(ct=>{ct.kod===k&&Ze.add(ct.orderId)});const tt=l.filter(ct=>Ze.has(ct.id)).map(ct=>ct.klient).filter((ct,Ve,Ge)=>ct&&Ge.indexOf(ct)===Ve).sort();return u.jsx("div",{className:"mt-6 pt-4",children:u.jsx("div",{className:"flex items-center space-x-2",children:u.jsxs("select",{value:b,onChange:ct=>E(ct.target.value),className:"block w-1/2 px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-0 focus:border-gray-300 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"",children:"Klient"}),tt.map(ct=>u.jsx("option",{value:ct,style:{fontFamily:"Sora, sans-serif"},children:ct},ct))]})})})})()]})})})()]})};Ms("pl",Is);const iR=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=C.useState(new Date),[o,l]=C.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=C.useState([]),[,h]=C.useState(new Set),[p,m]=C.useState(!1),[g,v]=C.useState(""),[k,w]=C.useState(""),[b,E]=C.useState(!1),[N,S]=C.useState(null);C.useEffect(()=>{const L=setTimeout(async()=>{if(g.trim().length<2||b){f([]);return}m(!0);try{const ae=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(g)}`);if(!ae.ok)throw new Error("Failed to fetch orders");const Q=await ae.json();if(Q&&Q.length>0){const Y=Q.map(ue=>({id:ue.id,nazwa:`Zamwienie: ${ue.numer_zamowienia}`,kod:ue.klient,klient:ue.klient,numer_zamowienia:ue.numer_zamowienia,products:ue.products||[]}));f(Y)}else f([])}catch(ae){console.error("Error searching orders:",ae),f([])}finally{m(!1)}},300);return()=>clearTimeout(L)},[g,b]);const z=(H,L)=>{if(H.numer_zamowienia){if(w(H.klient),S(H.id),H.products&&H.products.length>0){const ae=H.products.map(Q=>({nazwa:Q.nazwa,ilosc:Q.ilosc,original_ilosc:Q.ilosc,powod_zwrotu:""}));l(ae)}f([]),v(H.numer_zamowienia),E(!0),Xe.success("Zamwienie wybrane")}else{const ae=[...o];ae[L]={...ae[L],nazwa:H.nazwa,ilosc:0,original_ilosc:0},l(ae)}},te=()=>{const H=new Set;return o.forEach((L,ae)=>{const Q=L.original_ilosc,Y=o[ae].ilosc;!L.nazwa.trim()||!Y||Y<=0||!L.powod_zwrotu?H.add(ae):Y>Q&&(H.add(ae),Xe.error(`Ilo zwrotu (${Y}) nie moe przekracza iloci w zamwieniu (${Q})`))}),h(H),H.size===0},V=async()=>{if(!te()){Xe.error("Prosz wypeni wszystkie wymagane pola");return}try{const H={klient:k,data_zwrotu:r,products:o,orderId:N},L=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)});if(!L.ok){const Q=await L.json();throw new Error(Q.error||"Failed to create return")}const ae=await L.json();console.log("Return created:",ae),t(H),Xe.success(`Zwrot zosta utworzony: ${ae.numer_zwrotu}`),n(),v(""),w(""),E(!1),S(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)}catch(H){console.error("Error creating return:",H),Xe.error("Bd podczas tworzenia zwrotu")}},D=()=>{n(),v(""),w(""),E(!1),S(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)};return u.jsx(dr,{isOpen:e,onRequestClose:D,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),u.jsx("button",{onClick:D,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),u.jsx($n,{selected:r,onChange:H=>a(H||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:g,onChange:H=>{v(H.target.value),E(!1),S(null)},placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),p&&u.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&g.trim().length>=2&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(H=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>z(H,-1),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-[10px]",children:H.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",H.klient]})]})},H.id))})]})]})]})}),k&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),u.jsx("p",{className:"text-xs text-gray-900",children:k})]})}),u.jsx("button",{onClick:()=>w(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Ct,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((H,L)=>u.jsx("div",{className:"relative",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"relative flex-1 max-w-[50%]",children:u.jsx("input",{type:"text",value:H.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:"1",max:H.original_ilosc,value:o[L].ilosc||"",onChange:ae=>{const Q=[...o],Y=ae.target.value===""?0:parseInt(ae.target.value)||0;Q[L]={...Q[L],ilosc:Y},l(Q)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilo"})}),u.jsx("div",{className:"w-40 ml-2",children:u.jsxs("select",{value:o[L].powod_zwrotu,onChange:ae=>{const Q=[...o];Q[L]={...Q[L],powod_zwrotu:ae.target.value},l(Q)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[u.jsx("option",{value:"",children:"Powd zwrotu"}),u.jsx("option",{value:"Bd w zamwieniu",children:"Bd w zamwieniu"}),u.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),u.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&u.jsx("button",{onClick:()=>{const ae=o.filter((Q,Y)=>Y!==L);l(ae)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]})},L))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:V,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwrz zwrot"})}),u.jsx("div",{className:"absolute bottom-4 right-4",children:u.jsx("button",{onClick:D,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})};Ms("pl",Is);const lR=({isOpen:e,onClose:n,onReservationCreated:t})=>{console.log(" CreateReservationModal render - isOpen:",e);const[r,a]=C.useState(null),[o,l]=C.useState(null),[c,f]=C.useState(""),[h,p]=C.useState(""),[m,g]=C.useState([]),[v,k]=C.useState(null),[w,b]=C.useState(!1),[E,N]=C.useState([]),[S,z]=C.useState([{id:1,searchQuery:"",selectedProduct:null}]),[te,V]=C.useState(null),[D,H]=C.useState(!1),[L,ae]=C.useState(!1),[Q,Y]=C.useState(new Set),[ue,le]=C.useState(""),oe=C.useRef(null),pe=C.useRef(""),G=()=>{const T=Math.max(...S.map(F=>F.id))+1;z([...S,{id:T,searchQuery:"",selectedProduct:null}])},ie=T=>{S.length>1&&z(F=>F.filter(O=>O.id!==T))},B=()=>{console.log(" CreateReservationModal handleClose called"),a(null),l(null),f(""),p(""),g([]),k(null),N([]),z([{id:1,searchQuery:"",selectedProduct:null}]),V(null),H(!1),ae(!1),Y(new Set),le(""),oe.current=null,n()};C.useEffect(()=>{if(e){console.log(" CreateReservationModal opened - clearing state and generating number"),a(null),l(null),p(""),g([]),k(null),N([]),z([{id:1,searchQuery:"",selectedProduct:null}]),V(null),H(!1),ae(!1),Y(new Set),le(""),oe.current=null;const T=new Date,F=T.getDate().toString().padStart(2,"0"),O=(T.getMonth()+1).toString().padStart(2,"0"),R=T.getFullYear();console.log(" Fetching next reservation number from:",`${Ua}/api/reservations/next-number-only`),fetch(`${Ua}/api/reservations/next-number-only`).then(J=>{if(console.log(" Response status:",J.status),!J.ok)throw new Error(`HTTP error! status: ${J.status}`);return J.json()}).then(J=>{if(console.log(" Received data:",J),J.numer_rezerwacji){pe.current=J.numer_rezerwacji;const Z=`${J.numer_rezerwacji}_${F}_${O}_${R}`;f(Z),console.log(" Set reservation number to:",Z)}else console.warn(" No numer_rezerwacji in response, using fallback"),pe.current="R001",f(`R001_${F}_${O}_${R}`)}).catch(J=>{console.error(" Error fetching next reservation number:",J),pe.current="R001",f(`R001_${F}_${O}_${R}`)})}else f(""),pe.current=""},[e]),C.useEffect(()=>{const F=setTimeout(async()=>{if(h.trim().length<2){g([]);return}b(!0);try{const O=await fetch(`${Ua}/api/clients/search?q=${encodeURIComponent(h)}`);if(!O.ok)throw new Error("Failed to fetch clients");const R=await O.json();g(R)}catch(O){console.error("Error searching clients:",O),g([])}finally{b(!1)}},300);return()=>clearTimeout(F)},[h]),C.useEffect(()=>{const F=setTimeout(async()=>{if(te===null||!S.find(O=>O.id===te)?.searchQuery.trim()){N([]);return}H(!0);try{const O=S.find(U=>U.id===te)?.searchQuery||"",R=await fetch(`${Ua}/api/working-sheets/search?query=${encodeURIComponent(O)}`);if(!R.ok)throw new Error("Failed to fetch products");const Z=(await R.json()).map(U=>({kod:U.kod,nazwa:U.nazwa,ilosc:U.ilosc.toString(),kodKreskowy:U.kod_kreskowy||"",selectedQuantity:0,ilosc_reserved:U.ilosc_reserved||0}));N(Z)}catch(O){console.error("Error searching products:",O),N([])}finally{H(!1)}},300);return()=>clearTimeout(F)},[S,te]),C.useEffect(()=>{if(pe.current)if(r){const T=r.getDate().toString().padStart(2,"0"),F=(r.getMonth()+1).toString().padStart(2,"0"),O=r.getFullYear(),R=`${pe.current}_${T}_${F}_${O}`;f(R)}else{const T=new Date,F=T.getDate().toString().padStart(2,"0"),O=(T.getMonth()+1).toString().padStart(2,"0"),R=T.getFullYear(),J=`${pe.current}_${F}_${O}_${R}`;f(J)}},[r]);const de=(T,F)=>{console.log(" handleProductSelect called for fieldId:",T,"product:",F.kod),z(O=>O.map(J=>J.id===T?{...J,selectedProduct:F,searchQuery:`${F.kod} - ${F.nazwa.includes(" (samples)")?F.nazwa.replace(" (samples)","")+" (samples)":F.nazwa}`}:J)),N([]),V(null),console.log(" Products list cleared, activeSearchId reset")},I=()=>S.filter(T=>T.selectedProduct).reduce((T,F)=>{const O=F.selectedProduct?.selectedQuantity||0;return T+O},0),j=()=>{if(!r||!o||!v||!c.trim())return!1;const T=S.filter(F=>F.selectedProduct);return!(T.length===0||T.some(F=>!F.selectedProduct?.selectedQuantity||F.selectedProduct.selectedQuantity<=0)||Q.size>0)},re=async()=>{const T=S.filter(F=>F.selectedProduct).map(F=>({product_kod:F.selectedProduct.kod,product_nazwa:F.selectedProduct.nazwa,kod_kreskowy:F.selectedProduct.kodKreskowy||"",ilosc:F.selectedProduct.selectedQuantity||0}));if(!r){Xe.error("Wybierz dat rezerwacji");return}if(!o){Xe.error("Wybierz dat zakoczenia rezerwacji");return}if(o<r){Xe.error("Data zakoczenia nie moe by wczeniejsza ni data rezerwacji");return}if(!v){Xe.error("Wybierz klienta");return}if(T.length===0){Xe.error("Dodaj produkty");return}if(T.some(F=>!F.ilosc||F.ilosc<=0)){Xe.error("Wprowad ilo dla wszystkich produktw");return}Y(new Set),ae(!0);try{const F=await fetch(`${Ua}/api/reservations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:v.id,numer_rezerwacji:c,data_utworzenia:r.toISOString().split("T")[0],data_zakonczenia:o.toISOString().split("T")[0],komentarz:ue.trim()||null,products:T})});if(!F.ok){const O=await F.text();let R="Failed to create reservation";try{const J=JSON.parse(O);R=J.details?.message||J.error||R}catch{console.error("Non-JSON error response when creating reservation:",O)}throw new Error(R)}Xe.success("Rezerwacja zostaa utworzona"),B(),t&&t()}catch(F){console.error("Error creating reservation:",F),Xe.error(F.message||"Wystpi bd podczas tworzenia rezerwacji")}finally{ae(!1)}};return u.jsx(dr,{isOpen:e,onRequestClose:B,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"visible",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie rezerwacji"}),u.jsx("button",{onClick:B,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx($n,{selected:r,onChange:T=>a(T),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx($n,{selected:o,onChange:T=>l(T),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:r||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:h,onChange:T=>{p(T.target.value),v&&k(null)},placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),w&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),m.length>0&&!v&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map(T=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{k(T),p(T.nazwa),g([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:T.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:T.firma})]})},T.id))}),v&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.firma})]}),u.jsx("button",{onClick:()=>{k(null),p("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(Ct,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:ue,onChange:T=>le(T.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),S.map(T=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ca,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:T.searchQuery,onChange:F=>{const O=F.target.value;console.log(" Product search input changed for fieldId:",T.id,"value:",O),z(R=>R.map(J=>J.id===T.id?{...J,searchQuery:O,selectedProduct:null}:J)),V(T.id)},onFocus:()=>V(T.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-8",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:T.selectedProduct?.selectedQuantity||"",onChange:F=>{const O=F.target.value,R=O===""?0:Math.max(1,parseInt(O)||0);z(J=>{const Z=J.map(xe=>xe.id===T.id&&xe.selectedProduct?{...xe,selectedProduct:{...xe.selectedProduct,selectedQuantity:R}}:xe);oe.current=null;const U=Z.find(xe=>xe.id===T.id);if(U?.selectedProduct){const xe=parseInt(U.selectedProduct.ilosc)||0,M=U.selectedProduct.ilosc_reserved||0,ve=Math.max(0,xe-M);R===0?Y(ye=>{const Me=new Set(ye);return Me.delete(T.id),Me}):R>ve?(Y(ye=>{const Me=new Set(ye);return Me.add(T.id),Me}),M>0?Xe.error(`Niewystarczajca ilo - dostpne: ${ve} (na magazynie: ${xe}, z nich w rezerwacji: ${M})`):Xe.error(`Niewystarczajca ilo - dostpne: ${ve} (na magazynie: ${xe})`)):Y(ye=>{const Me=new Set(ye);return Me.delete(T.id),Me})}else Y(xe=>{const M=new Set(xe);return M.delete(T.id),M});return Z})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${Q.has(T.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),S.length>1&&u.jsx("button",{onClick:()=>ie(T.id),className:"ml-4 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),T.id===Math.max(...S.map(F=>F.id))&&u.jsx("button",{onClick:G,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(_a,{size:16})}),D&&te===T.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),E.length>0&&te===T.id&&!T.selectedProduct&&T.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:E.map((F,O)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>de(T.id,{...F,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:F.kod}),F.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:F.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:F.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",F.ilosc]}),(F.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",F.ilosc_reserved??0]})]})},`${F.kod}-${F.nazwa||""}-${O}`))})]},T.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:re,disabled:L||!j(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${L||!j()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:L?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:I()})]})]})})},cR=e=>(e(!0),!0);dr.setAppElement("#root");const uR=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
  }
`,er="";console.log("API_URL configured as:",er);function dR(){const[e,n]=C.useState(!1),[t,r]=C.useState(!1),[a,o]=C.useState(!1),[l,c]=C.useState(!1),[f,h]=C.useState(!1),[p,m]=C.useState(!1),[g,v]=C.useState(null),[k,w]=C.useState(null),[b,E]=C.useState(["inventory","clients","orders","inventoryStatus"]),[N,S]=C.useState(()=>{const he=localStorage.getItem("activeTab")||"inventory",Oe=localStorage.getItem("activeSubTab"),Ie=["inventory","clients","orders","inventoryStatus"],X=["przyjecie","analiza","kalendarz","wydanie","rezerwacje","analiza_towarow","faktury"],me=Ie.includes(he)?he:"inventory";let Ne="przyjecie";me==="orders"&&(Ne="wydanie");const Ae=Oe&&X.includes(Oe)?Oe:Ne;return{sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:me,activeSubTab:Ae,isDbInitialized:!1}}),[z,te]=C.useState(!1),[V,D]=C.useState(!1),[H,L]=C.useState(!1),[ae,Q]=C.useState(!1),[Y,ue]=C.useState(null),[le,oe]=C.useState(!1),[pe,G]=C.useState(null),[ie,B]=C.useState(0),[de,I]=C.useState(0),[j,re]=C.useState(0),[T,F]=C.useState([]),[O,R]=C.useState(!1),[J,Z]=C.useState(null),[U,xe]=C.useState(null);C.useEffect(()=>{(async()=>{try{console.log(" Starting data loading process..."),console.log(" API_URL:",er),console.log(" Loading clients...");const Oe=await ut();console.log(" Clients loaded:",Oe.length),console.log(" Loading products...");const Ie=await _t();console.log(" Products loaded:",Ie.length),console.log(" Loading product receipts...");const X=await Ht();console.log(" Product receipts loaded:",X.length),console.log(" Updating app state with loaded data..."),console.log(" Setting clients:",Oe),S(me=>{const Ne={...me,clients:Oe,products:Ie,productReceipts:X};return console.log(" New app state:",Ne),Ne}),console.log(" App state updated successfully"),console.log(" Final data counts:"),console.log("   - Clients:",Oe.length),console.log("   - Products:",Ie.length),console.log("   - Product Receipts:",X.length)}catch(Oe){console.error(" Error loading data:",Oe),Xe.error("Bd podczas adowania danych")}finally{console.log(" Data loading process completed")}})()},[]),C.useEffect(()=>{const he=document.createElement("style");return he.textContent=uR,document.head.appendChild(he),()=>{document.head.contains(he)&&document.head.removeChild(he)}},[]),C.useEffect(()=>{if(!N.isDbInitialized)return;console.log(" useEffect triggered - clients changed:",N.clients.length),(async()=>{const Oe={sheets:N.sheets,sheetsData:N.sheetsData,activeSheet:N.activeSheet,showTable:N.showTable,clients:N.clients,products:N.products,productReceipts:N.productReceipts};try{localStorage.setItem("appState",JSON.stringify(Oe)),console.log("App state saved to localStorage")}catch(Ie){console.error("Error saving state to localStorage:",Ie)}})()},[N.sheetsData,N.sheets,N.activeSheet,N.showTable,N.clients,N.products,N.productReceipts]);const M=async()=>{try{console.log(" Loading sheets from database..."),console.log(" Making request to:",`${er}/api/original-sheets`);const he=await fetch(`${er}/api/original-sheets`);if(console.log(" Sheets response status:",he.status),!he.ok)throw new Error(`HTTP error! status: ${he.status}`);const Oe=await he.json();console.log(" Received sheets from server:",Oe),console.log(" Sheets count:",Oe.length);const Ie=Oe.map(X=>({fileName:X.fileName,data:{headers:X.data.headers,rows:X.data.rows}}));console.log(" Processed sheets:",Ie),console.log(" Processed sheets count:",Ie.length),S(X=>({...X,sheets:Ie,sheetsData:Ie,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log(" App state updated with sheets data")}catch(he){console.error("     :",he),Xe.error("    ")}finally{console.log(" Loading sheets completed")}};C.useEffect(()=>{M()},[]);const ve=async(he,Oe)=>{console.log("handleExcelUpload called with:",{newFileName:he,fileData:Oe});try{const Ie=await fetch(`${er}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:he,data:Oe})});if(!Ie.ok){if(Ie.status===409){Xe.error("Moe by tylko jeden plik Excel. Usu istniejcy plik przed zaadowaniem nowego.");return}throw new Error(`HTTP error! status: ${Ie.status}`)}await M(),n(!1)}catch(Ie){console.error("Error saving file data:",Ie),Xe.error("Bd podczas zapisywania danych pliku")}},ye=he=>{const Oe=`${er}/api/download_file/${encodeURIComponent(he.fileName)}`;window.open(Oe,"_blank")},Me=he=>{w(he)},Pe=he=>{he.preventDefault()},ce=he=>{!k||k===he||(E(Oe=>{const Ie=[...Oe],X=Ie.indexOf(k),me=Ie.indexOf(he);return Ie.splice(X,1),Ie.splice(me,0,k),Ie}),w(null))},Fe=he=>{if(he==="inventory"||he==="clients"||he==="orders"||he==="inventoryStatus"){const Oe=he==="inventory"?"przyjecie":he==="orders"?"wydanie":null;localStorage.setItem("activeTab",he),Oe&&localStorage.setItem("activeSubTab",Oe),S(Ie=>({...Ie,activeTab:he,activeSubTab:Oe}))}},Re=he=>{localStorage.setItem("activeSubTab",he),S(Oe=>({...Oe,activeSubTab:he}))};C.useEffect(()=>{N.activeSubTab==="analiza_towarow"&&Bt()},[N.activeSubTab,j]);const De=he=>{switch(he){case"inventory":return"Zakup towarw";case"clients":return"Klienci";case"orders":return"Sprzeda towarw";case"inventoryStatus":return"Stany magazynowe";default:return he}},lt=()=>{c(!1),n(!1)},ft=async he=>{try{console.log(" Starting handleAddProduct..."),console.log(" Received data:",he),console.log(" Files check:",{hasProductInvoice:!!he.productInvoice,hasTransportInvoice:!!he.transportInvoice,productInvoice:he.productInvoice,transportInvoice:he.transportInvoice}),console.log(" Making request to:",`${er}/api/product-receipts`);let Oe;if(he.productInvoice||he.transportInvoice){console.log(" Files detected, using FormData...");const me=new FormData,Ne={date:he.date,sprzedawca:he.sprzedawca,wartosc:he.wartosc,kosztDostawy:he.kosztDostawy,aktualnyKurs:he.aktualnyKurs,podatekAkcyzowy:he.podatekAkcyzowy,products:he.products};me.append("data",JSON.stringify(Ne)),console.log(" JSON data:",Ne),he.productInvoice&&(me.append("productInvoice",he.productInvoice),console.log(" Product invoice added:",he.productInvoice.name)),he.transportInvoice&&(me.append("transportInvoice",he.transportInvoice),console.log(" Transport invoice added:",he.transportInvoice.name)),console.log(" FormData entries:");for(let[Ae,et]of me.entries())console.log(`  ${Ae}:`,et);Oe=await fetch(`${er}/api/product-receipts`,{method:"POST",body:me})}else{console.log(" No files, using JSON...");const me={date:he.date,sprzedawca:he.sprzedawca,wartosc:he.wartosc,kosztDostawy:he.kosztDostawy,aktualnyKurs:he.aktualnyKurs,podatekAkcyzowy:he.podatekAkcyzowy,products:he.products};console.log(" JSON data:",me),Oe=await fetch(`${er}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)})}if(console.log(" Response status:",Oe.status),console.log(" Response headers:",Oe.headers),!Oe.ok){const me=await Oe.text();throw console.error(" Response error text:",me),new Error(`Failed to save product receipt: ${Oe.status} - ${me}`)}const Ie=await Oe.json();if(console.log(" Saved receipt:",Ie),Ie.workingSheetsUpdated||Ie.workingSheetsInserted){let me="Dodano nowy towar";Ie.workingSheetsUpdated>0&&(me+=` (${Ie.workingSheetsUpdated}    working sheets)`),Ie.workingSheetsInserted>0&&(me+=` (${Ie.workingSheetsInserted}     working sheets)`),Xe.success(me)}else Xe.success("Dodano nowy towar");console.log(" Loading updated receipts...");const X=await Ht();console.log(" Updated receipts:",X),console.log(" Updating app state..."),S(me=>{const Ne={...me,productReceipts:X};return console.log(" New app state:",Ne),Ne}),o(!1)}catch(Oe){console.error(" Error adding product:",Oe),Xe.error("Wystpi bd podczas dodawania towaru")}},gt=async he=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",he),console.log(" Files check (update):",{hasProductInvoice:!!he.productInvoice,hasTransportInvoice:!!he.transportInvoice,productInvoice:he.productInvoice,transportInvoice:he.transportInvoice});try{let Oe;if(he.productInvoice||he.transportInvoice){console.log(" Files detected (update), using FormData...");const Ne=new FormData,Ae={date:he.date,sprzedawca:he.sprzedawca,wartosc:he.wartosc,kosztDostawy:he.kosztDostawy,products:he.products};Ne.append("data",JSON.stringify(Ae)),console.log(" JSON data (update):",Ae),he.productInvoice&&(Ne.append("productInvoice",he.productInvoice),console.log(" Product invoice added (update):",he.productInvoice.name)),he.transportInvoice&&(Ne.append("transportInvoice",he.transportInvoice),console.log(" Transport invoice added (update):",he.transportInvoice.name)),console.log(" FormData entries (update):");for(let[et,at]of Ne.entries())console.log(`  ${et}:`,at);Oe=await fetch(`${er}/api/product-receipts/${he.id}`,{method:"PUT",body:Ne})}else console.log(" No files (update), using JSON..."),Oe=await fetch(`${er}/api/product-receipts/${he.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:he.date,sprzedawca:he.sprzedawca,wartosc:he.wartosc,kosztDostawy:he.kosztDostawy,aktualnyKurs:he.aktualnyKurs,podatekAkcyzowy:he.podatekAkcyzowy,products:he.products})});if(!Oe.ok)throw new Error("Failed to update product receipt");const Ie=await Oe.json();console.log("Updated receipt:",Ie),console.log("Loading updated receipts...");const X=await Ht();console.log("Updated receipts:",X),console.log("Loading updated products...");const me=await _t();console.log("Updated products:",me),console.log("Updating app state..."),S(Ne=>{const Ae={...Ne,productReceipts:X,products:me};return console.log("New app state:",Ae),Ae}),Xe.success("Zakup zosta zaktualizowany"),Q(!1),ue(null),h(!1),v(null)}catch(Oe){console.error("Error updating product receipt:",Oe),Xe.error("Wystpi bd podczas aktualizacji zakupu")}},Nt=async he=>{try{if(!(await fetch(`${er}/api/product-receipts/${he}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const Ie=await Ht(),X=await _t();S(me=>({...me,productReceipts:Ie,products:X})),Xe.success("Zakup zosta usunity")}catch(Oe){console.error("Error deleting receipt:",Oe),Xe.error("Wystpi bd podczas usuwania zakupu")}},zt=async he=>{try{const Oe=await fetch(`${er}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!Oe.ok)throw new Error("Failed to add client");const Ie=await Oe.json(),X={...he,id:Ie.id};S(me=>({...me,clients:[...me.clients,X]})),I(me=>me+1),Xe.success("Klient zosta dodany")}catch(Oe){console.error("Error adding client:",Oe),Xe.error("Bd podczas dodawania klienta")}},Qt=async he=>{try{if(!(await fetch(`${er}/api/clients/${he}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");S(Ie=>({...Ie,clients:Ie.clients.filter(X=>X.id!==he)})),I(Ie=>Ie+1),Xe.success("Klient zosta usunity")}catch(Oe){console.error("Error deleting client:",Oe),Xe.error("Bd podczas usuwania klienta")}},qt=async he=>{try{console.log(" handleUpdateClient called with data:",he);const Oe=await fetch(`${er}/api/clients/${he.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!Oe.ok)throw new Error("Failed to update client");const Ie=await Oe.json();console.log(" Client updated in database:",Ie),console.log(" Updated client fields:",{id:Ie.id,firma:Ie.firma,nazwa:Ie.nazwa,adres:Ie.adres,czas_dostawy:Ie.czas_dostawy,kontakt:Ie.kontakt}),S(X=>{console.log(" Updating app state..."),console.log(" Previous clients:",X.clients),console.log(" Updated client data:",Ie);const me=X.clients.map(Ae=>Ae.id===he.id?(console.log(" Updating client:",Ae.id,"from:",Ae,"to:",{...Ae,...Ie}),{id:Ae.id,firma:Ie.firma||Ae.firma,nazwa:Ie.nazwa||Ae.nazwa,adres:Ie.adres||Ae.adres,czas_dostawy:Ie.czas_dostawy||Ae.czas_dostawy,kontakt:Ie.kontakt||Ae.kontakt}):{...Ae});console.log(" New clients array:",me);const Ne={...X,clients:me};return console.log(" New app state:",Ne),Ne}),Xe.success("Klient zosta zaktualizowany"),setTimeout(()=>{S(X=>(console.log(" Force update after timeout"),{...X})),I(X=>X+1),xe(he.id),ut().then(X=>{S(me=>({...me,clients:X})),I(me=>me+1)})},100)}catch(Oe){console.error("Error updating client:",Oe),Xe.error("Bd podczas aktualizacji klienta")}},Bt=async()=>{try{R(!0),Z(null);const he=await fetch(`${er}/api/reservations/active-products`);if(!he.ok)throw new Error(`HTTP ${he.status}`);const Oe=await he.json();console.log(" Active reservation products loaded:",Oe.length),F(Oe)}catch(he){console.error(" Error loading analysis products:",he),Z(he.message||"Bd adowania danych")}finally{R(!1)}},rr=async he=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",he),console.log("Products data:",JSON.stringify(he.products,null,2));try{const Oe=await fetch(`${er}/api/orders/${he.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!Oe.ok)throw new Error("Failed to update order");const Ie=await Oe.json();console.log("Updated order result:",Ie),Xe.success("Zamwienie zostao zaktualizowane"),B(X=>X+1)}catch(Oe){console.error("Error updating order:",Oe),Xe.error("Bd podczas aktualizacji zamwienia")}},ut=async()=>{try{console.log(" Loading clients from:",`${er}/api/clients`);const he=await fetch(`${er}/api/clients`);if(console.log(" Clients response status:",he.status),!he.ok)throw new Error(`HTTP error! status: ${he.status}`);const Oe=await he.json();return console.log(" Loaded clients:",Oe.length,"records"),console.log(" First client:",Oe[0]),Oe}catch(he){return console.error(" Error loading clients:",he),[]}},_t=async()=>{try{console.log(" Loading products from:",`${er}/api/products`);const he=await fetch(`${er}/api/products`);if(console.log(" Products response status:",he.status),!he.ok)throw new Error(`HTTP error! status: ${he.status}`);const Oe=await he.json();console.log(" Loaded products:",Oe.length,"records"),console.log(" First product:",Oe[0]);const Ie=Oe.map(X=>({kod:X.kod,nazwa:X.nazwa,ilosc:X.ilosc,jednostka_miary:X.jednostka_miary||"",kod_kreskowy:X.kod_kreskowy||"",data_waznosci:X.data_waznosci??void 0,archiwalny:X.archiwalny,rezerwacje:X.rezerwacje,ilosc_na_poleceniach:X.ilosc_na_poleceniach,waga_netto:X.waga_netto,waga_brutto:X.waga_brutto,objetosc:X.objetosc,opis:X.opis}));return console.log(" Processed products:",Ie.length,"records"),Ie}catch(he){return console.error(" Error loading products:",he),[]}},Ht=async()=>{try{console.log(" Loading product receipts from:",`${er}/api/product-receipts`);const he=await fetch(`${er}/api/product-receipts`);if(console.log(" Product receipts response status:",he.status),!he.ok)throw new Error(`HTTP error! status: ${he.status}`);const Oe=await he.json();return console.log(" Loaded product receipts:",Oe.length,"records"),Oe.map(Ie=>({id:Ie.id,dataPrzyjecia:Ie.dataPrzyjecia,sprzedawca:Ie.sprzedawca||"",wartosc:Ie.wartosc||0,kosztDostawy:Ie.kosztDostawy||0,aktualny_kurs:Ie.aktualny_kurs,podatek_akcyzowy:Ie.podatek_akcyzowy,aktualnyKurs:Ie.aktualnyKurs,podatekAkcyzowy:Ie.podatekAkcyzowy,products:Ie.products||[],productInvoice:Ie.productInvoice,transportInvoice:Ie.transportInvoice}))}catch(he){return console.error(" Error loading product receipts:",he),[]}},Dt=async he=>{try{console.log(" Searching working_sheets with query:",he),console.log(" Making request to:",`${er}/api/working-sheets/search?query=${encodeURIComponent(he)}`);const Oe=await fetch(`${er}/api/working-sheets/search?query=${encodeURIComponent(he)}`);if(console.log(" Search response status:",Oe.status),!Oe.ok)throw new Error(`HTTP error! status: ${Oe.status}`);const Ie=await Oe.json();return console.log(" Search results:",Ie.length,"items found"),Ie.map(me=>({kod:me.kod,nazwa:me.nazwa,ilosc:me.ilosc.toString(),kodKreskowy:me.kod_kreskowy||""}))}catch(Oe){return console.error(" Error searching working_sheets:",Oe),[]}},Zt=()=>{B(he=>he+1)},$t=()=>{B(he=>he+1)};return u.jsxs("div",{className:"min-h-screen bg-gray-100",children:[u.jsx(PO,{position:"top-right"}),u.jsx(gw,{isOpen:H,onClose:()=>L(!1),product:null}),u.jsx(z4,{isOpen:e,onClose:()=>n(!1),onUpload:ve}),u.jsx(L4,{isOpen:l,onClose:()=>c(!1),fileName:"",onConfirm:lt}),u.jsx(WP,{isOpen:a,onClose:()=>o(!1),onSubmit:ft}),u.jsx(JO,{isOpen:t,onClose:()=>r(!1),onAdd:zt}),u.jsx(ww,{isOpen:le,onClose:()=>{oe(!1),G(null)},onSubmit:qt,client:pe}),u.jsx(vw,{isOpen:f,onClose:()=>h(!1),receipt:g}),u.jsx(yw,{isOpen:ae,onClose:()=>{Q(!1),ue(null)},onSubmit:gt,receipt:Y}),u.jsx(OO,{isOpen:z,onClose:()=>te(!1),onOrderCreated:Zt}),u.jsx(iR,{isOpen:V,onClose:()=>D(!1),onSubmit:$t}),u.jsx(lR,{isOpen:p,onClose:()=>m(!1),onReservationCreated:()=>{re(he=>he+1),m(!1)},apiUrl:er}),u.jsx("div",{className:"bg-white shadow-sm",children:u.jsx("div",{className:"container mx-auto px-4 py-3",children:u.jsx("img",{src:ZO,alt:"Enoterra Logo",className:"h-32"})})}),u.jsx("div",{className:"bg-gray-100",children:u.jsx("div",{className:"container mx-auto px-4",children:u.jsx("div",{className:"flex items-center h-14",children:u.jsx("div",{className:"flex space-x-4",children:b.map(he=>u.jsx("div",{draggable:!0,onDragStart:()=>Me(he),onDragOver:Pe,onDrop:()=>ce(he),className:`relative -mb-px cursor-pointer ${N.activeTab===he?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${k===he?"opacity-50":""}`,onClick:()=>Fe(he),children:u.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:De(he)})},he))})})})}),u.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:u.jsx("div",{className:"container mx-auto px-4 py-6",children:u.jsxs("div",{className:"flex items-start -mt-2",children:[N.activeTab==="inventory"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>Re("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${N.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjcie towarw"}),u.jsx("button",{onClick:()=>Re("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${N.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupw"}),u.jsx("button",{onClick:()=>Re("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${N.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz patnoci"})]}),N.activeSubTab==="przyjecie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(_a,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>cR(n),children:[u.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:u.jsx(g2,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),u.jsx(eR,{receipts:N.productReceipts,onDelete:Nt,onUpdate:gt})]}),N.activeSubTab==="analiza"&&u.jsx("div",{className:"flex flex-col gap-4",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupw"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupw bdzie dostpna wkrtce."})]})}),N.activeSubTab==="kalendarz"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz patnoci"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza patnoci bdzie dostpna wkrtce."})]})})]}),N.activeTab==="inventory"&&u.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:N.sheets.map(he=>u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("button",{onClick:()=>ye(he),title:":     ",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:he.fileName})},he.fileName))}),N.activeTab==="inventory"&&N.showTable&&N.activeSheet&&u.jsx("div",{className:"mt-6 bg-white",children:u.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:u.jsx(UP,{data:N.activeSheet.data})})}),N.activeTab==="clients"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(_a,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),u.jsx(rR,{clients:N.clients,onDelete:Qt,onUpdate:qt},`clients-${de}-${U||"none"}`)]}),N.activeTab==="orders"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>Re("wydanie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${N.activeSubTab==="wydanie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Wydanie towarw"}),u.jsx("button",{onClick:()=>Re("rezerwacje"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${N.activeSubTab==="rezerwacje"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Rezerwacje"}),u.jsx("button",{onClick:()=>Re("analiza_towarow"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${N.activeSubTab==="analiza_towarow"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza towarw"}),u.jsx("button",{onClick:()=>Re("faktury"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${N.activeSubTab==="faktury"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Faktury"})]}),N.activeSubTab==="wydanie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsx("div",{className:"mb-4",children:u.jsx("div",{className:"w-1/2 mx-auto",children:u.jsx(HP,{onSearch:Dt})})}),u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>te(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(_a,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>D(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:u.jsx(Ct,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]})]}),u.jsx(IO,{onDeleteOrder:he=>{console.log("Delete order:",he)},onUpdateOrder:rr,refreshTrigger:ie})]}),N.activeSubTab==="rezerwacje"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>m(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(_a,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj rezerwacj"})})]})}),u.jsx(BO,{refreshTrigger:j})]}),N.activeSubTab==="analiza_towarow"&&u.jsxs("div",{className:"space-y-4 mt-6",children:[O&&u.jsx("div",{className:"text-gray-600 font-sora text-sm",children:"adowanie danych..."}),J&&u.jsx("div",{className:"text-red-600 font-sora text-sm",children:J}),!O&&!J&&u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Kod"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Nazwa"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Pozostao"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Wydane"}),u.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Zarezerwowane"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.length>0?T.map((he,Oe)=>{const Ie=he.ilosc??0,X=he.ilosc_wydane??0,me=Ie-X,Ne=he.product_kod??"",Ae=he.product_nazwa??"";return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:Ne}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:Ae}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center",children:u.jsx("span",{className:me>0?"text-green-600 font-medium":"text-gray-400",children:me})}),u.jsxs("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center text-red-600 cursor-pointer","data-tooltip-id":`wydane-tooltip-${he.reservation_id}-${he.product_kod}-${Oe}`,children:[X,X>0&&u.jsx(ti,{id:`wydane-tooltip-${he.reservation_id}-${he.product_kod}-${Oe}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:he.zamowienia_z_iloscia&&he.zamowienia_z_iloscia.length>0?he.zamowienia_z_iloscia.map((et,at)=>u.jsxs("div",{className:at===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:et.numer_zamowienia}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[et.ilosc," szt"]})]},at)):u.jsx("div",{children:"Brak danych o zamwieniach"})})})]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center cursor-pointer","data-tooltip-id":`zarezerwowane-tooltip-${he.reservation_id}-${he.product_kod}-${Oe}`,children:[Ie,u.jsx(ti,{id:`zarezerwowane-tooltip-${he.reservation_id}-${he.product_kod}-${Oe}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:T.filter(et=>et.product_kod===he.product_kod).map((et,at)=>u.jsxs("div",{className:at===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:et.klient||""}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[et.ilosc??0," szt"]})]},at))})})]})]},`${he.reservation_id}-${he.product_kod}-${Oe}`)}):u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak towarw w aktywnych rezerwacjach"})})})]})})]}),N.activeSubTab==="faktury"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Faktury"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja faktur bdzie dostpna wkrtce."})]})})]}),N.activeTab==="inventoryStatus"&&u.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:u.jsx(oR,{productReceipts:N.productReceipts})})]})})})]})}h2.createRoot(document.getElementById("root")).render(u.jsx(C.StrictMode,{children:u.jsx(dR,{})}));
