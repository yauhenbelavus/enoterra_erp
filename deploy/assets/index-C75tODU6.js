function a2(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Ku(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s2(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var Uf={exports:{}},Zi={},Hf={exports:{}},_t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var px;function o2(){if(px)return _t;px=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.iterator;function g(B){return B===null||typeof B!="object"?null:(B=x&&B[x]||B["@@iterator"],typeof B=="function"?B:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function _(B,S,R){this.props=B,this.context=S,this.refs=w,this.updater=R||y}_.prototype.isReactComponent={},_.prototype.setState=function(B,S){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,S,"setState")},_.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function E(){}E.prototype=_.prototype;function A(B,S,R){this.props=B,this.context=S,this.refs=w,this.updater=R||y}var T=A.prototype=new E;T.constructor=A,k(T,_.prototype),T.isPureReactComponent=!0;var L=Array.isArray,J=Object.prototype.hasOwnProperty,O={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function Z(B,S,R){var P,W={},H=null,ee=null;if(S!=null)for(P in S.ref!==void 0&&(ee=S.ref),S.key!==void 0&&(H=""+S.key),S)J.call(S,P)&&!C.hasOwnProperty(P)&&(W[P]=S[P]);var se=arguments.length-2;if(se===1)W.children=R;else if(1<se){for(var Q=Array(se),he=0;he<se;he++)Q[he]=arguments[he+2];W.children=Q}if(B&&B.defaultProps)for(P in se=B.defaultProps,se)W[P]===void 0&&(W[P]=se[P]);return{$$typeof:e,type:B,key:H,ref:ee,props:W,_owner:O.current}}function M(B,S){return{$$typeof:e,type:B.type,key:S,ref:B.ref,props:B.props,_owner:B._owner}}function ne(B){return typeof B=="object"&&B!==null&&B.$$typeof===e}function G(B){var S={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(R){return S[R]})}var z=/\/+/g;function fe(B,S){return typeof B=="object"&&B!==null&&B.key!=null?G(""+B.key):S.toString(36)}function ue(B,S,R,P,W){var H=typeof B;(H==="undefined"||H==="boolean")&&(B=null);var ee=!1;if(B===null)ee=!0;else switch(H){case"string":case"number":ee=!0;break;case"object":switch(B.$$typeof){case e:case n:ee=!0}}if(ee)return ee=B,W=W(ee),B=P===""?"."+fe(ee,0):P,L(W)?(R="",B!=null&&(R=B.replace(z,"$&/")+"/"),ue(W,S,R,"",function(he){return he})):W!=null&&(ne(W)&&(W=M(W,R+(!W.key||ee&&ee.key===W.key?"":(""+W.key).replace(z,"$&/")+"/")+B)),S.push(W)),1;if(ee=0,P=P===""?".":P+":",L(B))for(var se=0;se<B.length;se++){H=B[se];var Q=P+fe(H,se);ee+=ue(H,S,R,Q,W)}else if(Q=g(B),typeof Q=="function")for(B=Q.call(B),se=0;!(H=B.next()).done;)H=H.value,Q=P+fe(H,se++),ee+=ue(H,S,R,Q,W);else if(H==="object")throw S=String(B),Error("Objects are not valid as a React child (found: "+(S==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":S)+"). If you meant to render a collection of children, use an array instead.");return ee}function oe(B,S,R){if(B==null)return B;var P=[],W=0;return ue(B,P,"","",function(H){return S.call(R,H,W++)}),P}function pe(B){if(B._status===-1){var S=B._result;S=S(),S.then(function(R){(B._status===0||B._status===-1)&&(B._status=1,B._result=R)},function(R){(B._status===0||B._status===-1)&&(B._status=2,B._result=R)}),B._status===-1&&(B._status=0,B._result=S)}if(B._status===1)return B._result.default;throw B._result}var V={current:null},ie={transition:null},q={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:ie,ReactCurrentOwner:O};function ae(){throw Error("act(...) is not supported in production builds of React.")}return _t.Children={map:oe,forEach:function(B,S,R){oe(B,function(){S.apply(this,arguments)},R)},count:function(B){var S=0;return oe(B,function(){S++}),S},toArray:function(B){return oe(B,function(S){return S})||[]},only:function(B){if(!ne(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},_t.Component=_,_t.Fragment=t,_t.Profiler=a,_t.PureComponent=A,_t.StrictMode=r,_t.Suspense=f,_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q,_t.act=ae,_t.cloneElement=function(B,S,R){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var P=k({},B.props),W=B.key,H=B.ref,ee=B._owner;if(S!=null){if(S.ref!==void 0&&(H=S.ref,ee=O.current),S.key!==void 0&&(W=""+S.key),B.type&&B.type.defaultProps)var se=B.type.defaultProps;for(Q in S)J.call(S,Q)&&!C.hasOwnProperty(Q)&&(P[Q]=S[Q]===void 0&&se!==void 0?se[Q]:S[Q])}var Q=arguments.length-2;if(Q===1)P.children=R;else if(1<Q){se=Array(Q);for(var he=0;he<Q;he++)se[he]=arguments[he+2];P.children=se}return{$$typeof:e,type:B.type,key:W,ref:H,props:P,_owner:ee}},_t.createContext=function(B){return B={$$typeof:l,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:o,_context:B},B.Consumer=B},_t.createElement=Z,_t.createFactory=function(B){var S=Z.bind(null,B);return S.type=B,S},_t.createRef=function(){return{current:null}},_t.forwardRef=function(B){return{$$typeof:c,render:B}},_t.isValidElement=ne,_t.lazy=function(B){return{$$typeof:p,_payload:{_status:-1,_result:B},_init:pe}},_t.memo=function(B,S){return{$$typeof:h,type:B,compare:S===void 0?null:S}},_t.startTransition=function(B){var S=ie.transition;ie.transition={};try{B()}finally{ie.transition=S}},_t.unstable_act=ae,_t.useCallback=function(B,S){return V.current.useCallback(B,S)},_t.useContext=function(B){return V.current.useContext(B)},_t.useDebugValue=function(){},_t.useDeferredValue=function(B){return V.current.useDeferredValue(B)},_t.useEffect=function(B,S){return V.current.useEffect(B,S)},_t.useId=function(){return V.current.useId()},_t.useImperativeHandle=function(B,S,R){return V.current.useImperativeHandle(B,S,R)},_t.useInsertionEffect=function(B,S){return V.current.useInsertionEffect(B,S)},_t.useLayoutEffect=function(B,S){return V.current.useLayoutEffect(B,S)},_t.useMemo=function(B,S){return V.current.useMemo(B,S)},_t.useReducer=function(B,S,R){return V.current.useReducer(B,S,R)},_t.useRef=function(B){return V.current.useRef(B)},_t.useState=function(B){return V.current.useState(B)},_t.useSyncExternalStore=function(B,S,R){return V.current.useSyncExternalStore(B,S,R)},_t.useTransition=function(){return V.current.useTransition()},_t.version="18.3.1",_t}var hx;function Nl(){return hx||(hx=1,Hf.exports=o2()),Hf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mx;function i2(){if(mx)return Zi;mx=1;var e=Nl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,h){var p,x={},g=null,y=null;h!==void 0&&(g=""+h),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(y=f.ref);for(p in f)r.call(f,p)&&!o.hasOwnProperty(p)&&(x[p]=f[p]);if(c&&c.defaultProps)for(p in f=c.defaultProps,f)x[p]===void 0&&(x[p]=f[p]);return{$$typeof:n,type:c,key:g,ref:y,props:x,_owner:a.current}}return Zi.Fragment=t,Zi.jsx=l,Zi.jsxs=l,Zi}var xx;function l2(){return xx||(xx=1,Uf.exports=i2()),Uf.exports}var d=l2(),N=Nl();const De=Ku(N),Mv=a2({__proto__:null,default:De},[N]);var Yc={},$f={exports:{}},vn={},Yf={exports:{}},Vf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function c2(){return gx||(gx=1,(function(e){function n(ie,q){var ae=ie.length;ie.push(q);e:for(;0<ae;){var B=ae-1>>>1,S=ie[B];if(0<a(S,q))ie[B]=q,ie[ae]=S,ae=B;else break e}}function t(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var q=ie[0],ae=ie.pop();if(ae!==q){ie[0]=ae;e:for(var B=0,S=ie.length,R=S>>>1;B<R;){var P=2*(B+1)-1,W=ie[P],H=P+1,ee=ie[H];if(0>a(W,ae))H<S&&0>a(ee,W)?(ie[B]=ee,ie[H]=ae,B=H):(ie[B]=W,ie[P]=ae,B=P);else if(H<S&&0>a(ee,ae))ie[B]=ee,ie[H]=ae,B=H;else break e}}return q}function a(ie,q){var ae=ie.sortIndex-q.sortIndex;return ae!==0?ae:ie.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],h=[],p=1,x=null,g=3,y=!1,k=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(ie){for(var q=t(h);q!==null;){if(q.callback===null)r(h);else if(q.startTime<=ie)r(h),q.sortIndex=q.expirationTime,n(f,q);else break;q=t(h)}}function L(ie){if(w=!1,T(ie),!k)if(t(f)!==null)k=!0,pe(J);else{var q=t(h);q!==null&&V(L,q.startTime-ie)}}function J(ie,q){k=!1,w&&(w=!1,E(Z),Z=-1),y=!0;var ae=g;try{for(T(q),x=t(f);x!==null&&(!(x.expirationTime>q)||ie&&!G());){var B=x.callback;if(typeof B=="function"){x.callback=null,g=x.priorityLevel;var S=B(x.expirationTime<=q);q=e.unstable_now(),typeof S=="function"?x.callback=S:x===t(f)&&r(f),T(q)}else r(f);x=t(f)}if(x!==null)var R=!0;else{var P=t(h);P!==null&&V(L,P.startTime-q),R=!1}return R}finally{x=null,g=ae,y=!1}}var O=!1,C=null,Z=-1,M=5,ne=-1;function G(){return!(e.unstable_now()-ne<M)}function z(){if(C!==null){var ie=e.unstable_now();ne=ie;var q=!0;try{q=C(!0,ie)}finally{q?fe():(O=!1,C=null)}}else O=!1}var fe;if(typeof A=="function")fe=function(){A(z)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,oe=ue.port2;ue.port1.onmessage=z,fe=function(){oe.postMessage(null)}}else fe=function(){_(z,0)};function pe(ie){C=ie,O||(O=!0,fe())}function V(ie,q){Z=_(function(){ie(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){k||y||(k=!0,pe(J))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(ie){switch(g){case 1:case 2:case 3:var q=3;break;default:q=g}var ae=g;g=q;try{return ie()}finally{g=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,q){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ae=g;g=ie;try{return q()}finally{g=ae}},e.unstable_scheduleCallback=function(ie,q,ae){var B=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?B+ae:B):ae=B,ie){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=ae+S,ie={id:p++,callback:q,priorityLevel:ie,startTime:ae,expirationTime:S,sortIndex:-1},ae>B?(ie.sortIndex=ae,n(h,ie),t(f)===null&&ie===t(h)&&(w?(E(Z),Z=-1):w=!0,V(L,ae-B))):(ie.sortIndex=S,n(f,ie),k||y||(k=!0,pe(J))),ie},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(ie){var q=g;return function(){var ae=g;g=q;try{return ie.apply(this,arguments)}finally{g=ae}}}})(Vf)),Vf}var vx;function u2(){return vx||(vx=1,Yf.exports=c2()),Yf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yx;function f2(){if(yx)return vn;yx=1;var e=Nl(),n=u2();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},x={};function g(s){return f.call(x,s)?!0:f.call(p,s)?!1:h.test(s)?x[s]=!0:(p[s]=!0,!1)}function y(s,i,u,m){if(u!==null&&u.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function k(s,i,u,m){if(i===null||typeof i>"u"||y(s,i,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function w(s,i,u,m,v,b,D){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=u,this.propertyName=s,this.type=i,this.sanitizeURL=b,this.removeEmptyString=D}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){_[s]=new w(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];_[i]=new w(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){_[s]=new w(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){_[s]=new w(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){_[s]=new w(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){_[s]=new w(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){_[s]=new w(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){_[s]=new w(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){_[s]=new w(s,5,!1,s.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function A(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(E,A);_[i]=new w(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(E,A);_[i]=new w(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(E,A);_[i]=new w(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!1,!1)}),_.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,i,u,m){var v=_.hasOwnProperty(i)?_[i]:null;(v!==null?v.type!==0:m||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,u,v,m)&&(u=null),m||v===null?g(i)&&(u===null?s.removeAttribute(i):s.setAttribute(i,""+u)):v.mustUseProperty?s[v.propertyName]=u===null?v.type===3?!1:"":u:(i=v.attributeName,m=v.attributeNamespace,u===null?s.removeAttribute(i):(v=v.type,u=v===3||v===4&&u===!0?"":""+u,m?s.setAttributeNS(m,i,u):s.setAttribute(i,u))))}var L=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,J=Symbol.for("react.element"),O=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),G=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),ie=Symbol.iterator;function q(s){return s===null||typeof s!="object"?null:(s=ie&&s[ie]||s["@@iterator"],typeof s=="function"?s:null)}var ae=Object.assign,B;function S(s){if(B===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);B=i&&i[1]||""}return`
`+B+s}var R=!1;function P(s,i){if(!s||R)return"";R=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Se){var m=Se}Reflect.construct(s,[],i)}else{try{i.call()}catch(Se){m=Se}s.call(i.prototype)}else{try{throw Error()}catch(Se){m=Se}s()}}catch(Se){if(Se&&m&&typeof Se.stack=="string"){for(var v=Se.stack.split(`
`),b=m.stack.split(`
`),D=v.length-1,te=b.length-1;1<=D&&0<=te&&v[D]!==b[te];)te--;for(;1<=D&&0<=te;D--,te--)if(v[D]!==b[te]){if(D!==1||te!==1)do if(D--,te--,0>te||v[D]!==b[te]){var ce=`
`+v[D].replace(" at new "," at ");return s.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",s.displayName)),ce}while(1<=D&&0<=te);break}}}finally{R=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?S(s):""}function W(s){switch(s.tag){case 5:return S(s.type);case 16:return S("Lazy");case 13:return S("Suspense");case 19:return S("SuspenseList");case 0:case 2:case 15:return s=P(s.type,!1),s;case 11:return s=P(s.type.render,!1),s;case 1:return s=P(s.type,!0),s;default:return""}}function H(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case O:return"Portal";case M:return"Profiler";case Z:return"StrictMode";case fe:return"Suspense";case ue:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case G:return(s.displayName||"Context")+".Consumer";case ne:return(s._context.displayName||"Context")+".Provider";case z:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case oe:return i=s.displayName||null,i!==null?i:H(s.type)||"Memo";case pe:i=s._payload,s=s._init;try{return H(s(i))}catch{}}return null}function ee(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(i);case 8:return i===Z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function se(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Q(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function he(s){var i=Q(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),m=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,b=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return v.call(this)},set:function(D){m=""+D,b.call(this,D)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(D){m=""+D},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function me(s){s._valueTracker||(s._valueTracker=he(s))}function I(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),m="";return s&&(m=Q(s)?s.checked?"true":"false":s.value),s=m,s!==u?(i.setValue(s),!0):!1}function Ve(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ce(s,i){var u=i.checked;return ae({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function ge(s,i){var u=i.defaultValue==null?"":i.defaultValue,m=i.checked!=null?i.checked:i.defaultChecked;u=se(i.value!=null?i.value:u),s._wrapperState={initialChecked:m,initialValue:u,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Ee(s,i){i=i.checked,i!=null&&T(s,"checked",i,!1)}function ye(s,i){Ee(s,i);var u=se(i.value),m=i.type;if(u!=null)m==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?Ze(s,i.type,u):i.hasOwnProperty("defaultValue")&&Ze(s,i.type,se(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Pe(s,i,u){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var m=i.type;if(!(m!=="submit"&&m!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,u||i===s.value||(s.value=i),s.defaultValue=i}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function Ze(s,i,u){(i!=="number"||Ve(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var Xe=Array.isArray;function wt(s,i,u,m){if(s=s.options,i){i={};for(var v=0;v<u.length;v++)i["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=i.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&m&&(s[u].defaultSelected=!0)}else{for(u=""+se(u),i=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,m&&(s[v].defaultSelected=!0);return}i!==null||s[v].disabled||(i=s[v])}i!==null&&(i.selected=!0)}}function qt(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return ae({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Pt(s,i){var u=i.value;if(u==null){if(u=i.children,i=i.defaultValue,u!=null){if(i!=null)throw Error(t(92));if(Xe(u)){if(1<u.length)throw Error(t(93));u=u[0]}i=u}i==null&&(i=""),u=i}s._wrapperState={initialValue:se(u)}}function Mt(s,i){var u=se(i.value),m=se(i.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),i.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),m!=null&&(s.defaultValue=""+m)}function ir(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Zt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lr(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Zt(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var It,Gt=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,u,m,v){MSApp.execUnsafeLocalFunction(function(){return s(i,u,m,v)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(It=It||document.createElement("div"),It.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=It.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function it(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$t=["Webkit","ms","Moz","O"];Object.keys(bt).forEach(function(s){$t.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),bt[i]=bt[s]})});function gt(s,i,u){return i==null||typeof i=="boolean"||i===""?"":u||typeof i!="number"||i===0||bt.hasOwnProperty(s)&&bt[s]?(""+i).trim():i+"px"}function re(s,i){s=s.style;for(var u in i)if(i.hasOwnProperty(u)){var m=u.indexOf("--")===0,v=gt(u,i[u],m);u==="float"&&(u="cssFloat"),m?s.setProperty(u,v):s[u]=v}}var Te=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ae(s,i){if(i){if(Te[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function ze(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var le=null;function Ne(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Oe=null,$e=null,qe=null;function lt(s){if(s=ji(s)){if(typeof Oe!="function")throw Error(t(280));var i=s.stateNode;i&&(i=oc(i),Oe(s.stateNode,s.type,i))}}function Ye(s){$e?qe?qe.push(s):qe=[s]:$e=s}function st(){if($e){var s=$e,i=qe;if(qe=$e=null,lt(s),i)for(s=0;s<i.length;s++)lt(i[s])}}function At(s,i){return s(i)}function at(){}var vt=!1;function Dr(s,i,u){if(vt)return s(i,u);vt=!0;try{return At(s,i,u)}finally{vt=!1,($e!==null||qe!==null)&&(at(),st())}}function en(s,i){var u=s.stateNode;if(u===null)return null;var m=oc(u);if(m===null)return null;u=m[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,i,typeof u));return u}var Ke=!1;if(c)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){Ke=!0}}),window.addEventListener("test",ot,ot),window.removeEventListener("test",ot,ot)}catch{Ke=!1}function ht(s,i,u,m,v,b,D,te,ce){var Se=Array.prototype.slice.call(arguments,3);try{i.apply(u,Se)}catch(Me){this.onError(Me)}}var Yt=!1,nr=null,F=!1,K=null,j={onError:function(s){Yt=!0,nr=s}};function U(s,i,u,m,v,b,D,te,ce){Yt=!1,nr=null,ht.apply(j,arguments)}function Y(s,i,u,m,v,b,D,te,ce){if(U.apply(this,arguments),Yt){if(Yt){var Se=nr;Yt=!1,nr=null}else throw Error(t(198));F||(F=!0,K=Se)}}function X(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function we(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Fe(s){if(X(s)!==s)throw Error(t(188))}function ve(s){var i=s.alternate;if(!i){if(i=X(s),i===null)throw Error(t(188));return i!==s?null:s}for(var u=s,m=i;;){var v=u.return;if(v===null)break;var b=v.alternate;if(b===null){if(m=v.return,m!==null){u=m;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===u)return Fe(v),s;if(b===m)return Fe(v),i;b=b.sibling}throw Error(t(188))}if(u.return!==m.return)u=v,m=b;else{for(var D=!1,te=v.child;te;){if(te===u){D=!0,u=v,m=b;break}if(te===m){D=!0,m=v,u=b;break}te=te.sibling}if(!D){for(te=b.child;te;){if(te===u){D=!0,u=b,m=v;break}if(te===m){D=!0,m=b,u=v;break}te=te.sibling}if(!D)throw Error(t(189))}}if(u.alternate!==m)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:i}function _e(s){return s=ve(s),s!==null?be(s):null}function be(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=be(s);if(i!==null)return i;s=s.sibling}return null}var Ie=n.unstable_scheduleCallback,He=n.unstable_cancelCallback,je=n.unstable_shouldYield,Le=n.unstable_requestPaint,Be=n.unstable_now,dt=n.unstable_getCurrentPriorityLevel,zt=n.unstable_ImmediatePriority,jt=n.unstable_UserBlockingPriority,pr=n.unstable_NormalPriority,Rs=n.unstable_LowPriority,Qa=n.unstable_IdlePriority,la=null,Nr=null;function vi(s){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(la,s,void 0,(s.current.flags&128)===128)}catch{}}var hr=Math.clz32?Math.clz32:_w,ww=Math.log,kw=Math.LN2;function _w(s){return s>>>=0,s===0?32:31-(ww(s)/kw|0)|0}var Ul=64,Hl=4194304;function yi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function $l(s,i){var u=s.pendingLanes;if(u===0)return 0;var m=0,v=s.suspendedLanes,b=s.pingedLanes,D=u&268435455;if(D!==0){var te=D&~v;te!==0?m=yi(te):(b&=D,b!==0&&(m=yi(b)))}else D=u&~v,D!==0?m=yi(D):b!==0&&(m=yi(b));if(m===0)return 0;if(i!==0&&i!==m&&(i&v)===0&&(v=m&-m,b=i&-i,v>=b||v===16&&(b&4194240)!==0))return i;if((m&4)!==0&&(m|=u&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=m;0<i;)u=31-hr(i),v=1<<u,m|=s[u],i&=~v;return m}function bw(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ew(s,i){for(var u=s.suspendedLanes,m=s.pingedLanes,v=s.expirationTimes,b=s.pendingLanes;0<b;){var D=31-hr(b),te=1<<D,ce=v[D];ce===-1?((te&u)===0||(te&m)!==0)&&(v[D]=bw(te,i)):ce<=i&&(s.expiredLanes|=te),b&=~te}}function l0(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function $p(){var s=Ul;return Ul<<=1,(Ul&4194240)===0&&(Ul=64),s}function c0(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function wi(s,i,u){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-hr(i),s[i]=u}function Sw(s,i){var u=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<u;){var v=31-hr(u),b=1<<v;i[v]=0,m[v]=-1,s[v]=-1,u&=~b}}function u0(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var m=31-hr(u),v=1<<m;v&i|s[m]&i&&(s[m]|=i),u&=~v}}var Bt=0;function Yp(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Vp,f0,Kp,Gp,Xp,d0=!1,Yl=[],qa=null,Za=null,Ja=null,ki=new Map,_i=new Map,es=[],Tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qp(s,i){switch(s){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":Ja=null;break;case"pointerover":case"pointerout":ki.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":_i.delete(i.pointerId)}}function bi(s,i,u,m,v,b){return s===null||s.nativeEvent!==b?(s={blockedOn:i,domEventName:u,eventSystemFlags:m,nativeEvent:b,targetContainers:[v]},i!==null&&(i=ji(i),i!==null&&f0(i)),s):(s.eventSystemFlags|=m,i=s.targetContainers,v!==null&&i.indexOf(v)===-1&&i.push(v),s)}function Cw(s,i,u,m,v){switch(i){case"focusin":return qa=bi(qa,s,i,u,m,v),!0;case"dragenter":return Za=bi(Za,s,i,u,m,v),!0;case"mouseover":return Ja=bi(Ja,s,i,u,m,v),!0;case"pointerover":var b=v.pointerId;return ki.set(b,bi(ki.get(b)||null,s,i,u,m,v)),!0;case"gotpointercapture":return b=v.pointerId,_i.set(b,bi(_i.get(b)||null,s,i,u,m,v)),!0}return!1}function qp(s){var i=Ms(s.target);if(i!==null){var u=X(i);if(u!==null){if(i=u.tag,i===13){if(i=we(u),i!==null){s.blockedOn=i,Xp(s.priority,function(){Kp(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Vl(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=h0(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var m=new u.constructor(u.type,u);le=m,u.target.dispatchEvent(m),le=null}else return i=ji(u),i!==null&&f0(i),s.blockedOn=u,!1;i.shift()}return!0}function Zp(s,i,u){Vl(s)&&u.delete(i)}function Dw(){d0=!1,qa!==null&&Vl(qa)&&(qa=null),Za!==null&&Vl(Za)&&(Za=null),Ja!==null&&Vl(Ja)&&(Ja=null),ki.forEach(Zp),_i.forEach(Zp)}function Ei(s,i){s.blockedOn===i&&(s.blockedOn=null,d0||(d0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Dw)))}function Si(s){function i(v){return Ei(v,s)}if(0<Yl.length){Ei(Yl[0],s);for(var u=1;u<Yl.length;u++){var m=Yl[u];m.blockedOn===s&&(m.blockedOn=null)}}for(qa!==null&&Ei(qa,s),Za!==null&&Ei(Za,s),Ja!==null&&Ei(Ja,s),ki.forEach(i),_i.forEach(i),u=0;u<es.length;u++)m=es[u],m.blockedOn===s&&(m.blockedOn=null);for(;0<es.length&&(u=es[0],u.blockedOn===null);)qp(u),u.blockedOn===null&&es.shift()}var _o=L.ReactCurrentBatchConfig,Kl=!0;function Nw(s,i,u,m){var v=Bt,b=_o.transition;_o.transition=null;try{Bt=1,p0(s,i,u,m)}finally{Bt=v,_o.transition=b}}function Fw(s,i,u,m){var v=Bt,b=_o.transition;_o.transition=null;try{Bt=4,p0(s,i,u,m)}finally{Bt=v,_o.transition=b}}function p0(s,i,u,m){if(Kl){var v=h0(s,i,u,m);if(v===null)A0(s,i,m,Gl,u),Qp(s,m);else if(Cw(v,s,i,u,m))m.stopPropagation();else if(Qp(s,m),i&4&&-1<Tw.indexOf(s)){for(;v!==null;){var b=ji(v);if(b!==null&&Vp(b),b=h0(s,i,u,m),b===null&&A0(s,i,m,Gl,u),b===v)break;v=b}v!==null&&m.stopPropagation()}else A0(s,i,m,null,u)}}var Gl=null;function h0(s,i,u,m){if(Gl=null,s=Ne(m),s=Ms(s),s!==null)if(i=X(s),i===null)s=null;else if(u=i.tag,u===13){if(s=we(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return Gl=s,null}function Jp(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dt()){case zt:return 1;case jt:return 4;case pr:case Rs:return 16;case Qa:return 536870912;default:return 16}default:return 16}}var ts=null,m0=null,Xl=null;function eh(){if(Xl)return Xl;var s,i=m0,u=i.length,m,v="value"in ts?ts.value:ts.textContent,b=v.length;for(s=0;s<u&&i[s]===v[s];s++);var D=u-s;for(m=1;m<=D&&i[u-m]===v[b-m];m++);return Xl=v.slice(s,1<m?1-m:void 0)}function Ql(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ql(){return!0}function th(){return!1}function wn(s){function i(u,m,v,b,D){this._reactName=u,this._targetInst=v,this.type=m,this.nativeEvent=b,this.target=D,this.currentTarget=null;for(var te in s)s.hasOwnProperty(te)&&(u=s[te],this[te]=u?u(b):b[te]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?ql:th,this.isPropagationStopped=th,this}return ae(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),i}var bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},x0=wn(bo),Ti=ae({},bo,{view:0,detail:0}),Aw=wn(Ti),g0,v0,Ci,Zl=ae({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:w0,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ci&&(Ci&&s.type==="mousemove"?(g0=s.screenX-Ci.screenX,v0=s.screenY-Ci.screenY):v0=g0=0,Ci=s),g0)},movementY:function(s){return"movementY"in s?s.movementY:v0}}),rh=wn(Zl),Ow=ae({},Zl,{dataTransfer:0}),Pw=wn(Ow),Rw=ae({},Ti,{relatedTarget:0}),y0=wn(Rw),Mw=ae({},bo,{animationName:0,elapsedTime:0,pseudoElement:0}),Iw=wn(Mw),jw=ae({},bo,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Lw=wn(jw),zw=ae({},bo,{data:0}),nh=wn(zw),Bw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ww={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hw(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Uw[s])?!!i[s]:!1}function w0(){return Hw}var $w=ae({},Ti,{key:function(s){if(s.key){var i=Bw[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ql(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ww[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:w0,charCode:function(s){return s.type==="keypress"?Ql(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ql(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yw=wn($w),Vw=ae({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ah=wn(Vw),Kw=ae({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:w0}),Gw=wn(Kw),Xw=ae({},bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qw=wn(Xw),qw=ae({},Zl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zw=wn(qw),Jw=[9,13,27,32],k0=c&&"CompositionEvent"in window,Di=null;c&&"documentMode"in document&&(Di=document.documentMode);var ek=c&&"TextEvent"in window&&!Di,sh=c&&(!k0||Di&&8<Di&&11>=Di),oh=" ",ih=!1;function lh(s,i){switch(s){case"keyup":return Jw.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ch(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Eo=!1;function tk(s,i){switch(s){case"compositionend":return ch(i);case"keypress":return i.which!==32?null:(ih=!0,oh);case"textInput":return s=i.data,s===oh&&ih?null:s;default:return null}}function rk(s,i){if(Eo)return s==="compositionend"||!k0&&lh(s,i)?(s=eh(),Xl=m0=ts=null,Eo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return sh&&i.locale!=="ko"?null:i.data;default:return null}}var nk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!nk[s.type]:i==="textarea"}function fh(s,i,u,m){Ye(m),i=nc(i,"onChange"),0<i.length&&(u=new x0("onChange","change",null,u,m),s.push({event:u,listeners:i}))}var Ni=null,Fi=null;function ak(s){Nh(s,0)}function Jl(s){var i=No(s);if(I(i))return s}function sk(s,i){if(s==="change")return i}var dh=!1;if(c){var _0;if(c){var b0="oninput"in document;if(!b0){var ph=document.createElement("div");ph.setAttribute("oninput","return;"),b0=typeof ph.oninput=="function"}_0=b0}else _0=!1;dh=_0&&(!document.documentMode||9<document.documentMode)}function hh(){Ni&&(Ni.detachEvent("onpropertychange",mh),Fi=Ni=null)}function mh(s){if(s.propertyName==="value"&&Jl(Fi)){var i=[];fh(i,Fi,s,Ne(s)),Dr(ak,i)}}function ok(s,i,u){s==="focusin"?(hh(),Ni=i,Fi=u,Ni.attachEvent("onpropertychange",mh)):s==="focusout"&&hh()}function ik(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Jl(Fi)}function lk(s,i){if(s==="click")return Jl(i)}function ck(s,i){if(s==="input"||s==="change")return Jl(i)}function uk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Yn=typeof Object.is=="function"?Object.is:uk;function Ai(s,i){if(Yn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),m=Object.keys(i);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var v=u[m];if(!f.call(i,v)||!Yn(s[v],i[v]))return!1}return!0}function xh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function gh(s,i){var u=xh(s);s=0;for(var m;u;){if(u.nodeType===3){if(m=s+u.textContent.length,s<=i&&m>=i)return{node:u,offset:i-s};s=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=xh(u)}}function vh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?vh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function yh(){for(var s=window,i=Ve();i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Ve(s.document)}return i}function E0(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function fk(s){var i=yh(),u=s.focusedElem,m=s.selectionRange;if(i!==u&&u&&u.ownerDocument&&vh(u.ownerDocument.documentElement,u)){if(m!==null&&E0(u)){if(i=m.start,s=m.end,s===void 0&&(s=i),"selectionStart"in u)u.selectionStart=i,u.selectionEnd=Math.min(s,u.value.length);else if(s=(i=u.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var v=u.textContent.length,b=Math.min(m.start,v);m=m.end===void 0?b:Math.min(m.end,v),!s.extend&&b>m&&(v=m,m=b,b=v),v=gh(u,b);var D=gh(u,m);v&&D&&(s.rangeCount!==1||s.anchorNode!==v.node||s.anchorOffset!==v.offset||s.focusNode!==D.node||s.focusOffset!==D.offset)&&(i=i.createRange(),i.setStart(v.node,v.offset),s.removeAllRanges(),b>m?(s.addRange(i),s.extend(D.node,D.offset)):(i.setEnd(D.node,D.offset),s.addRange(i)))}}for(i=[],s=u;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<i.length;u++)s=i[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var dk=c&&"documentMode"in document&&11>=document.documentMode,So=null,S0=null,Oi=null,T0=!1;function wh(s,i,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;T0||So==null||So!==Ve(m)||(m=So,"selectionStart"in m&&E0(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Oi&&Ai(Oi,m)||(Oi=m,m=nc(S0,"onSelect"),0<m.length&&(i=new x0("onSelect","select",null,i,u),s.push({event:i,listeners:m}),i.target=So)))}function ec(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var To={animationend:ec("Animation","AnimationEnd"),animationiteration:ec("Animation","AnimationIteration"),animationstart:ec("Animation","AnimationStart"),transitionend:ec("Transition","TransitionEnd")},C0={},kh={};c&&(kh=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function tc(s){if(C0[s])return C0[s];if(!To[s])return s;var i=To[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in kh)return C0[s]=i[u];return s}var _h=tc("animationend"),bh=tc("animationiteration"),Eh=tc("animationstart"),Sh=tc("transitionend"),Th=new Map,Ch="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(s,i){Th.set(s,i),o(i,[s])}for(var D0=0;D0<Ch.length;D0++){var N0=Ch[D0],pk=N0.toLowerCase(),hk=N0[0].toUpperCase()+N0.slice(1);rs(pk,"on"+hk)}rs(_h,"onAnimationEnd"),rs(bh,"onAnimationIteration"),rs(Eh,"onAnimationStart"),rs("dblclick","onDoubleClick"),rs("focusin","onFocus"),rs("focusout","onBlur"),rs(Sh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function Dh(s,i,u){var m=s.type||"unknown-event";s.currentTarget=u,Y(m,i,void 0,s),s.currentTarget=null}function Nh(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var m=s[u],v=m.event;m=m.listeners;e:{var b=void 0;if(i)for(var D=m.length-1;0<=D;D--){var te=m[D],ce=te.instance,Se=te.currentTarget;if(te=te.listener,ce!==b&&v.isPropagationStopped())break e;Dh(v,te,Se),b=ce}else for(D=0;D<m.length;D++){if(te=m[D],ce=te.instance,Se=te.currentTarget,te=te.listener,ce!==b&&v.isPropagationStopped())break e;Dh(v,te,Se),b=ce}}}if(F)throw s=K,F=!1,K=null,s}function Xt(s,i){var u=i[j0];u===void 0&&(u=i[j0]=new Set);var m=s+"__bubble";u.has(m)||(Fh(i,s,2,!1),u.add(m))}function F0(s,i,u){var m=0;i&&(m|=4),Fh(u,s,m,i)}var rc="_reactListening"+Math.random().toString(36).slice(2);function Ri(s){if(!s[rc]){s[rc]=!0,r.forEach(function(u){u!=="selectionchange"&&(mk.has(u)||F0(u,!1,s),F0(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[rc]||(i[rc]=!0,F0("selectionchange",!1,i))}}function Fh(s,i,u,m){switch(Jp(i)){case 1:var v=Nw;break;case 4:v=Fw;break;default:v=p0}u=v.bind(null,i,u,s),v=void 0,!Ke||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(v=!0),m?v!==void 0?s.addEventListener(i,u,{capture:!0,passive:v}):s.addEventListener(i,u,!0):v!==void 0?s.addEventListener(i,u,{passive:v}):s.addEventListener(i,u,!1)}function A0(s,i,u,m,v){var b=m;if((i&1)===0&&(i&2)===0&&m!==null)e:for(;;){if(m===null)return;var D=m.tag;if(D===3||D===4){var te=m.stateNode.containerInfo;if(te===v||te.nodeType===8&&te.parentNode===v)break;if(D===4)for(D=m.return;D!==null;){var ce=D.tag;if((ce===3||ce===4)&&(ce=D.stateNode.containerInfo,ce===v||ce.nodeType===8&&ce.parentNode===v))return;D=D.return}for(;te!==null;){if(D=Ms(te),D===null)return;if(ce=D.tag,ce===5||ce===6){m=b=D;continue e}te=te.parentNode}}m=m.return}Dr(function(){var Se=b,Me=Ne(u),We=[];e:{var Re=Th.get(s);if(Re!==void 0){var Qe=x0,et=s;switch(s){case"keypress":if(Ql(u)===0)break e;case"keydown":case"keyup":Qe=Yw;break;case"focusin":et="focus",Qe=y0;break;case"focusout":et="blur",Qe=y0;break;case"beforeblur":case"afterblur":Qe=y0;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=Pw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=Gw;break;case _h:case bh:case Eh:Qe=Iw;break;case Sh:Qe=Qw;break;case"scroll":Qe=Aw;break;case"wheel":Qe=Zw;break;case"copy":case"cut":case"paste":Qe=Lw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=ah}var tt=(i&4)!==0,mr=!tt&&s==="scroll",xe=tt?Re!==null?Re+"Capture":null:Re;tt=[];for(var de=Se,ke;de!==null;){ke=de;var Ue=ke.stateNode;if(ke.tag===5&&Ue!==null&&(ke=Ue,xe!==null&&(Ue=en(de,xe),Ue!=null&&tt.push(Mi(de,Ue,ke)))),mr)break;de=de.return}0<tt.length&&(Re=new Qe(Re,et,null,u,Me),We.push({event:Re,listeners:tt}))}}if((i&7)===0){e:{if(Re=s==="mouseover"||s==="pointerover",Qe=s==="mouseout"||s==="pointerout",Re&&u!==le&&(et=u.relatedTarget||u.fromElement)&&(Ms(et)||et[Fa]))break e;if((Qe||Re)&&(Re=Me.window===Me?Me:(Re=Me.ownerDocument)?Re.defaultView||Re.parentWindow:window,Qe?(et=u.relatedTarget||u.toElement,Qe=Se,et=et?Ms(et):null,et!==null&&(mr=X(et),et!==mr||et.tag!==5&&et.tag!==6)&&(et=null)):(Qe=null,et=Se),Qe!==et)){if(tt=rh,Ue="onMouseLeave",xe="onMouseEnter",de="mouse",(s==="pointerout"||s==="pointerover")&&(tt=ah,Ue="onPointerLeave",xe="onPointerEnter",de="pointer"),mr=Qe==null?Re:No(Qe),ke=et==null?Re:No(et),Re=new tt(Ue,de+"leave",Qe,u,Me),Re.target=mr,Re.relatedTarget=ke,Ue=null,Ms(Me)===Se&&(tt=new tt(xe,de+"enter",et,u,Me),tt.target=ke,tt.relatedTarget=mr,Ue=tt),mr=Ue,Qe&&et)t:{for(tt=Qe,xe=et,de=0,ke=tt;ke;ke=Co(ke))de++;for(ke=0,Ue=xe;Ue;Ue=Co(Ue))ke++;for(;0<de-ke;)tt=Co(tt),de--;for(;0<ke-de;)xe=Co(xe),ke--;for(;de--;){if(tt===xe||xe!==null&&tt===xe.alternate)break t;tt=Co(tt),xe=Co(xe)}tt=null}else tt=null;Qe!==null&&Ah(We,Re,Qe,tt,!1),et!==null&&mr!==null&&Ah(We,mr,et,tt,!0)}}e:{if(Re=Se?No(Se):window,Qe=Re.nodeName&&Re.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Re.type==="file")var rt=sk;else if(uh(Re))if(dh)rt=ck;else{rt=ik;var ut=ok}else(Qe=Re.nodeName)&&Qe.toLowerCase()==="input"&&(Re.type==="checkbox"||Re.type==="radio")&&(rt=lk);if(rt&&(rt=rt(s,Se))){fh(We,rt,u,Me);break e}ut&&ut(s,Re,Se),s==="focusout"&&(ut=Re._wrapperState)&&ut.controlled&&Re.type==="number"&&Ze(Re,"number",Re.value)}switch(ut=Se?No(Se):window,s){case"focusin":(uh(ut)||ut.contentEditable==="true")&&(So=ut,S0=Se,Oi=null);break;case"focusout":Oi=S0=So=null;break;case"mousedown":T0=!0;break;case"contextmenu":case"mouseup":case"dragend":T0=!1,wh(We,u,Me);break;case"selectionchange":if(dk)break;case"keydown":case"keyup":wh(We,u,Me)}var ft;if(k0)e:{switch(s){case"compositionstart":var mt="onCompositionStart";break e;case"compositionend":mt="onCompositionEnd";break e;case"compositionupdate":mt="onCompositionUpdate";break e}mt=void 0}else Eo?lh(s,u)&&(mt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(mt="onCompositionStart");mt&&(sh&&u.locale!=="ko"&&(Eo||mt!=="onCompositionStart"?mt==="onCompositionEnd"&&Eo&&(ft=eh()):(ts=Me,m0="value"in ts?ts.value:ts.textContent,Eo=!0)),ut=nc(Se,mt),0<ut.length&&(mt=new nh(mt,s,null,u,Me),We.push({event:mt,listeners:ut}),ft?mt.data=ft:(ft=ch(u),ft!==null&&(mt.data=ft)))),(ft=ek?tk(s,u):rk(s,u))&&(Se=nc(Se,"onBeforeInput"),0<Se.length&&(Me=new nh("onBeforeInput","beforeinput",null,u,Me),We.push({event:Me,listeners:Se}),Me.data=ft))}Nh(We,i)})}function Mi(s,i,u){return{instance:s,listener:i,currentTarget:u}}function nc(s,i){for(var u=i+"Capture",m=[];s!==null;){var v=s,b=v.stateNode;v.tag===5&&b!==null&&(v=b,b=en(s,u),b!=null&&m.unshift(Mi(s,b,v)),b=en(s,i),b!=null&&m.push(Mi(s,b,v))),s=s.return}return m}function Co(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Ah(s,i,u,m,v){for(var b=i._reactName,D=[];u!==null&&u!==m;){var te=u,ce=te.alternate,Se=te.stateNode;if(ce!==null&&ce===m)break;te.tag===5&&Se!==null&&(te=Se,v?(ce=en(u,b),ce!=null&&D.unshift(Mi(u,ce,te))):v||(ce=en(u,b),ce!=null&&D.push(Mi(u,ce,te)))),u=u.return}D.length!==0&&s.push({event:i,listeners:D})}var xk=/\r\n?/g,gk=/\u0000|\uFFFD/g;function Oh(s){return(typeof s=="string"?s:""+s).replace(xk,`
`).replace(gk,"")}function ac(s,i,u){if(i=Oh(i),Oh(s)!==i&&u)throw Error(t(425))}function sc(){}var O0=null,P0=null;function R0(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var M0=typeof setTimeout=="function"?setTimeout:void 0,vk=typeof clearTimeout=="function"?clearTimeout:void 0,Ph=typeof Promise=="function"?Promise:void 0,yk=typeof queueMicrotask=="function"?queueMicrotask:typeof Ph<"u"?function(s){return Ph.resolve(null).then(s).catch(wk)}:M0;function wk(s){setTimeout(function(){throw s})}function I0(s,i){var u=i,m=0;do{var v=u.nextSibling;if(s.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(m===0){s.removeChild(v),Si(i);return}m--}else u!=="$"&&u!=="$?"&&u!=="$!"||m++;u=v}while(u);Si(i)}function ns(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Rh(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}var Do=Math.random().toString(36).slice(2),ca="__reactFiber$"+Do,Ii="__reactProps$"+Do,Fa="__reactContainer$"+Do,j0="__reactEvents$"+Do,kk="__reactListeners$"+Do,_k="__reactHandles$"+Do;function Ms(s){var i=s[ca];if(i)return i;for(var u=s.parentNode;u;){if(i=u[Fa]||u[ca]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=Rh(s);s!==null;){if(u=s[ca])return u;s=Rh(s)}return i}s=u,u=s.parentNode}return null}function ji(s){return s=s[ca]||s[Fa],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function No(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function oc(s){return s[Ii]||null}var L0=[],Fo=-1;function as(s){return{current:s}}function Qt(s){0>Fo||(s.current=L0[Fo],L0[Fo]=null,Fo--)}function Vt(s,i){Fo++,L0[Fo]=s.current,s.current=i}var ss={},Hr=as(ss),pn=as(!1),Is=ss;function Ao(s,i){var u=s.type.contextTypes;if(!u)return ss;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===i)return m.__reactInternalMemoizedMaskedChildContext;var v={},b;for(b in u)v[b]=i[b];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=v),v}function hn(s){return s=s.childContextTypes,s!=null}function ic(){Qt(pn),Qt(Hr)}function Mh(s,i,u){if(Hr.current!==ss)throw Error(t(168));Vt(Hr,i),Vt(pn,u)}function Ih(s,i,u){var m=s.stateNode;if(i=i.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var v in m)if(!(v in i))throw Error(t(108,ee(s)||"Unknown",v));return ae({},u,m)}function lc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ss,Is=Hr.current,Vt(Hr,s),Vt(pn,pn.current),!0}function jh(s,i,u){var m=s.stateNode;if(!m)throw Error(t(169));u?(s=Ih(s,i,Is),m.__reactInternalMemoizedMergedChildContext=s,Qt(pn),Qt(Hr),Vt(Hr,s)):Qt(pn),Vt(pn,u)}var Aa=null,cc=!1,z0=!1;function Lh(s){Aa===null?Aa=[s]:Aa.push(s)}function bk(s){cc=!0,Lh(s)}function os(){if(!z0&&Aa!==null){z0=!0;var s=0,i=Bt;try{var u=Aa;for(Bt=1;s<u.length;s++){var m=u[s];do m=m(!0);while(m!==null)}Aa=null,cc=!1}catch(v){throw Aa!==null&&(Aa=Aa.slice(s+1)),Ie(zt,os),v}finally{Bt=i,z0=!1}}return null}var Oo=[],Po=0,uc=null,fc=0,Dn=[],Nn=0,js=null,Oa=1,Pa="";function Ls(s,i){Oo[Po++]=fc,Oo[Po++]=uc,uc=s,fc=i}function zh(s,i,u){Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,js=s;var m=Oa;s=Pa;var v=32-hr(m)-1;m&=~(1<<v),u+=1;var b=32-hr(i)+v;if(30<b){var D=v-v%5;b=(m&(1<<D)-1).toString(32),m>>=D,v-=D,Oa=1<<32-hr(i)+v|u<<v|m,Pa=b+s}else Oa=1<<b|u<<v|m,Pa=s}function B0(s){s.return!==null&&(Ls(s,1),zh(s,1,0))}function W0(s){for(;s===uc;)uc=Oo[--Po],Oo[Po]=null,fc=Oo[--Po],Oo[Po]=null;for(;s===js;)js=Dn[--Nn],Dn[Nn]=null,Pa=Dn[--Nn],Dn[Nn]=null,Oa=Dn[--Nn],Dn[Nn]=null}var kn=null,_n=null,Jt=!1,Vn=null;function Bh(s,i){var u=Pn(5,null,null,0);u.elementType="DELETED",u.stateNode=i,u.return=s,i=s.deletions,i===null?(s.deletions=[u],s.flags|=16):i.push(u)}function Wh(s,i){switch(s.tag){case 5:var u=s.type;return i=i.nodeType!==1||u.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,kn=s,_n=ns(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,kn=s,_n=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(u=js!==null?{id:Oa,overflow:Pa}:null,s.memoizedState={dehydrated:i,treeContext:u,retryLane:1073741824},u=Pn(18,null,null,0),u.stateNode=i,u.return=s,s.child=u,kn=s,_n=null,!0):!1;default:return!1}}function U0(s){return(s.mode&1)!==0&&(s.flags&128)===0}function H0(s){if(Jt){var i=_n;if(i){var u=i;if(!Wh(s,i)){if(U0(s))throw Error(t(418));i=ns(u.nextSibling);var m=kn;i&&Wh(s,i)?Bh(m,u):(s.flags=s.flags&-4097|2,Jt=!1,kn=s)}}else{if(U0(s))throw Error(t(418));s.flags=s.flags&-4097|2,Jt=!1,kn=s}}}function Uh(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;kn=s}function dc(s){if(s!==kn)return!1;if(!Jt)return Uh(s),Jt=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!R0(s.type,s.memoizedProps)),i&&(i=_n)){if(U0(s))throw Hh(),Error(t(418));for(;i;)Bh(s,i),i=ns(i.nextSibling)}if(Uh(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(i===0){_n=ns(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++}s=s.nextSibling}_n=null}}else _n=kn?ns(s.stateNode.nextSibling):null;return!0}function Hh(){for(var s=_n;s;)s=ns(s.nextSibling)}function Ro(){_n=kn=null,Jt=!1}function $0(s){Vn===null?Vn=[s]:Vn.push(s)}var Ek=L.ReactCurrentBatchConfig;function Li(s,i,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var m=u.stateNode}if(!m)throw Error(t(147,s));var v=m,b=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function(D){var te=v.refs;D===null?delete te[b]:te[b]=D},i._stringRef=b,i)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function pc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function $h(s){var i=s._init;return i(s._payload)}function Yh(s){function i(xe,de){if(s){var ke=xe.deletions;ke===null?(xe.deletions=[de],xe.flags|=16):ke.push(de)}}function u(xe,de){if(!s)return null;for(;de!==null;)i(xe,de),de=de.sibling;return null}function m(xe,de){for(xe=new Map;de!==null;)de.key!==null?xe.set(de.key,de):xe.set(de.index,de),de=de.sibling;return xe}function v(xe,de){return xe=hs(xe,de),xe.index=0,xe.sibling=null,xe}function b(xe,de,ke){return xe.index=ke,s?(ke=xe.alternate,ke!==null?(ke=ke.index,ke<de?(xe.flags|=2,de):ke):(xe.flags|=2,de)):(xe.flags|=1048576,de)}function D(xe){return s&&xe.alternate===null&&(xe.flags|=2),xe}function te(xe,de,ke,Ue){return de===null||de.tag!==6?(de=If(ke,xe.mode,Ue),de.return=xe,de):(de=v(de,ke),de.return=xe,de)}function ce(xe,de,ke,Ue){var rt=ke.type;return rt===C?Me(xe,de,ke.props.children,Ue,ke.key):de!==null&&(de.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===pe&&$h(rt)===de.type)?(Ue=v(de,ke.props),Ue.ref=Li(xe,de,ke),Ue.return=xe,Ue):(Ue=jc(ke.type,ke.key,ke.props,null,xe.mode,Ue),Ue.ref=Li(xe,de,ke),Ue.return=xe,Ue)}function Se(xe,de,ke,Ue){return de===null||de.tag!==4||de.stateNode.containerInfo!==ke.containerInfo||de.stateNode.implementation!==ke.implementation?(de=jf(ke,xe.mode,Ue),de.return=xe,de):(de=v(de,ke.children||[]),de.return=xe,de)}function Me(xe,de,ke,Ue,rt){return de===null||de.tag!==7?(de=Vs(ke,xe.mode,Ue,rt),de.return=xe,de):(de=v(de,ke),de.return=xe,de)}function We(xe,de,ke){if(typeof de=="string"&&de!==""||typeof de=="number")return de=If(""+de,xe.mode,ke),de.return=xe,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case J:return ke=jc(de.type,de.key,de.props,null,xe.mode,ke),ke.ref=Li(xe,null,de),ke.return=xe,ke;case O:return de=jf(de,xe.mode,ke),de.return=xe,de;case pe:var Ue=de._init;return We(xe,Ue(de._payload),ke)}if(Xe(de)||q(de))return de=Vs(de,xe.mode,ke,null),de.return=xe,de;pc(xe,de)}return null}function Re(xe,de,ke,Ue){var rt=de!==null?de.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return rt!==null?null:te(xe,de,""+ke,Ue);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case J:return ke.key===rt?ce(xe,de,ke,Ue):null;case O:return ke.key===rt?Se(xe,de,ke,Ue):null;case pe:return rt=ke._init,Re(xe,de,rt(ke._payload),Ue)}if(Xe(ke)||q(ke))return rt!==null?null:Me(xe,de,ke,Ue,null);pc(xe,ke)}return null}function Qe(xe,de,ke,Ue,rt){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return xe=xe.get(ke)||null,te(de,xe,""+Ue,rt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case J:return xe=xe.get(Ue.key===null?ke:Ue.key)||null,ce(de,xe,Ue,rt);case O:return xe=xe.get(Ue.key===null?ke:Ue.key)||null,Se(de,xe,Ue,rt);case pe:var ut=Ue._init;return Qe(xe,de,ke,ut(Ue._payload),rt)}if(Xe(Ue)||q(Ue))return xe=xe.get(ke)||null,Me(de,xe,Ue,rt,null);pc(de,Ue)}return null}function et(xe,de,ke,Ue){for(var rt=null,ut=null,ft=de,mt=de=0,Or=null;ft!==null&&mt<ke.length;mt++){ft.index>mt?(Or=ft,ft=null):Or=ft.sibling;var Ot=Re(xe,ft,ke[mt],Ue);if(Ot===null){ft===null&&(ft=Or);break}s&&ft&&Ot.alternate===null&&i(xe,ft),de=b(Ot,de,mt),ut===null?rt=Ot:ut.sibling=Ot,ut=Ot,ft=Or}if(mt===ke.length)return u(xe,ft),Jt&&Ls(xe,mt),rt;if(ft===null){for(;mt<ke.length;mt++)ft=We(xe,ke[mt],Ue),ft!==null&&(de=b(ft,de,mt),ut===null?rt=ft:ut.sibling=ft,ut=ft);return Jt&&Ls(xe,mt),rt}for(ft=m(xe,ft);mt<ke.length;mt++)Or=Qe(ft,xe,mt,ke[mt],Ue),Or!==null&&(s&&Or.alternate!==null&&ft.delete(Or.key===null?mt:Or.key),de=b(Or,de,mt),ut===null?rt=Or:ut.sibling=Or,ut=Or);return s&&ft.forEach(function(ms){return i(xe,ms)}),Jt&&Ls(xe,mt),rt}function tt(xe,de,ke,Ue){var rt=q(ke);if(typeof rt!="function")throw Error(t(150));if(ke=rt.call(ke),ke==null)throw Error(t(151));for(var ut=rt=null,ft=de,mt=de=0,Or=null,Ot=ke.next();ft!==null&&!Ot.done;mt++,Ot=ke.next()){ft.index>mt?(Or=ft,ft=null):Or=ft.sibling;var ms=Re(xe,ft,Ot.value,Ue);if(ms===null){ft===null&&(ft=Or);break}s&&ft&&ms.alternate===null&&i(xe,ft),de=b(ms,de,mt),ut===null?rt=ms:ut.sibling=ms,ut=ms,ft=Or}if(Ot.done)return u(xe,ft),Jt&&Ls(xe,mt),rt;if(ft===null){for(;!Ot.done;mt++,Ot=ke.next())Ot=We(xe,Ot.value,Ue),Ot!==null&&(de=b(Ot,de,mt),ut===null?rt=Ot:ut.sibling=Ot,ut=Ot);return Jt&&Ls(xe,mt),rt}for(ft=m(xe,ft);!Ot.done;mt++,Ot=ke.next())Ot=Qe(ft,xe,mt,Ot.value,Ue),Ot!==null&&(s&&Ot.alternate!==null&&ft.delete(Ot.key===null?mt:Ot.key),de=b(Ot,de,mt),ut===null?rt=Ot:ut.sibling=Ot,ut=Ot);return s&&ft.forEach(function(n2){return i(xe,n2)}),Jt&&Ls(xe,mt),rt}function mr(xe,de,ke,Ue){if(typeof ke=="object"&&ke!==null&&ke.type===C&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case J:e:{for(var rt=ke.key,ut=de;ut!==null;){if(ut.key===rt){if(rt=ke.type,rt===C){if(ut.tag===7){u(xe,ut.sibling),de=v(ut,ke.props.children),de.return=xe,xe=de;break e}}else if(ut.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===pe&&$h(rt)===ut.type){u(xe,ut.sibling),de=v(ut,ke.props),de.ref=Li(xe,ut,ke),de.return=xe,xe=de;break e}u(xe,ut);break}else i(xe,ut);ut=ut.sibling}ke.type===C?(de=Vs(ke.props.children,xe.mode,Ue,ke.key),de.return=xe,xe=de):(Ue=jc(ke.type,ke.key,ke.props,null,xe.mode,Ue),Ue.ref=Li(xe,de,ke),Ue.return=xe,xe=Ue)}return D(xe);case O:e:{for(ut=ke.key;de!==null;){if(de.key===ut)if(de.tag===4&&de.stateNode.containerInfo===ke.containerInfo&&de.stateNode.implementation===ke.implementation){u(xe,de.sibling),de=v(de,ke.children||[]),de.return=xe,xe=de;break e}else{u(xe,de);break}else i(xe,de);de=de.sibling}de=jf(ke,xe.mode,Ue),de.return=xe,xe=de}return D(xe);case pe:return ut=ke._init,mr(xe,de,ut(ke._payload),Ue)}if(Xe(ke))return et(xe,de,ke,Ue);if(q(ke))return tt(xe,de,ke,Ue);pc(xe,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,de!==null&&de.tag===6?(u(xe,de.sibling),de=v(de,ke),de.return=xe,xe=de):(u(xe,de),de=If(ke,xe.mode,Ue),de.return=xe,xe=de),D(xe)):u(xe,de)}return mr}var Mo=Yh(!0),Vh=Yh(!1),hc=as(null),mc=null,Io=null,Y0=null;function V0(){Y0=Io=mc=null}function K0(s){var i=hc.current;Qt(hc),s._currentValue=i}function G0(s,i,u){for(;s!==null;){var m=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,m!==null&&(m.childLanes|=i)):m!==null&&(m.childLanes&i)!==i&&(m.childLanes|=i),s===u)break;s=s.return}}function jo(s,i){mc=s,Y0=Io=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(mn=!0),s.firstContext=null)}function Fn(s){var i=s._currentValue;if(Y0!==s)if(s={context:s,memoizedValue:i,next:null},Io===null){if(mc===null)throw Error(t(308));Io=s,mc.dependencies={lanes:0,firstContext:s}}else Io=Io.next=s;return i}var zs=null;function X0(s){zs===null?zs=[s]:zs.push(s)}function Kh(s,i,u,m){var v=i.interleaved;return v===null?(u.next=u,X0(i)):(u.next=v.next,v.next=u),i.interleaved=u,Ra(s,m)}function Ra(s,i){s.lanes|=i;var u=s.alternate;for(u!==null&&(u.lanes|=i),u=s,s=s.return;s!==null;)s.childLanes|=i,u=s.alternate,u!==null&&(u.childLanes|=i),u=s,s=s.return;return u.tag===3?u.stateNode:null}var is=!1;function Q0(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Ma(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function ls(s,i,u){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Ct&2)!==0){var v=m.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),m.pending=i,Ra(s,u)}return v=m.interleaved,v===null?(i.next=i,X0(m)):(i.next=v.next,v.next=i),m.interleaved=i,Ra(s,u)}function xc(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194240)!==0)){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,u0(s,u)}}function Xh(s,i){var u=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var v=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var D={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};b===null?v=b=D:b=b.next=D,u=u.next}while(u!==null);b===null?v=b=i:b=b.next=i}else v=b=i;u={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:m.shared,effects:m.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}function gc(s,i,u,m){var v=s.updateQueue;is=!1;var b=v.firstBaseUpdate,D=v.lastBaseUpdate,te=v.shared.pending;if(te!==null){v.shared.pending=null;var ce=te,Se=ce.next;ce.next=null,D===null?b=Se:D.next=Se,D=ce;var Me=s.alternate;Me!==null&&(Me=Me.updateQueue,te=Me.lastBaseUpdate,te!==D&&(te===null?Me.firstBaseUpdate=Se:te.next=Se,Me.lastBaseUpdate=ce))}if(b!==null){var We=v.baseState;D=0,Me=Se=ce=null,te=b;do{var Re=te.lane,Qe=te.eventTime;if((m&Re)===Re){Me!==null&&(Me=Me.next={eventTime:Qe,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var et=s,tt=te;switch(Re=i,Qe=u,tt.tag){case 1:if(et=tt.payload,typeof et=="function"){We=et.call(Qe,We,Re);break e}We=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=tt.payload,Re=typeof et=="function"?et.call(Qe,We,Re):et,Re==null)break e;We=ae({},We,Re);break e;case 2:is=!0}}te.callback!==null&&te.lane!==0&&(s.flags|=64,Re=v.effects,Re===null?v.effects=[te]:Re.push(te))}else Qe={eventTime:Qe,lane:Re,tag:te.tag,payload:te.payload,callback:te.callback,next:null},Me===null?(Se=Me=Qe,ce=We):Me=Me.next=Qe,D|=Re;if(te=te.next,te===null){if(te=v.shared.pending,te===null)break;Re=te,te=Re.next,Re.next=null,v.lastBaseUpdate=Re,v.shared.pending=null}}while(!0);if(Me===null&&(ce=We),v.baseState=ce,v.firstBaseUpdate=Se,v.lastBaseUpdate=Me,i=v.shared.interleaved,i!==null){v=i;do D|=v.lane,v=v.next;while(v!==i)}else b===null&&(v.shared.lanes=0);Us|=D,s.lanes=D,s.memoizedState=We}}function Qh(s,i,u){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var m=s[i],v=m.callback;if(v!==null){if(m.callback=null,m=u,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var zi={},ua=as(zi),Bi=as(zi),Wi=as(zi);function Bs(s){if(s===zi)throw Error(t(174));return s}function q0(s,i){switch(Vt(Wi,i),Vt(Bi,s),Vt(ua,zi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lr(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=lr(i,s)}Qt(ua),Vt(ua,i)}function Lo(){Qt(ua),Qt(Bi),Qt(Wi)}function qh(s){Bs(Wi.current);var i=Bs(ua.current),u=lr(i,s.type);i!==u&&(Vt(Bi,s),Vt(ua,u))}function Z0(s){Bi.current===s&&(Qt(ua),Qt(Bi))}var ar=as(0);function vc(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var J0=[];function ef(){for(var s=0;s<J0.length;s++)J0[s]._workInProgressVersionPrimary=null;J0.length=0}var yc=L.ReactCurrentDispatcher,tf=L.ReactCurrentBatchConfig,Ws=0,sr=null,br=null,Fr=null,wc=!1,Ui=!1,Hi=0,Sk=0;function $r(){throw Error(t(321))}function rf(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Yn(s[u],i[u]))return!1;return!0}function nf(s,i,u,m,v,b){if(Ws=b,sr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,yc.current=s===null||s.memoizedState===null?Nk:Fk,s=u(m,v),Ui){b=0;do{if(Ui=!1,Hi=0,25<=b)throw Error(t(301));b+=1,Fr=br=null,i.updateQueue=null,yc.current=Ak,s=u(m,v)}while(Ui)}if(yc.current=bc,i=br!==null&&br.next!==null,Ws=0,Fr=br=sr=null,wc=!1,i)throw Error(t(300));return s}function af(){var s=Hi!==0;return Hi=0,s}function fa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fr===null?sr.memoizedState=Fr=s:Fr=Fr.next=s,Fr}function An(){if(br===null){var s=sr.alternate;s=s!==null?s.memoizedState:null}else s=br.next;var i=Fr===null?sr.memoizedState:Fr.next;if(i!==null)Fr=i,br=s;else{if(s===null)throw Error(t(310));br=s,s={memoizedState:br.memoizedState,baseState:br.baseState,baseQueue:br.baseQueue,queue:br.queue,next:null},Fr===null?sr.memoizedState=Fr=s:Fr=Fr.next=s}return Fr}function $i(s,i){return typeof i=="function"?i(s):i}function sf(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=br,v=m.baseQueue,b=u.pending;if(b!==null){if(v!==null){var D=v.next;v.next=b.next,b.next=D}m.baseQueue=v=b,u.pending=null}if(v!==null){b=v.next,m=m.baseState;var te=D=null,ce=null,Se=b;do{var Me=Se.lane;if((Ws&Me)===Me)ce!==null&&(ce=ce.next={lane:0,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null}),m=Se.hasEagerState?Se.eagerState:s(m,Se.action);else{var We={lane:Me,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null};ce===null?(te=ce=We,D=m):ce=ce.next=We,sr.lanes|=Me,Us|=Me}Se=Se.next}while(Se!==null&&Se!==b);ce===null?D=m:ce.next=te,Yn(m,i.memoizedState)||(mn=!0),i.memoizedState=m,i.baseState=D,i.baseQueue=ce,u.lastRenderedState=m}if(s=u.interleaved,s!==null){v=s;do b=v.lane,sr.lanes|=b,Us|=b,v=v.next;while(v!==s)}else v===null&&(u.lanes=0);return[i.memoizedState,u.dispatch]}function of(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=u.dispatch,v=u.pending,b=i.memoizedState;if(v!==null){u.pending=null;var D=v=v.next;do b=s(b,D.action),D=D.next;while(D!==v);Yn(b,i.memoizedState)||(mn=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),u.lastRenderedState=b}return[b,m]}function Zh(){}function Jh(s,i){var u=sr,m=An(),v=i(),b=!Yn(m.memoizedState,v);if(b&&(m.memoizedState=v,mn=!0),m=m.queue,lf(rm.bind(null,u,m,s),[s]),m.getSnapshot!==i||b||Fr!==null&&Fr.memoizedState.tag&1){if(u.flags|=2048,Yi(9,tm.bind(null,u,m,v,i),void 0,null),Ar===null)throw Error(t(349));(Ws&30)!==0||em(u,i,v)}return v}function em(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=sr.updateQueue,i===null?(i={lastEffect:null,stores:null},sr.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function tm(s,i,u,m){i.value=u,i.getSnapshot=m,nm(i)&&am(s)}function rm(s,i,u){return u(function(){nm(i)&&am(s)})}function nm(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Yn(s,u)}catch{return!0}}function am(s){var i=Ra(s,1);i!==null&&Qn(i,s,1,-1)}function sm(s){var i=fa();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:s},i.queue=s,s=s.dispatch=Dk.bind(null,sr,s),[i.memoizedState,s]}function Yi(s,i,u,m){return s={tag:s,create:i,destroy:u,deps:m,next:null},i=sr.updateQueue,i===null?(i={lastEffect:null,stores:null},sr.updateQueue=i,i.lastEffect=s.next=s):(u=i.lastEffect,u===null?i.lastEffect=s.next=s:(m=u.next,u.next=s,s.next=m,i.lastEffect=s)),s}function om(){return An().memoizedState}function kc(s,i,u,m){var v=fa();sr.flags|=s,v.memoizedState=Yi(1|i,u,void 0,m===void 0?null:m)}function _c(s,i,u,m){var v=An();m=m===void 0?null:m;var b=void 0;if(br!==null){var D=br.memoizedState;if(b=D.destroy,m!==null&&rf(m,D.deps)){v.memoizedState=Yi(i,u,b,m);return}}sr.flags|=s,v.memoizedState=Yi(1|i,u,b,m)}function im(s,i){return kc(8390656,8,s,i)}function lf(s,i){return _c(2048,8,s,i)}function lm(s,i){return _c(4,2,s,i)}function cm(s,i){return _c(4,4,s,i)}function um(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function fm(s,i,u){return u=u!=null?u.concat([s]):null,_c(4,4,um.bind(null,i,s),u)}function cf(){}function dm(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&rf(i,m[1])?m[0]:(u.memoizedState=[s,i],s)}function pm(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&rf(i,m[1])?m[0]:(s=s(),u.memoizedState=[s,i],s)}function hm(s,i,u){return(Ws&21)===0?(s.baseState&&(s.baseState=!1,mn=!0),s.memoizedState=u):(Yn(u,i)||(u=$p(),sr.lanes|=u,Us|=u,s.baseState=!0),i)}function Tk(s,i){var u=Bt;Bt=u!==0&&4>u?u:4,s(!0);var m=tf.transition;tf.transition={};try{s(!1),i()}finally{Bt=u,tf.transition=m}}function mm(){return An().memoizedState}function Ck(s,i,u){var m=ds(s);if(u={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null},xm(s))gm(i,u);else if(u=Kh(s,i,u,m),u!==null){var v=rn();Qn(u,s,m,v),vm(u,i,m)}}function Dk(s,i,u){var m=ds(s),v={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null};if(xm(s))gm(i,v);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var D=i.lastRenderedState,te=b(D,u);if(v.hasEagerState=!0,v.eagerState=te,Yn(te,D)){var ce=i.interleaved;ce===null?(v.next=v,X0(i)):(v.next=ce.next,ce.next=v),i.interleaved=v;return}}catch{}finally{}u=Kh(s,i,v,m),u!==null&&(v=rn(),Qn(u,s,m,v),vm(u,i,m))}}function xm(s){var i=s.alternate;return s===sr||i!==null&&i===sr}function gm(s,i){Ui=wc=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function vm(s,i,u){if((u&4194240)!==0){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,u0(s,u)}}var bc={readContext:Fn,useCallback:$r,useContext:$r,useEffect:$r,useImperativeHandle:$r,useInsertionEffect:$r,useLayoutEffect:$r,useMemo:$r,useReducer:$r,useRef:$r,useState:$r,useDebugValue:$r,useDeferredValue:$r,useTransition:$r,useMutableSource:$r,useSyncExternalStore:$r,useId:$r,unstable_isNewReconciler:!1},Nk={readContext:Fn,useCallback:function(s,i){return fa().memoizedState=[s,i===void 0?null:i],s},useContext:Fn,useEffect:im,useImperativeHandle:function(s,i,u){return u=u!=null?u.concat([s]):null,kc(4194308,4,um.bind(null,i,s),u)},useLayoutEffect:function(s,i){return kc(4194308,4,s,i)},useInsertionEffect:function(s,i){return kc(4,2,s,i)},useMemo:function(s,i){var u=fa();return i=i===void 0?null:i,s=s(),u.memoizedState=[s,i],s},useReducer:function(s,i,u){var m=fa();return i=u!==void 0?u(i):i,m.memoizedState=m.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},m.queue=s,s=s.dispatch=Ck.bind(null,sr,s),[m.memoizedState,s]},useRef:function(s){var i=fa();return s={current:s},i.memoizedState=s},useState:sm,useDebugValue:cf,useDeferredValue:function(s){return fa().memoizedState=s},useTransition:function(){var s=sm(!1),i=s[0];return s=Tk.bind(null,s[1]),fa().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,u){var m=sr,v=fa();if(Jt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=i(),Ar===null)throw Error(t(349));(Ws&30)!==0||em(m,i,u)}v.memoizedState=u;var b={value:u,getSnapshot:i};return v.queue=b,im(rm.bind(null,m,b,s),[s]),m.flags|=2048,Yi(9,tm.bind(null,m,b,u,i),void 0,null),u},useId:function(){var s=fa(),i=Ar.identifierPrefix;if(Jt){var u=Pa,m=Oa;u=(m&~(1<<32-hr(m)-1)).toString(32)+u,i=":"+i+"R"+u,u=Hi++,0<u&&(i+="H"+u.toString(32)),i+=":"}else u=Sk++,i=":"+i+"r"+u.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Fk={readContext:Fn,useCallback:dm,useContext:Fn,useEffect:lf,useImperativeHandle:fm,useInsertionEffect:lm,useLayoutEffect:cm,useMemo:pm,useReducer:sf,useRef:om,useState:function(){return sf($i)},useDebugValue:cf,useDeferredValue:function(s){var i=An();return hm(i,br.memoizedState,s)},useTransition:function(){var s=sf($i)[0],i=An().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:mm,unstable_isNewReconciler:!1},Ak={readContext:Fn,useCallback:dm,useContext:Fn,useEffect:lf,useImperativeHandle:fm,useInsertionEffect:lm,useLayoutEffect:cm,useMemo:pm,useReducer:of,useRef:om,useState:function(){return of($i)},useDebugValue:cf,useDeferredValue:function(s){var i=An();return br===null?i.memoizedState=s:hm(i,br.memoizedState,s)},useTransition:function(){var s=of($i)[0],i=An().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:mm,unstable_isNewReconciler:!1};function Kn(s,i){if(s&&s.defaultProps){i=ae({},i),s=s.defaultProps;for(var u in s)i[u]===void 0&&(i[u]=s[u]);return i}return i}function uf(s,i,u,m){i=s.memoizedState,u=u(m,i),u=u==null?i:ae({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Ec={isMounted:function(s){return(s=s._reactInternals)?X(s)===s:!1},enqueueSetState:function(s,i,u){s=s._reactInternals;var m=rn(),v=ds(s),b=Ma(m,v);b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var m=rn(),v=ds(s),b=Ma(m,v);b.tag=1,b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=rn(),m=ds(s),v=Ma(u,m);v.tag=2,i!=null&&(v.callback=i),i=ls(s,v,m),i!==null&&(Qn(i,s,m,u),xc(i,s,m))}};function ym(s,i,u,m,v,b,D){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,b,D):i.prototype&&i.prototype.isPureReactComponent?!Ai(u,m)||!Ai(v,b):!0}function wm(s,i,u){var m=!1,v=ss,b=i.contextType;return typeof b=="object"&&b!==null?b=Fn(b):(v=hn(i)?Is:Hr.current,m=i.contextTypes,b=(m=m!=null)?Ao(s,v):ss),i=new i(u,b),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ec,s.stateNode=i,i._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=v,s.__reactInternalMemoizedMaskedChildContext=b),i}function km(s,i,u,m){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,m),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,m),i.state!==s&&Ec.enqueueReplaceState(i,i.state,null)}function ff(s,i,u,m){var v=s.stateNode;v.props=u,v.state=s.memoizedState,v.refs={},Q0(s);var b=i.contextType;typeof b=="object"&&b!==null?v.context=Fn(b):(b=hn(i)?Is:Hr.current,v.context=Ao(s,b)),v.state=s.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(uf(s,i,b,u),v.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(i=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),i!==v.state&&Ec.enqueueReplaceState(v,v.state,null),gc(s,u,v,m),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308)}function zo(s,i){try{var u="",m=i;do u+=W(m),m=m.return;while(m);var v=u}catch(b){v=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:i,stack:v,digest:null}}function df(s,i,u){return{value:s,source:null,stack:u??null,digest:i??null}}function pf(s,i){try{console.error(i.value)}catch(u){setTimeout(function(){throw u})}}var Ok=typeof WeakMap=="function"?WeakMap:Map;function _m(s,i,u){u=Ma(-1,u),u.tag=3,u.payload={element:null};var m=i.value;return u.callback=function(){Ac||(Ac=!0,Df=m),pf(s,i)},u}function bm(s,i,u){u=Ma(-1,u),u.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var v=i.value;u.payload=function(){return m(v)},u.callback=function(){pf(s,i)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(u.callback=function(){pf(s,i),typeof m!="function"&&(us===null?us=new Set([this]):us.add(this));var D=i.stack;this.componentDidCatch(i.value,{componentStack:D!==null?D:""})}),u}function Em(s,i,u){var m=s.pingCache;if(m===null){m=s.pingCache=new Ok;var v=new Set;m.set(i,v)}else v=m.get(i),v===void 0&&(v=new Set,m.set(i,v));v.has(u)||(v.add(u),s=Vk.bind(null,s,i,u),i.then(s,s))}function Sm(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Tm(s,i,u,m,v){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(i=Ma(-1,1),i.tag=2,ls(u,i,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=v,s)}var Pk=L.ReactCurrentOwner,mn=!1;function tn(s,i,u,m){i.child=s===null?Vh(i,null,u,m):Mo(i,s.child,u,m)}function Cm(s,i,u,m,v){u=u.render;var b=i.ref;return jo(i,v),m=nf(s,i,u,m,b,v),u=af(),s!==null&&!mn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(Jt&&u&&B0(i),i.flags|=1,tn(s,i,m,v),i.child)}function Dm(s,i,u,m,v){if(s===null){var b=u.type;return typeof b=="function"&&!Mf(b)&&b.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(i.tag=15,i.type=b,Nm(s,i,b,m,v)):(s=jc(u.type,null,m,i,i.mode,v),s.ref=i.ref,s.return=i,i.child=s)}if(b=s.child,(s.lanes&v)===0){var D=b.memoizedProps;if(u=u.compare,u=u!==null?u:Ai,u(D,m)&&s.ref===i.ref)return Ia(s,i,v)}return i.flags|=1,s=hs(b,m),s.ref=i.ref,s.return=i,i.child=s}function Nm(s,i,u,m,v){if(s!==null){var b=s.memoizedProps;if(Ai(b,m)&&s.ref===i.ref)if(mn=!1,i.pendingProps=m=b,(s.lanes&v)!==0)(s.flags&131072)!==0&&(mn=!0);else return i.lanes=s.lanes,Ia(s,i,v)}return hf(s,i,u,m,v)}function Fm(s,i,u){var m=i.pendingProps,v=m.children,b=s!==null?s.memoizedState:null;if(m.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(Wo,bn),bn|=u;else{if((u&1073741824)===0)return s=b!==null?b.baseLanes|u:u,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Vt(Wo,bn),bn|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=b!==null?b.baseLanes:u,Vt(Wo,bn),bn|=m}else b!==null?(m=b.baseLanes|u,i.memoizedState=null):m=u,Vt(Wo,bn),bn|=m;return tn(s,i,v,u),i.child}function Am(s,i){var u=i.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(i.flags|=512,i.flags|=2097152)}function hf(s,i,u,m,v){var b=hn(u)?Is:Hr.current;return b=Ao(i,b),jo(i,v),u=nf(s,i,u,m,b,v),m=af(),s!==null&&!mn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(Jt&&m&&B0(i),i.flags|=1,tn(s,i,u,v),i.child)}function Om(s,i,u,m,v){if(hn(u)){var b=!0;lc(i)}else b=!1;if(jo(i,v),i.stateNode===null)Tc(s,i),wm(i,u,m),ff(i,u,m,v),m=!0;else if(s===null){var D=i.stateNode,te=i.memoizedProps;D.props=te;var ce=D.context,Se=u.contextType;typeof Se=="object"&&Se!==null?Se=Fn(Se):(Se=hn(u)?Is:Hr.current,Se=Ao(i,Se));var Me=u.getDerivedStateFromProps,We=typeof Me=="function"||typeof D.getSnapshotBeforeUpdate=="function";We||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(te!==m||ce!==Se)&&km(i,D,m,Se),is=!1;var Re=i.memoizedState;D.state=Re,gc(i,m,D,v),ce=i.memoizedState,te!==m||Re!==ce||pn.current||is?(typeof Me=="function"&&(uf(i,u,Me,m),ce=i.memoizedState),(te=is||ym(i,u,te,m,Re,ce,Se))?(We||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(i.flags|=4194308)):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=m,i.memoizedState=ce),D.props=m,D.state=ce,D.context=Se,m=te):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),m=!1)}else{D=i.stateNode,Gh(s,i),te=i.memoizedProps,Se=i.type===i.elementType?te:Kn(i.type,te),D.props=Se,We=i.pendingProps,Re=D.context,ce=u.contextType,typeof ce=="object"&&ce!==null?ce=Fn(ce):(ce=hn(u)?Is:Hr.current,ce=Ao(i,ce));var Qe=u.getDerivedStateFromProps;(Me=typeof Qe=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(te!==We||Re!==ce)&&km(i,D,m,ce),is=!1,Re=i.memoizedState,D.state=Re,gc(i,m,D,v);var et=i.memoizedState;te!==We||Re!==et||pn.current||is?(typeof Qe=="function"&&(uf(i,u,Qe,m),et=i.memoizedState),(Se=is||ym(i,u,Se,m,Re,et,ce)||!1)?(Me||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(m,et,ce),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(m,et,ce)),typeof D.componentDidUpdate=="function"&&(i.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof D.componentDidUpdate!="function"||te===s.memoizedProps&&Re===s.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||te===s.memoizedProps&&Re===s.memoizedState||(i.flags|=1024),i.memoizedProps=m,i.memoizedState=et),D.props=m,D.state=et,D.context=ce,m=Se):(typeof D.componentDidUpdate!="function"||te===s.memoizedProps&&Re===s.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||te===s.memoizedProps&&Re===s.memoizedState||(i.flags|=1024),m=!1)}return mf(s,i,u,m,b,v)}function mf(s,i,u,m,v,b){Am(s,i);var D=(i.flags&128)!==0;if(!m&&!D)return v&&jh(i,u,!1),Ia(s,i,b);m=i.stateNode,Pk.current=i;var te=D&&typeof u.getDerivedStateFromError!="function"?null:m.render();return i.flags|=1,s!==null&&D?(i.child=Mo(i,s.child,null,b),i.child=Mo(i,null,te,b)):tn(s,i,te,b),i.memoizedState=m.state,v&&jh(i,u,!0),i.child}function Pm(s){var i=s.stateNode;i.pendingContext?Mh(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Mh(s,i.context,!1),q0(s,i.containerInfo)}function Rm(s,i,u,m,v){return Ro(),$0(v),i.flags|=256,tn(s,i,u,m),i.child}var xf={dehydrated:null,treeContext:null,retryLane:0};function gf(s){return{baseLanes:s,cachePool:null,transitions:null}}function Mm(s,i,u){var m=i.pendingProps,v=ar.current,b=!1,D=(i.flags&128)!==0,te;if((te=D)||(te=s!==null&&s.memoizedState===null?!1:(v&2)!==0),te?(b=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(v|=1),Vt(ar,v&1),s===null)return H0(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(D=m.children,s=m.fallback,b?(m=i.mode,b=i.child,D={mode:"hidden",children:D},(m&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=D):b=Lc(D,m,0,null),s=Vs(s,m,u,null),b.return=i,s.return=i,b.sibling=s,i.child=b,i.child.memoizedState=gf(u),i.memoizedState=xf,s):vf(i,D));if(v=s.memoizedState,v!==null&&(te=v.dehydrated,te!==null))return Rk(s,i,D,m,te,v,u);if(b){b=m.fallback,D=i.mode,v=s.child,te=v.sibling;var ce={mode:"hidden",children:m.children};return(D&1)===0&&i.child!==v?(m=i.child,m.childLanes=0,m.pendingProps=ce,i.deletions=null):(m=hs(v,ce),m.subtreeFlags=v.subtreeFlags&14680064),te!==null?b=hs(te,b):(b=Vs(b,D,u,null),b.flags|=2),b.return=i,m.return=i,m.sibling=b,i.child=m,m=b,b=i.child,D=s.child.memoizedState,D=D===null?gf(u):{baseLanes:D.baseLanes|u,cachePool:null,transitions:D.transitions},b.memoizedState=D,b.childLanes=s.childLanes&~u,i.memoizedState=xf,m}return b=s.child,s=b.sibling,m=hs(b,{mode:"visible",children:m.children}),(i.mode&1)===0&&(m.lanes=u),m.return=i,m.sibling=null,s!==null&&(u=i.deletions,u===null?(i.deletions=[s],i.flags|=16):u.push(s)),i.child=m,i.memoizedState=null,m}function vf(s,i){return i=Lc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Sc(s,i,u,m){return m!==null&&$0(m),Mo(i,s.child,null,u),s=vf(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Rk(s,i,u,m,v,b,D){if(u)return i.flags&256?(i.flags&=-257,m=df(Error(t(422))),Sc(s,i,D,m)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(b=m.fallback,v=i.mode,m=Lc({mode:"visible",children:m.children},v,0,null),b=Vs(b,v,D,null),b.flags|=2,m.return=i,b.return=i,m.sibling=b,i.child=m,(i.mode&1)!==0&&Mo(i,s.child,null,D),i.child.memoizedState=gf(D),i.memoizedState=xf,b);if((i.mode&1)===0)return Sc(s,i,D,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var te=m.dgst;return m=te,b=Error(t(419)),m=df(b,m,void 0),Sc(s,i,D,m)}if(te=(D&s.childLanes)!==0,mn||te){if(m=Ar,m!==null){switch(D&-D){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|D))!==0?0:v,v!==0&&v!==b.retryLane&&(b.retryLane=v,Ra(s,v),Qn(m,s,v,-1))}return Rf(),m=df(Error(t(421))),Sc(s,i,D,m)}return v.data==="$?"?(i.flags|=128,i.child=s.child,i=Kk.bind(null,s),v._reactRetry=i,null):(s=b.treeContext,_n=ns(v.nextSibling),kn=i,Jt=!0,Vn=null,s!==null&&(Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,Oa=s.id,Pa=s.overflow,js=i),i=vf(i,m.children),i.flags|=4096,i)}function Im(s,i,u){s.lanes|=i;var m=s.alternate;m!==null&&(m.lanes|=i),G0(s.return,i,u)}function yf(s,i,u,m,v){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:v}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=m,b.tail=u,b.tailMode=v)}function jm(s,i,u){var m=i.pendingProps,v=m.revealOrder,b=m.tail;if(tn(s,i,m.children,u),m=ar.current,(m&2)!==0)m=m&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Im(s,u,i);else if(s.tag===19)Im(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(Vt(ar,m),(i.mode&1)===0)i.memoizedState=null;else switch(v){case"forwards":for(u=i.child,v=null;u!==null;)s=u.alternate,s!==null&&vc(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=i.child,i.child=null):(v=u.sibling,u.sibling=null),yf(i,!1,v,u,b);break;case"backwards":for(u=null,v=i.child,i.child=null;v!==null;){if(s=v.alternate,s!==null&&vc(s)===null){i.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}yf(i,!0,u,null,b);break;case"together":yf(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Tc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Ia(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),Us|=i.lanes,(u&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,u=hs(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=hs(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function Mk(s,i,u){switch(i.tag){case 3:Pm(i),Ro();break;case 5:qh(i);break;case 1:hn(i.type)&&lc(i);break;case 4:q0(i,i.stateNode.containerInfo);break;case 10:var m=i.type._context,v=i.memoizedProps.value;Vt(hc,m._currentValue),m._currentValue=v;break;case 13:if(m=i.memoizedState,m!==null)return m.dehydrated!==null?(Vt(ar,ar.current&1),i.flags|=128,null):(u&i.child.childLanes)!==0?Mm(s,i,u):(Vt(ar,ar.current&1),s=Ia(s,i,u),s!==null?s.sibling:null);Vt(ar,ar.current&1);break;case 19:if(m=(u&i.childLanes)!==0,(s.flags&128)!==0){if(m)return jm(s,i,u);i.flags|=128}if(v=i.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Vt(ar,ar.current),m)break;return null;case 22:case 23:return i.lanes=0,Fm(s,i,u)}return Ia(s,i,u)}var Lm,wf,zm,Bm;Lm=function(s,i){for(var u=i.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},wf=function(){},zm=function(s,i,u,m){var v=s.memoizedProps;if(v!==m){s=i.stateNode,Bs(ua.current);var b=null;switch(u){case"input":v=Ce(s,v),m=Ce(s,m),b=[];break;case"select":v=ae({},v,{value:void 0}),m=ae({},m,{value:void 0}),b=[];break;case"textarea":v=qt(s,v),m=qt(s,m),b=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=sc)}Ae(u,m);var D;u=null;for(Se in v)if(!m.hasOwnProperty(Se)&&v.hasOwnProperty(Se)&&v[Se]!=null)if(Se==="style"){var te=v[Se];for(D in te)te.hasOwnProperty(D)&&(u||(u={}),u[D]="")}else Se!=="dangerouslySetInnerHTML"&&Se!=="children"&&Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&Se!=="autoFocus"&&(a.hasOwnProperty(Se)?b||(b=[]):(b=b||[]).push(Se,null));for(Se in m){var ce=m[Se];if(te=v?.[Se],m.hasOwnProperty(Se)&&ce!==te&&(ce!=null||te!=null))if(Se==="style")if(te){for(D in te)!te.hasOwnProperty(D)||ce&&ce.hasOwnProperty(D)||(u||(u={}),u[D]="");for(D in ce)ce.hasOwnProperty(D)&&te[D]!==ce[D]&&(u||(u={}),u[D]=ce[D])}else u||(b||(b=[]),b.push(Se,u)),u=ce;else Se==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,te=te?te.__html:void 0,ce!=null&&te!==ce&&(b=b||[]).push(Se,ce)):Se==="children"?typeof ce!="string"&&typeof ce!="number"||(b=b||[]).push(Se,""+ce):Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&(a.hasOwnProperty(Se)?(ce!=null&&Se==="onScroll"&&Xt("scroll",s),b||te===ce||(b=[])):(b=b||[]).push(Se,ce))}u&&(b=b||[]).push("style",u);var Se=b;(i.updateQueue=Se)&&(i.flags|=4)}},Bm=function(s,i,u,m){u!==m&&(i.flags|=4)};function Vi(s,i){if(!Jt)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Yr(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,m=0;if(i)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=m,s.childLanes=u,i}function Ik(s,i,u){var m=i.pendingProps;switch(W0(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yr(i),null;case 1:return hn(i.type)&&ic(),Yr(i),null;case 3:return m=i.stateNode,Lo(),Qt(pn),Qt(Hr),ef(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(dc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Vn!==null&&(Af(Vn),Vn=null))),wf(s,i),Yr(i),null;case 5:Z0(i);var v=Bs(Wi.current);if(u=i.type,s!==null&&i.stateNode!=null)zm(s,i,u,m,v),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!m){if(i.stateNode===null)throw Error(t(166));return Yr(i),null}if(s=Bs(ua.current),dc(i)){m=i.stateNode,u=i.type;var b=i.memoizedProps;switch(m[ca]=i,m[Ii]=b,s=(i.mode&1)!==0,u){case"dialog":Xt("cancel",m),Xt("close",m);break;case"iframe":case"object":case"embed":Xt("load",m);break;case"video":case"audio":for(v=0;v<Pi.length;v++)Xt(Pi[v],m);break;case"source":Xt("error",m);break;case"img":case"image":case"link":Xt("error",m),Xt("load",m);break;case"details":Xt("toggle",m);break;case"input":ge(m,b),Xt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!b.multiple},Xt("invalid",m);break;case"textarea":Pt(m,b),Xt("invalid",m)}Ae(u,b),v=null;for(var D in b)if(b.hasOwnProperty(D)){var te=b[D];D==="children"?typeof te=="string"?m.textContent!==te&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,te,s),v=["children",te]):typeof te=="number"&&m.textContent!==""+te&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,te,s),v=["children",""+te]):a.hasOwnProperty(D)&&te!=null&&D==="onScroll"&&Xt("scroll",m)}switch(u){case"input":me(m),Pe(m,b,!0);break;case"textarea":me(m),ir(m);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(m.onclick=sc)}m=v,i.updateQueue=m,m!==null&&(i.flags|=4)}else{D=v.nodeType===9?v:v.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Zt(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=D.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=D.createElement(u,{is:m.is}):(s=D.createElement(u),u==="select"&&(D=s,m.multiple?D.multiple=!0:m.size&&(D.size=m.size))):s=D.createElementNS(s,u),s[ca]=i,s[Ii]=m,Lm(s,i,!1,!1),i.stateNode=s;e:{switch(D=ze(u,m),u){case"dialog":Xt("cancel",s),Xt("close",s),v=m;break;case"iframe":case"object":case"embed":Xt("load",s),v=m;break;case"video":case"audio":for(v=0;v<Pi.length;v++)Xt(Pi[v],s);v=m;break;case"source":Xt("error",s),v=m;break;case"img":case"image":case"link":Xt("error",s),Xt("load",s),v=m;break;case"details":Xt("toggle",s),v=m;break;case"input":ge(s,m),v=Ce(s,m),Xt("invalid",s);break;case"option":v=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},v=ae({},m,{value:void 0}),Xt("invalid",s);break;case"textarea":Pt(s,m),v=qt(s,m),Xt("invalid",s);break;default:v=m}Ae(u,v),te=v;for(b in te)if(te.hasOwnProperty(b)){var ce=te[b];b==="style"?re(s,ce):b==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ce!=null&&Gt(s,ce)):b==="children"?typeof ce=="string"?(u!=="textarea"||ce!=="")&&it(s,ce):typeof ce=="number"&&it(s,""+ce):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(a.hasOwnProperty(b)?ce!=null&&b==="onScroll"&&Xt("scroll",s):ce!=null&&T(s,b,ce,D))}switch(u){case"input":me(s),Pe(s,m,!1);break;case"textarea":me(s),ir(s);break;case"option":m.value!=null&&s.setAttribute("value",""+se(m.value));break;case"select":s.multiple=!!m.multiple,b=m.value,b!=null?wt(s,!!m.multiple,b,!1):m.defaultValue!=null&&wt(s,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(s.onclick=sc)}switch(u){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Yr(i),null;case 6:if(s&&i.stateNode!=null)Bm(s,i,s.memoizedProps,m);else{if(typeof m!="string"&&i.stateNode===null)throw Error(t(166));if(u=Bs(Wi.current),Bs(ua.current),dc(i)){if(m=i.stateNode,u=i.memoizedProps,m[ca]=i,(b=m.nodeValue!==u)&&(s=kn,s!==null))switch(s.tag){case 3:ac(m.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ac(m.nodeValue,u,(s.mode&1)!==0)}b&&(i.flags|=4)}else m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[ca]=i,i.stateNode=m}return Yr(i),null;case 13:if(Qt(ar),m=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Jt&&_n!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Hh(),Ro(),i.flags|=98560,b=!1;else if(b=dc(i),m!==null&&m.dehydrated!==null){if(s===null){if(!b)throw Error(t(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));b[ca]=i}else Ro(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Yr(i),b=!1}else Vn!==null&&(Af(Vn),Vn=null),b=!0;if(!b)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=u,i):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(ar.current&1)!==0?Er===0&&(Er=3):Rf())),i.updateQueue!==null&&(i.flags|=4),Yr(i),null);case 4:return Lo(),wf(s,i),s===null&&Ri(i.stateNode.containerInfo),Yr(i),null;case 10:return K0(i.type._context),Yr(i),null;case 17:return hn(i.type)&&ic(),Yr(i),null;case 19:if(Qt(ar),b=i.memoizedState,b===null)return Yr(i),null;if(m=(i.flags&128)!==0,D=b.rendering,D===null)if(m)Vi(b,!1);else{if(Er!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(D=vc(s),D!==null){for(i.flags|=128,Vi(b,!1),m=D.updateQueue,m!==null&&(i.updateQueue=m,i.flags|=4),i.subtreeFlags=0,m=u,u=i.child;u!==null;)b=u,s=m,b.flags&=14680066,D=b.alternate,D===null?(b.childLanes=0,b.lanes=s,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=D.childLanes,b.lanes=D.lanes,b.child=D.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=D.memoizedProps,b.memoizedState=D.memoizedState,b.updateQueue=D.updateQueue,b.type=D.type,s=D.dependencies,b.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Vt(ar,ar.current&1|2),i.child}s=s.sibling}b.tail!==null&&Be()>Uo&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304)}else{if(!m)if(s=vc(D),s!==null){if(i.flags|=128,m=!0,u=s.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),Vi(b,!0),b.tail===null&&b.tailMode==="hidden"&&!D.alternate&&!Jt)return Yr(i),null}else 2*Be()-b.renderingStartTime>Uo&&u!==1073741824&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304);b.isBackwards?(D.sibling=i.child,i.child=D):(u=b.last,u!==null?u.sibling=D:i.child=D,b.last=D)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=Be(),i.sibling=null,u=ar.current,Vt(ar,m?u&1|2:u&1),i):(Yr(i),null);case 22:case 23:return Pf(),m=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(i.flags|=8192),m&&(i.mode&1)!==0?(bn&1073741824)!==0&&(Yr(i),i.subtreeFlags&6&&(i.flags|=8192)):Yr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function jk(s,i){switch(W0(i),i.tag){case 1:return hn(i.type)&&ic(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Lo(),Qt(pn),Qt(Hr),ef(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Z0(i),null;case 13:if(Qt(ar),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Ro()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return Qt(ar),null;case 4:return Lo(),null;case 10:return K0(i.type._context),null;case 22:case 23:return Pf(),null;case 24:return null;default:return null}}var Cc=!1,Vr=!1,Lk=typeof WeakSet=="function"?WeakSet:Set,Je=null;function Bo(s,i){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(m){cr(s,i,m)}else u.current=null}function kf(s,i,u){try{u()}catch(m){cr(s,i,m)}}var Wm=!1;function zk(s,i){if(O0=Kl,s=yh(),E0(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var v=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var D=0,te=-1,ce=-1,Se=0,Me=0,We=s,Re=null;t:for(;;){for(var Qe;We!==u||v!==0&&We.nodeType!==3||(te=D+v),We!==b||m!==0&&We.nodeType!==3||(ce=D+m),We.nodeType===3&&(D+=We.nodeValue.length),(Qe=We.firstChild)!==null;)Re=We,We=Qe;for(;;){if(We===s)break t;if(Re===u&&++Se===v&&(te=D),Re===b&&++Me===m&&(ce=D),(Qe=We.nextSibling)!==null)break;We=Re,Re=We.parentNode}We=Qe}u=te===-1||ce===-1?null:{start:te,end:ce}}else u=null}u=u||{start:0,end:0}}else u=null;for(P0={focusedElem:s,selectionRange:u},Kl=!1,Je=i;Je!==null;)if(i=Je,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,Je=s;else for(;Je!==null;){i=Je;try{var et=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(et!==null){var tt=et.memoizedProps,mr=et.memoizedState,xe=i.stateNode,de=xe.getSnapshotBeforeUpdate(i.elementType===i.type?tt:Kn(i.type,tt),mr);xe.__reactInternalSnapshotBeforeUpdate=de}break;case 3:var ke=i.stateNode.containerInfo;ke.nodeType===1?ke.textContent="":ke.nodeType===9&&ke.documentElement&&ke.removeChild(ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ue){cr(i,i.return,Ue)}if(s=i.sibling,s!==null){s.return=i.return,Je=s;break}Je=i.return}return et=Wm,Wm=!1,et}function Ki(s,i,u){var m=i.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&s)===s){var b=v.destroy;v.destroy=void 0,b!==void 0&&kf(i,u,b)}v=v.next}while(v!==m)}}function Dc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&s)===s){var m=u.create;u.destroy=m()}u=u.next}while(u!==i)}}function _f(s){var i=s.ref;if(i!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof i=="function"?i(s):i.current=s}}function Um(s){var i=s.alternate;i!==null&&(s.alternate=null,Um(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[ca],delete i[Ii],delete i[j0],delete i[kk],delete i[_k])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Hm(s){return s.tag===5||s.tag===3||s.tag===4}function $m(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Hm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function bf(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.nodeType===8?u.parentNode.insertBefore(s,i):u.insertBefore(s,i):(u.nodeType===8?(i=u.parentNode,i.insertBefore(s,u)):(i=u,i.appendChild(s)),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=sc));else if(m!==4&&(s=s.child,s!==null))for(bf(s,i,u),s=s.sibling;s!==null;)bf(s,i,u),s=s.sibling}function Ef(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(Ef(s,i,u),s=s.sibling;s!==null;)Ef(s,i,u),s=s.sibling}var jr=null,Gn=!1;function cs(s,i,u){for(u=u.child;u!==null;)Ym(s,i,u),u=u.sibling}function Ym(s,i,u){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(la,u)}catch{}switch(u.tag){case 5:Vr||Bo(u,i);case 6:var m=jr,v=Gn;jr=null,cs(s,i,u),jr=m,Gn=v,jr!==null&&(Gn?(s=jr,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):jr.removeChild(u.stateNode));break;case 18:jr!==null&&(Gn?(s=jr,u=u.stateNode,s.nodeType===8?I0(s.parentNode,u):s.nodeType===1&&I0(s,u),Si(s)):I0(jr,u.stateNode));break;case 4:m=jr,v=Gn,jr=u.stateNode.containerInfo,Gn=!0,cs(s,i,u),jr=m,Gn=v;break;case 0:case 11:case 14:case 15:if(!Vr&&(m=u.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var b=v,D=b.destroy;b=b.tag,D!==void 0&&((b&2)!==0||(b&4)!==0)&&kf(u,i,D),v=v.next}while(v!==m)}cs(s,i,u);break;case 1:if(!Vr&&(Bo(u,i),m=u.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=u.memoizedProps,m.state=u.memoizedState,m.componentWillUnmount()}catch(te){cr(u,i,te)}cs(s,i,u);break;case 21:cs(s,i,u);break;case 22:u.mode&1?(Vr=(m=Vr)||u.memoizedState!==null,cs(s,i,u),Vr=m):cs(s,i,u);break;default:cs(s,i,u)}}function Vm(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new Lk),i.forEach(function(m){var v=Gk.bind(null,s,m);u.has(m)||(u.add(m),m.then(v,v))})}}function Xn(s,i){var u=i.deletions;if(u!==null)for(var m=0;m<u.length;m++){var v=u[m];try{var b=s,D=i,te=D;e:for(;te!==null;){switch(te.tag){case 5:jr=te.stateNode,Gn=!1;break e;case 3:jr=te.stateNode.containerInfo,Gn=!0;break e;case 4:jr=te.stateNode.containerInfo,Gn=!0;break e}te=te.return}if(jr===null)throw Error(t(160));Ym(b,D,v),jr=null,Gn=!1;var ce=v.alternate;ce!==null&&(ce.return=null),v.return=null}catch(Se){cr(v,i,Se)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Km(i,s),i=i.sibling}function Km(s,i){var u=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Xn(i,s),da(s),m&4){try{Ki(3,s,s.return),Dc(3,s)}catch(tt){cr(s,s.return,tt)}try{Ki(5,s,s.return)}catch(tt){cr(s,s.return,tt)}}break;case 1:Xn(i,s),da(s),m&512&&u!==null&&Bo(u,u.return);break;case 5:if(Xn(i,s),da(s),m&512&&u!==null&&Bo(u,u.return),s.flags&32){var v=s.stateNode;try{it(v,"")}catch(tt){cr(s,s.return,tt)}}if(m&4&&(v=s.stateNode,v!=null)){var b=s.memoizedProps,D=u!==null?u.memoizedProps:b,te=s.type,ce=s.updateQueue;if(s.updateQueue=null,ce!==null)try{te==="input"&&b.type==="radio"&&b.name!=null&&Ee(v,b),ze(te,D);var Se=ze(te,b);for(D=0;D<ce.length;D+=2){var Me=ce[D],We=ce[D+1];Me==="style"?re(v,We):Me==="dangerouslySetInnerHTML"?Gt(v,We):Me==="children"?it(v,We):T(v,Me,We,Se)}switch(te){case"input":ye(v,b);break;case"textarea":Mt(v,b);break;case"select":var Re=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!b.multiple;var Qe=b.value;Qe!=null?wt(v,!!b.multiple,Qe,!1):Re!==!!b.multiple&&(b.defaultValue!=null?wt(v,!!b.multiple,b.defaultValue,!0):wt(v,!!b.multiple,b.multiple?[]:"",!1))}v[Ii]=b}catch(tt){cr(s,s.return,tt)}}break;case 6:if(Xn(i,s),da(s),m&4){if(s.stateNode===null)throw Error(t(162));v=s.stateNode,b=s.memoizedProps;try{v.nodeValue=b}catch(tt){cr(s,s.return,tt)}}break;case 3:if(Xn(i,s),da(s),m&4&&u!==null&&u.memoizedState.isDehydrated)try{Si(i.containerInfo)}catch(tt){cr(s,s.return,tt)}break;case 4:Xn(i,s),da(s);break;case 13:Xn(i,s),da(s),v=s.child,v.flags&8192&&(b=v.memoizedState!==null,v.stateNode.isHidden=b,!b||v.alternate!==null&&v.alternate.memoizedState!==null||(Cf=Be())),m&4&&Vm(s);break;case 22:if(Me=u!==null&&u.memoizedState!==null,s.mode&1?(Vr=(Se=Vr)||Me,Xn(i,s),Vr=Se):Xn(i,s),da(s),m&8192){if(Se=s.memoizedState!==null,(s.stateNode.isHidden=Se)&&!Me&&(s.mode&1)!==0)for(Je=s,Me=s.child;Me!==null;){for(We=Je=Me;Je!==null;){switch(Re=Je,Qe=Re.child,Re.tag){case 0:case 11:case 14:case 15:Ki(4,Re,Re.return);break;case 1:Bo(Re,Re.return);var et=Re.stateNode;if(typeof et.componentWillUnmount=="function"){m=Re,u=Re.return;try{i=m,et.props=i.memoizedProps,et.state=i.memoizedState,et.componentWillUnmount()}catch(tt){cr(m,u,tt)}}break;case 5:Bo(Re,Re.return);break;case 22:if(Re.memoizedState!==null){Qm(We);continue}}Qe!==null?(Qe.return=Re,Je=Qe):Qm(We)}Me=Me.sibling}e:for(Me=null,We=s;;){if(We.tag===5){if(Me===null){Me=We;try{v=We.stateNode,Se?(b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(te=We.stateNode,ce=We.memoizedProps.style,D=ce!=null&&ce.hasOwnProperty("display")?ce.display:null,te.style.display=gt("display",D))}catch(tt){cr(s,s.return,tt)}}}else if(We.tag===6){if(Me===null)try{We.stateNode.nodeValue=Se?"":We.memoizedProps}catch(tt){cr(s,s.return,tt)}}else if((We.tag!==22&&We.tag!==23||We.memoizedState===null||We===s)&&We.child!==null){We.child.return=We,We=We.child;continue}if(We===s)break e;for(;We.sibling===null;){if(We.return===null||We.return===s)break e;Me===We&&(Me=null),We=We.return}Me===We&&(Me=null),We.sibling.return=We.return,We=We.sibling}}break;case 19:Xn(i,s),da(s),m&4&&Vm(s);break;case 21:break;default:Xn(i,s),da(s)}}function da(s){var i=s.flags;if(i&2){try{e:{for(var u=s.return;u!==null;){if(Hm(u)){var m=u;break e}u=u.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(it(v,""),m.flags&=-33);var b=$m(s);Ef(s,b,v);break;case 3:case 4:var D=m.stateNode.containerInfo,te=$m(s);bf(s,te,D);break;default:throw Error(t(161))}}catch(ce){cr(s,s.return,ce)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Bk(s,i,u){Je=s,Gm(s)}function Gm(s,i,u){for(var m=(s.mode&1)!==0;Je!==null;){var v=Je,b=v.child;if(v.tag===22&&m){var D=v.memoizedState!==null||Cc;if(!D){var te=v.alternate,ce=te!==null&&te.memoizedState!==null||Vr;te=Cc;var Se=Vr;if(Cc=D,(Vr=ce)&&!Se)for(Je=v;Je!==null;)D=Je,ce=D.child,D.tag===22&&D.memoizedState!==null?qm(v):ce!==null?(ce.return=D,Je=ce):qm(v);for(;b!==null;)Je=b,Gm(b),b=b.sibling;Je=v,Cc=te,Vr=Se}Xm(s)}else(v.subtreeFlags&8772)!==0&&b!==null?(b.return=v,Je=b):Xm(s)}}function Xm(s){for(;Je!==null;){var i=Je;if((i.flags&8772)!==0){var u=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Vr||Dc(5,i);break;case 1:var m=i.stateNode;if(i.flags&4&&!Vr)if(u===null)m.componentDidMount();else{var v=i.elementType===i.type?u.memoizedProps:Kn(i.type,u.memoizedProps);m.componentDidUpdate(v,u.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&Qh(i,b,m);break;case 3:var D=i.updateQueue;if(D!==null){if(u=null,i.child!==null)switch(i.child.tag){case 5:u=i.child.stateNode;break;case 1:u=i.child.stateNode}Qh(i,D,u)}break;case 5:var te=i.stateNode;if(u===null&&i.flags&4){u=te;var ce=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":ce.autoFocus&&u.focus();break;case"img":ce.src&&(u.src=ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Se=i.alternate;if(Se!==null){var Me=Se.memoizedState;if(Me!==null){var We=Me.dehydrated;We!==null&&Si(We)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Vr||i.flags&512&&_f(i)}catch(Re){cr(i,i.return,Re)}}if(i===s){Je=null;break}if(u=i.sibling,u!==null){u.return=i.return,Je=u;break}Je=i.return}}function Qm(s){for(;Je!==null;){var i=Je;if(i===s){Je=null;break}var u=i.sibling;if(u!==null){u.return=i.return,Je=u;break}Je=i.return}}function qm(s){for(;Je!==null;){var i=Je;try{switch(i.tag){case 0:case 11:case 15:var u=i.return;try{Dc(4,i)}catch(ce){cr(i,u,ce)}break;case 1:var m=i.stateNode;if(typeof m.componentDidMount=="function"){var v=i.return;try{m.componentDidMount()}catch(ce){cr(i,v,ce)}}var b=i.return;try{_f(i)}catch(ce){cr(i,b,ce)}break;case 5:var D=i.return;try{_f(i)}catch(ce){cr(i,D,ce)}}}catch(ce){cr(i,i.return,ce)}if(i===s){Je=null;break}var te=i.sibling;if(te!==null){te.return=i.return,Je=te;break}Je=i.return}}var Wk=Math.ceil,Nc=L.ReactCurrentDispatcher,Sf=L.ReactCurrentOwner,On=L.ReactCurrentBatchConfig,Ct=0,Ar=null,yr=null,Lr=0,bn=0,Wo=as(0),Er=0,Gi=null,Us=0,Fc=0,Tf=0,Xi=null,xn=null,Cf=0,Uo=1/0,ja=null,Ac=!1,Df=null,us=null,Oc=!1,fs=null,Pc=0,Qi=0,Nf=null,Rc=-1,Mc=0;function rn(){return(Ct&6)!==0?Be():Rc!==-1?Rc:Rc=Be()}function ds(s){return(s.mode&1)===0?1:(Ct&2)!==0&&Lr!==0?Lr&-Lr:Ek.transition!==null?(Mc===0&&(Mc=$p()),Mc):(s=Bt,s!==0||(s=window.event,s=s===void 0?16:Jp(s.type)),s)}function Qn(s,i,u,m){if(50<Qi)throw Qi=0,Nf=null,Error(t(185));wi(s,u,m),((Ct&2)===0||s!==Ar)&&(s===Ar&&((Ct&2)===0&&(Fc|=u),Er===4&&ps(s,Lr)),gn(s,m),u===1&&Ct===0&&(i.mode&1)===0&&(Uo=Be()+500,cc&&os()))}function gn(s,i){var u=s.callbackNode;Ew(s,i);var m=$l(s,s===Ar?Lr:0);if(m===0)u!==null&&He(u),s.callbackNode=null,s.callbackPriority=0;else if(i=m&-m,s.callbackPriority!==i){if(u!=null&&He(u),i===1)s.tag===0?bk(Jm.bind(null,s)):Lh(Jm.bind(null,s)),yk(function(){(Ct&6)===0&&os()}),u=null;else{switch(Yp(m)){case 1:u=zt;break;case 4:u=jt;break;case 16:u=pr;break;case 536870912:u=Qa;break;default:u=pr}u=ix(u,Zm.bind(null,s))}s.callbackPriority=i,s.callbackNode=u}}function Zm(s,i){if(Rc=-1,Mc=0,(Ct&6)!==0)throw Error(t(327));var u=s.callbackNode;if(Ho()&&s.callbackNode!==u)return null;var m=$l(s,s===Ar?Lr:0);if(m===0)return null;if((m&30)!==0||(m&s.expiredLanes)!==0||i)i=Ic(s,m);else{i=m;var v=Ct;Ct|=2;var b=tx();(Ar!==s||Lr!==i)&&(ja=null,Uo=Be()+500,$s(s,i));do try{$k();break}catch(te){ex(s,te)}while(!0);V0(),Nc.current=b,Ct=v,yr!==null?i=0:(Ar=null,Lr=0,i=Er)}if(i!==0){if(i===2&&(v=l0(s),v!==0&&(m=v,i=Ff(s,v))),i===1)throw u=Gi,$s(s,0),ps(s,m),gn(s,Be()),u;if(i===6)ps(s,m);else{if(v=s.current.alternate,(m&30)===0&&!Uk(v)&&(i=Ic(s,m),i===2&&(b=l0(s),b!==0&&(m=b,i=Ff(s,b))),i===1))throw u=Gi,$s(s,0),ps(s,m),gn(s,Be()),u;switch(s.finishedWork=v,s.finishedLanes=m,i){case 0:case 1:throw Error(t(345));case 2:Ys(s,xn,ja);break;case 3:if(ps(s,m),(m&130023424)===m&&(i=Cf+500-Be(),10<i)){if($l(s,0)!==0)break;if(v=s.suspendedLanes,(v&m)!==m){rn(),s.pingedLanes|=s.suspendedLanes&v;break}s.timeoutHandle=M0(Ys.bind(null,s,xn,ja),i);break}Ys(s,xn,ja);break;case 4:if(ps(s,m),(m&4194240)===m)break;for(i=s.eventTimes,v=-1;0<m;){var D=31-hr(m);b=1<<D,D=i[D],D>v&&(v=D),m&=~b}if(m=v,m=Be()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*Wk(m/1960))-m,10<m){s.timeoutHandle=M0(Ys.bind(null,s,xn,ja),m);break}Ys(s,xn,ja);break;case 5:Ys(s,xn,ja);break;default:throw Error(t(329))}}}return gn(s,Be()),s.callbackNode===u?Zm.bind(null,s):null}function Ff(s,i){var u=Xi;return s.current.memoizedState.isDehydrated&&($s(s,i).flags|=256),s=Ic(s,i),s!==2&&(i=xn,xn=u,i!==null&&Af(i)),s}function Af(s){xn===null?xn=s:xn.push.apply(xn,s)}function Uk(s){for(var i=s;;){if(i.flags&16384){var u=i.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var m=0;m<u.length;m++){var v=u[m],b=v.getSnapshot;v=v.value;try{if(!Yn(b(),v))return!1}catch{return!1}}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ps(s,i){for(i&=~Tf,i&=~Fc,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var u=31-hr(i),m=1<<u;s[u]=-1,i&=~m}}function Jm(s){if((Ct&6)!==0)throw Error(t(327));Ho();var i=$l(s,0);if((i&1)===0)return gn(s,Be()),null;var u=Ic(s,i);if(s.tag!==0&&u===2){var m=l0(s);m!==0&&(i=m,u=Ff(s,m))}if(u===1)throw u=Gi,$s(s,0),ps(s,i),gn(s,Be()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Ys(s,xn,ja),gn(s,Be()),null}function Of(s,i){var u=Ct;Ct|=1;try{return s(i)}finally{Ct=u,Ct===0&&(Uo=Be()+500,cc&&os())}}function Hs(s){fs!==null&&fs.tag===0&&(Ct&6)===0&&Ho();var i=Ct;Ct|=1;var u=On.transition,m=Bt;try{if(On.transition=null,Bt=1,s)return s()}finally{Bt=m,On.transition=u,Ct=i,(Ct&6)===0&&os()}}function Pf(){bn=Wo.current,Qt(Wo)}function $s(s,i){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,vk(u)),yr!==null)for(u=yr.return;u!==null;){var m=u;switch(W0(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&ic();break;case 3:Lo(),Qt(pn),Qt(Hr),ef();break;case 5:Z0(m);break;case 4:Lo();break;case 13:Qt(ar);break;case 19:Qt(ar);break;case 10:K0(m.type._context);break;case 22:case 23:Pf()}u=u.return}if(Ar=s,yr=s=hs(s.current,null),Lr=bn=i,Er=0,Gi=null,Tf=Fc=Us=0,xn=Xi=null,zs!==null){for(i=0;i<zs.length;i++)if(u=zs[i],m=u.interleaved,m!==null){u.interleaved=null;var v=m.next,b=u.pending;if(b!==null){var D=b.next;b.next=v,m.next=D}u.pending=m}zs=null}return s}function ex(s,i){do{var u=yr;try{if(V0(),yc.current=bc,wc){for(var m=sr.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}wc=!1}if(Ws=0,Fr=br=sr=null,Ui=!1,Hi=0,Sf.current=null,u===null||u.return===null){Er=1,Gi=i,yr=null;break}e:{var b=s,D=u.return,te=u,ce=i;if(i=Lr,te.flags|=32768,ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var Se=ce,Me=te,We=Me.tag;if((Me.mode&1)===0&&(We===0||We===11||We===15)){var Re=Me.alternate;Re?(Me.updateQueue=Re.updateQueue,Me.memoizedState=Re.memoizedState,Me.lanes=Re.lanes):(Me.updateQueue=null,Me.memoizedState=null)}var Qe=Sm(D);if(Qe!==null){Qe.flags&=-257,Tm(Qe,D,te,b,i),Qe.mode&1&&Em(b,Se,i),i=Qe,ce=Se;var et=i.updateQueue;if(et===null){var tt=new Set;tt.add(ce),i.updateQueue=tt}else et.add(ce);break e}else{if((i&1)===0){Em(b,Se,i),Rf();break e}ce=Error(t(426))}}else if(Jt&&te.mode&1){var mr=Sm(D);if(mr!==null){(mr.flags&65536)===0&&(mr.flags|=256),Tm(mr,D,te,b,i),$0(zo(ce,te));break e}}b=ce=zo(ce,te),Er!==4&&(Er=2),Xi===null?Xi=[b]:Xi.push(b),b=D;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var xe=_m(b,ce,i);Xh(b,xe);break e;case 1:te=ce;var de=b.type,ke=b.stateNode;if((b.flags&128)===0&&(typeof de.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(us===null||!us.has(ke)))){b.flags|=65536,i&=-i,b.lanes|=i;var Ue=bm(b,te,i);Xh(b,Ue);break e}}b=b.return}while(b!==null)}nx(u)}catch(rt){i=rt,yr===u&&u!==null&&(yr=u=u.return);continue}break}while(!0)}function tx(){var s=Nc.current;return Nc.current=bc,s===null?bc:s}function Rf(){(Er===0||Er===3||Er===2)&&(Er=4),Ar===null||(Us&268435455)===0&&(Fc&268435455)===0||ps(Ar,Lr)}function Ic(s,i){var u=Ct;Ct|=2;var m=tx();(Ar!==s||Lr!==i)&&(ja=null,$s(s,i));do try{Hk();break}catch(v){ex(s,v)}while(!0);if(V0(),Ct=u,Nc.current=m,yr!==null)throw Error(t(261));return Ar=null,Lr=0,Er}function Hk(){for(;yr!==null;)rx(yr)}function $k(){for(;yr!==null&&!je();)rx(yr)}function rx(s){var i=ox(s.alternate,s,bn);s.memoizedProps=s.pendingProps,i===null?nx(s):yr=i,Sf.current=null}function nx(s){var i=s;do{var u=i.alternate;if(s=i.return,(i.flags&32768)===0){if(u=Ik(u,i,bn),u!==null){yr=u;return}}else{if(u=jk(u,i),u!==null){u.flags&=32767,yr=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Er=6,yr=null;return}}if(i=i.sibling,i!==null){yr=i;return}yr=i=s}while(i!==null);Er===0&&(Er=5)}function Ys(s,i,u){var m=Bt,v=On.transition;try{On.transition=null,Bt=1,Yk(s,i,u,m)}finally{On.transition=v,Bt=m}return null}function Yk(s,i,u,m){do Ho();while(fs!==null);if((Ct&6)!==0)throw Error(t(327));u=s.finishedWork;var v=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var b=u.lanes|u.childLanes;if(Sw(s,b),s===Ar&&(yr=Ar=null,Lr=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Oc||(Oc=!0,ix(pr,function(){return Ho(),null})),b=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||b){b=On.transition,On.transition=null;var D=Bt;Bt=1;var te=Ct;Ct|=4,Sf.current=null,zk(s,u),Km(u,s),fk(P0),Kl=!!O0,P0=O0=null,s.current=u,Bk(u),Le(),Ct=te,Bt=D,On.transition=b}else s.current=u;if(Oc&&(Oc=!1,fs=s,Pc=v),b=s.pendingLanes,b===0&&(us=null),vi(u.stateNode),gn(s,Be()),i!==null)for(m=s.onRecoverableError,u=0;u<i.length;u++)v=i[u],m(v.value,{componentStack:v.stack,digest:v.digest});if(Ac)throw Ac=!1,s=Df,Df=null,s;return(Pc&1)!==0&&s.tag!==0&&Ho(),b=s.pendingLanes,(b&1)!==0?s===Nf?Qi++:(Qi=0,Nf=s):Qi=0,os(),null}function Ho(){if(fs!==null){var s=Yp(Pc),i=On.transition,u=Bt;try{if(On.transition=null,Bt=16>s?16:s,fs===null)var m=!1;else{if(s=fs,fs=null,Pc=0,(Ct&6)!==0)throw Error(t(331));var v=Ct;for(Ct|=4,Je=s.current;Je!==null;){var b=Je,D=b.child;if((Je.flags&16)!==0){var te=b.deletions;if(te!==null){for(var ce=0;ce<te.length;ce++){var Se=te[ce];for(Je=Se;Je!==null;){var Me=Je;switch(Me.tag){case 0:case 11:case 15:Ki(8,Me,b)}var We=Me.child;if(We!==null)We.return=Me,Je=We;else for(;Je!==null;){Me=Je;var Re=Me.sibling,Qe=Me.return;if(Um(Me),Me===Se){Je=null;break}if(Re!==null){Re.return=Qe,Je=Re;break}Je=Qe}}}var et=b.alternate;if(et!==null){var tt=et.child;if(tt!==null){et.child=null;do{var mr=tt.sibling;tt.sibling=null,tt=mr}while(tt!==null)}}Je=b}}if((b.subtreeFlags&2064)!==0&&D!==null)D.return=b,Je=D;else e:for(;Je!==null;){if(b=Je,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:Ki(9,b,b.return)}var xe=b.sibling;if(xe!==null){xe.return=b.return,Je=xe;break e}Je=b.return}}var de=s.current;for(Je=de;Je!==null;){D=Je;var ke=D.child;if((D.subtreeFlags&2064)!==0&&ke!==null)ke.return=D,Je=ke;else e:for(D=de;Je!==null;){if(te=Je,(te.flags&2048)!==0)try{switch(te.tag){case 0:case 11:case 15:Dc(9,te)}}catch(rt){cr(te,te.return,rt)}if(te===D){Je=null;break e}var Ue=te.sibling;if(Ue!==null){Ue.return=te.return,Je=Ue;break e}Je=te.return}}if(Ct=v,os(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(la,s)}catch{}m=!0}return m}finally{Bt=u,On.transition=i}}return!1}function ax(s,i,u){i=zo(u,i),i=_m(s,i,1),s=ls(s,i,1),i=rn(),s!==null&&(wi(s,1,i),gn(s,i))}function cr(s,i,u){if(s.tag===3)ax(s,s,u);else for(;i!==null;){if(i.tag===3){ax(i,s,u);break}else if(i.tag===1){var m=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(us===null||!us.has(m))){s=zo(u,s),s=bm(i,s,1),i=ls(i,s,1),s=rn(),i!==null&&(wi(i,1,s),gn(i,s));break}}i=i.return}}function Vk(s,i,u){var m=s.pingCache;m!==null&&m.delete(i),i=rn(),s.pingedLanes|=s.suspendedLanes&u,Ar===s&&(Lr&u)===u&&(Er===4||Er===3&&(Lr&130023424)===Lr&&500>Be()-Cf?$s(s,0):Tf|=u),gn(s,i)}function sx(s,i){i===0&&((s.mode&1)===0?i=1:(i=Hl,Hl<<=1,(Hl&130023424)===0&&(Hl=4194304)));var u=rn();s=Ra(s,i),s!==null&&(wi(s,i,u),gn(s,u))}function Kk(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),sx(s,u)}function Gk(s,i){var u=0;switch(s.tag){case 13:var m=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(i),sx(s,u)}var ox;ox=function(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps||pn.current)mn=!0;else{if((s.lanes&u)===0&&(i.flags&128)===0)return mn=!1,Mk(s,i,u);mn=(s.flags&131072)!==0}else mn=!1,Jt&&(i.flags&1048576)!==0&&zh(i,fc,i.index);switch(i.lanes=0,i.tag){case 2:var m=i.type;Tc(s,i),s=i.pendingProps;var v=Ao(i,Hr.current);jo(i,u),v=nf(null,i,m,s,v,u);var b=af();return i.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,hn(m)?(b=!0,lc(i)):b=!1,i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Q0(i),v.updater=Ec,i.stateNode=v,v._reactInternals=i,ff(i,m,s,u),i=mf(null,i,m,!0,b,u)):(i.tag=0,Jt&&b&&B0(i),tn(null,i,v,u),i=i.child),i;case 16:m=i.elementType;e:{switch(Tc(s,i),s=i.pendingProps,v=m._init,m=v(m._payload),i.type=m,v=i.tag=Qk(m),s=Kn(m,s),v){case 0:i=hf(null,i,m,s,u);break e;case 1:i=Om(null,i,m,s,u);break e;case 11:i=Cm(null,i,m,s,u);break e;case 14:i=Dm(null,i,m,Kn(m.type,s),u);break e}throw Error(t(306,m,""))}return i;case 0:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),hf(s,i,m,v,u);case 1:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Om(s,i,m,v,u);case 3:e:{if(Pm(i),s===null)throw Error(t(387));m=i.pendingProps,b=i.memoizedState,v=b.element,Gh(s,i),gc(i,m,null,u);var D=i.memoizedState;if(m=D.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){v=zo(Error(t(423)),i),i=Rm(s,i,m,u,v);break e}else if(m!==v){v=zo(Error(t(424)),i),i=Rm(s,i,m,u,v);break e}else for(_n=ns(i.stateNode.containerInfo.firstChild),kn=i,Jt=!0,Vn=null,u=Vh(i,null,m,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Ro(),m===v){i=Ia(s,i,u);break e}tn(s,i,m,u)}i=i.child}return i;case 5:return qh(i),s===null&&H0(i),m=i.type,v=i.pendingProps,b=s!==null?s.memoizedProps:null,D=v.children,R0(m,v)?D=null:b!==null&&R0(m,b)&&(i.flags|=32),Am(s,i),tn(s,i,D,u),i.child;case 6:return s===null&&H0(i),null;case 13:return Mm(s,i,u);case 4:return q0(i,i.stateNode.containerInfo),m=i.pendingProps,s===null?i.child=Mo(i,null,m,u):tn(s,i,m,u),i.child;case 11:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Cm(s,i,m,v,u);case 7:return tn(s,i,i.pendingProps,u),i.child;case 8:return tn(s,i,i.pendingProps.children,u),i.child;case 12:return tn(s,i,i.pendingProps.children,u),i.child;case 10:e:{if(m=i.type._context,v=i.pendingProps,b=i.memoizedProps,D=v.value,Vt(hc,m._currentValue),m._currentValue=D,b!==null)if(Yn(b.value,D)){if(b.children===v.children&&!pn.current){i=Ia(s,i,u);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var te=b.dependencies;if(te!==null){D=b.child;for(var ce=te.firstContext;ce!==null;){if(ce.context===m){if(b.tag===1){ce=Ma(-1,u&-u),ce.tag=2;var Se=b.updateQueue;if(Se!==null){Se=Se.shared;var Me=Se.pending;Me===null?ce.next=ce:(ce.next=Me.next,Me.next=ce),Se.pending=ce}}b.lanes|=u,ce=b.alternate,ce!==null&&(ce.lanes|=u),G0(b.return,u,i),te.lanes|=u;break}ce=ce.next}}else if(b.tag===10)D=b.type===i.type?null:b.child;else if(b.tag===18){if(D=b.return,D===null)throw Error(t(341));D.lanes|=u,te=D.alternate,te!==null&&(te.lanes|=u),G0(D,u,i),D=b.sibling}else D=b.child;if(D!==null)D.return=b;else for(D=b;D!==null;){if(D===i){D=null;break}if(b=D.sibling,b!==null){b.return=D.return,D=b;break}D=D.return}b=D}tn(s,i,v.children,u),i=i.child}return i;case 9:return v=i.type,m=i.pendingProps.children,jo(i,u),v=Fn(v),m=m(v),i.flags|=1,tn(s,i,m,u),i.child;case 14:return m=i.type,v=Kn(m,i.pendingProps),v=Kn(m.type,v),Dm(s,i,m,v,u);case 15:return Nm(s,i,i.type,i.pendingProps,u);case 17:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Tc(s,i),i.tag=1,hn(m)?(s=!0,lc(i)):s=!1,jo(i,u),wm(i,m,v),ff(i,m,v,u),mf(null,i,m,!0,s,u);case 19:return jm(s,i,u);case 22:return Fm(s,i,u)}throw Error(t(156,i.tag))};function ix(s,i){return Ie(s,i)}function Xk(s,i,u,m){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,i,u,m){return new Xk(s,i,u,m)}function Mf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Qk(s){if(typeof s=="function")return Mf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===z)return 11;if(s===oe)return 14}return 2}function hs(s,i){var u=s.alternate;return u===null?(u=Pn(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function jc(s,i,u,m,v,b){var D=2;if(m=s,typeof s=="function")Mf(s)&&(D=1);else if(typeof s=="string")D=5;else e:switch(s){case C:return Vs(u.children,v,b,i);case Z:D=8,v|=8;break;case M:return s=Pn(12,u,i,v|2),s.elementType=M,s.lanes=b,s;case fe:return s=Pn(13,u,i,v),s.elementType=fe,s.lanes=b,s;case ue:return s=Pn(19,u,i,v),s.elementType=ue,s.lanes=b,s;case V:return Lc(u,v,b,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ne:D=10;break e;case G:D=9;break e;case z:D=11;break e;case oe:D=14;break e;case pe:D=16,m=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Pn(D,u,i,v),i.elementType=s,i.type=m,i.lanes=b,i}function Vs(s,i,u,m){return s=Pn(7,s,m,i),s.lanes=u,s}function Lc(s,i,u,m){return s=Pn(22,s,m,i),s.elementType=V,s.lanes=u,s.stateNode={isHidden:!1},s}function If(s,i,u){return s=Pn(6,s,null,i),s.lanes=u,s}function jf(s,i,u){return i=Pn(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function qk(s,i,u,m,v){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=c0(0),this.expirationTimes=c0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=c0(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function Lf(s,i,u,m,v,b,D,te,ce){return s=new qk(s,i,u,te,ce),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Pn(3,null,null,i),s.current=b,b.stateNode=s,b.memoizedState={element:m,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Q0(b),s}function Zk(s,i,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:m==null?null:""+m,children:s,containerInfo:i,implementation:u}}function lx(s){if(!s)return ss;s=s._reactInternals;e:{if(X(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(hn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(hn(u))return Ih(s,u,i)}return i}function cx(s,i,u,m,v,b,D,te,ce){return s=Lf(u,m,!0,s,v,b,D,te,ce),s.context=lx(null),u=s.current,m=rn(),v=ds(u),b=Ma(m,v),b.callback=i??null,ls(u,b,v),s.current.lanes=v,wi(s,v,m),gn(s,m),s}function zc(s,i,u,m){var v=i.current,b=rn(),D=ds(v);return u=lx(u),i.context===null?i.context=u:i.pendingContext=u,i=Ma(b,D),i.payload={element:s},m=m===void 0?null:m,m!==null&&(i.callback=m),s=ls(v,i,D),s!==null&&(Qn(s,v,D,b),xc(s,v,D)),D}function Bc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function ux(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function zf(s,i){ux(s,i),(s=s.alternate)&&ux(s,i)}function Jk(){return null}var fx=typeof reportError=="function"?reportError:function(s){console.error(s)};function Bf(s){this._internalRoot=s}Wc.prototype.render=Bf.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));zc(s,i,null,null)},Wc.prototype.unmount=Bf.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Hs(function(){zc(null,s,null,null)}),i[Fa]=null}};function Wc(s){this._internalRoot=s}Wc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Gp();s={blockedOn:null,target:s,priority:i};for(var u=0;u<es.length&&i!==0&&i<es[u].priority;u++);es.splice(u,0,s),u===0&&qp(s)}};function Wf(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Uc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function dx(){}function e2(s,i,u,m,v){if(v){if(typeof m=="function"){var b=m;m=function(){var Se=Bc(D);b.call(Se)}}var D=cx(i,m,s,0,null,!1,!1,"",dx);return s._reactRootContainer=D,s[Fa]=D.current,Ri(s.nodeType===8?s.parentNode:s),Hs(),D}for(;v=s.lastChild;)s.removeChild(v);if(typeof m=="function"){var te=m;m=function(){var Se=Bc(ce);te.call(Se)}}var ce=Lf(s,0,!1,null,null,!1,!1,"",dx);return s._reactRootContainer=ce,s[Fa]=ce.current,Ri(s.nodeType===8?s.parentNode:s),Hs(function(){zc(i,ce,u,m)}),ce}function Hc(s,i,u,m,v){var b=u._reactRootContainer;if(b){var D=b;if(typeof v=="function"){var te=v;v=function(){var ce=Bc(D);te.call(ce)}}zc(i,D,s,v)}else D=e2(u,i,s,v,m);return Bc(D)}Vp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var u=yi(i.pendingLanes);u!==0&&(u0(i,u|1),gn(i,Be()),(Ct&6)===0&&(Uo=Be()+500,os()))}break;case 13:Hs(function(){var m=Ra(s,1);if(m!==null){var v=rn();Qn(m,s,1,v)}}),zf(s,1)}},f0=function(s){if(s.tag===13){var i=Ra(s,134217728);if(i!==null){var u=rn();Qn(i,s,134217728,u)}zf(s,134217728)}},Kp=function(s){if(s.tag===13){var i=ds(s),u=Ra(s,i);if(u!==null){var m=rn();Qn(u,s,i,m)}zf(s,i)}},Gp=function(){return Bt},Xp=function(s,i){var u=Bt;try{return Bt=s,i()}finally{Bt=u}},Oe=function(s,i,u){switch(i){case"input":if(ye(s,u),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<u.length;i++){var m=u[i];if(m!==s&&m.form===s.form){var v=oc(m);if(!v)throw Error(t(90));I(m),ye(m,v)}}}break;case"textarea":Mt(s,u);break;case"select":i=u.value,i!=null&&wt(s,!!u.multiple,i,!1)}},At=Of,at=Hs;var t2={usingClientEntryPoint:!1,Events:[ji,No,oc,Ye,st,Of]},qi={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},r2={bundleType:qi.bundleType,version:qi.version,rendererPackageName:qi.rendererPackageName,rendererConfig:qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=_e(s),s===null?null:s.stateNode},findFiberByHostInstance:qi.findFiberByHostInstance||Jk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{la=$c.inject(r2),Nr=$c}catch{}}return vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t2,vn.createPortal=function(s,i){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wf(i))throw Error(t(200));return Zk(s,i,null,u)},vn.createRoot=function(s,i){if(!Wf(s))throw Error(t(299));var u=!1,m="",v=fx;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=Lf(s,1,!1,null,null,u,!1,m,v),s[Fa]=i.current,Ri(s.nodeType===8?s.parentNode:s),new Bf(i)},vn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=_e(i),s=s===null?null:s.stateNode,s},vn.flushSync=function(s){return Hs(s)},vn.hydrate=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!0,u)},vn.hydrateRoot=function(s,i,u){if(!Wf(s))throw Error(t(405));var m=u!=null&&u.hydratedSources||null,v=!1,b="",D=fx;if(u!=null&&(u.unstable_strictMode===!0&&(v=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onRecoverableError!==void 0&&(D=u.onRecoverableError)),i=cx(i,null,s,1,u??null,v,!1,b,D),s[Fa]=i.current,Ri(s),m)for(s=0;s<m.length;s++)u=m[s],v=u._getVersion,v=v(u._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[u,v]:i.mutableSourceEagerHydrationData.push(u,v);return new Wc(i)},vn.render=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!1,u)},vn.unmountComponentAtNode=function(s){if(!Uc(s))throw Error(t(40));return s._reactRootContainer?(Hs(function(){Hc(null,null,s,!1,function(){s._reactRootContainer=null,s[Fa]=null})}),!0):!1},vn.unstable_batchedUpdates=Of,vn.unstable_renderSubtreeIntoContainer=function(s,i,u,m){if(!Uc(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Hc(s,i,u,!1,m)},vn.version="18.3.1-next-f1338f8080-20240426",vn}var wx;function Qd(){if(wx)return $f.exports;wx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),$f.exports=f2(),$f.exports}var kx;function d2(){if(kx)return Yc;kx=1;var e=Qd();return Yc.createRoot=e.createRoot,Yc.hydrateRoot=e.hydrateRoot,Yc}var p2=d2();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var h2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ia=(e,n)=>{const t=N.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...h},p)=>N.createElement("svg",{ref:p,...h2,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${m2(e)}`,c].join(" "),...h},[...n.map(([x,g])=>N.createElement(x,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=ia("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=ia("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=ia("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=ia("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=ia("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=ia("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=ia("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=ia("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=ia("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=ia("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=ia("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Vc={exports:{}},xs={},Kf={exports:{}},Gf,_x;function y2(){if(_x)return Gf;_x=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Gf=e,Gf}var Xf,bx;function w2(){if(bx)return Xf;bx=1;var e=y2();function n(){}function t(){}return t.resetWarningCache=n,Xf=function(){function r(l,c,f,h,p,x){if(x!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},Xf}var Ex;function Iv(){return Ex||(Ex=1,Kf.exports=w2()()),Kf.exports}var Kc={exports:{}},Rn={},Gc={exports:{}},Sx;function jv(){return Sx||(Sx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(x,g){return g.getPropertyValue("overflow")!=="visible"||x.scrollWidth<=0&&x.scrollHeight<=0}function l(x){var g=x.offsetWidth<=0&&x.offsetHeight<=0;if(g&&!x.innerHTML)return!0;try{var y=window.getComputedStyle(x),k=y.getPropertyValue("display");return g?k!==r&&o(x,y):k===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(x){for(var g=x,y=x.getRootNode&&x.getRootNode();g&&g!==document.body;){if(y&&g===y&&(g=y.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(x,g){var y=x.nodeName.toLowerCase(),k=a.test(y)&&!x.disabled||y==="a"&&x.href||g;return k&&c(x)}function h(x){var g=x.getAttribute("tabindex");g===null&&(g=void 0);var y=isNaN(g);return(y||g>=0)&&f(x,!y)}function p(x){var g=[].slice.call(x.querySelectorAll("*"),0).reduce(function(y,k){return y.concat(k.shadowRoot?p(k.shadowRoot):[k])},[]);return g.filter(h)}e.exports=n.default})(Gc,Gc.exports)),Gc.exports}var Tx;function k2(){if(Tx)return Rn;Tx=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.resetState=l,Rn.log=c,Rn.handleBlur=f,Rn.handleFocus=h,Rn.markForFocusLater=p,Rn.returnFocus=x,Rn.popWithoutFocus=g,Rn.setupScopedFocus=y,Rn.teardownScopedFocus=k;var e=jv(),n=t(e);function t(w){return w&&w.__esModule?w:{default:w}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function h(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var w=(0,n.default)(a)[0]||a;w.focus()}},0)}}function p(){r.push(document.activeElement)}function x(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=null;try{r.length!==0&&(_=r.pop(),_.focus({preventScroll:w}));return}catch{console.warn(["You tried to return focus to",_,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function y(w){a=w,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",h,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",h))}function k(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",h)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",h))}return Rn}var Xc={exports:{}},Cx;function _2(){return Cx||(Cx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=jv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var h=(0,r.default)(c);if(!h.length){f.preventDefault();return}var p=void 0,x=f.shiftKey,g=h[0],y=h[h.length-1],k=o();if(c===k){if(!x)return;p=y}if(y===k&&!x&&(p=g),g===k&&x&&(p=y),p){f.preventDefault(),p.focus();return}var w=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),_=w!=null&&w[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(_){var E=h.indexOf(k);if(E>-1&&(E+=x?-1:1),p=h[E],typeof p>"u"){f.preventDefault(),p=x?y:g,p.focus();return}f.preventDefault(),p.focus()}}e.exports=n.default})(Xc,Xc.exports)),Xc.exports}var qn={},Qf,Dx;function b2(){if(Dx)return Qf;Dx=1;var e=function(){};return Qf=e,Qf}var pa={},qf={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Nx;function E2(){return Nx||(Nx=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(qf)),qf.exports}var Fx;function tp(){if(Fx)return pa;Fx=1,Object.defineProperty(pa,"__esModule",{value:!0}),pa.canUseDOM=pa.SafeNodeList=pa.SafeHTMLCollection=void 0;var e=E2(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return pa.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},pa.SafeNodeList=r.canUseDOM?window.NodeList:{},pa.canUseDOM=r.canUseDOM,pa.default=a,pa}var Ax;function Lv(){if(Ax)return qn;Ax=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.resetState=o,qn.log=l,qn.assertNodeList=c,qn.setElement=f,qn.validateElement=h,qn.hide=p,qn.show=x,qn.documentNotReadyOrSSRTesting=g;var e=b2(),n=r(e),t=tp();function r(y){return y&&y.__esModule?y:{default:y}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(y){return y.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(y){return y.removeAttribute("aria-hidden")})),a=null}function l(){}function c(y,k){if(!y||!y.length)throw new Error("react-modal: No elements were found for selector "+k+".")}function f(y){var k=y;if(typeof k=="string"&&t.canUseDOM){var w=document.querySelectorAll(k);c(w,k),k=w}return a=k||a,a}function h(y){var k=y||a;return k?Array.isArray(k)||k instanceof HTMLCollection||k instanceof NodeList?k:[k]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function p(y){var k=!0,w=!1,_=void 0;try{for(var E=h(y)[Symbol.iterator](),A;!(k=(A=E.next()).done);k=!0){var T=A.value;T.setAttribute("aria-hidden","true")}}catch(L){w=!0,_=L}finally{try{!k&&E.return&&E.return()}finally{if(w)throw _}}}function x(y){var k=!0,w=!1,_=void 0;try{for(var E=h(y)[Symbol.iterator](),A;!(k=(A=E.next()).done);k=!0){var T=A.value;T.removeAttribute("aria-hidden")}}catch(L){w=!0,_=L}finally{try{!k&&E.return&&E.return()}finally{if(w)throw _}}}function g(){a=null}return qn}var Ks={},Ox;function S2(){if(Ox)return Ks;Ox=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.resetState=r,Ks.log=a;var e={},n={};function t(h,p){h.classList.remove(p)}function r(){var h=document.getElementsByTagName("html")[0];for(var p in e)t(h,e[p]);var x=document.body;for(var g in n)t(x,n[g]);e={},n={}}function a(){}var o=function(p,x){return p[x]||(p[x]=0),p[x]+=1,x},l=function(p,x){return p[x]&&(p[x]-=1),x},c=function(p,x,g){g.forEach(function(y){o(x,y),p.add(y)})},f=function(p,x,g){g.forEach(function(y){l(x,y),x[y]===0&&p.remove(y)})};return Ks.add=function(p,x){return c(p.classList,p.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks.remove=function(p,x){return f(p.classList,p.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks}var $o={},Px;function zv(){if(Px)return $o;Px=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.log=r,$o.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return $o.default=t,$o}var Ji={},Rx;function T2(){if(Rx)return Ji;Rx=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.resetState=l,Ji.log=c;var e=zv(),n=t(e);function t(p){return p&&p.__esModule?p:{default:p}}var r=void 0,a=void 0,o=[];function l(){for(var p=[r,a],x=0;x<p.length;x++){var g=p[x];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var p=[r,a],x=0;x<p.length;x++){var g=p[x],y=g||{};console.log(y.nodeName,y.className,y.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function h(p,x){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=x,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(h),Ji}var Mx;function C2(){return Mx||(Mx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(ue){for(var oe=1;oe<arguments.length;oe++){var pe=arguments[oe];for(var V in pe)Object.prototype.hasOwnProperty.call(pe,V)&&(ue[V]=pe[V])}return ue},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ue){return typeof ue}:function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue},a=(function(){function ue(oe,pe){for(var V=0;V<pe.length;V++){var ie=pe[V];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(oe,ie.key,ie)}}return function(oe,pe,V){return pe&&ue(oe.prototype,pe),V&&ue(oe,V),oe}})(),o=Nl(),l=Iv(),c=J(l),f=k2(),h=L(f),p=_2(),x=J(p),g=Lv(),y=L(g),k=S2(),w=L(k),_=tp(),E=J(_),A=zv(),T=J(A);T2();function L(ue){if(ue&&ue.__esModule)return ue;var oe={};if(ue!=null)for(var pe in ue)Object.prototype.hasOwnProperty.call(ue,pe)&&(oe[pe]=ue[pe]);return oe.default=ue,oe}function J(ue){return ue&&ue.__esModule?ue:{default:ue}}function O(ue,oe){if(!(ue instanceof oe))throw new TypeError("Cannot call a class as a function")}function C(ue,oe){if(!ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return oe&&(typeof oe=="object"||typeof oe=="function")?oe:ue}function Z(ue,oe){if(typeof oe!="function"&&oe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof oe);ue.prototype=Object.create(oe&&oe.prototype,{constructor:{value:ue,enumerable:!1,writable:!0,configurable:!0}}),oe&&(Object.setPrototypeOf?Object.setPrototypeOf(ue,oe):ue.__proto__=oe)}var M={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},ne=function(oe){return oe.code==="Tab"||oe.keyCode===9},G=function(oe){return oe.code==="Escape"||oe.keyCode===27},z=0,fe=(function(ue){Z(oe,ue);function oe(pe){O(this,oe);var V=C(this,(oe.__proto__||Object.getPrototypeOf(oe)).call(this,pe));return V.setOverlayRef=function(ie){V.overlay=ie,V.props.overlayRef&&V.props.overlayRef(ie)},V.setContentRef=function(ie){V.content=ie,V.props.contentRef&&V.props.contentRef(ie)},V.afterClose=function(){var ie=V.props,q=ie.appElement,ae=ie.ariaHideApp,B=ie.htmlOpenClassName,S=ie.bodyOpenClassName,R=ie.parentSelector,P=R&&R().ownerDocument||document;S&&w.remove(P.body,S),B&&w.remove(P.getElementsByTagName("html")[0],B),ae&&z>0&&(z-=1,z===0&&y.show(q)),V.props.shouldFocusAfterRender&&(V.props.shouldReturnFocusAfterClose?(h.returnFocus(V.props.preventScroll),h.teardownScopedFocus()):h.popWithoutFocus()),V.props.onAfterClose&&V.props.onAfterClose(),T.default.deregister(V)},V.open=function(){V.beforeOpen(),V.state.afterOpen&&V.state.beforeClose?(clearTimeout(V.closeTimer),V.setState({beforeClose:!1})):(V.props.shouldFocusAfterRender&&(h.setupScopedFocus(V.node),h.markForFocusLater()),V.setState({isOpen:!0},function(){V.openAnimationFrame=requestAnimationFrame(function(){V.setState({afterOpen:!0}),V.props.isOpen&&V.props.onAfterOpen&&V.props.onAfterOpen({overlayEl:V.overlay,contentEl:V.content})})}))},V.close=function(){V.props.closeTimeoutMS>0?V.closeWithTimeout():V.closeWithoutTimeout()},V.focusContent=function(){return V.content&&!V.contentHasFocus()&&V.content.focus({preventScroll:!0})},V.closeWithTimeout=function(){var ie=Date.now()+V.props.closeTimeoutMS;V.setState({beforeClose:!0,closesAt:ie},function(){V.closeTimer=setTimeout(V.closeWithoutTimeout,V.state.closesAt-Date.now())})},V.closeWithoutTimeout=function(){V.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},V.afterClose)},V.handleKeyDown=function(ie){ne(ie)&&(0,x.default)(V.content,ie),V.props.shouldCloseOnEsc&&G(ie)&&(ie.stopPropagation(),V.requestClose(ie))},V.handleOverlayOnClick=function(ie){V.shouldClose===null&&(V.shouldClose=!0),V.shouldClose&&V.props.shouldCloseOnOverlayClick&&(V.ownerHandlesClose()?V.requestClose(ie):V.focusContent()),V.shouldClose=null},V.handleContentOnMouseUp=function(){V.shouldClose=!1},V.handleOverlayOnMouseDown=function(ie){!V.props.shouldCloseOnOverlayClick&&ie.target==V.overlay&&ie.preventDefault()},V.handleContentOnClick=function(){V.shouldClose=!1},V.handleContentOnMouseDown=function(){V.shouldClose=!1},V.requestClose=function(ie){return V.ownerHandlesClose()&&V.props.onRequestClose(ie)},V.ownerHandlesClose=function(){return V.props.onRequestClose},V.shouldBeClosed=function(){return!V.state.isOpen&&!V.state.beforeClose},V.contentHasFocus=function(){return document.activeElement===V.content||V.content.contains(document.activeElement)},V.buildClassName=function(ie,q){var ae=(typeof q>"u"?"undefined":r(q))==="object"?q:{base:M[ie],afterOpen:M[ie]+"--after-open",beforeClose:M[ie]+"--before-close"},B=ae.base;return V.state.afterOpen&&(B=B+" "+ae.afterOpen),V.state.beforeClose&&(B=B+" "+ae.beforeClose),typeof q=="string"&&q?B+" "+q:B},V.attributesFromObject=function(ie,q){return Object.keys(q).reduce(function(ae,B){return ae[ie+"-"+B]=q[B],ae},{})},V.state={afterOpen:!1,beforeClose:!1},V.shouldClose=null,V.moveFromContentToOverlay=null,V}return a(oe,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(V,ie){this.props.isOpen&&!V.isOpen?this.open():!this.props.isOpen&&V.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!ie.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var V=this.props,ie=V.appElement,q=V.ariaHideApp,ae=V.htmlOpenClassName,B=V.bodyOpenClassName,S=V.parentSelector,R=S&&S().ownerDocument||document;B&&w.add(R.body,B),ae&&w.add(R.getElementsByTagName("html")[0],ae),q&&(z+=1,y.hide(ie)),T.default.register(this)}},{key:"render",value:function(){var V=this.props,ie=V.id,q=V.className,ae=V.overlayClassName,B=V.defaultStyles,S=V.children,R=q?{}:B.content,P=ae?{}:B.overlay;if(this.shouldBeClosed())return null;var W={ref:this.setOverlayRef,className:this.buildClassName("overlay",ae),style:t({},P,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},H=t({id:ie,ref:this.setContentRef,style:t({},R,this.props.style.content),className:this.buildClassName("content",q),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),ee=this.props.contentElement(H,S);return this.props.overlayElement(W,ee)}}]),oe})(o.Component);fe.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},fe.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(E.default),c.default.instanceOf(_.SafeHTMLCollection),c.default.instanceOf(_.SafeNodeList),c.default.arrayOf(c.default.instanceOf(E.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=fe,e.exports=n.default})(Kc,Kc.exports)),Kc.exports}function Bv(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Wv(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function Uv(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}Bv.__suppressDeprecationWarning=!0;Wv.__suppressDeprecationWarning=!0;Uv.__suppressDeprecationWarning=!0;function D2(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=Bv,n.componentWillReceiveProps=Wv),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=Uv;var c=n.componentDidUpdate;n.componentDidUpdate=function(h,p,x){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:x;c.call(this,h,p,g)}}return e}const N2=Object.freeze(Object.defineProperty({__proto__:null,polyfill:D2},Symbol.toStringTag,{value:"Module"})),F2=s2(N2);var Ix;function A2(){if(Ix)return xs;Ix=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.bodyOpenClassName=xs.portalClassName=void 0;var e=Object.assign||function(G){for(var z=1;z<arguments.length;z++){var fe=arguments[z];for(var ue in fe)Object.prototype.hasOwnProperty.call(fe,ue)&&(G[ue]=fe[ue])}return G},n=(function(){function G(z,fe){for(var ue=0;ue<fe.length;ue++){var oe=fe[ue];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(z,oe.key,oe)}}return function(z,fe,ue){return fe&&G(z.prototype,fe),ue&&G(z,ue),z}})(),t=Nl(),r=_(t),a=Qd(),o=_(a),l=Iv(),c=_(l),f=C2(),h=_(f),p=Lv(),x=w(p),g=tp(),y=_(g),k=F2;function w(G){if(G&&G.__esModule)return G;var z={};if(G!=null)for(var fe in G)Object.prototype.hasOwnProperty.call(G,fe)&&(z[fe]=G[fe]);return z.default=G,z}function _(G){return G&&G.__esModule?G:{default:G}}function E(G,z){if(!(G instanceof z))throw new TypeError("Cannot call a class as a function")}function A(G,z){if(!G)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z&&(typeof z=="object"||typeof z=="function")?z:G}function T(G,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof z);G.prototype=Object.create(z&&z.prototype,{constructor:{value:G,enumerable:!1,writable:!0,configurable:!0}}),z&&(Object.setPrototypeOf?Object.setPrototypeOf(G,z):G.__proto__=z)}var L=xs.portalClassName="ReactModalPortal",J=xs.bodyOpenClassName="ReactModal__Body--open",O=g.canUseDOM&&o.default.createPortal!==void 0,C=function(z){return document.createElement(z)},Z=function(){return O?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function M(G){return G()}var ne=(function(G){T(z,G);function z(){var fe,ue,oe,pe;E(this,z);for(var V=arguments.length,ie=Array(V),q=0;q<V;q++)ie[q]=arguments[q];return pe=(ue=(oe=A(this,(fe=z.__proto__||Object.getPrototypeOf(z)).call.apply(fe,[this].concat(ie))),oe),oe.removePortal=function(){!O&&o.default.unmountComponentAtNode(oe.node);var ae=M(oe.props.parentSelector);ae&&ae.contains(oe.node)?ae.removeChild(oe.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},oe.portalRef=function(ae){oe.portal=ae},oe.renderPortal=function(ae){var B=Z(),S=B(oe,r.default.createElement(h.default,e({defaultStyles:z.defaultStyles},ae)),oe.node);oe.portalRef(S)},ue),A(oe,pe)}return n(z,[{key:"componentDidMount",value:function(){if(g.canUseDOM){O||(this.node=C("div")),this.node.className=this.props.portalClassName;var ue=M(this.props.parentSelector);ue.appendChild(this.node),!O&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(ue){var oe=M(ue.parentSelector),pe=M(this.props.parentSelector);return{prevParent:oe,nextParent:pe}}},{key:"componentDidUpdate",value:function(ue,oe,pe){if(g.canUseDOM){var V=this.props,ie=V.isOpen,q=V.portalClassName;ue.portalClassName!==q&&(this.node.className=q);var ae=pe.prevParent,B=pe.nextParent;B!==ae&&(ae.removeChild(this.node),B.appendChild(this.node)),!(!ue.isOpen&&!ie)&&!O&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var ue=this.portal.state,oe=Date.now(),pe=ue.isOpen&&this.props.closeTimeoutMS&&(ue.closesAt||oe+this.props.closeTimeoutMS);pe?(ue.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,pe-oe)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!O)return null;!this.node&&O&&(this.node=C("div"));var ue=Z();return ue(r.default.createElement(h.default,e({ref:this.portalRef,defaultStyles:z.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(ue){x.setElement(ue)}}]),z})(t.Component);return ne.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(y.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(y.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},ne.defaultProps={isOpen:!1,portalClassName:L,bodyOpenClassName:J,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(z,fe){return r.default.createElement("div",z,fe)},contentElement:function(z,fe){return r.default.createElement("div",z,fe)}},ne.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,k.polyfill)(ne),xs.default=ne,xs}var jx;function O2(){return jx||(jx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=A2(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Vc,Vc.exports)),Vc.exports}var P2=O2();const Mr=Ku(P2);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Hv=1252,R2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},np=function(e){R2.indexOf(e)!=-1&&(Hv=rp[0]=e)};function M2(){np(1252)}var ta=function(e){np(e)};function $v(){ta(1200),M2()}function Lx(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function I2(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Yv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var rl=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?I2(e.slice(2)):n==254&&t==255?Yv(e.slice(2)):n==65279?e.slice(1):e},Qc=function(n){return String.fromCharCode(n)},zx=function(n){return String.fromCharCode(n)},vl,ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bx(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,r=e.charCodeAt(h++),l=(t&3)<<4|r>>4,a=e.charCodeAt(h++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=ks.charAt(o)+ks.charAt(l)+ks.charAt(c)+ks.charAt(f);return n}function Cn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=ks.indexOf(e.charAt(h++)),l=ks.indexOf(e.charAt(h++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=ks.indexOf(e.charAt(h++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=ks.indexOf(e.charAt(h++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var Et=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ho=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Cs(e){return Et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Wx(e){return Et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ea=function(n){return Et?ho(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function mo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function ap(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ap(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var ys=Et?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ho(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function j2(e){for(var n=[],t=0,r=e.length+250,a=Cs(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=Cs(65535),r=65530)}return n.push(a.slice(0,t)),ys(n)}var fn=/\u0000/g,nl=/[\u0001-\u0006]/g;function qo(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function ra(e,n){var t=""+e;return t.length>=n?t:ur("0",n-t.length)+t}function sp(e,n){var t=""+e;return t.length>=n?t:ur(" ",n-t.length)+t}function ku(e,n){var t=""+e;return t.length>=n?t:t+ur(" ",n-t.length)}function L2(e,n){var t=""+Math.round(e);return t.length>=n?t:ur("0",n-t.length)+t}function z2(e,n){var t=""+e;return t.length>=n?t:ur("0",n-t.length)+t}var Ux=Math.pow(2,32);function Yo(e,n){if(e>Ux||e<-Ux)return L2(e,n);var t=Math.round(e);return z2(t,n)}function _u(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Hx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Zf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function B2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},$x={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},W2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bu(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,h=0,p=0,x=Math.floor(a);h<n&&(x=Math.floor(a),c=x*l+o,p=x*h+f,!(a-x<5e-8));)a=1/(a-x),o=l,l=c,f=h,h=p;if(p>n&&(h>n?(p=f,c=o):(p=h,c=l)),!t)return[0,r*c,p];var g=Math.floor(r*c/p);return[g,r*c-g*p,p]}function Qs(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=K2(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var Vv=new Date(1899,11,31,0,0,0),U2=Vv.getTime(),H2=new Date(1900,2,1,0,0,0);function Kv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=H2&&(t+=1440*60*1e3),(t-(U2+(e.getTimezoneOffset()-Vv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function op(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Y2(e){var n=e<0?12:11,t=op(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function V2(e){var n=op(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function yl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=Y2(e):n===10?t=e.toFixed(10).substr(0,12):t=V2(e),op($2(t.toUpperCase()))}function oo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,Kv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function K2(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function G2(e,n,t,r){var a="",o=0,l=0,c=t.y,f,h=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,h=n.length;break;case 3:return Zf[t.m-1][1];case 5:return Zf[t.m-1][0];default:return Zf[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,h=n.length;break;case 3:return Hx[t.q][0];default:return Hx[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?ra(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=ra(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:f=c,h=1;break}var p=h>0?ra(f,h):"";return p}function _s(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Gv=/%/g;function X2(e,n,t){var r=n.replace(Gv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+ur("%",a)}function Q2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Xv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Xv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Qv=/# (\?+)( ?)\/( ?)(\d+)/;function q2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?ur(" ",e[1].length+1+e[4].length):sp(l,e[1].length)+e[2]+"/"+e[3]+ra(c,e[4].length))}function Z2(e,n,t){return t+(n===0?"":""+n)+ur(" ",e[1].length+2+e[4].length)}var qv=/^#*0*\.([0#]+)/,Zv=/\).*[0#]/,Jv=/\(###\) ###\\?-####/;function nn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Yx(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Vx(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function J2(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function e_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function jn(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Zv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?jn("n",r,t):"("+jn("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return Q2(e,n,t);if(n.indexOf("%")!==-1)return X2(e,n,t);if(n.indexOf("E")!==-1)return Xv(n,t);if(n.charCodeAt(0)===36)return"$"+jn(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+Yo(f,n.length);if(n.match(/^[#?]+$/))return a=Yo(t,0),a==="0"&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(Qv))return q2(o,f,h);if(n.match(/^#+0+$/))return h+Yo(f,n.length-n.indexOf("0"));if(o=n.match(qv))return a=Yx(t,o[1].length).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+ur("0",nn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+Yx(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+_s(Yo(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+jn(e,n,-t):_s(""+(Math.floor(t)+J2(t,o[1].length)))+"."+ra(Vx(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return jn(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(jn(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(Jv))return a=jn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=bu(f,Math.pow(10,l)-1,!1),a=""+h,p=Ba("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=ku(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=bu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+ku(c[2],l):ur(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=Yo(t,0),n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return nn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Vx(t,o[1].length),t<0?"-"+jn(e,n,-t):_s(e_(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(l,o[1].length);switch(n){case"###,##0.00":return jn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=_s(Yo(f,0));return y!=="0"?h+y:"";case"###,###.00":return jn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return jn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function t_(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function r_(e,n,t){var r=n.replace(Gv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+ur("%",a)}function e1(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+e1(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ma(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Zv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ma("n",r,t):"("+ma("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return t_(e,n,t);if(n.indexOf("%")!==-1)return r_(e,n,t);if(n.indexOf("E")!==-1)return e1(n,t);if(n.charCodeAt(0)===36)return"$"+ma(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+ra(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(Qv))return Z2(o,f,h);if(n.match(/^#+0+$/))return h+ra(f,n.length-n.indexOf("0"));if(o=n.match(qv))return a=(""+t).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])),a=a.replace(/\.(\d*)$/,function(k,w){return"."+w+ur("0",nn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+_s(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):_s(""+t)+"."+ur("0",o[1].length);if(o=n.match(/^#,#*,#0/))return ma(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(ma(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(Jv))return a=ma(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=bu(f,Math.pow(10,l)-1,!1),a=""+h,p=Ba("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=ku(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=bu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+ku(c[2],l):ur(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return nn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):_s(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var y=_s(""+f);return y!=="0"?h+y:"";default:if(n.match(/\.[0#?]*$/))return ma(e,n.slice(0,n.lastIndexOf(".")),t)+nn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Ba(e,n,t){return(t|0)===t?ma(e,n,t):jn(e,n,t)}function n_(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var t1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function di(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":_u(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="上午/下午")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(t1))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function a_(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",h,p,x,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!_u(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(x=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(x);a[a.length]={t:"t",v:o},++l;break;case"\\":var y=e.charAt(++l),k=y==="("||y===")"?y:"t";a[a.length]={t:k,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=Qs(n,t,e.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=Qs(n,t),h==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"上":var w={t:c,v:c};if(h==null&&(h=Qs(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?"P":"A"),w.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(h!=null&&(w.v=h.H>=12?"下午":"上午"),w.t="T",l+=5,g="h"):(w.t="t",++l),h==null&&w.t==="T")return"";a[a.length]=w,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(t1)){if(h==null&&(h=Qs(n,t),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",di(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var _=0,E=0,A;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",_<1&&(_=1);break;case"s":(A=a[l].v.match(/\.0+$/))&&(E=Math.max(E,A[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var T="",L;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=G2(a[l].t.charCodeAt(0),a[l].v,h,E),a[l].t="t";break;case"n":case"?":for(L=l+1;a[L]!=null&&((c=a[L].t)==="?"||c==="D"||(c===" "||c==="t")&&a[L+1]!=null&&(a[L+1].t==="?"||a[L+1].t==="t"&&a[L+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[L].v==="/"||a[L].v===" "&&a[L+1]!=null&&a[L+1].t=="?"));)a[l].v+=a[L].v,a[L]={v:"",t:";"},++L;T+=a[l].v,l=L-1;break;case"G":a[l].t="t",a[l].v=oo(n,t);break}var J="",O,C;if(T.length>0){T.charCodeAt(0)==40?(O=n<0&&T.charCodeAt(0)===45?-n:n,C=Ba("n",T,O)):(O=n<0&&r>1?-n:n,C=Ba("n",T,O),O<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),L=C.length-1;var Z=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){Z=l;break}var M=a.length;if(Z===a.length&&C.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(L>=a[l].v.length-1?(L-=a[l].v.length,a[l].v=C.substr(L+1,a[l].v.length)):L<0?a[l].v="":(a[l].v=C.substr(0,L+1),L=-1),a[l].t="t",M=l);L>=0&&M<a.length&&(a[M].v=C.substr(0,L+1)+a[M].v)}else if(Z!==a.length&&C.indexOf("E")===-1){for(L=C.indexOf(".")-1,l=Z;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===Z?a[l].v.indexOf(".")-1:a[l].v.length-1,J=a[l].v.substr(p+1);p>=0;--p)L>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(J=C.charAt(L--)+J);a[l].v=J,a[l].t="t",M=l}for(L>=0&&M<a.length&&(a[M].v=C.substr(0,L+1)+a[M].v),L=C.indexOf(".")+1,l=Z;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==Z)){for(p=a[l].v.indexOf(".")>-1&&l===Z?a[l].v.indexOf(".")+1:0,J=a[l].v.substr(0,p);p<a[l].v.length;++p)L<C.length&&(J+=C.charAt(L++));a[l].v=J,a[l].t="t",M=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(O=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=Ba(a[l].t,a[l].v,O),a[l].t="t");var ne="";for(l=0;l!==a.length;++l)a[l]!=null&&(ne+=a[l].v);return ne}var Kx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gx(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function s_(e,n){var t=n_(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Kx),c=t[1].match(Kx);return Gx(n,l)?[r,t[0]]:Gx(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Un(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:yt)[e],r==null&&(r=t.table&&t.table[$x[e]]||yt[$x[e]]),r==null&&(r=W2[e]||"General");break}if(_u(r,0))return oo(n,t);n instanceof Date&&(n=Kv(n,t.date1904));var a=s_(r,n);if(_u(a[1]))return oo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return a_(a[1],n,t,a[0])}function eo(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(yt[t]==null){n<0&&(n=t);continue}if(yt[t]==e){n=t;break}}n<0&&(n=391)}return yt[n]=e,n}function r1(){yt=B2()}var o_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function i_(e){var n=typeof e=="number"?yt[e]:e;return n=n.replace(n1,"(\\d+)"),new RegExp("^"+n+"$")}function l_(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(n1)||[]).forEach(function(x,g){var y=parseInt(t[g+1],10);switch(x.toLowerCase().charAt(0)){case"y":r=y;break;case"d":o=y;break;case"h":l=y;break;case"s":f=y;break;case"m":l>=0?c=y:a=y;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?h:r==-1&&a==-1&&o==-1?p:h+"T"+p}var c_=(function(){var e={};e.version="1.2.0";function n(){for(var C=0,Z=new Array(256),M=0;M!=256;++M)C=M,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,Z[M]=C;return typeof Int32Array<"u"?new Int32Array(Z):Z}var t=n();function r(C){var Z=0,M=0,ne=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)G[ne]=C[ne];for(ne=0;ne!=256;++ne)for(M=C[ne],Z=256+ne;Z<4096;Z+=256)M=G[Z]=M>>>8^C[M&255];var z=[];for(ne=1;ne!=16;++ne)z[ne-1]=typeof Int32Array<"u"?G.subarray(ne*256,ne*256+256):G.slice(ne*256,ne*256+256);return z}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],h=a[4],p=a[5],x=a[6],g=a[7],y=a[8],k=a[9],w=a[10],_=a[11],E=a[12],A=a[13],T=a[14];function L(C,Z){for(var M=Z^-1,ne=0,G=C.length;ne<G;)M=M>>>8^t[(M^C.charCodeAt(ne++))&255];return~M}function J(C,Z){for(var M=Z^-1,ne=C.length-15,G=0;G<ne;)M=T[C[G++]^M&255]^A[C[G++]^M>>8&255]^E[C[G++]^M>>16&255]^_[C[G++]^M>>>24]^w[C[G++]]^k[C[G++]]^y[C[G++]]^g[C[G++]]^x[C[G++]]^p[C[G++]]^h[C[G++]]^f[C[G++]]^c[C[G++]]^l[C[G++]]^o[C[G++]]^t[C[G++]];for(ne+=15;G<ne;)M=M>>>8^t[(M^C[G++])&255];return~M}function O(C,Z){for(var M=Z^-1,ne=0,G=C.length,z=0,fe=0;ne<G;)z=C.charCodeAt(ne++),z<128?M=M>>>8^t[(M^z)&255]:z<2048?(M=M>>>8^t[(M^(192|z>>6&31))&255],M=M>>>8^t[(M^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,fe=C.charCodeAt(ne++)&1023,M=M>>>8^t[(M^(240|z>>8&7))&255],M=M>>>8^t[(M^(128|z>>2&63))&255],M=M>>>8^t[(M^(128|fe>>6&15|(z&3)<<4))&255],M=M>>>8^t[(M^(128|fe&63))&255]):(M=M>>>8^t[(M^(224|z>>12&15))&255],M=M>>>8^t[(M^(128|z>>6&63))&255],M=M>>>8^t[(M^(128|z&63))&255]);return~M}return e.table=t,e.bstr=L,e.buf=J,e.str=O,e})(),St=(function(){var n={};n.version="1.2.1";function t(F,K){for(var j=F.split("/"),U=K.split("/"),Y=0,X=0,we=Math.min(j.length,U.length);Y<we;++Y){if(X=j[Y].length-U[Y].length)return X;if(j[Y]!=U[Y])return j[Y]<U[Y]?-1:1}return j.length-U.length}function r(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:r(F.slice(0,-1));var K=F.lastIndexOf("/");return K===-1?F:F.slice(0,K+1)}function a(F){if(F.charAt(F.length-1)=="/")return a(F.slice(0,-1));var K=F.lastIndexOf("/");return K===-1?F:F.slice(K+1)}function o(F,K){typeof K=="string"&&(K=new Date(K));var j=K.getHours();j=j<<6|K.getMinutes(),j=j<<5|K.getSeconds()>>>1,F.write_shift(2,j);var U=K.getFullYear()-1980;U=U<<4|K.getMonth()+1,U=U<<5|K.getDate(),F.write_shift(2,U)}function l(F){var K=F.read_shift(2)&65535,j=F.read_shift(2)&65535,U=new Date,Y=j&31;j>>>=5;var X=j&15;j>>>=4,U.setMilliseconds(0),U.setFullYear(j+1980),U.setMonth(X-1),U.setDate(Y);var we=K&31;K>>>=5;var Fe=K&63;return K>>>=6,U.setHours(K),U.setMinutes(Fe),U.setSeconds(we<<1),U}function c(F){zr(F,0);for(var K={},j=0;F.l<=F.length-4;){var U=F.read_shift(2),Y=F.read_shift(2),X=F.l+Y,we={};switch(U){case 21589:j=F.read_shift(1),j&1&&(we.mtime=F.read_shift(4)),Y>5&&(j&2&&(we.atime=F.read_shift(4)),j&4&&(we.ctime=F.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}F.l=X,K[U]=we}return K}var f;function h(){return f||(f={})}function p(F,K){if(F[0]==80&&F[1]==75)return Oe(F,K);if((F[0]|32)==109&&(F[1]|32)==105)return Dr(F,K);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var j=3,U=512,Y=0,X=0,we=0,Fe=0,ve=0,_e=[],be=F.slice(0,512);zr(be,0);var Ie=x(be);switch(j=Ie[0],j){case 3:U=512;break;case 4:U=4096;break;case 0:if(Ie[1]==0)return Oe(F,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}U!==512&&(be=F.slice(0,U),zr(be,28));var He=F.slice(0,U);g(be,j);var je=be.read_shift(4,"i");if(j===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);be.l+=4,we=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),Fe=be.read_shift(4,"i"),Y=be.read_shift(4,"i"),ve=be.read_shift(4,"i"),X=be.read_shift(4,"i");for(var Le=-1,Be=0;Be<109&&(Le=be.read_shift(4,"i"),!(Le<0));++Be)_e[Be]=Le;var dt=y(F,U);_(ve,X,dt,U,_e);var zt=A(dt,we,_e,U);zt[we].name="!Directory",Y>0&&Fe!==fe&&(zt[Fe].name="!MiniFAT"),zt[_e[0]].name="!FAT",zt.fat_addrs=_e,zt.ssz=U;var jt={},pr=[],Rs=[],Qa=[];T(we,zt,dt,pr,Y,jt,Rs,Fe),k(Rs,Qa,pr),pr.shift();var la={FileIndex:Rs,FullPaths:Qa};return K&&K.raw&&(la.raw={header:He,sectors:dt}),la}function x(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(ue,"Header Signature: "),F.l+=16;var K=F.read_shift(2,"u");return[F.read_shift(2,"u"),K]}function g(F,K){var j=9;switch(F.l+=2,j=F.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function y(F,K){for(var j=Math.ceil(F.length/K)-1,U=[],Y=1;Y<j;++Y)U[Y-1]=F.slice(Y*K,(Y+1)*K);return U[j-1]=F.slice(j*K),U}function k(F,K,j){for(var U=0,Y=0,X=0,we=0,Fe=0,ve=j.length,_e=[],be=[];U<ve;++U)_e[U]=be[U]=U,K[U]=j[U];for(;Fe<be.length;++Fe)U=be[Fe],Y=F[U].L,X=F[U].R,we=F[U].C,_e[U]===U&&(Y!==-1&&_e[Y]!==Y&&(_e[U]=_e[Y]),X!==-1&&_e[X]!==X&&(_e[U]=_e[X])),we!==-1&&(_e[we]=U),Y!==-1&&U!=_e[U]&&(_e[Y]=_e[U],be.lastIndexOf(Y)<Fe&&be.push(Y)),X!==-1&&U!=_e[U]&&(_e[X]=_e[U],be.lastIndexOf(X)<Fe&&be.push(X));for(U=1;U<ve;++U)_e[U]===U&&(X!==-1&&_e[X]!==X?_e[U]=_e[X]:Y!==-1&&_e[Y]!==Y&&(_e[U]=_e[Y]));for(U=1;U<ve;++U)if(F[U].type!==0){if(Fe=U,Fe!=_e[Fe])do Fe=_e[Fe],K[U]=K[Fe]+"/"+K[U];while(Fe!==0&&_e[Fe]!==-1&&Fe!=_e[Fe]);_e[U]=-1}for(K[0]+="/",U=1;U<ve;++U)F[U].type!==2&&(K[U]+="/")}function w(F,K,j){for(var U=F.start,Y=F.size,X=[],we=U;j&&Y>0&&we>=0;)X.push(K.slice(we*z,we*z+z)),Y-=z,we=Xs(j,we*4);return X.length===0?Sr(0):ys(X).slice(0,F.size)}function _(F,K,j,U,Y){var X=fe;if(F===fe){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var we=j[F],Fe=(U>>>2)-1;if(!we)return;for(var ve=0;ve<Fe&&(X=Xs(we,ve*4))!==fe;++ve)Y.push(X);_(Xs(we,U-4),K-1,j,U,Y)}}function E(F,K,j,U,Y){var X=[],we=[];Y||(Y=[]);var Fe=U-1,ve=0,_e=0;for(ve=K;ve>=0;){Y[ve]=!0,X[X.length]=ve,we.push(F[ve]);var be=j[Math.floor(ve*4/U)];if(_e=ve*4&Fe,U<4+_e)throw new Error("FAT boundary crossed: "+ve+" 4 "+U);if(!F[be])break;ve=Xs(F[be],_e)}return{nodes:X,data:ag([we])}}function A(F,K,j,U){var Y=F.length,X=[],we=[],Fe=[],ve=[],_e=U-1,be=0,Ie=0,He=0,je=0;for(be=0;be<Y;++be)if(Fe=[],He=be+K,He>=Y&&(He-=Y),!we[He]){ve=[];var Le=[];for(Ie=He;Ie>=0;){Le[Ie]=!0,we[Ie]=!0,Fe[Fe.length]=Ie,ve.push(F[Ie]);var Be=j[Math.floor(Ie*4/U)];if(je=Ie*4&_e,U<4+je)throw new Error("FAT boundary crossed: "+Ie+" 4 "+U);if(!F[Be]||(Ie=Xs(F[Be],je),Le[Ie]))break}X[He]={nodes:Fe,data:ag([ve])}}return X}function T(F,K,j,U,Y,X,we,Fe){for(var ve=0,_e=U.length?2:0,be=K[F].data,Ie=0,He=0,je;Ie<be.length;Ie+=128){var Le=be.slice(Ie,Ie+128);zr(Le,64),He=Le.read_shift(2),je=fp(Le,0,He-_e),U.push(je);var Be={name:je,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},dt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);dt!==0&&(Be.ct=L(Le,Le.l-8));var zt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);zt!==0&&(Be.mt=L(Le,Le.l-8)),Be.start=Le.read_shift(4,"i"),Be.size=Le.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=fe,Be.name=""),Be.type===5?(ve=Be.start,Y>0&&ve!==fe&&(K[ve].name="!StreamData")):Be.size>=4096?(Be.storage="fat",K[Be.start]===void 0&&(K[Be.start]=E(j,Be.start,K.fat_addrs,K.ssz)),K[Be.start].name=Be.name,Be.content=K[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:ve!==fe&&Be.start!==fe&&K[ve]&&(Be.content=w(Be,K[ve].data,(K[Fe]||{}).data))),Be.content&&zr(Be.content,0),X[je]=Be,we.push(Be)}}function L(F,K){return new Date((En(F,K+4)/1e7*Math.pow(2,32)+En(F,K)/1e7-11644473600)*1e3)}function J(F,K){return h(),p(f.readFileSync(F),K)}function O(F,K){var j=K&&K.type;switch(j||Et&&Buffer.isBuffer(F)&&(j="buffer"),j||"base64"){case"file":return J(F,K);case"base64":return p(ea(Cn(F)),K);case"binary":return p(ea(F),K)}return p(F,K)}function C(F,K){var j=K||{},U=j.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=U+"/",F.FileIndex[0]={name:U,type:5}),j.CLSID&&(F.FileIndex[0].clsid=j.CLSID),Z(F)}function Z(F){var K="Sh33tJ5";if(!St.find(F,"/"+K)){var j=Sr(4);j[0]=55,j[1]=j[3]=50,j[2]=54,F.FileIndex.push({name:K,type:2,content:j,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+K),M(F)}}function M(F,K){C(F);for(var j=!1,U=!1,Y=F.FullPaths.length-1;Y>=0;--Y){var X=F.FileIndex[Y];switch(X.type){case 0:U?j=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(X.R*X.L*X.C)&&(j=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!K)){var we=new Date(1987,1,19),Fe=0,ve=Object.create?Object.create(null):{},_e=[];for(Y=0;Y<F.FullPaths.length;++Y)ve[F.FullPaths[Y]]=!0,F.FileIndex[Y].type!==0&&_e.push([F.FullPaths[Y],F.FileIndex[Y]]);for(Y=0;Y<_e.length;++Y){var be=r(_e[Y][0]);U=ve[be],U||(_e.push([be,{name:a(be).replace("/",""),type:1,clsid:pe,ct:we,mt:we,content:null}]),ve[be]=!0)}for(_e.sort(function(je,Le){return t(je[0],Le[0])}),F.FullPaths=[],F.FileIndex=[],Y=0;Y<_e.length;++Y)F.FullPaths[Y]=_e[Y][0],F.FileIndex[Y]=_e[Y][1];for(Y=0;Y<_e.length;++Y){var Ie=F.FileIndex[Y],He=F.FullPaths[Y];if(Ie.name=a(He).replace("/",""),Ie.L=Ie.R=Ie.C=-(Ie.color=1),Ie.size=Ie.content?Ie.content.length:0,Ie.start=0,Ie.clsid=Ie.clsid||pe,Y===0)Ie.C=_e.length>1?1:-1,Ie.size=0,Ie.type=5;else if(He.slice(-1)=="/"){for(Fe=Y+1;Fe<_e.length&&r(F.FullPaths[Fe])!=He;++Fe);for(Ie.C=Fe>=_e.length?-1:Fe,Fe=Y+1;Fe<_e.length&&r(F.FullPaths[Fe])!=r(He);++Fe);Ie.R=Fe>=_e.length?-1:Fe,Ie.type=1}else r(F.FullPaths[Y+1]||"")==r(He)&&(Ie.R=Y+1),Ie.type=2}}}function ne(F,K){var j=K||{};if(j.fileType=="mad")return en(F,j);switch(M(F),j.fileType){case"zip":return qe(F,j)}var U=(function(je){for(var Le=0,Be=0,dt=0;dt<je.FileIndex.length;++dt){var zt=je.FileIndex[dt];if(zt.content){var jt=zt.content.length;jt>0&&(jt<4096?Le+=jt+63>>6:Be+=jt+511>>9)}}for(var pr=je.FullPaths.length+3>>2,Rs=Le+7>>3,Qa=Le+127>>7,la=Rs+Be+pr+Qa,Nr=la+127>>7,vi=Nr<=109?0:Math.ceil((Nr-109)/127);la+Nr+vi+127>>7>Nr;)vi=++Nr<=109?0:Math.ceil((Nr-109)/127);var hr=[1,vi,Nr,Qa,pr,Be,Le,0];return je.FileIndex[0].size=Le<<6,hr[7]=(je.FileIndex[0].start=hr[0]+hr[1]+hr[2]+hr[3]+hr[4]+hr[5])+(hr[6]+7>>3),hr})(F),Y=Sr(U[7]<<9),X=0,we=0;{for(X=0;X<8;++X)Y.write_shift(1,oe[X]);for(X=0;X<8;++X)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),X=0;X<3;++X)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,U[2]),Y.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:fe),Y.write_shift(4,U[3]),Y.write_shift(-4,U[1]?U[0]-1:fe),Y.write_shift(4,U[1]),X=0;X<109;++X)Y.write_shift(-4,X<U[2]?U[1]+X:-1)}if(U[1])for(we=0;we<U[1];++we){for(;X<236+we*127;++X)Y.write_shift(-4,X<U[2]?U[1]+X:-1);Y.write_shift(-4,we===U[1]-1?fe:we+1)}var Fe=function(je){for(we+=je;X<we-1;++X)Y.write_shift(-4,X+1);je&&(++X,Y.write_shift(-4,fe))};for(we=X=0,we+=U[1];X<we;++X)Y.write_shift(-4,V.DIFSECT);for(we+=U[2];X<we;++X)Y.write_shift(-4,V.FATSECT);Fe(U[3]),Fe(U[4]);for(var ve=0,_e=0,be=F.FileIndex[0];ve<F.FileIndex.length;++ve)be=F.FileIndex[ve],be.content&&(_e=be.content.length,!(_e<4096)&&(be.start=we,Fe(_e+511>>9)));for(Fe(U[6]+7>>3);Y.l&511;)Y.write_shift(-4,V.ENDOFCHAIN);for(we=X=0,ve=0;ve<F.FileIndex.length;++ve)be=F.FileIndex[ve],be.content&&(_e=be.content.length,!(!_e||_e>=4096)&&(be.start=we,Fe(_e+63>>6)));for(;Y.l&511;)Y.write_shift(-4,V.ENDOFCHAIN);for(X=0;X<U[4]<<2;++X){var Ie=F.FullPaths[X];if(!Ie||Ie.length===0){for(ve=0;ve<17;++ve)Y.write_shift(4,0);for(ve=0;ve<3;++ve)Y.write_shift(4,-1);for(ve=0;ve<12;++ve)Y.write_shift(4,0);continue}be=F.FileIndex[X],X===0&&(be.start=be.size?be.start-1:fe);var He=X===0&&j.root||be.name;if(_e=2*(He.length+1),Y.write_shift(64,He,"utf16le"),Y.write_shift(2,_e),Y.write_shift(1,be.type),Y.write_shift(1,be.color),Y.write_shift(-4,be.L),Y.write_shift(-4,be.R),Y.write_shift(-4,be.C),be.clsid)Y.write_shift(16,be.clsid,"hex");else for(ve=0;ve<4;++ve)Y.write_shift(4,0);Y.write_shift(4,be.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,be.start),Y.write_shift(4,be.size),Y.write_shift(4,0)}for(X=1;X<F.FileIndex.length;++X)if(be=F.FileIndex[X],be.size>=4096)if(Y.l=be.start+1<<9,Et&&Buffer.isBuffer(be.content))be.content.copy(Y,Y.l,0,be.size),Y.l+=be.size+511&-512;else{for(ve=0;ve<be.size;++ve)Y.write_shift(1,be.content[ve]);for(;ve&511;++ve)Y.write_shift(1,0)}for(X=1;X<F.FileIndex.length;++X)if(be=F.FileIndex[X],be.size>0&&be.size<4096)if(Et&&Buffer.isBuffer(be.content))be.content.copy(Y,Y.l,0,be.size),Y.l+=be.size+63&-64;else{for(ve=0;ve<be.size;++ve)Y.write_shift(1,be.content[ve]);for(;ve&63;++ve)Y.write_shift(1,0)}if(Et)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function G(F,K){var j=F.FullPaths.map(function(ve){return ve.toUpperCase()}),U=j.map(function(ve){var _e=ve.split("/");return _e[_e.length-(ve.slice(-1)=="/"?2:1)]}),Y=!1;K.charCodeAt(0)===47?(Y=!0,K=j[0].slice(0,-1)+K):Y=K.indexOf("/")!==-1;var X=K.toUpperCase(),we=Y===!0?j.indexOf(X):U.indexOf(X);if(we!==-1)return F.FileIndex[we];var Fe=!X.match(nl);for(X=X.replace(fn,""),Fe&&(X=X.replace(nl,"!")),we=0;we<j.length;++we)if((Fe?j[we].replace(nl,"!"):j[we]).replace(fn,"")==X||(Fe?U[we].replace(nl,"!"):U[we]).replace(fn,"")==X)return F.FileIndex[we];return null}var z=64,fe=-2,ue="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:fe,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(F,K,j){h();var U=ne(F,j);f.writeFileSync(K,U)}function q(F){for(var K=new Array(F.length),j=0;j<F.length;++j)K[j]=String.fromCharCode(F[j]);return K.join("")}function ae(F,K){var j=ne(F,K);switch(K&&K.type||"buffer"){case"file":return h(),f.writeFileSync(K.filename,j),j;case"binary":return typeof j=="string"?j:q(j);case"base64":return Bx(typeof j=="string"?j:q(j));case"buffer":if(Et)return Buffer.isBuffer(j)?j:ho(j);case"array":return typeof j=="string"?ea(j):j}return j}var B;function S(F){try{var K=F.InflateRaw,j=new K;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)B=F;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function R(F,K){if(!B)return le(F,K);var j=B.InflateRaw,U=new j,Y=U._processChunk(F.slice(F.l),U._finishFlushFlag);return F.l+=U.bytesRead,Y}function P(F){return B?B.deflateRawSync(F):it(F)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(F){var K=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(K>>16|K>>8|K)&255}for(var Q=typeof Uint8Array<"u",he=Q?new Uint8Array(256):[],me=0;me<256;++me)he[me]=se(me);function I(F,K){var j=he[F&255];return K<=8?j>>>8-K:(j=j<<8|he[F>>8&255],K<=16?j>>>16-K:(j=j<<8|he[F>>16&255],j>>>24-K))}function Ve(F,K){var j=K&7,U=K>>>3;return(F[U]|(j<=6?0:F[U+1]<<8))>>>j&3}function Ce(F,K){var j=K&7,U=K>>>3;return(F[U]|(j<=5?0:F[U+1]<<8))>>>j&7}function ge(F,K){var j=K&7,U=K>>>3;return(F[U]|(j<=4?0:F[U+1]<<8))>>>j&15}function Ee(F,K){var j=K&7,U=K>>>3;return(F[U]|(j<=3?0:F[U+1]<<8))>>>j&31}function ye(F,K){var j=K&7,U=K>>>3;return(F[U]|(j<=1?0:F[U+1]<<8))>>>j&127}function Pe(F,K,j){var U=K&7,Y=K>>>3,X=(1<<j)-1,we=F[Y]>>>U;return j<8-U||(we|=F[Y+1]<<8-U,j<16-U)||(we|=F[Y+2]<<16-U,j<24-U)||(we|=F[Y+3]<<24-U),we&X}function Ze(F,K,j){var U=K&7,Y=K>>>3;return U<=5?F[Y]|=(j&7)<<U:(F[Y]|=j<<U&255,F[Y+1]=(j&7)>>8-U),K+3}function Xe(F,K,j){var U=K&7,Y=K>>>3;return j=(j&1)<<U,F[Y]|=j,K+1}function wt(F,K,j){var U=K&7,Y=K>>>3;return j<<=U,F[Y]|=j&255,j>>>=8,F[Y+1]=j,K+8}function qt(F,K,j){var U=K&7,Y=K>>>3;return j<<=U,F[Y]|=j&255,j>>>=8,F[Y+1]=j&255,F[Y+2]=j>>>8,K+16}function Pt(F,K){var j=F.length,U=2*j>K?2*j:K+5,Y=0;if(j>=K)return F;if(Et){var X=Wx(U);if(F.copy)F.copy(X);else for(;Y<F.length;++Y)X[Y]=F[Y];return X}else if(Q){var we=new Uint8Array(U);if(we.set)we.set(F);else for(;Y<j;++Y)we[Y]=F[Y];return we}return F.length=U,F}function Mt(F){for(var K=new Array(F),j=0;j<F;++j)K[j]=0;return K}function ir(F,K,j){var U=1,Y=0,X=0,we=0,Fe=0,ve=F.length,_e=Q?new Uint16Array(32):Mt(32);for(X=0;X<32;++X)_e[X]=0;for(X=ve;X<j;++X)F[X]=0;ve=F.length;var be=Q?new Uint16Array(ve):Mt(ve);for(X=0;X<ve;++X)_e[Y=F[X]]++,U<Y&&(U=Y),be[X]=0;for(_e[0]=0,X=1;X<=U;++X)_e[X+16]=Fe=Fe+_e[X-1]<<1;for(X=0;X<ve;++X)Fe=F[X],Fe!=0&&(be[X]=_e[Fe+16]++);var Ie=0;for(X=0;X<ve;++X)if(Ie=F[X],Ie!=0)for(Fe=I(be[X],U)>>U-Ie,we=(1<<U+4-Ie)-1;we>=0;--we)K[Fe|we<<Ie]=Ie&15|X<<4;return U}var Zt=Q?new Uint16Array(512):Mt(512),lr=Q?new Uint16Array(32):Mt(32);if(!Q){for(var It=0;It<512;++It)Zt[It]=0;for(It=0;It<32;++It)lr[It]=0}(function(){for(var F=[],K=0;K<32;K++)F.push(5);ir(F,lr,32);var j=[];for(K=0;K<=143;K++)j.push(8);for(;K<=255;K++)j.push(9);for(;K<=279;K++)j.push(7);for(;K<=287;K++)j.push(8);ir(j,Zt,288)})();var Gt=(function(){for(var K=Q?new Uint8Array(32768):[],j=0,U=0;j<ee.length-1;++j)for(;U<ee[j+1];++U)K[U]=j;for(;U<32768;++U)K[U]=29;var Y=Q?new Uint8Array(259):[];for(j=0,U=0;j<H.length-1;++j)for(;U<H[j+1];++U)Y[U]=j;function X(Fe,ve){for(var _e=0;_e<Fe.length;){var be=Math.min(65535,Fe.length-_e),Ie=_e+be==Fe.length;for(ve.write_shift(1,+Ie),ve.write_shift(2,be),ve.write_shift(2,~be&65535);be-- >0;)ve[ve.l++]=Fe[_e++]}return ve.l}function we(Fe,ve){for(var _e=0,be=0,Ie=Q?new Uint16Array(32768):[];be<Fe.length;){var He=Math.min(65535,Fe.length-be);if(He<10){for(_e=Ze(ve,_e,+(be+He==Fe.length)),_e&7&&(_e+=8-(_e&7)),ve.l=_e/8|0,ve.write_shift(2,He),ve.write_shift(2,~He&65535);He-- >0;)ve[ve.l++]=Fe[be++];_e=ve.l*8;continue}_e=Ze(ve,_e,+(be+He==Fe.length)+2);for(var je=0;He-- >0;){var Le=Fe[be];je=(je<<5^Le)&32767;var Be=-1,dt=0;if((Be=Ie[je])&&(Be|=be&-32768,Be>be&&(Be-=32768),Be<be))for(;Fe[Be+dt]==Fe[be+dt]&&dt<250;)++dt;if(dt>2){Le=Y[dt],Le<=22?_e=wt(ve,_e,he[Le+1]>>1)-1:(wt(ve,_e,3),_e+=5,wt(ve,_e,he[Le-23]>>5),_e+=3);var zt=Le<8?0:Le-4>>2;zt>0&&(qt(ve,_e,dt-H[Le]),_e+=zt),Le=K[be-Be],_e=wt(ve,_e,he[Le]>>3),_e-=3;var jt=Le<4?0:Le-2>>1;jt>0&&(qt(ve,_e,be-Be-ee[Le]),_e+=jt);for(var pr=0;pr<dt;++pr)Ie[je]=be&32767,je=(je<<5^Fe[be])&32767,++be;He-=dt-1}else Le<=143?Le=Le+48:_e=Xe(ve,_e,1),_e=wt(ve,_e,he[Le]),Ie[je]=be&32767,++be}_e=wt(ve,_e,0)-1}return ve.l=(_e+7)/8|0,ve.l}return function(ve,_e){return ve.length<8?X(ve,_e):we(ve,_e)}})();function it(F){var K=Sr(50+Math.floor(F.length*1.1)),j=Gt(F,K);return K.slice(0,j)}var bt=Q?new Uint16Array(32768):Mt(32768),$t=Q?new Uint16Array(32768):Mt(32768),gt=Q?new Uint16Array(128):Mt(128),re=1,Te=1;function Ae(F,K){var j=Ee(F,K)+257;K+=5;var U=Ee(F,K)+1;K+=5;var Y=ge(F,K)+4;K+=4;for(var X=0,we=Q?new Uint8Array(19):Mt(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,_e=Q?new Uint8Array(8):Mt(8),be=Q?new Uint8Array(8):Mt(8),Ie=we.length,He=0;He<Y;++He)we[W[He]]=X=Ce(F,K),ve<X&&(ve=X),_e[X]++,K+=3;var je=0;for(_e[0]=0,He=1;He<=ve;++He)be[He]=je=je+_e[He-1]<<1;for(He=0;He<Ie;++He)(je=we[He])!=0&&(Fe[He]=be[je]++);var Le=0;for(He=0;He<Ie;++He)if(Le=we[He],Le!=0){je=he[Fe[He]]>>8-Le;for(var Be=(1<<7-Le)-1;Be>=0;--Be)gt[je|Be<<Le]=Le&7|He<<3}var dt=[];for(ve=1;dt.length<j+U;)switch(je=gt[ye(F,K)],K+=je&7,je>>>=3){case 16:for(X=3+Ve(F,K),K+=2,je=dt[dt.length-1];X-- >0;)dt.push(je);break;case 17:for(X=3+Ce(F,K),K+=3;X-- >0;)dt.push(0);break;case 18:for(X=11+ye(F,K),K+=7;X-- >0;)dt.push(0);break;default:dt.push(je),ve<je&&(ve=je);break}var zt=dt.slice(0,j),jt=dt.slice(j);for(He=j;He<286;++He)zt[He]=0;for(He=U;He<30;++He)jt[He]=0;return re=ir(zt,bt,286),Te=ir(jt,$t,30),K}function ze(F,K){if(F[0]==3&&!(F[1]&3))return[Cs(K),2];for(var j=0,U=0,Y=Wx(K||1<<18),X=0,we=Y.length>>>0,Fe=0,ve=0;(U&1)==0;){if(U=Ce(F,j),j+=3,U>>>1)U>>1==1?(Fe=9,ve=5):(j=Ae(F,j),Fe=re,ve=Te);else{j&7&&(j+=8-(j&7));var _e=F[j>>>3]|F[(j>>>3)+1]<<8;if(j+=32,_e>0)for(!K&&we<X+_e&&(Y=Pt(Y,X+_e),we=Y.length);_e-- >0;)Y[X++]=F[j>>>3],j+=8;continue}for(;;){!K&&we<X+32767&&(Y=Pt(Y,X+32767),we=Y.length);var be=Pe(F,j,Fe),Ie=U>>>1==1?Zt[be]:bt[be];if(j+=Ie&15,Ie>>>=4,(Ie>>>8&255)===0)Y[X++]=Ie;else{if(Ie==256)break;Ie-=257;var He=Ie<8?0:Ie-4>>2;He>5&&(He=0);var je=X+H[Ie];He>0&&(je+=Pe(F,j,He),j+=He),be=Pe(F,j,ve),Ie=U>>>1==1?lr[be]:$t[be],j+=Ie&15,Ie>>>=4;var Le=Ie<4?0:Ie-2>>1,Be=ee[Ie];for(Le>0&&(Be+=Pe(F,j,Le),j+=Le),!K&&we<je&&(Y=Pt(Y,je+100),we=Y.length);X<je;)Y[X]=Y[X-Be],++X}}}return K?[Y,j+7>>>3]:[Y.slice(0,X),j+7>>>3]}function le(F,K){var j=F.slice(F.l||0),U=ze(j,K);return F.l+=U[1],U[0]}function Ne(F,K){if(F)typeof console<"u"&&console.error(K);else throw new Error(K)}function Oe(F,K){var j=F;zr(j,0);var U=[],Y=[],X={FileIndex:U,FullPaths:Y};C(X,{root:K.root});for(var we=j.length-4;(j[we]!=80||j[we+1]!=75||j[we+2]!=5||j[we+3]!=6)&&we>=0;)--we;j.l=we+4,j.l+=4;var Fe=j.read_shift(2);j.l+=6;var ve=j.read_shift(4);for(j.l=ve,we=0;we<Fe;++we){j.l+=20;var _e=j.read_shift(4),be=j.read_shift(4),Ie=j.read_shift(2),He=j.read_shift(2),je=j.read_shift(2);j.l+=8;var Le=j.read_shift(4),Be=c(j.slice(j.l+Ie,j.l+Ie+He));j.l+=Ie+He+je;var dt=j.l;j.l=Le+4,$e(j,_e,be,X,Be),j.l=dt}return X}function $e(F,K,j,U,Y){F.l+=2;var X=F.read_shift(2),we=F.read_shift(2),Fe=l(F);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ve=F.read_shift(4),_e=F.read_shift(4),be=F.read_shift(4),Ie=F.read_shift(2),He=F.read_shift(2),je="",Le=0;Le<Ie;++Le)je+=String.fromCharCode(F[F.l++]);if(He){var Be=c(F.slice(F.l,F.l+He));(Be[21589]||{}).mt&&(Fe=Be[21589].mt),((Y||{})[21589]||{}).mt&&(Fe=Y[21589].mt)}F.l+=He;var dt=F.slice(F.l,F.l+_e);switch(we){case 8:dt=R(F,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var zt=!1;X&8&&(ve=F.read_shift(4),ve==134695760&&(ve=F.read_shift(4),zt=!0),_e=F.read_shift(4),be=F.read_shift(4)),_e!=K&&Ne(zt,"Bad compressed size: "+K+" != "+_e),be!=j&&Ne(zt,"Bad uncompressed size: "+j+" != "+be),ot(U,je,dt,{unsafe:!0,mt:Fe})}function qe(F,K){var j=K||{},U=[],Y=[],X=Sr(1),we=j.compression?8:0,Fe=0,ve=0,_e=0,be=0,Ie=0,He=F.FullPaths[0],je=He,Le=F.FileIndex[0],Be=[],dt=0;for(ve=1;ve<F.FullPaths.length;++ve)if(je=F.FullPaths[ve].slice(He.length),Le=F.FileIndex[ve],!(!Le.size||!Le.content||je=="Sh33tJ5")){var zt=be,jt=Sr(je.length);for(_e=0;_e<je.length;++_e)jt.write_shift(1,je.charCodeAt(_e)&127);jt=jt.slice(0,jt.l),Be[Ie]=c_.buf(Le.content,0);var pr=Le.content;we==8&&(pr=P(pr)),X=Sr(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,Fe),X.write_shift(2,we),Le.mt?o(X,Le.mt):X.write_shift(4,0),X.write_shift(-4,Be[Ie]),X.write_shift(4,pr.length),X.write_shift(4,Le.content.length),X.write_shift(2,jt.length),X.write_shift(2,0),be+=X.length,U.push(X),be+=jt.length,U.push(jt),be+=pr.length,U.push(pr),X=Sr(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,Fe),X.write_shift(2,we),X.write_shift(4,0),X.write_shift(-4,Be[Ie]),X.write_shift(4,pr.length),X.write_shift(4,Le.content.length),X.write_shift(2,jt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,zt),dt+=X.l,Y.push(X),dt+=jt.length,Y.push(jt),++Ie}return X=Sr(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Ie),X.write_shift(2,Ie),X.write_shift(4,dt),X.write_shift(4,be),X.write_shift(2,0),ys([ys(U),ys(Y),X])}var lt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ye(F,K){if(F.ctype)return F.ctype;var j=F.name||"",U=j.match(/\.([^\.]+)$/);return U&&lt[U[1]]||K&&(U=(j=K).match(/[\.\\]([^\.\\])+$/),U&&lt[U[1]])?lt[U[1]]:"application/octet-stream"}function st(F){for(var K=Bx(F),j=[],U=0;U<K.length;U+=76)j.push(K.slice(U,U+76));return j.join(`\r
`)+`\r
`}function At(F){var K=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(_e){var be=_e.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],U=K.split(`\r
`),Y=0;Y<U.length;++Y){var X=U[Y];if(X.length==0){j.push("");continue}for(var we=0;we<X.length;){var Fe=76,ve=X.slice(we,we+Fe);ve.charAt(Fe-1)=="="?Fe--:ve.charAt(Fe-2)=="="?Fe-=2:ve.charAt(Fe-3)=="="&&(Fe-=3),ve=X.slice(we,we+Fe),we+=Fe,we<X.length&&(ve+="="),j.push(ve)}}return j.join(`\r
`)}function at(F){for(var K=[],j=0;j<F.length;++j){for(var U=F[j];j<=F.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+F[++j];K.push(U)}for(var Y=0;Y<K.length;++Y)K[Y]=K[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return ea(K.join(`\r
`))}function vt(F,K,j){for(var U="",Y="",X="",we,Fe=0;Fe<10;++Fe){var ve=K[Fe];if(!ve||ve.match(/^\s*$/))break;var _e=ve.match(/^(.*?):\s*([^\s].*)$/);if(_e)switch(_e[1].toLowerCase()){case"content-location":U=_e[2].trim();break;case"content-type":X=_e[2].trim();break;case"content-transfer-encoding":Y=_e[2].trim();break}}switch(++Fe,Y.toLowerCase()){case"base64":we=ea(Cn(K.slice(Fe).join("")));break;case"quoted-printable":we=at(K.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var be=ot(F,U.slice(j.length),we,{unsafe:!0});X&&(be.ctype=X)}function Dr(F,K){if(q(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=K&&K.root||"",U=(Et&&Buffer.isBuffer(F)?F.toString("binary"):q(F)).split(`\r
`),Y=0,X="";for(Y=0;Y<U.length;++Y)if(X=U[Y],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),j||(j=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),X.slice(0,j.length)!=j););var we=(U[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var Fe="--"+(we[1]||""),ve=[],_e=[],be={FileIndex:ve,FullPaths:_e};C(be);var Ie,He=0;for(Y=0;Y<U.length;++Y){var je=U[Y];je!==Fe&&je!==Fe+"--"||(He++&&vt(be,U.slice(Ie,Y),j),Ie=Y)}return be}function en(F,K){var j=K||{},U=j.boundary||"SheetJS";U="------="+U;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],X=F.FullPaths[0],we=X,Fe=F.FileIndex[0],ve=1;ve<F.FullPaths.length;++ve)if(we=F.FullPaths[ve].slice(X.length),Fe=F.FileIndex[ve],!(!Fe.size||!Fe.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var _e=Fe.content,be=Et&&Buffer.isBuffer(_e)?_e.toString("binary"):q(_e),Ie=0,He=Math.min(1024,be.length),je=0,Le=0;Le<=He;++Le)(je=be.charCodeAt(Le))>=32&&je<128&&++Ie;var Be=Ie>=He*4/5;Y.push(U),Y.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+we),Y.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),Y.push("Content-Type: "+Ye(Fe,we)),Y.push(""),Y.push(Be?At(be):st(be))}return Y.push(U+`--\r
`),Y.join(`\r
`)}function Ke(F){var K={};return C(K,F),K}function ot(F,K,j,U){var Y=U&&U.unsafe;Y||C(F);var X=!Y&&St.find(F,K);if(!X){var we=F.FullPaths[0];K.slice(0,we.length)==we?we=K:(we.slice(-1)!="/"&&(we+="/"),we=(we+K).replace("//","/")),X={name:a(K),type:2},F.FileIndex.push(X),F.FullPaths.push(we),Y||St.utils.cfb_gc(F)}return X.content=j,X.size=j?j.length:0,U&&(U.CLSID&&(X.clsid=U.CLSID),U.mt&&(X.mt=U.mt),U.ct&&(X.ct=U.ct)),X}function ht(F,K){C(F);var j=St.find(F,K);if(j){for(var U=0;U<F.FileIndex.length;++U)if(F.FileIndex[U]==j)return F.FileIndex.splice(U,1),F.FullPaths.splice(U,1),!0}return!1}function Yt(F,K,j){C(F);var U=St.find(F,K);if(U){for(var Y=0;Y<F.FileIndex.length;++Y)if(F.FileIndex[Y]==U)return F.FileIndex[Y].name=a(j),F.FullPaths[Y]=j,!0}return!1}function nr(F){M(F,!0)}return n.find=G,n.read=O,n.parse=p,n.write=ae,n.writeFile=ie,n.utils={cfb_new:Ke,cfb_add:ot,cfb_del:ht,cfb_mov:Yt,cfb_gc:nr,ReadShift:ll,CheckField:S1,prep_blob:zr,bconcat:ys,use_zlib:S,_deflateRaw:it,_inflateRaw:le,consts:V},n})();function u_(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ea(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function ip(e){for(var n=[],t=Ea(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var Eu=new Date(1899,11,30,0,0,0);function dn(e,n){var t=e.getTime(),r=Eu.getTime()+(e.getTimezoneOffset()-Eu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var a1=new Date,f_=Eu.getTime()+(a1.getTimezoneOffset()-Eu.getTimezoneOffset())*6e4,Xx=a1.getTimezoneOffset();function Xu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+f_),n.getTimezoneOffset()!==Xx&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Xx)*6e4),n}function d_(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var Qx=new Date("2017-02-19T19:06:09.000Z"),s1=isNaN(Qx.getFullYear())?new Date("2/19/17"):Qx,p_=s1.getFullYear()==2017;function Rr(e,n){var t=new Date(e);if(p_)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(s1.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function io(e,n){if(Et&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return sl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return sl(Yv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return sl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return sl(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Wr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=Wr(e[t]));return n}function ur(e,n){for(var t="";t.length<n;)t+=e;return t}function na(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var h_=["january","february","march","april","may","june","july","august","september","october","november","december"];function ai(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&h_.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var m_=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function o1(e){return e?e.content&&e.type?io(e.content,!0):e.data?rl(e.data):e.asNodeBuffer&&Et?rl(e.asNodeBuffer().toString("binary")):e.asBinary?rl(e.asBinary()):e._data&&e._data.getContent?rl(io(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function i1(e){if(!e)return null;if(e.data)return Lx(e.data);if(e.asNodeBuffer&&Et)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Lx(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function x_(e){return e&&e.name.slice(-4)===".bin"?i1(e):o1(e)}function Ln(e,n){for(var t=e.FullPaths||Ea(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function lp(e,n){var t=Ln(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function kr(e,n,t){if(!t)return x_(lp(e,n));if(!n)return null;try{return kr(e,n)}catch{return null}}function Sn(e,n,t){if(!t)return o1(lp(e,n));if(!n)return null;try{return Sn(e,n)}catch{return null}}function g_(e,n,t){return i1(lp(e,n))}function qx(e){for(var n=e.FullPaths||Ea(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function v_(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return Et?r=ho(t):r=j2(t),St.utils.cfb_add(e,n,r)}St.utils.cfb_add(e,n,t)}else e.file(n,t)}function l1(e,n){switch(n.type){case"base64":return St.read(e,{type:"base64"});case"binary":return St.read(e,{type:"binary"});case"buffer":case"array":return St.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function al(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var c1=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,y_=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Zx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,w_=/<[^>]*>/g,Jr=c1.match(Zx)?Zx:w_,k_=/<\w*:/,__=/<(\/?)\w+:/;function pt(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(y_),c=0,f="",h=0,p="",x="",g=1;if(l)for(h=0;h!=l.length;++h){for(x=l[h],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(p=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(g=(a=x.charCodeAt(o+1))==34||a==39?1:0,f=x.slice(o+1+g,x.length-g),c=0;c!=p.length&&p.charCodeAt(c)!==58;++c);if(c===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=f,r[p.toLowerCase()]=f;else{var y=(c===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(c+1);if(r[y]&&p.slice(c-3,c)=="ext")continue;r[y]=f,r[y.toLowerCase()]=f}}return r}function Ta(e){return e.replace(__,"<$1")}var u1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},b_=ip(u1),Ft=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return u1[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),E_=/[&<>'"]/g,S_=/[\u0000-\u001f]/g;function cp(e){var n=e+"";return n.replace(E_,function(t){return b_[t]}).replace(/\n/g,"<br/>").replace(S_,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Jx=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function tr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jf(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function eg(e){var n=Cs(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function tg(e){return ho(e,"binary").toString("utf8")}var qc="foo bar bazâð£",Kt=Et&&(tg(qc)==Jf(qc)&&tg||eg(qc)==Jf(qc)&&eg)||Jf,sl=Et?function(e){return ho(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},wl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),f1=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),T_=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),C_=/<\/?(?:vt:)?variant>/g,D_=/<(?:vt:)([^>]*)>([\s\S]*)</;function rg(e,n){var t=pt(e),r=e.match(T_(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(C_,"").match(D_);l&&a.push({v:Kt(l[2]),t:l[1]})}),a}var N_=/(^\s|\s$|\n)/;function F_(e){return Ea(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function A_(e,n,t){return"<"+e+(t!=null?F_(t):"")+(n!=null?(n.match(N_)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function up(e){if(Et&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Kt(mo(ap(e)));throw new Error("Bad input format: expected Buffer or string")}var kl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,O_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},P_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function R_(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function M_(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var ng=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},ag=Et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ho(n)})):ng(e)}:ng,sg=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(za(e,a)));return r.join("").replace(fn,"")},fp=Et?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(fn,""):sg(e,n,t)}:sg,og=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},d1=Et?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):og(e,n,t)}:og,ig=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Go(e,a)));return r.join("")},Fl=Et?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):ig(n,t,r)}:ig,p1=function(e,n){var t=En(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},h1=p1,m1=function(e,n){var t=En(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},x1=m1,g1=function(e,n){var t=2*En(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},v1=g1,y1=function(n,t){var r=En(n,t);return r>0?fp(n,t+4,t+4+r):""},w1=y1,k1=function(e,n){var t=En(e,n);return t>0?Fl(e,n+4,n+4+t):""},_1=k1,b1=function(e,n){return R_(e,n)},Su=b1,E1=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Et&&(h1=function(n,t){if(!Buffer.isBuffer(n))return p1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},x1=function(n,t){if(!Buffer.isBuffer(n))return m1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},v1=function(n,t){if(!Buffer.isBuffer(n))return g1(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},w1=function(n,t){if(!Buffer.isBuffer(n))return y1(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},_1=function(n,t){if(!Buffer.isBuffer(n))return k1(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Su=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):b1(n,t)},E1=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Go=function(e,n){return e[n]},za=function(e,n){return e[n+1]*256+e[n]},I_=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},En=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Xs=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},j_=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ll(e,n){var t="",r,a,o=[],l,c,f,h;switch(n){case"dbcs":if(h=this.l,Et&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(za(this,h)),h+=2;e*=2;break;case"utf8":t=Fl(this,this.l,this.l+e);break;case"utf16le":e*=2,t=fp(this,this.l,this.l+e);break;case"wstr":return ll.call(this,e,"dbcs");case"lpstr-ansi":t=h1(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":t=x1(this,this.l),e=4+En(this,this.l);break;case"lpwstr":t=v1(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),t=w1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),t=_1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Go(this,this.l+e++))!==0;)o.push(Qc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=za(this,this.l+e))!==0;)o.push(Qc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Go(this,h),this.l=h+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(za(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Go(this,h),this.l=h+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(Go(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return r=Go(this,this.l),this.l++,r;case 2:return r=(n==="i"?I_:za)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Xs:j_)(this,this.l),this.l+=4,r):(a=En(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Su(this,this.l):a=Su([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=d1(this,this.l,e);break}}return this.l+=e,t}var L_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},z_=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},B_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function W_(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)B_(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,L_(this,n,this.l);break;case 8:if(r=8,t==="f"){M_(this,n,this.l);break}case 16:break;case-4:r=4,z_(this,n,this.l);break}return this.l+=r,this}function S1(e,n){var t=d1(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function zr(e,n){e.l=n,e.read_shift=ll,e.chk=S1,e.write_shift=W_}function Zr(e,n){e.l+=n}function Sr(e){var n=Cs(e);return zr(n,0),n}function Xa(e,n,t){if(e){var r,a,o;zr(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var h=Au[c]||Au[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var p=h.f&&h.f(e,o,t);if(e.l=f,n(p,h,c))return}}}function Sd(){var e=[],n=Et?256:2048,t=function(h){var p=Sr(h);return zr(p,0),p},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=t(Math.max(h+1,n)))},l=function(){return a(),ys(e)},c=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function cl(e,n,t){var r=Wr(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function lg(e,n,t){var r=Wr(e);return r.s=cl(r.s,n.s,t),r.e=cl(r.e,n.s,t),r}function ul(e,n){if(e.cRel&&e.c<0)for(e=Wr(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Wr(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=xt(e);return!e.cRel&&e.cRel!=null&&(t=$_(t)),!e.rRel&&e.rRel!=null&&(t=U_(t)),t}function ed(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Tr(e.s.c)+":"+(e.e.cRel?"":"$")+Tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ur(e.s.r)+":"+(e.e.rRel?"":"$")+Ur(e.e.r):ul(e.s,n.biff)+":"+ul(e.e,n.biff)}function dp(e){return parseInt(H_(e),10)-1}function Ur(e){return""+(e+1)}function U_(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function H_(e){return e.replace(/\$(\d+)$/,"$1")}function pp(e){for(var n=Y_(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Tr(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function $_(e){return e.replace(/^([A-Z])/,"$$$1")}function Y_(e){return e.replace(/^\$([A-Z])/,"$1")}function V_(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function xt(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function pi(e){var n=e.indexOf(":");return n==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,n)),e:ln(e.slice(n+1))}}function Tt(e,n){return typeof n>"u"||typeof n=="number"?Tt(e.s,e.e):(typeof e!="string"&&(e=xt(e)),typeof n!="string"&&(n=xt(n)),e==n?e:e+":"+n)}function fr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function cg(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,t?dn(n):n)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(t?14:0),t?dn(n):n)}catch{return""+n}}function Ka(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?vo[e.v]||e.v:n==null?cg(e,e.v):cg(e,n))}function Os(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function T1(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=fr(o["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),l==-1&&(h.e.r=l=p.e.r+1)}for(var x=0;x!=n.length;++x)if(n[x]){if(!Array.isArray(n[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[x].length;++g)if(!(typeof n[x][g]>"u")){var y={v:n[x][g]},k=l+x,w=c+g;if(h.s.r>k&&(h.s.r=k),h.s.c>w&&(h.s.c=w),h.e.r<k&&(h.e.r=k),h.e.c<w&&(h.e.c=w),n[x][g]&&typeof n[x][g]=="object"&&!Array.isArray(n[x][g])&&!(n[x][g]instanceof Date))y=n[x][g];else if(Array.isArray(y.v)&&(y.f=n[x][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||yt[14],r.cellDates?(y.t="d",y.w=Un(y.z,dn(y.v))):(y.t="n",y.v=dn(y.v),y.w=Un(y.z,y.v))):y.t="s";if(a)o[k]||(o[k]=[]),o[k][w]&&o[k][w].z&&(y.z=o[k][w].z),o[k][w]=y;else{var _=xt({c:w,r:k});o[_]&&o[_].z&&(y.z=o[_].z),o[_]=y}}}return h.s.c<1e7&&(o["!ref"]=Tt(h)),o}function hi(e,n){return T1(null,e,n)}function K_(e){return e.read_shift(4,"i")}function qr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function G_(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hp(e,n){var t=e.l,r=e.read_shift(1),a=qr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(G_(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var X_=hp;function $n(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function xo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var Q_=qr;function mp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var q_=qr,Td=mp;function xp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Su([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Xs(n,0)>>2;return t?a/100:a}function C1(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var go=C1;function Xr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Z_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var h=to[a];h&&(n.rgb=bl(h));break;case 2:n.rgb=bl([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function J_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function D1(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function eb(e){return D1(e,1)}function tb(e){return D1(e,2)}var gp=2,yn=3,Zc=11,ug=12,Tu=19,Jc=64,rb=65,nb=71,ab=4108,sb=4126,Pr=80,N1=81,ob=[Pr,N1],ib={1:{n:"CodePage",t:gp},2:{n:"Category",t:Pr},3:{n:"PresentationFormat",t:Pr},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:Zc},12:{n:"HeadingPairs",t:ab},13:{n:"TitlesOfParts",t:sb},14:{n:"Manager",t:Pr},15:{n:"Company",t:Pr},16:{n:"LinksUpToDate",t:Zc},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:Zc},22:{n:"HyperlinksChanged",t:Zc},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:rb},26:{n:"ContentType",t:Pr},27:{n:"ContentStatus",t:Pr},28:{n:"Language",t:Pr},29:{n:"Version",t:Pr},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},lb={1:{n:"CodePage",t:gp},2:{n:"Title",t:Pr},3:{n:"Subject",t:Pr},4:{n:"Author",t:Pr},5:{n:"Keywords",t:Pr},6:{n:"Comments",t:Pr},7:{n:"Template",t:Pr},8:{n:"LastAuthor",t:Pr},9:{n:"RevNumber",t:Pr},10:{n:"EditTime",t:Jc},11:{n:"LastPrinted",t:Jc},12:{n:"CreatedDate",t:Jc},13:{n:"ModifiedDate",t:Jc},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:nb},18:{n:"Application",t:Pr},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},fg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ub(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var fb=ub([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),to=Wr(fb),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},F1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},dg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function db(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pb(e){var n=db();if(!e||!e.match)return n;var t={};if((e.match(Jr)||[]).forEach(function(r){var a=pt(r);switch(a[0].replace(k_,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[dg[a.ContentType]]!==void 0&&n[dg[a.ContentType]].push(a.PartName);break}}),n.xmlns!==O_.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var Qo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cd(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function fl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(Jr)||[]).forEach(function(a){var o=pt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:al(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var hb="application/vnd.oasis.opendocument.spreadsheet";function mb(e,n){for(var t=up(e),r,a;r=kl.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=pt(r[0],!1),a.path=="/"&&a.type!==hb)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var dl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xb=(function(){for(var e=new Array(dl.length),n=0;n<dl.length;++n){var t=dl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function A1(e){var n={};e=Kt(e);for(var t=0;t<dl.length;++t){var r=dl[t],a=e.match(xb[t]);a!=null&&a.length>0&&(n[r[1]]=Ft(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=Rr(n[r[1]]))}return n}var gb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function O1(e,n,t,r){var a=[];if(typeof e=="string")a=rg(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(p){return{v:p}}));var l=typeof n=="string"?rg(n,r).map(function(p){return p.v}):n,c=0,f=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function vb(e,n,t){var r={};return n||(n={}),e=Kt(e),gb.forEach(function(a){var o=(e.match(wl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=Ft(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&O1(r.HeadingPairs,r.TitlesOfParts,n,t),n}var yb=/<[^>]+>[^<]*/g;function wb(e,n){var t={},r="",a=e.match(yb);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=pt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Ft(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),p=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[r]=Ft(p);break;case"bool":t[r]=tr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(p);break;case"filetime":case"date":t[r]=Rr(p);break;case"cy":case"error":t[r]=Ft(p);break;default:if(h.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var kb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},td;function _b(e,n,t){td||(td=ip(kb)),n=td[n]||n,e[n]=t}function vp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function P1(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function R1(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function M1(e,n,t){return n===31?R1(e):P1(e,n,t)}function Dd(e,n,t){return M1(e,n,t===!1?0:4)}function bb(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return M1(e,n,0)}function Eb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(fn,""),e.l-a&2&&(e.l+=2)}return t}function Sb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(fn,"");return t}function Tb(e){var n=e.l,t=Cu(e,N1);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Cu(e,yn);return[t,r]}function Cb(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(Tb(e));return t}function pg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(fn,"").replace(nl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function I1(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function Db(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Cu(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==ug&&r!==n&&ob.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===ug?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return P1(e,r,4).replace(fn,"");case 31:return R1(e);case 64:return vp(e);case 65:return I1(e);case 71:return Db(e);case 80:return Dd(e,r,!o.raw).replace(fn,"");case 81:return bb(e,r).replace(fn,"");case 4108:return Cb(e);case 4126:case 4127:return r==4127?Eb(e):Sb(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function hg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,h={};for(l=0;l!=a;++l){var p=e.read_shift(4),x=e.read_shift(4);o[l]=[p,x+t]}o.sort(function(A,T){return A[1]-T[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var y=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,y=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(y=!1,e.l=o[l][1]),y)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var k=n[o[l][0]];if(g[k.n]=Cu(e,k.t,{raw:!0}),k.p==="version"&&(g[k.n]=String(g[k.n]>>16)+"."+("0000"+String(g[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(g[k.n]){case 0:g[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ta(c=g[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[k.n])}}else if(o[l][0]===1){if(c=g.CodePage=Cu(e,gp),ta(c),f!==-1){var w=e.l;e.l=o[f][1],h=pg(e,c),e.l=w}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}h=pg(e,c)}else{var _=h[o[l][0]],E;switch(e[e.l]){case 65:e.l+=4,E=I1(e);break;case 30:e.l+=4,E=Dd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=Dd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=xr(e,4);break;case 64:e.l+=4,E=Rr(vp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[_]=E}}return e.l=t+r,g}function mg(e,n,t){var r=e.content;if(!r)return{};zr(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),p=r.read_shift(16);if(p!==St.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var x=hg(r,n),g={SystemIdentifier:h};for(var y in x)g[y]=x[y];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var k;try{k=hg(r,null)}catch{}for(y in k)g[y]=k[y];return g.FMTID=[o,l],g}function gs(e,n){return e.read_shift(n),null}function Nb(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function xr(e,n){return e.read_shift(n)===1}function _r(e){return e.read_shift(2,"u")}function j1(e,n){return Nb(e,n,_r)}function Fb(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Al(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function Ab(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",p=n===0?"":e.read_shift(n,h);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function lo(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Ol(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):lo(e,r,t)}function yo(e,n,t){if(t.biff>5)return Ol(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ob(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function Pb(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(fn,"");return r&&(e.l+=24),a}function Rb(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(fn,"");return t+l}function Mb(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Pb(e);case"0303000000000000c000000000000046":return Rb(e);default:throw new Error("Unsupported Moniker "+t)}}function eu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(fn,""):"";return t}function Ib(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,h="",p,x;a&16&&(o=eu(e,t-e.l)),a&128&&(l=eu(e,t-e.l)),(a&257)===257&&(c=eu(e,t-e.l)),(a&257)===1&&(f=Mb(e,t-e.l)),a&8&&(h=eu(e,t-e.l)),a&32&&(p=e.read_shift(16)),a&64&&(x=vp(e)),e.l=t;var g=l||c||f||"";g&&h&&(g+="#"+h),g||(g="#"+h),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var y={Target:g};return p&&(y.guid=p),x&&(y.time=x),o&&(y.Tooltip=o),y}function L1(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function z1(e,n){var t=L1(e);return t[3]=0,t}function Ca(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function jb(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function Lb(e,n,t){return n===0?"":yo(e,n,t)}function zb(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function B1(e){var n=e.read_shift(2),t=xp(e);return[n,t]}function Bb(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Al(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function Qu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function W1(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var Wb=W1;function U1(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function Ub(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function Hb(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Kr(e){e.l+=2,e.l+=e.read_shift(2)}var $b={0:Kr,4:Kr,5:Kr,6:Kr,7:Hb,8:Kr,9:Kr,10:Kr,11:Kr,12:Kr,13:Ub,14:Kr,15:Kr,16:Kr,17:Kr,18:Kr,19:Kr,20:Kr,21:U1};function Yb(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push($b[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function tu(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function Vb(e,n){return n===0||e.read_shift(2),1200}function Kb(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=yo(e,0,t);return e.read_shift(n+r-e.l),a}function Gb(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function Xb(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Al(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function Qb(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(Ab(e));return o.Count=r,o.Unique=a,o}function qb(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function Zb(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function Jb(e){var n=jb(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function eE(e){return e.read_shift(2),e.read_shift(4)}function xg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function tE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),h=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:h}}function rE(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function nE(){}function aE(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Al(e,0,t),r}function sE(e){var n=Ca(e);return n.isst=e.read_shift(4),n}function oE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=Ca(e);t.biff==2&&e.l++;var o=Ol(e,r-e.l,t);return a.val=o,a}function iE(e,n,t){var r=e.read_shift(2),a=yo(e,0,t);return[r,a]}var lE=yo;function gg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function cE(e){var n=e.read_shift(2),t=e.read_shift(2),r=B1(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function uE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(B1(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function fE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function dE(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=cb[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function pE(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=dE(e,n,r.fStyle,t),r}function hE(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function vg(e,n,t){var r=Ca(e);(t.biff==2||n==9)&&++e.l;var a=Fb(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function mE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Ca(e),a=Xr(e);return r.val=a,r}var yg=Lb;function xE(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=lo(e,o),c=[];r>e.l;)c.push(Ol(e));return[o,a,l,c]}function wg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=Bb(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var gE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=lo(e,l,t);a&32&&(h=gE[h.charCodeAt(0)]);var p=r-e.l;t&&t.biff==2&&--p;var x=r==e.l||c===0||!(p>0)?[]:ZC(e,p,t,c);return{chKey:o,Name:h,itab:f,rgce:x}}function H1(e,n,t){if(t.biff<8)return vE(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(zb(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function vE(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Al(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function yE(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=lo(e,r,t),l=lo(e,a,t);return[o,l]}function wE(e,n,t){var r=W1(e);e.l++;var a=e.read_shift(1);return n-=8,[JC(e,n,t),a,r]}function _g(e,n,t){var r=Wb(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,QC(e,n,t)]}function kE(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function _E(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=yo(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function bE(e,n,t){return _E(e,n,t)}function EE(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(Qu(e));return t}function SE(e,n,t){if(t&&t.biff<8)return CE(e,n,t);var r=U1(e),a=Yb(e,n-22,r[1]);return{cmo:r,ft:a}}var TE={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function CE(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((TE[r]||Zr)(e,n,t)),{cmo:[a,r,o],ft:l}}function DE(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=Ob(e,6,t);var c=e.read_shift(2);e.read_shift(2),_r(e,2);var f=e.read_shift(2);e.l+=f;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],x=lo(e,e.lens[h+1]-e.lens[h]-1);if(a+=x,a.length>=(p?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function NE(e,n){var t=Qu(e);e.l+=16;var r=Ib(e,n-24);return[t,r]}function FE(e,n){e.read_shift(2);var t=Qu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(fn,""),[t,r]}function AE(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=fg[t]||t,t=e.read_shift(2),n[1]=fg[t]||t,n}function OE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(z1(e));return t}function PE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(z1(e));return t}function RE(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function $1(e,n,t){if(!t.cellStyles)return Zr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var h={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(h.level=f>>8&7),h}function ME(e,n){var t={};return n<32||(e.l+=16,t.header=Xr(e),t.footer=Xr(e),e.l+=2),t}function IE(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var jE=Ca,LE=j1,zE=Ol;function BE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function WE(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Ca(e);++e.l;var a=yo(e,n-7,t);return r.t="str",r.val=a,r}function UE(e){var n=Ca(e);++e.l;var t=Xr(e);return n.t="n",n.val=t,n}function HE(e){var n=Ca(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function $E(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function YE(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function VE(e,n,t){var r=e.l+n,a=Ca(e),o=e.read_shift(2),l=lo(e,o,t);return e.l=r,a.t="str",a.val=l,a}var KE=[2,3,48,49,131,139,140,245],bg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=ip({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var h=[],p=Cs(1);switch(f.type){case"base64":p=ea(Cn(c));break;case"binary":p=ea(c);break;case"buffer":case"array":p=c;break}zr(p,0);var x=p.read_shift(1),g=!!(x&136),y=!1,k=!1;switch(x){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,_=521;x==2&&(w=p.read_shift(2)),p.l+=3,x!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(_=p.read_shift(2));var E=p.read_shift(2),A=f.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(A=e[p[p.l]]),p.l+=1,p.l+=2),k&&(p.l+=36);for(var T=[],L={},J=Math.min(p.length,x==2?521:_-10-(y?264:0)),O=k?32:11;p.l<J&&p[p.l]!=13;)switch(L={},L.name=vl.utils.decode(A,p.slice(p.l,p.l+O)).replace(/[\u0000\r\n].*$/g,""),p.l+=O,L.type=String.fromCharCode(p.read_shift(1)),x!=2&&!k&&(L.offset=p.read_shift(4)),L.len=p.read_shift(1),x==2&&(L.offset=p.read_shift(2)),L.dec=p.read_shift(1),L.name.length&&T.push(L),x!=2&&(p.l+=k?13:14),L.type){case"B":(!y||L.len!=8)&&f.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(p[p.l]!==13&&(p.l=_-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=_;var C=0,Z=0;for(h[0]=[],Z=0;Z!=T.length;++Z)h[0][Z]=T[Z].name;for(;w-- >0;){if(p[p.l]===42){p.l+=E;continue}for(++p.l,h[++C]=[],Z=0,Z=0;Z!=T.length;++Z){var M=p.slice(p.l,p.l+T[Z].len);p.l+=T[Z].len,zr(M,0);var ne=vl.utils.decode(A,M);switch(T[Z].type){case"C":ne.trim().length&&(h[C][Z]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?h[C][Z]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):h[C][Z]=ne;break;case"F":h[C][Z]=parseFloat(ne.trim());break;case"+":case"I":h[C][Z]=k?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":h[C][Z]=!0;break;case"N":case"F":h[C][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[C][Z]="##MEMO##"+(k?parseInt(ne.trim(),10):M.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(h[C][Z]=+ne||0);break;case"@":h[C][Z]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":h[C][Z]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":h[C][Z]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[C][Z]=-M.read_shift(-8,"f");break;case"B":if(y&&T[Z].len==8){h[C][Z]=M.read_shift(8,"f");break}case"G":case"P":M.l+=T[Z].len;break;case"0":if(T[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[Z].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=T,h}function r(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var p=hi(t(c,h),h);return p["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,p}function a(c,f){try{return Os(r(c,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var h=f||{};if(+h.codepage>=0&&ta(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Sd(),x=Md(c,{header:1,raw:!0,cellDates:!0}),g=x[0],y=x.slice(1),k=c["!cols"]||[],w=0,_=0,E=0,A=1;for(w=0;w<g.length;++w){if(((k[w]||{}).DBF||{}).name){g[w]=k[w].DBF.name,++E;continue}if(g[w]!=null){if(++E,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(_=0;_<1024;++_)if(g.indexOf(g[w]+"_"+_)==-1){g[w]+="_"+_;break}}}}var T=fr(c["!ref"]),L=[],J=[],O=[];for(w=0;w<=T.e.c-T.s.c;++w){var C="",Z="",M=0,ne=[];for(_=0;_<y.length;++_)y[_][w]!=null&&ne.push(y[_][w]);if(ne.length==0||g[w]==null){L[w]="?";continue}for(_=0;_<ne.length;++_){switch(typeof ne[_]){case"number":Z="B";break;case"string":Z="C";break;case"boolean":Z="L";break;case"object":Z=ne[_]instanceof Date?"D":"C";break;default:Z="C"}M=Math.max(M,String(ne[_]).length),C=C&&C!=Z?"C":Z}M>250&&(M=250),Z=((k[w]||{}).DBF||{}).type,Z=="C"&&k[w].DBF.len>M&&(M=k[w].DBF.len),C=="B"&&Z=="N"&&(C="N",O[w]=k[w].DBF.dec,M=k[w].DBF.len),J[w]=C=="C"||Z=="N"?M:o[C]||0,A+=J[w],L[w]=C}var G=p.next(32);for(G.write_shift(4,318902576),G.write_shift(4,y.length),G.write_shift(2,296+32*E),G.write_shift(2,A),w=0;w<4;++w)G.write_shift(4,0);for(G.write_shift(4,0|(+n[Hv]||3)<<8),w=0,_=0;w<g.length;++w)if(g[w]!=null){var z=p.next(32),fe=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,fe,"sbcs"),z.write_shift(1,L[w]=="?"?"C":L[w],"sbcs"),z.write_shift(4,_),z.write_shift(1,J[w]||o[L[w]]||0),z.write_shift(1,O[w]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),_+=J[w]||o[L[w]]||0}var ue=p.next(264);for(ue.write_shift(4,13),w=0;w<65;++w)ue.write_shift(4,0);for(w=0;w<y.length;++w){var oe=p.next(A);for(oe.write_shift(1,0),_=0;_<g.length;++_)if(g[_]!=null)switch(L[_]){case"L":oe.write_shift(1,y[w][_]==null?63:y[w][_]?84:70);break;case"B":oe.write_shift(8,y[w][_]||0,"f");break;case"N":var pe="0";for(typeof y[w][_]=="number"&&(pe=y[w][_].toFixed(O[_]||0)),E=0;E<J[_]-pe.length;++E)oe.write_shift(1,32);oe.write_shift(1,pe,"sbcs");break;case"D":y[w][_]?(oe.write_shift(4,("0000"+y[w][_].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(y[w][_].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+y[w][_].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var V=String(y[w][_]!=null?y[w][_]:"").slice(0,J[_]);for(oe.write_shift(1,V,"sbcs"),E=0;E<J[_]-V.length;++E)oe.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),GE=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ea(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,y){var k=e[y];return typeof k=="number"?zx(k):k},r=function(g,y,k){var w=y.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?g:zx(w)};e["|"]=254;function a(g,y){switch(y.type){case"base64":return o(Cn(g),y);case"binary":return o(g,y);case"buffer":return o(Et&&Buffer.isBuffer(g)?g.toString("binary"):mo(g),y);case"array":return o(io(g),y)}throw new Error("Unrecognized type "+y.type)}function o(g,y){var k=g.split(/[\n\r]+/),w=-1,_=-1,E=0,A=0,T=[],L=[],J=null,O={},C=[],Z=[],M=[],ne=0,G;for(+y.codepage>=0&&ta(+y.codepage);E!==k.length;++E){ne=0;var z=k[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),fe=z.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),ue=fe[0],oe;if(z.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":fe[1].charAt(0)=="P"&&L.push(z.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,V=!1,ie=!1,q=!1,ae=-1,B=-1;for(A=1;A<fe.length;++A)switch(fe[A].charAt(0)){case"A":break;case"X":_=parseInt(fe[A].slice(1))-1,V=!0;break;case"Y":for(w=parseInt(fe[A].slice(1))-1,V||(_=0),G=T.length;G<=w;++G)T[G]=[];break;case"K":oe=fe[A].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(na(oe))?isNaN(ai(oe).getDate())||(oe=Rr(oe)):(oe=na(oe),J!==null&&di(J)&&(oe=Xu(oe))),pe=!0;break;case"E":q=!0;var S=Zo(fe[A].slice(1),{r:w,c:_});T[w][_]=[T[w][_],S];break;case"S":ie=!0,T[w][_]=[T[w][_],"S5S"];break;case"G":break;case"R":ae=parseInt(fe[A].slice(1))-1;break;case"C":B=parseInt(fe[A].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}if(pe&&(T[w][_]&&T[w][_].length==2?T[w][_][0]=oe:T[w][_]=oe,J=null),ie){if(q)throw new Error("SYLK shared formula cannot have own formula");var R=ae>-1&&T[ae][B];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");T[w][_][1]=ey(R[1],{r:w-ae,c:_-B})}break;case"F":var P=0;for(A=1;A<fe.length;++A)switch(fe[A].charAt(0)){case"X":_=parseInt(fe[A].slice(1))-1,++P;break;case"Y":for(w=parseInt(fe[A].slice(1))-1,G=T.length;G<=w;++G)T[G]=[];break;case"M":ne=parseInt(fe[A].slice(1))/20;break;case"F":break;case"G":break;case"P":J=L[parseInt(fe[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=fe[A].slice(1).split(" "),G=parseInt(M[0],10);G<=parseInt(M[1],10);++G)ne=parseInt(M[2],10),Z[G-1]=ne===0?{hidden:!0}:{wch:ne},si(Z[G-1]);break;case"C":_=parseInt(fe[A].slice(1))-1,Z[_]||(Z[_]={});break;case"R":w=parseInt(fe[A].slice(1))-1,C[w]||(C[w]={}),ne>0?(C[w].hpt=ne,C[w].hpx=El(ne)):ne===0&&(C[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}P<1&&(J=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}}return C.length>0&&(O["!rows"]=C),Z.length>0&&(O["!cols"]=Z),y&&y.sheetRows&&(T=T.slice(0,y.sheetRows)),[T,O]}function l(g,y){var k=a(g,y),w=k[0],_=k[1],E=hi(w,y);return Ea(_).forEach(function(A){E[A]=_[A]}),E}function c(g,y){return Os(l(g,y),y)}function f(g,y,k,w){var _="C;Y"+(k+1)+";X"+(w+1)+";K";switch(g.t){case"n":_+=g.v||0,g.f&&!g.F&&(_+=";E"+RT(g.f,{r:k,c:w}));break;case"b":_+=g.v?"TRUE":"FALSE";break;case"e":_+=g.w||g.v;break;case"d":_+='"'+(g.w||g.v)+'"';break;case"s":_+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(g,y){y.forEach(function(k,w){var _="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?_+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Nu(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Fu(k.wpx)),typeof k.wch=="number"&&(_+=Math.round(k.wch))),_.charAt(_.length-1)!=" "&&g.push(_)})}function p(g,y){y.forEach(function(k,w){var _="F;";k.hidden?_+="M0;":k.hpt?_+="M"+20*k.hpt+";":k.hpx&&(_+="M"+20*q1(k.hpx)+";"),_.length>2&&g.push(_+"R"+(w+1))})}function x(g,y){var k=["ID;PWXL;N;E"],w=[],_=fr(g["!ref"]),E,A=Array.isArray(g),T=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),g["!cols"]&&h(k,g["!cols"]),g["!rows"]&&p(k,g["!rows"]),k.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var L=_.s.r;L<=_.e.r;++L)for(var J=_.s.c;J<=_.e.c;++J){var O=xt({r:L,c:J});E=A?(g[L]||[])[J]:g[O],!(!E||E.v==null&&(!E.f||E.F))&&w.push(f(E,g,L,J))}return k.join(T)+T+w.join(T)+T+"E"+T}return{to_workbook:c,to_sheet:l,from_sheet:x}})(),XE=(function(){function e(o,l){switch(l.type){case"base64":return n(Cn(o),l);case"binary":return n(o,l);case"buffer":return n(Et&&Buffer.isBuffer(o)?o.toString("binary"):mo(o),l);case"array":return n(io(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,h=-1,p=0,x=[];p!==c.length;++p){if(c[p].trim()==="BOT"){x[++f]=[],h=0;continue}if(!(f<0)){var g=c[p].trim().split(","),y=g[0],k=g[1];++p;for(var w=c[p]||"";(w.match(/["]/g)||[]).length&1&&p<c.length-1;)w+=`
`+c[++p];switch(w=w.trim(),+y){case-1:if(w==="BOT"){x[++f]=[],h=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[f][h]=!0:w==="FALSE"?x[f][h]=!1:isNaN(na(k))?isNaN(ai(k).getDate())?x[f][h]=k:x[f][h]=Rr(k):x[f][h]=na(k),++h;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[f][h++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function t(o,l){return hi(e(o,l),l)}function r(o,l){return Os(t(o,l),l)}var a=(function(){var o=function(f,h,p,x,g){f.push(h),f.push(p+","+x),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,h,p,x){f.push(h+","+p),f.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var h=[],p=fr(f["!ref"]),x,g=Array.isArray(f);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,p.e.r-p.s.r+1,""),o(h,"TUPLES",0,p.e.c-p.s.c+1,""),o(h,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){l(h,-1,0,"BOT");for(var k=p.s.c;k<=p.e.c;++k){var w=xt({r:y,c:k});if(x=g?(f[y]||[])[k]:f[w],!x){l(h,1,0,"");continue}switch(x.t){case"n":var _=x.w;!_&&x.v!=null&&(_=x.v),_==null?x.f&&!x.F?l(h,1,0,"="+x.f):l(h,1,0,""):l(h,0,_,"V");break;case"b":l(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Un(x.z||yt[14],dn(Rr(x.v)))),l(h,0,x.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var E=`\r
`,A=h.join(E);return A}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),QE=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(x,g){for(var y=x.split(`
`),k=-1,w=-1,_=0,E=[];_!==y.length;++_){var A=y[_].trim().split(":");if(A[0]==="cell"){var T=ln(A[1]);if(E.length<=T.r)for(k=E.length;k<=T.r;++k)E[k]||(E[k]=[]);switch(k=T.r,w=T.c,A[2]){case"t":E[k][w]=e(A[3]);break;case"v":E[k][w]=+A[3];break;case"vtf":var L=A[A.length-1];case"vtc":switch(A[3]){case"nl":E[k][w]=!!+A[4];break;default:E[k][w]=+A[4];break}A[2]=="vtf"&&(E[k][w]=[E[k][w],L])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function r(x,g){return hi(t(x,g),g)}function a(x,g){return Os(r(x,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var g=[],y=[],k,w="",_=pi(x["!ref"]),E=Array.isArray(x),A=_.s.r;A<=_.e.r;++A)for(var T=_.s.c;T<=_.e.c;++T)if(w=xt({r:A,c:T}),k=E?(x[A]||[])[T]:x[w],!(!k||k.v==null||k.t==="z")){switch(y=["cell",w,"t"],k.t){case"s":case"str":y.push(n(k.v));break;case"n":k.f?(y[2]="vtf",y[3]="n",y[4]=k.v,y[5]=n(k.f)):(y[2]="v",y[3]=k.v);break;case"b":y[2]="vt"+(k.f?"f":"c"),y[3]="nl",y[4]=k.v?"1":"0",y[5]=n(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var L=dn(Rr(k.v));y[2]="vtc",y[3]="nd",y[4]=""+L,y[5]=k.w||Un(k.z||yt[14],L);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(x){return[o,l,c,l,h(x),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:p}})(),_l=(function(){function e(p,x,g,y,k){k.raw?x[g][y]=p:p===""||(p==="TRUE"?x[g][y]=!0:p==="FALSE"?x[g][y]=!1:isNaN(na(p))?isNaN(ai(p).getDate())?x[g][y]=p:x[g][y]=Rr(p):x[g][y]=na(p))}function n(p,x){var g=x||{},y=[];if(!p||p.length===0)return y;for(var k=p.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var _=10,E=0,A=0;A<=w;++A)E=k[A].indexOf(" "),E==-1?E=k[A].length:E++,_=Math.max(_,E);for(A=0;A<=w;++A){y[A]=[];var T=0;for(e(k[A].slice(0,_).trim(),y,A,T,g),T=1;T<=(k[A].length-_)/10+1;++T)e(k[A].slice(_+(T-1)*10,_+T*10).trim(),y,A,T,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(p){for(var x={},g=!1,y=0,k=0;y<p.length;++y)(k=p.charCodeAt(y))==34?g=!g:!g&&k in t&&(x[k]=(x[k]||0)+1);k=[];for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y]);if(!k.length){x=r;for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y])}return k.sort(function(w,_){return w[0]-_[0]||r[w[1]]-r[_[1]]}),t[k.pop()[1]]||44}function o(p,x){var g=x||{},y="",k=g.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=a(p.slice(0,1024)):g&&g.FS?y=g.FS:y=a(p.slice(0,1024));var _=0,E=0,A=0,T=0,L=0,J=y.charCodeAt(0),O=!1,C=0,Z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var M=g.dateNF!=null?i_(g.dateNF):null;function ne(){var G=p.slice(T,L),z={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)z.t="z";else if(g.raw)z.t="s",z.v=G;else if(G.trim().length===0)z.t="s",z.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(z.t="s",z.v=G.slice(2,-1).replace(/""/g,'"')):IT(G)?(z.t="n",z.f=G.slice(1)):(z.t="s",z.v=G);else if(G=="TRUE")z.t="b",z.v=!0;else if(G=="FALSE")z.t="b",z.v=!1;else if(!isNaN(A=na(G)))z.t="n",g.cellText!==!1&&(z.w=G),z.v=A;else if(!isNaN(ai(G).getDate())||M&&G.match(M)){z.z=g.dateNF||yt[14];var fe=0;M&&G.match(M)&&(G=l_(G,g.dateNF,G.match(M)||[]),fe=1),g.cellDates?(z.t="d",z.v=Rr(G,fe)):(z.t="n",z.v=dn(Rr(G,fe))),g.cellText!==!1&&(z.w=Un(z.z,z.v instanceof Date?dn(z.v):z.v)),g.cellNF||delete z.z}else z.t="s",z.v=G;if(z.t=="z"||(g.dense?(k[_]||(k[_]=[]),k[_][E]=z):k[xt({c:E,r:_})]=z),T=L+1,Z=p.charCodeAt(T),w.e.c<E&&(w.e.c=E),w.e.r<_&&(w.e.r=_),C==J)++E;else if(E=0,++_,g.sheetRows&&g.sheetRows<=_)return!0}e:for(;L<p.length;++L)switch(C=p.charCodeAt(L)){case 34:Z===34&&(O=!O);break;case J:case 10:case 13:if(!O&&ne())break e;break}return L-T>0&&ne(),k["!ref"]=Tt(w),k}function l(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,x):hi(n(p,x),x)}function c(p,x){var g="",y=x.type=="string"?[0,0,0,0]:Tp(p,x);switch(x.type){case"base64":g=Cn(p);break;case"binary":g=p;break;case"buffer":x.codepage==65001?g=p.toString("utf8"):x.codepage&&typeof vl<"u"||(g=Et&&Buffer.isBuffer(p)?p.toString("binary"):mo(p));break;case"array":g=io(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+x.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=Kt(g.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?g=Kt(g):x.type=="binary"&&typeof vl<"u",g.slice(0,19)=="socialcalc:version:"?QE.to_sheet(x.type=="string"?g:Kt(g),x):l(g,x)}function f(p,x){return Os(c(p,x),x)}function h(p){for(var x=[],g=fr(p["!ref"]),y,k=Array.isArray(p),w=g.s.r;w<=g.e.r;++w){for(var _=[],E=g.s.c;E<=g.e.c;++E){var A=xt({r:w,c:E});if(y=k?(p[w]||[])[E]:p[A],!y||y.v==null){_.push("          ");continue}for(var T=(y.w||(Ka(y),y.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(E===0?" ":""))}x.push(_.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})();function qE(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=GE.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return _l.to_workbook(e,n)}}var pl=(function(){function e(S,R,P){if(S){zr(S,S.l||0);for(var W=P.Enum||ae;S.l<S.length;){var H=S.read_shift(2),ee=W[H]||W[65535],se=S.read_shift(2),Q=S.l+se,he=ee.f&&ee.f(S,se,P);if(S.l=Q,R(he,ee,H))return}}}function n(S,R){switch(R.type){case"base64":return t(ea(Cn(S)),R);case"binary":return t(ea(S),R);case"buffer":case"array":return t(S,R)}throw"Unsupported type "+R.type}function t(S,R){if(!S)return S;var P=R||{},W=P.dense?[]:{},H="Sheet1",ee="",se=0,Q={},he=[],me=[],I={s:{r:0,c:0},e:{r:0,c:0}},Ve=P.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)P.Enum=ae,e(S,function(ye,Pe,Ze){switch(Ze){case 0:P.vers=ye,ye>=4096&&(P.qpro=!0);break;case 6:I=ye;break;case 204:ye&&(ee=ye);break;case 222:ee=ye;break;case 15:case 51:P.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:Ze==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=P.dateNF||yt[14],P.cellDates&&(ye[1].t="d",ye[1].v=Xu(ye[1].v))),P.qpro&&ye[3]>se&&(W["!ref"]=Tt(I),Q[H]=W,he.push(H),W=P.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},se=ye[3],H=ee||"Sheet"+(se+1),ee="");var Xe=P.dense?(W[ye[0].r]||[])[ye[0].c]:W[xt(ye[0])];if(Xe){Xe.t=ye[1].t,Xe.v=ye[1].v,ye[1].z!=null&&(Xe.z=ye[1].z),ye[1].f!=null&&(Xe.f=ye[1].f);break}P.dense?(W[ye[0].r]||(W[ye[0].r]=[]),W[ye[0].r][ye[0].c]=ye[1]):W[xt(ye[0])]=ye[1];break}},P);else if(S[2]==26||S[2]==14)P.Enum=B,S[2]==14&&(P.qpro=!0,S.l=0),e(S,function(ye,Pe,Ze){switch(Ze){case 204:H=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>se&&(W["!ref"]=Tt(I),Q[H]=W,he.push(H),W=P.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},se=ye[3],H="Sheet"+(se+1)),Ve>0&&ye[0].r>=Ve)break;P.dense?(W[ye[0].r]||(W[ye[0].r]=[]),W[ye[0].r][ye[0].c]=ye[1]):W[xt(ye[0])]=ye[1],I.e.c<ye[0].c&&(I.e.c=ye[0].c),I.e.r<ye[0].r&&(I.e.r=ye[0].r);break;case 27:ye[14e3]&&(me[ye[14e3][0]]=ye[14e3][1]);break;case 1537:me[ye[0]]=ye[1],ye[0]==se&&(H=ye[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(W["!ref"]=Tt(I),Q[ee||H]=W,he.push(ee||H),!me.length)return{SheetNames:he,Sheets:Q};for(var Ce={},ge=[],Ee=0;Ee<me.length;++Ee)Q[he[Ee]]?(ge.push(me[Ee]||he[Ee]),Ce[me[Ee]]=Q[me[Ee]]||Q[he[Ee]]):(ge.push(me[Ee]),Ce[me[Ee]]={"!ref":"A1"});return{SheetNames:ge,Sheets:Ce}}function r(S,R){var P=R||{};if(+P.codepage>=0&&ta(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Sd(),H=fr(S["!ref"]),ee=Array.isArray(S),se=[];Jn(W,0,o(1030)),Jn(W,6,f(H));for(var Q=Math.min(H.e.r,8191),he=H.s.r;he<=Q;++he)for(var me=Ur(he),I=H.s.c;I<=H.e.c;++I){he===H.s.r&&(se[I]=Tr(I));var Ve=se[I]+me,Ce=ee?(S[he]||[])[I]:S[Ve];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?Jn(W,13,y(he,I,Ce.v)):Jn(W,14,w(he,I,Ce.v));else{var ge=Ka(Ce);Jn(W,15,x(he,I,ge.slice(0,239)))}}return Jn(W,1),W.end()}function a(S,R){var P=R||{};if(+P.codepage>=0&&ta(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Sd();Jn(W,0,l(S));for(var H=0,ee=0;H<S.SheetNames.length;++H)(S.Sheets[S.SheetNames[H]]||{})["!ref"]&&Jn(W,27,q(S.SheetNames[H],ee++));var se=0;for(H=0;H<S.SheetNames.length;++H){var Q=S.Sheets[S.SheetNames[H]];if(!(!Q||!Q["!ref"])){for(var he=fr(Q["!ref"]),me=Array.isArray(Q),I=[],Ve=Math.min(he.e.r,8191),Ce=he.s.r;Ce<=Ve;++Ce)for(var ge=Ur(Ce),Ee=he.s.c;Ee<=he.e.c;++Ee){Ce===he.s.r&&(I[Ee]=Tr(Ee));var ye=I[Ee]+ge,Pe=me?(Q[Ce]||[])[Ee]:Q[ye];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")Jn(W,23,ne(Ce,Ee,se,Pe.v));else{var Ze=Ka(Pe);Jn(W,22,C(Ce,Ee,se,Ze.slice(0,239)))}}++se}}return Jn(W,1),W.end()}function o(S){var R=Sr(2);return R.write_shift(2,S),R}function l(S){var R=Sr(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var P=0,W=0,H=0,ee=0;ee<S.SheetNames.length;++ee){var se=S.SheetNames[ee],Q=S.Sheets[se];if(!(!Q||!Q["!ref"])){++H;var he=pi(Q["!ref"]);P<he.e.r&&(P=he.e.r),W<he.e.c&&(W=he.e.c)}}return P>8191&&(P=8191),R.write_shift(2,P),R.write_shift(1,H),R.write_shift(1,W),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function c(S,R,P){var W={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&P.qpro?(W.s.c=S.read_shift(1),S.l++,W.s.r=S.read_shift(2),W.e.c=S.read_shift(1),S.l++,W.e.r=S.read_shift(2),W):(W.s.c=S.read_shift(2),W.s.r=S.read_shift(2),R==12&&P.qpro&&(S.l+=2),W.e.c=S.read_shift(2),W.e.r=S.read_shift(2),R==12&&P.qpro&&(S.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function f(S){var R=Sr(8);return R.write_shift(2,S.s.c),R.write_shift(2,S.s.r),R.write_shift(2,S.e.c),R.write_shift(2,S.e.r),R}function h(S,R,P){var W=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(W[0].c=S.read_shift(1),W[3]=S.read_shift(1),W[0].r=S.read_shift(2),S.l+=2):(W[2]=S.read_shift(1),W[0].c=S.read_shift(2),W[0].r=S.read_shift(2)),W}function p(S,R,P){var W=S.l+R,H=h(S,R,P);if(H[1].t="s",P.vers==20768){S.l++;var ee=S.read_shift(1);return H[1].v=S.read_shift(ee,"utf8"),H}return P.qpro&&S.l++,H[1].v=S.read_shift(W-S.l,"cstr"),H}function x(S,R,P){var W=Sr(7+P.length);W.write_shift(1,255),W.write_shift(2,R),W.write_shift(2,S),W.write_shift(1,39);for(var H=0;H<W.length;++H){var ee=P.charCodeAt(H);W.write_shift(1,ee>=128?95:ee)}return W.write_shift(1,0),W}function g(S,R,P){var W=h(S,R,P);return W[1].v=S.read_shift(2,"i"),W}function y(S,R,P){var W=Sr(7);return W.write_shift(1,255),W.write_shift(2,R),W.write_shift(2,S),W.write_shift(2,P,"i"),W}function k(S,R,P){var W=h(S,R,P);return W[1].v=S.read_shift(8,"f"),W}function w(S,R,P){var W=Sr(13);return W.write_shift(1,255),W.write_shift(2,R),W.write_shift(2,S),W.write_shift(8,P,"f"),W}function _(S,R,P){var W=S.l+R,H=h(S,R,P);if(H[1].v=S.read_shift(8,"f"),P.qpro)S.l=W;else{var ee=S.read_shift(2);L(S.slice(S.l,S.l+ee),H),S.l+=ee}return H}function E(S,R,P){var W=R&32768;return R&=-32769,R=(W?S:0)+(R>=8192?R-16384:R),(W?"":"$")+(P?Tr(R):Ur(R))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(S,R){zr(S,0);for(var P=[],W=0,H="",ee="",se="",Q="";S.l<S.length;){var he=S[S.l++];switch(he){case 0:P.push(S.read_shift(8,"f"));break;case 1:ee=E(R[0].c,S.read_shift(2),!0),H=E(R[0].r,S.read_shift(2),!1),P.push(ee+H);break;case 2:{var me=E(R[0].c,S.read_shift(2),!0),I=E(R[0].r,S.read_shift(2),!1);ee=E(R[0].c,S.read_shift(2),!0),H=E(R[0].r,S.read_shift(2),!1),P.push(me+I+":"+ee+H)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(S.read_shift(2));break;case 6:{for(var Ve="";he=S[S.l++];)Ve+=String.fromCharCode(he);P.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:Q=P.pop(),se=P.pop(),P.push(["AND","OR"][he-20]+"("+se+","+Q+")");break;default:if(he<32&&T[he])Q=P.pop(),se=P.pop(),P.push(se+T[he]+Q);else if(A[he]){if(W=A[he][1],W==69&&(W=S[S.l++]),W>P.length){console.error("WK1 bad formula parse 0x"+he.toString(16)+":|"+P.join("|")+"|");return}var Ce=P.slice(-W);P.length-=W,P.push(A[he][0]+"("+Ce.join(",")+")")}else return he<=7?console.error("WK1 invalid opcode "+he.toString(16)):he<=24?console.error("WK1 unsupported op "+he.toString(16)):he<=30?console.error("WK1 invalid opcode "+he.toString(16)):he<=115?console.error("WK1 unsupported function opcode "+he.toString(16)):console.error("WK1 unrecognized opcode "+he.toString(16))}}P.length==1?R[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function J(S){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=S.read_shift(2),R[3]=S[S.l++],R[0].c=S[S.l++],R}function O(S,R){var P=J(S);return P[1].t="s",P[1].v=S.read_shift(R-4,"cstr"),P}function C(S,R,P,W){var H=Sr(6+W.length);H.write_shift(2,S),H.write_shift(1,P),H.write_shift(1,R),H.write_shift(1,39);for(var ee=0;ee<W.length;++ee){var se=W.charCodeAt(ee);H.write_shift(1,se>=128?95:se)}return H.write_shift(1,0),H}function Z(S,R){var P=J(S);P[1].v=S.read_shift(2);var W=P[1].v>>1;if(P[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return P[1].v=W,P}function M(S,R){var P=J(S),W=S.read_shift(4),H=S.read_shift(4),ee=S.read_shift(2);if(ee==65535)return W===0&&H===3221225472?(P[1].t="e",P[1].v=15):W===0&&H===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var se=ee&32768;return ee=(ee&32767)-16446,P[1].v=(1-se*2)*(H*Math.pow(2,ee+32)+W*Math.pow(2,ee)),P}function ne(S,R,P,W){var H=Sr(14);if(H.write_shift(2,S),H.write_shift(1,P),H.write_shift(1,R),W==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var ee=0,se=0,Q=0,he=0;return W<0&&(ee=1,W=-W),se=Math.log2(W)|0,W/=Math.pow(2,se-31),he=W>>>0,(he&2147483648)==0&&(W/=2,++se,he=W>>>0),W-=he,he|=2147483648,he>>>=0,W*=Math.pow(2,32),Q=W>>>0,H.write_shift(4,Q),H.write_shift(4,he),se+=16383+(ee?32768:0),H.write_shift(2,se),H}function G(S,R){var P=M(S);return S.l+=R-14,P}function z(S,R){var P=J(S),W=S.read_shift(4);return P[1].v=W>>6,P}function fe(S,R){var P=J(S),W=S.read_shift(8,"f");return P[1].v=W,P}function ue(S,R){var P=fe(S);return S.l+=R-10,P}function oe(S,R){return S[S.l+R-1]==0?S.read_shift(R,"cstr"):""}function pe(S,R){var P=S[S.l++];P>R-1&&(P=R-1);for(var W="";W.length<P;)W+=String.fromCharCode(S[S.l++]);return W}function V(S,R,P){if(!(!P.qpro||R<21)){var W=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var H=S.read_shift(R-21,"cstr");return[W,H]}}function ie(S,R){for(var P={},W=S.l+R;S.l<W;){var H=S.read_shift(2);if(H==14e3){for(P[H]=[0,""],P[H][0]=S.read_shift(2);S[S.l];)P[H][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return P}function q(S,R){var P=Sr(5+S.length);P.write_shift(2,14e3),P.write_shift(2,R);for(var W=0;W<S.length;++W){var H=S.charCodeAt(W);P[P.l++]=H>127?95:H}return P[P.l++]=0,P}var ae={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},B={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:Z},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:V},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function ZE(e){var n={},t=e.match(Jr),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=pt(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=rp[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var JE=(function(){var e=wl("t"),n=wl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:Ft(l[1])},f=o.match(n);return f&&(c.s=ZE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),eS=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),tS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,rS=/<(?:\w+:)?r>/,nS=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Ft(Kt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Kt(e),t&&(r.h=cp(r.t))):e.match(rS)&&(r.r=Kt(e),r.t=Ft(Kt((e.replace(nS,"").match(tS)||[]).join("").replace(Jr,""))),t&&(r.h=eS(JE(r.r)))),r):{t:""}}var aS=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sS=/<(?:\w+:)?(?:si|sstItem)>/g,oS=/<\/(?:\w+:)?(?:si|sstItem)>/;function iS(e,n){var t=[],r="";if(!e)return t;var a=e.match(aS);if(a){r=a[2].replace(sS,"").split(oS);for(var o=0;o!=r.length;++o){var l=yp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=pt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function lS(e){return[e.read_shift(4),e.read_shift(4)]}function cS(e,n){var t=[],r=!1;return Xa(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Y1(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Wa(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function uS(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function fS(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function dS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(fS(e));return n}function pS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function hS(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function mS(e){var n=hS(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function V1(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function K1(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function xS(e){var n=Wa(e);switch(n.Minor){case 2:return[n.Minor,gS(e)];case 3:return[n.Minor,vS()];case 4:return[n.Minor,yS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function gS(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=V1(e,t),a=K1(e,e.length-e.l);return{t:"Std",h:r,v:a}}function vS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yS(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(Jr,function(o){var l=pt(o);switch(Ta(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function wS(e,n){var t={},r=t.EncryptionVersionInfo=Wa(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=V1(e,a),n-=a,t.EncryptionVerifier=K1(e,n),t}function kS(e){var n={},t=n.EncryptionVersionInfo=Wa(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function _S(e){var n=0,t,r=Y1(e),a=r.length+1,o,l,c,f,h;for(t=Cs(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,h=c|f,n=h^l;return n^52811}var G1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var p=l[h],x=0;x!=7;++x)p&64&&(c^=t[f]),p*=2,--f;return c};return function(l){for(var c=Y1(l),f=o(c),h=c.length,p=Cs(16),x=0;x!=16;++x)p[x]=0;var g,y,k;for((h&1)===1&&(g=f>>8,p[h]=a(e[0],g),--h,g=f&255,y=c[c.length-1],p[h]=a(y,g));h>0;)--h,g=f>>8,p[h]=a(c[h],g),--h,g=f&255,p[h]=a(c[h],g);for(h=15,k=15-c.length;k>0;)g=f>>8,p[h]=a(e[k],g),--h,--k,g=f&255,p[h]=a(c[h],g),--h,--k;return p}})(),bS=function(e,n,t,r,a){a||(a=n),r||(r=G1(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},ES=function(e){var n=0,t=G1(e);return function(r){var a=bS("",r,n,t);return n=a[1],a[0]}};function SS(e,n,t,r){var a={key:_r(e),verificationBytes:_r(e)};return t.password&&(a.verifier=_S(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=ES(t.password)),a}function TS(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=kS(e):r.Data=wS(e,n),r}function CS(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?TS(e,n-2,r):SS(e,t.biff>=8?n:n-2,t,r),r}var DS=(function(){function e(a,o){switch(o.type){case"base64":return n(Cn(a),o);case"binary":return n(a,o);case"buffer":return n(Et&&Buffer.isBuffer(a)?a.toString("binary"):mo(a),o);case"array":return n(io(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,x){Array.isArray(c)&&(c[x]=[]);for(var g=/\\\w+\b/g,y=0,k,w=-1;k=g.exec(p);){switch(k[0]){case"\\cell":var _=p.slice(y,g.lastIndex-k[0].length);if(_[0]==" "&&(_=_.slice(1)),++w,_.length){var E={v:_,t:"s"};Array.isArray(c)?c[x][w]=E:c[xt({r:x,c:w})]=E}break}y=g.lastIndex}w>h.e.c&&(h.e.c=w)}),c["!ref"]=Tt(h),c}function t(a,o){return Os(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=fr(a["!ref"]),c,f=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var x=xt({r:h,c:p});c=f?(a[h]||[])[p]:a[x],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Ka(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function NS(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function bl(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function FS(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,h=a+o;switch(f=l/(h>1?2-h:h),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,h/2]}function AS(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function Du(e,n){if(n===0)return e;var t=FS(NS(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),bl(AS(t))}var X1=6,OS=15,PS=1,sn=X1;function Nu(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function Fu(e){return Math.floor((e-5)/sn*100+.5)/100}function Nd(e){return Math.round((e*sn+5)/sn*256)/256}function rd(e){return Nd(Fu(Nu(e)))}function wp(e){var n=Math.abs(e-rd(e)),t=sn;if(n>.005)for(sn=PS;sn<OS;++sn)Math.abs(e-rd(e))<=n&&(n=Math.abs(e-rd(e)),t=sn);sn=t}function si(e){e.width?(e.wpx=Nu(e.width),e.wch=Fu(e.wpx),e.MDW=sn):e.wpx?(e.wch=Fu(e.wpx),e.width=Nd(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Nd(e.wch),e.wpx=Nu(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var RS=96,Q1=RS;function q1(e){return e*96/Q1}function El(e){return e*Q1/96}var MS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IS(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(Jr)||[]).forEach(function(l){var c=pt(l);switch(Ta(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=tr(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=tr(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function jS(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(Jr)||[]).forEach(function(l){var c=pt(l);switch(Ta(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function LS(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(Jr)||[]).forEach(function(l){var c=pt(l);switch(Ta(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Kt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?tr(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?tr(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?tr(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?tr(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?tr(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?tr(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?tr(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=rp[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=tr(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=to[a.color.index];a.color.index==81&&(f=to[1]),f||(f=to[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Du(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function zS(e,n,t){n.NumberFmt=[];for(var r=Ea(yt),a=0;a<r.length;++a)n.NumberFmt[r[a]]=yt[r[a]];var o=e[0].match(Jr);if(o)for(a=0;a<o.length;++a){var l=pt(o[a]);switch(Ta(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ft(Kt(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}eo(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var ru=["numFmtId","fillId","fontId","borderId","xfId"],nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BS(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(Jr)||[]).forEach(function(o){var l=pt(o),c=0;switch(Ta(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<ru.length;++c)r[ru[c]]&&(r[ru[c]]=parseInt(r[ru[c]],10));for(c=0;c<nu.length;++c)r[nu[c]]&&(r[nu[c]]=tr(r[nu[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=tr(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var WS=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,h){var p={};if(!c)return p;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=c.match(n))&&zS(x,p,h),(x=c.match(a))&&LS(x,p,f,h),(x=c.match(r))&&jS(x,p,f,h),(x=c.match(o))&&IS(x,p,f,h),(x=c.match(t))&&BS(x,p,h),p}})();function US(e,n){var t=e.read_shift(2),r=qr(e);return[t,r]}function HS(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=J_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=Z_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=qr(e),r}var $S=Zr;function YS(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var VS=Zr;function KS(e,n,t){var r={};r.NumberFmt=[];for(var a in yt)r.NumberFmt[a]=yt[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return Xa(e,function(f,h,p){switch(p){case 44:r.NumberFmt[f[0]]=f[1],eo(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=Du(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(p);else if(h.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var GS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function XS(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(Jr)||[]).forEach(function(a){var o=pt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[GS.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function QS(){}function qS(){}var ZS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tT(e,n,t){n.themeElements={};var r;[["clrScheme",ZS,XS],["fontScheme",JS,QS],["fmtScheme",eT,qS]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var rT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Z1(e,n){(!e||e.length===0)&&(e=nT());var t,r={};if(!(t=e.match(rT)))throw new Error("themeElements not found in theme");return tT(t[0],r,n),r.raw=e,r}function nT(e,n){var t=[c1];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function aT(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=l1(o,{type:"array"})}catch{return}var c=Sn(l,"theme/theme/theme1.xml",!0);if(c)return Z1(c,t)}}function sT(e){return e.read_shift(4)}function oT(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=iT(e,4);break;case 2:n.xclrValue=L1(e);break;case 3:n.xclrValue=sT(e);break;case 4:e.l+=4;break}return e.l+=8,n}function iT(e,n){return Zr(e,n)}function lT(e,n){return Zr(e,n)}function cT(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=oT(e);break;case 6:r[1]=lT(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function uT(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(cT(e,t-e.l));return{ixfe:r,ext:o}}function fT(e,n){n.forEach(function(t){t[0]})}function dT(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:qr(e)}}function pT(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function hT(e){return e.l+=4,e.read_shift(4)!=0}function mT(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return Xa(e,function(f,h,p){switch(p){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(x){c==1?r.Cell.push({type:r.Types[x[0]-1].name,index:x[1]}):c==0&&r.Value.push({type:r.Types[x[0]-1].name,index:x[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function xT(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(Jr,function(c){var f=pt(c);switch(Ta(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==f.name&&(l=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function gT(e){var n=[];if(!e)return n;var t=1;return(e.match(Jr)||[]).forEach(function(r){var a=pt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function vT(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=xt(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function yT(e,n,t){var r=[];return Xa(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function wT(e,n,t,r){if(!e)return e;var a=r||{},o=!1;Xa(e,function(c,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function kT(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function Eg(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=ln(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=fr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var h=Tt(f);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:t};l.h&&(p.h=l.h);for(var x=o.c.length-1;x>=0;--x){if(!t&&o.c[x].T)return;t&&!o.c[x].T&&o.c.splice(x,1)}if(t&&r){for(x=0;x<r.length;++x)if(p.a==r[x].id){p.a=r[x].name||p.a;break}}o.c.push(p)})}function _T(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=pt(c[0]),h={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=ln(f.ref);if(!(n.sheetRows&&n.sheetRows<=p.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!x&&!!x[1]&&yp(x[1])||{r:"",t:"",h:""};h.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),h.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(h.h=g.h),r.push(h)}}}}),r}function bT(e,n){var t=[],r=!1,a={},o=0;return e.replace(Jr,function(c,f){var h=pt(c);switch(Ta(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function ET(e,n){var t=[],r=!1;return e.replace(Jr,function(o){var l=pt(o);switch(Ta(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function ST(e){var n={};n.iauthor=e.read_shift(4);var t=go(e);return n.rfx=t.s,n.ref=xt(t.s),e.l+=16,n}var TT=qr;function CT(e,n){var t=[],r=[],a={},o=!1;return Xa(e,function(c,f,h){switch(h){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var DT="application/vnd.ms-office.vbaProject";function NT(e){var n=St.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");St.utils.cfb_add(n,a,e.FileIndex[r].content)}}),St.write(n)}function FT(){return{"!type":"dialog"}}function AT(){return{"!type":"dialog"}}function OT(){return{"!type":"macro"}}function PT(){return{"!type":"macro"}}var Zo=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return c?p+=n.c:--p,f?h+=n.r:--h,a+(c?"":"$")+Tr(p)+(f?"":"$")+Ur(h)}return function(a,o){return n=o,a.replace(e,t)}})(),J1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,RT=(function(){return function(n,t){return n.replace(J1,function(r,a,o,l,c,f){var h=pp(l)-(o?0:t.c),p=dp(f)-(c?0:t.r),x=p==0?"":c?p+1:"["+p+"]",g=h==0?"":o?h+1:"["+h+"]";return a+"R"+x+"C"+g})}})();function ey(e,n){return e.replace(J1,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Tr(pp(o)+n.c))+(l=="$"?l+c:Ur(dp(c)+n.r))})}function MT(e,n,t){var r=pi(n),a=r.s,o=ln(t),l={r:o.r-a.r,c:o.c-a.c};return ey(e,l)}function IT(e){return e.length!=1}function Sg(e){return e.replace(/_xlfn\./g,"")}function wr(e){e.l+=1}function Ds(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function ty(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return ry(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Ds(e),c=Ds(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function ry(e){var n=Ds(e),t=Ds(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function jT(e,n,t){if(t.biff<8)return ry(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=Ds(e),l=Ds(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ny(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return LT(e);var r=e.read_shift(t&&t.biff==12?4:2),a=Ds(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function LT(e){var n=Ds(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function zT(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function BT(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return WT(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function WT(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function UT(e,n,t){var r=(e[e.l++]&96)>>5,a=ty(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function HT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=ty(e,o,t);return[r,a,l]}function $T(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function YT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function VT(e,n,t){var r=(e[e.l++]&96)>>5,a=jT(e,n-1,t);return[r,a]}function KT(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Tg(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function GT(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function XT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function QT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function qT(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function ZT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function ay(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function JT(e){return e.read_shift(2),ay(e)}function eC(e){return e.read_shift(2),ay(e)}function tC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=ny(e,0,t);return[r,a]}function rC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=BT(e,0,t);return[r,a]}function nC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=ny(e,0,t);return[r,a,o]}function aC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[sD[a],iy[a],r]}function sC(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:oC(e);return[a,(o[0]===0?iy:aD)[o[1]]]}function oC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function iC(e,n,t){e.l+=t&&t.biff==2?3:4}function lC(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function cC(e){return e.l++,vo[e.read_shift(1)]}function uC(e){return e.l++,e.read_shift(2)}function fC(e){return e.l++,e.read_shift(1)!==0}function dC(e){return e.l++,Xr(e)}function pC(e,n,t){return e.l++,Al(e,n-1,t)}function hC(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=xr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=vo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Xr(e);break;case 2:t[1]=yo(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function mC(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?go:Qu)(e));return a}function xC(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=hC(e,t.biff);return l}function gC(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function vC(e,n,t){if(t.biff==5)return yC(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function yC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function wC(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function kC(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function _C(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function bC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var EC=Zr,SC=Zr,TC=Zr;function Pl(e,n,t){return e.l+=2,[zT(e)]}function kp(e){return e.l+=6,[]}var CC=Pl,DC=kp,NC=kp,FC=Pl;function sy(e){return e.l+=2,[_r(e),e.read_shift(2)&1]}var AC=Pl,OC=sy,PC=kp,RC=Pl,MC=Pl,IC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jC(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=IC[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function LC(e){return e.l+=2,[e.read_shift(4)]}function zC(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function BC(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function WC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function UC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function HC(e){return e.l+=4,[0,0]}var Cg={1:{n:"PtgExp",f:lC},2:{n:"PtgTbl",f:TC},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:pC},26:{n:"PtgSheet",f:zC},27:{n:"PtgEndSheet",f:BC},28:{n:"PtgErr",f:cC},29:{n:"PtgBool",f:fC},30:{n:"PtgInt",f:uC},31:{n:"PtgNum",f:dC},32:{n:"PtgArray",f:KT},33:{n:"PtgFunc",f:aC},34:{n:"PtgFuncVar",f:sC},35:{n:"PtgName",f:gC},36:{n:"PtgRef",f:tC},37:{n:"PtgArea",f:UT},38:{n:"PtgMemArea",f:wC},39:{n:"PtgMemErr",f:EC},40:{n:"PtgMemNoMem",f:SC},41:{n:"PtgMemFunc",f:kC},42:{n:"PtgRefErr",f:_C},43:{n:"PtgAreaErr",f:$T},44:{n:"PtgRefN",f:rC},45:{n:"PtgAreaN",f:VT},46:{n:"PtgMemAreaN",f:WC},47:{n:"PtgMemNoMemN",f:UC},57:{n:"PtgNameX",f:vC},58:{n:"PtgRef3d",f:nC},59:{n:"PtgArea3d",f:HT},60:{n:"PtgRefErr3d",f:bC},61:{n:"PtgAreaErr3d",f:YT},255:{}},$C={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YC={1:{n:"PtgElfLel",f:sy},2:{n:"PtgElfRw",f:RC},3:{n:"PtgElfCol",f:CC},6:{n:"PtgElfRwV",f:MC},7:{n:"PtgElfColV",f:FC},10:{n:"PtgElfRadical",f:AC},11:{n:"PtgElfRadicalS",f:PC},13:{n:"PtgElfColS",f:DC},15:{n:"PtgElfColSV",f:NC},16:{n:"PtgElfRadicalLel",f:OC},25:{n:"PtgList",f:jC},29:{n:"PtgSxName",f:LC},255:{}},VC={0:{n:"PtgAttrNoop",f:HC},1:{n:"PtgAttrSemi",f:ZT},2:{n:"PtgAttrIf",f:QT},4:{n:"PtgAttrChoose",f:GT},8:{n:"PtgAttrGoto",f:XT},16:{n:"PtgAttrSum",f:iC},32:{n:"PtgAttrBaxcel",f:Tg},33:{n:"PtgAttrBaxcel",f:Tg},64:{n:"PtgAttrSpace",f:JT},65:{n:"PtgAttrSpaceSemi",f:eC},128:{n:"PtgAttrIfError",f:qT},255:{}};function Rl(e,n,t,r){if(r.biff<8)return Zr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=xC(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=mC(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(Zr(e,n)),o}function Ml(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Cg[o]||Cg[$C[o]],(o===24||o===25)&&(a=(o===24?YC:VC)[e[e.l+1]]),!a||!a.f?Zr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function KC(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var GC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XC(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function oy(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Dg(e,n,t){var r=oy(e,n,t);return r=="#REF"?r:XC(r,t)}function Gr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,h,p,x=0,g=0,y,k="";if(!e[0]||!e[0][0])return"";for(var w=-1,_="",E=0,A=e[0].length;E<A;++E){var T=e[0][E];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),w>=0){switch(e[0][w][1][0]){case 0:_=ur(" ",e[0][w][1][1]);break;case 1:_=ur("\r",e[0][w][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}h=h+_,w=-1}c.push(h+GC[T[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=cl(T[1][1],l,a),c.push(ul(p,o));break;case"PtgRefN":p=t?cl(T[1][1],t,a):T[1][1],c.push(ul(p,o));break;case"PtgRef3d":x=T[1][1],p=cl(T[1][2],l,a),k=Dg(r,x,a),c.push(k+"!"+ul(p,o));break;case"PtgFunc":case"PtgFuncVar":var L=T[1][0],J=T[1][1];L||(L=0),L&=127;var O=L==0?[]:c.slice(-L);c.length-=L,J==="User"&&(J=O.shift()),c.push(J+"("+O.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":y=lg(T[1][1],t?{s:t}:l,a),c.push(ed(y,a));break;case"PtgArea":y=lg(T[1][1],l,a),c.push(ed(y,a));break;case"PtgArea3d":x=T[1][1],y=T[1][2],k=Dg(r,x,a),c.push(k+"!"+ed(y,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=T[1][2];var C=(r.names||[])[g-1]||(r[0]||[])[g],Z=C?C.Name:"SH33TJSNAME"+String(g);Z&&Z.slice(0,6)=="_xlfn."&&!a.xlfn&&(Z=Z.slice(6)),c.push(Z);break;case"PtgNameX":var M=T[1][1];g=T[1][2];var ne;if(a.biff<=5)M<0&&(M=-M),r[M]&&(ne=r[M][g]);else{var G="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][g]&&r[M][g].itab>0&&(G=r.SheetNames[r[M][g].itab-1]+"!"):G=r.SheetNames[g-1]+"!"),r[M]&&r[M][g])G+=r[M][g].Name;else if(r[0]&&r[0][g])G+=r[0][g].Name;else{var z=(oy(r,M,a)||"").split(";;");z[g-1]?G=z[g-1]:G+="SH33TJSERRX"}c.push(G);break}ne||(ne={Name:"SH33TJSERRY"}),c.push(ne.Name);break;case"PtgParen":var fe="(",ue=")";if(w>=0){switch(_="",e[0][w][1][0]){case 2:fe=ur(" ",e[0][w][1][1])+fe;break;case 3:fe=ur("\r",e[0][w][1][1])+fe;break;case 4:ue=ur(" ",e[0][w][1][1])+ue;break;case 5:ue=ur("\r",e[0][w][1][1])+ue;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}c.push(fe+c.pop()+ue);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:T[1][1],r:T[1][0]};var oe={c:t.c,r:t.r};if(r.sharedf[xt(p)]){var pe=r.sharedf[xt(p)];c.push(Gr(pe,l,oe,r,a))}else{var V=!1;for(f=0;f!=r.arrayf.length;++f)if(h=r.arrayf[f],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Gr(h[1],l,oe,r,a)),V=!0;break}V||c.push(T[1])}break;case"PtgArray":c.push("{"+KC(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&ie.indexOf(e[0][E][0])==-1){T=e[0][w];var q=!0;switch(T[1][0]){case 4:q=!1;case 0:_=ur(" ",T[1][1]);break;case 5:q=!1;case 1:_=ur("\r",T[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((q?_:"")+c.pop()+(q?"":_)),w=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function QC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Zr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function qC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Zr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function ZC(e,n,t,r){var a=e.l+n,o=Ml(e,r,t),l;return a!==e.l&&(l=Rl(e,a-e.l,o,t)),[o,l]}function JC(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=Ml(e,o,t);return o==65535?[[],Zr(e,n-2)]:(n!==o+2&&(a=Rl(e,r-o-2,l,t)),[l,a])}function eD(e){var n;if(za(e,e.l+6)!==65535)return[Xr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function nd(e,n,t){var r=e.l+n,a=Ca(e);t.biff==2&&++e.l;var o=eD(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=qC(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function qu(e,n,t){var r=e.read_shift(4),a=Ml(e,r,t),o=e.read_shift(4),l=o>0?Rl(e,o,a,t):null;return[a,l]}var tD=qu,Zu=qu,rD=qu,nD=qu,aD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ng(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ad(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var hl={},Jo={};function ml(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ly(e,n,t,r,a,o){try{r.cellNF&&(e.z=yt[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Rr(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(yt[n]==null&&eo(o_[n]||"General",n),e.t==="e")e.w=e.w||vo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v);else if(e.t==="d"){var l=dn(e.v);(l|0)===l?e.w=l.toString(10):e.w=yl(l)}else{if(e.v===void 0)return"";e.w=oo(e.v,Jo)}else e.t==="d"?e.w=Un(n,dn(e.v),Jo):e.w=Un(n,e.v,Jo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Du(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Du(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function oD(e,n){var t=fr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Tt(t))}var iD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,lD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cD=/<(?:\w:)?hyperlink [^>]*>/mg,uD=/"(\w*:\w*)"/,fD=/<(?:\w:)?col\b[^>]*[\/]?>/g,dD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pD=/<(?:\w:)?pageMargins[^>]*\/>/g,cy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xD(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",x=e.match(lD);x?(h=e.slice(0,x.index),p=e.slice(x.index+x[0].length)):h=p=e;var g=h.match(cy);g?_p(g[0],c,a,t):(g=h.match(hD))&&gD(g[0],g[1]||"",c,a,t);var y=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var k=h.slice(y,y+50).match(uD);k&&oD(c,k[1])}var w=h.match(mD);w&&w[1]&&bD(w[1],a);var _=[];if(n.cellStyles){var E=h.match(fD);E&&wD(_,E)}x&&ED(x[1],c,n,f,o,l);var A=p.match(dD);A&&(c["!autofilter"]=kD(A[0]));var T=[],L=p.match(iD);if(L)for(y=0;y!=L.length;++y)T[y]=fr(L[y].slice(L[y].indexOf('"')+1));var J=p.match(cD);J&&vD(c,J,r);var O=p.match(pD);if(O&&(c["!margins"]=yD(pt(O[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Tt(f)),n.sheetRows>0&&c["!ref"]){var C=fr(c["!ref"]);n.sheetRows<=+C.e.r&&(C.e.r=n.sheetRows-1,C.e.r>f.e.r&&(C.e.r=f.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>f.e.c&&(C.e.c=f.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Tt(C))}return _.length>0&&(c["!cols"]=_),T.length>0&&(c["!merges"]=T),c}function _p(e,n,t,r){var a=pt(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=Ft(Kt(a.codeName)))}function gD(e,n,t,r,a){_p(e.slice(0,e.indexOf(">")),t,r,a)}function vD(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=pt(Kt(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Ft(o.location))):(o.Target="#"+Ft(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=fr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var h=c.s.c;h<=c.e.c;++h){var p=xt({c:h,r:f});r?(e[f]||(e[f]=[]),e[f][h]||(e[f][h]={t:"z",v:void 0}),e[f][h].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function yD(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function wD(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=pt(n[r],!0);a.hidden&&(a.hidden=tr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,wp(a.width)),si(a);o<=l;)e[o++]=Wr(a)}}function kD(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var _D=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bD(e,n){n.Views||(n.Views=[{}]),(e.match(_D)||[]).forEach(function(t,r){var a=pt(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),tr(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var ED=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=wl("v"),l=wl("f");return function(f,h,p,x,g,y){for(var k=0,w="",_=[],E=[],A=0,T=0,L=0,J="",O,C,Z=0,M=0,ne,G,z=0,fe=0,ue=Array.isArray(y.CellXf),oe,pe=[],V=[],ie=Array.isArray(h),q=[],ae={},B=!1,S=!!p.sheetStubs,R=f.split(n),P=0,W=R.length;P!=W;++P){w=R[P].trim();var H=w.length;if(H!==0){var ee=0;e:for(k=0;k<H;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(p&&p.cellStyles){if(C=pt(w.slice(ee,k),!0),Z=C.r!=null?parseInt(C.r,10):Z+1,M=-1,p.sheetRows&&p.sheetRows<Z)continue;ae={},B=!1,C.ht&&(B=!0,ae.hpt=parseFloat(C.ht),ae.hpx=El(ae.hpt)),C.hidden=="1"&&(B=!0,ae.hidden=!0),C.outlineLevel!=null&&(B=!0,ae.level=+C.outlineLevel),B&&(q[Z-1]=ae)}break;case"<":ee=k;break}if(ee>=k)break;if(C=pt(w.slice(ee,k),!0),Z=C.r!=null?parseInt(C.r,10):Z+1,M=-1,!(p.sheetRows&&p.sheetRows<Z)){x.s.r>Z-1&&(x.s.r=Z-1),x.e.r<Z-1&&(x.e.r=Z-1),p&&p.cellStyles&&(ae={},B=!1,C.ht&&(B=!0,ae.hpt=parseFloat(C.ht),ae.hpx=El(ae.hpt)),C.hidden=="1"&&(B=!0,ae.hidden=!0),C.outlineLevel!=null&&(B=!0,ae.level=+C.outlineLevel),B&&(q[Z-1]=ae)),_=w.slice(k).split(e);for(var se=0;se!=_.length&&_[se].trim().charAt(0)=="<";++se);for(_=_.slice(se),k=0;k!=_.length;++k)if(w=_[k].trim(),w.length!==0){if(E=w.match(t),A=k,T=0,L=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,E!=null&&E.length===2){for(A=0,J=E[1],T=0;T!=J.length&&!((L=J.charCodeAt(T)-64)<1||L>26);++T)A=26*A+L;--A,M=A}else++M;for(T=0;T!=w.length&&w.charCodeAt(T)!==62;++T);if(++T,C=pt(w.slice(0,T),!0),C.r||(C.r=xt({r:Z-1,c:M})),J=w.slice(T),O={t:""},(E=J.match(o))!=null&&E[1]!==""&&(O.v=Ft(E[1])),p.cellFormula){if((E=J.match(l))!=null&&E[1]!==""){if(O.f=Ft(Kt(E[1])).replace(/\r\n/g,`
`),p.xlfn||(O.f=Sg(O.f)),E[0].indexOf('t="array"')>-1)O.F=(J.match(a)||[])[1],O.F.indexOf(":")>-1&&pe.push([fr(O.F),O.F]);else if(E[0].indexOf('t="shared"')>-1){G=pt(E[0]);var Q=Ft(Kt(E[1]));p.xlfn||(Q=Sg(Q)),V[parseInt(G.si,10)]=[G,Q,C.r]}}else(E=J.match(/<f[^>]*\/>/))&&(G=pt(E[0]),V[G.si]&&(O.f=MT(V[G.si][1],V[G.si][2],C.r)));var he=ln(C.r);for(T=0;T<pe.length;++T)he.r>=pe[T][0].s.r&&he.r<=pe[T][0].e.r&&he.c>=pe[T][0].s.c&&he.c<=pe[T][0].e.c&&(O.F=pe[T][1])}if(C.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(S)O.t="z";else continue;else O.t=C.t||"n";switch(x.s.c>M&&(x.s.c=M),x.e.c<M&&(x.e.c=M),O.t){case"n":if(O.v==""||O.v==null){if(!S)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!S)continue;O.t="z"}else ne=hl[parseInt(O.v,10)],O.v=ne.t,O.r=ne.r,p.cellHTML&&(O.h=ne.h);break;case"str":O.t="s",O.v=O.v!=null?Kt(O.v):"",p.cellHTML&&(O.h=cp(O.v));break;case"inlineStr":E=J.match(r),O.t="s",E!=null&&(ne=yp(E[1]))?(O.v=ne.t,p.cellHTML&&(O.h=ne.h)):O.v="";break;case"b":O.v=tr(O.v);break;case"d":p.cellDates?O.v=Rr(O.v,1):(O.v=dn(Rr(O.v,1)),O.t="n");break;case"e":(!p||p.cellText!==!1)&&(O.w=O.v),O.v=F1[O.v];break}if(z=fe=0,oe=null,ue&&C.s!==void 0&&(oe=y.CellXf[C.s],oe!=null&&(oe.numFmtId!=null&&(z=oe.numFmtId),p.cellStyles&&oe.fillId!=null&&(fe=oe.fillId))),ly(O,z,fe,p,g,y),p.cellDates&&ue&&O.t=="n"&&di(yt[z])&&(O.t="d",O.v=Xu(O.v)),C.cm&&p.xlmeta){var me=(p.xlmeta.Cell||[])[+C.cm-1];me&&me.type=="XLDAPR"&&(O.D=!0)}if(ie){var I=ln(C.r);h[I.r]||(h[I.r]=[]),h[I.r][I.c]=O}else h[C.r]=O}}}}q.length>0&&(h["!rows"]=q)}})();function SD(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var TD=go;function CD(){}function DD(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=Q_(e),t}function ND(e){var n=$n(e);return[n]}function FD(e){var n=xo(e);return[n]}function AD(e){var n=$n(e),t=e.read_shift(1);return[n,t,"b"]}function OD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"b"]}function PD(e){var n=$n(e),t=e.read_shift(1);return[n,t,"e"]}function RD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"e"]}function MD(e){var n=$n(e),t=e.read_shift(4);return[n,t,"s"]}function ID(e){var n=xo(e),t=e.read_shift(4);return[n,t,"s"]}function jD(e){var n=$n(e),t=Xr(e);return[n,t,"n"]}function uy(e){var n=xo(e),t=Xr(e);return[n,t,"n"]}function LD(e){var n=$n(e),t=xp(e);return[n,t,"n"]}function zD(e){var n=xo(e),t=xp(e);return[n,t,"n"]}function BD(e){var n=$n(e),t=hp(e);return[n,t,"is"]}function WD(e){var n=$n(e),t=qr(e);return[n,t,"str"]}function UD(e){var n=xo(e),t=qr(e);return[n,t,"str"]}function HD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Gr(c,null,a,t.supbooks,t)}else e.l=r;return l}function $D(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Gr(c,null,a,t.supbooks,t)}else e.l=r;return l}function YD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=Xr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Gr(c,null,a,t.supbooks,t)}else e.l=r;return l}function VD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=qr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Gr(c,null,a,t.supbooks,t)}else e.l=r;return l}var KD=go;function GD(e,n){var t=e.l+n,r=go(e),a=mp(e),o=qr(e),l=qr(e),c=qr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function XD(){}function QD(e,n,t){var r=e.l+n,a=C1(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=tD(e,r-e.l,t);l[1]=c}else e.l=r;return l}function qD(e,n,t){var r=e.l+n,a=go(e),o=[a];if(t.cellFormula){var l=nD(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var ZD=["left","right","top","bottom","header","footer"];function JD(e){var n={};return ZD.forEach(function(t){n[t]=Xr(e)}),n}function e4(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function t4(){}function r4(){}function n4(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,g=!1,y,k,w,_,E,A,T,L,J,O=[];c.biff=12,c["!row"]=0;var C=0,Z=!1,M=[],ne={},G=c.supbooks||a.supbooks||[[]];if(G.sharedf=ne,G.arrayf=M,G.SheetNames=a.SheetNames||a.Sheets.map(function(ie){return ie.name}),!c.supbooks&&(c.supbooks=G,a.Names))for(var z=0;z<a.Names.length;++z)G[0][z+1]=a.Names[z];var fe=[],ue=[],oe=!1;Au[16]={n:"BrtShortReal",f:uy};var pe;if(Xa(e,function(q,ae,B){if(!g)switch(B){case 148:h=q;break;case 0:y=q,c.sheetRows&&c.sheetRows<=y.r&&(g=!0),L=Ur(_=y.r),c["!row"]=y.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=El(q.hpt)),ue[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:q[2]},q[2]){case"n":k.v=q[1];break;case"s":T=hl[q[1]],k.v=T.t,k.r=T.r;break;case"b":k.v=!!q[1];break;case"e":k.v=q[1],c.cellText!==!1&&(k.w=vo[k.v]);break;case"str":k.t="s",k.v=q[1];break;case"is":k.t="s",k.v=q[1].t;break}if((w=l.CellXf[q[0].iStyleRef])&&ly(k,w.numFmtId,null,c,o,l),E=q[0].c==-1?E+1:q[0].c,c.dense?(f[_]||(f[_]=[]),f[_][E]=k):f[Tr(E)+L]=k,c.cellFormula){for(Z=!1,C=0;C<M.length;++C){var S=M[C];y.r>=S[0].s.r&&y.r<=S[0].e.r&&E>=S[0].s.c&&E<=S[0].e.c&&(k.F=Tt(S[0]),Z=!0)}!Z&&q.length>3&&(k.f=q[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>E&&(p.s.c=E),p.e.r<y.r&&(p.e.r=y.r),p.e.c<E&&(p.e.c=E),c.cellDates&&w&&k.t=="n"&&di(yt[w.numFmtId])){var R=Qs(k.v);R&&(k.t="d",k.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}pe&&(pe.type=="XLDAPR"&&(k.D=!0),pe=void 0);break;case 1:case 12:if(!c.sheetStubs||x)break;k={t:"z",v:void 0},E=q[0].c==-1?E+1:q[0].c,c.dense?(f[_]||(f[_]=[]),f[_][E]=k):f[Tr(E)+L]=k,p.s.r>y.r&&(p.s.r=y.r),p.s.c>E&&(p.s.c=E),p.e.r<y.r&&(p.e.r=y.r),p.e.c<E&&(p.e.c=E),pe&&(pe.type=="XLDAPR"&&(k.D=!0),pe=void 0);break;case 176:O.push(q);break;case 49:pe=((c.xlmeta||{}).Cell||[])[q-1];break;case 494:var P=r["!id"][q.relId];for(P?(q.Target=P.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=P):q.relId==""&&(q.Target="#"+q.loc),_=q.rfx.s.r;_<=q.rfx.e.r;++_)for(E=q.rfx.s.c;E<=q.rfx.e.c;++E)c.dense?(f[_]||(f[_]=[]),f[_][E]||(f[_][E]={t:"z",v:void 0}),f[_][E].l=q):(A=xt({c:E,r:_}),f[A]||(f[A]={t:"z",v:void 0}),f[A].l=q);break;case 426:if(!c.cellFormula)break;M.push(q),J=c.dense?f[_][E]:f[Tr(E)+L],J.f=Gr(q[1],p,{r:y.r,c:E},G,c),J.F=Tt(q[0]);break;case 427:if(!c.cellFormula)break;ne[xt(q[0].s)]=q[1],J=c.dense?f[_][E]:f[Tr(E)+L],J.f=Gr(q[1],p,{r:y.r,c:E},G,c);break;case 60:if(!c.cellStyles)break;for(;q.e>=q.s;)fe[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},oe||(oe=!0,wp(q.w/256)),si(fe[q.e+1]);break;case 161:f["!autofilter"]={ref:Tt(q)};break;case 476:f["!margins"]=q;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),q.name&&(a.Sheets[t].CodeName=q.name),(q.above||q.left)&&(f["!outline"]={above:q.above,left:q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!ae.T){if(!x||c.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=Tt(h||p)),c.sheetRows&&f["!ref"]){var V=fr(f["!ref"]);c.sheetRows<=+V.e.r&&(V.e.r=c.sheetRows-1,V.e.r>p.e.r&&(V.e.r=p.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>p.e.c&&(V.e.c=p.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Tt(V))}return O.length>0&&(f["!merges"]=O),fe.length>0&&(f["!cols"]=fe),ue.length>0&&(f["!rows"]=ue),f}function a4(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=Ft((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function s4(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var g=a4(x);p.s.r=p.s.c=0,p.e.c=c,h=Tr(c),g[0].forEach(function(y,k){l[h+Ur(k)]={t:"n",v:y,z:g[1]},f=k}),p.e.r<f&&(p.e.r=f),++c}),c>0&&(l["!ref"]=Tt(p)),l}function o4(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(cy);return c&&_p(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function i4(e,n){e.l+=10;var t=qr(e);return{name:t}}function l4(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Xa(e,function(f,h,p){switch(p){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var fy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],c4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],u4=[],f4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Fg(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=tr(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Ag(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=tr(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function dy(e){Ag(e.WBProps,fy),Ag(e.CalcPr,f4),Fg(e.WBView,c4),Fg(e.Sheets,u4),Jo.date1904=tr(e.WBProps.date1904)}var d4="][*?/\\".split("");function p4(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return d4.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var h4=/<\w+:workbook/;function m4(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(Jr,function(f,h){var p=pt(f);switch(Ta(p[0])){case"<?xml":break;case"<workbook":f.match(h4)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fy.forEach(function(x){if(p[x[0]]!=null)switch(x[2]){case"bool":t.WBProps[x[0]]=tr(p[x[0]]);break;case"int":t.WBProps[x[0]]=parseInt(p[x[0]],10);break;default:t.WBProps[x[0]]=p[x[0]]}}),p.codeName&&(t.WBProps.CodeName=Kt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Ft(Kt(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=Kt(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),tr(p.hidden||"0")&&(o.Hidden=!0),l=h+f.length;break;case"</definedName>":o.Ref=Ft(Kt(e.slice(l,h))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),P_.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return dy(t),t}function x4(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Td(e),t.name=qr(e),t}function g4(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?qr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function v4(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function y4(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=q_(e),l=rD(e,0,t),c=mp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function w4(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Au[16]={n:"BrtFRTArchID$",f:v4},Xa(e,function(f,h,p){switch(p){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Gr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(p),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},n),dy(t),t.Names=o,t.supbooks=l,t}function k4(e,n,t){return n.slice(-4)===".bin"?w4(e,t):m4(e,t)}function _4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?n4(e,r,t,a,o,l,c):xD(e,r,t,a,o,l,c)}function b4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?l4(e,r,t,a,o):o4(e,r,t,a,o)}function E4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?OT():PT()}function S4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?FT():AT()}function T4(e,n,t,r){return n.slice(-4)===".bin"?KS(e,t,r):WS(e,t,r)}function C4(e,n,t){return Z1(e,t)}function D4(e,n,t){return n.slice(-4)===".bin"?cS(e,t):iS(e,t)}function N4(e,n,t){return n.slice(-4)===".bin"?CT(e,t):_T(e,t)}function F4(e,n,t){return n.slice(-4)===".bin"?yT(e):gT(e)}function A4(e,n,t,r){return t.slice(-4)===".bin"?wT(e,n,t,r):void 0}function O4(e,n,t){return n.slice(-4)===".bin"?mT(e,n,t):xT(e,n,t)}var py=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zn(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(py),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(hy),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function P4(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(py),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(hy),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var xl;function R4(e,n){var t=xl[e]||Ft(e);return t==="General"?oo(n):Un(t,n)}function M4(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=tr(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Rr(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Ft(n)]=a}function I4(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=R4(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=xl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&di(r)){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function j4(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=MS[r.Pattern]||r.Pattern)}e[n.ID]=n}function L4(e,n,t,r,a,o,l,c,f,h){var p="General",x=r.StyleID,g={};h=h||{};var y=[],k=0;for(x===void 0&&c&&(x=c.StyleID),x===void 0&&l&&(x=l.StyleID);o[x]!==void 0&&(o[x].nf&&(p=o[x].nf),o[x].Interior&&y.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=tr(e);break;case"String":r.t="s",r.r=Jx(Ft(e)),r.v=e.indexOf("<")>-1?Ft(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Rr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Ft(e):r.v<60&&(r.v=r.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=F1[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=Jx(n||e));break}if(I4(r,p,h),h.cellFormula!==!1)if(r.Formula){var w=Ft(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=Zo(w,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Zo("RC:RC",a):r.ArrayRange&&(r.F=Zo(r.ArrayRange,a),f.push([fr(r.F),r.F]))}else for(k=0;k<f.length;++k)a.r>=f[k][0].s.r&&a.r<=f[k][0].e.r&&a.c>=f[k][0].s.c&&a.c<=f[k][0].e.c&&(r.F=f[k][1]);h.cellStyles&&(y.forEach(function(_){!g.patternType&&_.patternType&&(g.patternType=_.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function z4(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sd(e,n){var t=n||{};r1();var r=rl(up(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Kt(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Wr(t);return l.type="string",_l.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Pe){a.indexOf("<"+Pe)>=0&&(o=!0)}),o)return G4(r,t);xl={"General Number":"General","General Date":yt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":yt[15],"Short Date":yt[14],"Long Time":yt[19],"Medium Time":yt[18],"Short Time":yt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:yt[2],Standard:yt[4],Percent:yt[10],Scientific:yt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],h,p={},x=[],g=t.dense?[]:{},y="",k={},w={},_=Zn('<Data ss:Type="String">'),E=0,A=0,T=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},J={},O={},C="",Z=0,M=[],ne={},G={},z=0,fe=[],ue=[],oe={},pe=[],V,ie=!1,q=[],ae=[],B={},S=0,R=0,P={Sheets:[],WBProps:{date1904:!1}},W={};kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var H="";c=kl.exec(r);)switch(c[3]=(H=c[3]).toLowerCase()){case"data":if(H=="data"){if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?L4(r.slice(E,c.index),C,_,f[f.length-1][0]=="comment"?oe:k,{c:A,r:T},J,pe[A],w,q,t):(C="",_=Zn(c[0]),E=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ue.length>0&&(k.c=ue),(!t.sheetRows||t.sheetRows>T)&&k.v!==void 0&&(t.dense?(g[T]||(g[T]=[]),g[T][A]=k):g[Tr(A)+Ur(T)]=k),k.HRef&&(k.l={Target:Ft(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(S=A+(parseInt(k.MergeAcross,10)|0),R=T+(parseInt(k.MergeDown,10)|0),M.push({s:{c:A,r:T},e:{c:S,r:R}})),!t.sheetStubs)k.MergeAcross?A=S+1:++A;else if(k.MergeAcross||k.MergeDown){for(var ee=A;ee<=S;++ee)for(var se=T;se<=R;++se)(ee>A||se>T)&&(t.dense?(g[se]||(g[se]=[]),g[se][ee]={t:"z"}):g[Tr(ee)+Ur(se)]={t:"z"});A=S+1}else++A;else k=P4(c[0]),k.Index&&(A=+k.Index-1),A<L.s.c&&(L.s.c=A),A>L.e.c&&(L.e.c=A),c[0].slice(-2)==="/>"&&++A,ue=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(T<L.s.r&&(L.s.r=T),T>L.e.r&&(L.e.r=T),c[0].slice(-2)==="/>"&&(w=Zn(c[0]),w.Index&&(T=+w.Index-1)),A=0,++T):(w=Zn(c[0]),w.Index&&(T=+w.Index-1),B={},(w.AutoFitHeight=="0"||w.Height)&&(B.hpx=parseInt(w.Height,10),B.hpt=q1(B.hpx),ae[T]=B),w.Hidden=="1"&&(B.hidden=!0,ae[T]=B));break;case"worksheet":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));x.push(y),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(g["!ref"]=Tt(L),t.sheetRows&&t.sheetRows<=L.e.r&&(g["!fullref"]=g["!ref"],L.e.r=t.sheetRows-1,g["!ref"]=Tt(L))),M.length&&(g["!merges"]=M),pe.length>0&&(g["!cols"]=pe),ae.length>0&&(g["!rows"]=ae),p[y]=g}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=A=0,f.push([c[3],!1]),h=Zn(c[0]),y=Ft(h.Name),g=t.dense?[]:{},M=[],q=[],ae=[],W={name:y,Hidden:0},P.Sheets.push(W);break;case"table":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),pe=[],ie=!1}break;case"style":c[1]==="/"?j4(J,O,t):O=Zn(c[0]);break;case"numberformat":O.nf=Ft(Zn(c[0]).Format||"General"),xl[O.nf]&&(O.nf=xl[O.nf]);for(var Q=0;Q!=392&&yt[Q]!=O.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(yt[Q]==null){eo(O.nf,Q);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(V=Zn(c[0]),V.Hidden&&(V.hidden=!0,delete V.Hidden),V.Width&&(V.wpx=parseInt(V.Width,10)),!ie&&V.wpx>10){ie=!0,sn=X1;for(var he=0;he<pe.length;++he)pe[he]&&si(pe[he])}ie&&si(V),pe[V.Index-1||pe.length]=V;for(var me=0;me<+V.Span;++me)pe[pe.length]=Wr(V);break;case"namedrange":if(c[1]==="/")break;P.Names||(P.Names=[]);var I=pt(c[0]),Ve={Name:I.Name,Ref:Zo(I.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Ve.Sheet=P.Sheets.length-1),P.Names.push(Ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?C+=r.slice(Z,c.index):Z=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;O.Interior=Zn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?_b(ne,H,r.slice(z,c.index)):z=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));z4(oe),ue.push(oe)}else f.push([c[3],!1]),h=Zn(c[0]),oe={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ce=Zn(c[0]);g["!autofilter"]={ref:Zo(Ce.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return jg(r,t);var ge=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ge=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ge=!1}break;case"excelworkbook":switch(c[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ge=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ge=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(z,c.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else z=c.index+c[0].length;break;case"header":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+pt(c[0]).Margin)||(g["!margins"].header=+pt(c[0]).Margin);break;case"footer":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+pt(c[0]).Margin)||(g["!margins"].footer=+pt(c[0]).Margin);break;case"pagemargins":var Ee=pt(c[0]);g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+Ee.Top)||(g["!margins"].top=+Ee.Top),isNaN(+Ee.Left)||(g["!margins"].left=+Ee.Left),isNaN(+Ee.Right)||(g["!margins"].right=+Ee.Right),isNaN(+Ee.Bottom)||(g["!margins"].bottom=+Ee.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ge=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ge=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ge=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ge=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ge=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ge=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ge=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ge=!1}break;case"smarttags":break;default:ge=!1;break}if(ge||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?M4(G,H,fe,r.slice(z,c.index)):(fe=c,z=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var ye={};return!t.bookSheets&&!t.bookProps&&(ye.Sheets=p),ye.SheetNames=x,ye.Workbook=P,ye.SSF=Wr(yt),ye.Props=ne,ye.Custprops=G,ye}function Fd(e,n){switch(Sp(n=n||{}),n.type||"base64"){case"base64":return sd(Cn(e),n);case"binary":case"buffer":case"file":return sd(e,n);case"array":return sd(mo(e),n)}}function B4(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=eb(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=tb(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var W4=[60,1084,2066,2165,2175];function U4(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=za(t,t.l),h=Ad[f],p=0;h!=null&&W4.indexOf(f)>-1;)o=za(t,t.l+2),p=t.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),c=t.slice(p,t.l+4+o),l.push(c),t.l+=4+o,h=Ad[f=za(t,t.l)];var x=ys(l);zr(x,0);var g=0;x.lens=[];for(var y=0;y<l.length;++y)x.lens.push(g),g+=l[y].length;if(x.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+r;return n.f(x,x.length,a)}function ha(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=yt[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=Un(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&di(yt[r]||String(r))){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function au(e,n,t){return{v:e,ixfe:n,t}}function H4(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],h="",p={},x,g="",y,k,w,_,E={},A=[],T,L,J=[],O=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Z={},M=function(it){return it<8?to[it]:it<64&&O[it-8]||to[it]},ne=function(it,bt,$t){var gt=bt.XF.data;if(!(!gt||!gt.patternType||!$t||!$t.cellStyles)){bt.s={},bt.s.patternType=gt.patternType;var re;(re=bl(M(gt.icvFore)))&&(bt.s.fgColor={rgb:re}),(re=bl(M(gt.icvBack)))&&(bt.s.bgColor={rgb:re})}},G=function(it,bt,$t){if(!(B>1)&&!($t.sheetRows&&it.r>=$t.sheetRows)){if($t.cellStyles&&bt.XF&&bt.XF.data&&ne(it,bt,$t),delete bt.ixfe,delete bt.XF,x=it,g=xt(it),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),it.r<l.s.r&&(l.s.r=it.r),it.c<l.s.c&&(l.s.c=it.c),it.r+1>l.e.r&&(l.e.r=it.r+1),it.c+1>l.e.c&&(l.e.c=it.c+1),$t.cellFormula&&bt.f){for(var gt=0;gt<A.length;++gt)if(!(A[gt][0].s.c>it.c||A[gt][0].s.r>it.r)&&!(A[gt][0].e.c<it.c||A[gt][0].e.r<it.r)){bt.F=Tt(A[gt][0]),(A[gt][0].s.c!=it.c||A[gt][0].s.r!=it.r)&&delete bt.f,bt.f&&(bt.f=""+Gr(A[gt][1],l,it,q,z));break}}$t.dense?(a[it.r]||(a[it.r]=[]),a[it.r][it.c]=bt):a[g]=bt}},z={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(z.password=n.password);var fe,ue=[],oe=[],pe=[],V=[],ie=!1,q=[];q.SheetNames=z.snames,q.sharedf=z.sharedf,q.arrayf=z.arrayf,q.names=[],q.XTI=[];var ae=0,B=0,S=0,R=[],P=[],W;z.codepage=1200,ta(1200);for(var H=!1;e.l<e.length-1;){var ee=e.l,se=e.read_shift(2);if(se===0&&ae===10)break;var Q=e.l===e.length?0:e.read_shift(2),he=Ad[se];if(he&&he.f){if(n.bookSheets&&ae===133&&se!==133)break;if(ae=se,he.r===2||he.r==12){var me=e.read_shift(2);if(Q-=2,!z.enc&&me!==se&&((me&255)<<8|me>>8)!==se)throw new Error("rt mismatch: "+me+"!="+se);he.r==12&&(e.l+=10,Q-=10)}var I={};if(se===10?I=he.f(e,Q,z):I=U4(se,he,e,Q,z),B==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(se){case 34:t.opts.Date1904=C.WBProps.date1904=I;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(z.enc||(e.l=0),z.enc=I,!n.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:z.lastuser=I;break;case 66:var Ve=Number(I);switch(Ve){case 21010:Ve=1200;break;case 32768:Ve=1e4;break;case 32769:Ve=1252;break}ta(z.codepage=Ve),H=!0;break;case 317:z.rrtabid=I;break;case 25:z.winlocked=I;break;case 439:t.opts.RefreshAll=I;break;case 12:t.opts.CalcCount=I;break;case 16:t.opts.CalcDelta=I;break;case 17:t.opts.CalcIter=I;break;case 13:t.opts.CalcMode=I;break;case 14:t.opts.CalcPrecision=I;break;case 95:t.opts.CalcSaveRecalc=I;break;case 15:z.CalcRefMode=I;break;case 2211:t.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:J.push(I);break;case 430:q.push([I]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(I);break;case 24:case 536:W={Name:I.Name,Ref:Gr(I.rgce,l,null,q,z)},I.itab>0&&(W.Sheet=I.itab-1),q.names.push(W),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(P[I.itab-1]={ref:Tt(I.rgce[0][0][1][2])});break;case 22:z.ExternCount=I;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(I),q.XTI=q.XTI.concat(I);break;case 2196:if(z.biff<8)break;W!=null&&(W.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&z.WTF&&console.error("Password verifier: "+I);break;case 133:o[I.pos]=I,z.snames.push(I.name);break;case 10:{if(--B)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Tt(l),n.sheetRows&&n.sheetRows<=l.e.r){var Ce=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Tt(l),l.e.r=Ce}l.e.r++,l.e.c++}ue.length>0&&(a["!merges"]=ue),oe.length>0&&(a["!objects"]=oe),pe.length>0&&(a["!cols"]=pe),V.length>0&&(a["!rows"]=V),C.Sheets.push(Z)}h===""?p=a:r[h]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(z.biff===8&&(z.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),z.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(z.biff=5,H=!0,ta(z.codepage=28591)),z.biff==8&&I.BIFFVer==0&&I.dt==16&&(z.biff=2),B++)break;if(a=n.dense?[]:{},z.biff<8&&!H&&(H=!0,ta(z.codepage=n.codepage||1252)),z.biff<5||I.BIFFVer==0&&I.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ge={pos:e.l-Q,name:h};o[ge.pos]=ge,z.snames.push(h)}else h=(o[ee]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),ue=[],oe=[],z.arrayf=A=[],pe=[],V=[],ie=!1,Z={Hidden:(o[ee]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[I.r]||[])[I.c]:a[xt({c:I.c,r:I.r})])&&++I.c,T={ixfe:I.ixfe,XF:J[I.ixfe]||{},v:I.val,t:"n"},S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:I.c,r:I.r},T,n);break;case 5:case 517:T={ixfe:I.ixfe,XF:J[I.ixfe],v:I.val,t:I.t},S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:I.c,r:I.r},T,n);break;case 638:T={ixfe:I.ixfe,XF:J[I.ixfe],v:I.rknum,t:"n"},S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:I.c,r:I.r},T,n);break;case 189:for(var Ee=I.c;Ee<=I.C;++Ee){var ye=I.rkrec[Ee-I.c][0];T={ixfe:ye,XF:J[ye],v:I.rkrec[Ee-I.c][1],t:"n"},S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:Ee,r:I.r},T,n)}break;case 6:case 518:case 1030:{if(I.val=="String"){c=I;break}if(T=au(I.val,I.cell.ixfe,I.tt),T.XF=J[T.ixfe],n.cellFormula){var Pe=I.formula;if(Pe&&Pe[0]&&Pe[0][0]&&Pe[0][0][0]=="PtgExp"){var Ze=Pe[0][0][1][0],Xe=Pe[0][0][1][1],wt=xt({r:Ze,c:Xe});E[wt]?T.f=""+Gr(I.formula,l,I.cell,q,z):T.F=((n.dense?(a[Ze]||[])[Xe]:a[wt])||{}).F}else T.f=""+Gr(I.formula,l,I.cell,q,z)}S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G(I.cell,T,n),c=I}break;case 7:case 519:if(c)c.val=I,T=au(I,c.cell.ixfe,"s"),T.XF=J[T.ixfe],n.cellFormula&&(T.f=""+Gr(c.formula,l,c.cell,q,z)),S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G(c.cell,T,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(I);var qt=xt(I[0].s);if(y=n.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[qt],n.cellFormula&&y){if(!c||!qt||!y)break;y.f=""+Gr(I[1],l,I[0],q,z),y.F=Tt(I[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;E[xt(c.cell)]=I[0],y=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[xt(c.cell)],(y||{}).f=""+Gr(I[0],l,x,q,z)}}break;case 253:T=au(f[I.isst].t,I.ixfe,"s"),f[I.isst].h&&(T.h=f[I.isst].h),T.XF=J[T.ixfe],S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:I.c,r:I.r},T,n);break;case 513:n.sheetStubs&&(T={ixfe:I.ixfe,XF:J[I.ixfe],t:"z"},S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:I.c,r:I.r},T,n));break;case 190:if(n.sheetStubs)for(var Pt=I.c;Pt<=I.C;++Pt){var Mt=I.ixfe[Pt-I.c];T={ixfe:Mt,XF:J[Mt],t:"z"},S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:Pt,r:I.r},T,n)}break;case 214:case 516:case 4:T=au(I.val,I.ixfe,"s"),T.XF=J[T.ixfe],S>0&&(T.z=R[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),G({c:I.c,r:I.r},T,n);break;case 0:case 512:B===1&&(l=I);break;case 252:f=I;break;case 1054:if(z.biff==4){R[S++]=I[1];for(var ir=0;ir<S+163&&yt[ir]!=I[1];++ir);ir>=163&&eo(I[1],S+163)}else eo(I[1],I[0]);break;case 30:{R[S++]=I;for(var Zt=0;Zt<S+163&&yt[Zt]!=I;++Zt);Zt>=163&&eo(I,S+163)}break;case 229:ue=ue.concat(I);break;case 93:oe[I.cmo[0]]=z.lastobj=I;break;case 438:z.lastobj.TxO=I;break;case 127:z.lastobj.ImData=I;break;case 440:for(_=I[0].s.r;_<=I[0].e.r;++_)for(w=I[0].s.c;w<=I[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[xt({c:w,r:_})],y&&(y.l=I[1]);break;case 2048:for(_=I[0].s.r;_<=I[0].e.r;++_)for(w=I[0].s.c;w<=I[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[xt({c:w,r:_})],y&&y.l&&(y.l.Tooltip=I[1]);break;case 28:{if(z.biff<=5&&z.biff>=2)break;y=n.dense?(a[I[0].r]||[])[I[0].c]:a[xt(I[0])];var lr=oe[I[2]];y||(n.dense?(a[I[0].r]||(a[I[0].r]=[]),y=a[I[0].r][I[0].c]={t:"z"}):y=a[xt(I[0])]={t:"z"},l.e.r=Math.max(l.e.r,I[0].r),l.s.r=Math.min(l.s.r,I[0].r),l.e.c=Math.max(l.e.c,I[0].c),l.s.c=Math.min(l.s.c,I[0].c)),y.c||(y.c=[]),k={a:I[1],t:lr.TxO.t},y.c.push(k)}break;case 2173:fT(J[I.ixfe],I.ext);break;case 125:{if(!z.cellStyles)break;for(;I.e>=I.s;)pe[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},ie||(ie=!0,wp(I.w/256)),si(pe[I.e+1])}break;case 520:{var It={};I.level!=null&&(V[I.r]=It,It.level=I.level),I.hidden&&(V[I.r]=It,It.hidden=!0),I.hpt&&(V[I.r]=It,It.hpt=I.hpt,It.hpx=El(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ml(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=I;break;case 161:a["!margins"]||ml(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(C.Views[0].RTL=!0);break;case 146:O=I;break;case 2198:fe=I;break;case 140:L=I;break;case 442:h?Z.CodeName=I||Z.name:C.WBProps.CodeName=I||"ThisWorkbook";break}}else he||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=Q}return t.SheetNames=Ea(o).sort(function(Gt,it){return Number(Gt)-Number(it)}).map(function(Gt){return o[Gt].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&P.forEach(function(Gt,it){t.Sheets[t.SheetNames[it]]["!autofilter"]=Gt}),t.Strings=f,t.SSF=Wr(yt),z.enc&&(t.Encryption=z.enc),fe&&(t.Themes=fe),t.Metadata={},L!==void 0&&(t.Metadata.Country=L),q.names.length>0&&(C.Names=q.names),t.Workbook=C,t}var Og={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $4(e,n,t){var r=St.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=mg(r,ib,Og.DSI);for(var o in a)n[o]=a[o]}catch(h){if(t.WTF)throw h}var l=St.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=mg(l,lb,Og.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(h){if(t.WTF)throw h}n.HeadingPairs&&n.TitlesOfParts&&(O1(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function my(e,n){n||(n={}),Sp(n),$v(),n.codepage&&np(n.codepage);var t,r;if(e.FullPaths){if(St.find(e,"/encryption"))throw new Error("File is password-protected");t=St.find(e,"!CompObj"),r=St.find(e,"/Workbook")||St.find(e,"/Book")}else{switch(n.type){case"base64":e=ea(Cn(e));break;case"binary":e=ea(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}zr(e,0),r={content:e}}var a,o;if(t&&B4(t),n.bookProps&&!n.bookSheets)a={};else{var l=Et?"buffer":"array";if(r&&r.content)a=H4(r.content,n);else if((o=St.find(e,"PerfectOffice_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else if((o=St.find(e,"NativeContent_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else throw(o=St.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&St.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=NT(e))}var c={};return e.FullPaths&&$4(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Au={0:{f:SD},1:{f:ND},2:{f:LD},3:{f:PD},4:{f:AD},5:{f:jD},6:{f:WD},7:{f:MD},8:{f:VD},9:{f:YD},10:{f:HD},11:{f:$D},12:{f:FD},13:{f:zD},14:{f:RD},15:{f:OD},16:{f:uy},17:{f:UD},18:{f:ID},19:{f:hp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:y4},40:{},42:{},43:{f:HS},44:{f:US},45:{f:$S},46:{f:VS},47:{f:YS},48:{},49:{f:K_},50:{},51:{f:pT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$1},62:{f:BD},63:{f:vT},64:{f:t4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:e4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DD},148:{f:TD,p:16},151:{f:XD},152:{},153:{f:g4},154:{},155:{},156:{f:x4},157:{},158:{},159:{T:1,f:lS},160:{T:-1},161:{T:1,f:go},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dT},336:{T:-1},337:{f:hT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Td},357:{},358:{},359:{},360:{T:1},361:{},362:{f:H1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QD},427:{f:qD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:GD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Td},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:TT},633:{T:1},634:{T:-1},635:{T:1,f:ST},636:{T:-1},637:{f:X_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:i4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:r4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ad={6:{f:nd},10:{f:gs},12:{f:_r},13:{f:_r},14:{f:xr},15:{f:xr},16:{f:Xr},17:{f:xr},18:{f:xr},19:{f:_r},20:{f:yg},21:{f:yg},23:{f:H1},24:{f:kg},25:{f:xr},26:{},27:{},28:{f:bE},29:{},34:{f:xr},35:{f:wg},38:{f:Xr},39:{f:Xr},40:{f:Xr},41:{f:Xr},42:{f:xr},43:{f:xr},47:{f:CS},49:{f:aE},51:{f:_r},60:{},61:{f:tE},64:{f:xr},65:{f:nE},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:Kb},93:{f:SE},94:{},95:{f:xr},96:{},97:{},99:{f:xr},125:{f:$1},128:{f:hE},129:{f:Gb},130:{f:_r},131:{f:xr},132:{f:xr},133:{f:Xb},134:{},140:{f:AE},141:{f:_r},144:{},146:{f:PE},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:LE},161:{f:ME},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uE},190:{f:fE},193:{f:gs},197:{},198:{},199:{},200:{},201:{},202:{f:xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:xr},222:{},224:{f:pE},225:{f:Vb},226:{f:gs},227:{},229:{f:EE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Qb},253:{f:sE},255:{f:qb},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:j1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xr},353:{f:gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xE},431:{f:xr},432:{},433:{},434:{},437:{},438:{f:DE},439:{f:xr},440:{f:NE},441:{},442:{f:Ol},443:{},444:{f:_r},445:{},446:{},448:{f:gs},449:{f:eE,r:2},450:{f:gs},512:{f:gg},513:{f:jE},515:{f:mE},516:{f:oE},517:{f:vg},519:{f:zE},520:{f:Zb},523:{},545:{f:_g},549:{f:xg},566:{},574:{f:rE},638:{f:cE},659:{},1048:{},1054:{f:iE},1084:{},1212:{f:wE},2048:{f:FE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:RE,r:12},2173:{f:uT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yE,r:12},2197:{},2198:{f:aT,r:12},2199:{},2200:{},2201:{},2202:{f:kE,r:12},2203:{f:gs},2204:{},2205:{},2206:{},2207:{},2211:{f:Jb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gg},1:{},2:{f:HE},3:{f:UE},4:{f:WE},5:{f:vg},7:{f:$E},8:{},9:{f:tu},11:{},22:{f:_r},30:{f:lE},31:{},32:{},33:{f:_g},36:{},37:{f:xg},50:{f:YE},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:BE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:VE},223:{},234:{},354:{},421:{},518:{f:nd},521:{f:tu},536:{f:kg},547:{f:wg},561:{},579:{},1030:{f:nd},1033:{f:tu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Jn(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&E1(t)&&e.push(t)}}function Pg(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=m_(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,x=0,g=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<f.length;++l){var w=f[l].trim(),_=w.slice(0,3).toLowerCase();if(_=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(_!="<td"&&_!="<th")){var E=w.split(/<\/t[dh]>/i);for(c=0;c<E.length;++c){var A=E[c].trim();if(A.match(/<t[dh]/i)){for(var T=A,L=0;T.charAt(0)=="<"&&(L=T.indexOf(">"))>-1;)T=T.slice(L+1);for(var J=0;J<k.length;++J){var O=k[J];O.s.c==p&&O.s.r<h&&h<=O.e.r&&(p=O.e.c+1,J=-1)}var C=pt(A.slice(0,A.indexOf(">")));g=C.colspan?+C.colspan:1,((x=+C.rowspan)>1||g>1)&&k.push({s:{r:h,c:p},e:{r:h+(x||1)-1,c:p+g-1}});var Z=C.t||C["data-t"]||"";if(!T.length){p+=g;continue}if(T=f1(T),y.s.r>h&&(y.s.r=h),y.e.r<h&&(y.e.r=h),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!T.length){p+=g;continue}var M={t:"s",v:T};t.raw||!T.trim().length||Z=="s"||(T==="TRUE"?M={t:"b",v:!0}:T==="FALSE"?M={t:"b",v:!1}:isNaN(na(T))?isNaN(ai(T).getDate())||(M={t:"d",v:Rr(T)},t.cellDates||(M={t:"n",v:dn(M.v)}),M.z=t.dateNF||yt[14]):M={t:"n",v:na(T)}),t.dense?(r[h]||(r[h]=[]),r[h][p]=M):r[xt({r:h,c:p})]=M,p+=g}}}}return r["!ref"]=Tt(y),k.length&&(r["!merges"]=k),r}function Y4(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>l)&&!(a[h].e.r<t||a[h].e.c<l)){if(a[h].s.r<t||a[h].s.c<l){c=-1;break}c=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(c<0)){var p=xt({r:t,c:l}),x=r.dense?(e[t]||[])[l]:e[p],g=x&&x.v!=null&&(x.h||cp(x.w||(Ka(x),x.w)||""))||"",y={};c>1&&(y.rowspan=c),f>1&&(y.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":x&&(y["data-t"]=x&&x.t||"z",x.v!=null&&(y["data-v"]=x.v),x.z!=null&&(y["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+x.l.Target+'">'+g+"</a>")),y.id=(r.id||"sjs")+"-"+p,o.push(A_("td",g,y))}}var k="<tr>";return k+o.join("")+"</tr>"}var V4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',K4="</body></html>";function G4(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Os(Pg(t[0],n),n);var r=Cp();return t.forEach(function(a,o){Dp(r,Pg(a,n),"Sheet"+(o+1))}),r}function X4(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Q4(e,n){var t=n||{},r=t.header!=null?t.header:V4,a=t.footer!=null?t.footer:K4,o=[r],l=pi(e["!ref"]);t.dense=Array.isArray(e),o.push(X4(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(Y4(e,l,c,t));return o.push("</table>"+a),o.join("")}function xy(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var p=pi(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),a==-1&&(h.e.r=a=p.e.r+1)}var x=[],g=0,y=e["!rows"]||(e["!rows"]=[]),k=0,w=0,_=0,E=0,A=0,T=0;for(e["!cols"]||(e["!cols"]=[]);k<c.length&&w<f;++k){var L=c[k];if(Rg(L)){if(r.display)continue;y[w]={hidden:!0}}var J=L.children;for(_=E=0;_<J.length;++_){var O=J[_];if(!(r.display&&Rg(O))){var C=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):f1(O.innerHTML),Z=O.getAttribute("data-z")||O.getAttribute("z");for(g=0;g<x.length;++g){var M=x[g];M.s.c==E+o&&M.s.r<w+a&&w+a<=M.e.r&&(E=M.e.c+1-o,g=-1)}T=+O.getAttribute("colspan")||1,((A=+O.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:w+a,c:E+o},e:{r:w+a+(A||1)-1,c:E+o+(T||1)-1}});var ne={t:"s",v:C},G=O.getAttribute("data-t")||O.getAttribute("t")||"";C!=null&&(C.length==0?ne.t=G||"z":r.raw||C.trim().length==0||G=="s"||(C==="TRUE"?ne={t:"b",v:!0}:C==="FALSE"?ne={t:"b",v:!1}:isNaN(na(C))?isNaN(ai(C).getDate())||(ne={t:"d",v:Rr(C)},r.cellDates||(ne={t:"n",v:dn(ne.v)}),ne.z=r.dateNF||yt[14]):ne={t:"n",v:na(C)})),ne.z===void 0&&Z!=null&&(ne.z=Z);var z="",fe=O.getElementsByTagName("A");if(fe&&fe.length)for(var ue=0;ue<fe.length&&!(fe[ue].hasAttribute("href")&&(z=fe[ue].getAttribute("href"),z.charAt(0)!="#"));++ue);z&&z.charAt(0)!="#"&&(ne.l={Target:z}),r.dense?(e[w+a]||(e[w+a]=[]),e[w+a][E+o]=ne):e[xt({c:E+o,r:w+a})]=ne,h.e.c<E+o&&(h.e.c=E+o),E+=T}}++w}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,w-1+a),e["!ref"]=Tt(h),w>=f&&(e["!fullref"]=Tt((h.e.r=c.length-k+w-1+a,h))),e}function gy(e,n){var t=n||{},r=t.dense?[]:{};return xy(r,e,n)}function q4(e,n){return Os(gy(e,n),n)}function Rg(e){var n="",t=Z4(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function Z4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function J4(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Ft(n.replace(/<[^>]*>/g,""));return[t]}var Mg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vy(e,n){var t=n||{},r=up(e),a=[],o,l,c={name:""},f="",h=0,p,x,g={},y=[],k=t.dense?[]:{},w,_,E={value:""},A="",T=0,L=[],J=-1,O=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},Z=0,M={},ne=[],G={},z=0,fe=0,ue=[],oe=1,pe=1,V=[],ie={Names:[]},q={},ae=["",""],B=[],S={},R="",P=0,W=!1,H=!1,ee=0;for(kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=kl.exec(r);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?k["!ref"]=Tt(C):k["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=C.e.r&&(k["!fullref"]=k["!ref"],C.e.r=t.sheetRows-1,k["!ref"]=Tt(C)),ne.length&&(k["!merges"]=ne),ue.length&&(k["!rows"]=ue),p.name=p.名称||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),g[p.name]=k,H=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=pt(w[0],!1),J=O=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,k=t.dense?[]:{},ne=[],ue=[],H=!0);break;case"table-row-group":w[1]==="/"?--Z:++Z;break;case"table-row":case"行":if(w[1]==="/"){J+=oe,oe=1;break}if(x=pt(w[0],!1),x.行号?J=x.行号-1:J==-1&&(J=0),oe=+x["number-rows-repeated"]||1,oe<10)for(ee=0;ee<oe;++ee)Z>0&&(ue[J+ee]={level:Z});O=-1;break;case"covered-table-cell":w[1]!=="/"&&++O,t.sheetStubs&&(t.dense?(k[J]||(k[J]=[]),k[J][O]={t:"z"}):k[xt({r:J,c:O})]={t:"z"}),A="",L=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++O,E=pt(w[0],!1),pe=parseInt(E["number-columns-repeated"]||"1",10),_={t:"z",v:null},E.formula&&t.cellFormula!=!1&&(_.f=Ng(Ft(E.formula))),(E.数据类型||E["value-type"])=="string"&&(_.t="s",_.v=Ft(E["string-value"]||""),t.dense?(k[J]||(k[J]=[]),k[J][O]=_):k[xt({r:J,c:O})]=_),O+=pe-1;else if(w[1]!=="/"){++O,A="",T=0,L=[],pe=1;var se=oe?J+oe-1:J;if(O>C.e.c&&(C.e.c=O),O<C.s.c&&(C.s.c=O),J<C.s.r&&(C.s.r=J),se>C.e.r&&(C.e.r=se),E=pt(w[0],!1),B=[],S={},_={t:E.数据类型||E["value-type"],v:null},t.cellFormula)if(E.formula&&(E.formula=Ft(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(z=parseInt(E["number-matrix-rows-spanned"],10)||0,fe=parseInt(E["number-matrix-columns-spanned"],10)||0,G={s:{r:J,c:O},e:{r:J+z-1,c:O+fe-1}},_.F=Tt(G),V.push([G,_.F])),E.formula)_.f=Ng(E.formula);else for(ee=0;ee<V.length;++ee)J>=V[ee][0].s.r&&J<=V[ee][0].e.r&&O>=V[ee][0].s.c&&O<=V[ee][0].e.c&&(_.F=V[ee][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(z=parseInt(E["number-rows-spanned"],10)||0,fe=parseInt(E["number-columns-spanned"],10)||0,G={s:{r:J,c:O},e:{r:J+z-1,c:O+fe-1}},ne.push(G)),E["number-columns-repeated"]&&(pe=parseInt(E["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=tr(E["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(E.value);break;case"percentage":_.t="n",_.v=parseFloat(E.value);break;case"currency":_.t="n",_.v=parseFloat(E.value);break;case"date":_.t="d",_.v=Rr(E["date-value"]),t.cellDates||(_.t="n",_.v=dn(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=d_(E["time-value"])/86400,t.cellDates&&(_.t="d",_.v=Xu(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(E.数据数值);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",E["string-value"]!=null&&(A=Ft(E["string-value"]),L=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(W=!1,_.t==="s"&&(_.v=A||"",L.length&&(_.R=L),W=T==0),q.Target&&(_.l=q),B.length>0&&(_.c=B,B=[]),A&&t.cellText!==!1&&(_.w=A),W&&(_.t="z",delete _.v),(!W||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=J))for(var Q=0;Q<oe;++Q){if(pe=parseInt(E["number-columns-repeated"]||"1",10),t.dense)for(k[J+Q]||(k[J+Q]=[]),k[J+Q][O]=Q==0?_:Wr(_);--pe>0;)k[J+Q][O+pe]=Wr(_);else for(k[xt({r:J+Q,c:O})]=_;--pe>0;)k[xt({r:J+Q,c:O+pe})]=Wr(_);C.e.c<=O&&(C.e.c=O)}pe=parseInt(E["number-columns-repeated"]||"1",10),O+=pe-1,pe=0,_={},A="",L=[]}q={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o;S.t=A,L.length&&(S.R=L),S.a=R,B.push(S)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);R="",P=0,A="",T=0,L=[];break;case"creator":w[1]==="/"?R=r.slice(P,w.index):P=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);A="",T=0,L=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(M[c.name]=f,(o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",c=pt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=pt(w[0],!1),f+=Mg[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=pt(w[0],!1),f+=Mg[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(h,w.index);break}else h=w.index+w[0].length;break;case"named-range":l=pt(w[0],!1),ae=ad(l["cell-range-address"]);var he={Name:l.name,Ref:ae[0]+"!"+ae[1]};H&&(he.Sheet=y.length),ie.Names.push(he);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!E||!E["string-value"])){var me=J4(r.slice(T,w.index));A=(A.length>0?A+`
`:"")+me[0]}else pt(w[0],!1),T=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ae=ad(pt(w[0])["target-range-address"]),g[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(q=pt(w[0],!1),!q.href)break;q.Target=Ft(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(ae=ad(q.Target.slice(1)),q.Target="#"+ae[0]+"!"+ae[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(w)}}var I={Sheets:g,SheetNames:y,Workbook:ie};return t.bookSheets&&delete I.Sheets,I}function Ig(e,n){n=n||{},Ln(e,"META-INF/manifest.xml")&&mb(kr(e,"META-INF/manifest.xml"),n);var t=Sn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=vy(Kt(t),n);return Ln(e,"meta.xml")&&(r.Props=A1(kr(e,"meta.xml"))),r}function jg(e,n){return vy(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Od(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Kt(mo(e))}function Pd(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function Lg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function eN(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Sl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Cr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function Qr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Sl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Sl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:c,type:o};n[a]==null?n[a]=[h]:n[a].push(h)}return n}function Ep(e,n){return e?.map(function(t){return n(t.data)})||[]}function tN(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Sl(e,r),o=Qr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Cr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=Qr(c.data),h=Cr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(n=o[3])!=null&&n[0]&&(l.merge=Cr(o[3][0].data)>>>0>0),t.push(l)}return t}function rN(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Sl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,h=0;if(o==1?(h=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(h=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Pd(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var p=Pd(a);if(p.length!=r)throw new Error("Unexpected length: ".concat(p.length," != ").concat(r));return p}function nN(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(rN(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Pd(n)}function aN(e,n,t,r){var a=bp(e),o=a.getUint32(4,!0),l=(r>1?12:8)+Lg(o&(r>1?3470:398))*4,c=-1,f=-1,h=NaN,p=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=Lg(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(h=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:n[f]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:t[c]};else if(f>-1)x={t:"s",v:n[f]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function sN(e,n,t){var r=bp(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,h=NaN,p=new Date(2001,0,1);a&1&&(f=eN(e,o),o+=16),a&2&&(h=r.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:n[c]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return x}function oN(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return aN(e,n,t,e[0]);case 5:return sN(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Es(e){var n=Qr(e);return Sl(n[1][0].data)}function zg(e,n){var t=Qr(n.data),r=Cr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=Qr(l.data),f=Cr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Od(c[3][0].data);break;case 8:{var h=e[Es(c[9][0].data)][0],p=Qr(h.data),x=e[Es(p[1][0].data)][0],g=Cr(x.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var y=Qr(x.data);o[f]=y[3].map(function(k){return Od(k.data)}).join("")}break}}),o}function iN(e,n){var t,r,a,o,l,c,f,h,p,x,g,y,k,w,_=Qr(e),E=Cr(_[1][0].data)>>>0,A=Cr(_[2][0].data)>>>0,T=((r=(t=_[8])==null?void 0:t[0])==null?void 0:r.data)&&Cr(_[8][0].data)>0||!1,L,J;if((o=(a=_[7])==null?void 0:a[0])!=null&&o.data&&n!=0)L=(c=(l=_[7])==null?void 0:l[0])==null?void 0:c.data,J=(h=(f=_[6])==null?void 0:f[0])==null?void 0:h.data;else if((x=(p=_[4])==null?void 0:p[0])!=null&&x.data&&n!=1)L=(y=(g=_[4])==null?void 0:g[0])==null?void 0:y.data,J=(w=(k=_[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var O=T?4:1,C=bp(L),Z=[],M=0;M<L.length/2;++M){var ne=C.getUint16(M*2,!0);ne<65535&&Z.push([M,ne])}if(Z.length!=A)throw"Expected ".concat(A," cells, found ").concat(Z.length);var G=[];for(M=0;M<Z.length-1;++M)G[Z[M][0]]=J.subarray(Z[M][1]*O,Z[M+1][1]*O);return Z.length>=1&&(G[Z[Z.length-1][0]]=J.subarray(Z[Z.length-1][1]*O)),{R:E,cells:G}}function lN(e,n){var t,r=Qr(n.data),a=(t=r?.[7])!=null&&t[0]?Cr(r[7][0].data)>>>0>0?1:0:-1,o=Ep(r[5],function(l){return iN(l,a)});return{nrows:Cr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,h){if(l[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));l[c.R][h]=f}),l},[])}}function cN(e,n,t){var r,a=Qr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Cr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Cr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Tt(o);var l=Qr(a[4][0].data),c=zg(e,e[Es(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?zg(e,e[Es(l[17][0].data)][0]):[],h=Qr(l[3][0].data),p=0;h[1].forEach(function(x){var g=Qr(x.data),y=e[Es(g[2][0].data)][0],k=Cr(y.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=lN(e,y);w.data.forEach(function(_,E){_.forEach(function(A,T){var L=xt({r:p+E,c:T}),J=oN(A,c,f);J&&(t[L]=J)})}),p+=w.nrows})}function uN(e,n){var t=Qr(n.data),r={"!ref":"A1"},a=e[Es(t[2][0].data)],o=Cr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return cN(e,a[0],r),r}function fN(e,n){var t,r=Qr(n.data),a={name:(t=r[1])!=null&&t[0]?Od(r[1][0].data):"",sheets:[]},o=Ep(r[2],Es);return o.forEach(function(l){e[l].forEach(function(c){var f=Cr(c.meta[1][0].data);f==6e3&&a.sheets.push(uN(e,c))})}),a}function dN(e,n){var t=Cp(),r=Qr(n.data),a=Ep(r[1],Es);if(a.forEach(function(o){e[o].forEach(function(l){var c=Cr(l.meta[1][0].data);if(c==2){var f=fN(e,l);f.sheets.forEach(function(h,p){Dp(t,h,p==0?f.name:f.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function od(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=nN(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var p;try{p=tN(h)}catch(x){return console.log("## "+(x.message||x))}p.forEach(function(x){o[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Cr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(h){var p=Cr(h.meta[1][0].data)>>>0;if(p==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return dN(o,c)}function pN(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Sp(e){pN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function hN(e){return Qo.WS.indexOf(e)>-1?"sheet":e==Qo.CS?"chart":e==Qo.DS?"dialog":e==Qo.MS?"macro":e&&e.length?e:"sheet"}function mN(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,hN(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function xN(e,n,t,r,a,o,l,c,f,h,p,x){try{o[r]=fl(Sn(e,t,!0),n);var g=kr(e,n),y;switch(c){case"sheet":y=_4(g,n,a,f,o[r],h,p,x);break;case"chart":if(y=b4(g,n,a,f,o[r],h,p,x),!y||!y["!drawel"])break;var k=al(y["!drawel"].Target,n),w=Cd(k),_=kT(Sn(e,k,!0),fl(Sn(e,w,!0),k)),E=al(_,k),A=Cd(E);y=s4(Sn(e,E,!0),E,f,fl(Sn(e,A,!0),E),h,y);break;case"macro":y=E4(g,n,a,f,o[r],h,p,x);break;case"dialog":y=S4(g,n,a,f,o[r],h,p,x);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=y;var T=[];o&&o[r]&&Ea(o[r]).forEach(function(L){var J="";if(o[r][L].Type==Qo.CMNT){J=al(o[r][L].Target,n);var O=N4(kr(e,J,!0),J,f);if(!O||!O.length)return;Eg(y,O,!1)}o[r][L].Type==Qo.TCMNT&&(J=al(o[r][L].Target,n),T=T.concat(bT(kr(e,J,!0),f)))}),T&&T.length&&Eg(y,T,!0,f.people||[])}catch(L){if(f.WTF)throw L}}function Mn(e){return e.charAt(0)=="/"?e.slice(1):e}function gN(e,n){if(r1(),n=n||{},Sp(n),Ln(e,"META-INF/manifest.xml")||Ln(e,"objectdata.xml"))return Ig(e,n);if(Ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof od<"u"){if(e.FileIndex)return od(e);var t=St.utils.cfb_new();return qx(e).forEach(function(ue){v_(t,ue,g_(e,ue))}),od(t)}throw new Error("Unsupported NUMBERS file")}if(!Ln(e,"[Content_Types].xml"))throw Ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=qx(e),a=pb(Sn(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",kr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!kr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},h={};if(!n.bookSheets&&!n.bookProps){if(hl=[],a.sst)try{hl=D4(kr(e,Mn(a.sst)),a.sst,n)}catch(ue){if(n.WTF)throw ue}n.cellStyles&&a.themes.length&&(f=C4(Sn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(h=T4(kr(e,Mn(a.style)),a.style,f,n))}a.links.map(function(ue){try{var oe=fl(Sn(e,Cd(Mn(ue))),ue);return A4(kr(e,Mn(ue)),oe,ue,n)}catch{}});var p=k4(kr(e,Mn(a.workbooks[0])),a.workbooks[0],n),x={},g="";a.coreprops.length&&(g=kr(e,Mn(a.coreprops[0]),!0),g&&(x=A1(g)),a.extprops.length!==0&&(g=kr(e,Mn(a.extprops[0]),!0),g&&vb(g,x,n)));var y={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=Sn(e,Mn(a.custprops[0]),!0),g&&(y=wb(g,n)));var k={};if((n.bookSheets||n.bookProps)&&(p.Sheets?l=p.Sheets.map(function(oe){return oe.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),n.bookProps&&(k.Props=x,k.Custprops=y),n.bookSheets&&typeof l<"u"&&(k.SheetNames=l),n.bookSheets?k.SheetNames:n.bookProps))return k;l={};var w={};n.bookDeps&&a.calcchain&&(w=F4(kr(e,Mn(a.calcchain)),a.calcchain));var _=0,E={},A,T;{var L=p.Sheets;x.Worksheets=L.length,x.SheetNames=[];for(var J=0;J!=L.length;++J)x.SheetNames[J]=L[J].name}var O=o?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),Z=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Ln(e,Z)||(Z="xl/_rels/workbook."+O+".rels");var M=fl(Sn(e,Z,!0),Z.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=O4(kr(e,Mn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=ET(kr(e,Mn(a.people[0])),n)),M&&(M=mN(M,p.Sheets));var ne=kr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=x.Worksheets;++_){var G="sheet";if(M&&M[_]?(A="xl/"+M[_][1].replace(/[\/]?xl\//,""),Ln(e,A)||(A=M[_][1]),Ln(e,A)||(A=Z.replace(/_rels\/.*$/,"")+M[_][1]),G=M[_][2]):(A="xl/worksheets/sheet"+(_+1-ne)+"."+O,A=A.replace(/sheet0\./,"sheet.")),T=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(_!=n.sheets)continue e;break;case"string":if(x.SheetNames[_].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var z=!1,fe=0;fe!=n.sheets.length;++fe)typeof n.sheets[fe]=="number"&&n.sheets[fe]==_&&(z=1),typeof n.sheets[fe]=="string"&&n.sheets[fe].toLowerCase()==x.SheetNames[_].toLowerCase()&&(z=1);if(!z)continue e}}xN(e,A,T,x.SheetNames[_],_,E,l,G,n,p,f,h)}return k={Directory:a,Workbook:p,Props:x,Custprops:y,Deps:w,Sheets:l,SheetNames:x.SheetNames,Strings:hl,Styles:h,Themes:f,SSF:Wr(yt)},n&&n.bookFiles&&(e.files?(k.keys=r,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(ue,oe){ue=ue.replace(/^Root Entry[\/]/,""),k.keys.push(ue),k.files[ue]=e.FileIndex[oe]}))),n&&n.bookVBA&&(a.vba.length>0?k.vbaraw=kr(e,Mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===DT&&(k.vbaraw=kr(e,"xl/vbaProject.bin",!0))),k}function vN(e,n){var t=n||{},r="Workbook",a=St.find(e,r);try{if(r="/!DataSpaces/Version",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(uS(a.content),r="/!DataSpaces/DataSpaceMap",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=dS(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=pS(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);mS(a.content)}catch{}if(r="/EncryptionInfo",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=xS(a.content);if(r="/EncryptedPackage",a=St.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Tp(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Cn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function yN(e,n){return St.find(e,"EncryptedPackage")?vN(e,n):my(e,n)}function wN(e,n){var t,r=e,a=n||{};return a.type||(a.type=Et&&Buffer.isBuffer(e)?"buffer":"base64"),t=l1(r,a),gN(t,a)}function yy(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Fd(e.slice(t),n);default:break e}return _l.to_workbook(e,n)}function kN(e,n){var t="",r=Tp(e,n);switch(n.type){case"base64":t=Cn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=io(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Kt(t)),n.type="binary",yy(t,n)}function _N(e,n){var t=e;return n.type=="base64"&&(t=Cn(t)),t=vl.utils.decode(1200,t.slice(2),"str"),n.type="binary",yy(t,n)}function bN(e){return e.match(/[^\x00-\x7F]/)?sl(e):e}function id(e,n,t,r){return r?(t.type="string",_l.to_workbook(e,t)):_l.to_workbook(n,t)}function Rd(e,n){$v();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rd(new Uint8Array(e),(t=Wr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Jo={},t.dateNF&&(Jo.dateNF=t.dateNF),t.type||(t.type=Et&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Et?"buffer":"binary",r=u_(e),typeof Uint8Array<"u"&&!Et&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=bN(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=Wr(t),t.type="array",Rd(ap(r),t)}switch((a=Tp(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return yN(St.read(r,t),t);break;case 9:if(a[1]<=8)return my(r,t);break;case 60:return Fd(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return qE(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return XE.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?wN(r,t):id(e,r,t,o);case 239:return a[3]===60?Fd(r,t):id(e,r,t,o);case 255:if(a[1]===254)return _N(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return pl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return pl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return bg.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return DS.to_workbook(r,t);break;case 10:case 13:case 32:return kN(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return KE.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?bg.to_workbook(r,t):id(e,r,t,o)}function EN(e,n,t,r,a,o,l,c){var f=Ur(t),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var y=n.s.c;y<=n.e.c;++y){var k=l?e[t][y]:e[r[y]+f];if(k===void 0||k.t===void 0){if(h===void 0)continue;o[y]!=null&&(g[o[y]]=h);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(o[y]!=null){if(w==null)if(k.t=="e"&&w===null)g[o[y]]=null;else if(h!==void 0)g[o[y]]=h;else if(p&&w===null)g[o[y]]=null;else continue;else g[o[y]]=p&&(k.t!=="n"||k.t==="n"&&c.rawNumbers!==!1)?w:Ka(k,w,c);w!=null&&(x=!1)}}return{row:g,isempty:x}}function Md(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof p){case"string":f=fr(p);break;case"number":f=fr(e["!ref"]),f.s.r=p;break;default:f=p}r>0&&(a=0);var x=Ur(f.s.r),g=[],y=[],k=0,w=0,_=Array.isArray(e),E=f.s.r,A=0,T={};_&&!e[E]&&(e[E]=[]);var L=h.skipHidden&&e["!cols"]||[],J=h.skipHidden&&e["!rows"]||[];for(A=f.s.c;A<=f.e.c;++A)if(!(L[A]||{}).hidden)switch(g[A]=Tr(A),t=_?e[E][A]:e[g[A]+x],r){case 1:o[A]=A-f.s.c;break;case 2:o[A]=g[A];break;case 3:o[A]=h.header[A-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ka(t,null,h),w=T[l]||0,!w)T[l]=1;else{do c=l+"_"+w++;while(T[c]);T[l]=w,T[c]=1}o[A]=c}for(E=f.s.r+a;E<=f.e.r;++E)if(!(J[E]||{}).hidden){var O=EN(e,f,E,g,r,o,_,h);(O.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(y[k++]=O.row)}return y.length=k,y}var Bg=/"/g;function SN(e,n,t,r,a,o,l,c){for(var f=!0,h=[],p="",x=Ur(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var y=c.dense?(e[t]||[])[g]:e[r[g]+x];if(y==null)p="";else if(y.v!=null){f=!1,p=""+(c.rawNumbers&&y.t=="n"?y.v:Ka(y,null,c));for(var k=0,w=0;k!==p.length;++k)if((w=p.charCodeAt(k))===a||w===o||w===34||c.forceQuotes){p='"'+p.replace(Bg,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(f=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(Bg,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&f?null:h.join(l)}function wy(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=fr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),p="",x=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],y=r.skipHidden&&e["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(g[k]||{}).hidden||(x[k]=Tr(k));for(var w=0,_=a.s.r;_<=a.e.r;++_)(y[_]||{}).hidden||(p=SN(e,a,_,x,l,f,o,r),p!=null&&(r.strip&&(p=p.replace(h,"")),(p||r.blankrows!==!1)&&t.push((w++?c:"")+p)));return delete r.dense,t.join("")}function TN(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=wy(e,n);return t}function CN(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=fr(e["!ref"]),o="",l=[],c,f=[],h=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Tr(c);for(var p=a.s.r;p<=a.e.r;++p)for(o=Ur(p),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=h?(e[p]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function ky(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}var h,p={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var x=fr(o["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),l==-1&&(l=x.e.r+1,p.e.r=l+n.length-1+a)}else l==-1&&(l=0,p.e.r=n.length-1+a);var g=r.header||[],y=0;n.forEach(function(w,_){Ea(w).forEach(function(E){(y=g.indexOf(E))==-1&&(g[y=g.length]=E);var A=w[E],T="z",L="",J=xt({c:c+y,r:l+_+a});h=Tl(o,J),A&&typeof A=="object"&&!(A instanceof Date)?o[J]=A:(typeof A=="number"?T="n":typeof A=="boolean"?T="b":typeof A=="string"?T="s":A instanceof Date?(T="d",r.cellDates||(T="n",A=dn(A)),L=r.dateNF||yt[14]):A===null&&r.nullError&&(T="e",A=0),h?(h.t=T,h.v=A,delete h.w,delete h.R,L&&(h.z=L)):o[J]=h={t:T,v:A},L&&(h.z=L))})}),p.e.c=Math.max(p.e.c,c+g.length-1);var k=Ur(l);if(a)for(y=0;y<g.length;++y)o[Tr(y+c)+k]={t:"s",v:g[y]};return o["!ref"]=Tt(p),o}function DN(e,n){return ky(null,e,n)}function Tl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=ln(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Tl(e,xt(n)):Tl(e,xt({r:n,c:t||0}))}function NN(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Cp(){return{SheetNames:[],Sheets:{}}}function Dp(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(p4(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function FN(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=NN(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function AN(e,n){return e.z=n,e}function _y(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function ON(e,n,t){return _y(e,"#"+n,t)}function PN(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function RN(e,n,t,r){for(var a=typeof n!="string"?n:fr(n),o=typeof n=="string"?n:Tt(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Tl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var MN={encode_col:Tr,encode_row:Ur,encode_cell:xt,encode_range:Tt,decode_col:pp,decode_row:dp,split_cell:V_,decode_cell:ln,decode_range:pi,format_cell:Ka,sheet_add_aoa:T1,sheet_add_json:ky,sheet_add_dom:xy,aoa_to_sheet:hi,json_to_sheet:DN,table_to_sheet:gy,table_to_book:q4,sheet_to_csv:wy,sheet_to_txt:TN,sheet_to_json:Md,sheet_to_html:Q4,sheet_to_formulae:CN,sheet_to_row_object_array:Md,sheet_get_cell:Tl,book_new:Cp,book_append_sheet:Dp,book_set_sheet_visibility:FN,cell_set_number_format:AN,cell_set_hyperlink:_y,cell_set_internal_link:ON,cell_add_comment:PN,sheet_set_array_formula:RN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const IN=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=N.useState(null),o=N.useRef(null),l=h=>{const p=h.target.files?.[0];p&&a(p)},c=()=>{if(r){const h=new FileReader;h.onload=p=>{try{const x=new Uint8Array(p.target?.result),g=Rd(x,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const y=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",y);const k=MN.sheet_to_json(y,{header:1});console.log("Parsed JSON data:",k);const w={headers:k[0],rows:k.slice(1)};console.log("Prepared file data:",w),t(r.name,w),f()}catch(x){console.error("Error reading Excel file:",x)}},h.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return d.jsx(Mr,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Załaduj plik Excel"}),d.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-2 overflow-hidden",children:d.jsx("div",{children:d.jsxs("div",{className:"relative mt-8",children:[d.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),d.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[d.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&d.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[d.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),d.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Załaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Załaduj"})]})]})})},jN=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>d.jsx(Mr,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:d.jsxs("div",{className:"h-full flex items-center justify-between",children:[d.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastąpić "',r,'"?']}),d.jsxs("div",{className:"flex space-x-2 shrink-0",children:[d.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),d.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastąp"})]})]})});function by(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=by(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Br(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=by(e))&&(r&&(r+=" "),r+=n);return r}const Ey=6048e5,LN=864e5,Ju=6e4,e0=36e5,zN=1e3,Wg=Symbol.for("constructDateFrom");function Ut(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Wg in e?e[Wg](n):e instanceof Date?new e.constructor(n):new Date(n)}function nt(e,n){return Ut(n||e,e)}function aa(e,n,t){const r=nt(e,t?.in);return isNaN(n)?Ut(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function sa(e,n,t){const r=nt(e,t?.in);if(isNaN(n))return Ut(e,NaN);if(!n)return r;const a=r.getDate(),o=Ut(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function Sy(e,n,t){return Ut(e,+nt(e)+n)}function BN(e,n,t){return Sy(e,n*e0)}let WN={};function wo(){return WN}function oa(e,n){const t=wo(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=nt(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function oi(e,n){return oa(e,{...n,weekStartsOn:1})}function Ty(e,n){const t=nt(e,n?.in),r=t.getFullYear(),a=Ut(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=oi(a),l=Ut(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=oi(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Ou(e){const n=nt(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function Da(e,...n){const t=Ut.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function co(e,n){const t=nt(e,n?.in);return t.setHours(0,0,0,0),t}function ii(e,n,t){const[r,a]=Da(t?.in,e,n),o=co(r),l=co(a),c=+o-Ou(o),f=+l-Ou(l);return Math.round((c-f)/LN)}function UN(e,n){const t=Ty(e,n),r=Ut(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),oi(r)}function Id(e,n,t){const r=nt(e,t?.in);return r.setTime(r.getTime()+n*Ju),r}function Np(e,n,t){return sa(e,n*3,t)}function HN(e,n,t){return Sy(e,n*1e3)}function Pu(e,n,t){return aa(e,n*7,t)}function Ua(e,n,t){return sa(e,n*12,t)}function Ug(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Ut.bind(null,a));const o=nt(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Ut(r,t||NaN)}function Hg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Ut.bind(null,a));const o=nt(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Ut(r,t||NaN)}function $N(e,n,t){const[r,a]=Da(t?.in,e,n);return+co(r)==+co(a)}function Ha(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Ru(e){return!(!Ha(e)&&typeof e!="number"||isNaN(+nt(e)))}function Mu(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function ro(e,n){const t=nt(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function Iu(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=ro(r)-ro(a);return o*4+l}function ju(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function YN(e,n,t){const[r,a]=Da(t?.in,e,n),o=$g(r,a),l=Math.abs(ii(r,a));r.setDate(r.getDate()-o*l);const c=+($g(r,a)===-o),f=o*(l-c);return f===0?0:f}function $g(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function Cy(e,n){const t=nt(e,n?.in);return t.setHours(23,59,59,999),t}function Dy(e,n){const t=nt(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function jd(e,n){const t=nt(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function Ny(e,n){const t=nt(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Fy(e,n){const t=nt(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function t0(e,n){const t=nt(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function VN(e,n){const t=wo(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=nt(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const KN={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},GN=(e,n,t)=>{let r;const a=KN[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function ei(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const XN={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},QN={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qN={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ZN={date:ei({formats:XN,defaultWidth:"full"}),time:ei({formats:QN,defaultWidth:"full"}),dateTime:ei({formats:qN,defaultWidth:"full"})},JN={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e3=(e,n,t,r)=>JN[e];function va(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const t3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},r3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},n3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},a3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},s3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},i3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},l3={ordinalNumber:i3,era:va({values:t3,defaultWidth:"wide"}),quarter:va({values:r3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:va({values:n3,defaultWidth:"wide"}),day:va({values:a3,defaultWidth:"wide"}),dayPeriod:va({values:s3,defaultWidth:"wide",formattingValues:o3,defaultFormattingWidth:"wide"})};function ya(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?u3(c,x=>x.test(l)):c3(c,x=>x.test(l));let h;h=e.valueCallback?e.valueCallback(f):f,h=t.valueCallback?t.valueCallback(h):h;const p=n.slice(l.length);return{value:h,rest:p}}}function c3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function u3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function Ay(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const f3=/^(\d+)(th|st|nd|rd)?/i,d3=/\d+/i,p3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},h3={any:[/^b/i,/^(a|c)/i]},m3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},x3={any:[/1/i,/2/i,/3/i,/4/i]},g3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},v3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},y3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},w3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},k3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},b3={ordinalNumber:Ay({matchPattern:f3,parsePattern:d3,valueCallback:e=>parseInt(e,10)}),era:ya({matchPatterns:p3,defaultMatchWidth:"wide",parsePatterns:h3,defaultParseWidth:"any"}),quarter:ya({matchPatterns:m3,defaultMatchWidth:"wide",parsePatterns:x3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ya({matchPatterns:g3,defaultMatchWidth:"wide",parsePatterns:v3,defaultParseWidth:"any"}),day:ya({matchPatterns:y3,defaultMatchWidth:"wide",parsePatterns:w3,defaultParseWidth:"any"}),dayPeriod:ya({matchPatterns:k3,defaultMatchWidth:"any",parsePatterns:_3,defaultParseWidth:"any"})},Oy={code:"en-US",formatDistance:GN,formatLong:ZN,formatRelative:e3,localize:l3,match:b3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function E3(e,n){const t=nt(e,n?.in);return ii(t,t0(t))+1}function Fp(e,n){const t=nt(e,n?.in),r=+oi(t)-+UN(t);return Math.round(r/Ey)+1}function Ap(e,n){const t=nt(e,n?.in),r=t.getFullYear(),a=wo(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Ut(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=oa(l,n),f=Ut(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const h=oa(f,n);return+t>=+c?r+1:+t>=+h?r:r-1}function S3(e,n){const t=wo(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Ap(e,n),o=Ut(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),oa(o,n)}function Py(e,n){const t=nt(e,n?.in),r=+oa(t,n)-+S3(t,n);return Math.round(r/Ey)+1}function Wt(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const vs={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Wt(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Wt(t+1,2)},d(e,n){return Wt(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Wt(e.getHours()%12||12,n.length)},H(e,n){return Wt(e.getHours(),n.length)},m(e,n){return Wt(e.getMinutes(),n.length)},s(e,n){return Wt(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Wt(a,n.length)}},Vo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Yg={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return vs.y(e,n)},Y:function(e,n,t,r){const a=Ap(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Wt(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Wt(o,n.length)},R:function(e,n){const t=Ty(e);return Wt(t,n.length)},u:function(e,n){const t=e.getFullYear();return Wt(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Wt(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Wt(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return vs.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Wt(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=Py(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Wt(a,n.length)},I:function(e,n,t){const r=Fp(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Wt(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):vs.d(e,n)},D:function(e,n,t){const r=E3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Wt(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Wt(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Wt(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Wt(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Vo.noon:r===0?a=Vo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Vo.evening:r>=12?a=Vo.afternoon:r>=4?a=Vo.morning:a=Vo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return vs.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):vs.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Wt(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Wt(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):vs.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):vs.s(e,n)},S:function(e,n){return vs.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Kg(r);case"XXXX":case"XX":return Gs(r);case"XXXXX":case"XXX":default:return Gs(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Kg(r);case"xxxx":case"xx":return Gs(r);case"xxxxx":case"xxx":default:return Gs(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Vg(r,":");case"OOOO":default:return"GMT"+Gs(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Vg(r,":");case"zzzz":default:return"GMT"+Gs(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Wt(r,n.length)},T:function(e,n,t){return Wt(+e,n.length)}};function Vg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Wt(o,2)}function Kg(e,n){return e%60===0?(e>0?"-":"+")+Wt(Math.abs(e)/60,2):Gs(e,n)}function Gs(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Wt(Math.trunc(r/60),2),o=Wt(r%60,2);return t+a+n+o}const Gg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},Ry=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},T3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Gg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Gg(r,n)).replace("{{time}}",Ry(a,n))},Ld={p:Ry,P:T3},C3=/^D+$/,D3=/^Y+$/,N3=["D","DD","YY","YYYY"];function F3(e){return C3.test(e)}function A3(e){return D3.test(e)}function O3(e,n,t){const r=P3(e,n,t);if(console.warn(r),N3.includes(e))throw new RangeError(r)}function P3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const R3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,M3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,I3=/^'([^]*?)'?$/,j3=/''/g,L3=/[a-zA-Z]/;function Xg(e,n,t){const r=wo(),a=t?.locale??r.locale??Oy,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=nt(e,t?.in);if(!Ru(c))throw new RangeError("Invalid time value");let f=n.match(M3).map(p=>{const x=p[0];if(x==="p"||x==="P"){const g=Ld[x];return g(p,a.formatLong)}return p}).join("").match(R3).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const x=p[0];if(x==="'")return{isToken:!1,value:z3(p)};if(Yg[x])return{isToken:!0,value:p};if(x.match(L3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const h={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(p=>{if(!p.isToken)return p.value;const x=p.value;(!t?.useAdditionalWeekYearTokens&&A3(x)||!t?.useAdditionalDayOfYearTokens&&F3(x))&&O3(x,n,String(e));const g=Yg[x[0]];return g(c,x,a.localize,h)}).join("")}function z3(e){const n=e.match(I3);return n?n[1].replace(j3,"'"):e}function Qg(e,n){return nt(e,n?.in).getDate()}function B3(e,n){return nt(e,n?.in).getDay()}function W3(e,n){const t=nt(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Ut(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function U3(){return Object.assign({},wo())}function $a(e,n){return nt(e,n?.in).getHours()}function H3(e,n){const t=nt(e,n?.in).getDay();return t===0?7:t}function Ya(e,n){return nt(e,n?.in).getMinutes()}function cn(e,n){return nt(e,n?.in).getMonth()}function Ss(e){return nt(e).getSeconds()}function zd(e){return+nt(e)}function kt(e,n){return nt(e,n?.in).getFullYear()}function Ns(e,n){return+nt(e)>+nt(n)}function uo(e,n){return+nt(e)<+nt(n)}function $3(e,n){return+nt(e)==+nt(n)}function Y3(e,n){const t=V3(n)?new n(0):Ut(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function V3(e){return typeof e=="function"&&e.prototype?.constructor===e}const K3=10;class My{subPriority=0;validate(n,t){return!0}}class G3 extends My{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class X3 extends My{priority=K3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Ut(t,r))}set(n,t){return t.timestampIsSet?n:Ut(n,Y3(n,this.context))}}class Rt{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new G3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class Q3 extends Rt{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const gr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},wa={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function vr(e,n){return e&&{value:n(e.value),rest:e.rest}}function or(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function ka(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*e0+o*Ju+l*zN),rest:n.slice(t[0].length)}}function Iy(e){return or(gr.anyDigitsSigned,e)}function dr(e,n){switch(e){case 1:return or(gr.singleDigit,n);case 2:return or(gr.twoDigits,n);case 3:return or(gr.threeDigits,n);case 4:return or(gr.fourDigits,n);default:return or(new RegExp("^\\d{1,"+e+"}"),n)}}function Lu(e,n){switch(e){case 1:return or(gr.singleDigitSigned,n);case 2:return or(gr.twoDigitsSigned,n);case 3:return or(gr.threeDigitsSigned,n);case 4:return or(gr.fourDigitsSigned,n);default:return or(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Op(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function jy(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function Ly(e){return e%400===0||e%4===0&&e%100!==0}class q3 extends Rt{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return vr(dr(4,n),a);case"yo":return vr(r.ordinalNumber(n,{unit:"year"}),a);default:return vr(dr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=jy(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class Z3 extends Rt{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return vr(dr(4,n),a);case"Yo":return vr(r.ordinalNumber(n,{unit:"year"}),a);default:return vr(dr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=Ap(n,a);if(r.isTwoDigitYear){const c=jy(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class J3 extends Rt{priority=130;parse(n,t){return Lu(t==="R"?4:t.length,n)}set(n,t,r){const a=Ut(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),oi(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class eF extends Rt{priority=130;parse(n,t){return Lu(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class tF extends Rt{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return dr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class rF extends Rt{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return dr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class nF extends Rt{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return vr(or(gr.month,n),a);case"MM":return vr(dr(2,n),a);case"Mo":return vr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class aF extends Rt{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return vr(or(gr.month,n),a);case"LL":return vr(dr(2,n),a);case"Lo":return vr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function sF(e,n,t){const r=nt(e,t?.in),a=Py(r,t)-n;return r.setDate(r.getDate()-a*7),nt(r,t?.in)}class oF extends Rt{priority=100;parse(n,t,r){switch(t){case"w":return or(gr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return dr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return oa(sF(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function iF(e,n,t){const r=nt(e,t?.in),a=Fp(r,t)-n;return r.setDate(r.getDate()-a*7),r}class lF extends Rt{priority=100;parse(n,t,r){switch(t){case"I":return or(gr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return dr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return oi(iF(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const cF=[31,28,31,30,31,30,31,31,30,31,30,31],uF=[31,29,31,30,31,30,31,31,30,31,30,31];class fF extends Rt{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return or(gr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return dr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=Ly(r),o=n.getMonth();return a?t>=1&&t<=uF[o]:t>=1&&t<=cF[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class dF extends Rt{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return or(gr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return dr(t.length,n)}}validate(n,t){const r=n.getFullYear();return Ly(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Pp(e,n,t){const r=wo(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=nt(e,t?.in),l=o.getDay(),f=(n%7+7)%7,h=7-a,p=n<0||n>6?n-(l+h)%7:(f+h)%7-(l+h)%7;return aa(o,p,t)}class pF extends Rt{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class hF extends Rt{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return vr(dr(t.length,n),o);case"eo":return vr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class mF extends Rt{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return vr(dr(t.length,n),o);case"co":return vr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function xF(e,n,t){const r=nt(e,t?.in),a=H3(r,t),o=n-a;return aa(r,o,t)}class gF extends Rt{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return dr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return vr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return vr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return vr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return vr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=xF(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class vF extends Rt{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Op(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class yF extends Rt{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Op(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class wF extends Rt{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Op(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class kF extends Rt{priority=70;parse(n,t,r){switch(t){case"h":return or(gr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return dr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class _F extends Rt{priority=70;parse(n,t,r){switch(t){case"H":return or(gr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return dr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class bF extends Rt{priority=70;parse(n,t,r){switch(t){case"K":return or(gr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return dr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class EF extends Rt{priority=70;parse(n,t,r){switch(t){case"k":return or(gr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return dr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class SF extends Rt{priority=60;parse(n,t,r){switch(t){case"m":return or(gr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return dr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class TF extends Rt{priority=50;parse(n,t,r){switch(t){case"s":return or(gr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return dr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class CF extends Rt{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return vr(dr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class DF extends Rt{priority=10;parse(n,t){switch(t){case"X":return ka(wa.basicOptionalMinutes,n);case"XX":return ka(wa.basic,n);case"XXXX":return ka(wa.basicOptionalSeconds,n);case"XXXXX":return ka(wa.extendedOptionalSeconds,n);case"XXX":default:return ka(wa.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Ut(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","x"]}class NF extends Rt{priority=10;parse(n,t){switch(t){case"x":return ka(wa.basicOptionalMinutes,n);case"xx":return ka(wa.basic,n);case"xxxx":return ka(wa.basicOptionalSeconds,n);case"xxxxx":return ka(wa.extendedOptionalSeconds,n);case"xxx":default:return ka(wa.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Ut(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","X"]}class FF extends Rt{priority=40;parse(n){return Iy(n)}set(n,t,r){return[Ut(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class AF extends Rt{priority=20;parse(n){return Iy(n)}set(n,t,r){return[Ut(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const OF={G:new Q3,y:new q3,Y:new Z3,R:new J3,u:new eF,Q:new tF,q:new rF,M:new nF,L:new aF,w:new oF,I:new lF,d:new fF,D:new dF,E:new pF,e:new hF,c:new mF,i:new gF,a:new vF,b:new yF,B:new wF,h:new kF,H:new _F,K:new bF,k:new EF,m:new SF,s:new TF,S:new CF,X:new DF,x:new NF,t:new FF,T:new AF},PF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,RF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,MF=/^'([^]*?)'?$/,IF=/''/g,jF=/\S/,LF=/[a-zA-Z]/;function zF(e,n,t,r){const a=()=>Ut(r?.in||t,NaN),o=U3(),l=r?.locale??o.locale??Oy,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():nt(t,r?.in);const h={firstWeekContainsDate:c,weekStartsOn:f,locale:l},p=[new X3(r?.in,t)],x=n.match(RF).map(_=>{const E=_[0];if(E in Ld){const A=Ld[E];return A(_,l.formatLong)}return _}).join("").match(PF),g=[];for(let _ of x){const E=_[0],A=OF[E];if(A){const{incompatibleTokens:T}=A;if(Array.isArray(T)){const J=g.find(O=>T.includes(O.token)||O.token===E);if(J)throw new RangeError(`The format string mustn't contain \`${J.fullToken}\` and \`${_}\` at the same time`)}else if(A.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${_}\` and any other token at the same time`);g.push({token:E,fullToken:_});const L=A.run(e,_,l.match,h);if(!L)return a();p.push(L.setter),e=L.rest}else{if(E.match(LF))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");if(_==="''"?_="'":E==="'"&&(_=BF(_)),e.indexOf(_)===0)e=e.slice(_.length);else return a()}}if(e.length>0&&jF.test(e))return a();const y=p.map(_=>_.priority).sort((_,E)=>E-_).filter((_,E,A)=>A.indexOf(_)===E).map(_=>p.filter(E=>E.priority===_).sort((E,A)=>A.subPriority-E.subPriority)).map(_=>_[0]);let k=nt(t,r?.in);if(isNaN(+k))return a();const w={};for(const _ of y){if(!_.validate(k,h))return a();const E=_.set(k,w,h);Array.isArray(E)?(k=E[0],Object.assign(w,E[1])):k=E}return k}function BF(e){return e.match(MF)[1].replace(IF,"'")}function WF(e,n,t){const[r,a]=Da(t?.in,e,n);return+oa(r,t)==+oa(a,t)}function UF(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function HF(e,n,t){const[r,a]=Da(t?.in,e,n);return+jd(r)==+jd(a)}function $F(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Cl(e,n,t){const r=+nt(e,t?.in),[a,o]=[+nt(n.start,t?.in),+nt(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function YF(e,n,t){return aa(e,-1,t)}function VF(e,n){const t=()=>Ut(n?.in,NaN),a=QF(e);let o;if(a.date){const h=qF(a.date,2);o=ZF(h.restDateString,h.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=JF(a.time),isNaN(c)))return t();if(a.timezone){if(f=eA(a.timezone),isNaN(f))return t()}else{const h=new Date(l+c),p=nt(0,n?.in);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return nt(l+c+f,n?.in)}const su={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},KF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,GF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,XF=/^([+-])(\d{2})(?::?(\d{2}))?$/;function QF(e){const n={},t=e.split(su.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],su.timeZoneDelimiter.test(n.date)&&(n.date=e.split(su.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=su.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function qF(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function ZF(e,n){if(n===null)return new Date(NaN);const t=e.match(KF);if(!t)return new Date(NaN);const r=!!t[4],a=el(t[1]),o=el(t[2])-1,l=el(t[3]),c=el(t[4]),f=el(t[5])-1;if(r)return sA(n,c,f)?tA(n,c,f):new Date(NaN);{const h=new Date(0);return!nA(n,o,l)||!aA(n,a)?new Date(NaN):(h.setUTCFullYear(n,o,Math.max(a,l)),h)}}function el(e){return e?parseInt(e):1}function JF(e){const n=e.match(GF);if(!n)return NaN;const t=ld(n[1]),r=ld(n[2]),a=ld(n[3]);return oA(t,r,a)?t*e0+r*Ju+a*1e3:NaN}function ld(e){return e&&parseFloat(e.replace(",","."))||0}function eA(e){if(e==="Z")return 0;const n=e.match(XF);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return iA(r,a)?t*(r*e0+a*Ju):NaN}function tA(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const rA=[31,null,31,30,31,30,31,31,30,31,30,31];function zy(e){return e%400===0||e%4===0&&e%100!==0}function nA(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(rA[n]||(zy(e)?29:28))}function aA(e,n){return n>=1&&n<=(zy(e)?366:365)}function sA(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function oA(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function iA(e,n){return n>=0&&n<=59}function Bn(e,n,t){const r=nt(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Ut(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=W3(l);return r.setMonth(n,Math.min(o,c)),r}function hu(e,n,t){const r=nt(e,t?.in);return r.setHours(n),r}function mu(e,n,t){const r=nt(e,t?.in);return r.setMinutes(n),r}function Xo(e,n,t){const r=nt(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Bn(r,r.getMonth()+o*3)}function xu(e,n,t){const r=nt(e,t?.in);return r.setSeconds(n),r}function xa(e,n,t){const r=nt(e,t?.in);return isNaN(+r)?Ut(e,NaN):(r.setFullYear(n),r)}function no(e,n,t){return sa(e,-n,t)}function By(e,n,t){return Np(e,-1,t)}function qg(e,n,t){return Pu(e,-1,t)}function li(e,n,t){return Ua(e,-n,t)}function r0(){return typeof window<"u"}function mi(e){return Wy(e)?(e.nodeName||"").toLowerCase():"#document"}function Tn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Na(e){var n;return(n=(Wy(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function Wy(e){return r0()?e instanceof Node||e instanceof Tn(e).Node:!1}function un(e){return r0()?e instanceof Element||e instanceof Tn(e).Element:!1}function Sa(e){return r0()?e instanceof HTMLElement||e instanceof Tn(e).HTMLElement:!1}function Zg(e){return!r0()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Tn(e).ShadowRoot}function Il(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Hn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function lA(e){return["table","td","th"].includes(mi(e))}function n0(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Rp(e){const n=Mp(),t=un(e)?Hn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function cA(e){let n=Fs(e);for(;Sa(n)&&!ci(n);){if(Rp(n))return n;if(n0(n))return null;n=Fs(n)}return null}function Mp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ci(e){return["html","body","#document"].includes(mi(e))}function Hn(e){return Tn(e).getComputedStyle(e)}function a0(e){return un(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Fs(e){if(mi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Zg(e)&&e.host||Na(e);return Zg(n)?n.host:n}function Uy(e){const n=Fs(e);return ci(n)?e.ownerDocument?e.ownerDocument.body:e.body:Sa(n)&&Il(n)?n:Uy(n)}function Dl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=Uy(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Tn(a);if(o){const c=Bd(l);return n.concat(l,l.visualViewport||[],Il(a)?a:[],c&&t?Dl(c):[])}return n.concat(a,Dl(a,[],t))}function Bd(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const ui=Math.min,ao=Math.max,zu=Math.round,ou=Math.floor,ba=e=>({x:e,y:e}),uA={left:"right",right:"left",bottom:"top",top:"bottom"},fA={start:"end",end:"start"};function Wd(e,n,t){return ao(e,ui(n,t))}function jl(e,n){return typeof e=="function"?e(n):e}function fo(e){return e.split("-")[0]}function Ll(e){return e.split("-")[1]}function Hy(e){return e==="x"?"y":"x"}function Ip(e){return e==="y"?"height":"width"}function so(e){return["top","bottom"].includes(fo(e))?"y":"x"}function jp(e){return Hy(so(e))}function dA(e,n,t){t===void 0&&(t=!1);const r=Ll(e),a=jp(e),o=Ip(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=Bu(l)),[l,Bu(l)]}function pA(e){const n=Bu(e);return[Ud(e),n,Ud(n)]}function Ud(e){return e.replace(/start|end/g,n=>fA[n])}function hA(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function mA(e,n,t,r){const a=Ll(e);let o=hA(fo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map(Ud)))),o}function Bu(e){return e.replace(/left|right|bottom|top/g,n=>uA[n])}function xA(e){return{top:0,right:0,bottom:0,left:0,...e}}function $y(e){return typeof e!="number"?xA(e):{top:e,right:e,bottom:e,left:e}}function Wu(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var Uu=typeof document<"u"?N.useLayoutEffect:N.useEffect;const gA={...Mv},vA=gA.useInsertionEffect,yA=vA||(e=>e());function wA(e){const n=N.useRef(()=>{});return yA(()=>{n.current=e}),N.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var Yy=Qd();const kA=Ku(Yy);function Jg(e,n,t){let{reference:r,floating:a}=e;const o=so(n),l=jp(n),c=Ip(l),f=fo(n),h=o==="y",p=r.x+r.width/2-a.width/2,x=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let y;switch(f){case"top":y={x:p,y:r.y-a.height};break;case"bottom":y={x:p,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:x};break;case"left":y={x:r.x-a.width,y:x};break;default:y={x:r.x,y:r.y}}switch(Ll(n)){case"start":y[l]-=g*(t&&h?-1:1);break;case"end":y[l]+=g*(t&&h?-1:1);break}return y}const _A=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let h=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:p,y:x}=Jg(h,r,f),g=r,y={},k=0;for(let w=0;w<c.length;w++){const{name:_,fn:E}=c[w],{x:A,y:T,data:L,reset:J}=await E({x:p,y:x,initialPlacement:r,placement:g,strategy:a,middlewareData:y,rects:h,platform:l,elements:{reference:e,floating:n}});p=A??p,x=T??x,y={...y,[_]:{...y[_],...L}},J&&k<=50&&(k++,typeof J=="object"&&(J.placement&&(g=J.placement),J.rects&&(h=J.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):J.rects),{x:p,y:x}=Jg(h,g,f)),w=-1)}return{x:p,y:x,placement:g,strategy:a,middlewareData:y}};async function Vy(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:x="floating",altBoundary:g=!1,padding:y=0}=jl(n,e),k=$y(y),_=c[g?x==="floating"?"reference":"floating":x],E=Wu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(_)))==null||t?_:_.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:h,rootBoundary:p,strategy:f})),A=x==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,T=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),L=await(o.isElement==null?void 0:o.isElement(T))?await(o.getScale==null?void 0:o.getScale(T))||{x:1,y:1}:{x:1,y:1},J=Wu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:A,offsetParent:T,strategy:f}):A);return{top:(E.top-J.top+k.top)/L.y,bottom:(J.bottom-E.bottom+k.bottom)/L.y,left:(E.left-J.left+k.left)/L.x,right:(J.right-E.right+k.right)/L.x}}const bA=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:h,padding:p=0}=jl(e,n)||{};if(h==null)return{};const x=$y(p),g={x:t,y:r},y=jp(a),k=Ip(y),w=await l.getDimensions(h),_=y==="y",E=_?"top":"left",A=_?"bottom":"right",T=_?"clientHeight":"clientWidth",L=o.reference[k]+o.reference[y]-g[y]-o.floating[k],J=g[y]-o.reference[y],O=await(l.getOffsetParent==null?void 0:l.getOffsetParent(h));let C=O?O[T]:0;(!C||!await(l.isElement==null?void 0:l.isElement(O)))&&(C=c.floating[T]||o.floating[k]);const Z=L/2-J/2,M=C/2-w[k]/2-1,ne=ui(x[E],M),G=ui(x[A],M),z=ne,fe=C-w[k]-G,ue=C/2-w[k]/2+Z,oe=Wd(z,ue,fe),pe=!f.arrow&&Ll(a)!=null&&ue!==oe&&o.reference[k]/2-(ue<z?ne:G)-w[k]/2<0,V=pe?ue<z?ue-z:ue-fe:0;return{[y]:g[y]+V,data:{[y]:oe,centerOffset:ue-oe-V,...pe&&{alignmentOffset:V}},reset:pe}}}),EA=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:h}=n,{mainAxis:p=!0,crossAxis:x=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:w=!0,..._}=jl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const E=fo(a),A=so(c),T=fo(c)===c,L=await(f.isRTL==null?void 0:f.isRTL(h.floating)),J=g||(T||!w?[Bu(c)]:pA(c)),O=k!=="none";!g&&O&&J.push(...mA(c,w,k,L));const C=[c,...J],Z=await Vy(n,_),M=[];let ne=((r=o.flip)==null?void 0:r.overflows)||[];if(p&&M.push(Z[E]),x){const oe=dA(a,l,L);M.push(Z[oe[0]],Z[oe[1]])}if(ne=[...ne,{placement:a,overflows:M}],!M.every(oe=>oe<=0)){var G,z;const oe=(((G=o.flip)==null?void 0:G.index)||0)+1,pe=C[oe];if(pe){var fe;const ie=x==="alignment"?A!==so(pe):!1,q=((fe=ne[0])==null?void 0:fe.overflows[0])>0;if(!ie||q)return{data:{index:oe,overflows:ne},reset:{placement:pe}}}let V=(z=ne.filter(ie=>ie.overflows[0]<=0).sort((ie,q)=>ie.overflows[1]-q.overflows[1])[0])==null?void 0:z.placement;if(!V)switch(y){case"bestFit":{var ue;const ie=(ue=ne.filter(q=>{if(O){const ae=so(q.placement);return ae===A||ae==="y"}return!0}).map(q=>[q.placement,q.overflows.filter(ae=>ae>0).reduce((ae,B)=>ae+B,0)]).sort((q,ae)=>q[1]-ae[1])[0])==null?void 0:ue[0];ie&&(V=ie);break}case"initialPlacement":V=c;break}if(a!==V)return{reset:{placement:V}}}return{}}}};async function SA(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=fo(t),c=Ll(t),f=so(t)==="y",h=["left","top"].includes(l)?-1:1,p=o&&f?-1:1,x=jl(n,e);let{mainAxis:g,crossAxis:y,alignmentAxis:k}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return c&&typeof k=="number"&&(y=c==="end"?k*-1:k),f?{x:y*p,y:g*h}:{x:g*h,y:y*p}}const TA=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await SA(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},CA=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:_=>{let{x:E,y:A}=_;return{x:E,y:A}}},...f}=jl(e,n),h={x:t,y:r},p=await Vy(n,f),x=so(fo(a)),g=Hy(x);let y=h[g],k=h[x];if(o){const _=g==="y"?"top":"left",E=g==="y"?"bottom":"right",A=y+p[_],T=y-p[E];y=Wd(A,y,T)}if(l){const _=x==="y"?"top":"left",E=x==="y"?"bottom":"right",A=k+p[_],T=k-p[E];k=Wd(A,k,T)}const w=c.fn({...n,[g]:y,[x]:k});return{...w,data:{x:w.x-t,y:w.y-r,enabled:{[g]:o,[x]:l}}}}}};function Ky(e){const n=Hn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Sa(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=zu(t)!==o||zu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function Lp(e){return un(e)?e:e.contextElement}function ti(e){const n=Lp(e);if(!Sa(n))return ba(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Ky(n);let l=(o?zu(t.width):t.width)/r,c=(o?zu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const DA=ba(0);function Gy(e){const n=Tn(e);return!Mp()||!n.visualViewport?DA:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function NA(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Tn(e)?!1:n}function po(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=Lp(e);let l=ba(1);n&&(r?un(r)&&(l=ti(r)):l=ti(e));const c=NA(o,t,r)?Gy(o):ba(0);let f=(a.left+c.x)/l.x,h=(a.top+c.y)/l.y,p=a.width/l.x,x=a.height/l.y;if(o){const g=Tn(o),y=r&&un(r)?Tn(r):r;let k=g,w=Bd(k);for(;w&&r&&y!==k;){const _=ti(w),E=w.getBoundingClientRect(),A=Hn(w),T=E.left+(w.clientLeft+parseFloat(A.paddingLeft))*_.x,L=E.top+(w.clientTop+parseFloat(A.paddingTop))*_.y;f*=_.x,h*=_.y,p*=_.x,x*=_.y,f+=T,h+=L,k=Tn(w),w=Bd(k)}}return Wu({width:p,height:x,x:f,y:h})}function zp(e,n){const t=a0(e).scrollLeft;return n?n.left+t:po(Na(e)).left+t}function Xy(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:zp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function FA(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Na(r),c=n?n0(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},h=ba(1);const p=ba(0),x=Sa(r);if((x||!x&&!o)&&((mi(r)!=="body"||Il(l))&&(f=a0(r)),Sa(r))){const y=po(r);h=ti(r),p.x=y.x+r.clientLeft,p.y=y.y+r.clientTop}const g=l&&!x&&!o?Xy(l,f,!0):ba(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-f.scrollLeft*h.x+p.x+g.x,y:t.y*h.y-f.scrollTop*h.y+p.y+g.y}}function AA(e){return Array.from(e.getClientRects())}function OA(e){const n=Na(e),t=a0(e),r=e.ownerDocument.body,a=ao(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=ao(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+zp(e);const c=-t.scrollTop;return Hn(r).direction==="rtl"&&(l+=ao(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function PA(e,n){const t=Tn(e),r=Na(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const h=Mp();(!h||h&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function RA(e,n){const t=po(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Sa(e)?ti(e):ba(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,h=r*o.y;return{width:l,height:c,x:f,y:h}}function ev(e,n,t){let r;if(n==="viewport")r=PA(e,t);else if(n==="document")r=OA(Na(e));else if(un(n))r=RA(n,t);else{const a=Gy(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Wu(r)}function Qy(e,n){const t=Fs(e);return t===n||!un(t)||ci(t)?!1:Hn(t).position==="fixed"||Qy(t,n)}function MA(e,n){const t=n.get(e);if(t)return t;let r=Dl(e,[],!1).filter(c=>un(c)&&mi(c)!=="body"),a=null;const o=Hn(e).position==="fixed";let l=o?Fs(e):e;for(;un(l)&&!ci(l);){const c=Hn(l),f=Rp(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Il(l)&&!f&&Qy(e,l))?r=r.filter(p=>p!==l):a=c,l=Fs(l)}return n.set(e,r),r}function IA(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?n0(n)?[]:MA(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((h,p)=>{const x=ev(n,p,a);return h.top=ao(x.top,h.top),h.right=ui(x.right,h.right),h.bottom=ui(x.bottom,h.bottom),h.left=ao(x.left,h.left),h},ev(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function jA(e){const{width:n,height:t}=Ky(e);return{width:n,height:t}}function LA(e,n,t){const r=Sa(n),a=Na(n),o=t==="fixed",l=po(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=ba(0);function h(){f.x=zp(a)}if(r||!r&&!o)if((mi(n)!=="body"||Il(a))&&(c=a0(n)),r){const y=po(n,!0,o,n);f.x=y.x+n.clientLeft,f.y=y.y+n.clientTop}else a&&h();o&&!r&&a&&h();const p=a&&!r&&!o?Xy(a,c):ba(0),x=l.left+c.scrollLeft-f.x-p.x,g=l.top+c.scrollTop-f.y-p.y;return{x,y:g,width:l.width,height:l.height}}function cd(e){return Hn(e).position==="static"}function tv(e,n){if(!Sa(e)||Hn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Na(e)===t&&(t=t.ownerDocument.body),t}function qy(e,n){const t=Tn(e);if(n0(e))return t;if(!Sa(e)){let a=Fs(e);for(;a&&!ci(a);){if(un(a)&&!cd(a))return a;a=Fs(a)}return t}let r=tv(e,n);for(;r&&lA(r)&&cd(r);)r=tv(r,n);return r&&ci(r)&&cd(r)&&!Rp(r)?t:r||cA(e)||t}const zA=async function(e){const n=this.getOffsetParent||qy,t=this.getDimensions,r=await t(e.floating);return{reference:LA(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function BA(e){return Hn(e).direction==="rtl"}const WA={convertOffsetParentRelativeRectToViewportRelativeRect:FA,getDocumentElement:Na,getClippingRect:IA,getOffsetParent:qy,getElementRects:zA,getClientRects:AA,getDimensions:jA,getScale:ti,isElement:un,isRTL:BA};function Zy(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function UA(e,n){let t=null,r;const a=Na(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const h=e.getBoundingClientRect(),{left:p,top:x,width:g,height:y}=h;if(c||n(),!g||!y)return;const k=ou(x),w=ou(a.clientWidth-(p+g)),_=ou(a.clientHeight-(x+y)),E=ou(p),T={rootMargin:-k+"px "+-w+"px "+-_+"px "+-E+"px",threshold:ao(0,ui(1,f))||1};let L=!0;function J(O){const C=O[0].intersectionRatio;if(C!==f){if(!L)return l();C?l(!1,C):r=setTimeout(()=>{l(!1,1e-7)},1e3)}C===1&&!Zy(h,e.getBoundingClientRect())&&l(),L=!1}try{t=new IntersectionObserver(J,{...T,root:a.ownerDocument})}catch{t=new IntersectionObserver(J,T)}t.observe(e)}return l(!0),o}function Jy(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,h=Lp(e),p=a||o?[...h?Dl(h):[],...Dl(n)]:[];p.forEach(E=>{a&&E.addEventListener("scroll",t,{passive:!0}),o&&E.addEventListener("resize",t)});const x=h&&c?UA(h,t):null;let g=-1,y=null;l&&(y=new ResizeObserver(E=>{let[A]=E;A&&A.target===h&&y&&(y.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var T;(T=y)==null||T.observe(n)})),t()}),h&&!f&&y.observe(h),y.observe(n));let k,w=f?po(e):null;f&&_();function _(){const E=po(e);w&&!Zy(w,E)&&t(),w=E,k=requestAnimationFrame(_)}return t(),()=>{var E;p.forEach(A=>{a&&A.removeEventListener("scroll",t),o&&A.removeEventListener("resize",t)}),x?.(),(E=y)==null||E.disconnect(),y=null,f&&cancelAnimationFrame(k)}}const ew=TA,HA=CA,tw=EA,Hd=bA,$d=(e,n,t)=>{const r=new Map,a={platform:WA,...t},o={...a.platform,_c:r};return _A(e,n,{...a,platform:o})};var gu=typeof document<"u"?N.useLayoutEffect:N.useEffect;function Hu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Hu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Hu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function rw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function rv(e,n){const t=rw(e);return Math.round(n*t)/t}function ud(e){const n=N.useRef(e);return gu(()=>{n.current=e}),n}function $A(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:h}=e,[p,x]=N.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,y]=N.useState(r);Hu(g,r)||y(r);const[k,w]=N.useState(null),[_,E]=N.useState(null),A=N.useCallback(ie=>{ie!==O.current&&(O.current=ie,w(ie))},[]),T=N.useCallback(ie=>{ie!==C.current&&(C.current=ie,E(ie))},[]),L=o||k,J=l||_,O=N.useRef(null),C=N.useRef(null),Z=N.useRef(p),M=f!=null,ne=ud(f),G=ud(a),z=ud(h),fe=N.useCallback(()=>{if(!O.current||!C.current)return;const ie={placement:n,strategy:t,middleware:g};G.current&&(ie.platform=G.current),$d(O.current,C.current,ie).then(q=>{const ae={...q,isPositioned:z.current!==!1};ue.current&&!Hu(Z.current,ae)&&(Z.current=ae,Yy.flushSync(()=>{x(ae)}))})},[g,n,t,G,z]);gu(()=>{h===!1&&Z.current.isPositioned&&(Z.current.isPositioned=!1,x(ie=>({...ie,isPositioned:!1})))},[h]);const ue=N.useRef(!1);gu(()=>(ue.current=!0,()=>{ue.current=!1}),[]),gu(()=>{if(L&&(O.current=L),J&&(C.current=J),L&&J){if(ne.current)return ne.current(L,J,fe);fe()}},[L,J,fe,ne,M]);const oe=N.useMemo(()=>({reference:O,floating:C,setReference:A,setFloating:T}),[A,T]),pe=N.useMemo(()=>({reference:L,floating:J}),[L,J]),V=N.useMemo(()=>{const ie={position:t,left:0,top:0};if(!pe.floating)return ie;const q=rv(pe.floating,p.x),ae=rv(pe.floating,p.y);return c?{...ie,transform:"translate("+q+"px, "+ae+"px)",...rw(pe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:q,top:ae}},[t,c,pe.floating,p.x,p.y]);return N.useMemo(()=>({...p,update:fe,refs:oe,elements:pe,floatingStyles:V}),[p,fe,oe,pe,V])}const YA=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?Hd({element:r.current,padding:a}).fn(t):{}:r?Hd({element:r,padding:a}).fn(t):{}}}},VA=(e,n)=>({...ew(e),options:[e,n]}),KA=(e,n)=>({...tw(e),options:[e,n]}),GA=(e,n)=>({...YA(e),options:[e,n]}),XA={...Mv};let nv=!1,QA=0;const av=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+QA++;function qA(){const[e,n]=N.useState(()=>nv?av():void 0);return Uu(()=>{e==null&&n(av())},[]),N.useEffect(()=>{nv=!0},[]),e}const ZA=XA.useId,nw=ZA||qA,JA=N.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:x,stroke:g,d:y,style:{transform:k,...w}={},..._}=n,E=nw(),[A,T]=N.useState(!1);if(Uu(()=>{if(!a)return;Hn(a).direction==="rtl"&&T(!0)},[a]),!a)return null;const[L,J]=r.split("-"),O=L==="top"||L==="bottom";let C=x;(O&&l!=null&&l.x||!O&&l!=null&&l.y)&&(C=null);const Z=p*2,M=Z/2,ne=c/2*(h/-8+1),G=f/2*h/4,z=!!y,fe=C&&J==="end"?"bottom":"top";let ue=C&&J==="end"?"right":"left";C&&A&&(ue=J==="end"?"left":"right");const oe=o?.x!=null?C||o.x:"",pe=o?.y!=null?C||o.y:"",V=y||"M0,0"+(" H"+c)+(" L"+(c-ne)+","+(f-G))+(" Q"+c/2+","+f+" "+ne+","+(f-G))+" Z",ie={top:z?"rotate(180deg)":"",left:z?"rotate(90deg)":"rotate(-90deg)",bottom:z?"":"rotate(180deg)",right:z?"rotate(-90deg)":"rotate(90deg)"}[L];return d.jsxs("svg",{..._,"aria-hidden":!0,ref:t,width:z?c:c+Z,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[ue]:oe,[fe]:pe,[L]:O||z?"100%":"calc(100% - "+Z/2+"px)",transform:[ie,k].filter(q=>!!q).join(" "),...w},children:[Z>0&&d.jsx("path",{clipPath:"url(#"+E+")",fill:"none",stroke:g,strokeWidth:Z+(y?0:1),d:V}),d.jsx("path",{stroke:Z&&!y?_.fill:"none",d:V}),d.jsx("clipPath",{id:E,children:d.jsx("rect",{x:-M,y:M*(z?-1:1),width:c+Z,height:c})})]})});function eO(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const tO=N.createContext(null),rO=N.createContext(null),nO=()=>{var e;return((e=N.useContext(tO))==null?void 0:e.id)||null},aO=()=>N.useContext(rO);function sO(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=nw(),o=N.useRef({}),[l]=N.useState(()=>eO()),c=nO()!=null,[f,h]=N.useState(r.reference),p=wA((y,k,w)=>{o.current.openEvent=y?k:void 0,l.emit("openchange",{open:y,event:k,reason:w,nested:c}),t?.(y,k,w)}),x=N.useMemo(()=>({setPositionReference:h}),[]),g=N.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return N.useMemo(()=>({dataRef:o,open:n,onOpenChange:p,elements:g,events:l,floatingId:a,refs:x}),[n,p,g,l,a,x])}function oO(e){e===void 0&&(e={});const{nodeId:n}=e,t=sO({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=N.useState(null),[c,f]=N.useState(null),p=a?.domReference||o,x=N.useRef(null),g=aO();Uu(()=>{p&&(x.current=p)},[p]);const y=$A({...e,elements:{...a,...c&&{reference:c}}}),k=N.useCallback(T=>{const L=un(T)?{getBoundingClientRect:()=>T.getBoundingClientRect(),getClientRects:()=>T.getClientRects(),contextElement:T}:T;f(L),y.refs.setReference(L)},[y.refs]),w=N.useCallback(T=>{(un(T)||T===null)&&(x.current=T,l(T)),(un(y.refs.reference.current)||y.refs.reference.current===null||T!==null&&!un(T))&&y.refs.setReference(T)},[y.refs]),_=N.useMemo(()=>({...y.refs,setReference:w,setPositionReference:k,domReference:x}),[y.refs,w,k]),E=N.useMemo(()=>({...y.elements,domReference:p}),[y.elements,p]),A=N.useMemo(()=>({...y,...r,refs:_,elements:E,nodeId:n}),[y,_,E,n,r]);return Uu(()=>{r.dataRef.current.floatingContext=A;const T=g?.nodesRef.current.find(L=>L.id===n);T&&(T.context=A)}),N.useMemo(()=>({...y,context:A,refs:_,elements:E}),[y,_,E,A])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Yd=function(n,t){return Yd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},Yd(n,t)};function Ir(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Yd(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var Nt=function(){return Nt=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Nt.apply(this,arguments)};function _a(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var iO=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return De.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},lO=function(e,n){var t=N.useRef(null),r=N.useRef(e);r.current=e;var a=N.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return N.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},s0=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=lO(t,l);return De.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},Ge;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(Ge||(Ge={}));function Bp(){var e=typeof window<"u"?window:globalThis;return e}var zl=12;function Lt(e){if(e==null)return new Date;var n=typeof e=="string"?VF(e):nt(e);return o0(n)?n:new Date}function fd(e,n,t,r,a){a===void 0&&(a=Lt());for(var o=fi(t)||fi(Wp()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var h=f[c],p=zF(e,h,a,{locale:o});if(o0(p)&&(!r||e===rr(p,h,t)))return p}return null}function o0(e,n){return Ru(e)&&!uo(e,new Date("1/1/1800"))}function rr(e,n,t){if(t==="en")return Xg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?fi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||fi(Wp()),Xg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function zn(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&rr(e,a,r)||""}function cO(e,n,t){if(!e)return"";var r=zn(e,t),a=n?zn(n,t):"";return"".concat(r," - ").concat(a)}function uO(e,n){if(!e?.length)return"";var t=e[0]?zn(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=zn(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function dd(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return hu(mu(xu(e,c),o),r)}function fO(e){return Fp(e)}function dO(e,n){return rr(e,"ddd",n)}function vu(e){return co(e)}function Ts(e,n,t){var r=fi(n||Wp());return oa(e,{locale:r,weekStartsOn:t})}function Va(e){return Ny(e)}function ol(e){return t0(e)}function sv(e){return jd(e)}function ov(){return co(Lt())}function iv(e){return Cy(e)}function pO(e){return VN(e)}function hO(e){return Dy(e)}function ga(e,n){return e&&n?$F(e,n):!e&&!n}function an(e,n){return e&&n?UF(e,n):!e&&!n}function $u(e,n){return e&&n?HF(e,n):!e&&!n}function Dt(e,n){return e&&n?$N(e,n):!e&&!n}function qs(e,n){return e&&n?$3(e,n):!e&&!n}function il(e,n,t){var r,a=co(n),o=Cy(t);try{r=Cl(e,{start:a,end:o})}catch{r=!1}return r}function xi(e,n){var t=Bp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function Wp(){var e=Bp();return e.__localeId__}function fi(e){if(typeof e=="string"){var n=Bp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function mO(e,n,t){return n(rr(e,"EEEE",t))}function xO(e,n){return rr(e,"EEEEEE",n)}function gO(e,n){return rr(e,"EEE",n)}function Up(e,n){return rr(Bn(Lt(),e),"LLLL",n)}function aw(e,n){return rr(Bn(Lt(),e),"LLL",n)}function vO(e,n){return rr(Xo(Lt(),e),"QQQ",n)}function Wn(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,h=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(p){return p instanceof Date?Dt(e,p):Dt(e,p.date)})||l&&l.some(function(p){var x=p.start,g=p.end;return Cl(e,{start:x,end:g})})||c&&!c.some(function(p){return Dt(e,p)})||f&&!f.some(function(p){var x=p.start,g=p.end;return Cl(e,{start:x,end:g})})||h&&!h(Lt(e))||!1}function Hp(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Cl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?Dt(e,o):Dt(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function sw(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r?Ny(r):void 0,maxDate:a?Dy(a):void 0})||o?.some(function(f){return an(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return an(e,f)})||c&&!c(Lt(e))||!1}function iu(e,n,t,r){var a=kt(e),o=cn(e),l=kt(n),c=cn(n),f=kt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function yO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return an(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return an(c,e)})||!1}function lu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o?.some(function(f){return $u(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return $u(e,f)})||c&&!c(Lt(e))||!1}function cu(e,n,t){if(!n||!t||!Ru(n)||!Ru(t))return!1;var r=kt(n),a=kt(t);return r<=e&&a>=e}function yu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return Bl(f,{minDate:r?t0(r):void 0,maxDate:a?Fy(a):void 0})||o?.some(function(h){return ga(f,h instanceof Date?h:h.date)})||l&&!l.some(function(h){return ga(f,h)})||c&&!c(Lt(f))||!1}function uu(e,n,t,r){var a=kt(e),o=ro(e),l=kt(n),c=ro(n),f=kt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function Bl(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&ii(e,a)<0||o&&ii(e,o)>0)!==null&&t!==void 0?t:!1}function lv(e,n){return n.some(function(t){return $a(t)===$a(e)&&Ya(t)===Ya(e)&&Ss(t)===Ss(e)})}function cv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&lv(e,r)||a&&!lv(e,a)||o&&!o(e)||!1}function uv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Lt();a=hu(a,$a(e)),a=mu(a,Ya(e)),a=xu(a,Ss(e));var o=Lt();o=hu(o,$a(t)),o=mu(o,Ya(t)),o=xu(o,Ss(t));var l=Lt();l=hu(l,$a(r)),l=mu(l,Ya(r)),l=xu(l,Ss(r));var c;try{c=!Cl(a,{start:o,end:l})}catch{c=!1}return c}function fv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=no(e,1);return r&&Mu(r,o)>0||a&&a.every(function(l){return Mu(l,o)>0})||!1}function dv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=sa(e,1);return r&&Mu(o,r)>0||a&&a.every(function(l){return Mu(o,l)>0})||!1}function wO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=t0(e),l=By(o);return r&&Iu(r,l)>0||a&&a.every(function(c){return Iu(c,l)>0})||!1}function kO(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Fy(e),l=Np(o,1);return r&&Iu(l,r)>0||a&&a.every(function(c){return Iu(l,c)>0})||!1}function pv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=li(e,1);return r&&ju(r,o)>0||a&&a.every(function(l){return ju(l,o)>0})||!1}function _O(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=ol(li(e,o)),c=bs(l,o).endPeriod,f=r&&kt(r);return f&&f>c||!1}function hv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ua(e,1);return r&&ju(o,r)>0||a&&a.every(function(l){return ju(o,l)>0})||!1}function bO(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=Ua(e,o),c=bs(l,o).startPeriod,f=r&&kt(r);return f&&f<c||!1}function ow(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)>=0});return Hg(r)}else return t?Hg(t):n}function iw(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)<=0});return Ug(r)}else return t?Ug(t):n}function mv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Ha(l)){var c=rr(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var h=Object.keys(l),p=(t=h[0])!==null&&t!==void 0?t:"",x=l[p];if(typeof p=="string"&&Array.isArray(x))for(var g=0,y=x.length;g<y;g++){var k=x[g];if(k){var c=rr(k,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(p)||(f.push(p),r.set(c,f))}}}}return r}function EO(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function SO(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Ha(a)){var l=rr(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&EO(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?_a(_a([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function TO(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,h=a[c];h&&(f=BN(f,$a(h)),f=Id(f,Ya(h)),f=HN(f,Ss(h)));var p=Id(e,(t+1)*r);Ns(f,n)&&uo(f,p)&&h!=null&&l.push(h)}return l}function xv(e){return e<10?"0".concat(e):"".concat(e)}function bs(e,n){n===void 0&&(n=zl);var t=Math.ceil(kt(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function CO(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function gv(e){var n=e.getSeconds(),t=e.getMilliseconds();return nt(e.getTime()-n*1e3-t)}function DO(e,n){return gv(e).getTime()===gv(n).getTime()}function vv(e){if(!Ha(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function yv(e,n){if(!Ha(e)||!Ha(n))throw new Error("Invalid date received");var t=vv(e),r=vv(n);return uo(t,r)}function lw(e){return e.key===Ge.Space}var NO=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=De.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),h=f?c:new Date;if(a?.includes(":")){var p=a.split(":"),x=p[0],g=p[1];h.setHours(Number(x)),h.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,h)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?N.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):De.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var h;(h=r.inputRef.current)===null||h===void 0||h.focus()},required:!0,value:a,onChange:function(h){r.onTimeChange(h.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return De.createElement("div",{className:"react-datepicker__input-time-container"},De.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),De.createElement("div",{className:"react-datepicker-time__input-container"},De.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(N.Component),FO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=N.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Ge.Space&&(r.preventDefault(),r.key=Ge.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return Dt(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Hp(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Dt(t.props.day,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&Dt(r,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=rr(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=rr(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:il(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,h=a.selectsDisabledDaysInRange,p=a.startDate,x=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!h&&t.isDisabled()?!1:l&&x&&(uo(g,x)||qs(g,x))?il(o,g,x):c&&p&&!x&&(Ns(g,p)||qs(g,p))||f&&p&&!x&&(Ns(g,p)||qs(g,p))?il(o,p,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?Dt(o,f):Dt(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,h=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?Dt(o,h):Dt(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Dt(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Dt(l,a)},t.isWeekend=function(){var r=B3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===cn(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(cn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Lt())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Br("react-datepicker__day",a,"react-datepicker__day--"+dO(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,h=t.isDisabled()||t.isExcluded()?f:l;return"".concat(h," ").concat(rr(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=rr(a,"MM.dd.yyyy"),h=[];return l.has(f)&&h.push.apply(h,l.get(f).holidayNames),t.isExcluded()&&h.push(c?.filter(function(p){return p instanceof Date?Dt(p,a):Dt(p?.date,a)}).map(function(p){if(!(p instanceof Date))return p?.message})),h.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&Dt(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Qg(t.props.day),t.props.day):Qg(t.props.day)},t.render=function(){return De.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&De.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(N.Component),AO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=N.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Ge.Space&&(r.preventDefault(),r.key=Ge.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Dt(t.props.date,t.props.selected)&&Dt(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Dt(t.props.date,t.props.selected)&&Dt(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&Dt(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&Dt(this.props.date,this.props.selected)};return De.createElement("div",{ref:this.weekNumberEl,className:Br(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(N.Component),OO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,h=new Date(r),p=0;p<7;p++){var x=new Date(r);x.setDate(x.getDate()+p);var g=!t.isDisabled(x);if(g){h=x;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(h,a,o),t.props.showWeekPicker&&t.handleDayClick(h,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):fO(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=aa(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=aa(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(De.createElement(AO,Nt({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(r,c);return De.createElement(FO,Nt({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Ts(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Dt(t.startOfWeek(),t.props.selected)&&Dt(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Dt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return De.createElement("div",{className:Br(t)},this.renderDays())},n})(N.Component),tl,PO=6,ri={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},pd=(tl={},tl[ri.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},tl[ri.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},tl[ri.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},tl),fu=1;function wv(e,n){return e?ri.FOUR_COLUMNS:n?ri.TWO_COLUMNS:ri.THREE_COLUMNS}var RO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=_a([],Array(12),!0).map(function(){return N.createRef()}),t.QUARTER_REFS=_a([],Array(4),!0).map(function(){return N.createRef()}),t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return Hp(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Bn(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:$u(Xo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Bn(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:$u(Xo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&x?iu(g,x,r,l):f&&p||h&&p&&!x?iu(p,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,h=Bn(l,r),p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?an(h,p):an(h,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,h=o.selectsRange,p=Bn(l,r),x=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||h?an(p,x):an(p,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&x?uu(g,x,r,l):f&&p||h&&p&&!x?uu(p,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=aa(r,6);return an(r,a)||an(o,a)},t.isCurrentMonth=function(r,a){return kt(r)===kt(Lt())&&a===cn(Lt())},t.isCurrentQuarter=function(r,a){return kt(r)===kt(Lt())&&a===ro(Lt())},t.isSelectedMonth=function(r,a,o){return cn(o)===a&&kt(r)===kt(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return ro(r)===a&&kt(r)===kt(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Ts(Va(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.preSelection},h=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.selected},p=t.props.selected?h(t.props.selected):void 0,x=t.props.preSelection?f(t.props.preSelection):void 0;r.push(De.createElement(OO,Nt({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:cn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:p,preSelection:x,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=Pu(c,1);var g=a&&o>=PO,y=!a&&!t.isWeekInMonth(c);if(g||y)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Va(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Va(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,h=c.preSelection,p=c.setPreSelection,x=c.minDate,g=c.maxDate,y=c.showFourColumnMonthYearPicker,k=c.showTwoColumnMonthYearPicker;if(h){var w=wv(y,k),_=t.getVerticalOffset(w),E=(l=pd[w])===null||l===void 0?void 0:l.grid,A=function(C,Z,M){var ne,G,z=Z,fe=M;switch(C){case Ge.ArrowRight:z=sa(Z,fu),fe=M===11?0:M+fu;break;case Ge.ArrowLeft:z=no(Z,fu),fe=M===0?11:M-fu;break;case Ge.ArrowUp:z=no(Z,_),fe=!((ne=E?.[0])===null||ne===void 0)&&ne.includes(M)?M+12-_:M-_;break;case Ge.ArrowDown:z=sa(Z,_),fe=!((G=E?.[E.length-1])===null||G===void 0)&&G.includes(M)?M-12+_:M+_;break}return{newCalculatedDate:z,newCalculatedMonth:fe}},T=function(C,Z,M){for(var ne=40,G=C,z=!1,fe=0,ue=A(G,Z,M),oe=ue.newCalculatedDate,pe=ue.newCalculatedMonth;!z;){if(fe>=ne){oe=Z,pe=M;break}if(x&&oe<x){G=Ge.ArrowRight;var V=A(G,oe,pe);oe=V.newCalculatedDate,pe=V.newCalculatedMonth}if(g&&oe>g){G=Ge.ArrowLeft;var V=A(G,oe,pe);oe=V.newCalculatedDate,pe=V.newCalculatedMonth}if(yO(oe,t.props)){var V=A(G,oe,pe);oe=V.newCalculatedDate,pe=V.newCalculatedMonth}else z=!0;fe++}return{newCalculatedDate:oe,newCalculatedMonth:pe}};if(a===Ge.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),p?.(f));return}var L=T(a,h,o),J=L.newCalculatedDate,O=L.newCalculatedMonth;switch(a){case Ge.ArrowRight:case Ge.ArrowLeft:case Ge.ArrowUp:case Ge.ArrowDown:t.handleMonthNavigation(O,J);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=pd[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==Ge.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Xo(t.props.day,a);lu(o,t.props)||t.handleDayClick(sv(o),r)},t.onQuarterMouseEnter=function(r){var a=Xo(t.props.day,r);lu(a,t.props)||t.handleDayMouseEnter(sv(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case Ge.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case Ge.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Np(t.props.preSelection,1));break;case Ge.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,By(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,x=Bn(l,r);return{isDisabled:(a=(c||f||h||p)&&sw(x,t.props))!==null&&a!==void 0?a:!1,labelDate:x}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,h=a.monthClassName,p=h?h(Bn(o,r)):void 0,x=t.getSelection();return Br("react-datepicker__month-text","react-datepicker__month-".concat(r),p,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":x?t.isSelectMonthInList(o,r,x):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?iu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=cn(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=ro(t.props.preSelection),o=lu(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,h=a.day,p=a.locale,x=Bn(h,r),g=t.isDisabled(x)||t.isExcluded(x)?f:l;return"".concat(g," ").concat(rr(x,"MMMM yyyy",p))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,h=a.minDate,p=a.maxDate,x=a.excludeDates,g=a.includeDates,y=a.filterDate,k=a.preSelection,w=a.disabledKeyboardNavigation,_=(h||p||x||g||y)&&lu(Xo(o,r),t.props);return Br("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":_,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!w&&k&&t.isSelectedQuarter(o,r,k)&&!_,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,h=aw(r,c),p=Up(r,c);return l?l(r,h,p,f):o?p:h},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=vO(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,h=(r=pd[wv(l,o)])===null||r===void 0?void 0:r.grid;return h?.map(function(p,x){return De.createElement("div",{className:"react-datepicker__month-wrapper",key:x},p.map(function(g,y){return De.createElement("div",{ref:t.MONTH_REFS[g],key:y,onClick:function(k){t.onMonthClick(k,g)},onKeyDown:function(k){lw(k)&&(k.preventDefault(),k.key=Ge.Enter),t.onMonthKeyDown(k,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return De.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return De.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(h){t.onQuarterClick(h,c)},onKeyDown:function(h){t.onQuarterKeyDown(h,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,h=r.showWeekPicker;return Br("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":h})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return De.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(rr(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(N.Component),MO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return De.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?De.createElement("span",{className:"react-datepicker__month-option--selected"},"✓"):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return De.createElement(s0,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(N.Component),IO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return De.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return De.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return De.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},De.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),De.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return De.createElement(MO,Nt({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return aw(o,t.props.locale)}:function(o){return Up(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return De.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(N.Component);function jO(e,n){for(var t=[],r=Va(e),a=Va(n);!Ns(r,a);)t.push(Lt(r)),r=sa(r,1);return t}var LO=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=zd(a),l=ga(r.props.date,a)&&an(r.props.date,a);return De.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?De.createElement("span",{className:"react-datepicker__month-year-option--selected"},"✓"):"",rr(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:jO(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Br({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return De.createElement(s0,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(N.Component),zO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Va(t.props.minDate),a=Va(t.props.maxDate),o=[];!Ns(r,a);){var l=zd(r);o.push(De.createElement("option",{key:l,value:l},rr(r,t.props.dateFormat,t.props.locale))),r=sa(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return De.createElement("select",{value:zd(Va(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=rr(t.props.date,t.props.dateFormat,t.props.locale);return De.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},De.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),De.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return De.createElement(LO,Nt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Lt(r);ga(t.props.date,a)&&an(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return De.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(N.Component),BO=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&DO(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&($a(r)*3600+Ya(r)*60+Ss(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===Ge.Space&&(r.preventDefault(),r.key=Ge.Enter),(r.key===Ge.ArrowUp||r.key===Ge.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===Ge.ArrowDown||r.key===Ge.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===Ge.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Lt(),f=vu(c),h=t.props.injectTimes&&t.props.injectTimes.sort(function(_,E){return _.getTime()-E.getTime()}),p=60*CO(c),x=p/l,g=0;g<x;g++){var y=Id(f,g*l);if(a.push(y),h){var k=TO(f,y,g,l,h);a=a.concat(k)}}var w=a.reduce(function(_,E){return E.getTime()<=c.getTime()?E:_},a[0]);return a.map(function(_){return De.createElement("li",{key:_.valueOf(),onClick:t.handleClick.bind(t,_),className:t.liClasses(_),ref:function(E){_===w&&(t.centerLi=E)},onKeyDown:function(E){t.handleOnKeyDown(E,_)},tabIndex:_===w?0:-1,role:"option","aria-selected":t.isSelectedTime(_)?"true":void 0,"aria-disabled":t.isDisabledTime(_)?"true":void 0},rr(_,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?De.createElement(De.Fragment,null):De.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},De.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return De.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),De.createElement("div",{className:"react-datepicker__time"},De.createElement("div",{className:"react-datepicker__time-box"},De.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(N.Component),kv=3,WO=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=_a([],Array(r.props.yearItemNumber),!0).map(function(){return N.createRef()}),r.isDisabled=function(a){return Wn(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return Hp(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,h,p=r.props,x=p.date,g=p.yearItemNumber;if(!(x===void 0||g===void 0)){var y=bs(x,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-y<0?r.updateFocusOnPaginate(g-(y-a)):a-y>=g?r.updateFocusOnPaginate(Math.abs(g-(a-y))):(h=(f=r.YEAR_REFS[a-y])===null||f===void 0?void 0:f.current)===null||h===void 0||h.focus())}},r.isSameDay=function(a,o){return Dt(a,o)},r.isCurrentYear=function(a){return a===kt(Lt())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&ga(xa(Lt(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&ga(xa(Lt(),a),r.props.endDate)},r.isInRange=function(a){return cu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,h=o.startDate,p=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&p?cu(a,r.selectingDate(),p):c&&h||f&&h&&!p?cu(a,h,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,h=xa(Lt(),a);return f?ga(h,(o=r.selectingDate())!==null&&o!==void 0?o:null):ga(h,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,h=l.selectsRange,p=xa(Lt(),a);return f||h?ga(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):ga(p,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,h=o.includeDates,p=o.filterDate,x=ol(xa(r.props.date,a)),g=(l||c||f||h||p)&&yu(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Dt(x,ol(r.props.selected))&&Dt(x,ol(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(h){return a===kt(h)}):!c||a===kt(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ol(xa(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,h=r.props,p=h.date,x=h.yearItemNumber,g=h.handleOnKeyDown;if(f!==Ge.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case Ge.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case Ge.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Ua(r.props.preSelection,1));break;case Ge.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,li(r.props.preSelection,1));break;case Ge.ArrowUp:{if(p===void 0||x===void 0||r.props.preSelection==null)break;var y=bs(p,x).startPeriod,k=kv,w=o-k;if(w<y){var _=x%k;o>=y&&o<y+_?k=_:k+=_,w=o-k}r.handleYearNavigation(w,li(r.props.preSelection,k));break}case Ge.ArrowDown:{if(p===void 0||x===void 0||r.props.preSelection==null)break;var E=bs(p,x).endPeriod,k=kv,w=o+k;if(w>E){var _=x%k;o<=E&&o>E-_?k=_:k+=_,w=o+k}r.handleYearNavigation(w,Ua(r.props.preSelection,k));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,x=o.filterDate,g=o.yearClassName;return Br("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(xa(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||h||p||x)&&yu(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=kt(r.props.preSelection),l=yu(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var h=bs(o,l),p=h.startPeriod,x=h.endPeriod,g=function(w){r.push(De.createElement("div",{ref:y.YEAR_REFS[w-p],onClick:function(_){t.onYearClick(_,w)},onKeyDown:function(_){lw(_)&&(_.preventDefault(),_.key=Ge.Enter),t.onYearKeyDown(_,w)},tabIndex:Number(y.getYearTabIndex(w)),className:y.getYearClassNames(w),onMouseEnter:y.props.usePointerEvent?void 0:function(_){return c(_,w)},onPointerEnter:y.props.usePointerEvent?function(_){return c(_,w)}:void 0,onMouseLeave:y.props.usePointerEvent?void 0:function(_){return f(_,w)},onPointerLeave:y.props.usePointerEvent?function(_){return f(_,w)}:void 0,key:w,"aria-current":y.isCurrentYear(w)?"date":void 0},y.getYearContent(w)))},y=this,k=p;k<=x;k++)g(k);return De.createElement("div",{className:"react-datepicker__year"},De.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(N.Component);function UO(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=kt(t)<=l),r&&c&&(c=kt(r)>=l),c&&a.push(l)}return a}var HO=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(x){return De.createElement("div",{className:c===x?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:x,onClick:r.onChange.bind(r,x),"aria-selected":c===x?"true":void 0},c===x?De.createElement("span",{className:"react-datepicker__year-option--selected"},"✓"):"",x)}),h=r.props.minDate?kt(r.props.minDate):null,p=r.props.maxDate?kt(r.props.maxDate):null;return(!p||!r.state.yearsList.find(function(x){return x===p}))&&f.unshift(De.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},De.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!h||!r.state.yearsList.find(function(x){return x===h}))&&f.push(De.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},De.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(h){return h+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:UO(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=N.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Br({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return De.createElement(s0,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(N.Component),$O=(function(e){Ir(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?kt(t.props.minDate):1900,a=t.props.maxDate?kt(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(De.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return De.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return De.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},De.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),De.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return De.createElement(HO,Nt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return De.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(N.Component),YO=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],VO=function(e){var n=(e.className||"").split(/\s+/);return YO.some(function(t){return n.indexOf(t)>=0})},KO=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;VO(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=ow(r.props),h=iw(r.props),p=Lt(),x=c||l||o;return x||(f&&uo(p,f)?f:h&&Ns(p,h)?h:p)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:sa(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:no(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:xa(Lt(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!Wn(a,r.props))return a;for(var o=Va(a),l=hO(a),c=YN(l,o),f=null,h=0;h<=c;h++){var p=aa(o,h);if(!Wn(p,r.props)){f=p;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:xa(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Bn(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:xa(Bn(l,cn(a)),kt(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Ts(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(De.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(o,c),h=r.formatWeekday(f,r.props.locale),p=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return De.createElement("div",{key:c,"aria-label":rr(f,"EEEE",r.props.locale),className:Br("react-datepicker__day-name",p)},h)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?mO(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?gO(a,o):xO(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:li(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,p=no(r.state.date,h),x;switch(!0){case r.props.showMonthYearPicker:x=pv(r.state.date,r.props);break;case r.props.showYearPicker:x=_O(r.state.date,r.props);break;case r.props.showQuarterYearPicker:x=wO(r.state.date,r.props);break;default:x=fv(p,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&x||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],y=["react-datepicker__navigation","react-datepicker__navigation--previous"],k=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(k=r.decreaseYear),x&&r.props.showDisabledMonthNavigation&&(y.push("react-datepicker__navigation--previous--disabled"),k=void 0);var w=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,_=r.props,E=_.previousMonthButtonLabel,A=E===void 0?n.defaultProps.previousMonthButtonLabel:E,T=_.previousYearButtonLabel,L=T===void 0?n.defaultProps.previousYearButtonLabel:T,J=r.props,O=J.previousMonthAriaLabel,C=O===void 0?typeof A=="string"?A:"Previous Month":O,Z=J.previousYearAriaLabel,M=Z===void 0?typeof L=="string"?L:"Previous Year":Z;return De.createElement("button",{type:"button",className:y.join(" "),onClick:k,onKeyDown:r.props.handleOnKeyDown,"aria-label":w?M:C},De.createElement("span",{className:g.join(" ")},w?L:A))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Ua(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=hv(r.state.date,r.props);break;case r.props.showYearPicker:o=bO(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=kO(r.state.date,r.props);break;default:o=dv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,x=p.nextMonthButtonLabel,g=x===void 0?n.defaultProps.nextMonthButtonLabel:x,y=p.nextYearButtonLabel,k=y===void 0?n.defaultProps.nextYearButtonLabel:y,w=r.props,_=w.nextMonthAriaLabel,E=_===void 0?typeof g=="string"?g:"Next Month":_,A=w.nextYearAriaLabel,T=A===void 0?typeof k=="string"?k:"Next Year":A;return De.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":h?T:E},De.createElement("span",{className:c.join(" ")},h?k:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),De.createElement("h2",{className:o.join(" ")},rr(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return De.createElement($O,Nt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:kt(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return De.createElement(IO,Nt({},n.defaultProps,r.props,{month:cn(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return De.createElement(zO,Nt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(ov(),a),r.props.setPreSelection&&r.props.setPreSelection(ov())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return De.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return De.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),De.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),De.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var h=fv(r.state.date,r.props),p=dv(r.state.date,r.props),x=pv(r.state.date,r.props),g=hv(r.state.date,r.props),y=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return De.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,Nt(Nt({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:p,prevYearButtonDisabled:x,nextYearButtonDisabled:g})),y&&De.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,h=f===void 0?n.defaultProps.yearItemNumber:f,p=bs(o,h),x=p.startPeriod,g=p.endPeriod;return De.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(x," - ").concat(g):kt(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(r.state.date,f):no(r.state.date,f),p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,x=0;x<c;++x){var g=x-p+f,y=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(h,g):sa(h,g),k="month-".concat(x),w=x<c-1,_=x>0;l.push(De.createElement("div",{key:k,ref:function(E){r.monthContainer=E??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:y,i:x}),De.createElement(RO,Nt({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:y,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:x,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:w,monthShowsDuplicateDaysStart:_}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return De.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),De.createElement(WO,Nt({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return De.createElement(BO,Nt({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&o0(a)&&!!r.props.selected,l=o?"".concat(xv(a.getHours()),":").concat(xv(a.getMinutes())):"";if(r.props.showTimeInput)return De.createElement(NO,Nt({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=bs(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=kt(r.state.date):f="".concat(Up(cn(r.state.date),r.props.locale)," ").concat(kt(r.state.date)),De.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return De.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=N.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:zl}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!Dt(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!an(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!Dt(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||iO;return De.createElement(s0,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},De.createElement("div",{style:{display:"contents"},ref:this.containerRef},De.createElement(t,{className:Br("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(N.Component),GO=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return De.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(De.isValidElement(n)){var l=n;return De.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return De.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},De.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},cw=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return kA.createPortal(this.props.children,this.el)},n})(N.Component),XO="[tabindex], a, button, input, select, textarea",QO=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},uw=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(XO),1,-1).filter(QO)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=N.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?De.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},De.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,De.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(N.Component);function qO(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=N.useRef(null),l=oO(Nt({open:!a,whileElementsMounted:Jy,placement:t.popperPlacement,middleware:_a([KA({padding:15}),VA(10),GA({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=Nt(Nt({},t),{hidePopper:a,popperProps:Nt(Nt({},l),{arrowRef:o})});return De.createElement(e,Nt({},c))};return n}var ZO=(function(e){Ir(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,h=t.enableTabLoop,p=t.popperOnKeyDown,x=t.portalId,g=t.portalHost,y=t.popperProps,k=t.showArrow,w=void 0;if(!l){var _=Br("react-datepicker-popper",r);w=De.createElement(uw,{enableTabLoop:h},De.createElement("div",{ref:y.refs.setFloating,style:y.floatingStyles,className:_,"data-placement":y.placement,onKeyDown:p},c,k&&De.createElement(JA,{ref:y.arrowRef,context:y.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(w=N.createElement(this.props.popperContainer,{},w)),x&&!l&&(w=De.createElement(cw,{portalId:x,portalHost:g},w));var E=Br("react-datepicker-wrapper",a);return De.createElement(De.Fragment,null,De.createElement("div",{ref:y.refs.setReference,className:E},f),w)},n})(N.Component),JO=qO(ZO),_v="react-datepicker-ignore-onclickoutside";function eP(e,n){return e&&n?cn(e)!==cn(n)||kt(e)!==kt(n):e!==n}var hd="Date input not valid.",As=(function(e){Ir(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Lt()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return o0(c)?_a(_a([],o,!0),[Nt(Nt({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=ow(r.props),c=iw(r.props),f=l&&uo(o,vu(l))?l:c&&Ns(o,iv(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:mv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(Nt(Nt({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(Nt(Nt({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:md},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Ha(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var x=h[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,h),!x||typeof x.isDefaultPrevented!="function"||x.isDefaultPrevented()))){r.setState({inputValue:x?.target instanceof HTMLInputElement?x.target.value:null,lastPreSelectChange:tP});var g=r.props,y=g.selectsRange,k=g.startDate,w=g.endDate,_=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,E=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,A=x?.target instanceof HTMLInputElement?x.target.value:"";if(y){var T=A.split("-",2).map(function(G){return G.trim()}),L=T[0],J=T[1],O=fd(L??"",_,r.props.locale,E),C=fd(J??"",_,r.props.locale,E),Z=k?.getTime()!==O?.getTime(),M=w?.getTime()!==C?.getTime();if(!Z&&!M||O&&Wn(O,r.props)||C&&Wn(C,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[O,C],x)}else{var ne=fd(A,_,r.props.locale,E,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(ne||!A)&&r.setSelected(ne,x,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,h=c.endDate;f&&!h&&(r.props.swapRange||!yv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,h,p=a;if(r.props.showYearPicker){if(p!==null&&yu(kt(p),r.props))return}else if(r.props.showMonthYearPicker){if(p!==null&&sw(p,r.props))return}else if(p!==null&&Wn(p,r.props))return;var x=r.props,g=x.onChange,y=x.selectsRange,k=x.startDate,w=x.endDate,_=x.selectsMultiple,E=x.selectedDates,A=x.minTime,T=x.swapRange;if(!qs(r.props.selected,p)||r.props.allowSameDay||y||_)if(p!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(p=dd(p,{hour:$a(r.props.selected),minute:Ya(r.props.selected),second:Ss(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&A&&(p=dd(p,{hour:A.getHours(),minute:A.getMinutes(),second:A.getSeconds()})),r.props.inline||r.setState({preSelection:p}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),y){var L=!k&&!w,J=k&&!w,O=k&&w;L?g?.([p,null],o):J&&(p===null?g?.([null,null],o):yv(p,k)?g?.(T?[p,k]:[p,null],o):g?.([k,p],o)),O&&g?.([p,null],o)}else if(_){if(p!==null)if(!E?.length)g?.([p],o);else{var C=E.some(function(M){return Dt(M,p)});if(C){var Z=E.filter(function(M){return!Dt(M,p)});g?.(Z,o)}else g?.(_a(_a([],E,!0),[p],!1),o)}}else g?.(p,o);l||((h=(f=r.props).onSelect)===null||h===void 0||h.call(f,p,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Ha(r.props.minDate),l=Ha(r.props.maxDate),c=!0;if(a){var f=vu(a);if(o&&l)c=il(a,r.props.minDate,r.props.maxDate);else if(o){var h=vu(r.props.minDate);c=Ns(a,h)||qs(f,h)}else if(l){var p=iv(r.props.maxDate);c=uo(a,p)||qs(f,p)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:dd(c,{hour:$a(a),minute:Ya(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,h,p;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var x=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(x===Ge.ArrowDown||x===Ge.ArrowUp||x===Ge.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(x===Ge.ArrowDown||x===Ge.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',y=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);y instanceof HTMLElement&&y.focus({preventScroll:!0});return}var k=Lt(r.state.preSelection);x===Ge.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===md?(r.handleSelect(k,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(k)):r.setOpen(!1)):x===Ge.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):x===Ge.Tab&&r.setOpen(!1),r.inputOk()||(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hd})}},r.onPortalKeyDown=function(a){var o=a.key;o===Ge.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,h,p,x=r.props,g=x.minDate,y=x.maxDate,k=x.disabledKeyboardNavigation,w=x.showWeekPicker,_=x.shouldCloseOnSelect,E=x.locale,A=x.calendarStartDay,T=x.adjustDateOnChange,L=x.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!k){var J=a.key,O=a.shiftKey,C=Lt(r.state.preSelection),Z=function(oe,pe){var V=pe;switch(oe){case Ge.ArrowRight:V=w?Pu(pe,1):aa(pe,1);break;case Ge.ArrowLeft:V=w?qg(pe):YF(pe);break;case Ge.ArrowUp:V=qg(pe);break;case Ge.ArrowDown:V=Pu(pe,1);break;case Ge.PageUp:V=O?li(pe,1):no(pe,1);break;case Ge.PageDown:V=O?Ua(pe,1):sa(pe,1);break;case Ge.Home:V=Ts(pe,E,A);break;case Ge.End:V=pO(pe);break}return V},M=function(oe,pe){for(var V=40,ie=oe,q=!1,ae=0,B=Z(oe,pe);!q;){if(ae>=V){B=pe;break}g&&B<g&&(ie=Ge.ArrowRight,B=Wn(g,r.props)?Z(ie,B):g),y&&B>y&&(ie=Ge.ArrowLeft,B=Wn(y,r.props)?Z(ie,B):y),Wn(B,r.props)?((ie===Ge.PageUp||ie===Ge.Home)&&(ie=Ge.ArrowRight),(ie===Ge.PageDown||ie===Ge.End)&&(ie=Ge.ArrowLeft),B=Z(ie,B)):q=!0,ae++}return B};if(J===Ge.Enter){a.preventDefault(),r.handleSelect(C,a),!_&&r.setPreSelection(C);return}else if(J===Ge.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:hd});return}var ne=null;switch(J){case Ge.ArrowLeft:case Ge.ArrowRight:case Ge.ArrowUp:case Ge.ArrowDown:case Ge.PageUp:case Ge.PageDown:case Ge.Home:case Ge.End:ne=M(J,C);break}if(!ne){(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hd});return}if(a.preventDefault(),r.setState({lastPreSelectChange:md}),T&&r.setSelected(ne),r.setPreSelection(ne),L){var G=cn(C),z=cn(ne),fe=kt(C),ue=kt(ne);G!==z||fe!==ue?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===Ge.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:De.createElement(KO,Nt({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:SO(r.modifyHolidays()),outsideClickIgnoreClass:_v,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,h=f?"PPPPp":"PPPP",p;return r.props.selectsRange?p="Selected start date: ".concat(zn(r.props.startDate,{dateFormat:h,locale:c}),". ").concat(r.props.endDate?"End date: "+zn(r.props.endDate,{dateFormat:h,locale:c}):""):r.props.showTimeSelectOnly?p="Selected time: ".concat(zn(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?p="Selected year: ".concat(zn(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?p="Selected month: ".concat(zn(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?p="Selected quarter: ".concat(zn(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):p="Selected date: ".concat(zn(r.props.selected,{dateFormat:h,locale:c})),De.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},p)},r.renderDateInput=function(){var a,o,l,c=Br(r.props.className,(a={},a[_v]=r.state.open,a)),f=r.props.customInput||De.createElement("input",{type:"text"}),h=r.props.customInputRef||"ref",p=r.props,x=p.dateFormat,g=x===void 0?n.defaultProps.dateFormat:x,y=p.locale,k=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?cO(r.props.startDate,r.props.endDate,{dateFormat:g,locale:y}):r.props.selectsMultiple?uO((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:y}):zn(r.props.selected,{dateFormat:g,locale:y});return N.cloneElement(f,(o={},o[h]=function(w){r.input=w},o.value=k,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Br(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,h=a.endDate,p=a.clearButtonTitle,x=a.clearButtonClassName,g=x===void 0?"":x,y=a.ariaLabelClose,k=y===void 0?"Close":y,w=a.selectedDates;return o&&(c!=null||f!=null||h!=null||w?.length)?De.createElement("button",{type:"button",className:Br("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":k,onClick:r.onClearClick,title:p,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:zl,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&eP(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:mv(this.props.highlightDates)}),!r.focused&&!qs(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),De.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&De.createElement(GO,Nt({icon:a,className:Br(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?De.createElement(uw,{enableTabLoop:this.props.enableTabLoop},De.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=De.createElement(cw,Nt({portalId:this.props.portalId},this.props),r)),De.createElement("div",null,this.renderInputContainer(),r)}return De.createElement(JO,Nt({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(N.Component),tP="input",md="navigate";const rP={lessThanXSeconds:{one:{regular:"mniej niż sekunda",past:"mniej niż sekundę",future:"mniej niż sekundę"},twoFour:"mniej niż {{count}} sekundy",other:"mniej niż {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekundę",future:"sekundę"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"pół minuty",twoFour:"pół minuty",other:"pół minuty"},lessThanXMinutes:{one:{regular:"mniej niż minuta",past:"mniej niż minutę",future:"mniej niż minutę"},twoFour:"mniej niż {{count}} minuty",other:"mniej niż {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minutę",future:"minutę"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"około godziny",past:"około godziny",future:"około godzinę"},twoFour:"około {{count}} godziny",other:"około {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzinę",future:"godzinę"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzień",past:"dzień",future:"1 dzień"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"około tygodnia",twoFour:"około {{count}} tygodni",other:"około {{count}} tygodni"},xWeeks:{one:"tydzień",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"około miesiąc",twoFour:"około {{count}} miesiące",other:"około {{count}} miesięcy"},xMonths:{one:"miesiąc",twoFour:"{{count}} miesiące",other:"{{count}} miesięcy"},aboutXYears:{one:"około rok",twoFour:"około {{count}} lata",other:"około {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function nP(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function xd(e,n,t){const r=nP(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const aP=(e,n,t)=>{const r=rP[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+xd(r,n,"future"):xd(r,n,"past")+" temu":xd(r,n,"regular")},sP={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},oP={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},iP={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},lP={date:ei({formats:sP,defaultWidth:"full"}),time:ei({formats:oP,defaultWidth:"full"}),dateTime:ei({formats:iP,defaultWidth:"full"})},cP={masculine:"ostatni",feminine:"ostatnia"},uP={masculine:"ten",feminine:"ta"},fP={masculine:"następny",feminine:"następna"},dP={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function bv(e,n,t,r){let a;if(WF(n,t,r))a=uP;else if(e==="lastWeek")a=cP;else if(e==="nextWeek")a=fP;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=dP[o];return`'${a[l]}' eeee 'o' p`}const pP={lastWeek:bv,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:bv,other:"P"},hP=(e,n,t,r)=>{const a=pP[e];return typeof a=="function"?a(e,n,t,r):a},mP={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed naszą erą","naszej ery"]},xP={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwartał","II kwartał","III kwartał","IV kwartał"]},gP={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"]},vP={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"]},yP={narrow:["N","P","W","Ś","C","P","S"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},wP={narrow:["n","p","w","ś","c","p","s"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},kP={narrow:{am:"a",pm:"p",midnight:"półn.",noon:"poł",morning:"rano",afternoon:"popoł.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"}},_P={narrow:{am:"a",pm:"p",midnight:"o półn.",noon:"w poł.",morning:"rano",afternoon:"po poł.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"}},bP=(e,n)=>String(e),EP={ordinalNumber:bP,era:va({values:mP,defaultWidth:"wide"}),quarter:va({values:xP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:va({values:gP,defaultWidth:"wide",formattingValues:vP,defaultFormattingWidth:"wide"}),day:va({values:yP,defaultWidth:"wide",formattingValues:wP,defaultFormattingWidth:"wide"}),dayPeriod:va({values:kP,defaultWidth:"wide",formattingValues:_P,defaultFormattingWidth:"wide"})},SP=/^(\d+)?/i,TP=/\d+/i,CP={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(ą|a)\s*er(ą|a)|naszej\s*ery)/i},DP={any:[/^p/i,/^n/i]},NP={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(ł|l)/i},FP={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},AP={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(ź|z)|lis|gru)/i,wide:/^(stycznia|stycze(ń|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(ń|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(ń|n)|wrze(ś|s)nia|wrzesie(ń|n)|pa(ź|z)dziernika|pa(ź|z)dziernik|listopada|listopad|grudnia|grudzie(ń|n))/i},OP={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},PP={narrow:/^[npwścs]/i,short:/^(nie|pon|wto|(ś|s)ro|czw|pi(ą|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(ś|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(ł|l)ek|wtorek|(ś|s)roda|czwartek|pi(ą|a)tek|sobota)/i},RP={narrow:[/^n/i,/^p/i,/^w/i,/^ś/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pi/i,/^so/i]},MP={narrow:/^(^a$|^p$|pó(ł|l)n\.?|o\s*pó(ł|l)n\.?|po(ł|l)\.?|w\s*po(ł|l)\.?|po\s*po(ł|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|pó(ł|l)noc|o\s*pó(ł|l)nocy|po(ł|l)udnie|w\s*po(ł|l)udnie|popo(ł|l)udnie|po\s*po(ł|l)udniu|rano|wieczór|wieczorem|noc|w\s*nocy)/i},IP={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i}},jP={ordinalNumber:Ay({matchPattern:SP,parsePattern:TP,valueCallback:e=>parseInt(e,10)}),era:ya({matchPatterns:CP,defaultMatchWidth:"wide",parsePatterns:DP,defaultParseWidth:"any"}),quarter:ya({matchPatterns:NP,defaultMatchWidth:"wide",parsePatterns:FP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ya({matchPatterns:AP,defaultMatchWidth:"wide",parsePatterns:OP,defaultParseWidth:"any"}),day:ya({matchPatterns:PP,defaultMatchWidth:"wide",parsePatterns:RP,defaultParseWidth:"any"}),dayPeriod:ya({matchPatterns:MP,defaultMatchWidth:"any",parsePatterns:IP,defaultParseWidth:"any"})},gi={code:"pl",formatDistance:aP,formatLong:lP,formatRelative:hP,localize:EP,match:jP,options:{weekStartsOn:1,firstWeekContainsDate:4}};xi("pl",gi);const gd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],LP=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],zP=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=N.useState(null),[o,l]=N.useState(""),[c,f]=N.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[h,p]=N.useState(""),[x,g]=N.useState(null),[y,k]=N.useState(null),w=N.useRef(null),_=N.useRef(null),[E,A]=N.useState(null),[T,L]=N.useState(null),[J,O]=N.useState("0,00"),[C,Z]=N.useState("0,00"),[M,ne]=N.useState("0,00"),G=()=>{const H=c.reduce((se,Q)=>{const he=parseFloat(Q.ilosc.toString().replace(",","."))||0;return se+he},0),ee=parseFloat(h.replace(",","."))||0;return H>0?(ee/H).toFixed(2):"0,00"},z=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},fe=H=>{if(c.length>1){const ee=[...c];ee.splice(H,1),f(ee)}},ue=H=>{const ee=[...c];ee[H].showDataWaznosci=!ee[H].showDataWaznosci,f(ee)},oe=H=>{const ee=H.target.files?.[0];console.log("📎 Product file selected:",ee),ee&&ee.type==="application/pdf"?(g(ee),console.log("✅ Product invoice set:",ee.name)):console.log("❌ Invalid product file type:",ee?.type)},pe=H=>{const ee=H.target.files?.[0];console.log("📎 Transport file selected:",ee),ee&&ee.type==="application/pdf"?(k(ee),console.log("✅ Transport invoice set:",ee.name)):console.log("❌ Invalid transport file type:",ee?.type)},V=()=>{w.current?.click()},ie=()=>{_.current?.click()},q=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",h),console.log("productRows:",c),!r||!c.some(Ce=>Ce.kod&&Ce.nazwa&&Ce.ilosc&&Ce.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(Ce=>Ce.kod&&Ce.nazwa&&Ce.ilosc&&Ce.cena));return}const H=parseFloat(J.replace(",","."))||1,ee=c.reduce((Ce,ge)=>Ce+(parseFloat(ge.ilosc)||0),0),se=ee>0?parseFloat(h.replace(",","."))/ee*H:0,Q=c.filter(Ce=>Ce.kod&&Ce.nazwa&&Ce.ilosc&&Ce.cena).map(Ce=>({kod:Ce.kod,nazwa:Ce.nazwa,kod_kreskowy:Ce.kod_kreskowy||"",ilosc:parseFloat(Ce.ilosc)||0,cena:parseFloat(Ce.cena.replace(",","."))||0,dataWaznosci:Ce.dataWaznosci?Ce.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:Ce.typ||void 0,objetosc:Ce.objetosc||void 0,deliveryCostPerUnitPln:se,podatekAkcyzowyPerLiter:parseFloat(C.replace(",","."))||0}));console.log("formattedProducts:",Q);const he=Q.reduce((Ce,ge)=>Ce+ge.ilosc*ge.cena,0),me=parseFloat(h.replace(",","."))||0,I=parseFloat(M.replace(",","."))||0,Ve=he*(1-I/100);console.log("totalValue:",he),console.log("rabat:",I+"%"),console.log("wartoscZRabatem:",Ve),console.log("deliveryCost:",me),console.log("📎 Files to submit:",{productInvoice:x,transportInvoice:y}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:Ve,kosztDostawy:me,aktualnyKurs:parseFloat(J.replace(",","."))||1,podatekAkcyzowy:C,rabat:M,products:Q,productInvoice:x||null,transportInvoice:y||null}),ae()},ae=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),p(""),l(""),O("0,00"),Z("0,00"),ne("0,00"),g(null),k(null),n()},B=()=>c.reduce((H,ee)=>{const se=parseFloat(ee.ilosc)||0,Q=parseFloat(ee.cena.replace(",","."))||0;return H+se*Q},0).toFixed(2),S=(H,ee)=>{const se=[...c];se[H].typ=ee,f(se),A(null)},R=H=>{A(E===H?null:H)},P=H=>{L(T===H?null:H)},W=(H,ee)=>{const se=[...c];se[H].objetosc=ee,f(se),L(null)};return N.useEffect(()=>{const H=se=>{const Q=se.target;if(!Q.closest(".react-datepicker")&&!Q.closest('button[title*="ważności"]')){const he=[...c];let me=!1;he.forEach(I=>{I.showDataWaznosci&&(I.showDataWaznosci=!1,me=!0)}),me&&f(he)}E!==null&&(Q.closest(".dropdown-container")||A(null)),T!==null&&(Q.closest(".dropdown-container")||L(null))},ee=se=>{se.key==="Escape"&&(A(null),L(null))};return document.addEventListener("mousedown",H),document.addEventListener("keydown",ee),()=>{document.removeEventListener("mousedown",H),document.removeEventListener("keydown",ee)}},[E,T,c]),d.jsx(Mr,{isOpen:e,onRequestClose:ae,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),d.jsx("button",{onClick:ae,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),d.jsx(As,{selected:r,onChange:H=>a(H),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsx("div",{className:"w-[200px] flex items-start",children:d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:h,onKeyPress:H=>{const ee=String.fromCharCode(H.which);(!/[\d,]/.test(ee)||ee===","&&H.target.value.includes(",")||H.target.value===""&&ee===",")&&H.preventDefault()},onChange:H=>{const ee=H.target,se=ee.selectionStart??0;let Q=ee.value.replace(/[^\d,]/g,"");if(Q===""){p("");return}if(!Q.includes(","))Q=Q+",00";else{const[me,I]=Q.split(",");I&&I.length>2&&(Q=`${me},${I.slice(0,2)}`)}p(Q),requestAnimationFrame(()=>{const me=Math.min(se,Q.length);ee.setSelectionRange(me,me)})},className:"w-[70%] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),d.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"€"})]})]})}),d.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:oe,className:"hidden",ref:w}),d.jsx("button",{type:"button",onClick:V,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:d.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),x&&d.jsx("a",{href:URL.createObjectURL(x),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:x.name,children:x.name})]}),d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:pe,className:"hidden",ref:_}),d.jsx("button",{type:"button",onClick:ie,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:d.jsx(Zd,{className:"h-4 w-4 text-gray-500"})}),y&&d.jsx("a",{href:URL.createObjectURL(y),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:y.name,children:y.name})]})]})]})}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),d.jsx("input",{type:"text",value:o,onChange:H=>l(H.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),d.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[G().replace(".",",")," €"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:J,onChange:H=>O(H.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł/€"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:C,onChange:H=>Z(H.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:M,onChange:H=>ne(H.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),d.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((H,ee)=>d.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[d.jsxs("div",{className:"col-span-1.5 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Kod"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:H.kod,onChange:se=>{const Q=[...c];Q[ee].kod=se.target.value,f(Q)}}),ee===c.length-1&&d.jsx("button",{onClick:z,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:d.jsx(Js,{size:16})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Nazwa"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:H.nazwa,onChange:se=>{const Q=[...c];Q[ee].nazwa=se.target.value,f(Q)}})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Kod kreskowy"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:H.kod_kreskowy,onChange:se=>{const Q=[...c];Q[ee].kod_kreskowy=se.target.value,f(Q)}})]}),d.jsxs("div",{className:"col-span-1.5",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Ilość"}),d.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:H.ilosc,onChange:se=>{const Q=[...c],he=se.target.value;(he===""||/^\d*$/.test(he))&&(Q[ee].ilosc=he,f(Q))}})]}),d.jsxs("div",{className:"col-span-2.9 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Cena"}),d.jsx("div",{className:"relative",children:d.jsx("input",{type:"text",value:H.cena,onKeyPress:se=>{const Q=String.fromCharCode(se.which);(!/[\d,]/.test(Q)||Q===","&&se.target.value.includes(",")||se.target.value===""&&Q===",")&&se.preventDefault()},onChange:se=>{const Q=se.target,he=Q.selectionStart??0;let me=se.target.value.replace(/[^\d,]/g,"");if(me===""){const Ce=[...c];Ce[ee].cena="",f(Ce);return}if(!me.includes(","))me=me+",00";else{const[Ce,ge]=me.split(",");ge&&ge.length>2&&(me=`${Ce},${ge.slice(0,2)}`)}const Ve=[...c];Ve[ee].cena=me,f(Ve),requestAnimationFrame(()=>{const Ce=Math.min(he,me.length);Q.setSelectionRange(Ce,Ce)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),d.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Wartość"}),d.jsx("div",{className:"relative flex items-center",children:d.jsx("input",{type:"text",value:(()=>{const se=parseFloat(H.ilosc)||0,Q=parseFloat(H.cena.replace(",","."))||0;return(se*Q).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),d.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[d.jsx("button",{type:"button",onClick:()=>ue(ee),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${H.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:H.dataWaznosci?`Termin ważności: ${H.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:d.jsx(qd,{size:16})}),d.jsx("button",{onClick:()=>fe(ee),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:d.jsx(Ht,{size:16})})]}),H.showDataWaznosci&&d.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:d.jsx(As,{selected:H.dataWaznosci,onChange:se=>{const Q=[...c];Q[ee].dataWaznosci=se,Q[ee].showDataWaznosci=!1,f(Q)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const se=[...c];se[ee].showDataWaznosci=!1,f(se)}})}),d.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Typ"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>R(ee),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${H.typ&&gd.find(se=>se.value===H.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate",children:H.typ&&gd.find(se=>se.value===H.typ)?.label||"Wybierz typ"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E===ee&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:se=>se.stopPropagation(),children:gd.map(se=>d.jsx("button",{type:"button",onClick:()=>S(ee,se.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${se.color}`,children:se.label},se.value))})]})]}),d.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ee>0?"invisible":""}`,children:"Objętość"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>P(ee),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${H.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[d.jsx("span",{className:"truncate",children:H.objetosc||"Wybierz"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T===ee&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:se=>se.stopPropagation(),style:{maxWidth:"200px"},children:LP.map(se=>d.jsx("button",{type:"button",onClick:()=>W(ee,se.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:se.label},se.value))})]})]})]},ee))})]}),d.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[d.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),d.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[B().replace(".",",")," €"]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(H=>H.kod&&H.nazwa&&H.ilosc&&H.cena)}),q()},disabled:!r||!c.some(H=>H.kod&&H.nazwa&&H.ilosc&&H.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(H=>H.kod&&H.nazwa&&H.ilosc&&H.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},BP=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilość"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilość"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsx("tr",{children:o.map((c,f)=>d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>d.jsx("tr",{children:c.map((h,p)=>d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:h},p))},f))})]})})},WP=({onSearch:e})=>{const[n,t]=N.useState(""),[r,a]=N.useState([]),[o,l]=N.useState(!1);return N.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),d.jsxs("div",{className:"w-full relative",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktów...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?d.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:d.jsxs("div",{className:"text-center py-4",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),d.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"Ładowanie..."})]})}):r.length>0?d.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:d.jsxs("table",{className:"w-full table-fixed",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),d.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),d.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilość"}),d.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod kreskowy"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),d.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),d.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc}),d.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kodKreskowy,children:c.kodKreskowy})]},f))})]})}):n?d.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:d.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynikов"})}):null]})};let UP={data:""},HP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||UP,$P=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,YP=/\/\*[^]*?\*\/|  +/g,Ev=/\n+/g,ws=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?ws(l,o):o+"{"+ws(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=ws(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=ws.p?ws.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},La={},fw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+fw(e[t]);return n}return e},VP=(e,n,t,r,a)=>{let o=fw(e),l=La[o]||(La[o]=(f=>{let h=0,p=11;for(;h<f.length;)p=101*p+f.charCodeAt(h++)>>>0;return"go"+p})(o));if(!La[l]){let f=o!==e?e:(h=>{let p,x,g=[{}];for(;p=$P.exec(h.replace(YP,""));)p[4]?g.shift():p[3]?(x=p[3].replace(Ev," ").trim(),g.unshift(g[0][x]=g[0][x]||{})):g[0][p[1]]=p[2].replace(Ev," ").trim();return g[0]})(e);La[l]=ws(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&La.g?La.g:null;return t&&(La.g=La[l]),((f,h,p,x)=>{x?h.data=h.data.replace(x,f):h.data.indexOf(f)===-1&&(h.data=p?f+h.data:h.data+f)})(La[l],n,r,c),l},KP=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":ws(c,""):c===!1?"":c}return r+a+(l??"")},"");function i0(e){let n=this||{},t=e.call?e(n.p):e;return VP(t.unshift?t.raw?KP(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,HP(n.target),n.g,n.o,n.k)}let dw,Vd,Kd;i0.bind({g:1});let Ga=i0.bind({k:1});function GP(e,n,t,r){ws.p=n,dw=e,Vd=t,Kd=r}function Ps(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Vd&&Vd()},c),t.o=/ *go\d+/.test(f),c.className=i0.apply(t,r)+(f?" "+f:"");let h=e;return e[0]&&(h=c.as||e,delete c.as),Kd&&h[0]&&Kd(c),dw(h,c)}return a}}var XP=e=>typeof e=="function",Yu=(e,n)=>XP(e)?e(n):e,QP=(()=>{let e=0;return()=>(++e).toString()})(),pw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),qP=20,hw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,qP)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return hw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},wu=[],Zs={toasts:[],pausedAt:void 0},ko=e=>{Zs=hw(Zs,e),wu.forEach(n=>{n(Zs)})},ZP={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},JP=(e={})=>{let[n,t]=N.useState(Zs),r=N.useRef(Zs);N.useEffect(()=>(r.current!==Zs&&t(Zs),wu.push(t),()=>{let o=wu.indexOf(t);o>-1&&wu.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||ZP[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},eR=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||QP()}),Wl=e=>(n,t)=>{let r=eR(n,e,t);return ko({type:2,toast:r}),r.id},on=(e,n)=>Wl("blank")(e,n);on.error=Wl("error");on.success=Wl("success");on.loading=Wl("loading");on.custom=Wl("custom");on.dismiss=e=>{ko({type:3,toastId:e})};on.remove=e=>ko({type:4,toastId:e});on.promise=(e,n,t)=>{let r=on.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?Yu(n.success,a):void 0;return o?on.success(o,{id:r,...t,...t?.success}):on.dismiss(r),a}).catch(a=>{let o=n.error?Yu(n.error,a):void 0;o?on.error(o,{id:r,...t,...t?.error}):on.dismiss(r)}),e};var tR=(e,n)=>{ko({type:1,toast:{id:e,height:n}})},rR=()=>{ko({type:5,time:Date.now()})},gl=new Map,nR=1e3,aR=(e,n=nR)=>{if(gl.has(e))return;let t=setTimeout(()=>{gl.delete(e),ko({type:4,toastId:e})},n);gl.set(e,t)},sR=e=>{let{toasts:n,pausedAt:t}=JP(e);N.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&on.dismiss(c.id);return}return setTimeout(()=>on.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=N.useCallback(()=>{t&&ko({type:6,time:Date.now()})},[t]),a=N.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:h}=l||{},p=n.filter(y=>(y.position||h)===(o.position||h)&&y.height),x=p.findIndex(y=>y.id===o.id),g=p.filter((y,k)=>k<x&&y.visible).length;return p.filter(y=>y.visible).slice(...c?[g+1]:[0,g]).reduce((y,k)=>y+(k.height||0)+f,0)},[n]);return N.useEffect(()=>{n.forEach(o=>{if(o.dismissed)aR(o.id,o.removeDelay);else{let l=gl.get(o.id);l&&(clearTimeout(l),gl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:tR,startPause:rR,endPause:r,calculateOffset:a}}},oR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,iR=Ga`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lR=Ga`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,cR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${oR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${iR} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${lR} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,uR=Ga`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,fR=Ps("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${uR} 1s linear infinite;
`,dR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,pR=Ga`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,hR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${pR} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,mR=Ps("div")`
  position: absolute;
`,xR=Ps("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,gR=Ga`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,vR=Ps("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${gR} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,yR=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?N.createElement(vR,null,n):n:t==="blank"?null:N.createElement(xR,null,N.createElement(fR,{...r}),t!=="loading"&&N.createElement(mR,null,t==="error"?N.createElement(cR,{...r}):N.createElement(hR,{...r})))},wR=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,kR=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,_R="0%{opacity:0;} 100%{opacity:1;}",bR="0%{opacity:1;} 100%{opacity:0;}",ER=Ps("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,SR=Ps("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,TR=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=pw()?[_R,bR]:[wR(t),kR(t)];return{animation:n?`${Ga(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ga(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},CR=N.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?TR(e.position||n||"top-center",e.visible):{opacity:0},o=N.createElement(yR,{toast:e}),l=N.createElement(SR,{...e.ariaProps},Yu(e.message,e));return N.createElement(ER,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):N.createElement(N.Fragment,null,o,l))});GP(N.createElement);var DR=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=N.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return N.createElement("div",{ref:o,className:n,style:t},a)},NR=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:pw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},FR=i0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,du=16,AR=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=sR(t);return N.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:du,left:du,right:du,bottom:du,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(h=>{let p=h.position||n,x=f.calculateOffset(h,{reverseOrder:e,gutter:r,defaultPosition:n}),g=NR(p,x);return N.createElement(DR,{id:h.id,key:h.id,onHeightUpdate:f.updateHeight,className:h.visible?FR:"",style:g},h.type==="custom"?Yu(h.message,h):a?a(h):N.createElement(CR,{toast:h,position:p}))}))},ct=on;xi("pl",gi);const OR=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log("🔍 OrderModal render - isOpen:",e);const[r,a]=N.useState(null),[o,l]=N.useState(""),[c,f]=N.useState(""),[h,p]=N.useState([]),[x,g]=N.useState(null),[y,k]=N.useState(!1),[w,_]=N.useState([]),[E,A]=N.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[T,L]=N.useState(null),[J,O]=N.useState(!1),[C,Z]=N.useState(!1),[M,ne]=N.useState(null),[G,z]=N.useState(new Set),fe=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],ue=()=>{const S=Math.max(...E.map(R=>R.id))+1;A([...E,{id:S,searchQuery:"",selectedProduct:null,typ:""}])},oe=S=>{E.length>1&&A(R=>R.filter(P=>P.id!==S))},pe=()=>{console.log("🔍 OrderModal handleClose called"),a(null),l(""),f(""),p([]),g(null),_([]),A([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),L(null),O(!1),Z(!1),ne(null),z(new Set),n()};N.useEffect(()=>{e&&(console.log("🔍 OrderModal opened - clearing state"),a(null),l(""),f(""),p([]),g(null),_([]),A([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),L(null),O(!1),Z(!1),ne(null),z(new Set))},[e]),N.useEffect(()=>{const R=setTimeout(async()=>{if(c.trim().length<2){p([]);return}k(!0);try{const P=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!P.ok)throw new Error("Failed to fetch clients");const W=await P.json();p(W)}catch(P){console.error("Error searching clients:",P),p([])}finally{k(!1)}},300);return()=>clearTimeout(R)},[c]),N.useEffect(()=>{const R=setTimeout(async()=>{if(T===null||!E.find(P=>P.id===T)?.searchQuery.trim()){_([]);return}O(!0);try{const P=E.find(se=>se.id===T)?.searchQuery||"",W=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(P)}`);if(!W.ok)throw new Error("Failed to fetch products");const ee=(await W.json()).map(se=>({kod:se.kod,nazwa:se.nazwa,ilosc:se.ilosc.toString(),kodKreskowy:se.kod_kreskowy||"",selectedQuantity:0}));_(ee)}catch(P){console.error("Error searching products:",P),_([])}finally{O(!1)}},300);return()=>clearTimeout(R)},[E,T]),N.useEffect(()=>{const S=P=>{const W=P.target;M!==null&&(W.closest(".dropdown-container")||ne(null))},R=P=>{P.key==="Escape"&&ne(null)};return M!==null&&(document.addEventListener("mousedown",S),document.addEventListener("keydown",R)),()=>{document.removeEventListener("mousedown",S),document.removeEventListener("keydown",R)}},[M]);const V=(S,R)=>{console.log("🔍 handleProductSelect called for fieldId:",S,"product:",R.kod),A(P=>P.map(H=>H.id===S?{...H,selectedProduct:R,searchQuery:`${R.kod} - ${R.nazwa}`}:H)),_([]),L(null),console.log("🔍 Products list cleared, activeSearchId reset")},ie=S=>{ne(M===S?null:S)},q=(S,R)=>{A(P=>P.map(W=>W.id===S?{...W,typ:R}:W)),ne(null)},ae=()=>E.filter(S=>S.selectedProduct).reduce((S,R)=>{const P=R.selectedProduct?.selectedQuantity||0;return S+P},0),B=async()=>{const S=E.filter(se=>se.selectedProduct).map(se=>({kod:se.selectedProduct.kod,nazwa:se.selectedProduct.nazwa,ilosc:se.selectedProduct.selectedQuantity||0,typ:se.typ,kod_kreskowy:se.selectedProduct.kodKreskowy}));if(!r){ct.error("Wybierz datę zamówienia");return}if(!o.trim()){ct.error("Wprowadź numer zamówienia");return}if(!x){ct.error("Wybierz klienta");return}if(S.length===0){ct.error("Dodaj produkty");return}if(S.some(se=>!se.ilosc)){ct.error("Wprowadź ilość dla wszystkich produktów");return}if(S.some(se=>!se.typ)){ct.error("Wybierz typ dla wszystkich produktów");return}const R=new Set;for(let se=0;se<E.length;se++){const Q=E[se];if(Q.selectedProduct){const he=Q.selectedProduct.selectedQuantity||0,me=parseInt(Q.selectedProduct.ilosc)||0;he>me&&R.add(Q.id)}}if(R.size>0){z(R);return}else z(new Set);const P=r.getDate().toString().padStart(2,"0"),W=(r.getMonth()+1).toString().padStart(2,"0"),H=r.getFullYear(),ee=`${o.trim()}_${P}_${W}_${H}`;Z(!0);try{const se=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:x.nazwa,order_number:ee,products:S})});if(!se.ok){const Q=await se.json();if(se.status===400&&Q.error.includes("Insufficient quantity")){const he=Q.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(he){const[,me,I,Ve]=he;ct.error(`Niewystarczająca ilość produktu ${me}. Dostępne: ${I}, Zamówione: ${Ve}`)}else ct.error(Q.error)}else throw new Error("Failed to create order");return}ct.success("Zamówienie zostało dodane"),pe(),t&&t()}catch(se){console.error("Error creating order:",se),ct.error("Wystąpił błąd podczas dodawania zamówienia")}finally{Z(!1)}};return d.jsx(Mr,{isOpen:e,onRequestClose:pe,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamówienia"}),d.jsx("button",{onClick:pe,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),d.jsx(As,{selected:r,onChange:S=>a(S),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsxs("div",{className:"w-[180px] ml-4",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),d.jsx("input",{type:"text",value:o,onChange:S=>l(S.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),d.jsxs("div",{className:"relative",children:[d.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",id:"client-search",value:c,onChange:S=>f(S.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),y&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),h.length>0&&!x&&d.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:h.map(S=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(S),f(S.nazwa),p([])},children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:S.nazwa}),d.jsx("span",{className:"text-[10px] text-gray-500",children:S.firma})]})},S.id))})]}),x&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.nazwa})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.firma})]}),x.adres&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.adres})]}),x.kontakt&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.kontakt})]})]}),d.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:d.jsx(Ht,{size:16})})]})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),E.map(S=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",value:S.searchQuery,onChange:R=>{const P=R.target.value;console.log("🔍 Product search input changed for fieldId:",S.id,"value:",P),A(W=>W.map(H=>H.id===S.id?{...H,searchQuery:P,selectedProduct:null}:H)),L(S.id)},onFocus:()=>L(S.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsx("div",{className:"w-16 ml-2",children:d.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:S.selectedProduct?.selectedQuantity||"",onChange:R=>{const P=R.target.value,W=P===""?0:Math.max(1,parseInt(P)||0);if(A(H=>H.map(ee=>ee.id===S.id&&ee.selectedProduct?{...ee,selectedProduct:{...ee.selectedProduct,selectedQuantity:W}}:ee)),G.has(S.id)){const H=new Set(G);H.delete(S.id),z(H)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${G.has(S.id)?"border-red-500":"border-gray-300"}`})}),d.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[d.jsxs("button",{type:"button",onClick:()=>ie(S.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${S.typ&&fe.find(R=>R.value===S.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate text-[10px]",children:S.typ&&fe.find(R=>R.value===S.typ)?.label||"Typ"}),d.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),M===S.id&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:R=>R.stopPropagation(),children:fe.map(R=>d.jsx("button",{type:"button",onClick:()=>q(S.id,R.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${R.color}`,children:R.label},R.value))})]}),E.length>1&&d.jsx("button",{onClick:()=>oe(S.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:d.jsx(Ht,{size:16})})]}),S.id===Math.max(...E.map(R=>R.id))&&d.jsx("button",{onClick:ue,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:d.jsx(Js,{size:16})}),J&&T===S.id&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),w.length>0&&T===S.id&&!S.selectedProduct&&S.searchQuery.trim()&&d.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:w.map(R=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>V(S.id,{...R,selectedQuantity:0}),children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:R.kod}),d.jsx("span",{className:"text-[10px] text-gray-500",children:R.nazwa}),d.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",R.ilosc]})]})},R.kod))})]},S.id))]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:B,disabled:C,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${C?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:C?d.jsxs("div",{className:"flex items-center justify-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),d.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",d.jsx("span",{className:"font-semibold text-gray-900",children:ae()})]})]})})},PR=({isOpen:e,onClose:n,order:t})=>{const[r,a]=N.useState(null),[o,l]=N.useState(null),[c,f]=N.useState(!1),h=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}];N.useEffect(()=>{e&&t&&(p(),x())},[e,t]);const p=async()=>{if(t){f(!0);try{const w=await fetch(`/api/orders/${t.id}`);if(!w.ok)throw new Error("Failed to load order details");const _=await w.json();a(_)}catch(w){console.error("Error loading order details:",w)}finally{f(!1)}}},x=async()=>{if(t)try{const w=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(w.ok){const _=await w.json();l(_)}}catch(w){console.error("Error loading client data:",w)}},g=w=>new Date(w).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const y=r||t,k=async()=>{if(!(!t||!y))try{const w=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!w.ok)throw new Error("Failed to generate PDF");const _=await w.blob(),E=window.URL.createObjectURL(_),A=document.createElement("a");A.href=E;const T=o?o.nazwa:y.klient,L=`${T}_${y.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",T),console.log("Order number:",y.numer_zamowienia),console.log("Generated filename:",L),A.download=L,document.body.appendChild(A),A.click(),window.URL.revokeObjectURL(E),document.body.removeChild(A)}catch(w){console.error("Error generating PDF:",w),alert("Błąd podczas generowania PDF")}};return d.jsx(Mr,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zamówienia"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?d.jsx("div",{className:"flex justify-center items-center py-8",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-700",children:"Numer zamówienia:"}),d.jsx("p",{className:"text-sm font-bold text-gray-900",children:y.numer_zamowienia})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),d.jsx("p",{className:"text-gray-900",children:g(y.data_utworzenia||"")})]})]})}),o&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Produkty w zamówieniu"}),y.products&&y.products.length>0?d.jsx("div",{children:d.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilość"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Typ"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.products.map(w=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:w.kod}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:d.jsx("div",{className:"break-words leading-tight",children:w.nazwa})}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:w.kod_kreskowy||"-"}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:w.ilosc}),d.jsx("td",{className:"px-4 py-2 text-xs w-20",children:w.typ?d.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${h.find(_=>_.value===w.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:h.find(_=>_.value===w.typ)?.label||w.typ}):d.jsx("span",{className:"text-gray-500",children:"-"})})]},w.id))})]})}):d.jsx("p",{className:"text-xs text-gray-500",children:"Brak produktów w zamówieniu"})]})]})}),d.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",d.jsx("span",{className:"font-semibold text-gray-900",children:y.laczna_ilosc})]}),d.jsx("div",{className:"absolute bottom-4 left-4",children:d.jsx("button",{onClick:k,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};xi("pl",gi);const vd=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],RR=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=N.useState(""),[l,c]=N.useState(""),[f,h]=N.useState(null),[p,x]=N.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),[g,y]=N.useState(null),[k,w]=N.useState(""),[_,E]=N.useState([]),[A,T]=N.useState(!1),[L,J]=N.useState(null),[O,C]=N.useState([]),[Z,M]=N.useState(!1),[ne,G]=N.useState(null),[z,fe]=N.useState(new Set),ue=async R=>{try{const P=R.map(se=>se.kod).filter(se=>se.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",P),P.length===0)return;const W=await fetch("/api/working-sheets");if(!W.ok)throw new Error("Failed to fetch working sheets");const H=await W.json();console.log("All working sheets products:",H);const ee=P.map(se=>{const Q=H.find(he=>he.kod===se);return console.log(`Found product for ${se}:`,Q),Q}).filter(se=>se!==void 0);console.log("Found products for order:",ee),E(ee),console.log("✅ Final loaded products info for order editing:",ee)}catch(P){console.error("❌ Error loading products info:",P)}};N.useEffect(()=>{if(e&&r){if(o(r.klient),w(r.klient),G({nazwa:r.klient}),c(r.numer_zamowienia),r.data_utworzenia){const R=new Date(r.data_utworzenia);h(R),console.log("📅 Loaded order date:",R)}else h(null);if(r.products&&r.products.length>0){console.log("Order products from backend:",r.products);const R=r.products.map(P=>({kod:P.kod||"",nazwa:P.nazwa||"",kod_kreskowy:P.kod_kreskowy||"",ilosc:(P.ilosc||0).toString(),typ:P.typ||""}));console.log("Formatted products:",R),x(R),console.log("🔄 About to load products info for:",R),ue(R)}else x([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])}},[e,r]),N.useEffect(()=>{const P=setTimeout(async()=>{if(L===null||!p.find((W,H)=>H===L)?.nazwa.trim()){E([]);return}T(!0);try{const W=p.find((se,Q)=>Q===L)?.nazwa||"",H=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(W)}`);if(!H.ok)throw new Error("Failed to fetch products");const ee=await H.json();E(ee)}catch(W){console.error("Error searching products:",W),E([])}finally{T(!1)}},300);return()=>clearTimeout(P)},[p,L]),N.useEffect(()=>{const P=setTimeout(async()=>{if(k.trim().length<2){C([]);return}M(!0);try{const W=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!W.ok)throw new Error("Failed to fetch clients");const H=await W.json();C(H)}catch(W){console.error("Error searching clients:",W),C([])}finally{M(!1)}},300);return()=>clearTimeout(P)},[k]),N.useEffect(()=>{const R=W=>{const H=W.target;g!==null&&(H.closest(".dropdown-container")||y(null))},P=W=>{W.key==="Escape"&&y(null)};return g!==null&&(document.addEventListener("mousedown",R),document.addEventListener("keydown",P)),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("keydown",P)}},[g]);const oe=()=>{x([...p,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])},pe=R=>{p.length>1&&x(p.filter((P,W)=>W!==R))},V=(R,P)=>{const W=[...p];W[R].typ=P,x(W),y(null)},ie=R=>{y(g===R?null:R)},q=(R,P)=>{console.log("🔍 EditOrderModal handleProductSelect called for index:",R,"product:",P.kod);const W=[...p];W[R]={...W[R],kod:P.kod,nazwa:P.nazwa,kod_kreskowy:P.kod_kreskowy||"",typ:P.typ||"sztuki"},x(W);const H=[..._],ee=H.findIndex(se=>se.kod===P.kod);ee>=0?H[ee]=P:H.push(P),E(H),J(null),console.log("🔍 EditOrderModal Products list cleared, activeSearchId reset")},ae=async(R,P)=>{const W=new Set;for(let H=0;H<R.length;H++){const ee=R[H],se=parseInt(ee.ilosc)||0,Q=p.findIndex(Ee=>Ee.kod===ee.kod&&Ee.nazwa===ee.nazwa&&Ee.ilosc===ee.ilosc);if(Q===-1){console.warn(`⚠️ Could not find actual index for product ${ee.kod}`);continue}const me=P.find(Ee=>Ee.kod===ee.kod)?.ilosc||0,I=r?.products?.find(Ee=>Ee.kod===ee.kod),Ve=I&&I.ilosc||0;let Ce;se>Ve?(Ce=se-Ve,console.log(`📈 Increasing order: ${Ve} → ${se}, need additional: ${Ce}`)):(Ce=se,console.log(`📉 Decreasing order: ${Ve} → ${se}, checking total available`));const ge=me+(se<=Ve?Ve:0);console.log(`Product ${Q} (valid index ${H}):`,{kod:ee.kod,requested:se,availableOnStock:me,reservedInOrder:Ve,requiredFromStock:Ce,totalAvailable:ge,hasError:Ce>ge}),Ce>ge&&(W.add(Q),console.log(`❌ Error for product ${Q}: required ${Ce} > available ${ge}`))}return W},B=async R=>{if(R.preventDefault(),!r)return;if(!a.trim()){ct.error("Wprowadź nazwę klienta");return}if(!l.trim()){ct.error("Wprowadź numer zamówienia");return}const P=p.filter(ee=>ee.kod.trim()&&ee.nazwa.trim()&&ee.ilosc.trim()&&ee.typ.trim());if(P.length===0){ct.error("Dodaj produkty do zamówienia");return}if(P.some(ee=>!ee.ilosc||!ee.typ)){ct.error("Wprowadź ilość i typ dla wszystkich produktów");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",P),console.log("products (stock info):",_),console.log("products.length:",_.length),_.length===0){console.log("⚠️ Products info is empty, reloading...");try{const ee=await fetch("/api/working-sheets");if(ee.ok){const se=await ee.json();console.log("Reloaded all products:",se),E(se);const Q=await ae(P,se);if(Q.size>0){fe(Q);return}else fe(new Set);console.log("✅ Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),ct.error("Błąd podczas ładowania informacji o produktach");return}}catch(ee){console.error("Error reloading products:",ee),ct.error("Błąd podczas ładowania informacji o produktach");return}}const W=await ae(P,_);if(W.size>0){fe(W);return}else fe(new Set);const H=P.map(ee=>({kod:ee.kod,kod_kreskowy:ee.kod_kreskowy,nazwa:ee.nazwa,ilosc:parseInt(ee.ilosc)||0,typ:ee.typ}));console.log("Sending products data:",H);try{const ee=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:H})});if(!ee.ok){const se=await ee.json();throw new Error(se.error||"Failed to update order")}ct.success("Zamówienie zostało zaktualizowane"),S(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:H})}catch(ee){console.error("Error updating order:",ee),ct.error("Wystąpił błąd podczas aktualizacji zamówienia")}},S=()=>{o(""),w(""),G(null),C([]),c(""),h(null),x([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),y(null),E([]),J(null),n()};return r?d.jsx(Mr,{isOpen:e,onRequestClose:S,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj zamówienie"}),d.jsx("button",{type:"button",onClick:S,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsxs("form",{onSubmit:B,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex space-x-4",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),d.jsx(As,{selected:f,onChange:R=>h(R),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),d.jsx("input",{type:"text",value:l,onChange:R=>c(R.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",value:k,onChange:R=>w(R.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),Z&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),O.length>0&&!ne&&d.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:O.map(R=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{G(R),w(R.nazwa),o(R.nazwa),C([])},children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:R.nazwa}),d.jsx("span",{className:"text-[10px] text-gray-500",children:R.firma})]})},R.id))})]}),ne&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),d.jsx("p",{className:"text-xs text-gray-900",children:ne.nazwa})]}),ne.firma&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),d.jsx("p",{className:"text-xs text-gray-900",children:ne.firma})]}),ne.adres&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),d.jsx("p",{className:"text-xs text-gray-900",children:ne.adres})]}),ne.kontakt&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),d.jsx("p",{className:"text-xs text-gray-900",children:ne.kontakt})]})]}),d.jsx("button",{type:"button",onClick:()=>{G(null),w(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:d.jsx(Ht,{size:16})})]})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),p.map((R,P)=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",value:R.nazwa,onChange:W=>{const H=W.target.value;console.log("🔍 EditOrderModal Product search input changed for index:",P,"value:",H);const ee=[...p];ee[P].nazwa=H,x(ee),J(P)},onFocus:()=>J(P),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsx("div",{className:"w-16 ml-2",children:d.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:R.ilosc,onChange:W=>{const H=[...p];if(H[P].ilosc=W.target.value,x(H),z.has(P)){const ee=new Set(z);ee.delete(P),fe(ee)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${z.has(P)?"border-red-500":"border-gray-300"}`})}),d.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[d.jsxs("button",{type:"button",onClick:()=>ie(P),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${R.typ&&vd.find(W=>W.value===R.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate text-[10px]",children:R.typ&&vd.find(W=>W.value===R.typ)?.label||"Typ"}),d.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g===P&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:W=>W.stopPropagation(),children:vd.map(W=>d.jsx("button",{type:"button",onClick:()=>V(P,W.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${W.color}`,children:W.label},W.value))})]}),p.length>1&&d.jsx("button",{type:"button",onClick:()=>pe(P),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:d.jsx(Ht,{size:16})})]}),P===p.length-1&&d.jsx("button",{type:"button",onClick:oe,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:d.jsx(Js,{size:16})}),A&&L===P&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),_.length>0&&L===P&&R.nazwa.trim()&&d.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:_.map(W=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>q(P,W),children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:W.kod}),d.jsx("span",{className:"text-[10px] text-gray-500",children:W.nazwa}),d.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",W.ilosc]})]})},W.kod))})]},P))]})]}),d.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[d.jsx("button",{type:"button",onClick:S,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),d.jsx("button",{type:"button",onClick:B,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null},MR=({onViewOrder:e,onEditOrder:n,onDeleteOrder:t,onUpdateOrder:r,refreshTrigger:a})=>{const[o,l]=N.useState([]),[c,f]=N.useState(!0),[h,p]=N.useState(null),[x,g]=N.useState(null),[y,k]=N.useState(!1),[w,_]=N.useState(!1),[E,A]=N.useState(null),[T,L]=N.useState(!1),[J,O]=N.useState(null),[C,Z]=N.useState(""),[M,ne]=N.useState("data_utworzenia"),[G,z]=N.useState("desc"),[fe,ue]=N.useState(""),[oe,pe]=N.useState(""),V=async()=>{try{console.log("🔄 Starting to load orders..."),f(!0),p(null),console.log("📡 Fetching from /api/orders-with-products...");const me=await fetch("/api/orders-with-products");if(console.log("📡 Response status:",me.status),console.log("📡 Response ok:",me.ok),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const I=await me.json();console.log("📡 Raw data received:",I),console.log("📡 Raw data length:",I.length);const Ve=I.map(Ce=>({id:Ce.id,klient:Ce.klient,numer_zamowienia:Ce.numer_zamowienia,data_utworzenia:Ce.data_utworzenia,laczna_ilosc:Ce.laczna_ilosc,typ:Ce.typ||"zamowienie",numer_zwrotu:Ce.numer_zwrotu||null,products:Ce.products||[]}));console.log("🔄 Transformed orders:",Ve),console.log("🔄 Orders count:",Ve.length),l(Ve)}catch(me){console.error("❌ Error loading orders:",me),p("Failed to load orders")}finally{f(!1)}};N.useEffect(()=>{V()},[]),N.useEffect(()=>{a&&V()},[a]);const ie=me=>new Date(me).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),q=me=>{g(me),k(!0)},ae=me=>{A(me),_(!0)},B=async me=>{if(console.log("OrdersList handleEditSubmit called with data:",me),r)r(me);else try{console.log("Sending PUT request to update order:",me);const I=await fetch(`/api/orders/${me.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);ct.success("Zamówienie zostało zaktualizowane"),V()}catch(I){console.error("Error updating order:",I),ct.error("Błąd podczas aktualizacji zamówienia")}},S=me=>{O(me),L(!0),Z("")},R=async()=>{if(C==="5202"){if(J?.id)try{t&&t(J.id);const me=await fetch(`/api/orders/${J.id}`,{method:"DELETE"});if(!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const I=await me.json();console.log("Order deleted:",I),ct.success("Zamówienie zostało usunięte"),V()}catch(me){console.error("Error deleting order:",me),ct.error("Błąd podczas usuwania zamówienia")}P()}else ct.error("Nieprawidłowe hasło"),Z("")},P=()=>{L(!1),O(null),Z("")},W=me=>{me.key==="Enter"&&R()},H=me=>{M===me?z(G==="asc"?"desc":"asc"):(ne(me),z("asc"))},ee=Array.from(new Set(o.map(me=>new Date(me.data_utworzenia).getFullYear().toString()))).sort((me,I)=>parseInt(I)-parseInt(me)),se=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],he=o.filter(me=>!(fe&&new Date(me.data_utworzenia).getFullYear().toString()!==fe||oe&&(new Date(me.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==oe)).sort((me,I)=>{let Ve,Ce;switch(M){case"numer_zamowienia":Ve=(me.numer_zamowienia||"").toLowerCase(),Ce=(I.numer_zamowienia||"").toLowerCase();break;case"klient":Ve=(me.klient||"").toLowerCase(),Ce=(I.klient||"").toLowerCase();break;case"laczna_ilosc":Ve=me.laczna_ilosc,Ce=I.laczna_ilosc;break;case"data_utworzenia":Ve=new Date(me.data_utworzenia),Ce=new Date(I.data_utworzenia);break;default:Ve=me[M]||"",Ce=I[M]||""}return typeof Ve=="string"&&typeof Ce=="string"?G==="asc"?Ve.localeCompare(Ce):Ce.localeCompare(Ve):typeof Ve=="number"&&typeof Ce=="number"?G==="asc"?Ve-Ce:Ce-Ve:Ve instanceof Date&&Ce instanceof Date?G==="asc"?Ve.getTime()-Ce.getTime():Ce.getTime()-Ve.getTime():0});return c?d.jsx("div",{className:"flex justify-center items-center h-32",children:d.jsx("div",{className:"text-gray-500",children:"Ładowanie zamówień..."})}):h?d.jsx("div",{className:"flex justify-center items-center h-32",children:d.jsxs("div",{className:"text-red-500",children:["Błąd: ",h]})}):d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("numer_zamowienia"),children:"Numer zamówienia"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("klient"),children:"Klient"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("typ"),children:"Typ"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("laczna_ilosc"),children:"Łączna ilość"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("data_utworzenia"),children:"Data utworzenia"}),d.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:d.jsxs("div",{className:"flex space-x-1 justify-end",children:[d.jsxs("select",{value:fe,onChange:me=>ue(me.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[d.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),ee.map(me=>d.jsx("option",{value:me,style:{fontFamily:"Sora, sans-serif"},children:me},me))]}),d.jsxs("select",{value:oe,onChange:me=>pe(me.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[d.jsx("option",{value:"",children:"Msc"}),se.map(me=>d.jsx("option",{value:me.value,style:{fontFamily:"Sora, sans-serif"},children:me.value},me.value))]})]})})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamówień"})}):he.map(me=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:me.numer_zamowienia}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:me.klient}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${me.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:me.typ==="zwrot"?"Zwrot":"Zamówienie"})}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:me.laczna_ilosc}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ie(me.data_utworzenia)}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),q(me)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:d.jsx(Jd,{size:16})}),d.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),ae(me)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:d.jsx(Gu,{size:16})}),d.jsx("button",{type:"button",onClick:I=>{I.preventDefault(),I.stopPropagation(),S(me)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:d.jsx(Ht,{size:16})})]})})]},me.id))})]})}),d.jsx(Mr,{isOpen:T,onRequestClose:P,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),d.jsx("button",{onClick:P,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsx("div",{children:d.jsx("input",{type:"password",value:C,onChange:me=>Z(me.target.value),onKeyPress:W,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[d.jsx("button",{onClick:P,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),d.jsx("button",{onClick:R,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),d.jsx(PR,{isOpen:y,onClose:()=>k(!1),order:x}),d.jsx(RR,{isOpen:w,onClose:()=>{_(!1),A(null)},onSubmit:me=>{B(me),_(!1),A(null)},order:E})]})},IR="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",mw=({isOpen:e,onClose:n,product:t})=>t?d.jsx(Mr,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[d.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:d.jsx(Ht,{size:24})}),d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Детали товара"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Код:"})," ",t.kod]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Название:"})," ",t.nazwa]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Количество:"})," ",t.ilosc]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Ед. измерения:"})," ",t.jednostka_miary]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Штрихкод:"})," ",t.kod_kreskowy]}),t.data_waznosci&&d.jsxs("p",{children:[d.jsx("strong",{children:"Срок годности:"})," ",t.data_waznosci]}),t.waga_netto&&d.jsxs("p",{children:[d.jsx("strong",{children:"Вес нетто:"})," ",t.waga_netto," кг"]}),t.waga_brutto&&d.jsxs("p",{children:[d.jsx("strong",{children:"Вес брутто:"})," ",t.waga_brutto," кг"]}),t.objetosc&&d.jsxs("p",{children:[d.jsx("strong",{children:"Объем:"})," ",t.objetosc," л"]}),t.opis&&d.jsxs("p",{children:[d.jsx("strong",{children:"Описание:"})," ",t.opis]})]})]})}):null,Vu="",xw=({isOpen:e,onClose:n,receipt:t,products:r})=>{const[a,o]=De.useState(null),[l,c]=De.useState(!1),[f,h]=De.useState({x:0,y:0}),[p,x]=De.useState(!1),g=De.useRef({x:0,y:0});De.useEffect(()=>{const w=E=>{p&&h({x:E.clientX-g.current.x,y:E.clientY-g.current.y})},_=()=>x(!1);return p&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",_)),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",_)}},[p]);const y=w=>{w.target.closest("button")||w.target.closest("input")||(x(!0),g.current={x:w.clientX-f.x,y:w.clientY-f.y})};if(!t)return null;let k=[];if(Array.isArray(t.products))k=t.products;else if(typeof t.products=="string")try{k=JSON.parse(t.products)}catch{k=[]}return d.jsxs(Mr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:y,style:{cursor:p?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zakupu"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Wartość"}),d.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," €"]})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),d.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," €"]})]})]}),(t.productInvoice||t.transportInvoice)&&d.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&d.jsxs("button",{onClick:()=>{const w=`${Vu}/uploads/${t.productInvoice}`;console.log("📎 Opening product invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[d.jsx(ep,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&d.jsxs("button",{onClick:()=>{const w=`${Vu}/uploads/${t.transportInvoice}`;console.log("📎 Opening transport invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[d.jsx(Zd,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),d.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),d.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),d.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),d.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilość"}),d.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),d.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Wartość"}),d.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),d.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objętość"}),d.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data ważności"})]})}),d.jsx("tbody",{children:k.map((w,_)=>d.jsxs("tr",{children:[d.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.kod}),d.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:w.nazwa}),d.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:w.kod_kreskowy||"-"}),d.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:w.ilosc}),d.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[w.cena," €"]}),d.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(w.ilosc*w.cena).toFixed(2).replace(".",",")," €"]}),d.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const E=w.typ;return E?{czerwone:"Czerwone",biale:"Białe",musujace:"Musujące",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment"}[E]||E:"-"})()}),d.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.objetosc||"-"}),d.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:w.dataWaznosci?typeof w.dataWaznosci=="number"?new Date(w.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(w.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},_))})]})]})]}),d.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),d.jsx(mw,{isOpen:l,onClose:()=>c(!1),product:a})]})},jR=({isOpen:e,onClose:n,onAdd:t,initialData:r,isEditMode:a=!1})=>{const[o,l]=N.useState(""),[c,f]=N.useState(""),[h,p]=N.useState(""),[x,g]=N.useState(""),[y,k]=N.useState("");N.useEffect(()=>{console.log("🔍 useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log("🔍 Setting initial data from props"),l(r.firma),f(r.nazwa),p(r.adres),g(r.czas_dostawy),k(r.kontakt)):e&&!r&&console.log("🔍 Modal opened without initial data - keeping current values")},[e,r]);const w=()=>{if(console.log("🔍 handleSubmit called with values:",{firma:o,nazwa:c,adres:h,czas_dostawy:x,kontakt:y}),console.log("🔍 Trimmed values:",{firma:o.trim(),nazwa:c.trim(),adres:h.trim(),czas_dostawy:x.trim(),kontakt:y.trim()}),!o.trim()||!c.trim()||!h.trim()||!x.trim()||!y.trim()){console.log("❌ Validation failed: some fields are empty");return}const E={firma:o.trim(),nazwa:c.trim(),adres:h.trim(),czas_dostawy:x.trim(),kontakt:y.trim()};console.log("✅ Submitting client data:",E),t(E),_()},_=()=>{l(""),f(""),p(""),g(""),k(""),n()};return d.jsx(Mr,{isOpen:e,onRequestClose:_,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),d.jsx("button",{onClick:_,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),d.jsx("input",{type:"text",value:o,onChange:E=>{console.log("🔍 firma onChange:",E.target.value),l(E.target.value)},placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),d.jsx("input",{type:"text",value:c,onChange:E=>f(E.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),d.jsx("input",{type:"text",value:h,onChange:E=>p(E.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),d.jsx("input",{type:"text",value:x,onChange:E=>g(E.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),d.jsx("input",{type:"text",value:y,onChange:E=>k(E.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:w,disabled:!o.trim()||!c.trim()||!h.trim()||!x.trim()||!y.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!o.trim()||!c.trim()||!h.trim()||!x.trim()||!y.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};xi("pl",gi);const yd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],Sv=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],gw=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=N.useState(null),[l,c]=N.useState(""),[f,h]=N.useState({x:0,y:0}),[p,x]=N.useState(!1),[g,y]=N.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k=N.useRef({x:0,y:0}),[w,_]=N.useState(""),[E,A]=N.useState(null),[T,L]=N.useState(null),[J,O]=N.useState(null),[C,Z]=N.useState(null),M=N.useRef(null),ne=N.useRef(null),[G,z]=N.useState(null),[fe,ue]=N.useState(null),[oe,pe]=N.useState("0,00"),[V,ie]=N.useState("0,00"),q=()=>{const ge=g.reduce((ye,Pe)=>{const Ze=parseFloat(Pe.ilosc.toString().replace(",","."))||0;return ye+Ze},0),Ee=parseFloat(w.replace(",","."))||0;return ge>0?(Ee/ge).toFixed(2):"0,00"};N.useEffect(()=>{if(e&&r){let ge=[];if(r.products)if(typeof r.products=="string")try{ge=JSON.parse(r.products)}catch(Ee){console.error("Error parsing products JSON:",Ee),ge=[]}else Array.isArray(r.products)&&(ge=r.products);if(Array.isArray(ge)&&ge.length>0){let Ee=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[Pe,Ze,Xe]=r.dataPrzyjecia.split("/");Ee=new Date(parseInt(Xe),parseInt(Ze)-1,parseInt(Pe))}else r.dataPrzyjecia.includes("-")?Ee=new Date(r.dataPrzyjecia):Ee=new Date(r.dataPrzyjecia);if(o(Ee),c(r.sprzedawca||""),_((r.kosztDostawy||0).toFixed(2).replace(".",",")),r.aktualny_kurs!==void 0&&r.aktualny_kurs!==null)pe(Number(r.aktualny_kurs).toFixed(2).replace(".",","));else if(r.aktualnyKurs!==void 0&&r.aktualnyKurs!==null)pe(String(r.aktualnyKurs).replace(".",","));else{const Pe=ge.reduce((qt,Pt)=>qt+(Pt.ilosc||0),0),Ze=Pe?r.kosztDostawy/Pe:0,Xe=ge[0]?.deliveryCostPerUnitPln||0,wt=Ze?Xe/Ze:1;pe(wt.toFixed(2).replace(".",","))}if(r.podatek_akcyzowy!==void 0&&r.podatek_akcyzowy!==null)ie(Number(r.podatek_akcyzowy).toFixed(2).replace(".",","));else if(r.podatekAkcyzowy!==void 0&&r.podatekAkcyzowy!==null)ie(String(r.podatekAkcyzowy).replace(".",","));else{const Pe=ge[0]?.podatekAkcyzowyPerLiter??ge[0]?.podatekAkcyzowy??ge[0]?.podatek_akcyzowy??0;ie(Pe.toFixed(2).replace(".",","))}const ye=ge.map(Pe=>({kod:Pe.kod||"",nazwa:Pe.nazwa||"",kod_kreskowy:Pe.kod_kreskowy||Pe.ean||"",ilosc:(Pe.ilosc||0).toString(),cena:(Pe.cena||0).toFixed(2).replace(".",","),dataWaznosci:Pe.dataWaznosci||"",showDataWaznosci:!1,typ:Pe.typ||Pe.typTowaru||"",objetosc:Pe.objetosc||""}));y(ye.length>0?ye:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),O(r.productInvoice||null),Z(r.transportInvoice||null),A(null),L(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),A(null),L(null),O(null),Z(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),A(null),L(null),O(null),Z(null)},[e,r]),N.useEffect(()=>{const ge=ye=>{const Pe=ye.target;if(!Pe.closest(".dropdown-container")&&!Pe.closest('button[onclick*="toggleDropdown"]')&&z(null),!Pe.closest(".objetosc-dropdown-container")&&!Pe.closest('button[onclick*="toggleObjetoscDropdown"]')&&ue(null),!Pe.closest(".react-datepicker")&&!Pe.closest('button[title*="ważności"]')){const Ze=[...g];let Xe=!1;Ze.forEach(wt=>{wt.showDataWaznosci&&(wt.showDataWaznosci=!1,Xe=!0)}),Xe&&y(Ze)}},Ee=ye=>{if(ye.key==="Escape"){z(null),ue(null);const Pe=[...g];let Ze=!1;Pe.forEach(Xe=>{Xe.showDataWaznosci&&(Xe.showDataWaznosci=!1,Ze=!0)}),Ze&&y(Pe)}};return document.addEventListener("mousedown",ge),document.addEventListener("keydown",Ee),()=>{document.removeEventListener("mousedown",ge),document.removeEventListener("keydown",Ee)}},[g]);const ae=()=>{y([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},B=ge=>{if(g.length>1){const Ee=[...g];Ee.splice(ge,1),y(Ee)}},S=ge=>{const Ee=[...g];Ee[ge].showDataWaznosci=!Ee[ge].showDataWaznosci,y(Ee)},R=(ge,Ee)=>{const ye=[...g];ye[ge].typ=Ee,y(ye),z(null)},P=ge=>{z(G===ge?null:ge)},W=(ge,Ee)=>{const ye=[...g];ye[ge].objetosc=Ee,y(ye),ue(null)},H=ge=>{ue(fe===ge?null:ge)},ee=ge=>{ge.target.closest("button")||ge.target.closest("input")||ge.target.closest(".react-datepicker")||ge.target.closest('[role="button"]')||ge.target.closest(".react-datepicker__input-container")||(x(!0),k.current={x:ge.clientX-f.x,y:ge.clientY-f.y})};N.useEffect(()=>{const ge=ye=>{p&&requestAnimationFrame(()=>{h({x:ye.clientX-k.current.x,y:ye.clientY-k.current.y})})},Ee=()=>{x(!1)};return p&&(window.addEventListener("mousemove",ge),window.addEventListener("mouseup",Ee)),()=>{window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",Ee)}},[p]);const se=ge=>{const Ee=ge.target.files?.[0];console.log("📎 Product file selected (edit):",Ee),Ee&&Ee.type==="application/pdf"?(A(Ee),console.log("✅ Product invoice set (edit):",Ee.name)):console.log("❌ Invalid product file type (edit):",Ee?.type)},Q=ge=>{const Ee=ge.target.files?.[0];console.log("📎 Transport file selected (edit):",Ee),Ee&&Ee.type==="application/pdf"?(L(Ee),console.log("✅ Transport invoice set (edit):",Ee.name)):console.log("❌ Invalid transport file type (edit):",Ee?.type)},he=()=>{M.current?.click()},me=()=>{ne.current?.click()},I=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const ge=g.filter(Ze=>Ze.kod&&Ze.nazwa&&Ze.ilosc&&Ze.cena);if(console.log("productRows:",g),console.log("validProducts:",ge),console.log("validProducts.length:",ge.length),ge.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const Ee=ge.map(Ze=>({kod:Ze.kod,nazwa:Ze.nazwa,kod_kreskowy:Ze.kod_kreskowy||"",ilosc:parseFloat(Ze.ilosc)||0,cena:parseFloat(Ze.cena.replace(",","."))||0,dataWaznosci:Ze.dataWaznosci||void 0,typ:Ze.typ||void 0,objetosc:Ze.objetosc?parseFloat(Ze.objetosc):void 0})),ye=Ee.reduce((Ze,Xe)=>Ze+Xe.ilosc*Xe.cena,0),Pe=parseFloat(w.replace(",","."))||0;console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ye,kosztDostawy:Pe,products:Ee}),console.log("📎 Files to submit (edit):",{productInvoice:E,transportInvoice:T}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ye,kosztDostawy:Pe,aktualnyKurs:parseFloat(oe.replace(",","."))||1,podatekAkcyzowy:parseFloat(V.replace(",","."))||0,products:Ee,productInvoice:E||null,transportInvoice:T||null}),Ve()},Ve=()=>{o(null),h({x:0,y:0}),y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),_(""),c(""),A(null),L(null),O(null),Z(null),n()},Ce=()=>g.reduce((ge,Ee)=>{const ye=parseFloat(Ee.ilosc)||0,Pe=parseFloat(Ee.cena.replace(",","."))||0;return ge+ye*Pe},0).toFixed(2);return d.jsx(Mr,{isOpen:e,onRequestClose:Ve,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:ee,style:{cursor:p?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:ge=>ge.stopPropagation(),children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),d.jsx("button",{type:"button",onClick:ge=>{ge.preventDefault(),ge.stopPropagation(),Ve()},className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),d.jsx(As,{selected:a,onChange:ge=>o(ge),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsx("div",{className:"w-[200px] flex items-start",children:d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:w,onKeyPress:ge=>{const Ee=String.fromCharCode(ge.which);(!/[\d,]/.test(Ee)||Ee===","&&ge.target.value.includes(",")||ge.target.value===""&&Ee===",")&&ge.preventDefault()},onChange:ge=>{const Ee=ge.target,ye=Ee.selectionStart??0;let Pe=Ee.value.replace(/[^\d,]/g,"");if(Pe===""){_("");return}if(!Pe.includes(","))Pe=Pe+",00";else{const[Xe,wt]=Pe.split(",");wt&&wt.length>2&&(Pe=`${Xe},${wt.slice(0,2)}`)}_(Pe),requestAnimationFrame(()=>{const Xe=Math.min(ye,Pe.length);Ee.setSelectionRange(Xe,Xe)})},className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),d.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"€"})]})]})}),d.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:se,className:"hidden",ref:M}),d.jsx("button",{type:"button",onClick:he,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:d.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),E&&d.jsx("a",{href:URL.createObjectURL(E),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:E.name,children:E.name}),!E&&J&&d.jsx("a",{href:`${Vu}${J}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:Q,className:"hidden",ref:ne}),d.jsx("button",{type:"button",onClick:me,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:d.jsx(Zd,{className:"h-4 w-4 text-gray-500"})}),T&&d.jsx("a",{href:URL.createObjectURL(T),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:T.name,children:T.name}),!T&&C&&d.jsx("a",{href:`${Vu}${C}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),d.jsx("input",{type:"text",value:l,onChange:ge=>c(ge.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),d.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[q().replace(".",",")," €"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:oe,onChange:ge=>pe(ge.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-8 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł/€"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:V,onChange:ge=>ie(ge.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł"})]})]})]}),d.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((ge,Ee)=>d.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[d.jsxs("div",{className:"col-span-1.5 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Kod"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:ge.kod,onChange:ye=>{const Pe=[...g];Pe[Ee].kod=ye.target.value,y(Pe)}}),Ee===g.length-1&&d.jsx("button",{onClick:ae,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:d.jsx(Js,{size:16})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Nazwa"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:ge.nazwa,onChange:ye=>{const Pe=[...g];Pe[Ee].nazwa=ye.target.value,y(Pe)}})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Kod kreskowy"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:ge.kod_kreskowy,onChange:ye=>{const Pe=[...g];Pe[Ee].kod_kreskowy=ye.target.value,y(Pe)}})]}),d.jsxs("div",{className:"col-span-1.5",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Ilość"}),d.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:ge.ilosc,onChange:ye=>{const Pe=[...g],Ze=ye.target.value;(Ze===""||/^\d*$/.test(Ze))&&(Pe[Ee].ilosc=Ze,y(Pe))}})]}),d.jsxs("div",{className:"col-span-2.9 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Cena"}),d.jsx("div",{className:"relative",children:d.jsx("input",{type:"text",value:ge.cena,onKeyPress:ye=>{const Pe=String.fromCharCode(ye.which);(!/[\d,]/.test(Pe)||Pe===","&&ye.target.value.includes(",")||ye.target.value===""&&Pe===",")&&ye.preventDefault()},onChange:ye=>{const Pe=ye.target,Ze=Pe.selectionStart??0;let Xe=ye.target.value.replace(/[^\d,]/g,"");if(Xe===""){const Pt=[...g];Pt[Ee].cena="",y(Pt);return}if(!Xe.includes(","))Xe=Xe+",00";else{const[Pt,Mt]=Xe.split(",");Mt&&Mt.length>2&&(Xe=`${Pt},${Mt.slice(0,2)}`)}const qt=[...g];qt[Ee].cena=Xe,y(qt),requestAnimationFrame(()=>{const Pt=Math.min(Ze,Xe.length);Pe.setSelectionRange(Pt,Pt)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),d.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Wartość"}),d.jsx("div",{className:"relative flex items-center",children:d.jsx("input",{type:"text",value:(()=>{const ye=parseFloat(ge.ilosc)||0,Pe=parseFloat(ge.cena.replace(",","."))||0;return(ye*Pe).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),d.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[d.jsx("button",{type:"button",onClick:()=>S(Ee),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${ge.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:ge.dataWaznosci?`Termin ważności: ${ge.dataWaznosci}`:"Dodaj termin ważności",children:d.jsx(qd,{size:16})}),d.jsx("button",{onClick:()=>B(Ee),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:d.jsx(Ht,{size:16})})]}),ge.showDataWaznosci&&d.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:d.jsx(As,{selected:ge.dataWaznosci?new Date(ge.dataWaznosci):null,onChange:ye=>{const Pe=[...g];Pe[Ee].dataWaznosci=ye?ye.toISOString().split("T")[0]:"",Pe[Ee].showDataWaznosci=!1,y(Pe)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const ye=[...g];ye[Ee].showDataWaznosci=!1,y(ye)}})}),d.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Typ"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>P(Ee),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${ge.typ&&yd.find(ye=>ye.value===ge.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate",children:ge.typ&&yd.find(ye=>ye.value===ge.typ)?.label||"Wybierz typ"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),G===Ee&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:ye=>ye.stopPropagation(),children:yd.map(ye=>d.jsx("button",{type:"button",onClick:()=>R(Ee,ye.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${ye.color}`,children:ye.label},ye.value))})]})]}),d.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ee>0?"invisible":""}`,children:"Objętość"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>H(Ee),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${ge.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[d.jsx("span",{className:"truncate",children:ge.objetosc?Sv.find(ye=>ye.value===ge.objetosc)?.label||ge.objetosc:"Wybierz"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),fe===Ee&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:ye=>ye.stopPropagation(),style:{maxWidth:"200px"},children:Sv.map(ye=>d.jsx("button",{type:"button",onClick:()=>W(Ee,ye.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:ye.label},ye.value))})]})]})]},Ee))})]}),d.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[d.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),d.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[Ce().replace(".",",")," €"]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:I,disabled:!a||!g.some(ge=>ge.kod&&ge.nazwa&&ge.ilosc&&ge.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(ge=>ge.kod&&ge.nazwa&&ge.ilosc&&ge.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},LR=({receipts:e,products:n,onDelete:t,onEdit:r,onUpdate:a,selectedCategory:o=""})=>{const[l,c]=N.useState(null),[f,h]=N.useState(!1),[p,x]=N.useState(!1),[g,y]=N.useState(null),[k,w]=N.useState(!1),[_,E]=N.useState(null),[A,T]=N.useState(""),[L,J]=N.useState({x:0,y:0}),[O,C]=N.useState(!1),Z=N.useRef({x:0,y:0}),[M,ne]=N.useState("dataPrzyjecia"),[G,z]=N.useState("desc"),[fe,ue]=N.useState(""),[oe,pe]=N.useState(""),V=Q=>{c(Q),h(!0)},ie=Q=>{y(Q),x(!0)},q=Q=>{E(Q),w(!0),T("")},ae=()=>{A==="5202"?(_?.id&&(t(_.id),ct.success("Zapis został usunięty")),B()):(ct.error("Nieprawidłowe hasło"),T(""))},B=()=>{w(!1),E(null),T(""),J({x:0,y:0})},S=Q=>{Q.key==="Enter"&&ae()},R=Q=>{M===Q?z(G==="asc"?"desc":"asc"):(ne(Q),z("asc"))},P=Q=>{Q.target.closest("button")||Q.target.closest("input")||(C(!0),Z.current={x:Q.clientX-L.x,y:Q.clientY-L.y})};N.useEffect(()=>{const Q=me=>{O&&requestAnimationFrame(()=>{J({x:me.clientX-Z.current.x,y:me.clientY-Z.current.y})})},he=()=>{C(!1)};return O&&(window.addEventListener("mousemove",Q),window.addEventListener("mouseup",he)),()=>{window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",he)}},[O]);const W=Array.from(new Set(e.map(Q=>new Date(Q.dataPrzyjecia).getFullYear().toString()))).sort((Q,he)=>parseInt(he)-parseInt(Q)),H=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],se=e.filter(Q=>{if(o)if(typeof Q.products=="string")try{if(!JSON.parse(Q.products).some(I=>I.typ===o))return!1}catch{return!1}else if(Array.isArray(Q.products)){if(!Q.products.some(me=>me.typ===o))return!1}else return!1;return!(fe&&new Date(Q.dataPrzyjecia).getFullYear().toString()!==fe||oe&&(new Date(Q.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==oe)}).sort((Q,he)=>{let me,I;switch(M){case"dataPrzyjecia":me=new Date(Q.dataPrzyjecia),I=new Date(he.dataPrzyjecia);break;case"sprzedawca":me=(Q.sprzedawca||"").toLowerCase(),I=(he.sprzedawca||"").toLowerCase();break;case"wartosc":me=Q.wartosc,I=he.wartosc;break;case"kosztDostawy":me=Q.kosztDostawy,I=he.kosztDostawy;break;default:me=Q[M]||"",I=he[M]||""}return typeof me=="string"&&typeof I=="string"?G==="asc"?me.localeCompare(I):I.localeCompare(me):typeof me=="number"&&typeof I=="number"?G==="asc"?me-I:I-me:me instanceof Date&&I instanceof Date?G==="asc"?me.getTime()-I.getTime():I.getTime()-me.getTime():0});return d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("dataPrzyjecia"),children:"Data zakupu"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("sprzedawca"),children:"Sprzedawca"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("wartosc"),children:"Wartość"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("kosztDostawy"),children:"Koszt dostawy"}),d.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:d.jsxs("div",{className:"flex space-x-1 justify-end",children:[d.jsxs("select",{value:fe,onChange:Q=>ue(Q.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[d.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),W.map(Q=>d.jsx("option",{value:Q,style:{fontFamily:"Sora, sans-serif"},children:Q},Q))]}),d.jsxs("select",{value:oe,onChange:Q=>pe(Q.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[d.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Msc"}),H.map(Q=>d.jsx("option",{value:Q.value,style:{fontFamily:"Sora, sans-serif"},children:Q.label},Q.value))]})]})})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.map(Q=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Q.dataPrzyjecia}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Q.sprzedawca}),d.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[Q.wartosc.toFixed(2)," €"]}),d.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[Q.kosztDostawy.toFixed(2)," €"]}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{type:"button",onClick:he=>{he.preventDefault(),he.stopPropagation(),V(Q)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:d.jsx(Jd,{size:16})}),d.jsx("button",{type:"button",onClick:he=>{he.preventDefault(),he.stopPropagation(),ie(Q)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:d.jsx(Gu,{size:16})}),d.jsx("button",{type:"button",onClick:he=>{he.preventDefault(),he.stopPropagation(),q(Q)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:d.jsx(Ht,{size:16})})]})})]},Q.id))})]})}),d.jsx(Mr,{isOpen:k,onRequestClose:B,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${L.x}px), calc(-50% + ${L.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:P,style:{cursor:O?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),d.jsx("button",{onClick:B,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsx("div",{children:d.jsx("input",{type:"password",value:A,onChange:Q=>T(Q.target.value),onKeyPress:S,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[d.jsx("button",{onClick:B,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),d.jsx("button",{onClick:ae,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),d.jsx(xw,{isOpen:f,onClose:()=>h(!1),receipt:l,products:n}),d.jsx(gw,{isOpen:p,onClose:()=>{x(!1),y(null)},onSubmit:Q=>{a({...Q,productInvoice:Q.productInvoice??void 0,transportInvoice:Q.transportInvoice??void 0}),x(!1),y(null)},receipt:g?{id:g.id||0,dataPrzyjecia:g.dataPrzyjecia,sprzedawca:g.sprzedawca,wartosc:g.wartosc,kosztDostawy:g.kosztDostawy,aktualnyKurs:g.aktualnyKurs,podatekAkcyzowy:g.podatekAkcyzowy,aktualny_kurs:g.aktualny_kurs,podatek_akcyzowy:g.podatek_akcyzowy,products:g.products,productInvoice:g.productInvoice,transportInvoice:g.transportInvoice}:null})]})},zR=({isOpen:e,onClose:n,client:t})=>t?d.jsx(Mr,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły klienta"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),d.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,vw=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=N.useState(""),[l,c]=N.useState(""),[f,h]=N.useState(""),[p,x]=N.useState(""),[g,y]=N.useState("");N.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),h(r.adres||""),x(r.czas_dostawy||""),y(r.kontakt||"")):(o(""),c(""),h(""),x(""),y(""))},[e,r]);const k=async()=>{if(a.trim()&&l.trim()&&f.trim()&&p.trim()&&g.trim()&&r){const _={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g};t(_),w()}},w=()=>{o(""),c(""),h(""),x(""),y(""),n()};return d.jsx(Mr,{isOpen:e,onRequestClose:w,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),d.jsx("button",{onClick:w,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),d.jsx("input",{type:"text",value:a,onChange:_=>o(_.target.value),placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),d.jsx("input",{type:"text",value:l,onChange:_=>c(_.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),d.jsx("input",{type:"text",value:f,onChange:_=>h(_.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),d.jsx("input",{type:"text",value:p,onChange:_=>x(_.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),d.jsx("input",{type:"text",value:g,onChange:_=>y(_.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:k,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},BR=({clients:e,onDelete:n,onEdit:t,onUpdate:r})=>{console.log("🔍 ClientsList render - clients:",e),console.log("🔍 ClientsList render - clients length:",e.length),console.log("🔍 ClientsList render - first client:",e[0]),console.log("🔍 ClientsList render - all clients:",e.map(ae=>({id:ae.id,firma:ae.firma,nazwa:ae.nazwa})));const[a,o]=N.useState(null),[l,c]=N.useState(!1),[f,h]=N.useState(!1),[p,x]=N.useState(null),[g,y]=N.useState(!1),[k,w]=N.useState(null),[_,E]=N.useState(""),[A,T]=N.useState({x:0,y:0}),[L,J]=N.useState(!1),O=N.useRef({x:0,y:0}),[C,Z]=N.useState(""),[M,ne]=N.useState("asc");e&&e.length>0,N.useEffect(()=>{console.log("🔍 ClientsList useEffect - clients changed:",e),console.log("🔍 ClientsList useEffect - clients length:",e.length)},[e]);const G=ae=>{o(ae),c(!0)},z=ae=>{x(ae),h(!0)},fe=ae=>{w(ae),y(!0),E("")},ue=()=>{_==="5202"?(k?.id&&n(k.id),oe()):(ct.error("Nieprawidłowe hasło"),E(""))},oe=()=>{y(!1),w(null),E(""),T({x:0,y:0})},pe=ae=>{ae.key==="Enter"&&ue()},V=ae=>{C===ae?ne(M==="asc"?"desc":"asc"):(Z(ae),ne("asc"))},ie=ae=>{ae.target.closest("button")||ae.target.closest("input")||(J(!0),O.current={x:ae.clientX-A.x,y:ae.clientY-A.y})};N.useEffect(()=>{const ae=S=>{L&&requestAnimationFrame(()=>{T({x:S.clientX-O.current.x,y:S.clientY-O.current.y})})},B=()=>{J(!1)};return L&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",B)),()=>{window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",B)}},[L]),console.log("🔍 Sorting logic - sortField:",C,"sortDirection:",M),console.log("🔍 Sorting logic - clients length:",e.length);const q=C?[...e].sort((ae,B)=>{let S,R;switch(C){case"firma":S=(ae.firma||"").toLowerCase(),R=(B.firma||"").toLowerCase();break;case"nazwa":S=(ae.nazwa||"").toLowerCase(),R=(B.nazwa||"").toLowerCase();break;case"adres":S=(ae.adres||"").toLowerCase(),R=(B.adres||"").toLowerCase();break;case"czas_dostawy":S=(ae.czas_dostawy||"").toLowerCase(),R=(B.czas_dostawy||"").toLowerCase();break;case"kontakt":S=(ae.kontakt||"").toLowerCase(),R=(B.kontakt||"").toLowerCase();break;default:S=ae[C]||"",R=B[C]||""}return typeof S=="string"&&typeof R=="string"?M==="asc"?S.localeCompare(R):R.localeCompare(S):0}):e;return console.log("🔍 Final sortedClients length:",q.length),console.log("🔍 Final sortedClients first:",q[0]),d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>V("firma"),children:["Nazwa firmy ",C==="firma"&&(M==="asc"?"↑":"↓")]}),d.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>V("nazwa"),children:["Nazwa ",C==="nazwa"&&(M==="asc"?"↑":"↓")]}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("adres"),children:"Adres"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("czas_dostawy"),children:"Czas dostawy"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("kontakt"),children:"Kontakt"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:C&&d.jsx("button",{onClick:()=>{Z(""),ne("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:"Сбросить сортировку",children:"Сброс"})})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map((ae,B)=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.firma}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.nazwa}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.adres}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.czas_dostawy}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.kontakt}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),S.stopPropagation(),G(ae)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:d.jsx(Jd,{size:16})}),d.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),S.stopPropagation(),z(ae)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:d.jsx(Gu,{size:16})}),d.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),S.stopPropagation(),fe(ae)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:d.jsx(Ht,{size:16})})]})})]},ae.id||`client-${B}`))})]})}),d.jsx(Mr,{isOpen:g,onRequestClose:oe,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${A.x}px), calc(-50% + ${A.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:ie,style:{cursor:L?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),d.jsx("button",{onClick:oe,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsx("div",{children:d.jsx("input",{type:"password",value:_,onChange:ae=>E(ae.target.value),onKeyPress:pe,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[d.jsx("button",{onClick:oe,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),d.jsx("button",{onClick:ue,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),d.jsx(zR,{isOpen:l,onClose:()=>c(!1),client:a}),d.jsx(vw,{isOpen:f,onClose:()=>{h(!1),x(null)},onSubmit:ae=>{r(ae),h(!1),x(null)},client:p})]})};var wd={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Tv;function WR(){return Tv||(Tv=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(wd)),wd.exports}var UR=WR();const Gd=Ku(UR);var Cv={};const HR="react-tooltip-core-styles",$R="react-tooltip-base-styles",Dv={core:!1,base:!1};function Nv({css:e,id:n=$R,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Dv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Cv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Cv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=HR),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Dv[t]=!0}const Fv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[ew(Number(a)),tw({fallbackAxisSideDirection:"start"}),HA({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const h=l;return t?(h.push(Hd({element:t,padding:5})),$d(e,n,{placement:r,strategy:o,middleware:h}).then((({x:p,y:x,placement:g,middlewareData:y})=>{var k,w;const _={left:`${p}px`,top:`${x}px`,border:c},{x:E,y:A}=(k=y.arrow)!==null&&k!==void 0?k:{x:0,y:0},T=(w={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&w!==void 0?w:"bottom",L=c&&{borderBottom:c,borderRight:c};let J=0;if(c){const O=`${c}`.match(/(\d+)px/);J=O?.[1]?Number(O[1]):1}return{tooltipStyles:_,tooltipArrowStyles:{left:E!=null?`${E}px`:"",top:A!=null?`${A}px`:"",right:"",bottom:"",...L,[T]:`-${f/2+J}px`},place:g}}))):$d(e,n,{placement:"bottom",strategy:o,middleware:h}).then((({x:p,y:x,placement:g})=>({tooltipStyles:{left:`${p}px`,top:`${x}px`},tooltipArrowStyles:{},place:g})))},Av=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),Ov=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Pv=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Xd=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Xd(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Pv(e)||!Pv(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Xd(e[a],n[a])))},YR=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Rv=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(YR(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},VR=typeof window<"u"?N.useLayoutEffect:N.useEffect,In=e=>{e.current&&(clearTimeout(e.current),e.current=null)},KR="DEFAULT_TOOLTIP_ID",GR={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},XR=N.createContext({getTooltipData:()=>GR});function yw(e=KR){return N.useContext(XR).getTooltipData(e)}var Ko={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},kd={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const QR=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:h=["hover"],openOnClick:p=!1,positionStrategy:x="absolute",middlewares:g,wrapper:y,delayShow:k=0,delayHide:w=0,float:_=!1,hidden:E=!1,noArrow:A=!1,clickable:T=!1,closeOnEsc:L=!1,closeOnScroll:J=!1,closeOnResize:O=!1,openEvents:C,closeEvents:Z,globalCloseEvents:M,imperativeModeOnly:ne,style:G,position:z,afterShow:fe,afterHide:ue,disableTooltip:oe,content:pe,contentWrapperRef:V,isOpen:ie,defaultIsOpen:q=!1,setIsOpen:ae,activeAnchor:B,setActiveAnchor:S,border:R,opacity:P,arrowColor:W,arrowSize:H=8,role:ee="tooltip"})=>{var se;const Q=N.useRef(null),he=N.useRef(null),me=N.useRef(null),I=N.useRef(null),Ve=N.useRef(null),[Ce,ge]=N.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[Ee,ye]=N.useState(!1),[Pe,Ze]=N.useState(!1),[Xe,wt]=N.useState(null),qt=N.useRef(!1),Pt=N.useRef(null),{anchorRefs:Mt,setActiveAnchor:ir}=yw(n),Zt=N.useRef(!1),[lr,It]=N.useState([]),Gt=N.useRef(!1),it=p||h.includes("click"),bt=it||C?.click||C?.dblclick||C?.mousedown,$t=C?{...C}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!C&&it&&Object.assign($t,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const gt=Z?{...Z}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!Z&&it&&Object.assign(gt,{mouseleave:!1,blur:!1,mouseout:!1});const re=M?{...M}:{escape:L||!1,scroll:J||!1,resize:O||!1,clickOutsideAnchor:bt||!1};ne&&(Object.assign($t,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(gt,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(re,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),VR((()=>(Gt.current=!0,()=>{Gt.current=!1})),[]);const Te=Ke=>{Gt.current&&(Ke&&Ze(!0),setTimeout((()=>{Gt.current&&(ae?.(Ke),ie===void 0&&ye(Ke))}),10))};N.useEffect((()=>{if(ie===void 0)return()=>null;ie&&Ze(!0);const Ke=setTimeout((()=>{ye(ie)}),10);return()=>{clearTimeout(Ke)}}),[ie]),N.useEffect((()=>{if(Ee!==qt.current)if(In(Ve),qt.current=Ee,Ee)fe?.();else{const Ke=(ot=>{const ht=ot.match(/^([\d.]+)(ms|s)$/);if(!ht)return 0;const[,Yt,nr]=ht;return Number(Yt)*(nr==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));Ve.current=setTimeout((()=>{Ze(!1),wt(null),ue?.()}),Ke+25)}}),[Ee]);const Ae=Ke=>{ge((ot=>Xd(ot,Ke)?ot:Ke))},ze=(Ke=k)=>{In(me),Pe?Te(!0):me.current=setTimeout((()=>{Te(!0)}),Ke)},le=(Ke=w)=>{In(I),I.current=setTimeout((()=>{Zt.current||Te(!1)}),Ke)},Ne=Ke=>{var ot;if(!Ke)return;const ht=(ot=Ke.currentTarget)!==null&&ot!==void 0?ot:Ke.target;if(!ht?.isConnected)return S(null),void ir({current:null});k?ze():Te(!0),S(ht),ir({current:ht}),In(I)},Oe=()=>{T?le(w||100):w?le():Te(!1),In(me)},$e=({x:Ke,y:ot})=>{var ht;const Yt={getBoundingClientRect:()=>({x:Ke,y:ot,width:0,height:0,top:ot,left:Ke,right:Ke,bottom:ot})};Fv({place:(ht=Xe?.place)!==null&&ht!==void 0?ht:c,offset:f,elementReference:Yt,tooltipReference:Q.current,tooltipArrowReference:he.current,strategy:x,middlewares:g,border:R,arrowSize:H}).then((nr=>{Ae(nr)}))},qe=Ke=>{if(!Ke)return;const ot=Ke,ht={x:ot.clientX,y:ot.clientY};$e(ht),Pt.current=ht},lt=Ke=>{var ot;if(!Ee)return;const ht=Ke.target;ht.isConnected&&(!((ot=Q.current)===null||ot===void 0)&&ot.contains(ht)||[document.querySelector(`[id='${o}']`),...lr].some((Yt=>Yt?.contains(ht)))||(Te(!1),In(me)))},Ye=Ov(Ne,50),st=Ov(Oe,50),At=Ke=>{st.cancel(),Ye(Ke)},at=()=>{Ye.cancel(),st()},vt=N.useCallback((()=>{var Ke,ot;const ht=(Ke=Xe?.position)!==null&&Ke!==void 0?Ke:z;ht?$e(ht):_?Pt.current&&$e(Pt.current):B?.isConnected&&Fv({place:(ot=Xe?.place)!==null&&ot!==void 0?ot:c,offset:f,elementReference:B,tooltipReference:Q.current,tooltipArrowReference:he.current,strategy:x,middlewares:g,border:R,arrowSize:H}).then((Yt=>{Gt.current&&Ae(Yt)}))}),[Ee,B,pe,G,c,Xe?.place,f,x,z,Xe?.position,_,H]);N.useEffect((()=>{var Ke,ot;const ht=new Set(Mt);lr.forEach((je=>{oe?.(je)||ht.add({current:je})}));const Yt=document.querySelector(`[id='${o}']`);Yt&&!oe?.(Yt)&&ht.add({current:Yt});const nr=()=>{Te(!1)},F=Rv(B),K=Rv(Q.current);re.scroll&&(window.addEventListener("scroll",nr),F?.addEventListener("scroll",nr),K?.addEventListener("scroll",nr));let j=null;re.resize?window.addEventListener("resize",nr):B&&Q.current&&(j=Jy(B,Q.current,vt,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const U=je=>{je.key==="Escape"&&Te(!1)};re.escape&&window.addEventListener("keydown",U),re.clickOutsideAnchor&&window.addEventListener("click",lt);const Y=[],X=je=>!!(je?.target&&B?.contains(je.target)),we=je=>{Ee&&X(je)||Ne(je)},Fe=je=>{Ee&&X(je)&&Oe()},ve=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],_e=["click","dblclick","mousedown","mouseup"];Object.entries($t).forEach((([je,Le])=>{Le&&(ve.includes(je)?Y.push({event:je,listener:At}):_e.includes(je)&&Y.push({event:je,listener:we}))})),Object.entries(gt).forEach((([je,Le])=>{Le&&(ve.includes(je)?Y.push({event:je,listener:at}):_e.includes(je)&&Y.push({event:je,listener:Fe}))})),_&&Y.push({event:"pointermove",listener:qe});const be=()=>{Zt.current=!0},Ie=()=>{Zt.current=!1,Oe()},He=T&&(gt.mouseout||gt.mouseleave);return He&&((Ke=Q.current)===null||Ke===void 0||Ke.addEventListener("mouseover",be),(ot=Q.current)===null||ot===void 0||ot.addEventListener("mouseout",Ie)),Y.forEach((({event:je,listener:Le})=>{ht.forEach((Be=>{var dt;(dt=Be.current)===null||dt===void 0||dt.addEventListener(je,Le)}))})),()=>{var je,Le;re.scroll&&(window.removeEventListener("scroll",nr),F?.removeEventListener("scroll",nr),K?.removeEventListener("scroll",nr)),re.resize?window.removeEventListener("resize",nr):j?.(),re.clickOutsideAnchor&&window.removeEventListener("click",lt),re.escape&&window.removeEventListener("keydown",U),He&&((je=Q.current)===null||je===void 0||je.removeEventListener("mouseover",be),(Le=Q.current)===null||Le===void 0||Le.removeEventListener("mouseout",Ie)),Y.forEach((({event:Be,listener:dt})=>{ht.forEach((zt=>{var jt;(jt=zt.current)===null||jt===void 0||jt.removeEventListener(Be,dt)}))}))}}),[B,vt,Pe,Mt,lr,C,Z,M,it,k,w]),N.useEffect((()=>{var Ke,ot;let ht=(ot=(Ke=Xe?.anchorSelect)!==null&&Ke!==void 0?Ke:l)!==null&&ot!==void 0?ot:"";!ht&&n&&(ht=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const Yt=new MutationObserver((nr=>{const F=[],K=[];nr.forEach((j=>{if(j.type==="attributes"&&j.attributeName==="data-tooltip-id"&&(j.target.getAttribute("data-tooltip-id")===n?F.push(j.target):j.oldValue===n&&K.push(j.target)),j.type==="childList"){if(B){const U=[...j.removedNodes].filter((Y=>Y.nodeType===1));if(ht)try{K.push(...U.filter((Y=>Y.matches(ht)))),K.push(...U.flatMap((Y=>[...Y.querySelectorAll(ht)])))}catch{}U.some((Y=>{var X;return!!(!((X=Y?.contains)===null||X===void 0)&&X.call(Y,B))&&(Ze(!1),Te(!1),S(null),In(me),In(I),!0)}))}if(ht)try{const U=[...j.addedNodes].filter((Y=>Y.nodeType===1));F.push(...U.filter((Y=>Y.matches(ht)))),F.push(...U.flatMap((Y=>[...Y.querySelectorAll(ht)])))}catch{}}})),(F.length||K.length)&&It((j=>[...j.filter((U=>!K.includes(U))),...F]))}));return Yt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{Yt.disconnect()}}),[n,l,Xe?.anchorSelect,B]),N.useEffect((()=>{vt()}),[vt]),N.useEffect((()=>{if(!V?.current)return()=>null;const Ke=new ResizeObserver((()=>{setTimeout((()=>vt()))}));return Ke.observe(V.current),()=>{Ke.disconnect()}}),[pe,V?.current]),N.useEffect((()=>{var Ke;const ot=document.querySelector(`[id='${o}']`),ht=[...lr,ot];B&&ht.includes(B)||S((Ke=lr[0])!==null&&Ke!==void 0?Ke:ot)}),[o,lr,B]),N.useEffect((()=>(q&&Te(!0),()=>{In(me),In(I)})),[]),N.useEffect((()=>{var Ke;let ot=(Ke=Xe?.anchorSelect)!==null&&Ke!==void 0?Ke:l;if(!ot&&n&&(ot=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),ot)try{const ht=Array.from(document.querySelectorAll(ot));It(ht)}catch{It([])}}),[n,l,Xe?.anchorSelect]),N.useEffect((()=>{me.current&&(In(me),ze(k))}),[k]);const Dr=(se=Xe?.content)!==null&&se!==void 0?se:pe,en=Ee&&Object.keys(Ce.tooltipStyles).length>0;return N.useImperativeHandle(e,(()=>({open:Ke=>{if(Ke?.anchorSelect)try{document.querySelector(Ke.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ke.anchorSelect}" is not a valid CSS selector`)}wt(Ke??null),Ke?.delay?ze(Ke.delay):Te(!0)},close:Ke=>{Ke?.delay?le(Ke.delay):Te(!1)},activeAnchor:B,place:Ce.place,isOpen:!!(Pe&&!E&&Dr&&en)}))),Pe&&!E&&Dr?De.createElement(y,{id:n,role:ee,className:Gd("react-tooltip",Ko.tooltip,kd.tooltip,kd[a],t,`react-tooltip__place-${Ce.place}`,Ko[en?"show":"closing"],en?"react-tooltip__show":"react-tooltip__closing",x==="fixed"&&Ko.fixed,T&&Ko.clickable),onTransitionEnd:Ke=>{In(Ve),Ee||Ke.propertyName!=="opacity"||(Ze(!1),wt(null),ue?.())},style:{...G,...Ce.tooltipStyles,opacity:P!==void 0&&en?P:void 0},ref:Q},Dr,De.createElement(y,{className:Gd("react-tooltip-arrow",Ko.arrow,kd.arrow,r,A&&Ko.noArrow),style:{...Ce.tooltipArrowStyles,background:W?`linear-gradient(to right bottom, transparent 50%, ${W} 50%)`:void 0,"--rt-arrow-size":`${H}px`},ref:he})):null},qR=({content:e})=>De.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),pu=De.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:h="top",offset:p=10,wrapper:x="div",children:g=null,events:y=["hover"],openOnClick:k=!1,positionStrategy:w="absolute",middlewares:_,delayShow:E=0,delayHide:A=0,float:T=!1,hidden:L=!1,noArrow:J=!1,clickable:O=!1,closeOnEsc:C=!1,closeOnScroll:Z=!1,closeOnResize:M=!1,openEvents:ne,closeEvents:G,globalCloseEvents:z,imperativeModeOnly:fe=!1,style:ue,position:oe,isOpen:pe,defaultIsOpen:V=!1,disableStyleInjection:ie=!1,border:q,opacity:ae,arrowColor:B,arrowSize:S,setIsOpen:R,afterShow:P,afterHide:W,disableTooltip:H,role:ee="tooltip"},se)=>{const[Q,he]=N.useState(r),[me,I]=N.useState(a),[Ve,Ce]=N.useState(h),[ge,Ee]=N.useState(f),[ye,Pe]=N.useState(p),[Ze,Xe]=N.useState(E),[wt,qt]=N.useState(A),[Pt,Mt]=N.useState(T),[ir,Zt]=N.useState(L),[lr,It]=N.useState(x),[Gt,it]=N.useState(y),[bt,$t]=N.useState(w),[gt,re]=N.useState(null),[Te,Ae]=N.useState(null),ze=N.useRef(ie),{anchorRefs:le,activeAnchor:Ne}=yw(e),Oe=st=>st?.getAttributeNames().reduce(((At,at)=>{var vt;return at.startsWith("data-tooltip-")&&(At[at.replace(/^data-tooltip-/,"")]=(vt=st?.getAttribute(at))!==null&&vt!==void 0?vt:null),At}),{}),$e=st=>{const At={place:at=>{var vt;Ce((vt=at)!==null&&vt!==void 0?vt:h)},content:at=>{he(at??r)},html:at=>{I(at??a)},variant:at=>{var vt;Ee((vt=at)!==null&&vt!==void 0?vt:f)},offset:at=>{Pe(at===null?p:Number(at))},wrapper:at=>{var vt;It((vt=at)!==null&&vt!==void 0?vt:x)},events:at=>{const vt=at?.split(" ");it(vt??y)},"position-strategy":at=>{var vt;$t((vt=at)!==null&&vt!==void 0?vt:w)},"delay-show":at=>{Xe(at===null?E:Number(at))},"delay-hide":at=>{qt(at===null?A:Number(at))},float:at=>{Mt(at===null?T:at==="true")},hidden:at=>{Zt(at===null?L:at==="true")},"class-name":at=>{re(at)}};Object.values(At).forEach((at=>at(null))),Object.entries(st).forEach((([at,vt])=>{var Dr;(Dr=At[at])===null||Dr===void 0||Dr.call(At,vt)}))};N.useEffect((()=>{he(r)}),[r]),N.useEffect((()=>{I(a)}),[a]),N.useEffect((()=>{Ce(h)}),[h]),N.useEffect((()=>{Ee(f)}),[f]),N.useEffect((()=>{Pe(p)}),[p]),N.useEffect((()=>{Xe(E)}),[E]),N.useEffect((()=>{qt(A)}),[A]),N.useEffect((()=>{Mt(T)}),[T]),N.useEffect((()=>{Zt(L)}),[L]),N.useEffect((()=>{$t(w)}),[w]),N.useEffect((()=>{ze.current!==ie&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[ie]),N.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:ie==="core",disableBase:ie}}))}),[]),N.useEffect((()=>{var st;const At=new Set(le);let at=t;if(!at&&e&&(at=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),at)try{document.querySelectorAll(at).forEach((ot=>{At.add({current:ot})}))}catch{console.warn(`[react-tooltip] "${at}" is not a valid CSS selector`)}const vt=document.querySelector(`[id='${n}']`);if(vt&&At.add({current:vt}),!At.size)return()=>null;const Dr=(st=Te??vt)!==null&&st!==void 0?st:Ne.current,en=new MutationObserver((ot=>{ot.forEach((ht=>{var Yt;if(!Dr||ht.type!=="attributes"||!(!((Yt=ht.attributeName)===null||Yt===void 0)&&Yt.startsWith("data-tooltip-")))return;const nr=Oe(Dr);$e(nr)}))})),Ke={attributes:!0,childList:!1,subtree:!1};if(Dr){const ot=Oe(Dr);$e(ot),en.observe(Dr,Ke)}return()=>{en.disconnect()}}),[le,Ne,Te,n,t]),N.useEffect((()=>{ue?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),q&&!Av("border",`${q}`)&&console.warn(`[react-tooltip] "${q}" is not a valid \`border\`.`),ue?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),ae&&!Av("opacity",`${ae}`)&&console.warn(`[react-tooltip] "${ae}" is not a valid \`opacity\`.`)}),[]);let qe=g;const lt=N.useRef(null);if(o){const st=o({content:Te?.getAttribute("data-tooltip-content")||Q||null,activeAnchor:Te});qe=st?De.createElement("div",{ref:lt,className:"react-tooltip-content-wrapper"},st):null}else Q&&(qe=Q);me&&(qe=De.createElement(qR,{content:me}));const Ye={forwardRef:se,id:e,anchorId:n,anchorSelect:t,className:Gd(l,gt),classNameArrow:c,content:qe,contentWrapperRef:lt,place:Ve,variant:ge,offset:ye,wrapper:lr,events:Gt,openOnClick:k,positionStrategy:bt,middlewares:_,delayShow:Ze,delayHide:wt,float:Pt,hidden:ir,noArrow:J,clickable:O,closeOnEsc:C,closeOnScroll:Z,closeOnResize:M,openEvents:ne,closeEvents:G,globalCloseEvents:z,imperativeModeOnly:fe,style:ue,position:oe,isOpen:pe,defaultIsOpen:V,border:q,opacity:ae,arrowColor:B,arrowSize:S,setIsOpen:R,afterShow:P,afterHide:W,disableTooltip:H,activeAnchor:Te,setActiveAnchor:st=>Ae(st),role:ee};return De.createElement(QR,{...Ye})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Nv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Nv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));xi("pl",gi);const _d=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],ZR=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],JR=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=N.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:""}),[l,c]=N.useState(!1),[f,h]=N.useState(!1),[p,x]=N.useState(!1),[g,y]=N.useState(!1),[k,w]=N.useState(null);N.useEffect(()=>{if(t)if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const C=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(C).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():""}),t.data_waznosci){let C;if(typeof t.data_waznosci=="string")C=new Date(t.data_waznosci);else{const Z=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;C=new Date(Z)}w(isNaN(C.getTime())?null:C)}else w(null)},[t]);const _=C=>{o(Z=>({...Z,typ:C})),h(!1)},E=()=>{h(!f)},A=C=>{o(Z=>({...Z,objetosc:C})),x(!1)},T=()=>{x(!p)},L=()=>{y(!g)},J=C=>{w(C),o(Z=>({...Z,data_waznosci:C?C.toISOString().split("T")[0]:""})),y(!1)};N.useEffect(()=>{const C=M=>{const ne=M.target;f&&!ne.closest(".dropdown-container")&&h(!1),p&&!ne.closest(".dropdown-container")&&x(!1),g&&!ne.closest(".react-datepicker")&&!ne.closest('button[title*="ważności"]')&&y(!1)},Z=M=>{M.key==="Escape"&&(h(!1),x(!1),y(!1))};return(f||p||g)&&(document.addEventListener("mousedown",C),document.addEventListener("keydown",Z)),()=>{document.removeEventListener("mousedown",C),document.removeEventListener("keydown",Z)}},[f,p,g]);const O=async C=>{if(C&&C.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0})})).ok)throw new Error("Failed to update item");const M={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(ne){console.error("Error creating price history record:",ne)}r(M),ct.success("Pozycja została zaktualizowana pomyślnie"),n()}catch(Z){console.error("Error updating item:",Z),ct.error("Błąd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:d.jsx(Mr,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycję"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsx("form",{onSubmit:O,className:"space-y-6 flex-grow",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),d.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),d.jsx("input",{type:"text",value:a.sprzedawca,onChange:C=>o(Z=>({...Z,sprzedawca:C.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{className:"relative dropdown-container",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:E,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&_d.find(C=>C.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate",children:a.typ&&_d.find(C=>C.value===a.typ)?.label||"Wybierz typ"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:_d.map(C=>d.jsx("button",{type:"button",onClick:()=>_(C.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${C.color}`,children:C.label},C.value))})]})]}),d.jsxs("div",{className:"relative dropdown-container",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objętość"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:T,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[d.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:ZR.map(C=>d.jsx("button",{type:"button",onClick:()=>A(C.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:C.label},C.value))})]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data ważności"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"text",value:k?k.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz datę",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),d.jsx("button",{type:"button",onClick:L,className:`p-1 focus:outline-none ${k?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:k?`Termin ważności: ${k.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:d.jsx(qd,{size:16})})]}),g&&d.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:d.jsx(As,{selected:k,onChange:J,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>y(!1)})})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa (€)"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:C=>o(Z=>({...Z,cena:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzedaży (zł)"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:C=>o(Z=>({...Z,cena_sprzedazy:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:O,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},eM=`
  .react-tooltip {
    z-index: 9999 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .resizable-table {
    table-layout: fixed !important;
    width: max-content !important;
    min-width: 100% !important;
  }
  
  .resizable-table th,
  .resizable-table td {
    box-sizing: border-box !important;
    overflow: hidden !important;
  }
  
  /* no generic resizable columns */
`,bd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],tM=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}return""}catch(n){return console.error("Error extracting date from order number:",n),""}},Ed=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},rM=({refreshTrigger:e,productReceipts:n=[]})=>{N.useEffect(()=>{const re=document.createElement("style");return re.textContent=eM,document.head.appendChild(re),()=>{document.head.removeChild(re)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState([]),[f,h]=N.useState(!0),[p,x]=N.useState(null),[g,y]=N.useState(""),[k,w]=N.useState(()=>localStorage.getItem("sortField")||"nazwa"),[_,E]=N.useState(()=>localStorage.getItem("sortDirection")||"asc"),[A,T]=N.useState([]),[L,J]=N.useState({}),[O,C]=N.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[Z,M]=N.useState(!1),[ne,G]=N.useState(null),[z,fe]=N.useState({}),[ue,oe]=N.useState({}),[pe,V]=N.useState({}),[ie,q]=N.useState(()=>{const re=localStorage.getItem("columnWidths");if(re)try{return JSON.parse(re)}catch(Te){console.error("Error parsing saved column widths:",Te)}return{nazwa:250}}),[ae,B]=N.useState(null),[S,R]=N.useState(0),[P,W]=N.useState(0),[H,ee]=N.useState(!1),se=N.useRef(null),Q=N.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const re=new Map;try{for(const Te of n)if(Array.isArray(Te.products))for(const Ae of Te.products)Ae.kod&&!re.has(Ae.kod)&&re.set(Ae.kod,Te.sprzedawca)}catch(Te){console.error("Error building sprzedawcaCache:",Te)}return console.log("sprzedawcaCache built with",re.size,"entries"),re},[n]),he=N.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const re=new Map;try{const Te=Ae=>{let ze=null;return n.forEach(le=>{if(Array.isArray(le.products)&&le.products.some(Ne=>Ne.kod===Ae)){const Ne=new Date(le.dataPrzyjecia);(!ze||Ne<ze)&&(ze=Ne)}}),a.forEach(le=>{if(le.kod===Ae){let Ne=null;le.numer_zamowienia&&(Ne=Ed(le.numer_zamowienia)),!Ne&&le.created_at&&(Ne=new Date(le.created_at)),Ne&&(!ze||Ne<ze)&&(ze=Ne)}}),ze};for(const Ae of t){const ze=Te(Ae.kod);if(ze){const Ne=Math.max(1,Math.ceil((new Date().getTime()-ze.getTime())/(1e3*60*60*24))),Oe=a.filter($e=>$e.kod!==Ae.kod?!1:$e.numer_zamowienia?Ed($e.numer_zamowienia)!==null:$e.created_at!==null).reduce(($e,qe)=>$e+qe.ilosc,0);re.set(Ae.kod,Oe/Ne)}else re.set(Ae.kod,0)}}catch(Te){console.error("Error building averageSalesCache:",Te)}return console.log("averageSalesCache built with",re.size,"entries"),re},[t,a,n]),me=async()=>{try{const re=await fetch("/api/products");if(re.ok){const Te=await re.json(),Ae={};Te.forEach(ze=>{Ae[ze.kod]||(Ae[ze.kod]=[]),Ae[ze.kod].push({cena:ze.cena,ilosc_aktualna:ze.ilosc_aktualna,data_zmiany:ze.updated_at||ze.created_at})}),Object.keys(Ae).forEach(ze=>{Ae[ze].sort((le,Ne)=>new Date(Ne.data_zmiany).getTime()-new Date(le.data_zmiany).getTime())}),fe(Ae)}}catch(re){console.error("Error loading all products:",re)}},I=re=>{const Te=a.filter(ze=>ze.kod===re);if(Te.length===0)return null;let Ae=null;return Te.forEach(ze=>{let le=null;ze.numer_zamowienia&&(le=Ed(ze.numer_zamowienia)),!le&&ze.created_at&&(le=new Date(ze.created_at)),le&&(!Ae||le>Ae)&&(Ae=le)}),Ae},Ve=async()=>{try{console.log("Starting loadInventory..."),h(!0),x(null),console.log("Fetching working-sheets...");const re=await fetch("/api/working-sheets");if(!re.ok)throw new Error(`HTTP error! status: ${re.status}`);const Te=await re.json();console.log("Inventory data from server:",Te.length,"items"),Te.length>0&&(console.log("First item keys:",Object.keys(Te[0])),console.log("First item typ value:",Te[0].typ),Te[0].data_waznosci&&(console.log("First item data_waznosci:",Te[0].data_waznosci),console.log("First item data_waznosci type:",typeof Te[0].data_waznosci),console.log("First item data_waznosci formatted:",$t(Te[0].data_waznosci)))),r(Te),console.log("Fetching orders...");const Ae=await fetch("/api/orders");if(!Ae.ok)throw new Error(`HTTP error! status: ${Ae.status}`);const ze=await Ae.json();console.log("Orders data from server:",ze.length,"items"),c(ze),console.log("Fetching orders-with-products...");const le=await fetch("/api/orders-with-products");if(!le.ok)throw new Error(`HTTP error! status: ${le.status}`);const Ne=await le.json();console.log("Orders with products from server:",Ne.length,"items");const Oe=[];Ne.forEach(lt=>{lt.products&&lt.products.forEach(Ye=>{Oe.push({...Ye,orderId:lt.id,created_at:Ye.created_at||lt.data_utworzenia,numer_zamowienia:lt.numer_zamowienia})})}),console.log("Total order products:",Oe.length),o(Oe),await me();const $e=await fetch("/api/products/samples-count");if($e.ok){const lt=await $e.json(),Ye={};lt.forEach(st=>{Ye[st.kod]=st.total_ilosc||0}),oe(Ye)}const qe=await fetch("/api/products/wartosc-towaru");if(qe.ok){const lt=await qe.json(),Ye={};lt.forEach(st=>{Ye[st.kod]=st.wartosc||0}),V(Ye)}console.log("loadInventory completed successfully")}catch(re){console.error("Error loading inventory:",re),x(`Failed to load inventory: ${re instanceof Error?re.message:"Unknown error"}`)}finally{h(!1)}};N.useEffect(()=>{Ve()},[]),N.useEffect(()=>{e&&Ve()},[e]);const Ce=re=>{if(k===re){const Te=_==="asc"?"desc":"asc";E(Te),localStorage.setItem("sortDirection",Te)}else w(re),E("asc"),localStorage.setItem("sortField",re),localStorage.setItem("sortDirection","asc")},ge=re=>{const Te=bd.find(Ae=>Ae.value===re);return Te?Te.color:"bg-gray-100 text-gray-800 border-gray-200"},Ee=re=>re===1/0?"bg-gray-100 text-gray-800 border-gray-200":re<=30?"bg-red-100 text-gray-800 border-red-200":re<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",ye=N.useMemo(()=>{const re=new Set;return t.forEach(Te=>{const Ae=Te.sprzedawca||Q.get(Te.kod);Ae&&re.add(Ae)}),Array.from(re).sort()},[t,Q]),Pe=N.useMemo(()=>{const re=new Set;return t.forEach(Te=>{Te.typ&&re.add(Te.typ)}),Array.from(re).sort()},[t]),Ze=N.useMemo(()=>{const re=new Set;return t.forEach(Te=>{Te.objetosc&&re.add(Te.objetosc.toString())}),Array.from(re).sort((Te,Ae)=>parseFloat(Te)-parseFloat(Ae))},[t]),Xe=N.useMemo(()=>{const re=new Set;return t.forEach(Te=>{if(Te.ilosc===0)re.add("brak");else{const Ae=he.get(Te.kod)||0,ze=Ae<=0?1/0:Math.floor(Te.ilosc/Ae),le=ze===1/0?"Brak danych":ze<=30?"mało":ze<=60?"średnie":"dużo";re.add(le)}}),Array.from(re).sort()},[t,he]),wt=t.filter(re=>{if(!(re.kod.toLowerCase().includes(g.toLowerCase())||re.nazwa.toLowerCase().includes(g.toLowerCase())||re.kod_kreskowy&&re.kod_kreskowy.toLowerCase().includes(g.toLowerCase()))||O.sprzedawca&&(re.sprzedawca||Q.get(re.kod))!==O.sprzedawca||O.typ&&re.typ!==O.typ||O.objetosc&&re.objetosc?.toString()!==O.objetosc)return!1;if(O.status){let Ae;if(re.ilosc===0)Ae="brak";else{const ze=he.get(re.kod)||0,le=ze<=0?1/0:Math.floor(re.ilosc/ze);Ae=le===1/0?"Brak danych":le<=30?"mało":le<=60?"średnie":"dużo"}if(Ae!==O.status)return!1}return!0}).sort((re,Te)=>{let Ae,ze;switch(k){case"sprzedawca":Ae=re.sprzedawca||Q.get(re.kod)||"",ze=Te.sprzedawca||Q.get(Te.kod)||"";break;case"cena":Ae=re.cena||0,ze=Te.cena||0;break;case"cena_sprzedazy":Ae=re.cena_sprzedazy||0,ze=Te.cena_sprzedazy||0;break;case"koszt_wlasny":Ae=re.koszt_wlasny||0,ze=Te.koszt_wlasny||0;break;case"srednieZuzycie":Ae=he.get(re.kod)||0,ze=he.get(Te.kod)||0;break;case"dniPozostalo":const le=he.get(re.kod)||0,Ne=he.get(Te.kod)||0;Ae=le<=0?1/0:Math.floor(re.ilosc/le),ze=Ne<=0?1/0:Math.floor(Te.ilosc/Ne);break;case"dataWyczerpania":if(re.ilosc===0){const Ye=I(re.kod);Ae=Ye?Ye.getTime():0}else{const Ye=he.get(re.kod)||0,st=Ye<=0?1/0:Math.floor(re.ilosc/Ye);Ae=st===1/0?1/0:new Date().setDate(new Date().getDate()+st)}if(Te.ilosc===0){const Ye=I(Te.kod);ze=Ye?Ye.getTime():0}else{const Ye=he.get(Te.kod)||0,st=Ye<=0?1/0:Math.floor(Te.ilosc/Ye);ze=st===1/0?1/0:new Date().setDate(new Date().getDate()+st)}break;case"status":const Oe=Ye=>{if(Ye.ilosc===0)return 0;const st=he.get(Ye.kod)||0,At=st<=0?1/0:Math.floor(Ye.ilosc/st);return At===1/0?4:At<=30?1:At<=60?2:3};Ae=Oe(re),ze=Oe(Te);break;case"typ":Ae=re.typ||"",ze=Te.typ||"";break;case"objetosc":Ae=re.objetosc||0,ze=Te.objetosc||0;break;case"dataWaznosci":const $e=Ye=>{if(!Ye)return 0;let st;if(typeof Ye=="string")st=new Date(Ye);else if(typeof Ye=="number")Ye<1e12?st=new Date(Ye*1e3):st=new Date(Ye);else return 0;return isNaN(st.getTime())?0:st.getTime()};Ae=$e(re.data_waznosci),ze=$e(Te.data_waznosci);break;case"sprzedaze":const qe=a.filter(Ye=>Ye.kod===re.kod).length,lt=a.filter(Ye=>Ye.kod===Te.kod).length;Ae=qe,ze=lt;break;default:Ae=re[k],ze=Te[k]}return typeof Ae=="string"&&typeof ze=="string"?_==="asc"?Ae.localeCompare(ze):ze.localeCompare(Ae):typeof Ae=="number"&&typeof ze=="number"?_==="asc"?Ae-ze:ze-Ae:0}),qt=re=>{T(re?wt.map(Te=>Te.id):[])},Pt=(re,Te)=>{T(Ae=>Te?[...Ae,re]:Ae.filter(ze=>ze!==re))},Mt=(re,Te)=>{re.preventDefault(),re.stopPropagation(),console.log("🖱️ Mouse down on column:",Te,"X:",re.clientX,"Current width:",ie[Te]),B(Te),R(re.clientX),W(ie[Te]),ee(!1),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},ir=re=>{if(ae){const Te=re.clientX-S,Ae=Math.max(50,P+Te);console.log("🔄 Mouse move:","DeltaX:",Te,"NewWidth:",Ae,"Column:",ae),Math.abs(Te)>3&&ee(!0);const ze={...ie,[ae]:Ae};q(ze),localStorage.setItem("columnWidths",JSON.stringify(ze))}},Zt=()=>{console.log("🖱️ Mouse up - finishing resize"),B(null),R(0),W(0),document.body.style.cursor="",document.body.style.userSelect="",setTimeout(()=>{ee(!1)},100)};N.useEffect(()=>{if(ae)return document.addEventListener("mousemove",ir),document.addEventListener("mouseup",Zt),()=>{document.removeEventListener("mousemove",ir),document.removeEventListener("mouseup",Zt)}},[ae,S,P]);const lr=re=>{J(Te=>({...Te,[re]:Math.max(0,(Te[re]||0)-1)}))},It=(re,Te)=>{J(Ae=>({...Ae,[re]:Math.min(Te,(Ae[re]||0)+1)}))},Gt=()=>{if(A.length!==1){ct.error("Wybierz dokładnie jedną pozycję do edycji");return}const re=t.find(Te=>Te.id===A[0]);re&&(G(re),M(!0))},it=re=>{r(Te=>Te.map(Ae=>Ae.id===re.id?re:Ae)),T([])},bt=wt.length>0&&wt.every(re=>A.includes(re.id)),$t=re=>{if(!re)return"-";let Te;if(typeof re=="string")Te=new Date(re);else if(typeof re=="number")re<1e12?Te=new Date(re*1e3):Te=new Date(re);else return"-";return isNaN(Te.getTime())?"-":Te.toLocaleDateString("pl-PL")},gt=A.length>0?t.filter(re=>A.includes(re.id)):[];return f?d.jsx("div",{className:"flex justify-center items-center py-8",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p?d.jsxs("div",{className:"text-center py-8",children:[d.jsx("p",{className:"text-red-600 font-sora",children:p}),d.jsx("button",{onClick:Ve,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[d.jsxs("div",{className:"relative w-full max-w-xs",children:[d.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),d.jsx("input",{type:"text",value:g,onChange:re=>y(re.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),d.jsx("button",{onClick:Gt,disabled:A.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:d.jsx(Gu,{size:16})})]}),d.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[d.jsxs("div",{className:"flex flex-wrap gap-4",children:[d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykułów"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:gt.length})]}),d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Łączna ilość towaru"}),d.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:gt.length>0?gt.reduce((re,Te)=>re+(Te.ilosc||0),0):0})]}),d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru fakturowa"}),d.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[gt.length>0?gt.reduce((re,Te)=>re+(pe[Te.kod]||0),0).toFixed(2):"0.00"," €"]})]}),d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru w sprzedaży"}),d.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[gt.length>0?gt.reduce((re,Te)=>{const Ae=Te.cena_sprzedazy||0,ze=Te.ilosc||0;return re+Ae*ze},0).toFixed(2):"0.00"," zł"]})]})]}),d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[d.jsx("div",{className:"relative",children:d.jsxs("select",{value:O.sprzedawca,onChange:re=>C(Te=>({...Te,sprzedawca:re.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Sprzedawca"}),ye.map(re=>d.jsx("option",{value:re,children:re},re))]})}),d.jsx("div",{className:"relative",children:d.jsxs("select",{value:O.typ,onChange:re=>C(Te=>({...Te,typ:re.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Typ"}),Pe.map(re=>d.jsx("option",{value:re,children:bd.find(Te=>Te.value===re)?.label||re},re))]})}),d.jsx("div",{className:"relative",children:d.jsxs("select",{value:O.objetosc,onChange:re=>C(Te=>({...Te,objetosc:re.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Objętość"}),Ze.map(re=>d.jsxs("option",{value:re,children:[re," l"]},re))]})}),d.jsx("div",{className:"relative",children:d.jsxs("select",{value:O.status,onChange:re=>C(Te=>({...Te,status:re.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Status"}),Xe.map(re=>d.jsx("option",{value:re,children:re},re))]})})]}),(O.sprzedawca||O.typ||O.objetosc||O.status)&&d.jsx("button",{onClick:()=>C({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczyść filtry"})]})]}),d.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:d.jsx("div",{className:"w-full overflow-x-auto overflow-y-scroll max-h-[500px] relative",children:d.jsxs("table",{className:"w-full resizable-table",ref:se,children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:d.jsx("input",{type:"checkbox",checked:bt,onChange:re=>qt(re.target.checked)})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ce("kod"),style:{width:"100px"},children:"Kod"}),d.jsxs("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 relative",onClick:()=>{H||Ce("nazwa")},style:{width:`${ie.nazwa}px`},children:["Nazwa",d.jsx("div",{className:`absolute top-0 right-0 h-full cursor-col-resize hover:bg-blue-500 transition-opacity z-10 ${ae==="nazwa"?"bg-blue-500 opacity-100":"opacity-0 hover:opacity-100"}`,style:{width:"2px"},onMouseDown:re=>{re.preventDefault(),re.stopPropagation(),Mt(re,"nazwa")}})]}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ce("sprzedawca"),style:{width:"120px"},children:"Sprzedawca"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ce("ilosc"),children:"Ilość"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ce("typ"),children:"Typ"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ce("objetosc"),children:"Objętość"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>Ce("cena"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Cena",d.jsx("br",{}),"fakturowa"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>Ce("koszt_wlasny"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Koszt",d.jsx("br",{}),"własny"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>Ce("cena_sprzedazy"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Cena w",d.jsx("br",{}),"sprzedaży"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>Ce("dataWaznosci"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Data",d.jsx("br",{}),"ważności"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ce("sprzedaze"),children:"Sprzedaże"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>Ce("srednieZuzycie"),style:{width:"100px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Średnie",d.jsx("br",{}),"zużycie/dzień"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>Ce("dniPozostalo"),style:{width:"80px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Dni",d.jsx("br",{}),"pozostało"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>Ce("dataWyczerpania"),style:{width:"110px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Data wyczerpania",d.jsx("br",{}),"zapasów"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>Ce("status"),children:"Status"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:wt.map(re=>{const Te=he.get(re.kod)||0;return Te<=0||Math.floor(re.ilosc/Te),d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:d.jsx("input",{type:"checkbox",checked:A.includes(re.id),onChange:Ae=>Pt(re.id,Ae.target.checked)})}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:"100px"},children:d.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:re.kod})}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:`${ie.nazwa}px`},children:d.jsx("div",{className:"break-words leading-tight max-h-12 overflow-hidden",children:re.nazwa})}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",style:{width:"120px"},children:re.sprzedawca||Q.get(re.kod)||""}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`ilosc-tooltip-${re.kod}`,children:[re.ilosc,d.jsx(pu,{id:`ilosc-tooltip-${re.kod}`,place:"top",children:d.jsx("div",{className:"font-sora",children:d.jsxs("div",{className:"font-medium",children:["Samples - ",ue[re.kod]||0]})})})]}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:re.typ?d.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${ge(re.typ)}`,children:bd.find(Ae=>Ae.value===re.typ)?.label||re.typ}):"-"}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:re.objetosc?`${re.objetosc} l`:"-"}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${re.kod}`,onMouseEnter:()=>{z[re.kod]||me()},children:[re.cena!=null?`${re.cena.toFixed(2)} €`:"-",d.jsx(pu,{id:`price-tooltip-${re.kod}`,className:"max-w-md",place:"top",children:d.jsxs("div",{className:"font-sora",children:[d.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),z[re.kod]&&z[re.kod].length>0?z[re.kod].map((Ae,ze)=>d.jsxs("div",{className:"mb-1",children:[d.jsx("span",{className:"font-medium",children:Ae.cena!=null?`${Ae.cena.toFixed(2)} €`:"N/A"}),d.jsxs("span",{className:"text-gray-500 ml-2",children:["(",Ae.ilosc_aktualna," szt.)"]})]},ze)):d.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`koszt-tooltip-${re.kod}`,children:[re.koszt_wlasny!=null?`${re.koszt_wlasny.toFixed(2)} zł`:"-",d.jsx(pu,{id:`koszt-tooltip-${re.kod}`,className:"max-w-md",place:"top",children:d.jsxs("div",{className:"font-sora",children:[d.jsxs("div",{className:"mb-1",children:[d.jsx("span",{className:"font-medium",children:"Transport:"}),d.jsx("span",{className:"text-gray-500 ml-2",children:re.koszt_dostawy_per_unit!=null?`${re.koszt_dostawy_per_unit.toFixed(2)} zł`:"0,00 zł"})]}),d.jsxs("div",{className:"mb-1",children:[d.jsx("span",{className:"font-medium",children:"Akcyza:"}),d.jsx("span",{className:"text-gray-500 ml-2",children:re.podatek_akcyzowy!=null?`${re.podatek_akcyzowy.toFixed(2)} zł`:"0,00 zł"})]})]})})]}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:re.cena_sprzedazy!=null?`${re.cena_sprzedazy.toFixed(2)} zł`:"-"}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:$t(re.data_waznosci)}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ae=a.filter(lt=>lt.kod===re.kod);console.log(`Sales for ${re.kod}:`,Ae.length);const ze={};Ae.forEach(lt=>{const Ye=l.find(vt=>vt.id===lt.orderId),st=Ye?Ye.klient:"";let At="";Ye&&Ye.numer_zamowienia&&(At=tM(Ye.numer_zamowienia)),!At&&Ye&&(At=new Date(Ye.data_utworzenia).toLocaleDateString("pl-PL")),!At&&lt.created_at&&(At=new Date(lt.created_at).toLocaleDateString("pl-PL"));const at=At+"|"+st;ze[at]||(ze[at]={qty:0,klient:st,date:At}),ze[at].qty+=lt.ilosc});const le=Object.entries(ze).sort(([,lt],[,Ye])=>{const st=new Date(lt.date.split(".").reverse().join("-"));return new Date(Ye.date.split(".").reverse().join("-")).getTime()-st.getTime()});if(console.log(`Sales array for ${re.kod}:`,le.length),le.length===0)return d.jsx("div",{className:"text-gray-400",children:"-"});const Ne=L[re.kod]||0,Oe=Math.max(0,le.length-5),$e=le.length>5;if(le.length===0)return d.jsx("div",{className:"text-gray-400",children:"-"});const qe=le.slice(Ne,Ne+5);return d.jsxs("div",{className:"flex items-center gap-1",children:[$e&&Ne>0&&d.jsx("button",{onClick:()=>lr(re.kod),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:d.jsx(x2,{size:12})}),d.jsx("div",{className:"flex flex-row gap-1",children:qe.map(([lt,Ye],st)=>d.jsxs("div",{className:"w-5 h-5 bg-blue-100 border border-blue-300 rounded flex items-center justify-center text-xs font-bold cursor-pointer hover:bg-blue-200 relative","data-tooltip-id":`sales-tooltip-${re.kod}-${Ne+st}`,...Ye.date&&Ye.klient?{"data-tooltip-content":`${Ye.date} | ${Ye.klient}`}:{},children:[Ye.qty,d.jsx(pu,{id:`sales-tooltip-${re.kod}-${Ne+st}`,className:"max-w-md",place:"top"})]},lt+st))}),$e&&Ne<Oe&&d.jsx("button",{onClick:()=>It(re.kod,Oe),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:d.jsx(g2,{size:12})})]})})()}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(he.get(re.kod)||0).toFixed(2),"/dzień"]}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ae=he.get(re.kod)||0,ze=Ae<=0?1/0:Math.floor(re.ilosc/Ae);return ze===1/0?"∞":ze})()}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(re.ilosc===0){const Ne=I(re.kod);return Ne?Ne.toLocaleDateString("pl-PL"):"-"}const Ae=he.get(re.kod)||0,ze=Ae<=0?1/0:Math.floor(re.ilosc/Ae);if(ze===1/0)return"-";const le=new Date;return le.setDate(le.getDate()+ze),le.toLocaleDateString("pl-PL")})()}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(re.ilosc===0)return d.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border bg-gray-100 text-gray-600 border-gray-300",children:"brak"});const Ae=he.get(re.kod)||0,ze=Ae<=0?1/0:Math.floor(re.ilosc/Ae),le=ze===1/0?"Brak danych":ze<=30?"mało":ze<=60?"średnie":"dużo";return d.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Ee(ze)}`,children:le})})()})]},re.id)})})]})})}),d.jsx(JR,{isOpen:Z,onClose:()=>{M(!1),G(null)},item:ne,onSave:it})]})};xi("pl",gi);const nM=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=N.useState(new Date),[o,l]=N.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=N.useState([]),[h,p]=N.useState(new Set),[x,g]=N.useState(!1),[y,k]=N.useState(""),[w,_]=N.useState(""),[E,A]=N.useState(!1),[T,L]=N.useState(null);N.useEffect(()=>{const ne=setTimeout(async()=>{if(y.trim().length<2||E){f([]);return}g(!0);try{const G=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(y)}`);if(!G.ok)throw new Error("Failed to fetch orders");const z=await G.json();if(z&&z.length>0){const fe=z.map(ue=>({id:ue.id,nazwa:`Zamówienie: ${ue.numer_zamowienia}`,kod:ue.klient,klient:ue.klient,numer_zamowienia:ue.numer_zamowienia,products:ue.products||[]}));f(fe)}else f([])}catch(G){console.error("Error searching orders:",G),f([])}finally{g(!1)}},300);return()=>clearTimeout(ne)},[y,E]);const J=(M,ne)=>{if(M.numer_zamowienia){if(_(M.klient),L(M.id),M.products&&M.products.length>0){const G=M.products.map(z=>({nazwa:z.nazwa,ilosc:z.ilosc,original_ilosc:z.ilosc,powod_zwrotu:""}));l(G)}f([]),k(M.numer_zamowienia),A(!0),ct.success("Zamówienie wybrane")}else{const G=[...o];G[ne]={...G[ne],nazwa:M.nazwa,ilosc:0,original_ilosc:0},l(G)}},O=()=>{const M=new Set;return o.forEach((ne,G)=>{const z=ne.original_ilosc,fe=o[G].ilosc;!ne.nazwa.trim()||!fe||fe<=0||!ne.powod_zwrotu?M.add(G):fe>z&&(M.add(G),ct.error(`Ilość zwrotu (${fe}) nie może przekraczać ilości w zamówieniu (${z})`))}),p(M),M.size===0},C=async()=>{if(!O()){ct.error("Proszę wypełnić wszystkie wymagane pola");return}try{const M={klient:w,data_zwrotu:r,products:o,orderId:T},ne=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!ne.ok){const z=await ne.json();throw new Error(z.error||"Failed to create return")}const G=await ne.json();console.log("Return created:",G),t(M),ct.success(`Zwrot został utworzony: ${G.numer_zwrotu}`),n(),k(""),_(""),A(!1),L(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),p(new Set)}catch(M){console.error("Error creating return:",M),ct.error("Błąd podczas tworzenia zwrotu")}},Z=()=>{n(),k(""),_(""),A(!1),L(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),p(new Set)};return d.jsx(Mr,{isOpen:e,onRequestClose:Z,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),d.jsx("button",{onClick:Z,className:"text-red-500 focus:outline-none",children:d.jsx(Ht,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex flex-wrap gap-4",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),d.jsx(As,{selected:r,onChange:M=>a(M||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:y,onChange:M=>{k(M.target.value),A(!1),L(null)},placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),x&&d.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&y.trim().length>=2&&d.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(M=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>J(M,-1),children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"text-[10px]",children:M.nazwa}),d.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",M.klient]})]})},M.id))})]})]})]})}),w&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),d.jsx("p",{className:"text-xs text-gray-900",children:w})]})}),d.jsx("button",{onClick:()=>_(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:d.jsx(Ht,{size:16})})]})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((M,ne)=>d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"flex",children:[d.jsx("div",{className:"relative flex-1 max-w-[50%]",children:d.jsx("input",{type:"text",value:M.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),d.jsx("div",{className:"w-20 ml-2",children:d.jsx("input",{type:"number",min:"1",max:M.original_ilosc,value:o[ne].ilosc||"",onChange:G=>{const z=[...o],fe=G.target.value===""?0:parseInt(G.target.value)||0;z[ne]={...z[ne],ilosc:fe},l(z)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilość"})}),d.jsx("div",{className:"w-40 ml-2",children:d.jsxs("select",{value:o[ne].powod_zwrotu,onChange:G=>{const z=[...o];z[ne]={...z[ne],powod_zwrotu:G.target.value},l(z)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[d.jsx("option",{value:"",children:"Powód zwrotu"}),d.jsx("option",{value:"Błąd w zamówieniu",children:"Błąd w zamówieniu"}),d.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),d.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&d.jsx("button",{onClick:()=>{const G=o.filter((z,fe)=>fe!==ne);l(G)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:d.jsx(Ht,{size:16})})]})},ne))]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:C,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwórz zwrot"})}),d.jsx("div",{className:"absolute bottom-4 right-4",children:d.jsx("button",{onClick:Z,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})},aM=e=>(e(!0),!0);Mr.setAppElement("#root");const er="";console.log("API_URL configured as:",er);function sM(){const[e,n]=N.useState(!1),[t,r]=N.useState(!1),[a,o]=N.useState(!1),[l,c]=N.useState(!1),[f,h]=N.useState(!1),[p,x]=N.useState(null),[g,y]=N.useState(null),[k,w]=N.useState(null),[_,E]=N.useState(null),[A,T]=N.useState(!0),[L,J]=N.useState(["inventory","clients","orders","inventoryStatus"]),[O,C]=N.useState(()=>{const le=localStorage.getItem("activeTab")||"inventory",Ne=localStorage.getItem("activeSubTab")||"przyjecie";return{sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:le,activeSubTab:Ne,isDbInitialized:!1}}),[Z,M]=N.useState(!1),[ne,G]=N.useState(!1),[z,fe]=N.useState(!1),[ue,oe]=N.useState(!1),[pe,V]=N.useState(null),[ie,q]=N.useState(!1),[ae,B]=N.useState(null),[S,R]=N.useState(!1),[P,W]=N.useState(null),[H,ee]=N.useState(0),[se,Q]=N.useState(0),[he,me]=N.useState(null),[I,Ve]=N.useState("");N.useEffect(()=>{(async()=>{try{T(!0),console.log("🚀 Starting data loading process..."),console.log("🔧 API_URL:",er),console.log("👥 Loading clients...");const Ne=await $t();console.log("✅ Clients loaded:",Ne.length),console.log("📦 Loading products...");const Oe=await gt();console.log("✅ Products loaded:",Oe.length),console.log("🧾 Loading product receipts...");const $e=await re();console.log("✅ Product receipts loaded:",$e.length),console.log("🔄 Updating app state with loaded data..."),console.log("📋 Setting clients:",Ne),C(qe=>{const lt={...qe,clients:Ne,products:Oe,productReceipts:$e};return console.log("🔄 New app state:",lt),lt}),console.log("✅ App state updated successfully"),console.log("📊 Final data counts:"),console.log("   - Clients:",Ne.length),console.log("   - Products:",Oe.length),console.log("   - Product Receipts:",$e.length)}catch(Ne){console.error("❌ Error loading data:",Ne),ct.error("Błąd podczas ładowania danych")}finally{T(!1),console.log("🏁 Data loading process completed")}})()},[]),N.useEffect(()=>{if(!O.isDbInitialized)return;console.log("💾 useEffect triggered - clients changed:",O.clients.length),(async()=>{const Ne={sheets:O.sheets,sheetsData:O.sheetsData,activeSheet:O.activeSheet,showTable:O.showTable,clients:O.clients,products:O.products,productReceipts:O.productReceipts};try{localStorage.setItem("appState",JSON.stringify(Ne)),console.log("App state saved to localStorage")}catch(Oe){console.error("Error saving state to localStorage:",Oe)}})()},[O.sheetsData,O.sheets,O.activeSheet,O.showTable,O.clients,O.products,O.productReceipts]);const Ce=async()=>{try{T(!0),console.log("🔍 Loading sheets from database..."),console.log("📡 Making request to:",`${er}/api/original-sheets`);const le=await fetch(`${er}/api/original-sheets`);if(console.log("📡 Sheets response status:",le.status),!le.ok)throw new Error(`HTTP error! status: ${le.status}`);const Ne=await le.json();console.log("✅ Received sheets from server:",Ne),console.log("📊 Sheets count:",Ne.length);const Oe=Ne.map($e=>({fileName:$e.fileName,data:{headers:$e.data.headers,rows:$e.data.rows}}));console.log("🔄 Processed sheets:",Oe),console.log("📊 Processed sheets count:",Oe.length),C($e=>({...$e,sheets:Oe,sheetsData:Oe,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log("✅ App state updated with sheets data")}catch(le){console.error("❌ Ошибка загрузки файлов из базы:",le),ct.error("Ошибка загрузки файлов из базы")}finally{T(!1),console.log("🏁 Loading sheets completed")}};N.useEffect(()=>{Ce()},[]);const ge=async(le,Ne)=>{console.log("handleExcelUpload called with:",{newFileName:le,fileData:Ne});try{const Oe=await fetch(`${er}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:le,data:Ne})});if(!Oe.ok){if(Oe.status===409){ct.error("Może być tylko jeden plik Excel. Usuń istniejący plik przed załadowaniem nowego.");return}throw new Error(`HTTP error! status: ${Oe.status}`)}await Ce(),n(!1)}catch(Oe){console.error("Error saving file data:",Oe),ct.error("Błąd podczas zapisywania danych pliku")}},Ee=(le,Ne)=>{const Oe=`${er}/api/download_file/${encodeURIComponent(le.fileName)}`;window.open(Oe,"_blank")},ye=le=>{w(le)},Pe=le=>{le.preventDefault()},Ze=le=>{!k||k===le||(J(Ne=>{const Oe=[...Ne],$e=Oe.indexOf(k),qe=Oe.indexOf(le);return Oe.splice($e,1),Oe.splice(qe,0,k),Oe}),w(null))},Xe=le=>{if(le==="inventory"||le==="clients"||le==="orders"||le==="inventoryStatus"){const Ne=le==="inventory"?"przyjecie":null;localStorage.setItem("activeTab",le),Ne&&localStorage.setItem("activeSubTab",Ne),C(Oe=>({...Oe,activeTab:le,activeSubTab:Ne}))}},wt=le=>{localStorage.setItem("activeSubTab",le),C(Ne=>({...Ne,activeSubTab:le}))},qt=le=>{switch(le){case"inventory":return"Zakup towaru";case"clients":return"Klienci";case"orders":return"Zamówienia";case"inventoryStatus":return"Stany magazynowe";default:return le}},Pt=()=>{g&&(c(!1),n(!1))},Mt=async le=>{try{console.log("🚀 Starting handleAddProduct..."),console.log("📋 Received data:",le),console.log("📎 Files check:",{hasProductInvoice:!!le.productInvoice,hasTransportInvoice:!!le.transportInvoice,productInvoice:le.productInvoice,transportInvoice:le.transportInvoice}),console.log("📡 Making request to:",`${er}/api/product-receipts`);let Ne;if(le.productInvoice||le.transportInvoice){console.log("📎 Files detected, using FormData...");const qe=new FormData,lt={date:le.date,sprzedawca:le.sprzedawca,wartosc:le.wartosc,kosztDostawy:le.kosztDostawy,aktualnyKurs:le.aktualnyKurs,podatekAkcyzowy:le.podatekAkcyzowy,products:le.products};qe.append("data",JSON.stringify(lt)),console.log("📄 JSON data:",lt),le.productInvoice&&(qe.append("productInvoice",le.productInvoice),console.log("📎 Product invoice added:",le.productInvoice.name)),le.transportInvoice&&(qe.append("transportInvoice",le.transportInvoice),console.log("📎 Transport invoice added:",le.transportInvoice.name)),console.log("📦 FormData entries:");for(let[Ye,st]of qe.entries())console.log(`  ${Ye}:`,st);Ne=await fetch(`${er}/api/product-receipts`,{method:"POST",body:qe})}else{console.log("📄 No files, using JSON...");const qe={date:le.date,sprzedawca:le.sprzedawca,wartosc:le.wartosc,kosztDostawy:le.kosztDostawy,aktualnyKurs:le.aktualnyKurs,podatekAkcyzowy:le.podatekAkcyzowy,products:le.products};console.log("📄 JSON data:",qe),Ne=await fetch(`${er}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(qe)})}if(console.log("📡 Response status:",Ne.status),console.log("📡 Response headers:",Ne.headers),!Ne.ok){const qe=await Ne.text();throw console.error("❌ Response error text:",qe),new Error(`Failed to save product receipt: ${Ne.status} - ${qe}`)}const Oe=await Ne.json();if(console.log("✅ Saved receipt:",Oe),Oe.workingSheetsUpdated||Oe.workingSheetsInserted){let qe="Dodano nowy towar";Oe.workingSheetsUpdated>0&&(qe+=` (${Oe.workingSheetsUpdated} товаров обновлено в working sheets)`),Oe.workingSheetsInserted>0&&(qe+=` (${Oe.workingSheetsInserted} новых товаров добавлено в working sheets)`),ct.success(qe)}else ct.success("Dodano nowy towar");console.log("🔄 Loading updated receipts...");const $e=await re();console.log("✅ Updated receipts:",$e),console.log("🔄 Updating app state..."),C(qe=>{const lt={...qe,productReceipts:$e};return console.log("✅ New app state:",lt),lt}),o(!1)}catch(Ne){console.error("❌ Error adding product:",Ne),ct.error("Wystąpił błąd podczas dodawania towaru")}},ir=le=>{B(le),q(!0)},Zt=async le=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",le),console.log("📎 Files check (update):",{hasProductInvoice:!!le.productInvoice,hasTransportInvoice:!!le.transportInvoice,productInvoice:le.productInvoice,transportInvoice:le.transportInvoice});try{let Ne;if(le.productInvoice||le.transportInvoice){console.log("📎 Files detected (update), using FormData...");const lt=new FormData,Ye={date:le.date,sprzedawca:le.sprzedawca,wartosc:le.wartosc,kosztDostawy:le.kosztDostawy,products:le.products};lt.append("data",JSON.stringify(Ye)),console.log("📄 JSON data (update):",Ye),le.productInvoice&&(lt.append("productInvoice",le.productInvoice),console.log("📎 Product invoice added (update):",le.productInvoice.name)),le.transportInvoice&&(lt.append("transportInvoice",le.transportInvoice),console.log("📎 Transport invoice added (update):",le.transportInvoice.name)),console.log("📦 FormData entries (update):");for(let[st,At]of lt.entries())console.log(`  ${st}:`,At);Ne=await fetch(`${er}/api/product-receipts/${le.id}`,{method:"PUT",body:lt})}else console.log("📄 No files (update), using JSON..."),Ne=await fetch(`${er}/api/product-receipts/${le.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:le.date,sprzedawca:le.sprzedawca,wartosc:le.wartosc,kosztDostawy:le.kosztDostawy,aktualnyKurs:le.aktualnyKurs,podatekAkcyzowy:le.podatekAkcyzowy,products:le.products})});if(!Ne.ok)throw new Error("Failed to update product receipt");const Oe=await Ne.json();console.log("Updated receipt:",Oe),console.log("Loading updated receipts...");const $e=await re();console.log("Updated receipts:",$e),console.log("Loading updated products...");const qe=await gt();console.log("Updated products:",qe),console.log("Updating app state..."),C(lt=>{const Ye={...lt,productReceipts:$e,products:qe};return console.log("New app state:",Ye),Ye}),ct.success("Zakup został zaktualizowany"),q(!1),B(null),h(!1),x(null)}catch(Ne){console.error("Error updating product receipt:",Ne),ct.error("Wystąpił błąd podczas aktualizacji zakupu")}},lr=async le=>{try{if(!(await fetch(`${er}/api/product-receipts/${le}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const Oe=await re(),$e=await gt();C(qe=>({...qe,productReceipts:Oe,products:$e})),ct.success("Zakup został usunięty")}catch(Ne){console.error("Error deleting receipt:",Ne),ct.error("Wystąpił błąd podczas usuwania zakupu")}},It=async le=>{try{const Ne=await fetch(`${er}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)});if(!Ne.ok)throw new Error("Failed to add client");const Oe=await Ne.json(),$e={...le,id:Oe.id};C(qe=>({...qe,clients:[...qe.clients,$e]})),Q(qe=>qe+1),ct.success("Klient został dodany")}catch(Ne){console.error("Error adding client:",Ne),ct.error("Błąd podczas dodawania klienta")}},Gt=async le=>{try{if(!(await fetch(`${er}/api/clients/${le}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");C(Oe=>({...Oe,clients:Oe.clients.filter($e=>$e.id!==le)})),Q(Oe=>Oe+1),ct.success("Klient został usunięty")}catch(Ne){console.error("Error deleting client:",Ne),ct.error("Błąd podczas usuwania klienta")}},it=async le=>{try{console.log("🔍 handleUpdateClient called with data:",le);const Ne=await fetch(`${er}/api/clients/${le.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)});if(!Ne.ok)throw new Error("Failed to update client");const Oe=await Ne.json();console.log("✅ Client updated in database:",Oe),console.log("✅ Updated client fields:",{id:Oe.id,firma:Oe.firma,nazwa:Oe.nazwa,adres:Oe.adres,czas_dostawy:Oe.czas_dostawy,kontakt:Oe.kontakt}),C($e=>{console.log("🔄 Updating app state..."),console.log("📋 Previous clients:",$e.clients),console.log("📋 Updated client data:",Oe);const qe=$e.clients.map(Ye=>Ye.id===le.id?(console.log("🔄 Updating client:",Ye.id,"from:",Ye,"to:",{...Ye,...Oe}),{id:Ye.id,firma:Oe.firma||Ye.firma,nazwa:Oe.nazwa||Ye.nazwa,adres:Oe.adres||Ye.adres,czas_dostawy:Oe.czas_dostawy||Ye.czas_dostawy,kontakt:Oe.kontakt||Ye.kontakt}):{...Ye});console.log("📋 New clients array:",qe);const lt={...$e,clients:qe};return console.log("🔄 New app state:",lt),lt}),ct.success("Klient został zaktualizowany"),setTimeout(()=>{C($e=>(console.log("🔄 Force update after timeout"),{...$e})),Q($e=>$e+1),me(le.id),$t().then($e=>{C(qe=>({...qe,clients:$e})),Q(qe=>qe+1)})},100)}catch(Ne){console.error("Error updating client:",Ne),ct.error("Błąd podczas aktualizacji klienta")}},bt=async le=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",le),console.log("Products data:",JSON.stringify(le.products,null,2));try{const Ne=await fetch(`${er}/api/orders/${le.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)});if(!Ne.ok)throw new Error("Failed to update order");const Oe=await Ne.json();console.log("Updated order result:",Oe),ct.success("Zamówienie zostało zaktualizowane"),ee($e=>$e+1)}catch(Ne){console.error("Error updating order:",Ne),ct.error("Błąd podczas aktualizacji zamówienia")}},$t=async()=>{try{console.log("🔍 Loading clients from:",`${er}/api/clients`);const le=await fetch(`${er}/api/clients`);if(console.log("📡 Clients response status:",le.status),!le.ok)throw new Error(`HTTP error! status: ${le.status}`);const Ne=await le.json();return console.log("✅ Loaded clients:",Ne.length,"records"),console.log("📋 First client:",Ne[0]),Ne}catch(le){return console.error("❌ Error loading clients:",le),[]}},gt=async()=>{try{console.log("🔍 Loading products from:",`${er}/api/products`);const le=await fetch(`${er}/api/products`);if(console.log("📡 Products response status:",le.status),!le.ok)throw new Error(`HTTP error! status: ${le.status}`);const Ne=await le.json();console.log("✅ Loaded products:",Ne.length,"records"),console.log("📋 First product:",Ne[0]);const Oe=Ne.map($e=>({kod:$e.kod,nazwa:$e.nazwa,ilosc:$e.ilosc,jednostka_miary:$e.jednostka_miary||"",kod_kreskowy:$e.kod_kreskowy||"",data_waznosci:$e.data_waznosci??void 0,archiwalny:$e.archiwalny,rezerwacje:$e.rezerwacje,ilosc_na_poleceniach:$e.ilosc_na_poleceniach,waga_netto:$e.waga_netto,waga_brutto:$e.waga_brutto,objetosc:$e.objetosc,opis:$e.opis}));return console.log("🔄 Processed products:",Oe.length,"records"),Oe}catch(le){return console.error("❌ Error loading products:",le),[]}},re=async()=>{try{console.log("🔍 Loading product receipts from:",`${er}/api/product-receipts`);const le=await fetch(`${er}/api/product-receipts`);if(console.log("📡 Product receipts response status:",le.status),!le.ok)throw new Error(`HTTP error! status: ${le.status}`);const Ne=await le.json();return console.log("✅ Loaded product receipts:",Ne.length,"records"),Ne.map(Oe=>({id:Oe.id,dataPrzyjecia:Oe.dataPrzyjecia,sprzedawca:Oe.sprzedawca||"",wartosc:Oe.wartosc||0,kosztDostawy:Oe.kosztDostawy||0,aktualny_kurs:Oe.aktualny_kurs,podatek_akcyzowy:Oe.podatek_akcyzowy,aktualnyKurs:Oe.aktualnyKurs,podatekAkcyzowy:Oe.podatekAkcyzowy,products:Oe.products||[],productInvoice:Oe.productInvoice,transportInvoice:Oe.transportInvoice}))}catch(le){return console.error("❌ Error loading product receipts:",le),[]}},Te=async le=>{try{console.log("🔍 Searching working_sheets with query:",le),console.log("📡 Making request to:",`${er}/api/working-sheets/search?query=${encodeURIComponent(le)}`);const Ne=await fetch(`${er}/api/working-sheets/search?query=${encodeURIComponent(le)}`);if(console.log("📡 Search response status:",Ne.status),!Ne.ok)throw new Error(`HTTP error! status: ${Ne.status}`);const Oe=await Ne.json();return console.log("✅ Search results:",Oe.length,"items found"),Oe.map(qe=>({kod:qe.kod,nazwa:qe.nazwa,ilosc:qe.ilosc.toString(),kodKreskowy:qe.kod_kreskowy||""}))}catch(Ne){return console.error("❌ Error searching working_sheets:",Ne),[]}},Ae=()=>{ee(le=>le+1)},ze=()=>{ee(le=>le+1)};return d.jsxs("div",{className:"min-h-screen bg-gray-100",children:[d.jsx(AR,{position:"top-right"}),d.jsx(mw,{isOpen:ue,onClose:()=>oe(!1),product:pe}),d.jsx(IN,{isOpen:e,onClose:()=>n(!1),onUpload:ge}),d.jsx(jN,{isOpen:l,onClose:()=>c(!1),fileName:g||"",onConfirm:Pt}),d.jsx(zP,{isOpen:a,onClose:()=>o(!1),onSubmit:Mt}),d.jsx(jR,{isOpen:t,onClose:()=>r(!1),onAdd:It}),d.jsx(vw,{isOpen:S,onClose:()=>{R(!1),W(null)},onSubmit:it,client:P}),d.jsx(xw,{isOpen:f,onClose:()=>h(!1),receipt:p}),d.jsx(gw,{isOpen:ie,onClose:()=>{q(!1),B(null)},onSubmit:Zt,receipt:ae}),d.jsx(OR,{isOpen:Z,onClose:()=>M(!1),onOrderCreated:Ae}),d.jsx(nM,{isOpen:ne,onClose:()=>G(!1),onSubmit:ze}),d.jsx("div",{className:"bg-white shadow-sm",children:d.jsx("div",{className:"container mx-auto px-4 py-3",children:d.jsx("img",{src:IR,alt:"Enoterra Logo",className:"h-32"})})}),d.jsx("div",{className:"bg-gray-100",children:d.jsx("div",{className:"container mx-auto px-4",children:d.jsx("div",{className:"flex items-center h-14",children:d.jsx("div",{className:"flex space-x-4",children:L.map(le=>d.jsx("div",{draggable:!0,onDragStart:()=>ye(le),onDragOver:Pe,onDrop:()=>Ze(le),className:`relative -mb-px cursor-pointer ${O.activeTab===le?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${k===le?"opacity-50":""}`,onClick:()=>Xe(le),children:d.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:qt(le)})},le))})})})}),d.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:d.jsxs("div",{className:"container mx-auto px-4 py-6",children:[d.jsxs("div",{className:"flex items-start -mt-2",children:[O.activeTab==="inventory"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[d.jsxs("div",{className:"flex",children:[d.jsx("button",{onClick:()=>wt("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${O.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjęcie towaru"}),d.jsx("button",{onClick:()=>wt("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${O.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupów"}),d.jsx("button",{onClick:()=>wt("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${O.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz płatności"})]}),O.activeSubTab==="przyjecie"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:d.jsx(Js,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>aM(n),children:[d.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:d.jsx(v2,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),d.jsx(LR,{receipts:O.productReceipts,products:O.products,onDelete:lr,onEdit:ir,onUpdate:Zt})]}),O.activeSubTab==="analiza"&&d.jsx("div",{className:"flex flex-col gap-4",children:d.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[d.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupów"}),d.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupów będzie dostępna wkrótce."})]})}),O.activeSubTab==="kalendarz"&&d.jsx("div",{className:"flex flex-col gap-4 mt-6",children:d.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[d.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz płatności"}),d.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza płatności będzie dostępna wkrótce."})]})})]}),O.activeTab==="inventory"&&d.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:O.sheets.map(le=>d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("button",{onClick:Ne=>Ee(le),title:"Клик: открыть файл в новой вкладке",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:le.fileName})},le.fileName))}),O.activeTab==="inventory"&&O.showTable&&O.activeSheet&&d.jsx("div",{className:"mt-6 bg-white",children:d.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:d.jsx(BP,{data:O.activeSheet.data})})}),O.activeTab==="clients"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[d.jsx("div",{className:"flex items-center gap-4",children:d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:d.jsx(Js,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),d.jsx(BR,{clients:O.clients,onDelete:Gt,onEdit:le=>{W(le),R(!0)},onUpdate:it},`clients-${se}-${he||"none"}`)]}),O.activeTab==="orders"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[d.jsx("div",{className:"mb-4",children:d.jsx("div",{className:"w-1/2 mx-auto",children:d.jsx(WP,{onSearch:Te})})}),d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>M(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:d.jsx(Js,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>G(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:d.jsx(Ht,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]})]}),d.jsx(MR,{onViewOrder:le=>{console.log("View order:",le)},onEditOrder:le=>{console.log("Edit order:",le)},onDeleteOrder:le=>{console.log("Delete order:",le)},onUpdateOrder:bt,refreshTrigger:H})]}),O.activeTab==="inventoryStatus"&&d.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:d.jsx(rM,{productReceipts:O.productReceipts})})]}),_&&d.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:_})]})})]})}p2.createRoot(document.getElementById("root")).render(d.jsx(N.StrictMode,{children:d.jsx(sM,{})}));
