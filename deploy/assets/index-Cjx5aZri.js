function a2(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Vu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s2(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var W0={exports:{}},Zi={},U0={exports:{}},vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dx;function o2(){if(dx)return vt;dx=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),x=Symbol.iterator;function g(P){return P===null||typeof P!="object"?null:(P=x&&P[x]||P["@@iterator"],typeof P=="function"?P:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function _(P,E,j){this.props=P,this.context=E,this.refs=w,this.updater=j||y}_.prototype.isReactComponent={},_.prototype.setState=function(P,E){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,E,"setState")},_.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function S(){}S.prototype=_.prototype;function O(P,E,j){this.props=P,this.context=E,this.refs=w,this.updater=j||y}var T=O.prototype=new S;T.constructor=O,k(T,_.prototype),T.isPureReactComponent=!0;var B=Array.isArray,J=Object.prototype.hasOwnProperty,I={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function Z(P,E,j){var M,U={},oe=null,pe=null;if(E!=null)for(M in E.ref!==void 0&&(pe=E.ref),E.key!==void 0&&(oe=""+E.key),E)J.call(E,M)&&!C.hasOwnProperty(M)&&(U[M]=E[M]);var me=arguments.length-2;if(me===1)U.children=j;else if(1<me){for(var ie=Array(me),te=0;te<me;te++)ie[te]=arguments[te+2];U.children=ie}if(P&&P.defaultProps)for(M in me=P.defaultProps,me)U[M]===void 0&&(U[M]=me[M]);return{$$typeof:e,type:P,key:oe,ref:pe,props:U,_owner:I.current}}function L(P,E){return{$$typeof:e,type:P.type,key:E,ref:P.ref,props:P.props,_owner:P._owner}}function ne(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function X(P){var E={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(j){return E[j]})}var W=/\/+/g;function ue(P,E){return typeof P=="object"&&P!==null&&P.key!=null?X(""+P.key):E.toString(36)}function le(P,E,j,M,U){var oe=typeof P;(oe==="undefined"||oe==="boolean")&&(P=null);var pe=!1;if(P===null)pe=!0;else switch(oe){case"string":case"number":pe=!0;break;case"object":switch(P.$$typeof){case e:case n:pe=!0}}if(pe)return pe=P,U=U(pe),P=M===""?"."+ue(pe,0):M,B(U)?(j="",P!=null&&(j=P.replace(W,"$&/")+"/"),le(U,E,j,"",function(te){return te})):U!=null&&(ne(U)&&(U=L(U,j+(!U.key||pe&&pe.key===U.key?"":(""+U.key).replace(W,"$&/")+"/")+P)),E.push(U)),1;if(pe=0,M=M===""?".":M+":",B(P))for(var me=0;me<P.length;me++){oe=P[me];var ie=M+ue(oe,me);pe+=le(oe,E,j,ie,U)}else if(ie=g(P),typeof ie=="function")for(P=ie.call(P),me=0;!(oe=P.next()).done;)oe=oe.value,ie=M+ue(oe,me++),pe+=le(oe,E,j,ie,U);else if(oe==="object")throw E=String(P),Error("Objects are not valid as a React child (found: "+(E==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":E)+"). If you meant to render a collection of children, use an array instead.");return pe}function re(P,E,j){if(P==null)return P;var M=[],U=0;return le(P,M,"","",function(oe){return E.call(j,oe,U++)}),M}function he(P){if(P._status===-1){var E=P._result;E=E(),E.then(function(j){(P._status===0||P._status===-1)&&(P._status=1,P._result=j)},function(j){(P._status===0||P._status===-1)&&(P._status=2,P._result=j)}),P._status===-1&&(P._status=0,P._result=E)}if(P._status===1)return P._result.default;throw P._result}var K={current:null},se={transition:null},R={ReactCurrentDispatcher:K,ReactCurrentBatchConfig:se,ReactCurrentOwner:I};function Y(){throw Error("act(...) is not supported in production builds of React.")}return vt.Children={map:re,forEach:function(P,E,j){re(P,function(){E.apply(this,arguments)},j)},count:function(P){var E=0;return re(P,function(){E++}),E},toArray:function(P){return re(P,function(E){return E})||[]},only:function(P){if(!ne(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},vt.Component=_,vt.Fragment=t,vt.Profiler=a,vt.PureComponent=O,vt.StrictMode=r,vt.Suspense=f,vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,vt.act=Y,vt.cloneElement=function(P,E,j){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var M=k({},P.props),U=P.key,oe=P.ref,pe=P._owner;if(E!=null){if(E.ref!==void 0&&(oe=E.ref,pe=I.current),E.key!==void 0&&(U=""+E.key),P.type&&P.type.defaultProps)var me=P.type.defaultProps;for(ie in E)J.call(E,ie)&&!C.hasOwnProperty(ie)&&(M[ie]=E[ie]===void 0&&me!==void 0?me[ie]:E[ie])}var ie=arguments.length-2;if(ie===1)M.children=j;else if(1<ie){me=Array(ie);for(var te=0;te<ie;te++)me[te]=arguments[te+2];M.children=me}return{$$typeof:e,type:P.type,key:U,ref:oe,props:M,_owner:pe}},vt.createContext=function(P){return P={$$typeof:l,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:o,_context:P},P.Consumer=P},vt.createElement=Z,vt.createFactory=function(P){var E=Z.bind(null,P);return E.type=P,E},vt.createRef=function(){return{current:null}},vt.forwardRef=function(P){return{$$typeof:c,render:P}},vt.isValidElement=ne,vt.lazy=function(P){return{$$typeof:d,_payload:{_status:-1,_result:P},_init:he}},vt.memo=function(P,E){return{$$typeof:p,type:P,compare:E===void 0?null:E}},vt.startTransition=function(P){var E=se.transition;se.transition={};try{P()}finally{se.transition=E}},vt.unstable_act=Y,vt.useCallback=function(P,E){return K.current.useCallback(P,E)},vt.useContext=function(P){return K.current.useContext(P)},vt.useDebugValue=function(){},vt.useDeferredValue=function(P){return K.current.useDeferredValue(P)},vt.useEffect=function(P,E){return K.current.useEffect(P,E)},vt.useId=function(){return K.current.useId()},vt.useImperativeHandle=function(P,E,j){return K.current.useImperativeHandle(P,E,j)},vt.useInsertionEffect=function(P,E){return K.current.useInsertionEffect(P,E)},vt.useLayoutEffect=function(P,E){return K.current.useLayoutEffect(P,E)},vt.useMemo=function(P,E){return K.current.useMemo(P,E)},vt.useReducer=function(P,E,j){return K.current.useReducer(P,E,j)},vt.useRef=function(P){return K.current.useRef(P)},vt.useState=function(P){return K.current.useState(P)},vt.useSyncExternalStore=function(P,E,j){return K.current.useSyncExternalStore(P,E,j)},vt.useTransition=function(){return K.current.useTransition()},vt.version="18.3.1",vt}var px;function Nl(){return px||(px=1,U0.exports=o2()),U0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hx;function i2(){if(hx)return Zi;hx=1;var e=Nl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,p){var d,x={},g=null,y=null;p!==void 0&&(g=""+p),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(y=f.ref);for(d in f)r.call(f,d)&&!o.hasOwnProperty(d)&&(x[d]=f[d]);if(c&&c.defaultProps)for(d in f=c.defaultProps,f)x[d]===void 0&&(x[d]=f[d]);return{$$typeof:n,type:c,key:g,ref:y,props:x,_owner:a.current}}return Zi.Fragment=t,Zi.jsx=l,Zi.jsxs=l,Zi}var mx;function l2(){return mx||(mx=1,W0.exports=i2()),W0.exports}var h=l2(),A=Nl();const Se=Vu(A),Mv=a2({__proto__:null,default:Se},[A]);var Yc={},H0={exports:{}},xn={},$0={exports:{}},Y0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xx;function c2(){return xx||(xx=1,(function(e){function n(se,R){var Y=se.length;se.push(R);e:for(;0<Y;){var P=Y-1>>>1,E=se[P];if(0<a(E,R))se[P]=R,se[Y]=E,Y=P;else break e}}function t(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var R=se[0],Y=se.pop();if(Y!==R){se[0]=Y;e:for(var P=0,E=se.length,j=E>>>1;P<j;){var M=2*(P+1)-1,U=se[M],oe=M+1,pe=se[oe];if(0>a(U,Y))oe<E&&0>a(pe,U)?(se[P]=pe,se[oe]=Y,P=oe):(se[P]=U,se[M]=Y,P=M);else if(oe<E&&0>a(pe,Y))se[P]=pe,se[oe]=Y,P=oe;else break e}}return R}function a(se,R){var Y=se.sortIndex-R.sortIndex;return Y!==0?Y:se.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],p=[],d=1,x=null,g=3,y=!1,k=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(se){for(var R=t(p);R!==null;){if(R.callback===null)r(p);else if(R.startTime<=se)r(p),R.sortIndex=R.expirationTime,n(f,R);else break;R=t(p)}}function B(se){if(w=!1,T(se),!k)if(t(f)!==null)k=!0,he(J);else{var R=t(p);R!==null&&K(B,R.startTime-se)}}function J(se,R){k=!1,w&&(w=!1,S(Z),Z=-1),y=!0;var Y=g;try{for(T(R),x=t(f);x!==null&&(!(x.expirationTime>R)||se&&!X());){var P=x.callback;if(typeof P=="function"){x.callback=null,g=x.priorityLevel;var E=P(x.expirationTime<=R);R=e.unstable_now(),typeof E=="function"?x.callback=E:x===t(f)&&r(f),T(R)}else r(f);x=t(f)}if(x!==null)var j=!0;else{var M=t(p);M!==null&&K(B,M.startTime-R),j=!1}return j}finally{x=null,g=Y,y=!1}}var I=!1,C=null,Z=-1,L=5,ne=-1;function X(){return!(e.unstable_now()-ne<L)}function W(){if(C!==null){var se=e.unstable_now();ne=se;var R=!0;try{R=C(!0,se)}finally{R?ue():(I=!1,C=null)}}else I=!1}var ue;if(typeof O=="function")ue=function(){O(W)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,re=le.port2;le.port1.onmessage=W,ue=function(){re.postMessage(null)}}else ue=function(){_(W,0)};function he(se){C=se,I||(I=!0,ue())}function K(se,R){Z=_(function(){se(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){k||y||(k=!0,he(J))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(se){switch(g){case 1:case 2:case 3:var R=3;break;default:R=g}var Y=g;g=R;try{return se()}finally{g=Y}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,R){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Y=g;g=se;try{return R()}finally{g=Y}},e.unstable_scheduleCallback=function(se,R,Y){var P=e.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?P+Y:P):Y=P,se){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=Y+E,se={id:d++,callback:R,priorityLevel:se,startTime:Y,expirationTime:E,sortIndex:-1},Y>P?(se.sortIndex=Y,n(p,se),t(f)===null&&se===t(p)&&(w?(S(Z),Z=-1):w=!0,K(B,Y-P))):(se.sortIndex=E,n(f,se),k||y||(k=!0,he(J))),se},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(se){var R=g;return function(){var Y=g;g=R;try{return se.apply(this,arguments)}finally{g=Y}}}})(Y0)),Y0}var gx;function u2(){return gx||(gx=1,$0.exports=c2()),$0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vx;function f2(){if(vx)return xn;vx=1;var e=Nl(),n=u2();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},x={};function g(s){return f.call(x,s)?!0:f.call(d,s)?!1:p.test(s)?x[s]=!0:(d[s]=!0,!1)}function y(s,i,u,m){if(u!==null&&u.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function k(s,i,u,m){if(i===null||typeof i>"u"||y(s,i,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function w(s,i,u,m,v,b,D){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=u,this.propertyName=s,this.type=i,this.sanitizeURL=b,this.removeEmptyString=D}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){_[s]=new w(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];_[i]=new w(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){_[s]=new w(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){_[s]=new w(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){_[s]=new w(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){_[s]=new w(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){_[s]=new w(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){_[s]=new w(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){_[s]=new w(s,5,!1,s.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function O(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(S,O);_[i]=new w(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(S,O);_[i]=new w(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(S,O);_[i]=new w(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!1,!1)}),_.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,i,u,m){var v=_.hasOwnProperty(i)?_[i]:null;(v!==null?v.type!==0:m||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,u,v,m)&&(u=null),m||v===null?g(i)&&(u===null?s.removeAttribute(i):s.setAttribute(i,""+u)):v.mustUseProperty?s[v.propertyName]=u===null?v.type===3?!1:"":u:(i=v.attributeName,m=v.attributeNamespace,u===null?s.removeAttribute(i):(v=v.type,u=v===3||v===4&&u===!0?"":""+u,m?s.setAttributeNS(m,i,u):s.setAttribute(i,u))))}var B=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,J=Symbol.for("react.element"),I=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),X=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),K=Symbol.for("react.offscreen"),se=Symbol.iterator;function R(s){return s===null||typeof s!="object"?null:(s=se&&s[se]||s["@@iterator"],typeof s=="function"?s:null)}var Y=Object.assign,P;function E(s){if(P===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);P=i&&i[1]||""}return`
`+P+s}var j=!1;function M(s,i){if(!s||j)return"";j=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(be){var m=be}Reflect.construct(s,[],i)}else{try{i.call()}catch(be){m=be}s.call(i.prototype)}else{try{throw Error()}catch(be){m=be}s()}}catch(be){if(be&&m&&typeof be.stack=="string"){for(var v=be.stack.split(`
`),b=m.stack.split(`
`),D=v.length-1,ee=b.length-1;1<=D&&0<=ee&&v[D]!==b[ee];)ee--;for(;1<=D&&0<=ee;D--,ee--)if(v[D]!==b[ee]){if(D!==1||ee!==1)do if(D--,ee--,0>ee||v[D]!==b[ee]){var ce=`
`+v[D].replace(" at new "," at ");return s.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",s.displayName)),ce}while(1<=D&&0<=ee);break}}}finally{j=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?E(s):""}function U(s){switch(s.tag){case 5:return E(s.type);case 16:return E("Lazy");case 13:return E("Suspense");case 19:return E("SuspenseList");case 0:case 2:case 15:return s=M(s.type,!1),s;case 11:return s=M(s.type.render,!1),s;case 1:return s=M(s.type,!0),s;default:return""}}function oe(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case I:return"Portal";case L:return"Profiler";case Z:return"StrictMode";case ue:return"Suspense";case le:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case X:return(s.displayName||"Context")+".Consumer";case ne:return(s._context.displayName||"Context")+".Provider";case W:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case re:return i=s.displayName||null,i!==null?i:oe(s.type)||"Memo";case he:i=s._payload,s=s._init;try{return oe(s(i))}catch{}}return null}function pe(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(i);case 8:return i===Z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function me(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ie(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function te(s){var i=ie(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),m=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,b=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return v.call(this)},set:function(D){m=""+D,b.call(this,D)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(D){m=""+D},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function ae(s){s._valueTracker||(s._valueTracker=te(s))}function F(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),m="";return s&&(m=ie(s)?s.checked?"true":"false":s.value),s=m,s!==u?(i.setValue(s),!0):!1}function Ce(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function De(s,i){var u=i.checked;return Y({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function He(s,i){var u=i.defaultValue==null?"":i.defaultValue,m=i.checked!=null?i.checked:i.defaultChecked;u=me(i.value!=null?i.value:u),s._wrapperState={initialChecked:m,initialValue:u,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function q(s,i){i=i.checked,i!=null&&T(s,"checked",i,!1)}function de(s,i){q(s,i);var u=me(i.value),m=i.type;if(u!=null)m==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?Ne(s,i.type,u):i.hasOwnProperty("defaultValue")&&Ne(s,i.type,me(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Ee(s,i,u){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var m=i.type;if(!(m!=="submit"&&m!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,u||i===s.value||(s.value=i),s.defaultValue=i}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function Ne(s,i,u){(i!=="number"||Ce(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var Le=Array.isArray;function Qe(s,i,u,m){if(s=s.options,i){i={};for(var v=0;v<u.length;v++)i["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=i.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&m&&(s[u].defaultSelected=!0)}else{for(u=""+me(u),i=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,m&&(s[v].defaultSelected=!0);return}i!==null||s[v].disabled||(i=s[v])}i!==null&&(i.selected=!0)}}function Mt(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return Y({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function gt(s,i){var u=i.value;if(u==null){if(u=i.children,i=i.defaultValue,u!=null){if(i!=null)throw Error(t(92));if(Le(u)){if(1<u.length)throw Error(t(93));u=u[0]}i=u}i==null&&(i=""),u=i}s._wrapperState={initialValue:me(u)}}function wt(s,i){var u=me(i.value),m=me(i.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),i.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),m!=null&&(s.defaultValue=""+m)}function Ft(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Ge(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ft(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Ge(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var ht,Ut=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,u,m,v){MSApp.execUnsafeLocalFunction(function(){return s(i,u,m,v)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(ht=ht||document.createElement("div"),ht.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=ht.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function rt(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var Et={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qt=["Webkit","ms","Moz","O"];Object.keys(Et).forEach(function(s){qt.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),Et[i]=Et[s]})});function kt(s,i,u){return i==null||typeof i=="boolean"||i===""?"":u||typeof i!="number"||i===0||Et.hasOwnProperty(s)&&Et[s]?(""+i).trim():i+"px"}function Ht(s,i){s=s.style;for(var u in i)if(i.hasOwnProperty(u)){var m=u.indexOf("--")===0,v=kt(u,i[u],m);u==="float"&&(u="cssFloat"),m?s.setProperty(u,v):s[u]=v}}var $t=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Cn(s,i){if(i){if($t[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function vn(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function je(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ze=null,Ve=null,et=null;function St(s){if(s=ji(s)){if(typeof ze!="function")throw Error(t(280));var i=s.stateNode;i&&(i=oc(i),ze(s.stateNode,s.type,i))}}function It(s){Ve?et?et.push(s):et=[s]:Ve=s}function Yt(){if(Ve){var s=Ve,i=et;if(et=Ve=null,St(s),i)for(s=0;s<i.length;s++)St(i[s])}}function wr(s,i){return s(i)}function nt(){}var mt=!1;function Tr(s,i,u){if(mt)return s(i,u);mt=!0;try{return wr(s,i,u)}finally{mt=!1,(Ve!==null||et!==null)&&(nt(),Yt())}}function Zr(s,i){var u=s.stateNode;if(u===null)return null;var m=oc(u);if(m===null)return null;u=m[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,i,typeof u));return u}var Ue=!1;if(c)try{var tt={};Object.defineProperty(tt,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",tt,tt),window.removeEventListener("test",tt,tt)}catch{Ue=!1}function ct(s,i,u,m,v,b,D,ee,ce){var be=Array.prototype.slice.call(arguments,3);try{i.apply(u,be)}catch(Ae){this.onError(Ae)}}var Vt=!1,rr=null,N=!1,G=null,z={onError:function(s){Vt=!0,rr=s}};function H(s,i,u,m,v,b,D,ee,ce){Vt=!1,rr=null,ct.apply(z,arguments)}function V(s,i,u,m,v,b,D,ee,ce){if(H.apply(this,arguments),Vt){if(Vt){var be=rr;Vt=!1,rr=null}else throw Error(t(198));N||(N=!0,G=be)}}function Q(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function ye(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Te(s){if(Q(s)!==s)throw Error(t(188))}function ve(s){var i=s.alternate;if(!i){if(i=Q(s),i===null)throw Error(t(188));return i!==s?null:s}for(var u=s,m=i;;){var v=u.return;if(v===null)break;var b=v.alternate;if(b===null){if(m=v.return,m!==null){u=m;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===u)return Te(v),s;if(b===m)return Te(v),i;b=b.sibling}throw Error(t(188))}if(u.return!==m.return)u=v,m=b;else{for(var D=!1,ee=v.child;ee;){if(ee===u){D=!0,u=v,m=b;break}if(ee===m){D=!0,m=v,u=b;break}ee=ee.sibling}if(!D){for(ee=b.child;ee;){if(ee===u){D=!0,u=b,m=v;break}if(ee===m){D=!0,m=b,u=v;break}ee=ee.sibling}if(!D)throw Error(t(189))}}if(u.alternate!==m)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:i}function ke(s){return s=ve(s),s!==null?_e(s):null}function _e(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=_e(s);if(i!==null)return i;s=s.sibling}return null}var Oe=n.unstable_scheduleCallback,We=n.unstable_cancelCallback,Pe=n.unstable_shouldYield,Re=n.unstable_requestPaint,Me=n.unstable_now,it=n.unstable_getCurrentPriorityLevel,jt=n.unstable_ImmediatePriority,Pt=n.unstable_UserBlockingPriority,ur=n.unstable_NormalPriority,Rs=n.unstable_LowPriority,Qa=n.unstable_IdlePriority,la=null,Cr=null;function vi(s){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(la,s,void 0,(s.current.flags&128)===128)}catch{}}var fr=Math.clz32?Math.clz32:_w,ww=Math.log,kw=Math.LN2;function _w(s){return s>>>=0,s===0?32:31-(ww(s)/kw|0)|0}var Ul=64,Hl=4194304;function yi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function $l(s,i){var u=s.pendingLanes;if(u===0)return 0;var m=0,v=s.suspendedLanes,b=s.pingedLanes,D=u&268435455;if(D!==0){var ee=D&~v;ee!==0?m=yi(ee):(b&=D,b!==0&&(m=yi(b)))}else D=u&~v,D!==0?m=yi(D):b!==0&&(m=yi(b));if(m===0)return 0;if(i!==0&&i!==m&&(i&v)===0&&(v=m&-m,b=i&-i,v>=b||v===16&&(b&4194240)!==0))return i;if((m&4)!==0&&(m|=u&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=m;0<i;)u=31-fr(i),v=1<<u,m|=s[u],i&=~v;return m}function bw(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ew(s,i){for(var u=s.suspendedLanes,m=s.pingedLanes,v=s.expirationTimes,b=s.pendingLanes;0<b;){var D=31-fr(b),ee=1<<D,ce=v[D];ce===-1?((ee&u)===0||(ee&m)!==0)&&(v[D]=bw(ee,i)):ce<=i&&(s.expiredLanes|=ee),b&=~ee}}function lf(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Hp(){var s=Ul;return Ul<<=1,(Ul&4194240)===0&&(Ul=64),s}function cf(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function wi(s,i,u){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-fr(i),s[i]=u}function Sw(s,i){var u=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<u;){var v=31-fr(u),b=1<<v;i[v]=0,m[v]=-1,s[v]=-1,u&=~b}}function uf(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var m=31-fr(u),v=1<<m;v&i|s[m]&i&&(s[m]|=i),u&=~v}}var Lt=0;function $p(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Yp,ff,Vp,Kp,Gp,df=!1,Yl=[],qa=null,Za=null,Ja=null,ki=new Map,_i=new Map,es=[],Tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xp(s,i){switch(s){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":Ja=null;break;case"pointerover":case"pointerout":ki.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":_i.delete(i.pointerId)}}function bi(s,i,u,m,v,b){return s===null||s.nativeEvent!==b?(s={blockedOn:i,domEventName:u,eventSystemFlags:m,nativeEvent:b,targetContainers:[v]},i!==null&&(i=ji(i),i!==null&&ff(i)),s):(s.eventSystemFlags|=m,i=s.targetContainers,v!==null&&i.indexOf(v)===-1&&i.push(v),s)}function Cw(s,i,u,m,v){switch(i){case"focusin":return qa=bi(qa,s,i,u,m,v),!0;case"dragenter":return Za=bi(Za,s,i,u,m,v),!0;case"mouseover":return Ja=bi(Ja,s,i,u,m,v),!0;case"pointerover":var b=v.pointerId;return ki.set(b,bi(ki.get(b)||null,s,i,u,m,v)),!0;case"gotpointercapture":return b=v.pointerId,_i.set(b,bi(_i.get(b)||null,s,i,u,m,v)),!0}return!1}function Qp(s){var i=Ms(s.target);if(i!==null){var u=Q(i);if(u!==null){if(i=u.tag,i===13){if(i=ye(u),i!==null){s.blockedOn=i,Gp(s.priority,function(){Vp(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Vl(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=hf(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var m=new u.constructor(u.type,u);xe=m,u.target.dispatchEvent(m),xe=null}else return i=ji(u),i!==null&&ff(i),s.blockedOn=u,!1;i.shift()}return!0}function qp(s,i,u){Vl(s)&&u.delete(i)}function Dw(){df=!1,qa!==null&&Vl(qa)&&(qa=null),Za!==null&&Vl(Za)&&(Za=null),Ja!==null&&Vl(Ja)&&(Ja=null),ki.forEach(qp),_i.forEach(qp)}function Ei(s,i){s.blockedOn===i&&(s.blockedOn=null,df||(df=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Dw)))}function Si(s){function i(v){return Ei(v,s)}if(0<Yl.length){Ei(Yl[0],s);for(var u=1;u<Yl.length;u++){var m=Yl[u];m.blockedOn===s&&(m.blockedOn=null)}}for(qa!==null&&Ei(qa,s),Za!==null&&Ei(Za,s),Ja!==null&&Ei(Ja,s),ki.forEach(i),_i.forEach(i),u=0;u<es.length;u++)m=es[u],m.blockedOn===s&&(m.blockedOn=null);for(;0<es.length&&(u=es[0],u.blockedOn===null);)Qp(u),u.blockedOn===null&&es.shift()}var _o=B.ReactCurrentBatchConfig,Kl=!0;function Nw(s,i,u,m){var v=Lt,b=_o.transition;_o.transition=null;try{Lt=1,pf(s,i,u,m)}finally{Lt=v,_o.transition=b}}function Fw(s,i,u,m){var v=Lt,b=_o.transition;_o.transition=null;try{Lt=4,pf(s,i,u,m)}finally{Lt=v,_o.transition=b}}function pf(s,i,u,m){if(Kl){var v=hf(s,i,u,m);if(v===null)Af(s,i,m,Gl,u),Xp(s,m);else if(Cw(v,s,i,u,m))m.stopPropagation();else if(Xp(s,m),i&4&&-1<Tw.indexOf(s)){for(;v!==null;){var b=ji(v);if(b!==null&&Yp(b),b=hf(s,i,u,m),b===null&&Af(s,i,m,Gl,u),b===v)break;v=b}v!==null&&m.stopPropagation()}else Af(s,i,m,null,u)}}var Gl=null;function hf(s,i,u,m){if(Gl=null,s=je(m),s=Ms(s),s!==null)if(i=Q(s),i===null)s=null;else if(u=i.tag,u===13){if(s=ye(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return Gl=s,null}function Zp(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(it()){case jt:return 1;case Pt:return 4;case ur:case Rs:return 16;case Qa:return 536870912;default:return 16}default:return 16}}var ts=null,mf=null,Xl=null;function Jp(){if(Xl)return Xl;var s,i=mf,u=i.length,m,v="value"in ts?ts.value:ts.textContent,b=v.length;for(s=0;s<u&&i[s]===v[s];s++);var D=u-s;for(m=1;m<=D&&i[u-m]===v[b-m];m++);return Xl=v.slice(s,1<m?1-m:void 0)}function Ql(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ql(){return!0}function eh(){return!1}function yn(s){function i(u,m,v,b,D){this._reactName=u,this._targetInst=v,this.type=m,this.nativeEvent=b,this.target=D,this.currentTarget=null;for(var ee in s)s.hasOwnProperty(ee)&&(u=s[ee],this[ee]=u?u(b):b[ee]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?ql:eh,this.isPropagationStopped=eh,this}return Y(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),i}var bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xf=yn(bo),Ti=Y({},bo,{view:0,detail:0}),Aw=yn(Ti),gf,vf,Ci,Zl=Y({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ci&&(Ci&&s.type==="mousemove"?(gf=s.screenX-Ci.screenX,vf=s.screenY-Ci.screenY):vf=gf=0,Ci=s),gf)},movementY:function(s){return"movementY"in s?s.movementY:vf}}),th=yn(Zl),Ow=Y({},Zl,{dataTransfer:0}),Pw=yn(Ow),Rw=Y({},Ti,{relatedTarget:0}),yf=yn(Rw),Mw=Y({},bo,{animationName:0,elapsedTime:0,pseudoElement:0}),Iw=yn(Mw),jw=Y({},bo,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Lw=yn(jw),zw=Y({},bo,{data:0}),rh=yn(zw),Bw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ww={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hw(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Uw[s])?!!i[s]:!1}function wf(){return Hw}var $w=Y({},Ti,{key:function(s){if(s.key){var i=Bw[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ql(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ww[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wf,charCode:function(s){return s.type==="keypress"?Ql(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ql(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yw=yn($w),Vw=Y({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nh=yn(Vw),Kw=Y({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wf}),Gw=yn(Kw),Xw=Y({},bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qw=yn(Xw),qw=Y({},Zl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zw=yn(qw),Jw=[9,13,27,32],kf=c&&"CompositionEvent"in window,Di=null;c&&"documentMode"in document&&(Di=document.documentMode);var ek=c&&"TextEvent"in window&&!Di,ah=c&&(!kf||Di&&8<Di&&11>=Di),sh=" ",oh=!1;function ih(s,i){switch(s){case"keyup":return Jw.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lh(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Eo=!1;function tk(s,i){switch(s){case"compositionend":return lh(i);case"keypress":return i.which!==32?null:(oh=!0,sh);case"textInput":return s=i.data,s===sh&&oh?null:s;default:return null}}function rk(s,i){if(Eo)return s==="compositionend"||!kf&&ih(s,i)?(s=Jp(),Xl=mf=ts=null,Eo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ah&&i.locale!=="ko"?null:i.data;default:return null}}var nk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ch(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!nk[s.type]:i==="textarea"}function uh(s,i,u,m){It(m),i=nc(i,"onChange"),0<i.length&&(u=new xf("onChange","change",null,u,m),s.push({event:u,listeners:i}))}var Ni=null,Fi=null;function ak(s){Dh(s,0)}function Jl(s){var i=No(s);if(F(i))return s}function sk(s,i){if(s==="change")return i}var fh=!1;if(c){var _f;if(c){var bf="oninput"in document;if(!bf){var dh=document.createElement("div");dh.setAttribute("oninput","return;"),bf=typeof dh.oninput=="function"}_f=bf}else _f=!1;fh=_f&&(!document.documentMode||9<document.documentMode)}function ph(){Ni&&(Ni.detachEvent("onpropertychange",hh),Fi=Ni=null)}function hh(s){if(s.propertyName==="value"&&Jl(Fi)){var i=[];uh(i,Fi,s,je(s)),Tr(ak,i)}}function ok(s,i,u){s==="focusin"?(ph(),Ni=i,Fi=u,Ni.attachEvent("onpropertychange",hh)):s==="focusout"&&ph()}function ik(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Jl(Fi)}function lk(s,i){if(s==="click")return Jl(i)}function ck(s,i){if(s==="input"||s==="change")return Jl(i)}function uk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Yn=typeof Object.is=="function"?Object.is:uk;function Ai(s,i){if(Yn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),m=Object.keys(i);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var v=u[m];if(!f.call(i,v)||!Yn(s[v],i[v]))return!1}return!0}function mh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function xh(s,i){var u=mh(s);s=0;for(var m;u;){if(u.nodeType===3){if(m=s+u.textContent.length,s<=i&&m>=i)return{node:u,offset:i-s};s=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=mh(u)}}function gh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?gh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function vh(){for(var s=window,i=Ce();i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Ce(s.document)}return i}function Ef(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function fk(s){var i=vh(),u=s.focusedElem,m=s.selectionRange;if(i!==u&&u&&u.ownerDocument&&gh(u.ownerDocument.documentElement,u)){if(m!==null&&Ef(u)){if(i=m.start,s=m.end,s===void 0&&(s=i),"selectionStart"in u)u.selectionStart=i,u.selectionEnd=Math.min(s,u.value.length);else if(s=(i=u.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var v=u.textContent.length,b=Math.min(m.start,v);m=m.end===void 0?b:Math.min(m.end,v),!s.extend&&b>m&&(v=m,m=b,b=v),v=xh(u,b);var D=xh(u,m);v&&D&&(s.rangeCount!==1||s.anchorNode!==v.node||s.anchorOffset!==v.offset||s.focusNode!==D.node||s.focusOffset!==D.offset)&&(i=i.createRange(),i.setStart(v.node,v.offset),s.removeAllRanges(),b>m?(s.addRange(i),s.extend(D.node,D.offset)):(i.setEnd(D.node,D.offset),s.addRange(i)))}}for(i=[],s=u;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<i.length;u++)s=i[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var dk=c&&"documentMode"in document&&11>=document.documentMode,So=null,Sf=null,Oi=null,Tf=!1;function yh(s,i,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Tf||So==null||So!==Ce(m)||(m=So,"selectionStart"in m&&Ef(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Oi&&Ai(Oi,m)||(Oi=m,m=nc(Sf,"onSelect"),0<m.length&&(i=new xf("onSelect","select",null,i,u),s.push({event:i,listeners:m}),i.target=So)))}function ec(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var To={animationend:ec("Animation","AnimationEnd"),animationiteration:ec("Animation","AnimationIteration"),animationstart:ec("Animation","AnimationStart"),transitionend:ec("Transition","TransitionEnd")},Cf={},wh={};c&&(wh=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function tc(s){if(Cf[s])return Cf[s];if(!To[s])return s;var i=To[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in wh)return Cf[s]=i[u];return s}var kh=tc("animationend"),_h=tc("animationiteration"),bh=tc("animationstart"),Eh=tc("transitionend"),Sh=new Map,Th="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(s,i){Sh.set(s,i),o(i,[s])}for(var Df=0;Df<Th.length;Df++){var Nf=Th[Df],pk=Nf.toLowerCase(),hk=Nf[0].toUpperCase()+Nf.slice(1);rs(pk,"on"+hk)}rs(kh,"onAnimationEnd"),rs(_h,"onAnimationIteration"),rs(bh,"onAnimationStart"),rs("dblclick","onDoubleClick"),rs("focusin","onFocus"),rs("focusout","onBlur"),rs(Eh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function Ch(s,i,u){var m=s.type||"unknown-event";s.currentTarget=u,V(m,i,void 0,s),s.currentTarget=null}function Dh(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var m=s[u],v=m.event;m=m.listeners;e:{var b=void 0;if(i)for(var D=m.length-1;0<=D;D--){var ee=m[D],ce=ee.instance,be=ee.currentTarget;if(ee=ee.listener,ce!==b&&v.isPropagationStopped())break e;Ch(v,ee,be),b=ce}else for(D=0;D<m.length;D++){if(ee=m[D],ce=ee.instance,be=ee.currentTarget,ee=ee.listener,ce!==b&&v.isPropagationStopped())break e;Ch(v,ee,be),b=ce}}}if(N)throw s=G,N=!1,G=null,s}function Xt(s,i){var u=i[jf];u===void 0&&(u=i[jf]=new Set);var m=s+"__bubble";u.has(m)||(Nh(i,s,2,!1),u.add(m))}function Ff(s,i,u){var m=0;i&&(m|=4),Nh(u,s,m,i)}var rc="_reactListening"+Math.random().toString(36).slice(2);function Ri(s){if(!s[rc]){s[rc]=!0,r.forEach(function(u){u!=="selectionchange"&&(mk.has(u)||Ff(u,!1,s),Ff(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[rc]||(i[rc]=!0,Ff("selectionchange",!1,i))}}function Nh(s,i,u,m){switch(Zp(i)){case 1:var v=Nw;break;case 4:v=Fw;break;default:v=pf}u=v.bind(null,i,u,s),v=void 0,!Ue||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(v=!0),m?v!==void 0?s.addEventListener(i,u,{capture:!0,passive:v}):s.addEventListener(i,u,!0):v!==void 0?s.addEventListener(i,u,{passive:v}):s.addEventListener(i,u,!1)}function Af(s,i,u,m,v){var b=m;if((i&1)===0&&(i&2)===0&&m!==null)e:for(;;){if(m===null)return;var D=m.tag;if(D===3||D===4){var ee=m.stateNode.containerInfo;if(ee===v||ee.nodeType===8&&ee.parentNode===v)break;if(D===4)for(D=m.return;D!==null;){var ce=D.tag;if((ce===3||ce===4)&&(ce=D.stateNode.containerInfo,ce===v||ce.nodeType===8&&ce.parentNode===v))return;D=D.return}for(;ee!==null;){if(D=Ms(ee),D===null)return;if(ce=D.tag,ce===5||ce===6){m=b=D;continue e}ee=ee.parentNode}}m=m.return}Tr(function(){var be=b,Ae=je(u),Ie=[];e:{var Fe=Sh.get(s);if(Fe!==void 0){var Ye=xf,Xe=s;switch(s){case"keypress":if(Ql(u)===0)break e;case"keydown":case"keyup":Ye=Yw;break;case"focusin":Xe="focus",Ye=yf;break;case"focusout":Xe="blur",Ye=yf;break;case"beforeblur":case"afterblur":Ye=yf;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=th;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=Pw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=Gw;break;case kh:case _h:case bh:Ye=Iw;break;case Eh:Ye=Qw;break;case"scroll":Ye=Aw;break;case"wheel":Ye=Zw;break;case"copy":case"cut":case"paste":Ye=Lw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=nh}var qe=(i&4)!==0,dr=!qe&&s==="scroll",ge=qe?Fe!==null?Fe+"Capture":null:Fe;qe=[];for(var fe=be,we;fe!==null;){we=fe;var Be=we.stateNode;if(we.tag===5&&Be!==null&&(we=Be,ge!==null&&(Be=Zr(fe,ge),Be!=null&&qe.push(Mi(fe,Be,we)))),dr)break;fe=fe.return}0<qe.length&&(Fe=new Ye(Fe,Xe,null,u,Ae),Ie.push({event:Fe,listeners:qe}))}}if((i&7)===0){e:{if(Fe=s==="mouseover"||s==="pointerover",Ye=s==="mouseout"||s==="pointerout",Fe&&u!==xe&&(Xe=u.relatedTarget||u.fromElement)&&(Ms(Xe)||Xe[Fa]))break e;if((Ye||Fe)&&(Fe=Ae.window===Ae?Ae:(Fe=Ae.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,Ye?(Xe=u.relatedTarget||u.toElement,Ye=be,Xe=Xe?Ms(Xe):null,Xe!==null&&(dr=Q(Xe),Xe!==dr||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(Ye=null,Xe=be),Ye!==Xe)){if(qe=th,Be="onMouseLeave",ge="onMouseEnter",fe="mouse",(s==="pointerout"||s==="pointerover")&&(qe=nh,Be="onPointerLeave",ge="onPointerEnter",fe="pointer"),dr=Ye==null?Fe:No(Ye),we=Xe==null?Fe:No(Xe),Fe=new qe(Be,fe+"leave",Ye,u,Ae),Fe.target=dr,Fe.relatedTarget=we,Be=null,Ms(Ae)===be&&(qe=new qe(ge,fe+"enter",Xe,u,Ae),qe.target=we,qe.relatedTarget=dr,Be=qe),dr=Be,Ye&&Xe)t:{for(qe=Ye,ge=Xe,fe=0,we=qe;we;we=Co(we))fe++;for(we=0,Be=ge;Be;Be=Co(Be))we++;for(;0<fe-we;)qe=Co(qe),fe--;for(;0<we-fe;)ge=Co(ge),we--;for(;fe--;){if(qe===ge||ge!==null&&qe===ge.alternate)break t;qe=Co(qe),ge=Co(ge)}qe=null}else qe=null;Ye!==null&&Fh(Ie,Fe,Ye,qe,!1),Xe!==null&&dr!==null&&Fh(Ie,dr,Xe,qe,!0)}}e:{if(Fe=be?No(be):window,Ye=Fe.nodeName&&Fe.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&Fe.type==="file")var Ze=sk;else if(ch(Fe))if(fh)Ze=ck;else{Ze=ik;var st=ok}else(Ye=Fe.nodeName)&&Ye.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(Ze=lk);if(Ze&&(Ze=Ze(s,be))){uh(Ie,Ze,u,Ae);break e}st&&st(s,Fe,be),s==="focusout"&&(st=Fe._wrapperState)&&st.controlled&&Fe.type==="number"&&Ne(Fe,"number",Fe.value)}switch(st=be?No(be):window,s){case"focusin":(ch(st)||st.contentEditable==="true")&&(So=st,Sf=be,Oi=null);break;case"focusout":Oi=Sf=So=null;break;case"mousedown":Tf=!0;break;case"contextmenu":case"mouseup":case"dragend":Tf=!1,yh(Ie,u,Ae);break;case"selectionchange":if(dk)break;case"keydown":case"keyup":yh(Ie,u,Ae)}var ot;if(kf)e:{switch(s){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Eo?ih(s,u)&&(ut="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(ut="onCompositionStart");ut&&(ah&&u.locale!=="ko"&&(Eo||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Eo&&(ot=Jp()):(ts=Ae,mf="value"in ts?ts.value:ts.textContent,Eo=!0)),st=nc(be,ut),0<st.length&&(ut=new rh(ut,s,null,u,Ae),Ie.push({event:ut,listeners:st}),ot?ut.data=ot:(ot=lh(u),ot!==null&&(ut.data=ot)))),(ot=ek?tk(s,u):rk(s,u))&&(be=nc(be,"onBeforeInput"),0<be.length&&(Ae=new rh("onBeforeInput","beforeinput",null,u,Ae),Ie.push({event:Ae,listeners:be}),Ae.data=ot))}Dh(Ie,i)})}function Mi(s,i,u){return{instance:s,listener:i,currentTarget:u}}function nc(s,i){for(var u=i+"Capture",m=[];s!==null;){var v=s,b=v.stateNode;v.tag===5&&b!==null&&(v=b,b=Zr(s,u),b!=null&&m.unshift(Mi(s,b,v)),b=Zr(s,i),b!=null&&m.push(Mi(s,b,v))),s=s.return}return m}function Co(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Fh(s,i,u,m,v){for(var b=i._reactName,D=[];u!==null&&u!==m;){var ee=u,ce=ee.alternate,be=ee.stateNode;if(ce!==null&&ce===m)break;ee.tag===5&&be!==null&&(ee=be,v?(ce=Zr(u,b),ce!=null&&D.unshift(Mi(u,ce,ee))):v||(ce=Zr(u,b),ce!=null&&D.push(Mi(u,ce,ee)))),u=u.return}D.length!==0&&s.push({event:i,listeners:D})}var xk=/\r\n?/g,gk=/\u0000|\uFFFD/g;function Ah(s){return(typeof s=="string"?s:""+s).replace(xk,`
`).replace(gk,"")}function ac(s,i,u){if(i=Ah(i),Ah(s)!==i&&u)throw Error(t(425))}function sc(){}var Of=null,Pf=null;function Rf(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Mf=typeof setTimeout=="function"?setTimeout:void 0,vk=typeof clearTimeout=="function"?clearTimeout:void 0,Oh=typeof Promise=="function"?Promise:void 0,yk=typeof queueMicrotask=="function"?queueMicrotask:typeof Oh<"u"?function(s){return Oh.resolve(null).then(s).catch(wk)}:Mf;function wk(s){setTimeout(function(){throw s})}function If(s,i){var u=i,m=0;do{var v=u.nextSibling;if(s.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(m===0){s.removeChild(v),Si(i);return}m--}else u!=="$"&&u!=="$?"&&u!=="$!"||m++;u=v}while(u);Si(i)}function ns(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Ph(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}var Do=Math.random().toString(36).slice(2),ca="__reactFiber$"+Do,Ii="__reactProps$"+Do,Fa="__reactContainer$"+Do,jf="__reactEvents$"+Do,kk="__reactListeners$"+Do,_k="__reactHandles$"+Do;function Ms(s){var i=s[ca];if(i)return i;for(var u=s.parentNode;u;){if(i=u[Fa]||u[ca]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=Ph(s);s!==null;){if(u=s[ca])return u;s=Ph(s)}return i}s=u,u=s.parentNode}return null}function ji(s){return s=s[ca]||s[Fa],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function No(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function oc(s){return s[Ii]||null}var Lf=[],Fo=-1;function as(s){return{current:s}}function Qt(s){0>Fo||(s.current=Lf[Fo],Lf[Fo]=null,Fo--)}function Kt(s,i){Fo++,Lf[Fo]=s.current,s.current=i}var ss={},Wr=as(ss),fn=as(!1),Is=ss;function Ao(s,i){var u=s.type.contextTypes;if(!u)return ss;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===i)return m.__reactInternalMemoizedMaskedChildContext;var v={},b;for(b in u)v[b]=i[b];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=v),v}function dn(s){return s=s.childContextTypes,s!=null}function ic(){Qt(fn),Qt(Wr)}function Rh(s,i,u){if(Wr.current!==ss)throw Error(t(168));Kt(Wr,i),Kt(fn,u)}function Mh(s,i,u){var m=s.stateNode;if(i=i.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var v in m)if(!(v in i))throw Error(t(108,pe(s)||"Unknown",v));return Y({},u,m)}function lc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ss,Is=Wr.current,Kt(Wr,s),Kt(fn,fn.current),!0}function Ih(s,i,u){var m=s.stateNode;if(!m)throw Error(t(169));u?(s=Mh(s,i,Is),m.__reactInternalMemoizedMergedChildContext=s,Qt(fn),Qt(Wr),Kt(Wr,s)):Qt(fn),Kt(fn,u)}var Aa=null,cc=!1,zf=!1;function jh(s){Aa===null?Aa=[s]:Aa.push(s)}function bk(s){cc=!0,jh(s)}function os(){if(!zf&&Aa!==null){zf=!0;var s=0,i=Lt;try{var u=Aa;for(Lt=1;s<u.length;s++){var m=u[s];do m=m(!0);while(m!==null)}Aa=null,cc=!1}catch(v){throw Aa!==null&&(Aa=Aa.slice(s+1)),Oe(jt,os),v}finally{Lt=i,zf=!1}}return null}var Oo=[],Po=0,uc=null,fc=0,Dn=[],Nn=0,js=null,Oa=1,Pa="";function Ls(s,i){Oo[Po++]=fc,Oo[Po++]=uc,uc=s,fc=i}function Lh(s,i,u){Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,js=s;var m=Oa;s=Pa;var v=32-fr(m)-1;m&=~(1<<v),u+=1;var b=32-fr(i)+v;if(30<b){var D=v-v%5;b=(m&(1<<D)-1).toString(32),m>>=D,v-=D,Oa=1<<32-fr(i)+v|u<<v|m,Pa=b+s}else Oa=1<<b|u<<v|m,Pa=s}function Bf(s){s.return!==null&&(Ls(s,1),Lh(s,1,0))}function Wf(s){for(;s===uc;)uc=Oo[--Po],Oo[Po]=null,fc=Oo[--Po],Oo[Po]=null;for(;s===js;)js=Dn[--Nn],Dn[Nn]=null,Pa=Dn[--Nn],Dn[Nn]=null,Oa=Dn[--Nn],Dn[Nn]=null}var wn=null,kn=null,Zt=!1,Vn=null;function zh(s,i){var u=Pn(5,null,null,0);u.elementType="DELETED",u.stateNode=i,u.return=s,i=s.deletions,i===null?(s.deletions=[u],s.flags|=16):i.push(u)}function Bh(s,i){switch(s.tag){case 5:var u=s.type;return i=i.nodeType!==1||u.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,wn=s,kn=ns(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,wn=s,kn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(u=js!==null?{id:Oa,overflow:Pa}:null,s.memoizedState={dehydrated:i,treeContext:u,retryLane:1073741824},u=Pn(18,null,null,0),u.stateNode=i,u.return=s,s.child=u,wn=s,kn=null,!0):!1;default:return!1}}function Uf(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Hf(s){if(Zt){var i=kn;if(i){var u=i;if(!Bh(s,i)){if(Uf(s))throw Error(t(418));i=ns(u.nextSibling);var m=wn;i&&Bh(s,i)?zh(m,u):(s.flags=s.flags&-4097|2,Zt=!1,wn=s)}}else{if(Uf(s))throw Error(t(418));s.flags=s.flags&-4097|2,Zt=!1,wn=s}}}function Wh(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;wn=s}function dc(s){if(s!==wn)return!1;if(!Zt)return Wh(s),Zt=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Rf(s.type,s.memoizedProps)),i&&(i=kn)){if(Uf(s))throw Uh(),Error(t(418));for(;i;)zh(s,i),i=ns(i.nextSibling)}if(Wh(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(i===0){kn=ns(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++}s=s.nextSibling}kn=null}}else kn=wn?ns(s.stateNode.nextSibling):null;return!0}function Uh(){for(var s=kn;s;)s=ns(s.nextSibling)}function Ro(){kn=wn=null,Zt=!1}function $f(s){Vn===null?Vn=[s]:Vn.push(s)}var Ek=B.ReactCurrentBatchConfig;function Li(s,i,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var m=u.stateNode}if(!m)throw Error(t(147,s));var v=m,b=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function(D){var ee=v.refs;D===null?delete ee[b]:ee[b]=D},i._stringRef=b,i)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function pc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Hh(s){var i=s._init;return i(s._payload)}function $h(s){function i(ge,fe){if(s){var we=ge.deletions;we===null?(ge.deletions=[fe],ge.flags|=16):we.push(fe)}}function u(ge,fe){if(!s)return null;for(;fe!==null;)i(ge,fe),fe=fe.sibling;return null}function m(ge,fe){for(ge=new Map;fe!==null;)fe.key!==null?ge.set(fe.key,fe):ge.set(fe.index,fe),fe=fe.sibling;return ge}function v(ge,fe){return ge=hs(ge,fe),ge.index=0,ge.sibling=null,ge}function b(ge,fe,we){return ge.index=we,s?(we=ge.alternate,we!==null?(we=we.index,we<fe?(ge.flags|=2,fe):we):(ge.flags|=2,fe)):(ge.flags|=1048576,fe)}function D(ge){return s&&ge.alternate===null&&(ge.flags|=2),ge}function ee(ge,fe,we,Be){return fe===null||fe.tag!==6?(fe=M0(we,ge.mode,Be),fe.return=ge,fe):(fe=v(fe,we),fe.return=ge,fe)}function ce(ge,fe,we,Be){var Ze=we.type;return Ze===C?Ae(ge,fe,we.props.children,Be,we.key):fe!==null&&(fe.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===he&&Hh(Ze)===fe.type)?(Be=v(fe,we.props),Be.ref=Li(ge,fe,we),Be.return=ge,Be):(Be=jc(we.type,we.key,we.props,null,ge.mode,Be),Be.ref=Li(ge,fe,we),Be.return=ge,Be)}function be(ge,fe,we,Be){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==we.containerInfo||fe.stateNode.implementation!==we.implementation?(fe=I0(we,ge.mode,Be),fe.return=ge,fe):(fe=v(fe,we.children||[]),fe.return=ge,fe)}function Ae(ge,fe,we,Be,Ze){return fe===null||fe.tag!==7?(fe=Vs(we,ge.mode,Be,Ze),fe.return=ge,fe):(fe=v(fe,we),fe.return=ge,fe)}function Ie(ge,fe,we){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return fe=M0(""+fe,ge.mode,we),fe.return=ge,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case J:return we=jc(fe.type,fe.key,fe.props,null,ge.mode,we),we.ref=Li(ge,null,fe),we.return=ge,we;case I:return fe=I0(fe,ge.mode,we),fe.return=ge,fe;case he:var Be=fe._init;return Ie(ge,Be(fe._payload),we)}if(Le(fe)||R(fe))return fe=Vs(fe,ge.mode,we,null),fe.return=ge,fe;pc(ge,fe)}return null}function Fe(ge,fe,we,Be){var Ze=fe!==null?fe.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return Ze!==null?null:ee(ge,fe,""+we,Be);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case J:return we.key===Ze?ce(ge,fe,we,Be):null;case I:return we.key===Ze?be(ge,fe,we,Be):null;case he:return Ze=we._init,Fe(ge,fe,Ze(we._payload),Be)}if(Le(we)||R(we))return Ze!==null?null:Ae(ge,fe,we,Be,null);pc(ge,we)}return null}function Ye(ge,fe,we,Be,Ze){if(typeof Be=="string"&&Be!==""||typeof Be=="number")return ge=ge.get(we)||null,ee(fe,ge,""+Be,Ze);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case J:return ge=ge.get(Be.key===null?we:Be.key)||null,ce(fe,ge,Be,Ze);case I:return ge=ge.get(Be.key===null?we:Be.key)||null,be(fe,ge,Be,Ze);case he:var st=Be._init;return Ye(ge,fe,we,st(Be._payload),Ze)}if(Le(Be)||R(Be))return ge=ge.get(we)||null,Ae(fe,ge,Be,Ze,null);pc(fe,Be)}return null}function Xe(ge,fe,we,Be){for(var Ze=null,st=null,ot=fe,ut=fe=0,Fr=null;ot!==null&&ut<we.length;ut++){ot.index>ut?(Fr=ot,ot=null):Fr=ot.sibling;var At=Fe(ge,ot,we[ut],Be);if(At===null){ot===null&&(ot=Fr);break}s&&ot&&At.alternate===null&&i(ge,ot),fe=b(At,fe,ut),st===null?Ze=At:st.sibling=At,st=At,ot=Fr}if(ut===we.length)return u(ge,ot),Zt&&Ls(ge,ut),Ze;if(ot===null){for(;ut<we.length;ut++)ot=Ie(ge,we[ut],Be),ot!==null&&(fe=b(ot,fe,ut),st===null?Ze=ot:st.sibling=ot,st=ot);return Zt&&Ls(ge,ut),Ze}for(ot=m(ge,ot);ut<we.length;ut++)Fr=Ye(ot,ge,ut,we[ut],Be),Fr!==null&&(s&&Fr.alternate!==null&&ot.delete(Fr.key===null?ut:Fr.key),fe=b(Fr,fe,ut),st===null?Ze=Fr:st.sibling=Fr,st=Fr);return s&&ot.forEach(function(ms){return i(ge,ms)}),Zt&&Ls(ge,ut),Ze}function qe(ge,fe,we,Be){var Ze=R(we);if(typeof Ze!="function")throw Error(t(150));if(we=Ze.call(we),we==null)throw Error(t(151));for(var st=Ze=null,ot=fe,ut=fe=0,Fr=null,At=we.next();ot!==null&&!At.done;ut++,At=we.next()){ot.index>ut?(Fr=ot,ot=null):Fr=ot.sibling;var ms=Fe(ge,ot,At.value,Be);if(ms===null){ot===null&&(ot=Fr);break}s&&ot&&ms.alternate===null&&i(ge,ot),fe=b(ms,fe,ut),st===null?Ze=ms:st.sibling=ms,st=ms,ot=Fr}if(At.done)return u(ge,ot),Zt&&Ls(ge,ut),Ze;if(ot===null){for(;!At.done;ut++,At=we.next())At=Ie(ge,At.value,Be),At!==null&&(fe=b(At,fe,ut),st===null?Ze=At:st.sibling=At,st=At);return Zt&&Ls(ge,ut),Ze}for(ot=m(ge,ot);!At.done;ut++,At=we.next())At=Ye(ot,ge,ut,At.value,Be),At!==null&&(s&&At.alternate!==null&&ot.delete(At.key===null?ut:At.key),fe=b(At,fe,ut),st===null?Ze=At:st.sibling=At,st=At);return s&&ot.forEach(function(n2){return i(ge,n2)}),Zt&&Ls(ge,ut),Ze}function dr(ge,fe,we,Be){if(typeof we=="object"&&we!==null&&we.type===C&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case J:e:{for(var Ze=we.key,st=fe;st!==null;){if(st.key===Ze){if(Ze=we.type,Ze===C){if(st.tag===7){u(ge,st.sibling),fe=v(st,we.props.children),fe.return=ge,ge=fe;break e}}else if(st.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===he&&Hh(Ze)===st.type){u(ge,st.sibling),fe=v(st,we.props),fe.ref=Li(ge,st,we),fe.return=ge,ge=fe;break e}u(ge,st);break}else i(ge,st);st=st.sibling}we.type===C?(fe=Vs(we.props.children,ge.mode,Be,we.key),fe.return=ge,ge=fe):(Be=jc(we.type,we.key,we.props,null,ge.mode,Be),Be.ref=Li(ge,fe,we),Be.return=ge,ge=Be)}return D(ge);case I:e:{for(st=we.key;fe!==null;){if(fe.key===st)if(fe.tag===4&&fe.stateNode.containerInfo===we.containerInfo&&fe.stateNode.implementation===we.implementation){u(ge,fe.sibling),fe=v(fe,we.children||[]),fe.return=ge,ge=fe;break e}else{u(ge,fe);break}else i(ge,fe);fe=fe.sibling}fe=I0(we,ge.mode,Be),fe.return=ge,ge=fe}return D(ge);case he:return st=we._init,dr(ge,fe,st(we._payload),Be)}if(Le(we))return Xe(ge,fe,we,Be);if(R(we))return qe(ge,fe,we,Be);pc(ge,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,fe!==null&&fe.tag===6?(u(ge,fe.sibling),fe=v(fe,we),fe.return=ge,ge=fe):(u(ge,fe),fe=M0(we,ge.mode,Be),fe.return=ge,ge=fe),D(ge)):u(ge,fe)}return dr}var Mo=$h(!0),Yh=$h(!1),hc=as(null),mc=null,Io=null,Yf=null;function Vf(){Yf=Io=mc=null}function Kf(s){var i=hc.current;Qt(hc),s._currentValue=i}function Gf(s,i,u){for(;s!==null;){var m=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,m!==null&&(m.childLanes|=i)):m!==null&&(m.childLanes&i)!==i&&(m.childLanes|=i),s===u)break;s=s.return}}function jo(s,i){mc=s,Yf=Io=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(pn=!0),s.firstContext=null)}function Fn(s){var i=s._currentValue;if(Yf!==s)if(s={context:s,memoizedValue:i,next:null},Io===null){if(mc===null)throw Error(t(308));Io=s,mc.dependencies={lanes:0,firstContext:s}}else Io=Io.next=s;return i}var zs=null;function Xf(s){zs===null?zs=[s]:zs.push(s)}function Vh(s,i,u,m){var v=i.interleaved;return v===null?(u.next=u,Xf(i)):(u.next=v.next,v.next=u),i.interleaved=u,Ra(s,m)}function Ra(s,i){s.lanes|=i;var u=s.alternate;for(u!==null&&(u.lanes|=i),u=s,s=s.return;s!==null;)s.childLanes|=i,u=s.alternate,u!==null&&(u.childLanes|=i),u=s,s=s.return;return u.tag===3?u.stateNode:null}var is=!1;function Qf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Ma(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function ls(s,i,u){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Tt&2)!==0){var v=m.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),m.pending=i,Ra(s,u)}return v=m.interleaved,v===null?(i.next=i,Xf(m)):(i.next=v.next,v.next=i),m.interleaved=i,Ra(s,u)}function xc(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194240)!==0)){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,uf(s,u)}}function Gh(s,i){var u=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var v=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var D={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};b===null?v=b=D:b=b.next=D,u=u.next}while(u!==null);b===null?v=b=i:b=b.next=i}else v=b=i;u={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:m.shared,effects:m.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}function gc(s,i,u,m){var v=s.updateQueue;is=!1;var b=v.firstBaseUpdate,D=v.lastBaseUpdate,ee=v.shared.pending;if(ee!==null){v.shared.pending=null;var ce=ee,be=ce.next;ce.next=null,D===null?b=be:D.next=be,D=ce;var Ae=s.alternate;Ae!==null&&(Ae=Ae.updateQueue,ee=Ae.lastBaseUpdate,ee!==D&&(ee===null?Ae.firstBaseUpdate=be:ee.next=be,Ae.lastBaseUpdate=ce))}if(b!==null){var Ie=v.baseState;D=0,Ae=be=ce=null,ee=b;do{var Fe=ee.lane,Ye=ee.eventTime;if((m&Fe)===Fe){Ae!==null&&(Ae=Ae.next={eventTime:Ye,lane:0,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null});e:{var Xe=s,qe=ee;switch(Fe=i,Ye=u,qe.tag){case 1:if(Xe=qe.payload,typeof Xe=="function"){Ie=Xe.call(Ye,Ie,Fe);break e}Ie=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=qe.payload,Fe=typeof Xe=="function"?Xe.call(Ye,Ie,Fe):Xe,Fe==null)break e;Ie=Y({},Ie,Fe);break e;case 2:is=!0}}ee.callback!==null&&ee.lane!==0&&(s.flags|=64,Fe=v.effects,Fe===null?v.effects=[ee]:Fe.push(ee))}else Ye={eventTime:Ye,lane:Fe,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},Ae===null?(be=Ae=Ye,ce=Ie):Ae=Ae.next=Ye,D|=Fe;if(ee=ee.next,ee===null){if(ee=v.shared.pending,ee===null)break;Fe=ee,ee=Fe.next,Fe.next=null,v.lastBaseUpdate=Fe,v.shared.pending=null}}while(!0);if(Ae===null&&(ce=Ie),v.baseState=ce,v.firstBaseUpdate=be,v.lastBaseUpdate=Ae,i=v.shared.interleaved,i!==null){v=i;do D|=v.lane,v=v.next;while(v!==i)}else b===null&&(v.shared.lanes=0);Us|=D,s.lanes=D,s.memoizedState=Ie}}function Xh(s,i,u){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var m=s[i],v=m.callback;if(v!==null){if(m.callback=null,m=u,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var zi={},ua=as(zi),Bi=as(zi),Wi=as(zi);function Bs(s){if(s===zi)throw Error(t(174));return s}function qf(s,i){switch(Kt(Wi,i),Kt(Bi,s),Kt(ua,zi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:ft(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=ft(i,s)}Qt(ua),Kt(ua,i)}function Lo(){Qt(ua),Qt(Bi),Qt(Wi)}function Qh(s){Bs(Wi.current);var i=Bs(ua.current),u=ft(i,s.type);i!==u&&(Kt(Bi,s),Kt(ua,u))}function Zf(s){Bi.current===s&&(Qt(ua),Qt(Bi))}var nr=as(0);function vc(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Jf=[];function e0(){for(var s=0;s<Jf.length;s++)Jf[s]._workInProgressVersionPrimary=null;Jf.length=0}var yc=B.ReactCurrentDispatcher,t0=B.ReactCurrentBatchConfig,Ws=0,ar=null,kr=null,Dr=null,wc=!1,Ui=!1,Hi=0,Sk=0;function Ur(){throw Error(t(321))}function r0(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Yn(s[u],i[u]))return!1;return!0}function n0(s,i,u,m,v,b){if(Ws=b,ar=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,yc.current=s===null||s.memoizedState===null?Nk:Fk,s=u(m,v),Ui){b=0;do{if(Ui=!1,Hi=0,25<=b)throw Error(t(301));b+=1,Dr=kr=null,i.updateQueue=null,yc.current=Ak,s=u(m,v)}while(Ui)}if(yc.current=bc,i=kr!==null&&kr.next!==null,Ws=0,Dr=kr=ar=null,wc=!1,i)throw Error(t(300));return s}function a0(){var s=Hi!==0;return Hi=0,s}function fa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?ar.memoizedState=Dr=s:Dr=Dr.next=s,Dr}function An(){if(kr===null){var s=ar.alternate;s=s!==null?s.memoizedState:null}else s=kr.next;var i=Dr===null?ar.memoizedState:Dr.next;if(i!==null)Dr=i,kr=s;else{if(s===null)throw Error(t(310));kr=s,s={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Dr===null?ar.memoizedState=Dr=s:Dr=Dr.next=s}return Dr}function $i(s,i){return typeof i=="function"?i(s):i}function s0(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=kr,v=m.baseQueue,b=u.pending;if(b!==null){if(v!==null){var D=v.next;v.next=b.next,b.next=D}m.baseQueue=v=b,u.pending=null}if(v!==null){b=v.next,m=m.baseState;var ee=D=null,ce=null,be=b;do{var Ae=be.lane;if((Ws&Ae)===Ae)ce!==null&&(ce=ce.next={lane:0,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),m=be.hasEagerState?be.eagerState:s(m,be.action);else{var Ie={lane:Ae,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null};ce===null?(ee=ce=Ie,D=m):ce=ce.next=Ie,ar.lanes|=Ae,Us|=Ae}be=be.next}while(be!==null&&be!==b);ce===null?D=m:ce.next=ee,Yn(m,i.memoizedState)||(pn=!0),i.memoizedState=m,i.baseState=D,i.baseQueue=ce,u.lastRenderedState=m}if(s=u.interleaved,s!==null){v=s;do b=v.lane,ar.lanes|=b,Us|=b,v=v.next;while(v!==s)}else v===null&&(u.lanes=0);return[i.memoizedState,u.dispatch]}function o0(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=u.dispatch,v=u.pending,b=i.memoizedState;if(v!==null){u.pending=null;var D=v=v.next;do b=s(b,D.action),D=D.next;while(D!==v);Yn(b,i.memoizedState)||(pn=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),u.lastRenderedState=b}return[b,m]}function qh(){}function Zh(s,i){var u=ar,m=An(),v=i(),b=!Yn(m.memoizedState,v);if(b&&(m.memoizedState=v,pn=!0),m=m.queue,i0(tm.bind(null,u,m,s),[s]),m.getSnapshot!==i||b||Dr!==null&&Dr.memoizedState.tag&1){if(u.flags|=2048,Yi(9,em.bind(null,u,m,v,i),void 0,null),Nr===null)throw Error(t(349));(Ws&30)!==0||Jh(u,i,v)}return v}function Jh(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=ar.updateQueue,i===null?(i={lastEffect:null,stores:null},ar.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function em(s,i,u,m){i.value=u,i.getSnapshot=m,rm(i)&&nm(s)}function tm(s,i,u){return u(function(){rm(i)&&nm(s)})}function rm(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Yn(s,u)}catch{return!0}}function nm(s){var i=Ra(s,1);i!==null&&Qn(i,s,1,-1)}function am(s){var i=fa();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:s},i.queue=s,s=s.dispatch=Dk.bind(null,ar,s),[i.memoizedState,s]}function Yi(s,i,u,m){return s={tag:s,create:i,destroy:u,deps:m,next:null},i=ar.updateQueue,i===null?(i={lastEffect:null,stores:null},ar.updateQueue=i,i.lastEffect=s.next=s):(u=i.lastEffect,u===null?i.lastEffect=s.next=s:(m=u.next,u.next=s,s.next=m,i.lastEffect=s)),s}function sm(){return An().memoizedState}function kc(s,i,u,m){var v=fa();ar.flags|=s,v.memoizedState=Yi(1|i,u,void 0,m===void 0?null:m)}function _c(s,i,u,m){var v=An();m=m===void 0?null:m;var b=void 0;if(kr!==null){var D=kr.memoizedState;if(b=D.destroy,m!==null&&r0(m,D.deps)){v.memoizedState=Yi(i,u,b,m);return}}ar.flags|=s,v.memoizedState=Yi(1|i,u,b,m)}function om(s,i){return kc(8390656,8,s,i)}function i0(s,i){return _c(2048,8,s,i)}function im(s,i){return _c(4,2,s,i)}function lm(s,i){return _c(4,4,s,i)}function cm(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function um(s,i,u){return u=u!=null?u.concat([s]):null,_c(4,4,cm.bind(null,i,s),u)}function l0(){}function fm(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&r0(i,m[1])?m[0]:(u.memoizedState=[s,i],s)}function dm(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&r0(i,m[1])?m[0]:(s=s(),u.memoizedState=[s,i],s)}function pm(s,i,u){return(Ws&21)===0?(s.baseState&&(s.baseState=!1,pn=!0),s.memoizedState=u):(Yn(u,i)||(u=Hp(),ar.lanes|=u,Us|=u,s.baseState=!0),i)}function Tk(s,i){var u=Lt;Lt=u!==0&&4>u?u:4,s(!0);var m=t0.transition;t0.transition={};try{s(!1),i()}finally{Lt=u,t0.transition=m}}function hm(){return An().memoizedState}function Ck(s,i,u){var m=ds(s);if(u={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null},mm(s))xm(i,u);else if(u=Vh(s,i,u,m),u!==null){var v=en();Qn(u,s,m,v),gm(u,i,m)}}function Dk(s,i,u){var m=ds(s),v={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null};if(mm(s))xm(i,v);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var D=i.lastRenderedState,ee=b(D,u);if(v.hasEagerState=!0,v.eagerState=ee,Yn(ee,D)){var ce=i.interleaved;ce===null?(v.next=v,Xf(i)):(v.next=ce.next,ce.next=v),i.interleaved=v;return}}catch{}finally{}u=Vh(s,i,v,m),u!==null&&(v=en(),Qn(u,s,m,v),gm(u,i,m))}}function mm(s){var i=s.alternate;return s===ar||i!==null&&i===ar}function xm(s,i){Ui=wc=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function gm(s,i,u){if((u&4194240)!==0){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,uf(s,u)}}var bc={readContext:Fn,useCallback:Ur,useContext:Ur,useEffect:Ur,useImperativeHandle:Ur,useInsertionEffect:Ur,useLayoutEffect:Ur,useMemo:Ur,useReducer:Ur,useRef:Ur,useState:Ur,useDebugValue:Ur,useDeferredValue:Ur,useTransition:Ur,useMutableSource:Ur,useSyncExternalStore:Ur,useId:Ur,unstable_isNewReconciler:!1},Nk={readContext:Fn,useCallback:function(s,i){return fa().memoizedState=[s,i===void 0?null:i],s},useContext:Fn,useEffect:om,useImperativeHandle:function(s,i,u){return u=u!=null?u.concat([s]):null,kc(4194308,4,cm.bind(null,i,s),u)},useLayoutEffect:function(s,i){return kc(4194308,4,s,i)},useInsertionEffect:function(s,i){return kc(4,2,s,i)},useMemo:function(s,i){var u=fa();return i=i===void 0?null:i,s=s(),u.memoizedState=[s,i],s},useReducer:function(s,i,u){var m=fa();return i=u!==void 0?u(i):i,m.memoizedState=m.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},m.queue=s,s=s.dispatch=Ck.bind(null,ar,s),[m.memoizedState,s]},useRef:function(s){var i=fa();return s={current:s},i.memoizedState=s},useState:am,useDebugValue:l0,useDeferredValue:function(s){return fa().memoizedState=s},useTransition:function(){var s=am(!1),i=s[0];return s=Tk.bind(null,s[1]),fa().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,u){var m=ar,v=fa();if(Zt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=i(),Nr===null)throw Error(t(349));(Ws&30)!==0||Jh(m,i,u)}v.memoizedState=u;var b={value:u,getSnapshot:i};return v.queue=b,om(tm.bind(null,m,b,s),[s]),m.flags|=2048,Yi(9,em.bind(null,m,b,u,i),void 0,null),u},useId:function(){var s=fa(),i=Nr.identifierPrefix;if(Zt){var u=Pa,m=Oa;u=(m&~(1<<32-fr(m)-1)).toString(32)+u,i=":"+i+"R"+u,u=Hi++,0<u&&(i+="H"+u.toString(32)),i+=":"}else u=Sk++,i=":"+i+"r"+u.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Fk={readContext:Fn,useCallback:fm,useContext:Fn,useEffect:i0,useImperativeHandle:um,useInsertionEffect:im,useLayoutEffect:lm,useMemo:dm,useReducer:s0,useRef:sm,useState:function(){return s0($i)},useDebugValue:l0,useDeferredValue:function(s){var i=An();return pm(i,kr.memoizedState,s)},useTransition:function(){var s=s0($i)[0],i=An().memoizedState;return[s,i]},useMutableSource:qh,useSyncExternalStore:Zh,useId:hm,unstable_isNewReconciler:!1},Ak={readContext:Fn,useCallback:fm,useContext:Fn,useEffect:i0,useImperativeHandle:um,useInsertionEffect:im,useLayoutEffect:lm,useMemo:dm,useReducer:o0,useRef:sm,useState:function(){return o0($i)},useDebugValue:l0,useDeferredValue:function(s){var i=An();return kr===null?i.memoizedState=s:pm(i,kr.memoizedState,s)},useTransition:function(){var s=o0($i)[0],i=An().memoizedState;return[s,i]},useMutableSource:qh,useSyncExternalStore:Zh,useId:hm,unstable_isNewReconciler:!1};function Kn(s,i){if(s&&s.defaultProps){i=Y({},i),s=s.defaultProps;for(var u in s)i[u]===void 0&&(i[u]=s[u]);return i}return i}function c0(s,i,u,m){i=s.memoizedState,u=u(m,i),u=u==null?i:Y({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Ec={isMounted:function(s){return(s=s._reactInternals)?Q(s)===s:!1},enqueueSetState:function(s,i,u){s=s._reactInternals;var m=en(),v=ds(s),b=Ma(m,v);b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var m=en(),v=ds(s),b=Ma(m,v);b.tag=1,b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=en(),m=ds(s),v=Ma(u,m);v.tag=2,i!=null&&(v.callback=i),i=ls(s,v,m),i!==null&&(Qn(i,s,m,u),xc(i,s,m))}};function vm(s,i,u,m,v,b,D){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,b,D):i.prototype&&i.prototype.isPureReactComponent?!Ai(u,m)||!Ai(v,b):!0}function ym(s,i,u){var m=!1,v=ss,b=i.contextType;return typeof b=="object"&&b!==null?b=Fn(b):(v=dn(i)?Is:Wr.current,m=i.contextTypes,b=(m=m!=null)?Ao(s,v):ss),i=new i(u,b),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ec,s.stateNode=i,i._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=v,s.__reactInternalMemoizedMaskedChildContext=b),i}function wm(s,i,u,m){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,m),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,m),i.state!==s&&Ec.enqueueReplaceState(i,i.state,null)}function u0(s,i,u,m){var v=s.stateNode;v.props=u,v.state=s.memoizedState,v.refs={},Qf(s);var b=i.contextType;typeof b=="object"&&b!==null?v.context=Fn(b):(b=dn(i)?Is:Wr.current,v.context=Ao(s,b)),v.state=s.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(c0(s,i,b,u),v.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(i=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),i!==v.state&&Ec.enqueueReplaceState(v,v.state,null),gc(s,u,v,m),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308)}function zo(s,i){try{var u="",m=i;do u+=U(m),m=m.return;while(m);var v=u}catch(b){v=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:i,stack:v,digest:null}}function f0(s,i,u){return{value:s,source:null,stack:u??null,digest:i??null}}function d0(s,i){try{console.error(i.value)}catch(u){setTimeout(function(){throw u})}}var Ok=typeof WeakMap=="function"?WeakMap:Map;function km(s,i,u){u=Ma(-1,u),u.tag=3,u.payload={element:null};var m=i.value;return u.callback=function(){Ac||(Ac=!0,C0=m),d0(s,i)},u}function _m(s,i,u){u=Ma(-1,u),u.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var v=i.value;u.payload=function(){return m(v)},u.callback=function(){d0(s,i)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(u.callback=function(){d0(s,i),typeof m!="function"&&(us===null?us=new Set([this]):us.add(this));var D=i.stack;this.componentDidCatch(i.value,{componentStack:D!==null?D:""})}),u}function bm(s,i,u){var m=s.pingCache;if(m===null){m=s.pingCache=new Ok;var v=new Set;m.set(i,v)}else v=m.get(i),v===void 0&&(v=new Set,m.set(i,v));v.has(u)||(v.add(u),s=Vk.bind(null,s,i,u),i.then(s,s))}function Em(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Sm(s,i,u,m,v){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(i=Ma(-1,1),i.tag=2,ls(u,i,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=v,s)}var Pk=B.ReactCurrentOwner,pn=!1;function Jr(s,i,u,m){i.child=s===null?Yh(i,null,u,m):Mo(i,s.child,u,m)}function Tm(s,i,u,m,v){u=u.render;var b=i.ref;return jo(i,v),m=n0(s,i,u,m,b,v),u=a0(),s!==null&&!pn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(Zt&&u&&Bf(i),i.flags|=1,Jr(s,i,m,v),i.child)}function Cm(s,i,u,m,v){if(s===null){var b=u.type;return typeof b=="function"&&!R0(b)&&b.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(i.tag=15,i.type=b,Dm(s,i,b,m,v)):(s=jc(u.type,null,m,i,i.mode,v),s.ref=i.ref,s.return=i,i.child=s)}if(b=s.child,(s.lanes&v)===0){var D=b.memoizedProps;if(u=u.compare,u=u!==null?u:Ai,u(D,m)&&s.ref===i.ref)return Ia(s,i,v)}return i.flags|=1,s=hs(b,m),s.ref=i.ref,s.return=i,i.child=s}function Dm(s,i,u,m,v){if(s!==null){var b=s.memoizedProps;if(Ai(b,m)&&s.ref===i.ref)if(pn=!1,i.pendingProps=m=b,(s.lanes&v)!==0)(s.flags&131072)!==0&&(pn=!0);else return i.lanes=s.lanes,Ia(s,i,v)}return p0(s,i,u,m,v)}function Nm(s,i,u){var m=i.pendingProps,v=m.children,b=s!==null?s.memoizedState:null;if(m.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kt(Wo,_n),_n|=u;else{if((u&1073741824)===0)return s=b!==null?b.baseLanes|u:u,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Kt(Wo,_n),_n|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=b!==null?b.baseLanes:u,Kt(Wo,_n),_n|=m}else b!==null?(m=b.baseLanes|u,i.memoizedState=null):m=u,Kt(Wo,_n),_n|=m;return Jr(s,i,v,u),i.child}function Fm(s,i){var u=i.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(i.flags|=512,i.flags|=2097152)}function p0(s,i,u,m,v){var b=dn(u)?Is:Wr.current;return b=Ao(i,b),jo(i,v),u=n0(s,i,u,m,b,v),m=a0(),s!==null&&!pn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(Zt&&m&&Bf(i),i.flags|=1,Jr(s,i,u,v),i.child)}function Am(s,i,u,m,v){if(dn(u)){var b=!0;lc(i)}else b=!1;if(jo(i,v),i.stateNode===null)Tc(s,i),ym(i,u,m),u0(i,u,m,v),m=!0;else if(s===null){var D=i.stateNode,ee=i.memoizedProps;D.props=ee;var ce=D.context,be=u.contextType;typeof be=="object"&&be!==null?be=Fn(be):(be=dn(u)?Is:Wr.current,be=Ao(i,be));var Ae=u.getDerivedStateFromProps,Ie=typeof Ae=="function"||typeof D.getSnapshotBeforeUpdate=="function";Ie||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(ee!==m||ce!==be)&&wm(i,D,m,be),is=!1;var Fe=i.memoizedState;D.state=Fe,gc(i,m,D,v),ce=i.memoizedState,ee!==m||Fe!==ce||fn.current||is?(typeof Ae=="function"&&(c0(i,u,Ae,m),ce=i.memoizedState),(ee=is||vm(i,u,ee,m,Fe,ce,be))?(Ie||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(i.flags|=4194308)):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=m,i.memoizedState=ce),D.props=m,D.state=ce,D.context=be,m=ee):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),m=!1)}else{D=i.stateNode,Kh(s,i),ee=i.memoizedProps,be=i.type===i.elementType?ee:Kn(i.type,ee),D.props=be,Ie=i.pendingProps,Fe=D.context,ce=u.contextType,typeof ce=="object"&&ce!==null?ce=Fn(ce):(ce=dn(u)?Is:Wr.current,ce=Ao(i,ce));var Ye=u.getDerivedStateFromProps;(Ae=typeof Ye=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(ee!==Ie||Fe!==ce)&&wm(i,D,m,ce),is=!1,Fe=i.memoizedState,D.state=Fe,gc(i,m,D,v);var Xe=i.memoizedState;ee!==Ie||Fe!==Xe||fn.current||is?(typeof Ye=="function"&&(c0(i,u,Ye,m),Xe=i.memoizedState),(be=is||vm(i,u,be,m,Fe,Xe,ce)||!1)?(Ae||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(m,Xe,ce),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(m,Xe,ce)),typeof D.componentDidUpdate=="function"&&(i.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof D.componentDidUpdate!="function"||ee===s.memoizedProps&&Fe===s.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||ee===s.memoizedProps&&Fe===s.memoizedState||(i.flags|=1024),i.memoizedProps=m,i.memoizedState=Xe),D.props=m,D.state=Xe,D.context=ce,m=be):(typeof D.componentDidUpdate!="function"||ee===s.memoizedProps&&Fe===s.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||ee===s.memoizedProps&&Fe===s.memoizedState||(i.flags|=1024),m=!1)}return h0(s,i,u,m,b,v)}function h0(s,i,u,m,v,b){Fm(s,i);var D=(i.flags&128)!==0;if(!m&&!D)return v&&Ih(i,u,!1),Ia(s,i,b);m=i.stateNode,Pk.current=i;var ee=D&&typeof u.getDerivedStateFromError!="function"?null:m.render();return i.flags|=1,s!==null&&D?(i.child=Mo(i,s.child,null,b),i.child=Mo(i,null,ee,b)):Jr(s,i,ee,b),i.memoizedState=m.state,v&&Ih(i,u,!0),i.child}function Om(s){var i=s.stateNode;i.pendingContext?Rh(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Rh(s,i.context,!1),qf(s,i.containerInfo)}function Pm(s,i,u,m,v){return Ro(),$f(v),i.flags|=256,Jr(s,i,u,m),i.child}var m0={dehydrated:null,treeContext:null,retryLane:0};function x0(s){return{baseLanes:s,cachePool:null,transitions:null}}function Rm(s,i,u){var m=i.pendingProps,v=nr.current,b=!1,D=(i.flags&128)!==0,ee;if((ee=D)||(ee=s!==null&&s.memoizedState===null?!1:(v&2)!==0),ee?(b=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(v|=1),Kt(nr,v&1),s===null)return Hf(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(D=m.children,s=m.fallback,b?(m=i.mode,b=i.child,D={mode:"hidden",children:D},(m&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=D):b=Lc(D,m,0,null),s=Vs(s,m,u,null),b.return=i,s.return=i,b.sibling=s,i.child=b,i.child.memoizedState=x0(u),i.memoizedState=m0,s):g0(i,D));if(v=s.memoizedState,v!==null&&(ee=v.dehydrated,ee!==null))return Rk(s,i,D,m,ee,v,u);if(b){b=m.fallback,D=i.mode,v=s.child,ee=v.sibling;var ce={mode:"hidden",children:m.children};return(D&1)===0&&i.child!==v?(m=i.child,m.childLanes=0,m.pendingProps=ce,i.deletions=null):(m=hs(v,ce),m.subtreeFlags=v.subtreeFlags&14680064),ee!==null?b=hs(ee,b):(b=Vs(b,D,u,null),b.flags|=2),b.return=i,m.return=i,m.sibling=b,i.child=m,m=b,b=i.child,D=s.child.memoizedState,D=D===null?x0(u):{baseLanes:D.baseLanes|u,cachePool:null,transitions:D.transitions},b.memoizedState=D,b.childLanes=s.childLanes&~u,i.memoizedState=m0,m}return b=s.child,s=b.sibling,m=hs(b,{mode:"visible",children:m.children}),(i.mode&1)===0&&(m.lanes=u),m.return=i,m.sibling=null,s!==null&&(u=i.deletions,u===null?(i.deletions=[s],i.flags|=16):u.push(s)),i.child=m,i.memoizedState=null,m}function g0(s,i){return i=Lc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Sc(s,i,u,m){return m!==null&&$f(m),Mo(i,s.child,null,u),s=g0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Rk(s,i,u,m,v,b,D){if(u)return i.flags&256?(i.flags&=-257,m=f0(Error(t(422))),Sc(s,i,D,m)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(b=m.fallback,v=i.mode,m=Lc({mode:"visible",children:m.children},v,0,null),b=Vs(b,v,D,null),b.flags|=2,m.return=i,b.return=i,m.sibling=b,i.child=m,(i.mode&1)!==0&&Mo(i,s.child,null,D),i.child.memoizedState=x0(D),i.memoizedState=m0,b);if((i.mode&1)===0)return Sc(s,i,D,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var ee=m.dgst;return m=ee,b=Error(t(419)),m=f0(b,m,void 0),Sc(s,i,D,m)}if(ee=(D&s.childLanes)!==0,pn||ee){if(m=Nr,m!==null){switch(D&-D){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|D))!==0?0:v,v!==0&&v!==b.retryLane&&(b.retryLane=v,Ra(s,v),Qn(m,s,v,-1))}return P0(),m=f0(Error(t(421))),Sc(s,i,D,m)}return v.data==="$?"?(i.flags|=128,i.child=s.child,i=Kk.bind(null,s),v._reactRetry=i,null):(s=b.treeContext,kn=ns(v.nextSibling),wn=i,Zt=!0,Vn=null,s!==null&&(Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,Oa=s.id,Pa=s.overflow,js=i),i=g0(i,m.children),i.flags|=4096,i)}function Mm(s,i,u){s.lanes|=i;var m=s.alternate;m!==null&&(m.lanes|=i),Gf(s.return,i,u)}function v0(s,i,u,m,v){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:v}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=m,b.tail=u,b.tailMode=v)}function Im(s,i,u){var m=i.pendingProps,v=m.revealOrder,b=m.tail;if(Jr(s,i,m.children,u),m=nr.current,(m&2)!==0)m=m&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Mm(s,u,i);else if(s.tag===19)Mm(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(Kt(nr,m),(i.mode&1)===0)i.memoizedState=null;else switch(v){case"forwards":for(u=i.child,v=null;u!==null;)s=u.alternate,s!==null&&vc(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=i.child,i.child=null):(v=u.sibling,u.sibling=null),v0(i,!1,v,u,b);break;case"backwards":for(u=null,v=i.child,i.child=null;v!==null;){if(s=v.alternate,s!==null&&vc(s)===null){i.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}v0(i,!0,u,null,b);break;case"together":v0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Tc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Ia(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),Us|=i.lanes,(u&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,u=hs(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=hs(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function Mk(s,i,u){switch(i.tag){case 3:Om(i),Ro();break;case 5:Qh(i);break;case 1:dn(i.type)&&lc(i);break;case 4:qf(i,i.stateNode.containerInfo);break;case 10:var m=i.type._context,v=i.memoizedProps.value;Kt(hc,m._currentValue),m._currentValue=v;break;case 13:if(m=i.memoizedState,m!==null)return m.dehydrated!==null?(Kt(nr,nr.current&1),i.flags|=128,null):(u&i.child.childLanes)!==0?Rm(s,i,u):(Kt(nr,nr.current&1),s=Ia(s,i,u),s!==null?s.sibling:null);Kt(nr,nr.current&1);break;case 19:if(m=(u&i.childLanes)!==0,(s.flags&128)!==0){if(m)return Im(s,i,u);i.flags|=128}if(v=i.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Kt(nr,nr.current),m)break;return null;case 22:case 23:return i.lanes=0,Nm(s,i,u)}return Ia(s,i,u)}var jm,y0,Lm,zm;jm=function(s,i){for(var u=i.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},y0=function(){},Lm=function(s,i,u,m){var v=s.memoizedProps;if(v!==m){s=i.stateNode,Bs(ua.current);var b=null;switch(u){case"input":v=De(s,v),m=De(s,m),b=[];break;case"select":v=Y({},v,{value:void 0}),m=Y({},m,{value:void 0}),b=[];break;case"textarea":v=Mt(s,v),m=Mt(s,m),b=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=sc)}Cn(u,m);var D;u=null;for(be in v)if(!m.hasOwnProperty(be)&&v.hasOwnProperty(be)&&v[be]!=null)if(be==="style"){var ee=v[be];for(D in ee)ee.hasOwnProperty(D)&&(u||(u={}),u[D]="")}else be!=="dangerouslySetInnerHTML"&&be!=="children"&&be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&be!=="autoFocus"&&(a.hasOwnProperty(be)?b||(b=[]):(b=b||[]).push(be,null));for(be in m){var ce=m[be];if(ee=v?.[be],m.hasOwnProperty(be)&&ce!==ee&&(ce!=null||ee!=null))if(be==="style")if(ee){for(D in ee)!ee.hasOwnProperty(D)||ce&&ce.hasOwnProperty(D)||(u||(u={}),u[D]="");for(D in ce)ce.hasOwnProperty(D)&&ee[D]!==ce[D]&&(u||(u={}),u[D]=ce[D])}else u||(b||(b=[]),b.push(be,u)),u=ce;else be==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ee=ee?ee.__html:void 0,ce!=null&&ee!==ce&&(b=b||[]).push(be,ce)):be==="children"?typeof ce!="string"&&typeof ce!="number"||(b=b||[]).push(be,""+ce):be!=="suppressContentEditableWarning"&&be!=="suppressHydrationWarning"&&(a.hasOwnProperty(be)?(ce!=null&&be==="onScroll"&&Xt("scroll",s),b||ee===ce||(b=[])):(b=b||[]).push(be,ce))}u&&(b=b||[]).push("style",u);var be=b;(i.updateQueue=be)&&(i.flags|=4)}},zm=function(s,i,u,m){u!==m&&(i.flags|=4)};function Vi(s,i){if(!Zt)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Hr(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,m=0;if(i)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=m,s.childLanes=u,i}function Ik(s,i,u){var m=i.pendingProps;switch(Wf(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(i),null;case 1:return dn(i.type)&&ic(),Hr(i),null;case 3:return m=i.stateNode,Lo(),Qt(fn),Qt(Wr),e0(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(dc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Vn!==null&&(F0(Vn),Vn=null))),y0(s,i),Hr(i),null;case 5:Zf(i);var v=Bs(Wi.current);if(u=i.type,s!==null&&i.stateNode!=null)Lm(s,i,u,m,v),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!m){if(i.stateNode===null)throw Error(t(166));return Hr(i),null}if(s=Bs(ua.current),dc(i)){m=i.stateNode,u=i.type;var b=i.memoizedProps;switch(m[ca]=i,m[Ii]=b,s=(i.mode&1)!==0,u){case"dialog":Xt("cancel",m),Xt("close",m);break;case"iframe":case"object":case"embed":Xt("load",m);break;case"video":case"audio":for(v=0;v<Pi.length;v++)Xt(Pi[v],m);break;case"source":Xt("error",m);break;case"img":case"image":case"link":Xt("error",m),Xt("load",m);break;case"details":Xt("toggle",m);break;case"input":He(m,b),Xt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!b.multiple},Xt("invalid",m);break;case"textarea":gt(m,b),Xt("invalid",m)}Cn(u,b),v=null;for(var D in b)if(b.hasOwnProperty(D)){var ee=b[D];D==="children"?typeof ee=="string"?m.textContent!==ee&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,ee,s),v=["children",ee]):typeof ee=="number"&&m.textContent!==""+ee&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,ee,s),v=["children",""+ee]):a.hasOwnProperty(D)&&ee!=null&&D==="onScroll"&&Xt("scroll",m)}switch(u){case"input":ae(m),Ee(m,b,!0);break;case"textarea":ae(m),Ft(m);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(m.onclick=sc)}m=v,i.updateQueue=m,m!==null&&(i.flags|=4)}else{D=v.nodeType===9?v:v.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Ge(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=D.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=D.createElement(u,{is:m.is}):(s=D.createElement(u),u==="select"&&(D=s,m.multiple?D.multiple=!0:m.size&&(D.size=m.size))):s=D.createElementNS(s,u),s[ca]=i,s[Ii]=m,jm(s,i,!1,!1),i.stateNode=s;e:{switch(D=vn(u,m),u){case"dialog":Xt("cancel",s),Xt("close",s),v=m;break;case"iframe":case"object":case"embed":Xt("load",s),v=m;break;case"video":case"audio":for(v=0;v<Pi.length;v++)Xt(Pi[v],s);v=m;break;case"source":Xt("error",s),v=m;break;case"img":case"image":case"link":Xt("error",s),Xt("load",s),v=m;break;case"details":Xt("toggle",s),v=m;break;case"input":He(s,m),v=De(s,m),Xt("invalid",s);break;case"option":v=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},v=Y({},m,{value:void 0}),Xt("invalid",s);break;case"textarea":gt(s,m),v=Mt(s,m),Xt("invalid",s);break;default:v=m}Cn(u,v),ee=v;for(b in ee)if(ee.hasOwnProperty(b)){var ce=ee[b];b==="style"?Ht(s,ce):b==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ce!=null&&Ut(s,ce)):b==="children"?typeof ce=="string"?(u!=="textarea"||ce!=="")&&rt(s,ce):typeof ce=="number"&&rt(s,""+ce):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(a.hasOwnProperty(b)?ce!=null&&b==="onScroll"&&Xt("scroll",s):ce!=null&&T(s,b,ce,D))}switch(u){case"input":ae(s),Ee(s,m,!1);break;case"textarea":ae(s),Ft(s);break;case"option":m.value!=null&&s.setAttribute("value",""+me(m.value));break;case"select":s.multiple=!!m.multiple,b=m.value,b!=null?Qe(s,!!m.multiple,b,!1):m.defaultValue!=null&&Qe(s,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(s.onclick=sc)}switch(u){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Hr(i),null;case 6:if(s&&i.stateNode!=null)zm(s,i,s.memoizedProps,m);else{if(typeof m!="string"&&i.stateNode===null)throw Error(t(166));if(u=Bs(Wi.current),Bs(ua.current),dc(i)){if(m=i.stateNode,u=i.memoizedProps,m[ca]=i,(b=m.nodeValue!==u)&&(s=wn,s!==null))switch(s.tag){case 3:ac(m.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ac(m.nodeValue,u,(s.mode&1)!==0)}b&&(i.flags|=4)}else m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[ca]=i,i.stateNode=m}return Hr(i),null;case 13:if(Qt(nr),m=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Zt&&kn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Uh(),Ro(),i.flags|=98560,b=!1;else if(b=dc(i),m!==null&&m.dehydrated!==null){if(s===null){if(!b)throw Error(t(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));b[ca]=i}else Ro(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Hr(i),b=!1}else Vn!==null&&(F0(Vn),Vn=null),b=!0;if(!b)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=u,i):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(nr.current&1)!==0?_r===0&&(_r=3):P0())),i.updateQueue!==null&&(i.flags|=4),Hr(i),null);case 4:return Lo(),y0(s,i),s===null&&Ri(i.stateNode.containerInfo),Hr(i),null;case 10:return Kf(i.type._context),Hr(i),null;case 17:return dn(i.type)&&ic(),Hr(i),null;case 19:if(Qt(nr),b=i.memoizedState,b===null)return Hr(i),null;if(m=(i.flags&128)!==0,D=b.rendering,D===null)if(m)Vi(b,!1);else{if(_r!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(D=vc(s),D!==null){for(i.flags|=128,Vi(b,!1),m=D.updateQueue,m!==null&&(i.updateQueue=m,i.flags|=4),i.subtreeFlags=0,m=u,u=i.child;u!==null;)b=u,s=m,b.flags&=14680066,D=b.alternate,D===null?(b.childLanes=0,b.lanes=s,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=D.childLanes,b.lanes=D.lanes,b.child=D.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=D.memoizedProps,b.memoizedState=D.memoizedState,b.updateQueue=D.updateQueue,b.type=D.type,s=D.dependencies,b.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Kt(nr,nr.current&1|2),i.child}s=s.sibling}b.tail!==null&&Me()>Uo&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304)}else{if(!m)if(s=vc(D),s!==null){if(i.flags|=128,m=!0,u=s.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),Vi(b,!0),b.tail===null&&b.tailMode==="hidden"&&!D.alternate&&!Zt)return Hr(i),null}else 2*Me()-b.renderingStartTime>Uo&&u!==1073741824&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304);b.isBackwards?(D.sibling=i.child,i.child=D):(u=b.last,u!==null?u.sibling=D:i.child=D,b.last=D)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=Me(),i.sibling=null,u=nr.current,Kt(nr,m?u&1|2:u&1),i):(Hr(i),null);case 22:case 23:return O0(),m=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(i.flags|=8192),m&&(i.mode&1)!==0?(_n&1073741824)!==0&&(Hr(i),i.subtreeFlags&6&&(i.flags|=8192)):Hr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function jk(s,i){switch(Wf(i),i.tag){case 1:return dn(i.type)&&ic(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Lo(),Qt(fn),Qt(Wr),e0(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Zf(i),null;case 13:if(Qt(nr),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Ro()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return Qt(nr),null;case 4:return Lo(),null;case 10:return Kf(i.type._context),null;case 22:case 23:return O0(),null;case 24:return null;default:return null}}var Cc=!1,$r=!1,Lk=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Bo(s,i){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(m){or(s,i,m)}else u.current=null}function w0(s,i,u){try{u()}catch(m){or(s,i,m)}}var Bm=!1;function zk(s,i){if(Of=Kl,s=vh(),Ef(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var v=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var D=0,ee=-1,ce=-1,be=0,Ae=0,Ie=s,Fe=null;t:for(;;){for(var Ye;Ie!==u||v!==0&&Ie.nodeType!==3||(ee=D+v),Ie!==b||m!==0&&Ie.nodeType!==3||(ce=D+m),Ie.nodeType===3&&(D+=Ie.nodeValue.length),(Ye=Ie.firstChild)!==null;)Fe=Ie,Ie=Ye;for(;;){if(Ie===s)break t;if(Fe===u&&++be===v&&(ee=D),Fe===b&&++Ae===m&&(ce=D),(Ye=Ie.nextSibling)!==null)break;Ie=Fe,Fe=Ie.parentNode}Ie=Ye}u=ee===-1||ce===-1?null:{start:ee,end:ce}}else u=null}u=u||{start:0,end:0}}else u=null;for(Pf={focusedElem:s,selectionRange:u},Kl=!1,Ke=i;Ke!==null;)if(i=Ke,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,Ke=s;else for(;Ke!==null;){i=Ke;try{var Xe=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var qe=Xe.memoizedProps,dr=Xe.memoizedState,ge=i.stateNode,fe=ge.getSnapshotBeforeUpdate(i.elementType===i.type?qe:Kn(i.type,qe),dr);ge.__reactInternalSnapshotBeforeUpdate=fe}break;case 3:var we=i.stateNode.containerInfo;we.nodeType===1?we.textContent="":we.nodeType===9&&we.documentElement&&we.removeChild(we.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Be){or(i,i.return,Be)}if(s=i.sibling,s!==null){s.return=i.return,Ke=s;break}Ke=i.return}return Xe=Bm,Bm=!1,Xe}function Ki(s,i,u){var m=i.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&s)===s){var b=v.destroy;v.destroy=void 0,b!==void 0&&w0(i,u,b)}v=v.next}while(v!==m)}}function Dc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&s)===s){var m=u.create;u.destroy=m()}u=u.next}while(u!==i)}}function k0(s){var i=s.ref;if(i!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof i=="function"?i(s):i.current=s}}function Wm(s){var i=s.alternate;i!==null&&(s.alternate=null,Wm(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[ca],delete i[Ii],delete i[jf],delete i[kk],delete i[_k])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Um(s){return s.tag===5||s.tag===3||s.tag===4}function Hm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Um(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _0(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.nodeType===8?u.parentNode.insertBefore(s,i):u.insertBefore(s,i):(u.nodeType===8?(i=u.parentNode,i.insertBefore(s,u)):(i=u,i.appendChild(s)),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=sc));else if(m!==4&&(s=s.child,s!==null))for(_0(s,i,u),s=s.sibling;s!==null;)_0(s,i,u),s=s.sibling}function b0(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(b0(s,i,u),s=s.sibling;s!==null;)b0(s,i,u),s=s.sibling}var Mr=null,Gn=!1;function cs(s,i,u){for(u=u.child;u!==null;)$m(s,i,u),u=u.sibling}function $m(s,i,u){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(la,u)}catch{}switch(u.tag){case 5:$r||Bo(u,i);case 6:var m=Mr,v=Gn;Mr=null,cs(s,i,u),Mr=m,Gn=v,Mr!==null&&(Gn?(s=Mr,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):Mr.removeChild(u.stateNode));break;case 18:Mr!==null&&(Gn?(s=Mr,u=u.stateNode,s.nodeType===8?If(s.parentNode,u):s.nodeType===1&&If(s,u),Si(s)):If(Mr,u.stateNode));break;case 4:m=Mr,v=Gn,Mr=u.stateNode.containerInfo,Gn=!0,cs(s,i,u),Mr=m,Gn=v;break;case 0:case 11:case 14:case 15:if(!$r&&(m=u.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var b=v,D=b.destroy;b=b.tag,D!==void 0&&((b&2)!==0||(b&4)!==0)&&w0(u,i,D),v=v.next}while(v!==m)}cs(s,i,u);break;case 1:if(!$r&&(Bo(u,i),m=u.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=u.memoizedProps,m.state=u.memoizedState,m.componentWillUnmount()}catch(ee){or(u,i,ee)}cs(s,i,u);break;case 21:cs(s,i,u);break;case 22:u.mode&1?($r=(m=$r)||u.memoizedState!==null,cs(s,i,u),$r=m):cs(s,i,u);break;default:cs(s,i,u)}}function Ym(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new Lk),i.forEach(function(m){var v=Gk.bind(null,s,m);u.has(m)||(u.add(m),m.then(v,v))})}}function Xn(s,i){var u=i.deletions;if(u!==null)for(var m=0;m<u.length;m++){var v=u[m];try{var b=s,D=i,ee=D;e:for(;ee!==null;){switch(ee.tag){case 5:Mr=ee.stateNode,Gn=!1;break e;case 3:Mr=ee.stateNode.containerInfo,Gn=!0;break e;case 4:Mr=ee.stateNode.containerInfo,Gn=!0;break e}ee=ee.return}if(Mr===null)throw Error(t(160));$m(b,D,v),Mr=null,Gn=!1;var ce=v.alternate;ce!==null&&(ce.return=null),v.return=null}catch(be){or(v,i,be)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Vm(i,s),i=i.sibling}function Vm(s,i){var u=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Xn(i,s),da(s),m&4){try{Ki(3,s,s.return),Dc(3,s)}catch(qe){or(s,s.return,qe)}try{Ki(5,s,s.return)}catch(qe){or(s,s.return,qe)}}break;case 1:Xn(i,s),da(s),m&512&&u!==null&&Bo(u,u.return);break;case 5:if(Xn(i,s),da(s),m&512&&u!==null&&Bo(u,u.return),s.flags&32){var v=s.stateNode;try{rt(v,"")}catch(qe){or(s,s.return,qe)}}if(m&4&&(v=s.stateNode,v!=null)){var b=s.memoizedProps,D=u!==null?u.memoizedProps:b,ee=s.type,ce=s.updateQueue;if(s.updateQueue=null,ce!==null)try{ee==="input"&&b.type==="radio"&&b.name!=null&&q(v,b),vn(ee,D);var be=vn(ee,b);for(D=0;D<ce.length;D+=2){var Ae=ce[D],Ie=ce[D+1];Ae==="style"?Ht(v,Ie):Ae==="dangerouslySetInnerHTML"?Ut(v,Ie):Ae==="children"?rt(v,Ie):T(v,Ae,Ie,be)}switch(ee){case"input":de(v,b);break;case"textarea":wt(v,b);break;case"select":var Fe=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!b.multiple;var Ye=b.value;Ye!=null?Qe(v,!!b.multiple,Ye,!1):Fe!==!!b.multiple&&(b.defaultValue!=null?Qe(v,!!b.multiple,b.defaultValue,!0):Qe(v,!!b.multiple,b.multiple?[]:"",!1))}v[Ii]=b}catch(qe){or(s,s.return,qe)}}break;case 6:if(Xn(i,s),da(s),m&4){if(s.stateNode===null)throw Error(t(162));v=s.stateNode,b=s.memoizedProps;try{v.nodeValue=b}catch(qe){or(s,s.return,qe)}}break;case 3:if(Xn(i,s),da(s),m&4&&u!==null&&u.memoizedState.isDehydrated)try{Si(i.containerInfo)}catch(qe){or(s,s.return,qe)}break;case 4:Xn(i,s),da(s);break;case 13:Xn(i,s),da(s),v=s.child,v.flags&8192&&(b=v.memoizedState!==null,v.stateNode.isHidden=b,!b||v.alternate!==null&&v.alternate.memoizedState!==null||(T0=Me())),m&4&&Ym(s);break;case 22:if(Ae=u!==null&&u.memoizedState!==null,s.mode&1?($r=(be=$r)||Ae,Xn(i,s),$r=be):Xn(i,s),da(s),m&8192){if(be=s.memoizedState!==null,(s.stateNode.isHidden=be)&&!Ae&&(s.mode&1)!==0)for(Ke=s,Ae=s.child;Ae!==null;){for(Ie=Ke=Ae;Ke!==null;){switch(Fe=Ke,Ye=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:Ki(4,Fe,Fe.return);break;case 1:Bo(Fe,Fe.return);var Xe=Fe.stateNode;if(typeof Xe.componentWillUnmount=="function"){m=Fe,u=Fe.return;try{i=m,Xe.props=i.memoizedProps,Xe.state=i.memoizedState,Xe.componentWillUnmount()}catch(qe){or(m,u,qe)}}break;case 5:Bo(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){Xm(Ie);continue}}Ye!==null?(Ye.return=Fe,Ke=Ye):Xm(Ie)}Ae=Ae.sibling}e:for(Ae=null,Ie=s;;){if(Ie.tag===5){if(Ae===null){Ae=Ie;try{v=Ie.stateNode,be?(b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(ee=Ie.stateNode,ce=Ie.memoizedProps.style,D=ce!=null&&ce.hasOwnProperty("display")?ce.display:null,ee.style.display=kt("display",D))}catch(qe){or(s,s.return,qe)}}}else if(Ie.tag===6){if(Ae===null)try{Ie.stateNode.nodeValue=be?"":Ie.memoizedProps}catch(qe){or(s,s.return,qe)}}else if((Ie.tag!==22&&Ie.tag!==23||Ie.memoizedState===null||Ie===s)&&Ie.child!==null){Ie.child.return=Ie,Ie=Ie.child;continue}if(Ie===s)break e;for(;Ie.sibling===null;){if(Ie.return===null||Ie.return===s)break e;Ae===Ie&&(Ae=null),Ie=Ie.return}Ae===Ie&&(Ae=null),Ie.sibling.return=Ie.return,Ie=Ie.sibling}}break;case 19:Xn(i,s),da(s),m&4&&Ym(s);break;case 21:break;default:Xn(i,s),da(s)}}function da(s){var i=s.flags;if(i&2){try{e:{for(var u=s.return;u!==null;){if(Um(u)){var m=u;break e}u=u.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(rt(v,""),m.flags&=-33);var b=Hm(s);b0(s,b,v);break;case 3:case 4:var D=m.stateNode.containerInfo,ee=Hm(s);_0(s,ee,D);break;default:throw Error(t(161))}}catch(ce){or(s,s.return,ce)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Bk(s,i,u){Ke=s,Km(s)}function Km(s,i,u){for(var m=(s.mode&1)!==0;Ke!==null;){var v=Ke,b=v.child;if(v.tag===22&&m){var D=v.memoizedState!==null||Cc;if(!D){var ee=v.alternate,ce=ee!==null&&ee.memoizedState!==null||$r;ee=Cc;var be=$r;if(Cc=D,($r=ce)&&!be)for(Ke=v;Ke!==null;)D=Ke,ce=D.child,D.tag===22&&D.memoizedState!==null?Qm(v):ce!==null?(ce.return=D,Ke=ce):Qm(v);for(;b!==null;)Ke=b,Km(b),b=b.sibling;Ke=v,Cc=ee,$r=be}Gm(s)}else(v.subtreeFlags&8772)!==0&&b!==null?(b.return=v,Ke=b):Gm(s)}}function Gm(s){for(;Ke!==null;){var i=Ke;if((i.flags&8772)!==0){var u=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:$r||Dc(5,i);break;case 1:var m=i.stateNode;if(i.flags&4&&!$r)if(u===null)m.componentDidMount();else{var v=i.elementType===i.type?u.memoizedProps:Kn(i.type,u.memoizedProps);m.componentDidUpdate(v,u.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&Xh(i,b,m);break;case 3:var D=i.updateQueue;if(D!==null){if(u=null,i.child!==null)switch(i.child.tag){case 5:u=i.child.stateNode;break;case 1:u=i.child.stateNode}Xh(i,D,u)}break;case 5:var ee=i.stateNode;if(u===null&&i.flags&4){u=ee;var ce=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":ce.autoFocus&&u.focus();break;case"img":ce.src&&(u.src=ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var be=i.alternate;if(be!==null){var Ae=be.memoizedState;if(Ae!==null){var Ie=Ae.dehydrated;Ie!==null&&Si(Ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}$r||i.flags&512&&k0(i)}catch(Fe){or(i,i.return,Fe)}}if(i===s){Ke=null;break}if(u=i.sibling,u!==null){u.return=i.return,Ke=u;break}Ke=i.return}}function Xm(s){for(;Ke!==null;){var i=Ke;if(i===s){Ke=null;break}var u=i.sibling;if(u!==null){u.return=i.return,Ke=u;break}Ke=i.return}}function Qm(s){for(;Ke!==null;){var i=Ke;try{switch(i.tag){case 0:case 11:case 15:var u=i.return;try{Dc(4,i)}catch(ce){or(i,u,ce)}break;case 1:var m=i.stateNode;if(typeof m.componentDidMount=="function"){var v=i.return;try{m.componentDidMount()}catch(ce){or(i,v,ce)}}var b=i.return;try{k0(i)}catch(ce){or(i,b,ce)}break;case 5:var D=i.return;try{k0(i)}catch(ce){or(i,D,ce)}}}catch(ce){or(i,i.return,ce)}if(i===s){Ke=null;break}var ee=i.sibling;if(ee!==null){ee.return=i.return,Ke=ee;break}Ke=i.return}}var Wk=Math.ceil,Nc=B.ReactCurrentDispatcher,E0=B.ReactCurrentOwner,On=B.ReactCurrentBatchConfig,Tt=0,Nr=null,xr=null,Ir=0,_n=0,Wo=as(0),_r=0,Gi=null,Us=0,Fc=0,S0=0,Xi=null,hn=null,T0=0,Uo=1/0,ja=null,Ac=!1,C0=null,us=null,Oc=!1,fs=null,Pc=0,Qi=0,D0=null,Rc=-1,Mc=0;function en(){return(Tt&6)!==0?Me():Rc!==-1?Rc:Rc=Me()}function ds(s){return(s.mode&1)===0?1:(Tt&2)!==0&&Ir!==0?Ir&-Ir:Ek.transition!==null?(Mc===0&&(Mc=Hp()),Mc):(s=Lt,s!==0||(s=window.event,s=s===void 0?16:Zp(s.type)),s)}function Qn(s,i,u,m){if(50<Qi)throw Qi=0,D0=null,Error(t(185));wi(s,u,m),((Tt&2)===0||s!==Nr)&&(s===Nr&&((Tt&2)===0&&(Fc|=u),_r===4&&ps(s,Ir)),mn(s,m),u===1&&Tt===0&&(i.mode&1)===0&&(Uo=Me()+500,cc&&os()))}function mn(s,i){var u=s.callbackNode;Ew(s,i);var m=$l(s,s===Nr?Ir:0);if(m===0)u!==null&&We(u),s.callbackNode=null,s.callbackPriority=0;else if(i=m&-m,s.callbackPriority!==i){if(u!=null&&We(u),i===1)s.tag===0?bk(Zm.bind(null,s)):jh(Zm.bind(null,s)),yk(function(){(Tt&6)===0&&os()}),u=null;else{switch($p(m)){case 1:u=jt;break;case 4:u=Pt;break;case 16:u=ur;break;case 536870912:u=Qa;break;default:u=ur}u=ox(u,qm.bind(null,s))}s.callbackPriority=i,s.callbackNode=u}}function qm(s,i){if(Rc=-1,Mc=0,(Tt&6)!==0)throw Error(t(327));var u=s.callbackNode;if(Ho()&&s.callbackNode!==u)return null;var m=$l(s,s===Nr?Ir:0);if(m===0)return null;if((m&30)!==0||(m&s.expiredLanes)!==0||i)i=Ic(s,m);else{i=m;var v=Tt;Tt|=2;var b=ex();(Nr!==s||Ir!==i)&&(ja=null,Uo=Me()+500,$s(s,i));do try{$k();break}catch(ee){Jm(s,ee)}while(!0);Vf(),Nc.current=b,Tt=v,xr!==null?i=0:(Nr=null,Ir=0,i=_r)}if(i!==0){if(i===2&&(v=lf(s),v!==0&&(m=v,i=N0(s,v))),i===1)throw u=Gi,$s(s,0),ps(s,m),mn(s,Me()),u;if(i===6)ps(s,m);else{if(v=s.current.alternate,(m&30)===0&&!Uk(v)&&(i=Ic(s,m),i===2&&(b=lf(s),b!==0&&(m=b,i=N0(s,b))),i===1))throw u=Gi,$s(s,0),ps(s,m),mn(s,Me()),u;switch(s.finishedWork=v,s.finishedLanes=m,i){case 0:case 1:throw Error(t(345));case 2:Ys(s,hn,ja);break;case 3:if(ps(s,m),(m&130023424)===m&&(i=T0+500-Me(),10<i)){if($l(s,0)!==0)break;if(v=s.suspendedLanes,(v&m)!==m){en(),s.pingedLanes|=s.suspendedLanes&v;break}s.timeoutHandle=Mf(Ys.bind(null,s,hn,ja),i);break}Ys(s,hn,ja);break;case 4:if(ps(s,m),(m&4194240)===m)break;for(i=s.eventTimes,v=-1;0<m;){var D=31-fr(m);b=1<<D,D=i[D],D>v&&(v=D),m&=~b}if(m=v,m=Me()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*Wk(m/1960))-m,10<m){s.timeoutHandle=Mf(Ys.bind(null,s,hn,ja),m);break}Ys(s,hn,ja);break;case 5:Ys(s,hn,ja);break;default:throw Error(t(329))}}}return mn(s,Me()),s.callbackNode===u?qm.bind(null,s):null}function N0(s,i){var u=Xi;return s.current.memoizedState.isDehydrated&&($s(s,i).flags|=256),s=Ic(s,i),s!==2&&(i=hn,hn=u,i!==null&&F0(i)),s}function F0(s){hn===null?hn=s:hn.push.apply(hn,s)}function Uk(s){for(var i=s;;){if(i.flags&16384){var u=i.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var m=0;m<u.length;m++){var v=u[m],b=v.getSnapshot;v=v.value;try{if(!Yn(b(),v))return!1}catch{return!1}}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ps(s,i){for(i&=~S0,i&=~Fc,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var u=31-fr(i),m=1<<u;s[u]=-1,i&=~m}}function Zm(s){if((Tt&6)!==0)throw Error(t(327));Ho();var i=$l(s,0);if((i&1)===0)return mn(s,Me()),null;var u=Ic(s,i);if(s.tag!==0&&u===2){var m=lf(s);m!==0&&(i=m,u=N0(s,m))}if(u===1)throw u=Gi,$s(s,0),ps(s,i),mn(s,Me()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Ys(s,hn,ja),mn(s,Me()),null}function A0(s,i){var u=Tt;Tt|=1;try{return s(i)}finally{Tt=u,Tt===0&&(Uo=Me()+500,cc&&os())}}function Hs(s){fs!==null&&fs.tag===0&&(Tt&6)===0&&Ho();var i=Tt;Tt|=1;var u=On.transition,m=Lt;try{if(On.transition=null,Lt=1,s)return s()}finally{Lt=m,On.transition=u,Tt=i,(Tt&6)===0&&os()}}function O0(){_n=Wo.current,Qt(Wo)}function $s(s,i){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,vk(u)),xr!==null)for(u=xr.return;u!==null;){var m=u;switch(Wf(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&ic();break;case 3:Lo(),Qt(fn),Qt(Wr),e0();break;case 5:Zf(m);break;case 4:Lo();break;case 13:Qt(nr);break;case 19:Qt(nr);break;case 10:Kf(m.type._context);break;case 22:case 23:O0()}u=u.return}if(Nr=s,xr=s=hs(s.current,null),Ir=_n=i,_r=0,Gi=null,S0=Fc=Us=0,hn=Xi=null,zs!==null){for(i=0;i<zs.length;i++)if(u=zs[i],m=u.interleaved,m!==null){u.interleaved=null;var v=m.next,b=u.pending;if(b!==null){var D=b.next;b.next=v,m.next=D}u.pending=m}zs=null}return s}function Jm(s,i){do{var u=xr;try{if(Vf(),yc.current=bc,wc){for(var m=ar.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}wc=!1}if(Ws=0,Dr=kr=ar=null,Ui=!1,Hi=0,E0.current=null,u===null||u.return===null){_r=1,Gi=i,xr=null;break}e:{var b=s,D=u.return,ee=u,ce=i;if(i=Ir,ee.flags|=32768,ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var be=ce,Ae=ee,Ie=Ae.tag;if((Ae.mode&1)===0&&(Ie===0||Ie===11||Ie===15)){var Fe=Ae.alternate;Fe?(Ae.updateQueue=Fe.updateQueue,Ae.memoizedState=Fe.memoizedState,Ae.lanes=Fe.lanes):(Ae.updateQueue=null,Ae.memoizedState=null)}var Ye=Em(D);if(Ye!==null){Ye.flags&=-257,Sm(Ye,D,ee,b,i),Ye.mode&1&&bm(b,be,i),i=Ye,ce=be;var Xe=i.updateQueue;if(Xe===null){var qe=new Set;qe.add(ce),i.updateQueue=qe}else Xe.add(ce);break e}else{if((i&1)===0){bm(b,be,i),P0();break e}ce=Error(t(426))}}else if(Zt&&ee.mode&1){var dr=Em(D);if(dr!==null){(dr.flags&65536)===0&&(dr.flags|=256),Sm(dr,D,ee,b,i),$f(zo(ce,ee));break e}}b=ce=zo(ce,ee),_r!==4&&(_r=2),Xi===null?Xi=[b]:Xi.push(b),b=D;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var ge=km(b,ce,i);Gh(b,ge);break e;case 1:ee=ce;var fe=b.type,we=b.stateNode;if((b.flags&128)===0&&(typeof fe.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(us===null||!us.has(we)))){b.flags|=65536,i&=-i,b.lanes|=i;var Be=_m(b,ee,i);Gh(b,Be);break e}}b=b.return}while(b!==null)}rx(u)}catch(Ze){i=Ze,xr===u&&u!==null&&(xr=u=u.return);continue}break}while(!0)}function ex(){var s=Nc.current;return Nc.current=bc,s===null?bc:s}function P0(){(_r===0||_r===3||_r===2)&&(_r=4),Nr===null||(Us&268435455)===0&&(Fc&268435455)===0||ps(Nr,Ir)}function Ic(s,i){var u=Tt;Tt|=2;var m=ex();(Nr!==s||Ir!==i)&&(ja=null,$s(s,i));do try{Hk();break}catch(v){Jm(s,v)}while(!0);if(Vf(),Tt=u,Nc.current=m,xr!==null)throw Error(t(261));return Nr=null,Ir=0,_r}function Hk(){for(;xr!==null;)tx(xr)}function $k(){for(;xr!==null&&!Pe();)tx(xr)}function tx(s){var i=sx(s.alternate,s,_n);s.memoizedProps=s.pendingProps,i===null?rx(s):xr=i,E0.current=null}function rx(s){var i=s;do{var u=i.alternate;if(s=i.return,(i.flags&32768)===0){if(u=Ik(u,i,_n),u!==null){xr=u;return}}else{if(u=jk(u,i),u!==null){u.flags&=32767,xr=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{_r=6,xr=null;return}}if(i=i.sibling,i!==null){xr=i;return}xr=i=s}while(i!==null);_r===0&&(_r=5)}function Ys(s,i,u){var m=Lt,v=On.transition;try{On.transition=null,Lt=1,Yk(s,i,u,m)}finally{On.transition=v,Lt=m}return null}function Yk(s,i,u,m){do Ho();while(fs!==null);if((Tt&6)!==0)throw Error(t(327));u=s.finishedWork;var v=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var b=u.lanes|u.childLanes;if(Sw(s,b),s===Nr&&(xr=Nr=null,Ir=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Oc||(Oc=!0,ox(ur,function(){return Ho(),null})),b=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||b){b=On.transition,On.transition=null;var D=Lt;Lt=1;var ee=Tt;Tt|=4,E0.current=null,zk(s,u),Vm(u,s),fk(Pf),Kl=!!Of,Pf=Of=null,s.current=u,Bk(u),Re(),Tt=ee,Lt=D,On.transition=b}else s.current=u;if(Oc&&(Oc=!1,fs=s,Pc=v),b=s.pendingLanes,b===0&&(us=null),vi(u.stateNode),mn(s,Me()),i!==null)for(m=s.onRecoverableError,u=0;u<i.length;u++)v=i[u],m(v.value,{componentStack:v.stack,digest:v.digest});if(Ac)throw Ac=!1,s=C0,C0=null,s;return(Pc&1)!==0&&s.tag!==0&&Ho(),b=s.pendingLanes,(b&1)!==0?s===D0?Qi++:(Qi=0,D0=s):Qi=0,os(),null}function Ho(){if(fs!==null){var s=$p(Pc),i=On.transition,u=Lt;try{if(On.transition=null,Lt=16>s?16:s,fs===null)var m=!1;else{if(s=fs,fs=null,Pc=0,(Tt&6)!==0)throw Error(t(331));var v=Tt;for(Tt|=4,Ke=s.current;Ke!==null;){var b=Ke,D=b.child;if((Ke.flags&16)!==0){var ee=b.deletions;if(ee!==null){for(var ce=0;ce<ee.length;ce++){var be=ee[ce];for(Ke=be;Ke!==null;){var Ae=Ke;switch(Ae.tag){case 0:case 11:case 15:Ki(8,Ae,b)}var Ie=Ae.child;if(Ie!==null)Ie.return=Ae,Ke=Ie;else for(;Ke!==null;){Ae=Ke;var Fe=Ae.sibling,Ye=Ae.return;if(Wm(Ae),Ae===be){Ke=null;break}if(Fe!==null){Fe.return=Ye,Ke=Fe;break}Ke=Ye}}}var Xe=b.alternate;if(Xe!==null){var qe=Xe.child;if(qe!==null){Xe.child=null;do{var dr=qe.sibling;qe.sibling=null,qe=dr}while(qe!==null)}}Ke=b}}if((b.subtreeFlags&2064)!==0&&D!==null)D.return=b,Ke=D;else e:for(;Ke!==null;){if(b=Ke,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:Ki(9,b,b.return)}var ge=b.sibling;if(ge!==null){ge.return=b.return,Ke=ge;break e}Ke=b.return}}var fe=s.current;for(Ke=fe;Ke!==null;){D=Ke;var we=D.child;if((D.subtreeFlags&2064)!==0&&we!==null)we.return=D,Ke=we;else e:for(D=fe;Ke!==null;){if(ee=Ke,(ee.flags&2048)!==0)try{switch(ee.tag){case 0:case 11:case 15:Dc(9,ee)}}catch(Ze){or(ee,ee.return,Ze)}if(ee===D){Ke=null;break e}var Be=ee.sibling;if(Be!==null){Be.return=ee.return,Ke=Be;break e}Ke=ee.return}}if(Tt=v,os(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(la,s)}catch{}m=!0}return m}finally{Lt=u,On.transition=i}}return!1}function nx(s,i,u){i=zo(u,i),i=km(s,i,1),s=ls(s,i,1),i=en(),s!==null&&(wi(s,1,i),mn(s,i))}function or(s,i,u){if(s.tag===3)nx(s,s,u);else for(;i!==null;){if(i.tag===3){nx(i,s,u);break}else if(i.tag===1){var m=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(us===null||!us.has(m))){s=zo(u,s),s=_m(i,s,1),i=ls(i,s,1),s=en(),i!==null&&(wi(i,1,s),mn(i,s));break}}i=i.return}}function Vk(s,i,u){var m=s.pingCache;m!==null&&m.delete(i),i=en(),s.pingedLanes|=s.suspendedLanes&u,Nr===s&&(Ir&u)===u&&(_r===4||_r===3&&(Ir&130023424)===Ir&&500>Me()-T0?$s(s,0):S0|=u),mn(s,i)}function ax(s,i){i===0&&((s.mode&1)===0?i=1:(i=Hl,Hl<<=1,(Hl&130023424)===0&&(Hl=4194304)));var u=en();s=Ra(s,i),s!==null&&(wi(s,i,u),mn(s,u))}function Kk(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),ax(s,u)}function Gk(s,i){var u=0;switch(s.tag){case 13:var m=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(i),ax(s,u)}var sx;sx=function(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps||fn.current)pn=!0;else{if((s.lanes&u)===0&&(i.flags&128)===0)return pn=!1,Mk(s,i,u);pn=(s.flags&131072)!==0}else pn=!1,Zt&&(i.flags&1048576)!==0&&Lh(i,fc,i.index);switch(i.lanes=0,i.tag){case 2:var m=i.type;Tc(s,i),s=i.pendingProps;var v=Ao(i,Wr.current);jo(i,u),v=n0(null,i,m,s,v,u);var b=a0();return i.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,dn(m)?(b=!0,lc(i)):b=!1,i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Qf(i),v.updater=Ec,i.stateNode=v,v._reactInternals=i,u0(i,m,s,u),i=h0(null,i,m,!0,b,u)):(i.tag=0,Zt&&b&&Bf(i),Jr(null,i,v,u),i=i.child),i;case 16:m=i.elementType;e:{switch(Tc(s,i),s=i.pendingProps,v=m._init,m=v(m._payload),i.type=m,v=i.tag=Qk(m),s=Kn(m,s),v){case 0:i=p0(null,i,m,s,u);break e;case 1:i=Am(null,i,m,s,u);break e;case 11:i=Tm(null,i,m,s,u);break e;case 14:i=Cm(null,i,m,Kn(m.type,s),u);break e}throw Error(t(306,m,""))}return i;case 0:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),p0(s,i,m,v,u);case 1:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Am(s,i,m,v,u);case 3:e:{if(Om(i),s===null)throw Error(t(387));m=i.pendingProps,b=i.memoizedState,v=b.element,Kh(s,i),gc(i,m,null,u);var D=i.memoizedState;if(m=D.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){v=zo(Error(t(423)),i),i=Pm(s,i,m,u,v);break e}else if(m!==v){v=zo(Error(t(424)),i),i=Pm(s,i,m,u,v);break e}else for(kn=ns(i.stateNode.containerInfo.firstChild),wn=i,Zt=!0,Vn=null,u=Yh(i,null,m,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Ro(),m===v){i=Ia(s,i,u);break e}Jr(s,i,m,u)}i=i.child}return i;case 5:return Qh(i),s===null&&Hf(i),m=i.type,v=i.pendingProps,b=s!==null?s.memoizedProps:null,D=v.children,Rf(m,v)?D=null:b!==null&&Rf(m,b)&&(i.flags|=32),Fm(s,i),Jr(s,i,D,u),i.child;case 6:return s===null&&Hf(i),null;case 13:return Rm(s,i,u);case 4:return qf(i,i.stateNode.containerInfo),m=i.pendingProps,s===null?i.child=Mo(i,null,m,u):Jr(s,i,m,u),i.child;case 11:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Tm(s,i,m,v,u);case 7:return Jr(s,i,i.pendingProps,u),i.child;case 8:return Jr(s,i,i.pendingProps.children,u),i.child;case 12:return Jr(s,i,i.pendingProps.children,u),i.child;case 10:e:{if(m=i.type._context,v=i.pendingProps,b=i.memoizedProps,D=v.value,Kt(hc,m._currentValue),m._currentValue=D,b!==null)if(Yn(b.value,D)){if(b.children===v.children&&!fn.current){i=Ia(s,i,u);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var ee=b.dependencies;if(ee!==null){D=b.child;for(var ce=ee.firstContext;ce!==null;){if(ce.context===m){if(b.tag===1){ce=Ma(-1,u&-u),ce.tag=2;var be=b.updateQueue;if(be!==null){be=be.shared;var Ae=be.pending;Ae===null?ce.next=ce:(ce.next=Ae.next,Ae.next=ce),be.pending=ce}}b.lanes|=u,ce=b.alternate,ce!==null&&(ce.lanes|=u),Gf(b.return,u,i),ee.lanes|=u;break}ce=ce.next}}else if(b.tag===10)D=b.type===i.type?null:b.child;else if(b.tag===18){if(D=b.return,D===null)throw Error(t(341));D.lanes|=u,ee=D.alternate,ee!==null&&(ee.lanes|=u),Gf(D,u,i),D=b.sibling}else D=b.child;if(D!==null)D.return=b;else for(D=b;D!==null;){if(D===i){D=null;break}if(b=D.sibling,b!==null){b.return=D.return,D=b;break}D=D.return}b=D}Jr(s,i,v.children,u),i=i.child}return i;case 9:return v=i.type,m=i.pendingProps.children,jo(i,u),v=Fn(v),m=m(v),i.flags|=1,Jr(s,i,m,u),i.child;case 14:return m=i.type,v=Kn(m,i.pendingProps),v=Kn(m.type,v),Cm(s,i,m,v,u);case 15:return Dm(s,i,i.type,i.pendingProps,u);case 17:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Tc(s,i),i.tag=1,dn(m)?(s=!0,lc(i)):s=!1,jo(i,u),ym(i,m,v),u0(i,m,v,u),h0(null,i,m,!0,s,u);case 19:return Im(s,i,u);case 22:return Nm(s,i,u)}throw Error(t(156,i.tag))};function ox(s,i){return Oe(s,i)}function Xk(s,i,u,m){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,i,u,m){return new Xk(s,i,u,m)}function R0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Qk(s){if(typeof s=="function")return R0(s)?1:0;if(s!=null){if(s=s.$$typeof,s===W)return 11;if(s===re)return 14}return 2}function hs(s,i){var u=s.alternate;return u===null?(u=Pn(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function jc(s,i,u,m,v,b){var D=2;if(m=s,typeof s=="function")R0(s)&&(D=1);else if(typeof s=="string")D=5;else e:switch(s){case C:return Vs(u.children,v,b,i);case Z:D=8,v|=8;break;case L:return s=Pn(12,u,i,v|2),s.elementType=L,s.lanes=b,s;case ue:return s=Pn(13,u,i,v),s.elementType=ue,s.lanes=b,s;case le:return s=Pn(19,u,i,v),s.elementType=le,s.lanes=b,s;case K:return Lc(u,v,b,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ne:D=10;break e;case X:D=9;break e;case W:D=11;break e;case re:D=14;break e;case he:D=16,m=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Pn(D,u,i,v),i.elementType=s,i.type=m,i.lanes=b,i}function Vs(s,i,u,m){return s=Pn(7,s,m,i),s.lanes=u,s}function Lc(s,i,u,m){return s=Pn(22,s,m,i),s.elementType=K,s.lanes=u,s.stateNode={isHidden:!1},s}function M0(s,i,u){return s=Pn(6,s,null,i),s.lanes=u,s}function I0(s,i,u){return i=Pn(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function qk(s,i,u,m,v){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cf(0),this.expirationTimes=cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cf(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function j0(s,i,u,m,v,b,D,ee,ce){return s=new qk(s,i,u,ee,ce),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Pn(3,null,null,i),s.current=b,b.stateNode=s,b.memoizedState={element:m,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qf(b),s}function Zk(s,i,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:m==null?null:""+m,children:s,containerInfo:i,implementation:u}}function ix(s){if(!s)return ss;s=s._reactInternals;e:{if(Q(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(dn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(dn(u))return Mh(s,u,i)}return i}function lx(s,i,u,m,v,b,D,ee,ce){return s=j0(u,m,!0,s,v,b,D,ee,ce),s.context=ix(null),u=s.current,m=en(),v=ds(u),b=Ma(m,v),b.callback=i??null,ls(u,b,v),s.current.lanes=v,wi(s,v,m),mn(s,m),s}function zc(s,i,u,m){var v=i.current,b=en(),D=ds(v);return u=ix(u),i.context===null?i.context=u:i.pendingContext=u,i=Ma(b,D),i.payload={element:s},m=m===void 0?null:m,m!==null&&(i.callback=m),s=ls(v,i,D),s!==null&&(Qn(s,v,D,b),xc(s,v,D)),D}function Bc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function cx(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function L0(s,i){cx(s,i),(s=s.alternate)&&cx(s,i)}function Jk(){return null}var ux=typeof reportError=="function"?reportError:function(s){console.error(s)};function z0(s){this._internalRoot=s}Wc.prototype.render=z0.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));zc(s,i,null,null)},Wc.prototype.unmount=z0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Hs(function(){zc(null,s,null,null)}),i[Fa]=null}};function Wc(s){this._internalRoot=s}Wc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Kp();s={blockedOn:null,target:s,priority:i};for(var u=0;u<es.length&&i!==0&&i<es[u].priority;u++);es.splice(u,0,s),u===0&&Qp(s)}};function B0(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Uc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function fx(){}function e2(s,i,u,m,v){if(v){if(typeof m=="function"){var b=m;m=function(){var be=Bc(D);b.call(be)}}var D=lx(i,m,s,0,null,!1,!1,"",fx);return s._reactRootContainer=D,s[Fa]=D.current,Ri(s.nodeType===8?s.parentNode:s),Hs(),D}for(;v=s.lastChild;)s.removeChild(v);if(typeof m=="function"){var ee=m;m=function(){var be=Bc(ce);ee.call(be)}}var ce=j0(s,0,!1,null,null,!1,!1,"",fx);return s._reactRootContainer=ce,s[Fa]=ce.current,Ri(s.nodeType===8?s.parentNode:s),Hs(function(){zc(i,ce,u,m)}),ce}function Hc(s,i,u,m,v){var b=u._reactRootContainer;if(b){var D=b;if(typeof v=="function"){var ee=v;v=function(){var ce=Bc(D);ee.call(ce)}}zc(i,D,s,v)}else D=e2(u,i,s,v,m);return Bc(D)}Yp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var u=yi(i.pendingLanes);u!==0&&(uf(i,u|1),mn(i,Me()),(Tt&6)===0&&(Uo=Me()+500,os()))}break;case 13:Hs(function(){var m=Ra(s,1);if(m!==null){var v=en();Qn(m,s,1,v)}}),L0(s,1)}},ff=function(s){if(s.tag===13){var i=Ra(s,134217728);if(i!==null){var u=en();Qn(i,s,134217728,u)}L0(s,134217728)}},Vp=function(s){if(s.tag===13){var i=ds(s),u=Ra(s,i);if(u!==null){var m=en();Qn(u,s,i,m)}L0(s,i)}},Kp=function(){return Lt},Gp=function(s,i){var u=Lt;try{return Lt=s,i()}finally{Lt=u}},ze=function(s,i,u){switch(i){case"input":if(de(s,u),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<u.length;i++){var m=u[i];if(m!==s&&m.form===s.form){var v=oc(m);if(!v)throw Error(t(90));F(m),de(m,v)}}}break;case"textarea":wt(s,u);break;case"select":i=u.value,i!=null&&Qe(s,!!u.multiple,i,!1)}},wr=A0,nt=Hs;var t2={usingClientEntryPoint:!1,Events:[ji,No,oc,It,Yt,A0]},qi={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},r2={bundleType:qi.bundleType,version:qi.version,rendererPackageName:qi.rendererPackageName,rendererConfig:qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:B.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=ke(s),s===null?null:s.stateNode},findFiberByHostInstance:qi.findFiberByHostInstance||Jk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{la=$c.inject(r2),Cr=$c}catch{}}return xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t2,xn.createPortal=function(s,i){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B0(i))throw Error(t(200));return Zk(s,i,null,u)},xn.createRoot=function(s,i){if(!B0(s))throw Error(t(299));var u=!1,m="",v=ux;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=j0(s,1,!1,null,null,u,!1,m,v),s[Fa]=i.current,Ri(s.nodeType===8?s.parentNode:s),new z0(i)},xn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=ke(i),s=s===null?null:s.stateNode,s},xn.flushSync=function(s){return Hs(s)},xn.hydrate=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!0,u)},xn.hydrateRoot=function(s,i,u){if(!B0(s))throw Error(t(405));var m=u!=null&&u.hydratedSources||null,v=!1,b="",D=ux;if(u!=null&&(u.unstable_strictMode===!0&&(v=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onRecoverableError!==void 0&&(D=u.onRecoverableError)),i=lx(i,null,s,1,u??null,v,!1,b,D),s[Fa]=i.current,Ri(s),m)for(s=0;s<m.length;s++)u=m[s],v=u._getVersion,v=v(u._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[u,v]:i.mutableSourceEagerHydrationData.push(u,v);return new Wc(i)},xn.render=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!1,u)},xn.unmountComponentAtNode=function(s){if(!Uc(s))throw Error(t(40));return s._reactRootContainer?(Hs(function(){Hc(null,null,s,!1,function(){s._reactRootContainer=null,s[Fa]=null})}),!0):!1},xn.unstable_batchedUpdates=A0,xn.unstable_renderSubtreeIntoContainer=function(s,i,u,m){if(!Uc(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Hc(s,i,u,!1,m)},xn.version="18.3.1-next-f1338f8080-20240426",xn}var yx;function Xd(){if(yx)return H0.exports;yx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),H0.exports=f2(),H0.exports}var wx;function d2(){if(wx)return Yc;wx=1;var e=Xd();return Yc.createRoot=e.createRoot,Yc.hydrateRoot=e.hydrateRoot,Yc}var p2=d2();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var h2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ia=(e,n)=>{const t=A.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...p},d)=>A.createElement("svg",{ref:d,...h2,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${m2(e)}`,c].join(" "),...p},[...n.map(([x,g])=>A.createElement(x,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=ia("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=ia("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=ia("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=ia("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=ia("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=ia("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=ia("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=ia("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=ia("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=ia("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=ia("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Vc={exports:{}},xs={},V0={exports:{}},K0,kx;function y2(){if(kx)return K0;kx=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K0=e,K0}var G0,_x;function w2(){if(_x)return G0;_x=1;var e=y2();function n(){}function t(){}return t.resetWarningCache=n,G0=function(){function r(l,c,f,p,d,x){if(x!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},G0}var bx;function Iv(){return bx||(bx=1,V0.exports=w2()()),V0.exports}var Kc={exports:{}},Rn={},Gc={exports:{}},Ex;function jv(){return Ex||(Ex=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=d;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(x,g){return g.getPropertyValue("overflow")!=="visible"||x.scrollWidth<=0&&x.scrollHeight<=0}function l(x){var g=x.offsetWidth<=0&&x.offsetHeight<=0;if(g&&!x.innerHTML)return!0;try{var y=window.getComputedStyle(x),k=y.getPropertyValue("display");return g?k!==r&&o(x,y):k===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(x){for(var g=x,y=x.getRootNode&&x.getRootNode();g&&g!==document.body;){if(y&&g===y&&(g=y.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(x,g){var y=x.nodeName.toLowerCase(),k=a.test(y)&&!x.disabled||y==="a"&&x.href||g;return k&&c(x)}function p(x){var g=x.getAttribute("tabindex");g===null&&(g=void 0);var y=isNaN(g);return(y||g>=0)&&f(x,!y)}function d(x){var g=[].slice.call(x.querySelectorAll("*"),0).reduce(function(y,k){return y.concat(k.shadowRoot?d(k.shadowRoot):[k])},[]);return g.filter(p)}e.exports=n.default})(Gc,Gc.exports)),Gc.exports}var Sx;function k2(){if(Sx)return Rn;Sx=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.resetState=l,Rn.log=c,Rn.handleBlur=f,Rn.handleFocus=p,Rn.markForFocusLater=d,Rn.returnFocus=x,Rn.popWithoutFocus=g,Rn.setupScopedFocus=y,Rn.teardownScopedFocus=k;var e=jv(),n=t(e);function t(w){return w&&w.__esModule?w:{default:w}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function p(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var w=(0,n.default)(a)[0]||a;w.focus()}},0)}}function d(){r.push(document.activeElement)}function x(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=null;try{r.length!==0&&(_=r.pop(),_.focus({preventScroll:w}));return}catch{console.warn(["You tried to return focus to",_,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function y(w){a=w,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",p,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",p))}function k(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",p)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",p))}return Rn}var Xc={exports:{}},Tx;function _2(){return Tx||(Tx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=jv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var p=(0,r.default)(c);if(!p.length){f.preventDefault();return}var d=void 0,x=f.shiftKey,g=p[0],y=p[p.length-1],k=o();if(c===k){if(!x)return;d=y}if(y===k&&!x&&(d=g),g===k&&x&&(d=y),d){f.preventDefault(),d.focus();return}var w=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),_=w!=null&&w[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(_){var S=p.indexOf(k);if(S>-1&&(S+=x?-1:1),d=p[S],typeof d>"u"){f.preventDefault(),d=x?y:g,d.focus();return}f.preventDefault(),d.focus()}}e.exports=n.default})(Xc,Xc.exports)),Xc.exports}var qn={},X0,Cx;function b2(){if(Cx)return X0;Cx=1;var e=function(){};return X0=e,X0}var pa={},Q0={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Dx;function E2(){return Dx||(Dx=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(Q0)),Q0.exports}var Nx;function ep(){if(Nx)return pa;Nx=1,Object.defineProperty(pa,"__esModule",{value:!0}),pa.canUseDOM=pa.SafeNodeList=pa.SafeHTMLCollection=void 0;var e=E2(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return pa.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},pa.SafeNodeList=r.canUseDOM?window.NodeList:{},pa.canUseDOM=r.canUseDOM,pa.default=a,pa}var Fx;function Lv(){if(Fx)return qn;Fx=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.resetState=o,qn.log=l,qn.assertNodeList=c,qn.setElement=f,qn.validateElement=p,qn.hide=d,qn.show=x,qn.documentNotReadyOrSSRTesting=g;var e=b2(),n=r(e),t=ep();function r(y){return y&&y.__esModule?y:{default:y}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(y){return y.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(y){return y.removeAttribute("aria-hidden")})),a=null}function l(){}function c(y,k){if(!y||!y.length)throw new Error("react-modal: No elements were found for selector "+k+".")}function f(y){var k=y;if(typeof k=="string"&&t.canUseDOM){var w=document.querySelectorAll(k);c(w,k),k=w}return a=k||a,a}function p(y){var k=y||a;return k?Array.isArray(k)||k instanceof HTMLCollection||k instanceof NodeList?k:[k]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function d(y){var k=!0,w=!1,_=void 0;try{for(var S=p(y)[Symbol.iterator](),O;!(k=(O=S.next()).done);k=!0){var T=O.value;T.setAttribute("aria-hidden","true")}}catch(B){w=!0,_=B}finally{try{!k&&S.return&&S.return()}finally{if(w)throw _}}}function x(y){var k=!0,w=!1,_=void 0;try{for(var S=p(y)[Symbol.iterator](),O;!(k=(O=S.next()).done);k=!0){var T=O.value;T.removeAttribute("aria-hidden")}}catch(B){w=!0,_=B}finally{try{!k&&S.return&&S.return()}finally{if(w)throw _}}}function g(){a=null}return qn}var Ks={},Ax;function S2(){if(Ax)return Ks;Ax=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.resetState=r,Ks.log=a;var e={},n={};function t(p,d){p.classList.remove(d)}function r(){var p=document.getElementsByTagName("html")[0];for(var d in e)t(p,e[d]);var x=document.body;for(var g in n)t(x,n[g]);e={},n={}}function a(){}var o=function(d,x){return d[x]||(d[x]=0),d[x]+=1,x},l=function(d,x){return d[x]&&(d[x]-=1),x},c=function(d,x,g){g.forEach(function(y){o(x,y),d.add(y)})},f=function(d,x,g){g.forEach(function(y){l(x,y),x[y]===0&&d.remove(y)})};return Ks.add=function(d,x){return c(d.classList,d.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks.remove=function(d,x){return f(d.classList,d.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks}var $o={},Ox;function zv(){if(Ox)return $o;Ox=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.log=r,$o.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return $o.default=t,$o}var Ji={},Px;function T2(){if(Px)return Ji;Px=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.resetState=l,Ji.log=c;var e=zv(),n=t(e);function t(d){return d&&d.__esModule?d:{default:d}}var r=void 0,a=void 0,o=[];function l(){for(var d=[r,a],x=0;x<d.length;x++){var g=d[x];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var d=[r,a],x=0;x<d.length;x++){var g=d[x],y=g||{};console.log(y.nodeName,y.className,y.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function p(d,x){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=x,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(p),Ji}var Rx;function C2(){return Rx||(Rx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(le){for(var re=1;re<arguments.length;re++){var he=arguments[re];for(var K in he)Object.prototype.hasOwnProperty.call(he,K)&&(le[K]=he[K])}return le},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(le){return typeof le}:function(le){return le&&typeof Symbol=="function"&&le.constructor===Symbol&&le!==Symbol.prototype?"symbol":typeof le},a=(function(){function le(re,he){for(var K=0;K<he.length;K++){var se=he[K];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(re,se.key,se)}}return function(re,he,K){return he&&le(re.prototype,he),K&&le(re,K),re}})(),o=Nl(),l=Iv(),c=J(l),f=k2(),p=B(f),d=_2(),x=J(d),g=Lv(),y=B(g),k=S2(),w=B(k),_=ep(),S=J(_),O=zv(),T=J(O);T2();function B(le){if(le&&le.__esModule)return le;var re={};if(le!=null)for(var he in le)Object.prototype.hasOwnProperty.call(le,he)&&(re[he]=le[he]);return re.default=le,re}function J(le){return le&&le.__esModule?le:{default:le}}function I(le,re){if(!(le instanceof re))throw new TypeError("Cannot call a class as a function")}function C(le,re){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re&&(typeof re=="object"||typeof re=="function")?re:le}function Z(le,re){if(typeof re!="function"&&re!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof re);le.prototype=Object.create(re&&re.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),re&&(Object.setPrototypeOf?Object.setPrototypeOf(le,re):le.__proto__=re)}var L={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},ne=function(re){return re.code==="Tab"||re.keyCode===9},X=function(re){return re.code==="Escape"||re.keyCode===27},W=0,ue=(function(le){Z(re,le);function re(he){I(this,re);var K=C(this,(re.__proto__||Object.getPrototypeOf(re)).call(this,he));return K.setOverlayRef=function(se){K.overlay=se,K.props.overlayRef&&K.props.overlayRef(se)},K.setContentRef=function(se){K.content=se,K.props.contentRef&&K.props.contentRef(se)},K.afterClose=function(){var se=K.props,R=se.appElement,Y=se.ariaHideApp,P=se.htmlOpenClassName,E=se.bodyOpenClassName,j=se.parentSelector,M=j&&j().ownerDocument||document;E&&w.remove(M.body,E),P&&w.remove(M.getElementsByTagName("html")[0],P),Y&&W>0&&(W-=1,W===0&&y.show(R)),K.props.shouldFocusAfterRender&&(K.props.shouldReturnFocusAfterClose?(p.returnFocus(K.props.preventScroll),p.teardownScopedFocus()):p.popWithoutFocus()),K.props.onAfterClose&&K.props.onAfterClose(),T.default.deregister(K)},K.open=function(){K.beforeOpen(),K.state.afterOpen&&K.state.beforeClose?(clearTimeout(K.closeTimer),K.setState({beforeClose:!1})):(K.props.shouldFocusAfterRender&&(p.setupScopedFocus(K.node),p.markForFocusLater()),K.setState({isOpen:!0},function(){K.openAnimationFrame=requestAnimationFrame(function(){K.setState({afterOpen:!0}),K.props.isOpen&&K.props.onAfterOpen&&K.props.onAfterOpen({overlayEl:K.overlay,contentEl:K.content})})}))},K.close=function(){K.props.closeTimeoutMS>0?K.closeWithTimeout():K.closeWithoutTimeout()},K.focusContent=function(){return K.content&&!K.contentHasFocus()&&K.content.focus({preventScroll:!0})},K.closeWithTimeout=function(){var se=Date.now()+K.props.closeTimeoutMS;K.setState({beforeClose:!0,closesAt:se},function(){K.closeTimer=setTimeout(K.closeWithoutTimeout,K.state.closesAt-Date.now())})},K.closeWithoutTimeout=function(){K.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},K.afterClose)},K.handleKeyDown=function(se){ne(se)&&(0,x.default)(K.content,se),K.props.shouldCloseOnEsc&&X(se)&&(se.stopPropagation(),K.requestClose(se))},K.handleOverlayOnClick=function(se){K.shouldClose===null&&(K.shouldClose=!0),K.shouldClose&&K.props.shouldCloseOnOverlayClick&&(K.ownerHandlesClose()?K.requestClose(se):K.focusContent()),K.shouldClose=null},K.handleContentOnMouseUp=function(){K.shouldClose=!1},K.handleOverlayOnMouseDown=function(se){!K.props.shouldCloseOnOverlayClick&&se.target==K.overlay&&se.preventDefault()},K.handleContentOnClick=function(){K.shouldClose=!1},K.handleContentOnMouseDown=function(){K.shouldClose=!1},K.requestClose=function(se){return K.ownerHandlesClose()&&K.props.onRequestClose(se)},K.ownerHandlesClose=function(){return K.props.onRequestClose},K.shouldBeClosed=function(){return!K.state.isOpen&&!K.state.beforeClose},K.contentHasFocus=function(){return document.activeElement===K.content||K.content.contains(document.activeElement)},K.buildClassName=function(se,R){var Y=(typeof R>"u"?"undefined":r(R))==="object"?R:{base:L[se],afterOpen:L[se]+"--after-open",beforeClose:L[se]+"--before-close"},P=Y.base;return K.state.afterOpen&&(P=P+" "+Y.afterOpen),K.state.beforeClose&&(P=P+" "+Y.beforeClose),typeof R=="string"&&R?P+" "+R:P},K.attributesFromObject=function(se,R){return Object.keys(R).reduce(function(Y,P){return Y[se+"-"+P]=R[P],Y},{})},K.state={afterOpen:!1,beforeClose:!1},K.shouldClose=null,K.moveFromContentToOverlay=null,K}return a(re,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(K,se){this.props.isOpen&&!K.isOpen?this.open():!this.props.isOpen&&K.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!se.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var K=this.props,se=K.appElement,R=K.ariaHideApp,Y=K.htmlOpenClassName,P=K.bodyOpenClassName,E=K.parentSelector,j=E&&E().ownerDocument||document;P&&w.add(j.body,P),Y&&w.add(j.getElementsByTagName("html")[0],Y),R&&(W+=1,y.hide(se)),T.default.register(this)}},{key:"render",value:function(){var K=this.props,se=K.id,R=K.className,Y=K.overlayClassName,P=K.defaultStyles,E=K.children,j=R?{}:P.content,M=Y?{}:P.overlay;if(this.shouldBeClosed())return null;var U={ref:this.setOverlayRef,className:this.buildClassName("overlay",Y),style:t({},M,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},oe=t({id:se,ref:this.setContentRef,style:t({},j,this.props.style.content),className:this.buildClassName("content",R),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),pe=this.props.contentElement(oe,E);return this.props.overlayElement(U,pe)}}]),re})(o.Component);ue.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},ue.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(S.default),c.default.instanceOf(_.SafeHTMLCollection),c.default.instanceOf(_.SafeNodeList),c.default.arrayOf(c.default.instanceOf(S.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=ue,e.exports=n.default})(Kc,Kc.exports)),Kc.exports}function Bv(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Wv(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function Uv(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}Bv.__suppressDeprecationWarning=!0;Wv.__suppressDeprecationWarning=!0;Uv.__suppressDeprecationWarning=!0;function D2(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=Bv,n.componentWillReceiveProps=Wv),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=Uv;var c=n.componentDidUpdate;n.componentDidUpdate=function(p,d,x){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:x;c.call(this,p,d,g)}}return e}const N2=Object.freeze(Object.defineProperty({__proto__:null,polyfill:D2},Symbol.toStringTag,{value:"Module"})),F2=s2(N2);var Mx;function A2(){if(Mx)return xs;Mx=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.bodyOpenClassName=xs.portalClassName=void 0;var e=Object.assign||function(X){for(var W=1;W<arguments.length;W++){var ue=arguments[W];for(var le in ue)Object.prototype.hasOwnProperty.call(ue,le)&&(X[le]=ue[le])}return X},n=(function(){function X(W,ue){for(var le=0;le<ue.length;le++){var re=ue[le];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(W,re.key,re)}}return function(W,ue,le){return ue&&X(W.prototype,ue),le&&X(W,le),W}})(),t=Nl(),r=_(t),a=Xd(),o=_(a),l=Iv(),c=_(l),f=C2(),p=_(f),d=Lv(),x=w(d),g=ep(),y=_(g),k=F2;function w(X){if(X&&X.__esModule)return X;var W={};if(X!=null)for(var ue in X)Object.prototype.hasOwnProperty.call(X,ue)&&(W[ue]=X[ue]);return W.default=X,W}function _(X){return X&&X.__esModule?X:{default:X}}function S(X,W){if(!(X instanceof W))throw new TypeError("Cannot call a class as a function")}function O(X,W){if(!X)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return W&&(typeof W=="object"||typeof W=="function")?W:X}function T(X,W){if(typeof W!="function"&&W!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof W);X.prototype=Object.create(W&&W.prototype,{constructor:{value:X,enumerable:!1,writable:!0,configurable:!0}}),W&&(Object.setPrototypeOf?Object.setPrototypeOf(X,W):X.__proto__=W)}var B=xs.portalClassName="ReactModalPortal",J=xs.bodyOpenClassName="ReactModal__Body--open",I=g.canUseDOM&&o.default.createPortal!==void 0,C=function(W){return document.createElement(W)},Z=function(){return I?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function L(X){return X()}var ne=(function(X){T(W,X);function W(){var ue,le,re,he;S(this,W);for(var K=arguments.length,se=Array(K),R=0;R<K;R++)se[R]=arguments[R];return he=(le=(re=O(this,(ue=W.__proto__||Object.getPrototypeOf(W)).call.apply(ue,[this].concat(se))),re),re.removePortal=function(){!I&&o.default.unmountComponentAtNode(re.node);var Y=L(re.props.parentSelector);Y&&Y.contains(re.node)?Y.removeChild(re.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},re.portalRef=function(Y){re.portal=Y},re.renderPortal=function(Y){var P=Z(),E=P(re,r.default.createElement(p.default,e({defaultStyles:W.defaultStyles},Y)),re.node);re.portalRef(E)},le),O(re,he)}return n(W,[{key:"componentDidMount",value:function(){if(g.canUseDOM){I||(this.node=C("div")),this.node.className=this.props.portalClassName;var le=L(this.props.parentSelector);le.appendChild(this.node),!I&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(le){var re=L(le.parentSelector),he=L(this.props.parentSelector);return{prevParent:re,nextParent:he}}},{key:"componentDidUpdate",value:function(le,re,he){if(g.canUseDOM){var K=this.props,se=K.isOpen,R=K.portalClassName;le.portalClassName!==R&&(this.node.className=R);var Y=he.prevParent,P=he.nextParent;P!==Y&&(Y.removeChild(this.node),P.appendChild(this.node)),!(!le.isOpen&&!se)&&!I&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var le=this.portal.state,re=Date.now(),he=le.isOpen&&this.props.closeTimeoutMS&&(le.closesAt||re+this.props.closeTimeoutMS);he?(le.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,he-re)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!I)return null;!this.node&&I&&(this.node=C("div"));var le=Z();return le(r.default.createElement(p.default,e({ref:this.portalRef,defaultStyles:W.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(le){x.setElement(le)}}]),W})(t.Component);return ne.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(y.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(y.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},ne.defaultProps={isOpen:!1,portalClassName:B,bodyOpenClassName:J,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(W,ue){return r.default.createElement("div",W,ue)},contentElement:function(W,ue){return r.default.createElement("div",W,ue)}},ne.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,k.polyfill)(ne),xs.default=ne,xs}var Ix;function O2(){return Ix||(Ix=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=A2(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Vc,Vc.exports)),Vc.exports}var P2=O2();const Pr=Vu(P2);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Hv=1252,R2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],tp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rp=function(e){R2.indexOf(e)!=-1&&(Hv=tp[0]=e)};function M2(){rp(1252)}var ta=function(e){rp(e)};function $v(){ta(1200),M2()}function jx(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function I2(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Yv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var rl=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?I2(e.slice(2)):n==254&&t==255?Yv(e.slice(2)):n==65279?e.slice(1):e},Qc=function(n){return String.fromCharCode(n)},Lx=function(n){return String.fromCharCode(n)},vl,ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zx(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,p=0;p<e.length;)t=e.charCodeAt(p++),o=t>>2,r=e.charCodeAt(p++),l=(t&3)<<4|r>>4,a=e.charCodeAt(p++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=ks.charAt(o)+ks.charAt(l)+ks.charAt(c)+ks.charAt(f);return n}function Tn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<e.length;)o=ks.indexOf(e.charAt(p++)),l=ks.indexOf(e.charAt(p++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=ks.indexOf(e.charAt(p++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=ks.indexOf(e.charAt(p++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var yt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ho=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Cs(e){return yt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Bx(e){return yt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ea=function(n){return yt?ho(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function mo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function np(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return np(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var ys=yt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ho(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function j2(e){for(var n=[],t=0,r=e.length+250,a=Cs(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=Cs(65535),r=65530)}return n.push(a.slice(0,t)),ys(n)}var cn=/\u0000/g,nl=/[\u0001-\u0006]/g;function qo(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function ra(e,n){var t=""+e;return t.length>=n?t:ir("0",n-t.length)+t}function ap(e,n){var t=""+e;return t.length>=n?t:ir(" ",n-t.length)+t}function wu(e,n){var t=""+e;return t.length>=n?t:t+ir(" ",n-t.length)}function L2(e,n){var t=""+Math.round(e);return t.length>=n?t:ir("0",n-t.length)+t}function z2(e,n){var t=""+e;return t.length>=n?t:ir("0",n-t.length)+t}var Wx=Math.pow(2,32);function Yo(e,n){if(e>Wx||e<-Wx)return L2(e,n);var t=Math.round(e);return z2(t,n)}function ku(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Ux=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],q0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function B2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var pt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Hx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},W2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _u(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,p=0,d=0,x=Math.floor(a);p<n&&(x=Math.floor(a),c=x*l+o,d=x*p+f,!(a-x<5e-8));)a=1/(a-x),o=l,l=c,f=p,p=d;if(d>n&&(p>n?(d=f,c=o):(d=p,c=l)),!t)return[0,r*c,d];var g=Math.floor(r*c/d);return[g,r*c-g*d,d]}function Qs(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=K2(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var Vv=new Date(1899,11,31,0,0,0),U2=Vv.getTime(),H2=new Date(1900,2,1,0,0,0);function Kv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=H2&&(t+=1440*60*1e3),(t-(U2+(e.getTimezoneOffset()-Vv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function sp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Y2(e){var n=e<0?12:11,t=sp(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function V2(e){var n=sp(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function yl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=Y2(e):n===10?t=e.toFixed(10).substr(0,12):t=V2(e),sp($2(t.toUpperCase()))}function oo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,Kv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function K2(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function G2(e,n,t,r){var a="",o=0,l=0,c=t.y,f,p=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,p=2;break;default:f=c%1e4,p=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,p=n.length;break;case 3:return q0[t.m-1][1];case 5:return q0[t.m-1][0];default:return q0[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,p=n.length;break;case 3:return Ux[t.q][0];default:return Ux[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,p=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,p=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,p=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?ra(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=ra(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}p=n.length===3?1:2;break;case 101:f=c,p=1;break}var d=p>0?ra(f,p):"";return d}function _s(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Gv=/%/g;function X2(e,n,t){var r=n.replace(Gv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+ir("%",a)}function Q2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Xv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Xv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,p,d){return f+p+d.substr(0,(a+o)%a)+"."+d.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Qv=/# (\?+)( ?)\/( ?)(\d+)/;function q2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?ir(" ",e[1].length+1+e[4].length):ap(l,e[1].length)+e[2]+"/"+e[3]+ra(c,e[4].length))}function Z2(e,n,t){return t+(n===0?"":""+n)+ir(" ",e[1].length+2+e[4].length)}var qv=/^#*0*\.([0#]+)/,Zv=/\).*[0#]/,Jv=/\(###\) ###\\?-####/;function tn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function $x(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Yx(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function J2(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function e_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function jn(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Zv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?jn("n",r,t):"("+jn("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return Q2(e,n,t);if(n.indexOf("%")!==-1)return X2(e,n,t);if(n.indexOf("E")!==-1)return Xv(n,t);if(n.charCodeAt(0)===36)return"$"+jn(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),p=t<0?"-":"";if(n.match(/^00+$/))return p+Yo(f,n.length);if(n.match(/^[#?]+$/))return a=Yo(t,0),a==="0"&&(a=""),a.length>n.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(Qv))return q2(o,f,p);if(n.match(/^#+0+$/))return p+Yo(f,n.length-n.indexOf("0"));if(o=n.match(qv))return a=$x(t,o[1].length).replace(/^([^\.]+)$/,"$1."+tn(o[1])).replace(/\.$/,"."+tn(o[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+ir("0",tn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return p+$x(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return p+_s(Yo(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+jn(e,n,-t):_s(""+(Math.floor(t)+J2(t,o[1].length)))+"."+ra(Yx(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return jn(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(jn(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(Jv))return a=jn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=_u(f,Math.pow(10,l)-1,!1),a=""+p,d=Ba("n",o[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+o[2]+"/"+o[3],d=wu(c[2],l),d.length<o[4].length&&(d=tn(o[4].substr(o[4].length-d.length))+d),a+=d,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=_u(f,Math.pow(10,l)-1,!0),p+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ap(c[1],l)+o[2]+"/"+o[3]+wu(c[2],l):ir(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=Yo(t,0),n.length<=a.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return tn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Yx(t,o[1].length),t<0?"-"+jn(e,n,-t):_s(e_(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(l,o[1].length);switch(n){case"###,##0.00":return jn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=_s(Yo(f,0));return y!=="0"?p+y:"";case"###,###.00":return jn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return jn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function t_(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function r_(e,n,t){var r=n.replace(Gv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+ir("%",a)}function e1(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+e1(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,p,d){return f+p+d.substr(0,(a+o)%a)+"."+d.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ma(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Zv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ma("n",r,t):"("+ma("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return t_(e,n,t);if(n.indexOf("%")!==-1)return r_(e,n,t);if(n.indexOf("E")!==-1)return e1(n,t);if(n.charCodeAt(0)===36)return"$"+ma(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),p=t<0?"-":"";if(n.match(/^00+$/))return p+ra(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(Qv))return Z2(o,f,p);if(n.match(/^#+0+$/))return p+ra(f,n.length-n.indexOf("0"));if(o=n.match(qv))return a=(""+t).replace(/^([^\.]+)$/,"$1."+tn(o[1])).replace(/\.$/,"."+tn(o[1])),a=a.replace(/\.(\d*)$/,function(k,w){return"."+w+ir("0",tn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return p+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return p+_s(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):_s(""+t)+"."+ir("0",o[1].length);if(o=n.match(/^#,#*,#0/))return ma(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(ma(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(Jv))return a=ma(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=_u(f,Math.pow(10,l)-1,!1),a=""+p,d=Ba("n",o[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+o[2]+"/"+o[3],d=wu(c[2],l),d.length<o[4].length&&(d=tn(o[4].substr(o[4].length-d.length))+d),a+=d,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=_u(f,Math.pow(10,l)-1,!0),p+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ap(c[1],l)+o[2]+"/"+o[3]+wu(c[2],l):ir(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return tn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):_s(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var y=_s(""+f);return y!=="0"?p+y:"";default:if(n.match(/\.[0#?]*$/))return ma(e,n.slice(0,n.lastIndexOf(".")),t)+tn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Ba(e,n,t){return(t|0)===t?ma(e,n,t):jn(e,n,t)}function n_(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var t1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function di(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":ku(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="上午/下午")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(t1))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function a_(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",p,d,x,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!ku(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(x=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(x);a[a.length]={t:"t",v:o},++l;break;case"\\":var y=e.charAt(++l),k=y==="("||y===")"?y:"t";a[a.length]={t:k,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(p==null&&(p=Qs(n,t,e.charAt(l+1)==="2"),p==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||p==null&&(p=Qs(n,t),p==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"上":var w={t:c,v:c};if(p==null&&(p=Qs(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(p!=null&&(w.v=p.H>=12?"P":"A"),w.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(p!=null&&(w.v=p.H>=12?"PM":"AM"),w.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(p!=null&&(w.v=p.H>=12?"下午":"上午"),w.t="T",l+=5,g="h"):(w.t="t",++l),p==null&&w.t==="T")return"";a[a.length]=w,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(t1)){if(p==null&&(p=Qs(n,t),p==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",di(e)||(a[a.length]={t:"t",v:o}));break;case".":if(p!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var _=0,S=0,O;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",_<1&&(_=1);break;case"s":(O=a[l].v.match(/\.0+$/))&&(S=Math.max(S,O[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var T="",B;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=G2(a[l].t.charCodeAt(0),a[l].v,p,S),a[l].t="t";break;case"n":case"?":for(B=l+1;a[B]!=null&&((c=a[B].t)==="?"||c==="D"||(c===" "||c==="t")&&a[B+1]!=null&&(a[B+1].t==="?"||a[B+1].t==="t"&&a[B+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[B].v==="/"||a[B].v===" "&&a[B+1]!=null&&a[B+1].t=="?"));)a[l].v+=a[B].v,a[B]={v:"",t:";"},++B;T+=a[l].v,l=B-1;break;case"G":a[l].t="t",a[l].v=oo(n,t);break}var J="",I,C;if(T.length>0){T.charCodeAt(0)==40?(I=n<0&&T.charCodeAt(0)===45?-n:n,C=Ba("n",T,I)):(I=n<0&&r>1?-n:n,C=Ba("n",T,I),I<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),B=C.length-1;var Z=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){Z=l;break}var L=a.length;if(Z===a.length&&C.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(B>=a[l].v.length-1?(B-=a[l].v.length,a[l].v=C.substr(B+1,a[l].v.length)):B<0?a[l].v="":(a[l].v=C.substr(0,B+1),B=-1),a[l].t="t",L=l);B>=0&&L<a.length&&(a[L].v=C.substr(0,B+1)+a[L].v)}else if(Z!==a.length&&C.indexOf("E")===-1){for(B=C.indexOf(".")-1,l=Z;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(d=a[l].v.indexOf(".")>-1&&l===Z?a[l].v.indexOf(".")-1:a[l].v.length-1,J=a[l].v.substr(d+1);d>=0;--d)B>=0&&(a[l].v.charAt(d)==="0"||a[l].v.charAt(d)==="#")&&(J=C.charAt(B--)+J);a[l].v=J,a[l].t="t",L=l}for(B>=0&&L<a.length&&(a[L].v=C.substr(0,B+1)+a[L].v),B=C.indexOf(".")+1,l=Z;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==Z)){for(d=a[l].v.indexOf(".")>-1&&l===Z?a[l].v.indexOf(".")+1:0,J=a[l].v.substr(0,d);d<a[l].v.length;++d)B<C.length&&(J+=C.charAt(B++));a[l].v=J,a[l].t="t",L=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(I=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=Ba(a[l].t,a[l].v,I),a[l].t="t");var ne="";for(l=0;l!==a.length;++l)a[l]!=null&&(ne+=a[l].v);return ne}var Vx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Kx(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function s_(e,n){var t=n_(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Vx),c=t[1].match(Vx);return Kx(n,l)?[r,t[0]]:Kx(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Un(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:pt)[e],r==null&&(r=t.table&&t.table[Hx[e]]||pt[Hx[e]]),r==null&&(r=W2[e]||"General");break}if(ku(r,0))return oo(n,t);n instanceof Date&&(n=Kv(n,t.date1904));var a=s_(r,n);if(ku(a[1]))return oo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return a_(a[1],n,t,a[0])}function eo(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(pt[t]==null){n<0&&(n=t);continue}if(pt[t]==e){n=t;break}}n<0&&(n=391)}return pt[n]=e,n}function r1(){pt=B2()}var o_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function i_(e){var n=typeof e=="number"?pt[e]:e;return n=n.replace(n1,"(\\d+)"),new RegExp("^"+n+"$")}function l_(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(n1)||[]).forEach(function(x,g){var y=parseInt(t[g+1],10);switch(x.toLowerCase().charAt(0)){case"y":r=y;break;case"d":o=y;break;case"h":l=y;break;case"s":f=y;break;case"m":l>=0?c=y:a=y;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var p=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?p:r==-1&&a==-1&&o==-1?d:p+"T"+d}var c_=(function(){var e={};e.version="1.2.0";function n(){for(var C=0,Z=new Array(256),L=0;L!=256;++L)C=L,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,Z[L]=C;return typeof Int32Array<"u"?new Int32Array(Z):Z}var t=n();function r(C){var Z=0,L=0,ne=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)X[ne]=C[ne];for(ne=0;ne!=256;++ne)for(L=C[ne],Z=256+ne;Z<4096;Z+=256)L=X[Z]=L>>>8^C[L&255];var W=[];for(ne=1;ne!=16;++ne)W[ne-1]=typeof Int32Array<"u"?X.subarray(ne*256,ne*256+256):X.slice(ne*256,ne*256+256);return W}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],p=a[4],d=a[5],x=a[6],g=a[7],y=a[8],k=a[9],w=a[10],_=a[11],S=a[12],O=a[13],T=a[14];function B(C,Z){for(var L=Z^-1,ne=0,X=C.length;ne<X;)L=L>>>8^t[(L^C.charCodeAt(ne++))&255];return~L}function J(C,Z){for(var L=Z^-1,ne=C.length-15,X=0;X<ne;)L=T[C[X++]^L&255]^O[C[X++]^L>>8&255]^S[C[X++]^L>>16&255]^_[C[X++]^L>>>24]^w[C[X++]]^k[C[X++]]^y[C[X++]]^g[C[X++]]^x[C[X++]]^d[C[X++]]^p[C[X++]]^f[C[X++]]^c[C[X++]]^l[C[X++]]^o[C[X++]]^t[C[X++]];for(ne+=15;X<ne;)L=L>>>8^t[(L^C[X++])&255];return~L}function I(C,Z){for(var L=Z^-1,ne=0,X=C.length,W=0,ue=0;ne<X;)W=C.charCodeAt(ne++),W<128?L=L>>>8^t[(L^W)&255]:W<2048?(L=L>>>8^t[(L^(192|W>>6&31))&255],L=L>>>8^t[(L^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,ue=C.charCodeAt(ne++)&1023,L=L>>>8^t[(L^(240|W>>8&7))&255],L=L>>>8^t[(L^(128|W>>2&63))&255],L=L>>>8^t[(L^(128|ue>>6&15|(W&3)<<4))&255],L=L>>>8^t[(L^(128|ue&63))&255]):(L=L>>>8^t[(L^(224|W>>12&15))&255],L=L>>>8^t[(L^(128|W>>6&63))&255],L=L>>>8^t[(L^(128|W&63))&255]);return~L}return e.table=t,e.bstr=B,e.buf=J,e.str=I,e})(),_t=(function(){var n={};n.version="1.2.1";function t(N,G){for(var z=N.split("/"),H=G.split("/"),V=0,Q=0,ye=Math.min(z.length,H.length);V<ye;++V){if(Q=z[V].length-H[V].length)return Q;if(z[V]!=H[V])return z[V]<H[V]?-1:1}return z.length-H.length}function r(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:r(N.slice(0,-1));var G=N.lastIndexOf("/");return G===-1?N:N.slice(0,G+1)}function a(N){if(N.charAt(N.length-1)=="/")return a(N.slice(0,-1));var G=N.lastIndexOf("/");return G===-1?N:N.slice(G+1)}function o(N,G){typeof G=="string"&&(G=new Date(G));var z=G.getHours();z=z<<6|G.getMinutes(),z=z<<5|G.getSeconds()>>>1,N.write_shift(2,z);var H=G.getFullYear()-1980;H=H<<4|G.getMonth()+1,H=H<<5|G.getDate(),N.write_shift(2,H)}function l(N){var G=N.read_shift(2)&65535,z=N.read_shift(2)&65535,H=new Date,V=z&31;z>>>=5;var Q=z&15;z>>>=4,H.setMilliseconds(0),H.setFullYear(z+1980),H.setMonth(Q-1),H.setDate(V);var ye=G&31;G>>>=5;var Te=G&63;return G>>>=6,H.setHours(G),H.setMinutes(Te),H.setSeconds(ye<<1),H}function c(N){jr(N,0);for(var G={},z=0;N.l<=N.length-4;){var H=N.read_shift(2),V=N.read_shift(2),Q=N.l+V,ye={};switch(H){case 21589:z=N.read_shift(1),z&1&&(ye.mtime=N.read_shift(4)),V>5&&(z&2&&(ye.atime=N.read_shift(4)),z&4&&(ye.ctime=N.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}N.l=Q,G[H]=ye}return G}var f;function p(){return f||(f={})}function d(N,G){if(N[0]==80&&N[1]==75)return ze(N,G);if((N[0]|32)==109&&(N[1]|32)==105)return Tr(N,G);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var z=3,H=512,V=0,Q=0,ye=0,Te=0,ve=0,ke=[],_e=N.slice(0,512);jr(_e,0);var Oe=x(_e);switch(z=Oe[0],z){case 3:H=512;break;case 4:H=4096;break;case 0:if(Oe[1]==0)return ze(N,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}H!==512&&(_e=N.slice(0,H),jr(_e,28));var We=N.slice(0,H);g(_e,z);var Pe=_e.read_shift(4,"i");if(z===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);_e.l+=4,ye=_e.read_shift(4,"i"),_e.l+=4,_e.chk("00100000","Mini Stream Cutoff Size: "),Te=_e.read_shift(4,"i"),V=_e.read_shift(4,"i"),ve=_e.read_shift(4,"i"),Q=_e.read_shift(4,"i");for(var Re=-1,Me=0;Me<109&&(Re=_e.read_shift(4,"i"),!(Re<0));++Me)ke[Me]=Re;var it=y(N,H);_(ve,Q,it,H,ke);var jt=O(it,ye,ke,H);jt[ye].name="!Directory",V>0&&Te!==ue&&(jt[Te].name="!MiniFAT"),jt[ke[0]].name="!FAT",jt.fat_addrs=ke,jt.ssz=H;var Pt={},ur=[],Rs=[],Qa=[];T(ye,jt,it,ur,V,Pt,Rs,Te),k(Rs,Qa,ur),ur.shift();var la={FileIndex:Rs,FullPaths:Qa};return G&&G.raw&&(la.raw={header:We,sectors:it}),la}function x(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(le,"Header Signature: "),N.l+=16;var G=N.read_shift(2,"u");return[N.read_shift(2,"u"),G]}function g(N,G){var z=9;switch(N.l+=2,z=N.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function y(N,G){for(var z=Math.ceil(N.length/G)-1,H=[],V=1;V<z;++V)H[V-1]=N.slice(V*G,(V+1)*G);return H[z-1]=N.slice(z*G),H}function k(N,G,z){for(var H=0,V=0,Q=0,ye=0,Te=0,ve=z.length,ke=[],_e=[];H<ve;++H)ke[H]=_e[H]=H,G[H]=z[H];for(;Te<_e.length;++Te)H=_e[Te],V=N[H].L,Q=N[H].R,ye=N[H].C,ke[H]===H&&(V!==-1&&ke[V]!==V&&(ke[H]=ke[V]),Q!==-1&&ke[Q]!==Q&&(ke[H]=ke[Q])),ye!==-1&&(ke[ye]=H),V!==-1&&H!=ke[H]&&(ke[V]=ke[H],_e.lastIndexOf(V)<Te&&_e.push(V)),Q!==-1&&H!=ke[H]&&(ke[Q]=ke[H],_e.lastIndexOf(Q)<Te&&_e.push(Q));for(H=1;H<ve;++H)ke[H]===H&&(Q!==-1&&ke[Q]!==Q?ke[H]=ke[Q]:V!==-1&&ke[V]!==V&&(ke[H]=ke[V]));for(H=1;H<ve;++H)if(N[H].type!==0){if(Te=H,Te!=ke[Te])do Te=ke[Te],G[H]=G[Te]+"/"+G[H];while(Te!==0&&ke[Te]!==-1&&Te!=ke[Te]);ke[H]=-1}for(G[0]+="/",H=1;H<ve;++H)N[H].type!==2&&(G[H]+="/")}function w(N,G,z){for(var H=N.start,V=N.size,Q=[],ye=H;z&&V>0&&ye>=0;)Q.push(G.slice(ye*W,ye*W+W)),V-=W,ye=Xs(z,ye*4);return Q.length===0?br(0):ys(Q).slice(0,N.size)}function _(N,G,z,H,V){var Q=ue;if(N===ue){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ye=z[N],Te=(H>>>2)-1;if(!ye)return;for(var ve=0;ve<Te&&(Q=Xs(ye,ve*4))!==ue;++ve)V.push(Q);_(Xs(ye,H-4),G-1,z,H,V)}}function S(N,G,z,H,V){var Q=[],ye=[];V||(V=[]);var Te=H-1,ve=0,ke=0;for(ve=G;ve>=0;){V[ve]=!0,Q[Q.length]=ve,ye.push(N[ve]);var _e=z[Math.floor(ve*4/H)];if(ke=ve*4&Te,H<4+ke)throw new Error("FAT boundary crossed: "+ve+" 4 "+H);if(!N[_e])break;ve=Xs(N[_e],ke)}return{nodes:Q,data:ng([ye])}}function O(N,G,z,H){var V=N.length,Q=[],ye=[],Te=[],ve=[],ke=H-1,_e=0,Oe=0,We=0,Pe=0;for(_e=0;_e<V;++_e)if(Te=[],We=_e+G,We>=V&&(We-=V),!ye[We]){ve=[];var Re=[];for(Oe=We;Oe>=0;){Re[Oe]=!0,ye[Oe]=!0,Te[Te.length]=Oe,ve.push(N[Oe]);var Me=z[Math.floor(Oe*4/H)];if(Pe=Oe*4&ke,H<4+Pe)throw new Error("FAT boundary crossed: "+Oe+" 4 "+H);if(!N[Me]||(Oe=Xs(N[Me],Pe),Re[Oe]))break}Q[We]={nodes:Te,data:ng([ve])}}return Q}function T(N,G,z,H,V,Q,ye,Te){for(var ve=0,ke=H.length?2:0,_e=G[N].data,Oe=0,We=0,Pe;Oe<_e.length;Oe+=128){var Re=_e.slice(Oe,Oe+128);jr(Re,64),We=Re.read_shift(2),Pe=up(Re,0,We-ke),H.push(Pe);var Me={name:Pe,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},it=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);it!==0&&(Me.ct=B(Re,Re.l-8));var jt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);jt!==0&&(Me.mt=B(Re,Re.l-8)),Me.start=Re.read_shift(4,"i"),Me.size=Re.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=ue,Me.name=""),Me.type===5?(ve=Me.start,V>0&&ve!==ue&&(G[ve].name="!StreamData")):Me.size>=4096?(Me.storage="fat",G[Me.start]===void 0&&(G[Me.start]=S(z,Me.start,G.fat_addrs,G.ssz)),G[Me.start].name=Me.name,Me.content=G[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:ve!==ue&&Me.start!==ue&&G[ve]&&(Me.content=w(Me,G[ve].data,(G[Te]||{}).data))),Me.content&&jr(Me.content,0),Q[Pe]=Me,ye.push(Me)}}function B(N,G){return new Date((bn(N,G+4)/1e7*Math.pow(2,32)+bn(N,G)/1e7-11644473600)*1e3)}function J(N,G){return p(),d(f.readFileSync(N),G)}function I(N,G){var z=G&&G.type;switch(z||yt&&Buffer.isBuffer(N)&&(z="buffer"),z||"base64"){case"file":return J(N,G);case"base64":return d(ea(Tn(N)),G);case"binary":return d(ea(N),G)}return d(N,G)}function C(N,G){var z=G||{},H=z.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=H+"/",N.FileIndex[0]={name:H,type:5}),z.CLSID&&(N.FileIndex[0].clsid=z.CLSID),Z(N)}function Z(N){var G="Sh33tJ5";if(!_t.find(N,"/"+G)){var z=br(4);z[0]=55,z[1]=z[3]=50,z[2]=54,N.FileIndex.push({name:G,type:2,content:z,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+G),L(N)}}function L(N,G){C(N);for(var z=!1,H=!1,V=N.FullPaths.length-1;V>=0;--V){var Q=N.FileIndex[V];switch(Q.type){case 0:H?z=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(Q.R*Q.L*Q.C)&&(z=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!G)){var ye=new Date(1987,1,19),Te=0,ve=Object.create?Object.create(null):{},ke=[];for(V=0;V<N.FullPaths.length;++V)ve[N.FullPaths[V]]=!0,N.FileIndex[V].type!==0&&ke.push([N.FullPaths[V],N.FileIndex[V]]);for(V=0;V<ke.length;++V){var _e=r(ke[V][0]);H=ve[_e],H||(ke.push([_e,{name:a(_e).replace("/",""),type:1,clsid:he,ct:ye,mt:ye,content:null}]),ve[_e]=!0)}for(ke.sort(function(Pe,Re){return t(Pe[0],Re[0])}),N.FullPaths=[],N.FileIndex=[],V=0;V<ke.length;++V)N.FullPaths[V]=ke[V][0],N.FileIndex[V]=ke[V][1];for(V=0;V<ke.length;++V){var Oe=N.FileIndex[V],We=N.FullPaths[V];if(Oe.name=a(We).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||he,V===0)Oe.C=ke.length>1?1:-1,Oe.size=0,Oe.type=5;else if(We.slice(-1)=="/"){for(Te=V+1;Te<ke.length&&r(N.FullPaths[Te])!=We;++Te);for(Oe.C=Te>=ke.length?-1:Te,Te=V+1;Te<ke.length&&r(N.FullPaths[Te])!=r(We);++Te);Oe.R=Te>=ke.length?-1:Te,Oe.type=1}else r(N.FullPaths[V+1]||"")==r(We)&&(Oe.R=V+1),Oe.type=2}}}function ne(N,G){var z=G||{};if(z.fileType=="mad")return Zr(N,z);switch(L(N),z.fileType){case"zip":return et(N,z)}var H=(function(Pe){for(var Re=0,Me=0,it=0;it<Pe.FileIndex.length;++it){var jt=Pe.FileIndex[it];if(jt.content){var Pt=jt.content.length;Pt>0&&(Pt<4096?Re+=Pt+63>>6:Me+=Pt+511>>9)}}for(var ur=Pe.FullPaths.length+3>>2,Rs=Re+7>>3,Qa=Re+127>>7,la=Rs+Me+ur+Qa,Cr=la+127>>7,vi=Cr<=109?0:Math.ceil((Cr-109)/127);la+Cr+vi+127>>7>Cr;)vi=++Cr<=109?0:Math.ceil((Cr-109)/127);var fr=[1,vi,Cr,Qa,ur,Me,Re,0];return Pe.FileIndex[0].size=Re<<6,fr[7]=(Pe.FileIndex[0].start=fr[0]+fr[1]+fr[2]+fr[3]+fr[4]+fr[5])+(fr[6]+7>>3),fr})(N),V=br(H[7]<<9),Q=0,ye=0;{for(Q=0;Q<8;++Q)V.write_shift(1,re[Q]);for(Q=0;Q<8;++Q)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),Q=0;Q<3;++Q)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,H[2]),V.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:ue),V.write_shift(4,H[3]),V.write_shift(-4,H[1]?H[0]-1:ue),V.write_shift(4,H[1]),Q=0;Q<109;++Q)V.write_shift(-4,Q<H[2]?H[1]+Q:-1)}if(H[1])for(ye=0;ye<H[1];++ye){for(;Q<236+ye*127;++Q)V.write_shift(-4,Q<H[2]?H[1]+Q:-1);V.write_shift(-4,ye===H[1]-1?ue:ye+1)}var Te=function(Pe){for(ye+=Pe;Q<ye-1;++Q)V.write_shift(-4,Q+1);Pe&&(++Q,V.write_shift(-4,ue))};for(ye=Q=0,ye+=H[1];Q<ye;++Q)V.write_shift(-4,K.DIFSECT);for(ye+=H[2];Q<ye;++Q)V.write_shift(-4,K.FATSECT);Te(H[3]),Te(H[4]);for(var ve=0,ke=0,_e=N.FileIndex[0];ve<N.FileIndex.length;++ve)_e=N.FileIndex[ve],_e.content&&(ke=_e.content.length,!(ke<4096)&&(_e.start=ye,Te(ke+511>>9)));for(Te(H[6]+7>>3);V.l&511;)V.write_shift(-4,K.ENDOFCHAIN);for(ye=Q=0,ve=0;ve<N.FileIndex.length;++ve)_e=N.FileIndex[ve],_e.content&&(ke=_e.content.length,!(!ke||ke>=4096)&&(_e.start=ye,Te(ke+63>>6)));for(;V.l&511;)V.write_shift(-4,K.ENDOFCHAIN);for(Q=0;Q<H[4]<<2;++Q){var Oe=N.FullPaths[Q];if(!Oe||Oe.length===0){for(ve=0;ve<17;++ve)V.write_shift(4,0);for(ve=0;ve<3;++ve)V.write_shift(4,-1);for(ve=0;ve<12;++ve)V.write_shift(4,0);continue}_e=N.FileIndex[Q],Q===0&&(_e.start=_e.size?_e.start-1:ue);var We=Q===0&&z.root||_e.name;if(ke=2*(We.length+1),V.write_shift(64,We,"utf16le"),V.write_shift(2,ke),V.write_shift(1,_e.type),V.write_shift(1,_e.color),V.write_shift(-4,_e.L),V.write_shift(-4,_e.R),V.write_shift(-4,_e.C),_e.clsid)V.write_shift(16,_e.clsid,"hex");else for(ve=0;ve<4;++ve)V.write_shift(4,0);V.write_shift(4,_e.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,_e.start),V.write_shift(4,_e.size),V.write_shift(4,0)}for(Q=1;Q<N.FileIndex.length;++Q)if(_e=N.FileIndex[Q],_e.size>=4096)if(V.l=_e.start+1<<9,yt&&Buffer.isBuffer(_e.content))_e.content.copy(V,V.l,0,_e.size),V.l+=_e.size+511&-512;else{for(ve=0;ve<_e.size;++ve)V.write_shift(1,_e.content[ve]);for(;ve&511;++ve)V.write_shift(1,0)}for(Q=1;Q<N.FileIndex.length;++Q)if(_e=N.FileIndex[Q],_e.size>0&&_e.size<4096)if(yt&&Buffer.isBuffer(_e.content))_e.content.copy(V,V.l,0,_e.size),V.l+=_e.size+63&-64;else{for(ve=0;ve<_e.size;++ve)V.write_shift(1,_e.content[ve]);for(;ve&63;++ve)V.write_shift(1,0)}if(yt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function X(N,G){var z=N.FullPaths.map(function(ve){return ve.toUpperCase()}),H=z.map(function(ve){var ke=ve.split("/");return ke[ke.length-(ve.slice(-1)=="/"?2:1)]}),V=!1;G.charCodeAt(0)===47?(V=!0,G=z[0].slice(0,-1)+G):V=G.indexOf("/")!==-1;var Q=G.toUpperCase(),ye=V===!0?z.indexOf(Q):H.indexOf(Q);if(ye!==-1)return N.FileIndex[ye];var Te=!Q.match(nl);for(Q=Q.replace(cn,""),Te&&(Q=Q.replace(nl,"!")),ye=0;ye<z.length;++ye)if((Te?z[ye].replace(nl,"!"):z[ye]).replace(cn,"")==Q||(Te?H[ye].replace(nl,"!"):H[ye]).replace(cn,"")==Q)return N.FileIndex[ye];return null}var W=64,ue=-2,le="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(N,G,z){p();var H=ne(N,z);f.writeFileSync(G,H)}function R(N){for(var G=new Array(N.length),z=0;z<N.length;++z)G[z]=String.fromCharCode(N[z]);return G.join("")}function Y(N,G){var z=ne(N,G);switch(G&&G.type||"buffer"){case"file":return p(),f.writeFileSync(G.filename,z),z;case"binary":return typeof z=="string"?z:R(z);case"base64":return zx(typeof z=="string"?z:R(z));case"buffer":if(yt)return Buffer.isBuffer(z)?z:ho(z);case"array":return typeof z=="string"?ea(z):z}return z}var P;function E(N){try{var G=N.InflateRaw,z=new G;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)P=N;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function j(N,G){if(!P)return xe(N,G);var z=P.InflateRaw,H=new z,V=H._processChunk(N.slice(N.l),H._finishFlushFlag);return N.l+=H.bytesRead,V}function M(N){return P?P.deflateRawSync(N):rt(N)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(N){var G=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(G>>16|G>>8|G)&255}for(var ie=typeof Uint8Array<"u",te=ie?new Uint8Array(256):[],ae=0;ae<256;++ae)te[ae]=me(ae);function F(N,G){var z=te[N&255];return G<=8?z>>>8-G:(z=z<<8|te[N>>8&255],G<=16?z>>>16-G:(z=z<<8|te[N>>16&255],z>>>24-G))}function Ce(N,G){var z=G&7,H=G>>>3;return(N[H]|(z<=6?0:N[H+1]<<8))>>>z&3}function De(N,G){var z=G&7,H=G>>>3;return(N[H]|(z<=5?0:N[H+1]<<8))>>>z&7}function He(N,G){var z=G&7,H=G>>>3;return(N[H]|(z<=4?0:N[H+1]<<8))>>>z&15}function q(N,G){var z=G&7,H=G>>>3;return(N[H]|(z<=3?0:N[H+1]<<8))>>>z&31}function de(N,G){var z=G&7,H=G>>>3;return(N[H]|(z<=1?0:N[H+1]<<8))>>>z&127}function Ee(N,G,z){var H=G&7,V=G>>>3,Q=(1<<z)-1,ye=N[V]>>>H;return z<8-H||(ye|=N[V+1]<<8-H,z<16-H)||(ye|=N[V+2]<<16-H,z<24-H)||(ye|=N[V+3]<<24-H),ye&Q}function Ne(N,G,z){var H=G&7,V=G>>>3;return H<=5?N[V]|=(z&7)<<H:(N[V]|=z<<H&255,N[V+1]=(z&7)>>8-H),G+3}function Le(N,G,z){var H=G&7,V=G>>>3;return z=(z&1)<<H,N[V]|=z,G+1}function Qe(N,G,z){var H=G&7,V=G>>>3;return z<<=H,N[V]|=z&255,z>>>=8,N[V+1]=z,G+8}function Mt(N,G,z){var H=G&7,V=G>>>3;return z<<=H,N[V]|=z&255,z>>>=8,N[V+1]=z&255,N[V+2]=z>>>8,G+16}function gt(N,G){var z=N.length,H=2*z>G?2*z:G+5,V=0;if(z>=G)return N;if(yt){var Q=Bx(H);if(N.copy)N.copy(Q);else for(;V<N.length;++V)Q[V]=N[V];return Q}else if(ie){var ye=new Uint8Array(H);if(ye.set)ye.set(N);else for(;V<z;++V)ye[V]=N[V];return ye}return N.length=H,N}function wt(N){for(var G=new Array(N),z=0;z<N;++z)G[z]=0;return G}function Ft(N,G,z){var H=1,V=0,Q=0,ye=0,Te=0,ve=N.length,ke=ie?new Uint16Array(32):wt(32);for(Q=0;Q<32;++Q)ke[Q]=0;for(Q=ve;Q<z;++Q)N[Q]=0;ve=N.length;var _e=ie?new Uint16Array(ve):wt(ve);for(Q=0;Q<ve;++Q)ke[V=N[Q]]++,H<V&&(H=V),_e[Q]=0;for(ke[0]=0,Q=1;Q<=H;++Q)ke[Q+16]=Te=Te+ke[Q-1]<<1;for(Q=0;Q<ve;++Q)Te=N[Q],Te!=0&&(_e[Q]=ke[Te+16]++);var Oe=0;for(Q=0;Q<ve;++Q)if(Oe=N[Q],Oe!=0)for(Te=F(_e[Q],H)>>H-Oe,ye=(1<<H+4-Oe)-1;ye>=0;--ye)G[Te|ye<<Oe]=Oe&15|Q<<4;return H}var Ge=ie?new Uint16Array(512):wt(512),ft=ie?new Uint16Array(32):wt(32);if(!ie){for(var ht=0;ht<512;++ht)Ge[ht]=0;for(ht=0;ht<32;++ht)ft[ht]=0}(function(){for(var N=[],G=0;G<32;G++)N.push(5);Ft(N,ft,32);var z=[];for(G=0;G<=143;G++)z.push(8);for(;G<=255;G++)z.push(9);for(;G<=279;G++)z.push(7);for(;G<=287;G++)z.push(8);Ft(z,Ge,288)})();var Ut=(function(){for(var G=ie?new Uint8Array(32768):[],z=0,H=0;z<pe.length-1;++z)for(;H<pe[z+1];++H)G[H]=z;for(;H<32768;++H)G[H]=29;var V=ie?new Uint8Array(259):[];for(z=0,H=0;z<oe.length-1;++z)for(;H<oe[z+1];++H)V[H]=z;function Q(Te,ve){for(var ke=0;ke<Te.length;){var _e=Math.min(65535,Te.length-ke),Oe=ke+_e==Te.length;for(ve.write_shift(1,+Oe),ve.write_shift(2,_e),ve.write_shift(2,~_e&65535);_e-- >0;)ve[ve.l++]=Te[ke++]}return ve.l}function ye(Te,ve){for(var ke=0,_e=0,Oe=ie?new Uint16Array(32768):[];_e<Te.length;){var We=Math.min(65535,Te.length-_e);if(We<10){for(ke=Ne(ve,ke,+(_e+We==Te.length)),ke&7&&(ke+=8-(ke&7)),ve.l=ke/8|0,ve.write_shift(2,We),ve.write_shift(2,~We&65535);We-- >0;)ve[ve.l++]=Te[_e++];ke=ve.l*8;continue}ke=Ne(ve,ke,+(_e+We==Te.length)+2);for(var Pe=0;We-- >0;){var Re=Te[_e];Pe=(Pe<<5^Re)&32767;var Me=-1,it=0;if((Me=Oe[Pe])&&(Me|=_e&-32768,Me>_e&&(Me-=32768),Me<_e))for(;Te[Me+it]==Te[_e+it]&&it<250;)++it;if(it>2){Re=V[it],Re<=22?ke=Qe(ve,ke,te[Re+1]>>1)-1:(Qe(ve,ke,3),ke+=5,Qe(ve,ke,te[Re-23]>>5),ke+=3);var jt=Re<8?0:Re-4>>2;jt>0&&(Mt(ve,ke,it-oe[Re]),ke+=jt),Re=G[_e-Me],ke=Qe(ve,ke,te[Re]>>3),ke-=3;var Pt=Re<4?0:Re-2>>1;Pt>0&&(Mt(ve,ke,_e-Me-pe[Re]),ke+=Pt);for(var ur=0;ur<it;++ur)Oe[Pe]=_e&32767,Pe=(Pe<<5^Te[_e])&32767,++_e;We-=it-1}else Re<=143?Re=Re+48:ke=Le(ve,ke,1),ke=Qe(ve,ke,te[Re]),Oe[Pe]=_e&32767,++_e}ke=Qe(ve,ke,0)-1}return ve.l=(ke+7)/8|0,ve.l}return function(ve,ke){return ve.length<8?Q(ve,ke):ye(ve,ke)}})();function rt(N){var G=br(50+Math.floor(N.length*1.1)),z=Ut(N,G);return G.slice(0,z)}var Et=ie?new Uint16Array(32768):wt(32768),qt=ie?new Uint16Array(32768):wt(32768),kt=ie?new Uint16Array(128):wt(128),Ht=1,$t=1;function Cn(N,G){var z=q(N,G)+257;G+=5;var H=q(N,G)+1;G+=5;var V=He(N,G)+4;G+=4;for(var Q=0,ye=ie?new Uint8Array(19):wt(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,ke=ie?new Uint8Array(8):wt(8),_e=ie?new Uint8Array(8):wt(8),Oe=ye.length,We=0;We<V;++We)ye[U[We]]=Q=De(N,G),ve<Q&&(ve=Q),ke[Q]++,G+=3;var Pe=0;for(ke[0]=0,We=1;We<=ve;++We)_e[We]=Pe=Pe+ke[We-1]<<1;for(We=0;We<Oe;++We)(Pe=ye[We])!=0&&(Te[We]=_e[Pe]++);var Re=0;for(We=0;We<Oe;++We)if(Re=ye[We],Re!=0){Pe=te[Te[We]]>>8-Re;for(var Me=(1<<7-Re)-1;Me>=0;--Me)kt[Pe|Me<<Re]=Re&7|We<<3}var it=[];for(ve=1;it.length<z+H;)switch(Pe=kt[de(N,G)],G+=Pe&7,Pe>>>=3){case 16:for(Q=3+Ce(N,G),G+=2,Pe=it[it.length-1];Q-- >0;)it.push(Pe);break;case 17:for(Q=3+De(N,G),G+=3;Q-- >0;)it.push(0);break;case 18:for(Q=11+de(N,G),G+=7;Q-- >0;)it.push(0);break;default:it.push(Pe),ve<Pe&&(ve=Pe);break}var jt=it.slice(0,z),Pt=it.slice(z);for(We=z;We<286;++We)jt[We]=0;for(We=H;We<30;++We)Pt[We]=0;return Ht=Ft(jt,Et,286),$t=Ft(Pt,qt,30),G}function vn(N,G){if(N[0]==3&&!(N[1]&3))return[Cs(G),2];for(var z=0,H=0,V=Bx(G||1<<18),Q=0,ye=V.length>>>0,Te=0,ve=0;(H&1)==0;){if(H=De(N,z),z+=3,H>>>1)H>>1==1?(Te=9,ve=5):(z=Cn(N,z),Te=Ht,ve=$t);else{z&7&&(z+=8-(z&7));var ke=N[z>>>3]|N[(z>>>3)+1]<<8;if(z+=32,ke>0)for(!G&&ye<Q+ke&&(V=gt(V,Q+ke),ye=V.length);ke-- >0;)V[Q++]=N[z>>>3],z+=8;continue}for(;;){!G&&ye<Q+32767&&(V=gt(V,Q+32767),ye=V.length);var _e=Ee(N,z,Te),Oe=H>>>1==1?Ge[_e]:Et[_e];if(z+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)V[Q++]=Oe;else{if(Oe==256)break;Oe-=257;var We=Oe<8?0:Oe-4>>2;We>5&&(We=0);var Pe=Q+oe[Oe];We>0&&(Pe+=Ee(N,z,We),z+=We),_e=Ee(N,z,ve),Oe=H>>>1==1?ft[_e]:qt[_e],z+=Oe&15,Oe>>>=4;var Re=Oe<4?0:Oe-2>>1,Me=pe[Oe];for(Re>0&&(Me+=Ee(N,z,Re),z+=Re),!G&&ye<Pe&&(V=gt(V,Pe+100),ye=V.length);Q<Pe;)V[Q]=V[Q-Me],++Q}}}return G?[V,z+7>>>3]:[V.slice(0,Q),z+7>>>3]}function xe(N,G){var z=N.slice(N.l||0),H=vn(z,G);return N.l+=H[1],H[0]}function je(N,G){if(N)typeof console<"u"&&console.error(G);else throw new Error(G)}function ze(N,G){var z=N;jr(z,0);var H=[],V=[],Q={FileIndex:H,FullPaths:V};C(Q,{root:G.root});for(var ye=z.length-4;(z[ye]!=80||z[ye+1]!=75||z[ye+2]!=5||z[ye+3]!=6)&&ye>=0;)--ye;z.l=ye+4,z.l+=4;var Te=z.read_shift(2);z.l+=6;var ve=z.read_shift(4);for(z.l=ve,ye=0;ye<Te;++ye){z.l+=20;var ke=z.read_shift(4),_e=z.read_shift(4),Oe=z.read_shift(2),We=z.read_shift(2),Pe=z.read_shift(2);z.l+=8;var Re=z.read_shift(4),Me=c(z.slice(z.l+Oe,z.l+Oe+We));z.l+=Oe+We+Pe;var it=z.l;z.l=Re+4,Ve(z,ke,_e,Q,Me),z.l=it}return Q}function Ve(N,G,z,H,V){N.l+=2;var Q=N.read_shift(2),ye=N.read_shift(2),Te=l(N);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var ve=N.read_shift(4),ke=N.read_shift(4),_e=N.read_shift(4),Oe=N.read_shift(2),We=N.read_shift(2),Pe="",Re=0;Re<Oe;++Re)Pe+=String.fromCharCode(N[N.l++]);if(We){var Me=c(N.slice(N.l,N.l+We));(Me[21589]||{}).mt&&(Te=Me[21589].mt),((V||{})[21589]||{}).mt&&(Te=V[21589].mt)}N.l+=We;var it=N.slice(N.l,N.l+ke);switch(ye){case 8:it=j(N,_e);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var jt=!1;Q&8&&(ve=N.read_shift(4),ve==134695760&&(ve=N.read_shift(4),jt=!0),ke=N.read_shift(4),_e=N.read_shift(4)),ke!=G&&je(jt,"Bad compressed size: "+G+" != "+ke),_e!=z&&je(jt,"Bad uncompressed size: "+z+" != "+_e),tt(H,Pe,it,{unsafe:!0,mt:Te})}function et(N,G){var z=G||{},H=[],V=[],Q=br(1),ye=z.compression?8:0,Te=0,ve=0,ke=0,_e=0,Oe=0,We=N.FullPaths[0],Pe=We,Re=N.FileIndex[0],Me=[],it=0;for(ve=1;ve<N.FullPaths.length;++ve)if(Pe=N.FullPaths[ve].slice(We.length),Re=N.FileIndex[ve],!(!Re.size||!Re.content||Pe=="Sh33tJ5")){var jt=_e,Pt=br(Pe.length);for(ke=0;ke<Pe.length;++ke)Pt.write_shift(1,Pe.charCodeAt(ke)&127);Pt=Pt.slice(0,Pt.l),Me[Oe]=c_.buf(Re.content,0);var ur=Re.content;ye==8&&(ur=M(ur)),Q=br(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Te),Q.write_shift(2,ye),Re.mt?o(Q,Re.mt):Q.write_shift(4,0),Q.write_shift(-4,Me[Oe]),Q.write_shift(4,ur.length),Q.write_shift(4,Re.content.length),Q.write_shift(2,Pt.length),Q.write_shift(2,0),_e+=Q.length,H.push(Q),_e+=Pt.length,H.push(Pt),_e+=ur.length,H.push(ur),Q=br(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Te),Q.write_shift(2,ye),Q.write_shift(4,0),Q.write_shift(-4,Me[Oe]),Q.write_shift(4,ur.length),Q.write_shift(4,Re.content.length),Q.write_shift(2,Pt.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,jt),it+=Q.l,V.push(Q),it+=Pt.length,V.push(Pt),++Oe}return Q=br(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,Oe),Q.write_shift(2,Oe),Q.write_shift(4,it),Q.write_shift(4,_e),Q.write_shift(2,0),ys([ys(H),ys(V),Q])}var St={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function It(N,G){if(N.ctype)return N.ctype;var z=N.name||"",H=z.match(/\.([^\.]+)$/);return H&&St[H[1]]||G&&(H=(z=G).match(/[\.\\]([^\.\\])+$/),H&&St[H[1]])?St[H[1]]:"application/octet-stream"}function Yt(N){for(var G=zx(N),z=[],H=0;H<G.length;H+=76)z.push(G.slice(H,H+76));return z.join(`\r
`)+`\r
`}function wr(N){var G=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var _e=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(_e.length==1?"0"+_e:_e)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],H=G.split(`\r
`),V=0;V<H.length;++V){var Q=H[V];if(Q.length==0){z.push("");continue}for(var ye=0;ye<Q.length;){var Te=76,ve=Q.slice(ye,ye+Te);ve.charAt(Te-1)=="="?Te--:ve.charAt(Te-2)=="="?Te-=2:ve.charAt(Te-3)=="="&&(Te-=3),ve=Q.slice(ye,ye+Te),ye+=Te,ye<Q.length&&(ve+="="),z.push(ve)}}return z.join(`\r
`)}function nt(N){for(var G=[],z=0;z<N.length;++z){for(var H=N[z];z<=N.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+N[++z];G.push(H)}for(var V=0;V<G.length;++V)G[V]=G[V].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return ea(G.join(`\r
`))}function mt(N,G,z){for(var H="",V="",Q="",ye,Te=0;Te<10;++Te){var ve=G[Te];if(!ve||ve.match(/^\s*$/))break;var ke=ve.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":H=ke[2].trim();break;case"content-type":Q=ke[2].trim();break;case"content-transfer-encoding":V=ke[2].trim();break}}switch(++Te,V.toLowerCase()){case"base64":ye=ea(Tn(G.slice(Te).join("")));break;case"quoted-printable":ye=nt(G.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var _e=tt(N,H.slice(z.length),ye,{unsafe:!0});Q&&(_e.ctype=Q)}function Tr(N,G){if(R(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=G&&G.root||"",H=(yt&&Buffer.isBuffer(N)?N.toString("binary"):R(N)).split(`\r
`),V=0,Q="";for(V=0;V<H.length;++V)if(Q=H[V],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),z||(z=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),Q.slice(0,z.length)!=z););var ye=(H[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Te="--"+(ye[1]||""),ve=[],ke=[],_e={FileIndex:ve,FullPaths:ke};C(_e);var Oe,We=0;for(V=0;V<H.length;++V){var Pe=H[V];Pe!==Te&&Pe!==Te+"--"||(We++&&mt(_e,H.slice(Oe,V),z),Oe=V)}return _e}function Zr(N,G){var z=G||{},H=z.boundary||"SheetJS";H="------="+H;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],Q=N.FullPaths[0],ye=Q,Te=N.FileIndex[0],ve=1;ve<N.FullPaths.length;++ve)if(ye=N.FullPaths[ve].slice(Q.length),Te=N.FileIndex[ve],!(!Te.size||!Te.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var ke=Te.content,_e=yt&&Buffer.isBuffer(ke)?ke.toString("binary"):R(ke),Oe=0,We=Math.min(1024,_e.length),Pe=0,Re=0;Re<=We;++Re)(Pe=_e.charCodeAt(Re))>=32&&Pe<128&&++Oe;var Me=Oe>=We*4/5;V.push(H),V.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+ye),V.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),V.push("Content-Type: "+It(Te,ye)),V.push(""),V.push(Me?wr(_e):Yt(_e))}return V.push(H+`--\r
`),V.join(`\r
`)}function Ue(N){var G={};return C(G,N),G}function tt(N,G,z,H){var V=H&&H.unsafe;V||C(N);var Q=!V&&_t.find(N,G);if(!Q){var ye=N.FullPaths[0];G.slice(0,ye.length)==ye?ye=G:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+G).replace("//","/")),Q={name:a(G),type:2},N.FileIndex.push(Q),N.FullPaths.push(ye),V||_t.utils.cfb_gc(N)}return Q.content=z,Q.size=z?z.length:0,H&&(H.CLSID&&(Q.clsid=H.CLSID),H.mt&&(Q.mt=H.mt),H.ct&&(Q.ct=H.ct)),Q}function ct(N,G){C(N);var z=_t.find(N,G);if(z){for(var H=0;H<N.FileIndex.length;++H)if(N.FileIndex[H]==z)return N.FileIndex.splice(H,1),N.FullPaths.splice(H,1),!0}return!1}function Vt(N,G,z){C(N);var H=_t.find(N,G);if(H){for(var V=0;V<N.FileIndex.length;++V)if(N.FileIndex[V]==H)return N.FileIndex[V].name=a(z),N.FullPaths[V]=z,!0}return!1}function rr(N){L(N,!0)}return n.find=X,n.read=I,n.parse=d,n.write=Y,n.writeFile=se,n.utils={cfb_new:Ue,cfb_add:tt,cfb_del:ct,cfb_mov:Vt,cfb_gc:rr,ReadShift:ll,CheckField:S1,prep_blob:jr,bconcat:ys,use_zlib:E,_deflateRaw:rt,_inflateRaw:xe,consts:K},n})();function u_(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ea(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function op(e){for(var n=[],t=Ea(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var bu=new Date(1899,11,30,0,0,0);function un(e,n){var t=e.getTime(),r=bu.getTime()+(e.getTimezoneOffset()-bu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var a1=new Date,f_=bu.getTime()+(a1.getTimezoneOffset()-bu.getTimezoneOffset())*6e4,Gx=a1.getTimezoneOffset();function Gu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+f_),n.getTimezoneOffset()!==Gx&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Gx)*6e4),n}function d_(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var Xx=new Date("2017-02-19T19:06:09.000Z"),s1=isNaN(Xx.getFullYear())?new Date("2/19/17"):Xx,p_=s1.getFullYear()==2017;function Or(e,n){var t=new Date(e);if(p_)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(s1.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function io(e,n){if(yt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return sl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return sl(Yv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return sl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return sl(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function zr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=zr(e[t]));return n}function ir(e,n){for(var t="";t.length<n;)t+=e;return t}function na(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var h_=["january","february","march","april","may","june","july","august","september","october","november","december"];function ai(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&h_.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var m_=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function o1(e){return e?e.content&&e.type?io(e.content,!0):e.data?rl(e.data):e.asNodeBuffer&&yt?rl(e.asNodeBuffer().toString("binary")):e.asBinary?rl(e.asBinary()):e._data&&e._data.getContent?rl(io(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function i1(e){if(!e)return null;if(e.data)return jx(e.data);if(e.asNodeBuffer&&yt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?jx(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function x_(e){return e&&e.name.slice(-4)===".bin"?i1(e):o1(e)}function Ln(e,n){for(var t=e.FullPaths||Ea(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function ip(e,n){var t=Ln(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function vr(e,n,t){if(!t)return x_(ip(e,n));if(!n)return null;try{return vr(e,n)}catch{return null}}function En(e,n,t){if(!t)return o1(ip(e,n));if(!n)return null;try{return En(e,n)}catch{return null}}function g_(e,n,t){return i1(ip(e,n))}function Qx(e){for(var n=e.FullPaths||Ea(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function v_(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return yt?r=ho(t):r=j2(t),_t.utils.cfb_add(e,n,r)}_t.utils.cfb_add(e,n,t)}else e.file(n,t)}function l1(e,n){switch(n.type){case"base64":return _t.read(e,{type:"base64"});case"binary":return _t.read(e,{type:"binary"});case"buffer":case"array":return _t.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function al(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var c1=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,y_=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,w_=/<[^>]*>/g,qr=c1.match(qx)?qx:w_,k_=/<\w*:/,__=/<(\/?)\w+:/;function lt(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(y_),c=0,f="",p=0,d="",x="",g=1;if(l)for(p=0;p!=l.length;++p){for(x=l[p],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(d=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(g=(a=x.charCodeAt(o+1))==34||a==39?1:0,f=x.slice(o+1+g,x.length-g),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),r[d]=f,r[d.toLowerCase()]=f;else{var y=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(r[y]&&d.slice(c-3,c)=="ext")continue;r[y]=f,r[y.toLowerCase()]=f}}return r}function Ta(e){return e.replace(__,"<$1")}var u1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},b_=op(u1),Nt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return u1[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),E_=/[&<>'"]/g,S_=/[\u0000-\u001f]/g;function lp(e){var n=e+"";return n.replace(E_,function(t){return b_[t]}).replace(/\n/g,"<br/>").replace(S_,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Zx=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function er(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Z0(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function Jx(e){var n=Cs(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function eg(e){return ho(e,"binary").toString("utf8")}var qc="foo bar bazâð£",Gt=yt&&(eg(qc)==Z0(qc)&&eg||Jx(qc)==Z0(qc)&&Jx)||Z0,sl=yt?function(e){return ho(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},wl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),f1=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),T_=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),C_=/<\/?(?:vt:)?variant>/g,D_=/<(?:vt:)([^>]*)>([\s\S]*)</;function tg(e,n){var t=lt(e),r=e.match(T_(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(C_,"").match(D_);l&&a.push({v:Gt(l[2]),t:l[1]})}),a}var N_=/(^\s|\s$|\n)/;function F_(e){return Ea(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function A_(e,n,t){return"<"+e+(t!=null?F_(t):"")+(n!=null?(n.match(N_)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function cp(e){if(yt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Gt(mo(np(e)));throw new Error("Bad input format: expected Buffer or string")}var kl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,O_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},P_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function R_(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function M_(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var rg=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},ng=yt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ho(n)})):rg(e)}:rg,ag=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(za(e,a)));return r.join("").replace(cn,"")},up=yt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(cn,""):ag(e,n,t)}:ag,sg=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},d1=yt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):sg(e,n,t)}:sg,og=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Go(e,a)));return r.join("")},Fl=yt?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):og(n,t,r)}:og,p1=function(e,n){var t=bn(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},h1=p1,m1=function(e,n){var t=bn(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},x1=m1,g1=function(e,n){var t=2*bn(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},v1=g1,y1=function(n,t){var r=bn(n,t);return r>0?up(n,t+4,t+4+r):""},w1=y1,k1=function(e,n){var t=bn(e,n);return t>0?Fl(e,n+4,n+4+t):""},_1=k1,b1=function(e,n){return R_(e,n)},Eu=b1,E1=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};yt&&(h1=function(n,t){if(!Buffer.isBuffer(n))return p1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},x1=function(n,t){if(!Buffer.isBuffer(n))return m1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},v1=function(n,t){if(!Buffer.isBuffer(n))return g1(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},w1=function(n,t){if(!Buffer.isBuffer(n))return y1(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},_1=function(n,t){if(!Buffer.isBuffer(n))return k1(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Eu=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):b1(n,t)},E1=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Go=function(e,n){return e[n]},za=function(e,n){return e[n+1]*256+e[n]},I_=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},bn=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Xs=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},j_=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ll(e,n){var t="",r,a,o=[],l,c,f,p;switch(n){case"dbcs":if(p=this.l,yt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(za(this,p)),p+=2;e*=2;break;case"utf8":t=Fl(this,this.l,this.l+e);break;case"utf16le":e*=2,t=up(this,this.l,this.l+e);break;case"wstr":return ll.call(this,e,"dbcs");case"lpstr-ansi":t=h1(this,this.l),e=4+bn(this,this.l);break;case"lpstr-cp":t=x1(this,this.l),e=4+bn(this,this.l);break;case"lpwstr":t=v1(this,this.l),e=4+2*bn(this,this.l);break;case"lpp4":e=4+bn(this,this.l),t=w1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bn(this,this.l),t=_1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Go(this,this.l+e++))!==0;)o.push(Qc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=za(this,this.l+e))!==0;)o.push(Qc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",p=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return l=Go(this,p),this.l=p+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(za(this,p))),p+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",p=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return l=Go(this,p),this.l=p+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(Go(this,p))),p+=1}t=o.join("");break;default:switch(e){case 1:return r=Go(this,this.l),this.l++,r;case 2:return r=(n==="i"?I_:za)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Xs:j_)(this,this.l),this.l+=4,r):(a=bn(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Eu(this,this.l):a=Eu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=d1(this,this.l,e);break}}return this.l+=e,t}var L_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},z_=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},B_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function W_(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)B_(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,L_(this,n,this.l);break;case 8:if(r=8,t==="f"){M_(this,n,this.l);break}case 16:break;case-4:r=4,z_(this,n,this.l);break}return this.l+=r,this}function S1(e,n){var t=d1(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function jr(e,n){e.l=n,e.read_shift=ll,e.chk=S1,e.write_shift=W_}function Qr(e,n){e.l+=n}function br(e){var n=Cs(e);return jr(n,0),n}function Xa(e,n,t){if(e){var r,a,o;jr(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var p=Fu[c]||Fu[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var d=p.f&&p.f(e,o,t);if(e.l=f,n(d,p,c))return}}}function Ed(){var e=[],n=yt?256:2048,t=function(p){var d=br(p);return jr(d,0),d},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(p){return r&&p<r.length-r.l?r:(a(),r=t(Math.max(p+1,n)))},l=function(){return a(),ys(e)},c=function(p){a(),r=p,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function cl(e,n,t){var r=zr(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ig(e,n,t){var r=zr(e);return r.s=cl(r.s,n.s,t),r.e=cl(r.e,n.s,t),r}function ul(e,n){if(e.cRel&&e.c<0)for(e=zr(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=zr(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=dt(e);return!e.cRel&&e.cRel!=null&&(t=$_(t)),!e.rRel&&e.rRel!=null&&(t=U_(t)),t}function J0(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Er(e.s.c)+":"+(e.e.cRel?"":"$")+Er(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Br(e.s.r)+":"+(e.e.rRel?"":"$")+Br(e.e.r):ul(e.s,n.biff)+":"+ul(e.e,n.biff)}function fp(e){return parseInt(H_(e),10)-1}function Br(e){return""+(e+1)}function U_(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function H_(e){return e.replace(/\$(\d+)$/,"$1")}function dp(e){for(var n=Y_(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Er(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function $_(e){return e.replace(/^([A-Z])/,"$$$1")}function Y_(e){return e.replace(/^\$([A-Z])/,"$1")}function V_(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sn(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function dt(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function pi(e){var n=e.indexOf(":");return n==-1?{s:sn(e),e:sn(e)}:{s:sn(e.slice(0,n)),e:sn(e.slice(n+1))}}function bt(e,n){return typeof n>"u"||typeof n=="number"?bt(e.s,e.e):(typeof e!="string"&&(e=dt(e)),typeof n!="string"&&(n=dt(n)),e==n?e:e+":"+n)}function lr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function lg(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,t?un(n):n)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(t?14:0),t?un(n):n)}catch{return""+n}}function Ka(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?vo[e.v]||e.v:n==null?lg(e,e.v):lg(e,n))}function Os(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function T1(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?sn(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var d=lr(o["!ref"]);p.s.c=d.s.c,p.s.r=d.s.r,p.e.c=Math.max(p.e.c,d.e.c),p.e.r=Math.max(p.e.r,d.e.r),l==-1&&(p.e.r=l=d.e.r+1)}for(var x=0;x!=n.length;++x)if(n[x]){if(!Array.isArray(n[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[x].length;++g)if(!(typeof n[x][g]>"u")){var y={v:n[x][g]},k=l+x,w=c+g;if(p.s.r>k&&(p.s.r=k),p.s.c>w&&(p.s.c=w),p.e.r<k&&(p.e.r=k),p.e.c<w&&(p.e.c=w),n[x][g]&&typeof n[x][g]=="object"&&!Array.isArray(n[x][g])&&!(n[x][g]instanceof Date))y=n[x][g];else if(Array.isArray(y.v)&&(y.f=n[x][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||pt[14],r.cellDates?(y.t="d",y.w=Un(y.z,un(y.v))):(y.t="n",y.v=un(y.v),y.w=Un(y.z,y.v))):y.t="s";if(a)o[k]||(o[k]=[]),o[k][w]&&o[k][w].z&&(y.z=o[k][w].z),o[k][w]=y;else{var _=dt({c:w,r:k});o[_]&&o[_].z&&(y.z=o[_].z),o[_]=y}}}return p.s.c<1e7&&(o["!ref"]=bt(p)),o}function hi(e,n){return T1(null,e,n)}function K_(e){return e.read_shift(4,"i")}function Xr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function G_(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function pp(e,n){var t=e.l,r=e.read_shift(1),a=Xr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(G_(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var X_=pp;function $n(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function xo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var Q_=Xr;function hp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var q_=Xr,Sd=hp;function mp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Eu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Xs(n,0)>>2;return t?a/100:a}function C1(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var go=C1;function Kr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Z_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var p=to[a];p&&(n.rgb=bl(p));break;case 2:n.rgb=bl([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function J_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function D1(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function eb(e){return D1(e,1)}function tb(e){return D1(e,2)}var xp=2,gn=3,Zc=11,cg=12,Su=19,Jc=64,rb=65,nb=71,ab=4108,sb=4126,Ar=80,N1=81,ob=[Ar,N1],ib={1:{n:"CodePage",t:xp},2:{n:"Category",t:Ar},3:{n:"PresentationFormat",t:Ar},4:{n:"ByteCount",t:gn},5:{n:"LineCount",t:gn},6:{n:"ParagraphCount",t:gn},7:{n:"SlideCount",t:gn},8:{n:"NoteCount",t:gn},9:{n:"HiddenCount",t:gn},10:{n:"MultimediaClipCount",t:gn},11:{n:"ScaleCrop",t:Zc},12:{n:"HeadingPairs",t:ab},13:{n:"TitlesOfParts",t:sb},14:{n:"Manager",t:Ar},15:{n:"Company",t:Ar},16:{n:"LinksUpToDate",t:Zc},17:{n:"CharacterCount",t:gn},19:{n:"SharedDoc",t:Zc},22:{n:"HyperlinksChanged",t:Zc},23:{n:"AppVersion",t:gn,p:"version"},24:{n:"DigSig",t:rb},26:{n:"ContentType",t:Ar},27:{n:"ContentStatus",t:Ar},28:{n:"Language",t:Ar},29:{n:"Version",t:Ar},255:{},2147483648:{n:"Locale",t:Su},2147483651:{n:"Behavior",t:Su},1919054434:{}},lb={1:{n:"CodePage",t:xp},2:{n:"Title",t:Ar},3:{n:"Subject",t:Ar},4:{n:"Author",t:Ar},5:{n:"Keywords",t:Ar},6:{n:"Comments",t:Ar},7:{n:"Template",t:Ar},8:{n:"LastAuthor",t:Ar},9:{n:"RevNumber",t:Ar},10:{n:"EditTime",t:Jc},11:{n:"LastPrinted",t:Jc},12:{n:"CreatedDate",t:Jc},13:{n:"ModifiedDate",t:Jc},14:{n:"PageCount",t:gn},15:{n:"WordCount",t:gn},16:{n:"CharCount",t:gn},17:{n:"Thumbnail",t:nb},18:{n:"Application",t:Ar},19:{n:"DocSecurity",t:gn},255:{},2147483648:{n:"Locale",t:Su},2147483651:{n:"Behavior",t:Su},1919054434:{}},ug={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ub(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var fb=ub([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),to=zr(fb),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},F1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},fg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function db(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pb(e){var n=db();if(!e||!e.match)return n;var t={};if((e.match(qr)||[]).forEach(function(r){var a=lt(r);switch(a[0].replace(k_,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[fg[a.ContentType]]!==void 0&&n[fg[a.ContentType]].push(a.PartName);break}}),n.xmlns!==O_.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var Qo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Td(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function fl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(qr)||[]).forEach(function(a){var o=lt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:al(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var hb="application/vnd.oasis.opendocument.spreadsheet";function mb(e,n){for(var t=cp(e),r,a;r=kl.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=lt(r[0],!1),a.path=="/"&&a.type!==hb)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var dl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xb=(function(){for(var e=new Array(dl.length),n=0;n<dl.length;++n){var t=dl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function A1(e){var n={};e=Gt(e);for(var t=0;t<dl.length;++t){var r=dl[t],a=e.match(xb[t]);a!=null&&a.length>0&&(n[r[1]]=Nt(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=Or(n[r[1]]))}return n}var gb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function O1(e,n,t,r){var a=[];if(typeof e=="string")a=tg(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(d){return{v:d}}));var l=typeof n=="string"?tg(n,r).map(function(d){return d.v}):n,c=0,f=0;if(l.length>0)for(var p=0;p!==a.length;p+=2){switch(f=+a[p+1].v,a[p].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function vb(e,n,t){var r={};return n||(n={}),e=Gt(e),gb.forEach(function(a){var o=(e.match(wl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=Nt(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&O1(r.HeadingPairs,r.TitlesOfParts,n,t),n}var yb=/<[^>]+>[^<]*/g;function wb(e,n){var t={},r="",a=e.match(yb);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=lt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Nt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),p=f[0].slice(4),d=f[1];switch(p){case"lpstr":case"bstr":case"lpwstr":t[r]=Nt(d);break;case"bool":t[r]=er(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(d);break;case"filetime":case"date":t[r]=Or(d);break;case"cy":case"error":t[r]=Nt(d);break;default:if(p.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,p,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var kb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ed;function _b(e,n,t){ed||(ed=op(kb)),n=ed[n]||n,e[n]=t}function gp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function P1(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function R1(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function M1(e,n,t){return n===31?R1(e):P1(e,n,t)}function Cd(e,n,t){return M1(e,n,t===!1?0:4)}function bb(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return M1(e,n,0)}function Eb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(cn,""),e.l-a&2&&(e.l+=2)}return t}function Sb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(cn,"");return t}function Tb(e){var n=e.l,t=Tu(e,N1);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Tu(e,gn);return[t,r]}function Cb(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(Tb(e));return t}function dg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(cn,"").replace(nl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function I1(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function Db(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Tu(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==cg&&r!==n&&ob.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===cg?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return P1(e,r,4).replace(cn,"");case 31:return R1(e);case 64:return gp(e);case 65:return I1(e);case 71:return Db(e);case 80:return Cd(e,r,!o.raw).replace(cn,"");case 81:return bb(e,r).replace(cn,"");case 4108:return Cb(e);case 4126:case 4127:return r==4127?Eb(e):Sb(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function pg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,p={};for(l=0;l!=a;++l){var d=e.read_shift(4),x=e.read_shift(4);o[l]=[d,x+t]}o.sort(function(O,T){return O[1]-T[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var y=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,y=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(y=!1,e.l=o[l][1]),y)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var k=n[o[l][0]];if(g[k.n]=Tu(e,k.t,{raw:!0}),k.p==="version"&&(g[k.n]=String(g[k.n]>>16)+"."+("0000"+String(g[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(g[k.n]){case 0:g[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ta(c=g[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[k.n])}}else if(o[l][0]===1){if(c=g.CodePage=Tu(e,xp),ta(c),f!==-1){var w=e.l;e.l=o[f][1],p=dg(e,c),e.l=w}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}p=dg(e,c)}else{var _=p[o[l][0]],S;switch(e[e.l]){case 65:e.l+=4,S=I1(e);break;case 30:e.l+=4,S=Cd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=Cd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=pr(e,4);break;case 64:e.l+=4,S=Or(gp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[_]=S}}return e.l=t+r,g}function hg(e,n,t){var r=e.content;if(!r)return{};jr(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var p=r.read_shift(4),d=r.read_shift(16);if(d!==_t.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var x=pg(r,n),g={SystemIdentifier:p};for(var y in x)g[y]=x[y];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var k;try{k=pg(r,null)}catch{}for(y in k)g[y]=k[y];return g.FMTID=[o,l],g}function gs(e,n){return e.read_shift(n),null}function Nb(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function pr(e,n){return e.read_shift(n)===1}function yr(e){return e.read_shift(2,"u")}function j1(e,n){return Nb(e,n,yr)}function Fb(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Al(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function Ab(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var p=o==2?"dbcs-cont":"sbcs-cont",d=n===0?"":e.read_shift(n,p);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=d,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function lo(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Ol(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):lo(e,r,t)}function yo(e,n,t){if(t.biff>5)return Ol(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ob(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function Pb(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(cn,"");return r&&(e.l+=24),a}function Rb(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(cn,"");return t+l}function Mb(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Pb(e);case"0303000000000000c000000000000046":return Rb(e);default:throw new Error("Unsupported Moniker "+t)}}function eu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(cn,""):"";return t}function Ib(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,p="",d,x;a&16&&(o=eu(e,t-e.l)),a&128&&(l=eu(e,t-e.l)),(a&257)===257&&(c=eu(e,t-e.l)),(a&257)===1&&(f=Mb(e,t-e.l)),a&8&&(p=eu(e,t-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(x=gp(e)),e.l=t;var g=l||c||f||"";g&&p&&(g+="#"+p),g||(g="#"+p),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var y={Target:g};return d&&(y.guid=d),x&&(y.time=x),o&&(y.Tooltip=o),y}function L1(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function z1(e,n){var t=L1(e);return t[3]=0,t}function Ca(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function jb(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function Lb(e,n,t){return n===0?"":yo(e,n,t)}function zb(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function B1(e){var n=e.read_shift(2),t=mp(e);return[n,t]}function Bb(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Al(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function Xu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function W1(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var Wb=W1;function U1(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function Ub(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function Hb(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Yr(e){e.l+=2,e.l+=e.read_shift(2)}var $b={0:Yr,4:Yr,5:Yr,6:Yr,7:Hb,8:Yr,9:Yr,10:Yr,11:Yr,12:Yr,13:Ub,14:Yr,15:Yr,16:Yr,17:Yr,18:Yr,19:Yr,20:Yr,21:U1};function Yb(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push($b[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function tu(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function Vb(e,n){return n===0||e.read_shift(2),1200}function Kb(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=yo(e,0,t);return e.read_shift(n+r-e.l),a}function Gb(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function Xb(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Al(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function Qb(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(Ab(e));return o.Count=r,o.Unique=a,o}function qb(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function Zb(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function Jb(e){var n=jb(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function eE(e){return e.read_shift(2),e.read_shift(4)}function mg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function tE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),p=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:p}}function rE(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function nE(){}function aE(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Al(e,0,t),r}function sE(e){var n=Ca(e);return n.isst=e.read_shift(4),n}function oE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=Ca(e);t.biff==2&&e.l++;var o=Ol(e,r-e.l,t);return a.val=o,a}function iE(e,n,t){var r=e.read_shift(2),a=yo(e,0,t);return[r,a]}var lE=yo;function xg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function cE(e){var n=e.read_shift(2),t=e.read_shift(2),r=B1(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function uE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(B1(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function fE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function dE(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=cb[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function pE(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=dE(e,n,r.fStyle,t),r}function hE(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function gg(e,n,t){var r=Ca(e);(t.biff==2||n==9)&&++e.l;var a=Fb(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function mE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Ca(e),a=Kr(e);return r.val=a,r}var vg=Lb;function xE(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=lo(e,o),c=[];r>e.l;)c.push(Ol(e));return[o,a,l,c]}function yg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=Bb(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var gE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function wg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var p=lo(e,l,t);a&32&&(p=gE[p.charCodeAt(0)]);var d=r-e.l;t&&t.biff==2&&--d;var x=r==e.l||c===0||!(d>0)?[]:ZC(e,d,t,c);return{chKey:o,Name:p,itab:f,rgce:x}}function H1(e,n,t){if(t.biff<8)return vE(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(zb(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function vE(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Al(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function yE(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=lo(e,r,t),l=lo(e,a,t);return[o,l]}function wE(e,n,t){var r=W1(e);e.l++;var a=e.read_shift(1);return n-=8,[JC(e,n,t),a,r]}function kg(e,n,t){var r=Wb(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,QC(e,n,t)]}function kE(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function _E(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=yo(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function bE(e,n,t){return _E(e,n,t)}function EE(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(Xu(e));return t}function SE(e,n,t){if(t&&t.biff<8)return CE(e,n,t);var r=U1(e),a=Yb(e,n-22,r[1]);return{cmo:r,ft:a}}var TE={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function CE(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((TE[r]||Qr)(e,n,t)),{cmo:[a,r,o],ft:l}}function DE(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=Ob(e,6,t);var c=e.read_shift(2);e.read_shift(2),yr(e,2);var f=e.read_shift(2);e.l+=f;for(var p=1;p<e.lens.length-1;++p){if(e.l-r!=e.lens[p])throw new Error("TxO: bad continue record");var d=e[e.l],x=lo(e,e.lens[p+1]-e.lens[p]-1);if(a+=x,a.length>=(d?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function NE(e,n){var t=Xu(e);e.l+=16;var r=Ib(e,n-24);return[t,r]}function FE(e,n){e.read_shift(2);var t=Xu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(cn,""),[t,r]}function AE(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=ug[t]||t,t=e.read_shift(2),n[1]=ug[t]||t,n}function OE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(z1(e));return t}function PE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(z1(e));return t}function RE(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function $1(e,n,t){if(!t.cellStyles)return Qr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var p={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(p.level=f>>8&7),p}function ME(e,n){var t={};return n<32||(e.l+=16,t.header=Kr(e),t.footer=Kr(e),e.l+=2),t}function IE(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var jE=Ca,LE=j1,zE=Ol;function BE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function WE(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Ca(e);++e.l;var a=yo(e,n-7,t);return r.t="str",r.val=a,r}function UE(e){var n=Ca(e);++e.l;var t=Kr(e);return n.t="n",n.val=t,n}function HE(e){var n=Ca(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function $E(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function YE(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function VE(e,n,t){var r=e.l+n,a=Ca(e),o=e.read_shift(2),l=lo(e,o,t);return e.l=r,a.t="str",a.val=l,a}var KE=[2,3,48,49,131,139,140,245],_g=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=op({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var p=[],d=Cs(1);switch(f.type){case"base64":d=ea(Tn(c));break;case"binary":d=ea(c);break;case"buffer":case"array":d=c;break}jr(d,0);var x=d.read_shift(1),g=!!(x&136),y=!1,k=!1;switch(x){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,_=521;x==2&&(w=d.read_shift(2)),d.l+=3,x!=2&&(w=d.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(_=d.read_shift(2));var S=d.read_shift(2),O=f.codepage||1252;x!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(O=e[d[d.l]]),d.l+=1,d.l+=2),k&&(d.l+=36);for(var T=[],B={},J=Math.min(d.length,x==2?521:_-10-(y?264:0)),I=k?32:11;d.l<J&&d[d.l]!=13;)switch(B={},B.name=vl.utils.decode(O,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,B.type=String.fromCharCode(d.read_shift(1)),x!=2&&!k&&(B.offset=d.read_shift(4)),B.len=d.read_shift(1),x==2&&(B.offset=d.read_shift(2)),B.dec=d.read_shift(1),B.name.length&&T.push(B),x!=2&&(d.l+=k?13:14),B.type){case"B":(!y||B.len!=8)&&f.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+B.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var C=0,Z=0;for(p[0]=[],Z=0;Z!=T.length;++Z)p[0][Z]=T[Z].name;for(;w-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,p[++C]=[],Z=0,Z=0;Z!=T.length;++Z){var L=d.slice(d.l,d.l+T[Z].len);d.l+=T[Z].len,jr(L,0);var ne=vl.utils.decode(O,L);switch(T[Z].type){case"C":ne.trim().length&&(p[C][Z]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?p[C][Z]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):p[C][Z]=ne;break;case"F":p[C][Z]=parseFloat(ne.trim());break;case"+":case"I":p[C][Z]=k?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":p[C][Z]=!0;break;case"N":case"F":p[C][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));p[C][Z]="##MEMO##"+(k?parseInt(ne.trim(),10):L.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(p[C][Z]=+ne||0);break;case"@":p[C][Z]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":p[C][Z]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":p[C][Z]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[C][Z]=-L.read_shift(-8,"f");break;case"B":if(y&&T[Z].len==8){p[C][Z]=L.read_shift(8,"f");break}case"G":case"P":L.l+=T[Z].len;break;case"0":if(T[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[Z].type)}}}if(x!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return f&&f.sheetRows&&(p=p.slice(0,f.sheetRows)),f.DBF=T,p}function r(c,f){var p=f||{};p.dateNF||(p.dateNF="yyyymmdd");var d=hi(t(c,p),p);return d["!cols"]=p.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete p.DBF,d}function a(c,f){try{return Os(r(c,f),f)}catch(p){if(f&&f.WTF)throw p}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var p=f||{};if(+p.codepage>=0&&ta(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ed(),x=Rd(c,{header:1,raw:!0,cellDates:!0}),g=x[0],y=x.slice(1),k=c["!cols"]||[],w=0,_=0,S=0,O=1;for(w=0;w<g.length;++w){if(((k[w]||{}).DBF||{}).name){g[w]=k[w].DBF.name,++S;continue}if(g[w]!=null){if(++S,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(_=0;_<1024;++_)if(g.indexOf(g[w]+"_"+_)==-1){g[w]+="_"+_;break}}}}var T=lr(c["!ref"]),B=[],J=[],I=[];for(w=0;w<=T.e.c-T.s.c;++w){var C="",Z="",L=0,ne=[];for(_=0;_<y.length;++_)y[_][w]!=null&&ne.push(y[_][w]);if(ne.length==0||g[w]==null){B[w]="?";continue}for(_=0;_<ne.length;++_){switch(typeof ne[_]){case"number":Z="B";break;case"string":Z="C";break;case"boolean":Z="L";break;case"object":Z=ne[_]instanceof Date?"D":"C";break;default:Z="C"}L=Math.max(L,String(ne[_]).length),C=C&&C!=Z?"C":Z}L>250&&(L=250),Z=((k[w]||{}).DBF||{}).type,Z=="C"&&k[w].DBF.len>L&&(L=k[w].DBF.len),C=="B"&&Z=="N"&&(C="N",I[w]=k[w].DBF.dec,L=k[w].DBF.len),J[w]=C=="C"||Z=="N"?L:o[C]||0,O+=J[w],B[w]=C}var X=d.next(32);for(X.write_shift(4,318902576),X.write_shift(4,y.length),X.write_shift(2,296+32*S),X.write_shift(2,O),w=0;w<4;++w)X.write_shift(4,0);for(X.write_shift(4,0|(+n[Hv]||3)<<8),w=0,_=0;w<g.length;++w)if(g[w]!=null){var W=d.next(32),ue=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,ue,"sbcs"),W.write_shift(1,B[w]=="?"?"C":B[w],"sbcs"),W.write_shift(4,_),W.write_shift(1,J[w]||o[B[w]]||0),W.write_shift(1,I[w]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),_+=J[w]||o[B[w]]||0}var le=d.next(264);for(le.write_shift(4,13),w=0;w<65;++w)le.write_shift(4,0);for(w=0;w<y.length;++w){var re=d.next(O);for(re.write_shift(1,0),_=0;_<g.length;++_)if(g[_]!=null)switch(B[_]){case"L":re.write_shift(1,y[w][_]==null?63:y[w][_]?84:70);break;case"B":re.write_shift(8,y[w][_]||0,"f");break;case"N":var he="0";for(typeof y[w][_]=="number"&&(he=y[w][_].toFixed(I[_]||0)),S=0;S<J[_]-he.length;++S)re.write_shift(1,32);re.write_shift(1,he,"sbcs");break;case"D":y[w][_]?(re.write_shift(4,("0000"+y[w][_].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(y[w][_].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+y[w][_].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var K=String(y[w][_]!=null?y[w][_]:"").slice(0,J[_]);for(re.write_shift(1,K,"sbcs"),S=0;S<J[_]-K.length;++S)re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),GE=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ea(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,y){var k=e[y];return typeof k=="number"?Lx(k):k},r=function(g,y,k){var w=y.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?g:Lx(w)};e["|"]=254;function a(g,y){switch(y.type){case"base64":return o(Tn(g),y);case"binary":return o(g,y);case"buffer":return o(yt&&Buffer.isBuffer(g)?g.toString("binary"):mo(g),y);case"array":return o(io(g),y)}throw new Error("Unrecognized type "+y.type)}function o(g,y){var k=g.split(/[\n\r]+/),w=-1,_=-1,S=0,O=0,T=[],B=[],J=null,I={},C=[],Z=[],L=[],ne=0,X;for(+y.codepage>=0&&ta(+y.codepage);S!==k.length;++S){ne=0;var W=k[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),ue=W.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),le=ue[0],re;if(W.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&B.push(W.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,K=!1,se=!1,R=!1,Y=-1,P=-1;for(O=1;O<ue.length;++O)switch(ue[O].charAt(0)){case"A":break;case"X":_=parseInt(ue[O].slice(1))-1,K=!0;break;case"Y":for(w=parseInt(ue[O].slice(1))-1,K||(_=0),X=T.length;X<=w;++X)T[X]=[];break;case"K":re=ue[O].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(na(re))?isNaN(ai(re).getDate())||(re=Or(re)):(re=na(re),J!==null&&di(J)&&(re=Gu(re))),he=!0;break;case"E":R=!0;var E=Zo(ue[O].slice(1),{r:w,c:_});T[w][_]=[T[w][_],E];break;case"S":se=!0,T[w][_]=[T[w][_],"S5S"];break;case"G":break;case"R":Y=parseInt(ue[O].slice(1))-1;break;case"C":P=parseInt(ue[O].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+W)}if(he&&(T[w][_]&&T[w][_].length==2?T[w][_][0]=re:T[w][_]=re,J=null),se){if(R)throw new Error("SYLK shared formula cannot have own formula");var j=Y>-1&&T[Y][P];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");T[w][_][1]=ey(j[1],{r:w-Y,c:_-P})}break;case"F":var M=0;for(O=1;O<ue.length;++O)switch(ue[O].charAt(0)){case"X":_=parseInt(ue[O].slice(1))-1,++M;break;case"Y":for(w=parseInt(ue[O].slice(1))-1,X=T.length;X<=w;++X)T[X]=[];break;case"M":ne=parseInt(ue[O].slice(1))/20;break;case"F":break;case"G":break;case"P":J=B[parseInt(ue[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=ue[O].slice(1).split(" "),X=parseInt(L[0],10);X<=parseInt(L[1],10);++X)ne=parseInt(L[2],10),Z[X-1]=ne===0?{hidden:!0}:{wch:ne},si(Z[X-1]);break;case"C":_=parseInt(ue[O].slice(1))-1,Z[_]||(Z[_]={});break;case"R":w=parseInt(ue[O].slice(1))-1,C[w]||(C[w]={}),ne>0?(C[w].hpt=ne,C[w].hpx=El(ne)):ne===0&&(C[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+W)}M<1&&(J=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+W)}}return C.length>0&&(I["!rows"]=C),Z.length>0&&(I["!cols"]=Z),y&&y.sheetRows&&(T=T.slice(0,y.sheetRows)),[T,I]}function l(g,y){var k=a(g,y),w=k[0],_=k[1],S=hi(w,y);return Ea(_).forEach(function(O){S[O]=_[O]}),S}function c(g,y){return Os(l(g,y),y)}function f(g,y,k,w){var _="C;Y"+(k+1)+";X"+(w+1)+";K";switch(g.t){case"n":_+=g.v||0,g.f&&!g.F&&(_+=";E"+RT(g.f,{r:k,c:w}));break;case"b":_+=g.v?"TRUE":"FALSE";break;case"e":_+=g.w||g.v;break;case"d":_+='"'+(g.w||g.v)+'"';break;case"s":_+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function p(g,y){y.forEach(function(k,w){var _="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?_+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Du(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Nu(k.wpx)),typeof k.wch=="number"&&(_+=Math.round(k.wch))),_.charAt(_.length-1)!=" "&&g.push(_)})}function d(g,y){y.forEach(function(k,w){var _="F;";k.hidden?_+="M0;":k.hpt?_+="M"+20*k.hpt+";":k.hpx&&(_+="M"+20*q1(k.hpx)+";"),_.length>2&&g.push(_+"R"+(w+1))})}function x(g,y){var k=["ID;PWXL;N;E"],w=[],_=lr(g["!ref"]),S,O=Array.isArray(g),T=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),g["!cols"]&&p(k,g["!cols"]),g["!rows"]&&d(k,g["!rows"]),k.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var B=_.s.r;B<=_.e.r;++B)for(var J=_.s.c;J<=_.e.c;++J){var I=dt({r:B,c:J});S=O?(g[B]||[])[J]:g[I],!(!S||S.v==null&&(!S.f||S.F))&&w.push(f(S,g,B,J))}return k.join(T)+T+w.join(T)+T+"E"+T}return{to_workbook:c,to_sheet:l,from_sheet:x}})(),XE=(function(){function e(o,l){switch(l.type){case"base64":return n(Tn(o),l);case"binary":return n(o,l);case"buffer":return n(yt&&Buffer.isBuffer(o)?o.toString("binary"):mo(o),l);case"array":return n(io(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,p=-1,d=0,x=[];d!==c.length;++d){if(c[d].trim()==="BOT"){x[++f]=[],p=0;continue}if(!(f<0)){var g=c[d].trim().split(","),y=g[0],k=g[1];++d;for(var w=c[d]||"";(w.match(/["]/g)||[]).length&1&&d<c.length-1;)w+=`
`+c[++d];switch(w=w.trim(),+y){case-1:if(w==="BOT"){x[++f]=[],p=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[f][p]=!0:w==="FALSE"?x[f][p]=!1:isNaN(na(k))?isNaN(ai(k).getDate())?x[f][p]=k:x[f][p]=Or(k):x[f][p]=na(k),++p;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[f][p++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function t(o,l){return hi(e(o,l),l)}function r(o,l){return Os(t(o,l),l)}var a=(function(){var o=function(f,p,d,x,g){f.push(p),f.push(d+","+x),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,p,d,x){f.push(p+","+d),f.push(p==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var p=[],d=lr(f["!ref"]),x,g=Array.isArray(f);o(p,"TABLE",0,1,"sheetjs"),o(p,"VECTORS",0,d.e.r-d.s.r+1,""),o(p,"TUPLES",0,d.e.c-d.s.c+1,""),o(p,"DATA",0,0,"");for(var y=d.s.r;y<=d.e.r;++y){l(p,-1,0,"BOT");for(var k=d.s.c;k<=d.e.c;++k){var w=dt({r:y,c:k});if(x=g?(f[y]||[])[k]:f[w],!x){l(p,1,0,"");continue}switch(x.t){case"n":var _=x.w;!_&&x.v!=null&&(_=x.v),_==null?x.f&&!x.F?l(p,1,0,"="+x.f):l(p,1,0,""):l(p,0,_,"V");break;case"b":l(p,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(p,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Un(x.z||pt[14],un(Or(x.v)))),l(p,0,x.w,"V");break;default:l(p,1,0,"")}}}l(p,-1,0,"EOD");var S=`\r
`,O=p.join(S);return O}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),QE=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(x,g){for(var y=x.split(`
`),k=-1,w=-1,_=0,S=[];_!==y.length;++_){var O=y[_].trim().split(":");if(O[0]==="cell"){var T=sn(O[1]);if(S.length<=T.r)for(k=S.length;k<=T.r;++k)S[k]||(S[k]=[]);switch(k=T.r,w=T.c,O[2]){case"t":S[k][w]=e(O[3]);break;case"v":S[k][w]=+O[3];break;case"vtf":var B=O[O.length-1];case"vtc":switch(O[3]){case"nl":S[k][w]=!!+O[4];break;default:S[k][w]=+O[4];break}O[2]=="vtf"&&(S[k][w]=[S[k][w],B])}}}return g&&g.sheetRows&&(S=S.slice(0,g.sheetRows)),S}function r(x,g){return hi(t(x,g),g)}function a(x,g){return Os(r(x,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function p(x){if(!x||!x["!ref"])return"";for(var g=[],y=[],k,w="",_=pi(x["!ref"]),S=Array.isArray(x),O=_.s.r;O<=_.e.r;++O)for(var T=_.s.c;T<=_.e.c;++T)if(w=dt({r:O,c:T}),k=S?(x[O]||[])[T]:x[w],!(!k||k.v==null||k.t==="z")){switch(y=["cell",w,"t"],k.t){case"s":case"str":y.push(n(k.v));break;case"n":k.f?(y[2]="vtf",y[3]="n",y[4]=k.v,y[5]=n(k.f)):(y[2]="v",y[3]=k.v);break;case"b":y[2]="vt"+(k.f?"f":"c"),y[3]="nl",y[4]=k.v?"1":"0",y[5]=n(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var B=un(Or(k.v));y[2]="vtc",y[3]="nd",y[4]=""+B,y[5]=k.w||Un(k.z||pt[14],B);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(x){return[o,l,c,l,p(x),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:d}})(),_l=(function(){function e(d,x,g,y,k){k.raw?x[g][y]=d:d===""||(d==="TRUE"?x[g][y]=!0:d==="FALSE"?x[g][y]=!1:isNaN(na(d))?isNaN(ai(d).getDate())?x[g][y]=d:x[g][y]=Or(d):x[g][y]=na(d))}function n(d,x){var g=x||{},y=[];if(!d||d.length===0)return y;for(var k=d.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var _=10,S=0,O=0;O<=w;++O)S=k[O].indexOf(" "),S==-1?S=k[O].length:S++,_=Math.max(_,S);for(O=0;O<=w;++O){y[O]=[];var T=0;for(e(k[O].slice(0,_).trim(),y,O,T,g),T=1;T<=(k[O].length-_)/10+1;++T)e(k[O].slice(_+(T-1)*10,_+T*10).trim(),y,O,T,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(d){for(var x={},g=!1,y=0,k=0;y<d.length;++y)(k=d.charCodeAt(y))==34?g=!g:!g&&k in t&&(x[k]=(x[k]||0)+1);k=[];for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y]);if(!k.length){x=r;for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y])}return k.sort(function(w,_){return w[0]-_[0]||r[w[1]]-r[_[1]]}),t[k.pop()[1]]||44}function o(d,x){var g=x||{},y="",k=g.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(y=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(y=d.charAt(4),d=d.slice(6)):y=a(d.slice(0,1024)):g&&g.FS?y=g.FS:y=a(d.slice(0,1024));var _=0,S=0,O=0,T=0,B=0,J=y.charCodeAt(0),I=!1,C=0,Z=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var L=g.dateNF!=null?i_(g.dateNF):null;function ne(){var X=d.slice(T,B),W={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)W.t="z";else if(g.raw)W.t="s",W.v=X;else if(X.trim().length===0)W.t="s",W.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(W.t="s",W.v=X.slice(2,-1).replace(/""/g,'"')):IT(X)?(W.t="n",W.f=X.slice(1)):(W.t="s",W.v=X);else if(X=="TRUE")W.t="b",W.v=!0;else if(X=="FALSE")W.t="b",W.v=!1;else if(!isNaN(O=na(X)))W.t="n",g.cellText!==!1&&(W.w=X),W.v=O;else if(!isNaN(ai(X).getDate())||L&&X.match(L)){W.z=g.dateNF||pt[14];var ue=0;L&&X.match(L)&&(X=l_(X,g.dateNF,X.match(L)||[]),ue=1),g.cellDates?(W.t="d",W.v=Or(X,ue)):(W.t="n",W.v=un(Or(X,ue))),g.cellText!==!1&&(W.w=Un(W.z,W.v instanceof Date?un(W.v):W.v)),g.cellNF||delete W.z}else W.t="s",W.v=X;if(W.t=="z"||(g.dense?(k[_]||(k[_]=[]),k[_][S]=W):k[dt({c:S,r:_})]=W),T=B+1,Z=d.charCodeAt(T),w.e.c<S&&(w.e.c=S),w.e.r<_&&(w.e.r=_),C==J)++S;else if(S=0,++_,g.sheetRows&&g.sheetRows<=_)return!0}e:for(;B<d.length;++B)switch(C=d.charCodeAt(B)){case 34:Z===34&&(I=!I);break;case J:case 10:case 13:if(!I&&ne())break e;break}return B-T>0&&ne(),k["!ref"]=bt(w),k}function l(d,x){return!(x&&x.PRN)||x.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?o(d,x):hi(n(d,x),x)}function c(d,x){var g="",y=x.type=="string"?[0,0,0,0]:Sp(d,x);switch(x.type){case"base64":g=Tn(d);break;case"binary":g=d;break;case"buffer":x.codepage==65001?g=d.toString("utf8"):x.codepage&&typeof vl<"u"||(g=yt&&Buffer.isBuffer(d)?d.toString("binary"):mo(d));break;case"array":g=io(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+x.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=Gt(g.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?g=Gt(g):x.type=="binary"&&typeof vl<"u",g.slice(0,19)=="socialcalc:version:"?QE.to_sheet(x.type=="string"?g:Gt(g),x):l(g,x)}function f(d,x){return Os(c(d,x),x)}function p(d){for(var x=[],g=lr(d["!ref"]),y,k=Array.isArray(d),w=g.s.r;w<=g.e.r;++w){for(var _=[],S=g.s.c;S<=g.e.c;++S){var O=dt({r:w,c:S});if(y=k?(d[w]||[])[S]:d[O],!y||y.v==null){_.push("          ");continue}for(var T=(y.w||(Ka(y),y.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(S===0?" ":""))}x.push(_.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:p}})();function qE(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=GE.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return _l.to_workbook(e,n)}}var pl=(function(){function e(E,j,M){if(E){jr(E,E.l||0);for(var U=M.Enum||Y;E.l<E.length;){var oe=E.read_shift(2),pe=U[oe]||U[65535],me=E.read_shift(2),ie=E.l+me,te=pe.f&&pe.f(E,me,M);if(E.l=ie,j(te,pe,oe))return}}}function n(E,j){switch(j.type){case"base64":return t(ea(Tn(E)),j);case"binary":return t(ea(E),j);case"buffer":case"array":return t(E,j)}throw"Unsupported type "+j.type}function t(E,j){if(!E)return E;var M=j||{},U=M.dense?[]:{},oe="Sheet1",pe="",me=0,ie={},te=[],ae=[],F={s:{r:0,c:0},e:{r:0,c:0}},Ce=M.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)M.Enum=Y,e(E,function(de,Ee,Ne){switch(Ne){case 0:M.vers=de,de>=4096&&(M.qpro=!0);break;case 6:F=de;break;case 204:de&&(pe=de);break;case 222:pe=de;break;case 15:case 51:M.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Ne==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=M.dateNF||pt[14],M.cellDates&&(de[1].t="d",de[1].v=Gu(de[1].v))),M.qpro&&de[3]>me&&(U["!ref"]=bt(F),ie[oe]=U,te.push(oe),U=M.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},me=de[3],oe=pe||"Sheet"+(me+1),pe="");var Le=M.dense?(U[de[0].r]||[])[de[0].c]:U[dt(de[0])];if(Le){Le.t=de[1].t,Le.v=de[1].v,de[1].z!=null&&(Le.z=de[1].z),de[1].f!=null&&(Le.f=de[1].f);break}M.dense?(U[de[0].r]||(U[de[0].r]=[]),U[de[0].r][de[0].c]=de[1]):U[dt(de[0])]=de[1];break}},M);else if(E[2]==26||E[2]==14)M.Enum=P,E[2]==14&&(M.qpro=!0,E.l=0),e(E,function(de,Ee,Ne){switch(Ne){case 204:oe=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>me&&(U["!ref"]=bt(F),ie[oe]=U,te.push(oe),U=M.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},me=de[3],oe="Sheet"+(me+1)),Ce>0&&de[0].r>=Ce)break;M.dense?(U[de[0].r]||(U[de[0].r]=[]),U[de[0].r][de[0].c]=de[1]):U[dt(de[0])]=de[1],F.e.c<de[0].c&&(F.e.c=de[0].c),F.e.r<de[0].r&&(F.e.r=de[0].r);break;case 27:de[14e3]&&(ae[de[14e3][0]]=de[14e3][1]);break;case 1537:ae[de[0]]=de[1],de[0]==me&&(oe=de[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(U["!ref"]=bt(F),ie[pe||oe]=U,te.push(pe||oe),!ae.length)return{SheetNames:te,Sheets:ie};for(var De={},He=[],q=0;q<ae.length;++q)ie[te[q]]?(He.push(ae[q]||te[q]),De[ae[q]]=ie[ae[q]]||ie[te[q]]):(He.push(ae[q]),De[ae[q]]={"!ref":"A1"});return{SheetNames:He,Sheets:De}}function r(E,j){var M=j||{};if(+M.codepage>=0&&ta(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Ed(),oe=lr(E["!ref"]),pe=Array.isArray(E),me=[];Jn(U,0,o(1030)),Jn(U,6,f(oe));for(var ie=Math.min(oe.e.r,8191),te=oe.s.r;te<=ie;++te)for(var ae=Br(te),F=oe.s.c;F<=oe.e.c;++F){te===oe.s.r&&(me[F]=Er(F));var Ce=me[F]+ae,De=pe?(E[te]||[])[F]:E[Ce];if(!(!De||De.t=="z"))if(De.t=="n")(De.v|0)==De.v&&De.v>=-32768&&De.v<=32767?Jn(U,13,y(te,F,De.v)):Jn(U,14,w(te,F,De.v));else{var He=Ka(De);Jn(U,15,x(te,F,He.slice(0,239)))}}return Jn(U,1),U.end()}function a(E,j){var M=j||{};if(+M.codepage>=0&&ta(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Ed();Jn(U,0,l(E));for(var oe=0,pe=0;oe<E.SheetNames.length;++oe)(E.Sheets[E.SheetNames[oe]]||{})["!ref"]&&Jn(U,27,R(E.SheetNames[oe],pe++));var me=0;for(oe=0;oe<E.SheetNames.length;++oe){var ie=E.Sheets[E.SheetNames[oe]];if(!(!ie||!ie["!ref"])){for(var te=lr(ie["!ref"]),ae=Array.isArray(ie),F=[],Ce=Math.min(te.e.r,8191),De=te.s.r;De<=Ce;++De)for(var He=Br(De),q=te.s.c;q<=te.e.c;++q){De===te.s.r&&(F[q]=Er(q));var de=F[q]+He,Ee=ae?(ie[De]||[])[q]:ie[de];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")Jn(U,23,ne(De,q,me,Ee.v));else{var Ne=Ka(Ee);Jn(U,22,C(De,q,me,Ne.slice(0,239)))}}++me}}return Jn(U,1),U.end()}function o(E){var j=br(2);return j.write_shift(2,E),j}function l(E){var j=br(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var M=0,U=0,oe=0,pe=0;pe<E.SheetNames.length;++pe){var me=E.SheetNames[pe],ie=E.Sheets[me];if(!(!ie||!ie["!ref"])){++oe;var te=pi(ie["!ref"]);M<te.e.r&&(M=te.e.r),U<te.e.c&&(U=te.e.c)}}return M>8191&&(M=8191),j.write_shift(2,M),j.write_shift(1,oe),j.write_shift(1,U),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function c(E,j,M){var U={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&M.qpro?(U.s.c=E.read_shift(1),E.l++,U.s.r=E.read_shift(2),U.e.c=E.read_shift(1),E.l++,U.e.r=E.read_shift(2),U):(U.s.c=E.read_shift(2),U.s.r=E.read_shift(2),j==12&&M.qpro&&(E.l+=2),U.e.c=E.read_shift(2),U.e.r=E.read_shift(2),j==12&&M.qpro&&(E.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function f(E){var j=br(8);return j.write_shift(2,E.s.c),j.write_shift(2,E.s.r),j.write_shift(2,E.e.c),j.write_shift(2,E.e.r),j}function p(E,j,M){var U=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(U[0].c=E.read_shift(1),U[3]=E.read_shift(1),U[0].r=E.read_shift(2),E.l+=2):(U[2]=E.read_shift(1),U[0].c=E.read_shift(2),U[0].r=E.read_shift(2)),U}function d(E,j,M){var U=E.l+j,oe=p(E,j,M);if(oe[1].t="s",M.vers==20768){E.l++;var pe=E.read_shift(1);return oe[1].v=E.read_shift(pe,"utf8"),oe}return M.qpro&&E.l++,oe[1].v=E.read_shift(U-E.l,"cstr"),oe}function x(E,j,M){var U=br(7+M.length);U.write_shift(1,255),U.write_shift(2,j),U.write_shift(2,E),U.write_shift(1,39);for(var oe=0;oe<U.length;++oe){var pe=M.charCodeAt(oe);U.write_shift(1,pe>=128?95:pe)}return U.write_shift(1,0),U}function g(E,j,M){var U=p(E,j,M);return U[1].v=E.read_shift(2,"i"),U}function y(E,j,M){var U=br(7);return U.write_shift(1,255),U.write_shift(2,j),U.write_shift(2,E),U.write_shift(2,M,"i"),U}function k(E,j,M){var U=p(E,j,M);return U[1].v=E.read_shift(8,"f"),U}function w(E,j,M){var U=br(13);return U.write_shift(1,255),U.write_shift(2,j),U.write_shift(2,E),U.write_shift(8,M,"f"),U}function _(E,j,M){var U=E.l+j,oe=p(E,j,M);if(oe[1].v=E.read_shift(8,"f"),M.qpro)E.l=U;else{var pe=E.read_shift(2);B(E.slice(E.l,E.l+pe),oe),E.l+=pe}return oe}function S(E,j,M){var U=j&32768;return j&=-32769,j=(U?E:0)+(j>=8192?j-16384:j),(U?"":"$")+(M?Er(j):Br(j))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function B(E,j){jr(E,0);for(var M=[],U=0,oe="",pe="",me="",ie="";E.l<E.length;){var te=E[E.l++];switch(te){case 0:M.push(E.read_shift(8,"f"));break;case 1:pe=S(j[0].c,E.read_shift(2),!0),oe=S(j[0].r,E.read_shift(2),!1),M.push(pe+oe);break;case 2:{var ae=S(j[0].c,E.read_shift(2),!0),F=S(j[0].r,E.read_shift(2),!1);pe=S(j[0].c,E.read_shift(2),!0),oe=S(j[0].r,E.read_shift(2),!1),M.push(ae+F+":"+pe+oe)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(E.read_shift(2));break;case 6:{for(var Ce="";te=E[E.l++];)Ce+=String.fromCharCode(te);M.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ie=M.pop(),me=M.pop(),M.push(["AND","OR"][te-20]+"("+me+","+ie+")");break;default:if(te<32&&T[te])ie=M.pop(),me=M.pop(),M.push(me+T[te]+ie);else if(O[te]){if(U=O[te][1],U==69&&(U=E[E.l++]),U>M.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+M.join("|")+"|");return}var De=M.slice(-U);M.length-=U,M.push(O[te][0]+"("+De.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}M.length==1?j[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function J(E){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=E.read_shift(2),j[3]=E[E.l++],j[0].c=E[E.l++],j}function I(E,j){var M=J(E);return M[1].t="s",M[1].v=E.read_shift(j-4,"cstr"),M}function C(E,j,M,U){var oe=br(6+U.length);oe.write_shift(2,E),oe.write_shift(1,M),oe.write_shift(1,j),oe.write_shift(1,39);for(var pe=0;pe<U.length;++pe){var me=U.charCodeAt(pe);oe.write_shift(1,me>=128?95:me)}return oe.write_shift(1,0),oe}function Z(E,j){var M=J(E);M[1].v=E.read_shift(2);var U=M[1].v>>1;if(M[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return M[1].v=U,M}function L(E,j){var M=J(E),U=E.read_shift(4),oe=E.read_shift(4),pe=E.read_shift(2);if(pe==65535)return U===0&&oe===3221225472?(M[1].t="e",M[1].v=15):U===0&&oe===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var me=pe&32768;return pe=(pe&32767)-16446,M[1].v=(1-me*2)*(oe*Math.pow(2,pe+32)+U*Math.pow(2,pe)),M}function ne(E,j,M,U){var oe=br(14);if(oe.write_shift(2,E),oe.write_shift(1,M),oe.write_shift(1,j),U==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var pe=0,me=0,ie=0,te=0;return U<0&&(pe=1,U=-U),me=Math.log2(U)|0,U/=Math.pow(2,me-31),te=U>>>0,(te&2147483648)==0&&(U/=2,++me,te=U>>>0),U-=te,te|=2147483648,te>>>=0,U*=Math.pow(2,32),ie=U>>>0,oe.write_shift(4,ie),oe.write_shift(4,te),me+=16383+(pe?32768:0),oe.write_shift(2,me),oe}function X(E,j){var M=L(E);return E.l+=j-14,M}function W(E,j){var M=J(E),U=E.read_shift(4);return M[1].v=U>>6,M}function ue(E,j){var M=J(E),U=E.read_shift(8,"f");return M[1].v=U,M}function le(E,j){var M=ue(E);return E.l+=j-10,M}function re(E,j){return E[E.l+j-1]==0?E.read_shift(j,"cstr"):""}function he(E,j){var M=E[E.l++];M>j-1&&(M=j-1);for(var U="";U.length<M;)U+=String.fromCharCode(E[E.l++]);return U}function K(E,j,M){if(!(!M.qpro||j<21)){var U=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var oe=E.read_shift(j-21,"cstr");return[U,oe]}}function se(E,j){for(var M={},U=E.l+j;E.l<U;){var oe=E.read_shift(2);if(oe==14e3){for(M[oe]=[0,""],M[oe][0]=E.read_shift(2);E[E.l];)M[oe][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return M}function R(E,j){var M=br(5+E.length);M.write_shift(2,14e3),M.write_shift(2,j);for(var U=0;U<E.length;++U){var oe=E.charCodeAt(U);M[M.l++]=oe>127?95:oe}return M[M.l++]=0,M}var Y={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},P={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:Z},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function ZE(e){var n={},t=e.match(qr),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=lt(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=tp[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var JE=(function(){var e=wl("t"),n=wl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:Nt(l[1])},f=o.match(n);return f&&(c.s=ZE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),eS=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),tS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,rS=/<(?:\w+:)?r>/,nS=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Nt(Gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Gt(e),t&&(r.h=lp(r.t))):e.match(rS)&&(r.r=Gt(e),r.t=Nt(Gt((e.replace(nS,"").match(tS)||[]).join("").replace(qr,""))),t&&(r.h=eS(JE(r.r)))),r):{t:""}}var aS=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sS=/<(?:\w+:)?(?:si|sstItem)>/g,oS=/<\/(?:\w+:)?(?:si|sstItem)>/;function iS(e,n){var t=[],r="";if(!e)return t;var a=e.match(aS);if(a){r=a[2].replace(sS,"").split(oS);for(var o=0;o!=r.length;++o){var l=vp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=lt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function lS(e){return[e.read_shift(4),e.read_shift(4)]}function cS(e,n){var t=[],r=!1;return Xa(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Y1(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Wa(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function uS(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function fS(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function dS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(fS(e));return n}function pS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function hS(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function mS(e){var n=hS(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function V1(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function K1(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function xS(e){var n=Wa(e);switch(n.Minor){case 2:return[n.Minor,gS(e)];case 3:return[n.Minor,vS()];case 4:return[n.Minor,yS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function gS(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=V1(e,t),a=K1(e,e.length-e.l);return{t:"Std",h:r,v:a}}function vS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yS(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(qr,function(o){var l=lt(o);switch(Ta(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function wS(e,n){var t={},r=t.EncryptionVersionInfo=Wa(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=V1(e,a),n-=a,t.EncryptionVerifier=K1(e,n),t}function kS(e){var n={},t=n.EncryptionVersionInfo=Wa(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function _S(e){var n=0,t,r=Y1(e),a=r.length+1,o,l,c,f,p;for(t=Cs(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,p=c|f,n=p^l;return n^52811}var G1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,p=l.length-1;p>=0;--p)for(var d=l[p],x=0;x!=7;++x)d&64&&(c^=t[f]),d*=2,--f;return c};return function(l){for(var c=Y1(l),f=o(c),p=c.length,d=Cs(16),x=0;x!=16;++x)d[x]=0;var g,y,k;for((p&1)===1&&(g=f>>8,d[p]=a(e[0],g),--p,g=f&255,y=c[c.length-1],d[p]=a(y,g));p>0;)--p,g=f>>8,d[p]=a(c[p],g),--p,g=f&255,d[p]=a(c[p],g);for(p=15,k=15-c.length;k>0;)g=f>>8,d[p]=a(e[k],g),--p,--k,g=f&255,d[p]=a(c[p],g),--p,--k;return d}})(),bS=function(e,n,t,r,a){a||(a=n),r||(r=G1(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},ES=function(e){var n=0,t=G1(e);return function(r){var a=bS("",r,n,t);return n=a[1],a[0]}};function SS(e,n,t,r){var a={key:yr(e),verificationBytes:yr(e)};return t.password&&(a.verifier=_S(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=ES(t.password)),a}function TS(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=kS(e):r.Data=wS(e,n),r}function CS(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?TS(e,n-2,r):SS(e,t.biff>=8?n:n-2,t,r),r}var DS=(function(){function e(a,o){switch(o.type){case"base64":return n(Tn(a),o);case"binary":return n(a,o);case"buffer":return n(yt&&Buffer.isBuffer(a)?a.toString("binary"):mo(a),o);case"array":return n(io(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(d,x){Array.isArray(c)&&(c[x]=[]);for(var g=/\\\w+\b/g,y=0,k,w=-1;k=g.exec(d);){switch(k[0]){case"\\cell":var _=d.slice(y,g.lastIndex-k[0].length);if(_[0]==" "&&(_=_.slice(1)),++w,_.length){var S={v:_,t:"s"};Array.isArray(c)?c[x][w]=S:c[dt({r:x,c:w})]=S}break}y=g.lastIndex}w>p.e.c&&(p.e.c=w)}),c["!ref"]=bt(p),c}function t(a,o){return Os(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=lr(a["!ref"]),c,f=Array.isArray(a),p=l.s.r;p<=l.e.r;++p){o.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)o.push("\\cellx"+(d+1));for(o.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var x=dt({r:p,c:d});c=f?(a[p]||[])[d]:a[x],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Ka(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function NS(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function bl(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function FS(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,p=a+o;switch(f=l/(p>1?2-p:p),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,p/2]}function AS(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var p=0;p!=3;++p)l[p]=Math.round(l[p]*255);return l}function Cu(e,n){if(n===0)return e;var t=FS(NS(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),bl(AS(t))}var X1=6,OS=15,PS=1,nn=X1;function Du(e){return Math.floor((e+Math.round(128/nn)/256)*nn)}function Nu(e){return Math.floor((e-5)/nn*100+.5)/100}function Dd(e){return Math.round((e*nn+5)/nn*256)/256}function td(e){return Dd(Nu(Du(e)))}function yp(e){var n=Math.abs(e-td(e)),t=nn;if(n>.005)for(nn=PS;nn<OS;++nn)Math.abs(e-td(e))<=n&&(n=Math.abs(e-td(e)),t=nn);nn=t}function si(e){e.width?(e.wpx=Du(e.width),e.wch=Nu(e.wpx),e.MDW=nn):e.wpx?(e.wch=Nu(e.wpx),e.width=Dd(e.wch),e.MDW=nn):typeof e.wch=="number"&&(e.width=Dd(e.wch),e.wpx=Du(e.width),e.MDW=nn),e.customWidth&&delete e.customWidth}var RS=96,Q1=RS;function q1(e){return e*96/Q1}function El(e){return e*Q1/96}var MS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IS(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(qr)||[]).forEach(function(l){var c=lt(l);switch(Ta(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=er(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=er(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function jS(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(qr)||[]).forEach(function(l){var c=lt(l);switch(Ta(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function LS(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(qr)||[]).forEach(function(l){var c=lt(l);switch(Ta(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Gt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?er(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?er(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?er(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?er(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?er(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?er(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?er(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=tp[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=er(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=to[a.color.index];a.color.index==81&&(f=to[1]),f||(f=to[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Cu(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function zS(e,n,t){n.NumberFmt=[];for(var r=Ea(pt),a=0;a<r.length;++a)n.NumberFmt[r[a]]=pt[r[a]];var o=e[0].match(qr);if(o)for(a=0;a<o.length;++a){var l=lt(o[a]);switch(Ta(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Nt(Gt(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}eo(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var ru=["numFmtId","fillId","fontId","borderId","xfId"],nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BS(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(qr)||[]).forEach(function(o){var l=lt(o),c=0;switch(Ta(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<ru.length;++c)r[ru[c]]&&(r[ru[c]]=parseInt(r[ru[c]],10));for(c=0;c<nu.length;++c)r[nu[c]]&&(r[nu[c]]=er(r[nu[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=er(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var WS=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,p){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=c.match(n))&&zS(x,d,p),(x=c.match(a))&&LS(x,d,f,p),(x=c.match(r))&&jS(x,d,f,p),(x=c.match(o))&&IS(x,d,f,p),(x=c.match(t))&&BS(x,d,p),d}})();function US(e,n){var t=e.read_shift(2),r=Xr(e);return[t,r]}function HS(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=J_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=Z_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Xr(e),r}var $S=Qr;function YS(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var VS=Qr;function KS(e,n,t){var r={};r.NumberFmt=[];for(var a in pt)r.NumberFmt[a]=pt[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return Xa(e,function(f,p,d){switch(d){case 44:r.NumberFmt[f[0]]=f[1],eo(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=Cu(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(d),l=!0;break;case 38:o.pop(),l=!1;break;default:if(p.T>0)o.push(d);else if(p.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}var GS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function XS(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(qr)||[]).forEach(function(a){var o=lt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[GS.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function QS(){}function qS(){}var ZS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tT(e,n,t){n.themeElements={};var r;[["clrScheme",ZS,XS],["fontScheme",JS,QS],["fmtScheme",eT,qS]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var rT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Z1(e,n){(!e||e.length===0)&&(e=nT());var t,r={};if(!(t=e.match(rT)))throw new Error("themeElements not found in theme");return tT(t[0],r,n),r.raw=e,r}function nT(e,n){var t=[c1];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function aT(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=l1(o,{type:"array"})}catch{return}var c=En(l,"theme/theme/theme1.xml",!0);if(c)return Z1(c,t)}}function sT(e){return e.read_shift(4)}function oT(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=iT(e,4);break;case 2:n.xclrValue=L1(e);break;case 3:n.xclrValue=sT(e);break;case 4:e.l+=4;break}return e.l+=8,n}function iT(e,n){return Qr(e,n)}function lT(e,n){return Qr(e,n)}function cT(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=oT(e);break;case 6:r[1]=lT(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function uT(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(cT(e,t-e.l));return{ixfe:r,ext:o}}function fT(e,n){n.forEach(function(t){t[0]})}function dT(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Xr(e)}}function pT(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function hT(e){return e.l+=4,e.read_shift(4)!=0}function mT(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return Xa(e,function(f,p,d){switch(d){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(x){c==1?r.Cell.push({type:r.Types[x[0]-1].name,index:x[1]}):c==0&&r.Value.push({type:r.Types[x[0]-1].name,index:x[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(d),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!p.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function xT(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(qr,function(c){var f=lt(c);switch(Ta(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var p=0;p<r.Types.length;++p)r.Types[p].name==f.name&&(l=r.Types[p]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function gT(e){var n=[];if(!e)return n;var t=1;return(e.match(qr)||[]).forEach(function(r){var a=lt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function vT(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=dt(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function yT(e,n,t){var r=[];return Xa(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function wT(e,n,t,r){if(!e)return e;var a=r||{},o=!1;Xa(e,function(c,f,p){switch(p){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}},a)}function kT(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function bg(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=sn(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=lr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var p=bt(f);p!==e["!ref"]&&(e["!ref"]=p)}o.c||(o.c=[]);var d={a:l.author,t:l.t,r:l.r,T:t};l.h&&(d.h=l.h);for(var x=o.c.length-1;x>=0;--x){if(!t&&o.c[x].T)return;t&&!o.c[x].T&&o.c.splice(x,1)}if(t&&r){for(x=0;x<r.length;++x)if(d.a==r[x].id){d.a=r[x].name||d.a;break}}o.c.push(d)})}function _T(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=lt(c[0]),p={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},d=sn(f.ref);if(!(n.sheetRows&&n.sheetRows<=d.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!x&&!!x[1]&&vp(x[1])||{r:"",t:"",h:""};p.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),p.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(p.h=g.h),r.push(p)}}}}),r}function bT(e,n){var t=[],r=!1,a={},o=0;return e.replace(qr,function(c,f){var p=lt(c);switch(Ta(p[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:p.personId,guid:p.id,ref:p.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in threaded comments")}return c}),t}function ET(e,n){var t=[],r=!1;return e.replace(qr,function(o){var l=lt(o);switch(Ta(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function ST(e){var n={};n.iauthor=e.read_shift(4);var t=go(e);return n.rfx=t.s,n.ref=dt(t.s),e.l+=16,n}var TT=Xr;function CT(e,n){var t=[],r=[],a={},o=!1;return Xa(e,function(c,f,p){switch(p){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}),t}var DT="application/vnd.ms-office.vbaProject";function NT(e){var n=_t.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_t.utils.cfb_add(n,a,e.FileIndex[r].content)}}),_t.write(n)}function FT(){return{"!type":"dialog"}}function AT(){return{"!type":"dialog"}}function OT(){return{"!type":"macro"}}function PT(){return{"!type":"macro"}}var Zo=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var p=o.length>0?parseInt(o,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return c?d+=n.c:--d,f?p+=n.r:--p,a+(c?"":"$")+Er(d)+(f?"":"$")+Br(p)}return function(a,o){return n=o,a.replace(e,t)}})(),J1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,RT=(function(){return function(n,t){return n.replace(J1,function(r,a,o,l,c,f){var p=dp(l)-(o?0:t.c),d=fp(f)-(c?0:t.r),x=d==0?"":c?d+1:"["+d+"]",g=p==0?"":o?p+1:"["+p+"]";return a+"R"+x+"C"+g})}})();function ey(e,n){return e.replace(J1,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Er(dp(o)+n.c))+(l=="$"?l+c:Br(fp(c)+n.r))})}function MT(e,n,t){var r=pi(n),a=r.s,o=sn(t),l={r:o.r-a.r,c:o.c-a.c};return ey(e,l)}function IT(e){return e.length!=1}function Eg(e){return e.replace(/_xlfn\./g,"")}function gr(e){e.l+=1}function Ds(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function ty(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return ry(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Ds(e),c=Ds(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function ry(e){var n=Ds(e),t=Ds(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function jT(e,n,t){if(t.biff<8)return ry(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=Ds(e),l=Ds(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ny(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return LT(e);var r=e.read_shift(t&&t.biff==12?4:2),a=Ds(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function LT(e){var n=Ds(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function zT(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function BT(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return WT(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function WT(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function UT(e,n,t){var r=(e[e.l++]&96)>>5,a=ty(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function HT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=ty(e,o,t);return[r,a,l]}function $T(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function YT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function VT(e,n,t){var r=(e[e.l++]&96)>>5,a=jT(e,n-1,t);return[r,a]}function KT(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Sg(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function GT(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function XT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function QT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function qT(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function ZT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function ay(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function JT(e){return e.read_shift(2),ay(e)}function eC(e){return e.read_shift(2),ay(e)}function tC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=ny(e,0,t);return[r,a]}function rC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=BT(e,0,t);return[r,a]}function nC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=ny(e,0,t);return[r,a,o]}function aC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[sD[a],iy[a],r]}function sC(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:oC(e);return[a,(o[0]===0?iy:aD)[o[1]]]}function oC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function iC(e,n,t){e.l+=t&&t.biff==2?3:4}function lC(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function cC(e){return e.l++,vo[e.read_shift(1)]}function uC(e){return e.l++,e.read_shift(2)}function fC(e){return e.l++,e.read_shift(1)!==0}function dC(e){return e.l++,Kr(e)}function pC(e,n,t){return e.l++,Al(e,n-1,t)}function hC(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=pr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=vo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Kr(e);break;case 2:t[1]=yo(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function mC(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?go:Xu)(e));return a}function xC(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=hC(e,t.biff);return l}function gC(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function vC(e,n,t){if(t.biff==5)return yC(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function yC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function wC(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function kC(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function _C(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function bC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var EC=Qr,SC=Qr,TC=Qr;function Pl(e,n,t){return e.l+=2,[zT(e)]}function wp(e){return e.l+=6,[]}var CC=Pl,DC=wp,NC=wp,FC=Pl;function sy(e){return e.l+=2,[yr(e),e.read_shift(2)&1]}var AC=Pl,OC=sy,PC=wp,RC=Pl,MC=Pl,IC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jC(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=IC[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function LC(e){return e.l+=2,[e.read_shift(4)]}function zC(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function BC(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function WC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function UC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function HC(e){return e.l+=4,[0,0]}var Tg={1:{n:"PtgExp",f:lC},2:{n:"PtgTbl",f:TC},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:pC},26:{n:"PtgSheet",f:zC},27:{n:"PtgEndSheet",f:BC},28:{n:"PtgErr",f:cC},29:{n:"PtgBool",f:fC},30:{n:"PtgInt",f:uC},31:{n:"PtgNum",f:dC},32:{n:"PtgArray",f:KT},33:{n:"PtgFunc",f:aC},34:{n:"PtgFuncVar",f:sC},35:{n:"PtgName",f:gC},36:{n:"PtgRef",f:tC},37:{n:"PtgArea",f:UT},38:{n:"PtgMemArea",f:wC},39:{n:"PtgMemErr",f:EC},40:{n:"PtgMemNoMem",f:SC},41:{n:"PtgMemFunc",f:kC},42:{n:"PtgRefErr",f:_C},43:{n:"PtgAreaErr",f:$T},44:{n:"PtgRefN",f:rC},45:{n:"PtgAreaN",f:VT},46:{n:"PtgMemAreaN",f:WC},47:{n:"PtgMemNoMemN",f:UC},57:{n:"PtgNameX",f:vC},58:{n:"PtgRef3d",f:nC},59:{n:"PtgArea3d",f:HT},60:{n:"PtgRefErr3d",f:bC},61:{n:"PtgAreaErr3d",f:YT},255:{}},$C={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YC={1:{n:"PtgElfLel",f:sy},2:{n:"PtgElfRw",f:RC},3:{n:"PtgElfCol",f:CC},6:{n:"PtgElfRwV",f:MC},7:{n:"PtgElfColV",f:FC},10:{n:"PtgElfRadical",f:AC},11:{n:"PtgElfRadicalS",f:PC},13:{n:"PtgElfColS",f:DC},15:{n:"PtgElfColSV",f:NC},16:{n:"PtgElfRadicalLel",f:OC},25:{n:"PtgList",f:jC},29:{n:"PtgSxName",f:LC},255:{}},VC={0:{n:"PtgAttrNoop",f:HC},1:{n:"PtgAttrSemi",f:ZT},2:{n:"PtgAttrIf",f:QT},4:{n:"PtgAttrChoose",f:GT},8:{n:"PtgAttrGoto",f:XT},16:{n:"PtgAttrSum",f:iC},32:{n:"PtgAttrBaxcel",f:Sg},33:{n:"PtgAttrBaxcel",f:Sg},64:{n:"PtgAttrSpace",f:JT},65:{n:"PtgAttrSpaceSemi",f:eC},128:{n:"PtgAttrIfError",f:qT},255:{}};function Rl(e,n,t,r){if(r.biff<8)return Qr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=xC(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=mC(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(Qr(e,n)),o}function Ml(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Tg[o]||Tg[$C[o]],(o===24||o===25)&&(a=(o===24?YC:VC)[e[e.l+1]]),!a||!a.f?Qr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function KC(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var GC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XC(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function oy(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Cg(e,n,t){var r=oy(e,n,t);return r=="#REF"?r:XC(r,t)}function Vr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,p,d,x=0,g=0,y,k="";if(!e[0]||!e[0][0])return"";for(var w=-1,_="",S=0,O=e[0].length;S<O;++S){var T=e[0][S];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),p=c.pop(),w>=0){switch(e[0][w][1][0]){case 0:_=ir(" ",e[0][w][1][1]);break;case 1:_=ir("\r",e[0][w][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}p=p+_,w=-1}c.push(p+GC[T[0]]+f);break;case"PtgIsect":f=c.pop(),p=c.pop(),c.push(p+" "+f);break;case"PtgUnion":f=c.pop(),p=c.pop(),c.push(p+","+f);break;case"PtgRange":f=c.pop(),p=c.pop(),c.push(p+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=cl(T[1][1],l,a),c.push(ul(d,o));break;case"PtgRefN":d=t?cl(T[1][1],t,a):T[1][1],c.push(ul(d,o));break;case"PtgRef3d":x=T[1][1],d=cl(T[1][2],l,a),k=Cg(r,x,a),c.push(k+"!"+ul(d,o));break;case"PtgFunc":case"PtgFuncVar":var B=T[1][0],J=T[1][1];B||(B=0),B&=127;var I=B==0?[]:c.slice(-B);c.length-=B,J==="User"&&(J=I.shift()),c.push(J+"("+I.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":y=ig(T[1][1],t?{s:t}:l,a),c.push(J0(y,a));break;case"PtgArea":y=ig(T[1][1],l,a),c.push(J0(y,a));break;case"PtgArea3d":x=T[1][1],y=T[1][2],k=Cg(r,x,a),c.push(k+"!"+J0(y,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=T[1][2];var C=(r.names||[])[g-1]||(r[0]||[])[g],Z=C?C.Name:"SH33TJSNAME"+String(g);Z&&Z.slice(0,6)=="_xlfn."&&!a.xlfn&&(Z=Z.slice(6)),c.push(Z);break;case"PtgNameX":var L=T[1][1];g=T[1][2];var ne;if(a.biff<=5)L<0&&(L=-L),r[L]&&(ne=r[L][g]);else{var X="";if(((r[L]||[])[0]||[])[0]==14849||(((r[L]||[])[0]||[])[0]==1025?r[L][g]&&r[L][g].itab>0&&(X=r.SheetNames[r[L][g].itab-1]+"!"):X=r.SheetNames[g-1]+"!"),r[L]&&r[L][g])X+=r[L][g].Name;else if(r[0]&&r[0][g])X+=r[0][g].Name;else{var W=(oy(r,L,a)||"").split(";;");W[g-1]?X=W[g-1]:X+="SH33TJSERRX"}c.push(X);break}ne||(ne={Name:"SH33TJSERRY"}),c.push(ne.Name);break;case"PtgParen":var ue="(",le=")";if(w>=0){switch(_="",e[0][w][1][0]){case 2:ue=ir(" ",e[0][w][1][1])+ue;break;case 3:ue=ir("\r",e[0][w][1][1])+ue;break;case 4:le=ir(" ",e[0][w][1][1])+le;break;case 5:le=ir("\r",e[0][w][1][1])+le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}c.push(ue+c.pop()+le);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var re={c:t.c,r:t.r};if(r.sharedf[dt(d)]){var he=r.sharedf[dt(d)];c.push(Vr(he,l,re,r,a))}else{var K=!1;for(f=0;f!=r.arrayf.length;++f)if(p=r.arrayf[f],!(d.c<p[0].s.c||d.c>p[0].e.c)&&!(d.r<p[0].s.r||d.r>p[0].e.r)){c.push(Vr(p[1],l,re,r,a)),K=!0;break}K||c.push(T[1])}break;case"PtgArray":c.push("{"+KC(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&se.indexOf(e[0][S][0])==-1){T=e[0][w];var R=!0;switch(T[1][0]){case 4:R=!1;case 0:_=ir(" ",T[1][1]);break;case 5:R=!1;case 1:_=ir("\r",T[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((R?_:"")+c.pop()+(R?"":_)),w=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function QC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Qr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function qC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Qr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function ZC(e,n,t,r){var a=e.l+n,o=Ml(e,r,t),l;return a!==e.l&&(l=Rl(e,a-e.l,o,t)),[o,l]}function JC(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=Ml(e,o,t);return o==65535?[[],Qr(e,n-2)]:(n!==o+2&&(a=Rl(e,r-o-2,l,t)),[l,a])}function eD(e){var n;if(za(e,e.l+6)!==65535)return[Kr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function rd(e,n,t){var r=e.l+n,a=Ca(e);t.biff==2&&++e.l;var o=eD(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=qC(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function Qu(e,n,t){var r=e.read_shift(4),a=Ml(e,r,t),o=e.read_shift(4),l=o>0?Rl(e,o,a,t):null;return[a,l]}var tD=Qu,qu=Qu,rD=Qu,nD=Qu,aD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function nd(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var hl={},Jo={};function ml(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ly(e,n,t,r,a,o){try{r.cellNF&&(e.z=pt[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Or(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(pt[n]==null&&eo(o_[n]||"General",n),e.t==="e")e.w=e.w||vo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v);else if(e.t==="d"){var l=un(e.v);(l|0)===l?e.w=l.toString(10):e.w=yl(l)}else{if(e.v===void 0)return"";e.w=oo(e.v,Jo)}else e.t==="d"?e.w=Un(n,un(e.v),Jo):e.w=Un(n,e.v,Jo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Cu(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Cu(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function oD(e,n){var t=lr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=bt(t))}var iD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,lD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cD=/<(?:\w:)?hyperlink [^>]*>/mg,uD=/"(\w*:\w*)"/,fD=/<(?:\w:)?col\b[^>]*[\/]?>/g,dD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pD=/<(?:\w:)?pageMargins[^>]*\/>/g,cy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xD(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p="",d="",x=e.match(lD);x?(p=e.slice(0,x.index),d=e.slice(x.index+x[0].length)):p=d=e;var g=p.match(cy);g?kp(g[0],c,a,t):(g=p.match(hD))&&gD(g[0],g[1]||"",c,a,t);var y=(p.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var k=p.slice(y,y+50).match(uD);k&&oD(c,k[1])}var w=p.match(mD);w&&w[1]&&bD(w[1],a);var _=[];if(n.cellStyles){var S=p.match(fD);S&&wD(_,S)}x&&ED(x[1],c,n,f,o,l);var O=d.match(dD);O&&(c["!autofilter"]=kD(O[0]));var T=[],B=d.match(iD);if(B)for(y=0;y!=B.length;++y)T[y]=lr(B[y].slice(B[y].indexOf('"')+1));var J=d.match(cD);J&&vD(c,J,r);var I=d.match(pD);if(I&&(c["!margins"]=yD(lt(I[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=bt(f)),n.sheetRows>0&&c["!ref"]){var C=lr(c["!ref"]);n.sheetRows<=+C.e.r&&(C.e.r=n.sheetRows-1,C.e.r>f.e.r&&(C.e.r=f.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>f.e.c&&(C.e.c=f.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),c["!fullref"]=c["!ref"],c["!ref"]=bt(C))}return _.length>0&&(c["!cols"]=_),T.length>0&&(c["!merges"]=T),c}function kp(e,n,t,r){var a=lt(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=Nt(Gt(a.codeName)))}function gD(e,n,t,r,a){kp(e.slice(0,e.indexOf(">")),t,r,a)}function vD(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=lt(Gt(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Nt(o.location))):(o.Target="#"+Nt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=lr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var p=c.s.c;p<=c.e.c;++p){var d=dt({c:p,r:f});r?(e[f]||(e[f]=[]),e[f][p]||(e[f][p]={t:"z",v:void 0}),e[f][p].l=o):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=o)}}}function yD(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function wD(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=lt(n[r],!0);a.hidden&&(a.hidden=er(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,yp(a.width)),si(a);o<=l;)e[o++]=zr(a)}}function kD(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var _D=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bD(e,n){n.Views||(n.Views=[{}]),(e.match(_D)||[]).forEach(function(t,r){var a=lt(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),er(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var ED=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=wl("v"),l=wl("f");return function(f,p,d,x,g,y){for(var k=0,w="",_=[],S=[],O=0,T=0,B=0,J="",I,C,Z=0,L=0,ne,X,W=0,ue=0,le=Array.isArray(y.CellXf),re,he=[],K=[],se=Array.isArray(p),R=[],Y={},P=!1,E=!!d.sheetStubs,j=f.split(n),M=0,U=j.length;M!=U;++M){w=j[M].trim();var oe=w.length;if(oe!==0){var pe=0;e:for(k=0;k<oe;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(d&&d.cellStyles){if(C=lt(w.slice(pe,k),!0),Z=C.r!=null?parseInt(C.r,10):Z+1,L=-1,d.sheetRows&&d.sheetRows<Z)continue;Y={},P=!1,C.ht&&(P=!0,Y.hpt=parseFloat(C.ht),Y.hpx=El(Y.hpt)),C.hidden=="1"&&(P=!0,Y.hidden=!0),C.outlineLevel!=null&&(P=!0,Y.level=+C.outlineLevel),P&&(R[Z-1]=Y)}break;case"<":pe=k;break}if(pe>=k)break;if(C=lt(w.slice(pe,k),!0),Z=C.r!=null?parseInt(C.r,10):Z+1,L=-1,!(d.sheetRows&&d.sheetRows<Z)){x.s.r>Z-1&&(x.s.r=Z-1),x.e.r<Z-1&&(x.e.r=Z-1),d&&d.cellStyles&&(Y={},P=!1,C.ht&&(P=!0,Y.hpt=parseFloat(C.ht),Y.hpx=El(Y.hpt)),C.hidden=="1"&&(P=!0,Y.hidden=!0),C.outlineLevel!=null&&(P=!0,Y.level=+C.outlineLevel),P&&(R[Z-1]=Y)),_=w.slice(k).split(e);for(var me=0;me!=_.length&&_[me].trim().charAt(0)=="<";++me);for(_=_.slice(me),k=0;k!=_.length;++k)if(w=_[k].trim(),w.length!==0){if(S=w.match(t),O=k,T=0,B=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,S!=null&&S.length===2){for(O=0,J=S[1],T=0;T!=J.length&&!((B=J.charCodeAt(T)-64)<1||B>26);++T)O=26*O+B;--O,L=O}else++L;for(T=0;T!=w.length&&w.charCodeAt(T)!==62;++T);if(++T,C=lt(w.slice(0,T),!0),C.r||(C.r=dt({r:Z-1,c:L})),J=w.slice(T),I={t:""},(S=J.match(o))!=null&&S[1]!==""&&(I.v=Nt(S[1])),d.cellFormula){if((S=J.match(l))!=null&&S[1]!==""){if(I.f=Nt(Gt(S[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=Eg(I.f)),S[0].indexOf('t="array"')>-1)I.F=(J.match(a)||[])[1],I.F.indexOf(":")>-1&&he.push([lr(I.F),I.F]);else if(S[0].indexOf('t="shared"')>-1){X=lt(S[0]);var ie=Nt(Gt(S[1]));d.xlfn||(ie=Eg(ie)),K[parseInt(X.si,10)]=[X,ie,C.r]}}else(S=J.match(/<f[^>]*\/>/))&&(X=lt(S[0]),K[X.si]&&(I.f=MT(K[X.si][1],K[X.si][2],C.r)));var te=sn(C.r);for(T=0;T<he.length;++T)te.r>=he[T][0].s.r&&te.r<=he[T][0].e.r&&te.c>=he[T][0].s.c&&te.c<=he[T][0].e.c&&(I.F=he[T][1])}if(C.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(E)I.t="z";else continue;else I.t=C.t||"n";switch(x.s.c>L&&(x.s.c=L),x.e.c<L&&(x.e.c=L),I.t){case"n":if(I.v==""||I.v==null){if(!E)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!E)continue;I.t="z"}else ne=hl[parseInt(I.v,10)],I.v=ne.t,I.r=ne.r,d.cellHTML&&(I.h=ne.h);break;case"str":I.t="s",I.v=I.v!=null?Gt(I.v):"",d.cellHTML&&(I.h=lp(I.v));break;case"inlineStr":S=J.match(r),I.t="s",S!=null&&(ne=vp(S[1]))?(I.v=ne.t,d.cellHTML&&(I.h=ne.h)):I.v="";break;case"b":I.v=er(I.v);break;case"d":d.cellDates?I.v=Or(I.v,1):(I.v=un(Or(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=F1[I.v];break}if(W=ue=0,re=null,le&&C.s!==void 0&&(re=y.CellXf[C.s],re!=null&&(re.numFmtId!=null&&(W=re.numFmtId),d.cellStyles&&re.fillId!=null&&(ue=re.fillId))),ly(I,W,ue,d,g,y),d.cellDates&&le&&I.t=="n"&&di(pt[W])&&(I.t="d",I.v=Gu(I.v)),C.cm&&d.xlmeta){var ae=(d.xlmeta.Cell||[])[+C.cm-1];ae&&ae.type=="XLDAPR"&&(I.D=!0)}if(se){var F=sn(C.r);p[F.r]||(p[F.r]=[]),p[F.r][F.c]=I}else p[C.r]=I}}}}R.length>0&&(p["!rows"]=R)}})();function SD(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var TD=go;function CD(){}function DD(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=Q_(e),t}function ND(e){var n=$n(e);return[n]}function FD(e){var n=xo(e);return[n]}function AD(e){var n=$n(e),t=e.read_shift(1);return[n,t,"b"]}function OD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"b"]}function PD(e){var n=$n(e),t=e.read_shift(1);return[n,t,"e"]}function RD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"e"]}function MD(e){var n=$n(e),t=e.read_shift(4);return[n,t,"s"]}function ID(e){var n=xo(e),t=e.read_shift(4);return[n,t,"s"]}function jD(e){var n=$n(e),t=Kr(e);return[n,t,"n"]}function uy(e){var n=xo(e),t=Kr(e);return[n,t,"n"]}function LD(e){var n=$n(e),t=mp(e);return[n,t,"n"]}function zD(e){var n=xo(e),t=mp(e);return[n,t,"n"]}function BD(e){var n=$n(e),t=pp(e);return[n,t,"is"]}function WD(e){var n=$n(e),t=Xr(e);return[n,t,"str"]}function UD(e){var n=xo(e),t=Xr(e);return[n,t,"str"]}function HD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}function $D(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}function YD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=Kr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}function VD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=Xr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}var KD=go;function GD(e,n){var t=e.l+n,r=go(e),a=hp(e),o=Xr(e),l=Xr(e),c=Xr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function XD(){}function QD(e,n,t){var r=e.l+n,a=C1(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=tD(e,r-e.l,t);l[1]=c}else e.l=r;return l}function qD(e,n,t){var r=e.l+n,a=go(e),o=[a];if(t.cellFormula){var l=nD(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var ZD=["left","right","top","bottom","header","footer"];function JD(e){var n={};return ZD.forEach(function(t){n[t]=Kr(e)}),n}function e4(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function t4(){}function r4(){}function n4(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},p,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,g=!1,y,k,w,_,S,O,T,B,J,I=[];c.biff=12,c["!row"]=0;var C=0,Z=!1,L=[],ne={},X=c.supbooks||a.supbooks||[[]];if(X.sharedf=ne,X.arrayf=L,X.SheetNames=a.SheetNames||a.Sheets.map(function(se){return se.name}),!c.supbooks&&(c.supbooks=X,a.Names))for(var W=0;W<a.Names.length;++W)X[0][W+1]=a.Names[W];var ue=[],le=[],re=!1;Fu[16]={n:"BrtShortReal",f:uy};var he;if(Xa(e,function(R,Y,P){if(!g)switch(P){case 148:p=R;break;case 0:y=R,c.sheetRows&&c.sheetRows<=y.r&&(g=!0),B=Br(_=y.r),c["!row"]=y.r,(R.hidden||R.hpt||R.level!=null)&&(R.hpt&&(R.hpx=El(R.hpt)),le[R.r]=R);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:R[2]},R[2]){case"n":k.v=R[1];break;case"s":T=hl[R[1]],k.v=T.t,k.r=T.r;break;case"b":k.v=!!R[1];break;case"e":k.v=R[1],c.cellText!==!1&&(k.w=vo[k.v]);break;case"str":k.t="s",k.v=R[1];break;case"is":k.t="s",k.v=R[1].t;break}if((w=l.CellXf[R[0].iStyleRef])&&ly(k,w.numFmtId,null,c,o,l),S=R[0].c==-1?S+1:R[0].c,c.dense?(f[_]||(f[_]=[]),f[_][S]=k):f[Er(S)+B]=k,c.cellFormula){for(Z=!1,C=0;C<L.length;++C){var E=L[C];y.r>=E[0].s.r&&y.r<=E[0].e.r&&S>=E[0].s.c&&S<=E[0].e.c&&(k.F=bt(E[0]),Z=!0)}!Z&&R.length>3&&(k.f=R[3])}if(d.s.r>y.r&&(d.s.r=y.r),d.s.c>S&&(d.s.c=S),d.e.r<y.r&&(d.e.r=y.r),d.e.c<S&&(d.e.c=S),c.cellDates&&w&&k.t=="n"&&di(pt[w.numFmtId])){var j=Qs(k.v);j&&(k.t="d",k.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}he&&(he.type=="XLDAPR"&&(k.D=!0),he=void 0);break;case 1:case 12:if(!c.sheetStubs||x)break;k={t:"z",v:void 0},S=R[0].c==-1?S+1:R[0].c,c.dense?(f[_]||(f[_]=[]),f[_][S]=k):f[Er(S)+B]=k,d.s.r>y.r&&(d.s.r=y.r),d.s.c>S&&(d.s.c=S),d.e.r<y.r&&(d.e.r=y.r),d.e.c<S&&(d.e.c=S),he&&(he.type=="XLDAPR"&&(k.D=!0),he=void 0);break;case 176:I.push(R);break;case 49:he=((c.xlmeta||{}).Cell||[])[R-1];break;case 494:var M=r["!id"][R.relId];for(M?(R.Target=M.Target,R.loc&&(R.Target+="#"+R.loc),R.Rel=M):R.relId==""&&(R.Target="#"+R.loc),_=R.rfx.s.r;_<=R.rfx.e.r;++_)for(S=R.rfx.s.c;S<=R.rfx.e.c;++S)c.dense?(f[_]||(f[_]=[]),f[_][S]||(f[_][S]={t:"z",v:void 0}),f[_][S].l=R):(O=dt({c:S,r:_}),f[O]||(f[O]={t:"z",v:void 0}),f[O].l=R);break;case 426:if(!c.cellFormula)break;L.push(R),J=c.dense?f[_][S]:f[Er(S)+B],J.f=Vr(R[1],d,{r:y.r,c:S},X,c),J.F=bt(R[0]);break;case 427:if(!c.cellFormula)break;ne[dt(R[0].s)]=R[1],J=c.dense?f[_][S]:f[Er(S)+B],J.f=Vr(R[1],d,{r:y.r,c:S},X,c);break;case 60:if(!c.cellStyles)break;for(;R.e>=R.s;)ue[R.e--]={width:R.w/256,hidden:!!(R.flags&1),level:R.level},re||(re=!0,yp(R.w/256)),si(ue[R.e+1]);break;case 161:f["!autofilter"]={ref:bt(R)};break;case 476:f["!margins"]=R;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),R.name&&(a.Sheets[t].CodeName=R.name),(R.above||R.left)&&(f["!outline"]={above:R.above,left:R.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),R.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Y.T){if(!x||c.WTF)throw new Error("Unexpected record 0x"+P.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(d.s.r<2e6||p&&(p.e.r>0||p.e.c>0||p.s.r>0||p.s.c>0))&&(f["!ref"]=bt(p||d)),c.sheetRows&&f["!ref"]){var K=lr(f["!ref"]);c.sheetRows<=+K.e.r&&(K.e.r=c.sheetRows-1,K.e.r>d.e.r&&(K.e.r=d.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>d.e.c&&(K.e.c=d.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),f["!fullref"]=f["!ref"],f["!ref"]=bt(K))}return I.length>0&&(f["!merges"]=I),ue.length>0&&(f["!cols"]=ue),le.length>0&&(f["!rows"]=le),f}function a4(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function s4(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,p="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var g=a4(x);d.s.r=d.s.c=0,d.e.c=c,p=Er(c),g[0].forEach(function(y,k){l[p+Br(k)]={t:"n",v:y,z:g[1]},f=k}),d.e.r<f&&(d.e.r=f),++c}),c>0&&(l["!ref"]=bt(d)),l}function o4(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(cy);return c&&kp(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function i4(e,n){e.l+=10;var t=Xr(e);return{name:t}}function l4(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Xa(e,function(f,p,d){switch(d){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(p.T>0)){if(!(p.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var fy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],c4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],u4=[],f4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ng(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=er(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Fg(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=er(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function dy(e){Fg(e.WBProps,fy),Fg(e.CalcPr,f4),Ng(e.WBView,c4),Ng(e.Sheets,u4),Jo.date1904=er(e.WBProps.date1904)}var d4="][*?/\\".split("");function p4(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return d4.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var h4=/<\w+:workbook/;function m4(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(qr,function(f,p){var d=lt(f);switch(Ta(d[0])){case"<?xml":break;case"<workbook":f.match(h4)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],t.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fy.forEach(function(x){if(d[x[0]]!=null)switch(x[2]){case"bool":t.WBProps[x[0]]=er(d[x[0]]);break;case"int":t.WBProps[x[0]]=parseInt(d[x[0]],10);break;default:t.WBProps[x[0]]=d[x[0]]}}),d.codeName&&(t.WBProps.CodeName=Gt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],t.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Nt(Gt(d.name)),delete d[0],t.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=Gt(d.name),d.comment&&(o.Comment=d.comment),d.localSheetId&&(o.Sheet=+d.localSheetId),er(d.hidden||"0")&&(o.Hidden=!0),l=p+f.length;break;case"</definedName>":o.Ref=Nt(Gt(e.slice(l,p))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete d[0],t.CalcPr=d;break;case"<calcPr/>":delete d[0],t.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return f}),P_.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return dy(t),t}function x4(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Sd(e),t.name=Xr(e),t}function g4(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?Xr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function v4(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function y4(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=q_(e),l=rD(e,0,t),c=hp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function w4(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Fu[16]={n:"BrtFRTArchID$",f:v4},Xa(e,function(f,p,d){switch(d){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Vr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,f]):l[0]=[d,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(d),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(d),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!p.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},n),dy(t),t.Names=o,t.supbooks=l,t}function k4(e,n,t){return n.slice(-4)===".bin"?w4(e,t):m4(e,t)}function _4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?n4(e,r,t,a,o,l,c):xD(e,r,t,a,o,l,c)}function b4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?l4(e,r,t,a,o):o4(e,r,t,a,o)}function E4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?OT():PT()}function S4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?FT():AT()}function T4(e,n,t,r){return n.slice(-4)===".bin"?KS(e,t,r):WS(e,t,r)}function C4(e,n,t){return Z1(e,t)}function D4(e,n,t){return n.slice(-4)===".bin"?cS(e,t):iS(e,t)}function N4(e,n,t){return n.slice(-4)===".bin"?CT(e,t):_T(e,t)}function F4(e,n,t){return n.slice(-4)===".bin"?yT(e):gT(e)}function A4(e,n,t,r){return t.slice(-4)===".bin"?wT(e,n,t,r):void 0}function O4(e,n,t){return n.slice(-4)===".bin"?mT(e,n,t):xT(e,n,t)}var py=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zn(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(py),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(hy),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function P4(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(py),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(hy),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var xl;function R4(e,n){var t=xl[e]||Nt(e);return t==="General"?oo(n):Un(t,n)}function M4(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=er(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Or(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Nt(n)]=a}function I4(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=R4(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=xl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&di(r)){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function j4(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=MS[r.Pattern]||r.Pattern)}e[n.ID]=n}function L4(e,n,t,r,a,o,l,c,f,p){var d="General",x=r.StyleID,g={};p=p||{};var y=[],k=0;for(x===void 0&&c&&(x=c.StyleID),x===void 0&&l&&(x=l.StyleID);o[x]!==void 0&&(o[x].nf&&(d=o[x].nf),o[x].Interior&&y.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=er(e);break;case"String":r.t="s",r.r=Zx(Nt(e)),r.v=e.indexOf("<")>-1?Nt(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Or(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Nt(e):r.v<60&&(r.v=r.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=F1[e],p.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=Zx(n||e));break}if(I4(r,d,p),p.cellFormula!==!1)if(r.Formula){var w=Nt(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=Zo(w,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Zo("RC:RC",a):r.ArrayRange&&(r.F=Zo(r.ArrayRange,a),f.push([lr(r.F),r.F]))}else for(k=0;k<f.length;++k)a.r>=f[k][0].s.r&&a.r<=f[k][0].e.r&&a.c>=f[k][0].s.c&&a.c<=f[k][0].e.c&&(r.F=f[k][1]);p.cellStyles&&(y.forEach(function(_){!g.patternType&&_.patternType&&(g.patternType=_.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function z4(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ad(e,n){var t=n||{};r1();var r=rl(cp(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Gt(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=zr(t);return l.type="string",_l.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ee){a.indexOf("<"+Ee)>=0&&(o=!0)}),o)return G4(r,t);xl={"General Number":"General","General Date":pt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":pt[15],"Short Date":pt[14],"Long Time":pt[19],"Medium Time":pt[18],"Short Time":pt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:pt[2],Standard:pt[4],Percent:pt[10],Scientific:pt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],p,d={},x=[],g=t.dense?[]:{},y="",k={},w={},_=Zn('<Data ss:Type="String">'),S=0,O=0,T=0,B={s:{r:2e6,c:2e6},e:{r:0,c:0}},J={},I={},C="",Z=0,L=[],ne={},X={},W=0,ue=[],le=[],re={},he=[],K,se=!1,R=[],Y=[],P={},E=0,j=0,M={Sheets:[],WBProps:{date1904:!1}},U={};kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=kl.exec(r);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?L4(r.slice(S,c.index),C,_,f[f.length-1][0]=="comment"?re:k,{c:O,r:T},J,he[O],w,R,t):(C="",_=Zn(c[0]),S=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(le.length>0&&(k.c=le),(!t.sheetRows||t.sheetRows>T)&&k.v!==void 0&&(t.dense?(g[T]||(g[T]=[]),g[T][O]=k):g[Er(O)+Br(T)]=k),k.HRef&&(k.l={Target:Nt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(E=O+(parseInt(k.MergeAcross,10)|0),j=T+(parseInt(k.MergeDown,10)|0),L.push({s:{c:O,r:T},e:{c:E,r:j}})),!t.sheetStubs)k.MergeAcross?O=E+1:++O;else if(k.MergeAcross||k.MergeDown){for(var pe=O;pe<=E;++pe)for(var me=T;me<=j;++me)(pe>O||me>T)&&(t.dense?(g[me]||(g[me]=[]),g[me][pe]={t:"z"}):g[Er(pe)+Br(me)]={t:"z"});O=E+1}else++O;else k=P4(c[0]),k.Index&&(O=+k.Index-1),O<B.s.c&&(B.s.c=O),O>B.e.c&&(B.e.c=O),c[0].slice(-2)==="/>"&&++O,le=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(T<B.s.r&&(B.s.r=T),T>B.e.r&&(B.e.r=T),c[0].slice(-2)==="/>"&&(w=Zn(c[0]),w.Index&&(T=+w.Index-1)),O=0,++T):(w=Zn(c[0]),w.Index&&(T=+w.Index-1),P={},(w.AutoFitHeight=="0"||w.Height)&&(P.hpx=parseInt(w.Height,10),P.hpt=q1(P.hpx),Y[T]=P),w.Hidden=="1"&&(P.hidden=!0,Y[T]=P));break;case"worksheet":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"));x.push(y),B.s.r<=B.e.r&&B.s.c<=B.e.c&&(g["!ref"]=bt(B),t.sheetRows&&t.sheetRows<=B.e.r&&(g["!fullref"]=g["!ref"],B.e.r=t.sheetRows-1,g["!ref"]=bt(B))),L.length&&(g["!merges"]=L),he.length>0&&(g["!cols"]=he),Y.length>0&&(g["!rows"]=Y),d[y]=g}else B={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=O=0,f.push([c[3],!1]),p=Zn(c[0]),y=Nt(p.Name),g=t.dense?[]:{},L=[],R=[],Y=[],U={name:y,Hidden:0},M.Sheets.push(U);break;case"table":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),he=[],se=!1}break;case"style":c[1]==="/"?j4(J,I,t):I=Zn(c[0]);break;case"numberformat":I.nf=Nt(Zn(c[0]).Format||"General"),xl[I.nf]&&(I.nf=xl[I.nf]);for(var ie=0;ie!=392&&pt[ie]!=I.nf;++ie);if(ie==392){for(ie=57;ie!=392;++ie)if(pt[ie]==null){eo(I.nf,ie);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(K=Zn(c[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!se&&K.wpx>10){se=!0,nn=X1;for(var te=0;te<he.length;++te)he[te]&&si(he[te])}se&&si(K),he[K.Index-1||he.length]=K;for(var ae=0;ae<+K.Span;++ae)he[he.length]=zr(K);break;case"namedrange":if(c[1]==="/")break;M.Names||(M.Names=[]);var F=lt(c[0]),Ce={Name:F.Name,Ref:Zo(F.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(Ce.Sheet=M.Sheets.length-1),M.Names.push(Ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?C+=r.slice(Z,c.index):Z=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;I.Interior=Zn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?_b(ne,oe,r.slice(W,c.index)):W=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"));z4(re),le.push(re)}else f.push([c[3],!1]),p=Zn(c[0]),re={a:p.Author};break;case"autofilter":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var De=Zn(c[0]);g["!autofilter"]={ref:Zo(De.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return Ig(r,t);var He=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(c[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(W,c.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else W=c.index+c[0].length;break;case"header":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(g["!margins"].header=+lt(c[0]).Margin);break;case"footer":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(g["!margins"].footer=+lt(c[0]).Margin);break;case"pagemargins":var q=lt(c[0]);g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+q.Top)||(g["!margins"].top=+q.Top),isNaN(+q.Left)||(g["!margins"].left=+q.Left),isNaN(+q.Right)||(g["!margins"].right=+q.Right),isNaN(+q.Bottom)||(g["!margins"].bottom=+q.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?M4(X,oe,ue,r.slice(W,c.index)):(ue=c,W=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var de={};return!t.bookSheets&&!t.bookProps&&(de.Sheets=d),de.SheetNames=x,de.Workbook=M,de.SSF=zr(pt),de.Props=ne,de.Custprops=X,de}function Nd(e,n){switch(Ep(n=n||{}),n.type||"base64"){case"base64":return ad(Tn(e),n);case"binary":case"buffer":case"file":return ad(e,n);case"array":return ad(mo(e),n)}}function B4(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=eb(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=tb(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var W4=[60,1084,2066,2165,2175];function U4(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=za(t,t.l),p=Fd[f],d=0;p!=null&&W4.indexOf(f)>-1;)o=za(t,t.l+2),d=t.l+4,f==2066?d+=4:(f==2165||f==2175)&&(d+=12),c=t.slice(d,t.l+4+o),l.push(c),t.l+=4+o,p=Fd[f=za(t,t.l)];var x=ys(l);jr(x,0);var g=0;x.lens=[];for(var y=0;y<l.length;++y)x.lens.push(g),g+=l[y].length;if(x.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+r;return n.f(x,x.length,a)}function ha(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=pt[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=Un(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&di(pt[r]||String(r))){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function au(e,n,t){return{v:e,ixfe:n,t}}function H4(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],p="",d={},x,g="",y,k,w,_,S={},O=[],T,B,J=[],I=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Z={},L=function(rt){return rt<8?to[rt]:rt<64&&I[rt-8]||to[rt]},ne=function(rt,Et,qt){var kt=Et.XF.data;if(!(!kt||!kt.patternType||!qt||!qt.cellStyles)){Et.s={},Et.s.patternType=kt.patternType;var Ht;(Ht=bl(L(kt.icvFore)))&&(Et.s.fgColor={rgb:Ht}),(Ht=bl(L(kt.icvBack)))&&(Et.s.bgColor={rgb:Ht})}},X=function(rt,Et,qt){if(!(P>1)&&!(qt.sheetRows&&rt.r>=qt.sheetRows)){if(qt.cellStyles&&Et.XF&&Et.XF.data&&ne(rt,Et,qt),delete Et.ixfe,delete Et.XF,x=rt,g=dt(rt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<l.s.r&&(l.s.r=rt.r),rt.c<l.s.c&&(l.s.c=rt.c),rt.r+1>l.e.r&&(l.e.r=rt.r+1),rt.c+1>l.e.c&&(l.e.c=rt.c+1),qt.cellFormula&&Et.f){for(var kt=0;kt<O.length;++kt)if(!(O[kt][0].s.c>rt.c||O[kt][0].s.r>rt.r)&&!(O[kt][0].e.c<rt.c||O[kt][0].e.r<rt.r)){Et.F=bt(O[kt][0]),(O[kt][0].s.c!=rt.c||O[kt][0].s.r!=rt.r)&&delete Et.f,Et.f&&(Et.f=""+Vr(O[kt][1],l,rt,R,W));break}}qt.dense?(a[rt.r]||(a[rt.r]=[]),a[rt.r][rt.c]=Et):a[g]=Et}},W={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(W.password=n.password);var ue,le=[],re=[],he=[],K=[],se=!1,R=[];R.SheetNames=W.snames,R.sharedf=W.sharedf,R.arrayf=W.arrayf,R.names=[],R.XTI=[];var Y=0,P=0,E=0,j=[],M=[],U;W.codepage=1200,ta(1200);for(var oe=!1;e.l<e.length-1;){var pe=e.l,me=e.read_shift(2);if(me===0&&Y===10)break;var ie=e.l===e.length?0:e.read_shift(2),te=Fd[me];if(te&&te.f){if(n.bookSheets&&Y===133&&me!==133)break;if(Y=me,te.r===2||te.r==12){var ae=e.read_shift(2);if(ie-=2,!W.enc&&ae!==me&&((ae&255)<<8|ae>>8)!==me)throw new Error("rt mismatch: "+ae+"!="+me);te.r==12&&(e.l+=10,ie-=10)}var F={};if(me===10?F=te.f(e,ie,W):F=U4(me,te,e,ie,W),P==0&&[9,521,1033,2057].indexOf(Y)===-1)continue;switch(me){case 34:t.opts.Date1904=C.WBProps.date1904=F;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(W.enc||(e.l=0),W.enc=F,!n.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=F;break;case 66:var Ce=Number(F);switch(Ce){case 21010:Ce=1200;break;case 32768:Ce=1e4;break;case 32769:Ce=1252;break}ta(W.codepage=Ce),oe=!0;break;case 317:W.rrtabid=F;break;case 25:W.winlocked=F;break;case 439:t.opts.RefreshAll=F;break;case 12:t.opts.CalcCount=F;break;case 16:t.opts.CalcDelta=F;break;case 17:t.opts.CalcIter=F;break;case 13:t.opts.CalcMode=F;break;case 14:t.opts.CalcPrecision=F;break;case 95:t.opts.CalcSaveRecalc=F;break;case 15:W.CalcRefMode=F;break;case 2211:t.opts.FullCalc=F;break;case 129:F.fDialog&&(a["!type"]="dialog"),F.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),F.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:J.push(F);break;case 430:R.push([F]),R[R.length-1].XTI=[];break;case 35:case 547:R[R.length-1].push(F);break;case 24:case 536:U={Name:F.Name,Ref:Vr(F.rgce,l,null,R,W)},F.itab>0&&(U.Sheet=F.itab-1),R.names.push(U),R[0]||(R[0]=[],R[0].XTI=[]),R[R.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(M[F.itab-1]={ref:bt(F.rgce[0][0][1][2])});break;case 22:W.ExternCount=F;break;case 23:R.length==0&&(R[0]=[],R[0].XTI=[]),R[R.length-1].XTI=R[R.length-1].XTI.concat(F),R.XTI=R.XTI.concat(F);break;case 2196:if(W.biff<8)break;U!=null&&(U.Comment=F[1]);break;case 18:a["!protect"]=F;break;case 19:F!==0&&W.WTF&&console.error("Password verifier: "+F);break;case 133:o[F.pos]=F,W.snames.push(F.name);break;case 10:{if(--P)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=bt(l),n.sheetRows&&n.sheetRows<=l.e.r){var De=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=bt(l),l.e.r=De}l.e.r++,l.e.c++}le.length>0&&(a["!merges"]=le),re.length>0&&(a["!objects"]=re),he.length>0&&(a["!cols"]=he),K.length>0&&(a["!rows"]=K),C.Sheets.push(Z)}p===""?d=a:r[p]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),W.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(W.biff=5,oe=!0,ta(W.codepage=28591)),W.biff==8&&F.BIFFVer==0&&F.dt==16&&(W.biff=2),P++)break;if(a=n.dense?[]:{},W.biff<8&&!oe&&(oe=!0,ta(W.codepage=n.codepage||1252)),W.biff<5||F.BIFFVer==0&&F.dt==4096){p===""&&(p="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:e.l-ie,name:p};o[He.pos]=He,W.snames.push(p)}else p=(o[pe]||{name:""}).name;F.dt==32&&(a["!type"]="chart"),F.dt==64&&(a["!type"]="macro"),le=[],re=[],W.arrayf=O=[],he=[],K=[],se=!1,Z={Hidden:(o[pe]||{hs:0}).hs,name:p}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[F.r]||[])[F.c]:a[dt({c:F.c,r:F.r})])&&++F.c,T={ixfe:F.ixfe,XF:J[F.ixfe]||{},v:F.val,t:"n"},E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 5:case 517:T={ixfe:F.ixfe,XF:J[F.ixfe],v:F.val,t:F.t},E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 638:T={ixfe:F.ixfe,XF:J[F.ixfe],v:F.rknum,t:"n"},E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 189:for(var q=F.c;q<=F.C;++q){var de=F.rkrec[q-F.c][0];T={ixfe:de,XF:J[de],v:F.rkrec[q-F.c][1],t:"n"},E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:q,r:F.r},T,n)}break;case 6:case 518:case 1030:{if(F.val=="String"){c=F;break}if(T=au(F.val,F.cell.ixfe,F.tt),T.XF=J[T.ixfe],n.cellFormula){var Ee=F.formula;if(Ee&&Ee[0]&&Ee[0][0]&&Ee[0][0][0]=="PtgExp"){var Ne=Ee[0][0][1][0],Le=Ee[0][0][1][1],Qe=dt({r:Ne,c:Le});S[Qe]?T.f=""+Vr(F.formula,l,F.cell,R,W):T.F=((n.dense?(a[Ne]||[])[Le]:a[Qe])||{}).F}else T.f=""+Vr(F.formula,l,F.cell,R,W)}E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X(F.cell,T,n),c=F}break;case 7:case 519:if(c)c.val=F,T=au(F,c.cell.ixfe,"s"),T.XF=J[T.ixfe],n.cellFormula&&(T.f=""+Vr(c.formula,l,c.cell,R,W)),E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X(c.cell,T,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(F);var Mt=dt(F[0].s);if(y=n.dense?(a[F[0].s.r]||[])[F[0].s.c]:a[Mt],n.cellFormula&&y){if(!c||!Mt||!y)break;y.f=""+Vr(F[1],l,F[0],R,W),y.F=bt(F[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;S[dt(c.cell)]=F[0],y=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[dt(c.cell)],(y||{}).f=""+Vr(F[0],l,x,R,W)}}break;case 253:T=au(f[F.isst].t,F.ixfe,"s"),f[F.isst].h&&(T.h=f[F.isst].h),T.XF=J[T.ixfe],E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 513:n.sheetStubs&&(T={ixfe:F.ixfe,XF:J[F.ixfe],t:"z"},E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n));break;case 190:if(n.sheetStubs)for(var gt=F.c;gt<=F.C;++gt){var wt=F.ixfe[gt-F.c];T={ixfe:wt,XF:J[wt],t:"z"},E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:gt,r:F.r},T,n)}break;case 214:case 516:case 4:T=au(F.val,F.ixfe,"s"),T.XF=J[T.ixfe],E>0&&(T.z=j[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 0:case 512:P===1&&(l=F);break;case 252:f=F;break;case 1054:if(W.biff==4){j[E++]=F[1];for(var Ft=0;Ft<E+163&&pt[Ft]!=F[1];++Ft);Ft>=163&&eo(F[1],E+163)}else eo(F[1],F[0]);break;case 30:{j[E++]=F;for(var Ge=0;Ge<E+163&&pt[Ge]!=F;++Ge);Ge>=163&&eo(F,E+163)}break;case 229:le=le.concat(F);break;case 93:re[F.cmo[0]]=W.lastobj=F;break;case 438:W.lastobj.TxO=F;break;case 127:W.lastobj.ImData=F;break;case 440:for(_=F[0].s.r;_<=F[0].e.r;++_)for(w=F[0].s.c;w<=F[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[dt({c:w,r:_})],y&&(y.l=F[1]);break;case 2048:for(_=F[0].s.r;_<=F[0].e.r;++_)for(w=F[0].s.c;w<=F[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[dt({c:w,r:_})],y&&y.l&&(y.l.Tooltip=F[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;y=n.dense?(a[F[0].r]||[])[F[0].c]:a[dt(F[0])];var ft=re[F[2]];y||(n.dense?(a[F[0].r]||(a[F[0].r]=[]),y=a[F[0].r][F[0].c]={t:"z"}):y=a[dt(F[0])]={t:"z"},l.e.r=Math.max(l.e.r,F[0].r),l.s.r=Math.min(l.s.r,F[0].r),l.e.c=Math.max(l.e.c,F[0].c),l.s.c=Math.min(l.s.c,F[0].c)),y.c||(y.c=[]),k={a:F[1],t:ft.TxO.t},y.c.push(k)}break;case 2173:fT(J[F.ixfe],F.ext);break;case 125:{if(!W.cellStyles)break;for(;F.e>=F.s;)he[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},se||(se=!0,yp(F.w/256)),si(he[F.e+1])}break;case 520:{var ht={};F.level!=null&&(K[F.r]=ht,ht.level=F.level),F.hidden&&(K[F.r]=ht,ht.hidden=!0),F.hpt&&(K[F.r]=ht,ht.hpt=F.hpt,ht.hpx=El(F.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ml(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=F;break;case 161:a["!margins"]||ml(a["!margins"]={}),a["!margins"].header=F.header,a["!margins"].footer=F.footer;break;case 574:F.RTL&&(C.Views[0].RTL=!0);break;case 146:I=F;break;case 2198:ue=F;break;case 140:B=F;break;case 442:p?Z.CodeName=F||Z.name:C.WBProps.CodeName=F||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+me.toString(16)),e.l+=ie}return t.SheetNames=Ea(o).sort(function(Ut,rt){return Number(Ut)-Number(rt)}).map(function(Ut){return o[Ut].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&d["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=d)):t.Preamble=d,t.Sheets&&M.forEach(function(Ut,rt){t.Sheets[t.SheetNames[rt]]["!autofilter"]=Ut}),t.Strings=f,t.SSF=zr(pt),W.enc&&(t.Encryption=W.enc),ue&&(t.Themes=ue),t.Metadata={},B!==void 0&&(t.Metadata.Country=B),R.names.length>0&&(C.Names=R.names),t.Workbook=C,t}var Ag={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $4(e,n,t){var r=_t.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=hg(r,ib,Ag.DSI);for(var o in a)n[o]=a[o]}catch(p){if(t.WTF)throw p}var l=_t.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=hg(l,lb,Ag.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(p){if(t.WTF)throw p}n.HeadingPairs&&n.TitlesOfParts&&(O1(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function my(e,n){n||(n={}),Ep(n),$v(),n.codepage&&rp(n.codepage);var t,r;if(e.FullPaths){if(_t.find(e,"/encryption"))throw new Error("File is password-protected");t=_t.find(e,"!CompObj"),r=_t.find(e,"/Workbook")||_t.find(e,"/Book")}else{switch(n.type){case"base64":e=ea(Tn(e));break;case"binary":e=ea(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}jr(e,0),r={content:e}}var a,o;if(t&&B4(t),n.bookProps&&!n.bookSheets)a={};else{var l=yt?"buffer":"array";if(r&&r.content)a=H4(r.content,n);else if((o=_t.find(e,"PerfectOffice_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else if((o=_t.find(e,"NativeContent_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else throw(o=_t.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&_t.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=NT(e))}var c={};return e.FullPaths&&$4(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Fu={0:{f:SD},1:{f:ND},2:{f:LD},3:{f:PD},4:{f:AD},5:{f:jD},6:{f:WD},7:{f:MD},8:{f:VD},9:{f:YD},10:{f:HD},11:{f:$D},12:{f:FD},13:{f:zD},14:{f:RD},15:{f:OD},16:{f:uy},17:{f:UD},18:{f:ID},19:{f:pp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:y4},40:{},42:{},43:{f:HS},44:{f:US},45:{f:$S},46:{f:VS},47:{f:YS},48:{},49:{f:K_},50:{},51:{f:pT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$1},62:{f:BD},63:{f:vT},64:{f:t4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:e4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DD},148:{f:TD,p:16},151:{f:XD},152:{},153:{f:g4},154:{},155:{},156:{f:x4},157:{},158:{},159:{T:1,f:lS},160:{T:-1},161:{T:1,f:go},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dT},336:{T:-1},337:{f:hT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Sd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:H1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QD},427:{f:qD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:GD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Sd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:TT},633:{T:1},634:{T:-1},635:{T:1,f:ST},636:{T:-1},637:{f:X_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:i4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:r4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fd={6:{f:rd},10:{f:gs},12:{f:yr},13:{f:yr},14:{f:pr},15:{f:pr},16:{f:Kr},17:{f:pr},18:{f:pr},19:{f:yr},20:{f:vg},21:{f:vg},23:{f:H1},24:{f:wg},25:{f:pr},26:{},27:{},28:{f:bE},29:{},34:{f:pr},35:{f:yg},38:{f:Kr},39:{f:Kr},40:{f:Kr},41:{f:Kr},42:{f:pr},43:{f:pr},47:{f:CS},49:{f:aE},51:{f:yr},60:{},61:{f:tE},64:{f:pr},65:{f:nE},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:Kb},93:{f:SE},94:{},95:{f:pr},96:{},97:{},99:{f:pr},125:{f:$1},128:{f:hE},129:{f:Gb},130:{f:yr},131:{f:pr},132:{f:pr},133:{f:Xb},134:{},140:{f:AE},141:{f:yr},144:{},146:{f:PE},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:LE},161:{f:ME},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uE},190:{f:fE},193:{f:gs},197:{},198:{},199:{},200:{},201:{},202:{f:pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:pr},222:{},224:{f:pE},225:{f:Vb},226:{f:gs},227:{},229:{f:EE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Qb},253:{f:sE},255:{f:qb},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:j1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pr},353:{f:gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xE},431:{f:pr},432:{},433:{},434:{},437:{},438:{f:DE},439:{f:pr},440:{f:NE},441:{},442:{f:Ol},443:{},444:{f:yr},445:{},446:{},448:{f:gs},449:{f:eE,r:2},450:{f:gs},512:{f:xg},513:{f:jE},515:{f:mE},516:{f:oE},517:{f:gg},519:{f:zE},520:{f:Zb},523:{},545:{f:kg},549:{f:mg},566:{},574:{f:rE},638:{f:cE},659:{},1048:{},1054:{f:iE},1084:{},1212:{f:wE},2048:{f:FE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:RE,r:12},2173:{f:uT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yE,r:12},2197:{},2198:{f:aT,r:12},2199:{},2200:{},2201:{},2202:{f:kE,r:12},2203:{f:gs},2204:{},2205:{},2206:{},2207:{},2211:{f:Jb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:xg},1:{},2:{f:HE},3:{f:UE},4:{f:WE},5:{f:gg},7:{f:$E},8:{},9:{f:tu},11:{},22:{f:yr},30:{f:lE},31:{},32:{},33:{f:kg},36:{},37:{f:mg},50:{f:YE},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:BE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:VE},223:{},234:{},354:{},421:{},518:{f:rd},521:{f:tu},536:{f:wg},547:{f:yg},561:{},579:{},1030:{f:rd},1033:{f:tu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Jn(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&E1(t)&&e.push(t)}}function Og(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=m_(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),p=-1,d=0,x=0,g=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<f.length;++l){var w=f[l].trim(),_=w.slice(0,3).toLowerCase();if(_=="<tr"){if(++p,t.sheetRows&&t.sheetRows<=p){--p;break}d=0;continue}if(!(_!="<td"&&_!="<th")){var S=w.split(/<\/t[dh]>/i);for(c=0;c<S.length;++c){var O=S[c].trim();if(O.match(/<t[dh]/i)){for(var T=O,B=0;T.charAt(0)=="<"&&(B=T.indexOf(">"))>-1;)T=T.slice(B+1);for(var J=0;J<k.length;++J){var I=k[J];I.s.c==d&&I.s.r<p&&p<=I.e.r&&(d=I.e.c+1,J=-1)}var C=lt(O.slice(0,O.indexOf(">")));g=C.colspan?+C.colspan:1,((x=+C.rowspan)>1||g>1)&&k.push({s:{r:p,c:d},e:{r:p+(x||1)-1,c:d+g-1}});var Z=C.t||C["data-t"]||"";if(!T.length){d+=g;continue}if(T=f1(T),y.s.r>p&&(y.s.r=p),y.e.r<p&&(y.e.r=p),y.s.c>d&&(y.s.c=d),y.e.c<d&&(y.e.c=d),!T.length){d+=g;continue}var L={t:"s",v:T};t.raw||!T.trim().length||Z=="s"||(T==="TRUE"?L={t:"b",v:!0}:T==="FALSE"?L={t:"b",v:!1}:isNaN(na(T))?isNaN(ai(T).getDate())||(L={t:"d",v:Or(T)},t.cellDates||(L={t:"n",v:un(L.v)}),L.z=t.dateNF||pt[14]):L={t:"n",v:na(T)}),t.dense?(r[p]||(r[p]=[]),r[p][d]=L):r[dt({r:p,c:d})]=L,d+=g}}}}return r["!ref"]=bt(y),k.length&&(r["!merges"]=k),r}function Y4(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,p=0;p<a.length;++p)if(!(a[p].s.r>t||a[p].s.c>l)&&!(a[p].e.r<t||a[p].e.c<l)){if(a[p].s.r<t||a[p].s.c<l){c=-1;break}c=a[p].e.r-a[p].s.r+1,f=a[p].e.c-a[p].s.c+1;break}if(!(c<0)){var d=dt({r:t,c:l}),x=r.dense?(e[t]||[])[l]:e[d],g=x&&x.v!=null&&(x.h||lp(x.w||(Ka(x),x.w)||""))||"",y={};c>1&&(y.rowspan=c),f>1&&(y.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":x&&(y["data-t"]=x&&x.t||"z",x.v!=null&&(y["data-v"]=x.v),x.z!=null&&(y["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+x.l.Target+'">'+g+"</a>")),y.id=(r.id||"sjs")+"-"+d,o.push(A_("td",g,y))}}var k="<tr>";return k+o.join("")+"</tr>"}var V4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',K4="</body></html>";function G4(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Os(Og(t[0],n),n);var r=Tp();return t.forEach(function(a,o){Cp(r,Og(a,n),"Sheet"+(o+1))}),r}function X4(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Q4(e,n){var t=n||{},r=t.header!=null?t.header:V4,a=t.footer!=null?t.footer:K4,o=[r],l=pi(e["!ref"]);t.dense=Array.isArray(e),o.push(X4(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(Y4(e,l,c,t));return o.push("</table>"+a),o.join("")}function xy(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?sn(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),p={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var d=pi(e["!ref"]);p.s.r=Math.min(p.s.r,d.s.r),p.s.c=Math.min(p.s.c,d.s.c),p.e.r=Math.max(p.e.r,d.e.r),p.e.c=Math.max(p.e.c,d.e.c),a==-1&&(p.e.r=a=d.e.r+1)}var x=[],g=0,y=e["!rows"]||(e["!rows"]=[]),k=0,w=0,_=0,S=0,O=0,T=0;for(e["!cols"]||(e["!cols"]=[]);k<c.length&&w<f;++k){var B=c[k];if(Pg(B)){if(r.display)continue;y[w]={hidden:!0}}var J=B.children;for(_=S=0;_<J.length;++_){var I=J[_];if(!(r.display&&Pg(I))){var C=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):f1(I.innerHTML),Z=I.getAttribute("data-z")||I.getAttribute("z");for(g=0;g<x.length;++g){var L=x[g];L.s.c==S+o&&L.s.r<w+a&&w+a<=L.e.r&&(S=L.e.c+1-o,g=-1)}T=+I.getAttribute("colspan")||1,((O=+I.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:w+a,c:S+o},e:{r:w+a+(O||1)-1,c:S+o+(T||1)-1}});var ne={t:"s",v:C},X=I.getAttribute("data-t")||I.getAttribute("t")||"";C!=null&&(C.length==0?ne.t=X||"z":r.raw||C.trim().length==0||X=="s"||(C==="TRUE"?ne={t:"b",v:!0}:C==="FALSE"?ne={t:"b",v:!1}:isNaN(na(C))?isNaN(ai(C).getDate())||(ne={t:"d",v:Or(C)},r.cellDates||(ne={t:"n",v:un(ne.v)}),ne.z=r.dateNF||pt[14]):ne={t:"n",v:na(C)})),ne.z===void 0&&Z!=null&&(ne.z=Z);var W="",ue=I.getElementsByTagName("A");if(ue&&ue.length)for(var le=0;le<ue.length&&!(ue[le].hasAttribute("href")&&(W=ue[le].getAttribute("href"),W.charAt(0)!="#"));++le);W&&W.charAt(0)!="#"&&(ne.l={Target:W}),r.dense?(e[w+a]||(e[w+a]=[]),e[w+a][S+o]=ne):e[dt({c:S+o,r:w+a})]=ne,p.e.c<S+o&&(p.e.c=S+o),S+=T}}++w}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),p.e.r=Math.max(p.e.r,w-1+a),e["!ref"]=bt(p),w>=f&&(e["!fullref"]=bt((p.e.r=c.length-k+w-1+a,p))),e}function gy(e,n){var t=n||{},r=t.dense?[]:{};return xy(r,e,n)}function q4(e,n){return Os(gy(e,n),n)}function Pg(e){var n="",t=Z4(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function Z4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function J4(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Nt(n.replace(/<[^>]*>/g,""));return[t]}var Rg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vy(e,n){var t=n||{},r=cp(e),a=[],o,l,c={name:""},f="",p=0,d,x,g={},y=[],k=t.dense?[]:{},w,_,S={value:""},O="",T=0,B=[],J=-1,I=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},Z=0,L={},ne=[],X={},W=0,ue=0,le=[],re=1,he=1,K=[],se={Names:[]},R={},Y=["",""],P=[],E={},j="",M=0,U=!1,oe=!1,pe=0;for(kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=kl.exec(r);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?k["!ref"]=bt(C):k["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=C.e.r&&(k["!fullref"]=k["!ref"],C.e.r=t.sheetRows-1,k["!ref"]=bt(C)),ne.length&&(k["!merges"]=ne),le.length&&(k["!rows"]=le),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),y.push(d.name),g[d.name]=k,oe=!1):w[0].charAt(w[0].length-2)!=="/"&&(d=lt(w[0],!1),J=I=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,k=t.dense?[]:{},ne=[],le=[],oe=!0);break;case"table-row-group":w[1]==="/"?--Z:++Z;break;case"table-row":case"行":if(w[1]==="/"){J+=re,re=1;break}if(x=lt(w[0],!1),x.行号?J=x.行号-1:J==-1&&(J=0),re=+x["number-rows-repeated"]||1,re<10)for(pe=0;pe<re;++pe)Z>0&&(le[J+pe]={level:Z});I=-1;break;case"covered-table-cell":w[1]!=="/"&&++I,t.sheetStubs&&(t.dense?(k[J]||(k[J]=[]),k[J][I]={t:"z"}):k[dt({r:J,c:I})]={t:"z"}),O="",B=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++I,S=lt(w[0],!1),he=parseInt(S["number-columns-repeated"]||"1",10),_={t:"z",v:null},S.formula&&t.cellFormula!=!1&&(_.f=Dg(Nt(S.formula))),(S.数据类型||S["value-type"])=="string"&&(_.t="s",_.v=Nt(S["string-value"]||""),t.dense?(k[J]||(k[J]=[]),k[J][I]=_):k[dt({r:J,c:I})]=_),I+=he-1;else if(w[1]!=="/"){++I,O="",T=0,B=[],he=1;var me=re?J+re-1:J;if(I>C.e.c&&(C.e.c=I),I<C.s.c&&(C.s.c=I),J<C.s.r&&(C.s.r=J),me>C.e.r&&(C.e.r=me),S=lt(w[0],!1),P=[],E={},_={t:S.数据类型||S["value-type"],v:null},t.cellFormula)if(S.formula&&(S.formula=Nt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(W=parseInt(S["number-matrix-rows-spanned"],10)||0,ue=parseInt(S["number-matrix-columns-spanned"],10)||0,X={s:{r:J,c:I},e:{r:J+W-1,c:I+ue-1}},_.F=bt(X),K.push([X,_.F])),S.formula)_.f=Dg(S.formula);else for(pe=0;pe<K.length;++pe)J>=K[pe][0].s.r&&J<=K[pe][0].e.r&&I>=K[pe][0].s.c&&I<=K[pe][0].e.c&&(_.F=K[pe][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(W=parseInt(S["number-rows-spanned"],10)||0,ue=parseInt(S["number-columns-spanned"],10)||0,X={s:{r:J,c:I},e:{r:J+W-1,c:I+ue-1}},ne.push(X)),S["number-columns-repeated"]&&(he=parseInt(S["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=er(S["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(S.value);break;case"percentage":_.t="n",_.v=parseFloat(S.value);break;case"currency":_.t="n",_.v=parseFloat(S.value);break;case"date":_.t="d",_.v=Or(S["date-value"]),t.cellDates||(_.t="n",_.v=un(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=d_(S["time-value"])/86400,t.cellDates&&(_.t="d",_.v=Gu(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(S.数据数值);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",S["string-value"]!=null&&(O=Nt(S["string-value"]),B=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(U=!1,_.t==="s"&&(_.v=O||"",B.length&&(_.R=B),U=T==0),R.Target&&(_.l=R),P.length>0&&(_.c=P,P=[]),O&&t.cellText!==!1&&(_.w=O),U&&(_.t="z",delete _.v),(!U||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=J))for(var ie=0;ie<re;++ie){if(he=parseInt(S["number-columns-repeated"]||"1",10),t.dense)for(k[J+ie]||(k[J+ie]=[]),k[J+ie][I]=ie==0?_:zr(_);--he>0;)k[J+ie][I+he]=zr(_);else for(k[dt({r:J+ie,c:I})]=_;--he>0;)k[dt({r:J+ie,c:I+he})]=zr(_);C.e.c<=I&&(C.e.c=I)}he=parseInt(S["number-columns-repeated"]||"1",10),I+=he-1,he=0,_={},O="",B=[]}R={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o;E.t=O,B.length&&(E.R=B),E.a=j,P.push(E)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);j="",M=0,O="",T=0,B=[];break;case"creator":w[1]==="/"?j=r.slice(M,w.index):M=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);O="",T=0,B=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(L[c.name]=f,(o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",c=lt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=lt(w[0],!1),f+=Rg[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=lt(w[0],!1),f+=Rg[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(p,w.index);break}else p=w.index+w[0].length;break;case"named-range":l=lt(w[0],!1),Y=nd(l["cell-range-address"]);var te={Name:l.name,Ref:Y[0]+"!"+Y[1]};oe&&(te.Sheet=y.length),se.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!S||!S["string-value"])){var ae=J4(r.slice(T,w.index));O=(O.length>0?O+`
`:"")+ae[0]}else lt(w[0],!1),T=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Y=nd(lt(w[0])["target-range-address"]),g[Y[0]]["!autofilter"]={ref:Y[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(R=lt(w[0],!1),!R.href)break;R.Target=Nt(R.href),delete R.href,R.Target.charAt(0)=="#"&&R.Target.indexOf(".")>-1?(Y=nd(R.Target.slice(1)),R.Target="#"+Y[0]+"!"+Y[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(w)}}var F={Sheets:g,SheetNames:y,Workbook:se};return t.bookSheets&&delete F.Sheets,F}function Mg(e,n){n=n||{},Ln(e,"META-INF/manifest.xml")&&mb(vr(e,"META-INF/manifest.xml"),n);var t=En(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=vy(Gt(t),n);return Ln(e,"meta.xml")&&(r.Props=A1(vr(e,"meta.xml"))),r}function Ig(e,n){return vy(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _p(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ad(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Gt(mo(e))}function Od(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function jg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function eN(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Sl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Sr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function Gr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Sl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Sl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var p={data:c,type:o};n[a]==null?n[a]=[p]:n[a].push(p)}return n}function bp(e,n){return e?.map(function(t){return n(t.data)})||[]}function tN(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Sl(e,r),o=Gr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Sr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=Gr(c.data),p=Sr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+p)}),r[0]+=p}),(n=o[3])!=null&&n[0]&&(l.merge=Sr(o[3][0].data)>>>0>0),t.push(l)}return t}function rN(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Sl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,p=0;if(o==1?(p=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(p=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Od(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(p>=f)for(a.push(a[0].slice(-f)),p-=f;p>=a[a.length-1].length;)a.push(a[a.length-1]),p-=a[a.length-1].length;a.push(a[0].slice(-f,-f+p))}}var d=Od(a);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function nN(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(rN(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Od(n)}function aN(e,n,t,r){var a=_p(e),o=a.getUint32(4,!0),l=(r>1?12:8)+jg(o&(r>1?3470:398))*4,c=-1,f=-1,p=NaN,d=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=jg(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(p=a.getFloat64(l,!0),l+=8),o&64&&(d.setTime(d.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:p};break;case 3:x={t:"s",v:n[f]};break;case 5:x={t:"d",v:d};break;case 6:x={t:"b",v:p>0};break;case 7:x={t:"n",v:p/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:t[c]};else if(f>-1)x={t:"s",v:n[f]};else if(!isNaN(p))x={t:"n",v:p};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function sN(e,n,t){var r=_p(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,p=NaN,d=new Date(2001,0,1);a&1&&(f=eN(e,o),o+=16),a&2&&(p=r.getFloat64(o,!0),o+=8),a&4&&(d.setTime(d.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:n[c]};break;case 5:x={t:"d",v:d};break;case 6:x={t:"b",v:p>0};break;case 7:x={t:"n",v:p/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return x}function oN(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return aN(e,n,t,e[0]);case 5:return sN(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Es(e){var n=Gr(e);return Sl(n[1][0].data)}function Lg(e,n){var t=Gr(n.data),r=Sr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=Gr(l.data),f=Sr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Ad(c[3][0].data);break;case 8:{var p=e[Es(c[9][0].data)][0],d=Gr(p.data),x=e[Es(d[1][0].data)][0],g=Sr(x.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var y=Gr(x.data);o[f]=y[3].map(function(k){return Ad(k.data)}).join("")}break}}),o}function iN(e,n){var t,r,a,o,l,c,f,p,d,x,g,y,k,w,_=Gr(e),S=Sr(_[1][0].data)>>>0,O=Sr(_[2][0].data)>>>0,T=((r=(t=_[8])==null?void 0:t[0])==null?void 0:r.data)&&Sr(_[8][0].data)>0||!1,B,J;if((o=(a=_[7])==null?void 0:a[0])!=null&&o.data&&n!=0)B=(c=(l=_[7])==null?void 0:l[0])==null?void 0:c.data,J=(p=(f=_[6])==null?void 0:f[0])==null?void 0:p.data;else if((x=(d=_[4])==null?void 0:d[0])!=null&&x.data&&n!=1)B=(y=(g=_[4])==null?void 0:g[0])==null?void 0:y.data,J=(w=(k=_[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var I=T?4:1,C=_p(B),Z=[],L=0;L<B.length/2;++L){var ne=C.getUint16(L*2,!0);ne<65535&&Z.push([L,ne])}if(Z.length!=O)throw"Expected ".concat(O," cells, found ").concat(Z.length);var X=[];for(L=0;L<Z.length-1;++L)X[Z[L][0]]=J.subarray(Z[L][1]*I,Z[L+1][1]*I);return Z.length>=1&&(X[Z[Z.length-1][0]]=J.subarray(Z[Z.length-1][1]*I)),{R:S,cells:X}}function lN(e,n){var t,r=Gr(n.data),a=(t=r?.[7])!=null&&t[0]?Sr(r[7][0].data)>>>0>0?1:0:-1,o=bp(r[5],function(l){return iN(l,a)});return{nrows:Sr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,p){if(l[c.R][p])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(p));l[c.R][p]=f}),l},[])}}function cN(e,n,t){var r,a=Gr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Sr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Sr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=bt(o);var l=Gr(a[4][0].data),c=Lg(e,e[Es(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?Lg(e,e[Es(l[17][0].data)][0]):[],p=Gr(l[3][0].data),d=0;p[1].forEach(function(x){var g=Gr(x.data),y=e[Es(g[2][0].data)][0],k=Sr(y.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=lN(e,y);w.data.forEach(function(_,S){_.forEach(function(O,T){var B=dt({r:d+S,c:T}),J=oN(O,c,f);J&&(t[B]=J)})}),d+=w.nrows})}function uN(e,n){var t=Gr(n.data),r={"!ref":"A1"},a=e[Es(t[2][0].data)],o=Sr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return cN(e,a[0],r),r}function fN(e,n){var t,r=Gr(n.data),a={name:(t=r[1])!=null&&t[0]?Ad(r[1][0].data):"",sheets:[]},o=bp(r[2],Es);return o.forEach(function(l){e[l].forEach(function(c){var f=Sr(c.meta[1][0].data);f==6e3&&a.sheets.push(uN(e,c))})}),a}function dN(e,n){var t=Tp(),r=Gr(n.data),a=bp(r[1],Es);if(a.forEach(function(o){e[o].forEach(function(l){var c=Sr(l.meta[1][0].data);if(c==2){var f=fN(e,l);f.sheets.forEach(function(p,d){Cp(t,p,d==0?f.name:f.name+"_"+d,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function sd(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var p;try{p=nN(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var d;try{d=tN(p)}catch(x){return console.log("## "+(x.message||x))}d.forEach(function(x){o[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Sr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(p){var d=Sr(p.meta[1][0].data)>>>0;if(d==1)if(!c)c=p;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return dN(o,c)}function pN(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Ep(e){pN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function hN(e){return Qo.WS.indexOf(e)>-1?"sheet":e==Qo.CS?"chart":e==Qo.DS?"dialog":e==Qo.MS?"macro":e&&e.length?e:"sheet"}function mN(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,hN(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function xN(e,n,t,r,a,o,l,c,f,p,d,x){try{o[r]=fl(En(e,t,!0),n);var g=vr(e,n),y;switch(c){case"sheet":y=_4(g,n,a,f,o[r],p,d,x);break;case"chart":if(y=b4(g,n,a,f,o[r],p,d,x),!y||!y["!drawel"])break;var k=al(y["!drawel"].Target,n),w=Td(k),_=kT(En(e,k,!0),fl(En(e,w,!0),k)),S=al(_,k),O=Td(S);y=s4(En(e,S,!0),S,f,fl(En(e,O,!0),S),p,y);break;case"macro":y=E4(g,n,a,f,o[r],p,d,x);break;case"dialog":y=S4(g,n,a,f,o[r],p,d,x);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=y;var T=[];o&&o[r]&&Ea(o[r]).forEach(function(B){var J="";if(o[r][B].Type==Qo.CMNT){J=al(o[r][B].Target,n);var I=N4(vr(e,J,!0),J,f);if(!I||!I.length)return;bg(y,I,!1)}o[r][B].Type==Qo.TCMNT&&(J=al(o[r][B].Target,n),T=T.concat(bT(vr(e,J,!0),f)))}),T&&T.length&&bg(y,T,!0,f.people||[])}catch(B){if(f.WTF)throw B}}function Mn(e){return e.charAt(0)=="/"?e.slice(1):e}function gN(e,n){if(r1(),n=n||{},Ep(n),Ln(e,"META-INF/manifest.xml")||Ln(e,"objectdata.xml"))return Mg(e,n);if(Ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof sd<"u"){if(e.FileIndex)return sd(e);var t=_t.utils.cfb_new();return Qx(e).forEach(function(le){v_(t,le,g_(e,le))}),sd(t)}throw new Error("Unsupported NUMBERS file")}if(!Ln(e,"[Content_Types].xml"))throw Ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Qx(e),a=pb(En(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",vr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!vr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},p={};if(!n.bookSheets&&!n.bookProps){if(hl=[],a.sst)try{hl=D4(vr(e,Mn(a.sst)),a.sst,n)}catch(le){if(n.WTF)throw le}n.cellStyles&&a.themes.length&&(f=C4(En(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(p=T4(vr(e,Mn(a.style)),a.style,f,n))}a.links.map(function(le){try{var re=fl(En(e,Td(Mn(le))),le);return A4(vr(e,Mn(le)),re,le,n)}catch{}});var d=k4(vr(e,Mn(a.workbooks[0])),a.workbooks[0],n),x={},g="";a.coreprops.length&&(g=vr(e,Mn(a.coreprops[0]),!0),g&&(x=A1(g)),a.extprops.length!==0&&(g=vr(e,Mn(a.extprops[0]),!0),g&&vb(g,x,n)));var y={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=En(e,Mn(a.custprops[0]),!0),g&&(y=wb(g,n)));var k={};if((n.bookSheets||n.bookProps)&&(d.Sheets?l=d.Sheets.map(function(re){return re.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),n.bookProps&&(k.Props=x,k.Custprops=y),n.bookSheets&&typeof l<"u"&&(k.SheetNames=l),n.bookSheets?k.SheetNames:n.bookProps))return k;l={};var w={};n.bookDeps&&a.calcchain&&(w=F4(vr(e,Mn(a.calcchain)),a.calcchain));var _=0,S={},O,T;{var B=d.Sheets;x.Worksheets=B.length,x.SheetNames=[];for(var J=0;J!=B.length;++J)x.SheetNames[J]=B[J].name}var I=o?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),Z=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Ln(e,Z)||(Z="xl/_rels/workbook."+I+".rels");var L=fl(En(e,Z,!0),Z.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=O4(vr(e,Mn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=ET(vr(e,Mn(a.people[0])),n)),L&&(L=mN(L,d.Sheets));var ne=vr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=x.Worksheets;++_){var X="sheet";if(L&&L[_]?(O="xl/"+L[_][1].replace(/[\/]?xl\//,""),Ln(e,O)||(O=L[_][1]),Ln(e,O)||(O=Z.replace(/_rels\/.*$/,"")+L[_][1]),X=L[_][2]):(O="xl/worksheets/sheet"+(_+1-ne)+"."+I,O=O.replace(/sheet0\./,"sheet.")),T=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(_!=n.sheets)continue e;break;case"string":if(x.SheetNames[_].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var W=!1,ue=0;ue!=n.sheets.length;++ue)typeof n.sheets[ue]=="number"&&n.sheets[ue]==_&&(W=1),typeof n.sheets[ue]=="string"&&n.sheets[ue].toLowerCase()==x.SheetNames[_].toLowerCase()&&(W=1);if(!W)continue e}}xN(e,O,T,x.SheetNames[_],_,S,l,X,n,d,f,p)}return k={Directory:a,Workbook:d,Props:x,Custprops:y,Deps:w,Sheets:l,SheetNames:x.SheetNames,Strings:hl,Styles:p,Themes:f,SSF:zr(pt)},n&&n.bookFiles&&(e.files?(k.keys=r,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(le,re){le=le.replace(/^Root Entry[\/]/,""),k.keys.push(le),k.files[le]=e.FileIndex[re]}))),n&&n.bookVBA&&(a.vba.length>0?k.vbaraw=vr(e,Mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===DT&&(k.vbaraw=vr(e,"xl/vbaProject.bin",!0))),k}function vN(e,n){var t=n||{},r="Workbook",a=_t.find(e,r);try{if(r="/!DataSpaces/Version",a=_t.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(uS(a.content),r="/!DataSpaces/DataSpaceMap",a=_t.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=dS(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=_t.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=pS(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=_t.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);mS(a.content)}catch{}if(r="/EncryptionInfo",a=_t.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=xS(a.content);if(r="/EncryptedPackage",a=_t.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Sp(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Tn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function yN(e,n){return _t.find(e,"EncryptedPackage")?vN(e,n):my(e,n)}function wN(e,n){var t,r=e,a=n||{};return a.type||(a.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),t=l1(r,a),gN(t,a)}function yy(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Nd(e.slice(t),n);default:break e}return _l.to_workbook(e,n)}function kN(e,n){var t="",r=Sp(e,n);switch(n.type){case"base64":t=Tn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=io(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Gt(t)),n.type="binary",yy(t,n)}function _N(e,n){var t=e;return n.type=="base64"&&(t=Tn(t)),t=vl.utils.decode(1200,t.slice(2),"str"),n.type="binary",yy(t,n)}function bN(e){return e.match(/[^\x00-\x7F]/)?sl(e):e}function od(e,n,t,r){return r?(t.type="string",_l.to_workbook(e,t)):_l.to_workbook(n,t)}function Pd(e,n){$v();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Pd(new Uint8Array(e),(t=zr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Jo={},t.dateNF&&(Jo.dateNF=t.dateNF),t.type||(t.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=yt?"buffer":"binary",r=u_(e),typeof Uint8Array<"u"&&!yt&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=bN(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=zr(t),t.type="array",Pd(np(r),t)}switch((a=Sp(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return yN(_t.read(r,t),t);break;case 9:if(a[1]<=8)return my(r,t);break;case 60:return Nd(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return qE(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return XE.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?wN(r,t):od(e,r,t,o);case 239:return a[3]===60?Nd(r,t):od(e,r,t,o);case 255:if(a[1]===254)return _N(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return pl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return pl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return _g.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return DS.to_workbook(r,t);break;case 10:case 13:case 32:return kN(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return KE.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?_g.to_workbook(r,t):od(e,r,t,o)}function EN(e,n,t,r,a,o,l,c){var f=Br(t),p=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var y=n.s.c;y<=n.e.c;++y){var k=l?e[t][y]:e[r[y]+f];if(k===void 0||k.t===void 0){if(p===void 0)continue;o[y]!=null&&(g[o[y]]=p);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(o[y]!=null){if(w==null)if(k.t=="e"&&w===null)g[o[y]]=null;else if(p!==void 0)g[o[y]]=p;else if(d&&w===null)g[o[y]]=null;else continue;else g[o[y]]=d&&(k.t!=="n"||k.t==="n"&&c.rawNumbers!==!1)?w:Ka(k,w,c);w!=null&&(x=!1)}}return{row:g,isempty:x}}function Rd(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},p=n||{},d=p.range!=null?p.range:e["!ref"];switch(p.header===1?r=1:p.header==="A"?r=2:Array.isArray(p.header)?r=3:p.header==null&&(r=0),typeof d){case"string":f=lr(d);break;case"number":f=lr(e["!ref"]),f.s.r=d;break;default:f=d}r>0&&(a=0);var x=Br(f.s.r),g=[],y=[],k=0,w=0,_=Array.isArray(e),S=f.s.r,O=0,T={};_&&!e[S]&&(e[S]=[]);var B=p.skipHidden&&e["!cols"]||[],J=p.skipHidden&&e["!rows"]||[];for(O=f.s.c;O<=f.e.c;++O)if(!(B[O]||{}).hidden)switch(g[O]=Er(O),t=_?e[S][O]:e[g[O]+x],r){case 1:o[O]=O-f.s.c;break;case 2:o[O]=g[O];break;case 3:o[O]=p.header[O-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ka(t,null,p),w=T[l]||0,!w)T[l]=1;else{do c=l+"_"+w++;while(T[c]);T[l]=w,T[c]=1}o[O]=c}for(S=f.s.r+a;S<=f.e.r;++S)if(!(J[S]||{}).hidden){var I=EN(e,f,S,g,r,o,_,p);(I.isempty===!1||(r===1?p.blankrows!==!1:p.blankrows))&&(y[k++]=I.row)}return y.length=k,y}var zg=/"/g;function SN(e,n,t,r,a,o,l,c){for(var f=!0,p=[],d="",x=Br(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var y=c.dense?(e[t]||[])[g]:e[r[g]+x];if(y==null)d="";else if(y.v!=null){f=!1,d=""+(c.rawNumbers&&y.t=="n"?y.v:Ka(y,null,c));for(var k=0,w=0;k!==d.length;++k)if((w=d.charCodeAt(k))===a||w===o||w===34||c.forceQuotes){d='"'+d.replace(zg,'""')+'"';break}d=="ID"&&(d='"ID"')}else y.f!=null&&!y.F?(f=!1,d="="+y.f,d.indexOf(",")>=0&&(d='"'+d.replace(zg,'""')+'"')):d="";p.push(d)}return c.blankrows===!1&&f?null:p.join(l)}function wy(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=lr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),p=new RegExp((o=="|"?"\\|":o)+"+$"),d="",x=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],y=r.skipHidden&&e["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(g[k]||{}).hidden||(x[k]=Er(k));for(var w=0,_=a.s.r;_<=a.e.r;++_)(y[_]||{}).hidden||(d=SN(e,a,_,x,l,f,o,r),d!=null&&(r.strip&&(d=d.replace(p,"")),(d||r.blankrows!==!1)&&t.push((w++?c:"")+d)));return delete r.dense,t.join("")}function TN(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=wy(e,n);return t}function CN(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=lr(e["!ref"]),o="",l=[],c,f=[],p=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Er(c);for(var d=a.s.r;d<=a.e.r;++d)for(o=Br(d),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=p?(e[d]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function ky(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?sn(r.origin):r.origin;l=f.r,c=f.c}var p,d={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var x=lr(o["!ref"]);d.e.c=Math.max(d.e.c,x.e.c),d.e.r=Math.max(d.e.r,x.e.r),l==-1&&(l=x.e.r+1,d.e.r=l+n.length-1+a)}else l==-1&&(l=0,d.e.r=n.length-1+a);var g=r.header||[],y=0;n.forEach(function(w,_){Ea(w).forEach(function(S){(y=g.indexOf(S))==-1&&(g[y=g.length]=S);var O=w[S],T="z",B="",J=dt({c:c+y,r:l+_+a});p=Tl(o,J),O&&typeof O=="object"&&!(O instanceof Date)?o[J]=O:(typeof O=="number"?T="n":typeof O=="boolean"?T="b":typeof O=="string"?T="s":O instanceof Date?(T="d",r.cellDates||(T="n",O=un(O)),B=r.dateNF||pt[14]):O===null&&r.nullError&&(T="e",O=0),p?(p.t=T,p.v=O,delete p.w,delete p.R,B&&(p.z=B)):o[J]=p={t:T,v:O},B&&(p.z=B))})}),d.e.c=Math.max(d.e.c,c+g.length-1);var k=Br(l);if(a)for(y=0;y<g.length;++y)o[Er(y+c)+k]={t:"s",v:g[y]};return o["!ref"]=bt(d),o}function DN(e,n){return ky(null,e,n)}function Tl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=sn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Tl(e,dt(n)):Tl(e,dt({r:n,c:t||0}))}function NN(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Tp(){return{SheetNames:[],Sheets:{}}}function Cp(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(p4(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function FN(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=NN(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function AN(e,n){return e.z=n,e}function _y(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function ON(e,n,t){return _y(e,"#"+n,t)}function PN(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function RN(e,n,t,r){for(var a=typeof n!="string"?n:lr(n),o=typeof n=="string"?n:bt(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Tl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var MN={encode_col:Er,encode_row:Br,encode_cell:dt,encode_range:bt,decode_col:dp,decode_row:fp,split_cell:V_,decode_cell:sn,decode_range:pi,format_cell:Ka,sheet_add_aoa:T1,sheet_add_json:ky,sheet_add_dom:xy,aoa_to_sheet:hi,json_to_sheet:DN,table_to_sheet:gy,table_to_book:q4,sheet_to_csv:wy,sheet_to_txt:TN,sheet_to_json:Rd,sheet_to_html:Q4,sheet_to_formulae:CN,sheet_to_row_object_array:Rd,sheet_get_cell:Tl,book_new:Tp,book_append_sheet:Cp,book_set_sheet_visibility:FN,cell_set_number_format:AN,cell_set_hyperlink:_y,cell_set_internal_link:ON,cell_add_comment:PN,sheet_set_array_formula:RN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const IN=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=A.useState(null),o=A.useRef(null),l=p=>{const d=p.target.files?.[0];d&&a(d)},c=()=>{if(r){const p=new FileReader;p.onload=d=>{try{const x=new Uint8Array(d.target?.result),g=Pd(x,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const y=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",y);const k=MN.sheet_to_json(y,{header:1});console.log("Parsed JSON data:",k);const w={headers:k[0],rows:k.slice(1)};console.log("Prepared file data:",w),t(r.name,w),f()}catch(x){console.error("Error reading Excel file:",x)}},p.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return h.jsx(Pr,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Załaduj plik Excel"}),h.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-2 overflow-hidden",children:h.jsx("div",{children:h.jsxs("div",{className:"relative mt-8",children:[h.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),h.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[h.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&h.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[h.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),h.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Załaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Załaduj"})]})]})})},jN=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:h.jsxs("div",{className:"h-full flex items-center justify-between",children:[h.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastąpić "',r,'"?']}),h.jsxs("div",{className:"flex space-x-2 shrink-0",children:[h.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),h.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastąp"})]})]})});function by(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=by(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Lr(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=by(e))&&(r&&(r+=" "),r+=n);return r}const Ey=6048e5,LN=864e5,Zu=6e4,Ju=36e5,zN=1e3,Bg=Symbol.for("constructDateFrom");function Bt(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Bg in e?e[Bg](n):e instanceof Date?new e.constructor(n):new Date(n)}function Je(e,n){return Bt(n||e,e)}function aa(e,n,t){const r=Je(e,t?.in);return isNaN(n)?Bt(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function sa(e,n,t){const r=Je(e,t?.in);if(isNaN(n))return Bt(e,NaN);if(!n)return r;const a=r.getDate(),o=Bt(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function Sy(e,n,t){return Bt(e,+Je(e)+n)}function BN(e,n,t){return Sy(e,n*Ju)}let WN={};function wo(){return WN}function oa(e,n){const t=wo(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Je(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function oi(e,n){return oa(e,{...n,weekStartsOn:1})}function Ty(e,n){const t=Je(e,n?.in),r=t.getFullYear(),a=Bt(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=oi(a),l=Bt(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=oi(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Au(e){const n=Je(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function Da(e,...n){const t=Bt.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function co(e,n){const t=Je(e,n?.in);return t.setHours(0,0,0,0),t}function ii(e,n,t){const[r,a]=Da(t?.in,e,n),o=co(r),l=co(a),c=+o-Au(o),f=+l-Au(l);return Math.round((c-f)/LN)}function UN(e,n){const t=Ty(e,n),r=Bt(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),oi(r)}function Md(e,n,t){const r=Je(e,t?.in);return r.setTime(r.getTime()+n*Zu),r}function Dp(e,n,t){return sa(e,n*3,t)}function HN(e,n,t){return Sy(e,n*1e3)}function Ou(e,n,t){return aa(e,n*7,t)}function Ua(e,n,t){return sa(e,n*12,t)}function Wg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Bt.bind(null,a));const o=Je(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Bt(r,t||NaN)}function Ug(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Bt.bind(null,a));const o=Je(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Bt(r,t||NaN)}function $N(e,n,t){const[r,a]=Da(t?.in,e,n);return+co(r)==+co(a)}function Ha(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Pu(e){return!(!Ha(e)&&typeof e!="number"||isNaN(+Je(e)))}function Ru(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function ro(e,n){const t=Je(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function Mu(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=ro(r)-ro(a);return o*4+l}function Iu(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function YN(e,n,t){const[r,a]=Da(t?.in,e,n),o=Hg(r,a),l=Math.abs(ii(r,a));r.setDate(r.getDate()-o*l);const c=+(Hg(r,a)===-o),f=o*(l-c);return f===0?0:f}function Hg(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function Cy(e,n){const t=Je(e,n?.in);return t.setHours(23,59,59,999),t}function Dy(e,n){const t=Je(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Id(e,n){const t=Je(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function Ny(e,n){const t=Je(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Fy(e,n){const t=Je(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function ef(e,n){const t=Je(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function VN(e,n){const t=wo(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Je(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const KN={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},GN=(e,n,t)=>{let r;const a=KN[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function ei(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const XN={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},QN={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qN={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ZN={date:ei({formats:XN,defaultWidth:"full"}),time:ei({formats:QN,defaultWidth:"full"}),dateTime:ei({formats:qN,defaultWidth:"full"})},JN={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e3=(e,n,t,r)=>JN[e];function va(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const t3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},r3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},n3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},a3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},s3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},i3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},l3={ordinalNumber:i3,era:va({values:t3,defaultWidth:"wide"}),quarter:va({values:r3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:va({values:n3,defaultWidth:"wide"}),day:va({values:a3,defaultWidth:"wide"}),dayPeriod:va({values:s3,defaultWidth:"wide",formattingValues:o3,defaultFormattingWidth:"wide"})};function ya(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?u3(c,x=>x.test(l)):c3(c,x=>x.test(l));let p;p=e.valueCallback?e.valueCallback(f):f,p=t.valueCallback?t.valueCallback(p):p;const d=n.slice(l.length);return{value:p,rest:d}}}function c3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function u3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function Ay(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const f3=/^(\d+)(th|st|nd|rd)?/i,d3=/\d+/i,p3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},h3={any:[/^b/i,/^(a|c)/i]},m3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},x3={any:[/1/i,/2/i,/3/i,/4/i]},g3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},v3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},y3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},w3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},k3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},b3={ordinalNumber:Ay({matchPattern:f3,parsePattern:d3,valueCallback:e=>parseInt(e,10)}),era:ya({matchPatterns:p3,defaultMatchWidth:"wide",parsePatterns:h3,defaultParseWidth:"any"}),quarter:ya({matchPatterns:m3,defaultMatchWidth:"wide",parsePatterns:x3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ya({matchPatterns:g3,defaultMatchWidth:"wide",parsePatterns:v3,defaultParseWidth:"any"}),day:ya({matchPatterns:y3,defaultMatchWidth:"wide",parsePatterns:w3,defaultParseWidth:"any"}),dayPeriod:ya({matchPatterns:k3,defaultMatchWidth:"any",parsePatterns:_3,defaultParseWidth:"any"})},Oy={code:"en-US",formatDistance:GN,formatLong:ZN,formatRelative:e3,localize:l3,match:b3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function E3(e,n){const t=Je(e,n?.in);return ii(t,ef(t))+1}function Np(e,n){const t=Je(e,n?.in),r=+oi(t)-+UN(t);return Math.round(r/Ey)+1}function Fp(e,n){const t=Je(e,n?.in),r=t.getFullYear(),a=wo(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Bt(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=oa(l,n),f=Bt(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const p=oa(f,n);return+t>=+c?r+1:+t>=+p?r:r-1}function S3(e,n){const t=wo(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Fp(e,n),o=Bt(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),oa(o,n)}function Py(e,n){const t=Je(e,n?.in),r=+oa(t,n)-+S3(t,n);return Math.round(r/Ey)+1}function zt(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const vs={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return zt(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):zt(t+1,2)},d(e,n){return zt(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return zt(e.getHours()%12||12,n.length)},H(e,n){return zt(e.getHours(),n.length)},m(e,n){return zt(e.getMinutes(),n.length)},s(e,n){return zt(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return zt(a,n.length)}},Vo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$g={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return vs.y(e,n)},Y:function(e,n,t,r){const a=Fp(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return zt(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):zt(o,n.length)},R:function(e,n){const t=Ty(e);return zt(t,n.length)},u:function(e,n){const t=e.getFullYear();return zt(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return zt(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return zt(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return vs.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return zt(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=Py(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):zt(a,n.length)},I:function(e,n,t){const r=Np(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):zt(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):vs.d(e,n)},D:function(e,n,t){const r=E3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):zt(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return zt(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return zt(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return zt(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Vo.noon:r===0?a=Vo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Vo.evening:r>=12?a=Vo.afternoon:r>=4?a=Vo.morning:a=Vo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return vs.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):vs.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):zt(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):zt(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):vs.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):vs.s(e,n)},S:function(e,n){return vs.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Vg(r);case"XXXX":case"XX":return Gs(r);case"XXXXX":case"XXX":default:return Gs(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Vg(r);case"xxxx":case"xx":return Gs(r);case"xxxxx":case"xxx":default:return Gs(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Yg(r,":");case"OOOO":default:return"GMT"+Gs(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Yg(r,":");case"zzzz":default:return"GMT"+Gs(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return zt(r,n.length)},T:function(e,n,t){return zt(+e,n.length)}};function Yg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+zt(o,2)}function Vg(e,n){return e%60===0?(e>0?"-":"+")+zt(Math.abs(e)/60,2):Gs(e,n)}function Gs(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=zt(Math.trunc(r/60),2),o=zt(r%60,2);return t+a+n+o}const Kg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},Ry=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},T3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Kg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Kg(r,n)).replace("{{time}}",Ry(a,n))},jd={p:Ry,P:T3},C3=/^D+$/,D3=/^Y+$/,N3=["D","DD","YY","YYYY"];function F3(e){return C3.test(e)}function A3(e){return D3.test(e)}function O3(e,n,t){const r=P3(e,n,t);if(console.warn(r),N3.includes(e))throw new RangeError(r)}function P3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const R3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,M3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,I3=/^'([^]*?)'?$/,j3=/''/g,L3=/[a-zA-Z]/;function Gg(e,n,t){const r=wo(),a=t?.locale??r.locale??Oy,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=Je(e,t?.in);if(!Pu(c))throw new RangeError("Invalid time value");let f=n.match(M3).map(d=>{const x=d[0];if(x==="p"||x==="P"){const g=jd[x];return g(d,a.formatLong)}return d}).join("").match(R3).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const x=d[0];if(x==="'")return{isToken:!1,value:z3(d)};if($g[x])return{isToken:!0,value:d};if(x.match(L3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:d}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const p={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(d=>{if(!d.isToken)return d.value;const x=d.value;(!t?.useAdditionalWeekYearTokens&&A3(x)||!t?.useAdditionalDayOfYearTokens&&F3(x))&&O3(x,n,String(e));const g=$g[x[0]];return g(c,x,a.localize,p)}).join("")}function z3(e){const n=e.match(I3);return n?n[1].replace(j3,"'"):e}function Xg(e,n){return Je(e,n?.in).getDate()}function B3(e,n){return Je(e,n?.in).getDay()}function W3(e,n){const t=Je(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Bt(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function U3(){return Object.assign({},wo())}function $a(e,n){return Je(e,n?.in).getHours()}function H3(e,n){const t=Je(e,n?.in).getDay();return t===0?7:t}function Ya(e,n){return Je(e,n?.in).getMinutes()}function on(e,n){return Je(e,n?.in).getMonth()}function Ss(e){return Je(e).getSeconds()}function Ld(e){return+Je(e)}function xt(e,n){return Je(e,n?.in).getFullYear()}function Ns(e,n){return+Je(e)>+Je(n)}function uo(e,n){return+Je(e)<+Je(n)}function $3(e,n){return+Je(e)==+Je(n)}function Y3(e,n){const t=V3(n)?new n(0):Bt(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function V3(e){return typeof e=="function"&&e.prototype?.constructor===e}const K3=10;class My{subPriority=0;validate(n,t){return!0}}class G3 extends My{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class X3 extends My{priority=K3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Bt(t,r))}set(n,t){return t.timestampIsSet?n:Bt(n,Y3(n,this.context))}}class Ot{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new G3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class Q3 extends Ot{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const hr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},wa={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function mr(e,n){return e&&{value:n(e.value),rest:e.rest}}function sr(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function ka(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*Ju+o*Zu+l*zN),rest:n.slice(t[0].length)}}function Iy(e){return sr(hr.anyDigitsSigned,e)}function cr(e,n){switch(e){case 1:return sr(hr.singleDigit,n);case 2:return sr(hr.twoDigits,n);case 3:return sr(hr.threeDigits,n);case 4:return sr(hr.fourDigits,n);default:return sr(new RegExp("^\\d{1,"+e+"}"),n)}}function ju(e,n){switch(e){case 1:return sr(hr.singleDigitSigned,n);case 2:return sr(hr.twoDigitsSigned,n);case 3:return sr(hr.threeDigitsSigned,n);case 4:return sr(hr.fourDigitsSigned,n);default:return sr(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Ap(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function jy(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function Ly(e){return e%400===0||e%4===0&&e%100!==0}class q3 extends Ot{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return mr(cr(4,n),a);case"yo":return mr(r.ordinalNumber(n,{unit:"year"}),a);default:return mr(cr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=jy(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class Z3 extends Ot{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return mr(cr(4,n),a);case"Yo":return mr(r.ordinalNumber(n,{unit:"year"}),a);default:return mr(cr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=Fp(n,a);if(r.isTwoDigitYear){const c=jy(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class J3 extends Ot{priority=130;parse(n,t){return ju(t==="R"?4:t.length,n)}set(n,t,r){const a=Bt(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),oi(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class eF extends Ot{priority=130;parse(n,t){return ju(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class tF extends Ot{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return cr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class rF extends Ot{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return cr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class nF extends Ot{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return mr(sr(hr.month,n),a);case"MM":return mr(cr(2,n),a);case"Mo":return mr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class aF extends Ot{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return mr(sr(hr.month,n),a);case"LL":return mr(cr(2,n),a);case"Lo":return mr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function sF(e,n,t){const r=Je(e,t?.in),a=Py(r,t)-n;return r.setDate(r.getDate()-a*7),Je(r,t?.in)}class oF extends Ot{priority=100;parse(n,t,r){switch(t){case"w":return sr(hr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return oa(sF(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function iF(e,n,t){const r=Je(e,t?.in),a=Np(r,t)-n;return r.setDate(r.getDate()-a*7),r}class lF extends Ot{priority=100;parse(n,t,r){switch(t){case"I":return sr(hr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return oi(iF(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const cF=[31,28,31,30,31,30,31,31,30,31,30,31],uF=[31,29,31,30,31,30,31,31,30,31,30,31];class fF extends Ot{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return sr(hr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return cr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=Ly(r),o=n.getMonth();return a?t>=1&&t<=uF[o]:t>=1&&t<=cF[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class dF extends Ot{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return sr(hr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return cr(t.length,n)}}validate(n,t){const r=n.getFullYear();return Ly(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Op(e,n,t){const r=wo(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=Je(e,t?.in),l=o.getDay(),f=(n%7+7)%7,p=7-a,d=n<0||n>6?n-(l+p)%7:(f+p)%7-(l+p)%7;return aa(o,d,t)}class pF extends Ot{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class hF extends Ot{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return mr(cr(t.length,n),o);case"eo":return mr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class mF extends Ot{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return mr(cr(t.length,n),o);case"co":return mr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function xF(e,n,t){const r=Je(e,t?.in),a=H3(r,t),o=n-a;return aa(r,o,t)}class gF extends Ot{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return cr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return mr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return mr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return mr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return mr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=xF(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class vF extends Ot{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class yF extends Ot{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class wF extends Ot{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class kF extends Ot{priority=70;parse(n,t,r){switch(t){case"h":return sr(hr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class _F extends Ot{priority=70;parse(n,t,r){switch(t){case"H":return sr(hr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class bF extends Ot{priority=70;parse(n,t,r){switch(t){case"K":return sr(hr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class EF extends Ot{priority=70;parse(n,t,r){switch(t){case"k":return sr(hr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class SF extends Ot{priority=60;parse(n,t,r){switch(t){case"m":return sr(hr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class TF extends Ot{priority=50;parse(n,t,r){switch(t){case"s":return sr(hr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class CF extends Ot{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return mr(cr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class DF extends Ot{priority=10;parse(n,t){switch(t){case"X":return ka(wa.basicOptionalMinutes,n);case"XX":return ka(wa.basic,n);case"XXXX":return ka(wa.basicOptionalSeconds,n);case"XXXXX":return ka(wa.extendedOptionalSeconds,n);case"XXX":default:return ka(wa.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Bt(n,n.getTime()-Au(n)-r)}incompatibleTokens=["t","T","x"]}class NF extends Ot{priority=10;parse(n,t){switch(t){case"x":return ka(wa.basicOptionalMinutes,n);case"xx":return ka(wa.basic,n);case"xxxx":return ka(wa.basicOptionalSeconds,n);case"xxxxx":return ka(wa.extendedOptionalSeconds,n);case"xxx":default:return ka(wa.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Bt(n,n.getTime()-Au(n)-r)}incompatibleTokens=["t","T","X"]}class FF extends Ot{priority=40;parse(n){return Iy(n)}set(n,t,r){return[Bt(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class AF extends Ot{priority=20;parse(n){return Iy(n)}set(n,t,r){return[Bt(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const OF={G:new Q3,y:new q3,Y:new Z3,R:new J3,u:new eF,Q:new tF,q:new rF,M:new nF,L:new aF,w:new oF,I:new lF,d:new fF,D:new dF,E:new pF,e:new hF,c:new mF,i:new gF,a:new vF,b:new yF,B:new wF,h:new kF,H:new _F,K:new bF,k:new EF,m:new SF,s:new TF,S:new CF,X:new DF,x:new NF,t:new FF,T:new AF},PF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,RF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,MF=/^'([^]*?)'?$/,IF=/''/g,jF=/\S/,LF=/[a-zA-Z]/;function zF(e,n,t,r){const a=()=>Bt(r?.in||t,NaN),o=U3(),l=r?.locale??o.locale??Oy,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():Je(t,r?.in);const p={firstWeekContainsDate:c,weekStartsOn:f,locale:l},d=[new X3(r?.in,t)],x=n.match(RF).map(_=>{const S=_[0];if(S in jd){const O=jd[S];return O(_,l.formatLong)}return _}).join("").match(PF),g=[];for(let _ of x){const S=_[0],O=OF[S];if(O){const{incompatibleTokens:T}=O;if(Array.isArray(T)){const J=g.find(I=>T.includes(I.token)||I.token===S);if(J)throw new RangeError(`The format string mustn't contain \`${J.fullToken}\` and \`${_}\` at the same time`)}else if(O.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${_}\` and any other token at the same time`);g.push({token:S,fullToken:_});const B=O.run(e,_,l.match,p);if(!B)return a();d.push(B.setter),e=B.rest}else{if(S.match(LF))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");if(_==="''"?_="'":S==="'"&&(_=BF(_)),e.indexOf(_)===0)e=e.slice(_.length);else return a()}}if(e.length>0&&jF.test(e))return a();const y=d.map(_=>_.priority).sort((_,S)=>S-_).filter((_,S,O)=>O.indexOf(_)===S).map(_=>d.filter(S=>S.priority===_).sort((S,O)=>O.subPriority-S.subPriority)).map(_=>_[0]);let k=Je(t,r?.in);if(isNaN(+k))return a();const w={};for(const _ of y){if(!_.validate(k,p))return a();const S=_.set(k,w,p);Array.isArray(S)?(k=S[0],Object.assign(w,S[1])):k=S}return k}function BF(e){return e.match(MF)[1].replace(IF,"'")}function WF(e,n,t){const[r,a]=Da(t?.in,e,n);return+oa(r,t)==+oa(a,t)}function UF(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function HF(e,n,t){const[r,a]=Da(t?.in,e,n);return+Id(r)==+Id(a)}function $F(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Cl(e,n,t){const r=+Je(e,t?.in),[a,o]=[+Je(n.start,t?.in),+Je(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function YF(e,n,t){return aa(e,-1,t)}function VF(e,n){const t=()=>Bt(n?.in,NaN),a=QF(e);let o;if(a.date){const p=qF(a.date,2);o=ZF(p.restDateString,p.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=JF(a.time),isNaN(c)))return t();if(a.timezone){if(f=eA(a.timezone),isNaN(f))return t()}else{const p=new Date(l+c),d=Je(0,n?.in);return d.setFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()),d.setHours(p.getUTCHours(),p.getUTCMinutes(),p.getUTCSeconds(),p.getUTCMilliseconds()),d}return Je(l+c+f,n?.in)}const su={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},KF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,GF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,XF=/^([+-])(\d{2})(?::?(\d{2}))?$/;function QF(e){const n={},t=e.split(su.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],su.timeZoneDelimiter.test(n.date)&&(n.date=e.split(su.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=su.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function qF(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function ZF(e,n){if(n===null)return new Date(NaN);const t=e.match(KF);if(!t)return new Date(NaN);const r=!!t[4],a=el(t[1]),o=el(t[2])-1,l=el(t[3]),c=el(t[4]),f=el(t[5])-1;if(r)return sA(n,c,f)?tA(n,c,f):new Date(NaN);{const p=new Date(0);return!nA(n,o,l)||!aA(n,a)?new Date(NaN):(p.setUTCFullYear(n,o,Math.max(a,l)),p)}}function el(e){return e?parseInt(e):1}function JF(e){const n=e.match(GF);if(!n)return NaN;const t=id(n[1]),r=id(n[2]),a=id(n[3]);return oA(t,r,a)?t*Ju+r*Zu+a*1e3:NaN}function id(e){return e&&parseFloat(e.replace(",","."))||0}function eA(e){if(e==="Z")return 0;const n=e.match(XF);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return iA(r,a)?t*(r*Ju+a*Zu):NaN}function tA(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const rA=[31,null,31,30,31,30,31,31,30,31,30,31];function zy(e){return e%400===0||e%4===0&&e%100!==0}function nA(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(rA[n]||(zy(e)?29:28))}function aA(e,n){return n>=1&&n<=(zy(e)?366:365)}function sA(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function oA(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function iA(e,n){return n>=0&&n<=59}function Bn(e,n,t){const r=Je(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Bt(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=W3(l);return r.setMonth(n,Math.min(o,c)),r}function pu(e,n,t){const r=Je(e,t?.in);return r.setHours(n),r}function hu(e,n,t){const r=Je(e,t?.in);return r.setMinutes(n),r}function Xo(e,n,t){const r=Je(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Bn(r,r.getMonth()+o*3)}function mu(e,n,t){const r=Je(e,t?.in);return r.setSeconds(n),r}function xa(e,n,t){const r=Je(e,t?.in);return isNaN(+r)?Bt(e,NaN):(r.setFullYear(n),r)}function no(e,n,t){return sa(e,-n,t)}function By(e,n,t){return Dp(e,-1,t)}function Qg(e,n,t){return Ou(e,-1,t)}function li(e,n,t){return Ua(e,-n,t)}function tf(){return typeof window<"u"}function mi(e){return Wy(e)?(e.nodeName||"").toLowerCase():"#document"}function Sn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Na(e){var n;return(n=(Wy(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function Wy(e){return tf()?e instanceof Node||e instanceof Sn(e).Node:!1}function ln(e){return tf()?e instanceof Element||e instanceof Sn(e).Element:!1}function Sa(e){return tf()?e instanceof HTMLElement||e instanceof Sn(e).HTMLElement:!1}function qg(e){return!tf()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Sn(e).ShadowRoot}function Il(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Hn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function lA(e){return["table","td","th"].includes(mi(e))}function rf(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Pp(e){const n=Rp(),t=ln(e)?Hn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function cA(e){let n=Fs(e);for(;Sa(n)&&!ci(n);){if(Pp(n))return n;if(rf(n))return null;n=Fs(n)}return null}function Rp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ci(e){return["html","body","#document"].includes(mi(e))}function Hn(e){return Sn(e).getComputedStyle(e)}function nf(e){return ln(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Fs(e){if(mi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||qg(e)&&e.host||Na(e);return qg(n)?n.host:n}function Uy(e){const n=Fs(e);return ci(n)?e.ownerDocument?e.ownerDocument.body:e.body:Sa(n)&&Il(n)?n:Uy(n)}function Dl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=Uy(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Sn(a);if(o){const c=zd(l);return n.concat(l,l.visualViewport||[],Il(a)?a:[],c&&t?Dl(c):[])}return n.concat(a,Dl(a,[],t))}function zd(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const ui=Math.min,ao=Math.max,Lu=Math.round,ou=Math.floor,ba=e=>({x:e,y:e}),uA={left:"right",right:"left",bottom:"top",top:"bottom"},fA={start:"end",end:"start"};function Bd(e,n,t){return ao(e,ui(n,t))}function jl(e,n){return typeof e=="function"?e(n):e}function fo(e){return e.split("-")[0]}function Ll(e){return e.split("-")[1]}function Hy(e){return e==="x"?"y":"x"}function Mp(e){return e==="y"?"height":"width"}function so(e){return["top","bottom"].includes(fo(e))?"y":"x"}function Ip(e){return Hy(so(e))}function dA(e,n,t){t===void 0&&(t=!1);const r=Ll(e),a=Ip(e),o=Mp(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=zu(l)),[l,zu(l)]}function pA(e){const n=zu(e);return[Wd(e),n,Wd(n)]}function Wd(e){return e.replace(/start|end/g,n=>fA[n])}function hA(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function mA(e,n,t,r){const a=Ll(e);let o=hA(fo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map(Wd)))),o}function zu(e){return e.replace(/left|right|bottom|top/g,n=>uA[n])}function xA(e){return{top:0,right:0,bottom:0,left:0,...e}}function $y(e){return typeof e!="number"?xA(e):{top:e,right:e,bottom:e,left:e}}function Bu(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var Wu=typeof document<"u"?A.useLayoutEffect:A.useEffect;const gA={...Mv},vA=gA.useInsertionEffect,yA=vA||(e=>e());function wA(e){const n=A.useRef(()=>{});return yA(()=>{n.current=e}),A.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var Yy=Xd();const kA=Vu(Yy);function Zg(e,n,t){let{reference:r,floating:a}=e;const o=so(n),l=Ip(n),c=Mp(l),f=fo(n),p=o==="y",d=r.x+r.width/2-a.width/2,x=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let y;switch(f){case"top":y={x:d,y:r.y-a.height};break;case"bottom":y={x:d,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:x};break;case"left":y={x:r.x-a.width,y:x};break;default:y={x:r.x,y:r.y}}switch(Ll(n)){case"start":y[l]-=g*(t&&p?-1:1);break;case"end":y[l]+=g*(t&&p?-1:1);break}return y}const _A=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let p=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:d,y:x}=Zg(p,r,f),g=r,y={},k=0;for(let w=0;w<c.length;w++){const{name:_,fn:S}=c[w],{x:O,y:T,data:B,reset:J}=await S({x:d,y:x,initialPlacement:r,placement:g,strategy:a,middlewareData:y,rects:p,platform:l,elements:{reference:e,floating:n}});d=O??d,x=T??x,y={...y,[_]:{...y[_],...B}},J&&k<=50&&(k++,typeof J=="object"&&(J.placement&&(g=J.placement),J.rects&&(p=J.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):J.rects),{x:d,y:x}=Zg(p,g,f)),w=-1)}return{x:d,y:x,placement:g,strategy:a,middlewareData:y}};async function Vy(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:p="clippingAncestors",rootBoundary:d="viewport",elementContext:x="floating",altBoundary:g=!1,padding:y=0}=jl(n,e),k=$y(y),_=c[g?x==="floating"?"reference":"floating":x],S=Bu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(_)))==null||t?_:_.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:p,rootBoundary:d,strategy:f})),O=x==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,T=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),B=await(o.isElement==null?void 0:o.isElement(T))?await(o.getScale==null?void 0:o.getScale(T))||{x:1,y:1}:{x:1,y:1},J=Bu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:O,offsetParent:T,strategy:f}):O);return{top:(S.top-J.top+k.top)/B.y,bottom:(J.bottom-S.bottom+k.bottom)/B.y,left:(S.left-J.left+k.left)/B.x,right:(J.right-S.right+k.right)/B.x}}const bA=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:p,padding:d=0}=jl(e,n)||{};if(p==null)return{};const x=$y(d),g={x:t,y:r},y=Ip(a),k=Mp(y),w=await l.getDimensions(p),_=y==="y",S=_?"top":"left",O=_?"bottom":"right",T=_?"clientHeight":"clientWidth",B=o.reference[k]+o.reference[y]-g[y]-o.floating[k],J=g[y]-o.reference[y],I=await(l.getOffsetParent==null?void 0:l.getOffsetParent(p));let C=I?I[T]:0;(!C||!await(l.isElement==null?void 0:l.isElement(I)))&&(C=c.floating[T]||o.floating[k]);const Z=B/2-J/2,L=C/2-w[k]/2-1,ne=ui(x[S],L),X=ui(x[O],L),W=ne,ue=C-w[k]-X,le=C/2-w[k]/2+Z,re=Bd(W,le,ue),he=!f.arrow&&Ll(a)!=null&&le!==re&&o.reference[k]/2-(le<W?ne:X)-w[k]/2<0,K=he?le<W?le-W:le-ue:0;return{[y]:g[y]+K,data:{[y]:re,centerOffset:le-re-K,...he&&{alignmentOffset:K}},reset:he}}}),EA=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:p}=n,{mainAxis:d=!0,crossAxis:x=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:w=!0,..._}=jl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const S=fo(a),O=so(c),T=fo(c)===c,B=await(f.isRTL==null?void 0:f.isRTL(p.floating)),J=g||(T||!w?[zu(c)]:pA(c)),I=k!=="none";!g&&I&&J.push(...mA(c,w,k,B));const C=[c,...J],Z=await Vy(n,_),L=[];let ne=((r=o.flip)==null?void 0:r.overflows)||[];if(d&&L.push(Z[S]),x){const re=dA(a,l,B);L.push(Z[re[0]],Z[re[1]])}if(ne=[...ne,{placement:a,overflows:L}],!L.every(re=>re<=0)){var X,W;const re=(((X=o.flip)==null?void 0:X.index)||0)+1,he=C[re];if(he){var ue;const se=x==="alignment"?O!==so(he):!1,R=((ue=ne[0])==null?void 0:ue.overflows[0])>0;if(!se||R)return{data:{index:re,overflows:ne},reset:{placement:he}}}let K=(W=ne.filter(se=>se.overflows[0]<=0).sort((se,R)=>se.overflows[1]-R.overflows[1])[0])==null?void 0:W.placement;if(!K)switch(y){case"bestFit":{var le;const se=(le=ne.filter(R=>{if(I){const Y=so(R.placement);return Y===O||Y==="y"}return!0}).map(R=>[R.placement,R.overflows.filter(Y=>Y>0).reduce((Y,P)=>Y+P,0)]).sort((R,Y)=>R[1]-Y[1])[0])==null?void 0:le[0];se&&(K=se);break}case"initialPlacement":K=c;break}if(a!==K)return{reset:{placement:K}}}return{}}}};async function SA(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=fo(t),c=Ll(t),f=so(t)==="y",p=["left","top"].includes(l)?-1:1,d=o&&f?-1:1,x=jl(n,e);let{mainAxis:g,crossAxis:y,alignmentAxis:k}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return c&&typeof k=="number"&&(y=c==="end"?k*-1:k),f?{x:y*d,y:g*p}:{x:g*p,y:y*d}}const TA=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await SA(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},CA=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:_=>{let{x:S,y:O}=_;return{x:S,y:O}}},...f}=jl(e,n),p={x:t,y:r},d=await Vy(n,f),x=so(fo(a)),g=Hy(x);let y=p[g],k=p[x];if(o){const _=g==="y"?"top":"left",S=g==="y"?"bottom":"right",O=y+d[_],T=y-d[S];y=Bd(O,y,T)}if(l){const _=x==="y"?"top":"left",S=x==="y"?"bottom":"right",O=k+d[_],T=k-d[S];k=Bd(O,k,T)}const w=c.fn({...n,[g]:y,[x]:k});return{...w,data:{x:w.x-t,y:w.y-r,enabled:{[g]:o,[x]:l}}}}}};function Ky(e){const n=Hn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Sa(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=Lu(t)!==o||Lu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function jp(e){return ln(e)?e:e.contextElement}function ti(e){const n=jp(e);if(!Sa(n))return ba(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Ky(n);let l=(o?Lu(t.width):t.width)/r,c=(o?Lu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const DA=ba(0);function Gy(e){const n=Sn(e);return!Rp()||!n.visualViewport?DA:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function NA(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Sn(e)?!1:n}function po(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=jp(e);let l=ba(1);n&&(r?ln(r)&&(l=ti(r)):l=ti(e));const c=NA(o,t,r)?Gy(o):ba(0);let f=(a.left+c.x)/l.x,p=(a.top+c.y)/l.y,d=a.width/l.x,x=a.height/l.y;if(o){const g=Sn(o),y=r&&ln(r)?Sn(r):r;let k=g,w=zd(k);for(;w&&r&&y!==k;){const _=ti(w),S=w.getBoundingClientRect(),O=Hn(w),T=S.left+(w.clientLeft+parseFloat(O.paddingLeft))*_.x,B=S.top+(w.clientTop+parseFloat(O.paddingTop))*_.y;f*=_.x,p*=_.y,d*=_.x,x*=_.y,f+=T,p+=B,k=Sn(w),w=zd(k)}}return Bu({width:d,height:x,x:f,y:p})}function Lp(e,n){const t=nf(e).scrollLeft;return n?n.left+t:po(Na(e)).left+t}function Xy(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:Lp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function FA(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Na(r),c=n?rf(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},p=ba(1);const d=ba(0),x=Sa(r);if((x||!x&&!o)&&((mi(r)!=="body"||Il(l))&&(f=nf(r)),Sa(r))){const y=po(r);p=ti(r),d.x=y.x+r.clientLeft,d.y=y.y+r.clientTop}const g=l&&!x&&!o?Xy(l,f,!0):ba(0);return{width:t.width*p.x,height:t.height*p.y,x:t.x*p.x-f.scrollLeft*p.x+d.x+g.x,y:t.y*p.y-f.scrollTop*p.y+d.y+g.y}}function AA(e){return Array.from(e.getClientRects())}function OA(e){const n=Na(e),t=nf(e),r=e.ownerDocument.body,a=ao(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=ao(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+Lp(e);const c=-t.scrollTop;return Hn(r).direction==="rtl"&&(l+=ao(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function PA(e,n){const t=Sn(e),r=Na(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const p=Rp();(!p||p&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function RA(e,n){const t=po(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Sa(e)?ti(e):ba(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,p=r*o.y;return{width:l,height:c,x:f,y:p}}function Jg(e,n,t){let r;if(n==="viewport")r=PA(e,t);else if(n==="document")r=OA(Na(e));else if(ln(n))r=RA(n,t);else{const a=Gy(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Bu(r)}function Qy(e,n){const t=Fs(e);return t===n||!ln(t)||ci(t)?!1:Hn(t).position==="fixed"||Qy(t,n)}function MA(e,n){const t=n.get(e);if(t)return t;let r=Dl(e,[],!1).filter(c=>ln(c)&&mi(c)!=="body"),a=null;const o=Hn(e).position==="fixed";let l=o?Fs(e):e;for(;ln(l)&&!ci(l);){const c=Hn(l),f=Pp(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Il(l)&&!f&&Qy(e,l))?r=r.filter(d=>d!==l):a=c,l=Fs(l)}return n.set(e,r),r}function IA(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?rf(n)?[]:MA(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((p,d)=>{const x=Jg(n,d,a);return p.top=ao(x.top,p.top),p.right=ui(x.right,p.right),p.bottom=ui(x.bottom,p.bottom),p.left=ao(x.left,p.left),p},Jg(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function jA(e){const{width:n,height:t}=Ky(e);return{width:n,height:t}}function LA(e,n,t){const r=Sa(n),a=Na(n),o=t==="fixed",l=po(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=ba(0);function p(){f.x=Lp(a)}if(r||!r&&!o)if((mi(n)!=="body"||Il(a))&&(c=nf(n)),r){const y=po(n,!0,o,n);f.x=y.x+n.clientLeft,f.y=y.y+n.clientTop}else a&&p();o&&!r&&a&&p();const d=a&&!r&&!o?Xy(a,c):ba(0),x=l.left+c.scrollLeft-f.x-d.x,g=l.top+c.scrollTop-f.y-d.y;return{x,y:g,width:l.width,height:l.height}}function ld(e){return Hn(e).position==="static"}function ev(e,n){if(!Sa(e)||Hn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Na(e)===t&&(t=t.ownerDocument.body),t}function qy(e,n){const t=Sn(e);if(rf(e))return t;if(!Sa(e)){let a=Fs(e);for(;a&&!ci(a);){if(ln(a)&&!ld(a))return a;a=Fs(a)}return t}let r=ev(e,n);for(;r&&lA(r)&&ld(r);)r=ev(r,n);return r&&ci(r)&&ld(r)&&!Pp(r)?t:r||cA(e)||t}const zA=async function(e){const n=this.getOffsetParent||qy,t=this.getDimensions,r=await t(e.floating);return{reference:LA(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function BA(e){return Hn(e).direction==="rtl"}const WA={convertOffsetParentRelativeRectToViewportRelativeRect:FA,getDocumentElement:Na,getClippingRect:IA,getOffsetParent:qy,getElementRects:zA,getClientRects:AA,getDimensions:jA,getScale:ti,isElement:ln,isRTL:BA};function Zy(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function UA(e,n){let t=null,r;const a=Na(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const p=e.getBoundingClientRect(),{left:d,top:x,width:g,height:y}=p;if(c||n(),!g||!y)return;const k=ou(x),w=ou(a.clientWidth-(d+g)),_=ou(a.clientHeight-(x+y)),S=ou(d),T={rootMargin:-k+"px "+-w+"px "+-_+"px "+-S+"px",threshold:ao(0,ui(1,f))||1};let B=!0;function J(I){const C=I[0].intersectionRatio;if(C!==f){if(!B)return l();C?l(!1,C):r=setTimeout(()=>{l(!1,1e-7)},1e3)}C===1&&!Zy(p,e.getBoundingClientRect())&&l(),B=!1}try{t=new IntersectionObserver(J,{...T,root:a.ownerDocument})}catch{t=new IntersectionObserver(J,T)}t.observe(e)}return l(!0),o}function Jy(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,p=jp(e),d=a||o?[...p?Dl(p):[],...Dl(n)]:[];d.forEach(S=>{a&&S.addEventListener("scroll",t,{passive:!0}),o&&S.addEventListener("resize",t)});const x=p&&c?UA(p,t):null;let g=-1,y=null;l&&(y=new ResizeObserver(S=>{let[O]=S;O&&O.target===p&&y&&(y.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var T;(T=y)==null||T.observe(n)})),t()}),p&&!f&&y.observe(p),y.observe(n));let k,w=f?po(e):null;f&&_();function _(){const S=po(e);w&&!Zy(w,S)&&t(),w=S,k=requestAnimationFrame(_)}return t(),()=>{var S;d.forEach(O=>{a&&O.removeEventListener("scroll",t),o&&O.removeEventListener("resize",t)}),x?.(),(S=y)==null||S.disconnect(),y=null,f&&cancelAnimationFrame(k)}}const ew=TA,HA=CA,tw=EA,Ud=bA,Hd=(e,n,t)=>{const r=new Map,a={platform:WA,...t},o={...a.platform,_c:r};return _A(e,n,{...a,platform:o})};var xu=typeof document<"u"?A.useLayoutEffect:A.useEffect;function Uu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Uu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Uu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function rw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function tv(e,n){const t=rw(e);return Math.round(n*t)/t}function cd(e){const n=A.useRef(e);return xu(()=>{n.current=e}),n}function $A(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:p}=e,[d,x]=A.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,y]=A.useState(r);Uu(g,r)||y(r);const[k,w]=A.useState(null),[_,S]=A.useState(null),O=A.useCallback(se=>{se!==I.current&&(I.current=se,w(se))},[]),T=A.useCallback(se=>{se!==C.current&&(C.current=se,S(se))},[]),B=o||k,J=l||_,I=A.useRef(null),C=A.useRef(null),Z=A.useRef(d),L=f!=null,ne=cd(f),X=cd(a),W=cd(p),ue=A.useCallback(()=>{if(!I.current||!C.current)return;const se={placement:n,strategy:t,middleware:g};X.current&&(se.platform=X.current),Hd(I.current,C.current,se).then(R=>{const Y={...R,isPositioned:W.current!==!1};le.current&&!Uu(Z.current,Y)&&(Z.current=Y,Yy.flushSync(()=>{x(Y)}))})},[g,n,t,X,W]);xu(()=>{p===!1&&Z.current.isPositioned&&(Z.current.isPositioned=!1,x(se=>({...se,isPositioned:!1})))},[p]);const le=A.useRef(!1);xu(()=>(le.current=!0,()=>{le.current=!1}),[]),xu(()=>{if(B&&(I.current=B),J&&(C.current=J),B&&J){if(ne.current)return ne.current(B,J,ue);ue()}},[B,J,ue,ne,L]);const re=A.useMemo(()=>({reference:I,floating:C,setReference:O,setFloating:T}),[O,T]),he=A.useMemo(()=>({reference:B,floating:J}),[B,J]),K=A.useMemo(()=>{const se={position:t,left:0,top:0};if(!he.floating)return se;const R=tv(he.floating,d.x),Y=tv(he.floating,d.y);return c?{...se,transform:"translate("+R+"px, "+Y+"px)",...rw(he.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:R,top:Y}},[t,c,he.floating,d.x,d.y]);return A.useMemo(()=>({...d,update:ue,refs:re,elements:he,floatingStyles:K}),[d,ue,re,he,K])}const YA=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?Ud({element:r.current,padding:a}).fn(t):{}:r?Ud({element:r,padding:a}).fn(t):{}}}},VA=(e,n)=>({...ew(e),options:[e,n]}),KA=(e,n)=>({...tw(e),options:[e,n]}),GA=(e,n)=>({...YA(e),options:[e,n]}),XA={...Mv};let rv=!1,QA=0;const nv=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+QA++;function qA(){const[e,n]=A.useState(()=>rv?nv():void 0);return Wu(()=>{e==null&&n(nv())},[]),A.useEffect(()=>{rv=!0},[]),e}const ZA=XA.useId,nw=ZA||qA,JA=A.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:p=0,strokeWidth:d=0,staticOffset:x,stroke:g,d:y,style:{transform:k,...w}={},..._}=n,S=nw(),[O,T]=A.useState(!1);if(Wu(()=>{if(!a)return;Hn(a).direction==="rtl"&&T(!0)},[a]),!a)return null;const[B,J]=r.split("-"),I=B==="top"||B==="bottom";let C=x;(I&&l!=null&&l.x||!I&&l!=null&&l.y)&&(C=null);const Z=d*2,L=Z/2,ne=c/2*(p/-8+1),X=f/2*p/4,W=!!y,ue=C&&J==="end"?"bottom":"top";let le=C&&J==="end"?"right":"left";C&&O&&(le=J==="end"?"left":"right");const re=o?.x!=null?C||o.x:"",he=o?.y!=null?C||o.y:"",K=y||"M0,0"+(" H"+c)+(" L"+(c-ne)+","+(f-X))+(" Q"+c/2+","+f+" "+ne+","+(f-X))+" Z",se={top:W?"rotate(180deg)":"",left:W?"rotate(90deg)":"rotate(-90deg)",bottom:W?"":"rotate(180deg)",right:W?"rotate(-90deg)":"rotate(90deg)"}[B];return h.jsxs("svg",{..._,"aria-hidden":!0,ref:t,width:W?c:c+Z,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[le]:re,[ue]:he,[B]:I||W?"100%":"calc(100% - "+Z/2+"px)",transform:[se,k].filter(R=>!!R).join(" "),...w},children:[Z>0&&h.jsx("path",{clipPath:"url(#"+S+")",fill:"none",stroke:g,strokeWidth:Z+(y?0:1),d:K}),h.jsx("path",{stroke:Z&&!y?_.fill:"none",d:K}),h.jsx("clipPath",{id:S,children:h.jsx("rect",{x:-L,y:L*(W?-1:1),width:c+Z,height:c})})]})});function eO(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const tO=A.createContext(null),rO=A.createContext(null),nO=()=>{var e;return((e=A.useContext(tO))==null?void 0:e.id)||null},aO=()=>A.useContext(rO);function sO(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=nw(),o=A.useRef({}),[l]=A.useState(()=>eO()),c=nO()!=null,[f,p]=A.useState(r.reference),d=wA((y,k,w)=>{o.current.openEvent=y?k:void 0,l.emit("openchange",{open:y,event:k,reason:w,nested:c}),t?.(y,k,w)}),x=A.useMemo(()=>({setPositionReference:p}),[]),g=A.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return A.useMemo(()=>({dataRef:o,open:n,onOpenChange:d,elements:g,events:l,floatingId:a,refs:x}),[n,d,g,l,a,x])}function oO(e){e===void 0&&(e={});const{nodeId:n}=e,t=sO({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=A.useState(null),[c,f]=A.useState(null),d=a?.domReference||o,x=A.useRef(null),g=aO();Wu(()=>{d&&(x.current=d)},[d]);const y=$A({...e,elements:{...a,...c&&{reference:c}}}),k=A.useCallback(T=>{const B=ln(T)?{getBoundingClientRect:()=>T.getBoundingClientRect(),getClientRects:()=>T.getClientRects(),contextElement:T}:T;f(B),y.refs.setReference(B)},[y.refs]),w=A.useCallback(T=>{(ln(T)||T===null)&&(x.current=T,l(T)),(ln(y.refs.reference.current)||y.refs.reference.current===null||T!==null&&!ln(T))&&y.refs.setReference(T)},[y.refs]),_=A.useMemo(()=>({...y.refs,setReference:w,setPositionReference:k,domReference:x}),[y.refs,w,k]),S=A.useMemo(()=>({...y.elements,domReference:d}),[y.elements,d]),O=A.useMemo(()=>({...y,...r,refs:_,elements:S,nodeId:n}),[y,_,S,n,r]);return Wu(()=>{r.dataRef.current.floatingContext=O;const T=g?.nodesRef.current.find(B=>B.id===n);T&&(T.context=O)}),A.useMemo(()=>({...y,context:O,refs:_,elements:S}),[y,_,S,O])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var $d=function(n,t){return $d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},$d(n,t)};function Rr(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");$d(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var Dt=function(){return Dt=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Dt.apply(this,arguments)};function _a(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var iO=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return Se.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},lO=function(e,n){var t=A.useRef(null),r=A.useRef(e);r.current=e;var a=A.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return A.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},af=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=lO(t,l);return Se.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},$e;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})($e||($e={}));function zp(){var e=typeof window<"u"?window:globalThis;return e}var zl=12;function Rt(e){if(e==null)return new Date;var n=typeof e=="string"?VF(e):Je(e);return sf(n)?n:new Date}function ud(e,n,t,r,a){a===void 0&&(a=Rt());for(var o=fi(t)||fi(Bp()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var p=f[c],d=zF(e,p,a,{locale:o});if(sf(d)&&(!r||e===tr(d,p,t)))return d}return null}function sf(e,n){return Pu(e)&&!uo(e,new Date("1/1/1800"))}function tr(e,n,t){if(t==="en")return Gg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?fi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||fi(Bp()),Gg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function zn(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&tr(e,a,r)||""}function cO(e,n,t){if(!e)return"";var r=zn(e,t),a=n?zn(n,t):"";return"".concat(r," - ").concat(a)}function uO(e,n){if(!e?.length)return"";var t=e[0]?zn(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=zn(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function fd(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return pu(hu(mu(e,c),o),r)}function fO(e){return Np(e)}function dO(e,n){return tr(e,"ddd",n)}function gu(e){return co(e)}function Ts(e,n,t){var r=fi(n||Bp());return oa(e,{locale:r,weekStartsOn:t})}function Va(e){return Ny(e)}function ol(e){return ef(e)}function av(e){return Id(e)}function sv(){return co(Rt())}function ov(e){return Cy(e)}function pO(e){return VN(e)}function hO(e){return Dy(e)}function ga(e,n){return e&&n?$F(e,n):!e&&!n}function rn(e,n){return e&&n?UF(e,n):!e&&!n}function Hu(e,n){return e&&n?HF(e,n):!e&&!n}function Ct(e,n){return e&&n?$N(e,n):!e&&!n}function qs(e,n){return e&&n?$3(e,n):!e&&!n}function il(e,n,t){var r,a=co(n),o=Cy(t);try{r=Cl(e,{start:a,end:o})}catch{r=!1}return r}function xi(e,n){var t=zp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function Bp(){var e=zp();return e.__localeId__}function fi(e){if(typeof e=="string"){var n=zp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function mO(e,n,t){return n(tr(e,"EEEE",t))}function xO(e,n){return tr(e,"EEEEEE",n)}function gO(e,n){return tr(e,"EEE",n)}function Wp(e,n){return tr(Bn(Rt(),e),"LLLL",n)}function aw(e,n){return tr(Bn(Rt(),e),"LLL",n)}function vO(e,n){return tr(Xo(Rt(),e),"QQQ",n)}function Wn(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,p=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(d){return d instanceof Date?Ct(e,d):Ct(e,d.date)})||l&&l.some(function(d){var x=d.start,g=d.end;return Cl(e,{start:x,end:g})})||c&&!c.some(function(d){return Ct(e,d)})||f&&!f.some(function(d){var x=d.start,g=d.end;return Cl(e,{start:x,end:g})})||p&&!p(Rt(e))||!1}function Up(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Cl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?Ct(e,o):Ct(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function sw(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r?Ny(r):void 0,maxDate:a?Dy(a):void 0})||o?.some(function(f){return rn(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return rn(e,f)})||c&&!c(Rt(e))||!1}function iu(e,n,t,r){var a=xt(e),o=on(e),l=xt(n),c=on(n),f=xt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function yO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return rn(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return rn(c,e)})||!1}function lu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o?.some(function(f){return Hu(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return Hu(e,f)})||c&&!c(Rt(e))||!1}function cu(e,n,t){if(!n||!t||!Pu(n)||!Pu(t))return!1;var r=xt(n),a=xt(t);return r<=e&&a>=e}function vu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return Bl(f,{minDate:r?ef(r):void 0,maxDate:a?Fy(a):void 0})||o?.some(function(p){return ga(f,p instanceof Date?p:p.date)})||l&&!l.some(function(p){return ga(f,p)})||c&&!c(Rt(f))||!1}function uu(e,n,t,r){var a=xt(e),o=ro(e),l=xt(n),c=ro(n),f=xt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function Bl(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&ii(e,a)<0||o&&ii(e,o)>0)!==null&&t!==void 0?t:!1}function iv(e,n){return n.some(function(t){return $a(t)===$a(e)&&Ya(t)===Ya(e)&&Ss(t)===Ss(e)})}function lv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&iv(e,r)||a&&!iv(e,a)||o&&!o(e)||!1}function cv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Rt();a=pu(a,$a(e)),a=hu(a,Ya(e)),a=mu(a,Ss(e));var o=Rt();o=pu(o,$a(t)),o=hu(o,Ya(t)),o=mu(o,Ss(t));var l=Rt();l=pu(l,$a(r)),l=hu(l,Ya(r)),l=mu(l,Ss(r));var c;try{c=!Cl(a,{start:o,end:l})}catch{c=!1}return c}function uv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=no(e,1);return r&&Ru(r,o)>0||a&&a.every(function(l){return Ru(l,o)>0})||!1}function fv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=sa(e,1);return r&&Ru(o,r)>0||a&&a.every(function(l){return Ru(o,l)>0})||!1}function wO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=ef(e),l=By(o);return r&&Mu(r,l)>0||a&&a.every(function(c){return Mu(c,l)>0})||!1}function kO(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Fy(e),l=Dp(o,1);return r&&Mu(l,r)>0||a&&a.every(function(c){return Mu(l,c)>0})||!1}function dv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=li(e,1);return r&&Iu(r,o)>0||a&&a.every(function(l){return Iu(l,o)>0})||!1}function _O(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=ol(li(e,o)),c=bs(l,o).endPeriod,f=r&&xt(r);return f&&f>c||!1}function pv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ua(e,1);return r&&Iu(o,r)>0||a&&a.every(function(l){return Iu(o,l)>0})||!1}function bO(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=Ua(e,o),c=bs(l,o).startPeriod,f=r&&xt(r);return f&&f<c||!1}function ow(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)>=0});return Ug(r)}else return t?Ug(t):n}function iw(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)<=0});return Wg(r)}else return t?Wg(t):n}function hv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Ha(l)){var c=tr(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var p=Object.keys(l),d=(t=p[0])!==null&&t!==void 0?t:"",x=l[d];if(typeof d=="string"&&Array.isArray(x))for(var g=0,y=x.length;g<y;g++){var k=x[g];if(k){var c=tr(k,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(d)||(f.push(d),r.set(c,f))}}}}return r}function EO(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function SO(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Ha(a)){var l=tr(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&EO(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?_a(_a([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function TO(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,p=a[c];p&&(f=BN(f,$a(p)),f=Md(f,Ya(p)),f=HN(f,Ss(p)));var d=Md(e,(t+1)*r);Ns(f,n)&&uo(f,d)&&p!=null&&l.push(p)}return l}function mv(e){return e<10?"0".concat(e):"".concat(e)}function bs(e,n){n===void 0&&(n=zl);var t=Math.ceil(xt(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function CO(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function xv(e){var n=e.getSeconds(),t=e.getMilliseconds();return Je(e.getTime()-n*1e3-t)}function DO(e,n){return xv(e).getTime()===xv(n).getTime()}function gv(e){if(!Ha(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function vv(e,n){if(!Ha(e)||!Ha(n))throw new Error("Invalid date received");var t=gv(e),r=gv(n);return uo(t,r)}function lw(e){return e.key===$e.Space}var NO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=Se.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),p=f?c:new Date;if(a?.includes(":")){var d=a.split(":"),x=d[0],g=d[1];p.setHours(Number(x)),p.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,p)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?A.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):Se.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var p;(p=r.inputRef.current)===null||p===void 0||p.focus()},required:!0,value:a,onChange:function(p){r.onTimeChange(p.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return Se.createElement("div",{className:"react-datepicker__input-time-container"},Se.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),Se.createElement("div",{className:"react-datepicker-time__input-container"},Se.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(A.Component),FO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=A.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===$e.Space&&(r.preventDefault(),r.key=$e.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return Ct(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Up(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Ct(t.props.day,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&Ct(r,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=tr(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=tr(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:il(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,p=a.selectsDisabledDaysInRange,d=a.startDate,x=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!p&&t.isDisabled()?!1:l&&x&&(uo(g,x)||qs(g,x))?il(o,g,x):c&&d&&!x&&(Ns(g,d)||qs(g,d))||f&&d&&!x&&(Ns(g,d)||qs(g,d))?il(o,d,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?Ct(o,f):Ct(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,p=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?Ct(o,p):Ct(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Ct(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Ct(l,a)},t.isWeekend=function(){var r=B3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===on(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(on(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Rt())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Lr("react-datepicker__day",a,"react-datepicker__day--"+dO(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,p=t.isDisabled()||t.isExcluded()?f:l;return"".concat(p," ").concat(tr(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=tr(a,"MM.dd.yyyy"),p=[];return l.has(f)&&p.push.apply(p,l.get(f).holidayNames),t.isExcluded()&&p.push(c?.filter(function(d){return d instanceof Date?Ct(d,a):Ct(d?.date,a)}).map(function(d){if(!(d instanceof Date))return d?.message})),p.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&Ct(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Xg(t.props.day),t.props.day):Xg(t.props.day)},t.render=function(){return Se.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&Se.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(A.Component),AO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=A.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===$e.Space&&(r.preventDefault(),r.key=$e.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Ct(t.props.date,t.props.selected)&&Ct(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Ct(t.props.date,t.props.selected)&&Ct(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&Ct(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&Ct(this.props.date,this.props.selected)};return Se.createElement("div",{ref:this.weekNumberEl,className:Lr(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(A.Component),OO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,p=new Date(r),d=0;d<7;d++){var x=new Date(r);x.setDate(x.getDate()+d);var g=!t.isDisabled(x);if(g){p=x;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(p,a,o),t.props.showWeekPicker&&t.handleDayClick(p,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):fO(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=aa(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=aa(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(Se.createElement(AO,Dt({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(r,c);return Se.createElement(FO,Dt({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Ts(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Ct(t.startOfWeek(),t.props.selected)&&Ct(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Ct(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return Se.createElement("div",{className:Lr(t)},this.renderDays())},n})(A.Component),tl,PO=6,ri={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},dd=(tl={},tl[ri.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},tl[ri.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},tl[ri.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},tl),fu=1;function yv(e,n){return e?ri.FOUR_COLUMNS:n?ri.TWO_COLUMNS:ri.THREE_COLUMNS}var RO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=_a([],Array(12),!0).map(function(){return A.createRef()}),t.QUARTER_REFS=_a([],Array(4),!0).map(function(){return A.createRef()}),t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return Up(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:rn(Bn(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Hu(Xo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:rn(Bn(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Hu(Xo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,p=o.selectsRange,d=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||p)||!g?!1:c&&x?iu(g,x,r,l):f&&d||p&&d&&!x?iu(d,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,p=Bn(l,r),d=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?rn(p,d):rn(p,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,p=o.selectsRange,d=Bn(l,r),x=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||p?rn(d,x):rn(d,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,p=o.selectsRange,d=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||p)||!g?!1:c&&x?uu(g,x,r,l):f&&d||p&&d&&!x?uu(d,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=aa(r,6);return rn(r,a)||rn(o,a)},t.isCurrentMonth=function(r,a){return xt(r)===xt(Rt())&&a===on(Rt())},t.isCurrentQuarter=function(r,a){return xt(r)===xt(Rt())&&a===ro(Rt())},t.isSelectedMonth=function(r,a,o){return on(o)===a&&xt(r)===xt(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return ro(r)===a&&xt(r)===xt(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Ts(Va(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.preSelection},p=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.selected},d=t.props.selected?p(t.props.selected):void 0,x=t.props.preSelection?f(t.props.preSelection):void 0;r.push(Se.createElement(OO,Dt({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:on(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:d,preSelection:x,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=Ou(c,1);var g=a&&o>=PO,y=!a&&!t.isWeekInMonth(c);if(g||y)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Va(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Va(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,p=c.preSelection,d=c.setPreSelection,x=c.minDate,g=c.maxDate,y=c.showFourColumnMonthYearPicker,k=c.showTwoColumnMonthYearPicker;if(p){var w=yv(y,k),_=t.getVerticalOffset(w),S=(l=dd[w])===null||l===void 0?void 0:l.grid,O=function(C,Z,L){var ne,X,W=Z,ue=L;switch(C){case $e.ArrowRight:W=sa(Z,fu),ue=L===11?0:L+fu;break;case $e.ArrowLeft:W=no(Z,fu),ue=L===0?11:L-fu;break;case $e.ArrowUp:W=no(Z,_),ue=!((ne=S?.[0])===null||ne===void 0)&&ne.includes(L)?L+12-_:L-_;break;case $e.ArrowDown:W=sa(Z,_),ue=!((X=S?.[S.length-1])===null||X===void 0)&&X.includes(L)?L-12+_:L+_;break}return{newCalculatedDate:W,newCalculatedMonth:ue}},T=function(C,Z,L){for(var ne=40,X=C,W=!1,ue=0,le=O(X,Z,L),re=le.newCalculatedDate,he=le.newCalculatedMonth;!W;){if(ue>=ne){re=Z,he=L;break}if(x&&re<x){X=$e.ArrowRight;var K=O(X,re,he);re=K.newCalculatedDate,he=K.newCalculatedMonth}if(g&&re>g){X=$e.ArrowLeft;var K=O(X,re,he);re=K.newCalculatedDate,he=K.newCalculatedMonth}if(yO(re,t.props)){var K=O(X,re,he);re=K.newCalculatedDate,he=K.newCalculatedMonth}else W=!0;ue++}return{newCalculatedDate:re,newCalculatedMonth:he}};if(a===$e.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),d?.(f));return}var B=T(a,p,o),J=B.newCalculatedDate,I=B.newCalculatedMonth;switch(a){case $e.ArrowRight:case $e.ArrowLeft:case $e.ArrowUp:case $e.ArrowDown:t.handleMonthNavigation(I,J);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=dd[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==$e.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Xo(t.props.day,a);lu(o,t.props)||t.handleDayClick(av(o),r)},t.onQuarterMouseEnter=function(r){var a=Xo(t.props.day,r);lu(a,t.props)||t.handleDayMouseEnter(av(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case $e.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case $e.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Dp(t.props.preSelection,1));break;case $e.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,By(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,p=o.excludeDates,d=o.includeDates,x=Bn(l,r);return{isDisabled:(a=(c||f||p||d)&&sw(x,t.props))!==null&&a!==void 0?a:!1,labelDate:x}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,p=a.monthClassName,d=p?p(Bn(o,r)):void 0,x=t.getSelection();return Lr("react-datepicker__month-text","react-datepicker__month-".concat(r),d,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":x?t.isSelectMonthInList(o,r,x):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?iu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=on(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=ro(t.props.preSelection),o=lu(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,p=a.day,d=a.locale,x=Bn(p,r),g=t.isDisabled(x)||t.isExcluded(x)?f:l;return"".concat(g," ").concat(tr(x,"MMMM yyyy",d))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,p=a.minDate,d=a.maxDate,x=a.excludeDates,g=a.includeDates,y=a.filterDate,k=a.preSelection,w=a.disabledKeyboardNavigation,_=(p||d||x||g||y)&&lu(Xo(o,r),t.props);return Lr("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":_,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!w&&k&&t.isSelectedQuarter(o,r,k)&&!_,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,p=aw(r,c),d=Wp(r,c);return l?l(r,p,d,f):o?d:p},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=vO(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,p=(r=dd[yv(l,o)])===null||r===void 0?void 0:r.grid;return p?.map(function(d,x){return Se.createElement("div",{className:"react-datepicker__month-wrapper",key:x},d.map(function(g,y){return Se.createElement("div",{ref:t.MONTH_REFS[g],key:y,onClick:function(k){t.onMonthClick(k,g)},onKeyDown:function(k){lw(k)&&(k.preventDefault(),k.key=$e.Enter),t.onMonthKeyDown(k,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return Se.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return Se.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(p){t.onQuarterClick(p,c)},onKeyDown:function(p){t.onQuarterKeyDown(p,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,p=r.showWeekPicker;return Lr("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":p})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return Se.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(tr(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(A.Component),MO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return Se.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?Se.createElement("span",{className:"react-datepicker__month-option--selected"},"✓"):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return Se.createElement(af,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(A.Component),IO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return Se.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return Se.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return Se.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},Se.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),Se.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return Se.createElement(MO,Dt({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return aw(o,t.props.locale)}:function(o){return Wp(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return Se.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(A.Component);function jO(e,n){for(var t=[],r=Va(e),a=Va(n);!Ns(r,a);)t.push(Rt(r)),r=sa(r,1);return t}var LO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=Ld(a),l=ga(r.props.date,a)&&rn(r.props.date,a);return Se.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?Se.createElement("span",{className:"react-datepicker__month-year-option--selected"},"✓"):"",tr(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:jO(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Lr({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return Se.createElement(af,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(A.Component),zO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Va(t.props.minDate),a=Va(t.props.maxDate),o=[];!Ns(r,a);){var l=Ld(r);o.push(Se.createElement("option",{key:l,value:l},tr(r,t.props.dateFormat,t.props.locale))),r=sa(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Se.createElement("select",{value:Ld(Va(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=tr(t.props.date,t.props.dateFormat,t.props.locale);return Se.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},Se.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),Se.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return Se.createElement(LO,Dt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Rt(r);ga(t.props.date,a)&&rn(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Se.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(A.Component),BO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&cv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&lv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&DO(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&cv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&lv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&($a(r)*3600+Ya(r)*60+Ss(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===$e.Space&&(r.preventDefault(),r.key=$e.Enter),(r.key===$e.ArrowUp||r.key===$e.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===$e.ArrowDown||r.key===$e.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===$e.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Rt(),f=gu(c),p=t.props.injectTimes&&t.props.injectTimes.sort(function(_,S){return _.getTime()-S.getTime()}),d=60*CO(c),x=d/l,g=0;g<x;g++){var y=Md(f,g*l);if(a.push(y),p){var k=TO(f,y,g,l,p);a=a.concat(k)}}var w=a.reduce(function(_,S){return S.getTime()<=c.getTime()?S:_},a[0]);return a.map(function(_){return Se.createElement("li",{key:_.valueOf(),onClick:t.handleClick.bind(t,_),className:t.liClasses(_),ref:function(S){_===w&&(t.centerLi=S)},onKeyDown:function(S){t.handleOnKeyDown(S,_)},tabIndex:_===w?0:-1,role:"option","aria-selected":t.isSelectedTime(_)?"true":void 0,"aria-disabled":t.isDisabledTime(_)?"true":void 0},tr(_,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?Se.createElement(Se.Fragment,null):Se.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},Se.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return Se.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),Se.createElement("div",{className:"react-datepicker__time"},Se.createElement("div",{className:"react-datepicker__time-box"},Se.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(A.Component),wv=3,WO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=_a([],Array(r.props.yearItemNumber),!0).map(function(){return A.createRef()}),r.isDisabled=function(a){return Wn(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return Up(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,p,d=r.props,x=d.date,g=d.yearItemNumber;if(!(x===void 0||g===void 0)){var y=bs(x,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-y<0?r.updateFocusOnPaginate(g-(y-a)):a-y>=g?r.updateFocusOnPaginate(Math.abs(g-(a-y))):(p=(f=r.YEAR_REFS[a-y])===null||f===void 0?void 0:f.current)===null||p===void 0||p.focus())}},r.isSameDay=function(a,o){return Ct(a,o)},r.isCurrentYear=function(a){return a===xt(Rt())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&ga(xa(Rt(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&ga(xa(Rt(),a),r.props.endDate)},r.isInRange=function(a){return cu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,p=o.startDate,d=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&d?cu(a,r.selectingDate(),d):c&&p||f&&p&&!d?cu(a,p,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,p=xa(Rt(),a);return f?ga(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):ga(p,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,p=l.selectsRange,d=xa(Rt(),a);return f||p?ga(d,(o=r.selectingDate())!==null&&o!==void 0?o:null):ga(d,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,p=o.includeDates,d=o.filterDate,x=ol(xa(r.props.date,a)),g=(l||c||f||p||d)&&vu(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Ct(x,ol(r.props.selected))&&Ct(x,ol(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(p){return a===xt(p)}):!c||a===xt(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ol(xa(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,p=r.props,d=p.date,x=p.yearItemNumber,g=p.handleOnKeyDown;if(f!==$e.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case $e.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case $e.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Ua(r.props.preSelection,1));break;case $e.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,li(r.props.preSelection,1));break;case $e.ArrowUp:{if(d===void 0||x===void 0||r.props.preSelection==null)break;var y=bs(d,x).startPeriod,k=wv,w=o-k;if(w<y){var _=x%k;o>=y&&o<y+_?k=_:k+=_,w=o-k}r.handleYearNavigation(w,li(r.props.preSelection,k));break}case $e.ArrowDown:{if(d===void 0||x===void 0||r.props.preSelection==null)break;var S=bs(d,x).endPeriod,k=wv,w=o+k;if(w>S){var _=x%k;o<=S&&o>S-_?k=_:k+=_,w=o+k}r.handleYearNavigation(w,Ua(r.props.preSelection,k));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,p=o.excludeDates,d=o.includeDates,x=o.filterDate,g=o.yearClassName;return Lr("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(xa(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||p||d||x)&&vu(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=xt(r.props.preSelection),l=vu(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var p=bs(o,l),d=p.startPeriod,x=p.endPeriod,g=function(w){r.push(Se.createElement("div",{ref:y.YEAR_REFS[w-d],onClick:function(_){t.onYearClick(_,w)},onKeyDown:function(_){lw(_)&&(_.preventDefault(),_.key=$e.Enter),t.onYearKeyDown(_,w)},tabIndex:Number(y.getYearTabIndex(w)),className:y.getYearClassNames(w),onMouseEnter:y.props.usePointerEvent?void 0:function(_){return c(_,w)},onPointerEnter:y.props.usePointerEvent?function(_){return c(_,w)}:void 0,onMouseLeave:y.props.usePointerEvent?void 0:function(_){return f(_,w)},onPointerLeave:y.props.usePointerEvent?function(_){return f(_,w)}:void 0,key:w,"aria-current":y.isCurrentYear(w)?"date":void 0},y.getYearContent(w)))},y=this,k=d;k<=x;k++)g(k);return Se.createElement("div",{className:"react-datepicker__year"},Se.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(A.Component);function UO(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=xt(t)<=l),r&&c&&(c=xt(r)>=l),c&&a.push(l)}return a}var HO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(x){return Se.createElement("div",{className:c===x?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:x,onClick:r.onChange.bind(r,x),"aria-selected":c===x?"true":void 0},c===x?Se.createElement("span",{className:"react-datepicker__year-option--selected"},"✓"):"",x)}),p=r.props.minDate?xt(r.props.minDate):null,d=r.props.maxDate?xt(r.props.maxDate):null;return(!d||!r.state.yearsList.find(function(x){return x===d}))&&f.unshift(Se.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},Se.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!p||!r.state.yearsList.find(function(x){return x===p}))&&f.push(Se.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},Se.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(p){return p+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:UO(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=A.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Lr({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return Se.createElement(af,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(A.Component),$O=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?xt(t.props.minDate):1900,a=t.props.maxDate?xt(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(Se.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Se.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return Se.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},Se.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),Se.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return Se.createElement(HO,Dt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Se.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(A.Component),YO=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],VO=function(e){var n=(e.className||"").split(/\s+/);return YO.some(function(t){return n.indexOf(t)>=0})},KO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;VO(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=ow(r.props),p=iw(r.props),d=Rt(),x=c||l||o;return x||(f&&uo(d,f)?f:p&&Ns(d,p)?p:d)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:sa(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:no(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:xa(Rt(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!Wn(a,r.props))return a;for(var o=Va(a),l=hO(a),c=YN(l,o),f=null,p=0;p<=c;p++){var d=aa(o,p);if(!Wn(d,r.props)){f=d;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:xa(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Bn(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:xa(Bn(l,on(a)),xt(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Ts(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(Se.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(o,c),p=r.formatWeekday(f,r.props.locale),d=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return Se.createElement("div",{key:c,"aria-label":tr(f,"EEEE",r.props.locale),className:Lr("react-datepicker__day-name",d)},p)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?mO(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?gO(a,o):xO(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:li(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,d=no(r.state.date,p),x;switch(!0){case r.props.showMonthYearPicker:x=dv(r.state.date,r.props);break;case r.props.showYearPicker:x=_O(r.state.date,r.props);break;case r.props.showQuarterYearPicker:x=wO(r.state.date,r.props);break;default:x=uv(d,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&x||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],y=["react-datepicker__navigation","react-datepicker__navigation--previous"],k=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(k=r.decreaseYear),x&&r.props.showDisabledMonthNavigation&&(y.push("react-datepicker__navigation--previous--disabled"),k=void 0);var w=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,_=r.props,S=_.previousMonthButtonLabel,O=S===void 0?n.defaultProps.previousMonthButtonLabel:S,T=_.previousYearButtonLabel,B=T===void 0?n.defaultProps.previousYearButtonLabel:T,J=r.props,I=J.previousMonthAriaLabel,C=I===void 0?typeof O=="string"?O:"Previous Month":I,Z=J.previousYearAriaLabel,L=Z===void 0?typeof B=="string"?B:"Previous Year":Z;return Se.createElement("button",{type:"button",className:y.join(" "),onClick:k,onKeyDown:r.props.handleOnKeyDown,"aria-label":w?L:C},Se.createElement("span",{className:g.join(" ")},w?B:O))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Ua(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=pv(r.state.date,r.props);break;case r.props.showYearPicker:o=bO(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=kO(r.state.date,r.props);break;default:o=fv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var p=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,d=r.props,x=d.nextMonthButtonLabel,g=x===void 0?n.defaultProps.nextMonthButtonLabel:x,y=d.nextYearButtonLabel,k=y===void 0?n.defaultProps.nextYearButtonLabel:y,w=r.props,_=w.nextMonthAriaLabel,S=_===void 0?typeof g=="string"?g:"Next Month":_,O=w.nextYearAriaLabel,T=O===void 0?typeof k=="string"?k:"Next Year":O;return Se.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":p?T:S},Se.createElement("span",{className:c.join(" ")},p?k:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),Se.createElement("h2",{className:o.join(" ")},tr(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return Se.createElement($O,Dt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:xt(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return Se.createElement(IO,Dt({},n.defaultProps,r.props,{month:on(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return Se.createElement(zO,Dt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(sv(),a),r.props.setPreSelection&&r.props.setPreSelection(sv())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return Se.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return Se.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),Se.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),Se.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var p=uv(r.state.date,r.props),d=fv(r.state.date,r.props),x=dv(r.state.date,r.props),g=pv(r.state.date,r.props),y=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return Se.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,Dt(Dt({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:p,nextMonthButtonDisabled:d,prevYearButtonDisabled:x,nextYearButtonDisabled:g})),y&&Se.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,p=f===void 0?n.defaultProps.yearItemNumber:f,d=bs(o,p),x=d.startPeriod,g=d.endPeriod;return Se.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(x," - ").concat(g):xt(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,p=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(r.state.date,f):no(r.state.date,f),d=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,x=0;x<c;++x){var g=x-d+f,y=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(p,g):sa(p,g),k="month-".concat(x),w=x<c-1,_=x>0;l.push(Se.createElement("div",{key:k,ref:function(S){r.monthContainer=S??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:y,i:x}),Se.createElement(RO,Dt({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:y,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:x,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:w,monthShowsDuplicateDaysStart:_}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return Se.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),Se.createElement(WO,Dt({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return Se.createElement(BO,Dt({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&sf(a)&&!!r.props.selected,l=o?"".concat(mv(a.getHours()),":").concat(mv(a.getMinutes())):"";if(r.props.showTimeInput)return Se.createElement(NO,Dt({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=bs(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=xt(r.state.date):f="".concat(Wp(on(r.state.date),r.props.locale)," ").concat(xt(r.state.date)),Se.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return Se.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=A.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:zl}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!Ct(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!rn(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!Ct(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||iO;return Se.createElement(af,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},Se.createElement("div",{style:{display:"contents"},ref:this.containerRef},Se.createElement(t,{className:Lr("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(A.Component),GO=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return Se.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(Se.isValidElement(n)){var l=n;return Se.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return Se.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},Se.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},cw=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return kA.createPortal(this.props.children,this.el)},n})(A.Component),XO="[tabindex], a, button, input, select, textarea",QO=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},uw=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(XO),1,-1).filter(QO)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=A.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?Se.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},Se.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,Se.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(A.Component);function qO(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=A.useRef(null),l=oO(Dt({open:!a,whileElementsMounted:Jy,placement:t.popperPlacement,middleware:_a([KA({padding:15}),VA(10),GA({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=Dt(Dt({},t),{hidePopper:a,popperProps:Dt(Dt({},l),{arrowRef:o})});return Se.createElement(e,Dt({},c))};return n}var ZO=(function(e){Rr(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,p=t.enableTabLoop,d=t.popperOnKeyDown,x=t.portalId,g=t.portalHost,y=t.popperProps,k=t.showArrow,w=void 0;if(!l){var _=Lr("react-datepicker-popper",r);w=Se.createElement(uw,{enableTabLoop:p},Se.createElement("div",{ref:y.refs.setFloating,style:y.floatingStyles,className:_,"data-placement":y.placement,onKeyDown:d},c,k&&Se.createElement(JA,{ref:y.arrowRef,context:y.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(w=A.createElement(this.props.popperContainer,{},w)),x&&!l&&(w=Se.createElement(cw,{portalId:x,portalHost:g},w));var S=Lr("react-datepicker-wrapper",a);return Se.createElement(Se.Fragment,null,Se.createElement("div",{ref:y.refs.setReference,className:S},f),w)},n})(A.Component),JO=qO(ZO),kv="react-datepicker-ignore-onclickoutside";function eP(e,n){return e&&n?on(e)!==on(n)||xt(e)!==xt(n):e!==n}var pd="Date input not valid.",As=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Rt()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return sf(c)?_a(_a([],o,!0),[Dt(Dt({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=ow(r.props),c=iw(r.props),f=l&&uo(o,gu(l))?l:c&&Ns(o,ov(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:hv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(Dt(Dt({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(Dt(Dt({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:hd},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Ha(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];var x=p[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,p),!x||typeof x.isDefaultPrevented!="function"||x.isDefaultPrevented()))){r.setState({inputValue:x?.target instanceof HTMLInputElement?x.target.value:null,lastPreSelectChange:tP});var g=r.props,y=g.selectsRange,k=g.startDate,w=g.endDate,_=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,S=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,O=x?.target instanceof HTMLInputElement?x.target.value:"";if(y){var T=O.split("-",2).map(function(X){return X.trim()}),B=T[0],J=T[1],I=ud(B??"",_,r.props.locale,S),C=ud(J??"",_,r.props.locale,S),Z=k?.getTime()!==I?.getTime(),L=w?.getTime()!==C?.getTime();if(!Z&&!L||I&&Wn(I,r.props)||C&&Wn(C,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[I,C],x)}else{var ne=ud(O,_,r.props.locale,S,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(ne||!O)&&r.setSelected(ne,x,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,p=c.endDate;f&&!p&&(r.props.swapRange||!vv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,p,d=a;if(r.props.showYearPicker){if(d!==null&&vu(xt(d),r.props))return}else if(r.props.showMonthYearPicker){if(d!==null&&sw(d,r.props))return}else if(d!==null&&Wn(d,r.props))return;var x=r.props,g=x.onChange,y=x.selectsRange,k=x.startDate,w=x.endDate,_=x.selectsMultiple,S=x.selectedDates,O=x.minTime,T=x.swapRange;if(!qs(r.props.selected,d)||r.props.allowSameDay||y||_)if(d!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(d=fd(d,{hour:$a(r.props.selected),minute:Ya(r.props.selected),second:Ss(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&O&&(d=fd(d,{hour:O.getHours(),minute:O.getMinutes(),second:O.getSeconds()})),r.props.inline||r.setState({preSelection:d}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),y){var B=!k&&!w,J=k&&!w,I=k&&w;B?g?.([d,null],o):J&&(d===null?g?.([null,null],o):vv(d,k)?g?.(T?[d,k]:[d,null],o):g?.([k,d],o)),I&&g?.([d,null],o)}else if(_){if(d!==null)if(!S?.length)g?.([d],o);else{var C=S.some(function(L){return Ct(L,d)});if(C){var Z=S.filter(function(L){return!Ct(L,d)});g?.(Z,o)}else g?.(_a(_a([],S,!0),[d],!1),o)}}else g?.(d,o);l||((p=(f=r.props).onSelect)===null||p===void 0||p.call(f,d,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Ha(r.props.minDate),l=Ha(r.props.maxDate),c=!0;if(a){var f=gu(a);if(o&&l)c=il(a,r.props.minDate,r.props.maxDate);else if(o){var p=gu(r.props.minDate);c=Ns(a,p)||qs(f,p)}else if(l){var d=ov(r.props.maxDate);c=uo(a,d)||qs(f,d)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:fd(c,{hour:$a(a),minute:Ya(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,p,d;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var x=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(x===$e.ArrowDown||x===$e.ArrowUp||x===$e.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(x===$e.ArrowDown||x===$e.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',y=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);y instanceof HTMLElement&&y.focus({preventScroll:!0});return}var k=Rt(r.state.preSelection);x===$e.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===hd?(r.handleSelect(k,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(k)):r.setOpen(!1)):x===$e.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):x===$e.Tab&&r.setOpen(!1),r.inputOk()||(d=(p=r.props).onInputError)===null||d===void 0||d.call(p,{code:1,msg:pd})}},r.onPortalKeyDown=function(a){var o=a.key;o===$e.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,p,d,x=r.props,g=x.minDate,y=x.maxDate,k=x.disabledKeyboardNavigation,w=x.showWeekPicker,_=x.shouldCloseOnSelect,S=x.locale,O=x.calendarStartDay,T=x.adjustDateOnChange,B=x.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!k){var J=a.key,I=a.shiftKey,C=Rt(r.state.preSelection),Z=function(re,he){var K=he;switch(re){case $e.ArrowRight:K=w?Ou(he,1):aa(he,1);break;case $e.ArrowLeft:K=w?Qg(he):YF(he);break;case $e.ArrowUp:K=Qg(he);break;case $e.ArrowDown:K=Ou(he,1);break;case $e.PageUp:K=I?li(he,1):no(he,1);break;case $e.PageDown:K=I?Ua(he,1):sa(he,1);break;case $e.Home:K=Ts(he,S,O);break;case $e.End:K=pO(he);break}return K},L=function(re,he){for(var K=40,se=re,R=!1,Y=0,P=Z(re,he);!R;){if(Y>=K){P=he;break}g&&P<g&&(se=$e.ArrowRight,P=Wn(g,r.props)?Z(se,P):g),y&&P>y&&(se=$e.ArrowLeft,P=Wn(y,r.props)?Z(se,P):y),Wn(P,r.props)?((se===$e.PageUp||se===$e.Home)&&(se=$e.ArrowRight),(se===$e.PageDown||se===$e.End)&&(se=$e.ArrowLeft),P=Z(se,P)):R=!0,Y++}return P};if(J===$e.Enter){a.preventDefault(),r.handleSelect(C,a),!_&&r.setPreSelection(C);return}else if(J===$e.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:pd});return}var ne=null;switch(J){case $e.ArrowLeft:case $e.ArrowRight:case $e.ArrowUp:case $e.ArrowDown:case $e.PageUp:case $e.PageDown:case $e.Home:case $e.End:ne=L(J,C);break}if(!ne){(d=(p=r.props).onInputError)===null||d===void 0||d.call(p,{code:1,msg:pd});return}if(a.preventDefault(),r.setState({lastPreSelectChange:hd}),T&&r.setSelected(ne),r.setPreSelection(ne),B){var X=on(C),W=on(ne),ue=xt(C),le=xt(ne);X!==W||ue!==le?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===$e.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:Se.createElement(KO,Dt({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:SO(r.modifyHolidays()),outsideClickIgnoreClass:kv,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,p=f?"PPPPp":"PPPP",d;return r.props.selectsRange?d="Selected start date: ".concat(zn(r.props.startDate,{dateFormat:p,locale:c}),". ").concat(r.props.endDate?"End date: "+zn(r.props.endDate,{dateFormat:p,locale:c}):""):r.props.showTimeSelectOnly?d="Selected time: ".concat(zn(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?d="Selected year: ".concat(zn(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?d="Selected month: ".concat(zn(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?d="Selected quarter: ".concat(zn(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):d="Selected date: ".concat(zn(r.props.selected,{dateFormat:p,locale:c})),Se.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},d)},r.renderDateInput=function(){var a,o,l,c=Lr(r.props.className,(a={},a[kv]=r.state.open,a)),f=r.props.customInput||Se.createElement("input",{type:"text"}),p=r.props.customInputRef||"ref",d=r.props,x=d.dateFormat,g=x===void 0?n.defaultProps.dateFormat:x,y=d.locale,k=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?cO(r.props.startDate,r.props.endDate,{dateFormat:g,locale:y}):r.props.selectsMultiple?uO((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:y}):zn(r.props.selected,{dateFormat:g,locale:y});return A.cloneElement(f,(o={},o[p]=function(w){r.input=w},o.value=k,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Lr(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,p=a.endDate,d=a.clearButtonTitle,x=a.clearButtonClassName,g=x===void 0?"":x,y=a.ariaLabelClose,k=y===void 0?"Close":y,w=a.selectedDates;return o&&(c!=null||f!=null||p!=null||w?.length)?Se.createElement("button",{type:"button",className:Lr("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":k,onClick:r.onClearClick,title:d,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:zl,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&eP(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:hv(this.props.highlightDates)}),!r.focused&&!qs(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),Se.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&Se.createElement(GO,Dt({icon:a,className:Lr(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?Se.createElement(uw,{enableTabLoop:this.props.enableTabLoop},Se.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=Se.createElement(cw,Dt({portalId:this.props.portalId},this.props),r)),Se.createElement("div",null,this.renderInputContainer(),r)}return Se.createElement(JO,Dt({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(A.Component),tP="input",hd="navigate";const rP={lessThanXSeconds:{one:{regular:"mniej niż sekunda",past:"mniej niż sekundę",future:"mniej niż sekundę"},twoFour:"mniej niż {{count}} sekundy",other:"mniej niż {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekundę",future:"sekundę"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"pół minuty",twoFour:"pół minuty",other:"pół minuty"},lessThanXMinutes:{one:{regular:"mniej niż minuta",past:"mniej niż minutę",future:"mniej niż minutę"},twoFour:"mniej niż {{count}} minuty",other:"mniej niż {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minutę",future:"minutę"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"około godziny",past:"około godziny",future:"około godzinę"},twoFour:"około {{count}} godziny",other:"około {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzinę",future:"godzinę"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzień",past:"dzień",future:"1 dzień"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"około tygodnia",twoFour:"około {{count}} tygodni",other:"około {{count}} tygodni"},xWeeks:{one:"tydzień",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"około miesiąc",twoFour:"około {{count}} miesiące",other:"około {{count}} miesięcy"},xMonths:{one:"miesiąc",twoFour:"{{count}} miesiące",other:"{{count}} miesięcy"},aboutXYears:{one:"około rok",twoFour:"około {{count}} lata",other:"około {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function nP(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function md(e,n,t){const r=nP(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const aP=(e,n,t)=>{const r=rP[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+md(r,n,"future"):md(r,n,"past")+" temu":md(r,n,"regular")},sP={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},oP={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},iP={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},lP={date:ei({formats:sP,defaultWidth:"full"}),time:ei({formats:oP,defaultWidth:"full"}),dateTime:ei({formats:iP,defaultWidth:"full"})},cP={masculine:"ostatni",feminine:"ostatnia"},uP={masculine:"ten",feminine:"ta"},fP={masculine:"następny",feminine:"następna"},dP={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function _v(e,n,t,r){let a;if(WF(n,t,r))a=uP;else if(e==="lastWeek")a=cP;else if(e==="nextWeek")a=fP;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=dP[o];return`'${a[l]}' eeee 'o' p`}const pP={lastWeek:_v,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:_v,other:"P"},hP=(e,n,t,r)=>{const a=pP[e];return typeof a=="function"?a(e,n,t,r):a},mP={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed naszą erą","naszej ery"]},xP={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwartał","II kwartał","III kwartał","IV kwartał"]},gP={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"]},vP={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"]},yP={narrow:["N","P","W","Ś","C","P","S"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},wP={narrow:["n","p","w","ś","c","p","s"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},kP={narrow:{am:"a",pm:"p",midnight:"półn.",noon:"poł",morning:"rano",afternoon:"popoł.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"}},_P={narrow:{am:"a",pm:"p",midnight:"o półn.",noon:"w poł.",morning:"rano",afternoon:"po poł.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"}},bP=(e,n)=>String(e),EP={ordinalNumber:bP,era:va({values:mP,defaultWidth:"wide"}),quarter:va({values:xP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:va({values:gP,defaultWidth:"wide",formattingValues:vP,defaultFormattingWidth:"wide"}),day:va({values:yP,defaultWidth:"wide",formattingValues:wP,defaultFormattingWidth:"wide"}),dayPeriod:va({values:kP,defaultWidth:"wide",formattingValues:_P,defaultFormattingWidth:"wide"})},SP=/^(\d+)?/i,TP=/\d+/i,CP={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(ą|a)\s*er(ą|a)|naszej\s*ery)/i},DP={any:[/^p/i,/^n/i]},NP={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(ł|l)/i},FP={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},AP={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(ź|z)|lis|gru)/i,wide:/^(stycznia|stycze(ń|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(ń|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(ń|n)|wrze(ś|s)nia|wrzesie(ń|n)|pa(ź|z)dziernika|pa(ź|z)dziernik|listopada|listopad|grudnia|grudzie(ń|n))/i},OP={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},PP={narrow:/^[npwścs]/i,short:/^(nie|pon|wto|(ś|s)ro|czw|pi(ą|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(ś|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(ł|l)ek|wtorek|(ś|s)roda|czwartek|pi(ą|a)tek|sobota)/i},RP={narrow:[/^n/i,/^p/i,/^w/i,/^ś/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pi/i,/^so/i]},MP={narrow:/^(^a$|^p$|pó(ł|l)n\.?|o\s*pó(ł|l)n\.?|po(ł|l)\.?|w\s*po(ł|l)\.?|po\s*po(ł|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|pó(ł|l)noc|o\s*pó(ł|l)nocy|po(ł|l)udnie|w\s*po(ł|l)udnie|popo(ł|l)udnie|po\s*po(ł|l)udniu|rano|wieczór|wieczorem|noc|w\s*nocy)/i},IP={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i}},jP={ordinalNumber:Ay({matchPattern:SP,parsePattern:TP,valueCallback:e=>parseInt(e,10)}),era:ya({matchPatterns:CP,defaultMatchWidth:"wide",parsePatterns:DP,defaultParseWidth:"any"}),quarter:ya({matchPatterns:NP,defaultMatchWidth:"wide",parsePatterns:FP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ya({matchPatterns:AP,defaultMatchWidth:"wide",parsePatterns:OP,defaultParseWidth:"any"}),day:ya({matchPatterns:PP,defaultMatchWidth:"wide",parsePatterns:RP,defaultParseWidth:"any"}),dayPeriod:ya({matchPatterns:MP,defaultMatchWidth:"any",parsePatterns:IP,defaultParseWidth:"any"})},gi={code:"pl",formatDistance:aP,formatLong:lP,formatRelative:hP,localize:EP,match:jP,options:{weekStartsOn:1,firstWeekContainsDate:4}};xi("pl",gi);const xd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],LP=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],zP=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=A.useState(null),[o,l]=A.useState(""),[c,f]=A.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[p,d]=A.useState(""),[x,g]=A.useState(null),[y,k]=A.useState(null),w=A.useRef(null),_=A.useRef(null),[S,O]=A.useState(null),[T,B]=A.useState(null),J=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},I=R=>{if(c.length>1){const Y=[...c];Y.splice(R,1),f(Y)}},C=R=>{const Y=[...c];Y[R].showDataWaznosci=!Y[R].showDataWaznosci,f(Y)},Z=R=>{const Y=R.target.files?.[0];console.log("📎 Product file selected:",Y),Y&&Y.type==="application/pdf"?(g(Y),console.log("✅ Product invoice set:",Y.name)):console.log("❌ Invalid product file type:",Y?.type)},L=R=>{const Y=R.target.files?.[0];console.log("📎 Transport file selected:",Y),Y&&Y.type==="application/pdf"?(k(Y),console.log("✅ Transport invoice set:",Y.name)):console.log("❌ Invalid transport file type:",Y?.type)},ne=()=>{w.current?.click()},X=()=>{_.current?.click()},W=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",p),console.log("productRows:",c),!r||!c.some(E=>E.kod&&E.nazwa&&E.ilosc&&E.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(E=>E.kod&&E.nazwa&&E.ilosc&&E.cena));return}const R=c.filter(E=>E.kod&&E.nazwa&&E.ilosc&&E.cena).map(E=>({kod:E.kod,nazwa:E.nazwa,kod_kreskowy:E.kod_kreskowy||"",ilosc:parseFloat(E.ilosc)||0,cena:parseFloat(E.cena.replace(",","."))||0,dataWaznosci:E.dataWaznosci?E.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:E.typ||void 0,objetosc:E.objetosc||void 0}));console.log("formattedProducts:",R);const Y=R.reduce((E,j)=>E+j.ilosc*j.cena,0),P=parseFloat(p.replace(",","."))||0;console.log("totalValue:",Y),console.log("deliveryCost:",P),console.log("📎 Files to submit:",{productInvoice:x,transportInvoice:y}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:Y,kosztDostawy:P,products:R,productInvoice:x||null,transportInvoice:y||null}),ue()},ue=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),d(""),l(""),g(null),k(null),n()},le=()=>c.reduce((R,Y)=>{const P=parseFloat(Y.ilosc)||0,E=parseFloat(Y.cena.replace(",","."))||0;return R+P*E},0).toFixed(2),re=(R,Y)=>{const P=[...c];P[R].typ=Y,f(P),O(null)},he=R=>{O(S===R?null:R)},K=R=>{B(T===R?null:R)},se=(R,Y)=>{const P=[...c];P[R].objetosc=Y,f(P),B(null)};return A.useEffect(()=>{const R=P=>{const E=P.target;if(!E.closest(".react-datepicker")&&!E.closest('button[title*="ważności"]')){const j=[...c];let M=!1;j.forEach(U=>{U.showDataWaznosci&&(U.showDataWaznosci=!1,M=!0)}),M&&f(j)}S!==null&&(E.closest(".dropdown-container")||O(null)),T!==null&&(E.closest(".dropdown-container")||B(null))},Y=P=>{P.key==="Escape"&&(O(null),B(null))};return document.addEventListener("mousedown",R),document.addEventListener("keydown",Y),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("keydown",Y)}},[S,T,c]),h.jsx(Pr,{isOpen:e,onRequestClose:ue,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),h.jsx("button",{onClick:ue,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),h.jsx(As,{selected:r,onChange:R=>a(R),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),h.jsx("div",{className:"w-[200px] flex items-start",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),h.jsx("div",{className:"relative",children:h.jsx("input",{type:"text",value:p,onKeyPress:R=>{const Y=String.fromCharCode(R.which);(!/[\d,]/.test(Y)||Y===","&&R.target.value.includes(",")||R.target.value===""&&Y===",")&&R.preventDefault()},onChange:R=>{const Y=R.target,P=Y.selectionStart??0;let E=Y.value.replace(/[^\d,]/g,"");if(E===""){d("");return}if(!E.includes(","))E=E+",00";else{const[M,U]=E.split(",");U&&U.length>2&&(E=`${M},${U.slice(0,2)}`)}d(E),requestAnimationFrame(()=>{const M=Math.min(P,E.length);Y.setSelectionRange(M,M)})},className:"w-[70%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]})}),h.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:Z,className:"hidden",ref:w}),h.jsx("button",{type:"button",onClick:ne,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:h.jsx(Jd,{className:"h-4 w-4 text-gray-500"})}),x&&h.jsx("a",{href:URL.createObjectURL(x),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:x.name,children:x.name})]}),h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:L,className:"hidden",ref:_}),h.jsx("button",{type:"button",onClick:X,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:h.jsx(qd,{className:"h-4 w-4 text-gray-500"})}),y&&h.jsx("a",{href:URL.createObjectURL(y),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:y.name,children:y.name})]})]})]})}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),h.jsx("input",{type:"text",value:o,onChange:R=>l(R.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})}),h.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((R,Y)=>h.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[h.jsxs("div",{className:"col-span-1.5 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Kod"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:R.kod,onChange:P=>{const E=[...c];E[Y].kod=P.target.value,f(E)}}),Y===c.length-1&&h.jsx("button",{onClick:J,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:h.jsx(Js,{size:16})})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Nazwa"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:R.nazwa,onChange:P=>{const E=[...c];E[Y].nazwa=P.target.value,f(E)}})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Kod kreskowy"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:R.kod_kreskowy,onChange:P=>{const E=[...c];E[Y].kod_kreskowy=P.target.value,f(E)}})]}),h.jsxs("div",{className:"col-span-1.5",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Ilość"}),h.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:R.ilosc,onChange:P=>{const E=[...c],j=P.target.value;(j===""||/^\d*$/.test(j))&&(E[Y].ilosc=j,f(E))}})]}),h.jsxs("div",{className:"col-span-2.9 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Cena"}),h.jsx("div",{className:"relative",children:h.jsx("input",{type:"text",value:R.cena,onKeyPress:P=>{const E=String.fromCharCode(P.which);(!/[\d,]/.test(E)||E===","&&P.target.value.includes(",")||P.target.value===""&&E===",")&&P.preventDefault()},onChange:P=>{const E=P.target,j=E.selectionStart??0;let M=P.target.value.replace(/[^\d,]/g,"");if(M===""){const pe=[...c];pe[Y].cena="",f(pe);return}if(!M.includes(","))M=M+",00";else{const[pe,me]=M.split(",");me&&me.length>2&&(M=`${pe},${me.slice(0,2)}`)}const oe=[...c];oe[Y].cena=M,f(oe),requestAnimationFrame(()=>{const pe=Math.min(j,M.length);E.setSelectionRange(pe,pe)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),h.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Wartość"}),h.jsx("div",{className:"relative flex items-center",children:h.jsx("input",{type:"text",value:(()=>{const P=parseFloat(R.ilosc)||0,E=parseFloat(R.cena.replace(",","."))||0;return(P*E).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),h.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[h.jsx("button",{type:"button",onClick:()=>C(Y),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${R.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:R.dataWaznosci?`Termin ważności: ${R.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:h.jsx(Qd,{size:16})}),h.jsx("button",{onClick:()=>I(Y),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:h.jsx(Wt,{size:16})})]}),R.showDataWaznosci&&h.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:h.jsx(As,{selected:R.dataWaznosci,onChange:P=>{const E=[...c];E[Y].dataWaznosci=P,E[Y].showDataWaznosci=!1,f(E)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const P=[...c];P[Y].showDataWaznosci=!1,f(P)}})}),h.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Typ"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>he(Y),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${R.typ&&xd.find(P=>P.value===R.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate",children:R.typ&&xd.find(P=>P.value===R.typ)?.label||"Wybierz typ"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),S===Y&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:P=>P.stopPropagation(),children:xd.map(P=>h.jsx("button",{type:"button",onClick:()=>re(Y,P.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${P.color}`,children:P.label},P.value))})]})]}),h.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Y>0?"invisible":""}`,children:"Objętość"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>K(Y),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${R.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[h.jsx("span",{className:"truncate",children:R.objetosc||"Wybierz"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T===Y&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:P=>P.stopPropagation(),style:{maxWidth:"200px"},children:LP.map(P=>h.jsx("button",{type:"button",onClick:()=>se(Y,P.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:P.label},P.value))})]})]})]},Y))})]}),h.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[h.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),h.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[le().replace(".",",")," €"]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(R=>R.kod&&R.nazwa&&R.ilosc&&R.cena)}),W()},disabled:!r||!c.some(R=>R.kod&&R.nazwa&&R.ilosc&&R.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(R=>R.kod&&R.nazwa&&R.ilosc&&R.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},BP=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilość"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilość"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsx("tr",{children:o.map((c,f)=>h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>h.jsx("tr",{children:c.map((p,d)=>h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:p},d))},f))})]})})},WP=({onSearch:e})=>{const[n,t]=A.useState(""),[r,a]=A.useState([]),[o,l]=A.useState(!1);return A.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),h.jsxs("div",{className:"w-full relative",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-5 w-5 text-gray-400"})}),h.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktów...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?h.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:h.jsxs("div",{className:"text-center py-4",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),h.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"Ładowanie..."})]})}):r.length>0?h.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:h.jsxs("table",{className:"w-full table-fixed",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),h.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),h.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilość"}),h.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod kreskowy"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc}),h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kodKreskowy,children:c.kodKreskowy})]},f))})]})}):n?h.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:h.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynikов"})}):null]})};let UP={data:""},HP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||UP,$P=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,YP=/\/\*[^]*?\*\/|  +/g,bv=/\n+/g,ws=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?ws(l,o):o+"{"+ws(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=ws(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=ws.p?ws.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},La={},fw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+fw(e[t]);return n}return e},VP=(e,n,t,r,a)=>{let o=fw(e),l=La[o]||(La[o]=(f=>{let p=0,d=11;for(;p<f.length;)d=101*d+f.charCodeAt(p++)>>>0;return"go"+d})(o));if(!La[l]){let f=o!==e?e:(p=>{let d,x,g=[{}];for(;d=$P.exec(p.replace(YP,""));)d[4]?g.shift():d[3]?(x=d[3].replace(bv," ").trim(),g.unshift(g[0][x]=g[0][x]||{})):g[0][d[1]]=d[2].replace(bv," ").trim();return g[0]})(e);La[l]=ws(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&La.g?La.g:null;return t&&(La.g=La[l]),((f,p,d,x)=>{x?p.data=p.data.replace(x,f):p.data.indexOf(f)===-1&&(p.data=d?f+p.data:p.data+f)})(La[l],n,r,c),l},KP=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":ws(c,""):c===!1?"":c}return r+a+(l??"")},"");function of(e){let n=this||{},t=e.call?e(n.p):e;return VP(t.unshift?t.raw?KP(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,HP(n.target),n.g,n.o,n.k)}let dw,Yd,Vd;of.bind({g:1});let Ga=of.bind({k:1});function GP(e,n,t,r){ws.p=n,dw=e,Yd=t,Vd=r}function Ps(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Yd&&Yd()},c),t.o=/ *go\d+/.test(f),c.className=of.apply(t,r)+(f?" "+f:"");let p=e;return e[0]&&(p=c.as||e,delete c.as),Vd&&p[0]&&Vd(c),dw(p,c)}return a}}var XP=e=>typeof e=="function",$u=(e,n)=>XP(e)?e(n):e,QP=(()=>{let e=0;return()=>(++e).toString()})(),pw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),qP=20,hw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,qP)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return hw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},yu=[],Zs={toasts:[],pausedAt:void 0},ko=e=>{Zs=hw(Zs,e),yu.forEach(n=>{n(Zs)})},ZP={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},JP=(e={})=>{let[n,t]=A.useState(Zs),r=A.useRef(Zs);A.useEffect(()=>(r.current!==Zs&&t(Zs),yu.push(t),()=>{let o=yu.indexOf(t);o>-1&&yu.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||ZP[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},eR=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||QP()}),Wl=e=>(n,t)=>{let r=eR(n,e,t);return ko({type:2,toast:r}),r.id},an=(e,n)=>Wl("blank")(e,n);an.error=Wl("error");an.success=Wl("success");an.loading=Wl("loading");an.custom=Wl("custom");an.dismiss=e=>{ko({type:3,toastId:e})};an.remove=e=>ko({type:4,toastId:e});an.promise=(e,n,t)=>{let r=an.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?$u(n.success,a):void 0;return o?an.success(o,{id:r,...t,...t?.success}):an.dismiss(r),a}).catch(a=>{let o=n.error?$u(n.error,a):void 0;o?an.error(o,{id:r,...t,...t?.error}):an.dismiss(r)}),e};var tR=(e,n)=>{ko({type:1,toast:{id:e,height:n}})},rR=()=>{ko({type:5,time:Date.now()})},gl=new Map,nR=1e3,aR=(e,n=nR)=>{if(gl.has(e))return;let t=setTimeout(()=>{gl.delete(e),ko({type:4,toastId:e})},n);gl.set(e,t)},sR=e=>{let{toasts:n,pausedAt:t}=JP(e);A.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&an.dismiss(c.id);return}return setTimeout(()=>an.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=A.useCallback(()=>{t&&ko({type:6,time:Date.now()})},[t]),a=A.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:p}=l||{},d=n.filter(y=>(y.position||p)===(o.position||p)&&y.height),x=d.findIndex(y=>y.id===o.id),g=d.filter((y,k)=>k<x&&y.visible).length;return d.filter(y=>y.visible).slice(...c?[g+1]:[0,g]).reduce((y,k)=>y+(k.height||0)+f,0)},[n]);return A.useEffect(()=>{n.forEach(o=>{if(o.dismissed)aR(o.id,o.removeDelay);else{let l=gl.get(o.id);l&&(clearTimeout(l),gl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:tR,startPause:rR,endPause:r,calculateOffset:a}}},oR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,iR=Ga`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lR=Ga`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,cR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${oR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${iR} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${lR} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,uR=Ga`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,fR=Ps("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${uR} 1s linear infinite;
`,dR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,pR=Ga`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,hR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${pR} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,mR=Ps("div")`
  position: absolute;
`,xR=Ps("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,gR=Ga`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,vR=Ps("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${gR} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,yR=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?A.createElement(vR,null,n):n:t==="blank"?null:A.createElement(xR,null,A.createElement(fR,{...r}),t!=="loading"&&A.createElement(mR,null,t==="error"?A.createElement(cR,{...r}):A.createElement(hR,{...r})))},wR=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,kR=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,_R="0%{opacity:0;} 100%{opacity:1;}",bR="0%{opacity:1;} 100%{opacity:0;}",ER=Ps("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,SR=Ps("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,TR=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=pw()?[_R,bR]:[wR(t),kR(t)];return{animation:n?`${Ga(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ga(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},CR=A.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?TR(e.position||n||"top-center",e.visible):{opacity:0},o=A.createElement(yR,{toast:e}),l=A.createElement(SR,{...e.ariaProps},$u(e.message,e));return A.createElement(ER,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):A.createElement(A.Fragment,null,o,l))});GP(A.createElement);var DR=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=A.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return A.createElement("div",{ref:o,className:n,style:t},a)},NR=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:pw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},FR=of`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,du=16,AR=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=sR(t);return A.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:du,left:du,right:du,bottom:du,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(p=>{let d=p.position||n,x=f.calculateOffset(p,{reverseOrder:e,gutter:r,defaultPosition:n}),g=NR(d,x);return A.createElement(DR,{id:p.id,key:p.id,onHeightUpdate:f.updateHeight,className:p.visible?FR:"",style:g},p.type==="custom"?$u(p.message,p):a?a(p):A.createElement(CR,{toast:p,position:d}))}))},at=an;xi("pl",gi);const OR=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log("🔍 OrderModal render - isOpen:",e);const[r,a]=A.useState(null),[o,l]=A.useState(""),[c,f]=A.useState(""),[p,d]=A.useState([]),[x,g]=A.useState(null),[y,k]=A.useState(!1),[w,_]=A.useState([]),[S,O]=A.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[T,B]=A.useState(null),[J,I]=A.useState(!1),[C,Z]=A.useState(!1),[L,ne]=A.useState(null),[X,W]=A.useState(new Set),ue=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],le=()=>{const E=Math.max(...S.map(j=>j.id))+1;O([...S,{id:E,searchQuery:"",selectedProduct:null,typ:""}])},re=E=>{S.length>1&&O(j=>j.filter(M=>M.id!==E))},he=()=>{console.log("🔍 OrderModal handleClose called"),a(null),l(""),f(""),d([]),g(null),_([]),O([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),B(null),I(!1),Z(!1),ne(null),W(new Set),n()};A.useEffect(()=>{e&&(console.log("🔍 OrderModal opened - clearing state"),a(null),l(""),f(""),d([]),g(null),_([]),O([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),B(null),I(!1),Z(!1),ne(null),W(new Set))},[e]),A.useEffect(()=>{const j=setTimeout(async()=>{if(c.trim().length<2){d([]);return}k(!0);try{const M=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!M.ok)throw new Error("Failed to fetch clients");const U=await M.json();d(U)}catch(M){console.error("Error searching clients:",M),d([])}finally{k(!1)}},300);return()=>clearTimeout(j)},[c]),A.useEffect(()=>{const j=setTimeout(async()=>{if(T===null||!S.find(M=>M.id===T)?.searchQuery.trim()){_([]);return}I(!0);try{const M=S.find(me=>me.id===T)?.searchQuery||"",U=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(M)}`);if(!U.ok)throw new Error("Failed to fetch products");const pe=(await U.json()).map(me=>({kod:me.kod,nazwa:me.nazwa,ilosc:me.ilosc.toString(),kodKreskowy:me.kod_kreskowy||"",selectedQuantity:0}));_(pe)}catch(M){console.error("Error searching products:",M),_([])}finally{I(!1)}},300);return()=>clearTimeout(j)},[S,T]),A.useEffect(()=>{const E=M=>{const U=M.target;L!==null&&(U.closest(".dropdown-container")||ne(null))},j=M=>{M.key==="Escape"&&ne(null)};return L!==null&&(document.addEventListener("mousedown",E),document.addEventListener("keydown",j)),()=>{document.removeEventListener("mousedown",E),document.removeEventListener("keydown",j)}},[L]);const K=(E,j)=>{console.log("🔍 handleProductSelect called for fieldId:",E,"product:",j.kod),O(M=>M.map(oe=>oe.id===E?{...oe,selectedProduct:j,searchQuery:`${j.kod} - ${j.nazwa}`}:oe)),_([]),B(null),console.log("🔍 Products list cleared, activeSearchId reset")},se=E=>{ne(L===E?null:E)},R=(E,j)=>{O(M=>M.map(U=>U.id===E?{...U,typ:j}:U)),ne(null)},Y=()=>S.filter(E=>E.selectedProduct).reduce((E,j)=>{const M=j.selectedProduct?.selectedQuantity||0;return E+M},0),P=async()=>{const E=S.filter(me=>me.selectedProduct).map(me=>({kod:me.selectedProduct.kod,nazwa:me.selectedProduct.nazwa,ilosc:me.selectedProduct.selectedQuantity||0,typ:me.typ,kod_kreskowy:me.selectedProduct.kodKreskowy}));if(!r){at.error("Wybierz datę zamówienia");return}if(!o.trim()){at.error("Wprowadź numer zamówienia");return}if(!x){at.error("Wybierz klienta");return}if(E.length===0){at.error("Dodaj produkty");return}if(E.some(me=>!me.ilosc)){at.error("Wprowadź ilość dla wszystkich produktów");return}if(E.some(me=>!me.typ)){at.error("Wybierz typ dla wszystkich produktów");return}const j=new Set;for(let me=0;me<S.length;me++){const ie=S[me];if(ie.selectedProduct){const te=ie.selectedProduct.selectedQuantity||0,ae=parseInt(ie.selectedProduct.ilosc)||0;te>ae&&j.add(ie.id)}}if(j.size>0){W(j);return}else W(new Set);const M=r.getDate().toString().padStart(2,"0"),U=(r.getMonth()+1).toString().padStart(2,"0"),oe=r.getFullYear(),pe=`${o.trim()}_${M}_${U}_${oe}`;Z(!0);try{const me=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:x.nazwa,order_number:pe,products:E})});if(!me.ok){const ie=await me.json();if(me.status===400&&ie.error.includes("Insufficient quantity")){const te=ie.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(te){const[,ae,F,Ce]=te;at.error(`Niewystarczająca ilość produktu ${ae}. Dostępne: ${F}, Zamówione: ${Ce}`)}else at.error(ie.error)}else throw new Error("Failed to create order");return}at.success("Zamówienie zostało dodane"),he(),t&&t()}catch(me){console.error("Error creating order:",me),at.error("Wystąpił błąd podczas dodawania zamówienia")}finally{Z(!1)}};return h.jsx(Pr,{isOpen:e,onRequestClose:he,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamówienia"}),h.jsx("button",{onClick:he,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),h.jsx(As,{selected:r,onChange:E=>a(E),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),h.jsxs("div",{className:"w-[180px] ml-4",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),h.jsx("input",{type:"text",value:o,onChange:E=>l(E.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),h.jsxs("div",{className:"relative",children:[h.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",id:"client-search",value:c,onChange:E=>f(E.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),y&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),p.length>0&&!x&&h.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:p.map(E=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(E),f(E.nazwa),d([])},children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:E.nazwa}),h.jsx("span",{className:"text-[10px] text-gray-500",children:E.firma})]})},E.id))})]}),x&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.nazwa})]}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.firma})]}),x.adres&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.adres})]}),x.kontakt&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.kontakt})]})]}),h.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:h.jsx(Wt,{size:16})})]})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),S.map(E=>h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",value:E.searchQuery,onChange:j=>{const M=j.target.value;console.log("🔍 Product search input changed for fieldId:",E.id,"value:",M),O(U=>U.map(oe=>oe.id===E.id?{...oe,searchQuery:M,selectedProduct:null}:oe)),B(E.id)},onFocus:()=>B(E.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsx("div",{className:"w-16 ml-2",children:h.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:E.selectedProduct?.selectedQuantity||"",onChange:j=>{const M=j.target.value,U=M===""?0:Math.max(1,parseInt(M)||0);if(O(oe=>oe.map(pe=>pe.id===E.id&&pe.selectedProduct?{...pe,selectedProduct:{...pe.selectedProduct,selectedQuantity:U}}:pe)),X.has(E.id)){const oe=new Set(X);oe.delete(E.id),W(oe)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${X.has(E.id)?"border-red-500":"border-gray-300"}`})}),h.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[h.jsxs("button",{type:"button",onClick:()=>se(E.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${E.typ&&ue.find(j=>j.value===E.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate text-[10px]",children:E.typ&&ue.find(j=>j.value===E.typ)?.label||"Typ"}),h.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),L===E.id&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:j=>j.stopPropagation(),children:ue.map(j=>h.jsx("button",{type:"button",onClick:()=>R(E.id,j.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${j.color}`,children:j.label},j.value))})]}),S.length>1&&h.jsx("button",{onClick:()=>re(E.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:h.jsx(Wt,{size:16})})]}),E.id===Math.max(...S.map(j=>j.id))&&h.jsx("button",{onClick:le,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:h.jsx(Js,{size:16})}),J&&T===E.id&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),w.length>0&&T===E.id&&!E.selectedProduct&&E.searchQuery.trim()&&h.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:w.map(j=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>K(E.id,{...j,selectedQuantity:0}),children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:j.kod}),h.jsx("span",{className:"text-[10px] text-gray-500",children:j.nazwa}),h.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",j.ilosc]})]})},j.kod))})]},E.id))]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:P,disabled:C,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${C?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:C?h.jsxs("div",{className:"flex items-center justify-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),h.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",h.jsx("span",{className:"font-semibold text-gray-900",children:Y()})]})]})})},PR=({isOpen:e,onClose:n,order:t})=>{const[r,a]=A.useState(null),[o,l]=A.useState(null),[c,f]=A.useState(!1),p=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}];A.useEffect(()=>{e&&t&&(d(),x())},[e,t]);const d=async()=>{if(t){f(!0);try{const w=await fetch(`/api/orders/${t.id}`);if(!w.ok)throw new Error("Failed to load order details");const _=await w.json();a(_)}catch(w){console.error("Error loading order details:",w)}finally{f(!1)}}},x=async()=>{if(t)try{const w=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(w.ok){const _=await w.json();l(_)}}catch(w){console.error("Error loading client data:",w)}},g=w=>new Date(w).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const y=r||t,k=async()=>{if(!(!t||!y))try{const w=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!w.ok)throw new Error("Failed to generate PDF");const _=await w.blob(),S=window.URL.createObjectURL(_),O=document.createElement("a");O.href=S;const T=o?o.nazwa:y.klient,B=`${T}_${y.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",T),console.log("Order number:",y.numer_zamowienia),console.log("Generated filename:",B),O.download=B,document.body.appendChild(O),O.click(),window.URL.revokeObjectURL(S),document.body.removeChild(O)}catch(w){console.error("Error generating PDF:",w),alert("Błąd podczas generowania PDF")}};return h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zamówienia"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?h.jsx("div",{className:"flex justify-center items-center py-8",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:h.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-700",children:"Numer zamówienia:"}),h.jsx("p",{className:"text-sm font-bold text-gray-900",children:y.numer_zamowienia})]}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),h.jsx("p",{className:"text-gray-900",children:g(y.data_utworzenia||"")})]})]})}),o&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Produkty w zamówieniu"}),y.products&&y.products.length>0?h.jsx("div",{children:h.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilość"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Typ"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.products.map(w=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:w.kod}),h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:h.jsx("div",{className:"break-words leading-tight",children:w.nazwa})}),h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:w.kod_kreskowy||"-"}),h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:w.ilosc}),h.jsx("td",{className:"px-4 py-2 text-xs w-20",children:w.typ?h.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${p.find(_=>_.value===w.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:p.find(_=>_.value===w.typ)?.label||w.typ}):h.jsx("span",{className:"text-gray-500",children:"-"})})]},w.id))})]})}):h.jsx("p",{className:"text-xs text-gray-500",children:"Brak produktów w zamówieniu"})]})]})}),h.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",h.jsx("span",{className:"font-semibold text-gray-900",children:y.laczna_ilosc})]}),h.jsx("div",{className:"absolute bottom-4 left-4",children:h.jsx("button",{onClick:k,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};xi("pl",gi);const gd=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],RR=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=A.useState(""),[l,c]=A.useState(""),[f,p]=A.useState(null),[d,x]=A.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),[g,y]=A.useState(null),[k,w]=A.useState(""),[_,S]=A.useState([]),[O,T]=A.useState(!1),[B,J]=A.useState(null),[I,C]=A.useState([]),[Z,L]=A.useState(!1),[ne,X]=A.useState(null),[W,ue]=A.useState(new Set),le=async j=>{try{const M=j.map(me=>me.kod).filter(me=>me.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",M),M.length===0)return;const U=await fetch("/api/working-sheets");if(!U.ok)throw new Error("Failed to fetch working sheets");const oe=await U.json();console.log("All working sheets products:",oe);const pe=M.map(me=>{const ie=oe.find(te=>te.kod===me);return console.log(`Found product for ${me}:`,ie),ie}).filter(me=>me!==void 0);console.log("Found products for order:",pe),S(pe),console.log("✅ Final loaded products info for order editing:",pe)}catch(M){console.error("❌ Error loading products info:",M)}};A.useEffect(()=>{if(e&&r){if(o(r.klient),w(r.klient),X({nazwa:r.klient}),c(r.numer_zamowienia),r.data_utworzenia){const j=new Date(r.data_utworzenia);p(j),console.log("📅 Loaded order date:",j)}else p(null);if(r.products&&r.products.length>0){console.log("Order products from backend:",r.products);const j=r.products.map(M=>({kod:M.kod||"",nazwa:M.nazwa||"",kod_kreskowy:M.kod_kreskowy||"",ilosc:(M.ilosc||0).toString(),typ:M.typ||""}));console.log("Formatted products:",j),x(j),console.log("🔄 About to load products info for:",j),le(j)}else x([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])}},[e,r]),A.useEffect(()=>{const M=setTimeout(async()=>{if(B===null||!d.find((U,oe)=>oe===B)?.nazwa.trim()){S([]);return}T(!0);try{const U=d.find((me,ie)=>ie===B)?.nazwa||"",oe=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(U)}`);if(!oe.ok)throw new Error("Failed to fetch products");const pe=await oe.json();S(pe)}catch(U){console.error("Error searching products:",U),S([])}finally{T(!1)}},300);return()=>clearTimeout(M)},[d,B]),A.useEffect(()=>{const M=setTimeout(async()=>{if(k.trim().length<2){C([]);return}L(!0);try{const U=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!U.ok)throw new Error("Failed to fetch clients");const oe=await U.json();C(oe)}catch(U){console.error("Error searching clients:",U),C([])}finally{L(!1)}},300);return()=>clearTimeout(M)},[k]),A.useEffect(()=>{const j=U=>{const oe=U.target;g!==null&&(oe.closest(".dropdown-container")||y(null))},M=U=>{U.key==="Escape"&&y(null)};return g!==null&&(document.addEventListener("mousedown",j),document.addEventListener("keydown",M)),()=>{document.removeEventListener("mousedown",j),document.removeEventListener("keydown",M)}},[g]);const re=()=>{x([...d,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])},he=j=>{d.length>1&&x(d.filter((M,U)=>U!==j))},K=(j,M)=>{const U=[...d];U[j].typ=M,x(U),y(null)},se=j=>{y(g===j?null:j)},R=(j,M)=>{console.log("🔍 EditOrderModal handleProductSelect called for index:",j,"product:",M.kod);const U=[...d];U[j]={...U[j],kod:M.kod,nazwa:M.nazwa,kod_kreskowy:M.kod_kreskowy||"",typ:M.typ||"sztuki"},x(U);const oe=[..._],pe=oe.findIndex(me=>me.kod===M.kod);pe>=0?oe[pe]=M:oe.push(M),S(oe),J(null),console.log("🔍 EditOrderModal Products list cleared, activeSearchId reset")},Y=async(j,M)=>{const U=new Set;for(let oe=0;oe<j.length;oe++){const pe=j[oe],me=parseInt(pe.ilosc)||0,ie=d.findIndex(q=>q.kod===pe.kod&&q.nazwa===pe.nazwa&&q.ilosc===pe.ilosc);if(ie===-1){console.warn(`⚠️ Could not find actual index for product ${pe.kod}`);continue}const ae=M.find(q=>q.kod===pe.kod)?.ilosc||0,F=r?.products?.find(q=>q.kod===pe.kod),Ce=F&&F.ilosc||0;let De;me>Ce?(De=me-Ce,console.log(`📈 Increasing order: ${Ce} → ${me}, need additional: ${De}`)):(De=me,console.log(`📉 Decreasing order: ${Ce} → ${me}, checking total available`));const He=ae+(me<=Ce?Ce:0);console.log(`Product ${ie} (valid index ${oe}):`,{kod:pe.kod,requested:me,availableOnStock:ae,reservedInOrder:Ce,requiredFromStock:De,totalAvailable:He,hasError:De>He}),De>He&&(U.add(ie),console.log(`❌ Error for product ${ie}: required ${De} > available ${He}`))}return U},P=async j=>{if(j.preventDefault(),!r)return;if(!a.trim()){at.error("Wprowadź nazwę klienta");return}if(!l.trim()){at.error("Wprowadź numer zamówienia");return}const M=d.filter(pe=>pe.kod.trim()&&pe.nazwa.trim()&&pe.ilosc.trim()&&pe.typ.trim());if(M.length===0){at.error("Dodaj produkty do zamówienia");return}if(M.some(pe=>!pe.ilosc||!pe.typ)){at.error("Wprowadź ilość i typ dla wszystkich produktów");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",M),console.log("products (stock info):",_),console.log("products.length:",_.length),_.length===0){console.log("⚠️ Products info is empty, reloading...");try{const pe=await fetch("/api/working-sheets");if(pe.ok){const me=await pe.json();console.log("Reloaded all products:",me),S(me);const ie=await Y(M,me);if(ie.size>0){ue(ie);return}else ue(new Set);console.log("✅ Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),at.error("Błąd podczas ładowania informacji o produktach");return}}catch(pe){console.error("Error reloading products:",pe),at.error("Błąd podczas ładowania informacji o produktach");return}}const U=await Y(M,_);if(U.size>0){ue(U);return}else ue(new Set);const oe=M.map(pe=>({kod:pe.kod,kod_kreskowy:pe.kod_kreskowy,nazwa:pe.nazwa,ilosc:parseInt(pe.ilosc)||0,typ:pe.typ}));console.log("Sending products data:",oe);try{const pe=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:oe})});if(!pe.ok){const me=await pe.json();throw new Error(me.error||"Failed to update order")}at.success("Zamówienie zostało zaktualizowane"),E(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:oe})}catch(pe){console.error("Error updating order:",pe),at.error("Wystąpił błąd podczas aktualizacji zamówienia")}},E=()=>{o(""),w(""),X(null),C([]),c(""),p(null),x([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),y(null),S([]),J(null),n()};return r?h.jsx(Pr,{isOpen:e,onRequestClose:E,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj zamówienie"}),h.jsx("button",{onClick:E,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsxs("form",{onSubmit:P,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex space-x-4",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),h.jsx(As,{selected:f,onChange:j=>p(j),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),h.jsx("input",{type:"text",value:l,onChange:j=>c(j.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",value:k,onChange:j=>w(j.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),Z&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),I.length>0&&!ne&&h.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:I.map(j=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{X(j),w(j.nazwa),o(j.nazwa),C([])},children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:j.nazwa}),h.jsx("span",{className:"text-[10px] text-gray-500",children:j.firma})]})},j.id))})]}),ne&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),h.jsx("p",{className:"text-xs text-gray-900",children:ne.nazwa})]}),ne.firma&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),h.jsx("p",{className:"text-xs text-gray-900",children:ne.firma})]}),ne.adres&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),h.jsx("p",{className:"text-xs text-gray-900",children:ne.adres})]}),ne.kontakt&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),h.jsx("p",{className:"text-xs text-gray-900",children:ne.kontakt})]})]}),h.jsx("button",{onClick:()=>{X(null),w(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:h.jsx(Wt,{size:16})})]})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),d.map((j,M)=>h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",value:j.nazwa,onChange:U=>{const oe=U.target.value;console.log("🔍 EditOrderModal Product search input changed for index:",M,"value:",oe);const pe=[...d];pe[M].nazwa=oe,x(pe),J(M)},onFocus:()=>J(M),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsx("div",{className:"w-16 ml-2",children:h.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:j.ilosc,onChange:U=>{const oe=[...d];if(oe[M].ilosc=U.target.value,x(oe),W.has(M)){const pe=new Set(W);pe.delete(M),ue(pe)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${W.has(M)?"border-red-500":"border-gray-300"}`})}),h.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[h.jsxs("button",{type:"button",onClick:()=>se(M),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${j.typ&&gd.find(U=>U.value===j.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate text-[10px]",children:j.typ&&gd.find(U=>U.value===j.typ)?.label||"Typ"}),h.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g===M&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:U=>U.stopPropagation(),children:gd.map(U=>h.jsx("button",{type:"button",onClick:()=>K(M,U.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${U.color}`,children:U.label},U.value))})]}),d.length>1&&h.jsx("button",{onClick:()=>he(M),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:h.jsx(Wt,{size:16})})]}),M===d.length-1&&h.jsx("button",{onClick:re,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:h.jsx(Js,{size:16})}),O&&B===M&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),_.length>0&&B===M&&j.nazwa.trim()&&h.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:_.map(U=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>R(M,U),children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:U.kod}),h.jsx("span",{className:"text-[10px] text-gray-500",children:U.nazwa}),h.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",U.ilosc]})]})},U.kod))})]},M))]})]}),h.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[h.jsx("button",{type:"button",onClick:E,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),h.jsx("button",{onClick:P,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null},MR=({onViewOrder:e,onEditOrder:n,onDeleteOrder:t,onUpdateOrder:r,refreshTrigger:a})=>{const[o,l]=A.useState([]),[c,f]=A.useState(!0),[p,d]=A.useState(null),[x,g]=A.useState(null),[y,k]=A.useState(!1),[w,_]=A.useState(!1),[S,O]=A.useState(null),[T,B]=A.useState(!1),[J,I]=A.useState(null),[C,Z]=A.useState(""),[L,ne]=A.useState("data_utworzenia"),[X,W]=A.useState("desc"),[ue,le]=A.useState(""),[re,he]=A.useState(""),K=async()=>{try{console.log("🔄 Starting to load orders..."),f(!0),d(null),console.log("📡 Fetching from /api/orders-with-products...");const ae=await fetch("/api/orders-with-products");if(console.log("📡 Response status:",ae.status),console.log("📡 Response ok:",ae.ok),!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const F=await ae.json();console.log("📡 Raw data received:",F),console.log("📡 Raw data length:",F.length);const Ce=F.map(De=>({id:De.id,klient:De.klient,numer_zamowienia:De.numer_zamowienia,data_utworzenia:De.data_utworzenia,laczna_ilosc:De.laczna_ilosc,typ:De.typ||"zamowienie",numer_zwrotu:De.numer_zwrotu||null,products:De.products||[]}));console.log("🔄 Transformed orders:",Ce),console.log("🔄 Orders count:",Ce.length),l(Ce)}catch(ae){console.error("❌ Error loading orders:",ae),d("Failed to load orders")}finally{f(!1)}};A.useEffect(()=>{K()},[]),A.useEffect(()=>{a&&K()},[a]);const se=ae=>new Date(ae).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),R=ae=>{g(ae),k(!0)},Y=ae=>{O(ae),_(!0)},P=async ae=>{if(console.log("OrdersList handleEditSubmit called with data:",ae),r)r(ae);else try{console.log("Sending PUT request to update order:",ae);const F=await fetch(`/api/orders/${ae.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!F.ok)throw new Error(`HTTP error! status: ${F.status}`);at.success("Zamówienie zostało zaktualizowane"),K()}catch(F){console.error("Error updating order:",F),at.error("Błąd podczas aktualizacji zamówienia")}},E=ae=>{I(ae),B(!0),Z("")},j=async()=>{if(C==="5202"){if(J?.id)try{t&&t(J.id);const ae=await fetch(`/api/orders/${J.id}`,{method:"DELETE"});if(!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const F=await ae.json();console.log("Order deleted:",F),at.success("Zamówienie zostało usunięte"),K()}catch(ae){console.error("Error deleting order:",ae),at.error("Błąd podczas usuwania zamówienia")}M()}else at.error("Nieprawidłowe hasło"),Z("")},M=()=>{B(!1),I(null),Z("")},U=ae=>{ae.key==="Enter"&&j()},oe=ae=>{L===ae?W(X==="asc"?"desc":"asc"):(ne(ae),W("asc"))},pe=Array.from(new Set(o.map(ae=>new Date(ae.data_utworzenia).getFullYear().toString()))).sort((ae,F)=>parseInt(F)-parseInt(ae)),me=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],te=o.filter(ae=>!(ue&&new Date(ae.data_utworzenia).getFullYear().toString()!==ue||re&&(new Date(ae.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==re)).sort((ae,F)=>{let Ce,De;switch(L){case"numer_zamowienia":Ce=(ae.numer_zamowienia||"").toLowerCase(),De=(F.numer_zamowienia||"").toLowerCase();break;case"klient":Ce=(ae.klient||"").toLowerCase(),De=(F.klient||"").toLowerCase();break;case"laczna_ilosc":Ce=ae.laczna_ilosc,De=F.laczna_ilosc;break;case"data_utworzenia":Ce=new Date(ae.data_utworzenia),De=new Date(F.data_utworzenia);break;default:Ce=ae[L]||"",De=F[L]||""}return typeof Ce=="string"&&typeof De=="string"?X==="asc"?Ce.localeCompare(De):De.localeCompare(Ce):typeof Ce=="number"&&typeof De=="number"?X==="asc"?Ce-De:De-Ce:Ce instanceof Date&&De instanceof Date?X==="asc"?Ce.getTime()-De.getTime():De.getTime()-Ce.getTime():0});return c?h.jsx("div",{className:"flex justify-center items-center h-32",children:h.jsx("div",{className:"text-gray-500",children:"Ładowanie zamówień..."})}):p?h.jsx("div",{className:"flex justify-center items-center h-32",children:h.jsxs("div",{className:"text-red-500",children:["Błąd: ",p]})}):h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>oe("numer_zamowienia"),children:"Numer zamówienia"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>oe("klient"),children:"Klient"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>oe("typ"),children:"Typ"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>oe("laczna_ilosc"),children:"Łączna ilość"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>oe("data_utworzenia"),children:"Data utworzenia"}),h.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:h.jsxs("div",{className:"flex space-x-1 justify-end",children:[h.jsxs("select",{value:ue,onChange:ae=>le(ae.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[h.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),pe.map(ae=>h.jsx("option",{value:ae,style:{fontFamily:"Sora, sans-serif"},children:ae},ae))]}),h.jsxs("select",{value:re,onChange:ae=>he(ae.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[h.jsx("option",{value:"",children:"Msc"}),me.map(ae=>h.jsx("option",{value:ae.value,style:{fontFamily:"Sora, sans-serif"},children:ae.value},ae.value))]})]})})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamówień"})}):te.map(ae=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.numer_zamowienia}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.klient}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ae.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:ae.typ==="zwrot"?"Zwrot":"Zamówienie"})}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.laczna_ilosc}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:se(ae.data_utworzenia)}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{type:"button",onClick:F=>{F.preventDefault(),F.stopPropagation(),R(ae)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:h.jsx(Zd,{size:16})}),h.jsx("button",{type:"button",onClick:F=>{F.preventDefault(),F.stopPropagation(),Y(ae)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:h.jsx(Ku,{size:16})}),h.jsx("button",{type:"button",onClick:F=>{F.preventDefault(),F.stopPropagation(),E(ae)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:h.jsx(Wt,{size:16})})]})})]},ae.id))})]})}),h.jsx(Pr,{isOpen:T,onRequestClose:M,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),h.jsx("button",{onClick:M,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsx("div",{children:h.jsx("input",{type:"password",value:C,onChange:ae=>Z(ae.target.value),onKeyPress:U,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[h.jsx("button",{onClick:M,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),h.jsx("button",{onClick:j,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),h.jsx(PR,{isOpen:y,onClose:()=>k(!1),order:x}),h.jsx(RR,{isOpen:w,onClose:()=>{_(!1),O(null)},onSubmit:ae=>{P(ae),_(!1),O(null)},order:S})]})},IR="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",mw=({isOpen:e,onClose:n,product:t})=>t?h.jsx(Pr,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[h.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:h.jsx(Wt,{size:24})}),h.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Детали товара"}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Код:"})," ",t.kod]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Название:"})," ",t.nazwa]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Количество:"})," ",t.ilosc]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Ед. измерения:"})," ",t.jednostka_miary]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Штрихкод:"})," ",t.kod_kreskowy]}),t.data_waznosci&&h.jsxs("p",{children:[h.jsx("strong",{children:"Срок годности:"})," ",t.data_waznosci]}),t.waga_netto&&h.jsxs("p",{children:[h.jsx("strong",{children:"Вес нетто:"})," ",t.waga_netto," кг"]}),t.waga_brutto&&h.jsxs("p",{children:[h.jsx("strong",{children:"Вес брутто:"})," ",t.waga_brutto," кг"]}),t.objetosc&&h.jsxs("p",{children:[h.jsx("strong",{children:"Объем:"})," ",t.objetosc," л"]}),t.opis&&h.jsxs("p",{children:[h.jsx("strong",{children:"Описание:"})," ",t.opis]})]})]})}):null,Yu="",xw=({isOpen:e,onClose:n,receipt:t,products:r})=>{const[a,o]=Se.useState(null),[l,c]=Se.useState(!1),[f,p]=Se.useState({x:0,y:0}),[d,x]=Se.useState(!1),g=Se.useRef({x:0,y:0});Se.useEffect(()=>{const w=S=>{d&&p({x:S.clientX-g.current.x,y:S.clientY-g.current.y})},_=()=>x(!1);return d&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",_)),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",_)}},[d]);const y=w=>{w.target.closest("button")||w.target.closest("input")||(x(!0),g.current={x:w.clientX-f.x,y:w.clientY-f.y})};if(!t)return null;let k=[];if(Array.isArray(t.products))k=t.products;else if(typeof t.products=="string")try{k=JSON.parse(t.products)}catch{k=[]}return h.jsxs(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:y,style:{cursor:d?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zakupu"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Wartość"}),h.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," €"]})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),h.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," €"]})]})]}),(t.productInvoice||t.transportInvoice)&&h.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&h.jsxs("button",{onClick:()=>{const w=`${Yu}/uploads/${t.productInvoice}`;console.log("📎 Opening product invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[h.jsx(Jd,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&h.jsxs("button",{onClick:()=>{const w=`${Yu}/uploads/${t.transportInvoice}`;console.log("📎 Opening transport invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[h.jsx(qd,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),h.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),h.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),h.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),h.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilość"}),h.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),h.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Wartość"}),h.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),h.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objętość"}),h.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data ważności"})]})}),h.jsx("tbody",{children:k.map((w,_)=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.kod}),h.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:w.nazwa}),h.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:w.kod_kreskowy||"-"}),h.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:w.ilosc}),h.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[w.cena," €"]}),h.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(w.ilosc*w.cena).toFixed(2).replace(".",",")," €"]}),h.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const S=w.typ;return S?{czerwone:"Czerwone",biale:"Białe",musujace:"Musujące",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment"}[S]||S:"-"})()}),h.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.objetosc||"-"}),h.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:w.dataWaznosci?typeof w.dataWaznosci=="number"?new Date(w.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(w.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},_))})]})]})]}),h.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),h.jsx(mw,{isOpen:l,onClose:()=>c(!1),product:a})]})},jR=({isOpen:e,onClose:n,onAdd:t,initialData:r,isEditMode:a=!1})=>{const[o,l]=A.useState(""),[c,f]=A.useState(""),[p,d]=A.useState(""),[x,g]=A.useState(""),[y,k]=A.useState("");A.useEffect(()=>{console.log("🔍 useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log("🔍 Setting initial data from props"),l(r.firma),f(r.nazwa),d(r.adres),g(r.czas_dostawy),k(r.kontakt)):e&&!r&&console.log("🔍 Modal opened without initial data - keeping current values")},[e,r]);const w=()=>{if(console.log("🔍 handleSubmit called with values:",{firma:o,nazwa:c,adres:p,czas_dostawy:x,kontakt:y}),console.log("🔍 Trimmed values:",{firma:o.trim(),nazwa:c.trim(),adres:p.trim(),czas_dostawy:x.trim(),kontakt:y.trim()}),!o.trim()||!c.trim()||!p.trim()||!x.trim()||!y.trim()){console.log("❌ Validation failed: some fields are empty");return}const S={firma:o.trim(),nazwa:c.trim(),adres:p.trim(),czas_dostawy:x.trim(),kontakt:y.trim()};console.log("✅ Submitting client data:",S),t(S),_()},_=()=>{l(""),f(""),d(""),g(""),k(""),n()};return h.jsx(Pr,{isOpen:e,onRequestClose:_,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),h.jsx("button",{onClick:_,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),h.jsx("input",{type:"text",value:o,onChange:S=>{console.log("🔍 firma onChange:",S.target.value),l(S.target.value)},placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),h.jsx("input",{type:"text",value:c,onChange:S=>f(S.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),h.jsx("input",{type:"text",value:p,onChange:S=>d(S.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),h.jsx("input",{type:"text",value:x,onChange:S=>g(S.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),h.jsx("input",{type:"text",value:y,onChange:S=>k(S.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:w,disabled:!o.trim()||!c.trim()||!p.trim()||!x.trim()||!y.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!o.trim()||!c.trim()||!p.trim()||!x.trim()||!y.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};xi("pl",gi);const vd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],Ev=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],gw=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=A.useState(null),[l,c]=A.useState(""),[f,p]=A.useState({x:0,y:0}),[d,x]=A.useState(!1),[g,y]=A.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k=A.useRef({x:0,y:0}),[w,_]=A.useState(""),[S,O]=A.useState(null),[T,B]=A.useState(null),[J,I]=A.useState(null),[C,Z]=A.useState(null),L=A.useRef(null),ne=A.useRef(null),[X,W]=A.useState(null),[ue,le]=A.useState(null);A.useEffect(()=>{if(e&&r){let te=[];if(r.products)if(typeof r.products=="string")try{te=JSON.parse(r.products)}catch(ae){console.error("Error parsing products JSON:",ae),te=[]}else Array.isArray(r.products)&&(te=r.products);if(Array.isArray(te)&&te.length>0){let ae=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[Ce,De,He]=r.dataPrzyjecia.split("/");ae=new Date(parseInt(He),parseInt(De)-1,parseInt(Ce))}else r.dataPrzyjecia.includes("-")?ae=new Date(r.dataPrzyjecia):ae=new Date(r.dataPrzyjecia);o(ae),c(r.sprzedawca||""),_((r.kosztDostawy||0).toFixed(2).replace(".",","));const F=te.map(Ce=>({kod:Ce.kod||"",nazwa:Ce.nazwa||"",kod_kreskowy:Ce.kod_kreskowy||Ce.ean||"",ilosc:(Ce.ilosc||0).toString(),cena:(Ce.cena||0).toFixed(2).replace(".",","),dataWaznosci:Ce.dataWaznosci||"",showDataWaznosci:!1,typ:Ce.typ||Ce.typTowaru||"",objetosc:Ce.objetosc||""}));y(F.length>0?F:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),I(r.productInvoice||null),Z(r.transportInvoice||null),O(null),B(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),O(null),B(null),I(null),Z(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),O(null),B(null),I(null),Z(null)},[e,r]),A.useEffect(()=>{const te=F=>{const Ce=F.target;if(!Ce.closest(".dropdown-container")&&!Ce.closest('button[onclick*="toggleDropdown"]')&&W(null),!Ce.closest(".objetosc-dropdown-container")&&!Ce.closest('button[onclick*="toggleObjetoscDropdown"]')&&le(null),!Ce.closest(".react-datepicker")&&!Ce.closest('button[title*="ważności"]')){const De=[...g];let He=!1;De.forEach(q=>{q.showDataWaznosci&&(q.showDataWaznosci=!1,He=!0)}),He&&y(De)}},ae=F=>{if(F.key==="Escape"){W(null),le(null);const Ce=[...g];let De=!1;Ce.forEach(He=>{He.showDataWaznosci&&(He.showDataWaznosci=!1,De=!0)}),De&&y(Ce)}};return document.addEventListener("mousedown",te),document.addEventListener("keydown",ae),()=>{document.removeEventListener("mousedown",te),document.removeEventListener("keydown",ae)}},[g]);const re=()=>{y([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},he=te=>{if(g.length>1){const ae=[...g];ae.splice(te,1),y(ae)}},K=te=>{const ae=[...g];ae[te].showDataWaznosci=!ae[te].showDataWaznosci,y(ae)},se=(te,ae)=>{const F=[...g];F[te].typ=ae,y(F),W(null)},R=te=>{W(X===te?null:te)},Y=(te,ae)=>{const F=[...g];F[te].objetosc=ae,y(F),le(null)},P=te=>{le(ue===te?null:te)},E=te=>{te.target.closest("button")||te.target.closest("input")||te.target.closest(".react-datepicker")||te.target.closest('[role="button"]')||te.target.closest(".react-datepicker__input-container")||(x(!0),k.current={x:te.clientX-f.x,y:te.clientY-f.y})};A.useEffect(()=>{const te=F=>{d&&requestAnimationFrame(()=>{p({x:F.clientX-k.current.x,y:F.clientY-k.current.y})})},ae=()=>{x(!1)};return d&&(window.addEventListener("mousemove",te),window.addEventListener("mouseup",ae)),()=>{window.removeEventListener("mousemove",te),window.removeEventListener("mouseup",ae)}},[d]);const j=te=>{const ae=te.target.files?.[0];console.log("📎 Product file selected (edit):",ae),ae&&ae.type==="application/pdf"?(O(ae),console.log("✅ Product invoice set (edit):",ae.name)):console.log("❌ Invalid product file type (edit):",ae?.type)},M=te=>{const ae=te.target.files?.[0];console.log("📎 Transport file selected (edit):",ae),ae&&ae.type==="application/pdf"?(B(ae),console.log("✅ Transport invoice set (edit):",ae.name)):console.log("❌ Invalid transport file type (edit):",ae?.type)},U=()=>{L.current?.click()},oe=()=>{ne.current?.click()},pe=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const te=g.filter(De=>De.kod&&De.nazwa&&De.ilosc&&De.cena);if(console.log("productRows:",g),console.log("validProducts:",te),console.log("validProducts.length:",te.length),te.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const ae=te.map(De=>({kod:De.kod,nazwa:De.nazwa,kod_kreskowy:De.kod_kreskowy||"",ilosc:parseFloat(De.ilosc)||0,cena:parseFloat(De.cena.replace(",","."))||0,dataWaznosci:De.dataWaznosci||void 0,typ:De.typ||void 0,objetosc:De.objetosc?parseFloat(De.objetosc):void 0})),F=ae.reduce((De,He)=>De+He.ilosc*He.cena,0),Ce=parseFloat(w.replace(",","."))||0;console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:F,kosztDostawy:Ce,products:ae}),console.log("📎 Files to submit (edit):",{productInvoice:S,transportInvoice:T}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:F,kosztDostawy:Ce,products:ae,productInvoice:S||null,transportInvoice:T||null}),me()},me=()=>{o(null),p({x:0,y:0}),y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),_(""),c(""),O(null),B(null),I(null),Z(null),n()},ie=()=>g.reduce((te,ae)=>{const F=parseFloat(ae.ilosc)||0,Ce=parseFloat(ae.cena.replace(",","."))||0;return te+F*Ce},0).toFixed(2);return h.jsx(Pr,{isOpen:e,onRequestClose:me,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:E,style:{cursor:d?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:te=>te.stopPropagation(),children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),h.jsx("button",{type:"button",onClick:te=>{te.preventDefault(),te.stopPropagation(),me()},className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),h.jsx(As,{selected:a,onChange:te=>o(te),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),h.jsx("div",{className:"w-[200px] flex items-start",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",value:w,onKeyPress:te=>{const ae=String.fromCharCode(te.which);(!/[\d,]/.test(ae)||ae===","&&te.target.value.includes(",")||te.target.value===""&&ae===",")&&te.preventDefault()},onChange:te=>{const ae=te.target,F=ae.selectionStart??0;let Ce=ae.value.replace(/[^\d,]/g,"");if(Ce===""){_("");return}if(!Ce.includes(","))Ce=Ce+",00";else{const[He,q]=Ce.split(",");q&&q.length>2&&(Ce=`${He},${q.slice(0,2)}`)}_(Ce),requestAnimationFrame(()=>{const He=Math.min(F,Ce.length);ae.setSelectionRange(He,He)})},className:"w-[70%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),h.jsx("span",{className:"absolute right-[calc(30%+0.75rem)] top-1/2 -translate-y-1/2 text-gray-500",children:"€"})]})]})}),h.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:j,className:"hidden",ref:L}),h.jsx("button",{type:"button",onClick:U,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:h.jsx(Jd,{className:"h-4 w-4 text-gray-500"})}),S&&h.jsx("a",{href:URL.createObjectURL(S),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:S.name,children:S.name}),!S&&J&&h.jsx("a",{href:`${Yu}${J}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:M,className:"hidden",ref:ne}),h.jsx("button",{type:"button",onClick:oe,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:h.jsx(qd,{className:"h-4 w-4 text-gray-500"})}),T&&h.jsx("a",{href:URL.createObjectURL(T),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:T.name,children:T.name}),!T&&C&&h.jsx("a",{href:`${Yu}${C}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),h.jsx("input",{type:"text",value:l,onChange:te=>c(te.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})}),h.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((te,ae)=>h.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[h.jsxs("div",{className:"col-span-1.5 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Kod"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:te.kod,onChange:F=>{const Ce=[...g];Ce[ae].kod=F.target.value,y(Ce)}}),ae===g.length-1&&h.jsx("button",{onClick:re,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:h.jsx(Js,{size:16})})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Nazwa"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:te.nazwa,onChange:F=>{const Ce=[...g];Ce[ae].nazwa=F.target.value,y(Ce)}})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Kod kreskowy"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:te.kod_kreskowy,onChange:F=>{const Ce=[...g];Ce[ae].kod_kreskowy=F.target.value,y(Ce)}})]}),h.jsxs("div",{className:"col-span-1.5",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Ilość"}),h.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:te.ilosc,onChange:F=>{const Ce=[...g],De=F.target.value;(De===""||/^\d*$/.test(De))&&(Ce[ae].ilosc=De,y(Ce))}})]}),h.jsxs("div",{className:"col-span-2.9 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Cena"}),h.jsx("div",{className:"relative",children:h.jsx("input",{type:"text",value:te.cena,onKeyPress:F=>{const Ce=String.fromCharCode(F.which);(!/[\d,]/.test(Ce)||Ce===","&&F.target.value.includes(",")||F.target.value===""&&Ce===",")&&F.preventDefault()},onChange:F=>{const Ce=F.target,De=Ce.selectionStart??0;let He=F.target.value.replace(/[^\d,]/g,"");if(He===""){const Ee=[...g];Ee[ae].cena="",y(Ee);return}if(!He.includes(","))He=He+",00";else{const[Ee,Ne]=He.split(",");Ne&&Ne.length>2&&(He=`${Ee},${Ne.slice(0,2)}`)}const de=[...g];de[ae].cena=He,y(de),requestAnimationFrame(()=>{const Ee=Math.min(De,He.length);Ce.setSelectionRange(Ee,Ee)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),h.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Wartość"}),h.jsx("div",{className:"relative flex items-center",children:h.jsx("input",{type:"text",value:(()=>{const F=parseFloat(te.ilosc)||0,Ce=parseFloat(te.cena.replace(",","."))||0;return(F*Ce).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),h.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[h.jsx("button",{type:"button",onClick:()=>K(ae),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${te.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:te.dataWaznosci?`Termin ważności: ${te.dataWaznosci}`:"Dodaj termin ważności",children:h.jsx(Qd,{size:16})}),h.jsx("button",{onClick:()=>he(ae),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:h.jsx(Wt,{size:16})})]}),te.showDataWaznosci&&h.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:h.jsx(As,{selected:te.dataWaznosci?new Date(te.dataWaznosci):null,onChange:F=>{const Ce=[...g];Ce[ae].dataWaznosci=F?F.toISOString().split("T")[0]:"",Ce[ae].showDataWaznosci=!1,y(Ce)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const F=[...g];F[ae].showDataWaznosci=!1,y(F)}})}),h.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Typ"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>R(ae),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${te.typ&&vd.find(F=>F.value===te.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate",children:te.typ&&vd.find(F=>F.value===te.typ)?.label||"Wybierz typ"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),X===ae&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:F=>F.stopPropagation(),children:vd.map(F=>h.jsx("button",{type:"button",onClick:()=>se(ae,F.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${F.color}`,children:F.label},F.value))})]})]}),h.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${ae>0?"invisible":""}`,children:"Objętość"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>P(ae),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${te.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[h.jsx("span",{className:"truncate",children:te.objetosc?Ev.find(F=>F.value===te.objetosc)?.label||te.objetosc:"Wybierz"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ue===ae&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:F=>F.stopPropagation(),style:{maxWidth:"200px"},children:Ev.map(F=>h.jsx("button",{type:"button",onClick:()=>Y(ae,F.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:F.label},F.value))})]})]})]},ae))})]}),h.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[h.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),h.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[ie().replace(".",",")," €"]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:pe,disabled:!a||!g.some(te=>te.kod&&te.nazwa&&te.ilosc&&te.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(te=>te.kod&&te.nazwa&&te.ilosc&&te.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},LR=({receipts:e,products:n,onDelete:t,onEdit:r,onUpdate:a,selectedCategory:o=""})=>{const[l,c]=A.useState(null),[f,p]=A.useState(!1),[d,x]=A.useState(!1),[g,y]=A.useState(null),[k,w]=A.useState(!1),[_,S]=A.useState(null),[O,T]=A.useState(""),[B,J]=A.useState({x:0,y:0}),[I,C]=A.useState(!1),Z=A.useRef({x:0,y:0}),[L,ne]=A.useState("dataPrzyjecia"),[X,W]=A.useState("desc"),[ue,le]=A.useState(""),[re,he]=A.useState(""),K=ie=>{c(ie),p(!0)},se=ie=>{y(ie),x(!0)},R=ie=>{S(ie),w(!0),T("")},Y=()=>{O==="5202"?(_?.id&&(t(_.id),at.success("Zapis został usunięty")),P()):(at.error("Nieprawidłowe hasło"),T(""))},P=()=>{w(!1),S(null),T(""),J({x:0,y:0})},E=ie=>{ie.key==="Enter"&&Y()},j=ie=>{L===ie?W(X==="asc"?"desc":"asc"):(ne(ie),W("asc"))},M=ie=>{ie.target.closest("button")||ie.target.closest("input")||(C(!0),Z.current={x:ie.clientX-B.x,y:ie.clientY-B.y})};A.useEffect(()=>{const ie=ae=>{I&&requestAnimationFrame(()=>{J({x:ae.clientX-Z.current.x,y:ae.clientY-Z.current.y})})},te=()=>{C(!1)};return I&&(window.addEventListener("mousemove",ie),window.addEventListener("mouseup",te)),()=>{window.removeEventListener("mousemove",ie),window.removeEventListener("mouseup",te)}},[I]);const U=Array.from(new Set(e.map(ie=>new Date(ie.dataPrzyjecia).getFullYear().toString()))).sort((ie,te)=>parseInt(te)-parseInt(ie)),oe=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],me=e.filter(ie=>{if(o)if(typeof ie.products=="string")try{if(!JSON.parse(ie.products).some(F=>F.typ===o))return!1}catch{return!1}else if(Array.isArray(ie.products)){if(!ie.products.some(ae=>ae.typ===o))return!1}else return!1;return!(ue&&new Date(ie.dataPrzyjecia).getFullYear().toString()!==ue||re&&(new Date(ie.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==re)}).sort((ie,te)=>{let ae,F;switch(L){case"dataPrzyjecia":ae=new Date(ie.dataPrzyjecia),F=new Date(te.dataPrzyjecia);break;case"sprzedawca":ae=(ie.sprzedawca||"").toLowerCase(),F=(te.sprzedawca||"").toLowerCase();break;case"wartosc":ae=ie.wartosc,F=te.wartosc;break;case"kosztDostawy":ae=ie.kosztDostawy,F=te.kosztDostawy;break;default:ae=ie[L]||"",F=te[L]||""}return typeof ae=="string"&&typeof F=="string"?X==="asc"?ae.localeCompare(F):F.localeCompare(ae):typeof ae=="number"&&typeof F=="number"?X==="asc"?ae-F:F-ae:ae instanceof Date&&F instanceof Date?X==="asc"?ae.getTime()-F.getTime():F.getTime()-ae.getTime():0});return h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>j("dataPrzyjecia"),children:"Data zakupu"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>j("sprzedawca"),children:"Sprzedawca"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>j("wartosc"),children:"Wartość"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>j("kosztDostawy"),children:"Koszt dostawy"}),h.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:h.jsxs("div",{className:"flex space-x-1 justify-end",children:[h.jsxs("select",{value:ue,onChange:ie=>le(ie.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[h.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),U.map(ie=>h.jsx("option",{value:ie,style:{fontFamily:"Sora, sans-serif"},children:ie},ie))]}),h.jsxs("select",{value:re,onChange:ie=>he(ie.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[h.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Msc"}),oe.map(ie=>h.jsx("option",{value:ie.value,style:{fontFamily:"Sora, sans-serif"},children:ie.label},ie.value))]})]})})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:me.map(ie=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ie.dataPrzyjecia}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ie.sprzedawca}),h.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[ie.wartosc.toFixed(2)," €"]}),h.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[ie.kosztDostawy.toFixed(2)," €"]}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{type:"button",onClick:te=>{te.preventDefault(),te.stopPropagation(),K(ie)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:h.jsx(Zd,{size:16})}),h.jsx("button",{type:"button",onClick:te=>{te.preventDefault(),te.stopPropagation(),se(ie)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:h.jsx(Ku,{size:16})}),h.jsx("button",{type:"button",onClick:te=>{te.preventDefault(),te.stopPropagation(),R(ie)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:h.jsx(Wt,{size:16})})]})})]},ie.id))})]})}),h.jsx(Pr,{isOpen:k,onRequestClose:P,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${B.x}px), calc(-50% + ${B.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:M,style:{cursor:I?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),h.jsx("button",{onClick:P,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsx("div",{children:h.jsx("input",{type:"password",value:O,onChange:ie=>T(ie.target.value),onKeyPress:E,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[h.jsx("button",{onClick:P,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),h.jsx("button",{onClick:Y,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),h.jsx(xw,{isOpen:f,onClose:()=>p(!1),receipt:l,products:n}),h.jsx(gw,{isOpen:d,onClose:()=>{x(!1),y(null)},onSubmit:ie=>{a({...ie,productInvoice:ie.productInvoice??void 0,transportInvoice:ie.transportInvoice??void 0}),x(!1),y(null)},receipt:g?{id:g.id||0,dataPrzyjecia:g.dataPrzyjecia,sprzedawca:g.sprzedawca,wartosc:g.wartosc,kosztDostawy:g.kosztDostawy,products:g.products,productInvoice:g.productInvoice,transportInvoice:g.transportInvoice}:null})]})},zR=({isOpen:e,onClose:n,client:t})=>t?h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły klienta"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),h.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,vw=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=A.useState(""),[l,c]=A.useState(""),[f,p]=A.useState(""),[d,x]=A.useState(""),[g,y]=A.useState("");A.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),p(r.adres||""),x(r.czas_dostawy||""),y(r.kontakt||"")):(o(""),c(""),p(""),x(""),y(""))},[e,r]);const k=async()=>{if(a.trim()&&l.trim()&&f.trim()&&d.trim()&&g.trim()&&r){const _={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:d,kontakt:g};t(_),w()}},w=()=>{o(""),c(""),p(""),x(""),y(""),n()};return h.jsx(Pr,{isOpen:e,onRequestClose:w,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),h.jsx("button",{onClick:w,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),h.jsx("input",{type:"text",value:a,onChange:_=>o(_.target.value),placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),h.jsx("input",{type:"text",value:l,onChange:_=>c(_.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),h.jsx("input",{type:"text",value:f,onChange:_=>p(_.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),h.jsx("input",{type:"text",value:d,onChange:_=>x(_.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),h.jsx("input",{type:"text",value:g,onChange:_=>y(_.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:k,disabled:!a.trim()||!l.trim()||!f.trim()||!d.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!d.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},BR=({clients:e,onDelete:n,onEdit:t,onUpdate:r})=>{console.log("🔍 ClientsList render - clients:",e),console.log("🔍 ClientsList render - clients length:",e.length),console.log("🔍 ClientsList render - first client:",e[0]),console.log("🔍 ClientsList render - all clients:",e.map(Y=>({id:Y.id,firma:Y.firma,nazwa:Y.nazwa})));const[a,o]=A.useState(null),[l,c]=A.useState(!1),[f,p]=A.useState(!1),[d,x]=A.useState(null),[g,y]=A.useState(!1),[k,w]=A.useState(null),[_,S]=A.useState(""),[O,T]=A.useState({x:0,y:0}),[B,J]=A.useState(!1),I=A.useRef({x:0,y:0}),[C,Z]=A.useState(""),[L,ne]=A.useState("asc");e&&e.length>0,A.useEffect(()=>{console.log("🔍 ClientsList useEffect - clients changed:",e),console.log("🔍 ClientsList useEffect - clients length:",e.length)},[e]);const X=Y=>{o(Y),c(!0)},W=Y=>{x(Y),p(!0)},ue=Y=>{w(Y),y(!0),S("")},le=()=>{_==="5202"?(k?.id&&n(k.id),re()):(at.error("Nieprawidłowe hasło"),S(""))},re=()=>{y(!1),w(null),S(""),T({x:0,y:0})},he=Y=>{Y.key==="Enter"&&le()},K=Y=>{C===Y?ne(L==="asc"?"desc":"asc"):(Z(Y),ne("asc"))},se=Y=>{Y.target.closest("button")||Y.target.closest("input")||(J(!0),I.current={x:Y.clientX-O.x,y:Y.clientY-O.y})};A.useEffect(()=>{const Y=E=>{B&&requestAnimationFrame(()=>{T({x:E.clientX-I.current.x,y:E.clientY-I.current.y})})},P=()=>{J(!1)};return B&&(window.addEventListener("mousemove",Y),window.addEventListener("mouseup",P)),()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",P)}},[B]),console.log("🔍 Sorting logic - sortField:",C,"sortDirection:",L),console.log("🔍 Sorting logic - clients length:",e.length);const R=C?[...e].sort((Y,P)=>{let E,j;switch(C){case"firma":E=(Y.firma||"").toLowerCase(),j=(P.firma||"").toLowerCase();break;case"nazwa":E=(Y.nazwa||"").toLowerCase(),j=(P.nazwa||"").toLowerCase();break;case"adres":E=(Y.adres||"").toLowerCase(),j=(P.adres||"").toLowerCase();break;case"czas_dostawy":E=(Y.czas_dostawy||"").toLowerCase(),j=(P.czas_dostawy||"").toLowerCase();break;case"kontakt":E=(Y.kontakt||"").toLowerCase(),j=(P.kontakt||"").toLowerCase();break;default:E=Y[C]||"",j=P[C]||""}return typeof E=="string"&&typeof j=="string"?L==="asc"?E.localeCompare(j):j.localeCompare(E):0}):e;return console.log("🔍 Final sortedClients length:",R.length),console.log("🔍 Final sortedClients first:",R[0]),h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>K("firma"),children:["Nazwa firmy ",C==="firma"&&(L==="asc"?"↑":"↓")]}),h.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>K("nazwa"),children:["Nazwa ",C==="nazwa"&&(L==="asc"?"↑":"↓")]}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>K("adres"),children:"Adres"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>K("czas_dostawy"),children:"Czas dostawy"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>K("kontakt"),children:"Kontakt"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:C&&h.jsx("button",{onClick:()=>{Z(""),ne("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:"Сбросить сортировку",children:"Сброс"})})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map((Y,P)=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Y.firma}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Y.nazwa}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Y.adres}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Y.czas_dostawy}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Y.kontakt}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{type:"button",onClick:E=>{E.preventDefault(),E.stopPropagation(),X(Y)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:h.jsx(Zd,{size:16})}),h.jsx("button",{type:"button",onClick:E=>{E.preventDefault(),E.stopPropagation(),W(Y)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:h.jsx(Ku,{size:16})}),h.jsx("button",{type:"button",onClick:E=>{E.preventDefault(),E.stopPropagation(),ue(Y)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:h.jsx(Wt,{size:16})})]})})]},Y.id||`client-${P}`))})]})}),h.jsx(Pr,{isOpen:g,onRequestClose:re,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${O.x}px), calc(-50% + ${O.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:se,style:{cursor:B?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),h.jsx("button",{onClick:re,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsx("div",{children:h.jsx("input",{type:"password",value:_,onChange:Y=>S(Y.target.value),onKeyPress:he,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[h.jsx("button",{onClick:re,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),h.jsx("button",{onClick:le,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),h.jsx(zR,{isOpen:l,onClose:()=>c(!1),client:a}),h.jsx(vw,{isOpen:f,onClose:()=>{p(!1),x(null)},onSubmit:Y=>{r(Y),p(!1),x(null)},client:d})]})};var yd={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Sv;function WR(){return Sv||(Sv=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(yd)),yd.exports}var UR=WR();const Kd=Vu(UR);var Tv={};const HR="react-tooltip-core-styles",$R="react-tooltip-base-styles",Cv={core:!1,base:!1};function Dv({css:e,id:n=$R,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Cv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Tv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Tv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=HR),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Cv[t]=!0}const Nv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[ew(Number(a)),tw({fallbackAxisSideDirection:"start"}),HA({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const p=l;return t?(p.push(Ud({element:t,padding:5})),Hd(e,n,{placement:r,strategy:o,middleware:p}).then((({x:d,y:x,placement:g,middlewareData:y})=>{var k,w;const _={left:`${d}px`,top:`${x}px`,border:c},{x:S,y:O}=(k=y.arrow)!==null&&k!==void 0?k:{x:0,y:0},T=(w={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&w!==void 0?w:"bottom",B=c&&{borderBottom:c,borderRight:c};let J=0;if(c){const I=`${c}`.match(/(\d+)px/);J=I?.[1]?Number(I[1]):1}return{tooltipStyles:_,tooltipArrowStyles:{left:S!=null?`${S}px`:"",top:O!=null?`${O}px`:"",right:"",bottom:"",...B,[T]:`-${f/2+J}px`},place:g}}))):Hd(e,n,{placement:"bottom",strategy:o,middleware:p}).then((({x:d,y:x,placement:g})=>({tooltipStyles:{left:`${d}px`,top:`${x}px`},tooltipArrowStyles:{},place:g})))},Fv=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),Av=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Ov=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Gd=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Gd(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Ov(e)||!Ov(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Gd(e[a],n[a])))},YR=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Pv=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(YR(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},VR=typeof window<"u"?A.useLayoutEffect:A.useEffect,In=e=>{e.current&&(clearTimeout(e.current),e.current=null)},KR="DEFAULT_TOOLTIP_ID",GR={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},XR=A.createContext({getTooltipData:()=>GR});function yw(e=KR){return A.useContext(XR).getTooltipData(e)}var Ko={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},wd={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const QR=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:p=["hover"],openOnClick:d=!1,positionStrategy:x="absolute",middlewares:g,wrapper:y,delayShow:k=0,delayHide:w=0,float:_=!1,hidden:S=!1,noArrow:O=!1,clickable:T=!1,closeOnEsc:B=!1,closeOnScroll:J=!1,closeOnResize:I=!1,openEvents:C,closeEvents:Z,globalCloseEvents:L,imperativeModeOnly:ne,style:X,position:W,afterShow:ue,afterHide:le,disableTooltip:re,content:he,contentWrapperRef:K,isOpen:se,defaultIsOpen:R=!1,setIsOpen:Y,activeAnchor:P,setActiveAnchor:E,border:j,opacity:M,arrowColor:U,arrowSize:oe=8,role:pe="tooltip"})=>{var me;const ie=A.useRef(null),te=A.useRef(null),ae=A.useRef(null),F=A.useRef(null),Ce=A.useRef(null),[De,He]=A.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[q,de]=A.useState(!1),[Ee,Ne]=A.useState(!1),[Le,Qe]=A.useState(null),Mt=A.useRef(!1),gt=A.useRef(null),{anchorRefs:wt,setActiveAnchor:Ft}=yw(n),Ge=A.useRef(!1),[ft,ht]=A.useState([]),Ut=A.useRef(!1),rt=d||p.includes("click"),Et=rt||C?.click||C?.dblclick||C?.mousedown,qt=C?{...C}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!C&&rt&&Object.assign(qt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const kt=Z?{...Z}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!Z&&rt&&Object.assign(kt,{mouseleave:!1,blur:!1,mouseout:!1});const Ht=L?{...L}:{escape:B||!1,scroll:J||!1,resize:I||!1,clickOutsideAnchor:Et||!1};ne&&(Object.assign(qt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(kt,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(Ht,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),VR((()=>(Ut.current=!0,()=>{Ut.current=!1})),[]);const $t=Ue=>{Ut.current&&(Ue&&Ne(!0),setTimeout((()=>{Ut.current&&(Y?.(Ue),se===void 0&&de(Ue))}),10))};A.useEffect((()=>{if(se===void 0)return()=>null;se&&Ne(!0);const Ue=setTimeout((()=>{de(se)}),10);return()=>{clearTimeout(Ue)}}),[se]),A.useEffect((()=>{if(q!==Mt.current)if(In(Ce),Mt.current=q,q)ue?.();else{const Ue=(tt=>{const ct=tt.match(/^([\d.]+)(ms|s)$/);if(!ct)return 0;const[,Vt,rr]=ct;return Number(Vt)*(rr==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));Ce.current=setTimeout((()=>{Ne(!1),Qe(null),le?.()}),Ue+25)}}),[q]);const Cn=Ue=>{He((tt=>Gd(tt,Ue)?tt:Ue))},vn=(Ue=k)=>{In(ae),Ee?$t(!0):ae.current=setTimeout((()=>{$t(!0)}),Ue)},xe=(Ue=w)=>{In(F),F.current=setTimeout((()=>{Ge.current||$t(!1)}),Ue)},je=Ue=>{var tt;if(!Ue)return;const ct=(tt=Ue.currentTarget)!==null&&tt!==void 0?tt:Ue.target;if(!ct?.isConnected)return E(null),void Ft({current:null});k?vn():$t(!0),E(ct),Ft({current:ct}),In(F)},ze=()=>{T?xe(w||100):w?xe():$t(!1),In(ae)},Ve=({x:Ue,y:tt})=>{var ct;const Vt={getBoundingClientRect:()=>({x:Ue,y:tt,width:0,height:0,top:tt,left:Ue,right:Ue,bottom:tt})};Nv({place:(ct=Le?.place)!==null&&ct!==void 0?ct:c,offset:f,elementReference:Vt,tooltipReference:ie.current,tooltipArrowReference:te.current,strategy:x,middlewares:g,border:j,arrowSize:oe}).then((rr=>{Cn(rr)}))},et=Ue=>{if(!Ue)return;const tt=Ue,ct={x:tt.clientX,y:tt.clientY};Ve(ct),gt.current=ct},St=Ue=>{var tt;if(!q)return;const ct=Ue.target;ct.isConnected&&(!((tt=ie.current)===null||tt===void 0)&&tt.contains(ct)||[document.querySelector(`[id='${o}']`),...ft].some((Vt=>Vt?.contains(ct)))||($t(!1),In(ae)))},It=Av(je,50),Yt=Av(ze,50),wr=Ue=>{Yt.cancel(),It(Ue)},nt=()=>{It.cancel(),Yt()},mt=A.useCallback((()=>{var Ue,tt;const ct=(Ue=Le?.position)!==null&&Ue!==void 0?Ue:W;ct?Ve(ct):_?gt.current&&Ve(gt.current):P?.isConnected&&Nv({place:(tt=Le?.place)!==null&&tt!==void 0?tt:c,offset:f,elementReference:P,tooltipReference:ie.current,tooltipArrowReference:te.current,strategy:x,middlewares:g,border:j,arrowSize:oe}).then((Vt=>{Ut.current&&Cn(Vt)}))}),[q,P,he,X,c,Le?.place,f,x,W,Le?.position,_,oe]);A.useEffect((()=>{var Ue,tt;const ct=new Set(wt);ft.forEach((Pe=>{re?.(Pe)||ct.add({current:Pe})}));const Vt=document.querySelector(`[id='${o}']`);Vt&&!re?.(Vt)&&ct.add({current:Vt});const rr=()=>{$t(!1)},N=Pv(P),G=Pv(ie.current);Ht.scroll&&(window.addEventListener("scroll",rr),N?.addEventListener("scroll",rr),G?.addEventListener("scroll",rr));let z=null;Ht.resize?window.addEventListener("resize",rr):P&&ie.current&&(z=Jy(P,ie.current,mt,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const H=Pe=>{Pe.key==="Escape"&&$t(!1)};Ht.escape&&window.addEventListener("keydown",H),Ht.clickOutsideAnchor&&window.addEventListener("click",St);const V=[],Q=Pe=>!!(Pe?.target&&P?.contains(Pe.target)),ye=Pe=>{q&&Q(Pe)||je(Pe)},Te=Pe=>{q&&Q(Pe)&&ze()},ve=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],ke=["click","dblclick","mousedown","mouseup"];Object.entries(qt).forEach((([Pe,Re])=>{Re&&(ve.includes(Pe)?V.push({event:Pe,listener:wr}):ke.includes(Pe)&&V.push({event:Pe,listener:ye}))})),Object.entries(kt).forEach((([Pe,Re])=>{Re&&(ve.includes(Pe)?V.push({event:Pe,listener:nt}):ke.includes(Pe)&&V.push({event:Pe,listener:Te}))})),_&&V.push({event:"pointermove",listener:et});const _e=()=>{Ge.current=!0},Oe=()=>{Ge.current=!1,ze()},We=T&&(kt.mouseout||kt.mouseleave);return We&&((Ue=ie.current)===null||Ue===void 0||Ue.addEventListener("mouseover",_e),(tt=ie.current)===null||tt===void 0||tt.addEventListener("mouseout",Oe)),V.forEach((({event:Pe,listener:Re})=>{ct.forEach((Me=>{var it;(it=Me.current)===null||it===void 0||it.addEventListener(Pe,Re)}))})),()=>{var Pe,Re;Ht.scroll&&(window.removeEventListener("scroll",rr),N?.removeEventListener("scroll",rr),G?.removeEventListener("scroll",rr)),Ht.resize?window.removeEventListener("resize",rr):z?.(),Ht.clickOutsideAnchor&&window.removeEventListener("click",St),Ht.escape&&window.removeEventListener("keydown",H),We&&((Pe=ie.current)===null||Pe===void 0||Pe.removeEventListener("mouseover",_e),(Re=ie.current)===null||Re===void 0||Re.removeEventListener("mouseout",Oe)),V.forEach((({event:Me,listener:it})=>{ct.forEach((jt=>{var Pt;(Pt=jt.current)===null||Pt===void 0||Pt.removeEventListener(Me,it)}))}))}}),[P,mt,Ee,wt,ft,C,Z,L,rt,k,w]),A.useEffect((()=>{var Ue,tt;let ct=(tt=(Ue=Le?.anchorSelect)!==null&&Ue!==void 0?Ue:l)!==null&&tt!==void 0?tt:"";!ct&&n&&(ct=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const Vt=new MutationObserver((rr=>{const N=[],G=[];rr.forEach((z=>{if(z.type==="attributes"&&z.attributeName==="data-tooltip-id"&&(z.target.getAttribute("data-tooltip-id")===n?N.push(z.target):z.oldValue===n&&G.push(z.target)),z.type==="childList"){if(P){const H=[...z.removedNodes].filter((V=>V.nodeType===1));if(ct)try{G.push(...H.filter((V=>V.matches(ct)))),G.push(...H.flatMap((V=>[...V.querySelectorAll(ct)])))}catch{}H.some((V=>{var Q;return!!(!((Q=V?.contains)===null||Q===void 0)&&Q.call(V,P))&&(Ne(!1),$t(!1),E(null),In(ae),In(F),!0)}))}if(ct)try{const H=[...z.addedNodes].filter((V=>V.nodeType===1));N.push(...H.filter((V=>V.matches(ct)))),N.push(...H.flatMap((V=>[...V.querySelectorAll(ct)])))}catch{}}})),(N.length||G.length)&&ht((z=>[...z.filter((H=>!G.includes(H))),...N]))}));return Vt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{Vt.disconnect()}}),[n,l,Le?.anchorSelect,P]),A.useEffect((()=>{mt()}),[mt]),A.useEffect((()=>{if(!K?.current)return()=>null;const Ue=new ResizeObserver((()=>{setTimeout((()=>mt()))}));return Ue.observe(K.current),()=>{Ue.disconnect()}}),[he,K?.current]),A.useEffect((()=>{var Ue;const tt=document.querySelector(`[id='${o}']`),ct=[...ft,tt];P&&ct.includes(P)||E((Ue=ft[0])!==null&&Ue!==void 0?Ue:tt)}),[o,ft,P]),A.useEffect((()=>(R&&$t(!0),()=>{In(ae),In(F)})),[]),A.useEffect((()=>{var Ue;let tt=(Ue=Le?.anchorSelect)!==null&&Ue!==void 0?Ue:l;if(!tt&&n&&(tt=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),tt)try{const ct=Array.from(document.querySelectorAll(tt));ht(ct)}catch{ht([])}}),[n,l,Le?.anchorSelect]),A.useEffect((()=>{ae.current&&(In(ae),vn(k))}),[k]);const Tr=(me=Le?.content)!==null&&me!==void 0?me:he,Zr=q&&Object.keys(De.tooltipStyles).length>0;return A.useImperativeHandle(e,(()=>({open:Ue=>{if(Ue?.anchorSelect)try{document.querySelector(Ue.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ue.anchorSelect}" is not a valid CSS selector`)}Qe(Ue??null),Ue?.delay?vn(Ue.delay):$t(!0)},close:Ue=>{Ue?.delay?xe(Ue.delay):$t(!1)},activeAnchor:P,place:De.place,isOpen:!!(Ee&&!S&&Tr&&Zr)}))),Ee&&!S&&Tr?Se.createElement(y,{id:n,role:pe,className:Kd("react-tooltip",Ko.tooltip,wd.tooltip,wd[a],t,`react-tooltip__place-${De.place}`,Ko[Zr?"show":"closing"],Zr?"react-tooltip__show":"react-tooltip__closing",x==="fixed"&&Ko.fixed,T&&Ko.clickable),onTransitionEnd:Ue=>{In(Ce),q||Ue.propertyName!=="opacity"||(Ne(!1),Qe(null),le?.())},style:{...X,...De.tooltipStyles,opacity:M!==void 0&&Zr?M:void 0},ref:ie},Tr,Se.createElement(y,{className:Kd("react-tooltip-arrow",Ko.arrow,wd.arrow,r,O&&Ko.noArrow),style:{...De.tooltipArrowStyles,background:U?`linear-gradient(to right bottom, transparent 50%, ${U} 50%)`:void 0,"--rt-arrow-size":`${oe}px`},ref:te})):null},qR=({content:e})=>Se.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),Rv=Se.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:p="top",offset:d=10,wrapper:x="div",children:g=null,events:y=["hover"],openOnClick:k=!1,positionStrategy:w="absolute",middlewares:_,delayShow:S=0,delayHide:O=0,float:T=!1,hidden:B=!1,noArrow:J=!1,clickable:I=!1,closeOnEsc:C=!1,closeOnScroll:Z=!1,closeOnResize:L=!1,openEvents:ne,closeEvents:X,globalCloseEvents:W,imperativeModeOnly:ue=!1,style:le,position:re,isOpen:he,defaultIsOpen:K=!1,disableStyleInjection:se=!1,border:R,opacity:Y,arrowColor:P,arrowSize:E,setIsOpen:j,afterShow:M,afterHide:U,disableTooltip:oe,role:pe="tooltip"},me)=>{const[ie,te]=A.useState(r),[ae,F]=A.useState(a),[Ce,De]=A.useState(p),[He,q]=A.useState(f),[de,Ee]=A.useState(d),[Ne,Le]=A.useState(S),[Qe,Mt]=A.useState(O),[gt,wt]=A.useState(T),[Ft,Ge]=A.useState(B),[ft,ht]=A.useState(x),[Ut,rt]=A.useState(y),[Et,qt]=A.useState(w),[kt,Ht]=A.useState(null),[$t,Cn]=A.useState(null),vn=A.useRef(se),{anchorRefs:xe,activeAnchor:je}=yw(e),ze=Yt=>Yt?.getAttributeNames().reduce(((wr,nt)=>{var mt;return nt.startsWith("data-tooltip-")&&(wr[nt.replace(/^data-tooltip-/,"")]=(mt=Yt?.getAttribute(nt))!==null&&mt!==void 0?mt:null),wr}),{}),Ve=Yt=>{const wr={place:nt=>{var mt;De((mt=nt)!==null&&mt!==void 0?mt:p)},content:nt=>{te(nt??r)},html:nt=>{F(nt??a)},variant:nt=>{var mt;q((mt=nt)!==null&&mt!==void 0?mt:f)},offset:nt=>{Ee(nt===null?d:Number(nt))},wrapper:nt=>{var mt;ht((mt=nt)!==null&&mt!==void 0?mt:x)},events:nt=>{const mt=nt?.split(" ");rt(mt??y)},"position-strategy":nt=>{var mt;qt((mt=nt)!==null&&mt!==void 0?mt:w)},"delay-show":nt=>{Le(nt===null?S:Number(nt))},"delay-hide":nt=>{Mt(nt===null?O:Number(nt))},float:nt=>{wt(nt===null?T:nt==="true")},hidden:nt=>{Ge(nt===null?B:nt==="true")},"class-name":nt=>{Ht(nt)}};Object.values(wr).forEach((nt=>nt(null))),Object.entries(Yt).forEach((([nt,mt])=>{var Tr;(Tr=wr[nt])===null||Tr===void 0||Tr.call(wr,mt)}))};A.useEffect((()=>{te(r)}),[r]),A.useEffect((()=>{F(a)}),[a]),A.useEffect((()=>{De(p)}),[p]),A.useEffect((()=>{q(f)}),[f]),A.useEffect((()=>{Ee(d)}),[d]),A.useEffect((()=>{Le(S)}),[S]),A.useEffect((()=>{Mt(O)}),[O]),A.useEffect((()=>{wt(T)}),[T]),A.useEffect((()=>{Ge(B)}),[B]),A.useEffect((()=>{qt(w)}),[w]),A.useEffect((()=>{vn.current!==se&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[se]),A.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:se==="core",disableBase:se}}))}),[]),A.useEffect((()=>{var Yt;const wr=new Set(xe);let nt=t;if(!nt&&e&&(nt=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),nt)try{document.querySelectorAll(nt).forEach((tt=>{wr.add({current:tt})}))}catch{console.warn(`[react-tooltip] "${nt}" is not a valid CSS selector`)}const mt=document.querySelector(`[id='${n}']`);if(mt&&wr.add({current:mt}),!wr.size)return()=>null;const Tr=(Yt=$t??mt)!==null&&Yt!==void 0?Yt:je.current,Zr=new MutationObserver((tt=>{tt.forEach((ct=>{var Vt;if(!Tr||ct.type!=="attributes"||!(!((Vt=ct.attributeName)===null||Vt===void 0)&&Vt.startsWith("data-tooltip-")))return;const rr=ze(Tr);Ve(rr)}))})),Ue={attributes:!0,childList:!1,subtree:!1};if(Tr){const tt=ze(Tr);Ve(tt),Zr.observe(Tr,Ue)}return()=>{Zr.disconnect()}}),[xe,je,$t,n,t]),A.useEffect((()=>{le?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),R&&!Fv("border",`${R}`)&&console.warn(`[react-tooltip] "${R}" is not a valid \`border\`.`),le?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),Y&&!Fv("opacity",`${Y}`)&&console.warn(`[react-tooltip] "${Y}" is not a valid \`opacity\`.`)}),[]);let et=g;const St=A.useRef(null);if(o){const Yt=o({content:$t?.getAttribute("data-tooltip-content")||ie||null,activeAnchor:$t});et=Yt?Se.createElement("div",{ref:St,className:"react-tooltip-content-wrapper"},Yt):null}else ie&&(et=ie);ae&&(et=Se.createElement(qR,{content:ae}));const It={forwardRef:me,id:e,anchorId:n,anchorSelect:t,className:Kd(l,kt),classNameArrow:c,content:et,contentWrapperRef:St,place:Ce,variant:He,offset:de,wrapper:ft,events:Ut,openOnClick:k,positionStrategy:Et,middlewares:_,delayShow:Ne,delayHide:Qe,float:gt,hidden:Ft,noArrow:J,clickable:I,closeOnEsc:C,closeOnScroll:Z,closeOnResize:L,openEvents:ne,closeEvents:X,globalCloseEvents:W,imperativeModeOnly:ue,style:le,position:re,isOpen:he,defaultIsOpen:K,border:R,opacity:Y,arrowColor:P,arrowSize:E,setIsOpen:j,afterShow:M,afterHide:U,disableTooltip:oe,activeAnchor:$t,setActiveAnchor:Yt=>Cn(Yt),role:pe};return Se.createElement(QR,{...It})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Dv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Dv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));xi("pl",gi);const kd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],ZR=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],JR=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=A.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:""}),[l,c]=A.useState(!1),[f,p]=A.useState(!1),[d,x]=A.useState(!1),[g,y]=A.useState(!1),[k,w]=A.useState(null);A.useEffect(()=>{if(t)if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const C=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(C).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():""}),t.data_waznosci){let C;if(typeof t.data_waznosci=="string")C=new Date(t.data_waznosci);else{const Z=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;C=new Date(Z)}w(isNaN(C.getTime())?null:C)}else w(null)},[t]);const _=C=>{o(Z=>({...Z,typ:C})),p(!1)},S=()=>{p(!f)},O=C=>{o(Z=>({...Z,objetosc:C})),x(!1)},T=()=>{x(!d)},B=()=>{y(!g)},J=C=>{w(C),o(Z=>({...Z,data_waznosci:C?C.toISOString().split("T")[0]:""})),y(!1)};A.useEffect(()=>{const C=L=>{const ne=L.target;f&&!ne.closest(".dropdown-container")&&p(!1),d&&!ne.closest(".dropdown-container")&&x(!1),g&&!ne.closest(".react-datepicker")&&!ne.closest('button[title*="ważności"]')&&y(!1)},Z=L=>{L.key==="Escape"&&(p(!1),x(!1),y(!1))};return(f||d||g)&&(document.addEventListener("mousedown",C),document.addEventListener("keydown",Z)),()=>{document.removeEventListener("mousedown",C),document.removeEventListener("keydown",Z)}},[f,d,g]);const I=async C=>{if(C&&C.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0})})).ok)throw new Error("Failed to update item");const L={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(ne){console.error("Error creating price history record:",ne)}r(L),at.success("Pozycja została zaktualizowana pomyślnie"),n()}catch(Z){console.error("Error updating item:",Z),at.error("Błąd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycję"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsx("form",{onSubmit:I,className:"space-y-6 flex-grow",children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),h.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),h.jsx("input",{type:"text",value:a.sprzedawca,onChange:C=>o(Z=>({...Z,sprzedawca:C.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{className:"relative dropdown-container",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:S,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&kd.find(C=>C.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate",children:a.typ&&kd.find(C=>C.value===a.typ)?.label||"Wybierz typ"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:kd.map(C=>h.jsx("button",{type:"button",onClick:()=>_(C.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${C.color}`,children:C.label},C.value))})]})]}),h.jsxs("div",{className:"relative dropdown-container",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objętość"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:T,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[h.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:ZR.map(C=>h.jsx("button",{type:"button",onClick:()=>O(C.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:C.label},C.value))})]})]}),h.jsxs("div",{className:"relative",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data ważności"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"text",value:k?k.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz datę",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),h.jsx("button",{type:"button",onClick:B,className:`p-1 focus:outline-none ${k?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:k?`Termin ważności: ${k.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:h.jsx(Qd,{size:16})})]}),g&&h.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:h.jsx(As,{selected:k,onChange:J,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>y(!1)})})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa (€)"}),h.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:C=>o(Z=>({...Z,cena:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzedaży (zł)"}),h.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:C=>o(Z=>({...Z,cena_sprzedazy:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:I,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},eM=`
  .react-tooltip {
    z-index: 9999 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
`,_d=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],tM=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}return""}catch(n){return console.error("Error extracting date from order number:",n),""}},bd=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},rM=({refreshTrigger:e,productReceipts:n=[]})=>{A.useEffect(()=>{const q=document.createElement("style");return q.textContent=eM,document.head.appendChild(q),()=>{document.head.removeChild(q)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=A.useState([]),[a,o]=A.useState([]),[l,c]=A.useState([]),[f,p]=A.useState(!0),[d,x]=A.useState(null),[g,y]=A.useState(""),[k,w]=A.useState("nazwa"),[_,S]=A.useState("asc"),[O,T]=A.useState([]),[B,J]=A.useState({}),[I,C]=A.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[Z,L]=A.useState(!1),[ne,X]=A.useState(null),[W,ue]=A.useState({}),le=A.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const q=new Map;try{for(const de of n)if(Array.isArray(de.products))for(const Ee of de.products)Ee.kod&&!q.has(Ee.kod)&&q.set(Ee.kod,de.sprzedawca)}catch(de){console.error("Error building sprzedawcaCache:",de)}return console.log("sprzedawcaCache built with",q.size,"entries"),q},[n]),re=A.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const q=new Map;try{const de=Ee=>{let Ne=null;return n.forEach(Le=>{if(Array.isArray(Le.products)&&Le.products.some(Qe=>Qe.kod===Ee)){const Qe=new Date(Le.dataPrzyjecia);(!Ne||Qe<Ne)&&(Ne=Qe)}}),a.forEach(Le=>{if(Le.kod===Ee){let Qe=null;Le.numer_zamowienia&&(Qe=bd(Le.numer_zamowienia)),!Qe&&Le.created_at&&(Qe=new Date(Le.created_at)),Qe&&(!Ne||Qe<Ne)&&(Ne=Qe)}}),Ne};for(const Ee of t){const Ne=de(Ee.kod);if(Ne){const Qe=Math.max(1,Math.ceil((new Date().getTime()-Ne.getTime())/(1e3*60*60*24))),Mt=a.filter(gt=>gt.kod!==Ee.kod?!1:gt.numer_zamowienia?bd(gt.numer_zamowienia)!==null:gt.created_at!==null).reduce((gt,wt)=>gt+wt.ilosc,0);q.set(Ee.kod,Mt/Qe)}else q.set(Ee.kod,0)}}catch(de){console.error("Error building averageSalesCache:",de)}return console.log("averageSalesCache built with",q.size,"entries"),q},[t,a,n]),he=async()=>{try{const q=await fetch("/api/products");if(q.ok){const de=await q.json(),Ee={};de.forEach(Ne=>{Ee[Ne.kod]||(Ee[Ne.kod]=[]),Ee[Ne.kod].push({cena:Ne.cena,ilosc_aktualna:Ne.ilosc_aktualna,data_zmiany:Ne.updated_at||Ne.created_at})}),Object.keys(Ee).forEach(Ne=>{Ee[Ne].sort((Le,Qe)=>new Date(Qe.data_zmiany).getTime()-new Date(Le.data_zmiany).getTime())}),ue(Ee)}}catch(q){console.error("Error loading all products:",q)}},K=q=>{const de=a.filter(Ne=>Ne.kod===q);if(de.length===0)return null;let Ee=null;return de.forEach(Ne=>{let Le=null;Ne.numer_zamowienia&&(Le=bd(Ne.numer_zamowienia)),!Le&&Ne.created_at&&(Le=new Date(Ne.created_at)),Le&&(!Ee||Le>Ee)&&(Ee=Le)}),Ee},se=async()=>{try{console.log("Starting loadInventory..."),p(!0),x(null),console.log("Fetching working-sheets...");const q=await fetch("/api/working-sheets");if(!q.ok)throw new Error(`HTTP error! status: ${q.status}`);const de=await q.json();console.log("Inventory data from server:",de.length,"items"),de.length>0&&(console.log("First item keys:",Object.keys(de[0])),console.log("First item typ value:",de[0].typ),de[0].data_waznosci&&(console.log("First item data_waznosci:",de[0].data_waznosci),console.log("First item data_waznosci type:",typeof de[0].data_waznosci),console.log("First item data_waznosci formatted:",De(de[0].data_waznosci)))),r(de),console.log("Fetching orders...");const Ee=await fetch("/api/orders");if(!Ee.ok)throw new Error(`HTTP error! status: ${Ee.status}`);const Ne=await Ee.json();console.log("Orders data from server:",Ne.length,"items"),c(Ne),console.log("Fetching orders-with-products...");const Le=await fetch("/api/orders-with-products");if(!Le.ok)throw new Error(`HTTP error! status: ${Le.status}`);const Qe=await Le.json();console.log("Orders with products from server:",Qe.length,"items");const Mt=[];Qe.forEach(gt=>{gt.products&&gt.products.forEach(wt=>{Mt.push({...wt,orderId:gt.id,created_at:wt.created_at||gt.data_utworzenia,numer_zamowienia:gt.numer_zamowienia})})}),console.log("Total order products:",Mt.length),o(Mt),await he(),console.log("loadInventory completed successfully")}catch(q){console.error("Error loading inventory:",q),x(`Failed to load inventory: ${q instanceof Error?q.message:"Unknown error"}`)}finally{p(!1)}};A.useEffect(()=>{se()},[]),A.useEffect(()=>{e&&se()},[e]);const R=q=>{k===q?S(_==="asc"?"desc":"asc"):(w(q),S("asc"))},Y=q=>{const de=_d.find(Ee=>Ee.value===q);return de?de.color:"bg-gray-100 text-gray-800 border-gray-200"},P=q=>q===1/0?"bg-gray-100 text-gray-800 border-gray-200":q<=30?"bg-red-100 text-gray-800 border-red-200":q<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",E=A.useMemo(()=>{const q=new Set;return t.forEach(de=>{const Ee=de.sprzedawca||le.get(de.kod);Ee&&q.add(Ee)}),Array.from(q).sort()},[t,le]),j=A.useMemo(()=>{const q=new Set;return t.forEach(de=>{de.typ&&q.add(de.typ)}),Array.from(q).sort()},[t]),M=A.useMemo(()=>{const q=new Set;return t.forEach(de=>{de.objetosc&&q.add(de.objetosc.toString())}),Array.from(q).sort((de,Ee)=>parseFloat(de)-parseFloat(Ee))},[t]),U=A.useMemo(()=>{const q=new Set;return t.forEach(de=>{if(de.ilosc===0)q.add("brak");else{const Ee=re.get(de.kod)||0,Ne=Ee<=0?1/0:Math.floor(de.ilosc/Ee),Le=Ne===1/0?"Brak danych":Ne<=30?"mało":Ne<=60?"średnie":"dużo";q.add(Le)}}),Array.from(q).sort()},[t,re]),oe=t.filter(q=>{if(!(q.kod.toLowerCase().includes(g.toLowerCase())||q.nazwa.toLowerCase().includes(g.toLowerCase())||q.kod_kreskowy&&q.kod_kreskowy.toLowerCase().includes(g.toLowerCase()))||I.sprzedawca&&(q.sprzedawca||le.get(q.kod))!==I.sprzedawca||I.typ&&q.typ!==I.typ||I.objetosc&&q.objetosc?.toString()!==I.objetosc)return!1;if(I.status){let Ee;if(q.ilosc===0)Ee="brak";else{const Ne=re.get(q.kod)||0,Le=Ne<=0?1/0:Math.floor(q.ilosc/Ne);Ee=Le===1/0?"Brak danych":Le<=30?"mało":Le<=60?"średnie":"dużo"}if(Ee!==I.status)return!1}return!0}).sort((q,de)=>{let Ee,Ne;switch(k){case"sprzedawca":Ee=q.sprzedawca||le.get(q.kod)||"",Ne=de.sprzedawca||le.get(de.kod)||"";break;case"cena":Ee=q.cena||0,Ne=de.cena||0;break;case"cena_sprzedazy":Ee=q.cena_sprzedazy||0,Ne=de.cena_sprzedazy||0;break;case"srednieZuzycie":Ee=re.get(q.kod)||0,Ne=re.get(de.kod)||0;break;case"dniPozostalo":const Le=re.get(q.kod)||0,Qe=re.get(de.kod)||0;Ee=Le<=0?1/0:Math.floor(q.ilosc/Le),Ne=Qe<=0?1/0:Math.floor(de.ilosc/Qe);break;case"dataWyczerpania":if(q.ilosc===0){const Ge=K(q.kod);Ee=Ge?Ge.getTime():0}else{const Ge=re.get(q.kod)||0,ft=Ge<=0?1/0:Math.floor(q.ilosc/Ge);Ee=ft===1/0?1/0:new Date().setDate(new Date().getDate()+ft)}if(de.ilosc===0){const Ge=K(de.kod);Ne=Ge?Ge.getTime():0}else{const Ge=re.get(de.kod)||0,ft=Ge<=0?1/0:Math.floor(de.ilosc/Ge);Ne=ft===1/0?1/0:new Date().setDate(new Date().getDate()+ft)}break;case"status":const Mt=Ge=>{if(Ge.ilosc===0)return 0;const ft=re.get(Ge.kod)||0,ht=ft<=0?1/0:Math.floor(Ge.ilosc/ft);return ht===1/0?4:ht<=30?1:ht<=60?2:3};Ee=Mt(q),Ne=Mt(de);break;case"typ":Ee=q.typ||"",Ne=de.typ||"";break;case"objetosc":Ee=q.objetosc||0,Ne=de.objetosc||0;break;case"dataWaznosci":const gt=Ge=>{if(!Ge)return 0;let ft;if(typeof Ge=="string")ft=new Date(Ge);else if(typeof Ge=="number")Ge<1e12?ft=new Date(Ge*1e3):ft=new Date(Ge);else return 0;return isNaN(ft.getTime())?0:ft.getTime()};Ee=gt(q.data_waznosci),Ne=gt(de.data_waznosci);break;case"sprzedaze":const wt=a.filter(Ge=>Ge.kod===q.kod).length,Ft=a.filter(Ge=>Ge.kod===de.kod).length;Ee=wt,Ne=Ft;break;default:Ee=q[k],Ne=de[k]}return typeof Ee=="string"&&typeof Ne=="string"?_==="asc"?Ee.localeCompare(Ne):Ne.localeCompare(Ee):typeof Ee=="number"&&typeof Ne=="number"?_==="asc"?Ee-Ne:Ne-Ee:0}),pe=q=>{T(q?oe.map(de=>de.id):[])},me=(q,de)=>{T(Ee=>de?[...Ee,q]:Ee.filter(Ne=>Ne!==q))},ie=q=>{J(de=>({...de,[q]:Math.max(0,(de[q]||0)-1)}))},te=(q,de)=>{J(Ee=>({...Ee,[q]:Math.min(de,(Ee[q]||0)+1)}))},ae=()=>{if(O.length!==1){at.error("Wybierz dokładnie jedną pozycję do edycji");return}const q=t.find(de=>de.id===O[0]);q&&(X(q),L(!0))},F=q=>{r(de=>de.map(Ee=>Ee.id===q.id?q:Ee)),T([])},Ce=oe.length>0&&oe.every(q=>O.includes(q.id)),De=q=>{if(!q)return"-";let de;if(typeof q=="string")de=new Date(q);else if(typeof q=="number")q<1e12?de=new Date(q*1e3):de=new Date(q);else return"-";return isNaN(de.getTime())?"-":de.toLocaleDateString("pl-PL")},He=O.length>0?t.filter(q=>O.includes(q.id)):[];return f?h.jsx("div",{className:"flex justify-center items-center py-8",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):d?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("p",{className:"text-red-600 font-sora",children:d}),h.jsx("button",{onClick:se,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[h.jsxs("div",{className:"relative w-full max-w-xs",children:[h.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),h.jsx("input",{type:"text",value:g,onChange:q=>y(q.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),h.jsx("button",{onClick:ae,disabled:O.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:h.jsx(Ku,{size:16})})]}),h.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[h.jsxs("div",{className:"flex flex-wrap gap-4",children:[h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykułów"}),h.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:He.length})]}),h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Łączna ilość towaru"}),h.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:He.length>0?He.reduce((q,de)=>q+(de.ilosc||0),0):0})]}),h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru fakturowa"}),h.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[He.length>0?He.reduce((q,de)=>{const Ee=W[de.kod]||[],Ne=Ee.reduce((Le,Qe)=>Le+Qe.cena*Qe.ilosc,0);if(Ee.length>0)return q+Ne;{const Le=de.cena||0,Qe=de.ilosc||0;return q+Le*Qe}},0).toFixed(2):"0.00"," €"]})]}),h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru w sprzedaży"}),h.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[He.length>0?He.reduce((q,de)=>{const Ee=de.cena_sprzedazy||0,Ne=de.ilosc||0;return q+Ee*Ne},0).toFixed(2):"0.00"," zł"]})]})]}),h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[h.jsx("div",{className:"relative",children:h.jsxs("select",{value:I.sprzedawca,onChange:q=>C(de=>({...de,sprzedawca:q.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Sprzedawca"}),E.map(q=>h.jsx("option",{value:q,children:q},q))]})}),h.jsx("div",{className:"relative",children:h.jsxs("select",{value:I.typ,onChange:q=>C(de=>({...de,typ:q.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Typ"}),j.map(q=>h.jsx("option",{value:q,children:_d.find(de=>de.value===q)?.label||q},q))]})}),h.jsx("div",{className:"relative",children:h.jsxs("select",{value:I.objetosc,onChange:q=>C(de=>({...de,objetosc:q.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Objętość"}),M.map(q=>h.jsxs("option",{value:q,children:[q," l"]},q))]})}),h.jsx("div",{className:"relative",children:h.jsxs("select",{value:I.status,onChange:q=>C(de=>({...de,status:q.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Status"}),U.map(q=>h.jsx("option",{value:q,children:q},q))]})})]}),(I.sprzedawca||I.typ||I.objetosc||I.status)&&h.jsx("button",{onClick:()=>C({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczyść filtry"})]})]}),h.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:h.jsx("div",{className:"w-full overflow-y-scroll max-h-[500px] relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:h.jsx("input",{type:"checkbox",checked:Ce,onChange:q=>pe(q.target.checked)})}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("kod"),children:"Kod"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("nazwa"),children:"Nazwa"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("sprzedawca"),children:"Sprzedawca"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("ilosc"),children:"Ilość"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("typ"),children:"Typ"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("objetosc"),children:"Objętość"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("cena"),children:"Cena fakturowa"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("cena_sprzedazy"),children:"Cena w sprzedaży"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("dataWaznosci"),children:"Data ważności"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("sprzedaze"),children:"Sprzedaże"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("srednieZuzycie"),children:"Średnie zużycie/dzień"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("dniPozostalo"),children:"Dni pozostało"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("dataWyczerpania"),children:"Data wyczerpania zapasów"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("status"),children:"Status"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:oe.map(q=>{const de=re.get(q.kod)||0;return de<=0||Math.floor(q.ilosc/de),h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:h.jsx("input",{type:"checkbox",checked:O.includes(q.id),onChange:Ee=>me(q.id,Ee.target.checked)})}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",children:h.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:q.kod})}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",children:h.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:q.nazwa})}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:q.sprzedawca||le.get(q.kod)||""}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:q.ilosc}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:q.typ?h.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Y(q.typ)}`,children:_d.find(Ee=>Ee.value===q.typ)?.label||q.typ}):"-"}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:q.objetosc?`${q.objetosc} l`:"-"}),h.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${q.kod}`,onMouseEnter:()=>{W[q.kod]||he()},children:[q.cena?`${q.cena.toFixed(2)} €`:"-",h.jsx(Rv,{id:`price-tooltip-${q.kod}`,className:"max-w-md",place:"top",children:h.jsxs("div",{className:"font-sora",children:[h.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),W[q.kod]&&W[q.kod].length>0?W[q.kod].map((Ee,Ne)=>h.jsxs("div",{className:"mb-1",children:[h.jsxs("span",{className:"font-medium",children:[Ee.cena.toFixed(2)," €"]}),h.jsxs("span",{className:"text-gray-500 ml-2",children:["(",Ee.ilosc_aktualna," szt.)"]})]},Ne)):h.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:q.cena_sprzedazy?`${q.cena_sprzedazy.toFixed(2)} zł`:"-"}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:De(q.data_waznosci)}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ee=a.filter(Ft=>Ft.kod===q.kod);console.log(`Sales for ${q.kod}:`,Ee.length);const Ne={};Ee.forEach(Ft=>{const Ge=l.find(rt=>rt.id===Ft.orderId),ft=Ge?Ge.klient:"";let ht="";Ge&&Ge.numer_zamowienia&&(ht=tM(Ge.numer_zamowienia)),!ht&&Ge&&(ht=new Date(Ge.data_utworzenia).toLocaleDateString("pl-PL")),!ht&&Ft.created_at&&(ht=new Date(Ft.created_at).toLocaleDateString("pl-PL"));const Ut=ht+"|"+ft;Ne[Ut]||(Ne[Ut]={qty:0,klient:ft,date:ht}),Ne[Ut].qty+=Ft.ilosc});const Le=Object.entries(Ne).sort(([,Ft],[,Ge])=>{const ft=new Date(Ft.date.split(".").reverse().join("-"));return new Date(Ge.date.split(".").reverse().join("-")).getTime()-ft.getTime()});if(console.log(`Sales array for ${q.kod}:`,Le.length),Le.length===0)return h.jsx("div",{className:"text-gray-400",children:"-"});const Qe=B[q.kod]||0,Mt=Math.max(0,Le.length-5),gt=Le.length>5;if(Le.length===0)return h.jsx("div",{className:"text-gray-400",children:"-"});const wt=Le.slice(Qe,Qe+5);return h.jsxs("div",{className:"flex items-center gap-1",children:[gt&&Qe>0&&h.jsx("button",{onClick:()=>ie(q.kod),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:h.jsx(x2,{size:12})}),h.jsx("div",{className:"flex flex-row gap-1",children:wt.map(([Ft,Ge],ft)=>h.jsxs("div",{className:"w-5 h-5 bg-blue-100 border border-blue-300 rounded flex items-center justify-center text-xs font-bold cursor-pointer hover:bg-blue-200 relative","data-tooltip-id":`sales-tooltip-${q.kod}-${Qe+ft}`,...Ge.date&&Ge.klient?{"data-tooltip-content":`${Ge.date} | ${Ge.klient}`}:{},children:[Ge.qty,h.jsx(Rv,{id:`sales-tooltip-${q.kod}-${Qe+ft}`,className:"max-w-md",place:"top"})]},Ft+ft))}),gt&&Qe<Mt&&h.jsx("button",{onClick:()=>te(q.kod,Mt),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:h.jsx(g2,{size:12})})]})})()}),h.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(re.get(q.kod)||0).toFixed(2),"/dzień"]}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ee=re.get(q.kod)||0,Ne=Ee<=0?1/0:Math.floor(q.ilosc/Ee);return Ne===1/0?"∞":Ne})()}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(q.ilosc===0){const Qe=K(q.kod);return Qe?Qe.toLocaleDateString("pl-PL"):"-"}const Ee=re.get(q.kod)||0,Ne=Ee<=0?1/0:Math.floor(q.ilosc/Ee);if(Ne===1/0)return"-";const Le=new Date;return Le.setDate(Le.getDate()+Ne),Le.toLocaleDateString("pl-PL")})()}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(q.ilosc===0)return h.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border bg-gray-100 text-gray-600 border-gray-300",children:"brak"});const Ee=re.get(q.kod)||0,Ne=Ee<=0?1/0:Math.floor(q.ilosc/Ee),Le=Ne===1/0?"Brak danych":Ne<=30?"mało":Ne<=60?"średnie":"dużo";return h.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${P(Ne)}`,children:Le})})()})]},q.id)})})]})})}),h.jsx(JR,{isOpen:Z,onClose:()=>{L(!1),X(null)},item:ne,onSave:F})]})};xi("pl",gi);const nM=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=A.useState(new Date),[o,l]=A.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=A.useState([]),[p,d]=A.useState(new Set),[x,g]=A.useState(!1),[y,k]=A.useState(""),[w,_]=A.useState(""),[S,O]=A.useState(!1),[T,B]=A.useState(null);A.useEffect(()=>{const ne=setTimeout(async()=>{if(y.trim().length<2||S){f([]);return}g(!0);try{const X=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(y)}`);if(!X.ok)throw new Error("Failed to fetch orders");const W=await X.json();if(W&&W.length>0){const ue=W.map(le=>({id:le.id,nazwa:`Zamówienie: ${le.numer_zamowienia}`,kod:le.klient,klient:le.klient,numer_zamowienia:le.numer_zamowienia,products:le.products||[]}));f(ue)}else f([])}catch(X){console.error("Error searching orders:",X),f([])}finally{g(!1)}},300);return()=>clearTimeout(ne)},[y,S]);const J=(L,ne)=>{if(L.numer_zamowienia){if(_(L.klient),B(L.id),L.products&&L.products.length>0){const X=L.products.map(W=>({nazwa:W.nazwa,ilosc:W.ilosc,original_ilosc:W.ilosc,powod_zwrotu:""}));l(X)}f([]),k(L.numer_zamowienia),O(!0),at.success("Zamówienie wybrane")}else{const X=[...o];X[ne]={...X[ne],nazwa:L.nazwa,ilosc:0,original_ilosc:0},l(X)}},I=()=>{const L=new Set;return o.forEach((ne,X)=>{const W=ne.original_ilosc,ue=o[X].ilosc;!ne.nazwa.trim()||!ue||ue<=0||!ne.powod_zwrotu?L.add(X):ue>W&&(L.add(X),at.error(`Ilość zwrotu (${ue}) nie może przekraczać ilości w zamówieniu (${W})`))}),d(L),L.size===0},C=async()=>{if(!I()){at.error("Proszę wypełnić wszystkie wymagane pola");return}try{const L={klient:w,data_zwrotu:r,products:o,orderId:T},ne=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!ne.ok){const W=await ne.json();throw new Error(W.error||"Failed to create return")}const X=await ne.json();console.log("Return created:",X),t(L),at.success(`Zwrot został utworzony: ${X.numer_zwrotu}`),n(),k(""),_(""),O(!1),B(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),d(new Set)}catch(L){console.error("Error creating return:",L),at.error("Błąd podczas tworzenia zwrotu")}},Z=()=>{n(),k(""),_(""),O(!1),B(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),d(new Set)};return h.jsx(Pr,{isOpen:e,onRequestClose:Z,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),h.jsx("button",{onClick:Z,className:"text-red-500 focus:outline-none",children:h.jsx(Wt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex flex-wrap gap-4",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),h.jsx(As,{selected:r,onChange:L=>a(L||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",value:y,onChange:L=>{k(L.target.value),O(!1),B(null)},placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),x&&h.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&y.trim().length>=2&&h.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(L=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>J(L,-1),children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"text-[10px]",children:L.nazwa}),h.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",L.klient]})]})},L.id))})]})]})]})}),w&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),h.jsx("p",{className:"text-xs text-gray-900",children:w})]})}),h.jsx("button",{onClick:()=>_(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:h.jsx(Wt,{size:16})})]})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((L,ne)=>h.jsx("div",{className:"relative",children:h.jsxs("div",{className:"flex",children:[h.jsx("div",{className:"relative flex-1 max-w-[50%]",children:h.jsx("input",{type:"text",value:L.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),h.jsx("div",{className:"w-20 ml-2",children:h.jsx("input",{type:"number",min:"1",max:L.original_ilosc,value:o[ne].ilosc||"",onChange:X=>{const W=[...o],ue=X.target.value===""?0:parseInt(X.target.value)||0;W[ne]={...W[ne],ilosc:ue},l(W)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilość"})}),h.jsx("div",{className:"w-40 ml-2",children:h.jsxs("select",{value:o[ne].powod_zwrotu,onChange:X=>{const W=[...o];W[ne]={...W[ne],powod_zwrotu:X.target.value},l(W)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[h.jsx("option",{value:"",children:"Powód zwrotu"}),h.jsx("option",{value:"Błąd w zamówieniu",children:"Błąd w zamówieniu"}),h.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),h.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&h.jsx("button",{onClick:()=>{const X=o.filter((W,ue)=>ue!==ne);l(X)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:h.jsx(Wt,{size:16})})]})},ne))]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:C,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwórz zwrot"})}),h.jsx("div",{className:"absolute bottom-4 right-4",children:h.jsx("button",{onClick:Z,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})},aM=e=>(e(!0),!0);Pr.setAppElement("#root");const Jt="";console.log("API_URL configured as:",Jt);function sM(){const[e,n]=A.useState(!1),[t,r]=A.useState(!1),[a,o]=A.useState(!1),[l,c]=A.useState(!1),[f,p]=A.useState(!1),[d,x]=A.useState(null),[g,y]=A.useState(null),[k,w]=A.useState(null),[_,S]=A.useState(null),[O,T]=A.useState(!0),[B,J]=A.useState(["inventory","clients","orders","inventoryStatus"]),[I,C]=A.useState({sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:"inventory",activeSubTab:"przyjecie",isDbInitialized:!1}),[Z,L]=A.useState(!1),[ne,X]=A.useState(!1),[W,ue]=A.useState(!1),[le,re]=A.useState(!1),[he,K]=A.useState(null),[se,R]=A.useState(!1),[Y,P]=A.useState(null),[E,j]=A.useState(!1),[M,U]=A.useState(null),[oe,pe]=A.useState(0),[me,ie]=A.useState(0),[te,ae]=A.useState(null),[F,Ce]=A.useState("");A.useEffect(()=>{(async()=>{try{T(!0),console.log("🚀 Starting data loading process..."),console.log("🔧 API_URL:",Jt),console.log("👥 Loading clients...");const je=await qt();console.log("✅ Clients loaded:",je.length),console.log("📦 Loading products...");const ze=await kt();console.log("✅ Products loaded:",ze.length),console.log("🧾 Loading product receipts...");const Ve=await Ht();console.log("✅ Product receipts loaded:",Ve.length),console.log("🔄 Updating app state with loaded data..."),console.log("📋 Setting clients:",je),C(et=>{const St={...et,clients:je,products:ze,productReceipts:Ve};return console.log("🔄 New app state:",St),St}),console.log("✅ App state updated successfully"),console.log("📊 Final data counts:"),console.log("   - Clients:",je.length),console.log("   - Products:",ze.length),console.log("   - Product Receipts:",Ve.length)}catch(je){console.error("❌ Error loading data:",je),at.error("Błąd podczas ładowania danych")}finally{T(!1),console.log("🏁 Data loading process completed")}})()},[]),A.useEffect(()=>{if(!I.isDbInitialized)return;console.log("💾 useEffect triggered - clients changed:",I.clients.length),(async()=>{const je={sheets:I.sheets,sheetsData:I.sheetsData,activeSheet:I.activeSheet,showTable:I.showTable,clients:I.clients,products:I.products,productReceipts:I.productReceipts};try{localStorage.setItem("appState",JSON.stringify(je)),console.log("App state saved to localStorage")}catch(ze){console.error("Error saving state to localStorage:",ze)}})()},[I.sheetsData,I.sheets,I.activeSheet,I.showTable,I.clients,I.products,I.productReceipts]);const De=async()=>{try{T(!0),console.log("🔍 Loading sheets from database..."),console.log("📡 Making request to:",`${Jt}/api/original-sheets`);const xe=await fetch(`${Jt}/api/original-sheets`);if(console.log("📡 Sheets response status:",xe.status),!xe.ok)throw new Error(`HTTP error! status: ${xe.status}`);const je=await xe.json();console.log("✅ Received sheets from server:",je),console.log("📊 Sheets count:",je.length);const ze=je.map(Ve=>({fileName:Ve.fileName,data:{headers:Ve.data.headers,rows:Ve.data.rows}}));console.log("🔄 Processed sheets:",ze),console.log("📊 Processed sheets count:",ze.length),C(Ve=>({...Ve,sheets:ze,sheetsData:ze,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log("✅ App state updated with sheets data")}catch(xe){console.error("❌ Ошибка загрузки файлов из базы:",xe),at.error("Ошибка загрузки файлов из базы")}finally{T(!1),console.log("🏁 Loading sheets completed")}};A.useEffect(()=>{De()},[]);const He=async(xe,je)=>{console.log("handleExcelUpload called with:",{newFileName:xe,fileData:je});try{const ze=await fetch(`${Jt}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:xe,data:je})});if(!ze.ok){if(ze.status===409){at.error("Może być tylko jeden plik Excel. Usuń istniejący plik przed załadowaniem nowego.");return}throw new Error(`HTTP error! status: ${ze.status}`)}await De(),n(!1)}catch(ze){console.error("Error saving file data:",ze),at.error("Błąd podczas zapisywania danych pliku")}},q=(xe,je)=>{const ze=`${Jt}/api/download_file/${encodeURIComponent(xe.fileName)}`;window.open(ze,"_blank")},de=xe=>{w(xe)},Ee=xe=>{xe.preventDefault()},Ne=xe=>{!k||k===xe||(J(je=>{const ze=[...je],Ve=ze.indexOf(k),et=ze.indexOf(xe);return ze.splice(Ve,1),ze.splice(et,0,k),ze}),w(null))},Le=xe=>{(xe==="inventory"||xe==="clients"||xe==="orders"||xe==="inventoryStatus")&&C(je=>({...je,activeTab:xe,activeSubTab:xe==="inventory"?"przyjecie":null}))},Qe=xe=>{C(je=>({...je,activeSubTab:xe}))},Mt=xe=>{switch(xe){case"inventory":return"Zakup towaru";case"clients":return"Klienci";case"orders":return"Zamówienia";case"inventoryStatus":return"Stany magazynowe";default:return xe}},gt=()=>{g&&(c(!1),n(!1))},wt=async xe=>{try{console.log("🚀 Starting handleAddProduct..."),console.log("📋 Received data:",xe),console.log("📎 Files check:",{hasProductInvoice:!!xe.productInvoice,hasTransportInvoice:!!xe.transportInvoice,productInvoice:xe.productInvoice,transportInvoice:xe.transportInvoice}),console.log("📡 Making request to:",`${Jt}/api/product-receipts`);let je;if(xe.productInvoice||xe.transportInvoice){console.log("📎 Files detected, using FormData...");const et=new FormData,St={date:xe.date,sprzedawca:xe.sprzedawca,wartosc:xe.wartosc,kosztDostawy:xe.kosztDostawy,products:xe.products};et.append("data",JSON.stringify(St)),console.log("📄 JSON data:",St),xe.productInvoice&&(et.append("productInvoice",xe.productInvoice),console.log("📎 Product invoice added:",xe.productInvoice.name)),xe.transportInvoice&&(et.append("transportInvoice",xe.transportInvoice),console.log("📎 Transport invoice added:",xe.transportInvoice.name)),console.log("📦 FormData entries:");for(let[It,Yt]of et.entries())console.log(`  ${It}:`,Yt);je=await fetch(`${Jt}/api/product-receipts`,{method:"POST",body:et})}else{console.log("📄 No files, using JSON...");const et={date:xe.date,sprzedawca:xe.sprzedawca,wartosc:xe.wartosc,kosztDostawy:xe.kosztDostawy,products:xe.products};console.log("📄 JSON data:",et),je=await fetch(`${Jt}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)})}if(console.log("📡 Response status:",je.status),console.log("📡 Response headers:",je.headers),!je.ok){const et=await je.text();throw console.error("❌ Response error text:",et),new Error(`Failed to save product receipt: ${je.status} - ${et}`)}const ze=await je.json();if(console.log("✅ Saved receipt:",ze),ze.workingSheetsUpdated||ze.workingSheetsInserted){let et="Dodano nowy towar";ze.workingSheetsUpdated>0&&(et+=` (${ze.workingSheetsUpdated} товаров обновлено в working sheets)`),ze.workingSheetsInserted>0&&(et+=` (${ze.workingSheetsInserted} новых товаров добавлено в working sheets)`),at.success(et)}else at.success("Dodano nowy towar");console.log("🔄 Loading updated receipts...");const Ve=await Ht();console.log("✅ Updated receipts:",Ve),console.log("🔄 Updating app state..."),C(et=>{const St={...et,productReceipts:Ve};return console.log("✅ New app state:",St),St}),o(!1)}catch(je){console.error("❌ Error adding product:",je),at.error("Wystąpił błąd podczas dodawania towaru")}},Ft=xe=>{P(xe),R(!0)},Ge=async xe=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",xe),console.log("📎 Files check (update):",{hasProductInvoice:!!xe.productInvoice,hasTransportInvoice:!!xe.transportInvoice,productInvoice:xe.productInvoice,transportInvoice:xe.transportInvoice});try{let je;if(xe.productInvoice||xe.transportInvoice){console.log("📎 Files detected (update), using FormData...");const St=new FormData,It={date:xe.date,sprzedawca:xe.sprzedawca,wartosc:xe.wartosc,kosztDostawy:xe.kosztDostawy,products:xe.products};St.append("data",JSON.stringify(It)),console.log("📄 JSON data (update):",It),xe.productInvoice&&(St.append("productInvoice",xe.productInvoice),console.log("📎 Product invoice added (update):",xe.productInvoice.name)),xe.transportInvoice&&(St.append("transportInvoice",xe.transportInvoice),console.log("📎 Transport invoice added (update):",xe.transportInvoice.name)),console.log("📦 FormData entries (update):");for(let[Yt,wr]of St.entries())console.log(`  ${Yt}:`,wr);je=await fetch(`${Jt}/api/product-receipts/${xe.id}`,{method:"PUT",body:St})}else console.log("📄 No files (update), using JSON..."),je=await fetch(`${Jt}/api/product-receipts/${xe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:xe.date,sprzedawca:xe.sprzedawca,wartosc:xe.wartosc,kosztDostawy:xe.kosztDostawy,products:xe.products})});if(!je.ok)throw new Error("Failed to update product receipt");const ze=await je.json();console.log("Updated receipt:",ze),console.log("Loading updated receipts...");const Ve=await Ht();console.log("Updated receipts:",Ve),console.log("Loading updated products...");const et=await kt();console.log("Updated products:",et),console.log("Updating app state..."),C(St=>{const It={...St,productReceipts:Ve,products:et};return console.log("New app state:",It),It}),at.success("Zakup został zaktualizowany"),R(!1),P(null),p(!1),x(null)}catch(je){console.error("Error updating product receipt:",je),at.error("Wystąpił błąd podczas aktualizacji zakupu")}},ft=async xe=>{try{if(!(await fetch(`${Jt}/api/product-receipts/${xe}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const ze=await Ht(),Ve=await kt();C(et=>({...et,productReceipts:ze,products:Ve})),at.success("Zakup został usunięty")}catch(je){console.error("Error deleting receipt:",je),at.error("Wystąpił błąd podczas usuwania zakupu")}},ht=async xe=>{try{const je=await fetch(`${Jt}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});if(!je.ok)throw new Error("Failed to add client");const ze=await je.json(),Ve={...xe,id:ze.id};C(et=>({...et,clients:[...et.clients,Ve]})),ie(et=>et+1),at.success("Klient został dodany")}catch(je){console.error("Error adding client:",je),at.error("Błąd podczas dodawania klienta")}},Ut=async xe=>{try{if(!(await fetch(`${Jt}/api/clients/${xe}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");C(ze=>({...ze,clients:ze.clients.filter(Ve=>Ve.id!==xe)})),ie(ze=>ze+1),at.success("Klient został usunięty")}catch(je){console.error("Error deleting client:",je),at.error("Błąd podczas usuwania klienta")}},rt=async xe=>{try{console.log("🔍 handleUpdateClient called with data:",xe);const je=await fetch(`${Jt}/api/clients/${xe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});if(!je.ok)throw new Error("Failed to update client");const ze=await je.json();console.log("✅ Client updated in database:",ze),console.log("✅ Updated client fields:",{id:ze.id,firma:ze.firma,nazwa:ze.nazwa,adres:ze.adres,czas_dostawy:ze.czas_dostawy,kontakt:ze.kontakt}),C(Ve=>{console.log("🔄 Updating app state..."),console.log("📋 Previous clients:",Ve.clients),console.log("📋 Updated client data:",ze);const et=Ve.clients.map(It=>It.id===xe.id?(console.log("🔄 Updating client:",It.id,"from:",It,"to:",{...It,...ze}),{id:It.id,firma:ze.firma||It.firma,nazwa:ze.nazwa||It.nazwa,adres:ze.adres||It.adres,czas_dostawy:ze.czas_dostawy||It.czas_dostawy,kontakt:ze.kontakt||It.kontakt}):{...It});console.log("📋 New clients array:",et);const St={...Ve,clients:et};return console.log("🔄 New app state:",St),St}),at.success("Klient został zaktualizowany"),setTimeout(()=>{C(Ve=>(console.log("🔄 Force update after timeout"),{...Ve})),ie(Ve=>Ve+1),ae(xe.id),qt().then(Ve=>{C(et=>({...et,clients:Ve})),ie(et=>et+1)})},100)}catch(je){console.error("Error updating client:",je),at.error("Błąd podczas aktualizacji klienta")}},Et=async xe=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",xe),console.log("Products data:",JSON.stringify(xe.products,null,2));try{const je=await fetch(`${Jt}/api/orders/${xe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});if(!je.ok)throw new Error("Failed to update order");const ze=await je.json();console.log("Updated order result:",ze),at.success("Zamówienie zostało zaktualizowane"),pe(Ve=>Ve+1)}catch(je){console.error("Error updating order:",je),at.error("Błąd podczas aktualizacji zamówienia")}},qt=async()=>{try{console.log("🔍 Loading clients from:",`${Jt}/api/clients`);const xe=await fetch(`${Jt}/api/clients`);if(console.log("📡 Clients response status:",xe.status),!xe.ok)throw new Error(`HTTP error! status: ${xe.status}`);const je=await xe.json();return console.log("✅ Loaded clients:",je.length,"records"),console.log("📋 First client:",je[0]),je}catch(xe){return console.error("❌ Error loading clients:",xe),[]}},kt=async()=>{try{console.log("🔍 Loading products from:",`${Jt}/api/products`);const xe=await fetch(`${Jt}/api/products`);if(console.log("📡 Products response status:",xe.status),!xe.ok)throw new Error(`HTTP error! status: ${xe.status}`);const je=await xe.json();console.log("✅ Loaded products:",je.length,"records"),console.log("📋 First product:",je[0]);const ze=je.map(Ve=>({kod:Ve.kod,nazwa:Ve.nazwa,ilosc:Ve.ilosc,jednostka_miary:Ve.jednostka_miary||"",kod_kreskowy:Ve.kod_kreskowy||"",data_waznosci:Ve.data_waznosci??void 0,archiwalny:Ve.archiwalny,rezerwacje:Ve.rezerwacje,ilosc_na_poleceniach:Ve.ilosc_na_poleceniach,waga_netto:Ve.waga_netto,waga_brutto:Ve.waga_brutto,objetosc:Ve.objetosc,opis:Ve.opis}));return console.log("🔄 Processed products:",ze.length,"records"),ze}catch(xe){return console.error("❌ Error loading products:",xe),[]}},Ht=async()=>{try{console.log("🔍 Loading product receipts from:",`${Jt}/api/product-receipts`);const xe=await fetch(`${Jt}/api/product-receipts`);if(console.log("📡 Product receipts response status:",xe.status),!xe.ok)throw new Error(`HTTP error! status: ${xe.status}`);const je=await xe.json();return console.log("✅ Loaded product receipts:",je.length,"records"),je.map(ze=>({id:ze.id,dataPrzyjecia:ze.dataPrzyjecia,sprzedawca:ze.sprzedawca||"",wartosc:ze.wartosc||0,kosztDostawy:ze.kosztDostawy||0,products:ze.products||[],productInvoice:ze.productInvoice,transportInvoice:ze.transportInvoice}))}catch(xe){return console.error("❌ Error loading product receipts:",xe),[]}},$t=async xe=>{try{console.log("🔍 Searching working_sheets with query:",xe),console.log("📡 Making request to:",`${Jt}/api/working-sheets/search?query=${encodeURIComponent(xe)}`);const je=await fetch(`${Jt}/api/working-sheets/search?query=${encodeURIComponent(xe)}`);if(console.log("📡 Search response status:",je.status),!je.ok)throw new Error(`HTTP error! status: ${je.status}`);const ze=await je.json();return console.log("✅ Search results:",ze.length,"items found"),ze.map(et=>({kod:et.kod,nazwa:et.nazwa,ilosc:et.ilosc.toString(),kodKreskowy:et.kod_kreskowy||""}))}catch(je){return console.error("❌ Error searching working_sheets:",je),[]}},Cn=()=>{pe(xe=>xe+1)},vn=()=>{pe(xe=>xe+1)};return h.jsxs("div",{className:"min-h-screen bg-gray-100",children:[h.jsx(AR,{position:"top-right"}),h.jsx(mw,{isOpen:le,onClose:()=>re(!1),product:he}),h.jsx(IN,{isOpen:e,onClose:()=>n(!1),onUpload:He}),h.jsx(jN,{isOpen:l,onClose:()=>c(!1),fileName:g||"",onConfirm:gt}),h.jsx(zP,{isOpen:a,onClose:()=>o(!1),onSubmit:wt}),h.jsx(jR,{isOpen:t,onClose:()=>r(!1),onAdd:ht}),h.jsx(vw,{isOpen:E,onClose:()=>{j(!1),U(null)},onSubmit:rt,client:M}),h.jsx(xw,{isOpen:f,onClose:()=>p(!1),receipt:d}),h.jsx(gw,{isOpen:se,onClose:()=>{R(!1),P(null)},onSubmit:Ge,receipt:Y}),h.jsx(OR,{isOpen:Z,onClose:()=>L(!1),onOrderCreated:Cn}),h.jsx(nM,{isOpen:ne,onClose:()=>X(!1),onSubmit:vn}),h.jsx("div",{className:"bg-white shadow-sm",children:h.jsx("div",{className:"container mx-auto px-4 py-3",children:h.jsx("img",{src:IR,alt:"Enoterra Logo",className:"h-32"})})}),h.jsx("div",{className:"bg-gray-100",children:h.jsx("div",{className:"container mx-auto px-4",children:h.jsx("div",{className:"flex items-center h-14",children:h.jsx("div",{className:"flex space-x-4",children:B.map(xe=>h.jsx("div",{draggable:!0,onDragStart:()=>de(xe),onDragOver:Ee,onDrop:()=>Ne(xe),className:`relative -mb-px cursor-pointer ${I.activeTab===xe?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${k===xe?"opacity-50":""}`,onClick:()=>Le(xe),children:h.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:Mt(xe)})},xe))})})})}),h.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:h.jsxs("div",{className:"container mx-auto px-4 py-6",children:[h.jsxs("div",{className:"flex items-start -mt-2",children:[I.activeTab==="inventory"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[h.jsxs("div",{className:"flex",children:[h.jsx("button",{onClick:()=>Qe("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${I.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjęcie towaru"}),h.jsx("button",{onClick:()=>Qe("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${I.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupów"}),h.jsx("button",{onClick:()=>Qe("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${I.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz płatności"})]}),I.activeSubTab==="przyjecie"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:h.jsx(Js,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>aM(n),children:[h.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:h.jsx(v2,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),h.jsx(LR,{receipts:I.productReceipts,products:I.products,onDelete:ft,onEdit:Ft,onUpdate:Ge})]}),I.activeSubTab==="analiza"&&h.jsx("div",{className:"flex flex-col gap-4",children:h.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[h.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupów"}),h.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupów będzie dostępna wkrótce."})]})}),I.activeSubTab==="kalendarz"&&h.jsx("div",{className:"flex flex-col gap-4 mt-6",children:h.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[h.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz płatności"}),h.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza płatności będzie dostępna wkrótce."})]})})]}),I.activeTab==="inventory"&&h.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:I.sheets.map(xe=>h.jsx("div",{className:"flex items-center gap-2",children:h.jsx("button",{onClick:je=>q(xe),title:"Клик: открыть файл в новой вкладке",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:xe.fileName})},xe.fileName))}),I.activeTab==="inventory"&&I.showTable&&I.activeSheet&&h.jsx("div",{className:"mt-6 bg-white",children:h.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:h.jsx(BP,{data:I.activeSheet.data})})}),I.activeTab==="clients"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:h.jsx(Js,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),h.jsx(BR,{clients:I.clients,onDelete:Ut,onEdit:xe=>{U(xe),j(!0)},onUpdate:rt},`clients-${me}-${te||"none"}`)]}),I.activeTab==="orders"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[h.jsx("div",{className:"mb-4",children:h.jsx("div",{className:"w-1/2 mx-auto",children:h.jsx(WP,{onSearch:$t})})}),h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>L(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:h.jsx(Js,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>X(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:h.jsx(Wt,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]})]}),h.jsx(MR,{onViewOrder:xe=>{console.log("View order:",xe)},onEditOrder:xe=>{console.log("Edit order:",xe)},onDeleteOrder:xe=>{console.log("Delete order:",xe)},onUpdateOrder:Et,refreshTrigger:oe})]}),I.activeTab==="inventoryStatus"&&h.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:h.jsx(rM,{productReceipts:I.productReceipts})})]}),_&&h.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:_})]})})]})}p2.createRoot(document.getElementById("root")).render(h.jsx(A.StrictMode,{children:h.jsx(sM,{})}));
