function n2(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Vu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function a2(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var W0={exports:{}},Zi={},U0={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fx;function s2(){if(fx)return wt;fx=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),x=Symbol.iterator;function g(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function _(O,E,I){this.props=O,this.context=E,this.refs=w,this.updater=I||y}_.prototype.isReactComponent={},_.prototype.setState=function(O,E){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,E,"setState")},_.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function S(){}S.prototype=_.prototype;function P(O,E,I){this.props=O,this.context=E,this.refs=w,this.updater=I||y}var T=P.prototype=new S;T.constructor=P,k(T,_.prototype),T.isPureReactComponent=!0;var z=Array.isArray,Z=Object.prototype.hasOwnProperty,L={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function Q(O,E,I){var R,W={},ie=null,de=null;if(E!=null)for(R in E.ref!==void 0&&(de=E.ref),E.key!==void 0&&(ie=""+E.key),E)Z.call(E,R)&&!C.hasOwnProperty(R)&&(W[R]=E[R]);var he=arguments.length-2;if(he===1)W.children=I;else if(1<he){for(var oe=Array(he),ee=0;ee<he;ee++)oe[ee]=arguments[ee+2];W.children=oe}if(O&&O.defaultProps)for(R in he=O.defaultProps,he)W[R]===void 0&&(W[R]=he[R]);return{$$typeof:e,type:O,key:ie,ref:de,props:W,_owner:L.current}}function j(O,E){return{$$typeof:e,type:O.type,key:E,ref:O.ref,props:O.props,_owner:O._owner}}function te(O){return typeof O=="object"&&O!==null&&O.$$typeof===e}function X(O){var E={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(I){return E[I]})}var U=/\/+/g;function ue(O,E){return typeof O=="object"&&O!==null&&O.key!=null?X(""+O.key):E.toString(36)}function le(O,E,I,R,W){var ie=typeof O;(ie==="undefined"||ie==="boolean")&&(O=null);var de=!1;if(O===null)de=!0;else switch(ie){case"string":case"number":de=!0;break;case"object":switch(O.$$typeof){case e:case n:de=!0}}if(de)return de=O,W=W(de),O=R===""?"."+ue(de,0):R,z(W)?(I="",O!=null&&(I=O.replace(U,"$&/")+"/"),le(W,E,I,"",function(ee){return ee})):W!=null&&(te(W)&&(W=j(W,I+(!W.key||de&&de.key===W.key?"":(""+W.key).replace(U,"$&/")+"/")+O)),E.push(W)),1;if(de=0,R=R===""?".":R+":",z(O))for(var he=0;he<O.length;he++){ie=O[he];var oe=R+ue(ie,he);de+=le(ie,E,I,oe,W)}else if(oe=g(O),typeof oe=="function")for(O=oe.call(O),he=0;!(ie=O.next()).done;)ie=ie.value,oe=R+ue(ie,he++),de+=le(ie,E,I,oe,W);else if(ie==="object")throw E=String(O),Error("Objects are not valid as a React child (found: "+(E==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":E)+"). If you meant to render a collection of children, use an array instead.");return de}function ae(O,E,I){if(O==null)return O;var R=[],W=0;return le(O,R,"","",function(ie){return E.call(I,ie,W++)}),R}function pe(O){if(O._status===-1){var E=O._result;E=E(),E.then(function(I){(O._status===0||O._status===-1)&&(O._status=1,O._result=I)},function(I){(O._status===0||O._status===-1)&&(O._status=2,O._result=I)}),O._status===-1&&(O._status=0,O._result=E)}if(O._status===1)return O._result.default;throw O._result}var V={current:null},se={transition:null},M={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:se,ReactCurrentOwner:L};function H(){throw Error("act(...) is not supported in production builds of React.")}return wt.Children={map:ae,forEach:function(O,E,I){ae(O,function(){E.apply(this,arguments)},I)},count:function(O){var E=0;return ae(O,function(){E++}),E},toArray:function(O){return ae(O,function(E){return E})||[]},only:function(O){if(!te(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},wt.Component=_,wt.Fragment=t,wt.Profiler=a,wt.PureComponent=P,wt.StrictMode=r,wt.Suspense=f,wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,wt.act=H,wt.cloneElement=function(O,E,I){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var R=k({},O.props),W=O.key,ie=O.ref,de=O._owner;if(E!=null){if(E.ref!==void 0&&(ie=E.ref,de=L.current),E.key!==void 0&&(W=""+E.key),O.type&&O.type.defaultProps)var he=O.type.defaultProps;for(oe in E)Z.call(E,oe)&&!C.hasOwnProperty(oe)&&(R[oe]=E[oe]===void 0&&he!==void 0?he[oe]:E[oe])}var oe=arguments.length-2;if(oe===1)R.children=I;else if(1<oe){he=Array(oe);for(var ee=0;ee<oe;ee++)he[ee]=arguments[ee+2];R.children=he}return{$$typeof:e,type:O.type,key:W,ref:ie,props:R,_owner:de}},wt.createContext=function(O){return O={$$typeof:l,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:o,_context:O},O.Consumer=O},wt.createElement=Q,wt.createFactory=function(O){var E=Q.bind(null,O);return E.type=O,E},wt.createRef=function(){return{current:null}},wt.forwardRef=function(O){return{$$typeof:c,render:O}},wt.isValidElement=te,wt.lazy=function(O){return{$$typeof:d,_payload:{_status:-1,_result:O},_init:pe}},wt.memo=function(O,E){return{$$typeof:p,type:O,compare:E===void 0?null:E}},wt.startTransition=function(O){var E=se.transition;se.transition={};try{O()}finally{se.transition=E}},wt.unstable_act=H,wt.useCallback=function(O,E){return V.current.useCallback(O,E)},wt.useContext=function(O){return V.current.useContext(O)},wt.useDebugValue=function(){},wt.useDeferredValue=function(O){return V.current.useDeferredValue(O)},wt.useEffect=function(O,E){return V.current.useEffect(O,E)},wt.useId=function(){return V.current.useId()},wt.useImperativeHandle=function(O,E,I){return V.current.useImperativeHandle(O,E,I)},wt.useInsertionEffect=function(O,E){return V.current.useInsertionEffect(O,E)},wt.useLayoutEffect=function(O,E){return V.current.useLayoutEffect(O,E)},wt.useMemo=function(O,E){return V.current.useMemo(O,E)},wt.useReducer=function(O,E,I){return V.current.useReducer(O,E,I)},wt.useRef=function(O){return V.current.useRef(O)},wt.useState=function(O){return V.current.useState(O)},wt.useSyncExternalStore=function(O,E,I){return V.current.useSyncExternalStore(O,E,I)},wt.useTransition=function(){return V.current.useTransition()},wt.version="18.3.1",wt}var dx;function Nl(){return dx||(dx=1,U0.exports=s2()),U0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var px;function o2(){if(px)return Zi;px=1;var e=Nl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,p){var d,x={},g=null,y=null;p!==void 0&&(g=""+p),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(y=f.ref);for(d in f)r.call(f,d)&&!o.hasOwnProperty(d)&&(x[d]=f[d]);if(c&&c.defaultProps)for(d in f=c.defaultProps,f)x[d]===void 0&&(x[d]=f[d]);return{$$typeof:n,type:c,key:g,ref:y,props:x,_owner:a.current}}return Zi.Fragment=t,Zi.jsx=l,Zi.jsxs=l,Zi}var hx;function i2(){return hx||(hx=1,W0.exports=o2()),W0.exports}var h=i2(),A=Nl();const be=Vu(A),Rv=n2({__proto__:null,default:be},[A]);var $c={},H0={exports:{}},xn={},Y0={exports:{}},$0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mx;function l2(){return mx||(mx=1,(function(e){function n(se,M){var H=se.length;se.push(M);e:for(;0<H;){var O=H-1>>>1,E=se[O];if(0<a(E,M))se[O]=M,se[H]=E,H=O;else break e}}function t(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var M=se[0],H=se.pop();if(H!==M){se[0]=H;e:for(var O=0,E=se.length,I=E>>>1;O<I;){var R=2*(O+1)-1,W=se[R],ie=R+1,de=se[ie];if(0>a(W,H))ie<E&&0>a(de,W)?(se[O]=de,se[ie]=H,O=ie):(se[O]=W,se[R]=H,O=R);else if(ie<E&&0>a(de,H))se[O]=de,se[ie]=H,O=ie;else break e}}return M}function a(se,M){var H=se.sortIndex-M.sortIndex;return H!==0?H:se.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],p=[],d=1,x=null,g=3,y=!1,k=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(se){for(var M=t(p);M!==null;){if(M.callback===null)r(p);else if(M.startTime<=se)r(p),M.sortIndex=M.expirationTime,n(f,M);else break;M=t(p)}}function z(se){if(w=!1,T(se),!k)if(t(f)!==null)k=!0,pe(Z);else{var M=t(p);M!==null&&V(z,M.startTime-se)}}function Z(se,M){k=!1,w&&(w=!1,S(Q),Q=-1),y=!0;var H=g;try{for(T(M),x=t(f);x!==null&&(!(x.expirationTime>M)||se&&!X());){var O=x.callback;if(typeof O=="function"){x.callback=null,g=x.priorityLevel;var E=O(x.expirationTime<=M);M=e.unstable_now(),typeof E=="function"?x.callback=E:x===t(f)&&r(f),T(M)}else r(f);x=t(f)}if(x!==null)var I=!0;else{var R=t(p);R!==null&&V(z,R.startTime-M),I=!1}return I}finally{x=null,g=H,y=!1}}var L=!1,C=null,Q=-1,j=5,te=-1;function X(){return!(e.unstable_now()-te<j)}function U(){if(C!==null){var se=e.unstable_now();te=se;var M=!0;try{M=C(!0,se)}finally{M?ue():(L=!1,C=null)}}else L=!1}var ue;if(typeof P=="function")ue=function(){P(U)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ae=le.port2;le.port1.onmessage=U,ue=function(){ae.postMessage(null)}}else ue=function(){_(U,0)};function pe(se){C=se,L||(L=!0,ue())}function V(se,M){Q=_(function(){se(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){k||y||(k=!0,pe(Z))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(se){switch(g){case 1:case 2:case 3:var M=3;break;default:M=g}var H=g;g=M;try{return se()}finally{g=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,M){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var H=g;g=se;try{return M()}finally{g=H}},e.unstable_scheduleCallback=function(se,M,H){var O=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?O+H:O):H=O,se){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=H+E,se={id:d++,callback:M,priorityLevel:se,startTime:H,expirationTime:E,sortIndex:-1},H>O?(se.sortIndex=H,n(p,se),t(f)===null&&se===t(p)&&(w?(S(Q),Q=-1):w=!0,V(z,H-O))):(se.sortIndex=E,n(f,se),k||y||(k=!0,pe(Z))),se},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(se){var M=g;return function(){var H=g;g=M;try{return se.apply(this,arguments)}finally{g=H}}}})($0)),$0}var xx;function c2(){return xx||(xx=1,Y0.exports=l2()),Y0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function u2(){if(gx)return xn;gx=1;var e=Nl(),n=c2();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},x={};function g(s){return f.call(x,s)?!0:f.call(d,s)?!1:p.test(s)?x[s]=!0:(d[s]=!0,!1)}function y(s,i,u,m){if(u!==null&&u.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function k(s,i,u,m){if(i===null||typeof i>"u"||y(s,i,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function w(s,i,u,m,v,b,D){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=u,this.propertyName=s,this.type=i,this.sanitizeURL=b,this.removeEmptyString=D}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){_[s]=new w(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];_[i]=new w(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){_[s]=new w(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){_[s]=new w(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){_[s]=new w(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){_[s]=new w(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){_[s]=new w(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){_[s]=new w(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){_[s]=new w(s,5,!1,s.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function P(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(S,P);_[i]=new w(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(S,P);_[i]=new w(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(S,P);_[i]=new w(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!1,!1)}),_.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,i,u,m){var v=_.hasOwnProperty(i)?_[i]:null;(v!==null?v.type!==0:m||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,u,v,m)&&(u=null),m||v===null?g(i)&&(u===null?s.removeAttribute(i):s.setAttribute(i,""+u)):v.mustUseProperty?s[v.propertyName]=u===null?v.type===3?!1:"":u:(i=v.attributeName,m=v.attributeNamespace,u===null?s.removeAttribute(i):(v=v.type,u=v===3||v===4&&u===!0?"":""+u,m?s.setAttributeNS(m,i,u):s.setAttribute(i,u))))}var z=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Z=Symbol.for("react.element"),L=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),X=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),se=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=se&&s[se]||s["@@iterator"],typeof s=="function"?s:null)}var H=Object.assign,O;function E(s){if(O===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);O=i&&i[1]||""}return`
`+O+s}var I=!1;function R(s,i){if(!s||I)return"";I=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(_e){var m=_e}Reflect.construct(s,[],i)}else{try{i.call()}catch(_e){m=_e}s.call(i.prototype)}else{try{throw Error()}catch(_e){m=_e}s()}}catch(_e){if(_e&&m&&typeof _e.stack=="string"){for(var v=_e.stack.split(`
`),b=m.stack.split(`
`),D=v.length-1,J=b.length-1;1<=D&&0<=J&&v[D]!==b[J];)J--;for(;1<=D&&0<=J;D--,J--)if(v[D]!==b[J]){if(D!==1||J!==1)do if(D--,J--,0>J||v[D]!==b[J]){var ce=`
`+v[D].replace(" at new "," at ");return s.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",s.displayName)),ce}while(1<=D&&0<=J);break}}}finally{I=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?E(s):""}function W(s){switch(s.tag){case 5:return E(s.type);case 16:return E("Lazy");case 13:return E("Suspense");case 19:return E("SuspenseList");case 0:case 2:case 15:return s=R(s.type,!1),s;case 11:return s=R(s.type.render,!1),s;case 1:return s=R(s.type,!0),s;default:return""}}function ie(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case L:return"Portal";case j:return"Profiler";case Q:return"StrictMode";case ue:return"Suspense";case le:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case X:return(s.displayName||"Context")+".Consumer";case te:return(s._context.displayName||"Context")+".Provider";case U:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ae:return i=s.displayName||null,i!==null?i:ie(s.type)||"Memo";case pe:i=s._payload,s=s._init;try{return ie(s(i))}catch{}}return null}function de(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ie(i);case 8:return i===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function he(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function oe(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ee(s){var i=oe(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),m=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,b=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return v.call(this)},set:function(D){m=""+D,b.call(this,D)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(D){m=""+D},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function re(s){s._valueTracker||(s._valueTracker=ee(s))}function F(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),m="";return s&&(m=oe(s)?s.checked?"true":"false":s.value),s=m,s!==u?(i.setValue(s),!0):!1}function Ce(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function De(s,i){var u=i.checked;return H({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function Ve(s,i){var u=i.defaultValue==null?"":i.defaultValue,m=i.checked!=null?i.checked:i.defaultChecked;u=he(i.value!=null?i.value:u),s._wrapperState={initialChecked:m,initialValue:u,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function He(s,i){i=i.checked,i!=null&&T(s,"checked",i,!1)}function Ie(s,i){He(s,i);var u=he(i.value),m=i.type;if(u!=null)m==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?Se(s,i.type,u):i.hasOwnProperty("defaultValue")&&Se(s,i.type,he(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function ne(s,i,u){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var m=i.type;if(!(m!=="submit"&&m!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,u||i===s.value||(s.value=i),s.defaultValue=i}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function Se(s,i,u){(i!=="number"||Ce(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var Ee=Array.isArray;function Fe(s,i,u,m){if(s=s.options,i){i={};for(var v=0;v<u.length;v++)i["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=i.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&m&&(s[u].defaultSelected=!0)}else{for(u=""+he(u),i=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,m&&(s[v].defaultSelected=!0);return}i!==null||s[v].disabled||(i=s[v])}i!==null&&(i.selected=!0)}}function qe(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return H({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function it(s,i){var u=i.value;if(u==null){if(u=i.children,i=i.defaultValue,u!=null){if(i!=null)throw Error(t(92));if(Ee(u)){if(1<u.length)throw Error(t(93));u=u[0]}i=u}i==null&&(i=""),u=i}s._wrapperState={initialValue:he(u)}}function kt(s,i){var u=he(i.value),m=he(i.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),i.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),m!=null&&(s.defaultValue=""+m)}function bt(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Rt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ot(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Rt(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var ht,Tt=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,u,m,v){MSApp.execUnsafeLocalFunction(function(){return s(i,u,m,v)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(ht=ht||document.createElement("div"),ht.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=ht.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function et(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var vt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xt=["Webkit","ms","Moz","O"];Object.keys(vt).forEach(function(s){xt.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),vt[i]=vt[s]})});function pt(s,i,u){return i==null||typeof i=="boolean"||i===""?"":u||typeof i!="number"||i===0||vt.hasOwnProperty(s)&&vt[s]?(""+i).trim():i+"px"}function Mt(s,i){s=s.style;for(var u in i)if(i.hasOwnProperty(u)){var m=u.indexOf("--")===0,v=pt(u,i[u],m);u==="float"&&(u="cssFloat"),m?s.setProperty(u,v):s[u]=v}}var $t=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Cn(s,i){if(i){if($t[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function vn(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var me=null;function Le(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ze=null,Ke=null,tt=null;function Ct(s){if(s=ji(s)){if(typeof ze!="function")throw Error(t(280));var i=s.stateNode;i&&(i=oc(i),ze(s.stateNode,s.type,i))}}function zt(s){Ke?tt?tt.push(s):tt=[s]:Ke=s}function Vt(){if(Ke){var s=Ke,i=tt;if(tt=Ke=null,Ct(s),i)for(s=0;s<i.length;s++)Ct(i[s])}}function wr(s,i){return s(i)}function nt(){}var gt=!1;function Tr(s,i,u){if(gt)return s(i,u);gt=!0;try{return wr(s,i,u)}finally{gt=!1,(Ke!==null||tt!==null)&&(nt(),Vt())}}function Zr(s,i){var u=s.stateNode;if(u===null)return null;var m=oc(u);if(m===null)return null;u=m[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,i,typeof u));return u}var Ue=!1;if(c)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{Ue=!1}function ut(s,i,u,m,v,b,D,J,ce){var _e=Array.prototype.slice.call(arguments,3);try{i.apply(u,_e)}catch(Ae){this.onError(Ae)}}var Kt=!1,rr=null,N=!1,G=null,B={onError:function(s){Kt=!0,rr=s}};function Y(s,i,u,m,v,b,D,J,ce){Kt=!1,rr=null,ut.apply(B,arguments)}function K(s,i,u,m,v,b,D,J,ce){if(Y.apply(this,arguments),Kt){if(Kt){var _e=rr;Kt=!1,rr=null}else throw Error(t(198));N||(N=!0,G=_e)}}function q(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function ve(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Te(s){if(q(s)!==s)throw Error(t(188))}function ge(s){var i=s.alternate;if(!i){if(i=q(s),i===null)throw Error(t(188));return i!==s?null:s}for(var u=s,m=i;;){var v=u.return;if(v===null)break;var b=v.alternate;if(b===null){if(m=v.return,m!==null){u=m;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===u)return Te(v),s;if(b===m)return Te(v),i;b=b.sibling}throw Error(t(188))}if(u.return!==m.return)u=v,m=b;else{for(var D=!1,J=v.child;J;){if(J===u){D=!0,u=v,m=b;break}if(J===m){D=!0,m=v,u=b;break}J=J.sibling}if(!D){for(J=b.child;J;){if(J===u){D=!0,u=b,m=v;break}if(J===m){D=!0,m=b,u=v;break}J=J.sibling}if(!D)throw Error(t(189))}}if(u.alternate!==m)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:i}function we(s){return s=ge(s),s!==null?ke(s):null}function ke(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=ke(s);if(i!==null)return i;s=s.sibling}return null}var Oe=n.unstable_scheduleCallback,We=n.unstable_cancelCallback,Pe=n.unstable_shouldYield,Re=n.unstable_requestPaint,Me=n.unstable_now,lt=n.unstable_getCurrentPriorityLevel,Bt=n.unstable_ImmediatePriority,jt=n.unstable_UserBlockingPriority,ur=n.unstable_NormalPriority,Rs=n.unstable_LowPriority,Qa=n.unstable_IdlePriority,la=null,Cr=null;function vi(s){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(la,s,void 0,(s.current.flags&128)===128)}catch{}}var fr=Math.clz32?Math.clz32:kw,yw=Math.log,ww=Math.LN2;function kw(s){return s>>>=0,s===0?32:31-(yw(s)/ww|0)|0}var Ul=64,Hl=4194304;function yi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Yl(s,i){var u=s.pendingLanes;if(u===0)return 0;var m=0,v=s.suspendedLanes,b=s.pingedLanes,D=u&268435455;if(D!==0){var J=D&~v;J!==0?m=yi(J):(b&=D,b!==0&&(m=yi(b)))}else D=u&~v,D!==0?m=yi(D):b!==0&&(m=yi(b));if(m===0)return 0;if(i!==0&&i!==m&&(i&v)===0&&(v=m&-m,b=i&-i,v>=b||v===16&&(b&4194240)!==0))return i;if((m&4)!==0&&(m|=u&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=m;0<i;)u=31-fr(i),v=1<<u,m|=s[u],i&=~v;return m}function _w(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bw(s,i){for(var u=s.suspendedLanes,m=s.pingedLanes,v=s.expirationTimes,b=s.pendingLanes;0<b;){var D=31-fr(b),J=1<<D,ce=v[D];ce===-1?((J&u)===0||(J&m)!==0)&&(v[D]=_w(J,i)):ce<=i&&(s.expiredLanes|=J),b&=~J}}function lf(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Up(){var s=Ul;return Ul<<=1,(Ul&4194240)===0&&(Ul=64),s}function cf(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function wi(s,i,u){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-fr(i),s[i]=u}function Ew(s,i){var u=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<u;){var v=31-fr(u),b=1<<v;i[v]=0,m[v]=-1,s[v]=-1,u&=~b}}function uf(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var m=31-fr(u),v=1<<m;v&i|s[m]&i&&(s[m]|=i),u&=~v}}var Wt=0;function Hp(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Yp,ff,$p,Vp,Kp,df=!1,$l=[],qa=null,Za=null,Ja=null,ki=new Map,_i=new Map,es=[],Sw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gp(s,i){switch(s){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":Ja=null;break;case"pointerover":case"pointerout":ki.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":_i.delete(i.pointerId)}}function bi(s,i,u,m,v,b){return s===null||s.nativeEvent!==b?(s={blockedOn:i,domEventName:u,eventSystemFlags:m,nativeEvent:b,targetContainers:[v]},i!==null&&(i=ji(i),i!==null&&ff(i)),s):(s.eventSystemFlags|=m,i=s.targetContainers,v!==null&&i.indexOf(v)===-1&&i.push(v),s)}function Tw(s,i,u,m,v){switch(i){case"focusin":return qa=bi(qa,s,i,u,m,v),!0;case"dragenter":return Za=bi(Za,s,i,u,m,v),!0;case"mouseover":return Ja=bi(Ja,s,i,u,m,v),!0;case"pointerover":var b=v.pointerId;return ki.set(b,bi(ki.get(b)||null,s,i,u,m,v)),!0;case"gotpointercapture":return b=v.pointerId,_i.set(b,bi(_i.get(b)||null,s,i,u,m,v)),!0}return!1}function Xp(s){var i=Ms(s.target);if(i!==null){var u=q(i);if(u!==null){if(i=u.tag,i===13){if(i=ve(u),i!==null){s.blockedOn=i,Kp(s.priority,function(){$p(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Vl(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=hf(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var m=new u.constructor(u.type,u);me=m,u.target.dispatchEvent(m),me=null}else return i=ji(u),i!==null&&ff(i),s.blockedOn=u,!1;i.shift()}return!0}function Qp(s,i,u){Vl(s)&&u.delete(i)}function Cw(){df=!1,qa!==null&&Vl(qa)&&(qa=null),Za!==null&&Vl(Za)&&(Za=null),Ja!==null&&Vl(Ja)&&(Ja=null),ki.forEach(Qp),_i.forEach(Qp)}function Ei(s,i){s.blockedOn===i&&(s.blockedOn=null,df||(df=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Cw)))}function Si(s){function i(v){return Ei(v,s)}if(0<$l.length){Ei($l[0],s);for(var u=1;u<$l.length;u++){var m=$l[u];m.blockedOn===s&&(m.blockedOn=null)}}for(qa!==null&&Ei(qa,s),Za!==null&&Ei(Za,s),Ja!==null&&Ei(Ja,s),ki.forEach(i),_i.forEach(i),u=0;u<es.length;u++)m=es[u],m.blockedOn===s&&(m.blockedOn=null);for(;0<es.length&&(u=es[0],u.blockedOn===null);)Xp(u),u.blockedOn===null&&es.shift()}var _o=z.ReactCurrentBatchConfig,Kl=!0;function Dw(s,i,u,m){var v=Wt,b=_o.transition;_o.transition=null;try{Wt=1,pf(s,i,u,m)}finally{Wt=v,_o.transition=b}}function Nw(s,i,u,m){var v=Wt,b=_o.transition;_o.transition=null;try{Wt=4,pf(s,i,u,m)}finally{Wt=v,_o.transition=b}}function pf(s,i,u,m){if(Kl){var v=hf(s,i,u,m);if(v===null)Af(s,i,m,Gl,u),Gp(s,m);else if(Tw(v,s,i,u,m))m.stopPropagation();else if(Gp(s,m),i&4&&-1<Sw.indexOf(s)){for(;v!==null;){var b=ji(v);if(b!==null&&Yp(b),b=hf(s,i,u,m),b===null&&Af(s,i,m,Gl,u),b===v)break;v=b}v!==null&&m.stopPropagation()}else Af(s,i,m,null,u)}}var Gl=null;function hf(s,i,u,m){if(Gl=null,s=Le(m),s=Ms(s),s!==null)if(i=q(s),i===null)s=null;else if(u=i.tag,u===13){if(s=ve(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return Gl=s,null}function qp(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lt()){case Bt:return 1;case jt:return 4;case ur:case Rs:return 16;case Qa:return 536870912;default:return 16}default:return 16}}var ts=null,mf=null,Xl=null;function Zp(){if(Xl)return Xl;var s,i=mf,u=i.length,m,v="value"in ts?ts.value:ts.textContent,b=v.length;for(s=0;s<u&&i[s]===v[s];s++);var D=u-s;for(m=1;m<=D&&i[u-m]===v[b-m];m++);return Xl=v.slice(s,1<m?1-m:void 0)}function Ql(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ql(){return!0}function Jp(){return!1}function yn(s){function i(u,m,v,b,D){this._reactName=u,this._targetInst=v,this.type=m,this.nativeEvent=b,this.target=D,this.currentTarget=null;for(var J in s)s.hasOwnProperty(J)&&(u=s[J],this[J]=u?u(b):b[J]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?ql:Jp,this.isPropagationStopped=Jp,this}return H(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),i}var bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xf=yn(bo),Ti=H({},bo,{view:0,detail:0}),Fw=yn(Ti),gf,vf,Ci,Zl=H({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ci&&(Ci&&s.type==="mousemove"?(gf=s.screenX-Ci.screenX,vf=s.screenY-Ci.screenY):vf=gf=0,Ci=s),gf)},movementY:function(s){return"movementY"in s?s.movementY:vf}}),eh=yn(Zl),Aw=H({},Zl,{dataTransfer:0}),Ow=yn(Aw),Pw=H({},Ti,{relatedTarget:0}),yf=yn(Pw),Rw=H({},bo,{animationName:0,elapsedTime:0,pseudoElement:0}),Mw=yn(Rw),Iw=H({},bo,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),jw=yn(Iw),Lw=H({},bo,{data:0}),th=yn(Lw),zw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ww={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Uw(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Ww[s])?!!i[s]:!1}function wf(){return Uw}var Hw=H({},Ti,{key:function(s){if(s.key){var i=zw[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ql(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Bw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wf,charCode:function(s){return s.type==="keypress"?Ql(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ql(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yw=yn(Hw),$w=H({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rh=yn($w),Vw=H({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wf}),Kw=yn(Vw),Gw=H({},bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xw=yn(Gw),Qw=H({},Zl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),qw=yn(Qw),Zw=[9,13,27,32],kf=c&&"CompositionEvent"in window,Di=null;c&&"documentMode"in document&&(Di=document.documentMode);var Jw=c&&"TextEvent"in window&&!Di,nh=c&&(!kf||Di&&8<Di&&11>=Di),ah=" ",sh=!1;function oh(s,i){switch(s){case"keyup":return Zw.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ih(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Eo=!1;function ek(s,i){switch(s){case"compositionend":return ih(i);case"keypress":return i.which!==32?null:(sh=!0,ah);case"textInput":return s=i.data,s===ah&&sh?null:s;default:return null}}function tk(s,i){if(Eo)return s==="compositionend"||!kf&&oh(s,i)?(s=Zp(),Xl=mf=ts=null,Eo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return nh&&i.locale!=="ko"?null:i.data;default:return null}}var rk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!rk[s.type]:i==="textarea"}function ch(s,i,u,m){zt(m),i=nc(i,"onChange"),0<i.length&&(u=new xf("onChange","change",null,u,m),s.push({event:u,listeners:i}))}var Ni=null,Fi=null;function nk(s){Ch(s,0)}function Jl(s){var i=No(s);if(F(i))return s}function ak(s,i){if(s==="change")return i}var uh=!1;if(c){var _f;if(c){var bf="oninput"in document;if(!bf){var fh=document.createElement("div");fh.setAttribute("oninput","return;"),bf=typeof fh.oninput=="function"}_f=bf}else _f=!1;uh=_f&&(!document.documentMode||9<document.documentMode)}function dh(){Ni&&(Ni.detachEvent("onpropertychange",ph),Fi=Ni=null)}function ph(s){if(s.propertyName==="value"&&Jl(Fi)){var i=[];ch(i,Fi,s,Le(s)),Tr(nk,i)}}function sk(s,i,u){s==="focusin"?(dh(),Ni=i,Fi=u,Ni.attachEvent("onpropertychange",ph)):s==="focusout"&&dh()}function ok(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Jl(Fi)}function ik(s,i){if(s==="click")return Jl(i)}function lk(s,i){if(s==="input"||s==="change")return Jl(i)}function ck(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var $n=typeof Object.is=="function"?Object.is:ck;function Ai(s,i){if($n(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),m=Object.keys(i);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var v=u[m];if(!f.call(i,v)||!$n(s[v],i[v]))return!1}return!0}function hh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function mh(s,i){var u=hh(s);s=0;for(var m;u;){if(u.nodeType===3){if(m=s+u.textContent.length,s<=i&&m>=i)return{node:u,offset:i-s};s=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=hh(u)}}function xh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?xh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function gh(){for(var s=window,i=Ce();i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Ce(s.document)}return i}function Ef(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function uk(s){var i=gh(),u=s.focusedElem,m=s.selectionRange;if(i!==u&&u&&u.ownerDocument&&xh(u.ownerDocument.documentElement,u)){if(m!==null&&Ef(u)){if(i=m.start,s=m.end,s===void 0&&(s=i),"selectionStart"in u)u.selectionStart=i,u.selectionEnd=Math.min(s,u.value.length);else if(s=(i=u.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var v=u.textContent.length,b=Math.min(m.start,v);m=m.end===void 0?b:Math.min(m.end,v),!s.extend&&b>m&&(v=m,m=b,b=v),v=mh(u,b);var D=mh(u,m);v&&D&&(s.rangeCount!==1||s.anchorNode!==v.node||s.anchorOffset!==v.offset||s.focusNode!==D.node||s.focusOffset!==D.offset)&&(i=i.createRange(),i.setStart(v.node,v.offset),s.removeAllRanges(),b>m?(s.addRange(i),s.extend(D.node,D.offset)):(i.setEnd(D.node,D.offset),s.addRange(i)))}}for(i=[],s=u;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<i.length;u++)s=i[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var fk=c&&"documentMode"in document&&11>=document.documentMode,So=null,Sf=null,Oi=null,Tf=!1;function vh(s,i,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Tf||So==null||So!==Ce(m)||(m=So,"selectionStart"in m&&Ef(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Oi&&Ai(Oi,m)||(Oi=m,m=nc(Sf,"onSelect"),0<m.length&&(i=new xf("onSelect","select",null,i,u),s.push({event:i,listeners:m}),i.target=So)))}function ec(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var To={animationend:ec("Animation","AnimationEnd"),animationiteration:ec("Animation","AnimationIteration"),animationstart:ec("Animation","AnimationStart"),transitionend:ec("Transition","TransitionEnd")},Cf={},yh={};c&&(yh=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function tc(s){if(Cf[s])return Cf[s];if(!To[s])return s;var i=To[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in yh)return Cf[s]=i[u];return s}var wh=tc("animationend"),kh=tc("animationiteration"),_h=tc("animationstart"),bh=tc("transitionend"),Eh=new Map,Sh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(s,i){Eh.set(s,i),o(i,[s])}for(var Df=0;Df<Sh.length;Df++){var Nf=Sh[Df],dk=Nf.toLowerCase(),pk=Nf[0].toUpperCase()+Nf.slice(1);rs(dk,"on"+pk)}rs(wh,"onAnimationEnd"),rs(kh,"onAnimationIteration"),rs(_h,"onAnimationStart"),rs("dblclick","onDoubleClick"),rs("focusin","onFocus"),rs("focusout","onBlur"),rs(bh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function Th(s,i,u){var m=s.type||"unknown-event";s.currentTarget=u,K(m,i,void 0,s),s.currentTarget=null}function Ch(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var m=s[u],v=m.event;m=m.listeners;e:{var b=void 0;if(i)for(var D=m.length-1;0<=D;D--){var J=m[D],ce=J.instance,_e=J.currentTarget;if(J=J.listener,ce!==b&&v.isPropagationStopped())break e;Th(v,J,_e),b=ce}else for(D=0;D<m.length;D++){if(J=m[D],ce=J.instance,_e=J.currentTarget,J=J.listener,ce!==b&&v.isPropagationStopped())break e;Th(v,J,_e),b=ce}}}if(N)throw s=G,N=!1,G=null,s}function Qt(s,i){var u=i[jf];u===void 0&&(u=i[jf]=new Set);var m=s+"__bubble";u.has(m)||(Dh(i,s,2,!1),u.add(m))}function Ff(s,i,u){var m=0;i&&(m|=4),Dh(u,s,m,i)}var rc="_reactListening"+Math.random().toString(36).slice(2);function Ri(s){if(!s[rc]){s[rc]=!0,r.forEach(function(u){u!=="selectionchange"&&(hk.has(u)||Ff(u,!1,s),Ff(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[rc]||(i[rc]=!0,Ff("selectionchange",!1,i))}}function Dh(s,i,u,m){switch(qp(i)){case 1:var v=Dw;break;case 4:v=Nw;break;default:v=pf}u=v.bind(null,i,u,s),v=void 0,!Ue||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(v=!0),m?v!==void 0?s.addEventListener(i,u,{capture:!0,passive:v}):s.addEventListener(i,u,!0):v!==void 0?s.addEventListener(i,u,{passive:v}):s.addEventListener(i,u,!1)}function Af(s,i,u,m,v){var b=m;if((i&1)===0&&(i&2)===0&&m!==null)e:for(;;){if(m===null)return;var D=m.tag;if(D===3||D===4){var J=m.stateNode.containerInfo;if(J===v||J.nodeType===8&&J.parentNode===v)break;if(D===4)for(D=m.return;D!==null;){var ce=D.tag;if((ce===3||ce===4)&&(ce=D.stateNode.containerInfo,ce===v||ce.nodeType===8&&ce.parentNode===v))return;D=D.return}for(;J!==null;){if(D=Ms(J),D===null)return;if(ce=D.tag,ce===5||ce===6){m=b=D;continue e}J=J.parentNode}}m=m.return}Tr(function(){var _e=b,Ae=Le(u),je=[];e:{var Ne=Eh.get(s);if(Ne!==void 0){var $e=xf,Xe=s;switch(s){case"keypress":if(Ql(u)===0)break e;case"keydown":case"keyup":$e=Yw;break;case"focusin":Xe="focus",$e=yf;break;case"focusout":Xe="blur",$e=yf;break;case"beforeblur":case"afterblur":$e=yf;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=eh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=Ow;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=Kw;break;case wh:case kh:case _h:$e=Mw;break;case bh:$e=Xw;break;case"scroll":$e=Fw;break;case"wheel":$e=qw;break;case"copy":case"cut":case"paste":$e=jw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=rh}var Qe=(i&4)!==0,dr=!Qe&&s==="scroll",xe=Qe?Ne!==null?Ne+"Capture":null:Ne;Qe=[];for(var fe=_e,ye;fe!==null;){ye=fe;var Be=ye.stateNode;if(ye.tag===5&&Be!==null&&(ye=Be,xe!==null&&(Be=Zr(fe,xe),Be!=null&&Qe.push(Mi(fe,Be,ye)))),dr)break;fe=fe.return}0<Qe.length&&(Ne=new $e(Ne,Xe,null,u,Ae),je.push({event:Ne,listeners:Qe}))}}if((i&7)===0){e:{if(Ne=s==="mouseover"||s==="pointerover",$e=s==="mouseout"||s==="pointerout",Ne&&u!==me&&(Xe=u.relatedTarget||u.fromElement)&&(Ms(Xe)||Xe[Fa]))break e;if(($e||Ne)&&(Ne=Ae.window===Ae?Ae:(Ne=Ae.ownerDocument)?Ne.defaultView||Ne.parentWindow:window,$e?(Xe=u.relatedTarget||u.toElement,$e=_e,Xe=Xe?Ms(Xe):null,Xe!==null&&(dr=q(Xe),Xe!==dr||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):($e=null,Xe=_e),$e!==Xe)){if(Qe=eh,Be="onMouseLeave",xe="onMouseEnter",fe="mouse",(s==="pointerout"||s==="pointerover")&&(Qe=rh,Be="onPointerLeave",xe="onPointerEnter",fe="pointer"),dr=$e==null?Ne:No($e),ye=Xe==null?Ne:No(Xe),Ne=new Qe(Be,fe+"leave",$e,u,Ae),Ne.target=dr,Ne.relatedTarget=ye,Be=null,Ms(Ae)===_e&&(Qe=new Qe(xe,fe+"enter",Xe,u,Ae),Qe.target=ye,Qe.relatedTarget=dr,Be=Qe),dr=Be,$e&&Xe)t:{for(Qe=$e,xe=Xe,fe=0,ye=Qe;ye;ye=Co(ye))fe++;for(ye=0,Be=xe;Be;Be=Co(Be))ye++;for(;0<fe-ye;)Qe=Co(Qe),fe--;for(;0<ye-fe;)xe=Co(xe),ye--;for(;fe--;){if(Qe===xe||xe!==null&&Qe===xe.alternate)break t;Qe=Co(Qe),xe=Co(xe)}Qe=null}else Qe=null;$e!==null&&Nh(je,Ne,$e,Qe,!1),Xe!==null&&dr!==null&&Nh(je,dr,Xe,Qe,!0)}}e:{if(Ne=_e?No(_e):window,$e=Ne.nodeName&&Ne.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Ne.type==="file")var Ze=ak;else if(lh(Ne))if(uh)Ze=lk;else{Ze=ok;var st=sk}else($e=Ne.nodeName)&&$e.toLowerCase()==="input"&&(Ne.type==="checkbox"||Ne.type==="radio")&&(Ze=ik);if(Ze&&(Ze=Ze(s,_e))){ch(je,Ze,u,Ae);break e}st&&st(s,Ne,_e),s==="focusout"&&(st=Ne._wrapperState)&&st.controlled&&Ne.type==="number"&&Se(Ne,"number",Ne.value)}switch(st=_e?No(_e):window,s){case"focusin":(lh(st)||st.contentEditable==="true")&&(So=st,Sf=_e,Oi=null);break;case"focusout":Oi=Sf=So=null;break;case"mousedown":Tf=!0;break;case"contextmenu":case"mouseup":case"dragend":Tf=!1,vh(je,u,Ae);break;case"selectionchange":if(fk)break;case"keydown":case"keyup":vh(je,u,Ae)}var ot;if(kf)e:{switch(s){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else Eo?oh(s,u)&&(ft="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(ft="onCompositionStart");ft&&(nh&&u.locale!=="ko"&&(Eo||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&Eo&&(ot=Zp()):(ts=Ae,mf="value"in ts?ts.value:ts.textContent,Eo=!0)),st=nc(_e,ft),0<st.length&&(ft=new th(ft,s,null,u,Ae),je.push({event:ft,listeners:st}),ot?ft.data=ot:(ot=ih(u),ot!==null&&(ft.data=ot)))),(ot=Jw?ek(s,u):tk(s,u))&&(_e=nc(_e,"onBeforeInput"),0<_e.length&&(Ae=new th("onBeforeInput","beforeinput",null,u,Ae),je.push({event:Ae,listeners:_e}),Ae.data=ot))}Ch(je,i)})}function Mi(s,i,u){return{instance:s,listener:i,currentTarget:u}}function nc(s,i){for(var u=i+"Capture",m=[];s!==null;){var v=s,b=v.stateNode;v.tag===5&&b!==null&&(v=b,b=Zr(s,u),b!=null&&m.unshift(Mi(s,b,v)),b=Zr(s,i),b!=null&&m.push(Mi(s,b,v))),s=s.return}return m}function Co(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Nh(s,i,u,m,v){for(var b=i._reactName,D=[];u!==null&&u!==m;){var J=u,ce=J.alternate,_e=J.stateNode;if(ce!==null&&ce===m)break;J.tag===5&&_e!==null&&(J=_e,v?(ce=Zr(u,b),ce!=null&&D.unshift(Mi(u,ce,J))):v||(ce=Zr(u,b),ce!=null&&D.push(Mi(u,ce,J)))),u=u.return}D.length!==0&&s.push({event:i,listeners:D})}var mk=/\r\n?/g,xk=/\u0000|\uFFFD/g;function Fh(s){return(typeof s=="string"?s:""+s).replace(mk,`
`).replace(xk,"")}function ac(s,i,u){if(i=Fh(i),Fh(s)!==i&&u)throw Error(t(425))}function sc(){}var Of=null,Pf=null;function Rf(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Mf=typeof setTimeout=="function"?setTimeout:void 0,gk=typeof clearTimeout=="function"?clearTimeout:void 0,Ah=typeof Promise=="function"?Promise:void 0,vk=typeof queueMicrotask=="function"?queueMicrotask:typeof Ah<"u"?function(s){return Ah.resolve(null).then(s).catch(yk)}:Mf;function yk(s){setTimeout(function(){throw s})}function If(s,i){var u=i,m=0;do{var v=u.nextSibling;if(s.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(m===0){s.removeChild(v),Si(i);return}m--}else u!=="$"&&u!=="$?"&&u!=="$!"||m++;u=v}while(u);Si(i)}function ns(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Oh(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}var Do=Math.random().toString(36).slice(2),ca="__reactFiber$"+Do,Ii="__reactProps$"+Do,Fa="__reactContainer$"+Do,jf="__reactEvents$"+Do,wk="__reactListeners$"+Do,kk="__reactHandles$"+Do;function Ms(s){var i=s[ca];if(i)return i;for(var u=s.parentNode;u;){if(i=u[Fa]||u[ca]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=Oh(s);s!==null;){if(u=s[ca])return u;s=Oh(s)}return i}s=u,u=s.parentNode}return null}function ji(s){return s=s[ca]||s[Fa],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function No(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function oc(s){return s[Ii]||null}var Lf=[],Fo=-1;function as(s){return{current:s}}function qt(s){0>Fo||(s.current=Lf[Fo],Lf[Fo]=null,Fo--)}function Gt(s,i){Fo++,Lf[Fo]=s.current,s.current=i}var ss={},Wr=as(ss),fn=as(!1),Is=ss;function Ao(s,i){var u=s.type.contextTypes;if(!u)return ss;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===i)return m.__reactInternalMemoizedMaskedChildContext;var v={},b;for(b in u)v[b]=i[b];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=v),v}function dn(s){return s=s.childContextTypes,s!=null}function ic(){qt(fn),qt(Wr)}function Ph(s,i,u){if(Wr.current!==ss)throw Error(t(168));Gt(Wr,i),Gt(fn,u)}function Rh(s,i,u){var m=s.stateNode;if(i=i.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var v in m)if(!(v in i))throw Error(t(108,de(s)||"Unknown",v));return H({},u,m)}function lc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ss,Is=Wr.current,Gt(Wr,s),Gt(fn,fn.current),!0}function Mh(s,i,u){var m=s.stateNode;if(!m)throw Error(t(169));u?(s=Rh(s,i,Is),m.__reactInternalMemoizedMergedChildContext=s,qt(fn),qt(Wr),Gt(Wr,s)):qt(fn),Gt(fn,u)}var Aa=null,cc=!1,zf=!1;function Ih(s){Aa===null?Aa=[s]:Aa.push(s)}function _k(s){cc=!0,Ih(s)}function os(){if(!zf&&Aa!==null){zf=!0;var s=0,i=Wt;try{var u=Aa;for(Wt=1;s<u.length;s++){var m=u[s];do m=m(!0);while(m!==null)}Aa=null,cc=!1}catch(v){throw Aa!==null&&(Aa=Aa.slice(s+1)),Oe(Bt,os),v}finally{Wt=i,zf=!1}}return null}var Oo=[],Po=0,uc=null,fc=0,Dn=[],Nn=0,js=null,Oa=1,Pa="";function Ls(s,i){Oo[Po++]=fc,Oo[Po++]=uc,uc=s,fc=i}function jh(s,i,u){Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,js=s;var m=Oa;s=Pa;var v=32-fr(m)-1;m&=~(1<<v),u+=1;var b=32-fr(i)+v;if(30<b){var D=v-v%5;b=(m&(1<<D)-1).toString(32),m>>=D,v-=D,Oa=1<<32-fr(i)+v|u<<v|m,Pa=b+s}else Oa=1<<b|u<<v|m,Pa=s}function Bf(s){s.return!==null&&(Ls(s,1),jh(s,1,0))}function Wf(s){for(;s===uc;)uc=Oo[--Po],Oo[Po]=null,fc=Oo[--Po],Oo[Po]=null;for(;s===js;)js=Dn[--Nn],Dn[Nn]=null,Pa=Dn[--Nn],Dn[Nn]=null,Oa=Dn[--Nn],Dn[Nn]=null}var wn=null,kn=null,Zt=!1,Vn=null;function Lh(s,i){var u=Pn(5,null,null,0);u.elementType="DELETED",u.stateNode=i,u.return=s,i=s.deletions,i===null?(s.deletions=[u],s.flags|=16):i.push(u)}function zh(s,i){switch(s.tag){case 5:var u=s.type;return i=i.nodeType!==1||u.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,wn=s,kn=ns(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,wn=s,kn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(u=js!==null?{id:Oa,overflow:Pa}:null,s.memoizedState={dehydrated:i,treeContext:u,retryLane:1073741824},u=Pn(18,null,null,0),u.stateNode=i,u.return=s,s.child=u,wn=s,kn=null,!0):!1;default:return!1}}function Uf(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Hf(s){if(Zt){var i=kn;if(i){var u=i;if(!zh(s,i)){if(Uf(s))throw Error(t(418));i=ns(u.nextSibling);var m=wn;i&&zh(s,i)?Lh(m,u):(s.flags=s.flags&-4097|2,Zt=!1,wn=s)}}else{if(Uf(s))throw Error(t(418));s.flags=s.flags&-4097|2,Zt=!1,wn=s}}}function Bh(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;wn=s}function dc(s){if(s!==wn)return!1;if(!Zt)return Bh(s),Zt=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Rf(s.type,s.memoizedProps)),i&&(i=kn)){if(Uf(s))throw Wh(),Error(t(418));for(;i;)Lh(s,i),i=ns(i.nextSibling)}if(Bh(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(i===0){kn=ns(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++}s=s.nextSibling}kn=null}}else kn=wn?ns(s.stateNode.nextSibling):null;return!0}function Wh(){for(var s=kn;s;)s=ns(s.nextSibling)}function Ro(){kn=wn=null,Zt=!1}function Yf(s){Vn===null?Vn=[s]:Vn.push(s)}var bk=z.ReactCurrentBatchConfig;function Li(s,i,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var m=u.stateNode}if(!m)throw Error(t(147,s));var v=m,b=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function(D){var J=v.refs;D===null?delete J[b]:J[b]=D},i._stringRef=b,i)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function pc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Uh(s){var i=s._init;return i(s._payload)}function Hh(s){function i(xe,fe){if(s){var ye=xe.deletions;ye===null?(xe.deletions=[fe],xe.flags|=16):ye.push(fe)}}function u(xe,fe){if(!s)return null;for(;fe!==null;)i(xe,fe),fe=fe.sibling;return null}function m(xe,fe){for(xe=new Map;fe!==null;)fe.key!==null?xe.set(fe.key,fe):xe.set(fe.index,fe),fe=fe.sibling;return xe}function v(xe,fe){return xe=hs(xe,fe),xe.index=0,xe.sibling=null,xe}function b(xe,fe,ye){return xe.index=ye,s?(ye=xe.alternate,ye!==null?(ye=ye.index,ye<fe?(xe.flags|=2,fe):ye):(xe.flags|=2,fe)):(xe.flags|=1048576,fe)}function D(xe){return s&&xe.alternate===null&&(xe.flags|=2),xe}function J(xe,fe,ye,Be){return fe===null||fe.tag!==6?(fe=M0(ye,xe.mode,Be),fe.return=xe,fe):(fe=v(fe,ye),fe.return=xe,fe)}function ce(xe,fe,ye,Be){var Ze=ye.type;return Ze===C?Ae(xe,fe,ye.props.children,Be,ye.key):fe!==null&&(fe.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===pe&&Uh(Ze)===fe.type)?(Be=v(fe,ye.props),Be.ref=Li(xe,fe,ye),Be.return=xe,Be):(Be=jc(ye.type,ye.key,ye.props,null,xe.mode,Be),Be.ref=Li(xe,fe,ye),Be.return=xe,Be)}function _e(xe,fe,ye,Be){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==ye.containerInfo||fe.stateNode.implementation!==ye.implementation?(fe=I0(ye,xe.mode,Be),fe.return=xe,fe):(fe=v(fe,ye.children||[]),fe.return=xe,fe)}function Ae(xe,fe,ye,Be,Ze){return fe===null||fe.tag!==7?(fe=Vs(ye,xe.mode,Be,Ze),fe.return=xe,fe):(fe=v(fe,ye),fe.return=xe,fe)}function je(xe,fe,ye){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return fe=M0(""+fe,xe.mode,ye),fe.return=xe,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case Z:return ye=jc(fe.type,fe.key,fe.props,null,xe.mode,ye),ye.ref=Li(xe,null,fe),ye.return=xe,ye;case L:return fe=I0(fe,xe.mode,ye),fe.return=xe,fe;case pe:var Be=fe._init;return je(xe,Be(fe._payload),ye)}if(Ee(fe)||M(fe))return fe=Vs(fe,xe.mode,ye,null),fe.return=xe,fe;pc(xe,fe)}return null}function Ne(xe,fe,ye,Be){var Ze=fe!==null?fe.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number")return Ze!==null?null:J(xe,fe,""+ye,Be);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case Z:return ye.key===Ze?ce(xe,fe,ye,Be):null;case L:return ye.key===Ze?_e(xe,fe,ye,Be):null;case pe:return Ze=ye._init,Ne(xe,fe,Ze(ye._payload),Be)}if(Ee(ye)||M(ye))return Ze!==null?null:Ae(xe,fe,ye,Be,null);pc(xe,ye)}return null}function $e(xe,fe,ye,Be,Ze){if(typeof Be=="string"&&Be!==""||typeof Be=="number")return xe=xe.get(ye)||null,J(fe,xe,""+Be,Ze);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case Z:return xe=xe.get(Be.key===null?ye:Be.key)||null,ce(fe,xe,Be,Ze);case L:return xe=xe.get(Be.key===null?ye:Be.key)||null,_e(fe,xe,Be,Ze);case pe:var st=Be._init;return $e(xe,fe,ye,st(Be._payload),Ze)}if(Ee(Be)||M(Be))return xe=xe.get(ye)||null,Ae(fe,xe,Be,Ze,null);pc(fe,Be)}return null}function Xe(xe,fe,ye,Be){for(var Ze=null,st=null,ot=fe,ft=fe=0,Fr=null;ot!==null&&ft<ye.length;ft++){ot.index>ft?(Fr=ot,ot=null):Fr=ot.sibling;var Pt=Ne(xe,ot,ye[ft],Be);if(Pt===null){ot===null&&(ot=Fr);break}s&&ot&&Pt.alternate===null&&i(xe,ot),fe=b(Pt,fe,ft),st===null?Ze=Pt:st.sibling=Pt,st=Pt,ot=Fr}if(ft===ye.length)return u(xe,ot),Zt&&Ls(xe,ft),Ze;if(ot===null){for(;ft<ye.length;ft++)ot=je(xe,ye[ft],Be),ot!==null&&(fe=b(ot,fe,ft),st===null?Ze=ot:st.sibling=ot,st=ot);return Zt&&Ls(xe,ft),Ze}for(ot=m(xe,ot);ft<ye.length;ft++)Fr=$e(ot,xe,ft,ye[ft],Be),Fr!==null&&(s&&Fr.alternate!==null&&ot.delete(Fr.key===null?ft:Fr.key),fe=b(Fr,fe,ft),st===null?Ze=Fr:st.sibling=Fr,st=Fr);return s&&ot.forEach(function(ms){return i(xe,ms)}),Zt&&Ls(xe,ft),Ze}function Qe(xe,fe,ye,Be){var Ze=M(ye);if(typeof Ze!="function")throw Error(t(150));if(ye=Ze.call(ye),ye==null)throw Error(t(151));for(var st=Ze=null,ot=fe,ft=fe=0,Fr=null,Pt=ye.next();ot!==null&&!Pt.done;ft++,Pt=ye.next()){ot.index>ft?(Fr=ot,ot=null):Fr=ot.sibling;var ms=Ne(xe,ot,Pt.value,Be);if(ms===null){ot===null&&(ot=Fr);break}s&&ot&&ms.alternate===null&&i(xe,ot),fe=b(ms,fe,ft),st===null?Ze=ms:st.sibling=ms,st=ms,ot=Fr}if(Pt.done)return u(xe,ot),Zt&&Ls(xe,ft),Ze;if(ot===null){for(;!Pt.done;ft++,Pt=ye.next())Pt=je(xe,Pt.value,Be),Pt!==null&&(fe=b(Pt,fe,ft),st===null?Ze=Pt:st.sibling=Pt,st=Pt);return Zt&&Ls(xe,ft),Ze}for(ot=m(xe,ot);!Pt.done;ft++,Pt=ye.next())Pt=$e(ot,xe,ft,Pt.value,Be),Pt!==null&&(s&&Pt.alternate!==null&&ot.delete(Pt.key===null?ft:Pt.key),fe=b(Pt,fe,ft),st===null?Ze=Pt:st.sibling=Pt,st=Pt);return s&&ot.forEach(function(r2){return i(xe,r2)}),Zt&&Ls(xe,ft),Ze}function dr(xe,fe,ye,Be){if(typeof ye=="object"&&ye!==null&&ye.type===C&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case Z:e:{for(var Ze=ye.key,st=fe;st!==null;){if(st.key===Ze){if(Ze=ye.type,Ze===C){if(st.tag===7){u(xe,st.sibling),fe=v(st,ye.props.children),fe.return=xe,xe=fe;break e}}else if(st.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===pe&&Uh(Ze)===st.type){u(xe,st.sibling),fe=v(st,ye.props),fe.ref=Li(xe,st,ye),fe.return=xe,xe=fe;break e}u(xe,st);break}else i(xe,st);st=st.sibling}ye.type===C?(fe=Vs(ye.props.children,xe.mode,Be,ye.key),fe.return=xe,xe=fe):(Be=jc(ye.type,ye.key,ye.props,null,xe.mode,Be),Be.ref=Li(xe,fe,ye),Be.return=xe,xe=Be)}return D(xe);case L:e:{for(st=ye.key;fe!==null;){if(fe.key===st)if(fe.tag===4&&fe.stateNode.containerInfo===ye.containerInfo&&fe.stateNode.implementation===ye.implementation){u(xe,fe.sibling),fe=v(fe,ye.children||[]),fe.return=xe,xe=fe;break e}else{u(xe,fe);break}else i(xe,fe);fe=fe.sibling}fe=I0(ye,xe.mode,Be),fe.return=xe,xe=fe}return D(xe);case pe:return st=ye._init,dr(xe,fe,st(ye._payload),Be)}if(Ee(ye))return Xe(xe,fe,ye,Be);if(M(ye))return Qe(xe,fe,ye,Be);pc(xe,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"?(ye=""+ye,fe!==null&&fe.tag===6?(u(xe,fe.sibling),fe=v(fe,ye),fe.return=xe,xe=fe):(u(xe,fe),fe=M0(ye,xe.mode,Be),fe.return=xe,xe=fe),D(xe)):u(xe,fe)}return dr}var Mo=Hh(!0),Yh=Hh(!1),hc=as(null),mc=null,Io=null,$f=null;function Vf(){$f=Io=mc=null}function Kf(s){var i=hc.current;qt(hc),s._currentValue=i}function Gf(s,i,u){for(;s!==null;){var m=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,m!==null&&(m.childLanes|=i)):m!==null&&(m.childLanes&i)!==i&&(m.childLanes|=i),s===u)break;s=s.return}}function jo(s,i){mc=s,$f=Io=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(pn=!0),s.firstContext=null)}function Fn(s){var i=s._currentValue;if($f!==s)if(s={context:s,memoizedValue:i,next:null},Io===null){if(mc===null)throw Error(t(308));Io=s,mc.dependencies={lanes:0,firstContext:s}}else Io=Io.next=s;return i}var zs=null;function Xf(s){zs===null?zs=[s]:zs.push(s)}function $h(s,i,u,m){var v=i.interleaved;return v===null?(u.next=u,Xf(i)):(u.next=v.next,v.next=u),i.interleaved=u,Ra(s,m)}function Ra(s,i){s.lanes|=i;var u=s.alternate;for(u!==null&&(u.lanes|=i),u=s,s=s.return;s!==null;)s.childLanes|=i,u=s.alternate,u!==null&&(u.childLanes|=i),u=s,s=s.return;return u.tag===3?u.stateNode:null}var is=!1;function Qf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Ma(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function ls(s,i,u){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Dt&2)!==0){var v=m.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),m.pending=i,Ra(s,u)}return v=m.interleaved,v===null?(i.next=i,Xf(m)):(i.next=v.next,v.next=i),m.interleaved=i,Ra(s,u)}function xc(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194240)!==0)){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,uf(s,u)}}function Kh(s,i){var u=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var v=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var D={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};b===null?v=b=D:b=b.next=D,u=u.next}while(u!==null);b===null?v=b=i:b=b.next=i}else v=b=i;u={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:m.shared,effects:m.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}function gc(s,i,u,m){var v=s.updateQueue;is=!1;var b=v.firstBaseUpdate,D=v.lastBaseUpdate,J=v.shared.pending;if(J!==null){v.shared.pending=null;var ce=J,_e=ce.next;ce.next=null,D===null?b=_e:D.next=_e,D=ce;var Ae=s.alternate;Ae!==null&&(Ae=Ae.updateQueue,J=Ae.lastBaseUpdate,J!==D&&(J===null?Ae.firstBaseUpdate=_e:J.next=_e,Ae.lastBaseUpdate=ce))}if(b!==null){var je=v.baseState;D=0,Ae=_e=ce=null,J=b;do{var Ne=J.lane,$e=J.eventTime;if((m&Ne)===Ne){Ae!==null&&(Ae=Ae.next={eventTime:$e,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var Xe=s,Qe=J;switch(Ne=i,$e=u,Qe.tag){case 1:if(Xe=Qe.payload,typeof Xe=="function"){je=Xe.call($e,je,Ne);break e}je=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Qe.payload,Ne=typeof Xe=="function"?Xe.call($e,je,Ne):Xe,Ne==null)break e;je=H({},je,Ne);break e;case 2:is=!0}}J.callback!==null&&J.lane!==0&&(s.flags|=64,Ne=v.effects,Ne===null?v.effects=[J]:Ne.push(J))}else $e={eventTime:$e,lane:Ne,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Ae===null?(_e=Ae=$e,ce=je):Ae=Ae.next=$e,D|=Ne;if(J=J.next,J===null){if(J=v.shared.pending,J===null)break;Ne=J,J=Ne.next,Ne.next=null,v.lastBaseUpdate=Ne,v.shared.pending=null}}while(!0);if(Ae===null&&(ce=je),v.baseState=ce,v.firstBaseUpdate=_e,v.lastBaseUpdate=Ae,i=v.shared.interleaved,i!==null){v=i;do D|=v.lane,v=v.next;while(v!==i)}else b===null&&(v.shared.lanes=0);Us|=D,s.lanes=D,s.memoizedState=je}}function Gh(s,i,u){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var m=s[i],v=m.callback;if(v!==null){if(m.callback=null,m=u,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var zi={},ua=as(zi),Bi=as(zi),Wi=as(zi);function Bs(s){if(s===zi)throw Error(t(174));return s}function qf(s,i){switch(Gt(Wi,i),Gt(Bi,s),Gt(ua,zi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Ot(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=Ot(i,s)}qt(ua),Gt(ua,i)}function Lo(){qt(ua),qt(Bi),qt(Wi)}function Xh(s){Bs(Wi.current);var i=Bs(ua.current),u=Ot(i,s.type);i!==u&&(Gt(Bi,s),Gt(ua,u))}function Zf(s){Bi.current===s&&(qt(ua),qt(Bi))}var nr=as(0);function vc(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Jf=[];function e0(){for(var s=0;s<Jf.length;s++)Jf[s]._workInProgressVersionPrimary=null;Jf.length=0}var yc=z.ReactCurrentDispatcher,t0=z.ReactCurrentBatchConfig,Ws=0,ar=null,kr=null,Dr=null,wc=!1,Ui=!1,Hi=0,Ek=0;function Ur(){throw Error(t(321))}function r0(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!$n(s[u],i[u]))return!1;return!0}function n0(s,i,u,m,v,b){if(Ws=b,ar=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,yc.current=s===null||s.memoizedState===null?Dk:Nk,s=u(m,v),Ui){b=0;do{if(Ui=!1,Hi=0,25<=b)throw Error(t(301));b+=1,Dr=kr=null,i.updateQueue=null,yc.current=Fk,s=u(m,v)}while(Ui)}if(yc.current=bc,i=kr!==null&&kr.next!==null,Ws=0,Dr=kr=ar=null,wc=!1,i)throw Error(t(300));return s}function a0(){var s=Hi!==0;return Hi=0,s}function fa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?ar.memoizedState=Dr=s:Dr=Dr.next=s,Dr}function An(){if(kr===null){var s=ar.alternate;s=s!==null?s.memoizedState:null}else s=kr.next;var i=Dr===null?ar.memoizedState:Dr.next;if(i!==null)Dr=i,kr=s;else{if(s===null)throw Error(t(310));kr=s,s={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Dr===null?ar.memoizedState=Dr=s:Dr=Dr.next=s}return Dr}function Yi(s,i){return typeof i=="function"?i(s):i}function s0(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=kr,v=m.baseQueue,b=u.pending;if(b!==null){if(v!==null){var D=v.next;v.next=b.next,b.next=D}m.baseQueue=v=b,u.pending=null}if(v!==null){b=v.next,m=m.baseState;var J=D=null,ce=null,_e=b;do{var Ae=_e.lane;if((Ws&Ae)===Ae)ce!==null&&(ce=ce.next={lane:0,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),m=_e.hasEagerState?_e.eagerState:s(m,_e.action);else{var je={lane:Ae,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null};ce===null?(J=ce=je,D=m):ce=ce.next=je,ar.lanes|=Ae,Us|=Ae}_e=_e.next}while(_e!==null&&_e!==b);ce===null?D=m:ce.next=J,$n(m,i.memoizedState)||(pn=!0),i.memoizedState=m,i.baseState=D,i.baseQueue=ce,u.lastRenderedState=m}if(s=u.interleaved,s!==null){v=s;do b=v.lane,ar.lanes|=b,Us|=b,v=v.next;while(v!==s)}else v===null&&(u.lanes=0);return[i.memoizedState,u.dispatch]}function o0(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=u.dispatch,v=u.pending,b=i.memoizedState;if(v!==null){u.pending=null;var D=v=v.next;do b=s(b,D.action),D=D.next;while(D!==v);$n(b,i.memoizedState)||(pn=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),u.lastRenderedState=b}return[b,m]}function Qh(){}function qh(s,i){var u=ar,m=An(),v=i(),b=!$n(m.memoizedState,v);if(b&&(m.memoizedState=v,pn=!0),m=m.queue,i0(em.bind(null,u,m,s),[s]),m.getSnapshot!==i||b||Dr!==null&&Dr.memoizedState.tag&1){if(u.flags|=2048,$i(9,Jh.bind(null,u,m,v,i),void 0,null),Nr===null)throw Error(t(349));(Ws&30)!==0||Zh(u,i,v)}return v}function Zh(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=ar.updateQueue,i===null?(i={lastEffect:null,stores:null},ar.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function Jh(s,i,u,m){i.value=u,i.getSnapshot=m,tm(i)&&rm(s)}function em(s,i,u){return u(function(){tm(i)&&rm(s)})}function tm(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!$n(s,u)}catch{return!0}}function rm(s){var i=Ra(s,1);i!==null&&Qn(i,s,1,-1)}function nm(s){var i=fa();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:s},i.queue=s,s=s.dispatch=Ck.bind(null,ar,s),[i.memoizedState,s]}function $i(s,i,u,m){return s={tag:s,create:i,destroy:u,deps:m,next:null},i=ar.updateQueue,i===null?(i={lastEffect:null,stores:null},ar.updateQueue=i,i.lastEffect=s.next=s):(u=i.lastEffect,u===null?i.lastEffect=s.next=s:(m=u.next,u.next=s,s.next=m,i.lastEffect=s)),s}function am(){return An().memoizedState}function kc(s,i,u,m){var v=fa();ar.flags|=s,v.memoizedState=$i(1|i,u,void 0,m===void 0?null:m)}function _c(s,i,u,m){var v=An();m=m===void 0?null:m;var b=void 0;if(kr!==null){var D=kr.memoizedState;if(b=D.destroy,m!==null&&r0(m,D.deps)){v.memoizedState=$i(i,u,b,m);return}}ar.flags|=s,v.memoizedState=$i(1|i,u,b,m)}function sm(s,i){return kc(8390656,8,s,i)}function i0(s,i){return _c(2048,8,s,i)}function om(s,i){return _c(4,2,s,i)}function im(s,i){return _c(4,4,s,i)}function lm(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function cm(s,i,u){return u=u!=null?u.concat([s]):null,_c(4,4,lm.bind(null,i,s),u)}function l0(){}function um(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&r0(i,m[1])?m[0]:(u.memoizedState=[s,i],s)}function fm(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&r0(i,m[1])?m[0]:(s=s(),u.memoizedState=[s,i],s)}function dm(s,i,u){return(Ws&21)===0?(s.baseState&&(s.baseState=!1,pn=!0),s.memoizedState=u):($n(u,i)||(u=Up(),ar.lanes|=u,Us|=u,s.baseState=!0),i)}function Sk(s,i){var u=Wt;Wt=u!==0&&4>u?u:4,s(!0);var m=t0.transition;t0.transition={};try{s(!1),i()}finally{Wt=u,t0.transition=m}}function pm(){return An().memoizedState}function Tk(s,i,u){var m=ds(s);if(u={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null},hm(s))mm(i,u);else if(u=$h(s,i,u,m),u!==null){var v=en();Qn(u,s,m,v),xm(u,i,m)}}function Ck(s,i,u){var m=ds(s),v={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null};if(hm(s))mm(i,v);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var D=i.lastRenderedState,J=b(D,u);if(v.hasEagerState=!0,v.eagerState=J,$n(J,D)){var ce=i.interleaved;ce===null?(v.next=v,Xf(i)):(v.next=ce.next,ce.next=v),i.interleaved=v;return}}catch{}finally{}u=$h(s,i,v,m),u!==null&&(v=en(),Qn(u,s,m,v),xm(u,i,m))}}function hm(s){var i=s.alternate;return s===ar||i!==null&&i===ar}function mm(s,i){Ui=wc=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function xm(s,i,u){if((u&4194240)!==0){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,uf(s,u)}}var bc={readContext:Fn,useCallback:Ur,useContext:Ur,useEffect:Ur,useImperativeHandle:Ur,useInsertionEffect:Ur,useLayoutEffect:Ur,useMemo:Ur,useReducer:Ur,useRef:Ur,useState:Ur,useDebugValue:Ur,useDeferredValue:Ur,useTransition:Ur,useMutableSource:Ur,useSyncExternalStore:Ur,useId:Ur,unstable_isNewReconciler:!1},Dk={readContext:Fn,useCallback:function(s,i){return fa().memoizedState=[s,i===void 0?null:i],s},useContext:Fn,useEffect:sm,useImperativeHandle:function(s,i,u){return u=u!=null?u.concat([s]):null,kc(4194308,4,lm.bind(null,i,s),u)},useLayoutEffect:function(s,i){return kc(4194308,4,s,i)},useInsertionEffect:function(s,i){return kc(4,2,s,i)},useMemo:function(s,i){var u=fa();return i=i===void 0?null:i,s=s(),u.memoizedState=[s,i],s},useReducer:function(s,i,u){var m=fa();return i=u!==void 0?u(i):i,m.memoizedState=m.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},m.queue=s,s=s.dispatch=Tk.bind(null,ar,s),[m.memoizedState,s]},useRef:function(s){var i=fa();return s={current:s},i.memoizedState=s},useState:nm,useDebugValue:l0,useDeferredValue:function(s){return fa().memoizedState=s},useTransition:function(){var s=nm(!1),i=s[0];return s=Sk.bind(null,s[1]),fa().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,u){var m=ar,v=fa();if(Zt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=i(),Nr===null)throw Error(t(349));(Ws&30)!==0||Zh(m,i,u)}v.memoizedState=u;var b={value:u,getSnapshot:i};return v.queue=b,sm(em.bind(null,m,b,s),[s]),m.flags|=2048,$i(9,Jh.bind(null,m,b,u,i),void 0,null),u},useId:function(){var s=fa(),i=Nr.identifierPrefix;if(Zt){var u=Pa,m=Oa;u=(m&~(1<<32-fr(m)-1)).toString(32)+u,i=":"+i+"R"+u,u=Hi++,0<u&&(i+="H"+u.toString(32)),i+=":"}else u=Ek++,i=":"+i+"r"+u.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Nk={readContext:Fn,useCallback:um,useContext:Fn,useEffect:i0,useImperativeHandle:cm,useInsertionEffect:om,useLayoutEffect:im,useMemo:fm,useReducer:s0,useRef:am,useState:function(){return s0(Yi)},useDebugValue:l0,useDeferredValue:function(s){var i=An();return dm(i,kr.memoizedState,s)},useTransition:function(){var s=s0(Yi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Qh,useSyncExternalStore:qh,useId:pm,unstable_isNewReconciler:!1},Fk={readContext:Fn,useCallback:um,useContext:Fn,useEffect:i0,useImperativeHandle:cm,useInsertionEffect:om,useLayoutEffect:im,useMemo:fm,useReducer:o0,useRef:am,useState:function(){return o0(Yi)},useDebugValue:l0,useDeferredValue:function(s){var i=An();return kr===null?i.memoizedState=s:dm(i,kr.memoizedState,s)},useTransition:function(){var s=o0(Yi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Qh,useSyncExternalStore:qh,useId:pm,unstable_isNewReconciler:!1};function Kn(s,i){if(s&&s.defaultProps){i=H({},i),s=s.defaultProps;for(var u in s)i[u]===void 0&&(i[u]=s[u]);return i}return i}function c0(s,i,u,m){i=s.memoizedState,u=u(m,i),u=u==null?i:H({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Ec={isMounted:function(s){return(s=s._reactInternals)?q(s)===s:!1},enqueueSetState:function(s,i,u){s=s._reactInternals;var m=en(),v=ds(s),b=Ma(m,v);b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var m=en(),v=ds(s),b=Ma(m,v);b.tag=1,b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=en(),m=ds(s),v=Ma(u,m);v.tag=2,i!=null&&(v.callback=i),i=ls(s,v,m),i!==null&&(Qn(i,s,m,u),xc(i,s,m))}};function gm(s,i,u,m,v,b,D){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,b,D):i.prototype&&i.prototype.isPureReactComponent?!Ai(u,m)||!Ai(v,b):!0}function vm(s,i,u){var m=!1,v=ss,b=i.contextType;return typeof b=="object"&&b!==null?b=Fn(b):(v=dn(i)?Is:Wr.current,m=i.contextTypes,b=(m=m!=null)?Ao(s,v):ss),i=new i(u,b),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ec,s.stateNode=i,i._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=v,s.__reactInternalMemoizedMaskedChildContext=b),i}function ym(s,i,u,m){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,m),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,m),i.state!==s&&Ec.enqueueReplaceState(i,i.state,null)}function u0(s,i,u,m){var v=s.stateNode;v.props=u,v.state=s.memoizedState,v.refs={},Qf(s);var b=i.contextType;typeof b=="object"&&b!==null?v.context=Fn(b):(b=dn(i)?Is:Wr.current,v.context=Ao(s,b)),v.state=s.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(c0(s,i,b,u),v.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(i=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),i!==v.state&&Ec.enqueueReplaceState(v,v.state,null),gc(s,u,v,m),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308)}function zo(s,i){try{var u="",m=i;do u+=W(m),m=m.return;while(m);var v=u}catch(b){v=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:i,stack:v,digest:null}}function f0(s,i,u){return{value:s,source:null,stack:u??null,digest:i??null}}function d0(s,i){try{console.error(i.value)}catch(u){setTimeout(function(){throw u})}}var Ak=typeof WeakMap=="function"?WeakMap:Map;function wm(s,i,u){u=Ma(-1,u),u.tag=3,u.payload={element:null};var m=i.value;return u.callback=function(){Ac||(Ac=!0,C0=m),d0(s,i)},u}function km(s,i,u){u=Ma(-1,u),u.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var v=i.value;u.payload=function(){return m(v)},u.callback=function(){d0(s,i)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(u.callback=function(){d0(s,i),typeof m!="function"&&(us===null?us=new Set([this]):us.add(this));var D=i.stack;this.componentDidCatch(i.value,{componentStack:D!==null?D:""})}),u}function _m(s,i,u){var m=s.pingCache;if(m===null){m=s.pingCache=new Ak;var v=new Set;m.set(i,v)}else v=m.get(i),v===void 0&&(v=new Set,m.set(i,v));v.has(u)||(v.add(u),s=$k.bind(null,s,i,u),i.then(s,s))}function bm(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Em(s,i,u,m,v){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(i=Ma(-1,1),i.tag=2,ls(u,i,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=v,s)}var Ok=z.ReactCurrentOwner,pn=!1;function Jr(s,i,u,m){i.child=s===null?Yh(i,null,u,m):Mo(i,s.child,u,m)}function Sm(s,i,u,m,v){u=u.render;var b=i.ref;return jo(i,v),m=n0(s,i,u,m,b,v),u=a0(),s!==null&&!pn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(Zt&&u&&Bf(i),i.flags|=1,Jr(s,i,m,v),i.child)}function Tm(s,i,u,m,v){if(s===null){var b=u.type;return typeof b=="function"&&!R0(b)&&b.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(i.tag=15,i.type=b,Cm(s,i,b,m,v)):(s=jc(u.type,null,m,i,i.mode,v),s.ref=i.ref,s.return=i,i.child=s)}if(b=s.child,(s.lanes&v)===0){var D=b.memoizedProps;if(u=u.compare,u=u!==null?u:Ai,u(D,m)&&s.ref===i.ref)return Ia(s,i,v)}return i.flags|=1,s=hs(b,m),s.ref=i.ref,s.return=i,i.child=s}function Cm(s,i,u,m,v){if(s!==null){var b=s.memoizedProps;if(Ai(b,m)&&s.ref===i.ref)if(pn=!1,i.pendingProps=m=b,(s.lanes&v)!==0)(s.flags&131072)!==0&&(pn=!0);else return i.lanes=s.lanes,Ia(s,i,v)}return p0(s,i,u,m,v)}function Dm(s,i,u){var m=i.pendingProps,v=m.children,b=s!==null?s.memoizedState:null;if(m.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gt(Wo,_n),_n|=u;else{if((u&1073741824)===0)return s=b!==null?b.baseLanes|u:u,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Gt(Wo,_n),_n|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=b!==null?b.baseLanes:u,Gt(Wo,_n),_n|=m}else b!==null?(m=b.baseLanes|u,i.memoizedState=null):m=u,Gt(Wo,_n),_n|=m;return Jr(s,i,v,u),i.child}function Nm(s,i){var u=i.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(i.flags|=512,i.flags|=2097152)}function p0(s,i,u,m,v){var b=dn(u)?Is:Wr.current;return b=Ao(i,b),jo(i,v),u=n0(s,i,u,m,b,v),m=a0(),s!==null&&!pn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(Zt&&m&&Bf(i),i.flags|=1,Jr(s,i,u,v),i.child)}function Fm(s,i,u,m,v){if(dn(u)){var b=!0;lc(i)}else b=!1;if(jo(i,v),i.stateNode===null)Tc(s,i),vm(i,u,m),u0(i,u,m,v),m=!0;else if(s===null){var D=i.stateNode,J=i.memoizedProps;D.props=J;var ce=D.context,_e=u.contextType;typeof _e=="object"&&_e!==null?_e=Fn(_e):(_e=dn(u)?Is:Wr.current,_e=Ao(i,_e));var Ae=u.getDerivedStateFromProps,je=typeof Ae=="function"||typeof D.getSnapshotBeforeUpdate=="function";je||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(J!==m||ce!==_e)&&ym(i,D,m,_e),is=!1;var Ne=i.memoizedState;D.state=Ne,gc(i,m,D,v),ce=i.memoizedState,J!==m||Ne!==ce||fn.current||is?(typeof Ae=="function"&&(c0(i,u,Ae,m),ce=i.memoizedState),(J=is||gm(i,u,J,m,Ne,ce,_e))?(je||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(i.flags|=4194308)):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=m,i.memoizedState=ce),D.props=m,D.state=ce,D.context=_e,m=J):(typeof D.componentDidMount=="function"&&(i.flags|=4194308),m=!1)}else{D=i.stateNode,Vh(s,i),J=i.memoizedProps,_e=i.type===i.elementType?J:Kn(i.type,J),D.props=_e,je=i.pendingProps,Ne=D.context,ce=u.contextType,typeof ce=="object"&&ce!==null?ce=Fn(ce):(ce=dn(u)?Is:Wr.current,ce=Ao(i,ce));var $e=u.getDerivedStateFromProps;(Ae=typeof $e=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(J!==je||Ne!==ce)&&ym(i,D,m,ce),is=!1,Ne=i.memoizedState,D.state=Ne,gc(i,m,D,v);var Xe=i.memoizedState;J!==je||Ne!==Xe||fn.current||is?(typeof $e=="function"&&(c0(i,u,$e,m),Xe=i.memoizedState),(_e=is||gm(i,u,_e,m,Ne,Xe,ce)||!1)?(Ae||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(m,Xe,ce),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(m,Xe,ce)),typeof D.componentDidUpdate=="function"&&(i.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof D.componentDidUpdate!="function"||J===s.memoizedProps&&Ne===s.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||J===s.memoizedProps&&Ne===s.memoizedState||(i.flags|=1024),i.memoizedProps=m,i.memoizedState=Xe),D.props=m,D.state=Xe,D.context=ce,m=_e):(typeof D.componentDidUpdate!="function"||J===s.memoizedProps&&Ne===s.memoizedState||(i.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||J===s.memoizedProps&&Ne===s.memoizedState||(i.flags|=1024),m=!1)}return h0(s,i,u,m,b,v)}function h0(s,i,u,m,v,b){Nm(s,i);var D=(i.flags&128)!==0;if(!m&&!D)return v&&Mh(i,u,!1),Ia(s,i,b);m=i.stateNode,Ok.current=i;var J=D&&typeof u.getDerivedStateFromError!="function"?null:m.render();return i.flags|=1,s!==null&&D?(i.child=Mo(i,s.child,null,b),i.child=Mo(i,null,J,b)):Jr(s,i,J,b),i.memoizedState=m.state,v&&Mh(i,u,!0),i.child}function Am(s){var i=s.stateNode;i.pendingContext?Ph(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Ph(s,i.context,!1),qf(s,i.containerInfo)}function Om(s,i,u,m,v){return Ro(),Yf(v),i.flags|=256,Jr(s,i,u,m),i.child}var m0={dehydrated:null,treeContext:null,retryLane:0};function x0(s){return{baseLanes:s,cachePool:null,transitions:null}}function Pm(s,i,u){var m=i.pendingProps,v=nr.current,b=!1,D=(i.flags&128)!==0,J;if((J=D)||(J=s!==null&&s.memoizedState===null?!1:(v&2)!==0),J?(b=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(v|=1),Gt(nr,v&1),s===null)return Hf(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(D=m.children,s=m.fallback,b?(m=i.mode,b=i.child,D={mode:"hidden",children:D},(m&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=D):b=Lc(D,m,0,null),s=Vs(s,m,u,null),b.return=i,s.return=i,b.sibling=s,i.child=b,i.child.memoizedState=x0(u),i.memoizedState=m0,s):g0(i,D));if(v=s.memoizedState,v!==null&&(J=v.dehydrated,J!==null))return Pk(s,i,D,m,J,v,u);if(b){b=m.fallback,D=i.mode,v=s.child,J=v.sibling;var ce={mode:"hidden",children:m.children};return(D&1)===0&&i.child!==v?(m=i.child,m.childLanes=0,m.pendingProps=ce,i.deletions=null):(m=hs(v,ce),m.subtreeFlags=v.subtreeFlags&14680064),J!==null?b=hs(J,b):(b=Vs(b,D,u,null),b.flags|=2),b.return=i,m.return=i,m.sibling=b,i.child=m,m=b,b=i.child,D=s.child.memoizedState,D=D===null?x0(u):{baseLanes:D.baseLanes|u,cachePool:null,transitions:D.transitions},b.memoizedState=D,b.childLanes=s.childLanes&~u,i.memoizedState=m0,m}return b=s.child,s=b.sibling,m=hs(b,{mode:"visible",children:m.children}),(i.mode&1)===0&&(m.lanes=u),m.return=i,m.sibling=null,s!==null&&(u=i.deletions,u===null?(i.deletions=[s],i.flags|=16):u.push(s)),i.child=m,i.memoizedState=null,m}function g0(s,i){return i=Lc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Sc(s,i,u,m){return m!==null&&Yf(m),Mo(i,s.child,null,u),s=g0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Pk(s,i,u,m,v,b,D){if(u)return i.flags&256?(i.flags&=-257,m=f0(Error(t(422))),Sc(s,i,D,m)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(b=m.fallback,v=i.mode,m=Lc({mode:"visible",children:m.children},v,0,null),b=Vs(b,v,D,null),b.flags|=2,m.return=i,b.return=i,m.sibling=b,i.child=m,(i.mode&1)!==0&&Mo(i,s.child,null,D),i.child.memoizedState=x0(D),i.memoizedState=m0,b);if((i.mode&1)===0)return Sc(s,i,D,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var J=m.dgst;return m=J,b=Error(t(419)),m=f0(b,m,void 0),Sc(s,i,D,m)}if(J=(D&s.childLanes)!==0,pn||J){if(m=Nr,m!==null){switch(D&-D){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|D))!==0?0:v,v!==0&&v!==b.retryLane&&(b.retryLane=v,Ra(s,v),Qn(m,s,v,-1))}return P0(),m=f0(Error(t(421))),Sc(s,i,D,m)}return v.data==="$?"?(i.flags|=128,i.child=s.child,i=Vk.bind(null,s),v._reactRetry=i,null):(s=b.treeContext,kn=ns(v.nextSibling),wn=i,Zt=!0,Vn=null,s!==null&&(Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,Oa=s.id,Pa=s.overflow,js=i),i=g0(i,m.children),i.flags|=4096,i)}function Rm(s,i,u){s.lanes|=i;var m=s.alternate;m!==null&&(m.lanes|=i),Gf(s.return,i,u)}function v0(s,i,u,m,v){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:v}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=m,b.tail=u,b.tailMode=v)}function Mm(s,i,u){var m=i.pendingProps,v=m.revealOrder,b=m.tail;if(Jr(s,i,m.children,u),m=nr.current,(m&2)!==0)m=m&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Rm(s,u,i);else if(s.tag===19)Rm(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(Gt(nr,m),(i.mode&1)===0)i.memoizedState=null;else switch(v){case"forwards":for(u=i.child,v=null;u!==null;)s=u.alternate,s!==null&&vc(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=i.child,i.child=null):(v=u.sibling,u.sibling=null),v0(i,!1,v,u,b);break;case"backwards":for(u=null,v=i.child,i.child=null;v!==null;){if(s=v.alternate,s!==null&&vc(s)===null){i.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}v0(i,!0,u,null,b);break;case"together":v0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Tc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Ia(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),Us|=i.lanes,(u&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,u=hs(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=hs(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function Rk(s,i,u){switch(i.tag){case 3:Am(i),Ro();break;case 5:Xh(i);break;case 1:dn(i.type)&&lc(i);break;case 4:qf(i,i.stateNode.containerInfo);break;case 10:var m=i.type._context,v=i.memoizedProps.value;Gt(hc,m._currentValue),m._currentValue=v;break;case 13:if(m=i.memoizedState,m!==null)return m.dehydrated!==null?(Gt(nr,nr.current&1),i.flags|=128,null):(u&i.child.childLanes)!==0?Pm(s,i,u):(Gt(nr,nr.current&1),s=Ia(s,i,u),s!==null?s.sibling:null);Gt(nr,nr.current&1);break;case 19:if(m=(u&i.childLanes)!==0,(s.flags&128)!==0){if(m)return Mm(s,i,u);i.flags|=128}if(v=i.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Gt(nr,nr.current),m)break;return null;case 22:case 23:return i.lanes=0,Dm(s,i,u)}return Ia(s,i,u)}var Im,y0,jm,Lm;Im=function(s,i){for(var u=i.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},y0=function(){},jm=function(s,i,u,m){var v=s.memoizedProps;if(v!==m){s=i.stateNode,Bs(ua.current);var b=null;switch(u){case"input":v=De(s,v),m=De(s,m),b=[];break;case"select":v=H({},v,{value:void 0}),m=H({},m,{value:void 0}),b=[];break;case"textarea":v=qe(s,v),m=qe(s,m),b=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=sc)}Cn(u,m);var D;u=null;for(_e in v)if(!m.hasOwnProperty(_e)&&v.hasOwnProperty(_e)&&v[_e]!=null)if(_e==="style"){var J=v[_e];for(D in J)J.hasOwnProperty(D)&&(u||(u={}),u[D]="")}else _e!=="dangerouslySetInnerHTML"&&_e!=="children"&&_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&_e!=="autoFocus"&&(a.hasOwnProperty(_e)?b||(b=[]):(b=b||[]).push(_e,null));for(_e in m){var ce=m[_e];if(J=v?.[_e],m.hasOwnProperty(_e)&&ce!==J&&(ce!=null||J!=null))if(_e==="style")if(J){for(D in J)!J.hasOwnProperty(D)||ce&&ce.hasOwnProperty(D)||(u||(u={}),u[D]="");for(D in ce)ce.hasOwnProperty(D)&&J[D]!==ce[D]&&(u||(u={}),u[D]=ce[D])}else u||(b||(b=[]),b.push(_e,u)),u=ce;else _e==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,J=J?J.__html:void 0,ce!=null&&J!==ce&&(b=b||[]).push(_e,ce)):_e==="children"?typeof ce!="string"&&typeof ce!="number"||(b=b||[]).push(_e,""+ce):_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&(a.hasOwnProperty(_e)?(ce!=null&&_e==="onScroll"&&Qt("scroll",s),b||J===ce||(b=[])):(b=b||[]).push(_e,ce))}u&&(b=b||[]).push("style",u);var _e=b;(i.updateQueue=_e)&&(i.flags|=4)}},Lm=function(s,i,u,m){u!==m&&(i.flags|=4)};function Vi(s,i){if(!Zt)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Hr(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,m=0;if(i)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=m,s.childLanes=u,i}function Mk(s,i,u){var m=i.pendingProps;switch(Wf(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(i),null;case 1:return dn(i.type)&&ic(),Hr(i),null;case 3:return m=i.stateNode,Lo(),qt(fn),qt(Wr),e0(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(dc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Vn!==null&&(F0(Vn),Vn=null))),y0(s,i),Hr(i),null;case 5:Zf(i);var v=Bs(Wi.current);if(u=i.type,s!==null&&i.stateNode!=null)jm(s,i,u,m,v),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!m){if(i.stateNode===null)throw Error(t(166));return Hr(i),null}if(s=Bs(ua.current),dc(i)){m=i.stateNode,u=i.type;var b=i.memoizedProps;switch(m[ca]=i,m[Ii]=b,s=(i.mode&1)!==0,u){case"dialog":Qt("cancel",m),Qt("close",m);break;case"iframe":case"object":case"embed":Qt("load",m);break;case"video":case"audio":for(v=0;v<Pi.length;v++)Qt(Pi[v],m);break;case"source":Qt("error",m);break;case"img":case"image":case"link":Qt("error",m),Qt("load",m);break;case"details":Qt("toggle",m);break;case"input":Ve(m,b),Qt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!b.multiple},Qt("invalid",m);break;case"textarea":it(m,b),Qt("invalid",m)}Cn(u,b),v=null;for(var D in b)if(b.hasOwnProperty(D)){var J=b[D];D==="children"?typeof J=="string"?m.textContent!==J&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,J,s),v=["children",J]):typeof J=="number"&&m.textContent!==""+J&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,J,s),v=["children",""+J]):a.hasOwnProperty(D)&&J!=null&&D==="onScroll"&&Qt("scroll",m)}switch(u){case"input":re(m),ne(m,b,!0);break;case"textarea":re(m),bt(m);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(m.onclick=sc)}m=v,i.updateQueue=m,m!==null&&(i.flags|=4)}else{D=v.nodeType===9?v:v.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Rt(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=D.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=D.createElement(u,{is:m.is}):(s=D.createElement(u),u==="select"&&(D=s,m.multiple?D.multiple=!0:m.size&&(D.size=m.size))):s=D.createElementNS(s,u),s[ca]=i,s[Ii]=m,Im(s,i,!1,!1),i.stateNode=s;e:{switch(D=vn(u,m),u){case"dialog":Qt("cancel",s),Qt("close",s),v=m;break;case"iframe":case"object":case"embed":Qt("load",s),v=m;break;case"video":case"audio":for(v=0;v<Pi.length;v++)Qt(Pi[v],s);v=m;break;case"source":Qt("error",s),v=m;break;case"img":case"image":case"link":Qt("error",s),Qt("load",s),v=m;break;case"details":Qt("toggle",s),v=m;break;case"input":Ve(s,m),v=De(s,m),Qt("invalid",s);break;case"option":v=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},v=H({},m,{value:void 0}),Qt("invalid",s);break;case"textarea":it(s,m),v=qe(s,m),Qt("invalid",s);break;default:v=m}Cn(u,v),J=v;for(b in J)if(J.hasOwnProperty(b)){var ce=J[b];b==="style"?Mt(s,ce):b==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ce!=null&&Tt(s,ce)):b==="children"?typeof ce=="string"?(u!=="textarea"||ce!=="")&&et(s,ce):typeof ce=="number"&&et(s,""+ce):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(a.hasOwnProperty(b)?ce!=null&&b==="onScroll"&&Qt("scroll",s):ce!=null&&T(s,b,ce,D))}switch(u){case"input":re(s),ne(s,m,!1);break;case"textarea":re(s),bt(s);break;case"option":m.value!=null&&s.setAttribute("value",""+he(m.value));break;case"select":s.multiple=!!m.multiple,b=m.value,b!=null?Fe(s,!!m.multiple,b,!1):m.defaultValue!=null&&Fe(s,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(s.onclick=sc)}switch(u){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Hr(i),null;case 6:if(s&&i.stateNode!=null)Lm(s,i,s.memoizedProps,m);else{if(typeof m!="string"&&i.stateNode===null)throw Error(t(166));if(u=Bs(Wi.current),Bs(ua.current),dc(i)){if(m=i.stateNode,u=i.memoizedProps,m[ca]=i,(b=m.nodeValue!==u)&&(s=wn,s!==null))switch(s.tag){case 3:ac(m.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ac(m.nodeValue,u,(s.mode&1)!==0)}b&&(i.flags|=4)}else m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[ca]=i,i.stateNode=m}return Hr(i),null;case 13:if(qt(nr),m=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Zt&&kn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Wh(),Ro(),i.flags|=98560,b=!1;else if(b=dc(i),m!==null&&m.dehydrated!==null){if(s===null){if(!b)throw Error(t(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));b[ca]=i}else Ro(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Hr(i),b=!1}else Vn!==null&&(F0(Vn),Vn=null),b=!0;if(!b)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=u,i):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(nr.current&1)!==0?_r===0&&(_r=3):P0())),i.updateQueue!==null&&(i.flags|=4),Hr(i),null);case 4:return Lo(),y0(s,i),s===null&&Ri(i.stateNode.containerInfo),Hr(i),null;case 10:return Kf(i.type._context),Hr(i),null;case 17:return dn(i.type)&&ic(),Hr(i),null;case 19:if(qt(nr),b=i.memoizedState,b===null)return Hr(i),null;if(m=(i.flags&128)!==0,D=b.rendering,D===null)if(m)Vi(b,!1);else{if(_r!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(D=vc(s),D!==null){for(i.flags|=128,Vi(b,!1),m=D.updateQueue,m!==null&&(i.updateQueue=m,i.flags|=4),i.subtreeFlags=0,m=u,u=i.child;u!==null;)b=u,s=m,b.flags&=14680066,D=b.alternate,D===null?(b.childLanes=0,b.lanes=s,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=D.childLanes,b.lanes=D.lanes,b.child=D.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=D.memoizedProps,b.memoizedState=D.memoizedState,b.updateQueue=D.updateQueue,b.type=D.type,s=D.dependencies,b.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Gt(nr,nr.current&1|2),i.child}s=s.sibling}b.tail!==null&&Me()>Uo&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304)}else{if(!m)if(s=vc(D),s!==null){if(i.flags|=128,m=!0,u=s.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),Vi(b,!0),b.tail===null&&b.tailMode==="hidden"&&!D.alternate&&!Zt)return Hr(i),null}else 2*Me()-b.renderingStartTime>Uo&&u!==1073741824&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304);b.isBackwards?(D.sibling=i.child,i.child=D):(u=b.last,u!==null?u.sibling=D:i.child=D,b.last=D)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=Me(),i.sibling=null,u=nr.current,Gt(nr,m?u&1|2:u&1),i):(Hr(i),null);case 22:case 23:return O0(),m=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(i.flags|=8192),m&&(i.mode&1)!==0?(_n&1073741824)!==0&&(Hr(i),i.subtreeFlags&6&&(i.flags|=8192)):Hr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Ik(s,i){switch(Wf(i),i.tag){case 1:return dn(i.type)&&ic(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Lo(),qt(fn),qt(Wr),e0(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Zf(i),null;case 13:if(qt(nr),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Ro()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return qt(nr),null;case 4:return Lo(),null;case 10:return Kf(i.type._context),null;case 22:case 23:return O0(),null;case 24:return null;default:return null}}var Cc=!1,Yr=!1,jk=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function Bo(s,i){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(m){or(s,i,m)}else u.current=null}function w0(s,i,u){try{u()}catch(m){or(s,i,m)}}var zm=!1;function Lk(s,i){if(Of=Kl,s=gh(),Ef(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var v=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var D=0,J=-1,ce=-1,_e=0,Ae=0,je=s,Ne=null;t:for(;;){for(var $e;je!==u||v!==0&&je.nodeType!==3||(J=D+v),je!==b||m!==0&&je.nodeType!==3||(ce=D+m),je.nodeType===3&&(D+=je.nodeValue.length),($e=je.firstChild)!==null;)Ne=je,je=$e;for(;;){if(je===s)break t;if(Ne===u&&++_e===v&&(J=D),Ne===b&&++Ae===m&&(ce=D),($e=je.nextSibling)!==null)break;je=Ne,Ne=je.parentNode}je=$e}u=J===-1||ce===-1?null:{start:J,end:ce}}else u=null}u=u||{start:0,end:0}}else u=null;for(Pf={focusedElem:s,selectionRange:u},Kl=!1,Ge=i;Ge!==null;)if(i=Ge,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,Ge=s;else for(;Ge!==null;){i=Ge;try{var Xe=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var Qe=Xe.memoizedProps,dr=Xe.memoizedState,xe=i.stateNode,fe=xe.getSnapshotBeforeUpdate(i.elementType===i.type?Qe:Kn(i.type,Qe),dr);xe.__reactInternalSnapshotBeforeUpdate=fe}break;case 3:var ye=i.stateNode.containerInfo;ye.nodeType===1?ye.textContent="":ye.nodeType===9&&ye.documentElement&&ye.removeChild(ye.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Be){or(i,i.return,Be)}if(s=i.sibling,s!==null){s.return=i.return,Ge=s;break}Ge=i.return}return Xe=zm,zm=!1,Xe}function Ki(s,i,u){var m=i.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&s)===s){var b=v.destroy;v.destroy=void 0,b!==void 0&&w0(i,u,b)}v=v.next}while(v!==m)}}function Dc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&s)===s){var m=u.create;u.destroy=m()}u=u.next}while(u!==i)}}function k0(s){var i=s.ref;if(i!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof i=="function"?i(s):i.current=s}}function Bm(s){var i=s.alternate;i!==null&&(s.alternate=null,Bm(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[ca],delete i[Ii],delete i[jf],delete i[wk],delete i[kk])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Wm(s){return s.tag===5||s.tag===3||s.tag===4}function Um(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Wm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _0(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.nodeType===8?u.parentNode.insertBefore(s,i):u.insertBefore(s,i):(u.nodeType===8?(i=u.parentNode,i.insertBefore(s,u)):(i=u,i.appendChild(s)),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=sc));else if(m!==4&&(s=s.child,s!==null))for(_0(s,i,u),s=s.sibling;s!==null;)_0(s,i,u),s=s.sibling}function b0(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(b0(s,i,u),s=s.sibling;s!==null;)b0(s,i,u),s=s.sibling}var Mr=null,Gn=!1;function cs(s,i,u){for(u=u.child;u!==null;)Hm(s,i,u),u=u.sibling}function Hm(s,i,u){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(la,u)}catch{}switch(u.tag){case 5:Yr||Bo(u,i);case 6:var m=Mr,v=Gn;Mr=null,cs(s,i,u),Mr=m,Gn=v,Mr!==null&&(Gn?(s=Mr,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):Mr.removeChild(u.stateNode));break;case 18:Mr!==null&&(Gn?(s=Mr,u=u.stateNode,s.nodeType===8?If(s.parentNode,u):s.nodeType===1&&If(s,u),Si(s)):If(Mr,u.stateNode));break;case 4:m=Mr,v=Gn,Mr=u.stateNode.containerInfo,Gn=!0,cs(s,i,u),Mr=m,Gn=v;break;case 0:case 11:case 14:case 15:if(!Yr&&(m=u.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var b=v,D=b.destroy;b=b.tag,D!==void 0&&((b&2)!==0||(b&4)!==0)&&w0(u,i,D),v=v.next}while(v!==m)}cs(s,i,u);break;case 1:if(!Yr&&(Bo(u,i),m=u.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=u.memoizedProps,m.state=u.memoizedState,m.componentWillUnmount()}catch(J){or(u,i,J)}cs(s,i,u);break;case 21:cs(s,i,u);break;case 22:u.mode&1?(Yr=(m=Yr)||u.memoizedState!==null,cs(s,i,u),Yr=m):cs(s,i,u);break;default:cs(s,i,u)}}function Ym(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new jk),i.forEach(function(m){var v=Kk.bind(null,s,m);u.has(m)||(u.add(m),m.then(v,v))})}}function Xn(s,i){var u=i.deletions;if(u!==null)for(var m=0;m<u.length;m++){var v=u[m];try{var b=s,D=i,J=D;e:for(;J!==null;){switch(J.tag){case 5:Mr=J.stateNode,Gn=!1;break e;case 3:Mr=J.stateNode.containerInfo,Gn=!0;break e;case 4:Mr=J.stateNode.containerInfo,Gn=!0;break e}J=J.return}if(Mr===null)throw Error(t(160));Hm(b,D,v),Mr=null,Gn=!1;var ce=v.alternate;ce!==null&&(ce.return=null),v.return=null}catch(_e){or(v,i,_e)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)$m(i,s),i=i.sibling}function $m(s,i){var u=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Xn(i,s),da(s),m&4){try{Ki(3,s,s.return),Dc(3,s)}catch(Qe){or(s,s.return,Qe)}try{Ki(5,s,s.return)}catch(Qe){or(s,s.return,Qe)}}break;case 1:Xn(i,s),da(s),m&512&&u!==null&&Bo(u,u.return);break;case 5:if(Xn(i,s),da(s),m&512&&u!==null&&Bo(u,u.return),s.flags&32){var v=s.stateNode;try{et(v,"")}catch(Qe){or(s,s.return,Qe)}}if(m&4&&(v=s.stateNode,v!=null)){var b=s.memoizedProps,D=u!==null?u.memoizedProps:b,J=s.type,ce=s.updateQueue;if(s.updateQueue=null,ce!==null)try{J==="input"&&b.type==="radio"&&b.name!=null&&He(v,b),vn(J,D);var _e=vn(J,b);for(D=0;D<ce.length;D+=2){var Ae=ce[D],je=ce[D+1];Ae==="style"?Mt(v,je):Ae==="dangerouslySetInnerHTML"?Tt(v,je):Ae==="children"?et(v,je):T(v,Ae,je,_e)}switch(J){case"input":Ie(v,b);break;case"textarea":kt(v,b);break;case"select":var Ne=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!b.multiple;var $e=b.value;$e!=null?Fe(v,!!b.multiple,$e,!1):Ne!==!!b.multiple&&(b.defaultValue!=null?Fe(v,!!b.multiple,b.defaultValue,!0):Fe(v,!!b.multiple,b.multiple?[]:"",!1))}v[Ii]=b}catch(Qe){or(s,s.return,Qe)}}break;case 6:if(Xn(i,s),da(s),m&4){if(s.stateNode===null)throw Error(t(162));v=s.stateNode,b=s.memoizedProps;try{v.nodeValue=b}catch(Qe){or(s,s.return,Qe)}}break;case 3:if(Xn(i,s),da(s),m&4&&u!==null&&u.memoizedState.isDehydrated)try{Si(i.containerInfo)}catch(Qe){or(s,s.return,Qe)}break;case 4:Xn(i,s),da(s);break;case 13:Xn(i,s),da(s),v=s.child,v.flags&8192&&(b=v.memoizedState!==null,v.stateNode.isHidden=b,!b||v.alternate!==null&&v.alternate.memoizedState!==null||(T0=Me())),m&4&&Ym(s);break;case 22:if(Ae=u!==null&&u.memoizedState!==null,s.mode&1?(Yr=(_e=Yr)||Ae,Xn(i,s),Yr=_e):Xn(i,s),da(s),m&8192){if(_e=s.memoizedState!==null,(s.stateNode.isHidden=_e)&&!Ae&&(s.mode&1)!==0)for(Ge=s,Ae=s.child;Ae!==null;){for(je=Ge=Ae;Ge!==null;){switch(Ne=Ge,$e=Ne.child,Ne.tag){case 0:case 11:case 14:case 15:Ki(4,Ne,Ne.return);break;case 1:Bo(Ne,Ne.return);var Xe=Ne.stateNode;if(typeof Xe.componentWillUnmount=="function"){m=Ne,u=Ne.return;try{i=m,Xe.props=i.memoizedProps,Xe.state=i.memoizedState,Xe.componentWillUnmount()}catch(Qe){or(m,u,Qe)}}break;case 5:Bo(Ne,Ne.return);break;case 22:if(Ne.memoizedState!==null){Gm(je);continue}}$e!==null?($e.return=Ne,Ge=$e):Gm(je)}Ae=Ae.sibling}e:for(Ae=null,je=s;;){if(je.tag===5){if(Ae===null){Ae=je;try{v=je.stateNode,_e?(b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(J=je.stateNode,ce=je.memoizedProps.style,D=ce!=null&&ce.hasOwnProperty("display")?ce.display:null,J.style.display=pt("display",D))}catch(Qe){or(s,s.return,Qe)}}}else if(je.tag===6){if(Ae===null)try{je.stateNode.nodeValue=_e?"":je.memoizedProps}catch(Qe){or(s,s.return,Qe)}}else if((je.tag!==22&&je.tag!==23||je.memoizedState===null||je===s)&&je.child!==null){je.child.return=je,je=je.child;continue}if(je===s)break e;for(;je.sibling===null;){if(je.return===null||je.return===s)break e;Ae===je&&(Ae=null),je=je.return}Ae===je&&(Ae=null),je.sibling.return=je.return,je=je.sibling}}break;case 19:Xn(i,s),da(s),m&4&&Ym(s);break;case 21:break;default:Xn(i,s),da(s)}}function da(s){var i=s.flags;if(i&2){try{e:{for(var u=s.return;u!==null;){if(Wm(u)){var m=u;break e}u=u.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(et(v,""),m.flags&=-33);var b=Um(s);b0(s,b,v);break;case 3:case 4:var D=m.stateNode.containerInfo,J=Um(s);_0(s,J,D);break;default:throw Error(t(161))}}catch(ce){or(s,s.return,ce)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function zk(s,i,u){Ge=s,Vm(s)}function Vm(s,i,u){for(var m=(s.mode&1)!==0;Ge!==null;){var v=Ge,b=v.child;if(v.tag===22&&m){var D=v.memoizedState!==null||Cc;if(!D){var J=v.alternate,ce=J!==null&&J.memoizedState!==null||Yr;J=Cc;var _e=Yr;if(Cc=D,(Yr=ce)&&!_e)for(Ge=v;Ge!==null;)D=Ge,ce=D.child,D.tag===22&&D.memoizedState!==null?Xm(v):ce!==null?(ce.return=D,Ge=ce):Xm(v);for(;b!==null;)Ge=b,Vm(b),b=b.sibling;Ge=v,Cc=J,Yr=_e}Km(s)}else(v.subtreeFlags&8772)!==0&&b!==null?(b.return=v,Ge=b):Km(s)}}function Km(s){for(;Ge!==null;){var i=Ge;if((i.flags&8772)!==0){var u=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Yr||Dc(5,i);break;case 1:var m=i.stateNode;if(i.flags&4&&!Yr)if(u===null)m.componentDidMount();else{var v=i.elementType===i.type?u.memoizedProps:Kn(i.type,u.memoizedProps);m.componentDidUpdate(v,u.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&Gh(i,b,m);break;case 3:var D=i.updateQueue;if(D!==null){if(u=null,i.child!==null)switch(i.child.tag){case 5:u=i.child.stateNode;break;case 1:u=i.child.stateNode}Gh(i,D,u)}break;case 5:var J=i.stateNode;if(u===null&&i.flags&4){u=J;var ce=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":ce.autoFocus&&u.focus();break;case"img":ce.src&&(u.src=ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var _e=i.alternate;if(_e!==null){var Ae=_e.memoizedState;if(Ae!==null){var je=Ae.dehydrated;je!==null&&Si(je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Yr||i.flags&512&&k0(i)}catch(Ne){or(i,i.return,Ne)}}if(i===s){Ge=null;break}if(u=i.sibling,u!==null){u.return=i.return,Ge=u;break}Ge=i.return}}function Gm(s){for(;Ge!==null;){var i=Ge;if(i===s){Ge=null;break}var u=i.sibling;if(u!==null){u.return=i.return,Ge=u;break}Ge=i.return}}function Xm(s){for(;Ge!==null;){var i=Ge;try{switch(i.tag){case 0:case 11:case 15:var u=i.return;try{Dc(4,i)}catch(ce){or(i,u,ce)}break;case 1:var m=i.stateNode;if(typeof m.componentDidMount=="function"){var v=i.return;try{m.componentDidMount()}catch(ce){or(i,v,ce)}}var b=i.return;try{k0(i)}catch(ce){or(i,b,ce)}break;case 5:var D=i.return;try{k0(i)}catch(ce){or(i,D,ce)}}}catch(ce){or(i,i.return,ce)}if(i===s){Ge=null;break}var J=i.sibling;if(J!==null){J.return=i.return,Ge=J;break}Ge=i.return}}var Bk=Math.ceil,Nc=z.ReactCurrentDispatcher,E0=z.ReactCurrentOwner,On=z.ReactCurrentBatchConfig,Dt=0,Nr=null,xr=null,Ir=0,_n=0,Wo=as(0),_r=0,Gi=null,Us=0,Fc=0,S0=0,Xi=null,hn=null,T0=0,Uo=1/0,ja=null,Ac=!1,C0=null,us=null,Oc=!1,fs=null,Pc=0,Qi=0,D0=null,Rc=-1,Mc=0;function en(){return(Dt&6)!==0?Me():Rc!==-1?Rc:Rc=Me()}function ds(s){return(s.mode&1)===0?1:(Dt&2)!==0&&Ir!==0?Ir&-Ir:bk.transition!==null?(Mc===0&&(Mc=Up()),Mc):(s=Wt,s!==0||(s=window.event,s=s===void 0?16:qp(s.type)),s)}function Qn(s,i,u,m){if(50<Qi)throw Qi=0,D0=null,Error(t(185));wi(s,u,m),((Dt&2)===0||s!==Nr)&&(s===Nr&&((Dt&2)===0&&(Fc|=u),_r===4&&ps(s,Ir)),mn(s,m),u===1&&Dt===0&&(i.mode&1)===0&&(Uo=Me()+500,cc&&os()))}function mn(s,i){var u=s.callbackNode;bw(s,i);var m=Yl(s,s===Nr?Ir:0);if(m===0)u!==null&&We(u),s.callbackNode=null,s.callbackPriority=0;else if(i=m&-m,s.callbackPriority!==i){if(u!=null&&We(u),i===1)s.tag===0?_k(qm.bind(null,s)):Ih(qm.bind(null,s)),vk(function(){(Dt&6)===0&&os()}),u=null;else{switch(Hp(m)){case 1:u=Bt;break;case 4:u=jt;break;case 16:u=ur;break;case 536870912:u=Qa;break;default:u=ur}u=sx(u,Qm.bind(null,s))}s.callbackPriority=i,s.callbackNode=u}}function Qm(s,i){if(Rc=-1,Mc=0,(Dt&6)!==0)throw Error(t(327));var u=s.callbackNode;if(Ho()&&s.callbackNode!==u)return null;var m=Yl(s,s===Nr?Ir:0);if(m===0)return null;if((m&30)!==0||(m&s.expiredLanes)!==0||i)i=Ic(s,m);else{i=m;var v=Dt;Dt|=2;var b=Jm();(Nr!==s||Ir!==i)&&(ja=null,Uo=Me()+500,Ys(s,i));do try{Hk();break}catch(J){Zm(s,J)}while(!0);Vf(),Nc.current=b,Dt=v,xr!==null?i=0:(Nr=null,Ir=0,i=_r)}if(i!==0){if(i===2&&(v=lf(s),v!==0&&(m=v,i=N0(s,v))),i===1)throw u=Gi,Ys(s,0),ps(s,m),mn(s,Me()),u;if(i===6)ps(s,m);else{if(v=s.current.alternate,(m&30)===0&&!Wk(v)&&(i=Ic(s,m),i===2&&(b=lf(s),b!==0&&(m=b,i=N0(s,b))),i===1))throw u=Gi,Ys(s,0),ps(s,m),mn(s,Me()),u;switch(s.finishedWork=v,s.finishedLanes=m,i){case 0:case 1:throw Error(t(345));case 2:$s(s,hn,ja);break;case 3:if(ps(s,m),(m&130023424)===m&&(i=T0+500-Me(),10<i)){if(Yl(s,0)!==0)break;if(v=s.suspendedLanes,(v&m)!==m){en(),s.pingedLanes|=s.suspendedLanes&v;break}s.timeoutHandle=Mf($s.bind(null,s,hn,ja),i);break}$s(s,hn,ja);break;case 4:if(ps(s,m),(m&4194240)===m)break;for(i=s.eventTimes,v=-1;0<m;){var D=31-fr(m);b=1<<D,D=i[D],D>v&&(v=D),m&=~b}if(m=v,m=Me()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*Bk(m/1960))-m,10<m){s.timeoutHandle=Mf($s.bind(null,s,hn,ja),m);break}$s(s,hn,ja);break;case 5:$s(s,hn,ja);break;default:throw Error(t(329))}}}return mn(s,Me()),s.callbackNode===u?Qm.bind(null,s):null}function N0(s,i){var u=Xi;return s.current.memoizedState.isDehydrated&&(Ys(s,i).flags|=256),s=Ic(s,i),s!==2&&(i=hn,hn=u,i!==null&&F0(i)),s}function F0(s){hn===null?hn=s:hn.push.apply(hn,s)}function Wk(s){for(var i=s;;){if(i.flags&16384){var u=i.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var m=0;m<u.length;m++){var v=u[m],b=v.getSnapshot;v=v.value;try{if(!$n(b(),v))return!1}catch{return!1}}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ps(s,i){for(i&=~S0,i&=~Fc,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var u=31-fr(i),m=1<<u;s[u]=-1,i&=~m}}function qm(s){if((Dt&6)!==0)throw Error(t(327));Ho();var i=Yl(s,0);if((i&1)===0)return mn(s,Me()),null;var u=Ic(s,i);if(s.tag!==0&&u===2){var m=lf(s);m!==0&&(i=m,u=N0(s,m))}if(u===1)throw u=Gi,Ys(s,0),ps(s,i),mn(s,Me()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,$s(s,hn,ja),mn(s,Me()),null}function A0(s,i){var u=Dt;Dt|=1;try{return s(i)}finally{Dt=u,Dt===0&&(Uo=Me()+500,cc&&os())}}function Hs(s){fs!==null&&fs.tag===0&&(Dt&6)===0&&Ho();var i=Dt;Dt|=1;var u=On.transition,m=Wt;try{if(On.transition=null,Wt=1,s)return s()}finally{Wt=m,On.transition=u,Dt=i,(Dt&6)===0&&os()}}function O0(){_n=Wo.current,qt(Wo)}function Ys(s,i){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,gk(u)),xr!==null)for(u=xr.return;u!==null;){var m=u;switch(Wf(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&ic();break;case 3:Lo(),qt(fn),qt(Wr),e0();break;case 5:Zf(m);break;case 4:Lo();break;case 13:qt(nr);break;case 19:qt(nr);break;case 10:Kf(m.type._context);break;case 22:case 23:O0()}u=u.return}if(Nr=s,xr=s=hs(s.current,null),Ir=_n=i,_r=0,Gi=null,S0=Fc=Us=0,hn=Xi=null,zs!==null){for(i=0;i<zs.length;i++)if(u=zs[i],m=u.interleaved,m!==null){u.interleaved=null;var v=m.next,b=u.pending;if(b!==null){var D=b.next;b.next=v,m.next=D}u.pending=m}zs=null}return s}function Zm(s,i){do{var u=xr;try{if(Vf(),yc.current=bc,wc){for(var m=ar.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}wc=!1}if(Ws=0,Dr=kr=ar=null,Ui=!1,Hi=0,E0.current=null,u===null||u.return===null){_r=1,Gi=i,xr=null;break}e:{var b=s,D=u.return,J=u,ce=i;if(i=Ir,J.flags|=32768,ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var _e=ce,Ae=J,je=Ae.tag;if((Ae.mode&1)===0&&(je===0||je===11||je===15)){var Ne=Ae.alternate;Ne?(Ae.updateQueue=Ne.updateQueue,Ae.memoizedState=Ne.memoizedState,Ae.lanes=Ne.lanes):(Ae.updateQueue=null,Ae.memoizedState=null)}var $e=bm(D);if($e!==null){$e.flags&=-257,Em($e,D,J,b,i),$e.mode&1&&_m(b,_e,i),i=$e,ce=_e;var Xe=i.updateQueue;if(Xe===null){var Qe=new Set;Qe.add(ce),i.updateQueue=Qe}else Xe.add(ce);break e}else{if((i&1)===0){_m(b,_e,i),P0();break e}ce=Error(t(426))}}else if(Zt&&J.mode&1){var dr=bm(D);if(dr!==null){(dr.flags&65536)===0&&(dr.flags|=256),Em(dr,D,J,b,i),Yf(zo(ce,J));break e}}b=ce=zo(ce,J),_r!==4&&(_r=2),Xi===null?Xi=[b]:Xi.push(b),b=D;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var xe=wm(b,ce,i);Kh(b,xe);break e;case 1:J=ce;var fe=b.type,ye=b.stateNode;if((b.flags&128)===0&&(typeof fe.getDerivedStateFromError=="function"||ye!==null&&typeof ye.componentDidCatch=="function"&&(us===null||!us.has(ye)))){b.flags|=65536,i&=-i,b.lanes|=i;var Be=km(b,J,i);Kh(b,Be);break e}}b=b.return}while(b!==null)}tx(u)}catch(Ze){i=Ze,xr===u&&u!==null&&(xr=u=u.return);continue}break}while(!0)}function Jm(){var s=Nc.current;return Nc.current=bc,s===null?bc:s}function P0(){(_r===0||_r===3||_r===2)&&(_r=4),Nr===null||(Us&268435455)===0&&(Fc&268435455)===0||ps(Nr,Ir)}function Ic(s,i){var u=Dt;Dt|=2;var m=Jm();(Nr!==s||Ir!==i)&&(ja=null,Ys(s,i));do try{Uk();break}catch(v){Zm(s,v)}while(!0);if(Vf(),Dt=u,Nc.current=m,xr!==null)throw Error(t(261));return Nr=null,Ir=0,_r}function Uk(){for(;xr!==null;)ex(xr)}function Hk(){for(;xr!==null&&!Pe();)ex(xr)}function ex(s){var i=ax(s.alternate,s,_n);s.memoizedProps=s.pendingProps,i===null?tx(s):xr=i,E0.current=null}function tx(s){var i=s;do{var u=i.alternate;if(s=i.return,(i.flags&32768)===0){if(u=Mk(u,i,_n),u!==null){xr=u;return}}else{if(u=Ik(u,i),u!==null){u.flags&=32767,xr=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{_r=6,xr=null;return}}if(i=i.sibling,i!==null){xr=i;return}xr=i=s}while(i!==null);_r===0&&(_r=5)}function $s(s,i,u){var m=Wt,v=On.transition;try{On.transition=null,Wt=1,Yk(s,i,u,m)}finally{On.transition=v,Wt=m}return null}function Yk(s,i,u,m){do Ho();while(fs!==null);if((Dt&6)!==0)throw Error(t(327));u=s.finishedWork;var v=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var b=u.lanes|u.childLanes;if(Ew(s,b),s===Nr&&(xr=Nr=null,Ir=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Oc||(Oc=!0,sx(ur,function(){return Ho(),null})),b=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||b){b=On.transition,On.transition=null;var D=Wt;Wt=1;var J=Dt;Dt|=4,E0.current=null,Lk(s,u),$m(u,s),uk(Pf),Kl=!!Of,Pf=Of=null,s.current=u,zk(u),Re(),Dt=J,Wt=D,On.transition=b}else s.current=u;if(Oc&&(Oc=!1,fs=s,Pc=v),b=s.pendingLanes,b===0&&(us=null),vi(u.stateNode),mn(s,Me()),i!==null)for(m=s.onRecoverableError,u=0;u<i.length;u++)v=i[u],m(v.value,{componentStack:v.stack,digest:v.digest});if(Ac)throw Ac=!1,s=C0,C0=null,s;return(Pc&1)!==0&&s.tag!==0&&Ho(),b=s.pendingLanes,(b&1)!==0?s===D0?Qi++:(Qi=0,D0=s):Qi=0,os(),null}function Ho(){if(fs!==null){var s=Hp(Pc),i=On.transition,u=Wt;try{if(On.transition=null,Wt=16>s?16:s,fs===null)var m=!1;else{if(s=fs,fs=null,Pc=0,(Dt&6)!==0)throw Error(t(331));var v=Dt;for(Dt|=4,Ge=s.current;Ge!==null;){var b=Ge,D=b.child;if((Ge.flags&16)!==0){var J=b.deletions;if(J!==null){for(var ce=0;ce<J.length;ce++){var _e=J[ce];for(Ge=_e;Ge!==null;){var Ae=Ge;switch(Ae.tag){case 0:case 11:case 15:Ki(8,Ae,b)}var je=Ae.child;if(je!==null)je.return=Ae,Ge=je;else for(;Ge!==null;){Ae=Ge;var Ne=Ae.sibling,$e=Ae.return;if(Bm(Ae),Ae===_e){Ge=null;break}if(Ne!==null){Ne.return=$e,Ge=Ne;break}Ge=$e}}}var Xe=b.alternate;if(Xe!==null){var Qe=Xe.child;if(Qe!==null){Xe.child=null;do{var dr=Qe.sibling;Qe.sibling=null,Qe=dr}while(Qe!==null)}}Ge=b}}if((b.subtreeFlags&2064)!==0&&D!==null)D.return=b,Ge=D;else e:for(;Ge!==null;){if(b=Ge,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:Ki(9,b,b.return)}var xe=b.sibling;if(xe!==null){xe.return=b.return,Ge=xe;break e}Ge=b.return}}var fe=s.current;for(Ge=fe;Ge!==null;){D=Ge;var ye=D.child;if((D.subtreeFlags&2064)!==0&&ye!==null)ye.return=D,Ge=ye;else e:for(D=fe;Ge!==null;){if(J=Ge,(J.flags&2048)!==0)try{switch(J.tag){case 0:case 11:case 15:Dc(9,J)}}catch(Ze){or(J,J.return,Ze)}if(J===D){Ge=null;break e}var Be=J.sibling;if(Be!==null){Be.return=J.return,Ge=Be;break e}Ge=J.return}}if(Dt=v,os(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(la,s)}catch{}m=!0}return m}finally{Wt=u,On.transition=i}}return!1}function rx(s,i,u){i=zo(u,i),i=wm(s,i,1),s=ls(s,i,1),i=en(),s!==null&&(wi(s,1,i),mn(s,i))}function or(s,i,u){if(s.tag===3)rx(s,s,u);else for(;i!==null;){if(i.tag===3){rx(i,s,u);break}else if(i.tag===1){var m=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(us===null||!us.has(m))){s=zo(u,s),s=km(i,s,1),i=ls(i,s,1),s=en(),i!==null&&(wi(i,1,s),mn(i,s));break}}i=i.return}}function $k(s,i,u){var m=s.pingCache;m!==null&&m.delete(i),i=en(),s.pingedLanes|=s.suspendedLanes&u,Nr===s&&(Ir&u)===u&&(_r===4||_r===3&&(Ir&130023424)===Ir&&500>Me()-T0?Ys(s,0):S0|=u),mn(s,i)}function nx(s,i){i===0&&((s.mode&1)===0?i=1:(i=Hl,Hl<<=1,(Hl&130023424)===0&&(Hl=4194304)));var u=en();s=Ra(s,i),s!==null&&(wi(s,i,u),mn(s,u))}function Vk(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),nx(s,u)}function Kk(s,i){var u=0;switch(s.tag){case 13:var m=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(i),nx(s,u)}var ax;ax=function(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps||fn.current)pn=!0;else{if((s.lanes&u)===0&&(i.flags&128)===0)return pn=!1,Rk(s,i,u);pn=(s.flags&131072)!==0}else pn=!1,Zt&&(i.flags&1048576)!==0&&jh(i,fc,i.index);switch(i.lanes=0,i.tag){case 2:var m=i.type;Tc(s,i),s=i.pendingProps;var v=Ao(i,Wr.current);jo(i,u),v=n0(null,i,m,s,v,u);var b=a0();return i.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,dn(m)?(b=!0,lc(i)):b=!1,i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Qf(i),v.updater=Ec,i.stateNode=v,v._reactInternals=i,u0(i,m,s,u),i=h0(null,i,m,!0,b,u)):(i.tag=0,Zt&&b&&Bf(i),Jr(null,i,v,u),i=i.child),i;case 16:m=i.elementType;e:{switch(Tc(s,i),s=i.pendingProps,v=m._init,m=v(m._payload),i.type=m,v=i.tag=Xk(m),s=Kn(m,s),v){case 0:i=p0(null,i,m,s,u);break e;case 1:i=Fm(null,i,m,s,u);break e;case 11:i=Sm(null,i,m,s,u);break e;case 14:i=Tm(null,i,m,Kn(m.type,s),u);break e}throw Error(t(306,m,""))}return i;case 0:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),p0(s,i,m,v,u);case 1:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Fm(s,i,m,v,u);case 3:e:{if(Am(i),s===null)throw Error(t(387));m=i.pendingProps,b=i.memoizedState,v=b.element,Vh(s,i),gc(i,m,null,u);var D=i.memoizedState;if(m=D.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){v=zo(Error(t(423)),i),i=Om(s,i,m,u,v);break e}else if(m!==v){v=zo(Error(t(424)),i),i=Om(s,i,m,u,v);break e}else for(kn=ns(i.stateNode.containerInfo.firstChild),wn=i,Zt=!0,Vn=null,u=Yh(i,null,m,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Ro(),m===v){i=Ia(s,i,u);break e}Jr(s,i,m,u)}i=i.child}return i;case 5:return Xh(i),s===null&&Hf(i),m=i.type,v=i.pendingProps,b=s!==null?s.memoizedProps:null,D=v.children,Rf(m,v)?D=null:b!==null&&Rf(m,b)&&(i.flags|=32),Nm(s,i),Jr(s,i,D,u),i.child;case 6:return s===null&&Hf(i),null;case 13:return Pm(s,i,u);case 4:return qf(i,i.stateNode.containerInfo),m=i.pendingProps,s===null?i.child=Mo(i,null,m,u):Jr(s,i,m,u),i.child;case 11:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Sm(s,i,m,v,u);case 7:return Jr(s,i,i.pendingProps,u),i.child;case 8:return Jr(s,i,i.pendingProps.children,u),i.child;case 12:return Jr(s,i,i.pendingProps.children,u),i.child;case 10:e:{if(m=i.type._context,v=i.pendingProps,b=i.memoizedProps,D=v.value,Gt(hc,m._currentValue),m._currentValue=D,b!==null)if($n(b.value,D)){if(b.children===v.children&&!fn.current){i=Ia(s,i,u);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var J=b.dependencies;if(J!==null){D=b.child;for(var ce=J.firstContext;ce!==null;){if(ce.context===m){if(b.tag===1){ce=Ma(-1,u&-u),ce.tag=2;var _e=b.updateQueue;if(_e!==null){_e=_e.shared;var Ae=_e.pending;Ae===null?ce.next=ce:(ce.next=Ae.next,Ae.next=ce),_e.pending=ce}}b.lanes|=u,ce=b.alternate,ce!==null&&(ce.lanes|=u),Gf(b.return,u,i),J.lanes|=u;break}ce=ce.next}}else if(b.tag===10)D=b.type===i.type?null:b.child;else if(b.tag===18){if(D=b.return,D===null)throw Error(t(341));D.lanes|=u,J=D.alternate,J!==null&&(J.lanes|=u),Gf(D,u,i),D=b.sibling}else D=b.child;if(D!==null)D.return=b;else for(D=b;D!==null;){if(D===i){D=null;break}if(b=D.sibling,b!==null){b.return=D.return,D=b;break}D=D.return}b=D}Jr(s,i,v.children,u),i=i.child}return i;case 9:return v=i.type,m=i.pendingProps.children,jo(i,u),v=Fn(v),m=m(v),i.flags|=1,Jr(s,i,m,u),i.child;case 14:return m=i.type,v=Kn(m,i.pendingProps),v=Kn(m.type,v),Tm(s,i,m,v,u);case 15:return Cm(s,i,i.type,i.pendingProps,u);case 17:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Tc(s,i),i.tag=1,dn(m)?(s=!0,lc(i)):s=!1,jo(i,u),vm(i,m,v),u0(i,m,v,u),h0(null,i,m,!0,s,u);case 19:return Mm(s,i,u);case 22:return Dm(s,i,u)}throw Error(t(156,i.tag))};function sx(s,i){return Oe(s,i)}function Gk(s,i,u,m){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,i,u,m){return new Gk(s,i,u,m)}function R0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Xk(s){if(typeof s=="function")return R0(s)?1:0;if(s!=null){if(s=s.$$typeof,s===U)return 11;if(s===ae)return 14}return 2}function hs(s,i){var u=s.alternate;return u===null?(u=Pn(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function jc(s,i,u,m,v,b){var D=2;if(m=s,typeof s=="function")R0(s)&&(D=1);else if(typeof s=="string")D=5;else e:switch(s){case C:return Vs(u.children,v,b,i);case Q:D=8,v|=8;break;case j:return s=Pn(12,u,i,v|2),s.elementType=j,s.lanes=b,s;case ue:return s=Pn(13,u,i,v),s.elementType=ue,s.lanes=b,s;case le:return s=Pn(19,u,i,v),s.elementType=le,s.lanes=b,s;case V:return Lc(u,v,b,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case te:D=10;break e;case X:D=9;break e;case U:D=11;break e;case ae:D=14;break e;case pe:D=16,m=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Pn(D,u,i,v),i.elementType=s,i.type=m,i.lanes=b,i}function Vs(s,i,u,m){return s=Pn(7,s,m,i),s.lanes=u,s}function Lc(s,i,u,m){return s=Pn(22,s,m,i),s.elementType=V,s.lanes=u,s.stateNode={isHidden:!1},s}function M0(s,i,u){return s=Pn(6,s,null,i),s.lanes=u,s}function I0(s,i,u){return i=Pn(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function Qk(s,i,u,m,v){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cf(0),this.expirationTimes=cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cf(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function j0(s,i,u,m,v,b,D,J,ce){return s=new Qk(s,i,u,J,ce),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Pn(3,null,null,i),s.current=b,b.stateNode=s,b.memoizedState={element:m,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qf(b),s}function qk(s,i,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:m==null?null:""+m,children:s,containerInfo:i,implementation:u}}function ox(s){if(!s)return ss;s=s._reactInternals;e:{if(q(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(dn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(dn(u))return Rh(s,u,i)}return i}function ix(s,i,u,m,v,b,D,J,ce){return s=j0(u,m,!0,s,v,b,D,J,ce),s.context=ox(null),u=s.current,m=en(),v=ds(u),b=Ma(m,v),b.callback=i??null,ls(u,b,v),s.current.lanes=v,wi(s,v,m),mn(s,m),s}function zc(s,i,u,m){var v=i.current,b=en(),D=ds(v);return u=ox(u),i.context===null?i.context=u:i.pendingContext=u,i=Ma(b,D),i.payload={element:s},m=m===void 0?null:m,m!==null&&(i.callback=m),s=ls(v,i,D),s!==null&&(Qn(s,v,D,b),xc(s,v,D)),D}function Bc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function lx(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function L0(s,i){lx(s,i),(s=s.alternate)&&lx(s,i)}function Zk(){return null}var cx=typeof reportError=="function"?reportError:function(s){console.error(s)};function z0(s){this._internalRoot=s}Wc.prototype.render=z0.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));zc(s,i,null,null)},Wc.prototype.unmount=z0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Hs(function(){zc(null,s,null,null)}),i[Fa]=null}};function Wc(s){this._internalRoot=s}Wc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Vp();s={blockedOn:null,target:s,priority:i};for(var u=0;u<es.length&&i!==0&&i<es[u].priority;u++);es.splice(u,0,s),u===0&&Xp(s)}};function B0(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Uc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function ux(){}function Jk(s,i,u,m,v){if(v){if(typeof m=="function"){var b=m;m=function(){var _e=Bc(D);b.call(_e)}}var D=ix(i,m,s,0,null,!1,!1,"",ux);return s._reactRootContainer=D,s[Fa]=D.current,Ri(s.nodeType===8?s.parentNode:s),Hs(),D}for(;v=s.lastChild;)s.removeChild(v);if(typeof m=="function"){var J=m;m=function(){var _e=Bc(ce);J.call(_e)}}var ce=j0(s,0,!1,null,null,!1,!1,"",ux);return s._reactRootContainer=ce,s[Fa]=ce.current,Ri(s.nodeType===8?s.parentNode:s),Hs(function(){zc(i,ce,u,m)}),ce}function Hc(s,i,u,m,v){var b=u._reactRootContainer;if(b){var D=b;if(typeof v=="function"){var J=v;v=function(){var ce=Bc(D);J.call(ce)}}zc(i,D,s,v)}else D=Jk(u,i,s,v,m);return Bc(D)}Yp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var u=yi(i.pendingLanes);u!==0&&(uf(i,u|1),mn(i,Me()),(Dt&6)===0&&(Uo=Me()+500,os()))}break;case 13:Hs(function(){var m=Ra(s,1);if(m!==null){var v=en();Qn(m,s,1,v)}}),L0(s,1)}},ff=function(s){if(s.tag===13){var i=Ra(s,134217728);if(i!==null){var u=en();Qn(i,s,134217728,u)}L0(s,134217728)}},$p=function(s){if(s.tag===13){var i=ds(s),u=Ra(s,i);if(u!==null){var m=en();Qn(u,s,i,m)}L0(s,i)}},Vp=function(){return Wt},Kp=function(s,i){var u=Wt;try{return Wt=s,i()}finally{Wt=u}},ze=function(s,i,u){switch(i){case"input":if(Ie(s,u),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<u.length;i++){var m=u[i];if(m!==s&&m.form===s.form){var v=oc(m);if(!v)throw Error(t(90));F(m),Ie(m,v)}}}break;case"textarea":kt(s,u);break;case"select":i=u.value,i!=null&&Fe(s,!!u.multiple,i,!1)}},wr=A0,nt=Hs;var e2={usingClientEntryPoint:!1,Events:[ji,No,oc,zt,Vt,A0]},qi={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t2={bundleType:qi.bundleType,version:qi.version,rendererPackageName:qi.rendererPackageName,rendererConfig:qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:z.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=we(s),s===null?null:s.stateNode},findFiberByHostInstance:qi.findFiberByHostInstance||Zk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yc.isDisabled&&Yc.supportsFiber)try{la=Yc.inject(t2),Cr=Yc}catch{}}return xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e2,xn.createPortal=function(s,i){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B0(i))throw Error(t(200));return qk(s,i,null,u)},xn.createRoot=function(s,i){if(!B0(s))throw Error(t(299));var u=!1,m="",v=cx;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=j0(s,1,!1,null,null,u,!1,m,v),s[Fa]=i.current,Ri(s.nodeType===8?s.parentNode:s),new z0(i)},xn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=we(i),s=s===null?null:s.stateNode,s},xn.flushSync=function(s){return Hs(s)},xn.hydrate=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!0,u)},xn.hydrateRoot=function(s,i,u){if(!B0(s))throw Error(t(405));var m=u!=null&&u.hydratedSources||null,v=!1,b="",D=cx;if(u!=null&&(u.unstable_strictMode===!0&&(v=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onRecoverableError!==void 0&&(D=u.onRecoverableError)),i=ix(i,null,s,1,u??null,v,!1,b,D),s[Fa]=i.current,Ri(s),m)for(s=0;s<m.length;s++)u=m[s],v=u._getVersion,v=v(u._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[u,v]:i.mutableSourceEagerHydrationData.push(u,v);return new Wc(i)},xn.render=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!1,u)},xn.unmountComponentAtNode=function(s){if(!Uc(s))throw Error(t(40));return s._reactRootContainer?(Hs(function(){Hc(null,null,s,!1,function(){s._reactRootContainer=null,s[Fa]=null})}),!0):!1},xn.unstable_batchedUpdates=A0,xn.unstable_renderSubtreeIntoContainer=function(s,i,u,m){if(!Uc(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Hc(s,i,u,!1,m)},xn.version="18.3.1-next-f1338f8080-20240426",xn}var vx;function Gd(){if(vx)return H0.exports;vx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),H0.exports=u2(),H0.exports}var yx;function f2(){if(yx)return $c;yx=1;var e=Gd();return $c.createRoot=e.createRoot,$c.hydrateRoot=e.hydrateRoot,$c}var d2=f2();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var p2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ia=(e,n)=>{const t=A.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...p},d)=>A.createElement("svg",{ref:d,...p2,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${h2(e)}`,c].join(" "),...p},[...n.map(([x,g])=>A.createElement(x,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=ia("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=ia("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=ia("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=ia("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=ia("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=ia("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=ia("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=ia("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=ia("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=ia("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=ia("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Vc={exports:{}},xs={},V0={exports:{}},K0,wx;function v2(){if(wx)return K0;wx=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K0=e,K0}var G0,kx;function y2(){if(kx)return G0;kx=1;var e=v2();function n(){}function t(){}return t.resetWarningCache=n,G0=function(){function r(l,c,f,p,d,x){if(x!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},G0}var _x;function Mv(){return _x||(_x=1,V0.exports=y2()()),V0.exports}var Kc={exports:{}},Rn={},Gc={exports:{}},bx;function Iv(){return bx||(bx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=d;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(x,g){return g.getPropertyValue("overflow")!=="visible"||x.scrollWidth<=0&&x.scrollHeight<=0}function l(x){var g=x.offsetWidth<=0&&x.offsetHeight<=0;if(g&&!x.innerHTML)return!0;try{var y=window.getComputedStyle(x),k=y.getPropertyValue("display");return g?k!==r&&o(x,y):k===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(x){for(var g=x,y=x.getRootNode&&x.getRootNode();g&&g!==document.body;){if(y&&g===y&&(g=y.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(x,g){var y=x.nodeName.toLowerCase(),k=a.test(y)&&!x.disabled||y==="a"&&x.href||g;return k&&c(x)}function p(x){var g=x.getAttribute("tabindex");g===null&&(g=void 0);var y=isNaN(g);return(y||g>=0)&&f(x,!y)}function d(x){var g=[].slice.call(x.querySelectorAll("*"),0).reduce(function(y,k){return y.concat(k.shadowRoot?d(k.shadowRoot):[k])},[]);return g.filter(p)}e.exports=n.default})(Gc,Gc.exports)),Gc.exports}var Ex;function w2(){if(Ex)return Rn;Ex=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.resetState=l,Rn.log=c,Rn.handleBlur=f,Rn.handleFocus=p,Rn.markForFocusLater=d,Rn.returnFocus=x,Rn.popWithoutFocus=g,Rn.setupScopedFocus=y,Rn.teardownScopedFocus=k;var e=Iv(),n=t(e);function t(w){return w&&w.__esModule?w:{default:w}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function p(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var w=(0,n.default)(a)[0]||a;w.focus()}},0)}}function d(){r.push(document.activeElement)}function x(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=null;try{r.length!==0&&(_=r.pop(),_.focus({preventScroll:w}));return}catch{console.warn(["You tried to return focus to",_,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function y(w){a=w,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",p,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",p))}function k(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",p)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",p))}return Rn}var Xc={exports:{}},Sx;function k2(){return Sx||(Sx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=Iv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var p=(0,r.default)(c);if(!p.length){f.preventDefault();return}var d=void 0,x=f.shiftKey,g=p[0],y=p[p.length-1],k=o();if(c===k){if(!x)return;d=y}if(y===k&&!x&&(d=g),g===k&&x&&(d=y),d){f.preventDefault(),d.focus();return}var w=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),_=w!=null&&w[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(_){var S=p.indexOf(k);if(S>-1&&(S+=x?-1:1),d=p[S],typeof d>"u"){f.preventDefault(),d=x?y:g,d.focus();return}f.preventDefault(),d.focus()}}e.exports=n.default})(Xc,Xc.exports)),Xc.exports}var qn={},X0,Tx;function _2(){if(Tx)return X0;Tx=1;var e=function(){};return X0=e,X0}var pa={},Q0={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Cx;function b2(){return Cx||(Cx=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(Q0)),Q0.exports}var Dx;function Jd(){if(Dx)return pa;Dx=1,Object.defineProperty(pa,"__esModule",{value:!0}),pa.canUseDOM=pa.SafeNodeList=pa.SafeHTMLCollection=void 0;var e=b2(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return pa.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},pa.SafeNodeList=r.canUseDOM?window.NodeList:{},pa.canUseDOM=r.canUseDOM,pa.default=a,pa}var Nx;function jv(){if(Nx)return qn;Nx=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.resetState=o,qn.log=l,qn.assertNodeList=c,qn.setElement=f,qn.validateElement=p,qn.hide=d,qn.show=x,qn.documentNotReadyOrSSRTesting=g;var e=_2(),n=r(e),t=Jd();function r(y){return y&&y.__esModule?y:{default:y}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(y){return y.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(y){return y.removeAttribute("aria-hidden")})),a=null}function l(){}function c(y,k){if(!y||!y.length)throw new Error("react-modal: No elements were found for selector "+k+".")}function f(y){var k=y;if(typeof k=="string"&&t.canUseDOM){var w=document.querySelectorAll(k);c(w,k),k=w}return a=k||a,a}function p(y){var k=y||a;return k?Array.isArray(k)||k instanceof HTMLCollection||k instanceof NodeList?k:[k]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function d(y){var k=!0,w=!1,_=void 0;try{for(var S=p(y)[Symbol.iterator](),P;!(k=(P=S.next()).done);k=!0){var T=P.value;T.setAttribute("aria-hidden","true")}}catch(z){w=!0,_=z}finally{try{!k&&S.return&&S.return()}finally{if(w)throw _}}}function x(y){var k=!0,w=!1,_=void 0;try{for(var S=p(y)[Symbol.iterator](),P;!(k=(P=S.next()).done);k=!0){var T=P.value;T.removeAttribute("aria-hidden")}}catch(z){w=!0,_=z}finally{try{!k&&S.return&&S.return()}finally{if(w)throw _}}}function g(){a=null}return qn}var Ks={},Fx;function E2(){if(Fx)return Ks;Fx=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.resetState=r,Ks.log=a;var e={},n={};function t(p,d){p.classList.remove(d)}function r(){var p=document.getElementsByTagName("html")[0];for(var d in e)t(p,e[d]);var x=document.body;for(var g in n)t(x,n[g]);e={},n={}}function a(){}var o=function(d,x){return d[x]||(d[x]=0),d[x]+=1,x},l=function(d,x){return d[x]&&(d[x]-=1),x},c=function(d,x,g){g.forEach(function(y){o(x,y),d.add(y)})},f=function(d,x,g){g.forEach(function(y){l(x,y),x[y]===0&&d.remove(y)})};return Ks.add=function(d,x){return c(d.classList,d.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks.remove=function(d,x){return f(d.classList,d.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks}var Yo={},Ax;function Lv(){if(Ax)return Yo;Ax=1,Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.log=r,Yo.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return Yo.default=t,Yo}var Ji={},Ox;function S2(){if(Ox)return Ji;Ox=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.resetState=l,Ji.log=c;var e=Lv(),n=t(e);function t(d){return d&&d.__esModule?d:{default:d}}var r=void 0,a=void 0,o=[];function l(){for(var d=[r,a],x=0;x<d.length;x++){var g=d[x];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var d=[r,a],x=0;x<d.length;x++){var g=d[x],y=g||{};console.log(y.nodeName,y.className,y.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function p(d,x){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=x,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(p),Ji}var Px;function T2(){return Px||(Px=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(le){for(var ae=1;ae<arguments.length;ae++){var pe=arguments[ae];for(var V in pe)Object.prototype.hasOwnProperty.call(pe,V)&&(le[V]=pe[V])}return le},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(le){return typeof le}:function(le){return le&&typeof Symbol=="function"&&le.constructor===Symbol&&le!==Symbol.prototype?"symbol":typeof le},a=(function(){function le(ae,pe){for(var V=0;V<pe.length;V++){var se=pe[V];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(ae,se.key,se)}}return function(ae,pe,V){return pe&&le(ae.prototype,pe),V&&le(ae,V),ae}})(),o=Nl(),l=Mv(),c=Z(l),f=w2(),p=z(f),d=k2(),x=Z(d),g=jv(),y=z(g),k=E2(),w=z(k),_=Jd(),S=Z(_),P=Lv(),T=Z(P);S2();function z(le){if(le&&le.__esModule)return le;var ae={};if(le!=null)for(var pe in le)Object.prototype.hasOwnProperty.call(le,pe)&&(ae[pe]=le[pe]);return ae.default=le,ae}function Z(le){return le&&le.__esModule?le:{default:le}}function L(le,ae){if(!(le instanceof ae))throw new TypeError("Cannot call a class as a function")}function C(le,ae){if(!le)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae&&(typeof ae=="object"||typeof ae=="function")?ae:le}function Q(le,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ae);le.prototype=Object.create(ae&&ae.prototype,{constructor:{value:le,enumerable:!1,writable:!0,configurable:!0}}),ae&&(Object.setPrototypeOf?Object.setPrototypeOf(le,ae):le.__proto__=ae)}var j={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},te=function(ae){return ae.code==="Tab"||ae.keyCode===9},X=function(ae){return ae.code==="Escape"||ae.keyCode===27},U=0,ue=(function(le){Q(ae,le);function ae(pe){L(this,ae);var V=C(this,(ae.__proto__||Object.getPrototypeOf(ae)).call(this,pe));return V.setOverlayRef=function(se){V.overlay=se,V.props.overlayRef&&V.props.overlayRef(se)},V.setContentRef=function(se){V.content=se,V.props.contentRef&&V.props.contentRef(se)},V.afterClose=function(){var se=V.props,M=se.appElement,H=se.ariaHideApp,O=se.htmlOpenClassName,E=se.bodyOpenClassName,I=se.parentSelector,R=I&&I().ownerDocument||document;E&&w.remove(R.body,E),O&&w.remove(R.getElementsByTagName("html")[0],O),H&&U>0&&(U-=1,U===0&&y.show(M)),V.props.shouldFocusAfterRender&&(V.props.shouldReturnFocusAfterClose?(p.returnFocus(V.props.preventScroll),p.teardownScopedFocus()):p.popWithoutFocus()),V.props.onAfterClose&&V.props.onAfterClose(),T.default.deregister(V)},V.open=function(){V.beforeOpen(),V.state.afterOpen&&V.state.beforeClose?(clearTimeout(V.closeTimer),V.setState({beforeClose:!1})):(V.props.shouldFocusAfterRender&&(p.setupScopedFocus(V.node),p.markForFocusLater()),V.setState({isOpen:!0},function(){V.openAnimationFrame=requestAnimationFrame(function(){V.setState({afterOpen:!0}),V.props.isOpen&&V.props.onAfterOpen&&V.props.onAfterOpen({overlayEl:V.overlay,contentEl:V.content})})}))},V.close=function(){V.props.closeTimeoutMS>0?V.closeWithTimeout():V.closeWithoutTimeout()},V.focusContent=function(){return V.content&&!V.contentHasFocus()&&V.content.focus({preventScroll:!0})},V.closeWithTimeout=function(){var se=Date.now()+V.props.closeTimeoutMS;V.setState({beforeClose:!0,closesAt:se},function(){V.closeTimer=setTimeout(V.closeWithoutTimeout,V.state.closesAt-Date.now())})},V.closeWithoutTimeout=function(){V.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},V.afterClose)},V.handleKeyDown=function(se){te(se)&&(0,x.default)(V.content,se),V.props.shouldCloseOnEsc&&X(se)&&(se.stopPropagation(),V.requestClose(se))},V.handleOverlayOnClick=function(se){V.shouldClose===null&&(V.shouldClose=!0),V.shouldClose&&V.props.shouldCloseOnOverlayClick&&(V.ownerHandlesClose()?V.requestClose(se):V.focusContent()),V.shouldClose=null},V.handleContentOnMouseUp=function(){V.shouldClose=!1},V.handleOverlayOnMouseDown=function(se){!V.props.shouldCloseOnOverlayClick&&se.target==V.overlay&&se.preventDefault()},V.handleContentOnClick=function(){V.shouldClose=!1},V.handleContentOnMouseDown=function(){V.shouldClose=!1},V.requestClose=function(se){return V.ownerHandlesClose()&&V.props.onRequestClose(se)},V.ownerHandlesClose=function(){return V.props.onRequestClose},V.shouldBeClosed=function(){return!V.state.isOpen&&!V.state.beforeClose},V.contentHasFocus=function(){return document.activeElement===V.content||V.content.contains(document.activeElement)},V.buildClassName=function(se,M){var H=(typeof M>"u"?"undefined":r(M))==="object"?M:{base:j[se],afterOpen:j[se]+"--after-open",beforeClose:j[se]+"--before-close"},O=H.base;return V.state.afterOpen&&(O=O+" "+H.afterOpen),V.state.beforeClose&&(O=O+" "+H.beforeClose),typeof M=="string"&&M?O+" "+M:O},V.attributesFromObject=function(se,M){return Object.keys(M).reduce(function(H,O){return H[se+"-"+O]=M[O],H},{})},V.state={afterOpen:!1,beforeClose:!1},V.shouldClose=null,V.moveFromContentToOverlay=null,V}return a(ae,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(V,se){this.props.isOpen&&!V.isOpen?this.open():!this.props.isOpen&&V.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!se.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var V=this.props,se=V.appElement,M=V.ariaHideApp,H=V.htmlOpenClassName,O=V.bodyOpenClassName,E=V.parentSelector,I=E&&E().ownerDocument||document;O&&w.add(I.body,O),H&&w.add(I.getElementsByTagName("html")[0],H),M&&(U+=1,y.hide(se)),T.default.register(this)}},{key:"render",value:function(){var V=this.props,se=V.id,M=V.className,H=V.overlayClassName,O=V.defaultStyles,E=V.children,I=M?{}:O.content,R=H?{}:O.overlay;if(this.shouldBeClosed())return null;var W={ref:this.setOverlayRef,className:this.buildClassName("overlay",H),style:t({},R,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},ie=t({id:se,ref:this.setContentRef,style:t({},I,this.props.style.content),className:this.buildClassName("content",M),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),de=this.props.contentElement(ie,E);return this.props.overlayElement(W,de)}}]),ae})(o.Component);ue.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},ue.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(S.default),c.default.instanceOf(_.SafeHTMLCollection),c.default.instanceOf(_.SafeNodeList),c.default.arrayOf(c.default.instanceOf(S.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=ue,e.exports=n.default})(Kc,Kc.exports)),Kc.exports}function zv(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Bv(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function Wv(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}zv.__suppressDeprecationWarning=!0;Bv.__suppressDeprecationWarning=!0;Wv.__suppressDeprecationWarning=!0;function C2(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=zv,n.componentWillReceiveProps=Bv),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=Wv;var c=n.componentDidUpdate;n.componentDidUpdate=function(p,d,x){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:x;c.call(this,p,d,g)}}return e}const D2=Object.freeze(Object.defineProperty({__proto__:null,polyfill:C2},Symbol.toStringTag,{value:"Module"})),N2=a2(D2);var Rx;function F2(){if(Rx)return xs;Rx=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.bodyOpenClassName=xs.portalClassName=void 0;var e=Object.assign||function(X){for(var U=1;U<arguments.length;U++){var ue=arguments[U];for(var le in ue)Object.prototype.hasOwnProperty.call(ue,le)&&(X[le]=ue[le])}return X},n=(function(){function X(U,ue){for(var le=0;le<ue.length;le++){var ae=ue[le];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(U,ae.key,ae)}}return function(U,ue,le){return ue&&X(U.prototype,ue),le&&X(U,le),U}})(),t=Nl(),r=_(t),a=Gd(),o=_(a),l=Mv(),c=_(l),f=T2(),p=_(f),d=jv(),x=w(d),g=Jd(),y=_(g),k=N2;function w(X){if(X&&X.__esModule)return X;var U={};if(X!=null)for(var ue in X)Object.prototype.hasOwnProperty.call(X,ue)&&(U[ue]=X[ue]);return U.default=X,U}function _(X){return X&&X.__esModule?X:{default:X}}function S(X,U){if(!(X instanceof U))throw new TypeError("Cannot call a class as a function")}function P(X,U){if(!X)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U&&(typeof U=="object"||typeof U=="function")?U:X}function T(X,U){if(typeof U!="function"&&U!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof U);X.prototype=Object.create(U&&U.prototype,{constructor:{value:X,enumerable:!1,writable:!0,configurable:!0}}),U&&(Object.setPrototypeOf?Object.setPrototypeOf(X,U):X.__proto__=U)}var z=xs.portalClassName="ReactModalPortal",Z=xs.bodyOpenClassName="ReactModal__Body--open",L=g.canUseDOM&&o.default.createPortal!==void 0,C=function(U){return document.createElement(U)},Q=function(){return L?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function j(X){return X()}var te=(function(X){T(U,X);function U(){var ue,le,ae,pe;S(this,U);for(var V=arguments.length,se=Array(V),M=0;M<V;M++)se[M]=arguments[M];return pe=(le=(ae=P(this,(ue=U.__proto__||Object.getPrototypeOf(U)).call.apply(ue,[this].concat(se))),ae),ae.removePortal=function(){!L&&o.default.unmountComponentAtNode(ae.node);var H=j(ae.props.parentSelector);H&&H.contains(ae.node)?H.removeChild(ae.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},ae.portalRef=function(H){ae.portal=H},ae.renderPortal=function(H){var O=Q(),E=O(ae,r.default.createElement(p.default,e({defaultStyles:U.defaultStyles},H)),ae.node);ae.portalRef(E)},le),P(ae,pe)}return n(U,[{key:"componentDidMount",value:function(){if(g.canUseDOM){L||(this.node=C("div")),this.node.className=this.props.portalClassName;var le=j(this.props.parentSelector);le.appendChild(this.node),!L&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(le){var ae=j(le.parentSelector),pe=j(this.props.parentSelector);return{prevParent:ae,nextParent:pe}}},{key:"componentDidUpdate",value:function(le,ae,pe){if(g.canUseDOM){var V=this.props,se=V.isOpen,M=V.portalClassName;le.portalClassName!==M&&(this.node.className=M);var H=pe.prevParent,O=pe.nextParent;O!==H&&(H.removeChild(this.node),O.appendChild(this.node)),!(!le.isOpen&&!se)&&!L&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var le=this.portal.state,ae=Date.now(),pe=le.isOpen&&this.props.closeTimeoutMS&&(le.closesAt||ae+this.props.closeTimeoutMS);pe?(le.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,pe-ae)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!L)return null;!this.node&&L&&(this.node=C("div"));var le=Q();return le(r.default.createElement(p.default,e({ref:this.portalRef,defaultStyles:U.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(le){x.setElement(le)}}]),U})(t.Component);return te.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(y.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(y.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},te.defaultProps={isOpen:!1,portalClassName:z,bodyOpenClassName:Z,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(U,ue){return r.default.createElement("div",U,ue)},contentElement:function(U,ue){return r.default.createElement("div",U,ue)}},te.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,k.polyfill)(te),xs.default=te,xs}var Mx;function A2(){return Mx||(Mx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=F2(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Vc,Vc.exports)),Vc.exports}var O2=A2();const Pr=Vu(O2);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Uv=1252,P2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ep={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tp=function(e){P2.indexOf(e)!=-1&&(Uv=ep[0]=e)};function R2(){tp(1252)}var ta=function(e){tp(e)};function Hv(){ta(1200),R2()}function Ix(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function M2(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Yv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var rl=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?M2(e.slice(2)):n==254&&t==255?Yv(e.slice(2)):n==65279?e.slice(1):e},Qc=function(n){return String.fromCharCode(n)},jx=function(n){return String.fromCharCode(n)},vl,ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Lx(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,p=0;p<e.length;)t=e.charCodeAt(p++),o=t>>2,r=e.charCodeAt(p++),l=(t&3)<<4|r>>4,a=e.charCodeAt(p++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=ks.charAt(o)+ks.charAt(l)+ks.charAt(c)+ks.charAt(f);return n}function Tn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<e.length;)o=ks.indexOf(e.charAt(p++)),l=ks.indexOf(e.charAt(p++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=ks.indexOf(e.charAt(p++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=ks.indexOf(e.charAt(p++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var _t=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ho=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Cs(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function zx(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ea=function(n){return _t?ho(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function mo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function rp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return rp(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var ys=_t?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ho(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function I2(e){for(var n=[],t=0,r=e.length+250,a=Cs(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=Cs(65535),r=65530)}return n.push(a.slice(0,t)),ys(n)}var cn=/\u0000/g,nl=/[\u0001-\u0006]/g;function qo(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function ra(e,n){var t=""+e;return t.length>=n?t:ir("0",n-t.length)+t}function np(e,n){var t=""+e;return t.length>=n?t:ir(" ",n-t.length)+t}function wu(e,n){var t=""+e;return t.length>=n?t:t+ir(" ",n-t.length)}function j2(e,n){var t=""+Math.round(e);return t.length>=n?t:ir("0",n-t.length)+t}function L2(e,n){var t=""+e;return t.length>=n?t:ir("0",n-t.length)+t}var Bx=Math.pow(2,32);function $o(e,n){if(e>Bx||e<-Bx)return j2(e,n);var t=Math.round(e);return L2(t,n)}function ku(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Wx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],q0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function z2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var mt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ux={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},B2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _u(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,p=0,d=0,x=Math.floor(a);p<n&&(x=Math.floor(a),c=x*l+o,d=x*p+f,!(a-x<5e-8));)a=1/(a-x),o=l,l=c,f=p,p=d;if(d>n&&(p>n?(d=f,c=o):(d=p,c=l)),!t)return[0,r*c,d];var g=Math.floor(r*c/d);return[g,r*c-g*d,d]}function Qs(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=V2(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var $v=new Date(1899,11,31,0,0,0),W2=$v.getTime(),U2=new Date(1900,2,1,0,0,0);function Vv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=U2&&(t+=1440*60*1e3),(t-(W2+(e.getTimezoneOffset()-$v.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ap(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function H2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Y2(e){var n=e<0?12:11,t=ap(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function $2(e){var n=ap(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function yl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=Y2(e):n===10?t=e.toFixed(10).substr(0,12):t=$2(e),ap(H2(t.toUpperCase()))}function oo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,Vv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function V2(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function K2(e,n,t,r){var a="",o=0,l=0,c=t.y,f,p=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,p=2;break;default:f=c%1e4,p=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,p=n.length;break;case 3:return q0[t.m-1][1];case 5:return q0[t.m-1][0];default:return q0[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,p=n.length;break;case 3:return Wx[t.q][0];default:return Wx[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,p=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,p=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,p=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?ra(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=ra(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}p=n.length===3?1:2;break;case 101:f=c,p=1;break}var d=p>0?ra(f,p):"";return d}function _s(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Kv=/%/g;function G2(e,n,t){var r=n.replace(Kv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+ir("%",a)}function X2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Gv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Gv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,p,d){return f+p+d.substr(0,(a+o)%a)+"."+d.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Xv=/# (\?+)( ?)\/( ?)(\d+)/;function Q2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?ir(" ",e[1].length+1+e[4].length):np(l,e[1].length)+e[2]+"/"+e[3]+ra(c,e[4].length))}function q2(e,n,t){return t+(n===0?"":""+n)+ir(" ",e[1].length+2+e[4].length)}var Qv=/^#*0*\.([0#]+)/,qv=/\).*[0#]/,Zv=/\(###\) ###\\?-####/;function tn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Hx(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Yx(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function Z2(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function J2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function jn(e,n,t){if(e.charCodeAt(0)===40&&!n.match(qv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?jn("n",r,t):"("+jn("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return X2(e,n,t);if(n.indexOf("%")!==-1)return G2(e,n,t);if(n.indexOf("E")!==-1)return Gv(n,t);if(n.charCodeAt(0)===36)return"$"+jn(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),p=t<0?"-":"";if(n.match(/^00+$/))return p+$o(f,n.length);if(n.match(/^[#?]+$/))return a=$o(t,0),a==="0"&&(a=""),a.length>n.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(Xv))return Q2(o,f,p);if(n.match(/^#+0+$/))return p+$o(f,n.length-n.indexOf("0"));if(o=n.match(Qv))return a=Hx(t,o[1].length).replace(/^([^\.]+)$/,"$1."+tn(o[1])).replace(/\.$/,"."+tn(o[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+ir("0",tn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return p+Hx(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return p+_s($o(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+jn(e,n,-t):_s(""+(Math.floor(t)+Z2(t,o[1].length)))+"."+ra(Yx(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return jn(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(jn(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(Zv))return a=jn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=_u(f,Math.pow(10,l)-1,!1),a=""+p,d=Ba("n",o[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+o[2]+"/"+o[3],d=wu(c[2],l),d.length<o[4].length&&(d=tn(o[4].substr(o[4].length-d.length))+d),a+=d,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=_u(f,Math.pow(10,l)-1,!0),p+(c[0]||(c[1]?"":"0"))+" "+(c[1]?np(c[1],l)+o[2]+"/"+o[3]+wu(c[2],l):ir(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=$o(t,0),n.length<=a.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return tn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Yx(t,o[1].length),t<0?"-"+jn(e,n,-t):_s(J2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(l,o[1].length);switch(n){case"###,##0.00":return jn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=_s($o(f,0));return y!=="0"?p+y:"";case"###,###.00":return jn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return jn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function e_(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function t_(e,n,t){var r=n.replace(Kv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+ir("%",a)}function Jv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Jv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,p,d){return f+p+d.substr(0,(a+o)%a)+"."+d.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ma(e,n,t){if(e.charCodeAt(0)===40&&!n.match(qv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ma("n",r,t):"("+ma("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return e_(e,n,t);if(n.indexOf("%")!==-1)return t_(e,n,t);if(n.indexOf("E")!==-1)return Jv(n,t);if(n.charCodeAt(0)===36)return"$"+ma(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),p=t<0?"-":"";if(n.match(/^00+$/))return p+ra(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(Xv))return q2(o,f,p);if(n.match(/^#+0+$/))return p+ra(f,n.length-n.indexOf("0"));if(o=n.match(Qv))return a=(""+t).replace(/^([^\.]+)$/,"$1."+tn(o[1])).replace(/\.$/,"."+tn(o[1])),a=a.replace(/\.(\d*)$/,function(k,w){return"."+w+ir("0",tn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return p+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return p+_s(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):_s(""+t)+"."+ir("0",o[1].length);if(o=n.match(/^#,#*,#0/))return ma(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(ma(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(Zv))return a=ma(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=_u(f,Math.pow(10,l)-1,!1),a=""+p,d=Ba("n",o[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+o[2]+"/"+o[3],d=wu(c[2],l),d.length<o[4].length&&(d=tn(o[4].substr(o[4].length-d.length))+d),a+=d,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=_u(f,Math.pow(10,l)-1,!0),p+(c[0]||(c[1]?"":"0"))+" "+(c[1]?np(c[1],l)+o[2]+"/"+o[3]+wu(c[2],l):ir(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:tn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return tn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ma(e,n,-t):_s(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var y=_s(""+f);return y!=="0"?p+y:"";default:if(n.match(/\.[0#?]*$/))return ma(e,n.slice(0,n.lastIndexOf(".")),t)+tn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Ba(e,n,t){return(t|0)===t?ma(e,n,t):jn(e,n,t)}function r_(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var e1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function di(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":ku(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(e1))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function n_(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",p,d,x,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!ku(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(x=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(x);a[a.length]={t:"t",v:o},++l;break;case"\\":var y=e.charAt(++l),k=y==="("||y===")"?y:"t";a[a.length]={t:k,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(p==null&&(p=Qs(n,t,e.charAt(l+1)==="2"),p==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||p==null&&(p=Qs(n,t),p==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"":var w={t:c,v:c};if(p==null&&(p=Qs(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(p!=null&&(w.v=p.H>=12?"P":"A"),w.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(p!=null&&(w.v=p.H>=12?"PM":"AM"),w.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="/"?(p!=null&&(w.v=p.H>=12?"":""),w.t="T",l+=5,g="h"):(w.t="t",++l),p==null&&w.t==="T")return"";a[a.length]=w,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(e1)){if(p==null&&(p=Qs(n,t),p==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",di(e)||(a[a.length]={t:"t",v:o}));break;case".":if(p!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var _=0,S=0,P;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",_<1&&(_=1);break;case"s":(P=a[l].v.match(/\.0+$/))&&(S=Math.max(S,P[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var T="",z;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=K2(a[l].t.charCodeAt(0),a[l].v,p,S),a[l].t="t";break;case"n":case"?":for(z=l+1;a[z]!=null&&((c=a[z].t)==="?"||c==="D"||(c===" "||c==="t")&&a[z+1]!=null&&(a[z+1].t==="?"||a[z+1].t==="t"&&a[z+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[z].v==="/"||a[z].v===" "&&a[z+1]!=null&&a[z+1].t=="?"));)a[l].v+=a[z].v,a[z]={v:"",t:";"},++z;T+=a[l].v,l=z-1;break;case"G":a[l].t="t",a[l].v=oo(n,t);break}var Z="",L,C;if(T.length>0){T.charCodeAt(0)==40?(L=n<0&&T.charCodeAt(0)===45?-n:n,C=Ba("n",T,L)):(L=n<0&&r>1?-n:n,C=Ba("n",T,L),L<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),z=C.length-1;var Q=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){Q=l;break}var j=a.length;if(Q===a.length&&C.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(z>=a[l].v.length-1?(z-=a[l].v.length,a[l].v=C.substr(z+1,a[l].v.length)):z<0?a[l].v="":(a[l].v=C.substr(0,z+1),z=-1),a[l].t="t",j=l);z>=0&&j<a.length&&(a[j].v=C.substr(0,z+1)+a[j].v)}else if(Q!==a.length&&C.indexOf("E")===-1){for(z=C.indexOf(".")-1,l=Q;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(d=a[l].v.indexOf(".")>-1&&l===Q?a[l].v.indexOf(".")-1:a[l].v.length-1,Z=a[l].v.substr(d+1);d>=0;--d)z>=0&&(a[l].v.charAt(d)==="0"||a[l].v.charAt(d)==="#")&&(Z=C.charAt(z--)+Z);a[l].v=Z,a[l].t="t",j=l}for(z>=0&&j<a.length&&(a[j].v=C.substr(0,z+1)+a[j].v),z=C.indexOf(".")+1,l=Q;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==Q)){for(d=a[l].v.indexOf(".")>-1&&l===Q?a[l].v.indexOf(".")+1:0,Z=a[l].v.substr(0,d);d<a[l].v.length;++d)z<C.length&&(Z+=C.charAt(z++));a[l].v=Z,a[l].t="t",j=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(L=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=Ba(a[l].t,a[l].v,L),a[l].t="t");var te="";for(l=0;l!==a.length;++l)a[l]!=null&&(te+=a[l].v);return te}var $x=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vx(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function a_(e,n){var t=r_(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match($x),c=t[1].match($x);return Vx(n,l)?[r,t[0]]:Vx(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Un(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:mt)[e],r==null&&(r=t.table&&t.table[Ux[e]]||mt[Ux[e]]),r==null&&(r=B2[e]||"General");break}if(ku(r,0))return oo(n,t);n instanceof Date&&(n=Vv(n,t.date1904));var a=a_(r,n);if(ku(a[1]))return oo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return n_(a[1],n,t,a[0])}function eo(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(mt[t]==null){n<0&&(n=t);continue}if(mt[t]==e){n=t;break}}n<0&&(n=391)}return mt[n]=e,n}function t1(){mt=z2()}var s_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},r1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function o_(e){var n=typeof e=="number"?mt[e]:e;return n=n.replace(r1,"(\\d+)"),new RegExp("^"+n+"$")}function i_(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(r1)||[]).forEach(function(x,g){var y=parseInt(t[g+1],10);switch(x.toLowerCase().charAt(0)){case"y":r=y;break;case"d":o=y;break;case"h":l=y;break;case"s":f=y;break;case"m":l>=0?c=y:a=y;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var p=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?p:r==-1&&a==-1&&o==-1?d:p+"T"+d}var l_=(function(){var e={};e.version="1.2.0";function n(){for(var C=0,Q=new Array(256),j=0;j!=256;++j)C=j,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,Q[j]=C;return typeof Int32Array<"u"?new Int32Array(Q):Q}var t=n();function r(C){var Q=0,j=0,te=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)X[te]=C[te];for(te=0;te!=256;++te)for(j=C[te],Q=256+te;Q<4096;Q+=256)j=X[Q]=j>>>8^C[j&255];var U=[];for(te=1;te!=16;++te)U[te-1]=typeof Int32Array<"u"?X.subarray(te*256,te*256+256):X.slice(te*256,te*256+256);return U}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],p=a[4],d=a[5],x=a[6],g=a[7],y=a[8],k=a[9],w=a[10],_=a[11],S=a[12],P=a[13],T=a[14];function z(C,Q){for(var j=Q^-1,te=0,X=C.length;te<X;)j=j>>>8^t[(j^C.charCodeAt(te++))&255];return~j}function Z(C,Q){for(var j=Q^-1,te=C.length-15,X=0;X<te;)j=T[C[X++]^j&255]^P[C[X++]^j>>8&255]^S[C[X++]^j>>16&255]^_[C[X++]^j>>>24]^w[C[X++]]^k[C[X++]]^y[C[X++]]^g[C[X++]]^x[C[X++]]^d[C[X++]]^p[C[X++]]^f[C[X++]]^c[C[X++]]^l[C[X++]]^o[C[X++]]^t[C[X++]];for(te+=15;X<te;)j=j>>>8^t[(j^C[X++])&255];return~j}function L(C,Q){for(var j=Q^-1,te=0,X=C.length,U=0,ue=0;te<X;)U=C.charCodeAt(te++),U<128?j=j>>>8^t[(j^U)&255]:U<2048?(j=j>>>8^t[(j^(192|U>>6&31))&255],j=j>>>8^t[(j^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,ue=C.charCodeAt(te++)&1023,j=j>>>8^t[(j^(240|U>>8&7))&255],j=j>>>8^t[(j^(128|U>>2&63))&255],j=j>>>8^t[(j^(128|ue>>6&15|(U&3)<<4))&255],j=j>>>8^t[(j^(128|ue&63))&255]):(j=j>>>8^t[(j^(224|U>>12&15))&255],j=j>>>8^t[(j^(128|U>>6&63))&255],j=j>>>8^t[(j^(128|U&63))&255]);return~j}return e.table=t,e.bstr=z,e.buf=Z,e.str=L,e})(),Et=(function(){var n={};n.version="1.2.1";function t(N,G){for(var B=N.split("/"),Y=G.split("/"),K=0,q=0,ve=Math.min(B.length,Y.length);K<ve;++K){if(q=B[K].length-Y[K].length)return q;if(B[K]!=Y[K])return B[K]<Y[K]?-1:1}return B.length-Y.length}function r(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:r(N.slice(0,-1));var G=N.lastIndexOf("/");return G===-1?N:N.slice(0,G+1)}function a(N){if(N.charAt(N.length-1)=="/")return a(N.slice(0,-1));var G=N.lastIndexOf("/");return G===-1?N:N.slice(G+1)}function o(N,G){typeof G=="string"&&(G=new Date(G));var B=G.getHours();B=B<<6|G.getMinutes(),B=B<<5|G.getSeconds()>>>1,N.write_shift(2,B);var Y=G.getFullYear()-1980;Y=Y<<4|G.getMonth()+1,Y=Y<<5|G.getDate(),N.write_shift(2,Y)}function l(N){var G=N.read_shift(2)&65535,B=N.read_shift(2)&65535,Y=new Date,K=B&31;B>>>=5;var q=B&15;B>>>=4,Y.setMilliseconds(0),Y.setFullYear(B+1980),Y.setMonth(q-1),Y.setDate(K);var ve=G&31;G>>>=5;var Te=G&63;return G>>>=6,Y.setHours(G),Y.setMinutes(Te),Y.setSeconds(ve<<1),Y}function c(N){jr(N,0);for(var G={},B=0;N.l<=N.length-4;){var Y=N.read_shift(2),K=N.read_shift(2),q=N.l+K,ve={};switch(Y){case 21589:B=N.read_shift(1),B&1&&(ve.mtime=N.read_shift(4)),K>5&&(B&2&&(ve.atime=N.read_shift(4)),B&4&&(ve.ctime=N.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}N.l=q,G[Y]=ve}return G}var f;function p(){return f||(f={})}function d(N,G){if(N[0]==80&&N[1]==75)return ze(N,G);if((N[0]|32)==109&&(N[1]|32)==105)return Tr(N,G);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var B=3,Y=512,K=0,q=0,ve=0,Te=0,ge=0,we=[],ke=N.slice(0,512);jr(ke,0);var Oe=x(ke);switch(B=Oe[0],B){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Oe[1]==0)return ze(N,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}Y!==512&&(ke=N.slice(0,Y),jr(ke,28));var We=N.slice(0,Y);g(ke,B);var Pe=ke.read_shift(4,"i");if(B===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);ke.l+=4,ve=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Te=ke.read_shift(4,"i"),K=ke.read_shift(4,"i"),ge=ke.read_shift(4,"i"),q=ke.read_shift(4,"i");for(var Re=-1,Me=0;Me<109&&(Re=ke.read_shift(4,"i"),!(Re<0));++Me)we[Me]=Re;var lt=y(N,Y);_(ge,q,lt,Y,we);var Bt=P(lt,ve,we,Y);Bt[ve].name="!Directory",K>0&&Te!==ue&&(Bt[Te].name="!MiniFAT"),Bt[we[0]].name="!FAT",Bt.fat_addrs=we,Bt.ssz=Y;var jt={},ur=[],Rs=[],Qa=[];T(ve,Bt,lt,ur,K,jt,Rs,Te),k(Rs,Qa,ur),ur.shift();var la={FileIndex:Rs,FullPaths:Qa};return G&&G.raw&&(la.raw={header:We,sectors:lt}),la}function x(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(le,"Header Signature: "),N.l+=16;var G=N.read_shift(2,"u");return[N.read_shift(2,"u"),G]}function g(N,G){var B=9;switch(N.l+=2,B=N.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function y(N,G){for(var B=Math.ceil(N.length/G)-1,Y=[],K=1;K<B;++K)Y[K-1]=N.slice(K*G,(K+1)*G);return Y[B-1]=N.slice(B*G),Y}function k(N,G,B){for(var Y=0,K=0,q=0,ve=0,Te=0,ge=B.length,we=[],ke=[];Y<ge;++Y)we[Y]=ke[Y]=Y,G[Y]=B[Y];for(;Te<ke.length;++Te)Y=ke[Te],K=N[Y].L,q=N[Y].R,ve=N[Y].C,we[Y]===Y&&(K!==-1&&we[K]!==K&&(we[Y]=we[K]),q!==-1&&we[q]!==q&&(we[Y]=we[q])),ve!==-1&&(we[ve]=Y),K!==-1&&Y!=we[Y]&&(we[K]=we[Y],ke.lastIndexOf(K)<Te&&ke.push(K)),q!==-1&&Y!=we[Y]&&(we[q]=we[Y],ke.lastIndexOf(q)<Te&&ke.push(q));for(Y=1;Y<ge;++Y)we[Y]===Y&&(q!==-1&&we[q]!==q?we[Y]=we[q]:K!==-1&&we[K]!==K&&(we[Y]=we[K]));for(Y=1;Y<ge;++Y)if(N[Y].type!==0){if(Te=Y,Te!=we[Te])do Te=we[Te],G[Y]=G[Te]+"/"+G[Y];while(Te!==0&&we[Te]!==-1&&Te!=we[Te]);we[Y]=-1}for(G[0]+="/",Y=1;Y<ge;++Y)N[Y].type!==2&&(G[Y]+="/")}function w(N,G,B){for(var Y=N.start,K=N.size,q=[],ve=Y;B&&K>0&&ve>=0;)q.push(G.slice(ve*U,ve*U+U)),K-=U,ve=Xs(B,ve*4);return q.length===0?br(0):ys(q).slice(0,N.size)}function _(N,G,B,Y,K){var q=ue;if(N===ue){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ve=B[N],Te=(Y>>>2)-1;if(!ve)return;for(var ge=0;ge<Te&&(q=Xs(ve,ge*4))!==ue;++ge)K.push(q);_(Xs(ve,Y-4),G-1,B,Y,K)}}function S(N,G,B,Y,K){var q=[],ve=[];K||(K=[]);var Te=Y-1,ge=0,we=0;for(ge=G;ge>=0;){K[ge]=!0,q[q.length]=ge,ve.push(N[ge]);var ke=B[Math.floor(ge*4/Y)];if(we=ge*4&Te,Y<4+we)throw new Error("FAT boundary crossed: "+ge+" 4 "+Y);if(!N[ke])break;ge=Xs(N[ke],we)}return{nodes:q,data:rg([ve])}}function P(N,G,B,Y){var K=N.length,q=[],ve=[],Te=[],ge=[],we=Y-1,ke=0,Oe=0,We=0,Pe=0;for(ke=0;ke<K;++ke)if(Te=[],We=ke+G,We>=K&&(We-=K),!ve[We]){ge=[];var Re=[];for(Oe=We;Oe>=0;){Re[Oe]=!0,ve[Oe]=!0,Te[Te.length]=Oe,ge.push(N[Oe]);var Me=B[Math.floor(Oe*4/Y)];if(Pe=Oe*4&we,Y<4+Pe)throw new Error("FAT boundary crossed: "+Oe+" 4 "+Y);if(!N[Me]||(Oe=Xs(N[Me],Pe),Re[Oe]))break}q[We]={nodes:Te,data:rg([ge])}}return q}function T(N,G,B,Y,K,q,ve,Te){for(var ge=0,we=Y.length?2:0,ke=G[N].data,Oe=0,We=0,Pe;Oe<ke.length;Oe+=128){var Re=ke.slice(Oe,Oe+128);jr(Re,64),We=Re.read_shift(2),Pe=cp(Re,0,We-we),Y.push(Pe);var Me={name:Pe,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},lt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);lt!==0&&(Me.ct=z(Re,Re.l-8));var Bt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Bt!==0&&(Me.mt=z(Re,Re.l-8)),Me.start=Re.read_shift(4,"i"),Me.size=Re.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=ue,Me.name=""),Me.type===5?(ge=Me.start,K>0&&ge!==ue&&(G[ge].name="!StreamData")):Me.size>=4096?(Me.storage="fat",G[Me.start]===void 0&&(G[Me.start]=S(B,Me.start,G.fat_addrs,G.ssz)),G[Me.start].name=Me.name,Me.content=G[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:ge!==ue&&Me.start!==ue&&G[ge]&&(Me.content=w(Me,G[ge].data,(G[Te]||{}).data))),Me.content&&jr(Me.content,0),q[Pe]=Me,ve.push(Me)}}function z(N,G){return new Date((bn(N,G+4)/1e7*Math.pow(2,32)+bn(N,G)/1e7-11644473600)*1e3)}function Z(N,G){return p(),d(f.readFileSync(N),G)}function L(N,G){var B=G&&G.type;switch(B||_t&&Buffer.isBuffer(N)&&(B="buffer"),B||"base64"){case"file":return Z(N,G);case"base64":return d(ea(Tn(N)),G);case"binary":return d(ea(N),G)}return d(N,G)}function C(N,G){var B=G||{},Y=B.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=Y+"/",N.FileIndex[0]={name:Y,type:5}),B.CLSID&&(N.FileIndex[0].clsid=B.CLSID),Q(N)}function Q(N){var G="Sh33tJ5";if(!Et.find(N,"/"+G)){var B=br(4);B[0]=55,B[1]=B[3]=50,B[2]=54,N.FileIndex.push({name:G,type:2,content:B,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+G),j(N)}}function j(N,G){C(N);for(var B=!1,Y=!1,K=N.FullPaths.length-1;K>=0;--K){var q=N.FileIndex[K];switch(q.type){case 0:Y?B=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(q.R*q.L*q.C)&&(B=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!G)){var ve=new Date(1987,1,19),Te=0,ge=Object.create?Object.create(null):{},we=[];for(K=0;K<N.FullPaths.length;++K)ge[N.FullPaths[K]]=!0,N.FileIndex[K].type!==0&&we.push([N.FullPaths[K],N.FileIndex[K]]);for(K=0;K<we.length;++K){var ke=r(we[K][0]);Y=ge[ke],Y||(we.push([ke,{name:a(ke).replace("/",""),type:1,clsid:pe,ct:ve,mt:ve,content:null}]),ge[ke]=!0)}for(we.sort(function(Pe,Re){return t(Pe[0],Re[0])}),N.FullPaths=[],N.FileIndex=[],K=0;K<we.length;++K)N.FullPaths[K]=we[K][0],N.FileIndex[K]=we[K][1];for(K=0;K<we.length;++K){var Oe=N.FileIndex[K],We=N.FullPaths[K];if(Oe.name=a(We).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||pe,K===0)Oe.C=we.length>1?1:-1,Oe.size=0,Oe.type=5;else if(We.slice(-1)=="/"){for(Te=K+1;Te<we.length&&r(N.FullPaths[Te])!=We;++Te);for(Oe.C=Te>=we.length?-1:Te,Te=K+1;Te<we.length&&r(N.FullPaths[Te])!=r(We);++Te);Oe.R=Te>=we.length?-1:Te,Oe.type=1}else r(N.FullPaths[K+1]||"")==r(We)&&(Oe.R=K+1),Oe.type=2}}}function te(N,G){var B=G||{};if(B.fileType=="mad")return Zr(N,B);switch(j(N),B.fileType){case"zip":return tt(N,B)}var Y=(function(Pe){for(var Re=0,Me=0,lt=0;lt<Pe.FileIndex.length;++lt){var Bt=Pe.FileIndex[lt];if(Bt.content){var jt=Bt.content.length;jt>0&&(jt<4096?Re+=jt+63>>6:Me+=jt+511>>9)}}for(var ur=Pe.FullPaths.length+3>>2,Rs=Re+7>>3,Qa=Re+127>>7,la=Rs+Me+ur+Qa,Cr=la+127>>7,vi=Cr<=109?0:Math.ceil((Cr-109)/127);la+Cr+vi+127>>7>Cr;)vi=++Cr<=109?0:Math.ceil((Cr-109)/127);var fr=[1,vi,Cr,Qa,ur,Me,Re,0];return Pe.FileIndex[0].size=Re<<6,fr[7]=(Pe.FileIndex[0].start=fr[0]+fr[1]+fr[2]+fr[3]+fr[4]+fr[5])+(fr[6]+7>>3),fr})(N),K=br(Y[7]<<9),q=0,ve=0;{for(q=0;q<8;++q)K.write_shift(1,ae[q]);for(q=0;q<8;++q)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),q=0;q<3;++q)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,Y[2]),K.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:ue),K.write_shift(4,Y[3]),K.write_shift(-4,Y[1]?Y[0]-1:ue),K.write_shift(4,Y[1]),q=0;q<109;++q)K.write_shift(-4,q<Y[2]?Y[1]+q:-1)}if(Y[1])for(ve=0;ve<Y[1];++ve){for(;q<236+ve*127;++q)K.write_shift(-4,q<Y[2]?Y[1]+q:-1);K.write_shift(-4,ve===Y[1]-1?ue:ve+1)}var Te=function(Pe){for(ve+=Pe;q<ve-1;++q)K.write_shift(-4,q+1);Pe&&(++q,K.write_shift(-4,ue))};for(ve=q=0,ve+=Y[1];q<ve;++q)K.write_shift(-4,V.DIFSECT);for(ve+=Y[2];q<ve;++q)K.write_shift(-4,V.FATSECT);Te(Y[3]),Te(Y[4]);for(var ge=0,we=0,ke=N.FileIndex[0];ge<N.FileIndex.length;++ge)ke=N.FileIndex[ge],ke.content&&(we=ke.content.length,!(we<4096)&&(ke.start=ve,Te(we+511>>9)));for(Te(Y[6]+7>>3);K.l&511;)K.write_shift(-4,V.ENDOFCHAIN);for(ve=q=0,ge=0;ge<N.FileIndex.length;++ge)ke=N.FileIndex[ge],ke.content&&(we=ke.content.length,!(!we||we>=4096)&&(ke.start=ve,Te(we+63>>6)));for(;K.l&511;)K.write_shift(-4,V.ENDOFCHAIN);for(q=0;q<Y[4]<<2;++q){var Oe=N.FullPaths[q];if(!Oe||Oe.length===0){for(ge=0;ge<17;++ge)K.write_shift(4,0);for(ge=0;ge<3;++ge)K.write_shift(4,-1);for(ge=0;ge<12;++ge)K.write_shift(4,0);continue}ke=N.FileIndex[q],q===0&&(ke.start=ke.size?ke.start-1:ue);var We=q===0&&B.root||ke.name;if(we=2*(We.length+1),K.write_shift(64,We,"utf16le"),K.write_shift(2,we),K.write_shift(1,ke.type),K.write_shift(1,ke.color),K.write_shift(-4,ke.L),K.write_shift(-4,ke.R),K.write_shift(-4,ke.C),ke.clsid)K.write_shift(16,ke.clsid,"hex");else for(ge=0;ge<4;++ge)K.write_shift(4,0);K.write_shift(4,ke.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,ke.start),K.write_shift(4,ke.size),K.write_shift(4,0)}for(q=1;q<N.FileIndex.length;++q)if(ke=N.FileIndex[q],ke.size>=4096)if(K.l=ke.start+1<<9,_t&&Buffer.isBuffer(ke.content))ke.content.copy(K,K.l,0,ke.size),K.l+=ke.size+511&-512;else{for(ge=0;ge<ke.size;++ge)K.write_shift(1,ke.content[ge]);for(;ge&511;++ge)K.write_shift(1,0)}for(q=1;q<N.FileIndex.length;++q)if(ke=N.FileIndex[q],ke.size>0&&ke.size<4096)if(_t&&Buffer.isBuffer(ke.content))ke.content.copy(K,K.l,0,ke.size),K.l+=ke.size+63&-64;else{for(ge=0;ge<ke.size;++ge)K.write_shift(1,ke.content[ge]);for(;ge&63;++ge)K.write_shift(1,0)}if(_t)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function X(N,G){var B=N.FullPaths.map(function(ge){return ge.toUpperCase()}),Y=B.map(function(ge){var we=ge.split("/");return we[we.length-(ge.slice(-1)=="/"?2:1)]}),K=!1;G.charCodeAt(0)===47?(K=!0,G=B[0].slice(0,-1)+G):K=G.indexOf("/")!==-1;var q=G.toUpperCase(),ve=K===!0?B.indexOf(q):Y.indexOf(q);if(ve!==-1)return N.FileIndex[ve];var Te=!q.match(nl);for(q=q.replace(cn,""),Te&&(q=q.replace(nl,"!")),ve=0;ve<B.length;++ve)if((Te?B[ve].replace(nl,"!"):B[ve]).replace(cn,"")==q||(Te?Y[ve].replace(nl,"!"):Y[ve]).replace(cn,"")==q)return N.FileIndex[ve];return null}var U=64,ue=-2,le="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(N,G,B){p();var Y=te(N,B);f.writeFileSync(G,Y)}function M(N){for(var G=new Array(N.length),B=0;B<N.length;++B)G[B]=String.fromCharCode(N[B]);return G.join("")}function H(N,G){var B=te(N,G);switch(G&&G.type||"buffer"){case"file":return p(),f.writeFileSync(G.filename,B),B;case"binary":return typeof B=="string"?B:M(B);case"base64":return Lx(typeof B=="string"?B:M(B));case"buffer":if(_t)return Buffer.isBuffer(B)?B:ho(B);case"array":return typeof B=="string"?ea(B):B}return B}var O;function E(N){try{var G=N.InflateRaw,B=new G;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)O=N;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function I(N,G){if(!O)return me(N,G);var B=O.InflateRaw,Y=new B,K=Y._processChunk(N.slice(N.l),Y._finishFlushFlag);return N.l+=Y.bytesRead,K}function R(N){return O?O.deflateRawSync(N):et(N)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(N){var G=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(G>>16|G>>8|G)&255}for(var oe=typeof Uint8Array<"u",ee=oe?new Uint8Array(256):[],re=0;re<256;++re)ee[re]=he(re);function F(N,G){var B=ee[N&255];return G<=8?B>>>8-G:(B=B<<8|ee[N>>8&255],G<=16?B>>>16-G:(B=B<<8|ee[N>>16&255],B>>>24-G))}function Ce(N,G){var B=G&7,Y=G>>>3;return(N[Y]|(B<=6?0:N[Y+1]<<8))>>>B&3}function De(N,G){var B=G&7,Y=G>>>3;return(N[Y]|(B<=5?0:N[Y+1]<<8))>>>B&7}function Ve(N,G){var B=G&7,Y=G>>>3;return(N[Y]|(B<=4?0:N[Y+1]<<8))>>>B&15}function He(N,G){var B=G&7,Y=G>>>3;return(N[Y]|(B<=3?0:N[Y+1]<<8))>>>B&31}function Ie(N,G){var B=G&7,Y=G>>>3;return(N[Y]|(B<=1?0:N[Y+1]<<8))>>>B&127}function ne(N,G,B){var Y=G&7,K=G>>>3,q=(1<<B)-1,ve=N[K]>>>Y;return B<8-Y||(ve|=N[K+1]<<8-Y,B<16-Y)||(ve|=N[K+2]<<16-Y,B<24-Y)||(ve|=N[K+3]<<24-Y),ve&q}function Se(N,G,B){var Y=G&7,K=G>>>3;return Y<=5?N[K]|=(B&7)<<Y:(N[K]|=B<<Y&255,N[K+1]=(B&7)>>8-Y),G+3}function Ee(N,G,B){var Y=G&7,K=G>>>3;return B=(B&1)<<Y,N[K]|=B,G+1}function Fe(N,G,B){var Y=G&7,K=G>>>3;return B<<=Y,N[K]|=B&255,B>>>=8,N[K+1]=B,G+8}function qe(N,G,B){var Y=G&7,K=G>>>3;return B<<=Y,N[K]|=B&255,B>>>=8,N[K+1]=B&255,N[K+2]=B>>>8,G+16}function it(N,G){var B=N.length,Y=2*B>G?2*B:G+5,K=0;if(B>=G)return N;if(_t){var q=zx(Y);if(N.copy)N.copy(q);else for(;K<N.length;++K)q[K]=N[K];return q}else if(oe){var ve=new Uint8Array(Y);if(ve.set)ve.set(N);else for(;K<B;++K)ve[K]=N[K];return ve}return N.length=Y,N}function kt(N){for(var G=new Array(N),B=0;B<N;++B)G[B]=0;return G}function bt(N,G,B){var Y=1,K=0,q=0,ve=0,Te=0,ge=N.length,we=oe?new Uint16Array(32):kt(32);for(q=0;q<32;++q)we[q]=0;for(q=ge;q<B;++q)N[q]=0;ge=N.length;var ke=oe?new Uint16Array(ge):kt(ge);for(q=0;q<ge;++q)we[K=N[q]]++,Y<K&&(Y=K),ke[q]=0;for(we[0]=0,q=1;q<=Y;++q)we[q+16]=Te=Te+we[q-1]<<1;for(q=0;q<ge;++q)Te=N[q],Te!=0&&(ke[q]=we[Te+16]++);var Oe=0;for(q=0;q<ge;++q)if(Oe=N[q],Oe!=0)for(Te=F(ke[q],Y)>>Y-Oe,ve=(1<<Y+4-Oe)-1;ve>=0;--ve)G[Te|ve<<Oe]=Oe&15|q<<4;return Y}var Rt=oe?new Uint16Array(512):kt(512),Ot=oe?new Uint16Array(32):kt(32);if(!oe){for(var ht=0;ht<512;++ht)Rt[ht]=0;for(ht=0;ht<32;++ht)Ot[ht]=0}(function(){for(var N=[],G=0;G<32;G++)N.push(5);bt(N,Ot,32);var B=[];for(G=0;G<=143;G++)B.push(8);for(;G<=255;G++)B.push(9);for(;G<=279;G++)B.push(7);for(;G<=287;G++)B.push(8);bt(B,Rt,288)})();var Tt=(function(){for(var G=oe?new Uint8Array(32768):[],B=0,Y=0;B<de.length-1;++B)for(;Y<de[B+1];++Y)G[Y]=B;for(;Y<32768;++Y)G[Y]=29;var K=oe?new Uint8Array(259):[];for(B=0,Y=0;B<ie.length-1;++B)for(;Y<ie[B+1];++Y)K[Y]=B;function q(Te,ge){for(var we=0;we<Te.length;){var ke=Math.min(65535,Te.length-we),Oe=we+ke==Te.length;for(ge.write_shift(1,+Oe),ge.write_shift(2,ke),ge.write_shift(2,~ke&65535);ke-- >0;)ge[ge.l++]=Te[we++]}return ge.l}function ve(Te,ge){for(var we=0,ke=0,Oe=oe?new Uint16Array(32768):[];ke<Te.length;){var We=Math.min(65535,Te.length-ke);if(We<10){for(we=Se(ge,we,+(ke+We==Te.length)),we&7&&(we+=8-(we&7)),ge.l=we/8|0,ge.write_shift(2,We),ge.write_shift(2,~We&65535);We-- >0;)ge[ge.l++]=Te[ke++];we=ge.l*8;continue}we=Se(ge,we,+(ke+We==Te.length)+2);for(var Pe=0;We-- >0;){var Re=Te[ke];Pe=(Pe<<5^Re)&32767;var Me=-1,lt=0;if((Me=Oe[Pe])&&(Me|=ke&-32768,Me>ke&&(Me-=32768),Me<ke))for(;Te[Me+lt]==Te[ke+lt]&&lt<250;)++lt;if(lt>2){Re=K[lt],Re<=22?we=Fe(ge,we,ee[Re+1]>>1)-1:(Fe(ge,we,3),we+=5,Fe(ge,we,ee[Re-23]>>5),we+=3);var Bt=Re<8?0:Re-4>>2;Bt>0&&(qe(ge,we,lt-ie[Re]),we+=Bt),Re=G[ke-Me],we=Fe(ge,we,ee[Re]>>3),we-=3;var jt=Re<4?0:Re-2>>1;jt>0&&(qe(ge,we,ke-Me-de[Re]),we+=jt);for(var ur=0;ur<lt;++ur)Oe[Pe]=ke&32767,Pe=(Pe<<5^Te[ke])&32767,++ke;We-=lt-1}else Re<=143?Re=Re+48:we=Ee(ge,we,1),we=Fe(ge,we,ee[Re]),Oe[Pe]=ke&32767,++ke}we=Fe(ge,we,0)-1}return ge.l=(we+7)/8|0,ge.l}return function(ge,we){return ge.length<8?q(ge,we):ve(ge,we)}})();function et(N){var G=br(50+Math.floor(N.length*1.1)),B=Tt(N,G);return G.slice(0,B)}var vt=oe?new Uint16Array(32768):kt(32768),xt=oe?new Uint16Array(32768):kt(32768),pt=oe?new Uint16Array(128):kt(128),Mt=1,$t=1;function Cn(N,G){var B=He(N,G)+257;G+=5;var Y=He(N,G)+1;G+=5;var K=Ve(N,G)+4;G+=4;for(var q=0,ve=oe?new Uint8Array(19):kt(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,we=oe?new Uint8Array(8):kt(8),ke=oe?new Uint8Array(8):kt(8),Oe=ve.length,We=0;We<K;++We)ve[W[We]]=q=De(N,G),ge<q&&(ge=q),we[q]++,G+=3;var Pe=0;for(we[0]=0,We=1;We<=ge;++We)ke[We]=Pe=Pe+we[We-1]<<1;for(We=0;We<Oe;++We)(Pe=ve[We])!=0&&(Te[We]=ke[Pe]++);var Re=0;for(We=0;We<Oe;++We)if(Re=ve[We],Re!=0){Pe=ee[Te[We]]>>8-Re;for(var Me=(1<<7-Re)-1;Me>=0;--Me)pt[Pe|Me<<Re]=Re&7|We<<3}var lt=[];for(ge=1;lt.length<B+Y;)switch(Pe=pt[Ie(N,G)],G+=Pe&7,Pe>>>=3){case 16:for(q=3+Ce(N,G),G+=2,Pe=lt[lt.length-1];q-- >0;)lt.push(Pe);break;case 17:for(q=3+De(N,G),G+=3;q-- >0;)lt.push(0);break;case 18:for(q=11+Ie(N,G),G+=7;q-- >0;)lt.push(0);break;default:lt.push(Pe),ge<Pe&&(ge=Pe);break}var Bt=lt.slice(0,B),jt=lt.slice(B);for(We=B;We<286;++We)Bt[We]=0;for(We=Y;We<30;++We)jt[We]=0;return Mt=bt(Bt,vt,286),$t=bt(jt,xt,30),G}function vn(N,G){if(N[0]==3&&!(N[1]&3))return[Cs(G),2];for(var B=0,Y=0,K=zx(G||1<<18),q=0,ve=K.length>>>0,Te=0,ge=0;(Y&1)==0;){if(Y=De(N,B),B+=3,Y>>>1)Y>>1==1?(Te=9,ge=5):(B=Cn(N,B),Te=Mt,ge=$t);else{B&7&&(B+=8-(B&7));var we=N[B>>>3]|N[(B>>>3)+1]<<8;if(B+=32,we>0)for(!G&&ve<q+we&&(K=it(K,q+we),ve=K.length);we-- >0;)K[q++]=N[B>>>3],B+=8;continue}for(;;){!G&&ve<q+32767&&(K=it(K,q+32767),ve=K.length);var ke=ne(N,B,Te),Oe=Y>>>1==1?Rt[ke]:vt[ke];if(B+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)K[q++]=Oe;else{if(Oe==256)break;Oe-=257;var We=Oe<8?0:Oe-4>>2;We>5&&(We=0);var Pe=q+ie[Oe];We>0&&(Pe+=ne(N,B,We),B+=We),ke=ne(N,B,ge),Oe=Y>>>1==1?Ot[ke]:xt[ke],B+=Oe&15,Oe>>>=4;var Re=Oe<4?0:Oe-2>>1,Me=de[Oe];for(Re>0&&(Me+=ne(N,B,Re),B+=Re),!G&&ve<Pe&&(K=it(K,Pe+100),ve=K.length);q<Pe;)K[q]=K[q-Me],++q}}}return G?[K,B+7>>>3]:[K.slice(0,q),B+7>>>3]}function me(N,G){var B=N.slice(N.l||0),Y=vn(B,G);return N.l+=Y[1],Y[0]}function Le(N,G){if(N)typeof console<"u"&&console.error(G);else throw new Error(G)}function ze(N,G){var B=N;jr(B,0);var Y=[],K=[],q={FileIndex:Y,FullPaths:K};C(q,{root:G.root});for(var ve=B.length-4;(B[ve]!=80||B[ve+1]!=75||B[ve+2]!=5||B[ve+3]!=6)&&ve>=0;)--ve;B.l=ve+4,B.l+=4;var Te=B.read_shift(2);B.l+=6;var ge=B.read_shift(4);for(B.l=ge,ve=0;ve<Te;++ve){B.l+=20;var we=B.read_shift(4),ke=B.read_shift(4),Oe=B.read_shift(2),We=B.read_shift(2),Pe=B.read_shift(2);B.l+=8;var Re=B.read_shift(4),Me=c(B.slice(B.l+Oe,B.l+Oe+We));B.l+=Oe+We+Pe;var lt=B.l;B.l=Re+4,Ke(B,we,ke,q,Me),B.l=lt}return q}function Ke(N,G,B,Y,K){N.l+=2;var q=N.read_shift(2),ve=N.read_shift(2),Te=l(N);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var ge=N.read_shift(4),we=N.read_shift(4),ke=N.read_shift(4),Oe=N.read_shift(2),We=N.read_shift(2),Pe="",Re=0;Re<Oe;++Re)Pe+=String.fromCharCode(N[N.l++]);if(We){var Me=c(N.slice(N.l,N.l+We));(Me[21589]||{}).mt&&(Te=Me[21589].mt),((K||{})[21589]||{}).mt&&(Te=K[21589].mt)}N.l+=We;var lt=N.slice(N.l,N.l+we);switch(ve){case 8:lt=I(N,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var Bt=!1;q&8&&(ge=N.read_shift(4),ge==134695760&&(ge=N.read_shift(4),Bt=!0),we=N.read_shift(4),ke=N.read_shift(4)),we!=G&&Le(Bt,"Bad compressed size: "+G+" != "+we),ke!=B&&Le(Bt,"Bad uncompressed size: "+B+" != "+ke),rt(Y,Pe,lt,{unsafe:!0,mt:Te})}function tt(N,G){var B=G||{},Y=[],K=[],q=br(1),ve=B.compression?8:0,Te=0,ge=0,we=0,ke=0,Oe=0,We=N.FullPaths[0],Pe=We,Re=N.FileIndex[0],Me=[],lt=0;for(ge=1;ge<N.FullPaths.length;++ge)if(Pe=N.FullPaths[ge].slice(We.length),Re=N.FileIndex[ge],!(!Re.size||!Re.content||Pe=="Sh33tJ5")){var Bt=ke,jt=br(Pe.length);for(we=0;we<Pe.length;++we)jt.write_shift(1,Pe.charCodeAt(we)&127);jt=jt.slice(0,jt.l),Me[Oe]=l_.buf(Re.content,0);var ur=Re.content;ve==8&&(ur=R(ur)),q=br(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,Te),q.write_shift(2,ve),Re.mt?o(q,Re.mt):q.write_shift(4,0),q.write_shift(-4,Me[Oe]),q.write_shift(4,ur.length),q.write_shift(4,Re.content.length),q.write_shift(2,jt.length),q.write_shift(2,0),ke+=q.length,Y.push(q),ke+=jt.length,Y.push(jt),ke+=ur.length,Y.push(ur),q=br(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,Te),q.write_shift(2,ve),q.write_shift(4,0),q.write_shift(-4,Me[Oe]),q.write_shift(4,ur.length),q.write_shift(4,Re.content.length),q.write_shift(2,jt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,Bt),lt+=q.l,K.push(q),lt+=jt.length,K.push(jt),++Oe}return q=br(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Oe),q.write_shift(2,Oe),q.write_shift(4,lt),q.write_shift(4,ke),q.write_shift(2,0),ys([ys(Y),ys(K),q])}var Ct={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zt(N,G){if(N.ctype)return N.ctype;var B=N.name||"",Y=B.match(/\.([^\.]+)$/);return Y&&Ct[Y[1]]||G&&(Y=(B=G).match(/[\.\\]([^\.\\])+$/),Y&&Ct[Y[1]])?Ct[Y[1]]:"application/octet-stream"}function Vt(N){for(var G=Lx(N),B=[],Y=0;Y<G.length;Y+=76)B.push(G.slice(Y,Y+76));return B.join(`\r
`)+`\r
`}function wr(N){var G=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var ke=we.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],Y=G.split(`\r
`),K=0;K<Y.length;++K){var q=Y[K];if(q.length==0){B.push("");continue}for(var ve=0;ve<q.length;){var Te=76,ge=q.slice(ve,ve+Te);ge.charAt(Te-1)=="="?Te--:ge.charAt(Te-2)=="="?Te-=2:ge.charAt(Te-3)=="="&&(Te-=3),ge=q.slice(ve,ve+Te),ve+=Te,ve<q.length&&(ge+="="),B.push(ge)}}return B.join(`\r
`)}function nt(N){for(var G=[],B=0;B<N.length;++B){for(var Y=N[B];B<=N.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+N[++B];G.push(Y)}for(var K=0;K<G.length;++K)G[K]=G[K].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return ea(G.join(`\r
`))}function gt(N,G,B){for(var Y="",K="",q="",ve,Te=0;Te<10;++Te){var ge=G[Te];if(!ge||ge.match(/^\s*$/))break;var we=ge.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":Y=we[2].trim();break;case"content-type":q=we[2].trim();break;case"content-transfer-encoding":K=we[2].trim();break}}switch(++Te,K.toLowerCase()){case"base64":ve=ea(Tn(G.slice(Te).join("")));break;case"quoted-printable":ve=nt(G.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var ke=rt(N,Y.slice(B.length),ve,{unsafe:!0});q&&(ke.ctype=q)}function Tr(N,G){if(M(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=G&&G.root||"",Y=(_t&&Buffer.isBuffer(N)?N.toString("binary"):M(N)).split(`\r
`),K=0,q="";for(K=0;K<Y.length;++K)if(q=Y[K],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),B||(B=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),q.slice(0,B.length)!=B););var ve=(Y[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var Te="--"+(ve[1]||""),ge=[],we=[],ke={FileIndex:ge,FullPaths:we};C(ke);var Oe,We=0;for(K=0;K<Y.length;++K){var Pe=Y[K];Pe!==Te&&Pe!==Te+"--"||(We++&&gt(ke,Y.slice(Oe,K),B),Oe=K)}return ke}function Zr(N,G){var B=G||{},Y=B.boundary||"SheetJS";Y="------="+Y;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],q=N.FullPaths[0],ve=q,Te=N.FileIndex[0],ge=1;ge<N.FullPaths.length;++ge)if(ve=N.FullPaths[ge].slice(q.length),Te=N.FileIndex[ge],!(!Te.size||!Te.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(lt){return"_x"+lt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(lt){return"_u"+lt.charCodeAt(0).toString(16)+"_"});for(var we=Te.content,ke=_t&&Buffer.isBuffer(we)?we.toString("binary"):M(we),Oe=0,We=Math.min(1024,ke.length),Pe=0,Re=0;Re<=We;++Re)(Pe=ke.charCodeAt(Re))>=32&&Pe<128&&++Oe;var Me=Oe>=We*4/5;K.push(Y),K.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+ve),K.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),K.push("Content-Type: "+zt(Te,ve)),K.push(""),K.push(Me?wr(ke):Vt(ke))}return K.push(Y+`--\r
`),K.join(`\r
`)}function Ue(N){var G={};return C(G,N),G}function rt(N,G,B,Y){var K=Y&&Y.unsafe;K||C(N);var q=!K&&Et.find(N,G);if(!q){var ve=N.FullPaths[0];G.slice(0,ve.length)==ve?ve=G:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+G).replace("//","/")),q={name:a(G),type:2},N.FileIndex.push(q),N.FullPaths.push(ve),K||Et.utils.cfb_gc(N)}return q.content=B,q.size=B?B.length:0,Y&&(Y.CLSID&&(q.clsid=Y.CLSID),Y.mt&&(q.mt=Y.mt),Y.ct&&(q.ct=Y.ct)),q}function ut(N,G){C(N);var B=Et.find(N,G);if(B){for(var Y=0;Y<N.FileIndex.length;++Y)if(N.FileIndex[Y]==B)return N.FileIndex.splice(Y,1),N.FullPaths.splice(Y,1),!0}return!1}function Kt(N,G,B){C(N);var Y=Et.find(N,G);if(Y){for(var K=0;K<N.FileIndex.length;++K)if(N.FileIndex[K]==Y)return N.FileIndex[K].name=a(B),N.FullPaths[K]=B,!0}return!1}function rr(N){j(N,!0)}return n.find=X,n.read=L,n.parse=d,n.write=H,n.writeFile=se,n.utils={cfb_new:Ue,cfb_add:rt,cfb_del:ut,cfb_mov:Kt,cfb_gc:rr,ReadShift:ll,CheckField:E1,prep_blob:jr,bconcat:ys,use_zlib:E,_deflateRaw:et,_inflateRaw:me,consts:V},n})();function c_(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ea(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function sp(e){for(var n=[],t=Ea(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var bu=new Date(1899,11,30,0,0,0);function un(e,n){var t=e.getTime(),r=bu.getTime()+(e.getTimezoneOffset()-bu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var n1=new Date,u_=bu.getTime()+(n1.getTimezoneOffset()-bu.getTimezoneOffset())*6e4,Kx=n1.getTimezoneOffset();function Gu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+u_),n.getTimezoneOffset()!==Kx&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Kx)*6e4),n}function f_(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var Gx=new Date("2017-02-19T19:06:09.000Z"),a1=isNaN(Gx.getFullYear())?new Date("2/19/17"):Gx,d_=a1.getFullYear()==2017;function Or(e,n){var t=new Date(e);if(d_)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(a1.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function io(e,n){if(_t&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return sl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return sl(Yv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return sl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return sl(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function zr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=zr(e[t]));return n}function ir(e,n){for(var t="";t.length<n;)t+=e;return t}function na(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var p_=["january","february","march","april","may","june","july","august","september","october","november","december"];function ai(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&p_.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var h_=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function s1(e){return e?e.content&&e.type?io(e.content,!0):e.data?rl(e.data):e.asNodeBuffer&&_t?rl(e.asNodeBuffer().toString("binary")):e.asBinary?rl(e.asBinary()):e._data&&e._data.getContent?rl(io(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function o1(e){if(!e)return null;if(e.data)return Ix(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Ix(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function m_(e){return e&&e.name.slice(-4)===".bin"?o1(e):s1(e)}function Ln(e,n){for(var t=e.FullPaths||Ea(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function op(e,n){var t=Ln(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function vr(e,n,t){if(!t)return m_(op(e,n));if(!n)return null;try{return vr(e,n)}catch{return null}}function En(e,n,t){if(!t)return s1(op(e,n));if(!n)return null;try{return En(e,n)}catch{return null}}function x_(e,n,t){return o1(op(e,n))}function Xx(e){for(var n=e.FullPaths||Ea(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function g_(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return _t?r=ho(t):r=I2(t),Et.utils.cfb_add(e,n,r)}Et.utils.cfb_add(e,n,t)}else e.file(n,t)}function i1(e,n){switch(n.type){case"base64":return Et.read(e,{type:"base64"});case"binary":return Et.read(e,{type:"binary"});case"buffer":case"array":return Et.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function al(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var l1=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,v_=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Qx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,y_=/<[^>]*>/g,qr=l1.match(Qx)?Qx:y_,w_=/<\w*:/,k_=/<(\/?)\w+:/;function ct(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(v_),c=0,f="",p=0,d="",x="",g=1;if(l)for(p=0;p!=l.length;++p){for(x=l[p],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(d=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(g=(a=x.charCodeAt(o+1))==34||a==39?1:0,f=x.slice(o+1+g,x.length-g),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),r[d]=f,r[d.toLowerCase()]=f;else{var y=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(r[y]&&d.slice(c-3,c)=="ext")continue;r[y]=f,r[y.toLowerCase()]=f}}return r}function Ta(e){return e.replace(k_,"<$1")}var c1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},__=sp(c1),At=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return c1[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),b_=/[&<>'"]/g,E_=/[\u0000-\u001f]/g;function ip(e){var n=e+"";return n.replace(b_,function(t){return __[t]}).replace(/\n/g,"<br/>").replace(E_,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var qx=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function er(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Z0(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function Zx(e){var n=Cs(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function Jx(e){return ho(e,"binary").toString("utf8")}var qc="foo bar baz",Xt=_t&&(Jx(qc)==Z0(qc)&&Jx||Zx(qc)==Z0(qc)&&Zx)||Z0,sl=_t?function(e){return ho(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},wl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),u1=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),S_=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),T_=/<\/?(?:vt:)?variant>/g,C_=/<(?:vt:)([^>]*)>([\s\S]*)</;function eg(e,n){var t=ct(e),r=e.match(S_(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(T_,"").match(C_);l&&a.push({v:Xt(l[2]),t:l[1]})}),a}var D_=/(^\s|\s$|\n)/;function N_(e){return Ea(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function F_(e,n,t){return"<"+e+(t!=null?N_(t):"")+(n!=null?(n.match(D_)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function lp(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(mo(rp(e)));throw new Error("Bad input format: expected Buffer or string")}var kl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,A_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},O_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function P_(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function R_(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var tg=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},rg=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ho(n)})):tg(e)}:tg,ng=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(za(e,a)));return r.join("").replace(cn,"")},cp=_t?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(cn,""):ng(e,n,t)}:ng,ag=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},f1=_t?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):ag(e,n,t)}:ag,sg=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Go(e,a)));return r.join("")},Fl=_t?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):sg(n,t,r)}:sg,d1=function(e,n){var t=bn(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},p1=d1,h1=function(e,n){var t=bn(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},m1=h1,x1=function(e,n){var t=2*bn(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},g1=x1,v1=function(n,t){var r=bn(n,t);return r>0?cp(n,t+4,t+4+r):""},y1=v1,w1=function(e,n){var t=bn(e,n);return t>0?Fl(e,n+4,n+4+t):""},k1=w1,_1=function(e,n){return P_(e,n)},Eu=_1,b1=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};_t&&(p1=function(n,t){if(!Buffer.isBuffer(n))return d1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},m1=function(n,t){if(!Buffer.isBuffer(n))return h1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},g1=function(n,t){if(!Buffer.isBuffer(n))return x1(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},y1=function(n,t){if(!Buffer.isBuffer(n))return v1(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},k1=function(n,t){if(!Buffer.isBuffer(n))return w1(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Eu=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):_1(n,t)},b1=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Go=function(e,n){return e[n]},za=function(e,n){return e[n+1]*256+e[n]},M_=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},bn=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Xs=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},I_=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ll(e,n){var t="",r,a,o=[],l,c,f,p;switch(n){case"dbcs":if(p=this.l,_t&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(za(this,p)),p+=2;e*=2;break;case"utf8":t=Fl(this,this.l,this.l+e);break;case"utf16le":e*=2,t=cp(this,this.l,this.l+e);break;case"wstr":return ll.call(this,e,"dbcs");case"lpstr-ansi":t=p1(this,this.l),e=4+bn(this,this.l);break;case"lpstr-cp":t=m1(this,this.l),e=4+bn(this,this.l);break;case"lpwstr":t=g1(this,this.l),e=4+2*bn(this,this.l);break;case"lpp4":e=4+bn(this,this.l),t=y1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bn(this,this.l),t=k1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Go(this,this.l+e++))!==0;)o.push(Qc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=za(this,this.l+e))!==0;)o.push(Qc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",p=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return l=Go(this,p),this.l=p+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(za(this,p))),p+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",p=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return l=Go(this,p),this.l=p+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(Go(this,p))),p+=1}t=o.join("");break;default:switch(e){case 1:return r=Go(this,this.l),this.l++,r;case 2:return r=(n==="i"?M_:za)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Xs:I_)(this,this.l),this.l+=4,r):(a=bn(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Eu(this,this.l):a=Eu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=f1(this,this.l,e);break}}return this.l+=e,t}var j_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},L_=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},z_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function B_(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)z_(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,j_(this,n,this.l);break;case 8:if(r=8,t==="f"){R_(this,n,this.l);break}case 16:break;case-4:r=4,L_(this,n,this.l);break}return this.l+=r,this}function E1(e,n){var t=f1(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function jr(e,n){e.l=n,e.read_shift=ll,e.chk=E1,e.write_shift=B_}function Qr(e,n){e.l+=n}function br(e){var n=Cs(e);return jr(n,0),n}function Xa(e,n,t){if(e){var r,a,o;jr(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var p=Fu[c]||Fu[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var d=p.f&&p.f(e,o,t);if(e.l=f,n(d,p,c))return}}}function bd(){var e=[],n=_t?256:2048,t=function(p){var d=br(p);return jr(d,0),d},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(p){return r&&p<r.length-r.l?r:(a(),r=t(Math.max(p+1,n)))},l=function(){return a(),ys(e)},c=function(p){a(),r=p,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function cl(e,n,t){var r=zr(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function og(e,n,t){var r=zr(e);return r.s=cl(r.s,n.s,t),r.e=cl(r.e,n.s,t),r}function ul(e,n){if(e.cRel&&e.c<0)for(e=zr(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=zr(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=dt(e);return!e.cRel&&e.cRel!=null&&(t=H_(t)),!e.rRel&&e.rRel!=null&&(t=W_(t)),t}function J0(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Er(e.s.c)+":"+(e.e.cRel?"":"$")+Er(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Br(e.s.r)+":"+(e.e.rRel?"":"$")+Br(e.e.r):ul(e.s,n.biff)+":"+ul(e.e,n.biff)}function up(e){return parseInt(U_(e),10)-1}function Br(e){return""+(e+1)}function W_(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function U_(e){return e.replace(/\$(\d+)$/,"$1")}function fp(e){for(var n=Y_(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Er(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function H_(e){return e.replace(/^([A-Z])/,"$$$1")}function Y_(e){return e.replace(/^\$([A-Z])/,"$1")}function $_(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sn(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function dt(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function pi(e){var n=e.indexOf(":");return n==-1?{s:sn(e),e:sn(e)}:{s:sn(e.slice(0,n)),e:sn(e.slice(n+1))}}function St(e,n){return typeof n>"u"||typeof n=="number"?St(e.s,e.e):(typeof e!="string"&&(e=dt(e)),typeof n!="string"&&(n=dt(n)),e==n?e:e+":"+n)}function lr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function ig(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,t?un(n):n)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(t?14:0),t?un(n):n)}catch{return""+n}}function Ka(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?vo[e.v]||e.v:n==null?ig(e,e.v):ig(e,n))}function Os(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function S1(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?sn(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var d=lr(o["!ref"]);p.s.c=d.s.c,p.s.r=d.s.r,p.e.c=Math.max(p.e.c,d.e.c),p.e.r=Math.max(p.e.r,d.e.r),l==-1&&(p.e.r=l=d.e.r+1)}for(var x=0;x!=n.length;++x)if(n[x]){if(!Array.isArray(n[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[x].length;++g)if(!(typeof n[x][g]>"u")){var y={v:n[x][g]},k=l+x,w=c+g;if(p.s.r>k&&(p.s.r=k),p.s.c>w&&(p.s.c=w),p.e.r<k&&(p.e.r=k),p.e.c<w&&(p.e.c=w),n[x][g]&&typeof n[x][g]=="object"&&!Array.isArray(n[x][g])&&!(n[x][g]instanceof Date))y=n[x][g];else if(Array.isArray(y.v)&&(y.f=n[x][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||mt[14],r.cellDates?(y.t="d",y.w=Un(y.z,un(y.v))):(y.t="n",y.v=un(y.v),y.w=Un(y.z,y.v))):y.t="s";if(a)o[k]||(o[k]=[]),o[k][w]&&o[k][w].z&&(y.z=o[k][w].z),o[k][w]=y;else{var _=dt({c:w,r:k});o[_]&&o[_].z&&(y.z=o[_].z),o[_]=y}}}return p.s.c<1e7&&(o["!ref"]=St(p)),o}function hi(e,n){return S1(null,e,n)}function V_(e){return e.read_shift(4,"i")}function Xr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function K_(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function dp(e,n){var t=e.l,r=e.read_shift(1),a=Xr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(K_(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var G_=dp;function Yn(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function xo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var X_=Xr;function pp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var Q_=Xr,Ed=pp;function hp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Eu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Xs(n,0)>>2;return t?a/100:a}function T1(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var go=T1;function Kr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function q_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var p=to[a];p&&(n.rgb=bl(p));break;case 2:n.rgb=bl([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function Z_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function C1(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function J_(e){return C1(e,1)}function eb(e){return C1(e,2)}var mp=2,gn=3,Zc=11,lg=12,Su=19,Jc=64,tb=65,rb=71,nb=4108,ab=4126,Ar=80,D1=81,sb=[Ar,D1],ob={1:{n:"CodePage",t:mp},2:{n:"Category",t:Ar},3:{n:"PresentationFormat",t:Ar},4:{n:"ByteCount",t:gn},5:{n:"LineCount",t:gn},6:{n:"ParagraphCount",t:gn},7:{n:"SlideCount",t:gn},8:{n:"NoteCount",t:gn},9:{n:"HiddenCount",t:gn},10:{n:"MultimediaClipCount",t:gn},11:{n:"ScaleCrop",t:Zc},12:{n:"HeadingPairs",t:nb},13:{n:"TitlesOfParts",t:ab},14:{n:"Manager",t:Ar},15:{n:"Company",t:Ar},16:{n:"LinksUpToDate",t:Zc},17:{n:"CharacterCount",t:gn},19:{n:"SharedDoc",t:Zc},22:{n:"HyperlinksChanged",t:Zc},23:{n:"AppVersion",t:gn,p:"version"},24:{n:"DigSig",t:tb},26:{n:"ContentType",t:Ar},27:{n:"ContentStatus",t:Ar},28:{n:"Language",t:Ar},29:{n:"Version",t:Ar},255:{},2147483648:{n:"Locale",t:Su},2147483651:{n:"Behavior",t:Su},1919054434:{}},ib={1:{n:"CodePage",t:mp},2:{n:"Title",t:Ar},3:{n:"Subject",t:Ar},4:{n:"Author",t:Ar},5:{n:"Keywords",t:Ar},6:{n:"Comments",t:Ar},7:{n:"Template",t:Ar},8:{n:"LastAuthor",t:Ar},9:{n:"RevNumber",t:Ar},10:{n:"EditTime",t:Jc},11:{n:"LastPrinted",t:Jc},12:{n:"CreatedDate",t:Jc},13:{n:"ModifiedDate",t:Jc},14:{n:"PageCount",t:gn},15:{n:"WordCount",t:gn},16:{n:"CharCount",t:gn},17:{n:"Thumbnail",t:rb},18:{n:"Application",t:Ar},19:{n:"DocSecurity",t:gn},255:{},2147483648:{n:"Locale",t:Su},2147483651:{n:"Behavior",t:Su},1919054434:{}},cg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cb(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var ub=cb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),to=zr(ub),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},N1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ug={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function fb(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function db(e){var n=fb();if(!e||!e.match)return n;var t={};if((e.match(qr)||[]).forEach(function(r){var a=ct(r);switch(a[0].replace(w_,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[ug[a.ContentType]]!==void 0&&n[ug[a.ContentType]].push(a.PartName);break}}),n.xmlns!==A_.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var Qo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Sd(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function fl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(qr)||[]).forEach(function(a){var o=ct(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:al(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var pb="application/vnd.oasis.opendocument.spreadsheet";function hb(e,n){for(var t=lp(e),r,a;r=kl.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=ct(r[0],!1),a.path=="/"&&a.type!==pb)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var dl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],mb=(function(){for(var e=new Array(dl.length),n=0;n<dl.length;++n){var t=dl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function F1(e){var n={};e=Xt(e);for(var t=0;t<dl.length;++t){var r=dl[t],a=e.match(mb[t]);a!=null&&a.length>0&&(n[r[1]]=At(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=Or(n[r[1]]))}return n}var xb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function A1(e,n,t,r){var a=[];if(typeof e=="string")a=eg(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(d){return{v:d}}));var l=typeof n=="string"?eg(n,r).map(function(d){return d.v}):n,c=0,f=0;if(l.length>0)for(var p=0;p!==a.length;p+=2){switch(f=+a[p+1].v,a[p].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function gb(e,n,t){var r={};return n||(n={}),e=Xt(e),xb.forEach(function(a){var o=(e.match(wl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=At(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&A1(r.HeadingPairs,r.TitlesOfParts,n,t),n}var vb=/<[^>]+>[^<]*/g;function yb(e,n){var t={},r="",a=e.match(vb);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=ct(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=At(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),p=f[0].slice(4),d=f[1];switch(p){case"lpstr":case"bstr":case"lpwstr":t[r]=At(d);break;case"bool":t[r]=er(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(d);break;case"filetime":case"date":t[r]=Or(d);break;case"cy":case"error":t[r]=At(d);break;default:if(p.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,p,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var wb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ed;function kb(e,n,t){ed||(ed=sp(wb)),n=ed[n]||n,e[n]=t}function xp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function O1(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function P1(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function R1(e,n,t){return n===31?P1(e):O1(e,n,t)}function Td(e,n,t){return R1(e,n,t===!1?0:4)}function _b(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return R1(e,n,0)}function bb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(cn,""),e.l-a&2&&(e.l+=2)}return t}function Eb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(cn,"");return t}function Sb(e){var n=e.l,t=Tu(e,D1);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Tu(e,gn);return[t,r]}function Tb(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(Sb(e));return t}function fg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(cn,"").replace(nl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function M1(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function Cb(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Tu(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==lg&&r!==n&&sb.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===lg?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return O1(e,r,4).replace(cn,"");case 31:return P1(e);case 64:return xp(e);case 65:return M1(e);case 71:return Cb(e);case 80:return Td(e,r,!o.raw).replace(cn,"");case 81:return _b(e,r).replace(cn,"");case 4108:return Tb(e);case 4126:case 4127:return r==4127?bb(e):Eb(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function dg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,p={};for(l=0;l!=a;++l){var d=e.read_shift(4),x=e.read_shift(4);o[l]=[d,x+t]}o.sort(function(P,T){return P[1]-T[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var y=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,y=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(y=!1,e.l=o[l][1]),y)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var k=n[o[l][0]];if(g[k.n]=Tu(e,k.t,{raw:!0}),k.p==="version"&&(g[k.n]=String(g[k.n]>>16)+"."+("0000"+String(g[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(g[k.n]){case 0:g[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ta(c=g[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[k.n])}}else if(o[l][0]===1){if(c=g.CodePage=Tu(e,mp),ta(c),f!==-1){var w=e.l;e.l=o[f][1],p=fg(e,c),e.l=w}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}p=fg(e,c)}else{var _=p[o[l][0]],S;switch(e[e.l]){case 65:e.l+=4,S=M1(e);break;case 30:e.l+=4,S=Td(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=Td(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=pr(e,4);break;case 64:e.l+=4,S=Or(xp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[_]=S}}return e.l=t+r,g}function pg(e,n,t){var r=e.content;if(!r)return{};jr(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var p=r.read_shift(4),d=r.read_shift(16);if(d!==Et.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var x=dg(r,n),g={SystemIdentifier:p};for(var y in x)g[y]=x[y];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var k;try{k=dg(r,null)}catch{}for(y in k)g[y]=k[y];return g.FMTID=[o,l],g}function gs(e,n){return e.read_shift(n),null}function Db(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function pr(e,n){return e.read_shift(n)===1}function yr(e){return e.read_shift(2,"u")}function I1(e,n){return Db(e,n,yr)}function Nb(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Al(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function Fb(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var p=o==2?"dbcs-cont":"sbcs-cont",d=n===0?"":e.read_shift(n,p);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=d,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function lo(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Ol(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):lo(e,r,t)}function yo(e,n,t){if(t.biff>5)return Ol(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ab(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function Ob(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(cn,"");return r&&(e.l+=24),a}function Pb(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(cn,"");return t+l}function Rb(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Ob(e);case"0303000000000000c000000000000046":return Pb(e);default:throw new Error("Unsupported Moniker "+t)}}function eu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(cn,""):"";return t}function Mb(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,p="",d,x;a&16&&(o=eu(e,t-e.l)),a&128&&(l=eu(e,t-e.l)),(a&257)===257&&(c=eu(e,t-e.l)),(a&257)===1&&(f=Rb(e,t-e.l)),a&8&&(p=eu(e,t-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(x=xp(e)),e.l=t;var g=l||c||f||"";g&&p&&(g+="#"+p),g||(g="#"+p),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var y={Target:g};return d&&(y.guid=d),x&&(y.time=x),o&&(y.Tooltip=o),y}function j1(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function L1(e,n){var t=j1(e);return t[3]=0,t}function Ca(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function Ib(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function jb(e,n,t){return n===0?"":yo(e,n,t)}function Lb(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function z1(e){var n=e.read_shift(2),t=hp(e);return[n,t]}function zb(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Al(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function Xu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function B1(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var Bb=B1;function W1(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function Wb(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function Ub(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function $r(e){e.l+=2,e.l+=e.read_shift(2)}var Hb={0:$r,4:$r,5:$r,6:$r,7:Ub,8:$r,9:$r,10:$r,11:$r,12:$r,13:Wb,14:$r,15:$r,16:$r,17:$r,18:$r,19:$r,20:$r,21:W1};function Yb(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push(Hb[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function tu(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function $b(e,n){return n===0||e.read_shift(2),1200}function Vb(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=yo(e,0,t);return e.read_shift(n+r-e.l),a}function Kb(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function Gb(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Al(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function Xb(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(Fb(e));return o.Count=r,o.Unique=a,o}function Qb(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function qb(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function Zb(e){var n=Ib(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function Jb(e){return e.read_shift(2),e.read_shift(4)}function hg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function eE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),p=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:p}}function tE(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function rE(){}function nE(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Al(e,0,t),r}function aE(e){var n=Ca(e);return n.isst=e.read_shift(4),n}function sE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=Ca(e);t.biff==2&&e.l++;var o=Ol(e,r-e.l,t);return a.val=o,a}function oE(e,n,t){var r=e.read_shift(2),a=yo(e,0,t);return[r,a]}var iE=yo;function mg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function lE(e){var n=e.read_shift(2),t=e.read_shift(2),r=z1(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function cE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(z1(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function uE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function fE(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=lb[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function dE(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=fE(e,n,r.fStyle,t),r}function pE(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function xg(e,n,t){var r=Ca(e);(t.biff==2||n==9)&&++e.l;var a=Nb(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function hE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Ca(e),a=Kr(e);return r.val=a,r}var gg=jb;function mE(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=lo(e,o),c=[];r>e.l;)c.push(Ol(e));return[o,a,l,c]}function vg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=zb(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var xE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var p=lo(e,l,t);a&32&&(p=xE[p.charCodeAt(0)]);var d=r-e.l;t&&t.biff==2&&--d;var x=r==e.l||c===0||!(d>0)?[]:qC(e,d,t,c);return{chKey:o,Name:p,itab:f,rgce:x}}function U1(e,n,t){if(t.biff<8)return gE(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(Lb(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function gE(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Al(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function vE(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=lo(e,r,t),l=lo(e,a,t);return[o,l]}function yE(e,n,t){var r=B1(e);e.l++;var a=e.read_shift(1);return n-=8,[ZC(e,n,t),a,r]}function wg(e,n,t){var r=Bb(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,XC(e,n,t)]}function wE(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function kE(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=yo(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function _E(e,n,t){return kE(e,n,t)}function bE(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(Xu(e));return t}function EE(e,n,t){if(t&&t.biff<8)return TE(e,n,t);var r=W1(e),a=Yb(e,n-22,r[1]);return{cmo:r,ft:a}}var SE={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function TE(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((SE[r]||Qr)(e,n,t)),{cmo:[a,r,o],ft:l}}function CE(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=Ab(e,6,t);var c=e.read_shift(2);e.read_shift(2),yr(e,2);var f=e.read_shift(2);e.l+=f;for(var p=1;p<e.lens.length-1;++p){if(e.l-r!=e.lens[p])throw new Error("TxO: bad continue record");var d=e[e.l],x=lo(e,e.lens[p+1]-e.lens[p]-1);if(a+=x,a.length>=(d?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function DE(e,n){var t=Xu(e);e.l+=16;var r=Mb(e,n-24);return[t,r]}function NE(e,n){e.read_shift(2);var t=Xu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(cn,""),[t,r]}function FE(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=cg[t]||t,t=e.read_shift(2),n[1]=cg[t]||t,n}function AE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(L1(e));return t}function OE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(L1(e));return t}function PE(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function H1(e,n,t){if(!t.cellStyles)return Qr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var p={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(p.level=f>>8&7),p}function RE(e,n){var t={};return n<32||(e.l+=16,t.header=Kr(e),t.footer=Kr(e),e.l+=2),t}function ME(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var IE=Ca,jE=I1,LE=Ol;function zE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function BE(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Ca(e);++e.l;var a=yo(e,n-7,t);return r.t="str",r.val=a,r}function WE(e){var n=Ca(e);++e.l;var t=Kr(e);return n.t="n",n.val=t,n}function UE(e){var n=Ca(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function HE(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function YE(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function $E(e,n,t){var r=e.l+n,a=Ca(e),o=e.read_shift(2),l=lo(e,o,t);return e.l=r,a.t="str",a.val=l,a}var VE=[2,3,48,49,131,139,140,245],kg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=sp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var p=[],d=Cs(1);switch(f.type){case"base64":d=ea(Tn(c));break;case"binary":d=ea(c);break;case"buffer":case"array":d=c;break}jr(d,0);var x=d.read_shift(1),g=!!(x&136),y=!1,k=!1;switch(x){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,_=521;x==2&&(w=d.read_shift(2)),d.l+=3,x!=2&&(w=d.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(_=d.read_shift(2));var S=d.read_shift(2),P=f.codepage||1252;x!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(P=e[d[d.l]]),d.l+=1,d.l+=2),k&&(d.l+=36);for(var T=[],z={},Z=Math.min(d.length,x==2?521:_-10-(y?264:0)),L=k?32:11;d.l<Z&&d[d.l]!=13;)switch(z={},z.name=vl.utils.decode(P,d.slice(d.l,d.l+L)).replace(/[\u0000\r\n].*$/g,""),d.l+=L,z.type=String.fromCharCode(d.read_shift(1)),x!=2&&!k&&(z.offset=d.read_shift(4)),z.len=d.read_shift(1),x==2&&(z.offset=d.read_shift(2)),z.dec=d.read_shift(1),z.name.length&&T.push(z),x!=2&&(d.l+=k?13:14),z.type){case"B":(!y||z.len!=8)&&f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var C=0,Q=0;for(p[0]=[],Q=0;Q!=T.length;++Q)p[0][Q]=T[Q].name;for(;w-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,p[++C]=[],Q=0,Q=0;Q!=T.length;++Q){var j=d.slice(d.l,d.l+T[Q].len);d.l+=T[Q].len,jr(j,0);var te=vl.utils.decode(P,j);switch(T[Q].type){case"C":te.trim().length&&(p[C][Q]=te.replace(/\s+$/,""));break;case"D":te.length===8?p[C][Q]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):p[C][Q]=te;break;case"F":p[C][Q]=parseFloat(te.trim());break;case"+":case"I":p[C][Q]=k?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":p[C][Q]=!0;break;case"N":case"F":p[C][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));p[C][Q]="##MEMO##"+(k?parseInt(te.trim(),10):j.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(p[C][Q]=+te||0);break;case"@":p[C][Q]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":p[C][Q]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":p[C][Q]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[C][Q]=-j.read_shift(-8,"f");break;case"B":if(y&&T[Q].len==8){p[C][Q]=j.read_shift(8,"f");break}case"G":case"P":j.l+=T[Q].len;break;case"0":if(T[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[Q].type)}}}if(x!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return f&&f.sheetRows&&(p=p.slice(0,f.sheetRows)),f.DBF=T,p}function r(c,f){var p=f||{};p.dateNF||(p.dateNF="yyyymmdd");var d=hi(t(c,p),p);return d["!cols"]=p.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete p.DBF,d}function a(c,f){try{return Os(r(c,f),f)}catch(p){if(f&&f.WTF)throw p}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var p=f||{};if(+p.codepage>=0&&ta(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var d=bd(),x=Pd(c,{header:1,raw:!0,cellDates:!0}),g=x[0],y=x.slice(1),k=c["!cols"]||[],w=0,_=0,S=0,P=1;for(w=0;w<g.length;++w){if(((k[w]||{}).DBF||{}).name){g[w]=k[w].DBF.name,++S;continue}if(g[w]!=null){if(++S,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(_=0;_<1024;++_)if(g.indexOf(g[w]+"_"+_)==-1){g[w]+="_"+_;break}}}}var T=lr(c["!ref"]),z=[],Z=[],L=[];for(w=0;w<=T.e.c-T.s.c;++w){var C="",Q="",j=0,te=[];for(_=0;_<y.length;++_)y[_][w]!=null&&te.push(y[_][w]);if(te.length==0||g[w]==null){z[w]="?";continue}for(_=0;_<te.length;++_){switch(typeof te[_]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=te[_]instanceof Date?"D":"C";break;default:Q="C"}j=Math.max(j,String(te[_]).length),C=C&&C!=Q?"C":Q}j>250&&(j=250),Q=((k[w]||{}).DBF||{}).type,Q=="C"&&k[w].DBF.len>j&&(j=k[w].DBF.len),C=="B"&&Q=="N"&&(C="N",L[w]=k[w].DBF.dec,j=k[w].DBF.len),Z[w]=C=="C"||Q=="N"?j:o[C]||0,P+=Z[w],z[w]=C}var X=d.next(32);for(X.write_shift(4,318902576),X.write_shift(4,y.length),X.write_shift(2,296+32*S),X.write_shift(2,P),w=0;w<4;++w)X.write_shift(4,0);for(X.write_shift(4,0|(+n[Uv]||3)<<8),w=0,_=0;w<g.length;++w)if(g[w]!=null){var U=d.next(32),ue=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,ue,"sbcs"),U.write_shift(1,z[w]=="?"?"C":z[w],"sbcs"),U.write_shift(4,_),U.write_shift(1,Z[w]||o[z[w]]||0),U.write_shift(1,L[w]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),_+=Z[w]||o[z[w]]||0}var le=d.next(264);for(le.write_shift(4,13),w=0;w<65;++w)le.write_shift(4,0);for(w=0;w<y.length;++w){var ae=d.next(P);for(ae.write_shift(1,0),_=0;_<g.length;++_)if(g[_]!=null)switch(z[_]){case"L":ae.write_shift(1,y[w][_]==null?63:y[w][_]?84:70);break;case"B":ae.write_shift(8,y[w][_]||0,"f");break;case"N":var pe="0";for(typeof y[w][_]=="number"&&(pe=y[w][_].toFixed(L[_]||0)),S=0;S<Z[_]-pe.length;++S)ae.write_shift(1,32);ae.write_shift(1,pe,"sbcs");break;case"D":y[w][_]?(ae.write_shift(4,("0000"+y[w][_].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(y[w][_].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+y[w][_].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var V=String(y[w][_]!=null?y[w][_]:"").slice(0,Z[_]);for(ae.write_shift(1,V,"sbcs"),S=0;S<Z[_]-V.length;++S)ae.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),KE=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ea(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,y){var k=e[y];return typeof k=="number"?jx(k):k},r=function(g,y,k){var w=y.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?g:jx(w)};e["|"]=254;function a(g,y){switch(y.type){case"base64":return o(Tn(g),y);case"binary":return o(g,y);case"buffer":return o(_t&&Buffer.isBuffer(g)?g.toString("binary"):mo(g),y);case"array":return o(io(g),y)}throw new Error("Unrecognized type "+y.type)}function o(g,y){var k=g.split(/[\n\r]+/),w=-1,_=-1,S=0,P=0,T=[],z=[],Z=null,L={},C=[],Q=[],j=[],te=0,X;for(+y.codepage>=0&&ta(+y.codepage);S!==k.length;++S){te=0;var U=k[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),ue=U.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),le=ue[0],ae;if(U.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&z.push(U.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,V=!1,se=!1,M=!1,H=-1,O=-1;for(P=1;P<ue.length;++P)switch(ue[P].charAt(0)){case"A":break;case"X":_=parseInt(ue[P].slice(1))-1,V=!0;break;case"Y":for(w=parseInt(ue[P].slice(1))-1,V||(_=0),X=T.length;X<=w;++X)T[X]=[];break;case"K":ae=ue[P].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(na(ae))?isNaN(ai(ae).getDate())||(ae=Or(ae)):(ae=na(ae),Z!==null&&di(Z)&&(ae=Gu(ae))),pe=!0;break;case"E":M=!0;var E=Zo(ue[P].slice(1),{r:w,c:_});T[w][_]=[T[w][_],E];break;case"S":se=!0,T[w][_]=[T[w][_],"S5S"];break;case"G":break;case"R":H=parseInt(ue[P].slice(1))-1;break;case"C":O=parseInt(ue[P].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}if(pe&&(T[w][_]&&T[w][_].length==2?T[w][_][0]=ae:T[w][_]=ae,Z=null),se){if(M)throw new Error("SYLK shared formula cannot have own formula");var I=H>-1&&T[H][O];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");T[w][_][1]=J1(I[1],{r:w-H,c:_-O})}break;case"F":var R=0;for(P=1;P<ue.length;++P)switch(ue[P].charAt(0)){case"X":_=parseInt(ue[P].slice(1))-1,++R;break;case"Y":for(w=parseInt(ue[P].slice(1))-1,X=T.length;X<=w;++X)T[X]=[];break;case"M":te=parseInt(ue[P].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=z[parseInt(ue[P].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=ue[P].slice(1).split(" "),X=parseInt(j[0],10);X<=parseInt(j[1],10);++X)te=parseInt(j[2],10),Q[X-1]=te===0?{hidden:!0}:{wch:te},si(Q[X-1]);break;case"C":_=parseInt(ue[P].slice(1))-1,Q[_]||(Q[_]={});break;case"R":w=parseInt(ue[P].slice(1))-1,C[w]||(C[w]={}),te>0?(C[w].hpt=te,C[w].hpx=El(te)):te===0&&(C[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}R<1&&(Z=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}}return C.length>0&&(L["!rows"]=C),Q.length>0&&(L["!cols"]=Q),y&&y.sheetRows&&(T=T.slice(0,y.sheetRows)),[T,L]}function l(g,y){var k=a(g,y),w=k[0],_=k[1],S=hi(w,y);return Ea(_).forEach(function(P){S[P]=_[P]}),S}function c(g,y){return Os(l(g,y),y)}function f(g,y,k,w){var _="C;Y"+(k+1)+";X"+(w+1)+";K";switch(g.t){case"n":_+=g.v||0,g.f&&!g.F&&(_+=";E"+PT(g.f,{r:k,c:w}));break;case"b":_+=g.v?"TRUE":"FALSE";break;case"e":_+=g.w||g.v;break;case"d":_+='"'+(g.w||g.v)+'"';break;case"s":_+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function p(g,y){y.forEach(function(k,w){var _="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?_+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Du(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Nu(k.wpx)),typeof k.wch=="number"&&(_+=Math.round(k.wch))),_.charAt(_.length-1)!=" "&&g.push(_)})}function d(g,y){y.forEach(function(k,w){var _="F;";k.hidden?_+="M0;":k.hpt?_+="M"+20*k.hpt+";":k.hpx&&(_+="M"+20*Q1(k.hpx)+";"),_.length>2&&g.push(_+"R"+(w+1))})}function x(g,y){var k=["ID;PWXL;N;E"],w=[],_=lr(g["!ref"]),S,P=Array.isArray(g),T=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),g["!cols"]&&p(k,g["!cols"]),g["!rows"]&&d(k,g["!rows"]),k.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var z=_.s.r;z<=_.e.r;++z)for(var Z=_.s.c;Z<=_.e.c;++Z){var L=dt({r:z,c:Z});S=P?(g[z]||[])[Z]:g[L],!(!S||S.v==null&&(!S.f||S.F))&&w.push(f(S,g,z,Z))}return k.join(T)+T+w.join(T)+T+"E"+T}return{to_workbook:c,to_sheet:l,from_sheet:x}})(),GE=(function(){function e(o,l){switch(l.type){case"base64":return n(Tn(o),l);case"binary":return n(o,l);case"buffer":return n(_t&&Buffer.isBuffer(o)?o.toString("binary"):mo(o),l);case"array":return n(io(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,p=-1,d=0,x=[];d!==c.length;++d){if(c[d].trim()==="BOT"){x[++f]=[],p=0;continue}if(!(f<0)){var g=c[d].trim().split(","),y=g[0],k=g[1];++d;for(var w=c[d]||"";(w.match(/["]/g)||[]).length&1&&d<c.length-1;)w+=`
`+c[++d];switch(w=w.trim(),+y){case-1:if(w==="BOT"){x[++f]=[],p=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[f][p]=!0:w==="FALSE"?x[f][p]=!1:isNaN(na(k))?isNaN(ai(k).getDate())?x[f][p]=k:x[f][p]=Or(k):x[f][p]=na(k),++p;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[f][p++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function t(o,l){return hi(e(o,l),l)}function r(o,l){return Os(t(o,l),l)}var a=(function(){var o=function(f,p,d,x,g){f.push(p),f.push(d+","+x),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,p,d,x){f.push(p+","+d),f.push(p==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var p=[],d=lr(f["!ref"]),x,g=Array.isArray(f);o(p,"TABLE",0,1,"sheetjs"),o(p,"VECTORS",0,d.e.r-d.s.r+1,""),o(p,"TUPLES",0,d.e.c-d.s.c+1,""),o(p,"DATA",0,0,"");for(var y=d.s.r;y<=d.e.r;++y){l(p,-1,0,"BOT");for(var k=d.s.c;k<=d.e.c;++k){var w=dt({r:y,c:k});if(x=g?(f[y]||[])[k]:f[w],!x){l(p,1,0,"");continue}switch(x.t){case"n":var _=x.w;!_&&x.v!=null&&(_=x.v),_==null?x.f&&!x.F?l(p,1,0,"="+x.f):l(p,1,0,""):l(p,0,_,"V");break;case"b":l(p,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(p,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Un(x.z||mt[14],un(Or(x.v)))),l(p,0,x.w,"V");break;default:l(p,1,0,"")}}}l(p,-1,0,"EOD");var S=`\r
`,P=p.join(S);return P}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),XE=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(x,g){for(var y=x.split(`
`),k=-1,w=-1,_=0,S=[];_!==y.length;++_){var P=y[_].trim().split(":");if(P[0]==="cell"){var T=sn(P[1]);if(S.length<=T.r)for(k=S.length;k<=T.r;++k)S[k]||(S[k]=[]);switch(k=T.r,w=T.c,P[2]){case"t":S[k][w]=e(P[3]);break;case"v":S[k][w]=+P[3];break;case"vtf":var z=P[P.length-1];case"vtc":switch(P[3]){case"nl":S[k][w]=!!+P[4];break;default:S[k][w]=+P[4];break}P[2]=="vtf"&&(S[k][w]=[S[k][w],z])}}}return g&&g.sheetRows&&(S=S.slice(0,g.sheetRows)),S}function r(x,g){return hi(t(x,g),g)}function a(x,g){return Os(r(x,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function p(x){if(!x||!x["!ref"])return"";for(var g=[],y=[],k,w="",_=pi(x["!ref"]),S=Array.isArray(x),P=_.s.r;P<=_.e.r;++P)for(var T=_.s.c;T<=_.e.c;++T)if(w=dt({r:P,c:T}),k=S?(x[P]||[])[T]:x[w],!(!k||k.v==null||k.t==="z")){switch(y=["cell",w,"t"],k.t){case"s":case"str":y.push(n(k.v));break;case"n":k.f?(y[2]="vtf",y[3]="n",y[4]=k.v,y[5]=n(k.f)):(y[2]="v",y[3]=k.v);break;case"b":y[2]="vt"+(k.f?"f":"c"),y[3]="nl",y[4]=k.v?"1":"0",y[5]=n(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var z=un(Or(k.v));y[2]="vtc",y[3]="nd",y[4]=""+z,y[5]=k.w||Un(k.z||mt[14],z);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(x){return[o,l,c,l,p(x),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:d}})(),_l=(function(){function e(d,x,g,y,k){k.raw?x[g][y]=d:d===""||(d==="TRUE"?x[g][y]=!0:d==="FALSE"?x[g][y]=!1:isNaN(na(d))?isNaN(ai(d).getDate())?x[g][y]=d:x[g][y]=Or(d):x[g][y]=na(d))}function n(d,x){var g=x||{},y=[];if(!d||d.length===0)return y;for(var k=d.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var _=10,S=0,P=0;P<=w;++P)S=k[P].indexOf(" "),S==-1?S=k[P].length:S++,_=Math.max(_,S);for(P=0;P<=w;++P){y[P]=[];var T=0;for(e(k[P].slice(0,_).trim(),y,P,T,g),T=1;T<=(k[P].length-_)/10+1;++T)e(k[P].slice(_+(T-1)*10,_+T*10).trim(),y,P,T,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(d){for(var x={},g=!1,y=0,k=0;y<d.length;++y)(k=d.charCodeAt(y))==34?g=!g:!g&&k in t&&(x[k]=(x[k]||0)+1);k=[];for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y]);if(!k.length){x=r;for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y])}return k.sort(function(w,_){return w[0]-_[0]||r[w[1]]-r[_[1]]}),t[k.pop()[1]]||44}function o(d,x){var g=x||{},y="",k=g.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(y=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(y=d.charAt(4),d=d.slice(6)):y=a(d.slice(0,1024)):g&&g.FS?y=g.FS:y=a(d.slice(0,1024));var _=0,S=0,P=0,T=0,z=0,Z=y.charCodeAt(0),L=!1,C=0,Q=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=g.dateNF!=null?o_(g.dateNF):null;function te(){var X=d.slice(T,z),U={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)U.t="z";else if(g.raw)U.t="s",U.v=X;else if(X.trim().length===0)U.t="s",U.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(U.t="s",U.v=X.slice(2,-1).replace(/""/g,'"')):MT(X)?(U.t="n",U.f=X.slice(1)):(U.t="s",U.v=X);else if(X=="TRUE")U.t="b",U.v=!0;else if(X=="FALSE")U.t="b",U.v=!1;else if(!isNaN(P=na(X)))U.t="n",g.cellText!==!1&&(U.w=X),U.v=P;else if(!isNaN(ai(X).getDate())||j&&X.match(j)){U.z=g.dateNF||mt[14];var ue=0;j&&X.match(j)&&(X=i_(X,g.dateNF,X.match(j)||[]),ue=1),g.cellDates?(U.t="d",U.v=Or(X,ue)):(U.t="n",U.v=un(Or(X,ue))),g.cellText!==!1&&(U.w=Un(U.z,U.v instanceof Date?un(U.v):U.v)),g.cellNF||delete U.z}else U.t="s",U.v=X;if(U.t=="z"||(g.dense?(k[_]||(k[_]=[]),k[_][S]=U):k[dt({c:S,r:_})]=U),T=z+1,Q=d.charCodeAt(T),w.e.c<S&&(w.e.c=S),w.e.r<_&&(w.e.r=_),C==Z)++S;else if(S=0,++_,g.sheetRows&&g.sheetRows<=_)return!0}e:for(;z<d.length;++z)switch(C=d.charCodeAt(z)){case 34:Q===34&&(L=!L);break;case Z:case 10:case 13:if(!L&&te())break e;break}return z-T>0&&te(),k["!ref"]=St(w),k}function l(d,x){return!(x&&x.PRN)||x.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?o(d,x):hi(n(d,x),x)}function c(d,x){var g="",y=x.type=="string"?[0,0,0,0]:Ep(d,x);switch(x.type){case"base64":g=Tn(d);break;case"binary":g=d;break;case"buffer":x.codepage==65001?g=d.toString("utf8"):x.codepage&&typeof vl<"u"||(g=_t&&Buffer.isBuffer(d)?d.toString("binary"):mo(d));break;case"array":g=io(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+x.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=Xt(g.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?g=Xt(g):x.type=="binary"&&typeof vl<"u",g.slice(0,19)=="socialcalc:version:"?XE.to_sheet(x.type=="string"?g:Xt(g),x):l(g,x)}function f(d,x){return Os(c(d,x),x)}function p(d){for(var x=[],g=lr(d["!ref"]),y,k=Array.isArray(d),w=g.s.r;w<=g.e.r;++w){for(var _=[],S=g.s.c;S<=g.e.c;++S){var P=dt({r:w,c:S});if(y=k?(d[w]||[])[S]:d[P],!y||y.v==null){_.push("          ");continue}for(var T=(y.w||(Ka(y),y.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(S===0?" ":""))}x.push(_.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:p}})();function QE(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=KE.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return _l.to_workbook(e,n)}}var pl=(function(){function e(E,I,R){if(E){jr(E,E.l||0);for(var W=R.Enum||H;E.l<E.length;){var ie=E.read_shift(2),de=W[ie]||W[65535],he=E.read_shift(2),oe=E.l+he,ee=de.f&&de.f(E,he,R);if(E.l=oe,I(ee,de,ie))return}}}function n(E,I){switch(I.type){case"base64":return t(ea(Tn(E)),I);case"binary":return t(ea(E),I);case"buffer":case"array":return t(E,I)}throw"Unsupported type "+I.type}function t(E,I){if(!E)return E;var R=I||{},W=R.dense?[]:{},ie="Sheet1",de="",he=0,oe={},ee=[],re=[],F={s:{r:0,c:0},e:{r:0,c:0}},Ce=R.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)R.Enum=H,e(E,function(Ie,ne,Se){switch(Se){case 0:R.vers=Ie,Ie>=4096&&(R.qpro=!0);break;case 6:F=Ie;break;case 204:Ie&&(de=Ie);break;case 222:de=Ie;break;case 15:case 51:R.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:Se==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=R.dateNF||mt[14],R.cellDates&&(Ie[1].t="d",Ie[1].v=Gu(Ie[1].v))),R.qpro&&Ie[3]>he&&(W["!ref"]=St(F),oe[ie]=W,ee.push(ie),W=R.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},he=Ie[3],ie=de||"Sheet"+(he+1),de="");var Ee=R.dense?(W[Ie[0].r]||[])[Ie[0].c]:W[dt(Ie[0])];if(Ee){Ee.t=Ie[1].t,Ee.v=Ie[1].v,Ie[1].z!=null&&(Ee.z=Ie[1].z),Ie[1].f!=null&&(Ee.f=Ie[1].f);break}R.dense?(W[Ie[0].r]||(W[Ie[0].r]=[]),W[Ie[0].r][Ie[0].c]=Ie[1]):W[dt(Ie[0])]=Ie[1];break}},R);else if(E[2]==26||E[2]==14)R.Enum=O,E[2]==14&&(R.qpro=!0,E.l=0),e(E,function(Ie,ne,Se){switch(Se){case 204:ie=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>he&&(W["!ref"]=St(F),oe[ie]=W,ee.push(ie),W=R.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},he=Ie[3],ie="Sheet"+(he+1)),Ce>0&&Ie[0].r>=Ce)break;R.dense?(W[Ie[0].r]||(W[Ie[0].r]=[]),W[Ie[0].r][Ie[0].c]=Ie[1]):W[dt(Ie[0])]=Ie[1],F.e.c<Ie[0].c&&(F.e.c=Ie[0].c),F.e.r<Ie[0].r&&(F.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(re[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:re[Ie[0]]=Ie[1],Ie[0]==he&&(ie=Ie[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(W["!ref"]=St(F),oe[de||ie]=W,ee.push(de||ie),!re.length)return{SheetNames:ee,Sheets:oe};for(var De={},Ve=[],He=0;He<re.length;++He)oe[ee[He]]?(Ve.push(re[He]||ee[He]),De[re[He]]=oe[re[He]]||oe[ee[He]]):(Ve.push(re[He]),De[re[He]]={"!ref":"A1"});return{SheetNames:Ve,Sheets:De}}function r(E,I){var R=I||{};if(+R.codepage>=0&&ta(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var W=bd(),ie=lr(E["!ref"]),de=Array.isArray(E),he=[];Jn(W,0,o(1030)),Jn(W,6,f(ie));for(var oe=Math.min(ie.e.r,8191),ee=ie.s.r;ee<=oe;++ee)for(var re=Br(ee),F=ie.s.c;F<=ie.e.c;++F){ee===ie.s.r&&(he[F]=Er(F));var Ce=he[F]+re,De=de?(E[ee]||[])[F]:E[Ce];if(!(!De||De.t=="z"))if(De.t=="n")(De.v|0)==De.v&&De.v>=-32768&&De.v<=32767?Jn(W,13,y(ee,F,De.v)):Jn(W,14,w(ee,F,De.v));else{var Ve=Ka(De);Jn(W,15,x(ee,F,Ve.slice(0,239)))}}return Jn(W,1),W.end()}function a(E,I){var R=I||{};if(+R.codepage>=0&&ta(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var W=bd();Jn(W,0,l(E));for(var ie=0,de=0;ie<E.SheetNames.length;++ie)(E.Sheets[E.SheetNames[ie]]||{})["!ref"]&&Jn(W,27,M(E.SheetNames[ie],de++));var he=0;for(ie=0;ie<E.SheetNames.length;++ie){var oe=E.Sheets[E.SheetNames[ie]];if(!(!oe||!oe["!ref"])){for(var ee=lr(oe["!ref"]),re=Array.isArray(oe),F=[],Ce=Math.min(ee.e.r,8191),De=ee.s.r;De<=Ce;++De)for(var Ve=Br(De),He=ee.s.c;He<=ee.e.c;++He){De===ee.s.r&&(F[He]=Er(He));var Ie=F[He]+Ve,ne=re?(oe[De]||[])[He]:oe[Ie];if(!(!ne||ne.t=="z"))if(ne.t=="n")Jn(W,23,te(De,He,he,ne.v));else{var Se=Ka(ne);Jn(W,22,C(De,He,he,Se.slice(0,239)))}}++he}}return Jn(W,1),W.end()}function o(E){var I=br(2);return I.write_shift(2,E),I}function l(E){var I=br(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var R=0,W=0,ie=0,de=0;de<E.SheetNames.length;++de){var he=E.SheetNames[de],oe=E.Sheets[he];if(!(!oe||!oe["!ref"])){++ie;var ee=pi(oe["!ref"]);R<ee.e.r&&(R=ee.e.r),W<ee.e.c&&(W=ee.e.c)}}return R>8191&&(R=8191),I.write_shift(2,R),I.write_shift(1,ie),I.write_shift(1,W),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function c(E,I,R){var W={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&R.qpro?(W.s.c=E.read_shift(1),E.l++,W.s.r=E.read_shift(2),W.e.c=E.read_shift(1),E.l++,W.e.r=E.read_shift(2),W):(W.s.c=E.read_shift(2),W.s.r=E.read_shift(2),I==12&&R.qpro&&(E.l+=2),W.e.c=E.read_shift(2),W.e.r=E.read_shift(2),I==12&&R.qpro&&(E.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function f(E){var I=br(8);return I.write_shift(2,E.s.c),I.write_shift(2,E.s.r),I.write_shift(2,E.e.c),I.write_shift(2,E.e.r),I}function p(E,I,R){var W=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(W[0].c=E.read_shift(1),W[3]=E.read_shift(1),W[0].r=E.read_shift(2),E.l+=2):(W[2]=E.read_shift(1),W[0].c=E.read_shift(2),W[0].r=E.read_shift(2)),W}function d(E,I,R){var W=E.l+I,ie=p(E,I,R);if(ie[1].t="s",R.vers==20768){E.l++;var de=E.read_shift(1);return ie[1].v=E.read_shift(de,"utf8"),ie}return R.qpro&&E.l++,ie[1].v=E.read_shift(W-E.l,"cstr"),ie}function x(E,I,R){var W=br(7+R.length);W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,E),W.write_shift(1,39);for(var ie=0;ie<W.length;++ie){var de=R.charCodeAt(ie);W.write_shift(1,de>=128?95:de)}return W.write_shift(1,0),W}function g(E,I,R){var W=p(E,I,R);return W[1].v=E.read_shift(2,"i"),W}function y(E,I,R){var W=br(7);return W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,E),W.write_shift(2,R,"i"),W}function k(E,I,R){var W=p(E,I,R);return W[1].v=E.read_shift(8,"f"),W}function w(E,I,R){var W=br(13);return W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,E),W.write_shift(8,R,"f"),W}function _(E,I,R){var W=E.l+I,ie=p(E,I,R);if(ie[1].v=E.read_shift(8,"f"),R.qpro)E.l=W;else{var de=E.read_shift(2);z(E.slice(E.l,E.l+de),ie),E.l+=de}return ie}function S(E,I,R){var W=I&32768;return I&=-32769,I=(W?E:0)+(I>=8192?I-16384:I),(W?"":"$")+(R?Er(I):Br(I))}var P={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(E,I){jr(E,0);for(var R=[],W=0,ie="",de="",he="",oe="";E.l<E.length;){var ee=E[E.l++];switch(ee){case 0:R.push(E.read_shift(8,"f"));break;case 1:de=S(I[0].c,E.read_shift(2),!0),ie=S(I[0].r,E.read_shift(2),!1),R.push(de+ie);break;case 2:{var re=S(I[0].c,E.read_shift(2),!0),F=S(I[0].r,E.read_shift(2),!1);de=S(I[0].c,E.read_shift(2),!0),ie=S(I[0].r,E.read_shift(2),!1),R.push(re+F+":"+de+ie)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(E.read_shift(2));break;case 6:{for(var Ce="";ee=E[E.l++];)Ce+=String.fromCharCode(ee);R.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:oe=R.pop(),he=R.pop(),R.push(["AND","OR"][ee-20]+"("+he+","+oe+")");break;default:if(ee<32&&T[ee])oe=R.pop(),he=R.pop(),R.push(he+T[ee]+oe);else if(P[ee]){if(W=P[ee][1],W==69&&(W=E[E.l++]),W>R.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+R.join("|")+"|");return}var De=R.slice(-W);R.length-=W,R.push(P[ee][0]+"("+De.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}R.length==1?I[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function Z(E){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=E.read_shift(2),I[3]=E[E.l++],I[0].c=E[E.l++],I}function L(E,I){var R=Z(E);return R[1].t="s",R[1].v=E.read_shift(I-4,"cstr"),R}function C(E,I,R,W){var ie=br(6+W.length);ie.write_shift(2,E),ie.write_shift(1,R),ie.write_shift(1,I),ie.write_shift(1,39);for(var de=0;de<W.length;++de){var he=W.charCodeAt(de);ie.write_shift(1,he>=128?95:he)}return ie.write_shift(1,0),ie}function Q(E,I){var R=Z(E);R[1].v=E.read_shift(2);var W=R[1].v>>1;if(R[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return R[1].v=W,R}function j(E,I){var R=Z(E),W=E.read_shift(4),ie=E.read_shift(4),de=E.read_shift(2);if(de==65535)return W===0&&ie===3221225472?(R[1].t="e",R[1].v=15):W===0&&ie===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var he=de&32768;return de=(de&32767)-16446,R[1].v=(1-he*2)*(ie*Math.pow(2,de+32)+W*Math.pow(2,de)),R}function te(E,I,R,W){var ie=br(14);if(ie.write_shift(2,E),ie.write_shift(1,R),ie.write_shift(1,I),W==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var de=0,he=0,oe=0,ee=0;return W<0&&(de=1,W=-W),he=Math.log2(W)|0,W/=Math.pow(2,he-31),ee=W>>>0,(ee&2147483648)==0&&(W/=2,++he,ee=W>>>0),W-=ee,ee|=2147483648,ee>>>=0,W*=Math.pow(2,32),oe=W>>>0,ie.write_shift(4,oe),ie.write_shift(4,ee),he+=16383+(de?32768:0),ie.write_shift(2,he),ie}function X(E,I){var R=j(E);return E.l+=I-14,R}function U(E,I){var R=Z(E),W=E.read_shift(4);return R[1].v=W>>6,R}function ue(E,I){var R=Z(E),W=E.read_shift(8,"f");return R[1].v=W,R}function le(E,I){var R=ue(E);return E.l+=I-10,R}function ae(E,I){return E[E.l+I-1]==0?E.read_shift(I,"cstr"):""}function pe(E,I){var R=E[E.l++];R>I-1&&(R=I-1);for(var W="";W.length<R;)W+=String.fromCharCode(E[E.l++]);return W}function V(E,I,R){if(!(!R.qpro||I<21)){var W=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var ie=E.read_shift(I-21,"cstr");return[W,ie]}}function se(E,I){for(var R={},W=E.l+I;E.l<W;){var ie=E.read_shift(2);if(ie==14e3){for(R[ie]=[0,""],R[ie][0]=E.read_shift(2);E[E.l];)R[ie][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return R}function M(E,I){var R=br(5+E.length);R.write_shift(2,14e3),R.write_shift(2,I);for(var W=0;W<E.length;++W){var ie=E.charCodeAt(W);R[R.l++]=ie>127?95:ie}return R[R.l++]=0,R}var H={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},O={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:V},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function qE(e){var n={},t=e.match(qr),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=ct(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=ep[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var ZE=(function(){var e=wl("t"),n=wl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:At(l[1])},f=o.match(n);return f&&(c.s=qE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),JE=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),eS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,tS=/<(?:\w+:)?r>/,rS=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function gp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=At(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Xt(e),t&&(r.h=ip(r.t))):e.match(tS)&&(r.r=Xt(e),r.t=At(Xt((e.replace(rS,"").match(eS)||[]).join("").replace(qr,""))),t&&(r.h=JE(ZE(r.r)))),r):{t:""}}var nS=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,aS=/<(?:\w+:)?(?:si|sstItem)>/g,sS=/<\/(?:\w+:)?(?:si|sstItem)>/;function oS(e,n){var t=[],r="";if(!e)return t;var a=e.match(nS);if(a){r=a[2].replace(aS,"").split(sS);for(var o=0;o!=r.length;++o){var l=gp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=ct(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function iS(e){return[e.read_shift(4),e.read_shift(4)]}function lS(e,n){var t=[],r=!1;return Xa(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Y1(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Wa(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function cS(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function uS(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function fS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(uS(e));return n}function dS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function pS(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function hS(e){var n=pS(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function $1(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function V1(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function mS(e){var n=Wa(e);switch(n.Minor){case 2:return[n.Minor,xS(e)];case 3:return[n.Minor,gS()];case 4:return[n.Minor,vS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function xS(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=$1(e,t),a=V1(e,e.length-e.l);return{t:"Std",h:r,v:a}}function gS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vS(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(qr,function(o){var l=ct(o);switch(Ta(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function yS(e,n){var t={},r=t.EncryptionVersionInfo=Wa(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=$1(e,a),n-=a,t.EncryptionVerifier=V1(e,n),t}function wS(e){var n={},t=n.EncryptionVersionInfo=Wa(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function kS(e){var n=0,t,r=Y1(e),a=r.length+1,o,l,c,f,p;for(t=Cs(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,p=c|f,n=p^l;return n^52811}var K1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,p=l.length-1;p>=0;--p)for(var d=l[p],x=0;x!=7;++x)d&64&&(c^=t[f]),d*=2,--f;return c};return function(l){for(var c=Y1(l),f=o(c),p=c.length,d=Cs(16),x=0;x!=16;++x)d[x]=0;var g,y,k;for((p&1)===1&&(g=f>>8,d[p]=a(e[0],g),--p,g=f&255,y=c[c.length-1],d[p]=a(y,g));p>0;)--p,g=f>>8,d[p]=a(c[p],g),--p,g=f&255,d[p]=a(c[p],g);for(p=15,k=15-c.length;k>0;)g=f>>8,d[p]=a(e[k],g),--p,--k,g=f&255,d[p]=a(c[p],g),--p,--k;return d}})(),_S=function(e,n,t,r,a){a||(a=n),r||(r=K1(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},bS=function(e){var n=0,t=K1(e);return function(r){var a=_S("",r,n,t);return n=a[1],a[0]}};function ES(e,n,t,r){var a={key:yr(e),verificationBytes:yr(e)};return t.password&&(a.verifier=kS(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=bS(t.password)),a}function SS(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=wS(e):r.Data=yS(e,n),r}function TS(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?SS(e,n-2,r):ES(e,t.biff>=8?n:n-2,t,r),r}var CS=(function(){function e(a,o){switch(o.type){case"base64":return n(Tn(a),o);case"binary":return n(a,o);case"buffer":return n(_t&&Buffer.isBuffer(a)?a.toString("binary"):mo(a),o);case"array":return n(io(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(d,x){Array.isArray(c)&&(c[x]=[]);for(var g=/\\\w+\b/g,y=0,k,w=-1;k=g.exec(d);){switch(k[0]){case"\\cell":var _=d.slice(y,g.lastIndex-k[0].length);if(_[0]==" "&&(_=_.slice(1)),++w,_.length){var S={v:_,t:"s"};Array.isArray(c)?c[x][w]=S:c[dt({r:x,c:w})]=S}break}y=g.lastIndex}w>p.e.c&&(p.e.c=w)}),c["!ref"]=St(p),c}function t(a,o){return Os(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=lr(a["!ref"]),c,f=Array.isArray(a),p=l.s.r;p<=l.e.r;++p){o.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)o.push("\\cellx"+(d+1));for(o.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var x=dt({r:p,c:d});c=f?(a[p]||[])[d]:a[x],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Ka(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function DS(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function bl(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function NS(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,p=a+o;switch(f=l/(p>1?2-p:p),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,p/2]}function FS(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var p=0;p!=3;++p)l[p]=Math.round(l[p]*255);return l}function Cu(e,n){if(n===0)return e;var t=NS(DS(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),bl(FS(t))}var G1=6,AS=15,OS=1,nn=G1;function Du(e){return Math.floor((e+Math.round(128/nn)/256)*nn)}function Nu(e){return Math.floor((e-5)/nn*100+.5)/100}function Cd(e){return Math.round((e*nn+5)/nn*256)/256}function td(e){return Cd(Nu(Du(e)))}function vp(e){var n=Math.abs(e-td(e)),t=nn;if(n>.005)for(nn=OS;nn<AS;++nn)Math.abs(e-td(e))<=n&&(n=Math.abs(e-td(e)),t=nn);nn=t}function si(e){e.width?(e.wpx=Du(e.width),e.wch=Nu(e.wpx),e.MDW=nn):e.wpx?(e.wch=Nu(e.wpx),e.width=Cd(e.wch),e.MDW=nn):typeof e.wch=="number"&&(e.width=Cd(e.wch),e.wpx=Du(e.width),e.MDW=nn),e.customWidth&&delete e.customWidth}var PS=96,X1=PS;function Q1(e){return e*96/X1}function El(e){return e*X1/96}var RS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function MS(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(qr)||[]).forEach(function(l){var c=ct(l);switch(Ta(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=er(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=er(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function IS(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(qr)||[]).forEach(function(l){var c=ct(l);switch(Ta(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function jS(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(qr)||[]).forEach(function(l){var c=ct(l);switch(Ta(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Xt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?er(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?er(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?er(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?er(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?er(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?er(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?er(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=ep[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=er(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=to[a.color.index];a.color.index==81&&(f=to[1]),f||(f=to[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Cu(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function LS(e,n,t){n.NumberFmt=[];for(var r=Ea(mt),a=0;a<r.length;++a)n.NumberFmt[r[a]]=mt[r[a]];var o=e[0].match(qr);if(o)for(a=0;a<o.length;++a){var l=ct(o[a]);switch(Ta(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=At(Xt(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}eo(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var ru=["numFmtId","fillId","fontId","borderId","xfId"],nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zS(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(qr)||[]).forEach(function(o){var l=ct(o),c=0;switch(Ta(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<ru.length;++c)r[ru[c]]&&(r[ru[c]]=parseInt(r[ru[c]],10));for(c=0;c<nu.length;++c)r[nu[c]]&&(r[nu[c]]=er(r[nu[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=er(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var BS=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,p){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=c.match(n))&&LS(x,d,p),(x=c.match(a))&&jS(x,d,f,p),(x=c.match(r))&&IS(x,d,f,p),(x=c.match(o))&&MS(x,d,f,p),(x=c.match(t))&&zS(x,d,p),d}})();function WS(e,n){var t=e.read_shift(2),r=Xr(e);return[t,r]}function US(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=Z_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=q_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Xr(e),r}var HS=Qr;function YS(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var $S=Qr;function VS(e,n,t){var r={};r.NumberFmt=[];for(var a in mt)r.NumberFmt[a]=mt[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return Xa(e,function(f,p,d){switch(d){case 44:r.NumberFmt[f[0]]=f[1],eo(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=Cu(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(d),l=!0;break;case 38:o.pop(),l=!1;break;default:if(p.T>0)o.push(d);else if(p.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}var KS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function GS(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(qr)||[]).forEach(function(a){var o=ct(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[KS.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function XS(){}function QS(){}var qS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ZS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,JS=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function eT(e,n,t){n.themeElements={};var r;[["clrScheme",qS,GS],["fontScheme",ZS,XS],["fmtScheme",JS,QS]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var tT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function q1(e,n){(!e||e.length===0)&&(e=rT());var t,r={};if(!(t=e.match(tT)))throw new Error("themeElements not found in theme");return eT(t[0],r,n),r.raw=e,r}function rT(e,n){var t=[l1];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function nT(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=i1(o,{type:"array"})}catch{return}var c=En(l,"theme/theme/theme1.xml",!0);if(c)return q1(c,t)}}function aT(e){return e.read_shift(4)}function sT(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=oT(e,4);break;case 2:n.xclrValue=j1(e);break;case 3:n.xclrValue=aT(e);break;case 4:e.l+=4;break}return e.l+=8,n}function oT(e,n){return Qr(e,n)}function iT(e,n){return Qr(e,n)}function lT(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=sT(e);break;case 6:r[1]=iT(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function cT(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(lT(e,t-e.l));return{ixfe:r,ext:o}}function uT(e,n){n.forEach(function(t){t[0]})}function fT(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Xr(e)}}function dT(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function pT(e){return e.l+=4,e.read_shift(4)!=0}function hT(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return Xa(e,function(f,p,d){switch(d){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(x){c==1?r.Cell.push({type:r.Types[x[0]-1].name,index:x[1]}):c==0&&r.Value.push({type:r.Types[x[0]-1].name,index:x[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(d),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!p.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function mT(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(qr,function(c){var f=ct(c);switch(Ta(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var p=0;p<r.Types.length;++p)r.Types[p].name==f.name&&(l=r.Types[p]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function xT(e){var n=[];if(!e)return n;var t=1;return(e.match(qr)||[]).forEach(function(r){var a=ct(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function gT(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=dt(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function vT(e,n,t){var r=[];return Xa(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function yT(e,n,t,r){if(!e)return e;var a=r||{},o=!1;Xa(e,function(c,f,p){switch(p){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}},a)}function wT(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function _g(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=sn(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=lr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var p=St(f);p!==e["!ref"]&&(e["!ref"]=p)}o.c||(o.c=[]);var d={a:l.author,t:l.t,r:l.r,T:t};l.h&&(d.h=l.h);for(var x=o.c.length-1;x>=0;--x){if(!t&&o.c[x].T)return;t&&!o.c[x].T&&o.c.splice(x,1)}if(t&&r){for(x=0;x<r.length;++x)if(d.a==r[x].id){d.a=r[x].name||d.a;break}}o.c.push(d)})}function kT(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=ct(c[0]),p={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},d=sn(f.ref);if(!(n.sheetRows&&n.sheetRows<=d.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!x&&!!x[1]&&gp(x[1])||{r:"",t:"",h:""};p.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),p.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(p.h=g.h),r.push(p)}}}}),r}function _T(e,n){var t=[],r=!1,a={},o=0;return e.replace(qr,function(c,f){var p=ct(c);switch(Ta(p[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:p.personId,guid:p.id,ref:p.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in threaded comments")}return c}),t}function bT(e,n){var t=[],r=!1;return e.replace(qr,function(o){var l=ct(o);switch(Ta(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function ET(e){var n={};n.iauthor=e.read_shift(4);var t=go(e);return n.rfx=t.s,n.ref=dt(t.s),e.l+=16,n}var ST=Xr;function TT(e,n){var t=[],r=[],a={},o=!1;return Xa(e,function(c,f,p){switch(p){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}),t}var CT="application/vnd.ms-office.vbaProject";function DT(e){var n=Et.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Et.utils.cfb_add(n,a,e.FileIndex[r].content)}}),Et.write(n)}function NT(){return{"!type":"dialog"}}function FT(){return{"!type":"dialog"}}function AT(){return{"!type":"macro"}}function OT(){return{"!type":"macro"}}var Zo=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var p=o.length>0?parseInt(o,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return c?d+=n.c:--d,f?p+=n.r:--p,a+(c?"":"$")+Er(d)+(f?"":"$")+Br(p)}return function(a,o){return n=o,a.replace(e,t)}})(),Z1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,PT=(function(){return function(n,t){return n.replace(Z1,function(r,a,o,l,c,f){var p=fp(l)-(o?0:t.c),d=up(f)-(c?0:t.r),x=d==0?"":c?d+1:"["+d+"]",g=p==0?"":o?p+1:"["+p+"]";return a+"R"+x+"C"+g})}})();function J1(e,n){return e.replace(Z1,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Er(fp(o)+n.c))+(l=="$"?l+c:Br(up(c)+n.r))})}function RT(e,n,t){var r=pi(n),a=r.s,o=sn(t),l={r:o.r-a.r,c:o.c-a.c};return J1(e,l)}function MT(e){return e.length!=1}function bg(e){return e.replace(/_xlfn\./g,"")}function gr(e){e.l+=1}function Ds(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function ey(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return ty(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Ds(e),c=Ds(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function ty(e){var n=Ds(e),t=Ds(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function IT(e,n,t){if(t.biff<8)return ty(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=Ds(e),l=Ds(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ry(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return jT(e);var r=e.read_shift(t&&t.biff==12?4:2),a=Ds(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function jT(e){var n=Ds(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function LT(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function zT(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return BT(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function BT(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function WT(e,n,t){var r=(e[e.l++]&96)>>5,a=ey(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function UT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=ey(e,o,t);return[r,a,l]}function HT(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function YT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function $T(e,n,t){var r=(e[e.l++]&96)>>5,a=IT(e,n-1,t);return[r,a]}function VT(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Eg(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function KT(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function GT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function XT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function QT(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function qT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function ny(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function ZT(e){return e.read_shift(2),ny(e)}function JT(e){return e.read_shift(2),ny(e)}function eC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=ry(e,0,t);return[r,a]}function tC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=zT(e,0,t);return[r,a]}function rC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=ry(e,0,t);return[r,a,o]}function nC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[aD[a],oy[a],r]}function aC(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:sC(e);return[a,(o[0]===0?oy:nD)[o[1]]]}function sC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function oC(e,n,t){e.l+=t&&t.biff==2?3:4}function iC(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function lC(e){return e.l++,vo[e.read_shift(1)]}function cC(e){return e.l++,e.read_shift(2)}function uC(e){return e.l++,e.read_shift(1)!==0}function fC(e){return e.l++,Kr(e)}function dC(e,n,t){return e.l++,Al(e,n-1,t)}function pC(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=pr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=vo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Kr(e);break;case 2:t[1]=yo(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function hC(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?go:Xu)(e));return a}function mC(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=pC(e,t.biff);return l}function xC(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function gC(e,n,t){if(t.biff==5)return vC(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function vC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function yC(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function wC(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function kC(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function _C(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var bC=Qr,EC=Qr,SC=Qr;function Pl(e,n,t){return e.l+=2,[LT(e)]}function yp(e){return e.l+=6,[]}var TC=Pl,CC=yp,DC=yp,NC=Pl;function ay(e){return e.l+=2,[yr(e),e.read_shift(2)&1]}var FC=Pl,AC=ay,OC=yp,PC=Pl,RC=Pl,MC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function IC(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=MC[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function jC(e){return e.l+=2,[e.read_shift(4)]}function LC(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function zC(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function BC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function WC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function UC(e){return e.l+=4,[0,0]}var Sg={1:{n:"PtgExp",f:iC},2:{n:"PtgTbl",f:SC},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:dC},26:{n:"PtgSheet",f:LC},27:{n:"PtgEndSheet",f:zC},28:{n:"PtgErr",f:lC},29:{n:"PtgBool",f:uC},30:{n:"PtgInt",f:cC},31:{n:"PtgNum",f:fC},32:{n:"PtgArray",f:VT},33:{n:"PtgFunc",f:nC},34:{n:"PtgFuncVar",f:aC},35:{n:"PtgName",f:xC},36:{n:"PtgRef",f:eC},37:{n:"PtgArea",f:WT},38:{n:"PtgMemArea",f:yC},39:{n:"PtgMemErr",f:bC},40:{n:"PtgMemNoMem",f:EC},41:{n:"PtgMemFunc",f:wC},42:{n:"PtgRefErr",f:kC},43:{n:"PtgAreaErr",f:HT},44:{n:"PtgRefN",f:tC},45:{n:"PtgAreaN",f:$T},46:{n:"PtgMemAreaN",f:BC},47:{n:"PtgMemNoMemN",f:WC},57:{n:"PtgNameX",f:gC},58:{n:"PtgRef3d",f:rC},59:{n:"PtgArea3d",f:UT},60:{n:"PtgRefErr3d",f:_C},61:{n:"PtgAreaErr3d",f:YT},255:{}},HC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YC={1:{n:"PtgElfLel",f:ay},2:{n:"PtgElfRw",f:PC},3:{n:"PtgElfCol",f:TC},6:{n:"PtgElfRwV",f:RC},7:{n:"PtgElfColV",f:NC},10:{n:"PtgElfRadical",f:FC},11:{n:"PtgElfRadicalS",f:OC},13:{n:"PtgElfColS",f:CC},15:{n:"PtgElfColSV",f:DC},16:{n:"PtgElfRadicalLel",f:AC},25:{n:"PtgList",f:IC},29:{n:"PtgSxName",f:jC},255:{}},$C={0:{n:"PtgAttrNoop",f:UC},1:{n:"PtgAttrSemi",f:qT},2:{n:"PtgAttrIf",f:XT},4:{n:"PtgAttrChoose",f:KT},8:{n:"PtgAttrGoto",f:GT},16:{n:"PtgAttrSum",f:oC},32:{n:"PtgAttrBaxcel",f:Eg},33:{n:"PtgAttrBaxcel",f:Eg},64:{n:"PtgAttrSpace",f:ZT},65:{n:"PtgAttrSpaceSemi",f:JT},128:{n:"PtgAttrIfError",f:QT},255:{}};function Rl(e,n,t,r){if(r.biff<8)return Qr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=mC(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=hC(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(Qr(e,n)),o}function Ml(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Sg[o]||Sg[HC[o]],(o===24||o===25)&&(a=(o===24?YC:$C)[e[e.l+1]]),!a||!a.f?Qr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function VC(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var KC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function GC(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function sy(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Tg(e,n,t){var r=sy(e,n,t);return r=="#REF"?r:GC(r,t)}function Vr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,p,d,x=0,g=0,y,k="";if(!e[0]||!e[0][0])return"";for(var w=-1,_="",S=0,P=e[0].length;S<P;++S){var T=e[0][S];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),p=c.pop(),w>=0){switch(e[0][w][1][0]){case 0:_=ir(" ",e[0][w][1][1]);break;case 1:_=ir("\r",e[0][w][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}p=p+_,w=-1}c.push(p+KC[T[0]]+f);break;case"PtgIsect":f=c.pop(),p=c.pop(),c.push(p+" "+f);break;case"PtgUnion":f=c.pop(),p=c.pop(),c.push(p+","+f);break;case"PtgRange":f=c.pop(),p=c.pop(),c.push(p+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=cl(T[1][1],l,a),c.push(ul(d,o));break;case"PtgRefN":d=t?cl(T[1][1],t,a):T[1][1],c.push(ul(d,o));break;case"PtgRef3d":x=T[1][1],d=cl(T[1][2],l,a),k=Tg(r,x,a),c.push(k+"!"+ul(d,o));break;case"PtgFunc":case"PtgFuncVar":var z=T[1][0],Z=T[1][1];z||(z=0),z&=127;var L=z==0?[]:c.slice(-z);c.length-=z,Z==="User"&&(Z=L.shift()),c.push(Z+"("+L.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":y=og(T[1][1],t?{s:t}:l,a),c.push(J0(y,a));break;case"PtgArea":y=og(T[1][1],l,a),c.push(J0(y,a));break;case"PtgArea3d":x=T[1][1],y=T[1][2],k=Tg(r,x,a),c.push(k+"!"+J0(y,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=T[1][2];var C=(r.names||[])[g-1]||(r[0]||[])[g],Q=C?C.Name:"SH33TJSNAME"+String(g);Q&&Q.slice(0,6)=="_xlfn."&&!a.xlfn&&(Q=Q.slice(6)),c.push(Q);break;case"PtgNameX":var j=T[1][1];g=T[1][2];var te;if(a.biff<=5)j<0&&(j=-j),r[j]&&(te=r[j][g]);else{var X="";if(((r[j]||[])[0]||[])[0]==14849||(((r[j]||[])[0]||[])[0]==1025?r[j][g]&&r[j][g].itab>0&&(X=r.SheetNames[r[j][g].itab-1]+"!"):X=r.SheetNames[g-1]+"!"),r[j]&&r[j][g])X+=r[j][g].Name;else if(r[0]&&r[0][g])X+=r[0][g].Name;else{var U=(sy(r,j,a)||"").split(";;");U[g-1]?X=U[g-1]:X+="SH33TJSERRX"}c.push(X);break}te||(te={Name:"SH33TJSERRY"}),c.push(te.Name);break;case"PtgParen":var ue="(",le=")";if(w>=0){switch(_="",e[0][w][1][0]){case 2:ue=ir(" ",e[0][w][1][1])+ue;break;case 3:ue=ir("\r",e[0][w][1][1])+ue;break;case 4:le=ir(" ",e[0][w][1][1])+le;break;case 5:le=ir("\r",e[0][w][1][1])+le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}c.push(ue+c.pop()+le);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var ae={c:t.c,r:t.r};if(r.sharedf[dt(d)]){var pe=r.sharedf[dt(d)];c.push(Vr(pe,l,ae,r,a))}else{var V=!1;for(f=0;f!=r.arrayf.length;++f)if(p=r.arrayf[f],!(d.c<p[0].s.c||d.c>p[0].e.c)&&!(d.r<p[0].s.r||d.r>p[0].e.r)){c.push(Vr(p[1],l,ae,r,a)),V=!0;break}V||c.push(T[1])}break;case"PtgArray":c.push("{"+VC(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&se.indexOf(e[0][S][0])==-1){T=e[0][w];var M=!0;switch(T[1][0]){case 4:M=!1;case 0:_=ir(" ",T[1][1]);break;case 5:M=!1;case 1:_=ir("\r",T[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((M?_:"")+c.pop()+(M?"":_)),w=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function XC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Qr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function QC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Qr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function qC(e,n,t,r){var a=e.l+n,o=Ml(e,r,t),l;return a!==e.l&&(l=Rl(e,a-e.l,o,t)),[o,l]}function ZC(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=Ml(e,o,t);return o==65535?[[],Qr(e,n-2)]:(n!==o+2&&(a=Rl(e,r-o-2,l,t)),[l,a])}function JC(e){var n;if(za(e,e.l+6)!==65535)return[Kr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function rd(e,n,t){var r=e.l+n,a=Ca(e);t.biff==2&&++e.l;var o=JC(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=QC(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function Qu(e,n,t){var r=e.read_shift(4),a=Ml(e,r,t),o=e.read_shift(4),l=o>0?Rl(e,o,a,t):null;return[a,l]}var eD=Qu,qu=Qu,tD=Qu,rD=Qu,nD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Cg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function nd(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var hl={},Jo={};function ml(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function iy(e,n,t,r,a,o){try{r.cellNF&&(e.z=mt[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Or(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(mt[n]==null&&eo(s_[n]||"General",n),e.t==="e")e.w=e.w||vo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v);else if(e.t==="d"){var l=un(e.v);(l|0)===l?e.w=l.toString(10):e.w=yl(l)}else{if(e.v===void 0)return"";e.w=oo(e.v,Jo)}else e.t==="d"?e.w=Un(n,un(e.v),Jo):e.w=Un(n,e.v,Jo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Cu(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Cu(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function sD(e,n){var t=lr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=St(t))}var oD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,iD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,lD=/<(?:\w:)?hyperlink [^>]*>/mg,cD=/"(\w*:\w*)"/,uD=/<(?:\w:)?col\b[^>]*[\/]?>/g,fD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,dD=/<(?:\w:)?pageMargins[^>]*\/>/g,ly=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,pD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,hD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function mD(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p="",d="",x=e.match(iD);x?(p=e.slice(0,x.index),d=e.slice(x.index+x[0].length)):p=d=e;var g=p.match(ly);g?wp(g[0],c,a,t):(g=p.match(pD))&&xD(g[0],g[1]||"",c,a,t);var y=(p.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var k=p.slice(y,y+50).match(cD);k&&sD(c,k[1])}var w=p.match(hD);w&&w[1]&&_D(w[1],a);var _=[];if(n.cellStyles){var S=p.match(uD);S&&yD(_,S)}x&&bD(x[1],c,n,f,o,l);var P=d.match(fD);P&&(c["!autofilter"]=wD(P[0]));var T=[],z=d.match(oD);if(z)for(y=0;y!=z.length;++y)T[y]=lr(z[y].slice(z[y].indexOf('"')+1));var Z=d.match(lD);Z&&gD(c,Z,r);var L=d.match(dD);if(L&&(c["!margins"]=vD(ct(L[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=St(f)),n.sheetRows>0&&c["!ref"]){var C=lr(c["!ref"]);n.sheetRows<=+C.e.r&&(C.e.r=n.sheetRows-1,C.e.r>f.e.r&&(C.e.r=f.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>f.e.c&&(C.e.c=f.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),c["!fullref"]=c["!ref"],c["!ref"]=St(C))}return _.length>0&&(c["!cols"]=_),T.length>0&&(c["!merges"]=T),c}function wp(e,n,t,r){var a=ct(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=At(Xt(a.codeName)))}function xD(e,n,t,r,a){wp(e.slice(0,e.indexOf(">")),t,r,a)}function gD(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=ct(Xt(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+At(o.location))):(o.Target="#"+At(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=lr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var p=c.s.c;p<=c.e.c;++p){var d=dt({c:p,r:f});r?(e[f]||(e[f]=[]),e[f][p]||(e[f][p]={t:"z",v:void 0}),e[f][p].l=o):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=o)}}}function vD(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function yD(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=ct(n[r],!0);a.hidden&&(a.hidden=er(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,vp(a.width)),si(a);o<=l;)e[o++]=zr(a)}}function wD(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var kD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function _D(e,n){n.Views||(n.Views=[{}]),(e.match(kD)||[]).forEach(function(t,r){var a=ct(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),er(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var bD=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=wl("v"),l=wl("f");return function(f,p,d,x,g,y){for(var k=0,w="",_=[],S=[],P=0,T=0,z=0,Z="",L,C,Q=0,j=0,te,X,U=0,ue=0,le=Array.isArray(y.CellXf),ae,pe=[],V=[],se=Array.isArray(p),M=[],H={},O=!1,E=!!d.sheetStubs,I=f.split(n),R=0,W=I.length;R!=W;++R){w=I[R].trim();var ie=w.length;if(ie!==0){var de=0;e:for(k=0;k<ie;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(d&&d.cellStyles){if(C=ct(w.slice(de,k),!0),Q=C.r!=null?parseInt(C.r,10):Q+1,j=-1,d.sheetRows&&d.sheetRows<Q)continue;H={},O=!1,C.ht&&(O=!0,H.hpt=parseFloat(C.ht),H.hpx=El(H.hpt)),C.hidden=="1"&&(O=!0,H.hidden=!0),C.outlineLevel!=null&&(O=!0,H.level=+C.outlineLevel),O&&(M[Q-1]=H)}break;case"<":de=k;break}if(de>=k)break;if(C=ct(w.slice(de,k),!0),Q=C.r!=null?parseInt(C.r,10):Q+1,j=-1,!(d.sheetRows&&d.sheetRows<Q)){x.s.r>Q-1&&(x.s.r=Q-1),x.e.r<Q-1&&(x.e.r=Q-1),d&&d.cellStyles&&(H={},O=!1,C.ht&&(O=!0,H.hpt=parseFloat(C.ht),H.hpx=El(H.hpt)),C.hidden=="1"&&(O=!0,H.hidden=!0),C.outlineLevel!=null&&(O=!0,H.level=+C.outlineLevel),O&&(M[Q-1]=H)),_=w.slice(k).split(e);for(var he=0;he!=_.length&&_[he].trim().charAt(0)=="<";++he);for(_=_.slice(he),k=0;k!=_.length;++k)if(w=_[k].trim(),w.length!==0){if(S=w.match(t),P=k,T=0,z=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,S!=null&&S.length===2){for(P=0,Z=S[1],T=0;T!=Z.length&&!((z=Z.charCodeAt(T)-64)<1||z>26);++T)P=26*P+z;--P,j=P}else++j;for(T=0;T!=w.length&&w.charCodeAt(T)!==62;++T);if(++T,C=ct(w.slice(0,T),!0),C.r||(C.r=dt({r:Q-1,c:j})),Z=w.slice(T),L={t:""},(S=Z.match(o))!=null&&S[1]!==""&&(L.v=At(S[1])),d.cellFormula){if((S=Z.match(l))!=null&&S[1]!==""){if(L.f=At(Xt(S[1])).replace(/\r\n/g,`
`),d.xlfn||(L.f=bg(L.f)),S[0].indexOf('t="array"')>-1)L.F=(Z.match(a)||[])[1],L.F.indexOf(":")>-1&&pe.push([lr(L.F),L.F]);else if(S[0].indexOf('t="shared"')>-1){X=ct(S[0]);var oe=At(Xt(S[1]));d.xlfn||(oe=bg(oe)),V[parseInt(X.si,10)]=[X,oe,C.r]}}else(S=Z.match(/<f[^>]*\/>/))&&(X=ct(S[0]),V[X.si]&&(L.f=RT(V[X.si][1],V[X.si][2],C.r)));var ee=sn(C.r);for(T=0;T<pe.length;++T)ee.r>=pe[T][0].s.r&&ee.r<=pe[T][0].e.r&&ee.c>=pe[T][0].s.c&&ee.c<=pe[T][0].e.c&&(L.F=pe[T][1])}if(C.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(E)L.t="z";else continue;else L.t=C.t||"n";switch(x.s.c>j&&(x.s.c=j),x.e.c<j&&(x.e.c=j),L.t){case"n":if(L.v==""||L.v==null){if(!E)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!E)continue;L.t="z"}else te=hl[parseInt(L.v,10)],L.v=te.t,L.r=te.r,d.cellHTML&&(L.h=te.h);break;case"str":L.t="s",L.v=L.v!=null?Xt(L.v):"",d.cellHTML&&(L.h=ip(L.v));break;case"inlineStr":S=Z.match(r),L.t="s",S!=null&&(te=gp(S[1]))?(L.v=te.t,d.cellHTML&&(L.h=te.h)):L.v="";break;case"b":L.v=er(L.v);break;case"d":d.cellDates?L.v=Or(L.v,1):(L.v=un(Or(L.v,1)),L.t="n");break;case"e":(!d||d.cellText!==!1)&&(L.w=L.v),L.v=N1[L.v];break}if(U=ue=0,ae=null,le&&C.s!==void 0&&(ae=y.CellXf[C.s],ae!=null&&(ae.numFmtId!=null&&(U=ae.numFmtId),d.cellStyles&&ae.fillId!=null&&(ue=ae.fillId))),iy(L,U,ue,d,g,y),d.cellDates&&le&&L.t=="n"&&di(mt[U])&&(L.t="d",L.v=Gu(L.v)),C.cm&&d.xlmeta){var re=(d.xlmeta.Cell||[])[+C.cm-1];re&&re.type=="XLDAPR"&&(L.D=!0)}if(se){var F=sn(C.r);p[F.r]||(p[F.r]=[]),p[F.r][F.c]=L}else p[C.r]=L}}}}M.length>0&&(p["!rows"]=M)}})();function ED(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var SD=go;function TD(){}function CD(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=X_(e),t}function DD(e){var n=Yn(e);return[n]}function ND(e){var n=xo(e);return[n]}function FD(e){var n=Yn(e),t=e.read_shift(1);return[n,t,"b"]}function AD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"b"]}function OD(e){var n=Yn(e),t=e.read_shift(1);return[n,t,"e"]}function PD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"e"]}function RD(e){var n=Yn(e),t=e.read_shift(4);return[n,t,"s"]}function MD(e){var n=xo(e),t=e.read_shift(4);return[n,t,"s"]}function ID(e){var n=Yn(e),t=Kr(e);return[n,t,"n"]}function cy(e){var n=xo(e),t=Kr(e);return[n,t,"n"]}function jD(e){var n=Yn(e),t=hp(e);return[n,t,"n"]}function LD(e){var n=xo(e),t=hp(e);return[n,t,"n"]}function zD(e){var n=Yn(e),t=dp(e);return[n,t,"is"]}function BD(e){var n=Yn(e),t=Xr(e);return[n,t,"str"]}function WD(e){var n=xo(e),t=Xr(e);return[n,t,"str"]}function UD(e,n,t){var r=e.l+n,a=Yn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}function HD(e,n,t){var r=e.l+n,a=Yn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}function YD(e,n,t){var r=e.l+n,a=Yn(e);a.r=t["!row"];var o=Kr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}function $D(e,n,t){var r=e.l+n,a=Yn(e);a.r=t["!row"];var o=Xr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=qu(e,r-e.l,t);l[3]=Vr(c,null,a,t.supbooks,t)}else e.l=r;return l}var VD=go;function KD(e,n){var t=e.l+n,r=go(e),a=pp(e),o=Xr(e),l=Xr(e),c=Xr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function GD(){}function XD(e,n,t){var r=e.l+n,a=T1(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=eD(e,r-e.l,t);l[1]=c}else e.l=r;return l}function QD(e,n,t){var r=e.l+n,a=go(e),o=[a];if(t.cellFormula){var l=rD(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var qD=["left","right","top","bottom","header","footer"];function ZD(e){var n={};return qD.forEach(function(t){n[t]=Kr(e)}),n}function JD(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function e4(){}function t4(){}function r4(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},p,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,g=!1,y,k,w,_,S,P,T,z,Z,L=[];c.biff=12,c["!row"]=0;var C=0,Q=!1,j=[],te={},X=c.supbooks||a.supbooks||[[]];if(X.sharedf=te,X.arrayf=j,X.SheetNames=a.SheetNames||a.Sheets.map(function(se){return se.name}),!c.supbooks&&(c.supbooks=X,a.Names))for(var U=0;U<a.Names.length;++U)X[0][U+1]=a.Names[U];var ue=[],le=[],ae=!1;Fu[16]={n:"BrtShortReal",f:cy};var pe;if(Xa(e,function(M,H,O){if(!g)switch(O){case 148:p=M;break;case 0:y=M,c.sheetRows&&c.sheetRows<=y.r&&(g=!0),z=Br(_=y.r),c["!row"]=y.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=El(M.hpt)),le[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:M[2]},M[2]){case"n":k.v=M[1];break;case"s":T=hl[M[1]],k.v=T.t,k.r=T.r;break;case"b":k.v=!!M[1];break;case"e":k.v=M[1],c.cellText!==!1&&(k.w=vo[k.v]);break;case"str":k.t="s",k.v=M[1];break;case"is":k.t="s",k.v=M[1].t;break}if((w=l.CellXf[M[0].iStyleRef])&&iy(k,w.numFmtId,null,c,o,l),S=M[0].c==-1?S+1:M[0].c,c.dense?(f[_]||(f[_]=[]),f[_][S]=k):f[Er(S)+z]=k,c.cellFormula){for(Q=!1,C=0;C<j.length;++C){var E=j[C];y.r>=E[0].s.r&&y.r<=E[0].e.r&&S>=E[0].s.c&&S<=E[0].e.c&&(k.F=St(E[0]),Q=!0)}!Q&&M.length>3&&(k.f=M[3])}if(d.s.r>y.r&&(d.s.r=y.r),d.s.c>S&&(d.s.c=S),d.e.r<y.r&&(d.e.r=y.r),d.e.c<S&&(d.e.c=S),c.cellDates&&w&&k.t=="n"&&di(mt[w.numFmtId])){var I=Qs(k.v);I&&(k.t="d",k.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}pe&&(pe.type=="XLDAPR"&&(k.D=!0),pe=void 0);break;case 1:case 12:if(!c.sheetStubs||x)break;k={t:"z",v:void 0},S=M[0].c==-1?S+1:M[0].c,c.dense?(f[_]||(f[_]=[]),f[_][S]=k):f[Er(S)+z]=k,d.s.r>y.r&&(d.s.r=y.r),d.s.c>S&&(d.s.c=S),d.e.r<y.r&&(d.e.r=y.r),d.e.c<S&&(d.e.c=S),pe&&(pe.type=="XLDAPR"&&(k.D=!0),pe=void 0);break;case 176:L.push(M);break;case 49:pe=((c.xlmeta||{}).Cell||[])[M-1];break;case 494:var R=r["!id"][M.relId];for(R?(M.Target=R.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=R):M.relId==""&&(M.Target="#"+M.loc),_=M.rfx.s.r;_<=M.rfx.e.r;++_)for(S=M.rfx.s.c;S<=M.rfx.e.c;++S)c.dense?(f[_]||(f[_]=[]),f[_][S]||(f[_][S]={t:"z",v:void 0}),f[_][S].l=M):(P=dt({c:S,r:_}),f[P]||(f[P]={t:"z",v:void 0}),f[P].l=M);break;case 426:if(!c.cellFormula)break;j.push(M),Z=c.dense?f[_][S]:f[Er(S)+z],Z.f=Vr(M[1],d,{r:y.r,c:S},X,c),Z.F=St(M[0]);break;case 427:if(!c.cellFormula)break;te[dt(M[0].s)]=M[1],Z=c.dense?f[_][S]:f[Er(S)+z],Z.f=Vr(M[1],d,{r:y.r,c:S},X,c);break;case 60:if(!c.cellStyles)break;for(;M.e>=M.s;)ue[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ae||(ae=!0,vp(M.w/256)),si(ue[M.e+1]);break;case 161:f["!autofilter"]={ref:St(M)};break;case 476:f["!margins"]=M;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),M.name&&(a.Sheets[t].CodeName=M.name),(M.above||M.left)&&(f["!outline"]={above:M.above,left:M.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),M.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!H.T){if(!x||c.WTF)throw new Error("Unexpected record 0x"+O.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(d.s.r<2e6||p&&(p.e.r>0||p.e.c>0||p.s.r>0||p.s.c>0))&&(f["!ref"]=St(p||d)),c.sheetRows&&f["!ref"]){var V=lr(f["!ref"]);c.sheetRows<=+V.e.r&&(V.e.r=c.sheetRows-1,V.e.r>d.e.r&&(V.e.r=d.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>d.e.c&&(V.e.c=d.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),f["!fullref"]=f["!ref"],f["!ref"]=St(V))}return L.length>0&&(f["!merges"]=L),ue.length>0&&(f["!cols"]=ue),le.length>0&&(f["!rows"]=le),f}function n4(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function a4(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,p="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var g=n4(x);d.s.r=d.s.c=0,d.e.c=c,p=Er(c),g[0].forEach(function(y,k){l[p+Br(k)]={t:"n",v:y,z:g[1]},f=k}),d.e.r<f&&(d.e.r=f),++c}),c>0&&(l["!ref"]=St(d)),l}function s4(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(ly);return c&&wp(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function o4(e,n){e.l+=10;var t=Xr(e);return{name:t}}function i4(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Xa(e,function(f,p,d){switch(d){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(p.T>0)){if(!(p.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var uy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],l4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],c4=[],u4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Dg(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=er(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Ng(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=er(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function fy(e){Ng(e.WBProps,uy),Ng(e.CalcPr,u4),Dg(e.WBView,l4),Dg(e.Sheets,c4),Jo.date1904=er(e.WBProps.date1904)}var f4="][*?/\\".split("");function d4(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return f4.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var p4=/<\w+:workbook/;function h4(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(qr,function(f,p){var d=ct(f);switch(Ta(d[0])){case"<?xml":break;case"<workbook":f.match(p4)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],t.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uy.forEach(function(x){if(d[x[0]]!=null)switch(x[2]){case"bool":t.WBProps[x[0]]=er(d[x[0]]);break;case"int":t.WBProps[x[0]]=parseInt(d[x[0]],10);break;default:t.WBProps[x[0]]=d[x[0]]}}),d.codeName&&(t.WBProps.CodeName=Xt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],t.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=At(Xt(d.name)),delete d[0],t.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=Xt(d.name),d.comment&&(o.Comment=d.comment),d.localSheetId&&(o.Sheet=+d.localSheetId),er(d.hidden||"0")&&(o.Hidden=!0),l=p+f.length;break;case"</definedName>":o.Ref=At(Xt(e.slice(l,p))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete d[0],t.CalcPr=d;break;case"<calcPr/>":delete d[0],t.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return f}),O_.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return fy(t),t}function m4(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Ed(e),t.name=Xr(e),t}function x4(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?Xr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function g4(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function v4(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=Q_(e),l=tD(e,0,t),c=pp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function y4(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Fu[16]={n:"BrtFRTArchID$",f:g4},Xa(e,function(f,p,d){switch(d){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Vr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,f]):l[0]=[d,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(d),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(d),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!p.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},n),fy(t),t.Names=o,t.supbooks=l,t}function w4(e,n,t){return n.slice(-4)===".bin"?y4(e,t):h4(e,t)}function k4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?r4(e,r,t,a,o,l,c):mD(e,r,t,a,o,l,c)}function _4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?i4(e,r,t,a,o):s4(e,r,t,a,o)}function b4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?AT():OT()}function E4(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?NT():FT()}function S4(e,n,t,r){return n.slice(-4)===".bin"?VS(e,t,r):BS(e,t,r)}function T4(e,n,t){return q1(e,t)}function C4(e,n,t){return n.slice(-4)===".bin"?lS(e,t):oS(e,t)}function D4(e,n,t){return n.slice(-4)===".bin"?TT(e,t):kT(e,t)}function N4(e,n,t){return n.slice(-4)===".bin"?vT(e):xT(e)}function F4(e,n,t,r){return t.slice(-4)===".bin"?yT(e,n,t,r):void 0}function A4(e,n,t){return n.slice(-4)===".bin"?hT(e,n,t):mT(e,n,t)}var dy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,py=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zn(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(dy),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(py),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function O4(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(dy),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(py),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var xl;function P4(e,n){var t=xl[e]||At(e);return t==="General"?oo(n):Un(t,n)}function R4(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=er(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Or(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[At(n)]=a}function M4(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=P4(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=xl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&di(r)){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function I4(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=RS[r.Pattern]||r.Pattern)}e[n.ID]=n}function j4(e,n,t,r,a,o,l,c,f,p){var d="General",x=r.StyleID,g={};p=p||{};var y=[],k=0;for(x===void 0&&c&&(x=c.StyleID),x===void 0&&l&&(x=l.StyleID);o[x]!==void 0&&(o[x].nf&&(d=o[x].nf),o[x].Interior&&y.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=er(e);break;case"String":r.t="s",r.r=qx(At(e)),r.v=e.indexOf("<")>-1?At(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Or(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=At(e):r.v<60&&(r.v=r.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=N1[e],p.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=qx(n||e));break}if(M4(r,d,p),p.cellFormula!==!1)if(r.Formula){var w=At(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=Zo(w,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Zo("RC:RC",a):r.ArrayRange&&(r.F=Zo(r.ArrayRange,a),f.push([lr(r.F),r.F]))}else for(k=0;k<f.length;++k)a.r>=f[k][0].s.r&&a.r<=f[k][0].e.r&&a.c>=f[k][0].s.c&&a.c<=f[k][0].e.c&&(r.F=f[k][1]);p.cellStyles&&(y.forEach(function(_){!g.patternType&&_.patternType&&(g.patternType=_.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function L4(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ad(e,n){var t=n||{};t1();var r=rl(lp(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Xt(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=zr(t);return l.type="string",_l.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ne){a.indexOf("<"+ne)>=0&&(o=!0)}),o)return K4(r,t);xl={"General Number":"General","General Date":mt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":mt[15],"Short Date":mt[14],"Long Time":mt[19],"Medium Time":mt[18],"Short Time":mt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:mt[2],Standard:mt[4],Percent:mt[10],Scientific:mt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],p,d={},x=[],g=t.dense?[]:{},y="",k={},w={},_=Zn('<Data ss:Type="String">'),S=0,P=0,T=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},Z={},L={},C="",Q=0,j=[],te={},X={},U=0,ue=[],le=[],ae={},pe=[],V,se=!1,M=[],H=[],O={},E=0,I=0,R={Sheets:[],WBProps:{date1904:!1}},W={};kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";c=kl.exec(r);)switch(c[3]=(ie=c[3]).toLowerCase()){case"data":if(ie=="data"){if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?j4(r.slice(S,c.index),C,_,f[f.length-1][0]=="comment"?ae:k,{c:P,r:T},Z,pe[P],w,M,t):(C="",_=Zn(c[0]),S=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(le.length>0&&(k.c=le),(!t.sheetRows||t.sheetRows>T)&&k.v!==void 0&&(t.dense?(g[T]||(g[T]=[]),g[T][P]=k):g[Er(P)+Br(T)]=k),k.HRef&&(k.l={Target:At(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(E=P+(parseInt(k.MergeAcross,10)|0),I=T+(parseInt(k.MergeDown,10)|0),j.push({s:{c:P,r:T},e:{c:E,r:I}})),!t.sheetStubs)k.MergeAcross?P=E+1:++P;else if(k.MergeAcross||k.MergeDown){for(var de=P;de<=E;++de)for(var he=T;he<=I;++he)(de>P||he>T)&&(t.dense?(g[he]||(g[he]=[]),g[he][de]={t:"z"}):g[Er(de)+Br(he)]={t:"z"});P=E+1}else++P;else k=O4(c[0]),k.Index&&(P=+k.Index-1),P<z.s.c&&(z.s.c=P),P>z.e.c&&(z.e.c=P),c[0].slice(-2)==="/>"&&++P,le=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(T<z.s.r&&(z.s.r=T),T>z.e.r&&(z.e.r=T),c[0].slice(-2)==="/>"&&(w=Zn(c[0]),w.Index&&(T=+w.Index-1)),P=0,++T):(w=Zn(c[0]),w.Index&&(T=+w.Index-1),O={},(w.AutoFitHeight=="0"||w.Height)&&(O.hpx=parseInt(w.Height,10),O.hpt=Q1(O.hpx),H[T]=O),w.Hidden=="1"&&(O.hidden=!0,H[T]=O));break;case"worksheet":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"));x.push(y),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(g["!ref"]=St(z),t.sheetRows&&t.sheetRows<=z.e.r&&(g["!fullref"]=g["!ref"],z.e.r=t.sheetRows-1,g["!ref"]=St(z))),j.length&&(g["!merges"]=j),pe.length>0&&(g["!cols"]=pe),H.length>0&&(g["!rows"]=H),d[y]=g}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=P=0,f.push([c[3],!1]),p=Zn(c[0]),y=At(p.Name),g=t.dense?[]:{},j=[],M=[],H=[],W={name:y,Hidden:0},R.Sheets.push(W);break;case"table":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),pe=[],se=!1}break;case"style":c[1]==="/"?I4(Z,L,t):L=Zn(c[0]);break;case"numberformat":L.nf=At(Zn(c[0]).Format||"General"),xl[L.nf]&&(L.nf=xl[L.nf]);for(var oe=0;oe!=392&&mt[oe]!=L.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if(mt[oe]==null){eo(L.nf,oe);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(V=Zn(c[0]),V.Hidden&&(V.hidden=!0,delete V.Hidden),V.Width&&(V.wpx=parseInt(V.Width,10)),!se&&V.wpx>10){se=!0,nn=G1;for(var ee=0;ee<pe.length;++ee)pe[ee]&&si(pe[ee])}se&&si(V),pe[V.Index-1||pe.length]=V;for(var re=0;re<+V.Span;++re)pe[pe.length]=zr(V);break;case"namedrange":if(c[1]==="/")break;R.Names||(R.Names=[]);var F=ct(c[0]),Ce={Name:F.Name,Ref:Zo(F.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(Ce.Sheet=R.Sheets.length-1),R.Names.push(Ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?C+=r.slice(Q,c.index):Q=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;L.Interior=Zn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?kb(te,ie,r.slice(U,c.index)):U=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"));L4(ae),le.push(ae)}else f.push([c[3],!1]),p=Zn(c[0]),ae={a:p.Author};break;case"autofilter":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var De=Zn(c[0]);g["!autofilter"]={ref:Zo(De.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((p=f.pop())[0]!==c[3])throw new Error("Bad state: "+p.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return Mg(r,t);var Ve=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ve=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ve=!1}break;case"excelworkbook":switch(c[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ve=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Ve=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(U,c.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else U=c.index+c[0].length;break;case"header":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+ct(c[0]).Margin)||(g["!margins"].header=+ct(c[0]).Margin);break;case"footer":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+ct(c[0]).Margin)||(g["!margins"].footer=+ct(c[0]).Margin);break;case"pagemargins":var He=ct(c[0]);g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+He.Top)||(g["!margins"].top=+He.Top),isNaN(+He.Left)||(g["!margins"].left=+He.Left),isNaN(+He.Right)||(g["!margins"].right=+He.Right),isNaN(+He.Bottom)||(g["!margins"].bottom=+He.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ve=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ve=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ve=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ve=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ve=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ve=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ve=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ve=!1}break;case"smarttags":break;default:Ve=!1;break}if(Ve||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?R4(X,ie,ue,r.slice(U,c.index)):(ue=c,U=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Ie={};return!t.bookSheets&&!t.bookProps&&(Ie.Sheets=d),Ie.SheetNames=x,Ie.Workbook=R,Ie.SSF=zr(mt),Ie.Props=te,Ie.Custprops=X,Ie}function Dd(e,n){switch(bp(n=n||{}),n.type||"base64"){case"base64":return ad(Tn(e),n);case"binary":case"buffer":case"file":return ad(e,n);case"array":return ad(mo(e),n)}}function z4(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=J_(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=eb(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var B4=[60,1084,2066,2165,2175];function W4(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=za(t,t.l),p=Nd[f],d=0;p!=null&&B4.indexOf(f)>-1;)o=za(t,t.l+2),d=t.l+4,f==2066?d+=4:(f==2165||f==2175)&&(d+=12),c=t.slice(d,t.l+4+o),l.push(c),t.l+=4+o,p=Nd[f=za(t,t.l)];var x=ys(l);jr(x,0);var g=0;x.lens=[];for(var y=0;y<l.length;++y)x.lens.push(g),g+=l[y].length;if(x.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+r;return n.f(x,x.length,a)}function ha(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=mt[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=Un(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&di(mt[r]||String(r))){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function au(e,n,t){return{v:e,ixfe:n,t}}function U4(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],p="",d={},x,g="",y,k,w,_,S={},P=[],T,z,Z=[],L=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Q={},j=function(et){return et<8?to[et]:et<64&&L[et-8]||to[et]},te=function(et,vt,xt){var pt=vt.XF.data;if(!(!pt||!pt.patternType||!xt||!xt.cellStyles)){vt.s={},vt.s.patternType=pt.patternType;var Mt;(Mt=bl(j(pt.icvFore)))&&(vt.s.fgColor={rgb:Mt}),(Mt=bl(j(pt.icvBack)))&&(vt.s.bgColor={rgb:Mt})}},X=function(et,vt,xt){if(!(O>1)&&!(xt.sheetRows&&et.r>=xt.sheetRows)){if(xt.cellStyles&&vt.XF&&vt.XF.data&&te(et,vt,xt),delete vt.ixfe,delete vt.XF,x=et,g=dt(et),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),et.r<l.s.r&&(l.s.r=et.r),et.c<l.s.c&&(l.s.c=et.c),et.r+1>l.e.r&&(l.e.r=et.r+1),et.c+1>l.e.c&&(l.e.c=et.c+1),xt.cellFormula&&vt.f){for(var pt=0;pt<P.length;++pt)if(!(P[pt][0].s.c>et.c||P[pt][0].s.r>et.r)&&!(P[pt][0].e.c<et.c||P[pt][0].e.r<et.r)){vt.F=St(P[pt][0]),(P[pt][0].s.c!=et.c||P[pt][0].s.r!=et.r)&&delete vt.f,vt.f&&(vt.f=""+Vr(P[pt][1],l,et,M,U));break}}xt.dense?(a[et.r]||(a[et.r]=[]),a[et.r][et.c]=vt):a[g]=vt}},U={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:P,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(U.password=n.password);var ue,le=[],ae=[],pe=[],V=[],se=!1,M=[];M.SheetNames=U.snames,M.sharedf=U.sharedf,M.arrayf=U.arrayf,M.names=[],M.XTI=[];var H=0,O=0,E=0,I=[],R=[],W;U.codepage=1200,ta(1200);for(var ie=!1;e.l<e.length-1;){var de=e.l,he=e.read_shift(2);if(he===0&&H===10)break;var oe=e.l===e.length?0:e.read_shift(2),ee=Nd[he];if(ee&&ee.f){if(n.bookSheets&&H===133&&he!==133)break;if(H=he,ee.r===2||ee.r==12){var re=e.read_shift(2);if(oe-=2,!U.enc&&re!==he&&((re&255)<<8|re>>8)!==he)throw new Error("rt mismatch: "+re+"!="+he);ee.r==12&&(e.l+=10,oe-=10)}var F={};if(he===10?F=ee.f(e,oe,U):F=W4(he,ee,e,oe,U),O==0&&[9,521,1033,2057].indexOf(H)===-1)continue;switch(he){case 34:t.opts.Date1904=C.WBProps.date1904=F;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(U.enc||(e.l=0),U.enc=F,!n.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=F;break;case 66:var Ce=Number(F);switch(Ce){case 21010:Ce=1200;break;case 32768:Ce=1e4;break;case 32769:Ce=1252;break}ta(U.codepage=Ce),ie=!0;break;case 317:U.rrtabid=F;break;case 25:U.winlocked=F;break;case 439:t.opts.RefreshAll=F;break;case 12:t.opts.CalcCount=F;break;case 16:t.opts.CalcDelta=F;break;case 17:t.opts.CalcIter=F;break;case 13:t.opts.CalcMode=F;break;case 14:t.opts.CalcPrecision=F;break;case 95:t.opts.CalcSaveRecalc=F;break;case 15:U.CalcRefMode=F;break;case 2211:t.opts.FullCalc=F;break;case 129:F.fDialog&&(a["!type"]="dialog"),F.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),F.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:Z.push(F);break;case 430:M.push([F]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(F);break;case 24:case 536:W={Name:F.Name,Ref:Vr(F.rgce,l,null,M,U)},F.itab>0&&(W.Sheet=F.itab-1),M.names.push(W),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(R[F.itab-1]={ref:St(F.rgce[0][0][1][2])});break;case 22:U.ExternCount=F;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(F),M.XTI=M.XTI.concat(F);break;case 2196:if(U.biff<8)break;W!=null&&(W.Comment=F[1]);break;case 18:a["!protect"]=F;break;case 19:F!==0&&U.WTF&&console.error("Password verifier: "+F);break;case 133:o[F.pos]=F,U.snames.push(F.name);break;case 10:{if(--O)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=St(l),n.sheetRows&&n.sheetRows<=l.e.r){var De=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=St(l),l.e.r=De}l.e.r++,l.e.c++}le.length>0&&(a["!merges"]=le),ae.length>0&&(a["!objects"]=ae),pe.length>0&&(a["!cols"]=pe),V.length>0&&(a["!rows"]=V),C.Sheets.push(Q)}p===""?d=a:r[p]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[he]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),U.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(U.biff=5,ie=!0,ta(U.codepage=28591)),U.biff==8&&F.BIFFVer==0&&F.dt==16&&(U.biff=2),O++)break;if(a=n.dense?[]:{},U.biff<8&&!ie&&(ie=!0,ta(U.codepage=n.codepage||1252)),U.biff<5||F.BIFFVer==0&&F.dt==4096){p===""&&(p="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ve={pos:e.l-oe,name:p};o[Ve.pos]=Ve,U.snames.push(p)}else p=(o[de]||{name:""}).name;F.dt==32&&(a["!type"]="chart"),F.dt==64&&(a["!type"]="macro"),le=[],ae=[],U.arrayf=P=[],pe=[],V=[],se=!1,Q={Hidden:(o[de]||{hs:0}).hs,name:p}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[F.r]||[])[F.c]:a[dt({c:F.c,r:F.r})])&&++F.c,T={ixfe:F.ixfe,XF:Z[F.ixfe]||{},v:F.val,t:"n"},E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 5:case 517:T={ixfe:F.ixfe,XF:Z[F.ixfe],v:F.val,t:F.t},E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 638:T={ixfe:F.ixfe,XF:Z[F.ixfe],v:F.rknum,t:"n"},E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 189:for(var He=F.c;He<=F.C;++He){var Ie=F.rkrec[He-F.c][0];T={ixfe:Ie,XF:Z[Ie],v:F.rkrec[He-F.c][1],t:"n"},E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:He,r:F.r},T,n)}break;case 6:case 518:case 1030:{if(F.val=="String"){c=F;break}if(T=au(F.val,F.cell.ixfe,F.tt),T.XF=Z[T.ixfe],n.cellFormula){var ne=F.formula;if(ne&&ne[0]&&ne[0][0]&&ne[0][0][0]=="PtgExp"){var Se=ne[0][0][1][0],Ee=ne[0][0][1][1],Fe=dt({r:Se,c:Ee});S[Fe]?T.f=""+Vr(F.formula,l,F.cell,M,U):T.F=((n.dense?(a[Se]||[])[Ee]:a[Fe])||{}).F}else T.f=""+Vr(F.formula,l,F.cell,M,U)}E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X(F.cell,T,n),c=F}break;case 7:case 519:if(c)c.val=F,T=au(F,c.cell.ixfe,"s"),T.XF=Z[T.ixfe],n.cellFormula&&(T.f=""+Vr(c.formula,l,c.cell,M,U)),E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X(c.cell,T,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{P.push(F);var qe=dt(F[0].s);if(y=n.dense?(a[F[0].s.r]||[])[F[0].s.c]:a[qe],n.cellFormula&&y){if(!c||!qe||!y)break;y.f=""+Vr(F[1],l,F[0],M,U),y.F=St(F[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;S[dt(c.cell)]=F[0],y=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[dt(c.cell)],(y||{}).f=""+Vr(F[0],l,x,M,U)}}break;case 253:T=au(f[F.isst].t,F.ixfe,"s"),f[F.isst].h&&(T.h=f[F.isst].h),T.XF=Z[T.ixfe],E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 513:n.sheetStubs&&(T={ixfe:F.ixfe,XF:Z[F.ixfe],t:"z"},E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n));break;case 190:if(n.sheetStubs)for(var it=F.c;it<=F.C;++it){var kt=F.ixfe[it-F.c];T={ixfe:kt,XF:Z[kt],t:"z"},E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:it,r:F.r},T,n)}break;case 214:case 516:case 4:T=au(F.val,F.ixfe,"s"),T.XF=Z[T.ixfe],E>0&&(T.z=I[T.ixfe>>8&63]),ha(T,n,t.opts.Date1904),X({c:F.c,r:F.r},T,n);break;case 0:case 512:O===1&&(l=F);break;case 252:f=F;break;case 1054:if(U.biff==4){I[E++]=F[1];for(var bt=0;bt<E+163&&mt[bt]!=F[1];++bt);bt>=163&&eo(F[1],E+163)}else eo(F[1],F[0]);break;case 30:{I[E++]=F;for(var Rt=0;Rt<E+163&&mt[Rt]!=F;++Rt);Rt>=163&&eo(F,E+163)}break;case 229:le=le.concat(F);break;case 93:ae[F.cmo[0]]=U.lastobj=F;break;case 438:U.lastobj.TxO=F;break;case 127:U.lastobj.ImData=F;break;case 440:for(_=F[0].s.r;_<=F[0].e.r;++_)for(w=F[0].s.c;w<=F[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[dt({c:w,r:_})],y&&(y.l=F[1]);break;case 2048:for(_=F[0].s.r;_<=F[0].e.r;++_)for(w=F[0].s.c;w<=F[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[dt({c:w,r:_})],y&&y.l&&(y.l.Tooltip=F[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;y=n.dense?(a[F[0].r]||[])[F[0].c]:a[dt(F[0])];var Ot=ae[F[2]];y||(n.dense?(a[F[0].r]||(a[F[0].r]=[]),y=a[F[0].r][F[0].c]={t:"z"}):y=a[dt(F[0])]={t:"z"},l.e.r=Math.max(l.e.r,F[0].r),l.s.r=Math.min(l.s.r,F[0].r),l.e.c=Math.max(l.e.c,F[0].c),l.s.c=Math.min(l.s.c,F[0].c)),y.c||(y.c=[]),k={a:F[1],t:Ot.TxO.t},y.c.push(k)}break;case 2173:uT(Z[F.ixfe],F.ext);break;case 125:{if(!U.cellStyles)break;for(;F.e>=F.s;)pe[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},se||(se=!0,vp(F.w/256)),si(pe[F.e+1])}break;case 520:{var ht={};F.level!=null&&(V[F.r]=ht,ht.level=F.level),F.hidden&&(V[F.r]=ht,ht.hidden=!0),F.hpt&&(V[F.r]=ht,ht.hpt=F.hpt,ht.hpx=El(F.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ml(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[he]]=F;break;case 161:a["!margins"]||ml(a["!margins"]={}),a["!margins"].header=F.header,a["!margins"].footer=F.footer;break;case 574:F.RTL&&(C.Views[0].RTL=!0);break;case 146:L=F;break;case 2198:ue=F;break;case 140:z=F;break;case 442:p?Q.CodeName=F||Q.name:C.WBProps.CodeName=F||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+he.toString(16)),e.l+=oe}return t.SheetNames=Ea(o).sort(function(Tt,et){return Number(Tt)-Number(et)}).map(function(Tt){return o[Tt].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&d["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=d)):t.Preamble=d,t.Sheets&&R.forEach(function(Tt,et){t.Sheets[t.SheetNames[et]]["!autofilter"]=Tt}),t.Strings=f,t.SSF=zr(mt),U.enc&&(t.Encryption=U.enc),ue&&(t.Themes=ue),t.Metadata={},z!==void 0&&(t.Metadata.Country=z),M.names.length>0&&(C.Names=M.names),t.Workbook=C,t}var Fg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function H4(e,n,t){var r=Et.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=pg(r,ob,Fg.DSI);for(var o in a)n[o]=a[o]}catch(p){if(t.WTF)throw p}var l=Et.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=pg(l,ib,Fg.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(p){if(t.WTF)throw p}n.HeadingPairs&&n.TitlesOfParts&&(A1(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function hy(e,n){n||(n={}),bp(n),Hv(),n.codepage&&tp(n.codepage);var t,r;if(e.FullPaths){if(Et.find(e,"/encryption"))throw new Error("File is password-protected");t=Et.find(e,"!CompObj"),r=Et.find(e,"/Workbook")||Et.find(e,"/Book")}else{switch(n.type){case"base64":e=ea(Tn(e));break;case"binary":e=ea(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}jr(e,0),r={content:e}}var a,o;if(t&&z4(t),n.bookProps&&!n.bookSheets)a={};else{var l=_t?"buffer":"array";if(r&&r.content)a=U4(r.content,n);else if((o=Et.find(e,"PerfectOffice_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else if((o=Et.find(e,"NativeContent_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else throw(o=Et.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&Et.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=DT(e))}var c={};return e.FullPaths&&H4(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Fu={0:{f:ED},1:{f:DD},2:{f:jD},3:{f:OD},4:{f:FD},5:{f:ID},6:{f:BD},7:{f:RD},8:{f:$D},9:{f:YD},10:{f:UD},11:{f:HD},12:{f:ND},13:{f:LD},14:{f:PD},15:{f:AD},16:{f:cy},17:{f:WD},18:{f:MD},19:{f:dp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:v4},40:{},42:{},43:{f:US},44:{f:WS},45:{f:HS},46:{f:$S},47:{f:YS},48:{},49:{f:V_},50:{},51:{f:dT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:H1},62:{f:zD},63:{f:gT},64:{f:e4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CD},148:{f:SD,p:16},151:{f:GD},152:{},153:{f:x4},154:{},155:{},156:{f:m4},157:{},158:{},159:{T:1,f:iS},160:{T:-1},161:{T:1,f:go},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fT},336:{T:-1},337:{f:pT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ed},357:{},358:{},359:{},360:{T:1},361:{},362:{f:U1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:XD},427:{f:QD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ZD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:TD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ed},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ST},633:{T:1},634:{T:-1},635:{T:1,f:ET},636:{T:-1},637:{f:G_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:o4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:t4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Nd={6:{f:rd},10:{f:gs},12:{f:yr},13:{f:yr},14:{f:pr},15:{f:pr},16:{f:Kr},17:{f:pr},18:{f:pr},19:{f:yr},20:{f:gg},21:{f:gg},23:{f:U1},24:{f:yg},25:{f:pr},26:{},27:{},28:{f:_E},29:{},34:{f:pr},35:{f:vg},38:{f:Kr},39:{f:Kr},40:{f:Kr},41:{f:Kr},42:{f:pr},43:{f:pr},47:{f:TS},49:{f:nE},51:{f:yr},60:{},61:{f:eE},64:{f:pr},65:{f:rE},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:Vb},93:{f:EE},94:{},95:{f:pr},96:{},97:{},99:{f:pr},125:{f:H1},128:{f:pE},129:{f:Kb},130:{f:yr},131:{f:pr},132:{f:pr},133:{f:Gb},134:{},140:{f:FE},141:{f:yr},144:{},146:{f:OE},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:jE},161:{f:RE},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:cE},190:{f:uE},193:{f:gs},197:{},198:{},199:{},200:{},201:{},202:{f:pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:pr},222:{},224:{f:dE},225:{f:$b},226:{f:gs},227:{},229:{f:bE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Xb},253:{f:aE},255:{f:Qb},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:I1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pr},353:{f:gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:mE},431:{f:pr},432:{},433:{},434:{},437:{},438:{f:CE},439:{f:pr},440:{f:DE},441:{},442:{f:Ol},443:{},444:{f:yr},445:{},446:{},448:{f:gs},449:{f:Jb,r:2},450:{f:gs},512:{f:mg},513:{f:IE},515:{f:hE},516:{f:sE},517:{f:xg},519:{f:LE},520:{f:qb},523:{},545:{f:wg},549:{f:hg},566:{},574:{f:tE},638:{f:lE},659:{},1048:{},1054:{f:oE},1084:{},1212:{f:yE},2048:{f:NE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:PE,r:12},2173:{f:cT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:vE,r:12},2197:{},2198:{f:nT,r:12},2199:{},2200:{},2201:{},2202:{f:wE,r:12},2203:{f:gs},2204:{},2205:{},2206:{},2207:{},2211:{f:Zb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ME},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:AE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mg},1:{},2:{f:UE},3:{f:WE},4:{f:BE},5:{f:xg},7:{f:HE},8:{},9:{f:tu},11:{},22:{f:yr},30:{f:iE},31:{},32:{},33:{f:wg},36:{},37:{f:hg},50:{f:YE},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:zE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:$E},223:{},234:{},354:{},421:{},518:{f:rd},521:{f:tu},536:{f:yg},547:{f:vg},561:{},579:{},1030:{f:rd},1033:{f:tu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Jn(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&b1(t)&&e.push(t)}}function Ag(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=h_(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),p=-1,d=0,x=0,g=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<f.length;++l){var w=f[l].trim(),_=w.slice(0,3).toLowerCase();if(_=="<tr"){if(++p,t.sheetRows&&t.sheetRows<=p){--p;break}d=0;continue}if(!(_!="<td"&&_!="<th")){var S=w.split(/<\/t[dh]>/i);for(c=0;c<S.length;++c){var P=S[c].trim();if(P.match(/<t[dh]/i)){for(var T=P,z=0;T.charAt(0)=="<"&&(z=T.indexOf(">"))>-1;)T=T.slice(z+1);for(var Z=0;Z<k.length;++Z){var L=k[Z];L.s.c==d&&L.s.r<p&&p<=L.e.r&&(d=L.e.c+1,Z=-1)}var C=ct(P.slice(0,P.indexOf(">")));g=C.colspan?+C.colspan:1,((x=+C.rowspan)>1||g>1)&&k.push({s:{r:p,c:d},e:{r:p+(x||1)-1,c:d+g-1}});var Q=C.t||C["data-t"]||"";if(!T.length){d+=g;continue}if(T=u1(T),y.s.r>p&&(y.s.r=p),y.e.r<p&&(y.e.r=p),y.s.c>d&&(y.s.c=d),y.e.c<d&&(y.e.c=d),!T.length){d+=g;continue}var j={t:"s",v:T};t.raw||!T.trim().length||Q=="s"||(T==="TRUE"?j={t:"b",v:!0}:T==="FALSE"?j={t:"b",v:!1}:isNaN(na(T))?isNaN(ai(T).getDate())||(j={t:"d",v:Or(T)},t.cellDates||(j={t:"n",v:un(j.v)}),j.z=t.dateNF||mt[14]):j={t:"n",v:na(T)}),t.dense?(r[p]||(r[p]=[]),r[p][d]=j):r[dt({r:p,c:d})]=j,d+=g}}}}return r["!ref"]=St(y),k.length&&(r["!merges"]=k),r}function Y4(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,p=0;p<a.length;++p)if(!(a[p].s.r>t||a[p].s.c>l)&&!(a[p].e.r<t||a[p].e.c<l)){if(a[p].s.r<t||a[p].s.c<l){c=-1;break}c=a[p].e.r-a[p].s.r+1,f=a[p].e.c-a[p].s.c+1;break}if(!(c<0)){var d=dt({r:t,c:l}),x=r.dense?(e[t]||[])[l]:e[d],g=x&&x.v!=null&&(x.h||ip(x.w||(Ka(x),x.w)||""))||"",y={};c>1&&(y.rowspan=c),f>1&&(y.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":x&&(y["data-t"]=x&&x.t||"z",x.v!=null&&(y["data-v"]=x.v),x.z!=null&&(y["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+x.l.Target+'">'+g+"</a>")),y.id=(r.id||"sjs")+"-"+d,o.push(F_("td",g,y))}}var k="<tr>";return k+o.join("")+"</tr>"}var $4='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',V4="</body></html>";function K4(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Os(Ag(t[0],n),n);var r=Sp();return t.forEach(function(a,o){Tp(r,Ag(a,n),"Sheet"+(o+1))}),r}function G4(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function X4(e,n){var t=n||{},r=t.header!=null?t.header:$4,a=t.footer!=null?t.footer:V4,o=[r],l=pi(e["!ref"]);t.dense=Array.isArray(e),o.push(G4(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(Y4(e,l,c,t));return o.push("</table>"+a),o.join("")}function my(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?sn(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),p={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var d=pi(e["!ref"]);p.s.r=Math.min(p.s.r,d.s.r),p.s.c=Math.min(p.s.c,d.s.c),p.e.r=Math.max(p.e.r,d.e.r),p.e.c=Math.max(p.e.c,d.e.c),a==-1&&(p.e.r=a=d.e.r+1)}var x=[],g=0,y=e["!rows"]||(e["!rows"]=[]),k=0,w=0,_=0,S=0,P=0,T=0;for(e["!cols"]||(e["!cols"]=[]);k<c.length&&w<f;++k){var z=c[k];if(Og(z)){if(r.display)continue;y[w]={hidden:!0}}var Z=z.children;for(_=S=0;_<Z.length;++_){var L=Z[_];if(!(r.display&&Og(L))){var C=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):u1(L.innerHTML),Q=L.getAttribute("data-z")||L.getAttribute("z");for(g=0;g<x.length;++g){var j=x[g];j.s.c==S+o&&j.s.r<w+a&&w+a<=j.e.r&&(S=j.e.c+1-o,g=-1)}T=+L.getAttribute("colspan")||1,((P=+L.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:w+a,c:S+o},e:{r:w+a+(P||1)-1,c:S+o+(T||1)-1}});var te={t:"s",v:C},X=L.getAttribute("data-t")||L.getAttribute("t")||"";C!=null&&(C.length==0?te.t=X||"z":r.raw||C.trim().length==0||X=="s"||(C==="TRUE"?te={t:"b",v:!0}:C==="FALSE"?te={t:"b",v:!1}:isNaN(na(C))?isNaN(ai(C).getDate())||(te={t:"d",v:Or(C)},r.cellDates||(te={t:"n",v:un(te.v)}),te.z=r.dateNF||mt[14]):te={t:"n",v:na(C)})),te.z===void 0&&Q!=null&&(te.z=Q);var U="",ue=L.getElementsByTagName("A");if(ue&&ue.length)for(var le=0;le<ue.length&&!(ue[le].hasAttribute("href")&&(U=ue[le].getAttribute("href"),U.charAt(0)!="#"));++le);U&&U.charAt(0)!="#"&&(te.l={Target:U}),r.dense?(e[w+a]||(e[w+a]=[]),e[w+a][S+o]=te):e[dt({c:S+o,r:w+a})]=te,p.e.c<S+o&&(p.e.c=S+o),S+=T}}++w}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),p.e.r=Math.max(p.e.r,w-1+a),e["!ref"]=St(p),w>=f&&(e["!fullref"]=St((p.e.r=c.length-k+w-1+a,p))),e}function xy(e,n){var t=n||{},r=t.dense?[]:{};return my(r,e,n)}function Q4(e,n){return Os(xy(e,n),n)}function Og(e){var n="",t=q4(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function q4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Z4(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=At(n.replace(/<[^>]*>/g,""));return[t]}var Pg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gy(e,n){var t=n||{},r=lp(e),a=[],o,l,c={name:""},f="",p=0,d,x,g={},y=[],k=t.dense?[]:{},w,_,S={value:""},P="",T=0,z=[],Z=-1,L=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},Q=0,j={},te=[],X={},U=0,ue=0,le=[],ae=1,pe=1,V=[],se={Names:[]},M={},H=["",""],O=[],E={},I="",R=0,W=!1,ie=!1,de=0;for(kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=kl.exec(r);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?k["!ref"]=St(C):k["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=C.e.r&&(k["!fullref"]=k["!ref"],C.e.r=t.sheetRows-1,k["!ref"]=St(C)),te.length&&(k["!merges"]=te),le.length&&(k["!rows"]=le),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),y.push(d.name),g[d.name]=k,ie=!1):w[0].charAt(w[0].length-2)!=="/"&&(d=ct(w[0],!1),Z=L=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,k=t.dense?[]:{},te=[],le=[],ie=!0);break;case"table-row-group":w[1]==="/"?--Q:++Q;break;case"table-row":case"":if(w[1]==="/"){Z+=ae,ae=1;break}if(x=ct(w[0],!1),x.?Z=x.-1:Z==-1&&(Z=0),ae=+x["number-rows-repeated"]||1,ae<10)for(de=0;de<ae;++de)Q>0&&(le[Z+de]={level:Q});L=-1;break;case"covered-table-cell":w[1]!=="/"&&++L,t.sheetStubs&&(t.dense?(k[Z]||(k[Z]=[]),k[Z][L]={t:"z"}):k[dt({r:Z,c:L})]={t:"z"}),P="",z=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++L,S=ct(w[0],!1),pe=parseInt(S["number-columns-repeated"]||"1",10),_={t:"z",v:null},S.formula&&t.cellFormula!=!1&&(_.f=Cg(At(S.formula))),(S.||S["value-type"])=="string"&&(_.t="s",_.v=At(S["string-value"]||""),t.dense?(k[Z]||(k[Z]=[]),k[Z][L]=_):k[dt({r:Z,c:L})]=_),L+=pe-1;else if(w[1]!=="/"){++L,P="",T=0,z=[],pe=1;var he=ae?Z+ae-1:Z;if(L>C.e.c&&(C.e.c=L),L<C.s.c&&(C.s.c=L),Z<C.s.r&&(C.s.r=Z),he>C.e.r&&(C.e.r=he),S=ct(w[0],!1),O=[],E={},_={t:S.||S["value-type"],v:null},t.cellFormula)if(S.formula&&(S.formula=At(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(U=parseInt(S["number-matrix-rows-spanned"],10)||0,ue=parseInt(S["number-matrix-columns-spanned"],10)||0,X={s:{r:Z,c:L},e:{r:Z+U-1,c:L+ue-1}},_.F=St(X),V.push([X,_.F])),S.formula)_.f=Cg(S.formula);else for(de=0;de<V.length;++de)Z>=V[de][0].s.r&&Z<=V[de][0].e.r&&L>=V[de][0].s.c&&L<=V[de][0].e.c&&(_.F=V[de][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(U=parseInt(S["number-rows-spanned"],10)||0,ue=parseInt(S["number-columns-spanned"],10)||0,X={s:{r:Z,c:L},e:{r:Z+U-1,c:L+ue-1}},te.push(X)),S["number-columns-repeated"]&&(pe=parseInt(S["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=er(S["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(S.value);break;case"percentage":_.t="n",_.v=parseFloat(S.value);break;case"currency":_.t="n",_.v=parseFloat(S.value);break;case"date":_.t="d",_.v=Or(S["date-value"]),t.cellDates||(_.t="n",_.v=un(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=f_(S["time-value"])/86400,t.cellDates&&(_.t="d",_.v=Gu(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(S.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",S["string-value"]!=null&&(P=At(S["string-value"]),z=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(W=!1,_.t==="s"&&(_.v=P||"",z.length&&(_.R=z),W=T==0),M.Target&&(_.l=M),O.length>0&&(_.c=O,O=[]),P&&t.cellText!==!1&&(_.w=P),W&&(_.t="z",delete _.v),(!W||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=Z))for(var oe=0;oe<ae;++oe){if(pe=parseInt(S["number-columns-repeated"]||"1",10),t.dense)for(k[Z+oe]||(k[Z+oe]=[]),k[Z+oe][L]=oe==0?_:zr(_);--pe>0;)k[Z+oe][L+pe]=zr(_);else for(k[dt({r:Z+oe,c:L})]=_;--pe>0;)k[dt({r:Z+oe,c:L+pe})]=zr(_);C.e.c<=L&&(C.e.c=L)}pe=parseInt(S["number-columns-repeated"]||"1",10),L+=pe-1,pe=0,_={},P="",z=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o;E.t=P,z.length&&(E.R=z),E.a=I,O.push(E)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);I="",R=0,P="",T=0,z=[];break;case"creator":w[1]==="/"?I=r.slice(R,w.index):R=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);P="",T=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(j[c.name]=f,(o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",c=ct(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ct(w[0],!1),f+=Pg[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ct(w[0],!1),f+=Pg[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(p,w.index);break}else p=w.index+w[0].length;break;case"named-range":l=ct(w[0],!1),H=nd(l["cell-range-address"]);var ee={Name:l.name,Ref:H[0]+"!"+H[1]};ie&&(ee.Sheet=y.length),se.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!S||!S["string-value"])){var re=Z4(r.slice(T,w.index));P=(P.length>0?P+`
`:"")+re[0]}else ct(w[0],!1),T=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{H=nd(ct(w[0])["target-range-address"]),g[H[0]]["!autofilter"]={ref:H[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(M=ct(w[0],!1),!M.href)break;M.Target=At(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(H=nd(M.Target.slice(1)),M.Target="#"+H[0]+"!"+H[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(w)}}var F={Sheets:g,SheetNames:y,Workbook:se};return t.bookSheets&&delete F.Sheets,F}function Rg(e,n){n=n||{},Ln(e,"META-INF/manifest.xml")&&hb(vr(e,"META-INF/manifest.xml"),n);var t=En(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=gy(Xt(t),n);return Ln(e,"meta.xml")&&(r.Props=F1(vr(e,"meta.xml"))),r}function Mg(e,n){return gy(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function kp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(mo(e))}function Ad(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function Ig(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function J4(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Sl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Sr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function Gr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Sl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Sl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var p={data:c,type:o};n[a]==null?n[a]=[p]:n[a].push(p)}return n}function _p(e,n){return e?.map(function(t){return n(t.data)})||[]}function eN(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Sl(e,r),o=Gr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Sr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=Gr(c.data),p=Sr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+p)}),r[0]+=p}),(n=o[3])!=null&&n[0]&&(l.merge=Sr(o[3][0].data)>>>0>0),t.push(l)}return t}function tN(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Sl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,p=0;if(o==1?(p=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(p=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Ad(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(p>=f)for(a.push(a[0].slice(-f)),p-=f;p>=a[a.length-1].length;)a.push(a[a.length-1]),p-=a[a.length-1].length;a.push(a[0].slice(-f,-f+p))}}var d=Ad(a);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function rN(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(tN(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Ad(n)}function nN(e,n,t,r){var a=kp(e),o=a.getUint32(4,!0),l=(r>1?12:8)+Ig(o&(r>1?3470:398))*4,c=-1,f=-1,p=NaN,d=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=Ig(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(p=a.getFloat64(l,!0),l+=8),o&64&&(d.setTime(d.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:p};break;case 3:x={t:"s",v:n[f]};break;case 5:x={t:"d",v:d};break;case 6:x={t:"b",v:p>0};break;case 7:x={t:"n",v:p/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:t[c]};else if(f>-1)x={t:"s",v:n[f]};else if(!isNaN(p))x={t:"n",v:p};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function aN(e,n,t){var r=kp(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,p=NaN,d=new Date(2001,0,1);a&1&&(f=J4(e,o),o+=16),a&2&&(p=r.getFloat64(o,!0),o+=8),a&4&&(d.setTime(d.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:n[c]};break;case 5:x={t:"d",v:d};break;case 6:x={t:"b",v:p>0};break;case 7:x={t:"n",v:p/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return x}function sN(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return nN(e,n,t,e[0]);case 5:return aN(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Es(e){var n=Gr(e);return Sl(n[1][0].data)}function jg(e,n){var t=Gr(n.data),r=Sr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=Gr(l.data),f=Sr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Fd(c[3][0].data);break;case 8:{var p=e[Es(c[9][0].data)][0],d=Gr(p.data),x=e[Es(d[1][0].data)][0],g=Sr(x.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var y=Gr(x.data);o[f]=y[3].map(function(k){return Fd(k.data)}).join("")}break}}),o}function oN(e,n){var t,r,a,o,l,c,f,p,d,x,g,y,k,w,_=Gr(e),S=Sr(_[1][0].data)>>>0,P=Sr(_[2][0].data)>>>0,T=((r=(t=_[8])==null?void 0:t[0])==null?void 0:r.data)&&Sr(_[8][0].data)>0||!1,z,Z;if((o=(a=_[7])==null?void 0:a[0])!=null&&o.data&&n!=0)z=(c=(l=_[7])==null?void 0:l[0])==null?void 0:c.data,Z=(p=(f=_[6])==null?void 0:f[0])==null?void 0:p.data;else if((x=(d=_[4])==null?void 0:d[0])!=null&&x.data&&n!=1)z=(y=(g=_[4])==null?void 0:g[0])==null?void 0:y.data,Z=(w=(k=_[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var L=T?4:1,C=kp(z),Q=[],j=0;j<z.length/2;++j){var te=C.getUint16(j*2,!0);te<65535&&Q.push([j,te])}if(Q.length!=P)throw"Expected ".concat(P," cells, found ").concat(Q.length);var X=[];for(j=0;j<Q.length-1;++j)X[Q[j][0]]=Z.subarray(Q[j][1]*L,Q[j+1][1]*L);return Q.length>=1&&(X[Q[Q.length-1][0]]=Z.subarray(Q[Q.length-1][1]*L)),{R:S,cells:X}}function iN(e,n){var t,r=Gr(n.data),a=(t=r?.[7])!=null&&t[0]?Sr(r[7][0].data)>>>0>0?1:0:-1,o=_p(r[5],function(l){return oN(l,a)});return{nrows:Sr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,p){if(l[c.R][p])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(p));l[c.R][p]=f}),l},[])}}function lN(e,n,t){var r,a=Gr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Sr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Sr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=St(o);var l=Gr(a[4][0].data),c=jg(e,e[Es(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?jg(e,e[Es(l[17][0].data)][0]):[],p=Gr(l[3][0].data),d=0;p[1].forEach(function(x){var g=Gr(x.data),y=e[Es(g[2][0].data)][0],k=Sr(y.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=iN(e,y);w.data.forEach(function(_,S){_.forEach(function(P,T){var z=dt({r:d+S,c:T}),Z=sN(P,c,f);Z&&(t[z]=Z)})}),d+=w.nrows})}function cN(e,n){var t=Gr(n.data),r={"!ref":"A1"},a=e[Es(t[2][0].data)],o=Sr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return lN(e,a[0],r),r}function uN(e,n){var t,r=Gr(n.data),a={name:(t=r[1])!=null&&t[0]?Fd(r[1][0].data):"",sheets:[]},o=_p(r[2],Es);return o.forEach(function(l){e[l].forEach(function(c){var f=Sr(c.meta[1][0].data);f==6e3&&a.sheets.push(cN(e,c))})}),a}function fN(e,n){var t=Sp(),r=Gr(n.data),a=_p(r[1],Es);if(a.forEach(function(o){e[o].forEach(function(l){var c=Sr(l.meta[1][0].data);if(c==2){var f=uN(e,l);f.sheets.forEach(function(p,d){Tp(t,p,d==0?f.name:f.name+"_"+d,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function sd(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var p;try{p=rN(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var d;try{d=eN(p)}catch(x){return console.log("## "+(x.message||x))}d.forEach(function(x){o[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Sr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(p){var d=Sr(p.meta[1][0].data)>>>0;if(d==1)if(!c)c=p;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return fN(o,c)}function dN(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function bp(e){dN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function pN(e){return Qo.WS.indexOf(e)>-1?"sheet":e==Qo.CS?"chart":e==Qo.DS?"dialog":e==Qo.MS?"macro":e&&e.length?e:"sheet"}function hN(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,pN(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function mN(e,n,t,r,a,o,l,c,f,p,d,x){try{o[r]=fl(En(e,t,!0),n);var g=vr(e,n),y;switch(c){case"sheet":y=k4(g,n,a,f,o[r],p,d,x);break;case"chart":if(y=_4(g,n,a,f,o[r],p,d,x),!y||!y["!drawel"])break;var k=al(y["!drawel"].Target,n),w=Sd(k),_=wT(En(e,k,!0),fl(En(e,w,!0),k)),S=al(_,k),P=Sd(S);y=a4(En(e,S,!0),S,f,fl(En(e,P,!0),S),p,y);break;case"macro":y=b4(g,n,a,f,o[r],p,d,x);break;case"dialog":y=E4(g,n,a,f,o[r],p,d,x);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=y;var T=[];o&&o[r]&&Ea(o[r]).forEach(function(z){var Z="";if(o[r][z].Type==Qo.CMNT){Z=al(o[r][z].Target,n);var L=D4(vr(e,Z,!0),Z,f);if(!L||!L.length)return;_g(y,L,!1)}o[r][z].Type==Qo.TCMNT&&(Z=al(o[r][z].Target,n),T=T.concat(_T(vr(e,Z,!0),f)))}),T&&T.length&&_g(y,T,!0,f.people||[])}catch(z){if(f.WTF)throw z}}function Mn(e){return e.charAt(0)=="/"?e.slice(1):e}function xN(e,n){if(t1(),n=n||{},bp(n),Ln(e,"META-INF/manifest.xml")||Ln(e,"objectdata.xml"))return Rg(e,n);if(Ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof sd<"u"){if(e.FileIndex)return sd(e);var t=Et.utils.cfb_new();return Xx(e).forEach(function(le){g_(t,le,x_(e,le))}),sd(t)}throw new Error("Unsupported NUMBERS file")}if(!Ln(e,"[Content_Types].xml"))throw Ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Xx(e),a=db(En(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",vr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!vr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},p={};if(!n.bookSheets&&!n.bookProps){if(hl=[],a.sst)try{hl=C4(vr(e,Mn(a.sst)),a.sst,n)}catch(le){if(n.WTF)throw le}n.cellStyles&&a.themes.length&&(f=T4(En(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(p=S4(vr(e,Mn(a.style)),a.style,f,n))}a.links.map(function(le){try{var ae=fl(En(e,Sd(Mn(le))),le);return F4(vr(e,Mn(le)),ae,le,n)}catch{}});var d=w4(vr(e,Mn(a.workbooks[0])),a.workbooks[0],n),x={},g="";a.coreprops.length&&(g=vr(e,Mn(a.coreprops[0]),!0),g&&(x=F1(g)),a.extprops.length!==0&&(g=vr(e,Mn(a.extprops[0]),!0),g&&gb(g,x,n)));var y={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=En(e,Mn(a.custprops[0]),!0),g&&(y=yb(g,n)));var k={};if((n.bookSheets||n.bookProps)&&(d.Sheets?l=d.Sheets.map(function(ae){return ae.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),n.bookProps&&(k.Props=x,k.Custprops=y),n.bookSheets&&typeof l<"u"&&(k.SheetNames=l),n.bookSheets?k.SheetNames:n.bookProps))return k;l={};var w={};n.bookDeps&&a.calcchain&&(w=N4(vr(e,Mn(a.calcchain)),a.calcchain));var _=0,S={},P,T;{var z=d.Sheets;x.Worksheets=z.length,x.SheetNames=[];for(var Z=0;Z!=z.length;++Z)x.SheetNames[Z]=z[Z].name}var L=o?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),Q=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Ln(e,Q)||(Q="xl/_rels/workbook."+L+".rels");var j=fl(En(e,Q,!0),Q.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=A4(vr(e,Mn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=bT(vr(e,Mn(a.people[0])),n)),j&&(j=hN(j,d.Sheets));var te=vr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=x.Worksheets;++_){var X="sheet";if(j&&j[_]?(P="xl/"+j[_][1].replace(/[\/]?xl\//,""),Ln(e,P)||(P=j[_][1]),Ln(e,P)||(P=Q.replace(/_rels\/.*$/,"")+j[_][1]),X=j[_][2]):(P="xl/worksheets/sheet"+(_+1-te)+"."+L,P=P.replace(/sheet0\./,"sheet.")),T=P.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(_!=n.sheets)continue e;break;case"string":if(x.SheetNames[_].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var U=!1,ue=0;ue!=n.sheets.length;++ue)typeof n.sheets[ue]=="number"&&n.sheets[ue]==_&&(U=1),typeof n.sheets[ue]=="string"&&n.sheets[ue].toLowerCase()==x.SheetNames[_].toLowerCase()&&(U=1);if(!U)continue e}}mN(e,P,T,x.SheetNames[_],_,S,l,X,n,d,f,p)}return k={Directory:a,Workbook:d,Props:x,Custprops:y,Deps:w,Sheets:l,SheetNames:x.SheetNames,Strings:hl,Styles:p,Themes:f,SSF:zr(mt)},n&&n.bookFiles&&(e.files?(k.keys=r,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(le,ae){le=le.replace(/^Root Entry[\/]/,""),k.keys.push(le),k.files[le]=e.FileIndex[ae]}))),n&&n.bookVBA&&(a.vba.length>0?k.vbaraw=vr(e,Mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===CT&&(k.vbaraw=vr(e,"xl/vbaProject.bin",!0))),k}function gN(e,n){var t=n||{},r="Workbook",a=Et.find(e,r);try{if(r="/!DataSpaces/Version",a=Et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(cS(a.content),r="/!DataSpaces/DataSpaceMap",a=Et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=fS(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=dS(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);hS(a.content)}catch{}if(r="/EncryptionInfo",a=Et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=mS(a.content);if(r="/EncryptedPackage",a=Et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Ep(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Tn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function vN(e,n){return Et.find(e,"EncryptedPackage")?gN(e,n):hy(e,n)}function yN(e,n){var t,r=e,a=n||{};return a.type||(a.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),t=i1(r,a),xN(t,a)}function vy(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Dd(e.slice(t),n);default:break e}return _l.to_workbook(e,n)}function wN(e,n){var t="",r=Ep(e,n);switch(n.type){case"base64":t=Tn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=io(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Xt(t)),n.type="binary",vy(t,n)}function kN(e,n){var t=e;return n.type=="base64"&&(t=Tn(t)),t=vl.utils.decode(1200,t.slice(2),"str"),n.type="binary",vy(t,n)}function _N(e){return e.match(/[^\x00-\x7F]/)?sl(e):e}function od(e,n,t,r){return r?(t.type="string",_l.to_workbook(e,t)):_l.to_workbook(n,t)}function Od(e,n){Hv();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Od(new Uint8Array(e),(t=zr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Jo={},t.dateNF&&(Jo.dateNF=t.dateNF),t.type||(t.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=_t?"buffer":"binary",r=c_(e),typeof Uint8Array<"u"&&!_t&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=_N(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=zr(t),t.type="array",Od(rp(r),t)}switch((a=Ep(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return vN(Et.read(r,t),t);break;case 9:if(a[1]<=8)return hy(r,t);break;case 60:return Dd(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return QE(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return GE.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?yN(r,t):od(e,r,t,o);case 239:return a[3]===60?Dd(r,t):od(e,r,t,o);case 255:if(a[1]===254)return kN(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return pl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return pl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return kg.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return CS.to_workbook(r,t);break;case 10:case 13:case 32:return wN(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VE.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?kg.to_workbook(r,t):od(e,r,t,o)}function bN(e,n,t,r,a,o,l,c){var f=Br(t),p=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var y=n.s.c;y<=n.e.c;++y){var k=l?e[t][y]:e[r[y]+f];if(k===void 0||k.t===void 0){if(p===void 0)continue;o[y]!=null&&(g[o[y]]=p);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(o[y]!=null){if(w==null)if(k.t=="e"&&w===null)g[o[y]]=null;else if(p!==void 0)g[o[y]]=p;else if(d&&w===null)g[o[y]]=null;else continue;else g[o[y]]=d&&(k.t!=="n"||k.t==="n"&&c.rawNumbers!==!1)?w:Ka(k,w,c);w!=null&&(x=!1)}}return{row:g,isempty:x}}function Pd(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},p=n||{},d=p.range!=null?p.range:e["!ref"];switch(p.header===1?r=1:p.header==="A"?r=2:Array.isArray(p.header)?r=3:p.header==null&&(r=0),typeof d){case"string":f=lr(d);break;case"number":f=lr(e["!ref"]),f.s.r=d;break;default:f=d}r>0&&(a=0);var x=Br(f.s.r),g=[],y=[],k=0,w=0,_=Array.isArray(e),S=f.s.r,P=0,T={};_&&!e[S]&&(e[S]=[]);var z=p.skipHidden&&e["!cols"]||[],Z=p.skipHidden&&e["!rows"]||[];for(P=f.s.c;P<=f.e.c;++P)if(!(z[P]||{}).hidden)switch(g[P]=Er(P),t=_?e[S][P]:e[g[P]+x],r){case 1:o[P]=P-f.s.c;break;case 2:o[P]=g[P];break;case 3:o[P]=p.header[P-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ka(t,null,p),w=T[l]||0,!w)T[l]=1;else{do c=l+"_"+w++;while(T[c]);T[l]=w,T[c]=1}o[P]=c}for(S=f.s.r+a;S<=f.e.r;++S)if(!(Z[S]||{}).hidden){var L=bN(e,f,S,g,r,o,_,p);(L.isempty===!1||(r===1?p.blankrows!==!1:p.blankrows))&&(y[k++]=L.row)}return y.length=k,y}var Lg=/"/g;function EN(e,n,t,r,a,o,l,c){for(var f=!0,p=[],d="",x=Br(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var y=c.dense?(e[t]||[])[g]:e[r[g]+x];if(y==null)d="";else if(y.v!=null){f=!1,d=""+(c.rawNumbers&&y.t=="n"?y.v:Ka(y,null,c));for(var k=0,w=0;k!==d.length;++k)if((w=d.charCodeAt(k))===a||w===o||w===34||c.forceQuotes){d='"'+d.replace(Lg,'""')+'"';break}d=="ID"&&(d='"ID"')}else y.f!=null&&!y.F?(f=!1,d="="+y.f,d.indexOf(",")>=0&&(d='"'+d.replace(Lg,'""')+'"')):d="";p.push(d)}return c.blankrows===!1&&f?null:p.join(l)}function yy(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=lr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),p=new RegExp((o=="|"?"\\|":o)+"+$"),d="",x=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],y=r.skipHidden&&e["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(g[k]||{}).hidden||(x[k]=Er(k));for(var w=0,_=a.s.r;_<=a.e.r;++_)(y[_]||{}).hidden||(d=EN(e,a,_,x,l,f,o,r),d!=null&&(r.strip&&(d=d.replace(p,"")),(d||r.blankrows!==!1)&&t.push((w++?c:"")+d)));return delete r.dense,t.join("")}function SN(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=yy(e,n);return t}function TN(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=lr(e["!ref"]),o="",l=[],c,f=[],p=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Er(c);for(var d=a.s.r;d<=a.e.r;++d)for(o=Br(d),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=p?(e[d]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function wy(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?sn(r.origin):r.origin;l=f.r,c=f.c}var p,d={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var x=lr(o["!ref"]);d.e.c=Math.max(d.e.c,x.e.c),d.e.r=Math.max(d.e.r,x.e.r),l==-1&&(l=x.e.r+1,d.e.r=l+n.length-1+a)}else l==-1&&(l=0,d.e.r=n.length-1+a);var g=r.header||[],y=0;n.forEach(function(w,_){Ea(w).forEach(function(S){(y=g.indexOf(S))==-1&&(g[y=g.length]=S);var P=w[S],T="z",z="",Z=dt({c:c+y,r:l+_+a});p=Tl(o,Z),P&&typeof P=="object"&&!(P instanceof Date)?o[Z]=P:(typeof P=="number"?T="n":typeof P=="boolean"?T="b":typeof P=="string"?T="s":P instanceof Date?(T="d",r.cellDates||(T="n",P=un(P)),z=r.dateNF||mt[14]):P===null&&r.nullError&&(T="e",P=0),p?(p.t=T,p.v=P,delete p.w,delete p.R,z&&(p.z=z)):o[Z]=p={t:T,v:P},z&&(p.z=z))})}),d.e.c=Math.max(d.e.c,c+g.length-1);var k=Br(l);if(a)for(y=0;y<g.length;++y)o[Er(y+c)+k]={t:"s",v:g[y]};return o["!ref"]=St(d),o}function CN(e,n){return wy(null,e,n)}function Tl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=sn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Tl(e,dt(n)):Tl(e,dt({r:n,c:t||0}))}function DN(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Sp(){return{SheetNames:[],Sheets:{}}}function Tp(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(d4(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function NN(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=DN(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function FN(e,n){return e.z=n,e}function ky(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function AN(e,n,t){return ky(e,"#"+n,t)}function ON(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function PN(e,n,t,r){for(var a=typeof n!="string"?n:lr(n),o=typeof n=="string"?n:St(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Tl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var RN={encode_col:Er,encode_row:Br,encode_cell:dt,encode_range:St,decode_col:fp,decode_row:up,split_cell:$_,decode_cell:sn,decode_range:pi,format_cell:Ka,sheet_add_aoa:S1,sheet_add_json:wy,sheet_add_dom:my,aoa_to_sheet:hi,json_to_sheet:CN,table_to_sheet:xy,table_to_book:Q4,sheet_to_csv:yy,sheet_to_txt:SN,sheet_to_json:Pd,sheet_to_html:X4,sheet_to_formulae:TN,sheet_to_row_object_array:Pd,sheet_get_cell:Tl,book_new:Sp,book_append_sheet:Tp,book_set_sheet_visibility:NN,cell_set_number_format:FN,cell_set_hyperlink:ky,cell_set_internal_link:AN,cell_add_comment:ON,sheet_set_array_formula:PN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const MN=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=A.useState(null),o=A.useRef(null),l=p=>{const d=p.target.files?.[0];d&&a(d)},c=()=>{if(r){const p=new FileReader;p.onload=d=>{try{const x=new Uint8Array(d.target?.result),g=Od(x,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const y=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",y);const k=RN.sheet_to_json(y,{header:1});console.log("Parsed JSON data:",k);const w={headers:k[0],rows:k.slice(1)};console.log("Prepared file data:",w),t(r.name,w),f()}catch(x){console.error("Error reading Excel file:",x)}},p.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return h.jsx(Pr,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Zaaduj plik Excel"}),h.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-2 overflow-hidden",children:h.jsx("div",{children:h.jsxs("div",{className:"relative mt-8",children:[h.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),h.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[h.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&h.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[h.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),h.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Zaaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Zaaduj"})]})]})})},IN=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:h.jsxs("div",{className:"h-full flex items-center justify-between",children:[h.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastpi "',r,'"?']}),h.jsxs("div",{className:"flex space-x-2 shrink-0",children:[h.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),h.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastp"})]})]})});function _y(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=_y(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Lr(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=_y(e))&&(r&&(r+=" "),r+=n);return r}const by=6048e5,jN=864e5,Zu=6e4,Ju=36e5,LN=1e3,zg=Symbol.for("constructDateFrom");function Ht(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&zg in e?e[zg](n):e instanceof Date?new e.constructor(n):new Date(n)}function Je(e,n){return Ht(n||e,e)}function aa(e,n,t){const r=Je(e,t?.in);return isNaN(n)?Ht(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function sa(e,n,t){const r=Je(e,t?.in);if(isNaN(n))return Ht(e,NaN);if(!n)return r;const a=r.getDate(),o=Ht(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function Ey(e,n,t){return Ht(e,+Je(e)+n)}function zN(e,n,t){return Ey(e,n*Ju)}let BN={};function wo(){return BN}function oa(e,n){const t=wo(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Je(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function oi(e,n){return oa(e,{...n,weekStartsOn:1})}function Sy(e,n){const t=Je(e,n?.in),r=t.getFullYear(),a=Ht(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=oi(a),l=Ht(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=oi(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Au(e){const n=Je(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function Da(e,...n){const t=Ht.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function co(e,n){const t=Je(e,n?.in);return t.setHours(0,0,0,0),t}function ii(e,n,t){const[r,a]=Da(t?.in,e,n),o=co(r),l=co(a),c=+o-Au(o),f=+l-Au(l);return Math.round((c-f)/jN)}function WN(e,n){const t=Sy(e,n),r=Ht(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),oi(r)}function Rd(e,n,t){const r=Je(e,t?.in);return r.setTime(r.getTime()+n*Zu),r}function Cp(e,n,t){return sa(e,n*3,t)}function UN(e,n,t){return Ey(e,n*1e3)}function Ou(e,n,t){return aa(e,n*7,t)}function Ua(e,n,t){return sa(e,n*12,t)}function Bg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Ht.bind(null,a));const o=Je(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Ht(r,t||NaN)}function Wg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Ht.bind(null,a));const o=Je(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Ht(r,t||NaN)}function HN(e,n,t){const[r,a]=Da(t?.in,e,n);return+co(r)==+co(a)}function Ha(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Pu(e){return!(!Ha(e)&&typeof e!="number"||isNaN(+Je(e)))}function Ru(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function ro(e,n){const t=Je(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function Mu(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=ro(r)-ro(a);return o*4+l}function Iu(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function YN(e,n,t){const[r,a]=Da(t?.in,e,n),o=Ug(r,a),l=Math.abs(ii(r,a));r.setDate(r.getDate()-o*l);const c=+(Ug(r,a)===-o),f=o*(l-c);return f===0?0:f}function Ug(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function Ty(e,n){const t=Je(e,n?.in);return t.setHours(23,59,59,999),t}function Cy(e,n){const t=Je(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Md(e,n){const t=Je(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function Dy(e,n){const t=Je(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Ny(e,n){const t=Je(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function ef(e,n){const t=Je(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function $N(e,n){const t=wo(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Je(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const VN={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},KN=(e,n,t)=>{let r;const a=VN[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function ei(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const GN={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},XN={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},QN={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qN={date:ei({formats:GN,defaultWidth:"full"}),time:ei({formats:XN,defaultWidth:"full"}),dateTime:ei({formats:QN,defaultWidth:"full"})},ZN={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},JN=(e,n,t,r)=>ZN[e];function va(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const e3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},t3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},n3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},a3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},s3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},o3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},i3={ordinalNumber:o3,era:va({values:e3,defaultWidth:"wide"}),quarter:va({values:t3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:va({values:r3,defaultWidth:"wide"}),day:va({values:n3,defaultWidth:"wide"}),dayPeriod:va({values:a3,defaultWidth:"wide",formattingValues:s3,defaultFormattingWidth:"wide"})};function ya(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?c3(c,x=>x.test(l)):l3(c,x=>x.test(l));let p;p=e.valueCallback?e.valueCallback(f):f,p=t.valueCallback?t.valueCallback(p):p;const d=n.slice(l.length);return{value:p,rest:d}}}function l3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function c3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function Fy(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const u3=/^(\d+)(th|st|nd|rd)?/i,f3=/\d+/i,d3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},p3={any:[/^b/i,/^(a|c)/i]},h3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},m3={any:[/1/i,/2/i,/3/i,/4/i]},x3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},g3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},v3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},y3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},w3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},k3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},_3={ordinalNumber:Fy({matchPattern:u3,parsePattern:f3,valueCallback:e=>parseInt(e,10)}),era:ya({matchPatterns:d3,defaultMatchWidth:"wide",parsePatterns:p3,defaultParseWidth:"any"}),quarter:ya({matchPatterns:h3,defaultMatchWidth:"wide",parsePatterns:m3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ya({matchPatterns:x3,defaultMatchWidth:"wide",parsePatterns:g3,defaultParseWidth:"any"}),day:ya({matchPatterns:v3,defaultMatchWidth:"wide",parsePatterns:y3,defaultParseWidth:"any"}),dayPeriod:ya({matchPatterns:w3,defaultMatchWidth:"any",parsePatterns:k3,defaultParseWidth:"any"})},Ay={code:"en-US",formatDistance:KN,formatLong:qN,formatRelative:JN,localize:i3,match:_3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function b3(e,n){const t=Je(e,n?.in);return ii(t,ef(t))+1}function Dp(e,n){const t=Je(e,n?.in),r=+oi(t)-+WN(t);return Math.round(r/by)+1}function Np(e,n){const t=Je(e,n?.in),r=t.getFullYear(),a=wo(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Ht(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=oa(l,n),f=Ht(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const p=oa(f,n);return+t>=+c?r+1:+t>=+p?r:r-1}function E3(e,n){const t=wo(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Np(e,n),o=Ht(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),oa(o,n)}function Oy(e,n){const t=Je(e,n?.in),r=+oa(t,n)-+E3(t,n);return Math.round(r/by)+1}function Ut(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const vs={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Ut(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Ut(t+1,2)},d(e,n){return Ut(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Ut(e.getHours()%12||12,n.length)},H(e,n){return Ut(e.getHours(),n.length)},m(e,n){return Ut(e.getMinutes(),n.length)},s(e,n){return Ut(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Ut(a,n.length)}},Vo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Hg={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return vs.y(e,n)},Y:function(e,n,t,r){const a=Np(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Ut(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Ut(o,n.length)},R:function(e,n){const t=Sy(e);return Ut(t,n.length)},u:function(e,n){const t=e.getFullYear();return Ut(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Ut(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Ut(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return vs.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Ut(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=Oy(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Ut(a,n.length)},I:function(e,n,t){const r=Dp(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Ut(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):vs.d(e,n)},D:function(e,n,t){const r=b3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Ut(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Ut(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Ut(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Ut(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Vo.noon:r===0?a=Vo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Vo.evening:r>=12?a=Vo.afternoon:r>=4?a=Vo.morning:a=Vo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return vs.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):vs.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Ut(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Ut(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):vs.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):vs.s(e,n)},S:function(e,n){return vs.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return $g(r);case"XXXX":case"XX":return Gs(r);case"XXXXX":case"XXX":default:return Gs(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return $g(r);case"xxxx":case"xx":return Gs(r);case"xxxxx":case"xxx":default:return Gs(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Yg(r,":");case"OOOO":default:return"GMT"+Gs(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Yg(r,":");case"zzzz":default:return"GMT"+Gs(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Ut(r,n.length)},T:function(e,n,t){return Ut(+e,n.length)}};function Yg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Ut(o,2)}function $g(e,n){return e%60===0?(e>0?"-":"+")+Ut(Math.abs(e)/60,2):Gs(e,n)}function Gs(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Ut(Math.trunc(r/60),2),o=Ut(r%60,2);return t+a+n+o}const Vg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},Py=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},S3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Vg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Vg(r,n)).replace("{{time}}",Py(a,n))},Id={p:Py,P:S3},T3=/^D+$/,C3=/^Y+$/,D3=["D","DD","YY","YYYY"];function N3(e){return T3.test(e)}function F3(e){return C3.test(e)}function A3(e,n,t){const r=O3(e,n,t);if(console.warn(r),D3.includes(e))throw new RangeError(r)}function O3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const P3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,R3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,M3=/^'([^]*?)'?$/,I3=/''/g,j3=/[a-zA-Z]/;function Kg(e,n,t){const r=wo(),a=t?.locale??r.locale??Ay,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=Je(e,t?.in);if(!Pu(c))throw new RangeError("Invalid time value");let f=n.match(R3).map(d=>{const x=d[0];if(x==="p"||x==="P"){const g=Id[x];return g(d,a.formatLong)}return d}).join("").match(P3).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const x=d[0];if(x==="'")return{isToken:!1,value:L3(d)};if(Hg[x])return{isToken:!0,value:d};if(x.match(j3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:d}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const p={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(d=>{if(!d.isToken)return d.value;const x=d.value;(!t?.useAdditionalWeekYearTokens&&F3(x)||!t?.useAdditionalDayOfYearTokens&&N3(x))&&A3(x,n,String(e));const g=Hg[x[0]];return g(c,x,a.localize,p)}).join("")}function L3(e){const n=e.match(M3);return n?n[1].replace(I3,"'"):e}function Gg(e,n){return Je(e,n?.in).getDate()}function z3(e,n){return Je(e,n?.in).getDay()}function B3(e,n){const t=Je(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Ht(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function W3(){return Object.assign({},wo())}function Ya(e,n){return Je(e,n?.in).getHours()}function U3(e,n){const t=Je(e,n?.in).getDay();return t===0?7:t}function $a(e,n){return Je(e,n?.in).getMinutes()}function on(e,n){return Je(e,n?.in).getMonth()}function Ss(e){return Je(e).getSeconds()}function jd(e){return+Je(e)}function yt(e,n){return Je(e,n?.in).getFullYear()}function Ns(e,n){return+Je(e)>+Je(n)}function uo(e,n){return+Je(e)<+Je(n)}function H3(e,n){return+Je(e)==+Je(n)}function Y3(e,n){const t=$3(n)?new n(0):Ht(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function $3(e){return typeof e=="function"&&e.prototype?.constructor===e}const V3=10;class Ry{subPriority=0;validate(n,t){return!0}}class K3 extends Ry{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class G3 extends Ry{priority=V3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Ht(t,r))}set(n,t){return t.timestampIsSet?n:Ht(n,Y3(n,this.context))}}class It{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new K3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class X3 extends It{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const hr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},wa={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function mr(e,n){return e&&{value:n(e.value),rest:e.rest}}function sr(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function ka(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*Ju+o*Zu+l*LN),rest:n.slice(t[0].length)}}function My(e){return sr(hr.anyDigitsSigned,e)}function cr(e,n){switch(e){case 1:return sr(hr.singleDigit,n);case 2:return sr(hr.twoDigits,n);case 3:return sr(hr.threeDigits,n);case 4:return sr(hr.fourDigits,n);default:return sr(new RegExp("^\\d{1,"+e+"}"),n)}}function ju(e,n){switch(e){case 1:return sr(hr.singleDigitSigned,n);case 2:return sr(hr.twoDigitsSigned,n);case 3:return sr(hr.threeDigitsSigned,n);case 4:return sr(hr.fourDigitsSigned,n);default:return sr(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Fp(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Iy(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function jy(e){return e%400===0||e%4===0&&e%100!==0}class Q3 extends It{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return mr(cr(4,n),a);case"yo":return mr(r.ordinalNumber(n,{unit:"year"}),a);default:return mr(cr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=Iy(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class q3 extends It{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return mr(cr(4,n),a);case"Yo":return mr(r.ordinalNumber(n,{unit:"year"}),a);default:return mr(cr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=Np(n,a);if(r.isTwoDigitYear){const c=Iy(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class Z3 extends It{priority=130;parse(n,t){return ju(t==="R"?4:t.length,n)}set(n,t,r){const a=Ht(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),oi(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class J3 extends It{priority=130;parse(n,t){return ju(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class eF extends It{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return cr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class tF extends It{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return cr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class rF extends It{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return mr(sr(hr.month,n),a);case"MM":return mr(cr(2,n),a);case"Mo":return mr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class nF extends It{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return mr(sr(hr.month,n),a);case"LL":return mr(cr(2,n),a);case"Lo":return mr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function aF(e,n,t){const r=Je(e,t?.in),a=Oy(r,t)-n;return r.setDate(r.getDate()-a*7),Je(r,t?.in)}class sF extends It{priority=100;parse(n,t,r){switch(t){case"w":return sr(hr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return oa(aF(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function oF(e,n,t){const r=Je(e,t?.in),a=Dp(r,t)-n;return r.setDate(r.getDate()-a*7),r}class iF extends It{priority=100;parse(n,t,r){switch(t){case"I":return sr(hr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return oi(oF(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const lF=[31,28,31,30,31,30,31,31,30,31,30,31],cF=[31,29,31,30,31,30,31,31,30,31,30,31];class uF extends It{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return sr(hr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return cr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=jy(r),o=n.getMonth();return a?t>=1&&t<=cF[o]:t>=1&&t<=lF[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class fF extends It{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return sr(hr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return cr(t.length,n)}}validate(n,t){const r=n.getFullYear();return jy(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Ap(e,n,t){const r=wo(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=Je(e,t?.in),l=o.getDay(),f=(n%7+7)%7,p=7-a,d=n<0||n>6?n-(l+p)%7:(f+p)%7-(l+p)%7;return aa(o,d,t)}class dF extends It{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Ap(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class pF extends It{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return mr(cr(t.length,n),o);case"eo":return mr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Ap(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class hF extends It{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return mr(cr(t.length,n),o);case"co":return mr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Ap(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function mF(e,n,t){const r=Je(e,t?.in),a=U3(r,t),o=n-a;return aa(r,o,t)}class xF extends It{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return cr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return mr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return mr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return mr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return mr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=mF(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class gF extends It{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Fp(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class vF extends It{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Fp(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class yF extends It{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Fp(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class wF extends It{priority=70;parse(n,t,r){switch(t){case"h":return sr(hr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class kF extends It{priority=70;parse(n,t,r){switch(t){case"H":return sr(hr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class _F extends It{priority=70;parse(n,t,r){switch(t){case"K":return sr(hr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class bF extends It{priority=70;parse(n,t,r){switch(t){case"k":return sr(hr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return cr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class EF extends It{priority=60;parse(n,t,r){switch(t){case"m":return sr(hr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class SF extends It{priority=50;parse(n,t,r){switch(t){case"s":return sr(hr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return cr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class TF extends It{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return mr(cr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class CF extends It{priority=10;parse(n,t){switch(t){case"X":return ka(wa.basicOptionalMinutes,n);case"XX":return ka(wa.basic,n);case"XXXX":return ka(wa.basicOptionalSeconds,n);case"XXXXX":return ka(wa.extendedOptionalSeconds,n);case"XXX":default:return ka(wa.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Ht(n,n.getTime()-Au(n)-r)}incompatibleTokens=["t","T","x"]}class DF extends It{priority=10;parse(n,t){switch(t){case"x":return ka(wa.basicOptionalMinutes,n);case"xx":return ka(wa.basic,n);case"xxxx":return ka(wa.basicOptionalSeconds,n);case"xxxxx":return ka(wa.extendedOptionalSeconds,n);case"xxx":default:return ka(wa.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Ht(n,n.getTime()-Au(n)-r)}incompatibleTokens=["t","T","X"]}class NF extends It{priority=40;parse(n){return My(n)}set(n,t,r){return[Ht(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class FF extends It{priority=20;parse(n){return My(n)}set(n,t,r){return[Ht(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const AF={G:new X3,y:new Q3,Y:new q3,R:new Z3,u:new J3,Q:new eF,q:new tF,M:new rF,L:new nF,w:new sF,I:new iF,d:new uF,D:new fF,E:new dF,e:new pF,c:new hF,i:new xF,a:new gF,b:new vF,B:new yF,h:new wF,H:new kF,K:new _F,k:new bF,m:new EF,s:new SF,S:new TF,X:new CF,x:new DF,t:new NF,T:new FF},OF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,PF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,RF=/^'([^]*?)'?$/,MF=/''/g,IF=/\S/,jF=/[a-zA-Z]/;function LF(e,n,t,r){const a=()=>Ht(r?.in||t,NaN),o=W3(),l=r?.locale??o.locale??Ay,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():Je(t,r?.in);const p={firstWeekContainsDate:c,weekStartsOn:f,locale:l},d=[new G3(r?.in,t)],x=n.match(PF).map(_=>{const S=_[0];if(S in Id){const P=Id[S];return P(_,l.formatLong)}return _}).join("").match(OF),g=[];for(let _ of x){const S=_[0],P=AF[S];if(P){const{incompatibleTokens:T}=P;if(Array.isArray(T)){const Z=g.find(L=>T.includes(L.token)||L.token===S);if(Z)throw new RangeError(`The format string mustn't contain \`${Z.fullToken}\` and \`${_}\` at the same time`)}else if(P.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${_}\` and any other token at the same time`);g.push({token:S,fullToken:_});const z=P.run(e,_,l.match,p);if(!z)return a();d.push(z.setter),e=z.rest}else{if(S.match(jF))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");if(_==="''"?_="'":S==="'"&&(_=zF(_)),e.indexOf(_)===0)e=e.slice(_.length);else return a()}}if(e.length>0&&IF.test(e))return a();const y=d.map(_=>_.priority).sort((_,S)=>S-_).filter((_,S,P)=>P.indexOf(_)===S).map(_=>d.filter(S=>S.priority===_).sort((S,P)=>P.subPriority-S.subPriority)).map(_=>_[0]);let k=Je(t,r?.in);if(isNaN(+k))return a();const w={};for(const _ of y){if(!_.validate(k,p))return a();const S=_.set(k,w,p);Array.isArray(S)?(k=S[0],Object.assign(w,S[1])):k=S}return k}function zF(e){return e.match(RF)[1].replace(MF,"'")}function BF(e,n,t){const[r,a]=Da(t?.in,e,n);return+oa(r,t)==+oa(a,t)}function WF(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function UF(e,n,t){const[r,a]=Da(t?.in,e,n);return+Md(r)==+Md(a)}function HF(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Cl(e,n,t){const r=+Je(e,t?.in),[a,o]=[+Je(n.start,t?.in),+Je(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function YF(e,n,t){return aa(e,-1,t)}function $F(e,n){const t=()=>Ht(n?.in,NaN),a=XF(e);let o;if(a.date){const p=QF(a.date,2);o=qF(p.restDateString,p.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=ZF(a.time),isNaN(c)))return t();if(a.timezone){if(f=JF(a.timezone),isNaN(f))return t()}else{const p=new Date(l+c),d=Je(0,n?.in);return d.setFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()),d.setHours(p.getUTCHours(),p.getUTCMinutes(),p.getUTCSeconds(),p.getUTCMilliseconds()),d}return Je(l+c+f,n?.in)}const su={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},VF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,KF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,GF=/^([+-])(\d{2})(?::?(\d{2}))?$/;function XF(e){const n={},t=e.split(su.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],su.timeZoneDelimiter.test(n.date)&&(n.date=e.split(su.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=su.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function QF(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function qF(e,n){if(n===null)return new Date(NaN);const t=e.match(VF);if(!t)return new Date(NaN);const r=!!t[4],a=el(t[1]),o=el(t[2])-1,l=el(t[3]),c=el(t[4]),f=el(t[5])-1;if(r)return aA(n,c,f)?eA(n,c,f):new Date(NaN);{const p=new Date(0);return!rA(n,o,l)||!nA(n,a)?new Date(NaN):(p.setUTCFullYear(n,o,Math.max(a,l)),p)}}function el(e){return e?parseInt(e):1}function ZF(e){const n=e.match(KF);if(!n)return NaN;const t=id(n[1]),r=id(n[2]),a=id(n[3]);return sA(t,r,a)?t*Ju+r*Zu+a*1e3:NaN}function id(e){return e&&parseFloat(e.replace(",","."))||0}function JF(e){if(e==="Z")return 0;const n=e.match(GF);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return oA(r,a)?t*(r*Ju+a*Zu):NaN}function eA(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const tA=[31,null,31,30,31,30,31,31,30,31,30,31];function Ly(e){return e%400===0||e%4===0&&e%100!==0}function rA(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(tA[n]||(Ly(e)?29:28))}function nA(e,n){return n>=1&&n<=(Ly(e)?366:365)}function aA(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function sA(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function oA(e,n){return n>=0&&n<=59}function Bn(e,n,t){const r=Je(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Ht(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=B3(l);return r.setMonth(n,Math.min(o,c)),r}function pu(e,n,t){const r=Je(e,t?.in);return r.setHours(n),r}function hu(e,n,t){const r=Je(e,t?.in);return r.setMinutes(n),r}function Xo(e,n,t){const r=Je(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Bn(r,r.getMonth()+o*3)}function mu(e,n,t){const r=Je(e,t?.in);return r.setSeconds(n),r}function xa(e,n,t){const r=Je(e,t?.in);return isNaN(+r)?Ht(e,NaN):(r.setFullYear(n),r)}function no(e,n,t){return sa(e,-n,t)}function zy(e,n,t){return Cp(e,-1,t)}function Xg(e,n,t){return Ou(e,-1,t)}function li(e,n,t){return Ua(e,-n,t)}function tf(){return typeof window<"u"}function mi(e){return By(e)?(e.nodeName||"").toLowerCase():"#document"}function Sn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Na(e){var n;return(n=(By(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function By(e){return tf()?e instanceof Node||e instanceof Sn(e).Node:!1}function ln(e){return tf()?e instanceof Element||e instanceof Sn(e).Element:!1}function Sa(e){return tf()?e instanceof HTMLElement||e instanceof Sn(e).HTMLElement:!1}function Qg(e){return!tf()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Sn(e).ShadowRoot}function Il(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Hn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function iA(e){return["table","td","th"].includes(mi(e))}function rf(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Op(e){const n=Pp(),t=ln(e)?Hn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function lA(e){let n=Fs(e);for(;Sa(n)&&!ci(n);){if(Op(n))return n;if(rf(n))return null;n=Fs(n)}return null}function Pp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ci(e){return["html","body","#document"].includes(mi(e))}function Hn(e){return Sn(e).getComputedStyle(e)}function nf(e){return ln(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Fs(e){if(mi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Qg(e)&&e.host||Na(e);return Qg(n)?n.host:n}function Wy(e){const n=Fs(e);return ci(n)?e.ownerDocument?e.ownerDocument.body:e.body:Sa(n)&&Il(n)?n:Wy(n)}function Dl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=Wy(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Sn(a);if(o){const c=Ld(l);return n.concat(l,l.visualViewport||[],Il(a)?a:[],c&&t?Dl(c):[])}return n.concat(a,Dl(a,[],t))}function Ld(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const ui=Math.min,ao=Math.max,Lu=Math.round,ou=Math.floor,ba=e=>({x:e,y:e}),cA={left:"right",right:"left",bottom:"top",top:"bottom"},uA={start:"end",end:"start"};function zd(e,n,t){return ao(e,ui(n,t))}function jl(e,n){return typeof e=="function"?e(n):e}function fo(e){return e.split("-")[0]}function Ll(e){return e.split("-")[1]}function Uy(e){return e==="x"?"y":"x"}function Rp(e){return e==="y"?"height":"width"}function so(e){return["top","bottom"].includes(fo(e))?"y":"x"}function Mp(e){return Uy(so(e))}function fA(e,n,t){t===void 0&&(t=!1);const r=Ll(e),a=Mp(e),o=Rp(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=zu(l)),[l,zu(l)]}function dA(e){const n=zu(e);return[Bd(e),n,Bd(n)]}function Bd(e){return e.replace(/start|end/g,n=>uA[n])}function pA(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function hA(e,n,t,r){const a=Ll(e);let o=pA(fo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map(Bd)))),o}function zu(e){return e.replace(/left|right|bottom|top/g,n=>cA[n])}function mA(e){return{top:0,right:0,bottom:0,left:0,...e}}function Hy(e){return typeof e!="number"?mA(e):{top:e,right:e,bottom:e,left:e}}function Bu(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var Wu=typeof document<"u"?A.useLayoutEffect:A.useEffect;const xA={...Rv},gA=xA.useInsertionEffect,vA=gA||(e=>e());function yA(e){const n=A.useRef(()=>{});return vA(()=>{n.current=e}),A.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var Yy=Gd();const wA=Vu(Yy);function qg(e,n,t){let{reference:r,floating:a}=e;const o=so(n),l=Mp(n),c=Rp(l),f=fo(n),p=o==="y",d=r.x+r.width/2-a.width/2,x=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let y;switch(f){case"top":y={x:d,y:r.y-a.height};break;case"bottom":y={x:d,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:x};break;case"left":y={x:r.x-a.width,y:x};break;default:y={x:r.x,y:r.y}}switch(Ll(n)){case"start":y[l]-=g*(t&&p?-1:1);break;case"end":y[l]+=g*(t&&p?-1:1);break}return y}const kA=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let p=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:d,y:x}=qg(p,r,f),g=r,y={},k=0;for(let w=0;w<c.length;w++){const{name:_,fn:S}=c[w],{x:P,y:T,data:z,reset:Z}=await S({x:d,y:x,initialPlacement:r,placement:g,strategy:a,middlewareData:y,rects:p,platform:l,elements:{reference:e,floating:n}});d=P??d,x=T??x,y={...y,[_]:{...y[_],...z}},Z&&k<=50&&(k++,typeof Z=="object"&&(Z.placement&&(g=Z.placement),Z.rects&&(p=Z.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):Z.rects),{x:d,y:x}=qg(p,g,f)),w=-1)}return{x:d,y:x,placement:g,strategy:a,middlewareData:y}};async function $y(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:p="clippingAncestors",rootBoundary:d="viewport",elementContext:x="floating",altBoundary:g=!1,padding:y=0}=jl(n,e),k=Hy(y),_=c[g?x==="floating"?"reference":"floating":x],S=Bu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(_)))==null||t?_:_.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:p,rootBoundary:d,strategy:f})),P=x==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,T=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),z=await(o.isElement==null?void 0:o.isElement(T))?await(o.getScale==null?void 0:o.getScale(T))||{x:1,y:1}:{x:1,y:1},Z=Bu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:P,offsetParent:T,strategy:f}):P);return{top:(S.top-Z.top+k.top)/z.y,bottom:(Z.bottom-S.bottom+k.bottom)/z.y,left:(S.left-Z.left+k.left)/z.x,right:(Z.right-S.right+k.right)/z.x}}const _A=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:p,padding:d=0}=jl(e,n)||{};if(p==null)return{};const x=Hy(d),g={x:t,y:r},y=Mp(a),k=Rp(y),w=await l.getDimensions(p),_=y==="y",S=_?"top":"left",P=_?"bottom":"right",T=_?"clientHeight":"clientWidth",z=o.reference[k]+o.reference[y]-g[y]-o.floating[k],Z=g[y]-o.reference[y],L=await(l.getOffsetParent==null?void 0:l.getOffsetParent(p));let C=L?L[T]:0;(!C||!await(l.isElement==null?void 0:l.isElement(L)))&&(C=c.floating[T]||o.floating[k]);const Q=z/2-Z/2,j=C/2-w[k]/2-1,te=ui(x[S],j),X=ui(x[P],j),U=te,ue=C-w[k]-X,le=C/2-w[k]/2+Q,ae=zd(U,le,ue),pe=!f.arrow&&Ll(a)!=null&&le!==ae&&o.reference[k]/2-(le<U?te:X)-w[k]/2<0,V=pe?le<U?le-U:le-ue:0;return{[y]:g[y]+V,data:{[y]:ae,centerOffset:le-ae-V,...pe&&{alignmentOffset:V}},reset:pe}}}),bA=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:p}=n,{mainAxis:d=!0,crossAxis:x=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:w=!0,..._}=jl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const S=fo(a),P=so(c),T=fo(c)===c,z=await(f.isRTL==null?void 0:f.isRTL(p.floating)),Z=g||(T||!w?[zu(c)]:dA(c)),L=k!=="none";!g&&L&&Z.push(...hA(c,w,k,z));const C=[c,...Z],Q=await $y(n,_),j=[];let te=((r=o.flip)==null?void 0:r.overflows)||[];if(d&&j.push(Q[S]),x){const ae=fA(a,l,z);j.push(Q[ae[0]],Q[ae[1]])}if(te=[...te,{placement:a,overflows:j}],!j.every(ae=>ae<=0)){var X,U;const ae=(((X=o.flip)==null?void 0:X.index)||0)+1,pe=C[ae];if(pe){var ue;const se=x==="alignment"?P!==so(pe):!1,M=((ue=te[0])==null?void 0:ue.overflows[0])>0;if(!se||M)return{data:{index:ae,overflows:te},reset:{placement:pe}}}let V=(U=te.filter(se=>se.overflows[0]<=0).sort((se,M)=>se.overflows[1]-M.overflows[1])[0])==null?void 0:U.placement;if(!V)switch(y){case"bestFit":{var le;const se=(le=te.filter(M=>{if(L){const H=so(M.placement);return H===P||H==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(H=>H>0).reduce((H,O)=>H+O,0)]).sort((M,H)=>M[1]-H[1])[0])==null?void 0:le[0];se&&(V=se);break}case"initialPlacement":V=c;break}if(a!==V)return{reset:{placement:V}}}return{}}}};async function EA(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=fo(t),c=Ll(t),f=so(t)==="y",p=["left","top"].includes(l)?-1:1,d=o&&f?-1:1,x=jl(n,e);let{mainAxis:g,crossAxis:y,alignmentAxis:k}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return c&&typeof k=="number"&&(y=c==="end"?k*-1:k),f?{x:y*d,y:g*p}:{x:g*p,y:y*d}}const SA=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await EA(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},TA=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:_=>{let{x:S,y:P}=_;return{x:S,y:P}}},...f}=jl(e,n),p={x:t,y:r},d=await $y(n,f),x=so(fo(a)),g=Uy(x);let y=p[g],k=p[x];if(o){const _=g==="y"?"top":"left",S=g==="y"?"bottom":"right",P=y+d[_],T=y-d[S];y=zd(P,y,T)}if(l){const _=x==="y"?"top":"left",S=x==="y"?"bottom":"right",P=k+d[_],T=k-d[S];k=zd(P,k,T)}const w=c.fn({...n,[g]:y,[x]:k});return{...w,data:{x:w.x-t,y:w.y-r,enabled:{[g]:o,[x]:l}}}}}};function Vy(e){const n=Hn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Sa(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=Lu(t)!==o||Lu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function Ip(e){return ln(e)?e:e.contextElement}function ti(e){const n=Ip(e);if(!Sa(n))return ba(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Vy(n);let l=(o?Lu(t.width):t.width)/r,c=(o?Lu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const CA=ba(0);function Ky(e){const n=Sn(e);return!Pp()||!n.visualViewport?CA:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function DA(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Sn(e)?!1:n}function po(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=Ip(e);let l=ba(1);n&&(r?ln(r)&&(l=ti(r)):l=ti(e));const c=DA(o,t,r)?Ky(o):ba(0);let f=(a.left+c.x)/l.x,p=(a.top+c.y)/l.y,d=a.width/l.x,x=a.height/l.y;if(o){const g=Sn(o),y=r&&ln(r)?Sn(r):r;let k=g,w=Ld(k);for(;w&&r&&y!==k;){const _=ti(w),S=w.getBoundingClientRect(),P=Hn(w),T=S.left+(w.clientLeft+parseFloat(P.paddingLeft))*_.x,z=S.top+(w.clientTop+parseFloat(P.paddingTop))*_.y;f*=_.x,p*=_.y,d*=_.x,x*=_.y,f+=T,p+=z,k=Sn(w),w=Ld(k)}}return Bu({width:d,height:x,x:f,y:p})}function jp(e,n){const t=nf(e).scrollLeft;return n?n.left+t:po(Na(e)).left+t}function Gy(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:jp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function NA(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Na(r),c=n?rf(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},p=ba(1);const d=ba(0),x=Sa(r);if((x||!x&&!o)&&((mi(r)!=="body"||Il(l))&&(f=nf(r)),Sa(r))){const y=po(r);p=ti(r),d.x=y.x+r.clientLeft,d.y=y.y+r.clientTop}const g=l&&!x&&!o?Gy(l,f,!0):ba(0);return{width:t.width*p.x,height:t.height*p.y,x:t.x*p.x-f.scrollLeft*p.x+d.x+g.x,y:t.y*p.y-f.scrollTop*p.y+d.y+g.y}}function FA(e){return Array.from(e.getClientRects())}function AA(e){const n=Na(e),t=nf(e),r=e.ownerDocument.body,a=ao(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=ao(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+jp(e);const c=-t.scrollTop;return Hn(r).direction==="rtl"&&(l+=ao(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function OA(e,n){const t=Sn(e),r=Na(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const p=Pp();(!p||p&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function PA(e,n){const t=po(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Sa(e)?ti(e):ba(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,p=r*o.y;return{width:l,height:c,x:f,y:p}}function Zg(e,n,t){let r;if(n==="viewport")r=OA(e,t);else if(n==="document")r=AA(Na(e));else if(ln(n))r=PA(n,t);else{const a=Ky(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Bu(r)}function Xy(e,n){const t=Fs(e);return t===n||!ln(t)||ci(t)?!1:Hn(t).position==="fixed"||Xy(t,n)}function RA(e,n){const t=n.get(e);if(t)return t;let r=Dl(e,[],!1).filter(c=>ln(c)&&mi(c)!=="body"),a=null;const o=Hn(e).position==="fixed";let l=o?Fs(e):e;for(;ln(l)&&!ci(l);){const c=Hn(l),f=Op(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Il(l)&&!f&&Xy(e,l))?r=r.filter(d=>d!==l):a=c,l=Fs(l)}return n.set(e,r),r}function MA(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?rf(n)?[]:RA(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((p,d)=>{const x=Zg(n,d,a);return p.top=ao(x.top,p.top),p.right=ui(x.right,p.right),p.bottom=ui(x.bottom,p.bottom),p.left=ao(x.left,p.left),p},Zg(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function IA(e){const{width:n,height:t}=Vy(e);return{width:n,height:t}}function jA(e,n,t){const r=Sa(n),a=Na(n),o=t==="fixed",l=po(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=ba(0);function p(){f.x=jp(a)}if(r||!r&&!o)if((mi(n)!=="body"||Il(a))&&(c=nf(n)),r){const y=po(n,!0,o,n);f.x=y.x+n.clientLeft,f.y=y.y+n.clientTop}else a&&p();o&&!r&&a&&p();const d=a&&!r&&!o?Gy(a,c):ba(0),x=l.left+c.scrollLeft-f.x-d.x,g=l.top+c.scrollTop-f.y-d.y;return{x,y:g,width:l.width,height:l.height}}function ld(e){return Hn(e).position==="static"}function Jg(e,n){if(!Sa(e)||Hn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Na(e)===t&&(t=t.ownerDocument.body),t}function Qy(e,n){const t=Sn(e);if(rf(e))return t;if(!Sa(e)){let a=Fs(e);for(;a&&!ci(a);){if(ln(a)&&!ld(a))return a;a=Fs(a)}return t}let r=Jg(e,n);for(;r&&iA(r)&&ld(r);)r=Jg(r,n);return r&&ci(r)&&ld(r)&&!Op(r)?t:r||lA(e)||t}const LA=async function(e){const n=this.getOffsetParent||Qy,t=this.getDimensions,r=await t(e.floating);return{reference:jA(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function zA(e){return Hn(e).direction==="rtl"}const BA={convertOffsetParentRelativeRectToViewportRelativeRect:NA,getDocumentElement:Na,getClippingRect:MA,getOffsetParent:Qy,getElementRects:LA,getClientRects:FA,getDimensions:IA,getScale:ti,isElement:ln,isRTL:zA};function qy(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function WA(e,n){let t=null,r;const a=Na(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const p=e.getBoundingClientRect(),{left:d,top:x,width:g,height:y}=p;if(c||n(),!g||!y)return;const k=ou(x),w=ou(a.clientWidth-(d+g)),_=ou(a.clientHeight-(x+y)),S=ou(d),T={rootMargin:-k+"px "+-w+"px "+-_+"px "+-S+"px",threshold:ao(0,ui(1,f))||1};let z=!0;function Z(L){const C=L[0].intersectionRatio;if(C!==f){if(!z)return l();C?l(!1,C):r=setTimeout(()=>{l(!1,1e-7)},1e3)}C===1&&!qy(p,e.getBoundingClientRect())&&l(),z=!1}try{t=new IntersectionObserver(Z,{...T,root:a.ownerDocument})}catch{t=new IntersectionObserver(Z,T)}t.observe(e)}return l(!0),o}function Zy(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,p=Ip(e),d=a||o?[...p?Dl(p):[],...Dl(n)]:[];d.forEach(S=>{a&&S.addEventListener("scroll",t,{passive:!0}),o&&S.addEventListener("resize",t)});const x=p&&c?WA(p,t):null;let g=-1,y=null;l&&(y=new ResizeObserver(S=>{let[P]=S;P&&P.target===p&&y&&(y.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var T;(T=y)==null||T.observe(n)})),t()}),p&&!f&&y.observe(p),y.observe(n));let k,w=f?po(e):null;f&&_();function _(){const S=po(e);w&&!qy(w,S)&&t(),w=S,k=requestAnimationFrame(_)}return t(),()=>{var S;d.forEach(P=>{a&&P.removeEventListener("scroll",t),o&&P.removeEventListener("resize",t)}),x?.(),(S=y)==null||S.disconnect(),y=null,f&&cancelAnimationFrame(k)}}const Jy=SA,UA=TA,ew=bA,Wd=_A,Ud=(e,n,t)=>{const r=new Map,a={platform:BA,...t},o={...a.platform,_c:r};return kA(e,n,{...a,platform:o})};var xu=typeof document<"u"?A.useLayoutEffect:A.useEffect;function Uu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Uu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Uu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function tw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ev(e,n){const t=tw(e);return Math.round(n*t)/t}function cd(e){const n=A.useRef(e);return xu(()=>{n.current=e}),n}function HA(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:p}=e,[d,x]=A.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,y]=A.useState(r);Uu(g,r)||y(r);const[k,w]=A.useState(null),[_,S]=A.useState(null),P=A.useCallback(se=>{se!==L.current&&(L.current=se,w(se))},[]),T=A.useCallback(se=>{se!==C.current&&(C.current=se,S(se))},[]),z=o||k,Z=l||_,L=A.useRef(null),C=A.useRef(null),Q=A.useRef(d),j=f!=null,te=cd(f),X=cd(a),U=cd(p),ue=A.useCallback(()=>{if(!L.current||!C.current)return;const se={placement:n,strategy:t,middleware:g};X.current&&(se.platform=X.current),Ud(L.current,C.current,se).then(M=>{const H={...M,isPositioned:U.current!==!1};le.current&&!Uu(Q.current,H)&&(Q.current=H,Yy.flushSync(()=>{x(H)}))})},[g,n,t,X,U]);xu(()=>{p===!1&&Q.current.isPositioned&&(Q.current.isPositioned=!1,x(se=>({...se,isPositioned:!1})))},[p]);const le=A.useRef(!1);xu(()=>(le.current=!0,()=>{le.current=!1}),[]),xu(()=>{if(z&&(L.current=z),Z&&(C.current=Z),z&&Z){if(te.current)return te.current(z,Z,ue);ue()}},[z,Z,ue,te,j]);const ae=A.useMemo(()=>({reference:L,floating:C,setReference:P,setFloating:T}),[P,T]),pe=A.useMemo(()=>({reference:z,floating:Z}),[z,Z]),V=A.useMemo(()=>{const se={position:t,left:0,top:0};if(!pe.floating)return se;const M=ev(pe.floating,d.x),H=ev(pe.floating,d.y);return c?{...se,transform:"translate("+M+"px, "+H+"px)",...tw(pe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:M,top:H}},[t,c,pe.floating,d.x,d.y]);return A.useMemo(()=>({...d,update:ue,refs:ae,elements:pe,floatingStyles:V}),[d,ue,ae,pe,V])}const YA=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?Wd({element:r.current,padding:a}).fn(t):{}:r?Wd({element:r,padding:a}).fn(t):{}}}},$A=(e,n)=>({...Jy(e),options:[e,n]}),VA=(e,n)=>({...ew(e),options:[e,n]}),KA=(e,n)=>({...YA(e),options:[e,n]}),GA={...Rv};let tv=!1,XA=0;const rv=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+XA++;function QA(){const[e,n]=A.useState(()=>tv?rv():void 0);return Wu(()=>{e==null&&n(rv())},[]),A.useEffect(()=>{tv=!0},[]),e}const qA=GA.useId,rw=qA||QA,ZA=A.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:p=0,strokeWidth:d=0,staticOffset:x,stroke:g,d:y,style:{transform:k,...w}={},..._}=n,S=rw(),[P,T]=A.useState(!1);if(Wu(()=>{if(!a)return;Hn(a).direction==="rtl"&&T(!0)},[a]),!a)return null;const[z,Z]=r.split("-"),L=z==="top"||z==="bottom";let C=x;(L&&l!=null&&l.x||!L&&l!=null&&l.y)&&(C=null);const Q=d*2,j=Q/2,te=c/2*(p/-8+1),X=f/2*p/4,U=!!y,ue=C&&Z==="end"?"bottom":"top";let le=C&&Z==="end"?"right":"left";C&&P&&(le=Z==="end"?"left":"right");const ae=o?.x!=null?C||o.x:"",pe=o?.y!=null?C||o.y:"",V=y||"M0,0"+(" H"+c)+(" L"+(c-te)+","+(f-X))+(" Q"+c/2+","+f+" "+te+","+(f-X))+" Z",se={top:U?"rotate(180deg)":"",left:U?"rotate(90deg)":"rotate(-90deg)",bottom:U?"":"rotate(180deg)",right:U?"rotate(-90deg)":"rotate(90deg)"}[z];return h.jsxs("svg",{..._,"aria-hidden":!0,ref:t,width:U?c:c+Q,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[le]:ae,[ue]:pe,[z]:L||U?"100%":"calc(100% - "+Q/2+"px)",transform:[se,k].filter(M=>!!M).join(" "),...w},children:[Q>0&&h.jsx("path",{clipPath:"url(#"+S+")",fill:"none",stroke:g,strokeWidth:Q+(y?0:1),d:V}),h.jsx("path",{stroke:Q&&!y?_.fill:"none",d:V}),h.jsx("clipPath",{id:S,children:h.jsx("rect",{x:-j,y:j*(U?-1:1),width:c+Q,height:c})})]})});function JA(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const eO=A.createContext(null),tO=A.createContext(null),rO=()=>{var e;return((e=A.useContext(eO))==null?void 0:e.id)||null},nO=()=>A.useContext(tO);function aO(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=rw(),o=A.useRef({}),[l]=A.useState(()=>JA()),c=rO()!=null,[f,p]=A.useState(r.reference),d=yA((y,k,w)=>{o.current.openEvent=y?k:void 0,l.emit("openchange",{open:y,event:k,reason:w,nested:c}),t?.(y,k,w)}),x=A.useMemo(()=>({setPositionReference:p}),[]),g=A.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return A.useMemo(()=>({dataRef:o,open:n,onOpenChange:d,elements:g,events:l,floatingId:a,refs:x}),[n,d,g,l,a,x])}function sO(e){e===void 0&&(e={});const{nodeId:n}=e,t=aO({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=A.useState(null),[c,f]=A.useState(null),d=a?.domReference||o,x=A.useRef(null),g=nO();Wu(()=>{d&&(x.current=d)},[d]);const y=HA({...e,elements:{...a,...c&&{reference:c}}}),k=A.useCallback(T=>{const z=ln(T)?{getBoundingClientRect:()=>T.getBoundingClientRect(),getClientRects:()=>T.getClientRects(),contextElement:T}:T;f(z),y.refs.setReference(z)},[y.refs]),w=A.useCallback(T=>{(ln(T)||T===null)&&(x.current=T,l(T)),(ln(y.refs.reference.current)||y.refs.reference.current===null||T!==null&&!ln(T))&&y.refs.setReference(T)},[y.refs]),_=A.useMemo(()=>({...y.refs,setReference:w,setPositionReference:k,domReference:x}),[y.refs,w,k]),S=A.useMemo(()=>({...y.elements,domReference:d}),[y.elements,d]),P=A.useMemo(()=>({...y,...r,refs:_,elements:S,nodeId:n}),[y,_,S,n,r]);return Wu(()=>{r.dataRef.current.floatingContext=P;const T=g?.nodesRef.current.find(z=>z.id===n);T&&(T.context=P)}),A.useMemo(()=>({...y,context:P,refs:_,elements:S}),[y,_,S,P])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Hd=function(n,t){return Hd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},Hd(n,t)};function Rr(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Hd(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var Ft=function(){return Ft=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Ft.apply(this,arguments)};function _a(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var oO=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return be.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},iO=function(e,n){var t=A.useRef(null),r=A.useRef(e);r.current=e;var a=A.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return A.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},af=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=iO(t,l);return be.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},Ye;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(Ye||(Ye={}));function Lp(){var e=typeof window<"u"?window:globalThis;return e}var zl=12;function Lt(e){if(e==null)return new Date;var n=typeof e=="string"?$F(e):Je(e);return sf(n)?n:new Date}function ud(e,n,t,r,a){a===void 0&&(a=Lt());for(var o=fi(t)||fi(zp()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var p=f[c],d=LF(e,p,a,{locale:o});if(sf(d)&&(!r||e===tr(d,p,t)))return d}return null}function sf(e,n){return Pu(e)&&!uo(e,new Date("1/1/1800"))}function tr(e,n,t){if(t==="en")return Kg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?fi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||fi(zp()),Kg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function zn(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&tr(e,a,r)||""}function lO(e,n,t){if(!e)return"";var r=zn(e,t),a=n?zn(n,t):"";return"".concat(r," - ").concat(a)}function cO(e,n){if(!e?.length)return"";var t=e[0]?zn(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=zn(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function fd(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return pu(hu(mu(e,c),o),r)}function uO(e){return Dp(e)}function fO(e,n){return tr(e,"ddd",n)}function gu(e){return co(e)}function Ts(e,n,t){var r=fi(n||zp());return oa(e,{locale:r,weekStartsOn:t})}function Va(e){return Dy(e)}function ol(e){return ef(e)}function nv(e){return Md(e)}function av(){return co(Lt())}function sv(e){return Ty(e)}function dO(e){return $N(e)}function pO(e){return Cy(e)}function ga(e,n){return e&&n?HF(e,n):!e&&!n}function rn(e,n){return e&&n?WF(e,n):!e&&!n}function Hu(e,n){return e&&n?UF(e,n):!e&&!n}function Nt(e,n){return e&&n?HN(e,n):!e&&!n}function qs(e,n){return e&&n?H3(e,n):!e&&!n}function il(e,n,t){var r,a=co(n),o=Ty(t);try{r=Cl(e,{start:a,end:o})}catch{r=!1}return r}function xi(e,n){var t=Lp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function zp(){var e=Lp();return e.__localeId__}function fi(e){if(typeof e=="string"){var n=Lp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function hO(e,n,t){return n(tr(e,"EEEE",t))}function mO(e,n){return tr(e,"EEEEEE",n)}function xO(e,n){return tr(e,"EEE",n)}function Bp(e,n){return tr(Bn(Lt(),e),"LLLL",n)}function nw(e,n){return tr(Bn(Lt(),e),"LLL",n)}function gO(e,n){return tr(Xo(Lt(),e),"QQQ",n)}function Wn(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,p=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(d){return d instanceof Date?Nt(e,d):Nt(e,d.date)})||l&&l.some(function(d){var x=d.start,g=d.end;return Cl(e,{start:x,end:g})})||c&&!c.some(function(d){return Nt(e,d)})||f&&!f.some(function(d){var x=d.start,g=d.end;return Cl(e,{start:x,end:g})})||p&&!p(Lt(e))||!1}function Wp(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Cl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?Nt(e,o):Nt(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function aw(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r?Dy(r):void 0,maxDate:a?Cy(a):void 0})||o?.some(function(f){return rn(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return rn(e,f)})||c&&!c(Lt(e))||!1}function iu(e,n,t,r){var a=yt(e),o=on(e),l=yt(n),c=on(n),f=yt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function vO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return rn(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return rn(c,e)})||!1}function lu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o?.some(function(f){return Hu(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return Hu(e,f)})||c&&!c(Lt(e))||!1}function cu(e,n,t){if(!n||!t||!Pu(n)||!Pu(t))return!1;var r=yt(n),a=yt(t);return r<=e&&a>=e}function vu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return Bl(f,{minDate:r?ef(r):void 0,maxDate:a?Ny(a):void 0})||o?.some(function(p){return ga(f,p instanceof Date?p:p.date)})||l&&!l.some(function(p){return ga(f,p)})||c&&!c(Lt(f))||!1}function uu(e,n,t,r){var a=yt(e),o=ro(e),l=yt(n),c=ro(n),f=yt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function Bl(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&ii(e,a)<0||o&&ii(e,o)>0)!==null&&t!==void 0?t:!1}function ov(e,n){return n.some(function(t){return Ya(t)===Ya(e)&&$a(t)===$a(e)&&Ss(t)===Ss(e)})}function iv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&ov(e,r)||a&&!ov(e,a)||o&&!o(e)||!1}function lv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Lt();a=pu(a,Ya(e)),a=hu(a,$a(e)),a=mu(a,Ss(e));var o=Lt();o=pu(o,Ya(t)),o=hu(o,$a(t)),o=mu(o,Ss(t));var l=Lt();l=pu(l,Ya(r)),l=hu(l,$a(r)),l=mu(l,Ss(r));var c;try{c=!Cl(a,{start:o,end:l})}catch{c=!1}return c}function cv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=no(e,1);return r&&Ru(r,o)>0||a&&a.every(function(l){return Ru(l,o)>0})||!1}function uv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=sa(e,1);return r&&Ru(o,r)>0||a&&a.every(function(l){return Ru(o,l)>0})||!1}function yO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=ef(e),l=zy(o);return r&&Mu(r,l)>0||a&&a.every(function(c){return Mu(c,l)>0})||!1}function wO(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ny(e),l=Cp(o,1);return r&&Mu(l,r)>0||a&&a.every(function(c){return Mu(l,c)>0})||!1}function fv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=li(e,1);return r&&Iu(r,o)>0||a&&a.every(function(l){return Iu(l,o)>0})||!1}function kO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=ol(li(e,o)),c=bs(l,o).endPeriod,f=r&&yt(r);return f&&f>c||!1}function dv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ua(e,1);return r&&Iu(o,r)>0||a&&a.every(function(l){return Iu(o,l)>0})||!1}function _O(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=Ua(e,o),c=bs(l,o).startPeriod,f=r&&yt(r);return f&&f<c||!1}function sw(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)>=0});return Wg(r)}else return t?Wg(t):n}function ow(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)<=0});return Bg(r)}else return t?Bg(t):n}function pv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Ha(l)){var c=tr(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var p=Object.keys(l),d=(t=p[0])!==null&&t!==void 0?t:"",x=l[d];if(typeof d=="string"&&Array.isArray(x))for(var g=0,y=x.length;g<y;g++){var k=x[g];if(k){var c=tr(k,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(d)||(f.push(d),r.set(c,f))}}}}return r}function bO(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function EO(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Ha(a)){var l=tr(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&bO(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?_a(_a([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function SO(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,p=a[c];p&&(f=zN(f,Ya(p)),f=Rd(f,$a(p)),f=UN(f,Ss(p)));var d=Rd(e,(t+1)*r);Ns(f,n)&&uo(f,d)&&p!=null&&l.push(p)}return l}function hv(e){return e<10?"0".concat(e):"".concat(e)}function bs(e,n){n===void 0&&(n=zl);var t=Math.ceil(yt(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function TO(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function mv(e){var n=e.getSeconds(),t=e.getMilliseconds();return Je(e.getTime()-n*1e3-t)}function CO(e,n){return mv(e).getTime()===mv(n).getTime()}function xv(e){if(!Ha(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function gv(e,n){if(!Ha(e)||!Ha(n))throw new Error("Invalid date received");var t=xv(e),r=xv(n);return uo(t,r)}function iw(e){return e.key===Ye.Space}var DO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=be.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),p=f?c:new Date;if(a?.includes(":")){var d=a.split(":"),x=d[0],g=d[1];p.setHours(Number(x)),p.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,p)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?A.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):be.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var p;(p=r.inputRef.current)===null||p===void 0||p.focus()},required:!0,value:a,onChange:function(p){r.onTimeChange(p.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return be.createElement("div",{className:"react-datepicker__input-time-container"},be.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),be.createElement("div",{className:"react-datepicker-time__input-container"},be.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(A.Component),NO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=A.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Ye.Space&&(r.preventDefault(),r.key=Ye.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return Nt(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Wp(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Nt(t.props.day,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&Nt(r,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=tr(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=tr(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:il(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,p=a.selectsDisabledDaysInRange,d=a.startDate,x=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!p&&t.isDisabled()?!1:l&&x&&(uo(g,x)||qs(g,x))?il(o,g,x):c&&d&&!x&&(Ns(g,d)||qs(g,d))||f&&d&&!x&&(Ns(g,d)||qs(g,d))?il(o,d,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?Nt(o,f):Nt(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,p=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?Nt(o,p):Nt(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Nt(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Nt(l,a)},t.isWeekend=function(){var r=z3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===on(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(on(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Lt())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Lr("react-datepicker__day",a,"react-datepicker__day--"+fO(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,p=t.isDisabled()||t.isExcluded()?f:l;return"".concat(p," ").concat(tr(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=tr(a,"MM.dd.yyyy"),p=[];return l.has(f)&&p.push.apply(p,l.get(f).holidayNames),t.isExcluded()&&p.push(c?.filter(function(d){return d instanceof Date?Nt(d,a):Nt(d?.date,a)}).map(function(d){if(!(d instanceof Date))return d?.message})),p.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&Nt(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Gg(t.props.day),t.props.day):Gg(t.props.day)},t.render=function(){return be.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&be.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(A.Component),FO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=A.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Ye.Space&&(r.preventDefault(),r.key=Ye.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Nt(t.props.date,t.props.selected)&&Nt(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Nt(t.props.date,t.props.selected)&&Nt(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&Nt(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&Nt(this.props.date,this.props.selected)};return be.createElement("div",{ref:this.weekNumberEl,className:Lr(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(A.Component),AO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,p=new Date(r),d=0;d<7;d++){var x=new Date(r);x.setDate(x.getDate()+d);var g=!t.isDisabled(x);if(g){p=x;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(p,a,o),t.props.showWeekPicker&&t.handleDayClick(p,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):uO(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=aa(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=aa(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(be.createElement(FO,Ft({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(r,c);return be.createElement(NO,Ft({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Ts(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Nt(t.startOfWeek(),t.props.selected)&&Nt(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Nt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return be.createElement("div",{className:Lr(t)},this.renderDays())},n})(A.Component),tl,OO=6,ri={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},dd=(tl={},tl[ri.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},tl[ri.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},tl[ri.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},tl),fu=1;function vv(e,n){return e?ri.FOUR_COLUMNS:n?ri.TWO_COLUMNS:ri.THREE_COLUMNS}var PO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=_a([],Array(12),!0).map(function(){return A.createRef()}),t.QUARTER_REFS=_a([],Array(4),!0).map(function(){return A.createRef()}),t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return Wp(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:rn(Bn(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Hu(Xo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:rn(Bn(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Hu(Xo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,p=o.selectsRange,d=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||p)||!g?!1:c&&x?iu(g,x,r,l):f&&d||p&&d&&!x?iu(d,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,p=Bn(l,r),d=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?rn(p,d):rn(p,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,p=o.selectsRange,d=Bn(l,r),x=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||p?rn(d,x):rn(d,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,p=o.selectsRange,d=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||p)||!g?!1:c&&x?uu(g,x,r,l):f&&d||p&&d&&!x?uu(d,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=aa(r,6);return rn(r,a)||rn(o,a)},t.isCurrentMonth=function(r,a){return yt(r)===yt(Lt())&&a===on(Lt())},t.isCurrentQuarter=function(r,a){return yt(r)===yt(Lt())&&a===ro(Lt())},t.isSelectedMonth=function(r,a,o){return on(o)===a&&yt(r)===yt(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return ro(r)===a&&yt(r)===yt(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Ts(Va(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.preSelection},p=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.selected},d=t.props.selected?p(t.props.selected):void 0,x=t.props.preSelection?f(t.props.preSelection):void 0;r.push(be.createElement(AO,Ft({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:on(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:d,preSelection:x,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=Ou(c,1);var g=a&&o>=OO,y=!a&&!t.isWeekInMonth(c);if(g||y)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Va(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Va(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,p=c.preSelection,d=c.setPreSelection,x=c.minDate,g=c.maxDate,y=c.showFourColumnMonthYearPicker,k=c.showTwoColumnMonthYearPicker;if(p){var w=vv(y,k),_=t.getVerticalOffset(w),S=(l=dd[w])===null||l===void 0?void 0:l.grid,P=function(C,Q,j){var te,X,U=Q,ue=j;switch(C){case Ye.ArrowRight:U=sa(Q,fu),ue=j===11?0:j+fu;break;case Ye.ArrowLeft:U=no(Q,fu),ue=j===0?11:j-fu;break;case Ye.ArrowUp:U=no(Q,_),ue=!((te=S?.[0])===null||te===void 0)&&te.includes(j)?j+12-_:j-_;break;case Ye.ArrowDown:U=sa(Q,_),ue=!((X=S?.[S.length-1])===null||X===void 0)&&X.includes(j)?j-12+_:j+_;break}return{newCalculatedDate:U,newCalculatedMonth:ue}},T=function(C,Q,j){for(var te=40,X=C,U=!1,ue=0,le=P(X,Q,j),ae=le.newCalculatedDate,pe=le.newCalculatedMonth;!U;){if(ue>=te){ae=Q,pe=j;break}if(x&&ae<x){X=Ye.ArrowRight;var V=P(X,ae,pe);ae=V.newCalculatedDate,pe=V.newCalculatedMonth}if(g&&ae>g){X=Ye.ArrowLeft;var V=P(X,ae,pe);ae=V.newCalculatedDate,pe=V.newCalculatedMonth}if(vO(ae,t.props)){var V=P(X,ae,pe);ae=V.newCalculatedDate,pe=V.newCalculatedMonth}else U=!0;ue++}return{newCalculatedDate:ae,newCalculatedMonth:pe}};if(a===Ye.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),d?.(f));return}var z=T(a,p,o),Z=z.newCalculatedDate,L=z.newCalculatedMonth;switch(a){case Ye.ArrowRight:case Ye.ArrowLeft:case Ye.ArrowUp:case Ye.ArrowDown:t.handleMonthNavigation(L,Z);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=dd[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==Ye.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Xo(t.props.day,a);lu(o,t.props)||t.handleDayClick(nv(o),r)},t.onQuarterMouseEnter=function(r){var a=Xo(t.props.day,r);lu(a,t.props)||t.handleDayMouseEnter(nv(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case Ye.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case Ye.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Cp(t.props.preSelection,1));break;case Ye.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,zy(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,p=o.excludeDates,d=o.includeDates,x=Bn(l,r);return{isDisabled:(a=(c||f||p||d)&&aw(x,t.props))!==null&&a!==void 0?a:!1,labelDate:x}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,p=a.monthClassName,d=p?p(Bn(o,r)):void 0,x=t.getSelection();return Lr("react-datepicker__month-text","react-datepicker__month-".concat(r),d,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":x?t.isSelectMonthInList(o,r,x):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?iu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=on(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=ro(t.props.preSelection),o=lu(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,p=a.day,d=a.locale,x=Bn(p,r),g=t.isDisabled(x)||t.isExcluded(x)?f:l;return"".concat(g," ").concat(tr(x,"MMMM yyyy",d))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,p=a.minDate,d=a.maxDate,x=a.excludeDates,g=a.includeDates,y=a.filterDate,k=a.preSelection,w=a.disabledKeyboardNavigation,_=(p||d||x||g||y)&&lu(Xo(o,r),t.props);return Lr("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":_,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!w&&k&&t.isSelectedQuarter(o,r,k)&&!_,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,p=nw(r,c),d=Bp(r,c);return l?l(r,p,d,f):o?d:p},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=gO(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,p=(r=dd[vv(l,o)])===null||r===void 0?void 0:r.grid;return p?.map(function(d,x){return be.createElement("div",{className:"react-datepicker__month-wrapper",key:x},d.map(function(g,y){return be.createElement("div",{ref:t.MONTH_REFS[g],key:y,onClick:function(k){t.onMonthClick(k,g)},onKeyDown:function(k){iw(k)&&(k.preventDefault(),k.key=Ye.Enter),t.onMonthKeyDown(k,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return be.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return be.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(p){t.onQuarterClick(p,c)},onKeyDown:function(p){t.onQuarterKeyDown(p,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,p=r.showWeekPicker;return Lr("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":p})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return be.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(tr(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(A.Component),RO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return be.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?be.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return be.createElement(af,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(A.Component),MO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return be.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return be.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return be.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},be.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),be.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return be.createElement(RO,Ft({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return nw(o,t.props.locale)}:function(o){return Bp(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return be.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(A.Component);function IO(e,n){for(var t=[],r=Va(e),a=Va(n);!Ns(r,a);)t.push(Lt(r)),r=sa(r,1);return t}var jO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=jd(a),l=ga(r.props.date,a)&&rn(r.props.date,a);return be.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?be.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",tr(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:IO(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Lr({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return be.createElement(af,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(A.Component),LO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Va(t.props.minDate),a=Va(t.props.maxDate),o=[];!Ns(r,a);){var l=jd(r);o.push(be.createElement("option",{key:l,value:l},tr(r,t.props.dateFormat,t.props.locale))),r=sa(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return be.createElement("select",{value:jd(Va(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=tr(t.props.date,t.props.dateFormat,t.props.locale);return be.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},be.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),be.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return be.createElement(jO,Ft({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Lt(r);ga(t.props.date,a)&&rn(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return be.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(A.Component),zO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&lv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&iv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&CO(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&lv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&iv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(Ya(r)*3600+$a(r)*60+Ss(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===Ye.Space&&(r.preventDefault(),r.key=Ye.Enter),(r.key===Ye.ArrowUp||r.key===Ye.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===Ye.ArrowDown||r.key===Ye.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===Ye.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Lt(),f=gu(c),p=t.props.injectTimes&&t.props.injectTimes.sort(function(_,S){return _.getTime()-S.getTime()}),d=60*TO(c),x=d/l,g=0;g<x;g++){var y=Rd(f,g*l);if(a.push(y),p){var k=SO(f,y,g,l,p);a=a.concat(k)}}var w=a.reduce(function(_,S){return S.getTime()<=c.getTime()?S:_},a[0]);return a.map(function(_){return be.createElement("li",{key:_.valueOf(),onClick:t.handleClick.bind(t,_),className:t.liClasses(_),ref:function(S){_===w&&(t.centerLi=S)},onKeyDown:function(S){t.handleOnKeyDown(S,_)},tabIndex:_===w?0:-1,role:"option","aria-selected":t.isSelectedTime(_)?"true":void 0,"aria-disabled":t.isDisabledTime(_)?"true":void 0},tr(_,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?be.createElement(be.Fragment,null):be.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},be.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return be.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),be.createElement("div",{className:"react-datepicker__time"},be.createElement("div",{className:"react-datepicker__time-box"},be.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(A.Component),yv=3,BO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=_a([],Array(r.props.yearItemNumber),!0).map(function(){return A.createRef()}),r.isDisabled=function(a){return Wn(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return Wp(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,p,d=r.props,x=d.date,g=d.yearItemNumber;if(!(x===void 0||g===void 0)){var y=bs(x,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-y<0?r.updateFocusOnPaginate(g-(y-a)):a-y>=g?r.updateFocusOnPaginate(Math.abs(g-(a-y))):(p=(f=r.YEAR_REFS[a-y])===null||f===void 0?void 0:f.current)===null||p===void 0||p.focus())}},r.isSameDay=function(a,o){return Nt(a,o)},r.isCurrentYear=function(a){return a===yt(Lt())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&ga(xa(Lt(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&ga(xa(Lt(),a),r.props.endDate)},r.isInRange=function(a){return cu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,p=o.startDate,d=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&d?cu(a,r.selectingDate(),d):c&&p||f&&p&&!d?cu(a,p,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,p=xa(Lt(),a);return f?ga(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):ga(p,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,p=l.selectsRange,d=xa(Lt(),a);return f||p?ga(d,(o=r.selectingDate())!==null&&o!==void 0?o:null):ga(d,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,p=o.includeDates,d=o.filterDate,x=ol(xa(r.props.date,a)),g=(l||c||f||p||d)&&vu(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Nt(x,ol(r.props.selected))&&Nt(x,ol(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(p){return a===yt(p)}):!c||a===yt(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ol(xa(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,p=r.props,d=p.date,x=p.yearItemNumber,g=p.handleOnKeyDown;if(f!==Ye.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case Ye.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case Ye.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Ua(r.props.preSelection,1));break;case Ye.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,li(r.props.preSelection,1));break;case Ye.ArrowUp:{if(d===void 0||x===void 0||r.props.preSelection==null)break;var y=bs(d,x).startPeriod,k=yv,w=o-k;if(w<y){var _=x%k;o>=y&&o<y+_?k=_:k+=_,w=o-k}r.handleYearNavigation(w,li(r.props.preSelection,k));break}case Ye.ArrowDown:{if(d===void 0||x===void 0||r.props.preSelection==null)break;var S=bs(d,x).endPeriod,k=yv,w=o+k;if(w>S){var _=x%k;o<=S&&o>S-_?k=_:k+=_,w=o+k}r.handleYearNavigation(w,Ua(r.props.preSelection,k));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,p=o.excludeDates,d=o.includeDates,x=o.filterDate,g=o.yearClassName;return Lr("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(xa(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||p||d||x)&&vu(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=yt(r.props.preSelection),l=vu(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var p=bs(o,l),d=p.startPeriod,x=p.endPeriod,g=function(w){r.push(be.createElement("div",{ref:y.YEAR_REFS[w-d],onClick:function(_){t.onYearClick(_,w)},onKeyDown:function(_){iw(_)&&(_.preventDefault(),_.key=Ye.Enter),t.onYearKeyDown(_,w)},tabIndex:Number(y.getYearTabIndex(w)),className:y.getYearClassNames(w),onMouseEnter:y.props.usePointerEvent?void 0:function(_){return c(_,w)},onPointerEnter:y.props.usePointerEvent?function(_){return c(_,w)}:void 0,onMouseLeave:y.props.usePointerEvent?void 0:function(_){return f(_,w)},onPointerLeave:y.props.usePointerEvent?function(_){return f(_,w)}:void 0,key:w,"aria-current":y.isCurrentYear(w)?"date":void 0},y.getYearContent(w)))},y=this,k=d;k<=x;k++)g(k);return be.createElement("div",{className:"react-datepicker__year"},be.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(A.Component);function WO(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=yt(t)<=l),r&&c&&(c=yt(r)>=l),c&&a.push(l)}return a}var UO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(x){return be.createElement("div",{className:c===x?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:x,onClick:r.onChange.bind(r,x),"aria-selected":c===x?"true":void 0},c===x?be.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",x)}),p=r.props.minDate?yt(r.props.minDate):null,d=r.props.maxDate?yt(r.props.maxDate):null;return(!d||!r.state.yearsList.find(function(x){return x===d}))&&f.unshift(be.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},be.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!p||!r.state.yearsList.find(function(x){return x===p}))&&f.push(be.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},be.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(p){return p+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:WO(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=A.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Lr({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return be.createElement(af,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(A.Component),HO=(function(e){Rr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?yt(t.props.minDate):1900,a=t.props.maxDate?yt(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(be.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return be.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return be.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},be.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),be.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return be.createElement(UO,Ft({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return be.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(A.Component),YO=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],$O=function(e){var n=(e.className||"").split(/\s+/);return YO.some(function(t){return n.indexOf(t)>=0})},VO=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;$O(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=sw(r.props),p=ow(r.props),d=Lt(),x=c||l||o;return x||(f&&uo(d,f)?f:p&&Ns(d,p)?p:d)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:sa(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:no(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:xa(Lt(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!Wn(a,r.props))return a;for(var o=Va(a),l=pO(a),c=YN(l,o),f=null,p=0;p<=c;p++){var d=aa(o,p);if(!Wn(d,r.props)){f=d;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:xa(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Bn(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:xa(Bn(l,on(a)),yt(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Ts(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(be.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(o,c),p=r.formatWeekday(f,r.props.locale),d=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return be.createElement("div",{key:c,"aria-label":tr(f,"EEEE",r.props.locale),className:Lr("react-datepicker__day-name",d)},p)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?hO(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?xO(a,o):mO(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:li(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,d=no(r.state.date,p),x;switch(!0){case r.props.showMonthYearPicker:x=fv(r.state.date,r.props);break;case r.props.showYearPicker:x=kO(r.state.date,r.props);break;case r.props.showQuarterYearPicker:x=yO(r.state.date,r.props);break;default:x=cv(d,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&x||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],y=["react-datepicker__navigation","react-datepicker__navigation--previous"],k=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(k=r.decreaseYear),x&&r.props.showDisabledMonthNavigation&&(y.push("react-datepicker__navigation--previous--disabled"),k=void 0);var w=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,_=r.props,S=_.previousMonthButtonLabel,P=S===void 0?n.defaultProps.previousMonthButtonLabel:S,T=_.previousYearButtonLabel,z=T===void 0?n.defaultProps.previousYearButtonLabel:T,Z=r.props,L=Z.previousMonthAriaLabel,C=L===void 0?typeof P=="string"?P:"Previous Month":L,Q=Z.previousYearAriaLabel,j=Q===void 0?typeof z=="string"?z:"Previous Year":Q;return be.createElement("button",{type:"button",className:y.join(" "),onClick:k,onKeyDown:r.props.handleOnKeyDown,"aria-label":w?j:C},be.createElement("span",{className:g.join(" ")},w?z:P))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Ua(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=dv(r.state.date,r.props);break;case r.props.showYearPicker:o=_O(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=wO(r.state.date,r.props);break;default:o=uv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var p=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,d=r.props,x=d.nextMonthButtonLabel,g=x===void 0?n.defaultProps.nextMonthButtonLabel:x,y=d.nextYearButtonLabel,k=y===void 0?n.defaultProps.nextYearButtonLabel:y,w=r.props,_=w.nextMonthAriaLabel,S=_===void 0?typeof g=="string"?g:"Next Month":_,P=w.nextYearAriaLabel,T=P===void 0?typeof k=="string"?k:"Next Year":P;return be.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":p?T:S},be.createElement("span",{className:c.join(" ")},p?k:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),be.createElement("h2",{className:o.join(" ")},tr(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return be.createElement(HO,Ft({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:yt(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return be.createElement(MO,Ft({},n.defaultProps,r.props,{month:on(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return be.createElement(LO,Ft({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(av(),a),r.props.setPreSelection&&r.props.setPreSelection(av())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return be.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return be.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),be.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),be.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var p=cv(r.state.date,r.props),d=uv(r.state.date,r.props),x=fv(r.state.date,r.props),g=dv(r.state.date,r.props),y=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return be.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,Ft(Ft({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:p,nextMonthButtonDisabled:d,prevYearButtonDisabled:x,nextYearButtonDisabled:g})),y&&be.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,p=f===void 0?n.defaultProps.yearItemNumber:f,d=bs(o,p),x=d.startPeriod,g=d.endPeriod;return be.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(x," - ").concat(g):yt(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,p=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(r.state.date,f):no(r.state.date,f),d=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,x=0;x<c;++x){var g=x-d+f,y=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(p,g):sa(p,g),k="month-".concat(x),w=x<c-1,_=x>0;l.push(be.createElement("div",{key:k,ref:function(S){r.monthContainer=S??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:y,i:x}),be.createElement(PO,Ft({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:y,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:x,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:w,monthShowsDuplicateDaysStart:_}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return be.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),be.createElement(BO,Ft({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return be.createElement(zO,Ft({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&sf(a)&&!!r.props.selected,l=o?"".concat(hv(a.getHours()),":").concat(hv(a.getMinutes())):"";if(r.props.showTimeInput)return be.createElement(DO,Ft({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=bs(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=yt(r.state.date):f="".concat(Bp(on(r.state.date),r.props.locale)," ").concat(yt(r.state.date)),be.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return be.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=A.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:zl}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!Nt(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!rn(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!Nt(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||oO;return be.createElement(af,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},be.createElement("div",{style:{display:"contents"},ref:this.containerRef},be.createElement(t,{className:Lr("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(A.Component),KO=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return be.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(be.isValidElement(n)){var l=n;return be.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return be.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},be.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},lw=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return wA.createPortal(this.props.children,this.el)},n})(A.Component),GO="[tabindex], a, button, input, select, textarea",XO=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},cw=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(GO),1,-1).filter(XO)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=A.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?be.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},be.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,be.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(A.Component);function QO(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=A.useRef(null),l=sO(Ft({open:!a,whileElementsMounted:Zy,placement:t.popperPlacement,middleware:_a([VA({padding:15}),$A(10),KA({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=Ft(Ft({},t),{hidePopper:a,popperProps:Ft(Ft({},l),{arrowRef:o})});return be.createElement(e,Ft({},c))};return n}var qO=(function(e){Rr(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,p=t.enableTabLoop,d=t.popperOnKeyDown,x=t.portalId,g=t.portalHost,y=t.popperProps,k=t.showArrow,w=void 0;if(!l){var _=Lr("react-datepicker-popper",r);w=be.createElement(cw,{enableTabLoop:p},be.createElement("div",{ref:y.refs.setFloating,style:y.floatingStyles,className:_,"data-placement":y.placement,onKeyDown:d},c,k&&be.createElement(ZA,{ref:y.arrowRef,context:y.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(w=A.createElement(this.props.popperContainer,{},w)),x&&!l&&(w=be.createElement(lw,{portalId:x,portalHost:g},w));var S=Lr("react-datepicker-wrapper",a);return be.createElement(be.Fragment,null,be.createElement("div",{ref:y.refs.setReference,className:S},f),w)},n})(A.Component),ZO=QO(qO),wv="react-datepicker-ignore-onclickoutside";function JO(e,n){return e&&n?on(e)!==on(n)||yt(e)!==yt(n):e!==n}var pd="Date input not valid.",As=(function(e){Rr(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Lt()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return sf(c)?_a(_a([],o,!0),[Ft(Ft({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=sw(r.props),c=ow(r.props),f=l&&uo(o,gu(l))?l:c&&Ns(o,sv(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:pv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(Ft(Ft({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(Ft(Ft({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:hd},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Ha(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,p=[],d=0;d<arguments.length;d++)p[d]=arguments[d];var x=p[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,p),!x||typeof x.isDefaultPrevented!="function"||x.isDefaultPrevented()))){r.setState({inputValue:x?.target instanceof HTMLInputElement?x.target.value:null,lastPreSelectChange:eP});var g=r.props,y=g.selectsRange,k=g.startDate,w=g.endDate,_=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,S=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,P=x?.target instanceof HTMLInputElement?x.target.value:"";if(y){var T=P.split("-",2).map(function(X){return X.trim()}),z=T[0],Z=T[1],L=ud(z??"",_,r.props.locale,S),C=ud(Z??"",_,r.props.locale,S),Q=k?.getTime()!==L?.getTime(),j=w?.getTime()!==C?.getTime();if(!Q&&!j||L&&Wn(L,r.props)||C&&Wn(C,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[L,C],x)}else{var te=ud(P,_,r.props.locale,S,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(te||!P)&&r.setSelected(te,x,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,p=c.endDate;f&&!p&&(r.props.swapRange||!gv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,p,d=a;if(r.props.showYearPicker){if(d!==null&&vu(yt(d),r.props))return}else if(r.props.showMonthYearPicker){if(d!==null&&aw(d,r.props))return}else if(d!==null&&Wn(d,r.props))return;var x=r.props,g=x.onChange,y=x.selectsRange,k=x.startDate,w=x.endDate,_=x.selectsMultiple,S=x.selectedDates,P=x.minTime,T=x.swapRange;if(!qs(r.props.selected,d)||r.props.allowSameDay||y||_)if(d!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(d=fd(d,{hour:Ya(r.props.selected),minute:$a(r.props.selected),second:Ss(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&P&&(d=fd(d,{hour:P.getHours(),minute:P.getMinutes(),second:P.getSeconds()})),r.props.inline||r.setState({preSelection:d}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),y){var z=!k&&!w,Z=k&&!w,L=k&&w;z?g?.([d,null],o):Z&&(d===null?g?.([null,null],o):gv(d,k)?g?.(T?[d,k]:[d,null],o):g?.([k,d],o)),L&&g?.([d,null],o)}else if(_){if(d!==null)if(!S?.length)g?.([d],o);else{var C=S.some(function(j){return Nt(j,d)});if(C){var Q=S.filter(function(j){return!Nt(j,d)});g?.(Q,o)}else g?.(_a(_a([],S,!0),[d],!1),o)}}else g?.(d,o);l||((p=(f=r.props).onSelect)===null||p===void 0||p.call(f,d,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Ha(r.props.minDate),l=Ha(r.props.maxDate),c=!0;if(a){var f=gu(a);if(o&&l)c=il(a,r.props.minDate,r.props.maxDate);else if(o){var p=gu(r.props.minDate);c=Ns(a,p)||qs(f,p)}else if(l){var d=sv(r.props.maxDate);c=uo(a,d)||qs(f,d)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:fd(c,{hour:Ya(a),minute:$a(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,p,d;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var x=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(x===Ye.ArrowDown||x===Ye.ArrowUp||x===Ye.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(x===Ye.ArrowDown||x===Ye.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',y=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);y instanceof HTMLElement&&y.focus({preventScroll:!0});return}var k=Lt(r.state.preSelection);x===Ye.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===hd?(r.handleSelect(k,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(k)):r.setOpen(!1)):x===Ye.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):x===Ye.Tab&&r.setOpen(!1),r.inputOk()||(d=(p=r.props).onInputError)===null||d===void 0||d.call(p,{code:1,msg:pd})}},r.onPortalKeyDown=function(a){var o=a.key;o===Ye.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,p,d,x=r.props,g=x.minDate,y=x.maxDate,k=x.disabledKeyboardNavigation,w=x.showWeekPicker,_=x.shouldCloseOnSelect,S=x.locale,P=x.calendarStartDay,T=x.adjustDateOnChange,z=x.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!k){var Z=a.key,L=a.shiftKey,C=Lt(r.state.preSelection),Q=function(ae,pe){var V=pe;switch(ae){case Ye.ArrowRight:V=w?Ou(pe,1):aa(pe,1);break;case Ye.ArrowLeft:V=w?Xg(pe):YF(pe);break;case Ye.ArrowUp:V=Xg(pe);break;case Ye.ArrowDown:V=Ou(pe,1);break;case Ye.PageUp:V=L?li(pe,1):no(pe,1);break;case Ye.PageDown:V=L?Ua(pe,1):sa(pe,1);break;case Ye.Home:V=Ts(pe,S,P);break;case Ye.End:V=dO(pe);break}return V},j=function(ae,pe){for(var V=40,se=ae,M=!1,H=0,O=Q(ae,pe);!M;){if(H>=V){O=pe;break}g&&O<g&&(se=Ye.ArrowRight,O=Wn(g,r.props)?Q(se,O):g),y&&O>y&&(se=Ye.ArrowLeft,O=Wn(y,r.props)?Q(se,O):y),Wn(O,r.props)?((se===Ye.PageUp||se===Ye.Home)&&(se=Ye.ArrowRight),(se===Ye.PageDown||se===Ye.End)&&(se=Ye.ArrowLeft),O=Q(se,O)):M=!0,H++}return O};if(Z===Ye.Enter){a.preventDefault(),r.handleSelect(C,a),!_&&r.setPreSelection(C);return}else if(Z===Ye.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:pd});return}var te=null;switch(Z){case Ye.ArrowLeft:case Ye.ArrowRight:case Ye.ArrowUp:case Ye.ArrowDown:case Ye.PageUp:case Ye.PageDown:case Ye.Home:case Ye.End:te=j(Z,C);break}if(!te){(d=(p=r.props).onInputError)===null||d===void 0||d.call(p,{code:1,msg:pd});return}if(a.preventDefault(),r.setState({lastPreSelectChange:hd}),T&&r.setSelected(te),r.setPreSelection(te),z){var X=on(C),U=on(te),ue=yt(C),le=yt(te);X!==U||ue!==le?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===Ye.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:be.createElement(VO,Ft({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:EO(r.modifyHolidays()),outsideClickIgnoreClass:wv,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,p=f?"PPPPp":"PPPP",d;return r.props.selectsRange?d="Selected start date: ".concat(zn(r.props.startDate,{dateFormat:p,locale:c}),". ").concat(r.props.endDate?"End date: "+zn(r.props.endDate,{dateFormat:p,locale:c}):""):r.props.showTimeSelectOnly?d="Selected time: ".concat(zn(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?d="Selected year: ".concat(zn(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?d="Selected month: ".concat(zn(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?d="Selected quarter: ".concat(zn(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):d="Selected date: ".concat(zn(r.props.selected,{dateFormat:p,locale:c})),be.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},d)},r.renderDateInput=function(){var a,o,l,c=Lr(r.props.className,(a={},a[wv]=r.state.open,a)),f=r.props.customInput||be.createElement("input",{type:"text"}),p=r.props.customInputRef||"ref",d=r.props,x=d.dateFormat,g=x===void 0?n.defaultProps.dateFormat:x,y=d.locale,k=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?lO(r.props.startDate,r.props.endDate,{dateFormat:g,locale:y}):r.props.selectsMultiple?cO((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:y}):zn(r.props.selected,{dateFormat:g,locale:y});return A.cloneElement(f,(o={},o[p]=function(w){r.input=w},o.value=k,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Lr(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,p=a.endDate,d=a.clearButtonTitle,x=a.clearButtonClassName,g=x===void 0?"":x,y=a.ariaLabelClose,k=y===void 0?"Close":y,w=a.selectedDates;return o&&(c!=null||f!=null||p!=null||w?.length)?be.createElement("button",{type:"button",className:Lr("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":k,onClick:r.onClearClick,title:d,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:zl,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&JO(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:pv(this.props.highlightDates)}),!r.focused&&!qs(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),be.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&be.createElement(KO,Ft({icon:a,className:Lr(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?be.createElement(cw,{enableTabLoop:this.props.enableTabLoop},be.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=be.createElement(lw,Ft({portalId:this.props.portalId},this.props),r)),be.createElement("div",null,this.renderInputContainer(),r)}return be.createElement(ZO,Ft({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(A.Component),eP="input",hd="navigate";const tP={lessThanXSeconds:{one:{regular:"mniej ni sekunda",past:"mniej ni sekund",future:"mniej ni sekund"},twoFour:"mniej ni {{count}} sekundy",other:"mniej ni {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekund",future:"sekund"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"p minuty",twoFour:"p minuty",other:"p minuty"},lessThanXMinutes:{one:{regular:"mniej ni minuta",past:"mniej ni minut",future:"mniej ni minut"},twoFour:"mniej ni {{count}} minuty",other:"mniej ni {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minut",future:"minut"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"okoo godziny",past:"okoo godziny",future:"okoo godzin"},twoFour:"okoo {{count}} godziny",other:"okoo {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzin",future:"godzin"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzie",past:"dzie",future:"1 dzie"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"okoo tygodnia",twoFour:"okoo {{count}} tygodni",other:"okoo {{count}} tygodni"},xWeeks:{one:"tydzie",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"okoo miesic",twoFour:"okoo {{count}} miesice",other:"okoo {{count}} miesicy"},xMonths:{one:"miesic",twoFour:"{{count}} miesice",other:"{{count}} miesicy"},aboutXYears:{one:"okoo rok",twoFour:"okoo {{count}} lata",other:"okoo {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function rP(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function md(e,n,t){const r=rP(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const nP=(e,n,t)=>{const r=tP[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+md(r,n,"future"):md(r,n,"past")+" temu":md(r,n,"regular")},aP={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},sP={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},oP={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},iP={date:ei({formats:aP,defaultWidth:"full"}),time:ei({formats:sP,defaultWidth:"full"}),dateTime:ei({formats:oP,defaultWidth:"full"})},lP={masculine:"ostatni",feminine:"ostatnia"},cP={masculine:"ten",feminine:"ta"},uP={masculine:"nastpny",feminine:"nastpna"},fP={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function kv(e,n,t,r){let a;if(BF(n,t,r))a=cP;else if(e==="lastWeek")a=lP;else if(e==="nextWeek")a=uP;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=fP[o];return`'${a[l]}' eeee 'o' p`}const dP={lastWeek:kv,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:kv,other:"P"},pP=(e,n,t,r)=>{const a=dP[e];return typeof a=="function"?a(e,n,t,r):a},hP={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed nasz er","naszej ery"]},mP={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwarta","II kwarta","III kwarta","IV kwarta"]},xP={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"]},gP={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrzenia","padziernika","listopada","grudnia"]},vP={narrow:["N","P","W","","C","P","S"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},yP={narrow:["n","p","w","","c","p","s"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},wP={narrow:{am:"a",pm:"p",midnight:"pn.",noon:"po",morning:"rano",afternoon:"popo.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"}},kP={narrow:{am:"a",pm:"p",midnight:"o pn.",noon:"w po.",morning:"rano",afternoon:"po po.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"}},_P=(e,n)=>String(e),bP={ordinalNumber:_P,era:va({values:hP,defaultWidth:"wide"}),quarter:va({values:mP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:va({values:xP,defaultWidth:"wide",formattingValues:gP,defaultFormattingWidth:"wide"}),day:va({values:vP,defaultWidth:"wide",formattingValues:yP,defaultFormattingWidth:"wide"}),dayPeriod:va({values:wP,defaultWidth:"wide",formattingValues:kP,defaultFormattingWidth:"wide"})},EP=/^(\d+)?/i,SP=/\d+/i,TP={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(|a)\s*er(|a)|naszej\s*ery)/i},CP={any:[/^p/i,/^n/i]},DP={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(|l)/i},NP={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},FP={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(|z)|lis|gru)/i,wide:/^(stycznia|stycze(|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(|n)|wrze(|s)nia|wrzesie(|n)|pa(|z)dziernika|pa(|z)dziernik|listopada|listopad|grudnia|grudzie(|n))/i},AP={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},OP={narrow:/^[npwcs]/i,short:/^(nie|pon|wto|(|s)ro|czw|pi(|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(|l)ek|wtorek|(|s)roda|czwartek|pi(|a)tek|sobota)/i},PP={narrow:[/^n/i,/^p/i,/^w/i,/^/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pi/i,/^so/i]},RP={narrow:/^(^a$|^p$|p(|l)n\.?|o\s*p(|l)n\.?|po(|l)\.?|w\s*po(|l)\.?|po\s*po(|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|p(|l)noc|o\s*p(|l)nocy|po(|l)udnie|w\s*po(|l)udnie|popo(|l)udnie|po\s*po(|l)udniu|rano|wieczr|wieczorem|noc|w\s*nocy)/i},MP={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i}},IP={ordinalNumber:Fy({matchPattern:EP,parsePattern:SP,valueCallback:e=>parseInt(e,10)}),era:ya({matchPatterns:TP,defaultMatchWidth:"wide",parsePatterns:CP,defaultParseWidth:"any"}),quarter:ya({matchPatterns:DP,defaultMatchWidth:"wide",parsePatterns:NP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ya({matchPatterns:FP,defaultMatchWidth:"wide",parsePatterns:AP,defaultParseWidth:"any"}),day:ya({matchPatterns:OP,defaultMatchWidth:"wide",parsePatterns:PP,defaultParseWidth:"any"}),dayPeriod:ya({matchPatterns:RP,defaultMatchWidth:"any",parsePatterns:MP,defaultParseWidth:"any"})},gi={code:"pl",formatDistance:nP,formatLong:iP,formatRelative:pP,localize:bP,match:IP,options:{weekStartsOn:1,firstWeekContainsDate:4}};xi("pl",gi);const xd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],jP=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],LP=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=A.useState(null),[o,l]=A.useState(""),[c,f]=A.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[p,d]=A.useState(""),[x,g]=A.useState(null),[y,k]=A.useState(null),w=A.useRef(null),_=A.useRef(null),[S,P]=A.useState(null),[T,z]=A.useState(null),Z=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},L=M=>{if(c.length>1){const H=[...c];H.splice(M,1),f(H)}},C=M=>{const H=[...c];H[M].showDataWaznosci=!H[M].showDataWaznosci,f(H)},Q=M=>{const H=M.target.files?.[0];console.log(" Product file selected:",H),H&&H.type==="application/pdf"?(g(H),console.log(" Product invoice set:",H.name)):console.log(" Invalid product file type:",H?.type)},j=M=>{const H=M.target.files?.[0];console.log(" Transport file selected:",H),H&&H.type==="application/pdf"?(k(H),console.log(" Transport invoice set:",H.name)):console.log(" Invalid transport file type:",H?.type)},te=()=>{w.current?.click()},X=()=>{_.current?.click()},U=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",p),console.log("productRows:",c),!r||!c.some(E=>E.kod&&E.nazwa&&E.ilosc&&E.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(E=>E.kod&&E.nazwa&&E.ilosc&&E.cena));return}const M=c.filter(E=>E.kod&&E.nazwa&&E.ilosc&&E.cena).map(E=>({kod:E.kod,nazwa:E.nazwa,kod_kreskowy:E.kod_kreskowy||"",ilosc:parseFloat(E.ilosc)||0,cena:parseFloat(E.cena.replace(",","."))||0,dataWaznosci:E.dataWaznosci?E.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:E.typ||void 0,objetosc:E.objetosc||void 0}));console.log("formattedProducts:",M);const H=M.reduce((E,I)=>E+I.ilosc*I.cena,0),O=parseFloat(p.replace(",","."))||0;console.log("totalValue:",H),console.log("deliveryCost:",O),console.log(" Files to submit:",{productInvoice:x,transportInvoice:y}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:H,kosztDostawy:O,products:M,productInvoice:x||null,transportInvoice:y||null}),ue()},ue=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),d(""),l(""),g(null),k(null),n()},le=()=>c.reduce((M,H)=>{const O=parseFloat(H.ilosc)||0,E=parseFloat(H.cena.replace(",","."))||0;return M+O*E},0).toFixed(2),ae=(M,H)=>{const O=[...c];O[M].typ=H,f(O),P(null)},pe=M=>{P(S===M?null:M)},V=M=>{z(T===M?null:M)},se=(M,H)=>{const O=[...c];O[M].objetosc=H,f(O),z(null)};return A.useEffect(()=>{const M=O=>{const E=O.target;if(!E.closest(".react-datepicker")&&!E.closest('button[title*="wanoci"]')){const I=[...c];let R=!1;I.forEach(W=>{W.showDataWaznosci&&(W.showDataWaznosci=!1,R=!0)}),R&&f(I)}S!==null&&(E.closest(".dropdown-container")||P(null)),T!==null&&(E.closest(".dropdown-container")||z(null))},H=O=>{O.key==="Escape"&&(P(null),z(null))};return document.addEventListener("mousedown",M),document.addEventListener("keydown",H),()=>{document.removeEventListener("mousedown",M),document.removeEventListener("keydown",H)}},[S,T,c]),h.jsx(Pr,{isOpen:e,onRequestClose:ue,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),h.jsx("button",{onClick:ue,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),h.jsx(As,{selected:r,onChange:M=>a(M),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),h.jsx("div",{className:"w-[200px] flex items-start",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),h.jsx("div",{className:"relative",children:h.jsx("input",{type:"text",value:p,onKeyPress:M=>{const H=String.fromCharCode(M.which);(!/[\d,]/.test(H)||H===","&&M.target.value.includes(",")||M.target.value===""&&H===",")&&M.preventDefault()},onChange:M=>{const H=M.target,O=H.selectionStart??0;let E=H.value.replace(/[^\d,]/g,"");if(E===""){d("");return}if(!E.includes(","))E=E+",00";else{const[R,W]=E.split(",");W&&W.length>2&&(E=`${R},${W.slice(0,2)}`)}d(E),requestAnimationFrame(()=>{const R=Math.min(O,E.length);H.setSelectionRange(R,R)})},className:"w-[70%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]})}),h.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:Q,className:"hidden",ref:w}),h.jsx("button",{type:"button",onClick:te,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:h.jsx(Zd,{className:"h-4 w-4 text-gray-500"})}),x&&h.jsx("a",{href:URL.createObjectURL(x),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:x.name,children:x.name})]}),h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:j,className:"hidden",ref:_}),h.jsx("button",{type:"button",onClick:X,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:h.jsx(Qd,{className:"h-4 w-4 text-gray-500"})}),y&&h.jsx("a",{href:URL.createObjectURL(y),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:y.name,children:y.name})]})]})]})}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),h.jsx("input",{type:"text",value:o,onChange:M=>l(M.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})}),h.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((M,H)=>h.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[h.jsxs("div",{className:"col-span-1.5 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Kod"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:M.kod,onChange:O=>{const E=[...c];E[H].kod=O.target.value,f(E)}}),H===c.length-1&&h.jsx("button",{onClick:Z,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:h.jsx(Js,{size:16})})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Nazwa"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:M.nazwa,onChange:O=>{const E=[...c];E[H].nazwa=O.target.value,f(E)}})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Kod kreskowy"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:M.kod_kreskowy,onChange:O=>{const E=[...c];E[H].kod_kreskowy=O.target.value,f(E)}})]}),h.jsxs("div",{className:"col-span-1.5",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Ilo"}),h.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:M.ilosc,onChange:O=>{const E=[...c],I=O.target.value;(I===""||/^\d*$/.test(I))&&(E[H].ilosc=I,f(E))}})]}),h.jsxs("div",{className:"col-span-2.9 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Cena"}),h.jsx("div",{className:"relative",children:h.jsx("input",{type:"text",value:M.cena,onKeyPress:O=>{const E=String.fromCharCode(O.which);(!/[\d,]/.test(E)||E===","&&O.target.value.includes(",")||O.target.value===""&&E===",")&&O.preventDefault()},onChange:O=>{const E=O.target,I=E.selectionStart??0;let R=O.target.value.replace(/[^\d,]/g,"");if(R===""){const de=[...c];de[H].cena="",f(de);return}if(!R.includes(","))R=R+",00";else{const[de,he]=R.split(",");he&&he.length>2&&(R=`${de},${he.slice(0,2)}`)}const ie=[...c];ie[H].cena=R,f(ie),requestAnimationFrame(()=>{const de=Math.min(I,R.length);E.setSelectionRange(de,de)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),h.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Warto"}),h.jsx("div",{className:"relative flex items-center",children:h.jsx("input",{type:"text",value:(()=>{const O=parseFloat(M.ilosc)||0,E=parseFloat(M.cena.replace(",","."))||0;return(O*E).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),h.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[h.jsx("button",{type:"button",onClick:()=>C(H),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${M.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:M.dataWaznosci?`Termin wanoci: ${M.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:h.jsx(Xd,{size:16})}),h.jsx("button",{onClick:()=>L(H),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:h.jsx(Yt,{size:16})})]}),M.showDataWaznosci&&h.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:h.jsx(As,{selected:M.dataWaznosci,onChange:O=>{const E=[...c];E[H].dataWaznosci=O,E[H].showDataWaznosci=!1,f(E)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const O=[...c];O[H].showDataWaznosci=!1,f(O)}})}),h.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Typ"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>pe(H),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${M.typ&&xd.find(O=>O.value===M.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate",children:M.typ&&xd.find(O=>O.value===M.typ)?.label||"Wybierz typ"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),S===H&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:O=>O.stopPropagation(),children:xd.map(O=>h.jsx("button",{type:"button",onClick:()=>ae(H,O.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${O.color}`,children:O.label},O.value))})]})]}),h.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${H>0?"invisible":""}`,children:"Objto"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>V(H),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${M.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[h.jsx("span",{className:"truncate",children:M.objetosc||"Wybierz"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T===H&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:O=>O.stopPropagation(),style:{maxWidth:"200px"},children:jP.map(O=>h.jsx("button",{type:"button",onClick:()=>se(H,O.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:O.label},O.value))})]})]})]},H))})]}),h.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[h.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),h.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[le().replace(".",",")," "]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(M=>M.kod&&M.nazwa&&M.ilosc&&M.cena)}),U()},disabled:!r||!c.some(M=>M.kod&&M.nazwa&&M.ilosc&&M.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(M=>M.kod&&M.nazwa&&M.ilosc&&M.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},zP=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilo"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilo"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsx("tr",{children:o.map((c,f)=>h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>h.jsx("tr",{children:c.map((p,d)=>h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:p},d))},f))})]})})},BP=({onSearch:e})=>{const[n,t]=A.useState(""),[r,a]=A.useState([]),[o,l]=A.useState(!1);return A.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),h.jsxs("div",{className:"w-full relative",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-5 w-5 text-gray-400"})}),h.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktw...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?h.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:h.jsxs("div",{className:"text-center py-4",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),h.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"adowanie..."})]})}):r.length>0?h.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:h.jsxs("table",{className:"w-full table-fixed",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),h.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),h.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilo"}),h.jsx("th",{className:"w-[35%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod kreskowy"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc}),h.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kodKreskowy,children:c.kodKreskowy})]},f))})]})}):n?h.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:h.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynik"})}):null]})};let WP={data:""},UP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||WP,HP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,YP=/\/\*[^]*?\*\/|  +/g,_v=/\n+/g,ws=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?ws(l,o):o+"{"+ws(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=ws(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=ws.p?ws.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},La={},uw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+uw(e[t]);return n}return e},$P=(e,n,t,r,a)=>{let o=uw(e),l=La[o]||(La[o]=(f=>{let p=0,d=11;for(;p<f.length;)d=101*d+f.charCodeAt(p++)>>>0;return"go"+d})(o));if(!La[l]){let f=o!==e?e:(p=>{let d,x,g=[{}];for(;d=HP.exec(p.replace(YP,""));)d[4]?g.shift():d[3]?(x=d[3].replace(_v," ").trim(),g.unshift(g[0][x]=g[0][x]||{})):g[0][d[1]]=d[2].replace(_v," ").trim();return g[0]})(e);La[l]=ws(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&La.g?La.g:null;return t&&(La.g=La[l]),((f,p,d,x)=>{x?p.data=p.data.replace(x,f):p.data.indexOf(f)===-1&&(p.data=d?f+p.data:p.data+f)})(La[l],n,r,c),l},VP=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":ws(c,""):c===!1?"":c}return r+a+(l??"")},"");function of(e){let n=this||{},t=e.call?e(n.p):e;return $P(t.unshift?t.raw?VP(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,UP(n.target),n.g,n.o,n.k)}let fw,Yd,$d;of.bind({g:1});let Ga=of.bind({k:1});function KP(e,n,t,r){ws.p=n,fw=e,Yd=t,$d=r}function Ps(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Yd&&Yd()},c),t.o=/ *go\d+/.test(f),c.className=of.apply(t,r)+(f?" "+f:"");let p=e;return e[0]&&(p=c.as||e,delete c.as),$d&&p[0]&&$d(c),fw(p,c)}return a}}var GP=e=>typeof e=="function",Yu=(e,n)=>GP(e)?e(n):e,XP=(()=>{let e=0;return()=>(++e).toString()})(),dw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),QP=20,pw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,QP)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return pw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},yu=[],Zs={toasts:[],pausedAt:void 0},ko=e=>{Zs=pw(Zs,e),yu.forEach(n=>{n(Zs)})},qP={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ZP=(e={})=>{let[n,t]=A.useState(Zs),r=A.useRef(Zs);A.useEffect(()=>(r.current!==Zs&&t(Zs),yu.push(t),()=>{let o=yu.indexOf(t);o>-1&&yu.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||qP[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},JP=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||XP()}),Wl=e=>(n,t)=>{let r=JP(n,e,t);return ko({type:2,toast:r}),r.id},an=(e,n)=>Wl("blank")(e,n);an.error=Wl("error");an.success=Wl("success");an.loading=Wl("loading");an.custom=Wl("custom");an.dismiss=e=>{ko({type:3,toastId:e})};an.remove=e=>ko({type:4,toastId:e});an.promise=(e,n,t)=>{let r=an.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?Yu(n.success,a):void 0;return o?an.success(o,{id:r,...t,...t?.success}):an.dismiss(r),a}).catch(a=>{let o=n.error?Yu(n.error,a):void 0;o?an.error(o,{id:r,...t,...t?.error}):an.dismiss(r)}),e};var eR=(e,n)=>{ko({type:1,toast:{id:e,height:n}})},tR=()=>{ko({type:5,time:Date.now()})},gl=new Map,rR=1e3,nR=(e,n=rR)=>{if(gl.has(e))return;let t=setTimeout(()=>{gl.delete(e),ko({type:4,toastId:e})},n);gl.set(e,t)},aR=e=>{let{toasts:n,pausedAt:t}=ZP(e);A.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&an.dismiss(c.id);return}return setTimeout(()=>an.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=A.useCallback(()=>{t&&ko({type:6,time:Date.now()})},[t]),a=A.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:p}=l||{},d=n.filter(y=>(y.position||p)===(o.position||p)&&y.height),x=d.findIndex(y=>y.id===o.id),g=d.filter((y,k)=>k<x&&y.visible).length;return d.filter(y=>y.visible).slice(...c?[g+1]:[0,g]).reduce((y,k)=>y+(k.height||0)+f,0)},[n]);return A.useEffect(()=>{n.forEach(o=>{if(o.dismissed)nR(o.id,o.removeDelay);else{let l=gl.get(o.id);l&&(clearTimeout(l),gl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:eR,startPause:tR,endPause:r,calculateOffset:a}}},sR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,oR=Ga`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iR=Ga`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,lR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${sR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${oR} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${iR} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,cR=Ga`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,uR=Ps("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${cR} 1s linear infinite;
`,fR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,dR=Ga`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,pR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${fR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${dR} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,hR=Ps("div")`
  position: absolute;
`,mR=Ps("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,xR=Ga`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gR=Ps("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${xR} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,vR=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?A.createElement(gR,null,n):n:t==="blank"?null:A.createElement(mR,null,A.createElement(uR,{...r}),t!=="loading"&&A.createElement(hR,null,t==="error"?A.createElement(lR,{...r}):A.createElement(pR,{...r})))},yR=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,wR=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,kR="0%{opacity:0;} 100%{opacity:1;}",_R="0%{opacity:1;} 100%{opacity:0;}",bR=Ps("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ER=Ps("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,SR=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=dw()?[kR,_R]:[yR(t),wR(t)];return{animation:n?`${Ga(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ga(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},TR=A.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?SR(e.position||n||"top-center",e.visible):{opacity:0},o=A.createElement(vR,{toast:e}),l=A.createElement(ER,{...e.ariaProps},Yu(e.message,e));return A.createElement(bR,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):A.createElement(A.Fragment,null,o,l))});KP(A.createElement);var CR=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=A.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return A.createElement("div",{ref:o,className:n,style:t},a)},DR=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:dw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},NR=of`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,du=16,FR=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=aR(t);return A.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:du,left:du,right:du,bottom:du,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(p=>{let d=p.position||n,x=f.calculateOffset(p,{reverseOrder:e,gutter:r,defaultPosition:n}),g=DR(d,x);return A.createElement(CR,{id:p.id,key:p.id,onHeightUpdate:f.updateHeight,className:p.visible?NR:"",style:g},p.type==="custom"?Yu(p.message,p):a?a(p):A.createElement(TR,{toast:p,position:d}))}))},at=an;xi("pl",gi);const AR=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log(" OrderModal render - isOpen:",e);const[r,a]=A.useState(null),[o,l]=A.useState(""),[c,f]=A.useState(""),[p,d]=A.useState([]),[x,g]=A.useState(null),[y,k]=A.useState(!1),[w,_]=A.useState([]),[S,P]=A.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[T,z]=A.useState(null),[Z,L]=A.useState(!1),[C,Q]=A.useState(!1),[j,te]=A.useState(null),[X,U]=A.useState(new Set),ue=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],le=()=>{const E=Math.max(...S.map(I=>I.id))+1;P([...S,{id:E,searchQuery:"",selectedProduct:null,typ:""}])},ae=E=>{S.length>1&&P(I=>I.filter(R=>R.id!==E))},pe=()=>{console.log(" OrderModal handleClose called"),a(null),l(""),f(""),d([]),g(null),_([]),P([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),z(null),L(!1),Q(!1),te(null),U(new Set),n()};A.useEffect(()=>{e&&(console.log(" OrderModal opened - clearing state"),a(null),l(""),f(""),d([]),g(null),_([]),P([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),z(null),L(!1),Q(!1),te(null),U(new Set))},[e]),A.useEffect(()=>{const I=setTimeout(async()=>{if(c.trim().length<2){d([]);return}k(!0);try{const R=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!R.ok)throw new Error("Failed to fetch clients");const W=await R.json();d(W)}catch(R){console.error("Error searching clients:",R),d([])}finally{k(!1)}},300);return()=>clearTimeout(I)},[c]),A.useEffect(()=>{const I=setTimeout(async()=>{if(T===null||!S.find(R=>R.id===T)?.searchQuery.trim()){_([]);return}L(!0);try{const R=S.find(he=>he.id===T)?.searchQuery||"",W=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(R)}`);if(!W.ok)throw new Error("Failed to fetch products");const de=(await W.json()).map(he=>({kod:he.kod,nazwa:he.nazwa,ilosc:he.ilosc.toString(),kodKreskowy:he.kod_kreskowy||"",selectedQuantity:0}));_(de)}catch(R){console.error("Error searching products:",R),_([])}finally{L(!1)}},300);return()=>clearTimeout(I)},[S,T]),A.useEffect(()=>{const E=R=>{const W=R.target;j!==null&&(W.closest(".dropdown-container")||te(null))},I=R=>{R.key==="Escape"&&te(null)};return j!==null&&(document.addEventListener("mousedown",E),document.addEventListener("keydown",I)),()=>{document.removeEventListener("mousedown",E),document.removeEventListener("keydown",I)}},[j]);const V=(E,I)=>{console.log(" handleProductSelect called for fieldId:",E,"product:",I.kod),P(R=>R.map(ie=>ie.id===E?{...ie,selectedProduct:I,searchQuery:`${I.kod} - ${I.nazwa}`}:ie)),_([]),z(null),console.log(" Products list cleared, activeSearchId reset")},se=E=>{te(j===E?null:E)},M=(E,I)=>{P(R=>R.map(W=>W.id===E?{...W,typ:I}:W)),te(null)},H=()=>S.filter(E=>E.selectedProduct).reduce((E,I)=>{const R=I.selectedProduct?.selectedQuantity||0;return E+R},0),O=async()=>{const E=S.filter(he=>he.selectedProduct).map(he=>({kod:he.selectedProduct.kod,nazwa:he.selectedProduct.nazwa,ilosc:he.selectedProduct.selectedQuantity||0,typ:he.typ,kod_kreskowy:he.selectedProduct.kodKreskowy}));if(!r){at.error("Wybierz dat zamwienia");return}if(!o.trim()){at.error("Wprowad numer zamwienia");return}if(!x){at.error("Wybierz klienta");return}if(E.length===0){at.error("Dodaj produkty");return}if(E.some(he=>!he.ilosc)){at.error("Wprowad ilo dla wszystkich produktw");return}if(E.some(he=>!he.typ)){at.error("Wybierz typ dla wszystkich produktw");return}const I=new Set;for(let he=0;he<S.length;he++){const oe=S[he];if(oe.selectedProduct){const ee=oe.selectedProduct.selectedQuantity||0,re=parseInt(oe.selectedProduct.ilosc)||0;ee>re&&I.add(oe.id)}}if(I.size>0){U(I);return}else U(new Set);const R=r.getDate().toString().padStart(2,"0"),W=(r.getMonth()+1).toString().padStart(2,"0"),ie=r.getFullYear(),de=`${o.trim()}_${R}_${W}_${ie}`;Q(!0);try{const he=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:x.nazwa,order_number:de,products:E})});if(!he.ok){const oe=await he.json();if(he.status===400&&oe.error.includes("Insufficient quantity")){const ee=oe.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(ee){const[,re,F,Ce]=ee;at.error(`Niewystarczajca ilo produktu ${re}. Dostpne: ${F}, Zamwione: ${Ce}`)}else at.error(oe.error)}else throw new Error("Failed to create order");return}at.success("Zamwienie zostao dodane"),pe(),t&&t()}catch(he){console.error("Error creating order:",he),at.error("Wystpi bd podczas dodawania zamwienia")}finally{Q(!1)}};return h.jsx(Pr,{isOpen:e,onRequestClose:pe,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamwienia"}),h.jsx("button",{onClick:pe,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),h.jsx(As,{selected:r,onChange:E=>a(E),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),h.jsxs("div",{className:"w-[180px] ml-4",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),h.jsx("input",{type:"text",value:o,onChange:E=>l(E.target.value),placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),h.jsxs("div",{className:"relative",children:[h.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",id:"client-search",value:c,onChange:E=>f(E.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),y&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),p.length>0&&!x&&h.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:p.map(E=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(E),f(E.nazwa),d([])},children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:E.nazwa}),h.jsx("span",{className:"text-[10px] text-gray-500",children:E.firma})]})},E.id))})]}),x&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.nazwa})]}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.firma})]}),x.adres&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.adres})]}),x.kontakt&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),h.jsx("p",{className:"text-xs text-gray-900",children:x.kontakt})]})]}),h.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:h.jsx(Yt,{size:16})})]})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),S.map(E=>h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",value:E.searchQuery,onChange:I=>{const R=I.target.value;console.log(" Product search input changed for fieldId:",E.id,"value:",R),P(W=>W.map(ie=>ie.id===E.id?{...ie,searchQuery:R,selectedProduct:null}:ie)),z(E.id)},onFocus:()=>z(E.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsx("div",{className:"w-16 ml-2",children:h.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:E.selectedProduct?.selectedQuantity||"",onChange:I=>{const R=I.target.value,W=R===""?0:Math.max(1,parseInt(R)||0);if(P(ie=>ie.map(de=>de.id===E.id&&de.selectedProduct?{...de,selectedProduct:{...de.selectedProduct,selectedQuantity:W}}:de)),X.has(E.id)){const ie=new Set(X);ie.delete(E.id),U(ie)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${X.has(E.id)?"border-red-500":"border-gray-300"}`})}),h.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[h.jsxs("button",{type:"button",onClick:()=>se(E.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${E.typ&&ue.find(I=>I.value===E.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate text-[10px]",children:E.typ&&ue.find(I=>I.value===E.typ)?.label||"Typ"}),h.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),j===E.id&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:I=>I.stopPropagation(),children:ue.map(I=>h.jsx("button",{type:"button",onClick:()=>M(E.id,I.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${I.color}`,children:I.label},I.value))})]}),S.length>1&&h.jsx("button",{onClick:()=>ae(E.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:h.jsx(Yt,{size:16})})]}),E.id===Math.max(...S.map(I=>I.id))&&h.jsx("button",{onClick:le,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:h.jsx(Js,{size:16})}),Z&&T===E.id&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),w.length>0&&T===E.id&&!E.selectedProduct&&E.searchQuery.trim()&&h.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:w.map(I=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>V(E.id,{...I,selectedQuantity:0}),children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:I.kod}),h.jsx("span",{className:"text-[10px] text-gray-500",children:I.nazwa}),h.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",I.ilosc]})]})},I.kod))})]},E.id))]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:O,disabled:C,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${C?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:C?h.jsxs("div",{className:"flex items-center justify-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),h.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",h.jsx("span",{className:"font-semibold text-gray-900",children:H()})]})]})})},OR=({isOpen:e,onClose:n,order:t})=>{const[r,a]=A.useState(null),[o,l]=A.useState(null),[c,f]=A.useState(!1),p=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}];A.useEffect(()=>{e&&t&&(d(),x())},[e,t]);const d=async()=>{if(t){f(!0);try{const w=await fetch(`/api/orders/${t.id}`);if(!w.ok)throw new Error("Failed to load order details");const _=await w.json();a(_)}catch(w){console.error("Error loading order details:",w)}finally{f(!1)}}},x=async()=>{if(t)try{const w=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(w.ok){const _=await w.json();l(_)}}catch(w){console.error("Error loading client data:",w)}},g=w=>new Date(w).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const y=r||t,k=async()=>{if(!(!t||!y))try{const w=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!w.ok)throw new Error("Failed to generate PDF");const _=await w.blob(),S=window.URL.createObjectURL(_),P=document.createElement("a");P.href=S;const T=o?o.nazwa:y.klient,z=`${T}_${y.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",T),console.log("Order number:",y.numer_zamowienia),console.log("Generated filename:",z),P.download=z,document.body.appendChild(P),P.click(),window.URL.revokeObjectURL(S),document.body.removeChild(P)}catch(w){console.error("Error generating PDF:",w),alert("Bd podczas generowania PDF")}};return h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy zamwienia"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?h.jsx("div",{className:"flex justify-center items-center py-8",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:h.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-700",children:"Numer zamwienia:"}),h.jsx("p",{className:"text-sm font-bold text-gray-900",children:y.numer_zamowienia})]}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),h.jsx("p",{className:"text-gray-900",children:g(y.data_utworzenia||"")})]})]})}),o&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),h.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Produkty w zamwieniu"}),y.products&&y.products.length>0?h.jsx("div",{children:h.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Typ"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.products.map(w=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:w.kod}),h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:h.jsx("div",{className:"break-words leading-tight",children:w.nazwa})}),h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:w.kod_kreskowy||"-"}),h.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:w.ilosc}),h.jsx("td",{className:"px-4 py-2 text-xs w-20",children:w.typ?h.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${p.find(_=>_.value===w.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:p.find(_=>_.value===w.typ)?.label||w.typ}):h.jsx("span",{className:"text-gray-500",children:"-"})})]},w.id))})]})}):h.jsx("p",{className:"text-xs text-gray-500",children:"Brak produktw w zamwieniu"})]})]})}),h.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",h.jsx("span",{className:"font-semibold text-gray-900",children:y.laczna_ilosc})]}),h.jsx("div",{className:"absolute bottom-4 left-4",children:h.jsx("button",{onClick:k,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};xi("pl",gi);const gd=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],PR=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=A.useState(""),[l,c]=A.useState(""),[f,p]=A.useState(null),[d,x]=A.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),[g,y]=A.useState(null),[k,w]=A.useState(""),[_,S]=A.useState([]),[P,T]=A.useState(!1),[z,Z]=A.useState(null),[L,C]=A.useState([]),[Q,j]=A.useState(!1),[te,X]=A.useState(null),[U,ue]=A.useState(new Set),le=async I=>{try{const R=I.map(he=>he.kod).filter(he=>he.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",R),R.length===0)return;const W=await fetch("/api/working-sheets");if(!W.ok)throw new Error("Failed to fetch working sheets");const ie=await W.json();console.log("All working sheets products:",ie);const de=R.map(he=>{const oe=ie.find(ee=>ee.kod===he);return console.log(`Found product for ${he}:`,oe),oe}).filter(he=>he!==void 0);console.log("Found products for order:",de),S(de),console.log(" Final loaded products info for order editing:",de)}catch(R){console.error(" Error loading products info:",R)}};A.useEffect(()=>{if(e&&r){if(o(r.klient),w(r.klient),X({nazwa:r.klient}),c(r.numer_zamowienia),r.data_utworzenia){const I=new Date(r.data_utworzenia);p(I),console.log(" Loaded order date:",I)}else p(null);if(r.products&&r.products.length>0){console.log("Order products from backend:",r.products);const I=r.products.map(R=>({kod:R.kod||"",nazwa:R.nazwa||"",kod_kreskowy:R.kod_kreskowy||"",ilosc:(R.ilosc||0).toString(),typ:R.typ||""}));console.log("Formatted products:",I),x(I),console.log(" About to load products info for:",I),le(I)}else x([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])}},[e,r]),A.useEffect(()=>{const R=setTimeout(async()=>{if(z===null||!d.find((W,ie)=>ie===z)?.nazwa.trim()){S([]);return}T(!0);try{const W=d.find((he,oe)=>oe===z)?.nazwa||"",ie=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(W)}`);if(!ie.ok)throw new Error("Failed to fetch products");const de=await ie.json();S(de)}catch(W){console.error("Error searching products:",W),S([])}finally{T(!1)}},300);return()=>clearTimeout(R)},[d,z]),A.useEffect(()=>{const R=setTimeout(async()=>{if(k.trim().length<2){C([]);return}j(!0);try{const W=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!W.ok)throw new Error("Failed to fetch clients");const ie=await W.json();C(ie)}catch(W){console.error("Error searching clients:",W),C([])}finally{j(!1)}},300);return()=>clearTimeout(R)},[k]),A.useEffect(()=>{const I=W=>{const ie=W.target;g!==null&&(ie.closest(".dropdown-container")||y(null))},R=W=>{W.key==="Escape"&&y(null)};return g!==null&&(document.addEventListener("mousedown",I),document.addEventListener("keydown",R)),()=>{document.removeEventListener("mousedown",I),document.removeEventListener("keydown",R)}},[g]);const ae=()=>{x([...d,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}])},pe=I=>{d.length>1&&x(d.filter((R,W)=>W!==I))},V=(I,R)=>{const W=[...d];W[I].typ=R,x(W),y(null)},se=I=>{y(g===I?null:I)},M=(I,R)=>{console.log(" EditOrderModal handleProductSelect called for index:",I,"product:",R.kod);const W=[...d];W[I]={...W[I],kod:R.kod,nazwa:R.nazwa,kod_kreskowy:R.kod_kreskowy||"",typ:R.typ||"sztuki"},x(W);const ie=[..._],de=ie.findIndex(he=>he.kod===R.kod);de>=0?ie[de]=R:ie.push(R),S(ie),Z(null),console.log(" EditOrderModal Products list cleared, activeSearchId reset")},H=async(I,R)=>{const W=new Set;for(let ie=0;ie<I.length;ie++){const de=I[ie],he=parseInt(de.ilosc)||0,oe=d.findIndex(He=>He.kod===de.kod&&He.nazwa===de.nazwa&&He.ilosc===de.ilosc);if(oe===-1){console.warn(` Could not find actual index for product ${de.kod}`);continue}const re=R.find(He=>He.kod===de.kod)?.ilosc||0,F=r?.products?.find(He=>He.kod===de.kod),Ce=F&&F.ilosc||0;let De;he>Ce?(De=he-Ce,console.log(` Increasing order: ${Ce}  ${he}, need additional: ${De}`)):(De=he,console.log(` Decreasing order: ${Ce}  ${he}, checking total available`));const Ve=re+(he<=Ce?Ce:0);console.log(`Product ${oe} (valid index ${ie}):`,{kod:de.kod,requested:he,availableOnStock:re,reservedInOrder:Ce,requiredFromStock:De,totalAvailable:Ve,hasError:De>Ve}),De>Ve&&(W.add(oe),console.log(` Error for product ${oe}: required ${De} > available ${Ve}`))}return W},O=async I=>{if(I.preventDefault(),!r)return;if(!a.trim()){at.error("Wprowad nazw klienta");return}if(!l.trim()){at.error("Wprowad numer zamwienia");return}const R=d.filter(de=>de.kod.trim()&&de.nazwa.trim()&&de.ilosc.trim()&&de.typ.trim());if(R.length===0){at.error("Dodaj produkty do zamwienia");return}if(R.some(de=>!de.ilosc||!de.typ)){at.error("Wprowad ilo i typ dla wszystkich produktw");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",R),console.log("products (stock info):",_),console.log("products.length:",_.length),_.length===0){console.log(" Products info is empty, reloading...");try{const de=await fetch("/api/working-sheets");if(de.ok){const he=await de.json();console.log("Reloaded all products:",he),S(he);const oe=await H(R,he);if(oe.size>0){ue(oe);return}else ue(new Set);console.log(" Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),at.error("Bd podczas adowania informacji o produktach");return}}catch(de){console.error("Error reloading products:",de),at.error("Bd podczas adowania informacji o produktach");return}}const W=await H(R,_);if(W.size>0){ue(W);return}else ue(new Set);const ie=R.map(de=>({kod:de.kod,kod_kreskowy:de.kod_kreskowy,nazwa:de.nazwa,ilosc:parseInt(de.ilosc)||0,typ:de.typ}));console.log("Sending products data:",ie);try{const de=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:ie})});if(!de.ok){const he=await de.json();throw new Error(he.error||"Failed to update order")}at.success("Zamwienie zostao zaktualizowane"),E(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:ie})}catch(de){console.error("Error updating order:",de),at.error("Wystpi bd podczas aktualizacji zamwienia")}},E=()=>{o(""),w(""),X(null),C([]),c(""),p(null),x([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),y(null),S([]),Z(null),n()};return r?h.jsx(Pr,{isOpen:e,onRequestClose:E,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj zamwienie"}),h.jsx("button",{onClick:E,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsxs("form",{onSubmit:O,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex space-x-4",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),h.jsx(As,{selected:f,onChange:I=>p(I),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),h.jsx("input",{type:"text",value:l,onChange:I=>c(I.target.value),placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",value:k,onChange:I=>w(I.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),Q&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),L.length>0&&!te&&h.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:L.map(I=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{X(I),w(I.nazwa),o(I.nazwa),C([])},children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:I.nazwa}),h.jsx("span",{className:"text-[10px] text-gray-500",children:I.firma})]})},I.id))})]}),te&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),h.jsx("p",{className:"text-xs text-gray-900",children:te.nazwa})]}),te.firma&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),h.jsx("p",{className:"text-xs text-gray-900",children:te.firma})]}),te.adres&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),h.jsx("p",{className:"text-xs text-gray-900",children:te.adres})]}),te.kontakt&&h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),h.jsx("p",{className:"text-xs text-gray-900",children:te.kontakt})]})]}),h.jsx("button",{onClick:()=>{X(null),w(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:h.jsx(Yt,{size:16})})]})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),d.map((I,R)=>h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:h.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),h.jsx("input",{type:"text",value:I.nazwa,onChange:W=>{const ie=W.target.value;console.log(" EditOrderModal Product search input changed for index:",R,"value:",ie);const de=[...d];de[R].nazwa=ie,x(de),Z(R)},onFocus:()=>Z(R),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsx("div",{className:"w-16 ml-2",children:h.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:I.ilosc,onChange:W=>{const ie=[...d];if(ie[R].ilosc=W.target.value,x(ie),U.has(R)){const de=new Set(U);de.delete(R),ue(de)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${U.has(R)?"border-red-500":"border-gray-300"}`})}),h.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[h.jsxs("button",{type:"button",onClick:()=>se(R),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${I.typ&&gd.find(W=>W.value===I.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate text-[10px]",children:I.typ&&gd.find(W=>W.value===I.typ)?.label||"Typ"}),h.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g===R&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:W=>W.stopPropagation(),children:gd.map(W=>h.jsx("button",{type:"button",onClick:()=>V(R,W.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${W.color}`,children:W.label},W.value))})]}),d.length>1&&h.jsx("button",{onClick:()=>pe(R),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:h.jsx(Yt,{size:16})})]}),R===d.length-1&&h.jsx("button",{onClick:ae,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:h.jsx(Js,{size:16})}),P&&z===R&&h.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),_.length>0&&z===R&&I.nazwa.trim()&&h.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:_.map(W=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>M(R,W),children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-[10px]",children:W.kod}),h.jsx("span",{className:"text-[10px] text-gray-500",children:W.nazwa}),h.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",W.ilosc]})]})},W.kod))})]},R))]})]}),h.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[h.jsx("button",{type:"button",onClick:E,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),h.jsx("button",{onClick:O,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null},RR=({onViewOrder:e,onEditOrder:n,onDeleteOrder:t,onUpdateOrder:r,refreshTrigger:a})=>{const[o,l]=A.useState([]),[c,f]=A.useState(!0),[p,d]=A.useState(null),[x,g]=A.useState(null),[y,k]=A.useState(!1),[w,_]=A.useState(!1),[S,P]=A.useState(null),[T,z]=A.useState(!1),[Z,L]=A.useState(null),[C,Q]=A.useState(""),[j,te]=A.useState("data_utworzenia"),[X,U]=A.useState("desc"),[ue,le]=A.useState(""),[ae,pe]=A.useState(""),V=async()=>{try{console.log(" Starting to load orders..."),f(!0),d(null),console.log(" Fetching from /api/orders-with-products...");const re=await fetch("/api/orders-with-products");if(console.log(" Response status:",re.status),console.log(" Response ok:",re.ok),!re.ok)throw new Error(`HTTP error! status: ${re.status}`);const F=await re.json();console.log(" Raw data received:",F),console.log(" Raw data length:",F.length);const Ce=F.map(De=>({id:De.id,klient:De.klient,numer_zamowienia:De.numer_zamowienia,data_utworzenia:De.data_utworzenia,laczna_ilosc:De.laczna_ilosc,typ:De.typ||"zamowienie",numer_zwrotu:De.numer_zwrotu||null,products:De.products||[]}));console.log(" Transformed orders:",Ce),console.log(" Orders count:",Ce.length),l(Ce)}catch(re){console.error(" Error loading orders:",re),d("Failed to load orders")}finally{f(!1)}};A.useEffect(()=>{V()},[]),A.useEffect(()=>{a&&V()},[a]);const se=re=>new Date(re).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),M=re=>{g(re),k(!0)},H=re=>{P(re),_(!0)},O=async re=>{if(console.log("OrdersList handleEditSubmit called with data:",re),r)r(re);else try{console.log("Sending PUT request to update order:",re);const F=await fetch(`/api/orders/${re.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(re)});if(!F.ok)throw new Error(`HTTP error! status: ${F.status}`);at.success("Zamwienie zostao zaktualizowane"),V()}catch(F){console.error("Error updating order:",F),at.error("Bd podczas aktualizacji zamwienia")}},E=re=>{L(re),z(!0),Q("")},I=async()=>{if(C==="5202"){if(Z?.id)try{t&&t(Z.id);const re=await fetch(`/api/orders/${Z.id}`,{method:"DELETE"});if(!re.ok)throw new Error(`HTTP error! status: ${re.status}`);const F=await re.json();console.log("Order deleted:",F),at.success("Zamwienie zostao usunite"),V()}catch(re){console.error("Error deleting order:",re),at.error("Bd podczas usuwania zamwienia")}R()}else at.error("Nieprawidowe haso"),Q("")},R=()=>{z(!1),L(null),Q("")},W=re=>{re.key==="Enter"&&I()},ie=re=>{j===re?U(X==="asc"?"desc":"asc"):(te(re),U("asc"))},de=Array.from(new Set(o.map(re=>new Date(re.data_utworzenia).getFullYear().toString()))).sort((re,F)=>parseInt(F)-parseInt(re)),he=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],ee=o.filter(re=>!(ue&&new Date(re.data_utworzenia).getFullYear().toString()!==ue||ae&&(new Date(re.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==ae)).sort((re,F)=>{let Ce,De;switch(j){case"numer_zamowienia":Ce=(re.numer_zamowienia||"").toLowerCase(),De=(F.numer_zamowienia||"").toLowerCase();break;case"klient":Ce=(re.klient||"").toLowerCase(),De=(F.klient||"").toLowerCase();break;case"laczna_ilosc":Ce=re.laczna_ilosc,De=F.laczna_ilosc;break;case"data_utworzenia":Ce=new Date(re.data_utworzenia),De=new Date(F.data_utworzenia);break;default:Ce=re[j]||"",De=F[j]||""}return typeof Ce=="string"&&typeof De=="string"?X==="asc"?Ce.localeCompare(De):De.localeCompare(Ce):typeof Ce=="number"&&typeof De=="number"?X==="asc"?Ce-De:De-Ce:Ce instanceof Date&&De instanceof Date?X==="asc"?Ce.getTime()-De.getTime():De.getTime()-Ce.getTime():0});return c?h.jsx("div",{className:"flex justify-center items-center h-32",children:h.jsx("div",{className:"text-gray-500",children:"adowanie zamwie..."})}):p?h.jsx("div",{className:"flex justify-center items-center h-32",children:h.jsxs("div",{className:"text-red-500",children:["Bd: ",p]})}):h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("numer_zamowienia"),children:"Numer zamwienia"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("klient"),children:"Klient"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("typ"),children:"Typ"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("laczna_ilosc"),children:"czna ilo"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>ie("data_utworzenia"),children:"Data utworzenia"}),h.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:h.jsxs("div",{className:"flex space-x-1 justify-end",children:[h.jsxs("select",{value:ue,onChange:re=>le(re.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[h.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),de.map(re=>h.jsx("option",{value:re,style:{fontFamily:"Sora, sans-serif"},children:re},re))]}),h.jsxs("select",{value:ae,onChange:re=>pe(re.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[h.jsx("option",{value:"",children:"Msc"}),he.map(re=>h.jsx("option",{value:re.value,style:{fontFamily:"Sora, sans-serif"},children:re.value},re.value))]})]})})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamwie"})}):ee.map(re=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:re.numer_zamowienia}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:re.klient}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${re.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:re.typ==="zwrot"?"Zwrot":"Zamwienie"})}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:re.laczna_ilosc}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:se(re.data_utworzenia)}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{type:"button",onClick:F=>{F.preventDefault(),F.stopPropagation(),M(re)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:h.jsx(qd,{size:16})}),h.jsx("button",{type:"button",onClick:F=>{F.preventDefault(),F.stopPropagation(),H(re)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:h.jsx(Ku,{size:16})}),h.jsx("button",{type:"button",onClick:F=>{F.preventDefault(),F.stopPropagation(),E(re)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:h.jsx(Yt,{size:16})})]})})]},re.id))})]})}),h.jsx(Pr,{isOpen:T,onRequestClose:R,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),h.jsx("button",{onClick:R,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsx("div",{children:h.jsx("input",{type:"password",value:C,onChange:re=>Q(re.target.value),onKeyPress:W,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[h.jsx("button",{onClick:R,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),h.jsx("button",{onClick:I,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),h.jsx(OR,{isOpen:y,onClose:()=>k(!1),order:x}),h.jsx(PR,{isOpen:w,onClose:()=>{_(!1),P(null)},onSubmit:re=>{O(re),_(!1),P(null)},order:S})]})},MR="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",hw=({isOpen:e,onClose:n,product:t})=>t?h.jsx(Pr,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[h.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:h.jsx(Yt,{size:24})}),h.jsx("h2",{className:"text-xl font-semibold mb-4",children:" "}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("p",{children:[h.jsx("strong",{children:":"})," ",t.kod]}),h.jsxs("p",{children:[h.jsx("strong",{children:":"})," ",t.nazwa]}),h.jsxs("p",{children:[h.jsx("strong",{children:":"})," ",t.ilosc]}),h.jsxs("p",{children:[h.jsx("strong",{children:". :"})," ",t.jednostka_miary]}),h.jsxs("p",{children:[h.jsx("strong",{children:":"})," ",t.kod_kreskowy]}),t.data_waznosci&&h.jsxs("p",{children:[h.jsx("strong",{children:" :"})," ",t.data_waznosci]}),t.waga_netto&&h.jsxs("p",{children:[h.jsx("strong",{children:" :"})," ",t.waga_netto," "]}),t.waga_brutto&&h.jsxs("p",{children:[h.jsx("strong",{children:" :"})," ",t.waga_brutto," "]}),t.objetosc&&h.jsxs("p",{children:[h.jsx("strong",{children:":"})," ",t.objetosc," "]}),t.opis&&h.jsxs("p",{children:[h.jsx("strong",{children:":"})," ",t.opis]})]})]})}):null,$u="",mw=({isOpen:e,onClose:n,receipt:t,products:r})=>{const[a,o]=be.useState(null),[l,c]=be.useState(!1),[f,p]=be.useState({x:0,y:0}),[d,x]=be.useState(!1),g=be.useRef({x:0,y:0});be.useEffect(()=>{const w=S=>{d&&p({x:S.clientX-g.current.x,y:S.clientY-g.current.y})},_=()=>x(!1);return d&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",_)),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",_)}},[d]);const y=w=>{w.target.closest("button")||w.target.closest("input")||(x(!0),g.current={x:w.clientX-f.x,y:w.clientY-f.y})};if(!t)return null;let k=[];if(Array.isArray(t.products))k=t.products;else if(typeof t.products=="string")try{k=JSON.parse(t.products)}catch{k=[]}return h.jsxs(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:y,style:{cursor:d?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy zakupu"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Warto"}),h.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," "]})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),h.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," "]})]})]}),(t.productInvoice||t.transportInvoice)&&h.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&h.jsxs("button",{onClick:()=>{const w=`${$u}/uploads/${t.productInvoice}`;console.log(" Opening product invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[h.jsx(Zd,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&h.jsxs("button",{onClick:()=>{const w=`${$u}/uploads/${t.transportInvoice}`;console.log(" Opening transport invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[h.jsx(Qd,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),h.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),h.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),h.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),h.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilo"}),h.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),h.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Warto"}),h.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),h.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objto"}),h.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data wanoci"})]})}),h.jsx("tbody",{children:k.map((w,_)=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.kod}),h.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:w.nazwa}),h.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:w.kod_kreskowy||"-"}),h.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:w.ilosc}),h.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[w.cena," "]}),h.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(w.ilosc*w.cena).toFixed(2).replace(".",",")," "]}),h.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const S=w.typ;return S?{czerwone:"Czerwone",biale:"Biae",musujace:"Musujce",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment"}[S]||S:"-"})()}),h.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.objetosc||"-"}),h.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:w.dataWaznosci?typeof w.dataWaznosci=="number"?new Date(w.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(w.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},_))})]})]})]}),h.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),h.jsx(hw,{isOpen:l,onClose:()=>c(!1),product:a})]})},IR=({isOpen:e,onClose:n,onAdd:t,initialData:r,isEditMode:a=!1})=>{const[o,l]=A.useState(""),[c,f]=A.useState(""),[p,d]=A.useState(""),[x,g]=A.useState(""),[y,k]=A.useState("");A.useEffect(()=>{console.log(" useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log(" Setting initial data from props"),l(r.firma),f(r.nazwa),d(r.adres),g(r.czas_dostawy),k(r.kontakt)):e&&!r&&console.log(" Modal opened without initial data - keeping current values")},[e,r]);const w=()=>{if(console.log(" handleSubmit called with values:",{firma:o,nazwa:c,adres:p,czas_dostawy:x,kontakt:y}),console.log(" Trimmed values:",{firma:o.trim(),nazwa:c.trim(),adres:p.trim(),czas_dostawy:x.trim(),kontakt:y.trim()}),!o.trim()||!c.trim()||!p.trim()||!x.trim()||!y.trim()){console.log(" Validation failed: some fields are empty");return}const S={firma:o.trim(),nazwa:c.trim(),adres:p.trim(),czas_dostawy:x.trim(),kontakt:y.trim()};console.log(" Submitting client data:",S),t(S),_()},_=()=>{l(""),f(""),d(""),g(""),k(""),n()};return h.jsx(Pr,{isOpen:e,onRequestClose:_,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),h.jsx("button",{onClick:_,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),h.jsx("input",{type:"text",value:o,onChange:S=>{console.log(" firma onChange:",S.target.value),l(S.target.value)},placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),h.jsx("input",{type:"text",value:c,onChange:S=>f(S.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),h.jsx("input",{type:"text",value:p,onChange:S=>d(S.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),h.jsx("input",{type:"text",value:x,onChange:S=>g(S.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),h.jsx("input",{type:"text",value:y,onChange:S=>k(S.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:w,disabled:!o.trim()||!c.trim()||!p.trim()||!x.trim()||!y.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!o.trim()||!c.trim()||!p.trim()||!x.trim()||!y.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};xi("pl",gi);const vd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],bv=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],xw=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=A.useState(null),[l,c]=A.useState(""),[f,p]=A.useState({x:0,y:0}),[d,x]=A.useState(!1),[g,y]=A.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k=A.useRef({x:0,y:0}),[w,_]=A.useState(""),[S,P]=A.useState(null),[T,z]=A.useState(null),[Z,L]=A.useState(null),[C,Q]=A.useState(null),j=A.useRef(null),te=A.useRef(null),[X,U]=A.useState(null),[ue,le]=A.useState(null);A.useEffect(()=>{if(e&&r){let ee=[];if(r.products)if(typeof r.products=="string")try{ee=JSON.parse(r.products)}catch(re){console.error("Error parsing products JSON:",re),ee=[]}else Array.isArray(r.products)&&(ee=r.products);if(Array.isArray(ee)&&ee.length>0){let re=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[Ce,De,Ve]=r.dataPrzyjecia.split("/");re=new Date(parseInt(Ve),parseInt(De)-1,parseInt(Ce))}else r.dataPrzyjecia.includes("-")?re=new Date(r.dataPrzyjecia):re=new Date(r.dataPrzyjecia);o(re),c(r.sprzedawca||""),_((r.kosztDostawy||0).toFixed(2).replace(".",","));const F=ee.map(Ce=>({kod:Ce.kod||"",nazwa:Ce.nazwa||"",kod_kreskowy:Ce.kod_kreskowy||Ce.ean||"",ilosc:(Ce.ilosc||0).toString(),cena:(Ce.cena||0).toFixed(2).replace(".",","),dataWaznosci:Ce.dataWaznosci||"",showDataWaznosci:!1,typ:Ce.typ||Ce.typTowaru||"",objetosc:Ce.objetosc||""}));y(F.length>0?F:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),L(r.productInvoice||null),Q(r.transportInvoice||null),P(null),z(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),P(null),z(null),L(null),Q(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),P(null),z(null),L(null),Q(null)},[e,r]),A.useEffect(()=>{const ee=F=>{const Ce=F.target;if(!Ce.closest(".dropdown-container")&&!Ce.closest('button[onclick*="toggleDropdown"]')&&U(null),!Ce.closest(".objetosc-dropdown-container")&&!Ce.closest('button[onclick*="toggleObjetoscDropdown"]')&&le(null),!Ce.closest(".react-datepicker")&&!Ce.closest('button[title*="wanoci"]')){const De=[...g];let Ve=!1;De.forEach(He=>{He.showDataWaznosci&&(He.showDataWaznosci=!1,Ve=!0)}),Ve&&y(De)}},re=F=>{if(F.key==="Escape"){U(null),le(null);const Ce=[...g];let De=!1;Ce.forEach(Ve=>{Ve.showDataWaznosci&&(Ve.showDataWaznosci=!1,De=!0)}),De&&y(Ce)}};return document.addEventListener("mousedown",ee),document.addEventListener("keydown",re),()=>{document.removeEventListener("mousedown",ee),document.removeEventListener("keydown",re)}},[g]);const ae=()=>{y([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},pe=ee=>{if(g.length>1){const re=[...g];re.splice(ee,1),y(re)}},V=ee=>{const re=[...g];re[ee].showDataWaznosci=!re[ee].showDataWaznosci,y(re)},se=(ee,re)=>{const F=[...g];F[ee].typ=re,y(F),U(null)},M=ee=>{U(X===ee?null:ee)},H=(ee,re)=>{const F=[...g];F[ee].objetosc=re,y(F),le(null)},O=ee=>{le(ue===ee?null:ee)},E=ee=>{ee.target.closest("button")||ee.target.closest("input")||ee.target.closest(".react-datepicker")||ee.target.closest('[role="button"]')||ee.target.closest(".react-datepicker__input-container")||(x(!0),k.current={x:ee.clientX-f.x,y:ee.clientY-f.y})};A.useEffect(()=>{const ee=F=>{d&&requestAnimationFrame(()=>{p({x:F.clientX-k.current.x,y:F.clientY-k.current.y})})},re=()=>{x(!1)};return d&&(window.addEventListener("mousemove",ee),window.addEventListener("mouseup",re)),()=>{window.removeEventListener("mousemove",ee),window.removeEventListener("mouseup",re)}},[d]);const I=ee=>{const re=ee.target.files?.[0];console.log(" Product file selected (edit):",re),re&&re.type==="application/pdf"?(P(re),console.log(" Product invoice set (edit):",re.name)):console.log(" Invalid product file type (edit):",re?.type)},R=ee=>{const re=ee.target.files?.[0];console.log(" Transport file selected (edit):",re),re&&re.type==="application/pdf"?(z(re),console.log(" Transport invoice set (edit):",re.name)):console.log(" Invalid transport file type (edit):",re?.type)},W=()=>{j.current?.click()},ie=()=>{te.current?.click()},de=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const ee=g.filter(De=>De.kod&&De.nazwa&&De.ilosc&&De.cena);if(console.log("productRows:",g),console.log("validProducts:",ee),console.log("validProducts.length:",ee.length),ee.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const re=ee.map(De=>({kod:De.kod,nazwa:De.nazwa,kod_kreskowy:De.kod_kreskowy||"",ilosc:parseFloat(De.ilosc)||0,cena:parseFloat(De.cena.replace(",","."))||0,dataWaznosci:De.dataWaznosci||void 0,typ:De.typ||void 0,objetosc:De.objetosc?parseFloat(De.objetosc):void 0})),F=re.reduce((De,Ve)=>De+Ve.ilosc*Ve.cena,0),Ce=parseFloat(w.replace(",","."))||0;console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:F,kosztDostawy:Ce,products:re}),console.log(" Files to submit (edit):",{productInvoice:S,transportInvoice:T}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:F,kosztDostawy:Ce,products:re,productInvoice:S||null,transportInvoice:T||null}),he()},he=()=>{o(null),p({x:0,y:0}),y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),_(""),c(""),P(null),z(null),L(null),Q(null),n()},oe=()=>g.reduce((ee,re)=>{const F=parseFloat(re.ilosc)||0,Ce=parseFloat(re.cena.replace(",","."))||0;return ee+F*Ce},0).toFixed(2);return h.jsx(Pr,{isOpen:e,onRequestClose:he,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:E,style:{cursor:d?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:ee=>ee.stopPropagation(),children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),h.jsx("button",{type:"button",onClick:ee=>{ee.preventDefault(),ee.stopPropagation(),he()},className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),h.jsx(As,{selected:a,onChange:ee=>o(ee),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),h.jsx("div",{className:"w-[200px] flex items-start",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",value:w,onKeyPress:ee=>{const re=String.fromCharCode(ee.which);(!/[\d,]/.test(re)||re===","&&ee.target.value.includes(",")||ee.target.value===""&&re===",")&&ee.preventDefault()},onChange:ee=>{const re=ee.target,F=re.selectionStart??0;let Ce=re.value.replace(/[^\d,]/g,"");if(Ce===""){_("");return}if(!Ce.includes(","))Ce=Ce+",00";else{const[Ve,He]=Ce.split(",");He&&He.length>2&&(Ce=`${Ve},${He.slice(0,2)}`)}_(Ce),requestAnimationFrame(()=>{const Ve=Math.min(F,Ce.length);re.setSelectionRange(Ve,Ve)})},className:"w-[70%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),h.jsx("span",{className:"absolute right-[calc(30%+0.75rem)] top-1/2 -translate-y-1/2 text-gray-500",children:""})]})]})}),h.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:I,className:"hidden",ref:j}),h.jsx("button",{type:"button",onClick:W,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:h.jsx(Zd,{className:"h-4 w-4 text-gray-500"})}),S&&h.jsx("a",{href:URL.createObjectURL(S),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:S.name,children:S.name}),!S&&Z&&h.jsx("a",{href:`${$u}${Z}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),h.jsxs("div",{className:"flex items-center w-48",children:[h.jsx("input",{type:"file",accept:".pdf",onChange:R,className:"hidden",ref:te}),h.jsx("button",{type:"button",onClick:ie,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:h.jsx(Qd,{className:"h-4 w-4 text-gray-500"})}),T&&h.jsx("a",{href:URL.createObjectURL(T),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:T.name,children:T.name}),!T&&C&&h.jsx("a",{href:`${$u}${C}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),h.jsx("input",{type:"text",value:l,onChange:ee=>c(ee.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})}),h.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((ee,re)=>h.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[h.jsxs("div",{className:"col-span-1.5 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Kod"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:ee.kod,onChange:F=>{const Ce=[...g];Ce[re].kod=F.target.value,y(Ce)}}),re===g.length-1&&h.jsx("button",{onClick:ae,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:h.jsx(Js,{size:16})})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Nazwa"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:ee.nazwa,onChange:F=>{const Ce=[...g];Ce[re].nazwa=F.target.value,y(Ce)}})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Kod kreskowy"}),h.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:ee.kod_kreskowy,onChange:F=>{const Ce=[...g];Ce[re].kod_kreskowy=F.target.value,y(Ce)}})]}),h.jsxs("div",{className:"col-span-1.5",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Ilo"}),h.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:ee.ilosc,onChange:F=>{const Ce=[...g],De=F.target.value;(De===""||/^\d*$/.test(De))&&(Ce[re].ilosc=De,y(Ce))}})]}),h.jsxs("div",{className:"col-span-2.9 relative",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Cena"}),h.jsx("div",{className:"relative",children:h.jsx("input",{type:"text",value:ee.cena,onKeyPress:F=>{const Ce=String.fromCharCode(F.which);(!/[\d,]/.test(Ce)||Ce===","&&F.target.value.includes(",")||F.target.value===""&&Ce===",")&&F.preventDefault()},onChange:F=>{const Ce=F.target,De=Ce.selectionStart??0;let Ve=F.target.value.replace(/[^\d,]/g,"");if(Ve===""){const ne=[...g];ne[re].cena="",y(ne);return}if(!Ve.includes(","))Ve=Ve+",00";else{const[ne,Se]=Ve.split(",");Se&&Se.length>2&&(Ve=`${ne},${Se.slice(0,2)}`)}const Ie=[...g];Ie[re].cena=Ve,y(Ie),requestAnimationFrame(()=>{const ne=Math.min(De,Ve.length);Ce.setSelectionRange(ne,ne)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),h.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Warto"}),h.jsx("div",{className:"relative flex items-center",children:h.jsx("input",{type:"text",value:(()=>{const F=parseFloat(ee.ilosc)||0,Ce=parseFloat(ee.cena.replace(",","."))||0;return(F*Ce).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),h.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[h.jsx("button",{type:"button",onClick:()=>V(re),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${ee.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:ee.dataWaznosci?`Termin wanoci: ${ee.dataWaznosci}`:"Dodaj termin wanoci",children:h.jsx(Xd,{size:16})}),h.jsx("button",{onClick:()=>pe(re),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:h.jsx(Yt,{size:16})})]}),ee.showDataWaznosci&&h.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:h.jsx(As,{selected:ee.dataWaznosci?new Date(ee.dataWaznosci):null,onChange:F=>{const Ce=[...g];Ce[re].dataWaznosci=F?F.toISOString().split("T")[0]:"",Ce[re].showDataWaznosci=!1,y(Ce)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const F=[...g];F[re].showDataWaznosci=!1,y(F)}})}),h.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Typ"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>M(re),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${ee.typ&&vd.find(F=>F.value===ee.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate",children:ee.typ&&vd.find(F=>F.value===ee.typ)?.label||"Wybierz typ"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),X===re&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:F=>F.stopPropagation(),children:vd.map(F=>h.jsx("button",{type:"button",onClick:()=>se(re,F.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${F.color}`,children:F.label},F.value))})]})]}),h.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[h.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Objto"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:()=>O(re),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${ee.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[h.jsx("span",{className:"truncate",children:ee.objetosc?bv.find(F=>F.value===ee.objetosc)?.label||ee.objetosc:"Wybierz"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ue===re&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:F=>F.stopPropagation(),style:{maxWidth:"200px"},children:bv.map(F=>h.jsx("button",{type:"button",onClick:()=>H(re,F.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:F.label},F.value))})]})]})]},re))})]}),h.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[h.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),h.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[oe().replace(".",",")," "]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:de,disabled:!a||!g.some(ee=>ee.kod&&ee.nazwa&&ee.ilosc&&ee.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(ee=>ee.kod&&ee.nazwa&&ee.ilosc&&ee.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},jR=({receipts:e,products:n,onDelete:t,onEdit:r,onUpdate:a,selectedCategory:o=""})=>{const[l,c]=A.useState(null),[f,p]=A.useState(!1),[d,x]=A.useState(!1),[g,y]=A.useState(null),[k,w]=A.useState(!1),[_,S]=A.useState(null),[P,T]=A.useState(""),[z,Z]=A.useState({x:0,y:0}),[L,C]=A.useState(!1),Q=A.useRef({x:0,y:0}),[j,te]=A.useState("dataPrzyjecia"),[X,U]=A.useState("desc"),[ue,le]=A.useState(""),[ae,pe]=A.useState(""),V=oe=>{c(oe),p(!0)},se=oe=>{y(oe),x(!0)},M=oe=>{S(oe),w(!0),T("")},H=()=>{P==="5202"?(_?.id&&(t(_.id),at.success("Zapis zosta usunity")),O()):(at.error("Nieprawidowe haso"),T(""))},O=()=>{w(!1),S(null),T(""),Z({x:0,y:0})},E=oe=>{oe.key==="Enter"&&H()},I=oe=>{j===oe?U(X==="asc"?"desc":"asc"):(te(oe),U("asc"))},R=oe=>{oe.target.closest("button")||oe.target.closest("input")||(C(!0),Q.current={x:oe.clientX-z.x,y:oe.clientY-z.y})};A.useEffect(()=>{const oe=re=>{L&&requestAnimationFrame(()=>{Z({x:re.clientX-Q.current.x,y:re.clientY-Q.current.y})})},ee=()=>{C(!1)};return L&&(window.addEventListener("mousemove",oe),window.addEventListener("mouseup",ee)),()=>{window.removeEventListener("mousemove",oe),window.removeEventListener("mouseup",ee)}},[L]);const W=Array.from(new Set(e.map(oe=>new Date(oe.dataPrzyjecia).getFullYear().toString()))).sort((oe,ee)=>parseInt(ee)-parseInt(oe)),ie=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],he=e.filter(oe=>{if(o)if(typeof oe.products=="string")try{if(!JSON.parse(oe.products).some(F=>F.typ===o))return!1}catch{return!1}else if(Array.isArray(oe.products)){if(!oe.products.some(re=>re.typ===o))return!1}else return!1;return!(ue&&new Date(oe.dataPrzyjecia).getFullYear().toString()!==ue||ae&&(new Date(oe.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==ae)}).sort((oe,ee)=>{let re,F;switch(j){case"dataPrzyjecia":re=new Date(oe.dataPrzyjecia),F=new Date(ee.dataPrzyjecia);break;case"sprzedawca":re=(oe.sprzedawca||"").toLowerCase(),F=(ee.sprzedawca||"").toLowerCase();break;case"wartosc":re=oe.wartosc,F=ee.wartosc;break;case"kosztDostawy":re=oe.kosztDostawy,F=ee.kosztDostawy;break;default:re=oe[j]||"",F=ee[j]||""}return typeof re=="string"&&typeof F=="string"?X==="asc"?re.localeCompare(F):F.localeCompare(re):typeof re=="number"&&typeof F=="number"?X==="asc"?re-F:F-re:re instanceof Date&&F instanceof Date?X==="asc"?re.getTime()-F.getTime():F.getTime()-re.getTime():0});return h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("dataPrzyjecia"),children:"Data zakupu"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("sprzedawca"),children:"Sprzedawca"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("wartosc"),children:"Warto"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>I("kosztDostawy"),children:"Koszt dostawy"}),h.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:h.jsxs("div",{className:"flex space-x-1 justify-end",children:[h.jsxs("select",{value:ue,onChange:oe=>le(oe.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[h.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),W.map(oe=>h.jsx("option",{value:oe,style:{fontFamily:"Sora, sans-serif"},children:oe},oe))]}),h.jsxs("select",{value:ae,onChange:oe=>pe(oe.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[h.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Msc"}),ie.map(oe=>h.jsx("option",{value:oe.value,style:{fontFamily:"Sora, sans-serif"},children:oe.label},oe.value))]})]})})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:he.map(oe=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:oe.dataPrzyjecia}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:oe.sprzedawca}),h.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[oe.wartosc.toFixed(2)," "]}),h.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[oe.kosztDostawy.toFixed(2)," "]}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{type:"button",onClick:ee=>{ee.preventDefault(),ee.stopPropagation(),V(oe)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:h.jsx(qd,{size:16})}),h.jsx("button",{type:"button",onClick:ee=>{ee.preventDefault(),ee.stopPropagation(),se(oe)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:h.jsx(Ku,{size:16})}),h.jsx("button",{type:"button",onClick:ee=>{ee.preventDefault(),ee.stopPropagation(),M(oe)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:h.jsx(Yt,{size:16})})]})})]},oe.id))})]})}),h.jsx(Pr,{isOpen:k,onRequestClose:O,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${z.x}px), calc(-50% + ${z.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:R,style:{cursor:L?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),h.jsx("button",{onClick:O,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsx("div",{children:h.jsx("input",{type:"password",value:P,onChange:oe=>T(oe.target.value),onKeyPress:E,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[h.jsx("button",{onClick:O,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),h.jsx("button",{onClick:H,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),h.jsx(mw,{isOpen:f,onClose:()=>p(!1),receipt:l,products:n}),h.jsx(xw,{isOpen:d,onClose:()=>{x(!1),y(null)},onSubmit:oe=>{a({...oe,productInvoice:oe.productInvoice??void 0,transportInvoice:oe.transportInvoice??void 0}),x(!1),y(null)},receipt:g?{id:g.id||0,dataPrzyjecia:g.dataPrzyjecia,sprzedawca:g.sprzedawca,wartosc:g.wartosc,kosztDostawy:g.kosztDostawy,products:g.products,productInvoice:g.productInvoice,transportInvoice:g.transportInvoice}:null})]})},LR=({isOpen:e,onClose:n,client:t})=>t?h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy klienta"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:h.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),h.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),h.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,gw=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=A.useState(""),[l,c]=A.useState(""),[f,p]=A.useState(""),[d,x]=A.useState(""),[g,y]=A.useState("");A.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),p(r.adres||""),x(r.czas_dostawy||""),y(r.kontakt||"")):(o(""),c(""),p(""),x(""),y(""))},[e,r]);const k=async()=>{if(a.trim()&&l.trim()&&f.trim()&&d.trim()&&g.trim()&&r){const _={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:d,kontakt:g};t(_),w()}},w=()=>{o(""),c(""),p(""),x(""),y(""),n()};return h.jsx(Pr,{isOpen:e,onRequestClose:w,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),h.jsx("button",{onClick:w,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),h.jsx("input",{type:"text",value:a,onChange:_=>o(_.target.value),placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),h.jsx("input",{type:"text",value:l,onChange:_=>c(_.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),h.jsx("input",{type:"text",value:f,onChange:_=>p(_.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),h.jsx("input",{type:"text",value:d,onChange:_=>x(_.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),h.jsx("input",{type:"text",value:g,onChange:_=>y(_.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:k,disabled:!a.trim()||!l.trim()||!f.trim()||!d.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!d.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},zR=({clients:e,onDelete:n,onEdit:t,onUpdate:r})=>{console.log(" ClientsList render - clients:",e),console.log(" ClientsList render - clients length:",e.length),console.log(" ClientsList render - first client:",e[0]),console.log(" ClientsList render - all clients:",e.map(H=>({id:H.id,firma:H.firma,nazwa:H.nazwa})));const[a,o]=A.useState(null),[l,c]=A.useState(!1),[f,p]=A.useState(!1),[d,x]=A.useState(null),[g,y]=A.useState(!1),[k,w]=A.useState(null),[_,S]=A.useState(""),[P,T]=A.useState({x:0,y:0}),[z,Z]=A.useState(!1),L=A.useRef({x:0,y:0}),[C,Q]=A.useState(""),[j,te]=A.useState("asc");e&&e.length>0,A.useEffect(()=>{console.log(" ClientsList useEffect - clients changed:",e),console.log(" ClientsList useEffect - clients length:",e.length)},[e]);const X=H=>{o(H),c(!0)},U=H=>{x(H),p(!0)},ue=H=>{w(H),y(!0),S("")},le=()=>{_==="5202"?(k?.id&&n(k.id),ae()):(at.error("Nieprawidowe haso"),S(""))},ae=()=>{y(!1),w(null),S(""),T({x:0,y:0})},pe=H=>{H.key==="Enter"&&le()},V=H=>{C===H?te(j==="asc"?"desc":"asc"):(Q(H),te("asc"))},se=H=>{H.target.closest("button")||H.target.closest("input")||(Z(!0),L.current={x:H.clientX-P.x,y:H.clientY-P.y})};A.useEffect(()=>{const H=E=>{z&&requestAnimationFrame(()=>{T({x:E.clientX-L.current.x,y:E.clientY-L.current.y})})},O=()=>{Z(!1)};return z&&(window.addEventListener("mousemove",H),window.addEventListener("mouseup",O)),()=>{window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",O)}},[z]),console.log(" Sorting logic - sortField:",C,"sortDirection:",j),console.log(" Sorting logic - clients length:",e.length);const M=C?[...e].sort((H,O)=>{let E,I;switch(C){case"firma":E=(H.firma||"").toLowerCase(),I=(O.firma||"").toLowerCase();break;case"nazwa":E=(H.nazwa||"").toLowerCase(),I=(O.nazwa||"").toLowerCase();break;case"adres":E=(H.adres||"").toLowerCase(),I=(O.adres||"").toLowerCase();break;case"czas_dostawy":E=(H.czas_dostawy||"").toLowerCase(),I=(O.czas_dostawy||"").toLowerCase();break;case"kontakt":E=(H.kontakt||"").toLowerCase(),I=(O.kontakt||"").toLowerCase();break;default:E=H[C]||"",I=O[C]||""}return typeof E=="string"&&typeof I=="string"?j==="asc"?E.localeCompare(I):I.localeCompare(E):0}):e;return console.log(" Final sortedClients length:",M.length),console.log(" Final sortedClients first:",M[0]),h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>V("firma"),children:["Nazwa firmy ",C==="firma"&&(j==="asc"?"":"")]}),h.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>V("nazwa"),children:["Nazwa ",C==="nazwa"&&(j==="asc"?"":"")]}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("adres"),children:"Adres"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("czas_dostawy"),children:"Czas dostawy"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("kontakt"),children:"Kontakt"}),h.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:C&&h.jsx("button",{onClick:()=>{Q(""),te("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:" ",children:""})})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map((H,O)=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:H.firma}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:H.nazwa}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:H.adres}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:H.czas_dostawy}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:H.kontakt}),h.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{type:"button",onClick:E=>{E.preventDefault(),E.stopPropagation(),X(H)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:h.jsx(qd,{size:16})}),h.jsx("button",{type:"button",onClick:E=>{E.preventDefault(),E.stopPropagation(),U(H)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:h.jsx(Ku,{size:16})}),h.jsx("button",{type:"button",onClick:E=>{E.preventDefault(),E.stopPropagation(),ue(H)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:h.jsx(Yt,{size:16})})]})})]},H.id||`client-${O}`))})]})}),h.jsx(Pr,{isOpen:g,onRequestClose:ae,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${P.x}px), calc(-50% + ${P.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:se,style:{cursor:z?"grabbing":"grab"},children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),h.jsx("button",{onClick:ae,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("div",{className:"space-y-6 flex-grow",children:h.jsx("div",{children:h.jsx("input",{type:"password",value:_,onChange:H=>S(H.target.value),onKeyPress:pe,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),h.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[h.jsx("button",{onClick:ae,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),h.jsx("button",{onClick:le,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),h.jsx(LR,{isOpen:l,onClose:()=>c(!1),client:a}),h.jsx(gw,{isOpen:f,onClose:()=>{p(!1),x(null)},onSubmit:H=>{r(H),p(!1),x(null)},client:d})]})};var yd={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Ev;function BR(){return Ev||(Ev=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(yd)),yd.exports}var WR=BR();const Vd=Vu(WR);var Sv={};const UR="react-tooltip-core-styles",HR="react-tooltip-base-styles",Tv={core:!1,base:!1};function Cv({css:e,id:n=HR,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Tv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Sv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Sv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=UR),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Tv[t]=!0}const Dv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[Jy(Number(a)),ew({fallbackAxisSideDirection:"start"}),UA({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const p=l;return t?(p.push(Wd({element:t,padding:5})),Ud(e,n,{placement:r,strategy:o,middleware:p}).then((({x:d,y:x,placement:g,middlewareData:y})=>{var k,w;const _={left:`${d}px`,top:`${x}px`,border:c},{x:S,y:P}=(k=y.arrow)!==null&&k!==void 0?k:{x:0,y:0},T=(w={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&w!==void 0?w:"bottom",z=c&&{borderBottom:c,borderRight:c};let Z=0;if(c){const L=`${c}`.match(/(\d+)px/);Z=L?.[1]?Number(L[1]):1}return{tooltipStyles:_,tooltipArrowStyles:{left:S!=null?`${S}px`:"",top:P!=null?`${P}px`:"",right:"",bottom:"",...z,[T]:`-${f/2+Z}px`},place:g}}))):Ud(e,n,{placement:"bottom",strategy:o,middleware:p}).then((({x:d,y:x,placement:g})=>({tooltipStyles:{left:`${d}px`,top:`${x}px`},tooltipArrowStyles:{},place:g})))},Nv=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),Fv=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Av=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Kd=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Kd(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Av(e)||!Av(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Kd(e[a],n[a])))},YR=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Ov=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(YR(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},$R=typeof window<"u"?A.useLayoutEffect:A.useEffect,In=e=>{e.current&&(clearTimeout(e.current),e.current=null)},VR="DEFAULT_TOOLTIP_ID",KR={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},GR=A.createContext({getTooltipData:()=>KR});function vw(e=VR){return A.useContext(GR).getTooltipData(e)}var Ko={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},wd={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const XR=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:p=["hover"],openOnClick:d=!1,positionStrategy:x="absolute",middlewares:g,wrapper:y,delayShow:k=0,delayHide:w=0,float:_=!1,hidden:S=!1,noArrow:P=!1,clickable:T=!1,closeOnEsc:z=!1,closeOnScroll:Z=!1,closeOnResize:L=!1,openEvents:C,closeEvents:Q,globalCloseEvents:j,imperativeModeOnly:te,style:X,position:U,afterShow:ue,afterHide:le,disableTooltip:ae,content:pe,contentWrapperRef:V,isOpen:se,defaultIsOpen:M=!1,setIsOpen:H,activeAnchor:O,setActiveAnchor:E,border:I,opacity:R,arrowColor:W,arrowSize:ie=8,role:de="tooltip"})=>{var he;const oe=A.useRef(null),ee=A.useRef(null),re=A.useRef(null),F=A.useRef(null),Ce=A.useRef(null),[De,Ve]=A.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[He,Ie]=A.useState(!1),[ne,Se]=A.useState(!1),[Ee,Fe]=A.useState(null),qe=A.useRef(!1),it=A.useRef(null),{anchorRefs:kt,setActiveAnchor:bt}=vw(n),Rt=A.useRef(!1),[Ot,ht]=A.useState([]),Tt=A.useRef(!1),et=d||p.includes("click"),vt=et||C?.click||C?.dblclick||C?.mousedown,xt=C?{...C}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!C&&et&&Object.assign(xt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const pt=Q?{...Q}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!Q&&et&&Object.assign(pt,{mouseleave:!1,blur:!1,mouseout:!1});const Mt=j?{...j}:{escape:z||!1,scroll:Z||!1,resize:L||!1,clickOutsideAnchor:vt||!1};te&&(Object.assign(xt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(pt,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(Mt,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),$R((()=>(Tt.current=!0,()=>{Tt.current=!1})),[]);const $t=Ue=>{Tt.current&&(Ue&&Se(!0),setTimeout((()=>{Tt.current&&(H?.(Ue),se===void 0&&Ie(Ue))}),10))};A.useEffect((()=>{if(se===void 0)return()=>null;se&&Se(!0);const Ue=setTimeout((()=>{Ie(se)}),10);return()=>{clearTimeout(Ue)}}),[se]),A.useEffect((()=>{if(He!==qe.current)if(In(Ce),qe.current=He,He)ue?.();else{const Ue=(rt=>{const ut=rt.match(/^([\d.]+)(ms|s)$/);if(!ut)return 0;const[,Kt,rr]=ut;return Number(Kt)*(rr==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));Ce.current=setTimeout((()=>{Se(!1),Fe(null),le?.()}),Ue+25)}}),[He]);const Cn=Ue=>{Ve((rt=>Kd(rt,Ue)?rt:Ue))},vn=(Ue=k)=>{In(re),ne?$t(!0):re.current=setTimeout((()=>{$t(!0)}),Ue)},me=(Ue=w)=>{In(F),F.current=setTimeout((()=>{Rt.current||$t(!1)}),Ue)},Le=Ue=>{var rt;if(!Ue)return;const ut=(rt=Ue.currentTarget)!==null&&rt!==void 0?rt:Ue.target;if(!ut?.isConnected)return E(null),void bt({current:null});k?vn():$t(!0),E(ut),bt({current:ut}),In(F)},ze=()=>{T?me(w||100):w?me():$t(!1),In(re)},Ke=({x:Ue,y:rt})=>{var ut;const Kt={getBoundingClientRect:()=>({x:Ue,y:rt,width:0,height:0,top:rt,left:Ue,right:Ue,bottom:rt})};Dv({place:(ut=Ee?.place)!==null&&ut!==void 0?ut:c,offset:f,elementReference:Kt,tooltipReference:oe.current,tooltipArrowReference:ee.current,strategy:x,middlewares:g,border:I,arrowSize:ie}).then((rr=>{Cn(rr)}))},tt=Ue=>{if(!Ue)return;const rt=Ue,ut={x:rt.clientX,y:rt.clientY};Ke(ut),it.current=ut},Ct=Ue=>{var rt;if(!He)return;const ut=Ue.target;ut.isConnected&&(!((rt=oe.current)===null||rt===void 0)&&rt.contains(ut)||[document.querySelector(`[id='${o}']`),...Ot].some((Kt=>Kt?.contains(ut)))||($t(!1),In(re)))},zt=Fv(Le,50),Vt=Fv(ze,50),wr=Ue=>{Vt.cancel(),zt(Ue)},nt=()=>{zt.cancel(),Vt()},gt=A.useCallback((()=>{var Ue,rt;const ut=(Ue=Ee?.position)!==null&&Ue!==void 0?Ue:U;ut?Ke(ut):_?it.current&&Ke(it.current):O?.isConnected&&Dv({place:(rt=Ee?.place)!==null&&rt!==void 0?rt:c,offset:f,elementReference:O,tooltipReference:oe.current,tooltipArrowReference:ee.current,strategy:x,middlewares:g,border:I,arrowSize:ie}).then((Kt=>{Tt.current&&Cn(Kt)}))}),[He,O,pe,X,c,Ee?.place,f,x,U,Ee?.position,_,ie]);A.useEffect((()=>{var Ue,rt;const ut=new Set(kt);Ot.forEach((Pe=>{ae?.(Pe)||ut.add({current:Pe})}));const Kt=document.querySelector(`[id='${o}']`);Kt&&!ae?.(Kt)&&ut.add({current:Kt});const rr=()=>{$t(!1)},N=Ov(O),G=Ov(oe.current);Mt.scroll&&(window.addEventListener("scroll",rr),N?.addEventListener("scroll",rr),G?.addEventListener("scroll",rr));let B=null;Mt.resize?window.addEventListener("resize",rr):O&&oe.current&&(B=Zy(O,oe.current,gt,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const Y=Pe=>{Pe.key==="Escape"&&$t(!1)};Mt.escape&&window.addEventListener("keydown",Y),Mt.clickOutsideAnchor&&window.addEventListener("click",Ct);const K=[],q=Pe=>!!(Pe?.target&&O?.contains(Pe.target)),ve=Pe=>{He&&q(Pe)||Le(Pe)},Te=Pe=>{He&&q(Pe)&&ze()},ge=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],we=["click","dblclick","mousedown","mouseup"];Object.entries(xt).forEach((([Pe,Re])=>{Re&&(ge.includes(Pe)?K.push({event:Pe,listener:wr}):we.includes(Pe)&&K.push({event:Pe,listener:ve}))})),Object.entries(pt).forEach((([Pe,Re])=>{Re&&(ge.includes(Pe)?K.push({event:Pe,listener:nt}):we.includes(Pe)&&K.push({event:Pe,listener:Te}))})),_&&K.push({event:"pointermove",listener:tt});const ke=()=>{Rt.current=!0},Oe=()=>{Rt.current=!1,ze()},We=T&&(pt.mouseout||pt.mouseleave);return We&&((Ue=oe.current)===null||Ue===void 0||Ue.addEventListener("mouseover",ke),(rt=oe.current)===null||rt===void 0||rt.addEventListener("mouseout",Oe)),K.forEach((({event:Pe,listener:Re})=>{ut.forEach((Me=>{var lt;(lt=Me.current)===null||lt===void 0||lt.addEventListener(Pe,Re)}))})),()=>{var Pe,Re;Mt.scroll&&(window.removeEventListener("scroll",rr),N?.removeEventListener("scroll",rr),G?.removeEventListener("scroll",rr)),Mt.resize?window.removeEventListener("resize",rr):B?.(),Mt.clickOutsideAnchor&&window.removeEventListener("click",Ct),Mt.escape&&window.removeEventListener("keydown",Y),We&&((Pe=oe.current)===null||Pe===void 0||Pe.removeEventListener("mouseover",ke),(Re=oe.current)===null||Re===void 0||Re.removeEventListener("mouseout",Oe)),K.forEach((({event:Me,listener:lt})=>{ut.forEach((Bt=>{var jt;(jt=Bt.current)===null||jt===void 0||jt.removeEventListener(Me,lt)}))}))}}),[O,gt,ne,kt,Ot,C,Q,j,et,k,w]),A.useEffect((()=>{var Ue,rt;let ut=(rt=(Ue=Ee?.anchorSelect)!==null&&Ue!==void 0?Ue:l)!==null&&rt!==void 0?rt:"";!ut&&n&&(ut=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const Kt=new MutationObserver((rr=>{const N=[],G=[];rr.forEach((B=>{if(B.type==="attributes"&&B.attributeName==="data-tooltip-id"&&(B.target.getAttribute("data-tooltip-id")===n?N.push(B.target):B.oldValue===n&&G.push(B.target)),B.type==="childList"){if(O){const Y=[...B.removedNodes].filter((K=>K.nodeType===1));if(ut)try{G.push(...Y.filter((K=>K.matches(ut)))),G.push(...Y.flatMap((K=>[...K.querySelectorAll(ut)])))}catch{}Y.some((K=>{var q;return!!(!((q=K?.contains)===null||q===void 0)&&q.call(K,O))&&(Se(!1),$t(!1),E(null),In(re),In(F),!0)}))}if(ut)try{const Y=[...B.addedNodes].filter((K=>K.nodeType===1));N.push(...Y.filter((K=>K.matches(ut)))),N.push(...Y.flatMap((K=>[...K.querySelectorAll(ut)])))}catch{}}})),(N.length||G.length)&&ht((B=>[...B.filter((Y=>!G.includes(Y))),...N]))}));return Kt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{Kt.disconnect()}}),[n,l,Ee?.anchorSelect,O]),A.useEffect((()=>{gt()}),[gt]),A.useEffect((()=>{if(!V?.current)return()=>null;const Ue=new ResizeObserver((()=>{setTimeout((()=>gt()))}));return Ue.observe(V.current),()=>{Ue.disconnect()}}),[pe,V?.current]),A.useEffect((()=>{var Ue;const rt=document.querySelector(`[id='${o}']`),ut=[...Ot,rt];O&&ut.includes(O)||E((Ue=Ot[0])!==null&&Ue!==void 0?Ue:rt)}),[o,Ot,O]),A.useEffect((()=>(M&&$t(!0),()=>{In(re),In(F)})),[]),A.useEffect((()=>{var Ue;let rt=(Ue=Ee?.anchorSelect)!==null&&Ue!==void 0?Ue:l;if(!rt&&n&&(rt=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),rt)try{const ut=Array.from(document.querySelectorAll(rt));ht(ut)}catch{ht([])}}),[n,l,Ee?.anchorSelect]),A.useEffect((()=>{re.current&&(In(re),vn(k))}),[k]);const Tr=(he=Ee?.content)!==null&&he!==void 0?he:pe,Zr=He&&Object.keys(De.tooltipStyles).length>0;return A.useImperativeHandle(e,(()=>({open:Ue=>{if(Ue?.anchorSelect)try{document.querySelector(Ue.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ue.anchorSelect}" is not a valid CSS selector`)}Fe(Ue??null),Ue?.delay?vn(Ue.delay):$t(!0)},close:Ue=>{Ue?.delay?me(Ue.delay):$t(!1)},activeAnchor:O,place:De.place,isOpen:!!(ne&&!S&&Tr&&Zr)}))),ne&&!S&&Tr?be.createElement(y,{id:n,role:de,className:Vd("react-tooltip",Ko.tooltip,wd.tooltip,wd[a],t,`react-tooltip__place-${De.place}`,Ko[Zr?"show":"closing"],Zr?"react-tooltip__show":"react-tooltip__closing",x==="fixed"&&Ko.fixed,T&&Ko.clickable),onTransitionEnd:Ue=>{In(Ce),He||Ue.propertyName!=="opacity"||(Se(!1),Fe(null),le?.())},style:{...X,...De.tooltipStyles,opacity:R!==void 0&&Zr?R:void 0},ref:oe},Tr,be.createElement(y,{className:Vd("react-tooltip-arrow",Ko.arrow,wd.arrow,r,P&&Ko.noArrow),style:{...De.tooltipArrowStyles,background:W?`linear-gradient(to right bottom, transparent 50%, ${W} 50%)`:void 0,"--rt-arrow-size":`${ie}px`},ref:ee})):null},QR=({content:e})=>be.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),Pv=be.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:p="top",offset:d=10,wrapper:x="div",children:g=null,events:y=["hover"],openOnClick:k=!1,positionStrategy:w="absolute",middlewares:_,delayShow:S=0,delayHide:P=0,float:T=!1,hidden:z=!1,noArrow:Z=!1,clickable:L=!1,closeOnEsc:C=!1,closeOnScroll:Q=!1,closeOnResize:j=!1,openEvents:te,closeEvents:X,globalCloseEvents:U,imperativeModeOnly:ue=!1,style:le,position:ae,isOpen:pe,defaultIsOpen:V=!1,disableStyleInjection:se=!1,border:M,opacity:H,arrowColor:O,arrowSize:E,setIsOpen:I,afterShow:R,afterHide:W,disableTooltip:ie,role:de="tooltip"},he)=>{const[oe,ee]=A.useState(r),[re,F]=A.useState(a),[Ce,De]=A.useState(p),[Ve,He]=A.useState(f),[Ie,ne]=A.useState(d),[Se,Ee]=A.useState(S),[Fe,qe]=A.useState(P),[it,kt]=A.useState(T),[bt,Rt]=A.useState(z),[Ot,ht]=A.useState(x),[Tt,et]=A.useState(y),[vt,xt]=A.useState(w),[pt,Mt]=A.useState(null),[$t,Cn]=A.useState(null),vn=A.useRef(se),{anchorRefs:me,activeAnchor:Le}=vw(e),ze=Vt=>Vt?.getAttributeNames().reduce(((wr,nt)=>{var gt;return nt.startsWith("data-tooltip-")&&(wr[nt.replace(/^data-tooltip-/,"")]=(gt=Vt?.getAttribute(nt))!==null&&gt!==void 0?gt:null),wr}),{}),Ke=Vt=>{const wr={place:nt=>{var gt;De((gt=nt)!==null&&gt!==void 0?gt:p)},content:nt=>{ee(nt??r)},html:nt=>{F(nt??a)},variant:nt=>{var gt;He((gt=nt)!==null&&gt!==void 0?gt:f)},offset:nt=>{ne(nt===null?d:Number(nt))},wrapper:nt=>{var gt;ht((gt=nt)!==null&&gt!==void 0?gt:x)},events:nt=>{const gt=nt?.split(" ");et(gt??y)},"position-strategy":nt=>{var gt;xt((gt=nt)!==null&&gt!==void 0?gt:w)},"delay-show":nt=>{Ee(nt===null?S:Number(nt))},"delay-hide":nt=>{qe(nt===null?P:Number(nt))},float:nt=>{kt(nt===null?T:nt==="true")},hidden:nt=>{Rt(nt===null?z:nt==="true")},"class-name":nt=>{Mt(nt)}};Object.values(wr).forEach((nt=>nt(null))),Object.entries(Vt).forEach((([nt,gt])=>{var Tr;(Tr=wr[nt])===null||Tr===void 0||Tr.call(wr,gt)}))};A.useEffect((()=>{ee(r)}),[r]),A.useEffect((()=>{F(a)}),[a]),A.useEffect((()=>{De(p)}),[p]),A.useEffect((()=>{He(f)}),[f]),A.useEffect((()=>{ne(d)}),[d]),A.useEffect((()=>{Ee(S)}),[S]),A.useEffect((()=>{qe(P)}),[P]),A.useEffect((()=>{kt(T)}),[T]),A.useEffect((()=>{Rt(z)}),[z]),A.useEffect((()=>{xt(w)}),[w]),A.useEffect((()=>{vn.current!==se&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[se]),A.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:se==="core",disableBase:se}}))}),[]),A.useEffect((()=>{var Vt;const wr=new Set(me);let nt=t;if(!nt&&e&&(nt=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),nt)try{document.querySelectorAll(nt).forEach((rt=>{wr.add({current:rt})}))}catch{console.warn(`[react-tooltip] "${nt}" is not a valid CSS selector`)}const gt=document.querySelector(`[id='${n}']`);if(gt&&wr.add({current:gt}),!wr.size)return()=>null;const Tr=(Vt=$t??gt)!==null&&Vt!==void 0?Vt:Le.current,Zr=new MutationObserver((rt=>{rt.forEach((ut=>{var Kt;if(!Tr||ut.type!=="attributes"||!(!((Kt=ut.attributeName)===null||Kt===void 0)&&Kt.startsWith("data-tooltip-")))return;const rr=ze(Tr);Ke(rr)}))})),Ue={attributes:!0,childList:!1,subtree:!1};if(Tr){const rt=ze(Tr);Ke(rt),Zr.observe(Tr,Ue)}return()=>{Zr.disconnect()}}),[me,Le,$t,n,t]),A.useEffect((()=>{le?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),M&&!Nv("border",`${M}`)&&console.warn(`[react-tooltip] "${M}" is not a valid \`border\`.`),le?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),H&&!Nv("opacity",`${H}`)&&console.warn(`[react-tooltip] "${H}" is not a valid \`opacity\`.`)}),[]);let tt=g;const Ct=A.useRef(null);if(o){const Vt=o({content:$t?.getAttribute("data-tooltip-content")||oe||null,activeAnchor:$t});tt=Vt?be.createElement("div",{ref:Ct,className:"react-tooltip-content-wrapper"},Vt):null}else oe&&(tt=oe);re&&(tt=be.createElement(QR,{content:re}));const zt={forwardRef:he,id:e,anchorId:n,anchorSelect:t,className:Vd(l,pt),classNameArrow:c,content:tt,contentWrapperRef:Ct,place:Ce,variant:Ve,offset:Ie,wrapper:Ot,events:Tt,openOnClick:k,positionStrategy:vt,middlewares:_,delayShow:Se,delayHide:Fe,float:it,hidden:bt,noArrow:Z,clickable:L,closeOnEsc:C,closeOnScroll:Q,closeOnResize:j,openEvents:te,closeEvents:X,globalCloseEvents:U,imperativeModeOnly:ue,style:le,position:ae,isOpen:pe,defaultIsOpen:V,border:M,opacity:H,arrowColor:O,arrowSize:E,setIsOpen:I,afterShow:R,afterHide:W,disableTooltip:ie,activeAnchor:$t,setActiveAnchor:Vt=>Cn(Vt),role:de};return be.createElement(XR,{...zt})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Cv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Cv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));xi("pl",gi);const kd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],qR=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],ZR=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=A.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:""}),[l,c]=A.useState(!1),[f,p]=A.useState(!1),[d,x]=A.useState(!1),[g,y]=A.useState(!1),[k,w]=A.useState(null);A.useEffect(()=>{if(t)if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const C=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(C).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():""}),t.data_waznosci){let C;if(typeof t.data_waznosci=="string")C=new Date(t.data_waznosci);else{const Q=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;C=new Date(Q)}w(isNaN(C.getTime())?null:C)}else w(null)},[t]);const _=C=>{o(Q=>({...Q,typ:C})),p(!1)},S=()=>{p(!f)},P=C=>{o(Q=>({...Q,objetosc:C})),x(!1)},T=()=>{x(!d)},z=()=>{y(!g)},Z=C=>{w(C),o(Q=>({...Q,data_waznosci:C?C.toISOString().split("T")[0]:""})),y(!1)};A.useEffect(()=>{const C=j=>{const te=j.target;f&&!te.closest(".dropdown-container")&&p(!1),d&&!te.closest(".dropdown-container")&&x(!1),g&&!te.closest(".react-datepicker")&&!te.closest('button[title*="wanoci"]')&&y(!1)},Q=j=>{j.key==="Escape"&&(p(!1),x(!1),y(!1))};return(f||d||g)&&(document.addEventListener("mousedown",C),document.addEventListener("keydown",Q)),()=>{document.removeEventListener("mousedown",C),document.removeEventListener("keydown",Q)}},[f,d,g]);const L=async C=>{if(C&&C.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0})})).ok)throw new Error("Failed to update item");const j={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(te){console.error("Error creating price history record:",te)}r(j),at.success("Pozycja zostaa zaktualizowana pomylnie"),n()}catch(Q){console.error("Error updating item:",Q),at.error("Bd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:h.jsx(Pr,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycj"}),h.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsx("form",{onSubmit:L,className:"space-y-6 flex-grow",children:h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),h.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),h.jsx("input",{type:"text",value:a.sprzedawca,onChange:C=>o(Q=>({...Q,sprzedawca:C.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),h.jsxs("div",{className:"relative dropdown-container",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:S,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&kd.find(C=>C.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[h.jsx("span",{className:"truncate",children:a.typ&&kd.find(C=>C.value===a.typ)?.label||"Wybierz typ"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:kd.map(C=>h.jsx("button",{type:"button",onClick:()=>_(C.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${C.color}`,children:C.label},C.value))})]})]}),h.jsxs("div",{className:"relative dropdown-container",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objto"}),h.jsxs("div",{className:"relative",children:[h.jsxs("button",{type:"button",onClick:T,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[h.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),h.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&h.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:qR.map(C=>h.jsx("button",{type:"button",onClick:()=>P(C.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:C.label},C.value))})]})]}),h.jsxs("div",{className:"relative",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data wanoci"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"text",value:k?k.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz dat",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),h.jsx("button",{type:"button",onClick:z,className:`p-1 focus:outline-none ${k?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:k?`Termin wanoci: ${k.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:h.jsx(Xd,{size:16})})]}),g&&h.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:h.jsx(As,{selected:k,onChange:Z,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>y(!1)})})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa ()"}),h.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:C=>o(Q=>({...Q,cena:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzeday (z)"}),h.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:C=>o(Q=>({...Q,cena_sprzedazy:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:L,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},JR=`
  .react-tooltip {
    z-index: 9999 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
`,_d=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],eM=({refreshTrigger:e,productReceipts:n=[]})=>{A.useEffect(()=>{const ne=document.createElement("style");return ne.textContent=JR,document.head.appendChild(ne),()=>{document.head.removeChild(ne)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=A.useState([]),[a,o]=A.useState([]),[l,c]=A.useState([]),[f,p]=A.useState(!0),[d,x]=A.useState(null),[g,y]=A.useState(""),[k,w]=A.useState("nazwa"),[_,S]=A.useState("asc"),[P,T]=A.useState(30),[z,Z]=A.useState([]),[L,C]=A.useState({}),[Q,j]=A.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[te,X]=A.useState(!1),[U,ue]=A.useState(null),[le,ae]=A.useState({}),pe=A.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const ne=new Map;try{for(const Se of n)if(Array.isArray(Se.products))for(const Ee of Se.products)Ee.kod&&!ne.has(Ee.kod)&&ne.set(Ee.kod,Se.sprzedawca)}catch(Se){console.error("Error building sprzedawcaCache:",Se)}return console.log("sprzedawcaCache built with",ne.size,"entries"),ne},[n]),V=A.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const ne=new Map;try{const Se=Ee=>{let Fe=null;return n.forEach(qe=>{if(Array.isArray(qe.products)&&qe.products.some(it=>it.kod===Ee)){const it=new Date(qe.dataPrzyjecia);(!Fe||it<Fe)&&(Fe=it)}}),a.forEach(qe=>{if(qe.kod===Ee&&qe.created_at){const it=new Date(qe.created_at);(!Fe||it<Fe)&&(Fe=it)}}),Fe};for(const Ee of t){const Fe=Se(Ee.kod);if(Fe){const it=Math.max(1,Math.ceil((new Date().getTime()-Fe.getTime())/(1e3*60*60*24))),kt=a.filter(bt=>bt.kod===Ee.kod).reduce((bt,Rt)=>bt+Rt.ilosc,0);ne.set(Ee.kod,kt/it)}else ne.set(Ee.kod,0)}}catch(Se){console.error("Error building averageSalesCache:",Se)}return console.log("averageSalesCache built with",ne.size,"entries"),ne},[t,a,n]),se=async()=>{try{const ne=await fetch("/api/products");if(ne.ok){const Se=await ne.json(),Ee={};Se.forEach(Fe=>{Ee[Fe.kod]||(Ee[Fe.kod]=[]),Ee[Fe.kod].push({cena:Fe.cena,ilosc_aktualna:Fe.ilosc_aktualna,data_zmiany:Fe.updated_at||Fe.created_at})}),Object.keys(Ee).forEach(Fe=>{Ee[Fe].sort((qe,it)=>new Date(it.data_zmiany).getTime()-new Date(qe.data_zmiany).getTime())}),ae(Ee)}}catch(ne){console.error("Error loading all products:",ne)}},M=async()=>{try{console.log("Starting loadInventory..."),p(!0),x(null),console.log("Fetching working-sheets...");const ne=await fetch("/api/working-sheets");if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const Se=await ne.json();console.log("Inventory data from server:",Se.length,"items"),Se.length>0&&(console.log("First item keys:",Object.keys(Se[0])),console.log("First item typ value:",Se[0].typ),Se[0].data_waznosci&&(console.log("First item data_waznosci:",Se[0].data_waznosci),console.log("First item data_waznosci type:",typeof Se[0].data_waznosci),console.log("First item data_waznosci formatted:",He(Se[0].data_waznosci)))),r(Se),console.log("Fetching orders...");const Ee=await fetch("/api/orders");if(!Ee.ok)throw new Error(`HTTP error! status: ${Ee.status}`);const Fe=await Ee.json();console.log("Orders data from server:",Fe.length,"items"),c(Fe),console.log("Fetching orders-with-products...");const qe=await fetch("/api/orders-with-products");if(!qe.ok)throw new Error(`HTTP error! status: ${qe.status}`);const it=await qe.json();console.log("Orders with products from server:",it.length,"items");const kt=[];it.forEach(bt=>{bt.products&&bt.products.forEach(Rt=>{kt.push({...Rt,orderId:bt.id,created_at:Rt.created_at||bt.data_utworzenia})})}),console.log("Total order products:",kt.length),o(kt),await se(),console.log("loadInventory completed successfully")}catch(ne){console.error("Error loading inventory:",ne),x(`Failed to load inventory: ${ne instanceof Error?ne.message:"Unknown error"}`)}finally{p(!1)}};A.useEffect(()=>{M()},[]),A.useEffect(()=>{e&&M()},[e]);const H=ne=>{k===ne?S(_==="asc"?"desc":"asc"):(w(ne),S("asc"))},O=ne=>{const Se=new Date;Se.setDate(Se.getDate()-P);const Ee=a.filter(qe=>qe.kod===ne&&new Date(qe.created_at)>=Se);return Ee.length===0?0:Ee.reduce((qe,it)=>qe+it.ilosc,0)/P},E=ne=>{const Se=_d.find(Ee=>Ee.value===ne);return Se?Se.color:"bg-gray-100 text-gray-800 border-gray-200"},I=ne=>ne===1/0?"bg-gray-100 text-gray-800 border-gray-200":ne<=30?"bg-red-100 text-gray-800 border-red-200":ne<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",R=A.useMemo(()=>{const ne=new Set;return t.forEach(Se=>{const Ee=Se.sprzedawca||pe.get(Se.kod);Ee&&ne.add(Ee)}),Array.from(ne).sort()},[t,pe]),W=A.useMemo(()=>{const ne=new Set;return t.forEach(Se=>{Se.typ&&ne.add(Se.typ)}),Array.from(ne).sort()},[t]),ie=A.useMemo(()=>{const ne=new Set;return t.forEach(Se=>{Se.objetosc&&ne.add(Se.objetosc.toString())}),Array.from(ne).sort((Se,Ee)=>parseFloat(Se)-parseFloat(Ee))},[t]),de=A.useMemo(()=>{const ne=new Set;return t.forEach(Se=>{const Ee=V.get(Se.kod)||0,Fe=Ee<=0?1/0:Math.floor(Se.ilosc/Ee),qe=Fe===1/0?"Brak danych":Fe<=30?"mao":Fe<=60?"rednie":"duo";ne.add(qe)}),Array.from(ne).sort()},[t,V]),he=t.filter(ne=>{if(!(ne.kod.toLowerCase().includes(g.toLowerCase())||ne.nazwa.toLowerCase().includes(g.toLowerCase())||ne.kod_kreskowy&&ne.kod_kreskowy.toLowerCase().includes(g.toLowerCase()))||Q.sprzedawca&&(ne.sprzedawca||pe.get(ne.kod))!==Q.sprzedawca||Q.typ&&ne.typ!==Q.typ||Q.objetosc&&ne.objetosc?.toString()!==Q.objetosc)return!1;if(Q.status){const Ee=V.get(ne.kod)||0,Fe=Ee<=0?1/0:Math.floor(ne.ilosc/Ee);if((Fe===1/0?"Brak danych":Fe<=30?"mao":Fe<=60?"rednie":"duo")!==Q.status)return!1}return!0}).sort((ne,Se)=>{let Ee,Fe;switch(k){case"sprzedawca":Ee=ne.sprzedawca||pe.get(ne.kod)||"",Fe=Se.sprzedawca||pe.get(Se.kod)||"";break;case"cena":Ee=ne.cena||0,Fe=Se.cena||0;break;case"cena_sprzedazy":Ee=ne.cena_sprzedazy||0,Fe=Se.cena_sprzedazy||0;break;case"srednieZuzycie":Ee=V.get(ne.kod)||0,Fe=V.get(Se.kod)||0;break;case"dniPozostalo":const qe=V.get(ne.kod)||0,it=V.get(Se.kod)||0;Ee=qe<=0?1/0:Math.floor(ne.ilosc/qe),Fe=it<=0?1/0:Math.floor(Se.ilosc/it);break;case"dataWyczerpania":const kt=V.get(ne.kod)||0,bt=V.get(Se.kod)||0,Rt=kt<=0?1/0:Math.floor(ne.ilosc/kt),Ot=bt<=0?1/0:Math.floor(Se.ilosc/bt);Ee=Rt===1/0?1/0:new Date().setDate(new Date().getDate()+Rt),Fe=Ot===1/0?1/0:new Date().setDate(new Date().getDate()+Ot);break;case"status":const ht=xt=>{const pt=V.get(xt.kod)||0,Mt=pt<=0?1/0:Math.floor(xt.ilosc/pt);return Mt===1/0?3:Mt<=30?0:Mt<=60?1:2};Ee=ht(ne),Fe=ht(Se);break;case"typ":Ee=ne.typ||"",Fe=Se.typ||"";break;case"objetosc":Ee=ne.objetosc||0,Fe=Se.objetosc||0;break;case"dataWaznosci":const Tt=xt=>{if(!xt)return 0;let pt;if(typeof xt=="string")pt=new Date(xt);else if(typeof xt=="number")xt<1e12?pt=new Date(xt*1e3):pt=new Date(xt);else return 0;return isNaN(pt.getTime())?0:pt.getTime()};Ee=Tt(ne.data_waznosci),Fe=Tt(Se.data_waznosci);break;case"sprzedaze":const et=a.filter(xt=>xt.kod===ne.kod).length,vt=a.filter(xt=>xt.kod===Se.kod).length;Ee=et,Fe=vt;break;default:Ee=ne[k],Fe=Se[k]}return typeof Ee=="string"&&typeof Fe=="string"?_==="asc"?Ee.localeCompare(Fe):Fe.localeCompare(Ee):typeof Ee=="number"&&typeof Fe=="number"?_==="asc"?Ee-Fe:Fe-Ee:0}),oe=ne=>{Z(ne?he.map(Se=>Se.id):[])},ee=(ne,Se)=>{Z(Ee=>Se?[...Ee,ne]:Ee.filter(Fe=>Fe!==ne))},re=ne=>{C(Se=>({...Se,[ne]:Math.max(0,(Se[ne]||0)-1)}))},F=(ne,Se)=>{C(Ee=>({...Ee,[ne]:Math.min(Se,(Ee[ne]||0)+1)}))},Ce=()=>{if(z.length!==1){at.error("Wybierz dokadnie jedn pozycj do edycji");return}const ne=t.find(Se=>Se.id===z[0]);ne&&(ue(ne),X(!0))},De=ne=>{r(Se=>Se.map(Ee=>Ee.id===ne.id?ne:Ee)),Z([])},Ve=he.length>0&&he.every(ne=>z.includes(ne.id)),He=ne=>{if(!ne)return"-";let Se;if(typeof ne=="string")Se=new Date(ne);else if(typeof ne=="number")ne<1e12?Se=new Date(ne*1e3):Se=new Date(ne);else return"-";return isNaN(Se.getTime())?"-":Se.toLocaleDateString("pl-PL")},Ie=z.length>0?t.filter(ne=>z.includes(ne.id)):[];return f?h.jsx("div",{className:"flex justify-center items-center py-8",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):d?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("p",{className:"text-red-600 font-sora",children:d}),h.jsx("button",{onClick:M,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[h.jsxs("div",{className:"relative w-full max-w-xs",children:[h.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),h.jsx("input",{type:"text",value:g,onChange:ne=>y(ne.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),h.jsx("button",{onClick:Ce,disabled:z.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:h.jsx(Ku,{size:16})})]}),h.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[h.jsxs("div",{className:"flex flex-wrap gap-4",children:[h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykuw"}),h.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:Ie.length})]}),h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"czna ilo towaru"}),h.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:Ie.length>0?Ie.reduce((ne,Se)=>ne+(Se.ilosc||0),0):0})]}),h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru fakturowa"}),h.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[Ie.length>0?Ie.reduce((ne,Se)=>{const Ee=le[Se.kod]||[],Fe=Ee.reduce((qe,it)=>qe+it.cena*it.ilosc,0);if(Ee.length>0)return ne+Fe;{const qe=Se.cena||0,it=Se.ilosc||0;return ne+qe*it}},0).toFixed(2):"0.00"," "]})]}),h.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[h.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru w sprzeday"}),h.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[Ie.length>0?Ie.reduce((ne,Se)=>{const Ee=Se.cena_sprzedazy||0,Fe=Se.ilosc||0;return ne+Ee*Fe},0).toFixed(2):"0.00"," z"]})]})]}),h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[h.jsx("div",{className:"relative",children:h.jsxs("select",{value:Q.sprzedawca,onChange:ne=>j(Se=>({...Se,sprzedawca:ne.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Sprzedawca"}),R.map(ne=>h.jsx("option",{value:ne,children:ne},ne))]})}),h.jsx("div",{className:"relative",children:h.jsxs("select",{value:Q.typ,onChange:ne=>j(Se=>({...Se,typ:ne.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Typ"}),W.map(ne=>h.jsx("option",{value:ne,children:_d.find(Se=>Se.value===ne)?.label||ne},ne))]})}),h.jsx("div",{className:"relative",children:h.jsxs("select",{value:Q.objetosc,onChange:ne=>j(Se=>({...Se,objetosc:ne.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Objto"}),ie.map(ne=>h.jsxs("option",{value:ne,children:[ne," l"]},ne))]})}),h.jsx("div",{className:"relative",children:h.jsxs("select",{value:Q.status,onChange:ne=>j(Se=>({...Se,status:ne.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[h.jsx("option",{value:"",children:"Status"}),de.map(ne=>h.jsx("option",{value:ne,children:ne},ne))]})})]}),(Q.sprzedawca||Q.typ||Q.objetosc||Q.status)&&h.jsx("button",{onClick:()=>j({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})]}),h.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:h.jsx("div",{className:"w-full overflow-y-scroll max-h-[500px] relative",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:h.jsx("input",{type:"checkbox",checked:Ve,onChange:ne=>oe(ne.target.checked)})}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("kod"),children:"Kod"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("nazwa"),children:"Nazwa"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("sprzedawca"),children:"Sprzedawca"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("ilosc"),children:"Ilo"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("typ"),children:"Typ"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("objetosc"),children:"Objto"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("cena"),children:"Cena fakturowa"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("cena_sprzedazy"),children:"Cena w sprzeday"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("dataWaznosci"),children:"Data wanoci"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("sprzedaze"),children:"Sprzedae"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("srednieZuzycie"),children:"rednie zuycie/dzie"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("dniPozostalo"),children:"Dni pozostao"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("dataWyczerpania"),children:"Data wyczerpania zapasw"}),h.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("status"),children:"Status"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:he.map(ne=>{O(ne.kod);const Se=V.get(ne.kod)||0;return Se<=0||Math.floor(ne.ilosc/Se),h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:h.jsx("input",{type:"checkbox",checked:z.includes(ne.id),onChange:Ee=>ee(ne.id,Ee.target.checked)})}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",children:h.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:ne.kod})}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",children:h.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:ne.nazwa})}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ne.sprzedawca||pe.get(ne.kod)||""}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ne.ilosc}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ne.typ?h.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${E(ne.typ)}`,children:_d.find(Ee=>Ee.value===ne.typ)?.label||ne.typ}):"-"}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ne.objetosc?`${ne.objetosc} l`:"-"}),h.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${ne.kod}`,onMouseEnter:()=>{le[ne.kod]||se()},children:[ne.cena?`${ne.cena.toFixed(2)} `:"-",h.jsx(Pv,{id:`price-tooltip-${ne.kod}`,className:"max-w-md",place:"top",children:h.jsxs("div",{className:"font-sora",children:[h.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),le[ne.kod]&&le[ne.kod].length>0?le[ne.kod].map((Ee,Fe)=>h.jsxs("div",{className:"mb-1",children:[h.jsxs("span",{className:"font-medium",children:[Ee.cena.toFixed(2)," "]}),h.jsxs("span",{className:"text-gray-500 ml-2",children:["(",Ee.ilosc_aktualna," szt.)"]})]},Fe)):h.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ne.cena_sprzedazy?`${ne.cena_sprzedazy.toFixed(2)} z`:"-"}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:He(ne.data_waznosci)}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ee=a.filter(Ot=>Ot.kod===ne.kod);console.log(`Sales for ${ne.kod}:`,Ee.length);const Fe={};Ee.forEach(Ot=>{const ht=l.find(xt=>xt.id===Ot.orderId),Tt=ht?ht.klient:"",et=ht?new Date(ht.data_utworzenia).toLocaleDateString("pl-PL"):Ot.created_at?new Date(Ot.created_at).toLocaleDateString("pl-PL"):"",vt=et+"|"+Tt;Fe[vt]||(Fe[vt]={qty:0,klient:Tt,date:et}),Fe[vt].qty+=Ot.ilosc});const qe=Object.entries(Fe);if(console.log(`Sales array for ${ne.kod}:`,qe.length),qe.length===0)return h.jsx("div",{className:"text-gray-400",children:"-"});const it=L[ne.kod]||0,kt=Math.max(0,qe.length-5),bt=qe.length>5;if(qe.length===0)return h.jsx("div",{className:"text-gray-400",children:"-"});const Rt=qe.slice(it,it+5);return h.jsxs("div",{className:"flex items-center gap-1",children:[bt&&it>0&&h.jsx("button",{onClick:()=>re(ne.kod),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:h.jsx(m2,{size:12})}),h.jsx("div",{className:"flex flex-row gap-1",children:Rt.map(([Ot,ht],Tt)=>h.jsxs("div",{className:"w-5 h-5 bg-blue-100 border border-blue-300 rounded flex items-center justify-center text-xs font-bold cursor-pointer hover:bg-blue-200 relative","data-tooltip-id":`sales-tooltip-${ne.kod}-${it+Tt}`,...ht.date&&ht.klient?{"data-tooltip-content":`${ht.date} | ${ht.klient}`}:{},children:[ht.qty,h.jsx(Pv,{id:`sales-tooltip-${ne.kod}-${it+Tt}`,className:"max-w-md",place:"top"})]},Ot+Tt))}),bt&&it<kt&&h.jsx("button",{onClick:()=>F(ne.kod,kt),className:"w-4 h-4 bg-gray-200 hover:bg-gray-300 rounded flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:h.jsx(x2,{size:12})})]})})()}),h.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(V.get(ne.kod)||0).toFixed(2),"/dzie"]}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ee=V.get(ne.kod)||0,Fe=Ee<=0?1/0:Math.floor(ne.ilosc/Ee);return Fe===1/0?"":Fe})()}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ee=V.get(ne.kod)||0,Fe=Ee<=0?1/0:Math.floor(ne.ilosc/Ee);if(Fe===1/0)return"-";const qe=new Date;return qe.setDate(qe.getDate()+Fe),qe.toLocaleDateString("pl-PL")})()}),h.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const Ee=V.get(ne.kod)||0,Fe=Ee<=0?1/0:Math.floor(ne.ilosc/Ee),qe=Fe===1/0?"Brak danych":Fe<=30?"mao":Fe<=60?"rednie":"duo";return h.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${I(Fe)}`,children:qe})})()})]},ne.id)})})]})})}),h.jsx(ZR,{isOpen:te,onClose:()=>{X(!1),ue(null)},item:U,onSave:De})]})};xi("pl",gi);const tM=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=A.useState(new Date),[o,l]=A.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=A.useState([]),[p,d]=A.useState(new Set),[x,g]=A.useState(!1),[y,k]=A.useState(""),[w,_]=A.useState(""),[S,P]=A.useState(!1),[T,z]=A.useState(null);A.useEffect(()=>{const te=setTimeout(async()=>{if(y.trim().length<2||S){f([]);return}g(!0);try{const X=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(y)}`);if(!X.ok)throw new Error("Failed to fetch orders");const U=await X.json();if(U&&U.length>0){const ue=U.map(le=>({id:le.id,nazwa:`Zamwienie: ${le.numer_zamowienia}`,kod:le.klient,klient:le.klient,numer_zamowienia:le.numer_zamowienia,products:le.products||[]}));f(ue)}else f([])}catch(X){console.error("Error searching orders:",X),f([])}finally{g(!1)}},300);return()=>clearTimeout(te)},[y,S]);const Z=(j,te)=>{if(j.numer_zamowienia){if(_(j.klient),z(j.id),j.products&&j.products.length>0){const X=j.products.map(U=>({nazwa:U.nazwa,ilosc:U.ilosc,original_ilosc:U.ilosc,powod_zwrotu:""}));l(X)}f([]),k(j.numer_zamowienia),P(!0),at.success("Zamwienie wybrane")}else{const X=[...o];X[te]={...X[te],nazwa:j.nazwa,ilosc:0,original_ilosc:0},l(X)}},L=()=>{const j=new Set;return o.forEach((te,X)=>{const U=te.original_ilosc,ue=o[X].ilosc;!te.nazwa.trim()||!ue||ue<=0||!te.powod_zwrotu?j.add(X):ue>U&&(j.add(X),at.error(`Ilo zwrotu (${ue}) nie moe przekracza iloci w zamwieniu (${U})`))}),d(j),j.size===0},C=async()=>{if(!L()){at.error("Prosz wypeni wszystkie wymagane pola");return}try{const j={klient:w,data_zwrotu:r,products:o,orderId:T},te=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(!te.ok){const U=await te.json();throw new Error(U.error||"Failed to create return")}const X=await te.json();console.log("Return created:",X),t(j),at.success(`Zwrot zosta utworzony: ${X.numer_zwrotu}`),n(),k(""),_(""),P(!1),z(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),d(new Set)}catch(j){console.error("Error creating return:",j),at.error("Bd podczas tworzenia zwrotu")}},Q=()=>{n(),k(""),_(""),P(!1),z(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),d(new Set)};return h.jsx(Pr,{isOpen:e,onRequestClose:Q,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:h.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[h.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),h.jsx("button",{onClick:Q,className:"text-red-500 focus:outline-none",children:h.jsx(Yt,{size:20})})]}),h.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{className:"flex flex-wrap gap-4",children:[h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),h.jsx(As,{selected:r,onChange:j=>a(j||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),h.jsxs("div",{className:"w-[200px]",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",value:y,onChange:j=>{k(j.target.value),P(!1),z(null)},placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),x&&h.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:h.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&y.trim().length>=2&&h.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(j=>h.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>Z(j,-1),children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"text-[10px]",children:j.nazwa}),h.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",j.klient]})]})},j.id))})]})]})]})}),w&&h.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),h.jsx("p",{className:"text-xs text-gray-900",children:w})]})}),h.jsx("button",{onClick:()=>_(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:h.jsx(Yt,{size:16})})]})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((j,te)=>h.jsx("div",{className:"relative",children:h.jsxs("div",{className:"flex",children:[h.jsx("div",{className:"relative flex-1 max-w-[50%]",children:h.jsx("input",{type:"text",value:j.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),h.jsx("div",{className:"w-20 ml-2",children:h.jsx("input",{type:"number",min:"1",max:j.original_ilosc,value:o[te].ilosc||"",onChange:X=>{const U=[...o],ue=X.target.value===""?0:parseInt(X.target.value)||0;U[te]={...U[te],ilosc:ue},l(U)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilo"})}),h.jsx("div",{className:"w-40 ml-2",children:h.jsxs("select",{value:o[te].powod_zwrotu,onChange:X=>{const U=[...o];U[te]={...U[te],powod_zwrotu:X.target.value},l(U)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[h.jsx("option",{value:"",children:"Powd zwrotu"}),h.jsx("option",{value:"Bd w zamwieniu",children:"Bd w zamwieniu"}),h.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),h.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&h.jsx("button",{onClick:()=>{const X=o.filter((U,ue)=>ue!==te);l(X)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:h.jsx(Yt,{size:16})})]})},te))]})]}),h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:h.jsx("button",{onClick:C,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwrz zwrot"})}),h.jsx("div",{className:"absolute bottom-4 right-4",children:h.jsx("button",{onClick:Q,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})},rM=e=>(e(!0),!0);Pr.setAppElement("#root");const Jt="";console.log("API_URL configured as:",Jt);function nM(){const[e,n]=A.useState(!1),[t,r]=A.useState(!1),[a,o]=A.useState(!1),[l,c]=A.useState(!1),[f,p]=A.useState(!1),[d,x]=A.useState(null),[g,y]=A.useState(null),[k,w]=A.useState(null),[_,S]=A.useState(null),[P,T]=A.useState(!0),[z,Z]=A.useState(["inventory","clients","orders","inventoryStatus"]),[L,C]=A.useState({sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:"inventory",activeSubTab:"przyjecie",isDbInitialized:!1}),[Q,j]=A.useState(!1),[te,X]=A.useState(!1),[U,ue]=A.useState(!1),[le,ae]=A.useState(!1),[pe,V]=A.useState(null),[se,M]=A.useState(!1),[H,O]=A.useState(null),[E,I]=A.useState(!1),[R,W]=A.useState(null),[ie,de]=A.useState(0),[he,oe]=A.useState(0),[ee,re]=A.useState(null),[F,Ce]=A.useState("");A.useEffect(()=>{(async()=>{try{T(!0),console.log(" Starting data loading process..."),console.log(" API_URL:",Jt),console.log(" Loading clients...");const Le=await xt();console.log(" Clients loaded:",Le.length),console.log(" Loading products...");const ze=await pt();console.log(" Products loaded:",ze.length),console.log(" Loading product receipts...");const Ke=await Mt();console.log(" Product receipts loaded:",Ke.length),console.log(" Updating app state with loaded data..."),console.log(" Setting clients:",Le),C(tt=>{const Ct={...tt,clients:Le,products:ze,productReceipts:Ke};return console.log(" New app state:",Ct),Ct}),console.log(" App state updated successfully"),console.log(" Final data counts:"),console.log("   - Clients:",Le.length),console.log("   - Products:",ze.length),console.log("   - Product Receipts:",Ke.length)}catch(Le){console.error(" Error loading data:",Le),at.error("Bd podczas adowania danych")}finally{T(!1),console.log(" Data loading process completed")}})()},[]),A.useEffect(()=>{if(!L.isDbInitialized)return;console.log(" useEffect triggered - clients changed:",L.clients.length),(async()=>{const Le={sheets:L.sheets,sheetsData:L.sheetsData,activeSheet:L.activeSheet,showTable:L.showTable,clients:L.clients,products:L.products,productReceipts:L.productReceipts};try{localStorage.setItem("appState",JSON.stringify(Le)),console.log("App state saved to localStorage")}catch(ze){console.error("Error saving state to localStorage:",ze)}})()},[L.sheetsData,L.sheets,L.activeSheet,L.showTable,L.clients,L.products,L.productReceipts]);const De=async()=>{try{T(!0),console.log(" Loading sheets from database..."),console.log(" Making request to:",`${Jt}/api/original-sheets`);const me=await fetch(`${Jt}/api/original-sheets`);if(console.log(" Sheets response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Le=await me.json();console.log(" Received sheets from server:",Le),console.log(" Sheets count:",Le.length);const ze=Le.map(Ke=>({fileName:Ke.fileName,data:{headers:Ke.data.headers,rows:Ke.data.rows}}));console.log(" Processed sheets:",ze),console.log(" Processed sheets count:",ze.length),C(Ke=>({...Ke,sheets:ze,sheetsData:ze,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log(" App state updated with sheets data")}catch(me){console.error("     :",me),at.error("    ")}finally{T(!1),console.log(" Loading sheets completed")}};A.useEffect(()=>{De()},[]);const Ve=async(me,Le)=>{console.log("handleExcelUpload called with:",{newFileName:me,fileData:Le});try{const ze=await fetch(`${Jt}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:me,data:Le})});if(!ze.ok){if(ze.status===409){at.error("Moe by tylko jeden plik Excel. Usu istniejcy plik przed zaadowaniem nowego.");return}throw new Error(`HTTP error! status: ${ze.status}`)}await De(),n(!1)}catch(ze){console.error("Error saving file data:",ze),at.error("Bd podczas zapisywania danych pliku")}},He=(me,Le)=>{const ze=`${Jt}/api/download_file/${encodeURIComponent(me.fileName)}`;window.open(ze,"_blank")},Ie=me=>{w(me)},ne=me=>{me.preventDefault()},Se=me=>{!k||k===me||(Z(Le=>{const ze=[...Le],Ke=ze.indexOf(k),tt=ze.indexOf(me);return ze.splice(Ke,1),ze.splice(tt,0,k),ze}),w(null))},Ee=me=>{(me==="inventory"||me==="clients"||me==="orders"||me==="inventoryStatus")&&C(Le=>({...Le,activeTab:me,activeSubTab:me==="inventory"?"przyjecie":null}))},Fe=me=>{C(Le=>({...Le,activeSubTab:me}))},qe=me=>{switch(me){case"inventory":return"Zakup towaru";case"clients":return"Klienci";case"orders":return"Zamwienia";case"inventoryStatus":return"Stany magazynowe";default:return me}},it=()=>{g&&(c(!1),n(!1))},kt=async me=>{try{console.log(" Starting handleAddProduct..."),console.log(" Received data:",me),console.log(" Files check:",{hasProductInvoice:!!me.productInvoice,hasTransportInvoice:!!me.transportInvoice,productInvoice:me.productInvoice,transportInvoice:me.transportInvoice}),console.log(" Making request to:",`${Jt}/api/product-receipts`);let Le;if(me.productInvoice||me.transportInvoice){console.log(" Files detected, using FormData...");const tt=new FormData,Ct={date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,products:me.products};tt.append("data",JSON.stringify(Ct)),console.log(" JSON data:",Ct),me.productInvoice&&(tt.append("productInvoice",me.productInvoice),console.log(" Product invoice added:",me.productInvoice.name)),me.transportInvoice&&(tt.append("transportInvoice",me.transportInvoice),console.log(" Transport invoice added:",me.transportInvoice.name)),console.log(" FormData entries:");for(let[zt,Vt]of tt.entries())console.log(`  ${zt}:`,Vt);Le=await fetch(`${Jt}/api/product-receipts`,{method:"POST",body:tt})}else{console.log(" No files, using JSON...");const tt={date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,products:me.products};console.log(" JSON data:",tt),Le=await fetch(`${Jt}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)})}if(console.log(" Response status:",Le.status),console.log(" Response headers:",Le.headers),!Le.ok){const tt=await Le.text();throw console.error(" Response error text:",tt),new Error(`Failed to save product receipt: ${Le.status} - ${tt}`)}const ze=await Le.json();if(console.log(" Saved receipt:",ze),ze.workingSheetsUpdated||ze.workingSheetsInserted){let tt="Dodano nowy towar";ze.workingSheetsUpdated>0&&(tt+=` (${ze.workingSheetsUpdated}    working sheets)`),ze.workingSheetsInserted>0&&(tt+=` (${ze.workingSheetsInserted}     working sheets)`),at.success(tt)}else at.success("Dodano nowy towar");console.log(" Loading updated receipts...");const Ke=await Mt();console.log(" Updated receipts:",Ke),console.log(" Updating app state..."),C(tt=>{const Ct={...tt,productReceipts:Ke};return console.log(" New app state:",Ct),Ct}),o(!1)}catch(Le){console.error(" Error adding product:",Le),at.error("Wystpi bd podczas dodawania towaru")}},bt=me=>{O(me),M(!0)},Rt=async me=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",me),console.log(" Files check (update):",{hasProductInvoice:!!me.productInvoice,hasTransportInvoice:!!me.transportInvoice,productInvoice:me.productInvoice,transportInvoice:me.transportInvoice});try{let Le;if(me.productInvoice||me.transportInvoice){console.log(" Files detected (update), using FormData...");const Ct=new FormData,zt={date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,products:me.products};Ct.append("data",JSON.stringify(zt)),console.log(" JSON data (update):",zt),me.productInvoice&&(Ct.append("productInvoice",me.productInvoice),console.log(" Product invoice added (update):",me.productInvoice.name)),me.transportInvoice&&(Ct.append("transportInvoice",me.transportInvoice),console.log(" Transport invoice added (update):",me.transportInvoice.name)),console.log(" FormData entries (update):");for(let[Vt,wr]of Ct.entries())console.log(`  ${Vt}:`,wr);Le=await fetch(`${Jt}/api/product-receipts/${me.id}`,{method:"PUT",body:Ct})}else console.log(" No files (update), using JSON..."),Le=await fetch(`${Jt}/api/product-receipts/${me.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:me.date,sprzedawca:me.sprzedawca,wartosc:me.wartosc,kosztDostawy:me.kosztDostawy,products:me.products})});if(!Le.ok)throw new Error("Failed to update product receipt");const ze=await Le.json();console.log("Updated receipt:",ze),console.log("Loading updated receipts...");const Ke=await Mt();console.log("Updated receipts:",Ke),console.log("Loading updated products...");const tt=await pt();console.log("Updated products:",tt),console.log("Updating app state..."),C(Ct=>{const zt={...Ct,productReceipts:Ke,products:tt};return console.log("New app state:",zt),zt}),at.success("Zakup zosta zaktualizowany"),M(!1),O(null),p(!1),x(null)}catch(Le){console.error("Error updating product receipt:",Le),at.error("Wystpi bd podczas aktualizacji zakupu")}},Ot=async me=>{try{if(!(await fetch(`${Jt}/api/product-receipts/${me}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const ze=await Mt(),Ke=await pt();C(tt=>({...tt,productReceipts:ze,products:Ke})),at.success("Zakup zosta usunity")}catch(Le){console.error("Error deleting receipt:",Le),at.error("Wystpi bd podczas usuwania zakupu")}},ht=async me=>{try{const Le=await fetch(`${Jt}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(!Le.ok)throw new Error("Failed to add client");const ze=await Le.json(),Ke={...me,id:ze.id};C(tt=>({...tt,clients:[...tt.clients,Ke]})),oe(tt=>tt+1),at.success("Klient zosta dodany")}catch(Le){console.error("Error adding client:",Le),at.error("Bd podczas dodawania klienta")}},Tt=async me=>{try{if(!(await fetch(`${Jt}/api/clients/${me}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");C(ze=>({...ze,clients:ze.clients.filter(Ke=>Ke.id!==me)})),oe(ze=>ze+1),at.success("Klient zosta usunity")}catch(Le){console.error("Error deleting client:",Le),at.error("Bd podczas usuwania klienta")}},et=async me=>{try{console.log(" handleUpdateClient called with data:",me);const Le=await fetch(`${Jt}/api/clients/${me.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(!Le.ok)throw new Error("Failed to update client");const ze=await Le.json();console.log(" Client updated in database:",ze),console.log(" Updated client fields:",{id:ze.id,firma:ze.firma,nazwa:ze.nazwa,adres:ze.adres,czas_dostawy:ze.czas_dostawy,kontakt:ze.kontakt}),C(Ke=>{console.log(" Updating app state..."),console.log(" Previous clients:",Ke.clients),console.log(" Updated client data:",ze);const tt=Ke.clients.map(zt=>zt.id===me.id?(console.log(" Updating client:",zt.id,"from:",zt,"to:",{...zt,...ze}),{id:zt.id,firma:ze.firma||zt.firma,nazwa:ze.nazwa||zt.nazwa,adres:ze.adres||zt.adres,czas_dostawy:ze.czas_dostawy||zt.czas_dostawy,kontakt:ze.kontakt||zt.kontakt}):{...zt});console.log(" New clients array:",tt);const Ct={...Ke,clients:tt};return console.log(" New app state:",Ct),Ct}),at.success("Klient zosta zaktualizowany"),setTimeout(()=>{C(Ke=>(console.log(" Force update after timeout"),{...Ke})),oe(Ke=>Ke+1),re(me.id),xt().then(Ke=>{C(tt=>({...tt,clients:Ke})),oe(tt=>tt+1)})},100)}catch(Le){console.error("Error updating client:",Le),at.error("Bd podczas aktualizacji klienta")}},vt=async me=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",me),console.log("Products data:",JSON.stringify(me.products,null,2));try{const Le=await fetch(`${Jt}/api/orders/${me.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(!Le.ok)throw new Error("Failed to update order");const ze=await Le.json();console.log("Updated order result:",ze),at.success("Zamwienie zostao zaktualizowane"),de(Ke=>Ke+1)}catch(Le){console.error("Error updating order:",Le),at.error("Bd podczas aktualizacji zamwienia")}},xt=async()=>{try{console.log(" Loading clients from:",`${Jt}/api/clients`);const me=await fetch(`${Jt}/api/clients`);if(console.log(" Clients response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Le=await me.json();return console.log(" Loaded clients:",Le.length,"records"),console.log(" First client:",Le[0]),Le}catch(me){return console.error(" Error loading clients:",me),[]}},pt=async()=>{try{console.log(" Loading products from:",`${Jt}/api/products`);const me=await fetch(`${Jt}/api/products`);if(console.log(" Products response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Le=await me.json();console.log(" Loaded products:",Le.length,"records"),console.log(" First product:",Le[0]);const ze=Le.map(Ke=>({kod:Ke.kod,nazwa:Ke.nazwa,ilosc:Ke.ilosc,jednostka_miary:Ke.jednostka_miary||"",kod_kreskowy:Ke.kod_kreskowy||"",data_waznosci:Ke.data_waznosci??void 0,archiwalny:Ke.archiwalny,rezerwacje:Ke.rezerwacje,ilosc_na_poleceniach:Ke.ilosc_na_poleceniach,waga_netto:Ke.waga_netto,waga_brutto:Ke.waga_brutto,objetosc:Ke.objetosc,opis:Ke.opis}));return console.log(" Processed products:",ze.length,"records"),ze}catch(me){return console.error(" Error loading products:",me),[]}},Mt=async()=>{try{console.log(" Loading product receipts from:",`${Jt}/api/product-receipts`);const me=await fetch(`${Jt}/api/product-receipts`);if(console.log(" Product receipts response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Le=await me.json();return console.log(" Loaded product receipts:",Le.length,"records"),Le.map(ze=>({id:ze.id,dataPrzyjecia:ze.dataPrzyjecia,sprzedawca:ze.sprzedawca||"",wartosc:ze.wartosc||0,kosztDostawy:ze.kosztDostawy||0,products:ze.products||[],productInvoice:ze.productInvoice,transportInvoice:ze.transportInvoice}))}catch(me){return console.error(" Error loading product receipts:",me),[]}},$t=async me=>{try{console.log(" Searching working_sheets with query:",me),console.log(" Making request to:",`${Jt}/api/working-sheets/search?query=${encodeURIComponent(me)}`);const Le=await fetch(`${Jt}/api/working-sheets/search?query=${encodeURIComponent(me)}`);if(console.log(" Search response status:",Le.status),!Le.ok)throw new Error(`HTTP error! status: ${Le.status}`);const ze=await Le.json();return console.log(" Search results:",ze.length,"items found"),ze.map(tt=>({kod:tt.kod,nazwa:tt.nazwa,ilosc:tt.ilosc.toString(),kodKreskowy:tt.kod_kreskowy||""}))}catch(Le){return console.error(" Error searching working_sheets:",Le),[]}},Cn=()=>{de(me=>me+1)},vn=()=>{de(me=>me+1)};return h.jsxs("div",{className:"min-h-screen bg-gray-100",children:[h.jsx(FR,{position:"top-right"}),h.jsx(hw,{isOpen:le,onClose:()=>ae(!1),product:pe}),h.jsx(MN,{isOpen:e,onClose:()=>n(!1),onUpload:Ve}),h.jsx(IN,{isOpen:l,onClose:()=>c(!1),fileName:g||"",onConfirm:it}),h.jsx(LP,{isOpen:a,onClose:()=>o(!1),onSubmit:kt}),h.jsx(IR,{isOpen:t,onClose:()=>r(!1),onAdd:ht}),h.jsx(gw,{isOpen:E,onClose:()=>{I(!1),W(null)},onSubmit:et,client:R}),h.jsx(mw,{isOpen:f,onClose:()=>p(!1),receipt:d}),h.jsx(xw,{isOpen:se,onClose:()=>{M(!1),O(null)},onSubmit:Rt,receipt:H}),h.jsx(AR,{isOpen:Q,onClose:()=>j(!1),onOrderCreated:Cn}),h.jsx(tM,{isOpen:te,onClose:()=>X(!1),onSubmit:vn}),h.jsx("div",{className:"bg-white shadow-sm",children:h.jsx("div",{className:"container mx-auto px-4 py-3",children:h.jsx("img",{src:MR,alt:"Enoterra Logo",className:"h-32"})})}),h.jsx("div",{className:"bg-gray-100",children:h.jsx("div",{className:"container mx-auto px-4",children:h.jsx("div",{className:"flex items-center h-14",children:h.jsx("div",{className:"flex space-x-4",children:z.map(me=>h.jsx("div",{draggable:!0,onDragStart:()=>Ie(me),onDragOver:ne,onDrop:()=>Se(me),className:`relative -mb-px cursor-pointer ${L.activeTab===me?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${k===me?"opacity-50":""}`,onClick:()=>Ee(me),children:h.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:qe(me)})},me))})})})}),h.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:h.jsxs("div",{className:"container mx-auto px-4 py-6",children:[h.jsxs("div",{className:"flex items-start -mt-2",children:[L.activeTab==="inventory"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[h.jsxs("div",{className:"flex",children:[h.jsx("button",{onClick:()=>Fe("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${L.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjcie towaru"}),h.jsx("button",{onClick:()=>Fe("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${L.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupw"}),h.jsx("button",{onClick:()=>Fe("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${L.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz patnoci"})]}),L.activeSubTab==="przyjecie"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:h.jsx(Js,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>rM(n),children:[h.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:h.jsx(g2,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),h.jsx(jR,{receipts:L.productReceipts,products:L.products,onDelete:Ot,onEdit:bt,onUpdate:Rt})]}),L.activeSubTab==="analiza"&&h.jsx("div",{className:"flex flex-col gap-4",children:h.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[h.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupw"}),h.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupw bdzie dostpna wkrtce."})]})}),L.activeSubTab==="kalendarz"&&h.jsx("div",{className:"flex flex-col gap-4 mt-6",children:h.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[h.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz patnoci"}),h.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza patnoci bdzie dostpna wkrtce."})]})})]}),L.activeTab==="inventory"&&h.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:L.sheets.map(me=>h.jsx("div",{className:"flex items-center gap-2",children:h.jsx("button",{onClick:Le=>He(me),title:":     ",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:me.fileName})},me.fileName))}),L.activeTab==="inventory"&&L.showTable&&L.activeSheet&&h.jsx("div",{className:"mt-6 bg-white",children:h.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:h.jsx(zP,{data:L.activeSheet.data})})}),L.activeTab==="clients"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:h.jsx(Js,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),h.jsx(zR,{clients:L.clients,onDelete:Tt,onEdit:me=>{W(me),I(!0)},onUpdate:et},`clients-${he}-${ee||"none"}`)]}),L.activeTab==="orders"&&h.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[h.jsx("div",{className:"mb-4",children:h.jsx("div",{className:"w-1/2 mx-auto",children:h.jsx(BP,{onSearch:$t})})}),h.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>j(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:h.jsx(Js,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),h.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>X(!0),children:[h.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:h.jsx(Yt,{size:16})}),h.jsx("div",{className:"px-2",children:h.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]})]}),h.jsx(RR,{onViewOrder:me=>{console.log("View order:",me)},onEditOrder:me=>{console.log("Edit order:",me)},onDeleteOrder:me=>{console.log("Delete order:",me)},onUpdateOrder:vt,refreshTrigger:ie})]}),L.activeTab==="inventoryStatus"&&h.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:h.jsx(eM,{productReceipts:L.productReceipts})})]}),_&&h.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:_})]})})]})}d2.createRoot(document.getElementById("root")).render(h.jsx(A.StrictMode,{children:h.jsx(nM,{})}));
