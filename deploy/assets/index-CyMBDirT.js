function s2(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Ku(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o2(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var Uf={exports:{}},Zi={},Hf={exports:{}},bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var px;function i2(){if(px)return bt;px=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.iterator;function g(W){return W===null||typeof W!="object"?null:(W=x&&W[x]||W["@@iterator"],typeof W=="function"?W:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function _(W,S,P){this.props=W,this.context=S,this.refs=w,this.updater=P||y}_.prototype.isReactComponent={},_.prototype.setState=function(W,S){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,S,"setState")},_.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function E(){}E.prototype=_.prototype;function A(W,S,P){this.props=W,this.context=S,this.refs=w,this.updater=P||y}var T=A.prototype=new E;T.constructor=A,k(T,_.prototype),T.isPureReactComponent=!0;var j=Array.isArray,ee=Object.prototype.hasOwnProperty,R={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function Q(W,S,P){var O,z={},H=null,re=null;if(S!=null)for(O in S.ref!==void 0&&(re=S.ref),S.key!==void 0&&(H=""+S.key),S)ee.call(S,O)&&!C.hasOwnProperty(O)&&(z[O]=S[O]);var ie=arguments.length-2;if(ie===1)z.children=P;else if(1<ie){for(var Z=Array(ie),ge=0;ge<ie;ge++)Z[ge]=arguments[ge+2];z.children=Z}if(W&&W.defaultProps)for(O in ie=W.defaultProps,ie)z[O]===void 0&&(z[O]=ie[O]);return{$$typeof:e,type:W,key:H,ref:re,props:z,_owner:R.current}}function M(W,S){return{$$typeof:e,type:W.type,key:S,ref:W.ref,props:W.props,_owner:W._owner}}function te(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function K(W){var S={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(P){return S[P]})}var B=/\/+/g;function fe(W,S){return typeof W=="object"&&W!==null&&W.key!=null?K(""+W.key):S.toString(36)}function ue(W,S,P,O,z){var H=typeof W;(H==="undefined"||H==="boolean")&&(W=null);var re=!1;if(W===null)re=!0;else switch(H){case"string":case"number":re=!0;break;case"object":switch(W.$$typeof){case e:case n:re=!0}}if(re)return re=W,z=z(re),W=O===""?"."+fe(re,0):O,j(z)?(P="",W!=null&&(P=W.replace(B,"$&/")+"/"),ue(z,S,P,"",function(ge){return ge})):z!=null&&(te(z)&&(z=M(z,P+(!z.key||re&&re.key===z.key?"":(""+z.key).replace(B,"$&/")+"/")+W)),S.push(z)),1;if(re=0,O=O===""?".":O+":",j(W))for(var ie=0;ie<W.length;ie++){H=W[ie];var Z=O+fe(H,ie);re+=ue(H,S,P,Z,z)}else if(Z=g(W),typeof Z=="function")for(W=Z.call(W),ie=0;!(H=W.next()).done;)H=H.value,Z=O+fe(H,ie++),re+=ue(H,S,P,Z,z);else if(H==="object")throw S=String(W),Error("Objects are not valid as a React child (found: "+(S==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":S)+"). If you meant to render a collection of children, use an array instead.");return re}function oe(W,S,P){if(W==null)return W;var O=[],z=0;return ue(W,O,"","",function(H){return S.call(P,H,z++)}),O}function he(W){if(W._status===-1){var S=W._result;S=S(),S.then(function(P){(W._status===0||W._status===-1)&&(W._status=1,W._result=P)},function(P){(W._status===0||W._status===-1)&&(W._status=2,W._result=P)}),W._status===-1&&(W._status=0,W._result=S)}if(W._status===1)return W._result.default;throw W._result}var V={current:null},le={transition:null},J={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:le,ReactCurrentOwner:R};function ae(){throw Error("act(...) is not supported in production builds of React.")}return bt.Children={map:oe,forEach:function(W,S,P){oe(W,function(){S.apply(this,arguments)},P)},count:function(W){var S=0;return oe(W,function(){S++}),S},toArray:function(W){return oe(W,function(S){return S})||[]},only:function(W){if(!te(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},bt.Component=_,bt.Fragment=t,bt.Profiler=a,bt.PureComponent=A,bt.StrictMode=r,bt.Suspense=f,bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,bt.act=ae,bt.cloneElement=function(W,S,P){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var O=k({},W.props),z=W.key,H=W.ref,re=W._owner;if(S!=null){if(S.ref!==void 0&&(H=S.ref,re=R.current),S.key!==void 0&&(z=""+S.key),W.type&&W.type.defaultProps)var ie=W.type.defaultProps;for(Z in S)ee.call(S,Z)&&!C.hasOwnProperty(Z)&&(O[Z]=S[Z]===void 0&&ie!==void 0?ie[Z]:S[Z])}var Z=arguments.length-2;if(Z===1)O.children=P;else if(1<Z){ie=Array(Z);for(var ge=0;ge<Z;ge++)ie[ge]=arguments[ge+2];O.children=ie}return{$$typeof:e,type:W.type,key:z,ref:H,props:O,_owner:re}},bt.createContext=function(W){return W={$$typeof:l,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:o,_context:W},W.Consumer=W},bt.createElement=Q,bt.createFactory=function(W){var S=Q.bind(null,W);return S.type=W,S},bt.createRef=function(){return{current:null}},bt.forwardRef=function(W){return{$$typeof:c,render:W}},bt.isValidElement=te,bt.lazy=function(W){return{$$typeof:p,_payload:{_status:-1,_result:W},_init:he}},bt.memo=function(W,S){return{$$typeof:h,type:W,compare:S===void 0?null:S}},bt.startTransition=function(W){var S=le.transition;le.transition={};try{W()}finally{le.transition=S}},bt.unstable_act=ae,bt.useCallback=function(W,S){return V.current.useCallback(W,S)},bt.useContext=function(W){return V.current.useContext(W)},bt.useDebugValue=function(){},bt.useDeferredValue=function(W){return V.current.useDeferredValue(W)},bt.useEffect=function(W,S){return V.current.useEffect(W,S)},bt.useId=function(){return V.current.useId()},bt.useImperativeHandle=function(W,S,P){return V.current.useImperativeHandle(W,S,P)},bt.useInsertionEffect=function(W,S){return V.current.useInsertionEffect(W,S)},bt.useLayoutEffect=function(W,S){return V.current.useLayoutEffect(W,S)},bt.useMemo=function(W,S){return V.current.useMemo(W,S)},bt.useReducer=function(W,S,P){return V.current.useReducer(W,S,P)},bt.useRef=function(W){return V.current.useRef(W)},bt.useState=function(W){return V.current.useState(W)},bt.useSyncExternalStore=function(W,S,P){return V.current.useSyncExternalStore(W,S,P)},bt.useTransition=function(){return V.current.useTransition()},bt.version="18.3.1",bt}var hx;function Nl(){return hx||(hx=1,Hf.exports=i2()),Hf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mx;function l2(){if(mx)return Zi;mx=1;var e=Nl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,h){var p,x={},g=null,y=null;h!==void 0&&(g=""+h),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(y=f.ref);for(p in f)r.call(f,p)&&!o.hasOwnProperty(p)&&(x[p]=f[p]);if(c&&c.defaultProps)for(p in f=c.defaultProps,f)x[p]===void 0&&(x[p]=f[p]);return{$$typeof:n,type:c,key:g,ref:y,props:x,_owner:a.current}}return Zi.Fragment=t,Zi.jsx=l,Zi.jsxs=l,Zi}var xx;function c2(){return xx||(xx=1,Uf.exports=l2()),Uf.exports}var d=c2(),D=Nl();const Ce=Ku(D),Iv=s2({__proto__:null,default:Ce},[D]);var Yc={},$f={exports:{}},vn={},Yf={exports:{}},Vf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function u2(){return gx||(gx=1,(function(e){function n(le,J){var ae=le.length;le.push(J);e:for(;0<ae;){var W=ae-1>>>1,S=le[W];if(0<a(S,J))le[W]=J,le[ae]=S,ae=W;else break e}}function t(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var J=le[0],ae=le.pop();if(ae!==J){le[0]=ae;e:for(var W=0,S=le.length,P=S>>>1;W<P;){var O=2*(W+1)-1,z=le[O],H=O+1,re=le[H];if(0>a(z,ae))H<S&&0>a(re,z)?(le[W]=re,le[H]=ae,W=H):(le[W]=z,le[O]=ae,W=O);else if(H<S&&0>a(re,ae))le[W]=re,le[H]=ae,W=H;else break e}}return J}function a(le,J){var ae=le.sortIndex-J.sortIndex;return ae!==0?ae:le.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],h=[],p=1,x=null,g=3,y=!1,k=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(le){for(var J=t(h);J!==null;){if(J.callback===null)r(h);else if(J.startTime<=le)r(h),J.sortIndex=J.expirationTime,n(f,J);else break;J=t(h)}}function j(le){if(w=!1,T(le),!k)if(t(f)!==null)k=!0,he(ee);else{var J=t(h);J!==null&&V(j,J.startTime-le)}}function ee(le,J){k=!1,w&&(w=!1,E(Q),Q=-1),y=!0;var ae=g;try{for(T(J),x=t(f);x!==null&&(!(x.expirationTime>J)||le&&!K());){var W=x.callback;if(typeof W=="function"){x.callback=null,g=x.priorityLevel;var S=W(x.expirationTime<=J);J=e.unstable_now(),typeof S=="function"?x.callback=S:x===t(f)&&r(f),T(J)}else r(f);x=t(f)}if(x!==null)var P=!0;else{var O=t(h);O!==null&&V(j,O.startTime-J),P=!1}return P}finally{x=null,g=ae,y=!1}}var R=!1,C=null,Q=-1,M=5,te=-1;function K(){return!(e.unstable_now()-te<M)}function B(){if(C!==null){var le=e.unstable_now();te=le;var J=!0;try{J=C(!0,le)}finally{J?fe():(R=!1,C=null)}}else R=!1}var fe;if(typeof A=="function")fe=function(){A(B)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,oe=ue.port2;ue.port1.onmessage=B,fe=function(){oe.postMessage(null)}}else fe=function(){_(B,0)};function he(le){C=le,R||(R=!0,fe())}function V(le,J){Q=_(function(){le(e.unstable_now())},J)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(le){le.callback=null},e.unstable_continueExecution=function(){k||y||(k=!0,he(ee))},e.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<le?Math.floor(1e3/le):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(le){switch(g){case 1:case 2:case 3:var J=3;break;default:J=g}var ae=g;g=J;try{return le()}finally{g=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(le,J){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var ae=g;g=le;try{return J()}finally{g=ae}},e.unstable_scheduleCallback=function(le,J,ae){var W=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?W+ae:W):ae=W,le){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=ae+S,le={id:p++,callback:J,priorityLevel:le,startTime:ae,expirationTime:S,sortIndex:-1},ae>W?(le.sortIndex=ae,n(h,le),t(f)===null&&le===t(h)&&(w?(E(Q),Q=-1):w=!0,V(j,ae-W))):(le.sortIndex=S,n(f,le),k||y||(k=!0,he(ee))),le},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(le){var J=g;return function(){var ae=g;g=J;try{return le.apply(this,arguments)}finally{g=ae}}}})(Vf)),Vf}var vx;function f2(){return vx||(vx=1,Yf.exports=u2()),Yf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yx;function d2(){if(yx)return vn;yx=1;var e=Nl(),n=f2();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},x={};function g(s){return f.call(x,s)?!0:f.call(p,s)?!1:h.test(s)?x[s]=!0:(p[s]=!0,!1)}function y(s,i,u,m){if(u!==null&&u.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function k(s,i,u,m){if(i===null||typeof i>"u"||y(s,i,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function w(s,i,u,m,v,b,N){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=u,this.propertyName=s,this.type=i,this.sanitizeURL=b,this.removeEmptyString=N}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){_[s]=new w(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];_[i]=new w(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){_[s]=new w(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){_[s]=new w(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){_[s]=new w(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){_[s]=new w(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){_[s]=new w(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){_[s]=new w(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){_[s]=new w(s,5,!1,s.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function A(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(E,A);_[i]=new w(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(E,A);_[i]=new w(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(E,A);_[i]=new w(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!1,!1)}),_.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){_[s]=new w(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,i,u,m){var v=_.hasOwnProperty(i)?_[i]:null;(v!==null?v.type!==0:m||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(k(i,u,v,m)&&(u=null),m||v===null?g(i)&&(u===null?s.removeAttribute(i):s.setAttribute(i,""+u)):v.mustUseProperty?s[v.propertyName]=u===null?v.type===3?!1:"":u:(i=v.attributeName,m=v.attributeNamespace,u===null?s.removeAttribute(i):(v=v.type,u=v===3||v===4&&u===!0?"":""+u,m?s.setAttributeNS(m,i,u):s.setAttribute(i,u))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ee=Symbol.for("react.element"),R=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),K=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),le=Symbol.iterator;function J(s){return s===null||typeof s!="object"?null:(s=le&&s[le]||s["@@iterator"],typeof s=="function"?s:null)}var ae=Object.assign,W;function S(s){if(W===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);W=i&&i[1]||""}return`
`+W+s}var P=!1;function O(s,i){if(!s||P)return"";P=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Ee){var m=Ee}Reflect.construct(s,[],i)}else{try{i.call()}catch(Ee){m=Ee}s.call(i.prototype)}else{try{throw Error()}catch(Ee){m=Ee}s()}}catch(Ee){if(Ee&&m&&typeof Ee.stack=="string"){for(var v=Ee.stack.split(`
`),b=m.stack.split(`
`),N=v.length-1,ne=b.length-1;1<=N&&0<=ne&&v[N]!==b[ne];)ne--;for(;1<=N&&0<=ne;N--,ne--)if(v[N]!==b[ne]){if(N!==1||ne!==1)do if(N--,ne--,0>ne||v[N]!==b[ne]){var ce=`
`+v[N].replace(" at new "," at ");return s.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",s.displayName)),ce}while(1<=N&&0<=ne);break}}}finally{P=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?S(s):""}function z(s){switch(s.tag){case 5:return S(s.type);case 16:return S("Lazy");case 13:return S("Suspense");case 19:return S("SuspenseList");case 0:case 2:case 15:return s=O(s.type,!1),s;case 11:return s=O(s.type.render,!1),s;case 1:return s=O(s.type,!0),s;default:return""}}function H(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case R:return"Portal";case M:return"Profiler";case Q:return"StrictMode";case fe:return"Suspense";case ue:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case K:return(s.displayName||"Context")+".Consumer";case te:return(s._context.displayName||"Context")+".Provider";case B:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case oe:return i=s.displayName||null,i!==null?i:H(s.type)||"Memo";case he:i=s._payload,s=s._init;try{return H(s(i))}catch{}}return null}function re(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(i);case 8:return i===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function ie(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Z(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ge(s){var i=Z(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),m=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,b=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return v.call(this)},set:function(N){m=""+N,b.call(this,N)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(N){m=""+N},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function xe(s){s._valueTracker||(s._valueTracker=ge(s))}function L(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),m="";return s&&(m=Z(s)?s.checked?"true":"false":s.value),s=m,s!==u?(i.setValue(s),!0):!1}function Ve(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Te(s,i){var u=i.checked;return ae({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function st(s,i){var u=i.defaultValue==null?"":i.defaultValue,m=i.checked!=null?i.checked:i.defaultChecked;u=ie(i.value!=null?i.value:u),s._wrapperState={initialChecked:m,initialValue:u,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Ge(s,i){i=i.checked,i!=null&&T(s,"checked",i,!1)}function de(s,i){Ge(s,i);var u=ie(i.value),m=i.type;if(u!=null)m==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?Le(s,i.type,u):i.hasOwnProperty("defaultValue")&&Le(s,i.type,ie(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function De(s,i,u){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var m=i.type;if(!(m!=="submit"&&m!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,u||i===s.value||(s.value=i),s.defaultValue=i}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function Le(s,i,u){(i!=="number"||Ve(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var Ae=Array.isArray;function it(s,i,u,m){if(s=s.options,i){i={};for(var v=0;v<u.length;v++)i["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=i.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&m&&(s[u].defaultSelected=!0)}else{for(u=""+ie(u),i=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,m&&(s[v].defaultSelected=!0);return}i!==null||s[v].disabled||(i=s[v])}i!==null&&(i.selected=!0)}}function gt(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return ae({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function ht(s,i){var u=i.value;if(u==null){if(u=i.children,i=i.defaultValue,u!=null){if(i!=null)throw Error(t(92));if(Ae(u)){if(1<u.length)throw Error(t(93));u=u[0]}i=u}i==null&&(i=""),u=i}s._wrapperState={initialValue:ie(u)}}function Dt(s,i){var u=ie(i.value),m=ie(i.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),i.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),m!=null&&(s.defaultValue=""+m)}function Nt(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Kt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cr(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Kt(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Lt,Xt=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,u,m,v){MSApp.execUnsafeLocalFunction(function(){return s(i,u,m,v)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Lt=Lt||document.createElement("div"),Lt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Lt.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function ot(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var St={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qt=["Webkit","ms","Moz","O"];Object.keys(St).forEach(function(s){Qt.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),St[i]=St[s]})});function Et(s,i,u){return i==null||typeof i=="boolean"||i===""?"":u||typeof i!="number"||i===0||St.hasOwnProperty(s)&&St[s]?(""+i).trim():i+"px"}function zt(s,i){s=s.style;for(var u in i)if(i.hasOwnProperty(u)){var m=u.indexOf("--")===0,v=Et(u,i[u],m);u==="float"&&(u="cssFloat"),m?s.setProperty(u,v):s[u]=v}}var Tt=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function se(s,i){if(i){if(Tt[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Ne(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var X=null;function me(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Se=null,ze=null,He=null;function Ze(s){if(s=ji(s)){if(typeof Se!="function")throw Error(t(280));var i=s.stateNode;i&&(i=oc(i),Se(s.stateNode,s.type,i))}}function yt(s){ze?He?He.push(s):He=[s]:ze=s}function at(){if(ze){var s=ze,i=He;if(He=ze=null,Ze(s),i)for(s=0;s<i.length;s++)Ze(i[s])}}function Qe(s,i){return s(i)}function We(){}var dt=!1;function wt(s,i,u){if(dt)return s(i,u);dt=!0;try{return Qe(s,i,u)}finally{dt=!1,(ze!==null||He!==null)&&(We(),at())}}function wr(s,i){var u=s.stateNode;if(u===null)return null;var m=oc(u);if(m===null)return null;u=m[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,i,typeof u));return u}var Ye=!1;if(c)try{var et={};Object.defineProperty(et,"passive",{get:function(){Ye=!0}}),window.addEventListener("test",et,et),window.removeEventListener("test",et,et)}catch{Ye=!1}function pt(s,i,u,m,v,b,N,ne,ce){var Ee=Array.prototype.slice.call(arguments,3);try{i.apply(u,Ee)}catch(Pe){this.onError(Pe)}}var Gt=!1,sr=null,F=!1,G=null,I={onError:function(s){Gt=!0,sr=s}};function U(s,i,u,m,v,b,N,ne,ce){Gt=!1,sr=null,pt.apply(I,arguments)}function Y(s,i,u,m,v,b,N,ne,ce){if(U.apply(this,arguments),Gt){if(Gt){var Ee=sr;Gt=!1,sr=null}else throw Error(t(198));F||(F=!0,G=Ee)}}function q(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function we(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Fe(s){if(q(s)!==s)throw Error(t(188))}function ye(s){var i=s.alternate;if(!i){if(i=q(s),i===null)throw Error(t(188));return i!==s?null:s}for(var u=s,m=i;;){var v=u.return;if(v===null)break;var b=v.alternate;if(b===null){if(m=v.return,m!==null){u=m;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===u)return Fe(v),s;if(b===m)return Fe(v),i;b=b.sibling}throw Error(t(188))}if(u.return!==m.return)u=v,m=b;else{for(var N=!1,ne=v.child;ne;){if(ne===u){N=!0,u=v,m=b;break}if(ne===m){N=!0,m=v,u=b;break}ne=ne.sibling}if(!N){for(ne=b.child;ne;){if(ne===u){N=!0,u=b,m=v;break}if(ne===m){N=!0,m=b,u=v;break}ne=ne.sibling}if(!N)throw Error(t(189))}}if(u.alternate!==m)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:i}function _e(s){return s=ye(s),s!==null?be(s):null}function be(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=be(s);if(i!==null)return i;s=s.sibling}return null}var Re=n.unstable_scheduleCallback,$e=n.unstable_cancelCallback,Me=n.unstable_shouldYield,Ie=n.unstable_requestPaint,je=n.unstable_now,ft=n.unstable_getCurrentPriorityLevel,Ut=n.unstable_ImmediatePriority,Bt=n.unstable_UserBlockingPriority,hr=n.unstable_NormalPriority,Rs=n.unstable_LowPriority,Qa=n.unstable_IdlePriority,ia=null,Ar=null;function vi(s){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(ia,s,void 0,(s.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:bw,kw=Math.log,_w=Math.LN2;function bw(s){return s>>>=0,s===0?32:31-(kw(s)/_w|0)|0}var Ul=64,Hl=4194304;function yi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function $l(s,i){var u=s.pendingLanes;if(u===0)return 0;var m=0,v=s.suspendedLanes,b=s.pingedLanes,N=u&268435455;if(N!==0){var ne=N&~v;ne!==0?m=yi(ne):(b&=N,b!==0&&(m=yi(b)))}else N=u&~v,N!==0?m=yi(N):b!==0&&(m=yi(b));if(m===0)return 0;if(i!==0&&i!==m&&(i&v)===0&&(v=m&-m,b=i&-i,v>=b||v===16&&(b&4194240)!==0))return i;if((m&4)!==0&&(m|=u&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=m;0<i;)u=31-mr(i),v=1<<u,m|=s[u],i&=~v;return m}function Ew(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sw(s,i){for(var u=s.suspendedLanes,m=s.pingedLanes,v=s.expirationTimes,b=s.pendingLanes;0<b;){var N=31-mr(b),ne=1<<N,ce=v[N];ce===-1?((ne&u)===0||(ne&m)!==0)&&(v[N]=Ew(ne,i)):ce<=i&&(s.expiredLanes|=ne),b&=~ne}}function l0(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function $p(){var s=Ul;return Ul<<=1,(Ul&4194240)===0&&(Ul=64),s}function c0(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function wi(s,i,u){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-mr(i),s[i]=u}function Tw(s,i){var u=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<u;){var v=31-mr(u),b=1<<v;i[v]=0,m[v]=-1,s[v]=-1,u&=~b}}function u0(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var m=31-mr(u),v=1<<m;v&i|s[m]&i&&(s[m]|=i),u&=~v}}var Ht=0;function Yp(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Vp,f0,Kp,Gp,Xp,d0=!1,Yl=[],qa=null,Za=null,Ja=null,ki=new Map,_i=new Map,es=[],Cw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qp(s,i){switch(s){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":Ja=null;break;case"pointerover":case"pointerout":ki.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":_i.delete(i.pointerId)}}function bi(s,i,u,m,v,b){return s===null||s.nativeEvent!==b?(s={blockedOn:i,domEventName:u,eventSystemFlags:m,nativeEvent:b,targetContainers:[v]},i!==null&&(i=ji(i),i!==null&&f0(i)),s):(s.eventSystemFlags|=m,i=s.targetContainers,v!==null&&i.indexOf(v)===-1&&i.push(v),s)}function Dw(s,i,u,m,v){switch(i){case"focusin":return qa=bi(qa,s,i,u,m,v),!0;case"dragenter":return Za=bi(Za,s,i,u,m,v),!0;case"mouseover":return Ja=bi(Ja,s,i,u,m,v),!0;case"pointerover":var b=v.pointerId;return ki.set(b,bi(ki.get(b)||null,s,i,u,m,v)),!0;case"gotpointercapture":return b=v.pointerId,_i.set(b,bi(_i.get(b)||null,s,i,u,m,v)),!0}return!1}function qp(s){var i=Ms(s.target);if(i!==null){var u=q(i);if(u!==null){if(i=u.tag,i===13){if(i=we(u),i!==null){s.blockedOn=i,Xp(s.priority,function(){Kp(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Vl(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=h0(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var m=new u.constructor(u.type,u);X=m,u.target.dispatchEvent(m),X=null}else return i=ji(u),i!==null&&f0(i),s.blockedOn=u,!1;i.shift()}return!0}function Zp(s,i,u){Vl(s)&&u.delete(i)}function Nw(){d0=!1,qa!==null&&Vl(qa)&&(qa=null),Za!==null&&Vl(Za)&&(Za=null),Ja!==null&&Vl(Ja)&&(Ja=null),ki.forEach(Zp),_i.forEach(Zp)}function Ei(s,i){s.blockedOn===i&&(s.blockedOn=null,d0||(d0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Nw)))}function Si(s){function i(v){return Ei(v,s)}if(0<Yl.length){Ei(Yl[0],s);for(var u=1;u<Yl.length;u++){var m=Yl[u];m.blockedOn===s&&(m.blockedOn=null)}}for(qa!==null&&Ei(qa,s),Za!==null&&Ei(Za,s),Ja!==null&&Ei(Ja,s),ki.forEach(i),_i.forEach(i),u=0;u<es.length;u++)m=es[u],m.blockedOn===s&&(m.blockedOn=null);for(;0<es.length&&(u=es[0],u.blockedOn===null);)qp(u),u.blockedOn===null&&es.shift()}var _o=j.ReactCurrentBatchConfig,Kl=!0;function Fw(s,i,u,m){var v=Ht,b=_o.transition;_o.transition=null;try{Ht=1,p0(s,i,u,m)}finally{Ht=v,_o.transition=b}}function Aw(s,i,u,m){var v=Ht,b=_o.transition;_o.transition=null;try{Ht=4,p0(s,i,u,m)}finally{Ht=v,_o.transition=b}}function p0(s,i,u,m){if(Kl){var v=h0(s,i,u,m);if(v===null)A0(s,i,m,Gl,u),Qp(s,m);else if(Dw(v,s,i,u,m))m.stopPropagation();else if(Qp(s,m),i&4&&-1<Cw.indexOf(s)){for(;v!==null;){var b=ji(v);if(b!==null&&Vp(b),b=h0(s,i,u,m),b===null&&A0(s,i,m,Gl,u),b===v)break;v=b}v!==null&&m.stopPropagation()}else A0(s,i,m,null,u)}}var Gl=null;function h0(s,i,u,m){if(Gl=null,s=me(m),s=Ms(s),s!==null)if(i=q(s),i===null)s=null;else if(u=i.tag,u===13){if(s=we(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return Gl=s,null}function Jp(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ft()){case Ut:return 1;case Bt:return 4;case hr:case Rs:return 16;case Qa:return 536870912;default:return 16}default:return 16}}var ts=null,m0=null,Xl=null;function eh(){if(Xl)return Xl;var s,i=m0,u=i.length,m,v="value"in ts?ts.value:ts.textContent,b=v.length;for(s=0;s<u&&i[s]===v[s];s++);var N=u-s;for(m=1;m<=N&&i[u-m]===v[b-m];m++);return Xl=v.slice(s,1<m?1-m:void 0)}function Ql(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ql(){return!0}function th(){return!1}function wn(s){function i(u,m,v,b,N){this._reactName=u,this._targetInst=v,this.type=m,this.nativeEvent=b,this.target=N,this.currentTarget=null;for(var ne in s)s.hasOwnProperty(ne)&&(u=s[ne],this[ne]=u?u(b):b[ne]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?ql:th,this.isPropagationStopped=th,this}return ae(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),i}var bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},x0=wn(bo),Ti=ae({},bo,{view:0,detail:0}),Ow=wn(Ti),g0,v0,Ci,Zl=ae({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:w0,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ci&&(Ci&&s.type==="mousemove"?(g0=s.screenX-Ci.screenX,v0=s.screenY-Ci.screenY):v0=g0=0,Ci=s),g0)},movementY:function(s){return"movementY"in s?s.movementY:v0}}),rh=wn(Zl),Pw=ae({},Zl,{dataTransfer:0}),Rw=wn(Pw),Mw=ae({},Ti,{relatedTarget:0}),y0=wn(Mw),Iw=ae({},bo,{animationName:0,elapsedTime:0,pseudoElement:0}),jw=wn(Iw),Lw=ae({},bo,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),zw=wn(Lw),Bw=ae({},bo,{data:0}),nh=wn(Bw),Ww={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $w(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Hw[s])?!!i[s]:!1}function w0(){return $w}var Yw=ae({},Ti,{key:function(s){if(s.key){var i=Ww[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ql(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Uw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:w0,charCode:function(s){return s.type==="keypress"?Ql(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ql(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Vw=wn(Yw),Kw=ae({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ah=wn(Kw),Gw=ae({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:w0}),Xw=wn(Gw),Qw=ae({},bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),qw=wn(Qw),Zw=ae({},Zl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Jw=wn(Zw),ek=[9,13,27,32],k0=c&&"CompositionEvent"in window,Di=null;c&&"documentMode"in document&&(Di=document.documentMode);var tk=c&&"TextEvent"in window&&!Di,sh=c&&(!k0||Di&&8<Di&&11>=Di),oh=" ",ih=!1;function lh(s,i){switch(s){case"keyup":return ek.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ch(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Eo=!1;function rk(s,i){switch(s){case"compositionend":return ch(i);case"keypress":return i.which!==32?null:(ih=!0,oh);case"textInput":return s=i.data,s===oh&&ih?null:s;default:return null}}function nk(s,i){if(Eo)return s==="compositionend"||!k0&&lh(s,i)?(s=eh(),Xl=m0=ts=null,Eo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return sh&&i.locale!=="ko"?null:i.data;default:return null}}var ak={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!ak[s.type]:i==="textarea"}function fh(s,i,u,m){yt(m),i=nc(i,"onChange"),0<i.length&&(u=new x0("onChange","change",null,u,m),s.push({event:u,listeners:i}))}var Ni=null,Fi=null;function sk(s){Nh(s,0)}function Jl(s){var i=No(s);if(L(i))return s}function ok(s,i){if(s==="change")return i}var dh=!1;if(c){var _0;if(c){var b0="oninput"in document;if(!b0){var ph=document.createElement("div");ph.setAttribute("oninput","return;"),b0=typeof ph.oninput=="function"}_0=b0}else _0=!1;dh=_0&&(!document.documentMode||9<document.documentMode)}function hh(){Ni&&(Ni.detachEvent("onpropertychange",mh),Fi=Ni=null)}function mh(s){if(s.propertyName==="value"&&Jl(Fi)){var i=[];fh(i,Fi,s,me(s)),wt(sk,i)}}function ik(s,i,u){s==="focusin"?(hh(),Ni=i,Fi=u,Ni.attachEvent("onpropertychange",mh)):s==="focusout"&&hh()}function lk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Jl(Fi)}function ck(s,i){if(s==="click")return Jl(i)}function uk(s,i){if(s==="input"||s==="change")return Jl(i)}function fk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Yn=typeof Object.is=="function"?Object.is:fk;function Ai(s,i){if(Yn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),m=Object.keys(i);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var v=u[m];if(!f.call(i,v)||!Yn(s[v],i[v]))return!1}return!0}function xh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function gh(s,i){var u=xh(s);s=0;for(var m;u;){if(u.nodeType===3){if(m=s+u.textContent.length,s<=i&&m>=i)return{node:u,offset:i-s};s=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=xh(u)}}function vh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?vh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function yh(){for(var s=window,i=Ve();i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Ve(s.document)}return i}function E0(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function dk(s){var i=yh(),u=s.focusedElem,m=s.selectionRange;if(i!==u&&u&&u.ownerDocument&&vh(u.ownerDocument.documentElement,u)){if(m!==null&&E0(u)){if(i=m.start,s=m.end,s===void 0&&(s=i),"selectionStart"in u)u.selectionStart=i,u.selectionEnd=Math.min(s,u.value.length);else if(s=(i=u.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var v=u.textContent.length,b=Math.min(m.start,v);m=m.end===void 0?b:Math.min(m.end,v),!s.extend&&b>m&&(v=m,m=b,b=v),v=gh(u,b);var N=gh(u,m);v&&N&&(s.rangeCount!==1||s.anchorNode!==v.node||s.anchorOffset!==v.offset||s.focusNode!==N.node||s.focusOffset!==N.offset)&&(i=i.createRange(),i.setStart(v.node,v.offset),s.removeAllRanges(),b>m?(s.addRange(i),s.extend(N.node,N.offset)):(i.setEnd(N.node,N.offset),s.addRange(i)))}}for(i=[],s=u;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<i.length;u++)s=i[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var pk=c&&"documentMode"in document&&11>=document.documentMode,So=null,S0=null,Oi=null,T0=!1;function wh(s,i,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;T0||So==null||So!==Ve(m)||(m=So,"selectionStart"in m&&E0(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Oi&&Ai(Oi,m)||(Oi=m,m=nc(S0,"onSelect"),0<m.length&&(i=new x0("onSelect","select",null,i,u),s.push({event:i,listeners:m}),i.target=So)))}function ec(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var To={animationend:ec("Animation","AnimationEnd"),animationiteration:ec("Animation","AnimationIteration"),animationstart:ec("Animation","AnimationStart"),transitionend:ec("Transition","TransitionEnd")},C0={},kh={};c&&(kh=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function tc(s){if(C0[s])return C0[s];if(!To[s])return s;var i=To[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in kh)return C0[s]=i[u];return s}var _h=tc("animationend"),bh=tc("animationiteration"),Eh=tc("animationstart"),Sh=tc("transitionend"),Th=new Map,Ch="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(s,i){Th.set(s,i),o(i,[s])}for(var D0=0;D0<Ch.length;D0++){var N0=Ch[D0],hk=N0.toLowerCase(),mk=N0[0].toUpperCase()+N0.slice(1);rs(hk,"on"+mk)}rs(_h,"onAnimationEnd"),rs(bh,"onAnimationIteration"),rs(Eh,"onAnimationStart"),rs("dblclick","onDoubleClick"),rs("focusin","onFocus"),rs("focusout","onBlur"),rs(Sh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function Dh(s,i,u){var m=s.type||"unknown-event";s.currentTarget=u,Y(m,i,void 0,s),s.currentTarget=null}function Nh(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var m=s[u],v=m.event;m=m.listeners;e:{var b=void 0;if(i)for(var N=m.length-1;0<=N;N--){var ne=m[N],ce=ne.instance,Ee=ne.currentTarget;if(ne=ne.listener,ce!==b&&v.isPropagationStopped())break e;Dh(v,ne,Ee),b=ce}else for(N=0;N<m.length;N++){if(ne=m[N],ce=ne.instance,Ee=ne.currentTarget,ne=ne.listener,ce!==b&&v.isPropagationStopped())break e;Dh(v,ne,Ee),b=ce}}}if(F)throw s=G,F=!1,G=null,s}function Jt(s,i){var u=i[j0];u===void 0&&(u=i[j0]=new Set);var m=s+"__bubble";u.has(m)||(Fh(i,s,2,!1),u.add(m))}function F0(s,i,u){var m=0;i&&(m|=4),Fh(u,s,m,i)}var rc="_reactListening"+Math.random().toString(36).slice(2);function Ri(s){if(!s[rc]){s[rc]=!0,r.forEach(function(u){u!=="selectionchange"&&(xk.has(u)||F0(u,!1,s),F0(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[rc]||(i[rc]=!0,F0("selectionchange",!1,i))}}function Fh(s,i,u,m){switch(Jp(i)){case 1:var v=Fw;break;case 4:v=Aw;break;default:v=p0}u=v.bind(null,i,u,s),v=void 0,!Ye||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(v=!0),m?v!==void 0?s.addEventListener(i,u,{capture:!0,passive:v}):s.addEventListener(i,u,!0):v!==void 0?s.addEventListener(i,u,{passive:v}):s.addEventListener(i,u,!1)}function A0(s,i,u,m,v){var b=m;if((i&1)===0&&(i&2)===0&&m!==null)e:for(;;){if(m===null)return;var N=m.tag;if(N===3||N===4){var ne=m.stateNode.containerInfo;if(ne===v||ne.nodeType===8&&ne.parentNode===v)break;if(N===4)for(N=m.return;N!==null;){var ce=N.tag;if((ce===3||ce===4)&&(ce=N.stateNode.containerInfo,ce===v||ce.nodeType===8&&ce.parentNode===v))return;N=N.return}for(;ne!==null;){if(N=Ms(ne),N===null)return;if(ce=N.tag,ce===5||ce===6){m=b=N;continue e}ne=ne.parentNode}}m=m.return}wt(function(){var Ee=b,Pe=me(u),Be=[];e:{var Oe=Th.get(s);if(Oe!==void 0){var Xe=x0,Je=s;switch(s){case"keypress":if(Ql(u)===0)break e;case"keydown":case"keyup":Xe=Vw;break;case"focusin":Je="focus",Xe=y0;break;case"focusout":Je="blur",Xe=y0;break;case"beforeblur":case"afterblur":Xe=y0;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xe=rh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xe=Rw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xe=Xw;break;case _h:case bh:case Eh:Xe=jw;break;case Sh:Xe=qw;break;case"scroll":Xe=Ow;break;case"wheel":Xe=Jw;break;case"copy":case"cut":case"paste":Xe=zw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xe=ah}var tt=(i&4)!==0,xr=!tt&&s==="scroll",ve=tt?Oe!==null?Oe+"Capture":null:Oe;tt=[];for(var pe=Ee,ke;pe!==null;){ke=pe;var Ue=ke.stateNode;if(ke.tag===5&&Ue!==null&&(ke=Ue,ve!==null&&(Ue=wr(pe,ve),Ue!=null&&tt.push(Mi(pe,Ue,ke)))),xr)break;pe=pe.return}0<tt.length&&(Oe=new Xe(Oe,Je,null,u,Pe),Be.push({event:Oe,listeners:tt}))}}if((i&7)===0){e:{if(Oe=s==="mouseover"||s==="pointerover",Xe=s==="mouseout"||s==="pointerout",Oe&&u!==X&&(Je=u.relatedTarget||u.fromElement)&&(Ms(Je)||Je[Fa]))break e;if((Xe||Oe)&&(Oe=Pe.window===Pe?Pe:(Oe=Pe.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,Xe?(Je=u.relatedTarget||u.toElement,Xe=Ee,Je=Je?Ms(Je):null,Je!==null&&(xr=q(Je),Je!==xr||Je.tag!==5&&Je.tag!==6)&&(Je=null)):(Xe=null,Je=Ee),Xe!==Je)){if(tt=rh,Ue="onMouseLeave",ve="onMouseEnter",pe="mouse",(s==="pointerout"||s==="pointerover")&&(tt=ah,Ue="onPointerLeave",ve="onPointerEnter",pe="pointer"),xr=Xe==null?Oe:No(Xe),ke=Je==null?Oe:No(Je),Oe=new tt(Ue,pe+"leave",Xe,u,Pe),Oe.target=xr,Oe.relatedTarget=ke,Ue=null,Ms(Pe)===Ee&&(tt=new tt(ve,pe+"enter",Je,u,Pe),tt.target=ke,tt.relatedTarget=xr,Ue=tt),xr=Ue,Xe&&Je)t:{for(tt=Xe,ve=Je,pe=0,ke=tt;ke;ke=Co(ke))pe++;for(ke=0,Ue=ve;Ue;Ue=Co(Ue))ke++;for(;0<pe-ke;)tt=Co(tt),pe--;for(;0<ke-pe;)ve=Co(ve),ke--;for(;pe--;){if(tt===ve||ve!==null&&tt===ve.alternate)break t;tt=Co(tt),ve=Co(ve)}tt=null}else tt=null;Xe!==null&&Ah(Be,Oe,Xe,tt,!1),Je!==null&&xr!==null&&Ah(Be,xr,Je,tt,!0)}}e:{if(Oe=Ee?No(Ee):window,Xe=Oe.nodeName&&Oe.nodeName.toLowerCase(),Xe==="select"||Xe==="input"&&Oe.type==="file")var rt=ok;else if(uh(Oe))if(dh)rt=uk;else{rt=lk;var ct=ik}else(Xe=Oe.nodeName)&&Xe.toLowerCase()==="input"&&(Oe.type==="checkbox"||Oe.type==="radio")&&(rt=ck);if(rt&&(rt=rt(s,Ee))){fh(Be,rt,u,Pe);break e}ct&&ct(s,Oe,Ee),s==="focusout"&&(ct=Oe._wrapperState)&&ct.controlled&&Oe.type==="number"&&Le(Oe,"number",Oe.value)}switch(ct=Ee?No(Ee):window,s){case"focusin":(uh(ct)||ct.contentEditable==="true")&&(So=ct,S0=Ee,Oi=null);break;case"focusout":Oi=S0=So=null;break;case"mousedown":T0=!0;break;case"contextmenu":case"mouseup":case"dragend":T0=!1,wh(Be,u,Pe);break;case"selectionchange":if(pk)break;case"keydown":case"keyup":wh(Be,u,Pe)}var ut;if(k0)e:{switch(s){case"compositionstart":var xt="onCompositionStart";break e;case"compositionend":xt="onCompositionEnd";break e;case"compositionupdate":xt="onCompositionUpdate";break e}xt=void 0}else Eo?lh(s,u)&&(xt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(xt="onCompositionStart");xt&&(sh&&u.locale!=="ko"&&(Eo||xt!=="onCompositionStart"?xt==="onCompositionEnd"&&Eo&&(ut=eh()):(ts=Pe,m0="value"in ts?ts.value:ts.textContent,Eo=!0)),ct=nc(Ee,xt),0<ct.length&&(xt=new nh(xt,s,null,u,Pe),Be.push({event:xt,listeners:ct}),ut?xt.data=ut:(ut=ch(u),ut!==null&&(xt.data=ut)))),(ut=tk?rk(s,u):nk(s,u))&&(Ee=nc(Ee,"onBeforeInput"),0<Ee.length&&(Pe=new nh("onBeforeInput","beforeinput",null,u,Pe),Be.push({event:Pe,listeners:Ee}),Pe.data=ut))}Nh(Be,i)})}function Mi(s,i,u){return{instance:s,listener:i,currentTarget:u}}function nc(s,i){for(var u=i+"Capture",m=[];s!==null;){var v=s,b=v.stateNode;v.tag===5&&b!==null&&(v=b,b=wr(s,u),b!=null&&m.unshift(Mi(s,b,v)),b=wr(s,i),b!=null&&m.push(Mi(s,b,v))),s=s.return}return m}function Co(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Ah(s,i,u,m,v){for(var b=i._reactName,N=[];u!==null&&u!==m;){var ne=u,ce=ne.alternate,Ee=ne.stateNode;if(ce!==null&&ce===m)break;ne.tag===5&&Ee!==null&&(ne=Ee,v?(ce=wr(u,b),ce!=null&&N.unshift(Mi(u,ce,ne))):v||(ce=wr(u,b),ce!=null&&N.push(Mi(u,ce,ne)))),u=u.return}N.length!==0&&s.push({event:i,listeners:N})}var gk=/\r\n?/g,vk=/\u0000|\uFFFD/g;function Oh(s){return(typeof s=="string"?s:""+s).replace(gk,`
`).replace(vk,"")}function ac(s,i,u){if(i=Oh(i),Oh(s)!==i&&u)throw Error(t(425))}function sc(){}var O0=null,P0=null;function R0(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var M0=typeof setTimeout=="function"?setTimeout:void 0,yk=typeof clearTimeout=="function"?clearTimeout:void 0,Ph=typeof Promise=="function"?Promise:void 0,wk=typeof queueMicrotask=="function"?queueMicrotask:typeof Ph<"u"?function(s){return Ph.resolve(null).then(s).catch(kk)}:M0;function kk(s){setTimeout(function(){throw s})}function I0(s,i){var u=i,m=0;do{var v=u.nextSibling;if(s.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(m===0){s.removeChild(v),Si(i);return}m--}else u!=="$"&&u!=="$?"&&u!=="$!"||m++;u=v}while(u);Si(i)}function ns(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Rh(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}var Do=Math.random().toString(36).slice(2),la="__reactFiber$"+Do,Ii="__reactProps$"+Do,Fa="__reactContainer$"+Do,j0="__reactEvents$"+Do,_k="__reactListeners$"+Do,bk="__reactHandles$"+Do;function Ms(s){var i=s[la];if(i)return i;for(var u=s.parentNode;u;){if(i=u[Fa]||u[la]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=Rh(s);s!==null;){if(u=s[la])return u;s=Rh(s)}return i}s=u,u=s.parentNode}return null}function ji(s){return s=s[la]||s[Fa],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function No(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function oc(s){return s[Ii]||null}var L0=[],Fo=-1;function as(s){return{current:s}}function er(s){0>Fo||(s.current=L0[Fo],L0[Fo]=null,Fo--)}function qt(s,i){Fo++,L0[Fo]=s.current,s.current=i}var ss={},$r=as(ss),pn=as(!1),Is=ss;function Ao(s,i){var u=s.type.contextTypes;if(!u)return ss;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===i)return m.__reactInternalMemoizedMaskedChildContext;var v={},b;for(b in u)v[b]=i[b];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=v),v}function hn(s){return s=s.childContextTypes,s!=null}function ic(){er(pn),er($r)}function Mh(s,i,u){if($r.current!==ss)throw Error(t(168));qt($r,i),qt(pn,u)}function Ih(s,i,u){var m=s.stateNode;if(i=i.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var v in m)if(!(v in i))throw Error(t(108,re(s)||"Unknown",v));return ae({},u,m)}function lc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ss,Is=$r.current,qt($r,s),qt(pn,pn.current),!0}function jh(s,i,u){var m=s.stateNode;if(!m)throw Error(t(169));u?(s=Ih(s,i,Is),m.__reactInternalMemoizedMergedChildContext=s,er(pn),er($r),qt($r,s)):er(pn),qt(pn,u)}var Aa=null,cc=!1,z0=!1;function Lh(s){Aa===null?Aa=[s]:Aa.push(s)}function Ek(s){cc=!0,Lh(s)}function os(){if(!z0&&Aa!==null){z0=!0;var s=0,i=Ht;try{var u=Aa;for(Ht=1;s<u.length;s++){var m=u[s];do m=m(!0);while(m!==null)}Aa=null,cc=!1}catch(v){throw Aa!==null&&(Aa=Aa.slice(s+1)),Re(Ut,os),v}finally{Ht=i,z0=!1}}return null}var Oo=[],Po=0,uc=null,fc=0,Dn=[],Nn=0,js=null,Oa=1,Pa="";function Ls(s,i){Oo[Po++]=fc,Oo[Po++]=uc,uc=s,fc=i}function zh(s,i,u){Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,js=s;var m=Oa;s=Pa;var v=32-mr(m)-1;m&=~(1<<v),u+=1;var b=32-mr(i)+v;if(30<b){var N=v-v%5;b=(m&(1<<N)-1).toString(32),m>>=N,v-=N,Oa=1<<32-mr(i)+v|u<<v|m,Pa=b+s}else Oa=1<<b|u<<v|m,Pa=s}function B0(s){s.return!==null&&(Ls(s,1),zh(s,1,0))}function W0(s){for(;s===uc;)uc=Oo[--Po],Oo[Po]=null,fc=Oo[--Po],Oo[Po]=null;for(;s===js;)js=Dn[--Nn],Dn[Nn]=null,Pa=Dn[--Nn],Dn[Nn]=null,Oa=Dn[--Nn],Dn[Nn]=null}var kn=null,_n=null,tr=!1,Vn=null;function Bh(s,i){var u=Pn(5,null,null,0);u.elementType="DELETED",u.stateNode=i,u.return=s,i=s.deletions,i===null?(s.deletions=[u],s.flags|=16):i.push(u)}function Wh(s,i){switch(s.tag){case 5:var u=s.type;return i=i.nodeType!==1||u.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,kn=s,_n=ns(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,kn=s,_n=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(u=js!==null?{id:Oa,overflow:Pa}:null,s.memoizedState={dehydrated:i,treeContext:u,retryLane:1073741824},u=Pn(18,null,null,0),u.stateNode=i,u.return=s,s.child=u,kn=s,_n=null,!0):!1;default:return!1}}function U0(s){return(s.mode&1)!==0&&(s.flags&128)===0}function H0(s){if(tr){var i=_n;if(i){var u=i;if(!Wh(s,i)){if(U0(s))throw Error(t(418));i=ns(u.nextSibling);var m=kn;i&&Wh(s,i)?Bh(m,u):(s.flags=s.flags&-4097|2,tr=!1,kn=s)}}else{if(U0(s))throw Error(t(418));s.flags=s.flags&-4097|2,tr=!1,kn=s}}}function Uh(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;kn=s}function dc(s){if(s!==kn)return!1;if(!tr)return Uh(s),tr=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!R0(s.type,s.memoizedProps)),i&&(i=_n)){if(U0(s))throw Hh(),Error(t(418));for(;i;)Bh(s,i),i=ns(i.nextSibling)}if(Uh(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(i===0){_n=ns(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++}s=s.nextSibling}_n=null}}else _n=kn?ns(s.stateNode.nextSibling):null;return!0}function Hh(){for(var s=_n;s;)s=ns(s.nextSibling)}function Ro(){_n=kn=null,tr=!1}function $0(s){Vn===null?Vn=[s]:Vn.push(s)}var Sk=j.ReactCurrentBatchConfig;function Li(s,i,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var m=u.stateNode}if(!m)throw Error(t(147,s));var v=m,b=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function(N){var ne=v.refs;N===null?delete ne[b]:ne[b]=N},i._stringRef=b,i)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function pc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function $h(s){var i=s._init;return i(s._payload)}function Yh(s){function i(ve,pe){if(s){var ke=ve.deletions;ke===null?(ve.deletions=[pe],ve.flags|=16):ke.push(pe)}}function u(ve,pe){if(!s)return null;for(;pe!==null;)i(ve,pe),pe=pe.sibling;return null}function m(ve,pe){for(ve=new Map;pe!==null;)pe.key!==null?ve.set(pe.key,pe):ve.set(pe.index,pe),pe=pe.sibling;return ve}function v(ve,pe){return ve=hs(ve,pe),ve.index=0,ve.sibling=null,ve}function b(ve,pe,ke){return ve.index=ke,s?(ke=ve.alternate,ke!==null?(ke=ke.index,ke<pe?(ve.flags|=2,pe):ke):(ve.flags|=2,pe)):(ve.flags|=1048576,pe)}function N(ve){return s&&ve.alternate===null&&(ve.flags|=2),ve}function ne(ve,pe,ke,Ue){return pe===null||pe.tag!==6?(pe=If(ke,ve.mode,Ue),pe.return=ve,pe):(pe=v(pe,ke),pe.return=ve,pe)}function ce(ve,pe,ke,Ue){var rt=ke.type;return rt===C?Pe(ve,pe,ke.props.children,Ue,ke.key):pe!==null&&(pe.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===he&&$h(rt)===pe.type)?(Ue=v(pe,ke.props),Ue.ref=Li(ve,pe,ke),Ue.return=ve,Ue):(Ue=jc(ke.type,ke.key,ke.props,null,ve.mode,Ue),Ue.ref=Li(ve,pe,ke),Ue.return=ve,Ue)}function Ee(ve,pe,ke,Ue){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==ke.containerInfo||pe.stateNode.implementation!==ke.implementation?(pe=jf(ke,ve.mode,Ue),pe.return=ve,pe):(pe=v(pe,ke.children||[]),pe.return=ve,pe)}function Pe(ve,pe,ke,Ue,rt){return pe===null||pe.tag!==7?(pe=Vs(ke,ve.mode,Ue,rt),pe.return=ve,pe):(pe=v(pe,ke),pe.return=ve,pe)}function Be(ve,pe,ke){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return pe=If(""+pe,ve.mode,ke),pe.return=ve,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case ee:return ke=jc(pe.type,pe.key,pe.props,null,ve.mode,ke),ke.ref=Li(ve,null,pe),ke.return=ve,ke;case R:return pe=jf(pe,ve.mode,ke),pe.return=ve,pe;case he:var Ue=pe._init;return Be(ve,Ue(pe._payload),ke)}if(Ae(pe)||J(pe))return pe=Vs(pe,ve.mode,ke,null),pe.return=ve,pe;pc(ve,pe)}return null}function Oe(ve,pe,ke,Ue){var rt=pe!==null?pe.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return rt!==null?null:ne(ve,pe,""+ke,Ue);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case ee:return ke.key===rt?ce(ve,pe,ke,Ue):null;case R:return ke.key===rt?Ee(ve,pe,ke,Ue):null;case he:return rt=ke._init,Oe(ve,pe,rt(ke._payload),Ue)}if(Ae(ke)||J(ke))return rt!==null?null:Pe(ve,pe,ke,Ue,null);pc(ve,ke)}return null}function Xe(ve,pe,ke,Ue,rt){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return ve=ve.get(ke)||null,ne(pe,ve,""+Ue,rt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case ee:return ve=ve.get(Ue.key===null?ke:Ue.key)||null,ce(pe,ve,Ue,rt);case R:return ve=ve.get(Ue.key===null?ke:Ue.key)||null,Ee(pe,ve,Ue,rt);case he:var ct=Ue._init;return Xe(ve,pe,ke,ct(Ue._payload),rt)}if(Ae(Ue)||J(Ue))return ve=ve.get(ke)||null,Pe(pe,ve,Ue,rt,null);pc(pe,Ue)}return null}function Je(ve,pe,ke,Ue){for(var rt=null,ct=null,ut=pe,xt=pe=0,Rr=null;ut!==null&&xt<ke.length;xt++){ut.index>xt?(Rr=ut,ut=null):Rr=ut.sibling;var It=Oe(ve,ut,ke[xt],Ue);if(It===null){ut===null&&(ut=Rr);break}s&&ut&&It.alternate===null&&i(ve,ut),pe=b(It,pe,xt),ct===null?rt=It:ct.sibling=It,ct=It,ut=Rr}if(xt===ke.length)return u(ve,ut),tr&&Ls(ve,xt),rt;if(ut===null){for(;xt<ke.length;xt++)ut=Be(ve,ke[xt],Ue),ut!==null&&(pe=b(ut,pe,xt),ct===null?rt=ut:ct.sibling=ut,ct=ut);return tr&&Ls(ve,xt),rt}for(ut=m(ve,ut);xt<ke.length;xt++)Rr=Xe(ut,ve,xt,ke[xt],Ue),Rr!==null&&(s&&Rr.alternate!==null&&ut.delete(Rr.key===null?xt:Rr.key),pe=b(Rr,pe,xt),ct===null?rt=Rr:ct.sibling=Rr,ct=Rr);return s&&ut.forEach(function(ms){return i(ve,ms)}),tr&&Ls(ve,xt),rt}function tt(ve,pe,ke,Ue){var rt=J(ke);if(typeof rt!="function")throw Error(t(150));if(ke=rt.call(ke),ke==null)throw Error(t(151));for(var ct=rt=null,ut=pe,xt=pe=0,Rr=null,It=ke.next();ut!==null&&!It.done;xt++,It=ke.next()){ut.index>xt?(Rr=ut,ut=null):Rr=ut.sibling;var ms=Oe(ve,ut,It.value,Ue);if(ms===null){ut===null&&(ut=Rr);break}s&&ut&&ms.alternate===null&&i(ve,ut),pe=b(ms,pe,xt),ct===null?rt=ms:ct.sibling=ms,ct=ms,ut=Rr}if(It.done)return u(ve,ut),tr&&Ls(ve,xt),rt;if(ut===null){for(;!It.done;xt++,It=ke.next())It=Be(ve,It.value,Ue),It!==null&&(pe=b(It,pe,xt),ct===null?rt=It:ct.sibling=It,ct=It);return tr&&Ls(ve,xt),rt}for(ut=m(ve,ut);!It.done;xt++,It=ke.next())It=Xe(ut,ve,xt,It.value,Ue),It!==null&&(s&&It.alternate!==null&&ut.delete(It.key===null?xt:It.key),pe=b(It,pe,xt),ct===null?rt=It:ct.sibling=It,ct=It);return s&&ut.forEach(function(a2){return i(ve,a2)}),tr&&Ls(ve,xt),rt}function xr(ve,pe,ke,Ue){if(typeof ke=="object"&&ke!==null&&ke.type===C&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case ee:e:{for(var rt=ke.key,ct=pe;ct!==null;){if(ct.key===rt){if(rt=ke.type,rt===C){if(ct.tag===7){u(ve,ct.sibling),pe=v(ct,ke.props.children),pe.return=ve,ve=pe;break e}}else if(ct.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===he&&$h(rt)===ct.type){u(ve,ct.sibling),pe=v(ct,ke.props),pe.ref=Li(ve,ct,ke),pe.return=ve,ve=pe;break e}u(ve,ct);break}else i(ve,ct);ct=ct.sibling}ke.type===C?(pe=Vs(ke.props.children,ve.mode,Ue,ke.key),pe.return=ve,ve=pe):(Ue=jc(ke.type,ke.key,ke.props,null,ve.mode,Ue),Ue.ref=Li(ve,pe,ke),Ue.return=ve,ve=Ue)}return N(ve);case R:e:{for(ct=ke.key;pe!==null;){if(pe.key===ct)if(pe.tag===4&&pe.stateNode.containerInfo===ke.containerInfo&&pe.stateNode.implementation===ke.implementation){u(ve,pe.sibling),pe=v(pe,ke.children||[]),pe.return=ve,ve=pe;break e}else{u(ve,pe);break}else i(ve,pe);pe=pe.sibling}pe=jf(ke,ve.mode,Ue),pe.return=ve,ve=pe}return N(ve);case he:return ct=ke._init,xr(ve,pe,ct(ke._payload),Ue)}if(Ae(ke))return Je(ve,pe,ke,Ue);if(J(ke))return tt(ve,pe,ke,Ue);pc(ve,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,pe!==null&&pe.tag===6?(u(ve,pe.sibling),pe=v(pe,ke),pe.return=ve,ve=pe):(u(ve,pe),pe=If(ke,ve.mode,Ue),pe.return=ve,ve=pe),N(ve)):u(ve,pe)}return xr}var Mo=Yh(!0),Vh=Yh(!1),hc=as(null),mc=null,Io=null,Y0=null;function V0(){Y0=Io=mc=null}function K0(s){var i=hc.current;er(hc),s._currentValue=i}function G0(s,i,u){for(;s!==null;){var m=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,m!==null&&(m.childLanes|=i)):m!==null&&(m.childLanes&i)!==i&&(m.childLanes|=i),s===u)break;s=s.return}}function jo(s,i){mc=s,Y0=Io=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(mn=!0),s.firstContext=null)}function Fn(s){var i=s._currentValue;if(Y0!==s)if(s={context:s,memoizedValue:i,next:null},Io===null){if(mc===null)throw Error(t(308));Io=s,mc.dependencies={lanes:0,firstContext:s}}else Io=Io.next=s;return i}var zs=null;function X0(s){zs===null?zs=[s]:zs.push(s)}function Kh(s,i,u,m){var v=i.interleaved;return v===null?(u.next=u,X0(i)):(u.next=v.next,v.next=u),i.interleaved=u,Ra(s,m)}function Ra(s,i){s.lanes|=i;var u=s.alternate;for(u!==null&&(u.lanes|=i),u=s,s=s.return;s!==null;)s.childLanes|=i,u=s.alternate,u!==null&&(u.childLanes|=i),u=s,s=s.return;return u.tag===3?u.stateNode:null}var is=!1;function Q0(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Ma(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function ls(s,i,u){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Ot&2)!==0){var v=m.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),m.pending=i,Ra(s,u)}return v=m.interleaved,v===null?(i.next=i,X0(m)):(i.next=v.next,v.next=i),m.interleaved=i,Ra(s,u)}function xc(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194240)!==0)){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,u0(s,u)}}function Xh(s,i){var u=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var v=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var N={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};b===null?v=b=N:b=b.next=N,u=u.next}while(u!==null);b===null?v=b=i:b=b.next=i}else v=b=i;u={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:m.shared,effects:m.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}function gc(s,i,u,m){var v=s.updateQueue;is=!1;var b=v.firstBaseUpdate,N=v.lastBaseUpdate,ne=v.shared.pending;if(ne!==null){v.shared.pending=null;var ce=ne,Ee=ce.next;ce.next=null,N===null?b=Ee:N.next=Ee,N=ce;var Pe=s.alternate;Pe!==null&&(Pe=Pe.updateQueue,ne=Pe.lastBaseUpdate,ne!==N&&(ne===null?Pe.firstBaseUpdate=Ee:ne.next=Ee,Pe.lastBaseUpdate=ce))}if(b!==null){var Be=v.baseState;N=0,Pe=Ee=ce=null,ne=b;do{var Oe=ne.lane,Xe=ne.eventTime;if((m&Oe)===Oe){Pe!==null&&(Pe=Pe.next={eventTime:Xe,lane:0,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null});e:{var Je=s,tt=ne;switch(Oe=i,Xe=u,tt.tag){case 1:if(Je=tt.payload,typeof Je=="function"){Be=Je.call(Xe,Be,Oe);break e}Be=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=tt.payload,Oe=typeof Je=="function"?Je.call(Xe,Be,Oe):Je,Oe==null)break e;Be=ae({},Be,Oe);break e;case 2:is=!0}}ne.callback!==null&&ne.lane!==0&&(s.flags|=64,Oe=v.effects,Oe===null?v.effects=[ne]:Oe.push(ne))}else Xe={eventTime:Xe,lane:Oe,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},Pe===null?(Ee=Pe=Xe,ce=Be):Pe=Pe.next=Xe,N|=Oe;if(ne=ne.next,ne===null){if(ne=v.shared.pending,ne===null)break;Oe=ne,ne=Oe.next,Oe.next=null,v.lastBaseUpdate=Oe,v.shared.pending=null}}while(!0);if(Pe===null&&(ce=Be),v.baseState=ce,v.firstBaseUpdate=Ee,v.lastBaseUpdate=Pe,i=v.shared.interleaved,i!==null){v=i;do N|=v.lane,v=v.next;while(v!==i)}else b===null&&(v.shared.lanes=0);Us|=N,s.lanes=N,s.memoizedState=Be}}function Qh(s,i,u){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var m=s[i],v=m.callback;if(v!==null){if(m.callback=null,m=u,typeof v!="function")throw Error(t(191,v));v.call(m)}}}var zi={},ca=as(zi),Bi=as(zi),Wi=as(zi);function Bs(s){if(s===zi)throw Error(t(174));return s}function q0(s,i){switch(qt(Wi,i),qt(Bi,s),qt(ca,zi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:cr(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=cr(i,s)}er(ca),qt(ca,i)}function Lo(){er(ca),er(Bi),er(Wi)}function qh(s){Bs(Wi.current);var i=Bs(ca.current),u=cr(i,s.type);i!==u&&(qt(Bi,s),qt(ca,u))}function Z0(s){Bi.current===s&&(er(ca),er(Bi))}var or=as(0);function vc(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var J0=[];function ef(){for(var s=0;s<J0.length;s++)J0[s]._workInProgressVersionPrimary=null;J0.length=0}var yc=j.ReactCurrentDispatcher,tf=j.ReactCurrentBatchConfig,Ws=0,ir=null,Sr=null,Or=null,wc=!1,Ui=!1,Hi=0,Tk=0;function Yr(){throw Error(t(321))}function rf(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Yn(s[u],i[u]))return!1;return!0}function nf(s,i,u,m,v,b){if(Ws=b,ir=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,yc.current=s===null||s.memoizedState===null?Fk:Ak,s=u(m,v),Ui){b=0;do{if(Ui=!1,Hi=0,25<=b)throw Error(t(301));b+=1,Or=Sr=null,i.updateQueue=null,yc.current=Ok,s=u(m,v)}while(Ui)}if(yc.current=bc,i=Sr!==null&&Sr.next!==null,Ws=0,Or=Sr=ir=null,wc=!1,i)throw Error(t(300));return s}function af(){var s=Hi!==0;return Hi=0,s}function ua(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Or===null?ir.memoizedState=Or=s:Or=Or.next=s,Or}function An(){if(Sr===null){var s=ir.alternate;s=s!==null?s.memoizedState:null}else s=Sr.next;var i=Or===null?ir.memoizedState:Or.next;if(i!==null)Or=i,Sr=s;else{if(s===null)throw Error(t(310));Sr=s,s={memoizedState:Sr.memoizedState,baseState:Sr.baseState,baseQueue:Sr.baseQueue,queue:Sr.queue,next:null},Or===null?ir.memoizedState=Or=s:Or=Or.next=s}return Or}function $i(s,i){return typeof i=="function"?i(s):i}function sf(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=Sr,v=m.baseQueue,b=u.pending;if(b!==null){if(v!==null){var N=v.next;v.next=b.next,b.next=N}m.baseQueue=v=b,u.pending=null}if(v!==null){b=v.next,m=m.baseState;var ne=N=null,ce=null,Ee=b;do{var Pe=Ee.lane;if((Ws&Pe)===Pe)ce!==null&&(ce=ce.next={lane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),m=Ee.hasEagerState?Ee.eagerState:s(m,Ee.action);else{var Be={lane:Pe,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null};ce===null?(ne=ce=Be,N=m):ce=ce.next=Be,ir.lanes|=Pe,Us|=Pe}Ee=Ee.next}while(Ee!==null&&Ee!==b);ce===null?N=m:ce.next=ne,Yn(m,i.memoizedState)||(mn=!0),i.memoizedState=m,i.baseState=N,i.baseQueue=ce,u.lastRenderedState=m}if(s=u.interleaved,s!==null){v=s;do b=v.lane,ir.lanes|=b,Us|=b,v=v.next;while(v!==s)}else v===null&&(u.lanes=0);return[i.memoizedState,u.dispatch]}function of(s){var i=An(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=u.dispatch,v=u.pending,b=i.memoizedState;if(v!==null){u.pending=null;var N=v=v.next;do b=s(b,N.action),N=N.next;while(N!==v);Yn(b,i.memoizedState)||(mn=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),u.lastRenderedState=b}return[b,m]}function Zh(){}function Jh(s,i){var u=ir,m=An(),v=i(),b=!Yn(m.memoizedState,v);if(b&&(m.memoizedState=v,mn=!0),m=m.queue,lf(rm.bind(null,u,m,s),[s]),m.getSnapshot!==i||b||Or!==null&&Or.memoizedState.tag&1){if(u.flags|=2048,Yi(9,tm.bind(null,u,m,v,i),void 0,null),Pr===null)throw Error(t(349));(Ws&30)!==0||em(u,i,v)}return v}function em(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=ir.updateQueue,i===null?(i={lastEffect:null,stores:null},ir.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function tm(s,i,u,m){i.value=u,i.getSnapshot=m,nm(i)&&am(s)}function rm(s,i,u){return u(function(){nm(i)&&am(s)})}function nm(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Yn(s,u)}catch{return!0}}function am(s){var i=Ra(s,1);i!==null&&Qn(i,s,1,-1)}function sm(s){var i=ua();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:s},i.queue=s,s=s.dispatch=Nk.bind(null,ir,s),[i.memoizedState,s]}function Yi(s,i,u,m){return s={tag:s,create:i,destroy:u,deps:m,next:null},i=ir.updateQueue,i===null?(i={lastEffect:null,stores:null},ir.updateQueue=i,i.lastEffect=s.next=s):(u=i.lastEffect,u===null?i.lastEffect=s.next=s:(m=u.next,u.next=s,s.next=m,i.lastEffect=s)),s}function om(){return An().memoizedState}function kc(s,i,u,m){var v=ua();ir.flags|=s,v.memoizedState=Yi(1|i,u,void 0,m===void 0?null:m)}function _c(s,i,u,m){var v=An();m=m===void 0?null:m;var b=void 0;if(Sr!==null){var N=Sr.memoizedState;if(b=N.destroy,m!==null&&rf(m,N.deps)){v.memoizedState=Yi(i,u,b,m);return}}ir.flags|=s,v.memoizedState=Yi(1|i,u,b,m)}function im(s,i){return kc(8390656,8,s,i)}function lf(s,i){return _c(2048,8,s,i)}function lm(s,i){return _c(4,2,s,i)}function cm(s,i){return _c(4,4,s,i)}function um(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function fm(s,i,u){return u=u!=null?u.concat([s]):null,_c(4,4,um.bind(null,i,s),u)}function cf(){}function dm(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&rf(i,m[1])?m[0]:(u.memoizedState=[s,i],s)}function pm(s,i){var u=An();i=i===void 0?null:i;var m=u.memoizedState;return m!==null&&i!==null&&rf(i,m[1])?m[0]:(s=s(),u.memoizedState=[s,i],s)}function hm(s,i,u){return(Ws&21)===0?(s.baseState&&(s.baseState=!1,mn=!0),s.memoizedState=u):(Yn(u,i)||(u=$p(),ir.lanes|=u,Us|=u,s.baseState=!0),i)}function Ck(s,i){var u=Ht;Ht=u!==0&&4>u?u:4,s(!0);var m=tf.transition;tf.transition={};try{s(!1),i()}finally{Ht=u,tf.transition=m}}function mm(){return An().memoizedState}function Dk(s,i,u){var m=ds(s);if(u={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null},xm(s))gm(i,u);else if(u=Kh(s,i,u,m),u!==null){var v=rn();Qn(u,s,m,v),vm(u,i,m)}}function Nk(s,i,u){var m=ds(s),v={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null};if(xm(s))gm(i,v);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var N=i.lastRenderedState,ne=b(N,u);if(v.hasEagerState=!0,v.eagerState=ne,Yn(ne,N)){var ce=i.interleaved;ce===null?(v.next=v,X0(i)):(v.next=ce.next,ce.next=v),i.interleaved=v;return}}catch{}finally{}u=Kh(s,i,v,m),u!==null&&(v=rn(),Qn(u,s,m,v),vm(u,i,m))}}function xm(s){var i=s.alternate;return s===ir||i!==null&&i===ir}function gm(s,i){Ui=wc=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function vm(s,i,u){if((u&4194240)!==0){var m=i.lanes;m&=s.pendingLanes,u|=m,i.lanes=u,u0(s,u)}}var bc={readContext:Fn,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},Fk={readContext:Fn,useCallback:function(s,i){return ua().memoizedState=[s,i===void 0?null:i],s},useContext:Fn,useEffect:im,useImperativeHandle:function(s,i,u){return u=u!=null?u.concat([s]):null,kc(4194308,4,um.bind(null,i,s),u)},useLayoutEffect:function(s,i){return kc(4194308,4,s,i)},useInsertionEffect:function(s,i){return kc(4,2,s,i)},useMemo:function(s,i){var u=ua();return i=i===void 0?null:i,s=s(),u.memoizedState=[s,i],s},useReducer:function(s,i,u){var m=ua();return i=u!==void 0?u(i):i,m.memoizedState=m.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},m.queue=s,s=s.dispatch=Dk.bind(null,ir,s),[m.memoizedState,s]},useRef:function(s){var i=ua();return s={current:s},i.memoizedState=s},useState:sm,useDebugValue:cf,useDeferredValue:function(s){return ua().memoizedState=s},useTransition:function(){var s=sm(!1),i=s[0];return s=Ck.bind(null,s[1]),ua().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,u){var m=ir,v=ua();if(tr){if(u===void 0)throw Error(t(407));u=u()}else{if(u=i(),Pr===null)throw Error(t(349));(Ws&30)!==0||em(m,i,u)}v.memoizedState=u;var b={value:u,getSnapshot:i};return v.queue=b,im(rm.bind(null,m,b,s),[s]),m.flags|=2048,Yi(9,tm.bind(null,m,b,u,i),void 0,null),u},useId:function(){var s=ua(),i=Pr.identifierPrefix;if(tr){var u=Pa,m=Oa;u=(m&~(1<<32-mr(m)-1)).toString(32)+u,i=":"+i+"R"+u,u=Hi++,0<u&&(i+="H"+u.toString(32)),i+=":"}else u=Tk++,i=":"+i+"r"+u.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Ak={readContext:Fn,useCallback:dm,useContext:Fn,useEffect:lf,useImperativeHandle:fm,useInsertionEffect:lm,useLayoutEffect:cm,useMemo:pm,useReducer:sf,useRef:om,useState:function(){return sf($i)},useDebugValue:cf,useDeferredValue:function(s){var i=An();return hm(i,Sr.memoizedState,s)},useTransition:function(){var s=sf($i)[0],i=An().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:mm,unstable_isNewReconciler:!1},Ok={readContext:Fn,useCallback:dm,useContext:Fn,useEffect:lf,useImperativeHandle:fm,useInsertionEffect:lm,useLayoutEffect:cm,useMemo:pm,useReducer:of,useRef:om,useState:function(){return of($i)},useDebugValue:cf,useDeferredValue:function(s){var i=An();return Sr===null?i.memoizedState=s:hm(i,Sr.memoizedState,s)},useTransition:function(){var s=of($i)[0],i=An().memoizedState;return[s,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:mm,unstable_isNewReconciler:!1};function Kn(s,i){if(s&&s.defaultProps){i=ae({},i),s=s.defaultProps;for(var u in s)i[u]===void 0&&(i[u]=s[u]);return i}return i}function uf(s,i,u,m){i=s.memoizedState,u=u(m,i),u=u==null?i:ae({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Ec={isMounted:function(s){return(s=s._reactInternals)?q(s)===s:!1},enqueueSetState:function(s,i,u){s=s._reactInternals;var m=rn(),v=ds(s),b=Ma(m,v);b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var m=rn(),v=ds(s),b=Ma(m,v);b.tag=1,b.payload=i,u!=null&&(b.callback=u),i=ls(s,b,v),i!==null&&(Qn(i,s,v,m),xc(i,s,v))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=rn(),m=ds(s),v=Ma(u,m);v.tag=2,i!=null&&(v.callback=i),i=ls(s,v,m),i!==null&&(Qn(i,s,m,u),xc(i,s,m))}};function ym(s,i,u,m,v,b,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,b,N):i.prototype&&i.prototype.isPureReactComponent?!Ai(u,m)||!Ai(v,b):!0}function wm(s,i,u){var m=!1,v=ss,b=i.contextType;return typeof b=="object"&&b!==null?b=Fn(b):(v=hn(i)?Is:$r.current,m=i.contextTypes,b=(m=m!=null)?Ao(s,v):ss),i=new i(u,b),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ec,s.stateNode=i,i._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=v,s.__reactInternalMemoizedMaskedChildContext=b),i}function km(s,i,u,m){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,m),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,m),i.state!==s&&Ec.enqueueReplaceState(i,i.state,null)}function ff(s,i,u,m){var v=s.stateNode;v.props=u,v.state=s.memoizedState,v.refs={},Q0(s);var b=i.contextType;typeof b=="object"&&b!==null?v.context=Fn(b):(b=hn(i)?Is:$r.current,v.context=Ao(s,b)),v.state=s.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(uf(s,i,b,u),v.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(i=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),i!==v.state&&Ec.enqueueReplaceState(v,v.state,null),gc(s,u,v,m),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308)}function zo(s,i){try{var u="",m=i;do u+=z(m),m=m.return;while(m);var v=u}catch(b){v=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:i,stack:v,digest:null}}function df(s,i,u){return{value:s,source:null,stack:u??null,digest:i??null}}function pf(s,i){try{console.error(i.value)}catch(u){setTimeout(function(){throw u})}}var Pk=typeof WeakMap=="function"?WeakMap:Map;function _m(s,i,u){u=Ma(-1,u),u.tag=3,u.payload={element:null};var m=i.value;return u.callback=function(){Ac||(Ac=!0,Df=m),pf(s,i)},u}function bm(s,i,u){u=Ma(-1,u),u.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var v=i.value;u.payload=function(){return m(v)},u.callback=function(){pf(s,i)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(u.callback=function(){pf(s,i),typeof m!="function"&&(us===null?us=new Set([this]):us.add(this));var N=i.stack;this.componentDidCatch(i.value,{componentStack:N!==null?N:""})}),u}function Em(s,i,u){var m=s.pingCache;if(m===null){m=s.pingCache=new Pk;var v=new Set;m.set(i,v)}else v=m.get(i),v===void 0&&(v=new Set,m.set(i,v));v.has(u)||(v.add(u),s=Kk.bind(null,s,i,u),i.then(s,s))}function Sm(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Tm(s,i,u,m,v){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(i=Ma(-1,1),i.tag=2,ls(u,i,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=v,s)}var Rk=j.ReactCurrentOwner,mn=!1;function tn(s,i,u,m){i.child=s===null?Vh(i,null,u,m):Mo(i,s.child,u,m)}function Cm(s,i,u,m,v){u=u.render;var b=i.ref;return jo(i,v),m=nf(s,i,u,m,b,v),u=af(),s!==null&&!mn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(tr&&u&&B0(i),i.flags|=1,tn(s,i,m,v),i.child)}function Dm(s,i,u,m,v){if(s===null){var b=u.type;return typeof b=="function"&&!Mf(b)&&b.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(i.tag=15,i.type=b,Nm(s,i,b,m,v)):(s=jc(u.type,null,m,i,i.mode,v),s.ref=i.ref,s.return=i,i.child=s)}if(b=s.child,(s.lanes&v)===0){var N=b.memoizedProps;if(u=u.compare,u=u!==null?u:Ai,u(N,m)&&s.ref===i.ref)return Ia(s,i,v)}return i.flags|=1,s=hs(b,m),s.ref=i.ref,s.return=i,i.child=s}function Nm(s,i,u,m,v){if(s!==null){var b=s.memoizedProps;if(Ai(b,m)&&s.ref===i.ref)if(mn=!1,i.pendingProps=m=b,(s.lanes&v)!==0)(s.flags&131072)!==0&&(mn=!0);else return i.lanes=s.lanes,Ia(s,i,v)}return hf(s,i,u,m,v)}function Fm(s,i,u){var m=i.pendingProps,v=m.children,b=s!==null?s.memoizedState:null;if(m.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(Wo,bn),bn|=u;else{if((u&1073741824)===0)return s=b!==null?b.baseLanes|u:u,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,qt(Wo,bn),bn|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=b!==null?b.baseLanes:u,qt(Wo,bn),bn|=m}else b!==null?(m=b.baseLanes|u,i.memoizedState=null):m=u,qt(Wo,bn),bn|=m;return tn(s,i,v,u),i.child}function Am(s,i){var u=i.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(i.flags|=512,i.flags|=2097152)}function hf(s,i,u,m,v){var b=hn(u)?Is:$r.current;return b=Ao(i,b),jo(i,v),u=nf(s,i,u,m,b,v),m=af(),s!==null&&!mn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Ia(s,i,v)):(tr&&m&&B0(i),i.flags|=1,tn(s,i,u,v),i.child)}function Om(s,i,u,m,v){if(hn(u)){var b=!0;lc(i)}else b=!1;if(jo(i,v),i.stateNode===null)Tc(s,i),wm(i,u,m),ff(i,u,m,v),m=!0;else if(s===null){var N=i.stateNode,ne=i.memoizedProps;N.props=ne;var ce=N.context,Ee=u.contextType;typeof Ee=="object"&&Ee!==null?Ee=Fn(Ee):(Ee=hn(u)?Is:$r.current,Ee=Ao(i,Ee));var Pe=u.getDerivedStateFromProps,Be=typeof Pe=="function"||typeof N.getSnapshotBeforeUpdate=="function";Be||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(ne!==m||ce!==Ee)&&km(i,N,m,Ee),is=!1;var Oe=i.memoizedState;N.state=Oe,gc(i,m,N,v),ce=i.memoizedState,ne!==m||Oe!==ce||pn.current||is?(typeof Pe=="function"&&(uf(i,u,Pe,m),ce=i.memoizedState),(ne=is||ym(i,u,ne,m,Oe,ce,Ee))?(Be||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(i.flags|=4194308)):(typeof N.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=m,i.memoizedState=ce),N.props=m,N.state=ce,N.context=Ee,m=ne):(typeof N.componentDidMount=="function"&&(i.flags|=4194308),m=!1)}else{N=i.stateNode,Gh(s,i),ne=i.memoizedProps,Ee=i.type===i.elementType?ne:Kn(i.type,ne),N.props=Ee,Be=i.pendingProps,Oe=N.context,ce=u.contextType,typeof ce=="object"&&ce!==null?ce=Fn(ce):(ce=hn(u)?Is:$r.current,ce=Ao(i,ce));var Xe=u.getDerivedStateFromProps;(Pe=typeof Xe=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(ne!==Be||Oe!==ce)&&km(i,N,m,ce),is=!1,Oe=i.memoizedState,N.state=Oe,gc(i,m,N,v);var Je=i.memoizedState;ne!==Be||Oe!==Je||pn.current||is?(typeof Xe=="function"&&(uf(i,u,Xe,m),Je=i.memoizedState),(Ee=is||ym(i,u,Ee,m,Oe,Je,ce)||!1)?(Pe||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(m,Je,ce),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(m,Je,ce)),typeof N.componentDidUpdate=="function"&&(i.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof N.componentDidUpdate!="function"||ne===s.memoizedProps&&Oe===s.memoizedState||(i.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||ne===s.memoizedProps&&Oe===s.memoizedState||(i.flags|=1024),i.memoizedProps=m,i.memoizedState=Je),N.props=m,N.state=Je,N.context=ce,m=Ee):(typeof N.componentDidUpdate!="function"||ne===s.memoizedProps&&Oe===s.memoizedState||(i.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||ne===s.memoizedProps&&Oe===s.memoizedState||(i.flags|=1024),m=!1)}return mf(s,i,u,m,b,v)}function mf(s,i,u,m,v,b){Am(s,i);var N=(i.flags&128)!==0;if(!m&&!N)return v&&jh(i,u,!1),Ia(s,i,b);m=i.stateNode,Rk.current=i;var ne=N&&typeof u.getDerivedStateFromError!="function"?null:m.render();return i.flags|=1,s!==null&&N?(i.child=Mo(i,s.child,null,b),i.child=Mo(i,null,ne,b)):tn(s,i,ne,b),i.memoizedState=m.state,v&&jh(i,u,!0),i.child}function Pm(s){var i=s.stateNode;i.pendingContext?Mh(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Mh(s,i.context,!1),q0(s,i.containerInfo)}function Rm(s,i,u,m,v){return Ro(),$0(v),i.flags|=256,tn(s,i,u,m),i.child}var xf={dehydrated:null,treeContext:null,retryLane:0};function gf(s){return{baseLanes:s,cachePool:null,transitions:null}}function Mm(s,i,u){var m=i.pendingProps,v=or.current,b=!1,N=(i.flags&128)!==0,ne;if((ne=N)||(ne=s!==null&&s.memoizedState===null?!1:(v&2)!==0),ne?(b=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(v|=1),qt(or,v&1),s===null)return H0(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(N=m.children,s=m.fallback,b?(m=i.mode,b=i.child,N={mode:"hidden",children:N},(m&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=N):b=Lc(N,m,0,null),s=Vs(s,m,u,null),b.return=i,s.return=i,b.sibling=s,i.child=b,i.child.memoizedState=gf(u),i.memoizedState=xf,s):vf(i,N));if(v=s.memoizedState,v!==null&&(ne=v.dehydrated,ne!==null))return Mk(s,i,N,m,ne,v,u);if(b){b=m.fallback,N=i.mode,v=s.child,ne=v.sibling;var ce={mode:"hidden",children:m.children};return(N&1)===0&&i.child!==v?(m=i.child,m.childLanes=0,m.pendingProps=ce,i.deletions=null):(m=hs(v,ce),m.subtreeFlags=v.subtreeFlags&14680064),ne!==null?b=hs(ne,b):(b=Vs(b,N,u,null),b.flags|=2),b.return=i,m.return=i,m.sibling=b,i.child=m,m=b,b=i.child,N=s.child.memoizedState,N=N===null?gf(u):{baseLanes:N.baseLanes|u,cachePool:null,transitions:N.transitions},b.memoizedState=N,b.childLanes=s.childLanes&~u,i.memoizedState=xf,m}return b=s.child,s=b.sibling,m=hs(b,{mode:"visible",children:m.children}),(i.mode&1)===0&&(m.lanes=u),m.return=i,m.sibling=null,s!==null&&(u=i.deletions,u===null?(i.deletions=[s],i.flags|=16):u.push(s)),i.child=m,i.memoizedState=null,m}function vf(s,i){return i=Lc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Sc(s,i,u,m){return m!==null&&$0(m),Mo(i,s.child,null,u),s=vf(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Mk(s,i,u,m,v,b,N){if(u)return i.flags&256?(i.flags&=-257,m=df(Error(t(422))),Sc(s,i,N,m)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(b=m.fallback,v=i.mode,m=Lc({mode:"visible",children:m.children},v,0,null),b=Vs(b,v,N,null),b.flags|=2,m.return=i,b.return=i,m.sibling=b,i.child=m,(i.mode&1)!==0&&Mo(i,s.child,null,N),i.child.memoizedState=gf(N),i.memoizedState=xf,b);if((i.mode&1)===0)return Sc(s,i,N,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var ne=m.dgst;return m=ne,b=Error(t(419)),m=df(b,m,void 0),Sc(s,i,N,m)}if(ne=(N&s.childLanes)!==0,mn||ne){if(m=Pr,m!==null){switch(N&-N){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|N))!==0?0:v,v!==0&&v!==b.retryLane&&(b.retryLane=v,Ra(s,v),Qn(m,s,v,-1))}return Rf(),m=df(Error(t(421))),Sc(s,i,N,m)}return v.data==="$?"?(i.flags|=128,i.child=s.child,i=Gk.bind(null,s),v._reactRetry=i,null):(s=b.treeContext,_n=ns(v.nextSibling),kn=i,tr=!0,Vn=null,s!==null&&(Dn[Nn++]=Oa,Dn[Nn++]=Pa,Dn[Nn++]=js,Oa=s.id,Pa=s.overflow,js=i),i=vf(i,m.children),i.flags|=4096,i)}function Im(s,i,u){s.lanes|=i;var m=s.alternate;m!==null&&(m.lanes|=i),G0(s.return,i,u)}function yf(s,i,u,m,v){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:v}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=m,b.tail=u,b.tailMode=v)}function jm(s,i,u){var m=i.pendingProps,v=m.revealOrder,b=m.tail;if(tn(s,i,m.children,u),m=or.current,(m&2)!==0)m=m&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Im(s,u,i);else if(s.tag===19)Im(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(qt(or,m),(i.mode&1)===0)i.memoizedState=null;else switch(v){case"forwards":for(u=i.child,v=null;u!==null;)s=u.alternate,s!==null&&vc(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=i.child,i.child=null):(v=u.sibling,u.sibling=null),yf(i,!1,v,u,b);break;case"backwards":for(u=null,v=i.child,i.child=null;v!==null;){if(s=v.alternate,s!==null&&vc(s)===null){i.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}yf(i,!0,u,null,b);break;case"together":yf(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Tc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Ia(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),Us|=i.lanes,(u&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,u=hs(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=hs(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function Ik(s,i,u){switch(i.tag){case 3:Pm(i),Ro();break;case 5:qh(i);break;case 1:hn(i.type)&&lc(i);break;case 4:q0(i,i.stateNode.containerInfo);break;case 10:var m=i.type._context,v=i.memoizedProps.value;qt(hc,m._currentValue),m._currentValue=v;break;case 13:if(m=i.memoizedState,m!==null)return m.dehydrated!==null?(qt(or,or.current&1),i.flags|=128,null):(u&i.child.childLanes)!==0?Mm(s,i,u):(qt(or,or.current&1),s=Ia(s,i,u),s!==null?s.sibling:null);qt(or,or.current&1);break;case 19:if(m=(u&i.childLanes)!==0,(s.flags&128)!==0){if(m)return jm(s,i,u);i.flags|=128}if(v=i.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),qt(or,or.current),m)break;return null;case 22:case 23:return i.lanes=0,Fm(s,i,u)}return Ia(s,i,u)}var Lm,wf,zm,Bm;Lm=function(s,i){for(var u=i.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},wf=function(){},zm=function(s,i,u,m){var v=s.memoizedProps;if(v!==m){s=i.stateNode,Bs(ca.current);var b=null;switch(u){case"input":v=Te(s,v),m=Te(s,m),b=[];break;case"select":v=ae({},v,{value:void 0}),m=ae({},m,{value:void 0}),b=[];break;case"textarea":v=gt(s,v),m=gt(s,m),b=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=sc)}se(u,m);var N;u=null;for(Ee in v)if(!m.hasOwnProperty(Ee)&&v.hasOwnProperty(Ee)&&v[Ee]!=null)if(Ee==="style"){var ne=v[Ee];for(N in ne)ne.hasOwnProperty(N)&&(u||(u={}),u[N]="")}else Ee!=="dangerouslySetInnerHTML"&&Ee!=="children"&&Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&Ee!=="autoFocus"&&(a.hasOwnProperty(Ee)?b||(b=[]):(b=b||[]).push(Ee,null));for(Ee in m){var ce=m[Ee];if(ne=v?.[Ee],m.hasOwnProperty(Ee)&&ce!==ne&&(ce!=null||ne!=null))if(Ee==="style")if(ne){for(N in ne)!ne.hasOwnProperty(N)||ce&&ce.hasOwnProperty(N)||(u||(u={}),u[N]="");for(N in ce)ce.hasOwnProperty(N)&&ne[N]!==ce[N]&&(u||(u={}),u[N]=ce[N])}else u||(b||(b=[]),b.push(Ee,u)),u=ce;else Ee==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ne=ne?ne.__html:void 0,ce!=null&&ne!==ce&&(b=b||[]).push(Ee,ce)):Ee==="children"?typeof ce!="string"&&typeof ce!="number"||(b=b||[]).push(Ee,""+ce):Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ee)?(ce!=null&&Ee==="onScroll"&&Jt("scroll",s),b||ne===ce||(b=[])):(b=b||[]).push(Ee,ce))}u&&(b=b||[]).push("style",u);var Ee=b;(i.updateQueue=Ee)&&(i.flags|=4)}},Bm=function(s,i,u,m){u!==m&&(i.flags|=4)};function Vi(s,i){if(!tr)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Vr(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,m=0;if(i)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=m,s.childLanes=u,i}function jk(s,i,u){var m=i.pendingProps;switch(W0(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(i),null;case 1:return hn(i.type)&&ic(),Vr(i),null;case 3:return m=i.stateNode,Lo(),er(pn),er($r),ef(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(dc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Vn!==null&&(Af(Vn),Vn=null))),wf(s,i),Vr(i),null;case 5:Z0(i);var v=Bs(Wi.current);if(u=i.type,s!==null&&i.stateNode!=null)zm(s,i,u,m,v),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!m){if(i.stateNode===null)throw Error(t(166));return Vr(i),null}if(s=Bs(ca.current),dc(i)){m=i.stateNode,u=i.type;var b=i.memoizedProps;switch(m[la]=i,m[Ii]=b,s=(i.mode&1)!==0,u){case"dialog":Jt("cancel",m),Jt("close",m);break;case"iframe":case"object":case"embed":Jt("load",m);break;case"video":case"audio":for(v=0;v<Pi.length;v++)Jt(Pi[v],m);break;case"source":Jt("error",m);break;case"img":case"image":case"link":Jt("error",m),Jt("load",m);break;case"details":Jt("toggle",m);break;case"input":st(m,b),Jt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!b.multiple},Jt("invalid",m);break;case"textarea":ht(m,b),Jt("invalid",m)}se(u,b),v=null;for(var N in b)if(b.hasOwnProperty(N)){var ne=b[N];N==="children"?typeof ne=="string"?m.textContent!==ne&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,ne,s),v=["children",ne]):typeof ne=="number"&&m.textContent!==""+ne&&(b.suppressHydrationWarning!==!0&&ac(m.textContent,ne,s),v=["children",""+ne]):a.hasOwnProperty(N)&&ne!=null&&N==="onScroll"&&Jt("scroll",m)}switch(u){case"input":xe(m),De(m,b,!0);break;case"textarea":xe(m),Nt(m);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(m.onclick=sc)}m=v,i.updateQueue=m,m!==null&&(i.flags|=4)}else{N=v.nodeType===9?v:v.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Kt(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=N.createElement(u,{is:m.is}):(s=N.createElement(u),u==="select"&&(N=s,m.multiple?N.multiple=!0:m.size&&(N.size=m.size))):s=N.createElementNS(s,u),s[la]=i,s[Ii]=m,Lm(s,i,!1,!1),i.stateNode=s;e:{switch(N=Ne(u,m),u){case"dialog":Jt("cancel",s),Jt("close",s),v=m;break;case"iframe":case"object":case"embed":Jt("load",s),v=m;break;case"video":case"audio":for(v=0;v<Pi.length;v++)Jt(Pi[v],s);v=m;break;case"source":Jt("error",s),v=m;break;case"img":case"image":case"link":Jt("error",s),Jt("load",s),v=m;break;case"details":Jt("toggle",s),v=m;break;case"input":st(s,m),v=Te(s,m),Jt("invalid",s);break;case"option":v=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},v=ae({},m,{value:void 0}),Jt("invalid",s);break;case"textarea":ht(s,m),v=gt(s,m),Jt("invalid",s);break;default:v=m}se(u,v),ne=v;for(b in ne)if(ne.hasOwnProperty(b)){var ce=ne[b];b==="style"?zt(s,ce):b==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ce!=null&&Xt(s,ce)):b==="children"?typeof ce=="string"?(u!=="textarea"||ce!=="")&&ot(s,ce):typeof ce=="number"&&ot(s,""+ce):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(a.hasOwnProperty(b)?ce!=null&&b==="onScroll"&&Jt("scroll",s):ce!=null&&T(s,b,ce,N))}switch(u){case"input":xe(s),De(s,m,!1);break;case"textarea":xe(s),Nt(s);break;case"option":m.value!=null&&s.setAttribute("value",""+ie(m.value));break;case"select":s.multiple=!!m.multiple,b=m.value,b!=null?it(s,!!m.multiple,b,!1):m.defaultValue!=null&&it(s,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(s.onclick=sc)}switch(u){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Vr(i),null;case 6:if(s&&i.stateNode!=null)Bm(s,i,s.memoizedProps,m);else{if(typeof m!="string"&&i.stateNode===null)throw Error(t(166));if(u=Bs(Wi.current),Bs(ca.current),dc(i)){if(m=i.stateNode,u=i.memoizedProps,m[la]=i,(b=m.nodeValue!==u)&&(s=kn,s!==null))switch(s.tag){case 3:ac(m.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ac(m.nodeValue,u,(s.mode&1)!==0)}b&&(i.flags|=4)}else m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[la]=i,i.stateNode=m}return Vr(i),null;case 13:if(er(or),m=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(tr&&_n!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Hh(),Ro(),i.flags|=98560,b=!1;else if(b=dc(i),m!==null&&m.dehydrated!==null){if(s===null){if(!b)throw Error(t(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));b[la]=i}else Ro(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Vr(i),b=!1}else Vn!==null&&(Af(Vn),Vn=null),b=!0;if(!b)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=u,i):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(or.current&1)!==0?Tr===0&&(Tr=3):Rf())),i.updateQueue!==null&&(i.flags|=4),Vr(i),null);case 4:return Lo(),wf(s,i),s===null&&Ri(i.stateNode.containerInfo),Vr(i),null;case 10:return K0(i.type._context),Vr(i),null;case 17:return hn(i.type)&&ic(),Vr(i),null;case 19:if(er(or),b=i.memoizedState,b===null)return Vr(i),null;if(m=(i.flags&128)!==0,N=b.rendering,N===null)if(m)Vi(b,!1);else{if(Tr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(N=vc(s),N!==null){for(i.flags|=128,Vi(b,!1),m=N.updateQueue,m!==null&&(i.updateQueue=m,i.flags|=4),i.subtreeFlags=0,m=u,u=i.child;u!==null;)b=u,s=m,b.flags&=14680066,N=b.alternate,N===null?(b.childLanes=0,b.lanes=s,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=N.childLanes,b.lanes=N.lanes,b.child=N.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=N.memoizedProps,b.memoizedState=N.memoizedState,b.updateQueue=N.updateQueue,b.type=N.type,s=N.dependencies,b.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return qt(or,or.current&1|2),i.child}s=s.sibling}b.tail!==null&&je()>Uo&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304)}else{if(!m)if(s=vc(N),s!==null){if(i.flags|=128,m=!0,u=s.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),Vi(b,!0),b.tail===null&&b.tailMode==="hidden"&&!N.alternate&&!tr)return Vr(i),null}else 2*je()-b.renderingStartTime>Uo&&u!==1073741824&&(i.flags|=128,m=!0,Vi(b,!1),i.lanes=4194304);b.isBackwards?(N.sibling=i.child,i.child=N):(u=b.last,u!==null?u.sibling=N:i.child=N,b.last=N)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=je(),i.sibling=null,u=or.current,qt(or,m?u&1|2:u&1),i):(Vr(i),null);case 22:case 23:return Pf(),m=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(i.flags|=8192),m&&(i.mode&1)!==0?(bn&1073741824)!==0&&(Vr(i),i.subtreeFlags&6&&(i.flags|=8192)):Vr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Lk(s,i){switch(W0(i),i.tag){case 1:return hn(i.type)&&ic(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Lo(),er(pn),er($r),ef(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Z0(i),null;case 13:if(er(or),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Ro()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return er(or),null;case 4:return Lo(),null;case 10:return K0(i.type._context),null;case 22:case 23:return Pf(),null;case 24:return null;default:return null}}var Cc=!1,Kr=!1,zk=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Bo(s,i){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(m){ur(s,i,m)}else u.current=null}function kf(s,i,u){try{u()}catch(m){ur(s,i,m)}}var Wm=!1;function Bk(s,i){if(O0=Kl,s=yh(),E0(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var v=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var N=0,ne=-1,ce=-1,Ee=0,Pe=0,Be=s,Oe=null;t:for(;;){for(var Xe;Be!==u||v!==0&&Be.nodeType!==3||(ne=N+v),Be!==b||m!==0&&Be.nodeType!==3||(ce=N+m),Be.nodeType===3&&(N+=Be.nodeValue.length),(Xe=Be.firstChild)!==null;)Oe=Be,Be=Xe;for(;;){if(Be===s)break t;if(Oe===u&&++Ee===v&&(ne=N),Oe===b&&++Pe===m&&(ce=N),(Xe=Be.nextSibling)!==null)break;Be=Oe,Oe=Be.parentNode}Be=Xe}u=ne===-1||ce===-1?null:{start:ne,end:ce}}else u=null}u=u||{start:0,end:0}}else u=null;for(P0={focusedElem:s,selectionRange:u},Kl=!1,qe=i;qe!==null;)if(i=qe,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,qe=s;else for(;qe!==null;){i=qe;try{var Je=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Je!==null){var tt=Je.memoizedProps,xr=Je.memoizedState,ve=i.stateNode,pe=ve.getSnapshotBeforeUpdate(i.elementType===i.type?tt:Kn(i.type,tt),xr);ve.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var ke=i.stateNode.containerInfo;ke.nodeType===1?ke.textContent="":ke.nodeType===9&&ke.documentElement&&ke.removeChild(ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ue){ur(i,i.return,Ue)}if(s=i.sibling,s!==null){s.return=i.return,qe=s;break}qe=i.return}return Je=Wm,Wm=!1,Je}function Ki(s,i,u){var m=i.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&s)===s){var b=v.destroy;v.destroy=void 0,b!==void 0&&kf(i,u,b)}v=v.next}while(v!==m)}}function Dc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&s)===s){var m=u.create;u.destroy=m()}u=u.next}while(u!==i)}}function _f(s){var i=s.ref;if(i!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof i=="function"?i(s):i.current=s}}function Um(s){var i=s.alternate;i!==null&&(s.alternate=null,Um(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[la],delete i[Ii],delete i[j0],delete i[_k],delete i[bk])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Hm(s){return s.tag===5||s.tag===3||s.tag===4}function $m(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Hm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function bf(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.nodeType===8?u.parentNode.insertBefore(s,i):u.insertBefore(s,i):(u.nodeType===8?(i=u.parentNode,i.insertBefore(s,u)):(i=u,i.appendChild(s)),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=sc));else if(m!==4&&(s=s.child,s!==null))for(bf(s,i,u),s=s.sibling;s!==null;)bf(s,i,u),s=s.sibling}function Ef(s,i,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(Ef(s,i,u),s=s.sibling;s!==null;)Ef(s,i,u),s=s.sibling}var Lr=null,Gn=!1;function cs(s,i,u){for(u=u.child;u!==null;)Ym(s,i,u),u=u.sibling}function Ym(s,i,u){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(ia,u)}catch{}switch(u.tag){case 5:Kr||Bo(u,i);case 6:var m=Lr,v=Gn;Lr=null,cs(s,i,u),Lr=m,Gn=v,Lr!==null&&(Gn?(s=Lr,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):Lr.removeChild(u.stateNode));break;case 18:Lr!==null&&(Gn?(s=Lr,u=u.stateNode,s.nodeType===8?I0(s.parentNode,u):s.nodeType===1&&I0(s,u),Si(s)):I0(Lr,u.stateNode));break;case 4:m=Lr,v=Gn,Lr=u.stateNode.containerInfo,Gn=!0,cs(s,i,u),Lr=m,Gn=v;break;case 0:case 11:case 14:case 15:if(!Kr&&(m=u.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var b=v,N=b.destroy;b=b.tag,N!==void 0&&((b&2)!==0||(b&4)!==0)&&kf(u,i,N),v=v.next}while(v!==m)}cs(s,i,u);break;case 1:if(!Kr&&(Bo(u,i),m=u.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=u.memoizedProps,m.state=u.memoizedState,m.componentWillUnmount()}catch(ne){ur(u,i,ne)}cs(s,i,u);break;case 21:cs(s,i,u);break;case 22:u.mode&1?(Kr=(m=Kr)||u.memoizedState!==null,cs(s,i,u),Kr=m):cs(s,i,u);break;default:cs(s,i,u)}}function Vm(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new zk),i.forEach(function(m){var v=Xk.bind(null,s,m);u.has(m)||(u.add(m),m.then(v,v))})}}function Xn(s,i){var u=i.deletions;if(u!==null)for(var m=0;m<u.length;m++){var v=u[m];try{var b=s,N=i,ne=N;e:for(;ne!==null;){switch(ne.tag){case 5:Lr=ne.stateNode,Gn=!1;break e;case 3:Lr=ne.stateNode.containerInfo,Gn=!0;break e;case 4:Lr=ne.stateNode.containerInfo,Gn=!0;break e}ne=ne.return}if(Lr===null)throw Error(t(160));Ym(b,N,v),Lr=null,Gn=!1;var ce=v.alternate;ce!==null&&(ce.return=null),v.return=null}catch(Ee){ur(v,i,Ee)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Km(i,s),i=i.sibling}function Km(s,i){var u=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Xn(i,s),fa(s),m&4){try{Ki(3,s,s.return),Dc(3,s)}catch(tt){ur(s,s.return,tt)}try{Ki(5,s,s.return)}catch(tt){ur(s,s.return,tt)}}break;case 1:Xn(i,s),fa(s),m&512&&u!==null&&Bo(u,u.return);break;case 5:if(Xn(i,s),fa(s),m&512&&u!==null&&Bo(u,u.return),s.flags&32){var v=s.stateNode;try{ot(v,"")}catch(tt){ur(s,s.return,tt)}}if(m&4&&(v=s.stateNode,v!=null)){var b=s.memoizedProps,N=u!==null?u.memoizedProps:b,ne=s.type,ce=s.updateQueue;if(s.updateQueue=null,ce!==null)try{ne==="input"&&b.type==="radio"&&b.name!=null&&Ge(v,b),Ne(ne,N);var Ee=Ne(ne,b);for(N=0;N<ce.length;N+=2){var Pe=ce[N],Be=ce[N+1];Pe==="style"?zt(v,Be):Pe==="dangerouslySetInnerHTML"?Xt(v,Be):Pe==="children"?ot(v,Be):T(v,Pe,Be,Ee)}switch(ne){case"input":de(v,b);break;case"textarea":Dt(v,b);break;case"select":var Oe=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!b.multiple;var Xe=b.value;Xe!=null?it(v,!!b.multiple,Xe,!1):Oe!==!!b.multiple&&(b.defaultValue!=null?it(v,!!b.multiple,b.defaultValue,!0):it(v,!!b.multiple,b.multiple?[]:"",!1))}v[Ii]=b}catch(tt){ur(s,s.return,tt)}}break;case 6:if(Xn(i,s),fa(s),m&4){if(s.stateNode===null)throw Error(t(162));v=s.stateNode,b=s.memoizedProps;try{v.nodeValue=b}catch(tt){ur(s,s.return,tt)}}break;case 3:if(Xn(i,s),fa(s),m&4&&u!==null&&u.memoizedState.isDehydrated)try{Si(i.containerInfo)}catch(tt){ur(s,s.return,tt)}break;case 4:Xn(i,s),fa(s);break;case 13:Xn(i,s),fa(s),v=s.child,v.flags&8192&&(b=v.memoizedState!==null,v.stateNode.isHidden=b,!b||v.alternate!==null&&v.alternate.memoizedState!==null||(Cf=je())),m&4&&Vm(s);break;case 22:if(Pe=u!==null&&u.memoizedState!==null,s.mode&1?(Kr=(Ee=Kr)||Pe,Xn(i,s),Kr=Ee):Xn(i,s),fa(s),m&8192){if(Ee=s.memoizedState!==null,(s.stateNode.isHidden=Ee)&&!Pe&&(s.mode&1)!==0)for(qe=s,Pe=s.child;Pe!==null;){for(Be=qe=Pe;qe!==null;){switch(Oe=qe,Xe=Oe.child,Oe.tag){case 0:case 11:case 14:case 15:Ki(4,Oe,Oe.return);break;case 1:Bo(Oe,Oe.return);var Je=Oe.stateNode;if(typeof Je.componentWillUnmount=="function"){m=Oe,u=Oe.return;try{i=m,Je.props=i.memoizedProps,Je.state=i.memoizedState,Je.componentWillUnmount()}catch(tt){ur(m,u,tt)}}break;case 5:Bo(Oe,Oe.return);break;case 22:if(Oe.memoizedState!==null){Qm(Be);continue}}Xe!==null?(Xe.return=Oe,qe=Xe):Qm(Be)}Pe=Pe.sibling}e:for(Pe=null,Be=s;;){if(Be.tag===5){if(Pe===null){Pe=Be;try{v=Be.stateNode,Ee?(b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(ne=Be.stateNode,ce=Be.memoizedProps.style,N=ce!=null&&ce.hasOwnProperty("display")?ce.display:null,ne.style.display=Et("display",N))}catch(tt){ur(s,s.return,tt)}}}else if(Be.tag===6){if(Pe===null)try{Be.stateNode.nodeValue=Ee?"":Be.memoizedProps}catch(tt){ur(s,s.return,tt)}}else if((Be.tag!==22&&Be.tag!==23||Be.memoizedState===null||Be===s)&&Be.child!==null){Be.child.return=Be,Be=Be.child;continue}if(Be===s)break e;for(;Be.sibling===null;){if(Be.return===null||Be.return===s)break e;Pe===Be&&(Pe=null),Be=Be.return}Pe===Be&&(Pe=null),Be.sibling.return=Be.return,Be=Be.sibling}}break;case 19:Xn(i,s),fa(s),m&4&&Vm(s);break;case 21:break;default:Xn(i,s),fa(s)}}function fa(s){var i=s.flags;if(i&2){try{e:{for(var u=s.return;u!==null;){if(Hm(u)){var m=u;break e}u=u.return}throw Error(t(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(ot(v,""),m.flags&=-33);var b=$m(s);Ef(s,b,v);break;case 3:case 4:var N=m.stateNode.containerInfo,ne=$m(s);bf(s,ne,N);break;default:throw Error(t(161))}}catch(ce){ur(s,s.return,ce)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Wk(s,i,u){qe=s,Gm(s)}function Gm(s,i,u){for(var m=(s.mode&1)!==0;qe!==null;){var v=qe,b=v.child;if(v.tag===22&&m){var N=v.memoizedState!==null||Cc;if(!N){var ne=v.alternate,ce=ne!==null&&ne.memoizedState!==null||Kr;ne=Cc;var Ee=Kr;if(Cc=N,(Kr=ce)&&!Ee)for(qe=v;qe!==null;)N=qe,ce=N.child,N.tag===22&&N.memoizedState!==null?qm(v):ce!==null?(ce.return=N,qe=ce):qm(v);for(;b!==null;)qe=b,Gm(b),b=b.sibling;qe=v,Cc=ne,Kr=Ee}Xm(s)}else(v.subtreeFlags&8772)!==0&&b!==null?(b.return=v,qe=b):Xm(s)}}function Xm(s){for(;qe!==null;){var i=qe;if((i.flags&8772)!==0){var u=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Kr||Dc(5,i);break;case 1:var m=i.stateNode;if(i.flags&4&&!Kr)if(u===null)m.componentDidMount();else{var v=i.elementType===i.type?u.memoizedProps:Kn(i.type,u.memoizedProps);m.componentDidUpdate(v,u.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&Qh(i,b,m);break;case 3:var N=i.updateQueue;if(N!==null){if(u=null,i.child!==null)switch(i.child.tag){case 5:u=i.child.stateNode;break;case 1:u=i.child.stateNode}Qh(i,N,u)}break;case 5:var ne=i.stateNode;if(u===null&&i.flags&4){u=ne;var ce=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":ce.autoFocus&&u.focus();break;case"img":ce.src&&(u.src=ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Ee=i.alternate;if(Ee!==null){var Pe=Ee.memoizedState;if(Pe!==null){var Be=Pe.dehydrated;Be!==null&&Si(Be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kr||i.flags&512&&_f(i)}catch(Oe){ur(i,i.return,Oe)}}if(i===s){qe=null;break}if(u=i.sibling,u!==null){u.return=i.return,qe=u;break}qe=i.return}}function Qm(s){for(;qe!==null;){var i=qe;if(i===s){qe=null;break}var u=i.sibling;if(u!==null){u.return=i.return,qe=u;break}qe=i.return}}function qm(s){for(;qe!==null;){var i=qe;try{switch(i.tag){case 0:case 11:case 15:var u=i.return;try{Dc(4,i)}catch(ce){ur(i,u,ce)}break;case 1:var m=i.stateNode;if(typeof m.componentDidMount=="function"){var v=i.return;try{m.componentDidMount()}catch(ce){ur(i,v,ce)}}var b=i.return;try{_f(i)}catch(ce){ur(i,b,ce)}break;case 5:var N=i.return;try{_f(i)}catch(ce){ur(i,N,ce)}}}catch(ce){ur(i,i.return,ce)}if(i===s){qe=null;break}var ne=i.sibling;if(ne!==null){ne.return=i.return,qe=ne;break}qe=i.return}}var Uk=Math.ceil,Nc=j.ReactCurrentDispatcher,Sf=j.ReactCurrentOwner,On=j.ReactCurrentBatchConfig,Ot=0,Pr=null,kr=null,zr=0,bn=0,Wo=as(0),Tr=0,Gi=null,Us=0,Fc=0,Tf=0,Xi=null,xn=null,Cf=0,Uo=1/0,ja=null,Ac=!1,Df=null,us=null,Oc=!1,fs=null,Pc=0,Qi=0,Nf=null,Rc=-1,Mc=0;function rn(){return(Ot&6)!==0?je():Rc!==-1?Rc:Rc=je()}function ds(s){return(s.mode&1)===0?1:(Ot&2)!==0&&zr!==0?zr&-zr:Sk.transition!==null?(Mc===0&&(Mc=$p()),Mc):(s=Ht,s!==0||(s=window.event,s=s===void 0?16:Jp(s.type)),s)}function Qn(s,i,u,m){if(50<Qi)throw Qi=0,Nf=null,Error(t(185));wi(s,u,m),((Ot&2)===0||s!==Pr)&&(s===Pr&&((Ot&2)===0&&(Fc|=u),Tr===4&&ps(s,zr)),gn(s,m),u===1&&Ot===0&&(i.mode&1)===0&&(Uo=je()+500,cc&&os()))}function gn(s,i){var u=s.callbackNode;Sw(s,i);var m=$l(s,s===Pr?zr:0);if(m===0)u!==null&&$e(u),s.callbackNode=null,s.callbackPriority=0;else if(i=m&-m,s.callbackPriority!==i){if(u!=null&&$e(u),i===1)s.tag===0?Ek(Jm.bind(null,s)):Lh(Jm.bind(null,s)),wk(function(){(Ot&6)===0&&os()}),u=null;else{switch(Yp(m)){case 1:u=Ut;break;case 4:u=Bt;break;case 16:u=hr;break;case 536870912:u=Qa;break;default:u=hr}u=ix(u,Zm.bind(null,s))}s.callbackPriority=i,s.callbackNode=u}}function Zm(s,i){if(Rc=-1,Mc=0,(Ot&6)!==0)throw Error(t(327));var u=s.callbackNode;if(Ho()&&s.callbackNode!==u)return null;var m=$l(s,s===Pr?zr:0);if(m===0)return null;if((m&30)!==0||(m&s.expiredLanes)!==0||i)i=Ic(s,m);else{i=m;var v=Ot;Ot|=2;var b=tx();(Pr!==s||zr!==i)&&(ja=null,Uo=je()+500,$s(s,i));do try{Yk();break}catch(ne){ex(s,ne)}while(!0);V0(),Nc.current=b,Ot=v,kr!==null?i=0:(Pr=null,zr=0,i=Tr)}if(i!==0){if(i===2&&(v=l0(s),v!==0&&(m=v,i=Ff(s,v))),i===1)throw u=Gi,$s(s,0),ps(s,m),gn(s,je()),u;if(i===6)ps(s,m);else{if(v=s.current.alternate,(m&30)===0&&!Hk(v)&&(i=Ic(s,m),i===2&&(b=l0(s),b!==0&&(m=b,i=Ff(s,b))),i===1))throw u=Gi,$s(s,0),ps(s,m),gn(s,je()),u;switch(s.finishedWork=v,s.finishedLanes=m,i){case 0:case 1:throw Error(t(345));case 2:Ys(s,xn,ja);break;case 3:if(ps(s,m),(m&130023424)===m&&(i=Cf+500-je(),10<i)){if($l(s,0)!==0)break;if(v=s.suspendedLanes,(v&m)!==m){rn(),s.pingedLanes|=s.suspendedLanes&v;break}s.timeoutHandle=M0(Ys.bind(null,s,xn,ja),i);break}Ys(s,xn,ja);break;case 4:if(ps(s,m),(m&4194240)===m)break;for(i=s.eventTimes,v=-1;0<m;){var N=31-mr(m);b=1<<N,N=i[N],N>v&&(v=N),m&=~b}if(m=v,m=je()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*Uk(m/1960))-m,10<m){s.timeoutHandle=M0(Ys.bind(null,s,xn,ja),m);break}Ys(s,xn,ja);break;case 5:Ys(s,xn,ja);break;default:throw Error(t(329))}}}return gn(s,je()),s.callbackNode===u?Zm.bind(null,s):null}function Ff(s,i){var u=Xi;return s.current.memoizedState.isDehydrated&&($s(s,i).flags|=256),s=Ic(s,i),s!==2&&(i=xn,xn=u,i!==null&&Af(i)),s}function Af(s){xn===null?xn=s:xn.push.apply(xn,s)}function Hk(s){for(var i=s;;){if(i.flags&16384){var u=i.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var m=0;m<u.length;m++){var v=u[m],b=v.getSnapshot;v=v.value;try{if(!Yn(b(),v))return!1}catch{return!1}}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ps(s,i){for(i&=~Tf,i&=~Fc,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var u=31-mr(i),m=1<<u;s[u]=-1,i&=~m}}function Jm(s){if((Ot&6)!==0)throw Error(t(327));Ho();var i=$l(s,0);if((i&1)===0)return gn(s,je()),null;var u=Ic(s,i);if(s.tag!==0&&u===2){var m=l0(s);m!==0&&(i=m,u=Ff(s,m))}if(u===1)throw u=Gi,$s(s,0),ps(s,i),gn(s,je()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Ys(s,xn,ja),gn(s,je()),null}function Of(s,i){var u=Ot;Ot|=1;try{return s(i)}finally{Ot=u,Ot===0&&(Uo=je()+500,cc&&os())}}function Hs(s){fs!==null&&fs.tag===0&&(Ot&6)===0&&Ho();var i=Ot;Ot|=1;var u=On.transition,m=Ht;try{if(On.transition=null,Ht=1,s)return s()}finally{Ht=m,On.transition=u,Ot=i,(Ot&6)===0&&os()}}function Pf(){bn=Wo.current,er(Wo)}function $s(s,i){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,yk(u)),kr!==null)for(u=kr.return;u!==null;){var m=u;switch(W0(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&ic();break;case 3:Lo(),er(pn),er($r),ef();break;case 5:Z0(m);break;case 4:Lo();break;case 13:er(or);break;case 19:er(or);break;case 10:K0(m.type._context);break;case 22:case 23:Pf()}u=u.return}if(Pr=s,kr=s=hs(s.current,null),zr=bn=i,Tr=0,Gi=null,Tf=Fc=Us=0,xn=Xi=null,zs!==null){for(i=0;i<zs.length;i++)if(u=zs[i],m=u.interleaved,m!==null){u.interleaved=null;var v=m.next,b=u.pending;if(b!==null){var N=b.next;b.next=v,m.next=N}u.pending=m}zs=null}return s}function ex(s,i){do{var u=kr;try{if(V0(),yc.current=bc,wc){for(var m=ir.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}wc=!1}if(Ws=0,Or=Sr=ir=null,Ui=!1,Hi=0,Sf.current=null,u===null||u.return===null){Tr=1,Gi=i,kr=null;break}e:{var b=s,N=u.return,ne=u,ce=i;if(i=zr,ne.flags|=32768,ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var Ee=ce,Pe=ne,Be=Pe.tag;if((Pe.mode&1)===0&&(Be===0||Be===11||Be===15)){var Oe=Pe.alternate;Oe?(Pe.updateQueue=Oe.updateQueue,Pe.memoizedState=Oe.memoizedState,Pe.lanes=Oe.lanes):(Pe.updateQueue=null,Pe.memoizedState=null)}var Xe=Sm(N);if(Xe!==null){Xe.flags&=-257,Tm(Xe,N,ne,b,i),Xe.mode&1&&Em(b,Ee,i),i=Xe,ce=Ee;var Je=i.updateQueue;if(Je===null){var tt=new Set;tt.add(ce),i.updateQueue=tt}else Je.add(ce);break e}else{if((i&1)===0){Em(b,Ee,i),Rf();break e}ce=Error(t(426))}}else if(tr&&ne.mode&1){var xr=Sm(N);if(xr!==null){(xr.flags&65536)===0&&(xr.flags|=256),Tm(xr,N,ne,b,i),$0(zo(ce,ne));break e}}b=ce=zo(ce,ne),Tr!==4&&(Tr=2),Xi===null?Xi=[b]:Xi.push(b),b=N;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var ve=_m(b,ce,i);Xh(b,ve);break e;case 1:ne=ce;var pe=b.type,ke=b.stateNode;if((b.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(us===null||!us.has(ke)))){b.flags|=65536,i&=-i,b.lanes|=i;var Ue=bm(b,ne,i);Xh(b,Ue);break e}}b=b.return}while(b!==null)}nx(u)}catch(rt){i=rt,kr===u&&u!==null&&(kr=u=u.return);continue}break}while(!0)}function tx(){var s=Nc.current;return Nc.current=bc,s===null?bc:s}function Rf(){(Tr===0||Tr===3||Tr===2)&&(Tr=4),Pr===null||(Us&268435455)===0&&(Fc&268435455)===0||ps(Pr,zr)}function Ic(s,i){var u=Ot;Ot|=2;var m=tx();(Pr!==s||zr!==i)&&(ja=null,$s(s,i));do try{$k();break}catch(v){ex(s,v)}while(!0);if(V0(),Ot=u,Nc.current=m,kr!==null)throw Error(t(261));return Pr=null,zr=0,Tr}function $k(){for(;kr!==null;)rx(kr)}function Yk(){for(;kr!==null&&!Me();)rx(kr)}function rx(s){var i=ox(s.alternate,s,bn);s.memoizedProps=s.pendingProps,i===null?nx(s):kr=i,Sf.current=null}function nx(s){var i=s;do{var u=i.alternate;if(s=i.return,(i.flags&32768)===0){if(u=jk(u,i,bn),u!==null){kr=u;return}}else{if(u=Lk(u,i),u!==null){u.flags&=32767,kr=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Tr=6,kr=null;return}}if(i=i.sibling,i!==null){kr=i;return}kr=i=s}while(i!==null);Tr===0&&(Tr=5)}function Ys(s,i,u){var m=Ht,v=On.transition;try{On.transition=null,Ht=1,Vk(s,i,u,m)}finally{On.transition=v,Ht=m}return null}function Vk(s,i,u,m){do Ho();while(fs!==null);if((Ot&6)!==0)throw Error(t(327));u=s.finishedWork;var v=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var b=u.lanes|u.childLanes;if(Tw(s,b),s===Pr&&(kr=Pr=null,zr=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Oc||(Oc=!0,ix(hr,function(){return Ho(),null})),b=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||b){b=On.transition,On.transition=null;var N=Ht;Ht=1;var ne=Ot;Ot|=4,Sf.current=null,Bk(s,u),Km(u,s),dk(P0),Kl=!!O0,P0=O0=null,s.current=u,Wk(u),Ie(),Ot=ne,Ht=N,On.transition=b}else s.current=u;if(Oc&&(Oc=!1,fs=s,Pc=v),b=s.pendingLanes,b===0&&(us=null),vi(u.stateNode),gn(s,je()),i!==null)for(m=s.onRecoverableError,u=0;u<i.length;u++)v=i[u],m(v.value,{componentStack:v.stack,digest:v.digest});if(Ac)throw Ac=!1,s=Df,Df=null,s;return(Pc&1)!==0&&s.tag!==0&&Ho(),b=s.pendingLanes,(b&1)!==0?s===Nf?Qi++:(Qi=0,Nf=s):Qi=0,os(),null}function Ho(){if(fs!==null){var s=Yp(Pc),i=On.transition,u=Ht;try{if(On.transition=null,Ht=16>s?16:s,fs===null)var m=!1;else{if(s=fs,fs=null,Pc=0,(Ot&6)!==0)throw Error(t(331));var v=Ot;for(Ot|=4,qe=s.current;qe!==null;){var b=qe,N=b.child;if((qe.flags&16)!==0){var ne=b.deletions;if(ne!==null){for(var ce=0;ce<ne.length;ce++){var Ee=ne[ce];for(qe=Ee;qe!==null;){var Pe=qe;switch(Pe.tag){case 0:case 11:case 15:Ki(8,Pe,b)}var Be=Pe.child;if(Be!==null)Be.return=Pe,qe=Be;else for(;qe!==null;){Pe=qe;var Oe=Pe.sibling,Xe=Pe.return;if(Um(Pe),Pe===Ee){qe=null;break}if(Oe!==null){Oe.return=Xe,qe=Oe;break}qe=Xe}}}var Je=b.alternate;if(Je!==null){var tt=Je.child;if(tt!==null){Je.child=null;do{var xr=tt.sibling;tt.sibling=null,tt=xr}while(tt!==null)}}qe=b}}if((b.subtreeFlags&2064)!==0&&N!==null)N.return=b,qe=N;else e:for(;qe!==null;){if(b=qe,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:Ki(9,b,b.return)}var ve=b.sibling;if(ve!==null){ve.return=b.return,qe=ve;break e}qe=b.return}}var pe=s.current;for(qe=pe;qe!==null;){N=qe;var ke=N.child;if((N.subtreeFlags&2064)!==0&&ke!==null)ke.return=N,qe=ke;else e:for(N=pe;qe!==null;){if(ne=qe,(ne.flags&2048)!==0)try{switch(ne.tag){case 0:case 11:case 15:Dc(9,ne)}}catch(rt){ur(ne,ne.return,rt)}if(ne===N){qe=null;break e}var Ue=ne.sibling;if(Ue!==null){Ue.return=ne.return,qe=Ue;break e}qe=ne.return}}if(Ot=v,os(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(ia,s)}catch{}m=!0}return m}finally{Ht=u,On.transition=i}}return!1}function ax(s,i,u){i=zo(u,i),i=_m(s,i,1),s=ls(s,i,1),i=rn(),s!==null&&(wi(s,1,i),gn(s,i))}function ur(s,i,u){if(s.tag===3)ax(s,s,u);else for(;i!==null;){if(i.tag===3){ax(i,s,u);break}else if(i.tag===1){var m=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(us===null||!us.has(m))){s=zo(u,s),s=bm(i,s,1),i=ls(i,s,1),s=rn(),i!==null&&(wi(i,1,s),gn(i,s));break}}i=i.return}}function Kk(s,i,u){var m=s.pingCache;m!==null&&m.delete(i),i=rn(),s.pingedLanes|=s.suspendedLanes&u,Pr===s&&(zr&u)===u&&(Tr===4||Tr===3&&(zr&130023424)===zr&&500>je()-Cf?$s(s,0):Tf|=u),gn(s,i)}function sx(s,i){i===0&&((s.mode&1)===0?i=1:(i=Hl,Hl<<=1,(Hl&130023424)===0&&(Hl=4194304)));var u=rn();s=Ra(s,i),s!==null&&(wi(s,i,u),gn(s,u))}function Gk(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),sx(s,u)}function Xk(s,i){var u=0;switch(s.tag){case 13:var m=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(i),sx(s,u)}var ox;ox=function(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps||pn.current)mn=!0;else{if((s.lanes&u)===0&&(i.flags&128)===0)return mn=!1,Ik(s,i,u);mn=(s.flags&131072)!==0}else mn=!1,tr&&(i.flags&1048576)!==0&&zh(i,fc,i.index);switch(i.lanes=0,i.tag){case 2:var m=i.type;Tc(s,i),s=i.pendingProps;var v=Ao(i,$r.current);jo(i,u),v=nf(null,i,m,s,v,u);var b=af();return i.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,hn(m)?(b=!0,lc(i)):b=!1,i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Q0(i),v.updater=Ec,i.stateNode=v,v._reactInternals=i,ff(i,m,s,u),i=mf(null,i,m,!0,b,u)):(i.tag=0,tr&&b&&B0(i),tn(null,i,v,u),i=i.child),i;case 16:m=i.elementType;e:{switch(Tc(s,i),s=i.pendingProps,v=m._init,m=v(m._payload),i.type=m,v=i.tag=qk(m),s=Kn(m,s),v){case 0:i=hf(null,i,m,s,u);break e;case 1:i=Om(null,i,m,s,u);break e;case 11:i=Cm(null,i,m,s,u);break e;case 14:i=Dm(null,i,m,Kn(m.type,s),u);break e}throw Error(t(306,m,""))}return i;case 0:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),hf(s,i,m,v,u);case 1:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Om(s,i,m,v,u);case 3:e:{if(Pm(i),s===null)throw Error(t(387));m=i.pendingProps,b=i.memoizedState,v=b.element,Gh(s,i),gc(i,m,null,u);var N=i.memoizedState;if(m=N.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:N.cache,pendingSuspenseBoundaries:N.pendingSuspenseBoundaries,transitions:N.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){v=zo(Error(t(423)),i),i=Rm(s,i,m,u,v);break e}else if(m!==v){v=zo(Error(t(424)),i),i=Rm(s,i,m,u,v);break e}else for(_n=ns(i.stateNode.containerInfo.firstChild),kn=i,tr=!0,Vn=null,u=Vh(i,null,m,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Ro(),m===v){i=Ia(s,i,u);break e}tn(s,i,m,u)}i=i.child}return i;case 5:return qh(i),s===null&&H0(i),m=i.type,v=i.pendingProps,b=s!==null?s.memoizedProps:null,N=v.children,R0(m,v)?N=null:b!==null&&R0(m,b)&&(i.flags|=32),Am(s,i),tn(s,i,N,u),i.child;case 6:return s===null&&H0(i),null;case 13:return Mm(s,i,u);case 4:return q0(i,i.stateNode.containerInfo),m=i.pendingProps,s===null?i.child=Mo(i,null,m,u):tn(s,i,m,u),i.child;case 11:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Cm(s,i,m,v,u);case 7:return tn(s,i,i.pendingProps,u),i.child;case 8:return tn(s,i,i.pendingProps.children,u),i.child;case 12:return tn(s,i,i.pendingProps.children,u),i.child;case 10:e:{if(m=i.type._context,v=i.pendingProps,b=i.memoizedProps,N=v.value,qt(hc,m._currentValue),m._currentValue=N,b!==null)if(Yn(b.value,N)){if(b.children===v.children&&!pn.current){i=Ia(s,i,u);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var ne=b.dependencies;if(ne!==null){N=b.child;for(var ce=ne.firstContext;ce!==null;){if(ce.context===m){if(b.tag===1){ce=Ma(-1,u&-u),ce.tag=2;var Ee=b.updateQueue;if(Ee!==null){Ee=Ee.shared;var Pe=Ee.pending;Pe===null?ce.next=ce:(ce.next=Pe.next,Pe.next=ce),Ee.pending=ce}}b.lanes|=u,ce=b.alternate,ce!==null&&(ce.lanes|=u),G0(b.return,u,i),ne.lanes|=u;break}ce=ce.next}}else if(b.tag===10)N=b.type===i.type?null:b.child;else if(b.tag===18){if(N=b.return,N===null)throw Error(t(341));N.lanes|=u,ne=N.alternate,ne!==null&&(ne.lanes|=u),G0(N,u,i),N=b.sibling}else N=b.child;if(N!==null)N.return=b;else for(N=b;N!==null;){if(N===i){N=null;break}if(b=N.sibling,b!==null){b.return=N.return,N=b;break}N=N.return}b=N}tn(s,i,v.children,u),i=i.child}return i;case 9:return v=i.type,m=i.pendingProps.children,jo(i,u),v=Fn(v),m=m(v),i.flags|=1,tn(s,i,m,u),i.child;case 14:return m=i.type,v=Kn(m,i.pendingProps),v=Kn(m.type,v),Dm(s,i,m,v,u);case 15:return Nm(s,i,i.type,i.pendingProps,u);case 17:return m=i.type,v=i.pendingProps,v=i.elementType===m?v:Kn(m,v),Tc(s,i),i.tag=1,hn(m)?(s=!0,lc(i)):s=!1,jo(i,u),wm(i,m,v),ff(i,m,v,u),mf(null,i,m,!0,s,u);case 19:return jm(s,i,u);case 22:return Fm(s,i,u)}throw Error(t(156,i.tag))};function ix(s,i){return Re(s,i)}function Qk(s,i,u,m){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,i,u,m){return new Qk(s,i,u,m)}function Mf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function qk(s){if(typeof s=="function")return Mf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===B)return 11;if(s===oe)return 14}return 2}function hs(s,i){var u=s.alternate;return u===null?(u=Pn(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function jc(s,i,u,m,v,b){var N=2;if(m=s,typeof s=="function")Mf(s)&&(N=1);else if(typeof s=="string")N=5;else e:switch(s){case C:return Vs(u.children,v,b,i);case Q:N=8,v|=8;break;case M:return s=Pn(12,u,i,v|2),s.elementType=M,s.lanes=b,s;case fe:return s=Pn(13,u,i,v),s.elementType=fe,s.lanes=b,s;case ue:return s=Pn(19,u,i,v),s.elementType=ue,s.lanes=b,s;case V:return Lc(u,v,b,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case te:N=10;break e;case K:N=9;break e;case B:N=11;break e;case oe:N=14;break e;case he:N=16,m=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Pn(N,u,i,v),i.elementType=s,i.type=m,i.lanes=b,i}function Vs(s,i,u,m){return s=Pn(7,s,m,i),s.lanes=u,s}function Lc(s,i,u,m){return s=Pn(22,s,m,i),s.elementType=V,s.lanes=u,s.stateNode={isHidden:!1},s}function If(s,i,u){return s=Pn(6,s,null,i),s.lanes=u,s}function jf(s,i,u){return i=Pn(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function Zk(s,i,u,m,v){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=c0(0),this.expirationTimes=c0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=c0(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function Lf(s,i,u,m,v,b,N,ne,ce){return s=new Zk(s,i,u,ne,ce),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Pn(3,null,null,i),s.current=b,b.stateNode=s,b.memoizedState={element:m,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Q0(b),s}function Jk(s,i,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:m==null?null:""+m,children:s,containerInfo:i,implementation:u}}function lx(s){if(!s)return ss;s=s._reactInternals;e:{if(q(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(hn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(hn(u))return Ih(s,u,i)}return i}function cx(s,i,u,m,v,b,N,ne,ce){return s=Lf(u,m,!0,s,v,b,N,ne,ce),s.context=lx(null),u=s.current,m=rn(),v=ds(u),b=Ma(m,v),b.callback=i??null,ls(u,b,v),s.current.lanes=v,wi(s,v,m),gn(s,m),s}function zc(s,i,u,m){var v=i.current,b=rn(),N=ds(v);return u=lx(u),i.context===null?i.context=u:i.pendingContext=u,i=Ma(b,N),i.payload={element:s},m=m===void 0?null:m,m!==null&&(i.callback=m),s=ls(v,i,N),s!==null&&(Qn(s,v,N,b),xc(s,v,N)),N}function Bc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function ux(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function zf(s,i){ux(s,i),(s=s.alternate)&&ux(s,i)}function e2(){return null}var fx=typeof reportError=="function"?reportError:function(s){console.error(s)};function Bf(s){this._internalRoot=s}Wc.prototype.render=Bf.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));zc(s,i,null,null)},Wc.prototype.unmount=Bf.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Hs(function(){zc(null,s,null,null)}),i[Fa]=null}};function Wc(s){this._internalRoot=s}Wc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Gp();s={blockedOn:null,target:s,priority:i};for(var u=0;u<es.length&&i!==0&&i<es[u].priority;u++);es.splice(u,0,s),u===0&&qp(s)}};function Wf(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Uc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function dx(){}function t2(s,i,u,m,v){if(v){if(typeof m=="function"){var b=m;m=function(){var Ee=Bc(N);b.call(Ee)}}var N=cx(i,m,s,0,null,!1,!1,"",dx);return s._reactRootContainer=N,s[Fa]=N.current,Ri(s.nodeType===8?s.parentNode:s),Hs(),N}for(;v=s.lastChild;)s.removeChild(v);if(typeof m=="function"){var ne=m;m=function(){var Ee=Bc(ce);ne.call(Ee)}}var ce=Lf(s,0,!1,null,null,!1,!1,"",dx);return s._reactRootContainer=ce,s[Fa]=ce.current,Ri(s.nodeType===8?s.parentNode:s),Hs(function(){zc(i,ce,u,m)}),ce}function Hc(s,i,u,m,v){var b=u._reactRootContainer;if(b){var N=b;if(typeof v=="function"){var ne=v;v=function(){var ce=Bc(N);ne.call(ce)}}zc(i,N,s,v)}else N=t2(u,i,s,v,m);return Bc(N)}Vp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var u=yi(i.pendingLanes);u!==0&&(u0(i,u|1),gn(i,je()),(Ot&6)===0&&(Uo=je()+500,os()))}break;case 13:Hs(function(){var m=Ra(s,1);if(m!==null){var v=rn();Qn(m,s,1,v)}}),zf(s,1)}},f0=function(s){if(s.tag===13){var i=Ra(s,134217728);if(i!==null){var u=rn();Qn(i,s,134217728,u)}zf(s,134217728)}},Kp=function(s){if(s.tag===13){var i=ds(s),u=Ra(s,i);if(u!==null){var m=rn();Qn(u,s,i,m)}zf(s,i)}},Gp=function(){return Ht},Xp=function(s,i){var u=Ht;try{return Ht=s,i()}finally{Ht=u}},Se=function(s,i,u){switch(i){case"input":if(de(s,u),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<u.length;i++){var m=u[i];if(m!==s&&m.form===s.form){var v=oc(m);if(!v)throw Error(t(90));L(m),de(m,v)}}}break;case"textarea":Dt(s,u);break;case"select":i=u.value,i!=null&&it(s,!!u.multiple,i,!1)}},Qe=Of,We=Hs;var r2={usingClientEntryPoint:!1,Events:[ji,No,oc,yt,at,Of]},qi={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},n2={bundleType:qi.bundleType,version:qi.version,rendererPackageName:qi.rendererPackageName,rendererConfig:qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=_e(s),s===null?null:s.stateNode},findFiberByHostInstance:qi.findFiberByHostInstance||e2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{ia=$c.inject(n2),Ar=$c}catch{}}return vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r2,vn.createPortal=function(s,i){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wf(i))throw Error(t(200));return Jk(s,i,null,u)},vn.createRoot=function(s,i){if(!Wf(s))throw Error(t(299));var u=!1,m="",v=fx;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=Lf(s,1,!1,null,null,u,!1,m,v),s[Fa]=i.current,Ri(s.nodeType===8?s.parentNode:s),new Bf(i)},vn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=_e(i),s=s===null?null:s.stateNode,s},vn.flushSync=function(s){return Hs(s)},vn.hydrate=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!0,u)},vn.hydrateRoot=function(s,i,u){if(!Wf(s))throw Error(t(405));var m=u!=null&&u.hydratedSources||null,v=!1,b="",N=fx;if(u!=null&&(u.unstable_strictMode===!0&&(v=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onRecoverableError!==void 0&&(N=u.onRecoverableError)),i=cx(i,null,s,1,u??null,v,!1,b,N),s[Fa]=i.current,Ri(s),m)for(s=0;s<m.length;s++)u=m[s],v=u._getVersion,v=v(u._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[u,v]:i.mutableSourceEagerHydrationData.push(u,v);return new Wc(i)},vn.render=function(s,i,u){if(!Uc(i))throw Error(t(200));return Hc(null,s,i,!1,u)},vn.unmountComponentAtNode=function(s){if(!Uc(s))throw Error(t(40));return s._reactRootContainer?(Hs(function(){Hc(null,null,s,!1,function(){s._reactRootContainer=null,s[Fa]=null})}),!0):!1},vn.unstable_batchedUpdates=Of,vn.unstable_renderSubtreeIntoContainer=function(s,i,u,m){if(!Uc(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Hc(s,i,u,!1,m)},vn.version="18.3.1-next-f1338f8080-20240426",vn}var wx;function Qd(){if(wx)return $f.exports;wx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),$f.exports=d2(),$f.exports}var kx;function p2(){if(kx)return Yc;kx=1;var e=Qd();return Yc.createRoot=e.createRoot,Yc.hydrateRoot=e.hydrateRoot,Yc}var h2=p2();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var m2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Sa=(e,n)=>{const t=D.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...h},p)=>D.createElement("svg",{ref:p,...m2,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${x2(e)}`,c].join(" "),...h},[...n.map(([x,g])=>D.createElement(x,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=Sa("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=Sa("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=Sa("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=Sa("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Sa("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=Sa("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=Sa("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=Sa("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Sa("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=Sa("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Vc={exports:{}},xs={},Kf={exports:{}},Gf,_x;function y2(){if(_x)return Gf;_x=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Gf=e,Gf}var Xf,bx;function w2(){if(bx)return Xf;bx=1;var e=y2();function n(){}function t(){}return t.resetWarningCache=n,Xf=function(){function r(l,c,f,h,p,x){if(x!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},Xf}var Ex;function jv(){return Ex||(Ex=1,Kf.exports=w2()()),Kf.exports}var Kc={exports:{}},Rn={},Gc={exports:{}},Sx;function Lv(){return Sx||(Sx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(x,g){return g.getPropertyValue("overflow")!=="visible"||x.scrollWidth<=0&&x.scrollHeight<=0}function l(x){var g=x.offsetWidth<=0&&x.offsetHeight<=0;if(g&&!x.innerHTML)return!0;try{var y=window.getComputedStyle(x),k=y.getPropertyValue("display");return g?k!==r&&o(x,y):k===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(x){for(var g=x,y=x.getRootNode&&x.getRootNode();g&&g!==document.body;){if(y&&g===y&&(g=y.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(x,g){var y=x.nodeName.toLowerCase(),k=a.test(y)&&!x.disabled||y==="a"&&x.href||g;return k&&c(x)}function h(x){var g=x.getAttribute("tabindex");g===null&&(g=void 0);var y=isNaN(g);return(y||g>=0)&&f(x,!y)}function p(x){var g=[].slice.call(x.querySelectorAll("*"),0).reduce(function(y,k){return y.concat(k.shadowRoot?p(k.shadowRoot):[k])},[]);return g.filter(h)}e.exports=n.default})(Gc,Gc.exports)),Gc.exports}var Tx;function k2(){if(Tx)return Rn;Tx=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.resetState=l,Rn.log=c,Rn.handleBlur=f,Rn.handleFocus=h,Rn.markForFocusLater=p,Rn.returnFocus=x,Rn.popWithoutFocus=g,Rn.setupScopedFocus=y,Rn.teardownScopedFocus=k;var e=Lv(),n=t(e);function t(w){return w&&w.__esModule?w:{default:w}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function h(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var w=(0,n.default)(a)[0]||a;w.focus()}},0)}}function p(){r.push(document.activeElement)}function x(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,_=null;try{r.length!==0&&(_=r.pop(),_.focus({preventScroll:w}));return}catch{console.warn(["You tried to return focus to",_,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function y(w){a=w,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",h,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",h))}function k(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",h)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",h))}return Rn}var Xc={exports:{}},Cx;function _2(){return Cx||(Cx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=Lv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var h=(0,r.default)(c);if(!h.length){f.preventDefault();return}var p=void 0,x=f.shiftKey,g=h[0],y=h[h.length-1],k=o();if(c===k){if(!x)return;p=y}if(y===k&&!x&&(p=g),g===k&&x&&(p=y),p){f.preventDefault(),p.focus();return}var w=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),_=w!=null&&w[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(_){var E=h.indexOf(k);if(E>-1&&(E+=x?-1:1),p=h[E],typeof p>"u"){f.preventDefault(),p=x?y:g,p.focus();return}f.preventDefault(),p.focus()}}e.exports=n.default})(Xc,Xc.exports)),Xc.exports}var qn={},Qf,Dx;function b2(){if(Dx)return Qf;Dx=1;var e=function(){};return Qf=e,Qf}var da={},qf={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Nx;function E2(){return Nx||(Nx=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(qf)),qf.exports}var Fx;function tp(){if(Fx)return da;Fx=1,Object.defineProperty(da,"__esModule",{value:!0}),da.canUseDOM=da.SafeNodeList=da.SafeHTMLCollection=void 0;var e=E2(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return da.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},da.SafeNodeList=r.canUseDOM?window.NodeList:{},da.canUseDOM=r.canUseDOM,da.default=a,da}var Ax;function zv(){if(Ax)return qn;Ax=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.resetState=o,qn.log=l,qn.assertNodeList=c,qn.setElement=f,qn.validateElement=h,qn.hide=p,qn.show=x,qn.documentNotReadyOrSSRTesting=g;var e=b2(),n=r(e),t=tp();function r(y){return y&&y.__esModule?y:{default:y}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(y){return y.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(y){return y.removeAttribute("aria-hidden")})),a=null}function l(){}function c(y,k){if(!y||!y.length)throw new Error("react-modal: No elements were found for selector "+k+".")}function f(y){var k=y;if(typeof k=="string"&&t.canUseDOM){var w=document.querySelectorAll(k);c(w,k),k=w}return a=k||a,a}function h(y){var k=y||a;return k?Array.isArray(k)||k instanceof HTMLCollection||k instanceof NodeList?k:[k]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function p(y){var k=!0,w=!1,_=void 0;try{for(var E=h(y)[Symbol.iterator](),A;!(k=(A=E.next()).done);k=!0){var T=A.value;T.setAttribute("aria-hidden","true")}}catch(j){w=!0,_=j}finally{try{!k&&E.return&&E.return()}finally{if(w)throw _}}}function x(y){var k=!0,w=!1,_=void 0;try{for(var E=h(y)[Symbol.iterator](),A;!(k=(A=E.next()).done);k=!0){var T=A.value;T.removeAttribute("aria-hidden")}}catch(j){w=!0,_=j}finally{try{!k&&E.return&&E.return()}finally{if(w)throw _}}}function g(){a=null}return qn}var Ks={},Ox;function S2(){if(Ox)return Ks;Ox=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.resetState=r,Ks.log=a;var e={},n={};function t(h,p){h.classList.remove(p)}function r(){var h=document.getElementsByTagName("html")[0];for(var p in e)t(h,e[p]);var x=document.body;for(var g in n)t(x,n[g]);e={},n={}}function a(){}var o=function(p,x){return p[x]||(p[x]=0),p[x]+=1,x},l=function(p,x){return p[x]&&(p[x]-=1),x},c=function(p,x,g){g.forEach(function(y){o(x,y),p.add(y)})},f=function(p,x,g){g.forEach(function(y){l(x,y),x[y]===0&&p.remove(y)})};return Ks.add=function(p,x){return c(p.classList,p.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks.remove=function(p,x){return f(p.classList,p.nodeName.toLowerCase()=="html"?e:n,x.split(" "))},Ks}var $o={},Px;function Bv(){if(Px)return $o;Px=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.log=r,$o.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return $o.default=t,$o}var Ji={},Rx;function T2(){if(Rx)return Ji;Rx=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.resetState=l,Ji.log=c;var e=Bv(),n=t(e);function t(p){return p&&p.__esModule?p:{default:p}}var r=void 0,a=void 0,o=[];function l(){for(var p=[r,a],x=0;x<p.length;x++){var g=p[x];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var p=[r,a],x=0;x<p.length;x++){var g=p[x],y=g||{};console.log(y.nodeName,y.className,y.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function h(p,x){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=x,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(h),Ji}var Mx;function C2(){return Mx||(Mx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(ue){for(var oe=1;oe<arguments.length;oe++){var he=arguments[oe];for(var V in he)Object.prototype.hasOwnProperty.call(he,V)&&(ue[V]=he[V])}return ue},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ue){return typeof ue}:function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue},a=(function(){function ue(oe,he){for(var V=0;V<he.length;V++){var le=he[V];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(oe,le.key,le)}}return function(oe,he,V){return he&&ue(oe.prototype,he),V&&ue(oe,V),oe}})(),o=Nl(),l=jv(),c=ee(l),f=k2(),h=j(f),p=_2(),x=ee(p),g=zv(),y=j(g),k=S2(),w=j(k),_=tp(),E=ee(_),A=Bv(),T=ee(A);T2();function j(ue){if(ue&&ue.__esModule)return ue;var oe={};if(ue!=null)for(var he in ue)Object.prototype.hasOwnProperty.call(ue,he)&&(oe[he]=ue[he]);return oe.default=ue,oe}function ee(ue){return ue&&ue.__esModule?ue:{default:ue}}function R(ue,oe){if(!(ue instanceof oe))throw new TypeError("Cannot call a class as a function")}function C(ue,oe){if(!ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return oe&&(typeof oe=="object"||typeof oe=="function")?oe:ue}function Q(ue,oe){if(typeof oe!="function"&&oe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof oe);ue.prototype=Object.create(oe&&oe.prototype,{constructor:{value:ue,enumerable:!1,writable:!0,configurable:!0}}),oe&&(Object.setPrototypeOf?Object.setPrototypeOf(ue,oe):ue.__proto__=oe)}var M={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},te=function(oe){return oe.code==="Tab"||oe.keyCode===9},K=function(oe){return oe.code==="Escape"||oe.keyCode===27},B=0,fe=(function(ue){Q(oe,ue);function oe(he){R(this,oe);var V=C(this,(oe.__proto__||Object.getPrototypeOf(oe)).call(this,he));return V.setOverlayRef=function(le){V.overlay=le,V.props.overlayRef&&V.props.overlayRef(le)},V.setContentRef=function(le){V.content=le,V.props.contentRef&&V.props.contentRef(le)},V.afterClose=function(){var le=V.props,J=le.appElement,ae=le.ariaHideApp,W=le.htmlOpenClassName,S=le.bodyOpenClassName,P=le.parentSelector,O=P&&P().ownerDocument||document;S&&w.remove(O.body,S),W&&w.remove(O.getElementsByTagName("html")[0],W),ae&&B>0&&(B-=1,B===0&&y.show(J)),V.props.shouldFocusAfterRender&&(V.props.shouldReturnFocusAfterClose?(h.returnFocus(V.props.preventScroll),h.teardownScopedFocus()):h.popWithoutFocus()),V.props.onAfterClose&&V.props.onAfterClose(),T.default.deregister(V)},V.open=function(){V.beforeOpen(),V.state.afterOpen&&V.state.beforeClose?(clearTimeout(V.closeTimer),V.setState({beforeClose:!1})):(V.props.shouldFocusAfterRender&&(h.setupScopedFocus(V.node),h.markForFocusLater()),V.setState({isOpen:!0},function(){V.openAnimationFrame=requestAnimationFrame(function(){V.setState({afterOpen:!0}),V.props.isOpen&&V.props.onAfterOpen&&V.props.onAfterOpen({overlayEl:V.overlay,contentEl:V.content})})}))},V.close=function(){V.props.closeTimeoutMS>0?V.closeWithTimeout():V.closeWithoutTimeout()},V.focusContent=function(){return V.content&&!V.contentHasFocus()&&V.content.focus({preventScroll:!0})},V.closeWithTimeout=function(){var le=Date.now()+V.props.closeTimeoutMS;V.setState({beforeClose:!0,closesAt:le},function(){V.closeTimer=setTimeout(V.closeWithoutTimeout,V.state.closesAt-Date.now())})},V.closeWithoutTimeout=function(){V.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},V.afterClose)},V.handleKeyDown=function(le){te(le)&&(0,x.default)(V.content,le),V.props.shouldCloseOnEsc&&K(le)&&(le.stopPropagation(),V.requestClose(le))},V.handleOverlayOnClick=function(le){V.shouldClose===null&&(V.shouldClose=!0),V.shouldClose&&V.props.shouldCloseOnOverlayClick&&(V.ownerHandlesClose()?V.requestClose(le):V.focusContent()),V.shouldClose=null},V.handleContentOnMouseUp=function(){V.shouldClose=!1},V.handleOverlayOnMouseDown=function(le){!V.props.shouldCloseOnOverlayClick&&le.target==V.overlay&&le.preventDefault()},V.handleContentOnClick=function(){V.shouldClose=!1},V.handleContentOnMouseDown=function(){V.shouldClose=!1},V.requestClose=function(le){return V.ownerHandlesClose()&&V.props.onRequestClose(le)},V.ownerHandlesClose=function(){return V.props.onRequestClose},V.shouldBeClosed=function(){return!V.state.isOpen&&!V.state.beforeClose},V.contentHasFocus=function(){return document.activeElement===V.content||V.content.contains(document.activeElement)},V.buildClassName=function(le,J){var ae=(typeof J>"u"?"undefined":r(J))==="object"?J:{base:M[le],afterOpen:M[le]+"--after-open",beforeClose:M[le]+"--before-close"},W=ae.base;return V.state.afterOpen&&(W=W+" "+ae.afterOpen),V.state.beforeClose&&(W=W+" "+ae.beforeClose),typeof J=="string"&&J?W+" "+J:W},V.attributesFromObject=function(le,J){return Object.keys(J).reduce(function(ae,W){return ae[le+"-"+W]=J[W],ae},{})},V.state={afterOpen:!1,beforeClose:!1},V.shouldClose=null,V.moveFromContentToOverlay=null,V}return a(oe,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(V,le){this.props.isOpen&&!V.isOpen?this.open():!this.props.isOpen&&V.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!le.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var V=this.props,le=V.appElement,J=V.ariaHideApp,ae=V.htmlOpenClassName,W=V.bodyOpenClassName,S=V.parentSelector,P=S&&S().ownerDocument||document;W&&w.add(P.body,W),ae&&w.add(P.getElementsByTagName("html")[0],ae),J&&(B+=1,y.hide(le)),T.default.register(this)}},{key:"render",value:function(){var V=this.props,le=V.id,J=V.className,ae=V.overlayClassName,W=V.defaultStyles,S=V.children,P=J?{}:W.content,O=ae?{}:W.overlay;if(this.shouldBeClosed())return null;var z={ref:this.setOverlayRef,className:this.buildClassName("overlay",ae),style:t({},O,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},H=t({id:le,ref:this.setContentRef,style:t({},P,this.props.style.content),className:this.buildClassName("content",J),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),re=this.props.contentElement(H,S);return this.props.overlayElement(z,re)}}]),oe})(o.Component);fe.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},fe.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(E.default),c.default.instanceOf(_.SafeHTMLCollection),c.default.instanceOf(_.SafeNodeList),c.default.arrayOf(c.default.instanceOf(E.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=fe,e.exports=n.default})(Kc,Kc.exports)),Kc.exports}function Wv(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function Uv(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function Hv(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}Wv.__suppressDeprecationWarning=!0;Uv.__suppressDeprecationWarning=!0;Hv.__suppressDeprecationWarning=!0;function D2(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=Wv,n.componentWillReceiveProps=Uv),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=Hv;var c=n.componentDidUpdate;n.componentDidUpdate=function(h,p,x){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:x;c.call(this,h,p,g)}}return e}const N2=Object.freeze(Object.defineProperty({__proto__:null,polyfill:D2},Symbol.toStringTag,{value:"Module"})),F2=o2(N2);var Ix;function A2(){if(Ix)return xs;Ix=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.bodyOpenClassName=xs.portalClassName=void 0;var e=Object.assign||function(K){for(var B=1;B<arguments.length;B++){var fe=arguments[B];for(var ue in fe)Object.prototype.hasOwnProperty.call(fe,ue)&&(K[ue]=fe[ue])}return K},n=(function(){function K(B,fe){for(var ue=0;ue<fe.length;ue++){var oe=fe[ue];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(B,oe.key,oe)}}return function(B,fe,ue){return fe&&K(B.prototype,fe),ue&&K(B,ue),B}})(),t=Nl(),r=_(t),a=Qd(),o=_(a),l=jv(),c=_(l),f=C2(),h=_(f),p=zv(),x=w(p),g=tp(),y=_(g),k=F2;function w(K){if(K&&K.__esModule)return K;var B={};if(K!=null)for(var fe in K)Object.prototype.hasOwnProperty.call(K,fe)&&(B[fe]=K[fe]);return B.default=K,B}function _(K){return K&&K.__esModule?K:{default:K}}function E(K,B){if(!(K instanceof B))throw new TypeError("Cannot call a class as a function")}function A(K,B){if(!K)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:K}function T(K,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);K.prototype=Object.create(B&&B.prototype,{constructor:{value:K,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(K,B):K.__proto__=B)}var j=xs.portalClassName="ReactModalPortal",ee=xs.bodyOpenClassName="ReactModal__Body--open",R=g.canUseDOM&&o.default.createPortal!==void 0,C=function(B){return document.createElement(B)},Q=function(){return R?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function M(K){return K()}var te=(function(K){T(B,K);function B(){var fe,ue,oe,he;E(this,B);for(var V=arguments.length,le=Array(V),J=0;J<V;J++)le[J]=arguments[J];return he=(ue=(oe=A(this,(fe=B.__proto__||Object.getPrototypeOf(B)).call.apply(fe,[this].concat(le))),oe),oe.removePortal=function(){!R&&o.default.unmountComponentAtNode(oe.node);var ae=M(oe.props.parentSelector);ae&&ae.contains(oe.node)?ae.removeChild(oe.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},oe.portalRef=function(ae){oe.portal=ae},oe.renderPortal=function(ae){var W=Q(),S=W(oe,r.default.createElement(h.default,e({defaultStyles:B.defaultStyles},ae)),oe.node);oe.portalRef(S)},ue),A(oe,he)}return n(B,[{key:"componentDidMount",value:function(){if(g.canUseDOM){R||(this.node=C("div")),this.node.className=this.props.portalClassName;var ue=M(this.props.parentSelector);ue.appendChild(this.node),!R&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(ue){var oe=M(ue.parentSelector),he=M(this.props.parentSelector);return{prevParent:oe,nextParent:he}}},{key:"componentDidUpdate",value:function(ue,oe,he){if(g.canUseDOM){var V=this.props,le=V.isOpen,J=V.portalClassName;ue.portalClassName!==J&&(this.node.className=J);var ae=he.prevParent,W=he.nextParent;W!==ae&&(ae.removeChild(this.node),W.appendChild(this.node)),!(!ue.isOpen&&!le)&&!R&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var ue=this.portal.state,oe=Date.now(),he=ue.isOpen&&this.props.closeTimeoutMS&&(ue.closesAt||oe+this.props.closeTimeoutMS);he?(ue.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,he-oe)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!R)return null;!this.node&&R&&(this.node=C("div"));var ue=Q();return ue(r.default.createElement(h.default,e({ref:this.portalRef,defaultStyles:B.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(ue){x.setElement(ue)}}]),B})(t.Component);return te.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(y.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(y.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},te.defaultProps={isOpen:!1,portalClassName:j,bodyOpenClassName:ee,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(B,fe){return r.default.createElement("div",B,fe)},contentElement:function(B,fe){return r.default.createElement("div",B,fe)}},te.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,k.polyfill)(te),xs.default=te,xs}var jx;function O2(){return jx||(jx=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=A2(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Vc,Vc.exports)),Vc.exports}var P2=O2();const Fr=Ku(P2);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $v=1252,R2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},np=function(e){R2.indexOf(e)!=-1&&($v=rp[0]=e)};function M2(){np(1252)}var ta=function(e){np(e)};function Yv(){ta(1200),M2()}function Lx(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function I2(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Vv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var rl=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?I2(e.slice(2)):n==254&&t==255?Vv(e.slice(2)):n==65279?e.slice(1):e},Qc=function(n){return String.fromCharCode(n)},zx=function(n){return String.fromCharCode(n)},vl,ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Bx(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,r=e.charCodeAt(h++),l=(t&3)<<4|r>>4,a=e.charCodeAt(h++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=ks.charAt(o)+ks.charAt(l)+ks.charAt(c)+ks.charAt(f);return n}function Cn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=ks.indexOf(e.charAt(h++)),l=ks.indexOf(e.charAt(h++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=ks.indexOf(e.charAt(h++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=ks.indexOf(e.charAt(h++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var Ct=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ho=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function Cs(e){return Ct?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Wx(e){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ea=function(n){return Ct?ho(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function mo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function ap(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ap(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var ys=Ct?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ho(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function j2(e){for(var n=[],t=0,r=e.length+250,a=Cs(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=Cs(65535),r=65530)}return n.push(a.slice(0,t)),ys(n)}var fn=/\u0000/g,nl=/[\u0001-\u0006]/g;function qo(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function ra(e,n){var t=""+e;return t.length>=n?t:fr("0",n-t.length)+t}function sp(e,n){var t=""+e;return t.length>=n?t:fr(" ",n-t.length)+t}function ku(e,n){var t=""+e;return t.length>=n?t:t+fr(" ",n-t.length)}function L2(e,n){var t=""+Math.round(e);return t.length>=n?t:fr("0",n-t.length)+t}function z2(e,n){var t=""+e;return t.length>=n?t:fr("0",n-t.length)+t}var Ux=Math.pow(2,32);function Yo(e,n){if(e>Ux||e<-Ux)return L2(e,n);var t=Math.round(e);return z2(t,n)}function _u(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Hx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Zf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function B2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},$x={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},W2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bu(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,h=0,p=0,x=Math.floor(a);h<n&&(x=Math.floor(a),c=x*l+o,p=x*h+f,!(a-x<5e-8));)a=1/(a-x),o=l,l=c,f=h,h=p;if(p>n&&(h>n?(p=f,c=o):(p=h,c=l)),!t)return[0,r*c,p];var g=Math.floor(r*c/p);return[g,r*c-g*p,p]}function Qs(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=K2(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var Kv=new Date(1899,11,31,0,0,0),U2=Kv.getTime(),H2=new Date(1900,2,1,0,0,0);function Gv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=H2&&(t+=1440*60*1e3),(t-(U2+(e.getTimezoneOffset()-Kv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function op(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Y2(e){var n=e<0?12:11,t=op(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function V2(e){var n=op(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function yl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=Y2(e):n===10?t=e.toFixed(10).substr(0,12):t=V2(e),op($2(t.toUpperCase()))}function oo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,Gv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function K2(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function G2(e,n,t,r){var a="",o=0,l=0,c=t.y,f,h=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,h=n.length;break;case 3:return Zf[t.m-1][1];case 5:return Zf[t.m-1][0];default:return Zf[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,h=n.length;break;case 3:return Hx[t.q][0];default:return Hx[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?ra(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=ra(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:f=c,h=1;break}var p=h>0?ra(f,h):"";return p}function _s(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Xv=/%/g;function X2(e,n,t){var r=n.replace(Xv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+fr("%",a)}function Q2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Qv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Qv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var qv=/# (\?+)( ?)\/( ?)(\d+)/;function q2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?fr(" ",e[1].length+1+e[4].length):sp(l,e[1].length)+e[2]+"/"+e[3]+ra(c,e[4].length))}function Z2(e,n,t){return t+(n===0?"":""+n)+fr(" ",e[1].length+2+e[4].length)}var Zv=/^#*0*\.([0#]+)/,Jv=/\).*[0#]/,e1=/\(###\) ###\\?-####/;function nn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Yx(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Vx(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function J2(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function e_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function jn(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Jv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?jn("n",r,t):"("+jn("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return Q2(e,n,t);if(n.indexOf("%")!==-1)return X2(e,n,t);if(n.indexOf("E")!==-1)return Qv(n,t);if(n.charCodeAt(0)===36)return"$"+jn(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+Yo(f,n.length);if(n.match(/^[#?]+$/))return a=Yo(t,0),a==="0"&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(qv))return q2(o,f,h);if(n.match(/^#+0+$/))return h+Yo(f,n.length-n.indexOf("0"));if(o=n.match(Zv))return a=Yx(t,o[1].length).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+fr("0",nn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+Yx(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+_s(Yo(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+jn(e,n,-t):_s(""+(Math.floor(t)+J2(t,o[1].length)))+"."+ra(Vx(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return jn(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(jn(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(e1))return a=jn(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=bu(f,Math.pow(10,l)-1,!1),a=""+h,p=Ba("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=ku(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=bu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+ku(c[2],l):fr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=Yo(t,0),n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return nn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Vx(t,o[1].length),t<0?"-"+jn(e,n,-t):_s(e_(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(l,o[1].length);switch(n){case"###,##0.00":return jn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=_s(Yo(f,0));return y!=="0"?h+y:"";case"###,###.00":return jn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return jn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function t_(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Ba(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function r_(e,n,t){var r=n.replace(Xv,""),a=n.length-r.length;return Ba(e,r,t*Math.pow(10,2*a))+fr("%",a)}function t1(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+t1(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ha(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Jv)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ha("n",r,t):"("+ha("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return t_(e,n,t);if(n.indexOf("%")!==-1)return r_(e,n,t);if(n.indexOf("E")!==-1)return t1(n,t);if(n.charCodeAt(0)===36)return"$"+ha(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+ra(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(qv))return Z2(o,f,h);if(n.match(/^#+0+$/))return h+ra(f,n.length-n.indexOf("0"));if(o=n.match(Zv))return a=(""+t).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])),a=a.replace(/\.(\d*)$/,function(k,w){return"."+w+fr("0",nn(o[1]).length-w.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+_s(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ha(e,n,-t):_s(""+t)+"."+fr("0",o[1].length);if(o=n.match(/^#,#*,#0/))return ha(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(ha(e,n.replace(/[\\-]/g,""),t)),l=0,qo(qo(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return l<a.length?a.charAt(l++):k==="0"?"0":""}));if(n.match(e1))return a=ha(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=bu(f,Math.pow(10,l)-1,!1),a=""+h,p=Ba("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=ku(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=bu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+o[2]+"/"+o[3]+ku(c[2],l):fr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=n.indexOf(".")-l,g=n.length-a.length-x;return nn(n.substr(0,x)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ha(e,n,-t):_s(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ra(0,3-k.length):"")+k})+"."+ra(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var y=_s(""+f);return y!=="0"?h+y:"";default:if(n.match(/\.[0#?]*$/))return ha(e,n.slice(0,n.lastIndexOf(".")),t)+nn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Ba(e,n,t){return(t|0)===t?ha(e,n,t):jn(e,n,t)}function n_(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var r1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function di(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":_u(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="上午/下午")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(r1))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function a_(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",h,p,x,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!_u(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(x=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(x);a[a.length]={t:"t",v:o},++l;break;case"\\":var y=e.charAt(++l),k=y==="("||y===")"?y:"t";a[a.length]={t:k,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=Qs(n,t,e.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=Qs(n,t),h==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"上":var w={t:c,v:c};if(h==null&&(h=Qs(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?"P":"A"),w.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(h!=null&&(w.v=h.H>=12?"下午":"上午"),w.t="T",l+=5,g="h"):(w.t="t",++l),h==null&&w.t==="T")return"";a[a.length]=w,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(r1)){if(h==null&&(h=Qs(n,t),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",di(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var _=0,E=0,A;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",_<1&&(_=1);break;case"s":(A=a[l].v.match(/\.0+$/))&&(E=Math.max(E,A[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var T="",j;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=G2(a[l].t.charCodeAt(0),a[l].v,h,E),a[l].t="t";break;case"n":case"?":for(j=l+1;a[j]!=null&&((c=a[j].t)==="?"||c==="D"||(c===" "||c==="t")&&a[j+1]!=null&&(a[j+1].t==="?"||a[j+1].t==="t"&&a[j+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[j].v==="/"||a[j].v===" "&&a[j+1]!=null&&a[j+1].t=="?"));)a[l].v+=a[j].v,a[j]={v:"",t:";"},++j;T+=a[l].v,l=j-1;break;case"G":a[l].t="t",a[l].v=oo(n,t);break}var ee="",R,C;if(T.length>0){T.charCodeAt(0)==40?(R=n<0&&T.charCodeAt(0)===45?-n:n,C=Ba("n",T,R)):(R=n<0&&r>1?-n:n,C=Ba("n",T,R),R<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),j=C.length-1;var Q=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){Q=l;break}var M=a.length;if(Q===a.length&&C.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(j>=a[l].v.length-1?(j-=a[l].v.length,a[l].v=C.substr(j+1,a[l].v.length)):j<0?a[l].v="":(a[l].v=C.substr(0,j+1),j=-1),a[l].t="t",M=l);j>=0&&M<a.length&&(a[M].v=C.substr(0,j+1)+a[M].v)}else if(Q!==a.length&&C.indexOf("E")===-1){for(j=C.indexOf(".")-1,l=Q;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===Q?a[l].v.indexOf(".")-1:a[l].v.length-1,ee=a[l].v.substr(p+1);p>=0;--p)j>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(ee=C.charAt(j--)+ee);a[l].v=ee,a[l].t="t",M=l}for(j>=0&&M<a.length&&(a[M].v=C.substr(0,j+1)+a[M].v),j=C.indexOf(".")+1,l=Q;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==Q)){for(p=a[l].v.indexOf(".")>-1&&l===Q?a[l].v.indexOf(".")+1:0,ee=a[l].v.substr(0,p);p<a[l].v.length;++p)j<C.length&&(ee+=C.charAt(j++));a[l].v=ee,a[l].t="t",M=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(R=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=Ba(a[l].t,a[l].v,R),a[l].t="t");var te="";for(l=0;l!==a.length;++l)a[l]!=null&&(te+=a[l].v);return te}var Kx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gx(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function s_(e,n){var t=n_(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Kx),c=t[1].match(Kx);return Gx(n,l)?[r,t[0]]:Gx(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Un(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:kt)[e],r==null&&(r=t.table&&t.table[$x[e]]||kt[$x[e]]),r==null&&(r=W2[e]||"General");break}if(_u(r,0))return oo(n,t);n instanceof Date&&(n=Gv(n,t.date1904));var a=s_(r,n);if(_u(a[1]))return oo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return a_(a[1],n,t,a[0])}function eo(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(kt[t]==null){n<0&&(n=t);continue}if(kt[t]==e){n=t;break}}n<0&&(n=391)}return kt[n]=e,n}function n1(){kt=B2()}var o_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},a1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function i_(e){var n=typeof e=="number"?kt[e]:e;return n=n.replace(a1,"(\\d+)"),new RegExp("^"+n+"$")}function l_(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(a1)||[]).forEach(function(x,g){var y=parseInt(t[g+1],10);switch(x.toLowerCase().charAt(0)){case"y":r=y;break;case"d":o=y;break;case"h":l=y;break;case"s":f=y;break;case"m":l>=0?c=y:a=y;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?h:r==-1&&a==-1&&o==-1?p:h+"T"+p}var c_=(function(){var e={};e.version="1.2.0";function n(){for(var C=0,Q=new Array(256),M=0;M!=256;++M)C=M,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,Q[M]=C;return typeof Int32Array<"u"?new Int32Array(Q):Q}var t=n();function r(C){var Q=0,M=0,te=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)K[te]=C[te];for(te=0;te!=256;++te)for(M=C[te],Q=256+te;Q<4096;Q+=256)M=K[Q]=M>>>8^C[M&255];var B=[];for(te=1;te!=16;++te)B[te-1]=typeof Int32Array<"u"?K.subarray(te*256,te*256+256):K.slice(te*256,te*256+256);return B}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],h=a[4],p=a[5],x=a[6],g=a[7],y=a[8],k=a[9],w=a[10],_=a[11],E=a[12],A=a[13],T=a[14];function j(C,Q){for(var M=Q^-1,te=0,K=C.length;te<K;)M=M>>>8^t[(M^C.charCodeAt(te++))&255];return~M}function ee(C,Q){for(var M=Q^-1,te=C.length-15,K=0;K<te;)M=T[C[K++]^M&255]^A[C[K++]^M>>8&255]^E[C[K++]^M>>16&255]^_[C[K++]^M>>>24]^w[C[K++]]^k[C[K++]]^y[C[K++]]^g[C[K++]]^x[C[K++]]^p[C[K++]]^h[C[K++]]^f[C[K++]]^c[C[K++]]^l[C[K++]]^o[C[K++]]^t[C[K++]];for(te+=15;K<te;)M=M>>>8^t[(M^C[K++])&255];return~M}function R(C,Q){for(var M=Q^-1,te=0,K=C.length,B=0,fe=0;te<K;)B=C.charCodeAt(te++),B<128?M=M>>>8^t[(M^B)&255]:B<2048?(M=M>>>8^t[(M^(192|B>>6&31))&255],M=M>>>8^t[(M^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,fe=C.charCodeAt(te++)&1023,M=M>>>8^t[(M^(240|B>>8&7))&255],M=M>>>8^t[(M^(128|B>>2&63))&255],M=M>>>8^t[(M^(128|fe>>6&15|(B&3)<<4))&255],M=M>>>8^t[(M^(128|fe&63))&255]):(M=M>>>8^t[(M^(224|B>>12&15))&255],M=M>>>8^t[(M^(128|B>>6&63))&255],M=M>>>8^t[(M^(128|B&63))&255]);return~M}return e.table=t,e.bstr=j,e.buf=ee,e.str=R,e})(),Ft=(function(){var n={};n.version="1.2.1";function t(F,G){for(var I=F.split("/"),U=G.split("/"),Y=0,q=0,we=Math.min(I.length,U.length);Y<we;++Y){if(q=I[Y].length-U[Y].length)return q;if(I[Y]!=U[Y])return I[Y]<U[Y]?-1:1}return I.length-U.length}function r(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:r(F.slice(0,-1));var G=F.lastIndexOf("/");return G===-1?F:F.slice(0,G+1)}function a(F){if(F.charAt(F.length-1)=="/")return a(F.slice(0,-1));var G=F.lastIndexOf("/");return G===-1?F:F.slice(G+1)}function o(F,G){typeof G=="string"&&(G=new Date(G));var I=G.getHours();I=I<<6|G.getMinutes(),I=I<<5|G.getSeconds()>>>1,F.write_shift(2,I);var U=G.getFullYear()-1980;U=U<<4|G.getMonth()+1,U=U<<5|G.getDate(),F.write_shift(2,U)}function l(F){var G=F.read_shift(2)&65535,I=F.read_shift(2)&65535,U=new Date,Y=I&31;I>>>=5;var q=I&15;I>>>=4,U.setMilliseconds(0),U.setFullYear(I+1980),U.setMonth(q-1),U.setDate(Y);var we=G&31;G>>>=5;var Fe=G&63;return G>>>=6,U.setHours(G),U.setMinutes(Fe),U.setSeconds(we<<1),U}function c(F){Br(F,0);for(var G={},I=0;F.l<=F.length-4;){var U=F.read_shift(2),Y=F.read_shift(2),q=F.l+Y,we={};switch(U){case 21589:I=F.read_shift(1),I&1&&(we.mtime=F.read_shift(4)),Y>5&&(I&2&&(we.atime=F.read_shift(4)),I&4&&(we.ctime=F.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}F.l=q,G[U]=we}return G}var f;function h(){return f||(f={})}function p(F,G){if(F[0]==80&&F[1]==75)return Se(F,G);if((F[0]|32)==109&&(F[1]|32)==105)return wt(F,G);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var I=3,U=512,Y=0,q=0,we=0,Fe=0,ye=0,_e=[],be=F.slice(0,512);Br(be,0);var Re=x(be);switch(I=Re[0],I){case 3:U=512;break;case 4:U=4096;break;case 0:if(Re[1]==0)return Se(F,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}U!==512&&(be=F.slice(0,U),Br(be,28));var $e=F.slice(0,U);g(be,I);var Me=be.read_shift(4,"i");if(I===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);be.l+=4,we=be.read_shift(4,"i"),be.l+=4,be.chk("00100000","Mini Stream Cutoff Size: "),Fe=be.read_shift(4,"i"),Y=be.read_shift(4,"i"),ye=be.read_shift(4,"i"),q=be.read_shift(4,"i");for(var Ie=-1,je=0;je<109&&(Ie=be.read_shift(4,"i"),!(Ie<0));++je)_e[je]=Ie;var ft=y(F,U);_(ye,q,ft,U,_e);var Ut=A(ft,we,_e,U);Ut[we].name="!Directory",Y>0&&Fe!==fe&&(Ut[Fe].name="!MiniFAT"),Ut[_e[0]].name="!FAT",Ut.fat_addrs=_e,Ut.ssz=U;var Bt={},hr=[],Rs=[],Qa=[];T(we,Ut,ft,hr,Y,Bt,Rs,Fe),k(Rs,Qa,hr),hr.shift();var ia={FileIndex:Rs,FullPaths:Qa};return G&&G.raw&&(ia.raw={header:$e,sectors:ft}),ia}function x(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(ue,"Header Signature: "),F.l+=16;var G=F.read_shift(2,"u");return[F.read_shift(2,"u"),G]}function g(F,G){var I=9;switch(F.l+=2,I=F.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function y(F,G){for(var I=Math.ceil(F.length/G)-1,U=[],Y=1;Y<I;++Y)U[Y-1]=F.slice(Y*G,(Y+1)*G);return U[I-1]=F.slice(I*G),U}function k(F,G,I){for(var U=0,Y=0,q=0,we=0,Fe=0,ye=I.length,_e=[],be=[];U<ye;++U)_e[U]=be[U]=U,G[U]=I[U];for(;Fe<be.length;++Fe)U=be[Fe],Y=F[U].L,q=F[U].R,we=F[U].C,_e[U]===U&&(Y!==-1&&_e[Y]!==Y&&(_e[U]=_e[Y]),q!==-1&&_e[q]!==q&&(_e[U]=_e[q])),we!==-1&&(_e[we]=U),Y!==-1&&U!=_e[U]&&(_e[Y]=_e[U],be.lastIndexOf(Y)<Fe&&be.push(Y)),q!==-1&&U!=_e[U]&&(_e[q]=_e[U],be.lastIndexOf(q)<Fe&&be.push(q));for(U=1;U<ye;++U)_e[U]===U&&(q!==-1&&_e[q]!==q?_e[U]=_e[q]:Y!==-1&&_e[Y]!==Y&&(_e[U]=_e[Y]));for(U=1;U<ye;++U)if(F[U].type!==0){if(Fe=U,Fe!=_e[Fe])do Fe=_e[Fe],G[U]=G[Fe]+"/"+G[U];while(Fe!==0&&_e[Fe]!==-1&&Fe!=_e[Fe]);_e[U]=-1}for(G[0]+="/",U=1;U<ye;++U)F[U].type!==2&&(G[U]+="/")}function w(F,G,I){for(var U=F.start,Y=F.size,q=[],we=U;I&&Y>0&&we>=0;)q.push(G.slice(we*B,we*B+B)),Y-=B,we=Xs(I,we*4);return q.length===0?Cr(0):ys(q).slice(0,F.size)}function _(F,G,I,U,Y){var q=fe;if(F===fe){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var we=I[F],Fe=(U>>>2)-1;if(!we)return;for(var ye=0;ye<Fe&&(q=Xs(we,ye*4))!==fe;++ye)Y.push(q);_(Xs(we,U-4),G-1,I,U,Y)}}function E(F,G,I,U,Y){var q=[],we=[];Y||(Y=[]);var Fe=U-1,ye=0,_e=0;for(ye=G;ye>=0;){Y[ye]=!0,q[q.length]=ye,we.push(F[ye]);var be=I[Math.floor(ye*4/U)];if(_e=ye*4&Fe,U<4+_e)throw new Error("FAT boundary crossed: "+ye+" 4 "+U);if(!F[be])break;ye=Xs(F[be],_e)}return{nodes:q,data:ag([we])}}function A(F,G,I,U){var Y=F.length,q=[],we=[],Fe=[],ye=[],_e=U-1,be=0,Re=0,$e=0,Me=0;for(be=0;be<Y;++be)if(Fe=[],$e=be+G,$e>=Y&&($e-=Y),!we[$e]){ye=[];var Ie=[];for(Re=$e;Re>=0;){Ie[Re]=!0,we[Re]=!0,Fe[Fe.length]=Re,ye.push(F[Re]);var je=I[Math.floor(Re*4/U)];if(Me=Re*4&_e,U<4+Me)throw new Error("FAT boundary crossed: "+Re+" 4 "+U);if(!F[je]||(Re=Xs(F[je],Me),Ie[Re]))break}q[$e]={nodes:Fe,data:ag([ye])}}return q}function T(F,G,I,U,Y,q,we,Fe){for(var ye=0,_e=U.length?2:0,be=G[F].data,Re=0,$e=0,Me;Re<be.length;Re+=128){var Ie=be.slice(Re,Re+128);Br(Ie,64),$e=Ie.read_shift(2),Me=fp(Ie,0,$e-_e),U.push(Me);var je={name:Me,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},ft=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);ft!==0&&(je.ct=j(Ie,Ie.l-8));var Ut=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Ut!==0&&(je.mt=j(Ie,Ie.l-8)),je.start=Ie.read_shift(4,"i"),je.size=Ie.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=fe,je.name=""),je.type===5?(ye=je.start,Y>0&&ye!==fe&&(G[ye].name="!StreamData")):je.size>=4096?(je.storage="fat",G[je.start]===void 0&&(G[je.start]=E(I,je.start,G.fat_addrs,G.ssz)),G[je.start].name=je.name,je.content=G[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:ye!==fe&&je.start!==fe&&G[ye]&&(je.content=w(je,G[ye].data,(G[Fe]||{}).data))),je.content&&Br(je.content,0),q[Me]=je,we.push(je)}}function j(F,G){return new Date((En(F,G+4)/1e7*Math.pow(2,32)+En(F,G)/1e7-11644473600)*1e3)}function ee(F,G){return h(),p(f.readFileSync(F),G)}function R(F,G){var I=G&&G.type;switch(I||Ct&&Buffer.isBuffer(F)&&(I="buffer"),I||"base64"){case"file":return ee(F,G);case"base64":return p(ea(Cn(F)),G);case"binary":return p(ea(F),G)}return p(F,G)}function C(F,G){var I=G||{},U=I.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=U+"/",F.FileIndex[0]={name:U,type:5}),I.CLSID&&(F.FileIndex[0].clsid=I.CLSID),Q(F)}function Q(F){var G="Sh33tJ5";if(!Ft.find(F,"/"+G)){var I=Cr(4);I[0]=55,I[1]=I[3]=50,I[2]=54,F.FileIndex.push({name:G,type:2,content:I,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+G),M(F)}}function M(F,G){C(F);for(var I=!1,U=!1,Y=F.FullPaths.length-1;Y>=0;--Y){var q=F.FileIndex[Y];switch(q.type){case 0:U?I=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(q.R*q.L*q.C)&&(I=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!G)){var we=new Date(1987,1,19),Fe=0,ye=Object.create?Object.create(null):{},_e=[];for(Y=0;Y<F.FullPaths.length;++Y)ye[F.FullPaths[Y]]=!0,F.FileIndex[Y].type!==0&&_e.push([F.FullPaths[Y],F.FileIndex[Y]]);for(Y=0;Y<_e.length;++Y){var be=r(_e[Y][0]);U=ye[be],U||(_e.push([be,{name:a(be).replace("/",""),type:1,clsid:he,ct:we,mt:we,content:null}]),ye[be]=!0)}for(_e.sort(function(Me,Ie){return t(Me[0],Ie[0])}),F.FullPaths=[],F.FileIndex=[],Y=0;Y<_e.length;++Y)F.FullPaths[Y]=_e[Y][0],F.FileIndex[Y]=_e[Y][1];for(Y=0;Y<_e.length;++Y){var Re=F.FileIndex[Y],$e=F.FullPaths[Y];if(Re.name=a($e).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||he,Y===0)Re.C=_e.length>1?1:-1,Re.size=0,Re.type=5;else if($e.slice(-1)=="/"){for(Fe=Y+1;Fe<_e.length&&r(F.FullPaths[Fe])!=$e;++Fe);for(Re.C=Fe>=_e.length?-1:Fe,Fe=Y+1;Fe<_e.length&&r(F.FullPaths[Fe])!=r($e);++Fe);Re.R=Fe>=_e.length?-1:Fe,Re.type=1}else r(F.FullPaths[Y+1]||"")==r($e)&&(Re.R=Y+1),Re.type=2}}}function te(F,G){var I=G||{};if(I.fileType=="mad")return wr(F,I);switch(M(F),I.fileType){case"zip":return He(F,I)}var U=(function(Me){for(var Ie=0,je=0,ft=0;ft<Me.FileIndex.length;++ft){var Ut=Me.FileIndex[ft];if(Ut.content){var Bt=Ut.content.length;Bt>0&&(Bt<4096?Ie+=Bt+63>>6:je+=Bt+511>>9)}}for(var hr=Me.FullPaths.length+3>>2,Rs=Ie+7>>3,Qa=Ie+127>>7,ia=Rs+je+hr+Qa,Ar=ia+127>>7,vi=Ar<=109?0:Math.ceil((Ar-109)/127);ia+Ar+vi+127>>7>Ar;)vi=++Ar<=109?0:Math.ceil((Ar-109)/127);var mr=[1,vi,Ar,Qa,hr,je,Ie,0];return Me.FileIndex[0].size=Ie<<6,mr[7]=(Me.FileIndex[0].start=mr[0]+mr[1]+mr[2]+mr[3]+mr[4]+mr[5])+(mr[6]+7>>3),mr})(F),Y=Cr(U[7]<<9),q=0,we=0;{for(q=0;q<8;++q)Y.write_shift(1,oe[q]);for(q=0;q<8;++q)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),q=0;q<3;++q)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,U[2]),Y.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:fe),Y.write_shift(4,U[3]),Y.write_shift(-4,U[1]?U[0]-1:fe),Y.write_shift(4,U[1]),q=0;q<109;++q)Y.write_shift(-4,q<U[2]?U[1]+q:-1)}if(U[1])for(we=0;we<U[1];++we){for(;q<236+we*127;++q)Y.write_shift(-4,q<U[2]?U[1]+q:-1);Y.write_shift(-4,we===U[1]-1?fe:we+1)}var Fe=function(Me){for(we+=Me;q<we-1;++q)Y.write_shift(-4,q+1);Me&&(++q,Y.write_shift(-4,fe))};for(we=q=0,we+=U[1];q<we;++q)Y.write_shift(-4,V.DIFSECT);for(we+=U[2];q<we;++q)Y.write_shift(-4,V.FATSECT);Fe(U[3]),Fe(U[4]);for(var ye=0,_e=0,be=F.FileIndex[0];ye<F.FileIndex.length;++ye)be=F.FileIndex[ye],be.content&&(_e=be.content.length,!(_e<4096)&&(be.start=we,Fe(_e+511>>9)));for(Fe(U[6]+7>>3);Y.l&511;)Y.write_shift(-4,V.ENDOFCHAIN);for(we=q=0,ye=0;ye<F.FileIndex.length;++ye)be=F.FileIndex[ye],be.content&&(_e=be.content.length,!(!_e||_e>=4096)&&(be.start=we,Fe(_e+63>>6)));for(;Y.l&511;)Y.write_shift(-4,V.ENDOFCHAIN);for(q=0;q<U[4]<<2;++q){var Re=F.FullPaths[q];if(!Re||Re.length===0){for(ye=0;ye<17;++ye)Y.write_shift(4,0);for(ye=0;ye<3;++ye)Y.write_shift(4,-1);for(ye=0;ye<12;++ye)Y.write_shift(4,0);continue}be=F.FileIndex[q],q===0&&(be.start=be.size?be.start-1:fe);var $e=q===0&&I.root||be.name;if(_e=2*($e.length+1),Y.write_shift(64,$e,"utf16le"),Y.write_shift(2,_e),Y.write_shift(1,be.type),Y.write_shift(1,be.color),Y.write_shift(-4,be.L),Y.write_shift(-4,be.R),Y.write_shift(-4,be.C),be.clsid)Y.write_shift(16,be.clsid,"hex");else for(ye=0;ye<4;++ye)Y.write_shift(4,0);Y.write_shift(4,be.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,be.start),Y.write_shift(4,be.size),Y.write_shift(4,0)}for(q=1;q<F.FileIndex.length;++q)if(be=F.FileIndex[q],be.size>=4096)if(Y.l=be.start+1<<9,Ct&&Buffer.isBuffer(be.content))be.content.copy(Y,Y.l,0,be.size),Y.l+=be.size+511&-512;else{for(ye=0;ye<be.size;++ye)Y.write_shift(1,be.content[ye]);for(;ye&511;++ye)Y.write_shift(1,0)}for(q=1;q<F.FileIndex.length;++q)if(be=F.FileIndex[q],be.size>0&&be.size<4096)if(Ct&&Buffer.isBuffer(be.content))be.content.copy(Y,Y.l,0,be.size),Y.l+=be.size+63&-64;else{for(ye=0;ye<be.size;++ye)Y.write_shift(1,be.content[ye]);for(;ye&63;++ye)Y.write_shift(1,0)}if(Ct)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function K(F,G){var I=F.FullPaths.map(function(ye){return ye.toUpperCase()}),U=I.map(function(ye){var _e=ye.split("/");return _e[_e.length-(ye.slice(-1)=="/"?2:1)]}),Y=!1;G.charCodeAt(0)===47?(Y=!0,G=I[0].slice(0,-1)+G):Y=G.indexOf("/")!==-1;var q=G.toUpperCase(),we=Y===!0?I.indexOf(q):U.indexOf(q);if(we!==-1)return F.FileIndex[we];var Fe=!q.match(nl);for(q=q.replace(fn,""),Fe&&(q=q.replace(nl,"!")),we=0;we<I.length;++we)if((Fe?I[we].replace(nl,"!"):I[we]).replace(fn,"")==q||(Fe?U[we].replace(nl,"!"):U[we]).replace(fn,"")==q)return F.FileIndex[we];return null}var B=64,fe=-2,ue="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:fe,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(F,G,I){h();var U=te(F,I);f.writeFileSync(G,U)}function J(F){for(var G=new Array(F.length),I=0;I<F.length;++I)G[I]=String.fromCharCode(F[I]);return G.join("")}function ae(F,G){var I=te(F,G);switch(G&&G.type||"buffer"){case"file":return h(),f.writeFileSync(G.filename,I),I;case"binary":return typeof I=="string"?I:J(I);case"base64":return Bx(typeof I=="string"?I:J(I));case"buffer":if(Ct)return Buffer.isBuffer(I)?I:ho(I);case"array":return typeof I=="string"?ea(I):I}return I}var W;function S(F){try{var G=F.InflateRaw,I=new G;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)W=F;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function P(F,G){if(!W)return X(F,G);var I=W.InflateRaw,U=new I,Y=U._processChunk(F.slice(F.l),U._finishFlushFlag);return F.l+=U.bytesRead,Y}function O(F){return W?W.deflateRawSync(F):ot(F)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(F){var G=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(G>>16|G>>8|G)&255}for(var Z=typeof Uint8Array<"u",ge=Z?new Uint8Array(256):[],xe=0;xe<256;++xe)ge[xe]=ie(xe);function L(F,G){var I=ge[F&255];return G<=8?I>>>8-G:(I=I<<8|ge[F>>8&255],G<=16?I>>>16-G:(I=I<<8|ge[F>>16&255],I>>>24-G))}function Ve(F,G){var I=G&7,U=G>>>3;return(F[U]|(I<=6?0:F[U+1]<<8))>>>I&3}function Te(F,G){var I=G&7,U=G>>>3;return(F[U]|(I<=5?0:F[U+1]<<8))>>>I&7}function st(F,G){var I=G&7,U=G>>>3;return(F[U]|(I<=4?0:F[U+1]<<8))>>>I&15}function Ge(F,G){var I=G&7,U=G>>>3;return(F[U]|(I<=3?0:F[U+1]<<8))>>>I&31}function de(F,G){var I=G&7,U=G>>>3;return(F[U]|(I<=1?0:F[U+1]<<8))>>>I&127}function De(F,G,I){var U=G&7,Y=G>>>3,q=(1<<I)-1,we=F[Y]>>>U;return I<8-U||(we|=F[Y+1]<<8-U,I<16-U)||(we|=F[Y+2]<<16-U,I<24-U)||(we|=F[Y+3]<<24-U),we&q}function Le(F,G,I){var U=G&7,Y=G>>>3;return U<=5?F[Y]|=(I&7)<<U:(F[Y]|=I<<U&255,F[Y+1]=(I&7)>>8-U),G+3}function Ae(F,G,I){var U=G&7,Y=G>>>3;return I=(I&1)<<U,F[Y]|=I,G+1}function it(F,G,I){var U=G&7,Y=G>>>3;return I<<=U,F[Y]|=I&255,I>>>=8,F[Y+1]=I,G+8}function gt(F,G,I){var U=G&7,Y=G>>>3;return I<<=U,F[Y]|=I&255,I>>>=8,F[Y+1]=I&255,F[Y+2]=I>>>8,G+16}function ht(F,G){var I=F.length,U=2*I>G?2*I:G+5,Y=0;if(I>=G)return F;if(Ct){var q=Wx(U);if(F.copy)F.copy(q);else for(;Y<F.length;++Y)q[Y]=F[Y];return q}else if(Z){var we=new Uint8Array(U);if(we.set)we.set(F);else for(;Y<I;++Y)we[Y]=F[Y];return we}return F.length=U,F}function Dt(F){for(var G=new Array(F),I=0;I<F;++I)G[I]=0;return G}function Nt(F,G,I){var U=1,Y=0,q=0,we=0,Fe=0,ye=F.length,_e=Z?new Uint16Array(32):Dt(32);for(q=0;q<32;++q)_e[q]=0;for(q=ye;q<I;++q)F[q]=0;ye=F.length;var be=Z?new Uint16Array(ye):Dt(ye);for(q=0;q<ye;++q)_e[Y=F[q]]++,U<Y&&(U=Y),be[q]=0;for(_e[0]=0,q=1;q<=U;++q)_e[q+16]=Fe=Fe+_e[q-1]<<1;for(q=0;q<ye;++q)Fe=F[q],Fe!=0&&(be[q]=_e[Fe+16]++);var Re=0;for(q=0;q<ye;++q)if(Re=F[q],Re!=0)for(Fe=L(be[q],U)>>U-Re,we=(1<<U+4-Re)-1;we>=0;--we)G[Fe|we<<Re]=Re&15|q<<4;return U}var Kt=Z?new Uint16Array(512):Dt(512),cr=Z?new Uint16Array(32):Dt(32);if(!Z){for(var Lt=0;Lt<512;++Lt)Kt[Lt]=0;for(Lt=0;Lt<32;++Lt)cr[Lt]=0}(function(){for(var F=[],G=0;G<32;G++)F.push(5);Nt(F,cr,32);var I=[];for(G=0;G<=143;G++)I.push(8);for(;G<=255;G++)I.push(9);for(;G<=279;G++)I.push(7);for(;G<=287;G++)I.push(8);Nt(I,Kt,288)})();var Xt=(function(){for(var G=Z?new Uint8Array(32768):[],I=0,U=0;I<re.length-1;++I)for(;U<re[I+1];++U)G[U]=I;for(;U<32768;++U)G[U]=29;var Y=Z?new Uint8Array(259):[];for(I=0,U=0;I<H.length-1;++I)for(;U<H[I+1];++U)Y[U]=I;function q(Fe,ye){for(var _e=0;_e<Fe.length;){var be=Math.min(65535,Fe.length-_e),Re=_e+be==Fe.length;for(ye.write_shift(1,+Re),ye.write_shift(2,be),ye.write_shift(2,~be&65535);be-- >0;)ye[ye.l++]=Fe[_e++]}return ye.l}function we(Fe,ye){for(var _e=0,be=0,Re=Z?new Uint16Array(32768):[];be<Fe.length;){var $e=Math.min(65535,Fe.length-be);if($e<10){for(_e=Le(ye,_e,+(be+$e==Fe.length)),_e&7&&(_e+=8-(_e&7)),ye.l=_e/8|0,ye.write_shift(2,$e),ye.write_shift(2,~$e&65535);$e-- >0;)ye[ye.l++]=Fe[be++];_e=ye.l*8;continue}_e=Le(ye,_e,+(be+$e==Fe.length)+2);for(var Me=0;$e-- >0;){var Ie=Fe[be];Me=(Me<<5^Ie)&32767;var je=-1,ft=0;if((je=Re[Me])&&(je|=be&-32768,je>be&&(je-=32768),je<be))for(;Fe[je+ft]==Fe[be+ft]&&ft<250;)++ft;if(ft>2){Ie=Y[ft],Ie<=22?_e=it(ye,_e,ge[Ie+1]>>1)-1:(it(ye,_e,3),_e+=5,it(ye,_e,ge[Ie-23]>>5),_e+=3);var Ut=Ie<8?0:Ie-4>>2;Ut>0&&(gt(ye,_e,ft-H[Ie]),_e+=Ut),Ie=G[be-je],_e=it(ye,_e,ge[Ie]>>3),_e-=3;var Bt=Ie<4?0:Ie-2>>1;Bt>0&&(gt(ye,_e,be-je-re[Ie]),_e+=Bt);for(var hr=0;hr<ft;++hr)Re[Me]=be&32767,Me=(Me<<5^Fe[be])&32767,++be;$e-=ft-1}else Ie<=143?Ie=Ie+48:_e=Ae(ye,_e,1),_e=it(ye,_e,ge[Ie]),Re[Me]=be&32767,++be}_e=it(ye,_e,0)-1}return ye.l=(_e+7)/8|0,ye.l}return function(ye,_e){return ye.length<8?q(ye,_e):we(ye,_e)}})();function ot(F){var G=Cr(50+Math.floor(F.length*1.1)),I=Xt(F,G);return G.slice(0,I)}var St=Z?new Uint16Array(32768):Dt(32768),Qt=Z?new Uint16Array(32768):Dt(32768),Et=Z?new Uint16Array(128):Dt(128),zt=1,Tt=1;function se(F,G){var I=Ge(F,G)+257;G+=5;var U=Ge(F,G)+1;G+=5;var Y=st(F,G)+4;G+=4;for(var q=0,we=Z?new Uint8Array(19):Dt(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,_e=Z?new Uint8Array(8):Dt(8),be=Z?new Uint8Array(8):Dt(8),Re=we.length,$e=0;$e<Y;++$e)we[z[$e]]=q=Te(F,G),ye<q&&(ye=q),_e[q]++,G+=3;var Me=0;for(_e[0]=0,$e=1;$e<=ye;++$e)be[$e]=Me=Me+_e[$e-1]<<1;for($e=0;$e<Re;++$e)(Me=we[$e])!=0&&(Fe[$e]=be[Me]++);var Ie=0;for($e=0;$e<Re;++$e)if(Ie=we[$e],Ie!=0){Me=ge[Fe[$e]]>>8-Ie;for(var je=(1<<7-Ie)-1;je>=0;--je)Et[Me|je<<Ie]=Ie&7|$e<<3}var ft=[];for(ye=1;ft.length<I+U;)switch(Me=Et[de(F,G)],G+=Me&7,Me>>>=3){case 16:for(q=3+Ve(F,G),G+=2,Me=ft[ft.length-1];q-- >0;)ft.push(Me);break;case 17:for(q=3+Te(F,G),G+=3;q-- >0;)ft.push(0);break;case 18:for(q=11+de(F,G),G+=7;q-- >0;)ft.push(0);break;default:ft.push(Me),ye<Me&&(ye=Me);break}var Ut=ft.slice(0,I),Bt=ft.slice(I);for($e=I;$e<286;++$e)Ut[$e]=0;for($e=U;$e<30;++$e)Bt[$e]=0;return zt=Nt(Ut,St,286),Tt=Nt(Bt,Qt,30),G}function Ne(F,G){if(F[0]==3&&!(F[1]&3))return[Cs(G),2];for(var I=0,U=0,Y=Wx(G||1<<18),q=0,we=Y.length>>>0,Fe=0,ye=0;(U&1)==0;){if(U=Te(F,I),I+=3,U>>>1)U>>1==1?(Fe=9,ye=5):(I=se(F,I),Fe=zt,ye=Tt);else{I&7&&(I+=8-(I&7));var _e=F[I>>>3]|F[(I>>>3)+1]<<8;if(I+=32,_e>0)for(!G&&we<q+_e&&(Y=ht(Y,q+_e),we=Y.length);_e-- >0;)Y[q++]=F[I>>>3],I+=8;continue}for(;;){!G&&we<q+32767&&(Y=ht(Y,q+32767),we=Y.length);var be=De(F,I,Fe),Re=U>>>1==1?Kt[be]:St[be];if(I+=Re&15,Re>>>=4,(Re>>>8&255)===0)Y[q++]=Re;else{if(Re==256)break;Re-=257;var $e=Re<8?0:Re-4>>2;$e>5&&($e=0);var Me=q+H[Re];$e>0&&(Me+=De(F,I,$e),I+=$e),be=De(F,I,ye),Re=U>>>1==1?cr[be]:Qt[be],I+=Re&15,Re>>>=4;var Ie=Re<4?0:Re-2>>1,je=re[Re];for(Ie>0&&(je+=De(F,I,Ie),I+=Ie),!G&&we<Me&&(Y=ht(Y,Me+100),we=Y.length);q<Me;)Y[q]=Y[q-je],++q}}}return G?[Y,I+7>>>3]:[Y.slice(0,q),I+7>>>3]}function X(F,G){var I=F.slice(F.l||0),U=Ne(I,G);return F.l+=U[1],U[0]}function me(F,G){if(F)typeof console<"u"&&console.error(G);else throw new Error(G)}function Se(F,G){var I=F;Br(I,0);var U=[],Y=[],q={FileIndex:U,FullPaths:Y};C(q,{root:G.root});for(var we=I.length-4;(I[we]!=80||I[we+1]!=75||I[we+2]!=5||I[we+3]!=6)&&we>=0;)--we;I.l=we+4,I.l+=4;var Fe=I.read_shift(2);I.l+=6;var ye=I.read_shift(4);for(I.l=ye,we=0;we<Fe;++we){I.l+=20;var _e=I.read_shift(4),be=I.read_shift(4),Re=I.read_shift(2),$e=I.read_shift(2),Me=I.read_shift(2);I.l+=8;var Ie=I.read_shift(4),je=c(I.slice(I.l+Re,I.l+Re+$e));I.l+=Re+$e+Me;var ft=I.l;I.l=Ie+4,ze(I,_e,be,q,je),I.l=ft}return q}function ze(F,G,I,U,Y){F.l+=2;var q=F.read_shift(2),we=F.read_shift(2),Fe=l(F);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var ye=F.read_shift(4),_e=F.read_shift(4),be=F.read_shift(4),Re=F.read_shift(2),$e=F.read_shift(2),Me="",Ie=0;Ie<Re;++Ie)Me+=String.fromCharCode(F[F.l++]);if($e){var je=c(F.slice(F.l,F.l+$e));(je[21589]||{}).mt&&(Fe=je[21589].mt),((Y||{})[21589]||{}).mt&&(Fe=Y[21589].mt)}F.l+=$e;var ft=F.slice(F.l,F.l+_e);switch(we){case 8:ft=P(F,be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var Ut=!1;q&8&&(ye=F.read_shift(4),ye==134695760&&(ye=F.read_shift(4),Ut=!0),_e=F.read_shift(4),be=F.read_shift(4)),_e!=G&&me(Ut,"Bad compressed size: "+G+" != "+_e),be!=I&&me(Ut,"Bad uncompressed size: "+I+" != "+be),et(U,Me,ft,{unsafe:!0,mt:Fe})}function He(F,G){var I=G||{},U=[],Y=[],q=Cr(1),we=I.compression?8:0,Fe=0,ye=0,_e=0,be=0,Re=0,$e=F.FullPaths[0],Me=$e,Ie=F.FileIndex[0],je=[],ft=0;for(ye=1;ye<F.FullPaths.length;++ye)if(Me=F.FullPaths[ye].slice($e.length),Ie=F.FileIndex[ye],!(!Ie.size||!Ie.content||Me=="Sh33tJ5")){var Ut=be,Bt=Cr(Me.length);for(_e=0;_e<Me.length;++_e)Bt.write_shift(1,Me.charCodeAt(_e)&127);Bt=Bt.slice(0,Bt.l),je[Re]=c_.buf(Ie.content,0);var hr=Ie.content;we==8&&(hr=O(hr)),q=Cr(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,Fe),q.write_shift(2,we),Ie.mt?o(q,Ie.mt):q.write_shift(4,0),q.write_shift(-4,je[Re]),q.write_shift(4,hr.length),q.write_shift(4,Ie.content.length),q.write_shift(2,Bt.length),q.write_shift(2,0),be+=q.length,U.push(q),be+=Bt.length,U.push(Bt),be+=hr.length,U.push(hr),q=Cr(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,Fe),q.write_shift(2,we),q.write_shift(4,0),q.write_shift(-4,je[Re]),q.write_shift(4,hr.length),q.write_shift(4,Ie.content.length),q.write_shift(2,Bt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,Ut),ft+=q.l,Y.push(q),ft+=Bt.length,Y.push(Bt),++Re}return q=Cr(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Re),q.write_shift(2,Re),q.write_shift(4,ft),q.write_shift(4,be),q.write_shift(2,0),ys([ys(U),ys(Y),q])}var Ze={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function yt(F,G){if(F.ctype)return F.ctype;var I=F.name||"",U=I.match(/\.([^\.]+)$/);return U&&Ze[U[1]]||G&&(U=(I=G).match(/[\.\\]([^\.\\])+$/),U&&Ze[U[1]])?Ze[U[1]]:"application/octet-stream"}function at(F){for(var G=Bx(F),I=[],U=0;U<G.length;U+=76)I.push(G.slice(U,U+76));return I.join(`\r
`)+`\r
`}function Qe(F){var G=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(_e){var be=_e.charCodeAt(0).toString(16).toUpperCase();return"="+(be.length==1?"0"+be:be)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],U=G.split(`\r
`),Y=0;Y<U.length;++Y){var q=U[Y];if(q.length==0){I.push("");continue}for(var we=0;we<q.length;){var Fe=76,ye=q.slice(we,we+Fe);ye.charAt(Fe-1)=="="?Fe--:ye.charAt(Fe-2)=="="?Fe-=2:ye.charAt(Fe-3)=="="&&(Fe-=3),ye=q.slice(we,we+Fe),we+=Fe,we<q.length&&(ye+="="),I.push(ye)}}return I.join(`\r
`)}function We(F){for(var G=[],I=0;I<F.length;++I){for(var U=F[I];I<=F.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+F[++I];G.push(U)}for(var Y=0;Y<G.length;++Y)G[Y]=G[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return ea(G.join(`\r
`))}function dt(F,G,I){for(var U="",Y="",q="",we,Fe=0;Fe<10;++Fe){var ye=G[Fe];if(!ye||ye.match(/^\s*$/))break;var _e=ye.match(/^(.*?):\s*([^\s].*)$/);if(_e)switch(_e[1].toLowerCase()){case"content-location":U=_e[2].trim();break;case"content-type":q=_e[2].trim();break;case"content-transfer-encoding":Y=_e[2].trim();break}}switch(++Fe,Y.toLowerCase()){case"base64":we=ea(Cn(G.slice(Fe).join("")));break;case"quoted-printable":we=We(G.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var be=et(F,U.slice(I.length),we,{unsafe:!0});q&&(be.ctype=q)}function wt(F,G){if(J(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=G&&G.root||"",U=(Ct&&Buffer.isBuffer(F)?F.toString("binary"):J(F)).split(`\r
`),Y=0,q="";for(Y=0;Y<U.length;++Y)if(q=U[Y],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),I||(I=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),q.slice(0,I.length)!=I););var we=(U[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var Fe="--"+(we[1]||""),ye=[],_e=[],be={FileIndex:ye,FullPaths:_e};C(be);var Re,$e=0;for(Y=0;Y<U.length;++Y){var Me=U[Y];Me!==Fe&&Me!==Fe+"--"||($e++&&dt(be,U.slice(Re,Y),I),Re=Y)}return be}function wr(F,G){var I=G||{},U=I.boundary||"SheetJS";U="------="+U;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],q=F.FullPaths[0],we=q,Fe=F.FileIndex[0],ye=1;ye<F.FullPaths.length;++ye)if(we=F.FullPaths[ye].slice(q.length),Fe=F.FileIndex[ye],!(!Fe.size||!Fe.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ft){return"_x"+ft.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ft){return"_u"+ft.charCodeAt(0).toString(16)+"_"});for(var _e=Fe.content,be=Ct&&Buffer.isBuffer(_e)?_e.toString("binary"):J(_e),Re=0,$e=Math.min(1024,be.length),Me=0,Ie=0;Ie<=$e;++Ie)(Me=be.charCodeAt(Ie))>=32&&Me<128&&++Re;var je=Re>=$e*4/5;Y.push(U),Y.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+we),Y.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),Y.push("Content-Type: "+yt(Fe,we)),Y.push(""),Y.push(je?Qe(be):at(be))}return Y.push(U+`--\r
`),Y.join(`\r
`)}function Ye(F){var G={};return C(G,F),G}function et(F,G,I,U){var Y=U&&U.unsafe;Y||C(F);var q=!Y&&Ft.find(F,G);if(!q){var we=F.FullPaths[0];G.slice(0,we.length)==we?we=G:(we.slice(-1)!="/"&&(we+="/"),we=(we+G).replace("//","/")),q={name:a(G),type:2},F.FileIndex.push(q),F.FullPaths.push(we),Y||Ft.utils.cfb_gc(F)}return q.content=I,q.size=I?I.length:0,U&&(U.CLSID&&(q.clsid=U.CLSID),U.mt&&(q.mt=U.mt),U.ct&&(q.ct=U.ct)),q}function pt(F,G){C(F);var I=Ft.find(F,G);if(I){for(var U=0;U<F.FileIndex.length;++U)if(F.FileIndex[U]==I)return F.FileIndex.splice(U,1),F.FullPaths.splice(U,1),!0}return!1}function Gt(F,G,I){C(F);var U=Ft.find(F,G);if(U){for(var Y=0;Y<F.FileIndex.length;++Y)if(F.FileIndex[Y]==U)return F.FileIndex[Y].name=a(I),F.FullPaths[Y]=I,!0}return!1}function sr(F){M(F,!0)}return n.find=K,n.read=R,n.parse=p,n.write=ae,n.writeFile=le,n.utils={cfb_new:Ye,cfb_add:et,cfb_del:pt,cfb_mov:Gt,cfb_gc:sr,ReadShift:ll,CheckField:T1,prep_blob:Br,bconcat:ys,use_zlib:S,_deflateRaw:ot,_inflateRaw:X,consts:V},n})();function u_(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function ba(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function ip(e){for(var n=[],t=ba(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var Eu=new Date(1899,11,30,0,0,0);function dn(e,n){var t=e.getTime(),r=Eu.getTime()+(e.getTimezoneOffset()-Eu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var s1=new Date,f_=Eu.getTime()+(s1.getTimezoneOffset()-Eu.getTimezoneOffset())*6e4,Xx=s1.getTimezoneOffset();function Xu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+f_),n.getTimezoneOffset()!==Xx&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Xx)*6e4),n}function d_(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var Qx=new Date("2017-02-19T19:06:09.000Z"),o1=isNaN(Qx.getFullYear())?new Date("2/19/17"):Qx,p_=o1.getFullYear()==2017;function Ir(e,n){var t=new Date(e);if(p_)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(o1.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function io(e,n){if(Ct&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return sl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return sl(Vv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return sl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return sl(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=Ur(e[t]));return n}function fr(e,n){for(var t="";t.length<n;)t+=e;return t}function na(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var h_=["january","february","march","april","may","june","july","august","september","october","november","december"];function ai(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&h_.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var m_=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function i1(e){return e?e.content&&e.type?io(e.content,!0):e.data?rl(e.data):e.asNodeBuffer&&Ct?rl(e.asNodeBuffer().toString("binary")):e.asBinary?rl(e.asBinary()):e._data&&e._data.getContent?rl(io(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function l1(e){if(!e)return null;if(e.data)return Lx(e.data);if(e.asNodeBuffer&&Ct)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Lx(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function x_(e){return e&&e.name.slice(-4)===".bin"?l1(e):i1(e)}function Ln(e,n){for(var t=e.FullPaths||ba(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function lp(e,n){var t=Ln(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function br(e,n,t){if(!t)return x_(lp(e,n));if(!n)return null;try{return br(e,n)}catch{return null}}function Sn(e,n,t){if(!t)return i1(lp(e,n));if(!n)return null;try{return Sn(e,n)}catch{return null}}function g_(e,n,t){return l1(lp(e,n))}function qx(e){for(var n=e.FullPaths||ba(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function v_(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return Ct?r=ho(t):r=j2(t),Ft.utils.cfb_add(e,n,r)}Ft.utils.cfb_add(e,n,t)}else e.file(n,t)}function c1(e,n){switch(n.type){case"base64":return Ft.read(e,{type:"base64"});case"binary":return Ft.read(e,{type:"binary"});case"buffer":case"array":return Ft.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function al(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var u1=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,y_=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Zx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,w_=/<[^>]*>/g,en=u1.match(Zx)?Zx:w_,k_=/<\w*:/,__=/<(\/?)\w+:/;function mt(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(y_),c=0,f="",h=0,p="",x="",g=1;if(l)for(h=0;h!=l.length;++h){for(x=l[h],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(p=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(g=(a=x.charCodeAt(o+1))==34||a==39?1:0,f=x.slice(o+1+g,x.length-g),c=0;c!=p.length&&p.charCodeAt(c)!==58;++c);if(c===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=f,r[p.toLowerCase()]=f;else{var y=(c===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(c+1);if(r[y]&&p.slice(c-3,c)=="ext")continue;r[y]=f,r[y.toLowerCase()]=f}}return r}function Ta(e){return e.replace(__,"<$1")}var f1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},b_=ip(f1),Mt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return f1[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),E_=/[&<>'"]/g,S_=/[\u0000-\u001f]/g;function cp(e){var n=e+"";return n.replace(E_,function(t){return b_[t]}).replace(/\n/g,"<br/>").replace(S_,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Jx=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function nr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jf(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function eg(e){var n=Cs(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function tg(e){return ho(e,"binary").toString("utf8")}var qc="foo bar bazâð£",Zt=Ct&&(tg(qc)==Jf(qc)&&tg||eg(qc)==Jf(qc)&&eg)||Jf,sl=Ct?function(e){return ho(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},wl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),d1=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),T_=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),C_=/<\/?(?:vt:)?variant>/g,D_=/<(?:vt:)([^>]*)>([\s\S]*)</;function rg(e,n){var t=mt(e),r=e.match(T_(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(C_,"").match(D_);l&&a.push({v:Zt(l[2]),t:l[1]})}),a}var N_=/(^\s|\s$|\n)/;function F_(e){return ba(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function A_(e,n,t){return"<"+e+(t!=null?F_(t):"")+(n!=null?(n.match(N_)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function up(e){if(Ct&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Zt(mo(ap(e)));throw new Error("Bad input format: expected Buffer or string")}var kl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,O_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},P_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function R_(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function M_(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var ng=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},ag=Ct?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ho(n)})):ng(e)}:ng,sg=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(za(e,a)));return r.join("").replace(fn,"")},fp=Ct?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(fn,""):sg(e,n,t)}:sg,og=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},p1=Ct?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):og(e,n,t)}:og,ig=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Go(e,a)));return r.join("")},Fl=Ct?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):ig(n,t,r)}:ig,h1=function(e,n){var t=En(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},m1=h1,x1=function(e,n){var t=En(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},g1=x1,v1=function(e,n){var t=2*En(e,n);return t>0?Fl(e,n+4,n+4+t-1):""},y1=v1,w1=function(n,t){var r=En(n,t);return r>0?fp(n,t+4,t+4+r):""},k1=w1,_1=function(e,n){var t=En(e,n);return t>0?Fl(e,n+4,n+4+t):""},b1=_1,E1=function(e,n){return R_(e,n)},Su=E1,S1=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Ct&&(m1=function(n,t){if(!Buffer.isBuffer(n))return h1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},g1=function(n,t){if(!Buffer.isBuffer(n))return x1(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},y1=function(n,t){if(!Buffer.isBuffer(n))return v1(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},k1=function(n,t){if(!Buffer.isBuffer(n))return w1(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},b1=function(n,t){if(!Buffer.isBuffer(n))return _1(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Su=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):E1(n,t)},S1=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Go=function(e,n){return e[n]},za=function(e,n){return e[n+1]*256+e[n]},I_=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},En=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Xs=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},j_=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ll(e,n){var t="",r,a,o=[],l,c,f,h;switch(n){case"dbcs":if(h=this.l,Ct&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(za(this,h)),h+=2;e*=2;break;case"utf8":t=Fl(this,this.l,this.l+e);break;case"utf16le":e*=2,t=fp(this,this.l,this.l+e);break;case"wstr":return ll.call(this,e,"dbcs");case"lpstr-ansi":t=m1(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":t=g1(this,this.l),e=4+En(this,this.l);break;case"lpwstr":t=y1(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),t=k1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),t=b1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Go(this,this.l+e++))!==0;)o.push(Qc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=za(this,this.l+e))!==0;)o.push(Qc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Go(this,h),this.l=h+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(za(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Go(this,h),this.l=h+1,c=ll.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Qc(Go(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return r=Go(this,this.l),this.l++,r;case 2:return r=(n==="i"?I_:za)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Xs:j_)(this,this.l),this.l+=4,r):(a=En(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Su(this,this.l):a=Su([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=p1(this,this.l,e);break}}return this.l+=e,t}var L_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},z_=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},B_=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function W_(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)B_(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,L_(this,n,this.l);break;case 8:if(r=8,t==="f"){M_(this,n,this.l);break}case 16:break;case-4:r=4,z_(this,n,this.l);break}return this.l+=r,this}function T1(e,n){var t=p1(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Br(e,n){e.l=n,e.read_shift=ll,e.chk=T1,e.write_shift=W_}function Jr(e,n){e.l+=n}function Cr(e){var n=Cs(e);return Br(n,0),n}function Xa(e,n,t){if(e){var r,a,o;Br(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var h=Au[c]||Au[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var p=h.f&&h.f(e,o,t);if(e.l=f,n(p,h,c))return}}}function Sd(){var e=[],n=Ct?256:2048,t=function(h){var p=Cr(h);return Br(p,0),p},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=t(Math.max(h+1,n)))},l=function(){return a(),ys(e)},c=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function cl(e,n,t){var r=Ur(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function lg(e,n,t){var r=Ur(e);return r.s=cl(r.s,n.s,t),r.e=cl(r.e,n.s,t),r}function ul(e,n){if(e.cRel&&e.c<0)for(e=Ur(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Ur(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=vt(e);return!e.cRel&&e.cRel!=null&&(t=$_(t)),!e.rRel&&e.rRel!=null&&(t=U_(t)),t}function ed(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dr(e.s.c)+":"+(e.e.cRel?"":"$")+Dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Hr(e.s.r)+":"+(e.e.rRel?"":"$")+Hr(e.e.r):ul(e.s,n.biff)+":"+ul(e.e,n.biff)}function dp(e){return parseInt(H_(e),10)-1}function Hr(e){return""+(e+1)}function U_(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function H_(e){return e.replace(/\$(\d+)$/,"$1")}function pp(e){for(var n=Y_(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Dr(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function $_(e){return e.replace(/^([A-Z])/,"$$$1")}function Y_(e){return e.replace(/^\$([A-Z])/,"$1")}function V_(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function vt(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function pi(e){var n=e.indexOf(":");return n==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,n)),e:ln(e.slice(n+1))}}function At(e,n){return typeof n>"u"||typeof n=="number"?At(e.s,e.e):(typeof e!="string"&&(e=vt(e)),typeof n!="string"&&(n=vt(n)),e==n?e:e+":"+n)}function dr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function cg(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,t?dn(n):n)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(t?14:0),t?dn(n):n)}catch{return""+n}}function Ka(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?vo[e.v]||e.v:n==null?cg(e,e.v):cg(e,n))}function Os(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function C1(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=dr(o["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),l==-1&&(h.e.r=l=p.e.r+1)}for(var x=0;x!=n.length;++x)if(n[x]){if(!Array.isArray(n[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[x].length;++g)if(!(typeof n[x][g]>"u")){var y={v:n[x][g]},k=l+x,w=c+g;if(h.s.r>k&&(h.s.r=k),h.s.c>w&&(h.s.c=w),h.e.r<k&&(h.e.r=k),h.e.c<w&&(h.e.c=w),n[x][g]&&typeof n[x][g]=="object"&&!Array.isArray(n[x][g])&&!(n[x][g]instanceof Date))y=n[x][g];else if(Array.isArray(y.v)&&(y.f=n[x][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(r.nullError)y.t="e",y.v=0;else if(r.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=r.dateNF||kt[14],r.cellDates?(y.t="d",y.w=Un(y.z,dn(y.v))):(y.t="n",y.v=dn(y.v),y.w=Un(y.z,y.v))):y.t="s";if(a)o[k]||(o[k]=[]),o[k][w]&&o[k][w].z&&(y.z=o[k][w].z),o[k][w]=y;else{var _=vt({c:w,r:k});o[_]&&o[_].z&&(y.z=o[_].z),o[_]=y}}}return h.s.c<1e7&&(o["!ref"]=At(h)),o}function hi(e,n){return C1(null,e,n)}function K_(e){return e.read_shift(4,"i")}function Zr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function G_(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hp(e,n){var t=e.l,r=e.read_shift(1),a=Zr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(G_(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var X_=hp;function $n(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function xo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var Q_=Zr;function mp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var q_=Zr,Td=mp;function xp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Su([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Xs(n,0)>>2;return t?a/100:a}function D1(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var go=D1;function Qr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Z_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var h=to[a];h&&(n.rgb=bl(h));break;case 2:n.rgb=bl([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function J_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function N1(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function eb(e){return N1(e,1)}function tb(e){return N1(e,2)}var gp=2,yn=3,Zc=11,ug=12,Tu=19,Jc=64,rb=65,nb=71,ab=4108,sb=4126,Mr=80,F1=81,ob=[Mr,F1],ib={1:{n:"CodePage",t:gp},2:{n:"Category",t:Mr},3:{n:"PresentationFormat",t:Mr},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:Zc},12:{n:"HeadingPairs",t:ab},13:{n:"TitlesOfParts",t:sb},14:{n:"Manager",t:Mr},15:{n:"Company",t:Mr},16:{n:"LinksUpToDate",t:Zc},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:Zc},22:{n:"HyperlinksChanged",t:Zc},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:rb},26:{n:"ContentType",t:Mr},27:{n:"ContentStatus",t:Mr},28:{n:"Language",t:Mr},29:{n:"Version",t:Mr},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},lb={1:{n:"CodePage",t:gp},2:{n:"Title",t:Mr},3:{n:"Subject",t:Mr},4:{n:"Author",t:Mr},5:{n:"Keywords",t:Mr},6:{n:"Comments",t:Mr},7:{n:"Template",t:Mr},8:{n:"LastAuthor",t:Mr},9:{n:"RevNumber",t:Mr},10:{n:"EditTime",t:Jc},11:{n:"LastPrinted",t:Jc},12:{n:"CreatedDate",t:Jc},13:{n:"ModifiedDate",t:Jc},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:nb},18:{n:"Application",t:Mr},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:Tu},2147483651:{n:"Behavior",t:Tu},1919054434:{}},fg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ub(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var fb=ub([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),to=Ur(fb),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},A1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},dg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function db(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pb(e){var n=db();if(!e||!e.match)return n;var t={};if((e.match(en)||[]).forEach(function(r){var a=mt(r);switch(a[0].replace(k_,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[dg[a.ContentType]]!==void 0&&n[dg[a.ContentType]].push(a.PartName);break}}),n.xmlns!==O_.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var Qo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cd(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function fl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(en)||[]).forEach(function(a){var o=mt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:al(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var hb="application/vnd.oasis.opendocument.spreadsheet";function mb(e,n){for(var t=up(e),r,a;r=kl.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=mt(r[0],!1),a.path=="/"&&a.type!==hb)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var dl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xb=(function(){for(var e=new Array(dl.length),n=0;n<dl.length;++n){var t=dl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function O1(e){var n={};e=Zt(e);for(var t=0;t<dl.length;++t){var r=dl[t],a=e.match(xb[t]);a!=null&&a.length>0&&(n[r[1]]=Mt(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=Ir(n[r[1]]))}return n}var gb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function P1(e,n,t,r){var a=[];if(typeof e=="string")a=rg(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(p){return{v:p}}));var l=typeof n=="string"?rg(n,r).map(function(p){return p.v}):n,c=0,f=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function vb(e,n,t){var r={};return n||(n={}),e=Zt(e),gb.forEach(function(a){var o=(e.match(wl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=Mt(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&P1(r.HeadingPairs,r.TitlesOfParts,n,t),n}var yb=/<[^>]+>[^<]*/g;function wb(e,n){var t={},r="",a=e.match(yb);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=mt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Mt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),p=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[r]=Mt(p);break;case"bool":t[r]=nr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(p);break;case"filetime":case"date":t[r]=Ir(p);break;case"cy":case"error":t[r]=Mt(p);break;default:if(h.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var kb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},td;function _b(e,n,t){td||(td=ip(kb)),n=td[n]||n,e[n]=t}function vp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function R1(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function M1(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function I1(e,n,t){return n===31?M1(e):R1(e,n,t)}function Dd(e,n,t){return I1(e,n,t===!1?0:4)}function bb(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return I1(e,n,0)}function Eb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(fn,""),e.l-a&2&&(e.l+=2)}return t}function Sb(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(fn,"");return t}function Tb(e){var n=e.l,t=Cu(e,F1);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Cu(e,yn);return[t,r]}function Cb(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(Tb(e));return t}function pg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(fn,"").replace(nl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function j1(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function Db(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Cu(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==ug&&r!==n&&ob.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===ug?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return R1(e,r,4).replace(fn,"");case 31:return M1(e);case 64:return vp(e);case 65:return j1(e);case 71:return Db(e);case 80:return Dd(e,r,!o.raw).replace(fn,"");case 81:return bb(e,r).replace(fn,"");case 4108:return Cb(e);case 4126:case 4127:return r==4127?Eb(e):Sb(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function hg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,h={};for(l=0;l!=a;++l){var p=e.read_shift(4),x=e.read_shift(4);o[l]=[p,x+t]}o.sort(function(A,T){return A[1]-T[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var y=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,y=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],y=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(y=!1,e.l=o[l][1]),y)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var k=n[o[l][0]];if(g[k.n]=Cu(e,k.t,{raw:!0}),k.p==="version"&&(g[k.n]=String(g[k.n]>>16)+"."+("0000"+String(g[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(g[k.n]){case 0:g[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ta(c=g[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[k.n])}}else if(o[l][0]===1){if(c=g.CodePage=Cu(e,gp),ta(c),f!==-1){var w=e.l;e.l=o[f][1],h=pg(e,c),e.l=w}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}h=pg(e,c)}else{var _=h[o[l][0]],E;switch(e[e.l]){case 65:e.l+=4,E=j1(e);break;case 30:e.l+=4,E=Dd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=Dd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=gr(e,4);break;case 64:e.l+=4,E=Ir(vp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[_]=E}}return e.l=t+r,g}function mg(e,n,t){var r=e.content;if(!r)return{};Br(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),p=r.read_shift(16);if(p!==Ft.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var x=hg(r,n),g={SystemIdentifier:h};for(var y in x)g[y]=x[y];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var k;try{k=hg(r,null)}catch{}for(y in k)g[y]=k[y];return g.FMTID=[o,l],g}function gs(e,n){return e.read_shift(n),null}function Nb(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function gr(e,n){return e.read_shift(n)===1}function Er(e){return e.read_shift(2,"u")}function L1(e,n){return Nb(e,n,Er)}function Fb(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Al(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function Ab(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",p=n===0?"":e.read_shift(n,h);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function lo(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Ol(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):lo(e,r,t)}function yo(e,n,t){if(t.biff>5)return Ol(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ob(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function Pb(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(fn,"");return r&&(e.l+=24),a}function Rb(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(fn,"");return t+l}function Mb(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Pb(e);case"0303000000000000c000000000000046":return Rb(e);default:throw new Error("Unsupported Moniker "+t)}}function eu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(fn,""):"";return t}function Ib(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,h="",p,x;a&16&&(o=eu(e,t-e.l)),a&128&&(l=eu(e,t-e.l)),(a&257)===257&&(c=eu(e,t-e.l)),(a&257)===1&&(f=Mb(e,t-e.l)),a&8&&(h=eu(e,t-e.l)),a&32&&(p=e.read_shift(16)),a&64&&(x=vp(e)),e.l=t;var g=l||c||f||"";g&&h&&(g+="#"+h),g||(g="#"+h),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var y={Target:g};return p&&(y.guid=p),x&&(y.time=x),o&&(y.Tooltip=o),y}function z1(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function B1(e,n){var t=z1(e);return t[3]=0,t}function Ca(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function jb(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function Lb(e,n,t){return n===0?"":yo(e,n,t)}function zb(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function W1(e){var n=e.read_shift(2),t=xp(e);return[n,t]}function Bb(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Al(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function Qu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function U1(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var Wb=U1;function H1(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function Ub(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function Hb(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Gr(e){e.l+=2,e.l+=e.read_shift(2)}var $b={0:Gr,4:Gr,5:Gr,6:Gr,7:Hb,8:Gr,9:Gr,10:Gr,11:Gr,12:Gr,13:Ub,14:Gr,15:Gr,16:Gr,17:Gr,18:Gr,19:Gr,20:Gr,21:H1};function Yb(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push($b[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function tu(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function Vb(e,n){return n===0||e.read_shift(2),1200}function Kb(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=yo(e,0,t);return e.read_shift(n+r-e.l),a}function Gb(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function Xb(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Al(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function Qb(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(Ab(e));return o.Count=r,o.Unique=a,o}function qb(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function Zb(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function Jb(e){var n=jb(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function eE(e){return e.read_shift(2),e.read_shift(4)}function xg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function tE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),h=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:h}}function rE(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function nE(){}function aE(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Al(e,0,t),r}function sE(e){var n=Ca(e);return n.isst=e.read_shift(4),n}function oE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=Ca(e);t.biff==2&&e.l++;var o=Ol(e,r-e.l,t);return a.val=o,a}function iE(e,n,t){var r=e.read_shift(2),a=yo(e,0,t);return[r,a]}var lE=yo;function gg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function cE(e){var n=e.read_shift(2),t=e.read_shift(2),r=W1(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function uE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(W1(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function fE(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function dE(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=cb[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function pE(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=dE(e,n,r.fStyle,t),r}function hE(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function vg(e,n,t){var r=Ca(e);(t.biff==2||n==9)&&++e.l;var a=Fb(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function mE(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Ca(e),a=Qr(e);return r.val=a,r}var yg=Lb;function xE(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=lo(e,o),c=[];r>e.l;)c.push(Ol(e));return[o,a,l,c]}function wg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=Bb(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var gE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=lo(e,l,t);a&32&&(h=gE[h.charCodeAt(0)]);var p=r-e.l;t&&t.biff==2&&--p;var x=r==e.l||c===0||!(p>0)?[]:ZC(e,p,t,c);return{chKey:o,Name:h,itab:f,rgce:x}}function $1(e,n,t){if(t.biff<8)return vE(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(zb(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function vE(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Al(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function yE(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=lo(e,r,t),l=lo(e,a,t);return[o,l]}function wE(e,n,t){var r=U1(e);e.l++;var a=e.read_shift(1);return n-=8,[JC(e,n,t),a,r]}function _g(e,n,t){var r=Wb(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,QC(e,n,t)]}function kE(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function _E(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=yo(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function bE(e,n,t){return _E(e,n,t)}function EE(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(Qu(e));return t}function SE(e,n,t){if(t&&t.biff<8)return CE(e,n,t);var r=H1(e),a=Yb(e,n-22,r[1]);return{cmo:r,ft:a}}var TE={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function CE(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((TE[r]||Jr)(e,n,t)),{cmo:[a,r,o],ft:l}}function DE(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=Ob(e,6,t);var c=e.read_shift(2);e.read_shift(2),Er(e,2);var f=e.read_shift(2);e.l+=f;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],x=lo(e,e.lens[h+1]-e.lens[h]-1);if(a+=x,a.length>=(p?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function NE(e,n){var t=Qu(e);e.l+=16;var r=Ib(e,n-24);return[t,r]}function FE(e,n){e.read_shift(2);var t=Qu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(fn,""),[t,r]}function AE(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=fg[t]||t,t=e.read_shift(2),n[1]=fg[t]||t,n}function OE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(B1(e));return t}function PE(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(B1(e));return t}function RE(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Y1(e,n,t){if(!t.cellStyles)return Jr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var h={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(h.level=f>>8&7),h}function ME(e,n){var t={};return n<32||(e.l+=16,t.header=Qr(e),t.footer=Qr(e),e.l+=2),t}function IE(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var jE=Ca,LE=L1,zE=Ol;function BE(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function WE(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Ca(e);++e.l;var a=yo(e,n-7,t);return r.t="str",r.val=a,r}function UE(e){var n=Ca(e);++e.l;var t=Qr(e);return n.t="n",n.val=t,n}function HE(e){var n=Ca(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function $E(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function YE(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function VE(e,n,t){var r=e.l+n,a=Ca(e),o=e.read_shift(2),l=lo(e,o,t);return e.l=r,a.t="str",a.val=l,a}var KE=[2,3,48,49,131,139,140,245],bg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=ip({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var h=[],p=Cs(1);switch(f.type){case"base64":p=ea(Cn(c));break;case"binary":p=ea(c);break;case"buffer":case"array":p=c;break}Br(p,0);var x=p.read_shift(1),g=!!(x&136),y=!1,k=!1;switch(x){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,_=521;x==2&&(w=p.read_shift(2)),p.l+=3,x!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(_=p.read_shift(2));var E=p.read_shift(2),A=f.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(A=e[p[p.l]]),p.l+=1,p.l+=2),k&&(p.l+=36);for(var T=[],j={},ee=Math.min(p.length,x==2?521:_-10-(y?264:0)),R=k?32:11;p.l<ee&&p[p.l]!=13;)switch(j={},j.name=vl.utils.decode(A,p.slice(p.l,p.l+R)).replace(/[\u0000\r\n].*$/g,""),p.l+=R,j.type=String.fromCharCode(p.read_shift(1)),x!=2&&!k&&(j.offset=p.read_shift(4)),j.len=p.read_shift(1),x==2&&(j.offset=p.read_shift(2)),j.dec=p.read_shift(1),j.name.length&&T.push(j),x!=2&&(p.l+=k?13:14),j.type){case"B":(!y||j.len!=8)&&f.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(p[p.l]!==13&&(p.l=_-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=_;var C=0,Q=0;for(h[0]=[],Q=0;Q!=T.length;++Q)h[0][Q]=T[Q].name;for(;w-- >0;){if(p[p.l]===42){p.l+=E;continue}for(++p.l,h[++C]=[],Q=0,Q=0;Q!=T.length;++Q){var M=p.slice(p.l,p.l+T[Q].len);p.l+=T[Q].len,Br(M,0);var te=vl.utils.decode(A,M);switch(T[Q].type){case"C":te.trim().length&&(h[C][Q]=te.replace(/\s+$/,""));break;case"D":te.length===8?h[C][Q]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):h[C][Q]=te;break;case"F":h[C][Q]=parseFloat(te.trim());break;case"+":case"I":h[C][Q]=k?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":h[C][Q]=!0;break;case"N":case"F":h[C][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[C][Q]="##MEMO##"+(k?parseInt(te.trim(),10):M.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(h[C][Q]=+te||0);break;case"@":h[C][Q]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":h[C][Q]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":h[C][Q]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[C][Q]=-M.read_shift(-8,"f");break;case"B":if(y&&T[Q].len==8){h[C][Q]=M.read_shift(8,"f");break}case"G":case"P":M.l+=T[Q].len;break;case"0":if(T[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[Q].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=T,h}function r(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var p=hi(t(c,h),h);return p["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,p}function a(c,f){try{return Os(r(c,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var h=f||{};if(+h.codepage>=0&&ta(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Sd(),x=Md(c,{header:1,raw:!0,cellDates:!0}),g=x[0],y=x.slice(1),k=c["!cols"]||[],w=0,_=0,E=0,A=1;for(w=0;w<g.length;++w){if(((k[w]||{}).DBF||{}).name){g[w]=k[w].DBF.name,++E;continue}if(g[w]!=null){if(++E,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(_=0;_<1024;++_)if(g.indexOf(g[w]+"_"+_)==-1){g[w]+="_"+_;break}}}}var T=dr(c["!ref"]),j=[],ee=[],R=[];for(w=0;w<=T.e.c-T.s.c;++w){var C="",Q="",M=0,te=[];for(_=0;_<y.length;++_)y[_][w]!=null&&te.push(y[_][w]);if(te.length==0||g[w]==null){j[w]="?";continue}for(_=0;_<te.length;++_){switch(typeof te[_]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=te[_]instanceof Date?"D":"C";break;default:Q="C"}M=Math.max(M,String(te[_]).length),C=C&&C!=Q?"C":Q}M>250&&(M=250),Q=((k[w]||{}).DBF||{}).type,Q=="C"&&k[w].DBF.len>M&&(M=k[w].DBF.len),C=="B"&&Q=="N"&&(C="N",R[w]=k[w].DBF.dec,M=k[w].DBF.len),ee[w]=C=="C"||Q=="N"?M:o[C]||0,A+=ee[w],j[w]=C}var K=p.next(32);for(K.write_shift(4,318902576),K.write_shift(4,y.length),K.write_shift(2,296+32*E),K.write_shift(2,A),w=0;w<4;++w)K.write_shift(4,0);for(K.write_shift(4,0|(+n[$v]||3)<<8),w=0,_=0;w<g.length;++w)if(g[w]!=null){var B=p.next(32),fe=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,fe,"sbcs"),B.write_shift(1,j[w]=="?"?"C":j[w],"sbcs"),B.write_shift(4,_),B.write_shift(1,ee[w]||o[j[w]]||0),B.write_shift(1,R[w]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),_+=ee[w]||o[j[w]]||0}var ue=p.next(264);for(ue.write_shift(4,13),w=0;w<65;++w)ue.write_shift(4,0);for(w=0;w<y.length;++w){var oe=p.next(A);for(oe.write_shift(1,0),_=0;_<g.length;++_)if(g[_]!=null)switch(j[_]){case"L":oe.write_shift(1,y[w][_]==null?63:y[w][_]?84:70);break;case"B":oe.write_shift(8,y[w][_]||0,"f");break;case"N":var he="0";for(typeof y[w][_]=="number"&&(he=y[w][_].toFixed(R[_]||0)),E=0;E<ee[_]-he.length;++E)oe.write_shift(1,32);oe.write_shift(1,he,"sbcs");break;case"D":y[w][_]?(oe.write_shift(4,("0000"+y[w][_].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(y[w][_].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+y[w][_].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var V=String(y[w][_]!=null?y[w][_]:"").slice(0,ee[_]);for(oe.write_shift(1,V,"sbcs"),E=0;E<ee[_]-V.length;++E)oe.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),GE=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+ba(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,y){var k=e[y];return typeof k=="number"?zx(k):k},r=function(g,y,k){var w=y.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?g:zx(w)};e["|"]=254;function a(g,y){switch(y.type){case"base64":return o(Cn(g),y);case"binary":return o(g,y);case"buffer":return o(Ct&&Buffer.isBuffer(g)?g.toString("binary"):mo(g),y);case"array":return o(io(g),y)}throw new Error("Unrecognized type "+y.type)}function o(g,y){var k=g.split(/[\n\r]+/),w=-1,_=-1,E=0,A=0,T=[],j=[],ee=null,R={},C=[],Q=[],M=[],te=0,K;for(+y.codepage>=0&&ta(+y.codepage);E!==k.length;++E){te=0;var B=k[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),fe=B.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),ue=fe[0],oe;if(B.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":fe[1].charAt(0)=="P"&&j.push(B.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,V=!1,le=!1,J=!1,ae=-1,W=-1;for(A=1;A<fe.length;++A)switch(fe[A].charAt(0)){case"A":break;case"X":_=parseInt(fe[A].slice(1))-1,V=!0;break;case"Y":for(w=parseInt(fe[A].slice(1))-1,V||(_=0),K=T.length;K<=w;++K)T[K]=[];break;case"K":oe=fe[A].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(na(oe))?isNaN(ai(oe).getDate())||(oe=Ir(oe)):(oe=na(oe),ee!==null&&di(ee)&&(oe=Xu(oe))),he=!0;break;case"E":J=!0;var S=Zo(fe[A].slice(1),{r:w,c:_});T[w][_]=[T[w][_],S];break;case"S":le=!0,T[w][_]=[T[w][_],"S5S"];break;case"G":break;case"R":ae=parseInt(fe[A].slice(1))-1;break;case"C":W=parseInt(fe[A].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}if(he&&(T[w][_]&&T[w][_].length==2?T[w][_][0]=oe:T[w][_]=oe,ee=null),le){if(J)throw new Error("SYLK shared formula cannot have own formula");var P=ae>-1&&T[ae][W];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");T[w][_][1]=ty(P[1],{r:w-ae,c:_-W})}break;case"F":var O=0;for(A=1;A<fe.length;++A)switch(fe[A].charAt(0)){case"X":_=parseInt(fe[A].slice(1))-1,++O;break;case"Y":for(w=parseInt(fe[A].slice(1))-1,K=T.length;K<=w;++K)T[K]=[];break;case"M":te=parseInt(fe[A].slice(1))/20;break;case"F":break;case"G":break;case"P":ee=j[parseInt(fe[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=fe[A].slice(1).split(" "),K=parseInt(M[0],10);K<=parseInt(M[1],10);++K)te=parseInt(M[2],10),Q[K-1]=te===0?{hidden:!0}:{wch:te},si(Q[K-1]);break;case"C":_=parseInt(fe[A].slice(1))-1,Q[_]||(Q[_]={});break;case"R":w=parseInt(fe[A].slice(1))-1,C[w]||(C[w]={}),te>0?(C[w].hpt=te,C[w].hpx=El(te)):te===0&&(C[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}O<1&&(ee=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+B)}}return C.length>0&&(R["!rows"]=C),Q.length>0&&(R["!cols"]=Q),y&&y.sheetRows&&(T=T.slice(0,y.sheetRows)),[T,R]}function l(g,y){var k=a(g,y),w=k[0],_=k[1],E=hi(w,y);return ba(_).forEach(function(A){E[A]=_[A]}),E}function c(g,y){return Os(l(g,y),y)}function f(g,y,k,w){var _="C;Y"+(k+1)+";X"+(w+1)+";K";switch(g.t){case"n":_+=g.v||0,g.f&&!g.F&&(_+=";E"+RT(g.f,{r:k,c:w}));break;case"b":_+=g.v?"TRUE":"FALSE";break;case"e":_+=g.w||g.v;break;case"d":_+='"'+(g.w||g.v)+'"';break;case"s":_+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(g,y){y.forEach(function(k,w){var _="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?_+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Nu(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Fu(k.wpx)),typeof k.wch=="number"&&(_+=Math.round(k.wch))),_.charAt(_.length-1)!=" "&&g.push(_)})}function p(g,y){y.forEach(function(k,w){var _="F;";k.hidden?_+="M0;":k.hpt?_+="M"+20*k.hpt+";":k.hpx&&(_+="M"+20*Z1(k.hpx)+";"),_.length>2&&g.push(_+"R"+(w+1))})}function x(g,y){var k=["ID;PWXL;N;E"],w=[],_=dr(g["!ref"]),E,A=Array.isArray(g),T=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),g["!cols"]&&h(k,g["!cols"]),g["!rows"]&&p(k,g["!rows"]),k.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var j=_.s.r;j<=_.e.r;++j)for(var ee=_.s.c;ee<=_.e.c;++ee){var R=vt({r:j,c:ee});E=A?(g[j]||[])[ee]:g[R],!(!E||E.v==null&&(!E.f||E.F))&&w.push(f(E,g,j,ee))}return k.join(T)+T+w.join(T)+T+"E"+T}return{to_workbook:c,to_sheet:l,from_sheet:x}})(),XE=(function(){function e(o,l){switch(l.type){case"base64":return n(Cn(o),l);case"binary":return n(o,l);case"buffer":return n(Ct&&Buffer.isBuffer(o)?o.toString("binary"):mo(o),l);case"array":return n(io(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,h=-1,p=0,x=[];p!==c.length;++p){if(c[p].trim()==="BOT"){x[++f]=[],h=0;continue}if(!(f<0)){var g=c[p].trim().split(","),y=g[0],k=g[1];++p;for(var w=c[p]||"";(w.match(/["]/g)||[]).length&1&&p<c.length-1;)w+=`
`+c[++p];switch(w=w.trim(),+y){case-1:if(w==="BOT"){x[++f]=[],h=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[f][h]=!0:w==="FALSE"?x[f][h]=!1:isNaN(na(k))?isNaN(ai(k).getDate())?x[f][h]=k:x[f][h]=Ir(k):x[f][h]=na(k),++h;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[f][h++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function t(o,l){return hi(e(o,l),l)}function r(o,l){return Os(t(o,l),l)}var a=(function(){var o=function(f,h,p,x,g){f.push(h),f.push(p+","+x),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,h,p,x){f.push(h+","+p),f.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var h=[],p=dr(f["!ref"]),x,g=Array.isArray(f);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,p.e.r-p.s.r+1,""),o(h,"TUPLES",0,p.e.c-p.s.c+1,""),o(h,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){l(h,-1,0,"BOT");for(var k=p.s.c;k<=p.e.c;++k){var w=vt({r:y,c:k});if(x=g?(f[y]||[])[k]:f[w],!x){l(h,1,0,"");continue}switch(x.t){case"n":var _=x.w;!_&&x.v!=null&&(_=x.v),_==null?x.f&&!x.F?l(h,1,0,"="+x.f):l(h,1,0,""):l(h,0,_,"V");break;case"b":l(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Un(x.z||kt[14],dn(Ir(x.v)))),l(h,0,x.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var E=`\r
`,A=h.join(E);return A}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),QE=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(x,g){for(var y=x.split(`
`),k=-1,w=-1,_=0,E=[];_!==y.length;++_){var A=y[_].trim().split(":");if(A[0]==="cell"){var T=ln(A[1]);if(E.length<=T.r)for(k=E.length;k<=T.r;++k)E[k]||(E[k]=[]);switch(k=T.r,w=T.c,A[2]){case"t":E[k][w]=e(A[3]);break;case"v":E[k][w]=+A[3];break;case"vtf":var j=A[A.length-1];case"vtc":switch(A[3]){case"nl":E[k][w]=!!+A[4];break;default:E[k][w]=+A[4];break}A[2]=="vtf"&&(E[k][w]=[E[k][w],j])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function r(x,g){return hi(t(x,g),g)}function a(x,g){return Os(r(x,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var g=[],y=[],k,w="",_=pi(x["!ref"]),E=Array.isArray(x),A=_.s.r;A<=_.e.r;++A)for(var T=_.s.c;T<=_.e.c;++T)if(w=vt({r:A,c:T}),k=E?(x[A]||[])[T]:x[w],!(!k||k.v==null||k.t==="z")){switch(y=["cell",w,"t"],k.t){case"s":case"str":y.push(n(k.v));break;case"n":k.f?(y[2]="vtf",y[3]="n",y[4]=k.v,y[5]=n(k.f)):(y[2]="v",y[3]=k.v);break;case"b":y[2]="vt"+(k.f?"f":"c"),y[3]="nl",y[4]=k.v?"1":"0",y[5]=n(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var j=dn(Ir(k.v));y[2]="vtc",y[3]="nd",y[4]=""+j,y[5]=k.w||Un(k.z||kt[14],j);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(x){return[o,l,c,l,h(x),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:p}})(),_l=(function(){function e(p,x,g,y,k){k.raw?x[g][y]=p:p===""||(p==="TRUE"?x[g][y]=!0:p==="FALSE"?x[g][y]=!1:isNaN(na(p))?isNaN(ai(p).getDate())?x[g][y]=p:x[g][y]=Ir(p):x[g][y]=na(p))}function n(p,x){var g=x||{},y=[];if(!p||p.length===0)return y;for(var k=p.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var _=10,E=0,A=0;A<=w;++A)E=k[A].indexOf(" "),E==-1?E=k[A].length:E++,_=Math.max(_,E);for(A=0;A<=w;++A){y[A]=[];var T=0;for(e(k[A].slice(0,_).trim(),y,A,T,g),T=1;T<=(k[A].length-_)/10+1;++T)e(k[A].slice(_+(T-1)*10,_+T*10).trim(),y,A,T,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(p){for(var x={},g=!1,y=0,k=0;y<p.length;++y)(k=p.charCodeAt(y))==34?g=!g:!g&&k in t&&(x[k]=(x[k]||0)+1);k=[];for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y]);if(!k.length){x=r;for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&k.push([x[y],y])}return k.sort(function(w,_){return w[0]-_[0]||r[w[1]]-r[_[1]]}),t[k.pop()[1]]||44}function o(p,x){var g=x||{},y="",k=g.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=a(p.slice(0,1024)):g&&g.FS?y=g.FS:y=a(p.slice(0,1024));var _=0,E=0,A=0,T=0,j=0,ee=y.charCodeAt(0),R=!1,C=0,Q=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var M=g.dateNF!=null?i_(g.dateNF):null;function te(){var K=p.slice(T,j),B={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)B.t="z";else if(g.raw)B.t="s",B.v=K;else if(K.trim().length===0)B.t="s",B.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(B.t="s",B.v=K.slice(2,-1).replace(/""/g,'"')):IT(K)?(B.t="n",B.f=K.slice(1)):(B.t="s",B.v=K);else if(K=="TRUE")B.t="b",B.v=!0;else if(K=="FALSE")B.t="b",B.v=!1;else if(!isNaN(A=na(K)))B.t="n",g.cellText!==!1&&(B.w=K),B.v=A;else if(!isNaN(ai(K).getDate())||M&&K.match(M)){B.z=g.dateNF||kt[14];var fe=0;M&&K.match(M)&&(K=l_(K,g.dateNF,K.match(M)||[]),fe=1),g.cellDates?(B.t="d",B.v=Ir(K,fe)):(B.t="n",B.v=dn(Ir(K,fe))),g.cellText!==!1&&(B.w=Un(B.z,B.v instanceof Date?dn(B.v):B.v)),g.cellNF||delete B.z}else B.t="s",B.v=K;if(B.t=="z"||(g.dense?(k[_]||(k[_]=[]),k[_][E]=B):k[vt({c:E,r:_})]=B),T=j+1,Q=p.charCodeAt(T),w.e.c<E&&(w.e.c=E),w.e.r<_&&(w.e.r=_),C==ee)++E;else if(E=0,++_,g.sheetRows&&g.sheetRows<=_)return!0}e:for(;j<p.length;++j)switch(C=p.charCodeAt(j)){case 34:Q===34&&(R=!R);break;case ee:case 10:case 13:if(!R&&te())break e;break}return j-T>0&&te(),k["!ref"]=At(w),k}function l(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,x):hi(n(p,x),x)}function c(p,x){var g="",y=x.type=="string"?[0,0,0,0]:Tp(p,x);switch(x.type){case"base64":g=Cn(p);break;case"binary":g=p;break;case"buffer":x.codepage==65001?g=p.toString("utf8"):x.codepage&&typeof vl<"u"||(g=Ct&&Buffer.isBuffer(p)?p.toString("binary"):mo(p));break;case"array":g=io(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+x.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=Zt(g.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?g=Zt(g):x.type=="binary"&&typeof vl<"u",g.slice(0,19)=="socialcalc:version:"?QE.to_sheet(x.type=="string"?g:Zt(g),x):l(g,x)}function f(p,x){return Os(c(p,x),x)}function h(p){for(var x=[],g=dr(p["!ref"]),y,k=Array.isArray(p),w=g.s.r;w<=g.e.r;++w){for(var _=[],E=g.s.c;E<=g.e.c;++E){var A=vt({r:w,c:E});if(y=k?(p[w]||[])[E]:p[A],!y||y.v==null){_.push("          ");continue}for(var T=(y.w||(Ka(y),y.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(E===0?" ":""))}x.push(_.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})();function qE(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=GE.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return _l.to_workbook(e,n)}}var pl=(function(){function e(S,P,O){if(S){Br(S,S.l||0);for(var z=O.Enum||ae;S.l<S.length;){var H=S.read_shift(2),re=z[H]||z[65535],ie=S.read_shift(2),Z=S.l+ie,ge=re.f&&re.f(S,ie,O);if(S.l=Z,P(ge,re,H))return}}}function n(S,P){switch(P.type){case"base64":return t(ea(Cn(S)),P);case"binary":return t(ea(S),P);case"buffer":case"array":return t(S,P)}throw"Unsupported type "+P.type}function t(S,P){if(!S)return S;var O=P||{},z=O.dense?[]:{},H="Sheet1",re="",ie=0,Z={},ge=[],xe=[],L={s:{r:0,c:0},e:{r:0,c:0}},Ve=O.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)O.Enum=ae,e(S,function(de,De,Le){switch(Le){case 0:O.vers=de,de>=4096&&(O.qpro=!0);break;case 6:L=de;break;case 204:de&&(re=de);break;case 222:re=de;break;case 15:case 51:O.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Le==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=O.dateNF||kt[14],O.cellDates&&(de[1].t="d",de[1].v=Xu(de[1].v))),O.qpro&&de[3]>ie&&(z["!ref"]=At(L),Z[H]=z,ge.push(H),z=O.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},ie=de[3],H=re||"Sheet"+(ie+1),re="");var Ae=O.dense?(z[de[0].r]||[])[de[0].c]:z[vt(de[0])];if(Ae){Ae.t=de[1].t,Ae.v=de[1].v,de[1].z!=null&&(Ae.z=de[1].z),de[1].f!=null&&(Ae.f=de[1].f);break}O.dense?(z[de[0].r]||(z[de[0].r]=[]),z[de[0].r][de[0].c]=de[1]):z[vt(de[0])]=de[1];break}},O);else if(S[2]==26||S[2]==14)O.Enum=W,S[2]==14&&(O.qpro=!0,S.l=0),e(S,function(de,De,Le){switch(Le){case 204:H=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>ie&&(z["!ref"]=At(L),Z[H]=z,ge.push(H),z=O.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},ie=de[3],H="Sheet"+(ie+1)),Ve>0&&de[0].r>=Ve)break;O.dense?(z[de[0].r]||(z[de[0].r]=[]),z[de[0].r][de[0].c]=de[1]):z[vt(de[0])]=de[1],L.e.c<de[0].c&&(L.e.c=de[0].c),L.e.r<de[0].r&&(L.e.r=de[0].r);break;case 27:de[14e3]&&(xe[de[14e3][0]]=de[14e3][1]);break;case 1537:xe[de[0]]=de[1],de[0]==ie&&(H=de[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(z["!ref"]=At(L),Z[re||H]=z,ge.push(re||H),!xe.length)return{SheetNames:ge,Sheets:Z};for(var Te={},st=[],Ge=0;Ge<xe.length;++Ge)Z[ge[Ge]]?(st.push(xe[Ge]||ge[Ge]),Te[xe[Ge]]=Z[xe[Ge]]||Z[ge[Ge]]):(st.push(xe[Ge]),Te[xe[Ge]]={"!ref":"A1"});return{SheetNames:st,Sheets:Te}}function r(S,P){var O=P||{};if(+O.codepage>=0&&ta(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var z=Sd(),H=dr(S["!ref"]),re=Array.isArray(S),ie=[];Jn(z,0,o(1030)),Jn(z,6,f(H));for(var Z=Math.min(H.e.r,8191),ge=H.s.r;ge<=Z;++ge)for(var xe=Hr(ge),L=H.s.c;L<=H.e.c;++L){ge===H.s.r&&(ie[L]=Dr(L));var Ve=ie[L]+xe,Te=re?(S[ge]||[])[L]:S[Ve];if(!(!Te||Te.t=="z"))if(Te.t=="n")(Te.v|0)==Te.v&&Te.v>=-32768&&Te.v<=32767?Jn(z,13,y(ge,L,Te.v)):Jn(z,14,w(ge,L,Te.v));else{var st=Ka(Te);Jn(z,15,x(ge,L,st.slice(0,239)))}}return Jn(z,1),z.end()}function a(S,P){var O=P||{};if(+O.codepage>=0&&ta(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var z=Sd();Jn(z,0,l(S));for(var H=0,re=0;H<S.SheetNames.length;++H)(S.Sheets[S.SheetNames[H]]||{})["!ref"]&&Jn(z,27,J(S.SheetNames[H],re++));var ie=0;for(H=0;H<S.SheetNames.length;++H){var Z=S.Sheets[S.SheetNames[H]];if(!(!Z||!Z["!ref"])){for(var ge=dr(Z["!ref"]),xe=Array.isArray(Z),L=[],Ve=Math.min(ge.e.r,8191),Te=ge.s.r;Te<=Ve;++Te)for(var st=Hr(Te),Ge=ge.s.c;Ge<=ge.e.c;++Ge){Te===ge.s.r&&(L[Ge]=Dr(Ge));var de=L[Ge]+st,De=xe?(Z[Te]||[])[Ge]:Z[de];if(!(!De||De.t=="z"))if(De.t=="n")Jn(z,23,te(Te,Ge,ie,De.v));else{var Le=Ka(De);Jn(z,22,C(Te,Ge,ie,Le.slice(0,239)))}}++ie}}return Jn(z,1),z.end()}function o(S){var P=Cr(2);return P.write_shift(2,S),P}function l(S){var P=Cr(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var O=0,z=0,H=0,re=0;re<S.SheetNames.length;++re){var ie=S.SheetNames[re],Z=S.Sheets[ie];if(!(!Z||!Z["!ref"])){++H;var ge=pi(Z["!ref"]);O<ge.e.r&&(O=ge.e.r),z<ge.e.c&&(z=ge.e.c)}}return O>8191&&(O=8191),P.write_shift(2,O),P.write_shift(1,H),P.write_shift(1,z),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function c(S,P,O){var z={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&O.qpro?(z.s.c=S.read_shift(1),S.l++,z.s.r=S.read_shift(2),z.e.c=S.read_shift(1),S.l++,z.e.r=S.read_shift(2),z):(z.s.c=S.read_shift(2),z.s.r=S.read_shift(2),P==12&&O.qpro&&(S.l+=2),z.e.c=S.read_shift(2),z.e.r=S.read_shift(2),P==12&&O.qpro&&(S.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function f(S){var P=Cr(8);return P.write_shift(2,S.s.c),P.write_shift(2,S.s.r),P.write_shift(2,S.e.c),P.write_shift(2,S.e.r),P}function h(S,P,O){var z=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(z[0].c=S.read_shift(1),z[3]=S.read_shift(1),z[0].r=S.read_shift(2),S.l+=2):(z[2]=S.read_shift(1),z[0].c=S.read_shift(2),z[0].r=S.read_shift(2)),z}function p(S,P,O){var z=S.l+P,H=h(S,P,O);if(H[1].t="s",O.vers==20768){S.l++;var re=S.read_shift(1);return H[1].v=S.read_shift(re,"utf8"),H}return O.qpro&&S.l++,H[1].v=S.read_shift(z-S.l,"cstr"),H}function x(S,P,O){var z=Cr(7+O.length);z.write_shift(1,255),z.write_shift(2,P),z.write_shift(2,S),z.write_shift(1,39);for(var H=0;H<z.length;++H){var re=O.charCodeAt(H);z.write_shift(1,re>=128?95:re)}return z.write_shift(1,0),z}function g(S,P,O){var z=h(S,P,O);return z[1].v=S.read_shift(2,"i"),z}function y(S,P,O){var z=Cr(7);return z.write_shift(1,255),z.write_shift(2,P),z.write_shift(2,S),z.write_shift(2,O,"i"),z}function k(S,P,O){var z=h(S,P,O);return z[1].v=S.read_shift(8,"f"),z}function w(S,P,O){var z=Cr(13);return z.write_shift(1,255),z.write_shift(2,P),z.write_shift(2,S),z.write_shift(8,O,"f"),z}function _(S,P,O){var z=S.l+P,H=h(S,P,O);if(H[1].v=S.read_shift(8,"f"),O.qpro)S.l=z;else{var re=S.read_shift(2);j(S.slice(S.l,S.l+re),H),S.l+=re}return H}function E(S,P,O){var z=P&32768;return P&=-32769,P=(z?S:0)+(P>=8192?P-16384:P),(z?"":"$")+(O?Dr(P):Hr(P))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(S,P){Br(S,0);for(var O=[],z=0,H="",re="",ie="",Z="";S.l<S.length;){var ge=S[S.l++];switch(ge){case 0:O.push(S.read_shift(8,"f"));break;case 1:re=E(P[0].c,S.read_shift(2),!0),H=E(P[0].r,S.read_shift(2),!1),O.push(re+H);break;case 2:{var xe=E(P[0].c,S.read_shift(2),!0),L=E(P[0].r,S.read_shift(2),!1);re=E(P[0].c,S.read_shift(2),!0),H=E(P[0].r,S.read_shift(2),!1),O.push(xe+L+":"+re+H)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(S.read_shift(2));break;case 6:{for(var Ve="";ge=S[S.l++];)Ve+=String.fromCharCode(ge);O.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:Z=O.pop(),ie=O.pop(),O.push(["AND","OR"][ge-20]+"("+ie+","+Z+")");break;default:if(ge<32&&T[ge])Z=O.pop(),ie=O.pop(),O.push(ie+T[ge]+Z);else if(A[ge]){if(z=A[ge][1],z==69&&(z=S[S.l++]),z>O.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+O.join("|")+"|");return}var Te=O.slice(-z);O.length-=z,O.push(A[ge][0]+"("+Te.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}O.length==1?P[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function ee(S){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=S.read_shift(2),P[3]=S[S.l++],P[0].c=S[S.l++],P}function R(S,P){var O=ee(S);return O[1].t="s",O[1].v=S.read_shift(P-4,"cstr"),O}function C(S,P,O,z){var H=Cr(6+z.length);H.write_shift(2,S),H.write_shift(1,O),H.write_shift(1,P),H.write_shift(1,39);for(var re=0;re<z.length;++re){var ie=z.charCodeAt(re);H.write_shift(1,ie>=128?95:ie)}return H.write_shift(1,0),H}function Q(S,P){var O=ee(S);O[1].v=S.read_shift(2);var z=O[1].v>>1;if(O[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return O[1].v=z,O}function M(S,P){var O=ee(S),z=S.read_shift(4),H=S.read_shift(4),re=S.read_shift(2);if(re==65535)return z===0&&H===3221225472?(O[1].t="e",O[1].v=15):z===0&&H===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var ie=re&32768;return re=(re&32767)-16446,O[1].v=(1-ie*2)*(H*Math.pow(2,re+32)+z*Math.pow(2,re)),O}function te(S,P,O,z){var H=Cr(14);if(H.write_shift(2,S),H.write_shift(1,O),H.write_shift(1,P),z==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var re=0,ie=0,Z=0,ge=0;return z<0&&(re=1,z=-z),ie=Math.log2(z)|0,z/=Math.pow(2,ie-31),ge=z>>>0,(ge&2147483648)==0&&(z/=2,++ie,ge=z>>>0),z-=ge,ge|=2147483648,ge>>>=0,z*=Math.pow(2,32),Z=z>>>0,H.write_shift(4,Z),H.write_shift(4,ge),ie+=16383+(re?32768:0),H.write_shift(2,ie),H}function K(S,P){var O=M(S);return S.l+=P-14,O}function B(S,P){var O=ee(S),z=S.read_shift(4);return O[1].v=z>>6,O}function fe(S,P){var O=ee(S),z=S.read_shift(8,"f");return O[1].v=z,O}function ue(S,P){var O=fe(S);return S.l+=P-10,O}function oe(S,P){return S[S.l+P-1]==0?S.read_shift(P,"cstr"):""}function he(S,P){var O=S[S.l++];O>P-1&&(O=P-1);for(var z="";z.length<O;)z+=String.fromCharCode(S[S.l++]);return z}function V(S,P,O){if(!(!O.qpro||P<21)){var z=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var H=S.read_shift(P-21,"cstr");return[z,H]}}function le(S,P){for(var O={},z=S.l+P;S.l<z;){var H=S.read_shift(2);if(H==14e3){for(O[H]=[0,""],O[H][0]=S.read_shift(2);S[S.l];)O[H][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return O}function J(S,P){var O=Cr(5+S.length);O.write_shift(2,14e3),O.write_shift(2,P);for(var z=0;z<S.length;++z){var H=S.charCodeAt(z);O[O.l++]=H>127?95:H}return O[O.l++]=0,O}var ae={0:{n:"BOF",f:Er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:V},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function ZE(e){var n={},t=e.match(en),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=mt(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=rp[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var JE=(function(){var e=wl("t"),n=wl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:Mt(l[1])},f=o.match(n);return f&&(c.s=ZE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),eS=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),tS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,rS=/<(?:\w+:)?r>/,nS=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Mt(Zt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Zt(e),t&&(r.h=cp(r.t))):e.match(rS)&&(r.r=Zt(e),r.t=Mt(Zt((e.replace(nS,"").match(tS)||[]).join("").replace(en,""))),t&&(r.h=eS(JE(r.r)))),r):{t:""}}var aS=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sS=/<(?:\w+:)?(?:si|sstItem)>/g,oS=/<\/(?:\w+:)?(?:si|sstItem)>/;function iS(e,n){var t=[],r="";if(!e)return t;var a=e.match(aS);if(a){r=a[2].replace(sS,"").split(oS);for(var o=0;o!=r.length;++o){var l=yp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=mt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function lS(e){return[e.read_shift(4),e.read_shift(4)]}function cS(e,n){var t=[],r=!1;return Xa(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function V1(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Wa(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function uS(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function fS(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function dS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(fS(e));return n}function pS(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function hS(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Wa(e,4),n.U=Wa(e,4),n.W=Wa(e,4),n}function mS(e){var n=hS(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function K1(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function G1(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function xS(e){var n=Wa(e);switch(n.Minor){case 2:return[n.Minor,gS(e)];case 3:return[n.Minor,vS()];case 4:return[n.Minor,yS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function gS(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=K1(e,t),a=G1(e,e.length-e.l);return{t:"Std",h:r,v:a}}function vS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yS(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(en,function(o){var l=mt(o);switch(Ta(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function wS(e,n){var t={},r=t.EncryptionVersionInfo=Wa(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=K1(e,a),n-=a,t.EncryptionVerifier=G1(e,n),t}function kS(e){var n={},t=n.EncryptionVersionInfo=Wa(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function _S(e){var n=0,t,r=V1(e),a=r.length+1,o,l,c,f,h;for(t=Cs(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,h=c|f,n=h^l;return n^52811}var X1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var p=l[h],x=0;x!=7;++x)p&64&&(c^=t[f]),p*=2,--f;return c};return function(l){for(var c=V1(l),f=o(c),h=c.length,p=Cs(16),x=0;x!=16;++x)p[x]=0;var g,y,k;for((h&1)===1&&(g=f>>8,p[h]=a(e[0],g),--h,g=f&255,y=c[c.length-1],p[h]=a(y,g));h>0;)--h,g=f>>8,p[h]=a(c[h],g),--h,g=f&255,p[h]=a(c[h],g);for(h=15,k=15-c.length;k>0;)g=f>>8,p[h]=a(e[k],g),--h,--k,g=f&255,p[h]=a(c[h],g),--h,--k;return p}})(),bS=function(e,n,t,r,a){a||(a=n),r||(r=X1(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},ES=function(e){var n=0,t=X1(e);return function(r){var a=bS("",r,n,t);return n=a[1],a[0]}};function SS(e,n,t,r){var a={key:Er(e),verificationBytes:Er(e)};return t.password&&(a.verifier=_S(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=ES(t.password)),a}function TS(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=kS(e):r.Data=wS(e,n),r}function CS(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?TS(e,n-2,r):SS(e,t.biff>=8?n:n-2,t,r),r}var DS=(function(){function e(a,o){switch(o.type){case"base64":return n(Cn(a),o);case"binary":return n(a,o);case"buffer":return n(Ct&&Buffer.isBuffer(a)?a.toString("binary"):mo(a),o);case"array":return n(io(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,x){Array.isArray(c)&&(c[x]=[]);for(var g=/\\\w+\b/g,y=0,k,w=-1;k=g.exec(p);){switch(k[0]){case"\\cell":var _=p.slice(y,g.lastIndex-k[0].length);if(_[0]==" "&&(_=_.slice(1)),++w,_.length){var E={v:_,t:"s"};Array.isArray(c)?c[x][w]=E:c[vt({r:x,c:w})]=E}break}y=g.lastIndex}w>h.e.c&&(h.e.c=w)}),c["!ref"]=At(h),c}function t(a,o){return Os(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=dr(a["!ref"]),c,f=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var x=vt({r:h,c:p});c=f?(a[h]||[])[p]:a[x],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Ka(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function NS(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function bl(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function FS(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,h=a+o;switch(f=l/(h>1?2-h:h),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,h/2]}function AS(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function Du(e,n){if(n===0)return e;var t=FS(NS(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),bl(AS(t))}var Q1=6,OS=15,PS=1,sn=Q1;function Nu(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function Fu(e){return Math.floor((e-5)/sn*100+.5)/100}function Nd(e){return Math.round((e*sn+5)/sn*256)/256}function rd(e){return Nd(Fu(Nu(e)))}function wp(e){var n=Math.abs(e-rd(e)),t=sn;if(n>.005)for(sn=PS;sn<OS;++sn)Math.abs(e-rd(e))<=n&&(n=Math.abs(e-rd(e)),t=sn);sn=t}function si(e){e.width?(e.wpx=Nu(e.width),e.wch=Fu(e.wpx),e.MDW=sn):e.wpx?(e.wch=Fu(e.wpx),e.width=Nd(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Nd(e.wch),e.wpx=Nu(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var RS=96,q1=RS;function Z1(e){return e*96/q1}function El(e){return e*q1/96}var MS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IS(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=mt(l);switch(Ta(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=nr(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=nr(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function jS(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=mt(l);switch(Ta(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function LS(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=mt(l);switch(Ta(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Zt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?nr(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?nr(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?nr(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?nr(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?nr(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?nr(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?nr(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=rp[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=nr(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=to[a.color.index];a.color.index==81&&(f=to[1]),f||(f=to[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Du(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function zS(e,n,t){n.NumberFmt=[];for(var r=ba(kt),a=0;a<r.length;++a)n.NumberFmt[r[a]]=kt[r[a]];var o=e[0].match(en);if(o)for(a=0;a<o.length;++a){var l=mt(o[a]);switch(Ta(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Mt(Zt(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}eo(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var ru=["numFmtId","fillId","fontId","borderId","xfId"],nu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BS(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(en)||[]).forEach(function(o){var l=mt(o),c=0;switch(Ta(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<ru.length;++c)r[ru[c]]&&(r[ru[c]]=parseInt(r[ru[c]],10));for(c=0;c<nu.length;++c)r[nu[c]]&&(r[nu[c]]=nr(r[nu[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=nr(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var WS=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,h){var p={};if(!c)return p;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=c.match(n))&&zS(x,p,h),(x=c.match(a))&&LS(x,p,f,h),(x=c.match(r))&&jS(x,p,f,h),(x=c.match(o))&&IS(x,p,f,h),(x=c.match(t))&&BS(x,p,h),p}})();function US(e,n){var t=e.read_shift(2),r=Zr(e);return[t,r]}function HS(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=J_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=Z_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Zr(e),r}var $S=Jr;function YS(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var VS=Jr;function KS(e,n,t){var r={};r.NumberFmt=[];for(var a in kt)r.NumberFmt[a]=kt[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return Xa(e,function(f,h,p){switch(p){case 44:r.NumberFmt[f[0]]=f[1],eo(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=Du(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(p);else if(h.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var GS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function XS(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(en)||[]).forEach(function(a){var o=mt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[GS.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function QS(){}function qS(){}var ZS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tT(e,n,t){n.themeElements={};var r;[["clrScheme",ZS,XS],["fontScheme",JS,QS],["fmtScheme",eT,qS]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var rT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function J1(e,n){(!e||e.length===0)&&(e=nT());var t,r={};if(!(t=e.match(rT)))throw new Error("themeElements not found in theme");return tT(t[0],r,n),r.raw=e,r}function nT(e,n){var t=[u1];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function aT(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=c1(o,{type:"array"})}catch{return}var c=Sn(l,"theme/theme/theme1.xml",!0);if(c)return J1(c,t)}}function sT(e){return e.read_shift(4)}function oT(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=iT(e,4);break;case 2:n.xclrValue=z1(e);break;case 3:n.xclrValue=sT(e);break;case 4:e.l+=4;break}return e.l+=8,n}function iT(e,n){return Jr(e,n)}function lT(e,n){return Jr(e,n)}function cT(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=oT(e);break;case 6:r[1]=lT(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function uT(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(cT(e,t-e.l));return{ixfe:r,ext:o}}function fT(e,n){n.forEach(function(t){t[0]})}function dT(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zr(e)}}function pT(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function hT(e){return e.l+=4,e.read_shift(4)!=0}function mT(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return Xa(e,function(f,h,p){switch(p){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(x){c==1?r.Cell.push({type:r.Types[x[0]-1].name,index:x[1]}):c==0&&r.Value.push({type:r.Types[x[0]-1].name,index:x[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function xT(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(en,function(c){var f=mt(c);switch(Ta(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==f.name&&(l=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function gT(e){var n=[];if(!e)return n;var t=1;return(e.match(en)||[]).forEach(function(r){var a=mt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function vT(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=vt(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function yT(e,n,t){var r=[];return Xa(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function wT(e,n,t,r){if(!e)return e;var a=r||{},o=!1;Xa(e,function(c,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function kT(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function Eg(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=ln(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=dr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var h=At(f);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:t};l.h&&(p.h=l.h);for(var x=o.c.length-1;x>=0;--x){if(!t&&o.c[x].T)return;t&&!o.c[x].T&&o.c.splice(x,1)}if(t&&r){for(x=0;x<r.length;++x)if(p.a==r[x].id){p.a=r[x].name||p.a;break}}o.c.push(p)})}function _T(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=mt(c[0]),h={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=ln(f.ref);if(!(n.sheetRows&&n.sheetRows<=p.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!x&&!!x[1]&&yp(x[1])||{r:"",t:"",h:""};h.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),h.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(h.h=g.h),r.push(h)}}}}),r}function bT(e,n){var t=[],r=!1,a={},o=0;return e.replace(en,function(c,f){var h=mt(c);switch(Ta(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function ET(e,n){var t=[],r=!1;return e.replace(en,function(o){var l=mt(o);switch(Ta(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function ST(e){var n={};n.iauthor=e.read_shift(4);var t=go(e);return n.rfx=t.s,n.ref=vt(t.s),e.l+=16,n}var TT=Zr;function CT(e,n){var t=[],r=[],a={},o=!1;return Xa(e,function(c,f,h){switch(h){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var DT="application/vnd.ms-office.vbaProject";function NT(e){var n=Ft.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ft.utils.cfb_add(n,a,e.FileIndex[r].content)}}),Ft.write(n)}function FT(){return{"!type":"dialog"}}function AT(){return{"!type":"dialog"}}function OT(){return{"!type":"macro"}}function PT(){return{"!type":"macro"}}var Zo=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return c?p+=n.c:--p,f?h+=n.r:--h,a+(c?"":"$")+Dr(p)+(f?"":"$")+Hr(h)}return function(a,o){return n=o,a.replace(e,t)}})(),ey=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,RT=(function(){return function(n,t){return n.replace(ey,function(r,a,o,l,c,f){var h=pp(l)-(o?0:t.c),p=dp(f)-(c?0:t.r),x=p==0?"":c?p+1:"["+p+"]",g=h==0?"":o?h+1:"["+h+"]";return a+"R"+x+"C"+g})}})();function ty(e,n){return e.replace(ey,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Dr(pp(o)+n.c))+(l=="$"?l+c:Hr(dp(c)+n.r))})}function MT(e,n,t){var r=pi(n),a=r.s,o=ln(t),l={r:o.r-a.r,c:o.c-a.c};return ty(e,l)}function IT(e){return e.length!=1}function Sg(e){return e.replace(/_xlfn\./g,"")}function _r(e){e.l+=1}function Ds(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function ry(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return ny(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Ds(e),c=Ds(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function ny(e){var n=Ds(e),t=Ds(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function jT(e,n,t){if(t.biff<8)return ny(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=Ds(e),l=Ds(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ay(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return LT(e);var r=e.read_shift(t&&t.biff==12?4:2),a=Ds(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function LT(e){var n=Ds(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function zT(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function BT(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return WT(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function WT(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function UT(e,n,t){var r=(e[e.l++]&96)>>5,a=ry(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function HT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=ry(e,o,t);return[r,a,l]}function $T(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function YT(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function VT(e,n,t){var r=(e[e.l++]&96)>>5,a=jT(e,n-1,t);return[r,a]}function KT(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Tg(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function GT(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function XT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function QT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function qT(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function ZT(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function sy(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function JT(e){return e.read_shift(2),sy(e)}function eC(e){return e.read_shift(2),sy(e)}function tC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=ay(e,0,t);return[r,a]}function rC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=BT(e,0,t);return[r,a]}function nC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=ay(e,0,t);return[r,a,o]}function aC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[sD[a],ly[a],r]}function sC(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:oC(e);return[a,(o[0]===0?ly:aD)[o[1]]]}function oC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function iC(e,n,t){e.l+=t&&t.biff==2?3:4}function lC(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function cC(e){return e.l++,vo[e.read_shift(1)]}function uC(e){return e.l++,e.read_shift(2)}function fC(e){return e.l++,e.read_shift(1)!==0}function dC(e){return e.l++,Qr(e)}function pC(e,n,t){return e.l++,Al(e,n-1,t)}function hC(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=gr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=vo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Qr(e);break;case 2:t[1]=yo(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function mC(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?go:Qu)(e));return a}function xC(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=hC(e,t.biff);return l}function gC(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function vC(e,n,t){if(t.biff==5)return yC(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function yC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function wC(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function kC(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function _C(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function bC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var EC=Jr,SC=Jr,TC=Jr;function Pl(e,n,t){return e.l+=2,[zT(e)]}function kp(e){return e.l+=6,[]}var CC=Pl,DC=kp,NC=kp,FC=Pl;function oy(e){return e.l+=2,[Er(e),e.read_shift(2)&1]}var AC=Pl,OC=oy,PC=kp,RC=Pl,MC=Pl,IC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jC(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=IC[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function LC(e){return e.l+=2,[e.read_shift(4)]}function zC(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function BC(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function WC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function UC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function HC(e){return e.l+=4,[0,0]}var Cg={1:{n:"PtgExp",f:lC},2:{n:"PtgTbl",f:TC},3:{n:"PtgAdd",f:_r},4:{n:"PtgSub",f:_r},5:{n:"PtgMul",f:_r},6:{n:"PtgDiv",f:_r},7:{n:"PtgPower",f:_r},8:{n:"PtgConcat",f:_r},9:{n:"PtgLt",f:_r},10:{n:"PtgLe",f:_r},11:{n:"PtgEq",f:_r},12:{n:"PtgGe",f:_r},13:{n:"PtgGt",f:_r},14:{n:"PtgNe",f:_r},15:{n:"PtgIsect",f:_r},16:{n:"PtgUnion",f:_r},17:{n:"PtgRange",f:_r},18:{n:"PtgUplus",f:_r},19:{n:"PtgUminus",f:_r},20:{n:"PtgPercent",f:_r},21:{n:"PtgParen",f:_r},22:{n:"PtgMissArg",f:_r},23:{n:"PtgStr",f:pC},26:{n:"PtgSheet",f:zC},27:{n:"PtgEndSheet",f:BC},28:{n:"PtgErr",f:cC},29:{n:"PtgBool",f:fC},30:{n:"PtgInt",f:uC},31:{n:"PtgNum",f:dC},32:{n:"PtgArray",f:KT},33:{n:"PtgFunc",f:aC},34:{n:"PtgFuncVar",f:sC},35:{n:"PtgName",f:gC},36:{n:"PtgRef",f:tC},37:{n:"PtgArea",f:UT},38:{n:"PtgMemArea",f:wC},39:{n:"PtgMemErr",f:EC},40:{n:"PtgMemNoMem",f:SC},41:{n:"PtgMemFunc",f:kC},42:{n:"PtgRefErr",f:_C},43:{n:"PtgAreaErr",f:$T},44:{n:"PtgRefN",f:rC},45:{n:"PtgAreaN",f:VT},46:{n:"PtgMemAreaN",f:WC},47:{n:"PtgMemNoMemN",f:UC},57:{n:"PtgNameX",f:vC},58:{n:"PtgRef3d",f:nC},59:{n:"PtgArea3d",f:HT},60:{n:"PtgRefErr3d",f:bC},61:{n:"PtgAreaErr3d",f:YT},255:{}},$C={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YC={1:{n:"PtgElfLel",f:oy},2:{n:"PtgElfRw",f:RC},3:{n:"PtgElfCol",f:CC},6:{n:"PtgElfRwV",f:MC},7:{n:"PtgElfColV",f:FC},10:{n:"PtgElfRadical",f:AC},11:{n:"PtgElfRadicalS",f:PC},13:{n:"PtgElfColS",f:DC},15:{n:"PtgElfColSV",f:NC},16:{n:"PtgElfRadicalLel",f:OC},25:{n:"PtgList",f:jC},29:{n:"PtgSxName",f:LC},255:{}},VC={0:{n:"PtgAttrNoop",f:HC},1:{n:"PtgAttrSemi",f:ZT},2:{n:"PtgAttrIf",f:QT},4:{n:"PtgAttrChoose",f:GT},8:{n:"PtgAttrGoto",f:XT},16:{n:"PtgAttrSum",f:iC},32:{n:"PtgAttrBaxcel",f:Tg},33:{n:"PtgAttrBaxcel",f:Tg},64:{n:"PtgAttrSpace",f:JT},65:{n:"PtgAttrSpaceSemi",f:eC},128:{n:"PtgAttrIfError",f:qT},255:{}};function Rl(e,n,t,r){if(r.biff<8)return Jr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=xC(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=mC(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(Jr(e,n)),o}function Ml(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Cg[o]||Cg[$C[o]],(o===24||o===25)&&(a=(o===24?YC:VC)[e[e.l+1]]),!a||!a.f?Jr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function KC(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var GC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XC(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function iy(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Dg(e,n,t){var r=iy(e,n,t);return r=="#REF"?r:XC(r,t)}function Xr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,h,p,x=0,g=0,y,k="";if(!e[0]||!e[0][0])return"";for(var w=-1,_="",E=0,A=e[0].length;E<A;++E){var T=e[0][E];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),w>=0){switch(e[0][w][1][0]){case 0:_=fr(" ",e[0][w][1][1]);break;case 1:_=fr("\r",e[0][w][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}h=h+_,w=-1}c.push(h+GC[T[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=cl(T[1][1],l,a),c.push(ul(p,o));break;case"PtgRefN":p=t?cl(T[1][1],t,a):T[1][1],c.push(ul(p,o));break;case"PtgRef3d":x=T[1][1],p=cl(T[1][2],l,a),k=Dg(r,x,a),c.push(k+"!"+ul(p,o));break;case"PtgFunc":case"PtgFuncVar":var j=T[1][0],ee=T[1][1];j||(j=0),j&=127;var R=j==0?[]:c.slice(-j);c.length-=j,ee==="User"&&(ee=R.shift()),c.push(ee+"("+R.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":y=lg(T[1][1],t?{s:t}:l,a),c.push(ed(y,a));break;case"PtgArea":y=lg(T[1][1],l,a),c.push(ed(y,a));break;case"PtgArea3d":x=T[1][1],y=T[1][2],k=Dg(r,x,a),c.push(k+"!"+ed(y,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=T[1][2];var C=(r.names||[])[g-1]||(r[0]||[])[g],Q=C?C.Name:"SH33TJSNAME"+String(g);Q&&Q.slice(0,6)=="_xlfn."&&!a.xlfn&&(Q=Q.slice(6)),c.push(Q);break;case"PtgNameX":var M=T[1][1];g=T[1][2];var te;if(a.biff<=5)M<0&&(M=-M),r[M]&&(te=r[M][g]);else{var K="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][g]&&r[M][g].itab>0&&(K=r.SheetNames[r[M][g].itab-1]+"!"):K=r.SheetNames[g-1]+"!"),r[M]&&r[M][g])K+=r[M][g].Name;else if(r[0]&&r[0][g])K+=r[0][g].Name;else{var B=(iy(r,M,a)||"").split(";;");B[g-1]?K=B[g-1]:K+="SH33TJSERRX"}c.push(K);break}te||(te={Name:"SH33TJSERRY"}),c.push(te.Name);break;case"PtgParen":var fe="(",ue=")";if(w>=0){switch(_="",e[0][w][1][0]){case 2:fe=fr(" ",e[0][w][1][1])+fe;break;case 3:fe=fr("\r",e[0][w][1][1])+fe;break;case 4:ue=fr(" ",e[0][w][1][1])+ue;break;case 5:ue=fr("\r",e[0][w][1][1])+ue;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}c.push(fe+c.pop()+ue);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:T[1][1],r:T[1][0]};var oe={c:t.c,r:t.r};if(r.sharedf[vt(p)]){var he=r.sharedf[vt(p)];c.push(Xr(he,l,oe,r,a))}else{var V=!1;for(f=0;f!=r.arrayf.length;++f)if(h=r.arrayf[f],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Xr(h[1],l,oe,r,a)),V=!0;break}V||c.push(T[1])}break;case"PtgArray":c.push("{"+KC(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&le.indexOf(e[0][E][0])==-1){T=e[0][w];var J=!0;switch(T[1][0]){case 4:J=!1;case 0:_=fr(" ",T[1][1]);break;case 5:J=!1;case 1:_=fr("\r",T[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((J?_:"")+c.pop()+(J?"":_)),w=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function QC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function qC(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=Ml(e,l,t);return n!==l+a&&(o=Rl(e,n-l-a,c,t)),e.l=r,[c,o]}function ZC(e,n,t,r){var a=e.l+n,o=Ml(e,r,t),l;return a!==e.l&&(l=Rl(e,a-e.l,o,t)),[o,l]}function JC(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=Ml(e,o,t);return o==65535?[[],Jr(e,n-2)]:(n!==o+2&&(a=Rl(e,r-o-2,l,t)),[l,a])}function eD(e){var n;if(za(e,e.l+6)!==65535)return[Qr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function nd(e,n,t){var r=e.l+n,a=Ca(e);t.biff==2&&++e.l;var o=eD(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=qC(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function qu(e,n,t){var r=e.read_shift(4),a=Ml(e,r,t),o=e.read_shift(4),l=o>0?Rl(e,o,a,t):null;return[a,l]}var tD=qu,Zu=qu,rD=qu,nD=qu,aD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ly={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ng(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ad(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var hl={},Jo={};function ml(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function cy(e,n,t,r,a,o){try{r.cellNF&&(e.z=kt[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ir(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(kt[n]==null&&eo(o_[n]||"General",n),e.t==="e")e.w=e.w||vo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v);else if(e.t==="d"){var l=dn(e.v);(l|0)===l?e.w=l.toString(10):e.w=yl(l)}else{if(e.v===void 0)return"";e.w=oo(e.v,Jo)}else e.t==="d"?e.w=Un(n,dn(e.v),Jo):e.w=Un(n,e.v,Jo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Du(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Du(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function oD(e,n){var t=dr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=At(t))}var iD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,lD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cD=/<(?:\w:)?hyperlink [^>]*>/mg,uD=/"(\w*:\w*)"/,fD=/<(?:\w:)?col\b[^>]*[\/]?>/g,dD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pD=/<(?:\w:)?pageMargins[^>]*\/>/g,uy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xD(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",x=e.match(lD);x?(h=e.slice(0,x.index),p=e.slice(x.index+x[0].length)):h=p=e;var g=h.match(uy);g?_p(g[0],c,a,t):(g=h.match(hD))&&gD(g[0],g[1]||"",c,a,t);var y=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var k=h.slice(y,y+50).match(uD);k&&oD(c,k[1])}var w=h.match(mD);w&&w[1]&&bD(w[1],a);var _=[];if(n.cellStyles){var E=h.match(fD);E&&wD(_,E)}x&&ED(x[1],c,n,f,o,l);var A=p.match(dD);A&&(c["!autofilter"]=kD(A[0]));var T=[],j=p.match(iD);if(j)for(y=0;y!=j.length;++y)T[y]=dr(j[y].slice(j[y].indexOf('"')+1));var ee=p.match(cD);ee&&vD(c,ee,r);var R=p.match(pD);if(R&&(c["!margins"]=yD(mt(R[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=At(f)),n.sheetRows>0&&c["!ref"]){var C=dr(c["!ref"]);n.sheetRows<=+C.e.r&&(C.e.r=n.sheetRows-1,C.e.r>f.e.r&&(C.e.r=f.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>f.e.c&&(C.e.c=f.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),c["!fullref"]=c["!ref"],c["!ref"]=At(C))}return _.length>0&&(c["!cols"]=_),T.length>0&&(c["!merges"]=T),c}function _p(e,n,t,r){var a=mt(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=Mt(Zt(a.codeName)))}function gD(e,n,t,r,a){_p(e.slice(0,e.indexOf(">")),t,r,a)}function vD(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=mt(Zt(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Mt(o.location))):(o.Target="#"+Mt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=dr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var h=c.s.c;h<=c.e.c;++h){var p=vt({c:h,r:f});r?(e[f]||(e[f]=[]),e[f][h]||(e[f][h]={t:"z",v:void 0}),e[f][h].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function yD(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function wD(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=mt(n[r],!0);a.hidden&&(a.hidden=nr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,wp(a.width)),si(a);o<=l;)e[o++]=Ur(a)}}function kD(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var _D=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bD(e,n){n.Views||(n.Views=[{}]),(e.match(_D)||[]).forEach(function(t,r){var a=mt(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),nr(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var ED=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=wl("v"),l=wl("f");return function(f,h,p,x,g,y){for(var k=0,w="",_=[],E=[],A=0,T=0,j=0,ee="",R,C,Q=0,M=0,te,K,B=0,fe=0,ue=Array.isArray(y.CellXf),oe,he=[],V=[],le=Array.isArray(h),J=[],ae={},W=!1,S=!!p.sheetStubs,P=f.split(n),O=0,z=P.length;O!=z;++O){w=P[O].trim();var H=w.length;if(H!==0){var re=0;e:for(k=0;k<H;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(p&&p.cellStyles){if(C=mt(w.slice(re,k),!0),Q=C.r!=null?parseInt(C.r,10):Q+1,M=-1,p.sheetRows&&p.sheetRows<Q)continue;ae={},W=!1,C.ht&&(W=!0,ae.hpt=parseFloat(C.ht),ae.hpx=El(ae.hpt)),C.hidden=="1"&&(W=!0,ae.hidden=!0),C.outlineLevel!=null&&(W=!0,ae.level=+C.outlineLevel),W&&(J[Q-1]=ae)}break;case"<":re=k;break}if(re>=k)break;if(C=mt(w.slice(re,k),!0),Q=C.r!=null?parseInt(C.r,10):Q+1,M=-1,!(p.sheetRows&&p.sheetRows<Q)){x.s.r>Q-1&&(x.s.r=Q-1),x.e.r<Q-1&&(x.e.r=Q-1),p&&p.cellStyles&&(ae={},W=!1,C.ht&&(W=!0,ae.hpt=parseFloat(C.ht),ae.hpx=El(ae.hpt)),C.hidden=="1"&&(W=!0,ae.hidden=!0),C.outlineLevel!=null&&(W=!0,ae.level=+C.outlineLevel),W&&(J[Q-1]=ae)),_=w.slice(k).split(e);for(var ie=0;ie!=_.length&&_[ie].trim().charAt(0)=="<";++ie);for(_=_.slice(ie),k=0;k!=_.length;++k)if(w=_[k].trim(),w.length!==0){if(E=w.match(t),A=k,T=0,j=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,E!=null&&E.length===2){for(A=0,ee=E[1],T=0;T!=ee.length&&!((j=ee.charCodeAt(T)-64)<1||j>26);++T)A=26*A+j;--A,M=A}else++M;for(T=0;T!=w.length&&w.charCodeAt(T)!==62;++T);if(++T,C=mt(w.slice(0,T),!0),C.r||(C.r=vt({r:Q-1,c:M})),ee=w.slice(T),R={t:""},(E=ee.match(o))!=null&&E[1]!==""&&(R.v=Mt(E[1])),p.cellFormula){if((E=ee.match(l))!=null&&E[1]!==""){if(R.f=Mt(Zt(E[1])).replace(/\r\n/g,`
`),p.xlfn||(R.f=Sg(R.f)),E[0].indexOf('t="array"')>-1)R.F=(ee.match(a)||[])[1],R.F.indexOf(":")>-1&&he.push([dr(R.F),R.F]);else if(E[0].indexOf('t="shared"')>-1){K=mt(E[0]);var Z=Mt(Zt(E[1]));p.xlfn||(Z=Sg(Z)),V[parseInt(K.si,10)]=[K,Z,C.r]}}else(E=ee.match(/<f[^>]*\/>/))&&(K=mt(E[0]),V[K.si]&&(R.f=MT(V[K.si][1],V[K.si][2],C.r)));var ge=ln(C.r);for(T=0;T<he.length;++T)ge.r>=he[T][0].s.r&&ge.r<=he[T][0].e.r&&ge.c>=he[T][0].s.c&&ge.c<=he[T][0].e.c&&(R.F=he[T][1])}if(C.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(S)R.t="z";else continue;else R.t=C.t||"n";switch(x.s.c>M&&(x.s.c=M),x.e.c<M&&(x.e.c=M),R.t){case"n":if(R.v==""||R.v==null){if(!S)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!S)continue;R.t="z"}else te=hl[parseInt(R.v,10)],R.v=te.t,R.r=te.r,p.cellHTML&&(R.h=te.h);break;case"str":R.t="s",R.v=R.v!=null?Zt(R.v):"",p.cellHTML&&(R.h=cp(R.v));break;case"inlineStr":E=ee.match(r),R.t="s",E!=null&&(te=yp(E[1]))?(R.v=te.t,p.cellHTML&&(R.h=te.h)):R.v="";break;case"b":R.v=nr(R.v);break;case"d":p.cellDates?R.v=Ir(R.v,1):(R.v=dn(Ir(R.v,1)),R.t="n");break;case"e":(!p||p.cellText!==!1)&&(R.w=R.v),R.v=A1[R.v];break}if(B=fe=0,oe=null,ue&&C.s!==void 0&&(oe=y.CellXf[C.s],oe!=null&&(oe.numFmtId!=null&&(B=oe.numFmtId),p.cellStyles&&oe.fillId!=null&&(fe=oe.fillId))),cy(R,B,fe,p,g,y),p.cellDates&&ue&&R.t=="n"&&di(kt[B])&&(R.t="d",R.v=Xu(R.v)),C.cm&&p.xlmeta){var xe=(p.xlmeta.Cell||[])[+C.cm-1];xe&&xe.type=="XLDAPR"&&(R.D=!0)}if(le){var L=ln(C.r);h[L.r]||(h[L.r]=[]),h[L.r][L.c]=R}else h[C.r]=R}}}}J.length>0&&(h["!rows"]=J)}})();function SD(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var TD=go;function CD(){}function DD(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=Q_(e),t}function ND(e){var n=$n(e);return[n]}function FD(e){var n=xo(e);return[n]}function AD(e){var n=$n(e),t=e.read_shift(1);return[n,t,"b"]}function OD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"b"]}function PD(e){var n=$n(e),t=e.read_shift(1);return[n,t,"e"]}function RD(e){var n=xo(e),t=e.read_shift(1);return[n,t,"e"]}function MD(e){var n=$n(e),t=e.read_shift(4);return[n,t,"s"]}function ID(e){var n=xo(e),t=e.read_shift(4);return[n,t,"s"]}function jD(e){var n=$n(e),t=Qr(e);return[n,t,"n"]}function fy(e){var n=xo(e),t=Qr(e);return[n,t,"n"]}function LD(e){var n=$n(e),t=xp(e);return[n,t,"n"]}function zD(e){var n=xo(e),t=xp(e);return[n,t,"n"]}function BD(e){var n=$n(e),t=hp(e);return[n,t,"is"]}function WD(e){var n=$n(e),t=Zr(e);return[n,t,"str"]}function UD(e){var n=xo(e),t=Zr(e);return[n,t,"str"]}function HD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}function $D(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}function YD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=Qr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}function VD(e,n,t){var r=e.l+n,a=$n(e);a.r=t["!row"];var o=Zr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=Zu(e,r-e.l,t);l[3]=Xr(c,null,a,t.supbooks,t)}else e.l=r;return l}var KD=go;function GD(e,n){var t=e.l+n,r=go(e),a=mp(e),o=Zr(e),l=Zr(e),c=Zr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function XD(){}function QD(e,n,t){var r=e.l+n,a=D1(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=tD(e,r-e.l,t);l[1]=c}else e.l=r;return l}function qD(e,n,t){var r=e.l+n,a=go(e),o=[a];if(t.cellFormula){var l=nD(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var ZD=["left","right","top","bottom","header","footer"];function JD(e){var n={};return ZD.forEach(function(t){n[t]=Qr(e)}),n}function eN(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function tN(){}function rN(){}function nN(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,g=!1,y,k,w,_,E,A,T,j,ee,R=[];c.biff=12,c["!row"]=0;var C=0,Q=!1,M=[],te={},K=c.supbooks||a.supbooks||[[]];if(K.sharedf=te,K.arrayf=M,K.SheetNames=a.SheetNames||a.Sheets.map(function(le){return le.name}),!c.supbooks&&(c.supbooks=K,a.Names))for(var B=0;B<a.Names.length;++B)K[0][B+1]=a.Names[B];var fe=[],ue=[],oe=!1;Au[16]={n:"BrtShortReal",f:fy};var he;if(Xa(e,function(J,ae,W){if(!g)switch(W){case 148:h=J;break;case 0:y=J,c.sheetRows&&c.sheetRows<=y.r&&(g=!0),j=Hr(_=y.r),c["!row"]=y.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=El(J.hpt)),ue[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:J[2]},J[2]){case"n":k.v=J[1];break;case"s":T=hl[J[1]],k.v=T.t,k.r=T.r;break;case"b":k.v=!!J[1];break;case"e":k.v=J[1],c.cellText!==!1&&(k.w=vo[k.v]);break;case"str":k.t="s",k.v=J[1];break;case"is":k.t="s",k.v=J[1].t;break}if((w=l.CellXf[J[0].iStyleRef])&&cy(k,w.numFmtId,null,c,o,l),E=J[0].c==-1?E+1:J[0].c,c.dense?(f[_]||(f[_]=[]),f[_][E]=k):f[Dr(E)+j]=k,c.cellFormula){for(Q=!1,C=0;C<M.length;++C){var S=M[C];y.r>=S[0].s.r&&y.r<=S[0].e.r&&E>=S[0].s.c&&E<=S[0].e.c&&(k.F=At(S[0]),Q=!0)}!Q&&J.length>3&&(k.f=J[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>E&&(p.s.c=E),p.e.r<y.r&&(p.e.r=y.r),p.e.c<E&&(p.e.c=E),c.cellDates&&w&&k.t=="n"&&di(kt[w.numFmtId])){var P=Qs(k.v);P&&(k.t="d",k.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}he&&(he.type=="XLDAPR"&&(k.D=!0),he=void 0);break;case 1:case 12:if(!c.sheetStubs||x)break;k={t:"z",v:void 0},E=J[0].c==-1?E+1:J[0].c,c.dense?(f[_]||(f[_]=[]),f[_][E]=k):f[Dr(E)+j]=k,p.s.r>y.r&&(p.s.r=y.r),p.s.c>E&&(p.s.c=E),p.e.r<y.r&&(p.e.r=y.r),p.e.c<E&&(p.e.c=E),he&&(he.type=="XLDAPR"&&(k.D=!0),he=void 0);break;case 176:R.push(J);break;case 49:he=((c.xlmeta||{}).Cell||[])[J-1];break;case 494:var O=r["!id"][J.relId];for(O?(J.Target=O.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=O):J.relId==""&&(J.Target="#"+J.loc),_=J.rfx.s.r;_<=J.rfx.e.r;++_)for(E=J.rfx.s.c;E<=J.rfx.e.c;++E)c.dense?(f[_]||(f[_]=[]),f[_][E]||(f[_][E]={t:"z",v:void 0}),f[_][E].l=J):(A=vt({c:E,r:_}),f[A]||(f[A]={t:"z",v:void 0}),f[A].l=J);break;case 426:if(!c.cellFormula)break;M.push(J),ee=c.dense?f[_][E]:f[Dr(E)+j],ee.f=Xr(J[1],p,{r:y.r,c:E},K,c),ee.F=At(J[0]);break;case 427:if(!c.cellFormula)break;te[vt(J[0].s)]=J[1],ee=c.dense?f[_][E]:f[Dr(E)+j],ee.f=Xr(J[1],p,{r:y.r,c:E},K,c);break;case 60:if(!c.cellStyles)break;for(;J.e>=J.s;)fe[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},oe||(oe=!0,wp(J.w/256)),si(fe[J.e+1]);break;case 161:f["!autofilter"]={ref:At(J)};break;case 476:f["!margins"]=J;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),J.name&&(a.Sheets[t].CodeName=J.name),(J.above||J.left)&&(f["!outline"]={above:J.above,left:J.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),J.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!ae.T){if(!x||c.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=At(h||p)),c.sheetRows&&f["!ref"]){var V=dr(f["!ref"]);c.sheetRows<=+V.e.r&&(V.e.r=c.sheetRows-1,V.e.r>p.e.r&&(V.e.r=p.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>p.e.c&&(V.e.c=p.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),f["!fullref"]=f["!ref"],f["!ref"]=At(V))}return R.length>0&&(f["!merges"]=R),fe.length>0&&(f["!cols"]=fe),ue.length>0&&(f["!rows"]=ue),f}function aN(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=Mt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function sN(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var g=aN(x);p.s.r=p.s.c=0,p.e.c=c,h=Dr(c),g[0].forEach(function(y,k){l[h+Hr(k)]={t:"n",v:y,z:g[1]},f=k}),p.e.r<f&&(p.e.r=f),++c}),c>0&&(l["!ref"]=At(p)),l}function oN(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(uy);return c&&_p(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function iN(e,n){e.l+=10;var t=Zr(e);return{name:t}}function lN(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Xa(e,function(f,h,p){switch(p){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var dy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uN=[],fN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Fg(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=nr(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Ag(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=nr(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function py(e){Ag(e.WBProps,dy),Ag(e.CalcPr,fN),Fg(e.WBView,cN),Fg(e.Sheets,uN),Jo.date1904=nr(e.WBProps.date1904)}var dN="][*?/\\".split("");function pN(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return dN.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var hN=/<\w+:workbook/;function mN(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(en,function(f,h){var p=mt(f);switch(Ta(p[0])){case"<?xml":break;case"<workbook":f.match(hN)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dy.forEach(function(x){if(p[x[0]]!=null)switch(x[2]){case"bool":t.WBProps[x[0]]=nr(p[x[0]]);break;case"int":t.WBProps[x[0]]=parseInt(p[x[0]],10);break;default:t.WBProps[x[0]]=p[x[0]]}}),p.codeName&&(t.WBProps.CodeName=Zt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Mt(Zt(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=Zt(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),nr(p.hidden||"0")&&(o.Hidden=!0),l=h+f.length;break;case"</definedName>":o.Ref=Mt(Zt(e.slice(l,h))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),P_.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return py(t),t}function xN(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Td(e),t.name=Zr(e),t}function gN(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?Zr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function vN(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function yN(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=q_(e),l=rD(e,0,t),c=mp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function wN(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Au[16]={n:"BrtFRTArchID$",f:vN},Xa(e,function(f,h,p){switch(p){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Xr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(p),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},n),py(t),t.Names=o,t.supbooks=l,t}function kN(e,n,t){return n.slice(-4)===".bin"?wN(e,t):mN(e,t)}function _N(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?nN(e,r,t,a,o,l,c):xD(e,r,t,a,o,l,c)}function bN(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?lN(e,r,t,a,o):oN(e,r,t,a,o)}function EN(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?OT():PT()}function SN(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?FT():AT()}function TN(e,n,t,r){return n.slice(-4)===".bin"?KS(e,t,r):WS(e,t,r)}function CN(e,n,t){return J1(e,t)}function DN(e,n,t){return n.slice(-4)===".bin"?cS(e,t):iS(e,t)}function NN(e,n,t){return n.slice(-4)===".bin"?CT(e,t):_T(e,t)}function FN(e,n,t){return n.slice(-4)===".bin"?yT(e):gT(e)}function AN(e,n,t,r){return t.slice(-4)===".bin"?wT(e,n,t,r):void 0}function ON(e,n,t){return n.slice(-4)===".bin"?mT(e,n,t):xT(e,n,t)}var hy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,my=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zn(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(hy),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(my),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function PN(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(hy),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(my),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var xl;function RN(e,n){var t=xl[e]||Mt(e);return t==="General"?oo(n):Un(t,n)}function MN(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=nr(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Ir(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Mt(n)]=a}function IN(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=RN(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=xl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&di(r)){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function jN(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=MS[r.Pattern]||r.Pattern)}e[n.ID]=n}function LN(e,n,t,r,a,o,l,c,f,h){var p="General",x=r.StyleID,g={};h=h||{};var y=[],k=0;for(x===void 0&&c&&(x=c.StyleID),x===void 0&&l&&(x=l.StyleID);o[x]!==void 0&&(o[x].nf&&(p=o[x].nf),o[x].Interior&&y.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=nr(e);break;case"String":r.t="s",r.r=Jx(Mt(e)),r.v=e.indexOf("<")>-1?Mt(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Ir(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Mt(e):r.v<60&&(r.v=r.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=A1[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=Jx(n||e));break}if(IN(r,p,h),h.cellFormula!==!1)if(r.Formula){var w=Mt(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=Zo(w,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Zo("RC:RC",a):r.ArrayRange&&(r.F=Zo(r.ArrayRange,a),f.push([dr(r.F),r.F]))}else for(k=0;k<f.length;++k)a.r>=f[k][0].s.r&&a.r<=f[k][0].e.r&&a.c>=f[k][0].s.c&&a.c<=f[k][0].e.c&&(r.F=f[k][1]);h.cellStyles&&(y.forEach(function(_){!g.patternType&&_.patternType&&(g.patternType=_.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function zN(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sd(e,n){var t=n||{};n1();var r=rl(up(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Zt(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Ur(t);return l.type="string",_l.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(De){a.indexOf("<"+De)>=0&&(o=!0)}),o)return GN(r,t);xl={"General Number":"General","General Date":kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kt[15],"Short Date":kt[14],"Long Time":kt[19],"Medium Time":kt[18],"Short Time":kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kt[2],Standard:kt[4],Percent:kt[10],Scientific:kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],h,p={},x=[],g=t.dense?[]:{},y="",k={},w={},_=Zn('<Data ss:Type="String">'),E=0,A=0,T=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},ee={},R={},C="",Q=0,M=[],te={},K={},B=0,fe=[],ue=[],oe={},he=[],V,le=!1,J=[],ae=[],W={},S=0,P=0,O={Sheets:[],WBProps:{date1904:!1}},z={};kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var H="";c=kl.exec(r);)switch(c[3]=(H=c[3]).toLowerCase()){case"data":if(H=="data"){if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?LN(r.slice(E,c.index),C,_,f[f.length-1][0]=="comment"?oe:k,{c:A,r:T},ee,he[A],w,J,t):(C="",_=Zn(c[0]),E=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ue.length>0&&(k.c=ue),(!t.sheetRows||t.sheetRows>T)&&k.v!==void 0&&(t.dense?(g[T]||(g[T]=[]),g[T][A]=k):g[Dr(A)+Hr(T)]=k),k.HRef&&(k.l={Target:Mt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(S=A+(parseInt(k.MergeAcross,10)|0),P=T+(parseInt(k.MergeDown,10)|0),M.push({s:{c:A,r:T},e:{c:S,r:P}})),!t.sheetStubs)k.MergeAcross?A=S+1:++A;else if(k.MergeAcross||k.MergeDown){for(var re=A;re<=S;++re)for(var ie=T;ie<=P;++ie)(re>A||ie>T)&&(t.dense?(g[ie]||(g[ie]=[]),g[ie][re]={t:"z"}):g[Dr(re)+Hr(ie)]={t:"z"});A=S+1}else++A;else k=PN(c[0]),k.Index&&(A=+k.Index-1),A<j.s.c&&(j.s.c=A),A>j.e.c&&(j.e.c=A),c[0].slice(-2)==="/>"&&++A,ue=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(T<j.s.r&&(j.s.r=T),T>j.e.r&&(j.e.r=T),c[0].slice(-2)==="/>"&&(w=Zn(c[0]),w.Index&&(T=+w.Index-1)),A=0,++T):(w=Zn(c[0]),w.Index&&(T=+w.Index-1),W={},(w.AutoFitHeight=="0"||w.Height)&&(W.hpx=parseInt(w.Height,10),W.hpt=Z1(W.hpx),ae[T]=W),w.Hidden=="1"&&(W.hidden=!0,ae[T]=W));break;case"worksheet":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));x.push(y),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(g["!ref"]=At(j),t.sheetRows&&t.sheetRows<=j.e.r&&(g["!fullref"]=g["!ref"],j.e.r=t.sheetRows-1,g["!ref"]=At(j))),M.length&&(g["!merges"]=M),he.length>0&&(g["!cols"]=he),ae.length>0&&(g["!rows"]=ae),p[y]=g}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=A=0,f.push([c[3],!1]),h=Zn(c[0]),y=Mt(h.Name),g=t.dense?[]:{},M=[],J=[],ae=[],z={name:y,Hidden:0},O.Sheets.push(z);break;case"table":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),he=[],le=!1}break;case"style":c[1]==="/"?jN(ee,R,t):R=Zn(c[0]);break;case"numberformat":R.nf=Mt(Zn(c[0]).Format||"General"),xl[R.nf]&&(R.nf=xl[R.nf]);for(var Z=0;Z!=392&&kt[Z]!=R.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(kt[Z]==null){eo(R.nf,Z);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(V=Zn(c[0]),V.Hidden&&(V.hidden=!0,delete V.Hidden),V.Width&&(V.wpx=parseInt(V.Width,10)),!le&&V.wpx>10){le=!0,sn=Q1;for(var ge=0;ge<he.length;++ge)he[ge]&&si(he[ge])}le&&si(V),he[V.Index-1||he.length]=V;for(var xe=0;xe<+V.Span;++xe)he[he.length]=Ur(V);break;case"namedrange":if(c[1]==="/")break;O.Names||(O.Names=[]);var L=mt(c[0]),Ve={Name:L.Name,Ref:Zo(L.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(Ve.Sheet=O.Sheets.length-1),O.Names.push(Ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?C+=r.slice(Q,c.index):Q=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;R.Interior=Zn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?_b(te,H,r.slice(B,c.index)):B=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));zN(oe),ue.push(oe)}else f.push([c[3],!1]),h=Zn(c[0]),oe={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Te=Zn(c[0]);g["!autofilter"]={ref:Zo(Te.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return jg(r,t);var st=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:st=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:st=!1}break;case"excelworkbook":switch(c[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:st=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:st=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(B,c.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else B=c.index+c[0].length;break;case"header":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+mt(c[0]).Margin)||(g["!margins"].header=+mt(c[0]).Margin);break;case"footer":g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+mt(c[0]).Margin)||(g["!margins"].footer=+mt(c[0]).Margin);break;case"pagemargins":var Ge=mt(c[0]);g["!margins"]||ml(g["!margins"]={},"xlml"),isNaN(+Ge.Top)||(g["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(g["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(g["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(g["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:st=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:st=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:st=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:st=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:st=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:st=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:st=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:st=!1}break;case"smarttags":break;default:st=!1;break}if(st||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?MN(K,H,fe,r.slice(B,c.index)):(fe=c,B=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var de={};return!t.bookSheets&&!t.bookProps&&(de.Sheets=p),de.SheetNames=x,de.Workbook=O,de.SSF=Ur(kt),de.Props=te,de.Custprops=K,de}function Fd(e,n){switch(Sp(n=n||{}),n.type||"base64"){case"base64":return sd(Cn(e),n);case"binary":case"buffer":case"file":return sd(e,n);case"array":return sd(mo(e),n)}}function BN(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=eb(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=tb(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var WN=[60,1084,2066,2165,2175];function UN(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=za(t,t.l),h=Ad[f],p=0;h!=null&&WN.indexOf(f)>-1;)o=za(t,t.l+2),p=t.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),c=t.slice(p,t.l+4+o),l.push(c),t.l+=4+o,h=Ad[f=za(t,t.l)];var x=ys(l);Br(x,0);var g=0;x.lens=[];for(var y=0;y<l.length;++y)x.lens.push(g),g+=l[y].length;if(x.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+r;return n.f(x,x.length,a)}function pa(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=kt[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yl(e.v):e.w=oo(e.v):e.w=Un(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&di(kt[r]||String(r))){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function au(e,n,t){return{v:e,ixfe:n,t}}function HN(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],h="",p={},x,g="",y,k,w,_,E={},A=[],T,j,ee=[],R=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Q={},M=function(ot){return ot<8?to[ot]:ot<64&&R[ot-8]||to[ot]},te=function(ot,St,Qt){var Et=St.XF.data;if(!(!Et||!Et.patternType||!Qt||!Qt.cellStyles)){St.s={},St.s.patternType=Et.patternType;var zt;(zt=bl(M(Et.icvFore)))&&(St.s.fgColor={rgb:zt}),(zt=bl(M(Et.icvBack)))&&(St.s.bgColor={rgb:zt})}},K=function(ot,St,Qt){if(!(W>1)&&!(Qt.sheetRows&&ot.r>=Qt.sheetRows)){if(Qt.cellStyles&&St.XF&&St.XF.data&&te(ot,St,Qt),delete St.ixfe,delete St.XF,x=ot,g=vt(ot),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<l.s.r&&(l.s.r=ot.r),ot.c<l.s.c&&(l.s.c=ot.c),ot.r+1>l.e.r&&(l.e.r=ot.r+1),ot.c+1>l.e.c&&(l.e.c=ot.c+1),Qt.cellFormula&&St.f){for(var Et=0;Et<A.length;++Et)if(!(A[Et][0].s.c>ot.c||A[Et][0].s.r>ot.r)&&!(A[Et][0].e.c<ot.c||A[Et][0].e.r<ot.r)){St.F=At(A[Et][0]),(A[Et][0].s.c!=ot.c||A[Et][0].s.r!=ot.r)&&delete St.f,St.f&&(St.f=""+Xr(A[Et][1],l,ot,J,B));break}}Qt.dense?(a[ot.r]||(a[ot.r]=[]),a[ot.r][ot.c]=St):a[g]=St}},B={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(B.password=n.password);var fe,ue=[],oe=[],he=[],V=[],le=!1,J=[];J.SheetNames=B.snames,J.sharedf=B.sharedf,J.arrayf=B.arrayf,J.names=[],J.XTI=[];var ae=0,W=0,S=0,P=[],O=[],z;B.codepage=1200,ta(1200);for(var H=!1;e.l<e.length-1;){var re=e.l,ie=e.read_shift(2);if(ie===0&&ae===10)break;var Z=e.l===e.length?0:e.read_shift(2),ge=Ad[ie];if(ge&&ge.f){if(n.bookSheets&&ae===133&&ie!==133)break;if(ae=ie,ge.r===2||ge.r==12){var xe=e.read_shift(2);if(Z-=2,!B.enc&&xe!==ie&&((xe&255)<<8|xe>>8)!==ie)throw new Error("rt mismatch: "+xe+"!="+ie);ge.r==12&&(e.l+=10,Z-=10)}var L={};if(ie===10?L=ge.f(e,Z,B):L=UN(ie,ge,e,Z,B),W==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(ie){case 34:t.opts.Date1904=C.WBProps.date1904=L;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=L,!n.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=L;break;case 66:var Ve=Number(L);switch(Ve){case 21010:Ve=1200;break;case 32768:Ve=1e4;break;case 32769:Ve=1252;break}ta(B.codepage=Ve),H=!0;break;case 317:B.rrtabid=L;break;case 25:B.winlocked=L;break;case 439:t.opts.RefreshAll=L;break;case 12:t.opts.CalcCount=L;break;case 16:t.opts.CalcDelta=L;break;case 17:t.opts.CalcIter=L;break;case 13:t.opts.CalcMode=L;break;case 14:t.opts.CalcPrecision=L;break;case 95:t.opts.CalcSaveRecalc=L;break;case 15:B.CalcRefMode=L;break;case 2211:t.opts.FullCalc=L;break;case 129:L.fDialog&&(a["!type"]="dialog"),L.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),L.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:ee.push(L);break;case 430:J.push([L]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(L);break;case 24:case 536:z={Name:L.Name,Ref:Xr(L.rgce,l,null,J,B)},L.itab>0&&(z.Sheet=L.itab-1),J.names.push(z),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(O[L.itab-1]={ref:At(L.rgce[0][0][1][2])});break;case 22:B.ExternCount=L;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(L),J.XTI=J.XTI.concat(L);break;case 2196:if(B.biff<8)break;z!=null&&(z.Comment=L[1]);break;case 18:a["!protect"]=L;break;case 19:L!==0&&B.WTF&&console.error("Password verifier: "+L);break;case 133:o[L.pos]=L,B.snames.push(L.name);break;case 10:{if(--W)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=At(l),n.sheetRows&&n.sheetRows<=l.e.r){var Te=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=At(l),l.e.r=Te}l.e.r++,l.e.c++}ue.length>0&&(a["!merges"]=ue),oe.length>0&&(a["!objects"]=oe),he.length>0&&(a["!cols"]=he),V.length>0&&(a["!rows"]=V),C.Sheets.push(Q)}h===""?p=a:r[h]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),B.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(B.biff=5,H=!0,ta(B.codepage=28591)),B.biff==8&&L.BIFFVer==0&&L.dt==16&&(B.biff=2),W++)break;if(a=n.dense?[]:{},B.biff<8&&!H&&(H=!0,ta(B.codepage=n.codepage||1252)),B.biff<5||L.BIFFVer==0&&L.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var st={pos:e.l-Z,name:h};o[st.pos]=st,B.snames.push(h)}else h=(o[re]||{name:""}).name;L.dt==32&&(a["!type"]="chart"),L.dt==64&&(a["!type"]="macro"),ue=[],oe=[],B.arrayf=A=[],he=[],V=[],le=!1,Q={Hidden:(o[re]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[L.r]||[])[L.c]:a[vt({c:L.c,r:L.r})])&&++L.c,T={ixfe:L.ixfe,XF:ee[L.ixfe]||{},v:L.val,t:"n"},S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:L.c,r:L.r},T,n);break;case 5:case 517:T={ixfe:L.ixfe,XF:ee[L.ixfe],v:L.val,t:L.t},S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:L.c,r:L.r},T,n);break;case 638:T={ixfe:L.ixfe,XF:ee[L.ixfe],v:L.rknum,t:"n"},S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:L.c,r:L.r},T,n);break;case 189:for(var Ge=L.c;Ge<=L.C;++Ge){var de=L.rkrec[Ge-L.c][0];T={ixfe:de,XF:ee[de],v:L.rkrec[Ge-L.c][1],t:"n"},S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:Ge,r:L.r},T,n)}break;case 6:case 518:case 1030:{if(L.val=="String"){c=L;break}if(T=au(L.val,L.cell.ixfe,L.tt),T.XF=ee[T.ixfe],n.cellFormula){var De=L.formula;if(De&&De[0]&&De[0][0]&&De[0][0][0]=="PtgExp"){var Le=De[0][0][1][0],Ae=De[0][0][1][1],it=vt({r:Le,c:Ae});E[it]?T.f=""+Xr(L.formula,l,L.cell,J,B):T.F=((n.dense?(a[Le]||[])[Ae]:a[it])||{}).F}else T.f=""+Xr(L.formula,l,L.cell,J,B)}S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K(L.cell,T,n),c=L}break;case 7:case 519:if(c)c.val=L,T=au(L,c.cell.ixfe,"s"),T.XF=ee[T.ixfe],n.cellFormula&&(T.f=""+Xr(c.formula,l,c.cell,J,B)),S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K(c.cell,T,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(L);var gt=vt(L[0].s);if(y=n.dense?(a[L[0].s.r]||[])[L[0].s.c]:a[gt],n.cellFormula&&y){if(!c||!gt||!y)break;y.f=""+Xr(L[1],l,L[0],J,B),y.F=At(L[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;E[vt(c.cell)]=L[0],y=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[vt(c.cell)],(y||{}).f=""+Xr(L[0],l,x,J,B)}}break;case 253:T=au(f[L.isst].t,L.ixfe,"s"),f[L.isst].h&&(T.h=f[L.isst].h),T.XF=ee[T.ixfe],S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:L.c,r:L.r},T,n);break;case 513:n.sheetStubs&&(T={ixfe:L.ixfe,XF:ee[L.ixfe],t:"z"},S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:L.c,r:L.r},T,n));break;case 190:if(n.sheetStubs)for(var ht=L.c;ht<=L.C;++ht){var Dt=L.ixfe[ht-L.c];T={ixfe:Dt,XF:ee[Dt],t:"z"},S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:ht,r:L.r},T,n)}break;case 214:case 516:case 4:T=au(L.val,L.ixfe,"s"),T.XF=ee[T.ixfe],S>0&&(T.z=P[T.ixfe>>8&63]),pa(T,n,t.opts.Date1904),K({c:L.c,r:L.r},T,n);break;case 0:case 512:W===1&&(l=L);break;case 252:f=L;break;case 1054:if(B.biff==4){P[S++]=L[1];for(var Nt=0;Nt<S+163&&kt[Nt]!=L[1];++Nt);Nt>=163&&eo(L[1],S+163)}else eo(L[1],L[0]);break;case 30:{P[S++]=L;for(var Kt=0;Kt<S+163&&kt[Kt]!=L;++Kt);Kt>=163&&eo(L,S+163)}break;case 229:ue=ue.concat(L);break;case 93:oe[L.cmo[0]]=B.lastobj=L;break;case 438:B.lastobj.TxO=L;break;case 127:B.lastobj.ImData=L;break;case 440:for(_=L[0].s.r;_<=L[0].e.r;++_)for(w=L[0].s.c;w<=L[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[vt({c:w,r:_})],y&&(y.l=L[1]);break;case 2048:for(_=L[0].s.r;_<=L[0].e.r;++_)for(w=L[0].s.c;w<=L[0].e.c;++w)y=n.dense?(a[_]||[])[w]:a[vt({c:w,r:_})],y&&y.l&&(y.l.Tooltip=L[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;y=n.dense?(a[L[0].r]||[])[L[0].c]:a[vt(L[0])];var cr=oe[L[2]];y||(n.dense?(a[L[0].r]||(a[L[0].r]=[]),y=a[L[0].r][L[0].c]={t:"z"}):y=a[vt(L[0])]={t:"z"},l.e.r=Math.max(l.e.r,L[0].r),l.s.r=Math.min(l.s.r,L[0].r),l.e.c=Math.max(l.e.c,L[0].c),l.s.c=Math.min(l.s.c,L[0].c)),y.c||(y.c=[]),k={a:L[1],t:cr.TxO.t},y.c.push(k)}break;case 2173:fT(ee[L.ixfe],L.ext);break;case 125:{if(!B.cellStyles)break;for(;L.e>=L.s;)he[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},le||(le=!0,wp(L.w/256)),si(he[L.e+1])}break;case 520:{var Lt={};L.level!=null&&(V[L.r]=Lt,Lt.level=L.level),L.hidden&&(V[L.r]=Lt,Lt.hidden=!0),L.hpt&&(V[L.r]=Lt,Lt.hpt=L.hpt,Lt.hpx=El(L.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ml(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=L;break;case 161:a["!margins"]||ml(a["!margins"]={}),a["!margins"].header=L.header,a["!margins"].footer=L.footer;break;case 574:L.RTL&&(C.Views[0].RTL=!0);break;case 146:R=L;break;case 2198:fe=L;break;case 140:j=L;break;case 442:h?Q.CodeName=L||Q.name:C.WBProps.CodeName=L||"ThisWorkbook";break}}else ge||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=Z}return t.SheetNames=ba(o).sort(function(Xt,ot){return Number(Xt)-Number(ot)}).map(function(Xt){return o[Xt].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&O.forEach(function(Xt,ot){t.Sheets[t.SheetNames[ot]]["!autofilter"]=Xt}),t.Strings=f,t.SSF=Ur(kt),B.enc&&(t.Encryption=B.enc),fe&&(t.Themes=fe),t.Metadata={},j!==void 0&&(t.Metadata.Country=j),J.names.length>0&&(C.Names=J.names),t.Workbook=C,t}var Og={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $N(e,n,t){var r=Ft.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=mg(r,ib,Og.DSI);for(var o in a)n[o]=a[o]}catch(h){if(t.WTF)throw h}var l=Ft.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=mg(l,lb,Og.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(h){if(t.WTF)throw h}n.HeadingPairs&&n.TitlesOfParts&&(P1(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function xy(e,n){n||(n={}),Sp(n),Yv(),n.codepage&&np(n.codepage);var t,r;if(e.FullPaths){if(Ft.find(e,"/encryption"))throw new Error("File is password-protected");t=Ft.find(e,"!CompObj"),r=Ft.find(e,"/Workbook")||Ft.find(e,"/Book")}else{switch(n.type){case"base64":e=ea(Cn(e));break;case"binary":e=ea(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Br(e,0),r={content:e}}var a,o;if(t&&BN(t),n.bookProps&&!n.bookSheets)a={};else{var l=Ct?"buffer":"array";if(r&&r.content)a=HN(r.content,n);else if((o=Ft.find(e,"PerfectOffice_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else if((o=Ft.find(e,"NativeContent_MAIN"))&&o.content)a=pl.to_workbook(o.content,(n.type=l,n));else throw(o=Ft.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&Ft.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=NT(e))}var c={};return e.FullPaths&&$N(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Au={0:{f:SD},1:{f:ND},2:{f:LD},3:{f:PD},4:{f:AD},5:{f:jD},6:{f:WD},7:{f:MD},8:{f:VD},9:{f:YD},10:{f:HD},11:{f:$D},12:{f:FD},13:{f:zD},14:{f:RD},15:{f:OD},16:{f:fy},17:{f:UD},18:{f:ID},19:{f:hp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yN},40:{},42:{},43:{f:HS},44:{f:US},45:{f:$S},46:{f:VS},47:{f:YS},48:{},49:{f:K_},50:{},51:{f:pT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Y1},62:{f:BD},63:{f:vT},64:{f:tN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DD},148:{f:TD,p:16},151:{f:XD},152:{},153:{f:gN},154:{},155:{},156:{f:xN},157:{},158:{},159:{T:1,f:lS},160:{T:-1},161:{T:1,f:go},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dT},336:{T:-1},337:{f:hT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Td},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QD},427:{f:qD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:GD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Td},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:TT},633:{T:1},634:{T:-1},635:{T:1,f:ST},636:{T:-1},637:{f:X_},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ad={6:{f:nd},10:{f:gs},12:{f:Er},13:{f:Er},14:{f:gr},15:{f:gr},16:{f:Qr},17:{f:gr},18:{f:gr},19:{f:Er},20:{f:yg},21:{f:yg},23:{f:$1},24:{f:kg},25:{f:gr},26:{},27:{},28:{f:bE},29:{},34:{f:gr},35:{f:wg},38:{f:Qr},39:{f:Qr},40:{f:Qr},41:{f:Qr},42:{f:gr},43:{f:gr},47:{f:CS},49:{f:aE},51:{f:Er},60:{},61:{f:tE},64:{f:gr},65:{f:nE},66:{f:Er},77:{},80:{},81:{},82:{},85:{f:Er},89:{},90:{},91:{},92:{f:Kb},93:{f:SE},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:Y1},128:{f:hE},129:{f:Gb},130:{f:Er},131:{f:gr},132:{f:gr},133:{f:Xb},134:{},140:{f:AE},141:{f:Er},144:{},146:{f:PE},151:{},152:{},153:{},154:{},155:{},156:{f:Er},157:{},158:{},160:{f:LE},161:{f:ME},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uE},190:{f:fE},193:{f:gs},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Er},220:{},221:{f:gr},222:{},224:{f:pE},225:{f:Vb},226:{f:gs},227:{},229:{f:EE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Qb},253:{f:sE},255:{f:qb},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:L1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xE},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:DE},439:{f:gr},440:{f:NE},441:{},442:{f:Ol},443:{},444:{f:Er},445:{},446:{},448:{f:gs},449:{f:eE,r:2},450:{f:gs},512:{f:gg},513:{f:jE},515:{f:mE},516:{f:oE},517:{f:vg},519:{f:zE},520:{f:Zb},523:{},545:{f:_g},549:{f:xg},566:{},574:{f:rE},638:{f:cE},659:{},1048:{},1054:{f:iE},1084:{},1212:{f:wE},2048:{f:FE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:RE,r:12},2173:{f:uT,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yE,r:12},2197:{},2198:{f:aT,r:12},2199:{},2200:{},2201:{},2202:{f:kE,r:12},2203:{f:gs},2204:{},2205:{},2206:{},2207:{},2211:{f:Jb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gg},1:{},2:{f:HE},3:{f:UE},4:{f:WE},5:{f:vg},7:{f:$E},8:{},9:{f:tu},11:{},22:{f:Er},30:{f:lE},31:{},32:{},33:{f:_g},36:{},37:{f:xg},50:{f:YE},62:{},52:{},67:{},68:{f:Er},69:{},86:{},126:{},127:{f:BE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:VE},223:{},234:{},354:{},421:{},518:{f:nd},521:{f:tu},536:{f:kg},547:{f:wg},561:{},579:{},1030:{f:nd},1033:{f:tu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Jn(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&S1(t)&&e.push(t)}}function Pg(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=m_(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,x=0,g=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(l=0;l<f.length;++l){var w=f[l].trim(),_=w.slice(0,3).toLowerCase();if(_=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(_!="<td"&&_!="<th")){var E=w.split(/<\/t[dh]>/i);for(c=0;c<E.length;++c){var A=E[c].trim();if(A.match(/<t[dh]/i)){for(var T=A,j=0;T.charAt(0)=="<"&&(j=T.indexOf(">"))>-1;)T=T.slice(j+1);for(var ee=0;ee<k.length;++ee){var R=k[ee];R.s.c==p&&R.s.r<h&&h<=R.e.r&&(p=R.e.c+1,ee=-1)}var C=mt(A.slice(0,A.indexOf(">")));g=C.colspan?+C.colspan:1,((x=+C.rowspan)>1||g>1)&&k.push({s:{r:h,c:p},e:{r:h+(x||1)-1,c:p+g-1}});var Q=C.t||C["data-t"]||"";if(!T.length){p+=g;continue}if(T=d1(T),y.s.r>h&&(y.s.r=h),y.e.r<h&&(y.e.r=h),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!T.length){p+=g;continue}var M={t:"s",v:T};t.raw||!T.trim().length||Q=="s"||(T==="TRUE"?M={t:"b",v:!0}:T==="FALSE"?M={t:"b",v:!1}:isNaN(na(T))?isNaN(ai(T).getDate())||(M={t:"d",v:Ir(T)},t.cellDates||(M={t:"n",v:dn(M.v)}),M.z=t.dateNF||kt[14]):M={t:"n",v:na(T)}),t.dense?(r[h]||(r[h]=[]),r[h][p]=M):r[vt({r:h,c:p})]=M,p+=g}}}}return r["!ref"]=At(y),k.length&&(r["!merges"]=k),r}function YN(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>l)&&!(a[h].e.r<t||a[h].e.c<l)){if(a[h].s.r<t||a[h].s.c<l){c=-1;break}c=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(c<0)){var p=vt({r:t,c:l}),x=r.dense?(e[t]||[])[l]:e[p],g=x&&x.v!=null&&(x.h||cp(x.w||(Ka(x),x.w)||""))||"",y={};c>1&&(y.rowspan=c),f>1&&(y.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":x&&(y["data-t"]=x&&x.t||"z",x.v!=null&&(y["data-v"]=x.v),x.z!=null&&(y["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+x.l.Target+'">'+g+"</a>")),y.id=(r.id||"sjs")+"-"+p,o.push(A_("td",g,y))}}var k="<tr>";return k+o.join("")+"</tr>"}var VN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',KN="</body></html>";function GN(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Os(Pg(t[0],n),n);var r=Cp();return t.forEach(function(a,o){Dp(r,Pg(a,n),"Sheet"+(o+1))}),r}function XN(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function QN(e,n){var t=n||{},r=t.header!=null?t.header:VN,a=t.footer!=null?t.footer:KN,o=[r],l=pi(e["!ref"]);t.dense=Array.isArray(e),o.push(XN(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(YN(e,l,c,t));return o.push("</table>"+a),o.join("")}function gy(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var p=pi(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),a==-1&&(h.e.r=a=p.e.r+1)}var x=[],g=0,y=e["!rows"]||(e["!rows"]=[]),k=0,w=0,_=0,E=0,A=0,T=0;for(e["!cols"]||(e["!cols"]=[]);k<c.length&&w<f;++k){var j=c[k];if(Rg(j)){if(r.display)continue;y[w]={hidden:!0}}var ee=j.children;for(_=E=0;_<ee.length;++_){var R=ee[_];if(!(r.display&&Rg(R))){var C=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):d1(R.innerHTML),Q=R.getAttribute("data-z")||R.getAttribute("z");for(g=0;g<x.length;++g){var M=x[g];M.s.c==E+o&&M.s.r<w+a&&w+a<=M.e.r&&(E=M.e.c+1-o,g=-1)}T=+R.getAttribute("colspan")||1,((A=+R.getAttribute("rowspan")||1)>1||T>1)&&x.push({s:{r:w+a,c:E+o},e:{r:w+a+(A||1)-1,c:E+o+(T||1)-1}});var te={t:"s",v:C},K=R.getAttribute("data-t")||R.getAttribute("t")||"";C!=null&&(C.length==0?te.t=K||"z":r.raw||C.trim().length==0||K=="s"||(C==="TRUE"?te={t:"b",v:!0}:C==="FALSE"?te={t:"b",v:!1}:isNaN(na(C))?isNaN(ai(C).getDate())||(te={t:"d",v:Ir(C)},r.cellDates||(te={t:"n",v:dn(te.v)}),te.z=r.dateNF||kt[14]):te={t:"n",v:na(C)})),te.z===void 0&&Q!=null&&(te.z=Q);var B="",fe=R.getElementsByTagName("A");if(fe&&fe.length)for(var ue=0;ue<fe.length&&!(fe[ue].hasAttribute("href")&&(B=fe[ue].getAttribute("href"),B.charAt(0)!="#"));++ue);B&&B.charAt(0)!="#"&&(te.l={Target:B}),r.dense?(e[w+a]||(e[w+a]=[]),e[w+a][E+o]=te):e[vt({c:E+o,r:w+a})]=te,h.e.c<E+o&&(h.e.c=E+o),E+=T}}++w}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,w-1+a),e["!ref"]=At(h),w>=f&&(e["!fullref"]=At((h.e.r=c.length-k+w-1+a,h))),e}function vy(e,n){var t=n||{},r=t.dense?[]:{};return gy(r,e,n)}function qN(e,n){return Os(vy(e,n),n)}function Rg(e){var n="",t=ZN(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function ZN(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function JN(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Mt(n.replace(/<[^>]*>/g,""));return[t]}var Mg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yy(e,n){var t=n||{},r=up(e),a=[],o,l,c={name:""},f="",h=0,p,x,g={},y=[],k=t.dense?[]:{},w,_,E={value:""},A="",T=0,j=[],ee=-1,R=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},Q=0,M={},te=[],K={},B=0,fe=0,ue=[],oe=1,he=1,V=[],le={Names:[]},J={},ae=["",""],W=[],S={},P="",O=0,z=!1,H=!1,re=0;for(kl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=kl.exec(r);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?k["!ref"]=At(C):k["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=C.e.r&&(k["!fullref"]=k["!ref"],C.e.r=t.sheetRows-1,k["!ref"]=At(C)),te.length&&(k["!merges"]=te),ue.length&&(k["!rows"]=ue),p.name=p.名称||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),g[p.name]=k,H=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=mt(w[0],!1),ee=R=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,k=t.dense?[]:{},te=[],ue=[],H=!0);break;case"table-row-group":w[1]==="/"?--Q:++Q;break;case"table-row":case"行":if(w[1]==="/"){ee+=oe,oe=1;break}if(x=mt(w[0],!1),x.行号?ee=x.行号-1:ee==-1&&(ee=0),oe=+x["number-rows-repeated"]||1,oe<10)for(re=0;re<oe;++re)Q>0&&(ue[ee+re]={level:Q});R=-1;break;case"covered-table-cell":w[1]!=="/"&&++R,t.sheetStubs&&(t.dense?(k[ee]||(k[ee]=[]),k[ee][R]={t:"z"}):k[vt({r:ee,c:R})]={t:"z"}),A="",j=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++R,E=mt(w[0],!1),he=parseInt(E["number-columns-repeated"]||"1",10),_={t:"z",v:null},E.formula&&t.cellFormula!=!1&&(_.f=Ng(Mt(E.formula))),(E.数据类型||E["value-type"])=="string"&&(_.t="s",_.v=Mt(E["string-value"]||""),t.dense?(k[ee]||(k[ee]=[]),k[ee][R]=_):k[vt({r:ee,c:R})]=_),R+=he-1;else if(w[1]!=="/"){++R,A="",T=0,j=[],he=1;var ie=oe?ee+oe-1:ee;if(R>C.e.c&&(C.e.c=R),R<C.s.c&&(C.s.c=R),ee<C.s.r&&(C.s.r=ee),ie>C.e.r&&(C.e.r=ie),E=mt(w[0],!1),W=[],S={},_={t:E.数据类型||E["value-type"],v:null},t.cellFormula)if(E.formula&&(E.formula=Mt(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(B=parseInt(E["number-matrix-rows-spanned"],10)||0,fe=parseInt(E["number-matrix-columns-spanned"],10)||0,K={s:{r:ee,c:R},e:{r:ee+B-1,c:R+fe-1}},_.F=At(K),V.push([K,_.F])),E.formula)_.f=Ng(E.formula);else for(re=0;re<V.length;++re)ee>=V[re][0].s.r&&ee<=V[re][0].e.r&&R>=V[re][0].s.c&&R<=V[re][0].e.c&&(_.F=V[re][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(B=parseInt(E["number-rows-spanned"],10)||0,fe=parseInt(E["number-columns-spanned"],10)||0,K={s:{r:ee,c:R},e:{r:ee+B-1,c:R+fe-1}},te.push(K)),E["number-columns-repeated"]&&(he=parseInt(E["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=nr(E["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(E.value);break;case"percentage":_.t="n",_.v=parseFloat(E.value);break;case"currency":_.t="n",_.v=parseFloat(E.value);break;case"date":_.t="d",_.v=Ir(E["date-value"]),t.cellDates||(_.t="n",_.v=dn(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=d_(E["time-value"])/86400,t.cellDates&&(_.t="d",_.v=Xu(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(E.数据数值);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",E["string-value"]!=null&&(A=Mt(E["string-value"]),j=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(z=!1,_.t==="s"&&(_.v=A||"",j.length&&(_.R=j),z=T==0),J.Target&&(_.l=J),W.length>0&&(_.c=W,W=[]),A&&t.cellText!==!1&&(_.w=A),z&&(_.t="z",delete _.v),(!z||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=ee))for(var Z=0;Z<oe;++Z){if(he=parseInt(E["number-columns-repeated"]||"1",10),t.dense)for(k[ee+Z]||(k[ee+Z]=[]),k[ee+Z][R]=Z==0?_:Ur(_);--he>0;)k[ee+Z][R+he]=Ur(_);else for(k[vt({r:ee+Z,c:R})]=_;--he>0;)k[vt({r:ee+Z,c:R+he})]=Ur(_);C.e.c<=R&&(C.e.c=R)}he=parseInt(E["number-columns-repeated"]||"1",10),R+=he-1,he=0,_={},A="",j=[]}J={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o;S.t=A,j.length&&(S.R=j),S.a=P,W.push(S)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);P="",O=0,A="",T=0,j=[];break;case"creator":w[1]==="/"?P=r.slice(O,w.index):O=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);A="",T=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(M[c.name]=f,(o=a.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",c=mt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=mt(w[0],!1),f+=Mg[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=mt(w[0],!1),f+=Mg[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(h,w.index);break}else h=w.index+w[0].length;break;case"named-range":l=mt(w[0],!1),ae=ad(l["cell-range-address"]);var ge={Name:l.name,Ref:ae[0]+"!"+ae[1]};H&&(ge.Sheet=y.length),le.Names.push(ge);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!E||!E["string-value"])){var xe=JN(r.slice(T,w.index));A=(A.length>0?A+`
`:"")+xe[0]}else mt(w[0],!1),T=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ae=ad(mt(w[0])["target-range-address"]),g[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(J=mt(w[0],!1),!J.href)break;J.Target=Mt(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(ae=ad(J.Target.slice(1)),J.Target="#"+ae[0]+"!"+ae[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(w)}}var L={Sheets:g,SheetNames:y,Workbook:le};return t.bookSheets&&delete L.Sheets,L}function Ig(e,n){n=n||{},Ln(e,"META-INF/manifest.xml")&&mb(br(e,"META-INF/manifest.xml"),n);var t=Sn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=yy(Zt(t),n);return Ln(e,"meta.xml")&&(r.Props=O1(br(e,"meta.xml"))),r}function jg(e,n){return yy(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Od(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Zt(mo(e))}function Pd(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function Lg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function e4(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Sl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Nr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function qr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Sl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Sl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:c,type:o};n[a]==null?n[a]=[h]:n[a].push(h)}return n}function Ep(e,n){return e?.map(function(t){return n(t.data)})||[]}function t4(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Sl(e,r),o=qr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Nr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=qr(c.data),h=Nr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(n=o[3])!=null&&n[0]&&(l.merge=Nr(o[3][0].data)>>>0>0),t.push(l)}return t}function r4(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Sl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,h=0;if(o==1?(h=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(h=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Pd(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var p=Pd(a);if(p.length!=r)throw new Error("Unexpected length: ".concat(p.length," != ").concat(r));return p}function n4(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(r4(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Pd(n)}function a4(e,n,t,r){var a=bp(e),o=a.getUint32(4,!0),l=(r>1?12:8)+Lg(o&(r>1?3470:398))*4,c=-1,f=-1,h=NaN,p=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=Lg(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(h=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:n[f]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:t[c]};else if(f>-1)x={t:"s",v:n[f]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function s4(e,n,t){var r=bp(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,h=NaN,p=new Date(2001,0,1);a&1&&(f=e4(e,o),o+=16),a&2&&(h=r.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:n[c]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return x}function o4(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return a4(e,n,t,e[0]);case 5:return s4(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Es(e){var n=qr(e);return Sl(n[1][0].data)}function zg(e,n){var t=qr(n.data),r=Nr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=qr(l.data),f=Nr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Od(c[3][0].data);break;case 8:{var h=e[Es(c[9][0].data)][0],p=qr(h.data),x=e[Es(p[1][0].data)][0],g=Nr(x.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var y=qr(x.data);o[f]=y[3].map(function(k){return Od(k.data)}).join("")}break}}),o}function i4(e,n){var t,r,a,o,l,c,f,h,p,x,g,y,k,w,_=qr(e),E=Nr(_[1][0].data)>>>0,A=Nr(_[2][0].data)>>>0,T=((r=(t=_[8])==null?void 0:t[0])==null?void 0:r.data)&&Nr(_[8][0].data)>0||!1,j,ee;if((o=(a=_[7])==null?void 0:a[0])!=null&&o.data&&n!=0)j=(c=(l=_[7])==null?void 0:l[0])==null?void 0:c.data,ee=(h=(f=_[6])==null?void 0:f[0])==null?void 0:h.data;else if((x=(p=_[4])==null?void 0:p[0])!=null&&x.data&&n!=1)j=(y=(g=_[4])==null?void 0:g[0])==null?void 0:y.data,ee=(w=(k=_[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var R=T?4:1,C=bp(j),Q=[],M=0;M<j.length/2;++M){var te=C.getUint16(M*2,!0);te<65535&&Q.push([M,te])}if(Q.length!=A)throw"Expected ".concat(A," cells, found ").concat(Q.length);var K=[];for(M=0;M<Q.length-1;++M)K[Q[M][0]]=ee.subarray(Q[M][1]*R,Q[M+1][1]*R);return Q.length>=1&&(K[Q[Q.length-1][0]]=ee.subarray(Q[Q.length-1][1]*R)),{R:E,cells:K}}function l4(e,n){var t,r=qr(n.data),a=(t=r?.[7])!=null&&t[0]?Nr(r[7][0].data)>>>0>0?1:0:-1,o=Ep(r[5],function(l){return i4(l,a)});return{nrows:Nr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,h){if(l[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));l[c.R][h]=f}),l},[])}}function c4(e,n,t){var r,a=qr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Nr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Nr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=At(o);var l=qr(a[4][0].data),c=zg(e,e[Es(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?zg(e,e[Es(l[17][0].data)][0]):[],h=qr(l[3][0].data),p=0;h[1].forEach(function(x){var g=qr(x.data),y=e[Es(g[2][0].data)][0],k=Nr(y.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=l4(e,y);w.data.forEach(function(_,E){_.forEach(function(A,T){var j=vt({r:p+E,c:T}),ee=o4(A,c,f);ee&&(t[j]=ee)})}),p+=w.nrows})}function u4(e,n){var t=qr(n.data),r={"!ref":"A1"},a=e[Es(t[2][0].data)],o=Nr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return c4(e,a[0],r),r}function f4(e,n){var t,r=qr(n.data),a={name:(t=r[1])!=null&&t[0]?Od(r[1][0].data):"",sheets:[]},o=Ep(r[2],Es);return o.forEach(function(l){e[l].forEach(function(c){var f=Nr(c.meta[1][0].data);f==6e3&&a.sheets.push(u4(e,c))})}),a}function d4(e,n){var t=Cp(),r=qr(n.data),a=Ep(r[1],Es);if(a.forEach(function(o){e[o].forEach(function(l){var c=Nr(l.meta[1][0].data);if(c==2){var f=f4(e,l);f.sheets.forEach(function(h,p){Dp(t,h,p==0?f.name:f.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function od(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=n4(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var p;try{p=t4(h)}catch(x){return console.log("## "+(x.message||x))}p.forEach(function(x){o[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Nr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(h){var p=Nr(h.meta[1][0].data)>>>0;if(p==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return d4(o,c)}function p4(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Sp(e){p4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function h4(e){return Qo.WS.indexOf(e)>-1?"sheet":e==Qo.CS?"chart":e==Qo.DS?"dialog":e==Qo.MS?"macro":e&&e.length?e:"sheet"}function m4(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,h4(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function x4(e,n,t,r,a,o,l,c,f,h,p,x){try{o[r]=fl(Sn(e,t,!0),n);var g=br(e,n),y;switch(c){case"sheet":y=_N(g,n,a,f,o[r],h,p,x);break;case"chart":if(y=bN(g,n,a,f,o[r],h,p,x),!y||!y["!drawel"])break;var k=al(y["!drawel"].Target,n),w=Cd(k),_=kT(Sn(e,k,!0),fl(Sn(e,w,!0),k)),E=al(_,k),A=Cd(E);y=sN(Sn(e,E,!0),E,f,fl(Sn(e,A,!0),E),h,y);break;case"macro":y=EN(g,n,a,f,o[r],h,p,x);break;case"dialog":y=SN(g,n,a,f,o[r],h,p,x);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=y;var T=[];o&&o[r]&&ba(o[r]).forEach(function(j){var ee="";if(o[r][j].Type==Qo.CMNT){ee=al(o[r][j].Target,n);var R=NN(br(e,ee,!0),ee,f);if(!R||!R.length)return;Eg(y,R,!1)}o[r][j].Type==Qo.TCMNT&&(ee=al(o[r][j].Target,n),T=T.concat(bT(br(e,ee,!0),f)))}),T&&T.length&&Eg(y,T,!0,f.people||[])}catch(j){if(f.WTF)throw j}}function Mn(e){return e.charAt(0)=="/"?e.slice(1):e}function g4(e,n){if(n1(),n=n||{},Sp(n),Ln(e,"META-INF/manifest.xml")||Ln(e,"objectdata.xml"))return Ig(e,n);if(Ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof od<"u"){if(e.FileIndex)return od(e);var t=Ft.utils.cfb_new();return qx(e).forEach(function(ue){v_(t,ue,g_(e,ue))}),od(t)}throw new Error("Unsupported NUMBERS file")}if(!Ln(e,"[Content_Types].xml"))throw Ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=qx(e),a=pb(Sn(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",br(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!br(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},h={};if(!n.bookSheets&&!n.bookProps){if(hl=[],a.sst)try{hl=DN(br(e,Mn(a.sst)),a.sst,n)}catch(ue){if(n.WTF)throw ue}n.cellStyles&&a.themes.length&&(f=CN(Sn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(h=TN(br(e,Mn(a.style)),a.style,f,n))}a.links.map(function(ue){try{var oe=fl(Sn(e,Cd(Mn(ue))),ue);return AN(br(e,Mn(ue)),oe,ue,n)}catch{}});var p=kN(br(e,Mn(a.workbooks[0])),a.workbooks[0],n),x={},g="";a.coreprops.length&&(g=br(e,Mn(a.coreprops[0]),!0),g&&(x=O1(g)),a.extprops.length!==0&&(g=br(e,Mn(a.extprops[0]),!0),g&&vb(g,x,n)));var y={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=Sn(e,Mn(a.custprops[0]),!0),g&&(y=wb(g,n)));var k={};if((n.bookSheets||n.bookProps)&&(p.Sheets?l=p.Sheets.map(function(oe){return oe.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),n.bookProps&&(k.Props=x,k.Custprops=y),n.bookSheets&&typeof l<"u"&&(k.SheetNames=l),n.bookSheets?k.SheetNames:n.bookProps))return k;l={};var w={};n.bookDeps&&a.calcchain&&(w=FN(br(e,Mn(a.calcchain)),a.calcchain));var _=0,E={},A,T;{var j=p.Sheets;x.Worksheets=j.length,x.SheetNames=[];for(var ee=0;ee!=j.length;++ee)x.SheetNames[ee]=j[ee].name}var R=o?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),Q=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Ln(e,Q)||(Q="xl/_rels/workbook."+R+".rels");var M=fl(Sn(e,Q,!0),Q.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=ON(br(e,Mn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=ET(br(e,Mn(a.people[0])),n)),M&&(M=m4(M,p.Sheets));var te=br(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=x.Worksheets;++_){var K="sheet";if(M&&M[_]?(A="xl/"+M[_][1].replace(/[\/]?xl\//,""),Ln(e,A)||(A=M[_][1]),Ln(e,A)||(A=Q.replace(/_rels\/.*$/,"")+M[_][1]),K=M[_][2]):(A="xl/worksheets/sheet"+(_+1-te)+"."+R,A=A.replace(/sheet0\./,"sheet.")),T=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(_!=n.sheets)continue e;break;case"string":if(x.SheetNames[_].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var B=!1,fe=0;fe!=n.sheets.length;++fe)typeof n.sheets[fe]=="number"&&n.sheets[fe]==_&&(B=1),typeof n.sheets[fe]=="string"&&n.sheets[fe].toLowerCase()==x.SheetNames[_].toLowerCase()&&(B=1);if(!B)continue e}}x4(e,A,T,x.SheetNames[_],_,E,l,K,n,p,f,h)}return k={Directory:a,Workbook:p,Props:x,Custprops:y,Deps:w,Sheets:l,SheetNames:x.SheetNames,Strings:hl,Styles:h,Themes:f,SSF:Ur(kt)},n&&n.bookFiles&&(e.files?(k.keys=r,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(ue,oe){ue=ue.replace(/^Root Entry[\/]/,""),k.keys.push(ue),k.files[ue]=e.FileIndex[oe]}))),n&&n.bookVBA&&(a.vba.length>0?k.vbaraw=br(e,Mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===DT&&(k.vbaraw=br(e,"xl/vbaProject.bin",!0))),k}function v4(e,n){var t=n||{},r="Workbook",a=Ft.find(e,r);try{if(r="/!DataSpaces/Version",a=Ft.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(uS(a.content),r="/!DataSpaces/DataSpaceMap",a=Ft.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=dS(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ft.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=pS(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ft.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);mS(a.content)}catch{}if(r="/EncryptionInfo",a=Ft.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=xS(a.content);if(r="/EncryptedPackage",a=Ft.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Tp(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Cn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function y4(e,n){return Ft.find(e,"EncryptedPackage")?v4(e,n):xy(e,n)}function w4(e,n){var t,r=e,a=n||{};return a.type||(a.type=Ct&&Buffer.isBuffer(e)?"buffer":"base64"),t=c1(r,a),g4(t,a)}function wy(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Fd(e.slice(t),n);default:break e}return _l.to_workbook(e,n)}function k4(e,n){var t="",r=Tp(e,n);switch(n.type){case"base64":t=Cn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=io(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Zt(t)),n.type="binary",wy(t,n)}function _4(e,n){var t=e;return n.type=="base64"&&(t=Cn(t)),t=vl.utils.decode(1200,t.slice(2),"str"),n.type="binary",wy(t,n)}function b4(e){return e.match(/[^\x00-\x7F]/)?sl(e):e}function id(e,n,t,r){return r?(t.type="string",_l.to_workbook(e,t)):_l.to_workbook(n,t)}function Rd(e,n){Yv();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rd(new Uint8Array(e),(t=Ur(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Jo={},t.dateNF&&(Jo.dateNF=t.dateNF),t.type||(t.type=Ct&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Ct?"buffer":"binary",r=u_(e),typeof Uint8Array<"u"&&!Ct&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=b4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=Ur(t),t.type="array",Rd(ap(r),t)}switch((a=Tp(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return y4(Ft.read(r,t),t);break;case 9:if(a[1]<=8)return xy(r,t);break;case 60:return Fd(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return qE(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return XE.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?w4(r,t):id(e,r,t,o);case 239:return a[3]===60?Fd(r,t):id(e,r,t,o);case 255:if(a[1]===254)return _4(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return pl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return pl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return bg.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return DS.to_workbook(r,t);break;case 10:case 13:case 32:return k4(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return KE.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?bg.to_workbook(r,t):id(e,r,t,o)}function E4(e,n,t,r,a,o,l,c){var f=Hr(t),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var y=n.s.c;y<=n.e.c;++y){var k=l?e[t][y]:e[r[y]+f];if(k===void 0||k.t===void 0){if(h===void 0)continue;o[y]!=null&&(g[o[y]]=h);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(o[y]!=null){if(w==null)if(k.t=="e"&&w===null)g[o[y]]=null;else if(h!==void 0)g[o[y]]=h;else if(p&&w===null)g[o[y]]=null;else continue;else g[o[y]]=p&&(k.t!=="n"||k.t==="n"&&c.rawNumbers!==!1)?w:Ka(k,w,c);w!=null&&(x=!1)}}return{row:g,isempty:x}}function Md(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof p){case"string":f=dr(p);break;case"number":f=dr(e["!ref"]),f.s.r=p;break;default:f=p}r>0&&(a=0);var x=Hr(f.s.r),g=[],y=[],k=0,w=0,_=Array.isArray(e),E=f.s.r,A=0,T={};_&&!e[E]&&(e[E]=[]);var j=h.skipHidden&&e["!cols"]||[],ee=h.skipHidden&&e["!rows"]||[];for(A=f.s.c;A<=f.e.c;++A)if(!(j[A]||{}).hidden)switch(g[A]=Dr(A),t=_?e[E][A]:e[g[A]+x],r){case 1:o[A]=A-f.s.c;break;case 2:o[A]=g[A];break;case 3:o[A]=h.header[A-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ka(t,null,h),w=T[l]||0,!w)T[l]=1;else{do c=l+"_"+w++;while(T[c]);T[l]=w,T[c]=1}o[A]=c}for(E=f.s.r+a;E<=f.e.r;++E)if(!(ee[E]||{}).hidden){var R=E4(e,f,E,g,r,o,_,h);(R.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(y[k++]=R.row)}return y.length=k,y}var Bg=/"/g;function S4(e,n,t,r,a,o,l,c){for(var f=!0,h=[],p="",x=Hr(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var y=c.dense?(e[t]||[])[g]:e[r[g]+x];if(y==null)p="";else if(y.v!=null){f=!1,p=""+(c.rawNumbers&&y.t=="n"?y.v:Ka(y,null,c));for(var k=0,w=0;k!==p.length;++k)if((w=p.charCodeAt(k))===a||w===o||w===34||c.forceQuotes){p='"'+p.replace(Bg,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(f=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(Bg,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&f?null:h.join(l)}function ky(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=dr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),p="",x=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],y=r.skipHidden&&e["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(g[k]||{}).hidden||(x[k]=Dr(k));for(var w=0,_=a.s.r;_<=a.e.r;++_)(y[_]||{}).hidden||(p=S4(e,a,_,x,l,f,o,r),p!=null&&(r.strip&&(p=p.replace(h,"")),(p||r.blankrows!==!1)&&t.push((w++?c:"")+p)));return delete r.dense,t.join("")}function T4(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=ky(e,n);return t}function C4(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=dr(e["!ref"]),o="",l=[],c,f=[],h=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Dr(c);for(var p=a.s.r;p<=a.e.r;++p)for(o=Hr(p),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=h?(e[p]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function _y(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}var h,p={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var x=dr(o["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),l==-1&&(l=x.e.r+1,p.e.r=l+n.length-1+a)}else l==-1&&(l=0,p.e.r=n.length-1+a);var g=r.header||[],y=0;n.forEach(function(w,_){ba(w).forEach(function(E){(y=g.indexOf(E))==-1&&(g[y=g.length]=E);var A=w[E],T="z",j="",ee=vt({c:c+y,r:l+_+a});h=Tl(o,ee),A&&typeof A=="object"&&!(A instanceof Date)?o[ee]=A:(typeof A=="number"?T="n":typeof A=="boolean"?T="b":typeof A=="string"?T="s":A instanceof Date?(T="d",r.cellDates||(T="n",A=dn(A)),j=r.dateNF||kt[14]):A===null&&r.nullError&&(T="e",A=0),h?(h.t=T,h.v=A,delete h.w,delete h.R,j&&(h.z=j)):o[ee]=h={t:T,v:A},j&&(h.z=j))})}),p.e.c=Math.max(p.e.c,c+g.length-1);var k=Hr(l);if(a)for(y=0;y<g.length;++y)o[Dr(y+c)+k]={t:"s",v:g[y]};return o["!ref"]=At(p),o}function D4(e,n){return _y(null,e,n)}function Tl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=ln(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Tl(e,vt(n)):Tl(e,vt({r:n,c:t||0}))}function N4(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Cp(){return{SheetNames:[],Sheets:{}}}function Dp(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(pN(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function F4(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=N4(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function A4(e,n){return e.z=n,e}function by(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function O4(e,n,t){return by(e,"#"+n,t)}function P4(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function R4(e,n,t,r){for(var a=typeof n!="string"?n:dr(n),o=typeof n=="string"?n:At(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Tl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var M4={encode_col:Dr,encode_row:Hr,encode_cell:vt,encode_range:At,decode_col:pp,decode_row:dp,split_cell:V_,decode_cell:ln,decode_range:pi,format_cell:Ka,sheet_add_aoa:C1,sheet_add_json:_y,sheet_add_dom:gy,aoa_to_sheet:hi,json_to_sheet:D4,table_to_sheet:vy,table_to_book:qN,sheet_to_csv:ky,sheet_to_txt:T4,sheet_to_json:Md,sheet_to_html:QN,sheet_to_formulae:C4,sheet_to_row_object_array:Md,sheet_get_cell:Tl,book_new:Cp,book_append_sheet:Dp,book_set_sheet_visibility:F4,cell_set_number_format:A4,cell_set_hyperlink:by,cell_set_internal_link:O4,cell_add_comment:P4,sheet_set_array_formula:R4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const I4=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=D.useState(null),o=D.useRef(null),l=h=>{const p=h.target.files?.[0];p&&a(p)},c=()=>{if(r){const h=new FileReader;h.onload=p=>{try{const x=new Uint8Array(p.target?.result),g=Rd(x,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const y=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",y);const k=M4.sheet_to_json(y,{header:1});console.log("Parsed JSON data:",k);const w={headers:k[0],rows:k.slice(1)};console.log("Prepared file data:",w),t(r.name,w),f()}catch(x){console.error("Error reading Excel file:",x)}},h.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return d.jsx(Fr,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Załaduj plik Excel"}),d.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-2 overflow-hidden",children:d.jsx("div",{children:d.jsxs("div",{className:"relative mt-8",children:[d.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),d.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[d.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&d.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[d.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),d.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Załaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Załaduj"})]})]})})},j4=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>d.jsx(Fr,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:d.jsxs("div",{className:"h-full flex items-center justify-between",children:[d.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastąpić "',r,'"?']}),d.jsxs("div",{className:"flex space-x-2 shrink-0",children:[d.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),d.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastąp"})]})]})});function Ey(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=Ey(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Wr(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=Ey(e))&&(r&&(r+=" "),r+=n);return r}const Sy=6048e5,L4=864e5,Ju=6e4,e0=36e5,z4=1e3,Wg=Symbol.for("constructDateFrom");function Vt(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Wg in e?e[Wg](n):e instanceof Date?new e.constructor(n):new Date(n)}function nt(e,n){return Vt(n||e,e)}function aa(e,n,t){const r=nt(e,t?.in);return isNaN(n)?Vt(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function sa(e,n,t){const r=nt(e,t?.in);if(isNaN(n))return Vt(e,NaN);if(!n)return r;const a=r.getDate(),o=Vt(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function Ty(e,n,t){return Vt(e,+nt(e)+n)}function B4(e,n,t){return Ty(e,n*e0)}let W4={};function wo(){return W4}function oa(e,n){const t=wo(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=nt(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function oi(e,n){return oa(e,{...n,weekStartsOn:1})}function Cy(e,n){const t=nt(e,n?.in),r=t.getFullYear(),a=Vt(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=oi(a),l=Vt(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=oi(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Ou(e){const n=nt(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function Da(e,...n){const t=Vt.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function co(e,n){const t=nt(e,n?.in);return t.setHours(0,0,0,0),t}function ii(e,n,t){const[r,a]=Da(t?.in,e,n),o=co(r),l=co(a),c=+o-Ou(o),f=+l-Ou(l);return Math.round((c-f)/L4)}function U4(e,n){const t=Cy(e,n),r=Vt(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),oi(r)}function Id(e,n,t){const r=nt(e,t?.in);return r.setTime(r.getTime()+n*Ju),r}function Np(e,n,t){return sa(e,n*3,t)}function H4(e,n,t){return Ty(e,n*1e3)}function Pu(e,n,t){return aa(e,n*7,t)}function Ua(e,n,t){return sa(e,n*12,t)}function Ug(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Vt.bind(null,a));const o=nt(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Vt(r,t||NaN)}function Hg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Vt.bind(null,a));const o=nt(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Vt(r,t||NaN)}function $4(e,n,t){const[r,a]=Da(t?.in,e,n);return+co(r)==+co(a)}function Ha(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Ru(e){return!(!Ha(e)&&typeof e!="number"||isNaN(+nt(e)))}function Mu(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function ro(e,n){const t=nt(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function Iu(e,n,t){const[r,a]=Da(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=ro(r)-ro(a);return o*4+l}function ju(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function Y4(e,n,t){const[r,a]=Da(t?.in,e,n),o=$g(r,a),l=Math.abs(ii(r,a));r.setDate(r.getDate()-o*l);const c=+($g(r,a)===-o),f=o*(l-c);return f===0?0:f}function $g(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function Dy(e,n){const t=nt(e,n?.in);return t.setHours(23,59,59,999),t}function Ny(e,n){const t=nt(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function jd(e,n){const t=nt(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function Fy(e,n){const t=nt(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Ay(e,n){const t=nt(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function t0(e,n){const t=nt(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function V4(e,n){const t=wo(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=nt(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const K4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},G4=(e,n,t)=>{let r;const a=K4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function ei(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const X4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Q4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},q4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Z4={date:ei({formats:X4,defaultWidth:"full"}),time:ei({formats:Q4,defaultWidth:"full"}),dateTime:ei({formats:q4,defaultWidth:"full"})},J4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e3=(e,n,t,r)=>J4[e];function ga(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const t3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},r3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},n3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},a3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},s3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},i3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},l3={ordinalNumber:i3,era:ga({values:t3,defaultWidth:"wide"}),quarter:ga({values:r3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ga({values:n3,defaultWidth:"wide"}),day:ga({values:a3,defaultWidth:"wide"}),dayPeriod:ga({values:s3,defaultWidth:"wide",formattingValues:o3,defaultFormattingWidth:"wide"})};function va(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?u3(c,x=>x.test(l)):c3(c,x=>x.test(l));let h;h=e.valueCallback?e.valueCallback(f):f,h=t.valueCallback?t.valueCallback(h):h;const p=n.slice(l.length);return{value:h,rest:p}}}function c3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function u3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function Oy(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const f3=/^(\d+)(th|st|nd|rd)?/i,d3=/\d+/i,p3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},h3={any:[/^b/i,/^(a|c)/i]},m3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},x3={any:[/1/i,/2/i,/3/i,/4/i]},g3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},v3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},y3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},w3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},k3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},_3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},b3={ordinalNumber:Oy({matchPattern:f3,parsePattern:d3,valueCallback:e=>parseInt(e,10)}),era:va({matchPatterns:p3,defaultMatchWidth:"wide",parsePatterns:h3,defaultParseWidth:"any"}),quarter:va({matchPatterns:m3,defaultMatchWidth:"wide",parsePatterns:x3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:va({matchPatterns:g3,defaultMatchWidth:"wide",parsePatterns:v3,defaultParseWidth:"any"}),day:va({matchPatterns:y3,defaultMatchWidth:"wide",parsePatterns:w3,defaultParseWidth:"any"}),dayPeriod:va({matchPatterns:k3,defaultMatchWidth:"any",parsePatterns:_3,defaultParseWidth:"any"})},Py={code:"en-US",formatDistance:G4,formatLong:Z4,formatRelative:e3,localize:l3,match:b3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function E3(e,n){const t=nt(e,n?.in);return ii(t,t0(t))+1}function Fp(e,n){const t=nt(e,n?.in),r=+oi(t)-+U4(t);return Math.round(r/Sy)+1}function Ap(e,n){const t=nt(e,n?.in),r=t.getFullYear(),a=wo(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Vt(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=oa(l,n),f=Vt(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const h=oa(f,n);return+t>=+c?r+1:+t>=+h?r:r-1}function S3(e,n){const t=wo(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Ap(e,n),o=Vt(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),oa(o,n)}function Ry(e,n){const t=nt(e,n?.in),r=+oa(t,n)-+S3(t,n);return Math.round(r/Sy)+1}function $t(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const vs={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return $t(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):$t(t+1,2)},d(e,n){return $t(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return $t(e.getHours()%12||12,n.length)},H(e,n){return $t(e.getHours(),n.length)},m(e,n){return $t(e.getMinutes(),n.length)},s(e,n){return $t(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return $t(a,n.length)}},Vo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Yg={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return vs.y(e,n)},Y:function(e,n,t,r){const a=Ap(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return $t(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):$t(o,n.length)},R:function(e,n){const t=Cy(e);return $t(t,n.length)},u:function(e,n){const t=e.getFullYear();return $t(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return $t(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return $t(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return vs.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return $t(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=Ry(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):$t(a,n.length)},I:function(e,n,t){const r=Fp(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):$t(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):vs.d(e,n)},D:function(e,n,t){const r=E3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):$t(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return $t(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return $t(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return $t(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Vo.noon:r===0?a=Vo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Vo.evening:r>=12?a=Vo.afternoon:r>=4?a=Vo.morning:a=Vo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return vs.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):vs.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):$t(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):$t(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):vs.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):vs.s(e,n)},S:function(e,n){return vs.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Kg(r);case"XXXX":case"XX":return Gs(r);case"XXXXX":case"XXX":default:return Gs(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Kg(r);case"xxxx":case"xx":return Gs(r);case"xxxxx":case"xxx":default:return Gs(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Vg(r,":");case"OOOO":default:return"GMT"+Gs(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Vg(r,":");case"zzzz":default:return"GMT"+Gs(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return $t(r,n.length)},T:function(e,n,t){return $t(+e,n.length)}};function Vg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+$t(o,2)}function Kg(e,n){return e%60===0?(e>0?"-":"+")+$t(Math.abs(e)/60,2):Gs(e,n)}function Gs(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=$t(Math.trunc(r/60),2),o=$t(r%60,2);return t+a+n+o}const Gg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},My=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},T3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Gg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Gg(r,n)).replace("{{time}}",My(a,n))},Ld={p:My,P:T3},C3=/^D+$/,D3=/^Y+$/,N3=["D","DD","YY","YYYY"];function F3(e){return C3.test(e)}function A3(e){return D3.test(e)}function O3(e,n,t){const r=P3(e,n,t);if(console.warn(r),N3.includes(e))throw new RangeError(r)}function P3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const R3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,M3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,I3=/^'([^]*?)'?$/,j3=/''/g,L3=/[a-zA-Z]/;function Xg(e,n,t){const r=wo(),a=t?.locale??r.locale??Py,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=nt(e,t?.in);if(!Ru(c))throw new RangeError("Invalid time value");let f=n.match(M3).map(p=>{const x=p[0];if(x==="p"||x==="P"){const g=Ld[x];return g(p,a.formatLong)}return p}).join("").match(R3).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const x=p[0];if(x==="'")return{isToken:!1,value:z3(p)};if(Yg[x])return{isToken:!0,value:p};if(x.match(L3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const h={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(p=>{if(!p.isToken)return p.value;const x=p.value;(!t?.useAdditionalWeekYearTokens&&A3(x)||!t?.useAdditionalDayOfYearTokens&&F3(x))&&O3(x,n,String(e));const g=Yg[x[0]];return g(c,x,a.localize,h)}).join("")}function z3(e){const n=e.match(I3);return n?n[1].replace(j3,"'"):e}function Qg(e,n){return nt(e,n?.in).getDate()}function B3(e,n){return nt(e,n?.in).getDay()}function W3(e,n){const t=nt(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Vt(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function U3(){return Object.assign({},wo())}function $a(e,n){return nt(e,n?.in).getHours()}function H3(e,n){const t=nt(e,n?.in).getDay();return t===0?7:t}function Ya(e,n){return nt(e,n?.in).getMinutes()}function cn(e,n){return nt(e,n?.in).getMonth()}function Ss(e){return nt(e).getSeconds()}function zd(e){return+nt(e)}function _t(e,n){return nt(e,n?.in).getFullYear()}function Ns(e,n){return+nt(e)>+nt(n)}function uo(e,n){return+nt(e)<+nt(n)}function $3(e,n){return+nt(e)==+nt(n)}function Y3(e,n){const t=V3(n)?new n(0):Vt(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function V3(e){return typeof e=="function"&&e.prototype?.constructor===e}const K3=10;class Iy{subPriority=0;validate(n,t){return!0}}class G3 extends Iy{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class X3 extends Iy{priority=K3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Vt(t,r))}set(n,t){return t.timestampIsSet?n:Vt(n,Y3(n,this.context))}}class jt{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new G3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class Q3 extends jt{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const vr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ya={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function yr(e,n){return e&&{value:n(e.value),rest:e.rest}}function lr(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function wa(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*e0+o*Ju+l*z4),rest:n.slice(t[0].length)}}function jy(e){return lr(vr.anyDigitsSigned,e)}function pr(e,n){switch(e){case 1:return lr(vr.singleDigit,n);case 2:return lr(vr.twoDigits,n);case 3:return lr(vr.threeDigits,n);case 4:return lr(vr.fourDigits,n);default:return lr(new RegExp("^\\d{1,"+e+"}"),n)}}function Lu(e,n){switch(e){case 1:return lr(vr.singleDigitSigned,n);case 2:return lr(vr.twoDigitsSigned,n);case 3:return lr(vr.threeDigitsSigned,n);case 4:return lr(vr.fourDigitsSigned,n);default:return lr(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Op(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Ly(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function zy(e){return e%400===0||e%4===0&&e%100!==0}class q3 extends jt{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return yr(pr(4,n),a);case"yo":return yr(r.ordinalNumber(n,{unit:"year"}),a);default:return yr(pr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=Ly(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class Z3 extends jt{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return yr(pr(4,n),a);case"Yo":return yr(r.ordinalNumber(n,{unit:"year"}),a);default:return yr(pr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=Ap(n,a);if(r.isTwoDigitYear){const c=Ly(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),oa(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class J3 extends jt{priority=130;parse(n,t){return Lu(t==="R"?4:t.length,n)}set(n,t,r){const a=Vt(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),oi(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class eF extends jt{priority=130;parse(n,t){return Lu(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class tF extends jt{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return pr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class rF extends jt{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return pr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class nF extends jt{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return yr(lr(vr.month,n),a);case"MM":return yr(pr(2,n),a);case"Mo":return yr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class aF extends jt{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return yr(lr(vr.month,n),a);case"LL":return yr(pr(2,n),a);case"Lo":return yr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function sF(e,n,t){const r=nt(e,t?.in),a=Ry(r,t)-n;return r.setDate(r.getDate()-a*7),nt(r,t?.in)}class oF extends jt{priority=100;parse(n,t,r){switch(t){case"w":return lr(vr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return oa(sF(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function iF(e,n,t){const r=nt(e,t?.in),a=Fp(r,t)-n;return r.setDate(r.getDate()-a*7),r}class lF extends jt{priority=100;parse(n,t,r){switch(t){case"I":return lr(vr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return oi(iF(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const cF=[31,28,31,30,31,30,31,31,30,31,30,31],uF=[31,29,31,30,31,30,31,31,30,31,30,31];class fF extends jt{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return lr(vr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return pr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=zy(r),o=n.getMonth();return a?t>=1&&t<=uF[o]:t>=1&&t<=cF[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class dF extends jt{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return lr(vr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return pr(t.length,n)}}validate(n,t){const r=n.getFullYear();return zy(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Pp(e,n,t){const r=wo(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=nt(e,t?.in),l=o.getDay(),f=(n%7+7)%7,h=7-a,p=n<0||n>6?n-(l+h)%7:(f+h)%7-(l+h)%7;return aa(o,p,t)}class pF extends jt{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class hF extends jt{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return yr(pr(t.length,n),o);case"eo":return yr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class mF extends jt{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return yr(pr(t.length,n),o);case"co":return yr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Pp(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function xF(e,n,t){const r=nt(e,t?.in),a=H3(r,t),o=n-a;return aa(r,o,t)}class gF extends jt{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return pr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return yr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return yr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return yr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return yr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=xF(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class vF extends jt{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Op(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class yF extends jt{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Op(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class wF extends jt{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Op(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class kF extends jt{priority=70;parse(n,t,r){switch(t){case"h":return lr(vr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class _F extends jt{priority=70;parse(n,t,r){switch(t){case"H":return lr(vr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class bF extends jt{priority=70;parse(n,t,r){switch(t){case"K":return lr(vr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class EF extends jt{priority=70;parse(n,t,r){switch(t){case"k":return lr(vr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return pr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class SF extends jt{priority=60;parse(n,t,r){switch(t){case"m":return lr(vr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class TF extends jt{priority=50;parse(n,t,r){switch(t){case"s":return lr(vr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return pr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class CF extends jt{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return yr(pr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class DF extends jt{priority=10;parse(n,t){switch(t){case"X":return wa(ya.basicOptionalMinutes,n);case"XX":return wa(ya.basic,n);case"XXXX":return wa(ya.basicOptionalSeconds,n);case"XXXXX":return wa(ya.extendedOptionalSeconds,n);case"XXX":default:return wa(ya.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Vt(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","x"]}class NF extends jt{priority=10;parse(n,t){switch(t){case"x":return wa(ya.basicOptionalMinutes,n);case"xx":return wa(ya.basic,n);case"xxxx":return wa(ya.basicOptionalSeconds,n);case"xxxxx":return wa(ya.extendedOptionalSeconds,n);case"xxx":default:return wa(ya.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Vt(n,n.getTime()-Ou(n)-r)}incompatibleTokens=["t","T","X"]}class FF extends jt{priority=40;parse(n){return jy(n)}set(n,t,r){return[Vt(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class AF extends jt{priority=20;parse(n){return jy(n)}set(n,t,r){return[Vt(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const OF={G:new Q3,y:new q3,Y:new Z3,R:new J3,u:new eF,Q:new tF,q:new rF,M:new nF,L:new aF,w:new oF,I:new lF,d:new fF,D:new dF,E:new pF,e:new hF,c:new mF,i:new gF,a:new vF,b:new yF,B:new wF,h:new kF,H:new _F,K:new bF,k:new EF,m:new SF,s:new TF,S:new CF,X:new DF,x:new NF,t:new FF,T:new AF},PF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,RF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,MF=/^'([^]*?)'?$/,IF=/''/g,jF=/\S/,LF=/[a-zA-Z]/;function zF(e,n,t,r){const a=()=>Vt(r?.in||t,NaN),o=U3(),l=r?.locale??o.locale??Py,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():nt(t,r?.in);const h={firstWeekContainsDate:c,weekStartsOn:f,locale:l},p=[new X3(r?.in,t)],x=n.match(RF).map(_=>{const E=_[0];if(E in Ld){const A=Ld[E];return A(_,l.formatLong)}return _}).join("").match(PF),g=[];for(let _ of x){const E=_[0],A=OF[E];if(A){const{incompatibleTokens:T}=A;if(Array.isArray(T)){const ee=g.find(R=>T.includes(R.token)||R.token===E);if(ee)throw new RangeError(`The format string mustn't contain \`${ee.fullToken}\` and \`${_}\` at the same time`)}else if(A.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${_}\` and any other token at the same time`);g.push({token:E,fullToken:_});const j=A.run(e,_,l.match,h);if(!j)return a();p.push(j.setter),e=j.rest}else{if(E.match(LF))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");if(_==="''"?_="'":E==="'"&&(_=BF(_)),e.indexOf(_)===0)e=e.slice(_.length);else return a()}}if(e.length>0&&jF.test(e))return a();const y=p.map(_=>_.priority).sort((_,E)=>E-_).filter((_,E,A)=>A.indexOf(_)===E).map(_=>p.filter(E=>E.priority===_).sort((E,A)=>A.subPriority-E.subPriority)).map(_=>_[0]);let k=nt(t,r?.in);if(isNaN(+k))return a();const w={};for(const _ of y){if(!_.validate(k,h))return a();const E=_.set(k,w,h);Array.isArray(E)?(k=E[0],Object.assign(w,E[1])):k=E}return k}function BF(e){return e.match(MF)[1].replace(IF,"'")}function WF(e,n,t){const[r,a]=Da(t?.in,e,n);return+oa(r,t)==+oa(a,t)}function UF(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function HF(e,n,t){const[r,a]=Da(t?.in,e,n);return+jd(r)==+jd(a)}function $F(e,n,t){const[r,a]=Da(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Cl(e,n,t){const r=+nt(e,t?.in),[a,o]=[+nt(n.start,t?.in),+nt(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function YF(e,n,t){return aa(e,-1,t)}function VF(e,n){const t=()=>Vt(n?.in,NaN),a=QF(e);let o;if(a.date){const h=qF(a.date,2);o=ZF(h.restDateString,h.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=JF(a.time),isNaN(c)))return t();if(a.timezone){if(f=eA(a.timezone),isNaN(f))return t()}else{const h=new Date(l+c),p=nt(0,n?.in);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return nt(l+c+f,n?.in)}const su={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},KF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,GF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,XF=/^([+-])(\d{2})(?::?(\d{2}))?$/;function QF(e){const n={},t=e.split(su.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],su.timeZoneDelimiter.test(n.date)&&(n.date=e.split(su.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=su.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function qF(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function ZF(e,n){if(n===null)return new Date(NaN);const t=e.match(KF);if(!t)return new Date(NaN);const r=!!t[4],a=el(t[1]),o=el(t[2])-1,l=el(t[3]),c=el(t[4]),f=el(t[5])-1;if(r)return sA(n,c,f)?tA(n,c,f):new Date(NaN);{const h=new Date(0);return!nA(n,o,l)||!aA(n,a)?new Date(NaN):(h.setUTCFullYear(n,o,Math.max(a,l)),h)}}function el(e){return e?parseInt(e):1}function JF(e){const n=e.match(GF);if(!n)return NaN;const t=ld(n[1]),r=ld(n[2]),a=ld(n[3]);return oA(t,r,a)?t*e0+r*Ju+a*1e3:NaN}function ld(e){return e&&parseFloat(e.replace(",","."))||0}function eA(e){if(e==="Z")return 0;const n=e.match(XF);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return iA(r,a)?t*(r*e0+a*Ju):NaN}function tA(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const rA=[31,null,31,30,31,30,31,31,30,31,30,31];function By(e){return e%400===0||e%4===0&&e%100!==0}function nA(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(rA[n]||(By(e)?29:28))}function aA(e,n){return n>=1&&n<=(By(e)?366:365)}function sA(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function oA(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function iA(e,n){return n>=0&&n<=59}function Bn(e,n,t){const r=nt(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Vt(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=W3(l);return r.setMonth(n,Math.min(o,c)),r}function hu(e,n,t){const r=nt(e,t?.in);return r.setHours(n),r}function mu(e,n,t){const r=nt(e,t?.in);return r.setMinutes(n),r}function Xo(e,n,t){const r=nt(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Bn(r,r.getMonth()+o*3)}function xu(e,n,t){const r=nt(e,t?.in);return r.setSeconds(n),r}function ma(e,n,t){const r=nt(e,t?.in);return isNaN(+r)?Vt(e,NaN):(r.setFullYear(n),r)}function no(e,n,t){return sa(e,-n,t)}function Wy(e,n,t){return Np(e,-1,t)}function qg(e,n,t){return Pu(e,-1,t)}function li(e,n,t){return Ua(e,-n,t)}function r0(){return typeof window<"u"}function mi(e){return Uy(e)?(e.nodeName||"").toLowerCase():"#document"}function Tn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Na(e){var n;return(n=(Uy(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function Uy(e){return r0()?e instanceof Node||e instanceof Tn(e).Node:!1}function un(e){return r0()?e instanceof Element||e instanceof Tn(e).Element:!1}function Ea(e){return r0()?e instanceof HTMLElement||e instanceof Tn(e).HTMLElement:!1}function Zg(e){return!r0()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Tn(e).ShadowRoot}function Il(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Hn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function lA(e){return["table","td","th"].includes(mi(e))}function n0(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Rp(e){const n=Mp(),t=un(e)?Hn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function cA(e){let n=Fs(e);for(;Ea(n)&&!ci(n);){if(Rp(n))return n;if(n0(n))return null;n=Fs(n)}return null}function Mp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ci(e){return["html","body","#document"].includes(mi(e))}function Hn(e){return Tn(e).getComputedStyle(e)}function a0(e){return un(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Fs(e){if(mi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Zg(e)&&e.host||Na(e);return Zg(n)?n.host:n}function Hy(e){const n=Fs(e);return ci(n)?e.ownerDocument?e.ownerDocument.body:e.body:Ea(n)&&Il(n)?n:Hy(n)}function Dl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=Hy(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Tn(a);if(o){const c=Bd(l);return n.concat(l,l.visualViewport||[],Il(a)?a:[],c&&t?Dl(c):[])}return n.concat(a,Dl(a,[],t))}function Bd(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const ui=Math.min,ao=Math.max,zu=Math.round,ou=Math.floor,_a=e=>({x:e,y:e}),uA={left:"right",right:"left",bottom:"top",top:"bottom"},fA={start:"end",end:"start"};function Wd(e,n,t){return ao(e,ui(n,t))}function jl(e,n){return typeof e=="function"?e(n):e}function fo(e){return e.split("-")[0]}function Ll(e){return e.split("-")[1]}function $y(e){return e==="x"?"y":"x"}function Ip(e){return e==="y"?"height":"width"}function so(e){return["top","bottom"].includes(fo(e))?"y":"x"}function jp(e){return $y(so(e))}function dA(e,n,t){t===void 0&&(t=!1);const r=Ll(e),a=jp(e),o=Ip(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=Bu(l)),[l,Bu(l)]}function pA(e){const n=Bu(e);return[Ud(e),n,Ud(n)]}function Ud(e){return e.replace(/start|end/g,n=>fA[n])}function hA(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function mA(e,n,t,r){const a=Ll(e);let o=hA(fo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map(Ud)))),o}function Bu(e){return e.replace(/left|right|bottom|top/g,n=>uA[n])}function xA(e){return{top:0,right:0,bottom:0,left:0,...e}}function Yy(e){return typeof e!="number"?xA(e):{top:e,right:e,bottom:e,left:e}}function Wu(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var Uu=typeof document<"u"?D.useLayoutEffect:D.useEffect;const gA={...Iv},vA=gA.useInsertionEffect,yA=vA||(e=>e());function wA(e){const n=D.useRef(()=>{});return yA(()=>{n.current=e}),D.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var Vy=Qd();const kA=Ku(Vy);function Jg(e,n,t){let{reference:r,floating:a}=e;const o=so(n),l=jp(n),c=Ip(l),f=fo(n),h=o==="y",p=r.x+r.width/2-a.width/2,x=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let y;switch(f){case"top":y={x:p,y:r.y-a.height};break;case"bottom":y={x:p,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:x};break;case"left":y={x:r.x-a.width,y:x};break;default:y={x:r.x,y:r.y}}switch(Ll(n)){case"start":y[l]-=g*(t&&h?-1:1);break;case"end":y[l]+=g*(t&&h?-1:1);break}return y}const _A=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let h=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:p,y:x}=Jg(h,r,f),g=r,y={},k=0;for(let w=0;w<c.length;w++){const{name:_,fn:E}=c[w],{x:A,y:T,data:j,reset:ee}=await E({x:p,y:x,initialPlacement:r,placement:g,strategy:a,middlewareData:y,rects:h,platform:l,elements:{reference:e,floating:n}});p=A??p,x=T??x,y={...y,[_]:{...y[_],...j}},ee&&k<=50&&(k++,typeof ee=="object"&&(ee.placement&&(g=ee.placement),ee.rects&&(h=ee.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):ee.rects),{x:p,y:x}=Jg(h,g,f)),w=-1)}return{x:p,y:x,placement:g,strategy:a,middlewareData:y}};async function Ky(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:x="floating",altBoundary:g=!1,padding:y=0}=jl(n,e),k=Yy(y),_=c[g?x==="floating"?"reference":"floating":x],E=Wu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(_)))==null||t?_:_.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:h,rootBoundary:p,strategy:f})),A=x==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,T=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),j=await(o.isElement==null?void 0:o.isElement(T))?await(o.getScale==null?void 0:o.getScale(T))||{x:1,y:1}:{x:1,y:1},ee=Wu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:A,offsetParent:T,strategy:f}):A);return{top:(E.top-ee.top+k.top)/j.y,bottom:(ee.bottom-E.bottom+k.bottom)/j.y,left:(E.left-ee.left+k.left)/j.x,right:(ee.right-E.right+k.right)/j.x}}const bA=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:h,padding:p=0}=jl(e,n)||{};if(h==null)return{};const x=Yy(p),g={x:t,y:r},y=jp(a),k=Ip(y),w=await l.getDimensions(h),_=y==="y",E=_?"top":"left",A=_?"bottom":"right",T=_?"clientHeight":"clientWidth",j=o.reference[k]+o.reference[y]-g[y]-o.floating[k],ee=g[y]-o.reference[y],R=await(l.getOffsetParent==null?void 0:l.getOffsetParent(h));let C=R?R[T]:0;(!C||!await(l.isElement==null?void 0:l.isElement(R)))&&(C=c.floating[T]||o.floating[k]);const Q=j/2-ee/2,M=C/2-w[k]/2-1,te=ui(x[E],M),K=ui(x[A],M),B=te,fe=C-w[k]-K,ue=C/2-w[k]/2+Q,oe=Wd(B,ue,fe),he=!f.arrow&&Ll(a)!=null&&ue!==oe&&o.reference[k]/2-(ue<B?te:K)-w[k]/2<0,V=he?ue<B?ue-B:ue-fe:0;return{[y]:g[y]+V,data:{[y]:oe,centerOffset:ue-oe-V,...he&&{alignmentOffset:V}},reset:he}}}),EA=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:h}=n,{mainAxis:p=!0,crossAxis:x=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:w=!0,..._}=jl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const E=fo(a),A=so(c),T=fo(c)===c,j=await(f.isRTL==null?void 0:f.isRTL(h.floating)),ee=g||(T||!w?[Bu(c)]:pA(c)),R=k!=="none";!g&&R&&ee.push(...mA(c,w,k,j));const C=[c,...ee],Q=await Ky(n,_),M=[];let te=((r=o.flip)==null?void 0:r.overflows)||[];if(p&&M.push(Q[E]),x){const oe=dA(a,l,j);M.push(Q[oe[0]],Q[oe[1]])}if(te=[...te,{placement:a,overflows:M}],!M.every(oe=>oe<=0)){var K,B;const oe=(((K=o.flip)==null?void 0:K.index)||0)+1,he=C[oe];if(he){var fe;const le=x==="alignment"?A!==so(he):!1,J=((fe=te[0])==null?void 0:fe.overflows[0])>0;if(!le||J)return{data:{index:oe,overflows:te},reset:{placement:he}}}let V=(B=te.filter(le=>le.overflows[0]<=0).sort((le,J)=>le.overflows[1]-J.overflows[1])[0])==null?void 0:B.placement;if(!V)switch(y){case"bestFit":{var ue;const le=(ue=te.filter(J=>{if(R){const ae=so(J.placement);return ae===A||ae==="y"}return!0}).map(J=>[J.placement,J.overflows.filter(ae=>ae>0).reduce((ae,W)=>ae+W,0)]).sort((J,ae)=>J[1]-ae[1])[0])==null?void 0:ue[0];le&&(V=le);break}case"initialPlacement":V=c;break}if(a!==V)return{reset:{placement:V}}}return{}}}};async function SA(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=fo(t),c=Ll(t),f=so(t)==="y",h=["left","top"].includes(l)?-1:1,p=o&&f?-1:1,x=jl(n,e);let{mainAxis:g,crossAxis:y,alignmentAxis:k}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return c&&typeof k=="number"&&(y=c==="end"?k*-1:k),f?{x:y*p,y:g*h}:{x:g*h,y:y*p}}const TA=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await SA(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},CA=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:_=>{let{x:E,y:A}=_;return{x:E,y:A}}},...f}=jl(e,n),h={x:t,y:r},p=await Ky(n,f),x=so(fo(a)),g=$y(x);let y=h[g],k=h[x];if(o){const _=g==="y"?"top":"left",E=g==="y"?"bottom":"right",A=y+p[_],T=y-p[E];y=Wd(A,y,T)}if(l){const _=x==="y"?"top":"left",E=x==="y"?"bottom":"right",A=k+p[_],T=k-p[E];k=Wd(A,k,T)}const w=c.fn({...n,[g]:y,[x]:k});return{...w,data:{x:w.x-t,y:w.y-r,enabled:{[g]:o,[x]:l}}}}}};function Gy(e){const n=Hn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Ea(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=zu(t)!==o||zu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function Lp(e){return un(e)?e:e.contextElement}function ti(e){const n=Lp(e);if(!Ea(n))return _a(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Gy(n);let l=(o?zu(t.width):t.width)/r,c=(o?zu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const DA=_a(0);function Xy(e){const n=Tn(e);return!Mp()||!n.visualViewport?DA:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function NA(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Tn(e)?!1:n}function po(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=Lp(e);let l=_a(1);n&&(r?un(r)&&(l=ti(r)):l=ti(e));const c=NA(o,t,r)?Xy(o):_a(0);let f=(a.left+c.x)/l.x,h=(a.top+c.y)/l.y,p=a.width/l.x,x=a.height/l.y;if(o){const g=Tn(o),y=r&&un(r)?Tn(r):r;let k=g,w=Bd(k);for(;w&&r&&y!==k;){const _=ti(w),E=w.getBoundingClientRect(),A=Hn(w),T=E.left+(w.clientLeft+parseFloat(A.paddingLeft))*_.x,j=E.top+(w.clientTop+parseFloat(A.paddingTop))*_.y;f*=_.x,h*=_.y,p*=_.x,x*=_.y,f+=T,h+=j,k=Tn(w),w=Bd(k)}}return Wu({width:p,height:x,x:f,y:h})}function zp(e,n){const t=a0(e).scrollLeft;return n?n.left+t:po(Na(e)).left+t}function Qy(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:zp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function FA(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Na(r),c=n?n0(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},h=_a(1);const p=_a(0),x=Ea(r);if((x||!x&&!o)&&((mi(r)!=="body"||Il(l))&&(f=a0(r)),Ea(r))){const y=po(r);h=ti(r),p.x=y.x+r.clientLeft,p.y=y.y+r.clientTop}const g=l&&!x&&!o?Qy(l,f,!0):_a(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-f.scrollLeft*h.x+p.x+g.x,y:t.y*h.y-f.scrollTop*h.y+p.y+g.y}}function AA(e){return Array.from(e.getClientRects())}function OA(e){const n=Na(e),t=a0(e),r=e.ownerDocument.body,a=ao(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=ao(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+zp(e);const c=-t.scrollTop;return Hn(r).direction==="rtl"&&(l+=ao(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function PA(e,n){const t=Tn(e),r=Na(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const h=Mp();(!h||h&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function RA(e,n){const t=po(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Ea(e)?ti(e):_a(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,h=r*o.y;return{width:l,height:c,x:f,y:h}}function ev(e,n,t){let r;if(n==="viewport")r=PA(e,t);else if(n==="document")r=OA(Na(e));else if(un(n))r=RA(n,t);else{const a=Xy(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Wu(r)}function qy(e,n){const t=Fs(e);return t===n||!un(t)||ci(t)?!1:Hn(t).position==="fixed"||qy(t,n)}function MA(e,n){const t=n.get(e);if(t)return t;let r=Dl(e,[],!1).filter(c=>un(c)&&mi(c)!=="body"),a=null;const o=Hn(e).position==="fixed";let l=o?Fs(e):e;for(;un(l)&&!ci(l);){const c=Hn(l),f=Rp(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Il(l)&&!f&&qy(e,l))?r=r.filter(p=>p!==l):a=c,l=Fs(l)}return n.set(e,r),r}function IA(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?n0(n)?[]:MA(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((h,p)=>{const x=ev(n,p,a);return h.top=ao(x.top,h.top),h.right=ui(x.right,h.right),h.bottom=ui(x.bottom,h.bottom),h.left=ao(x.left,h.left),h},ev(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function jA(e){const{width:n,height:t}=Gy(e);return{width:n,height:t}}function LA(e,n,t){const r=Ea(n),a=Na(n),o=t==="fixed",l=po(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=_a(0);function h(){f.x=zp(a)}if(r||!r&&!o)if((mi(n)!=="body"||Il(a))&&(c=a0(n)),r){const y=po(n,!0,o,n);f.x=y.x+n.clientLeft,f.y=y.y+n.clientTop}else a&&h();o&&!r&&a&&h();const p=a&&!r&&!o?Qy(a,c):_a(0),x=l.left+c.scrollLeft-f.x-p.x,g=l.top+c.scrollTop-f.y-p.y;return{x,y:g,width:l.width,height:l.height}}function cd(e){return Hn(e).position==="static"}function tv(e,n){if(!Ea(e)||Hn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Na(e)===t&&(t=t.ownerDocument.body),t}function Zy(e,n){const t=Tn(e);if(n0(e))return t;if(!Ea(e)){let a=Fs(e);for(;a&&!ci(a);){if(un(a)&&!cd(a))return a;a=Fs(a)}return t}let r=tv(e,n);for(;r&&lA(r)&&cd(r);)r=tv(r,n);return r&&ci(r)&&cd(r)&&!Rp(r)?t:r||cA(e)||t}const zA=async function(e){const n=this.getOffsetParent||Zy,t=this.getDimensions,r=await t(e.floating);return{reference:LA(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function BA(e){return Hn(e).direction==="rtl"}const WA={convertOffsetParentRelativeRectToViewportRelativeRect:FA,getDocumentElement:Na,getClippingRect:IA,getOffsetParent:Zy,getElementRects:zA,getClientRects:AA,getDimensions:jA,getScale:ti,isElement:un,isRTL:BA};function Jy(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function UA(e,n){let t=null,r;const a=Na(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const h=e.getBoundingClientRect(),{left:p,top:x,width:g,height:y}=h;if(c||n(),!g||!y)return;const k=ou(x),w=ou(a.clientWidth-(p+g)),_=ou(a.clientHeight-(x+y)),E=ou(p),T={rootMargin:-k+"px "+-w+"px "+-_+"px "+-E+"px",threshold:ao(0,ui(1,f))||1};let j=!0;function ee(R){const C=R[0].intersectionRatio;if(C!==f){if(!j)return l();C?l(!1,C):r=setTimeout(()=>{l(!1,1e-7)},1e3)}C===1&&!Jy(h,e.getBoundingClientRect())&&l(),j=!1}try{t=new IntersectionObserver(ee,{...T,root:a.ownerDocument})}catch{t=new IntersectionObserver(ee,T)}t.observe(e)}return l(!0),o}function ew(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,h=Lp(e),p=a||o?[...h?Dl(h):[],...Dl(n)]:[];p.forEach(E=>{a&&E.addEventListener("scroll",t,{passive:!0}),o&&E.addEventListener("resize",t)});const x=h&&c?UA(h,t):null;let g=-1,y=null;l&&(y=new ResizeObserver(E=>{let[A]=E;A&&A.target===h&&y&&(y.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var T;(T=y)==null||T.observe(n)})),t()}),h&&!f&&y.observe(h),y.observe(n));let k,w=f?po(e):null;f&&_();function _(){const E=po(e);w&&!Jy(w,E)&&t(),w=E,k=requestAnimationFrame(_)}return t(),()=>{var E;p.forEach(A=>{a&&A.removeEventListener("scroll",t),o&&A.removeEventListener("resize",t)}),x?.(),(E=y)==null||E.disconnect(),y=null,f&&cancelAnimationFrame(k)}}const tw=TA,HA=CA,rw=EA,Hd=bA,$d=(e,n,t)=>{const r=new Map,a={platform:WA,...t},o={...a.platform,_c:r};return _A(e,n,{...a,platform:o})};var gu=typeof document<"u"?D.useLayoutEffect:D.useEffect;function Hu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Hu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Hu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function nw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function rv(e,n){const t=nw(e);return Math.round(n*t)/t}function ud(e){const n=D.useRef(e);return gu(()=>{n.current=e}),n}function $A(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:h}=e,[p,x]=D.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,y]=D.useState(r);Hu(g,r)||y(r);const[k,w]=D.useState(null),[_,E]=D.useState(null),A=D.useCallback(le=>{le!==R.current&&(R.current=le,w(le))},[]),T=D.useCallback(le=>{le!==C.current&&(C.current=le,E(le))},[]),j=o||k,ee=l||_,R=D.useRef(null),C=D.useRef(null),Q=D.useRef(p),M=f!=null,te=ud(f),K=ud(a),B=ud(h),fe=D.useCallback(()=>{if(!R.current||!C.current)return;const le={placement:n,strategy:t,middleware:g};K.current&&(le.platform=K.current),$d(R.current,C.current,le).then(J=>{const ae={...J,isPositioned:B.current!==!1};ue.current&&!Hu(Q.current,ae)&&(Q.current=ae,Vy.flushSync(()=>{x(ae)}))})},[g,n,t,K,B]);gu(()=>{h===!1&&Q.current.isPositioned&&(Q.current.isPositioned=!1,x(le=>({...le,isPositioned:!1})))},[h]);const ue=D.useRef(!1);gu(()=>(ue.current=!0,()=>{ue.current=!1}),[]),gu(()=>{if(j&&(R.current=j),ee&&(C.current=ee),j&&ee){if(te.current)return te.current(j,ee,fe);fe()}},[j,ee,fe,te,M]);const oe=D.useMemo(()=>({reference:R,floating:C,setReference:A,setFloating:T}),[A,T]),he=D.useMemo(()=>({reference:j,floating:ee}),[j,ee]),V=D.useMemo(()=>{const le={position:t,left:0,top:0};if(!he.floating)return le;const J=rv(he.floating,p.x),ae=rv(he.floating,p.y);return c?{...le,transform:"translate("+J+"px, "+ae+"px)",...nw(he.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:J,top:ae}},[t,c,he.floating,p.x,p.y]);return D.useMemo(()=>({...p,update:fe,refs:oe,elements:he,floatingStyles:V}),[p,fe,oe,he,V])}const YA=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?Hd({element:r.current,padding:a}).fn(t):{}:r?Hd({element:r,padding:a}).fn(t):{}}}},VA=(e,n)=>({...tw(e),options:[e,n]}),KA=(e,n)=>({...rw(e),options:[e,n]}),GA=(e,n)=>({...YA(e),options:[e,n]}),XA={...Iv};let nv=!1,QA=0;const av=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+QA++;function qA(){const[e,n]=D.useState(()=>nv?av():void 0);return Uu(()=>{e==null&&n(av())},[]),D.useEffect(()=>{nv=!0},[]),e}const ZA=XA.useId,aw=ZA||qA,JA=D.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:x,stroke:g,d:y,style:{transform:k,...w}={},..._}=n,E=aw(),[A,T]=D.useState(!1);if(Uu(()=>{if(!a)return;Hn(a).direction==="rtl"&&T(!0)},[a]),!a)return null;const[j,ee]=r.split("-"),R=j==="top"||j==="bottom";let C=x;(R&&l!=null&&l.x||!R&&l!=null&&l.y)&&(C=null);const Q=p*2,M=Q/2,te=c/2*(h/-8+1),K=f/2*h/4,B=!!y,fe=C&&ee==="end"?"bottom":"top";let ue=C&&ee==="end"?"right":"left";C&&A&&(ue=ee==="end"?"left":"right");const oe=o?.x!=null?C||o.x:"",he=o?.y!=null?C||o.y:"",V=y||"M0,0"+(" H"+c)+(" L"+(c-te)+","+(f-K))+(" Q"+c/2+","+f+" "+te+","+(f-K))+" Z",le={top:B?"rotate(180deg)":"",left:B?"rotate(90deg)":"rotate(-90deg)",bottom:B?"":"rotate(180deg)",right:B?"rotate(-90deg)":"rotate(90deg)"}[j];return d.jsxs("svg",{..._,"aria-hidden":!0,ref:t,width:B?c:c+Q,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[ue]:oe,[fe]:he,[j]:R||B?"100%":"calc(100% - "+Q/2+"px)",transform:[le,k].filter(J=>!!J).join(" "),...w},children:[Q>0&&d.jsx("path",{clipPath:"url(#"+E+")",fill:"none",stroke:g,strokeWidth:Q+(y?0:1),d:V}),d.jsx("path",{stroke:Q&&!y?_.fill:"none",d:V}),d.jsx("clipPath",{id:E,children:d.jsx("rect",{x:-M,y:M*(B?-1:1),width:c+Q,height:c})})]})});function eO(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const tO=D.createContext(null),rO=D.createContext(null),nO=()=>{var e;return((e=D.useContext(tO))==null?void 0:e.id)||null},aO=()=>D.useContext(rO);function sO(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=aw(),o=D.useRef({}),[l]=D.useState(()=>eO()),c=nO()!=null,[f,h]=D.useState(r.reference),p=wA((y,k,w)=>{o.current.openEvent=y?k:void 0,l.emit("openchange",{open:y,event:k,reason:w,nested:c}),t?.(y,k,w)}),x=D.useMemo(()=>({setPositionReference:h}),[]),g=D.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return D.useMemo(()=>({dataRef:o,open:n,onOpenChange:p,elements:g,events:l,floatingId:a,refs:x}),[n,p,g,l,a,x])}function oO(e){e===void 0&&(e={});const{nodeId:n}=e,t=sO({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=D.useState(null),[c,f]=D.useState(null),p=a?.domReference||o,x=D.useRef(null),g=aO();Uu(()=>{p&&(x.current=p)},[p]);const y=$A({...e,elements:{...a,...c&&{reference:c}}}),k=D.useCallback(T=>{const j=un(T)?{getBoundingClientRect:()=>T.getBoundingClientRect(),getClientRects:()=>T.getClientRects(),contextElement:T}:T;f(j),y.refs.setReference(j)},[y.refs]),w=D.useCallback(T=>{(un(T)||T===null)&&(x.current=T,l(T)),(un(y.refs.reference.current)||y.refs.reference.current===null||T!==null&&!un(T))&&y.refs.setReference(T)},[y.refs]),_=D.useMemo(()=>({...y.refs,setReference:w,setPositionReference:k,domReference:x}),[y.refs,w,k]),E=D.useMemo(()=>({...y.elements,domReference:p}),[y.elements,p]),A=D.useMemo(()=>({...y,...r,refs:_,elements:E,nodeId:n}),[y,_,E,n,r]);return Uu(()=>{r.dataRef.current.floatingContext=A;const T=g?.nodesRef.current.find(j=>j.id===n);T&&(T.context=A)}),D.useMemo(()=>({...y,context:A,refs:_,elements:E}),[y,_,E,A])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Yd=function(n,t){return Yd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},Yd(n,t)};function jr(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Yd(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var Rt=function(){return Rt=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Rt.apply(this,arguments)};function ka(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var iO=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return Ce.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},lO=function(e,n){var t=D.useRef(null),r=D.useRef(e);r.current=e;var a=D.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return D.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},s0=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=lO(t,l);return Ce.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},Ke;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(Ke||(Ke={}));function Bp(){var e=typeof window<"u"?window:globalThis;return e}var zl=12;function Wt(e){if(e==null)return new Date;var n=typeof e=="string"?VF(e):nt(e);return o0(n)?n:new Date}function fd(e,n,t,r,a){a===void 0&&(a=Wt());for(var o=fi(t)||fi(Wp()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var h=f[c],p=zF(e,h,a,{locale:o});if(o0(p)&&(!r||e===ar(p,h,t)))return p}return null}function o0(e,n){return Ru(e)&&!uo(e,new Date("1/1/1800"))}function ar(e,n,t){if(t==="en")return Xg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?fi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||fi(Wp()),Xg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function zn(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&ar(e,a,r)||""}function cO(e,n,t){if(!e)return"";var r=zn(e,t),a=n?zn(n,t):"";return"".concat(r," - ").concat(a)}function uO(e,n){if(!e?.length)return"";var t=e[0]?zn(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=zn(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function dd(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return hu(mu(xu(e,c),o),r)}function fO(e){return Fp(e)}function dO(e,n){return ar(e,"ddd",n)}function vu(e){return co(e)}function Ts(e,n,t){var r=fi(n||Wp());return oa(e,{locale:r,weekStartsOn:t})}function Va(e){return Fy(e)}function ol(e){return t0(e)}function sv(e){return jd(e)}function ov(){return co(Wt())}function iv(e){return Dy(e)}function pO(e){return V4(e)}function hO(e){return Ny(e)}function xa(e,n){return e&&n?$F(e,n):!e&&!n}function an(e,n){return e&&n?UF(e,n):!e&&!n}function $u(e,n){return e&&n?HF(e,n):!e&&!n}function Pt(e,n){return e&&n?$4(e,n):!e&&!n}function qs(e,n){return e&&n?$3(e,n):!e&&!n}function il(e,n,t){var r,a=co(n),o=Dy(t);try{r=Cl(e,{start:a,end:o})}catch{r=!1}return r}function xi(e,n){var t=Bp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function Wp(){var e=Bp();return e.__localeId__}function fi(e){if(typeof e=="string"){var n=Bp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function mO(e,n,t){return n(ar(e,"EEEE",t))}function xO(e,n){return ar(e,"EEEEEE",n)}function gO(e,n){return ar(e,"EEE",n)}function Up(e,n){return ar(Bn(Wt(),e),"LLLL",n)}function sw(e,n){return ar(Bn(Wt(),e),"LLL",n)}function vO(e,n){return ar(Xo(Wt(),e),"QQQ",n)}function Wn(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,h=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(p){return p instanceof Date?Pt(e,p):Pt(e,p.date)})||l&&l.some(function(p){var x=p.start,g=p.end;return Cl(e,{start:x,end:g})})||c&&!c.some(function(p){return Pt(e,p)})||f&&!f.some(function(p){var x=p.start,g=p.end;return Cl(e,{start:x,end:g})})||h&&!h(Wt(e))||!1}function Hp(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Cl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?Pt(e,o):Pt(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function ow(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r?Fy(r):void 0,maxDate:a?Ny(a):void 0})||o?.some(function(f){return an(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return an(e,f)})||c&&!c(Wt(e))||!1}function iu(e,n,t,r){var a=_t(e),o=cn(e),l=_t(n),c=cn(n),f=_t(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function yO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return Bl(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return an(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return an(c,e)})||!1}function lu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return Bl(e,{minDate:r,maxDate:a})||o?.some(function(f){return $u(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return $u(e,f)})||c&&!c(Wt(e))||!1}function cu(e,n,t){if(!n||!t||!Ru(n)||!Ru(t))return!1;var r=_t(n),a=_t(t);return r<=e&&a>=e}function yu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return Bl(f,{minDate:r?t0(r):void 0,maxDate:a?Ay(a):void 0})||o?.some(function(h){return xa(f,h instanceof Date?h:h.date)})||l&&!l.some(function(h){return xa(f,h)})||c&&!c(Wt(f))||!1}function uu(e,n,t,r){var a=_t(e),o=ro(e),l=_t(n),c=ro(n),f=_t(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function Bl(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&ii(e,a)<0||o&&ii(e,o)>0)!==null&&t!==void 0?t:!1}function lv(e,n){return n.some(function(t){return $a(t)===$a(e)&&Ya(t)===Ya(e)&&Ss(t)===Ss(e)})}function cv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&lv(e,r)||a&&!lv(e,a)||o&&!o(e)||!1}function uv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Wt();a=hu(a,$a(e)),a=mu(a,Ya(e)),a=xu(a,Ss(e));var o=Wt();o=hu(o,$a(t)),o=mu(o,Ya(t)),o=xu(o,Ss(t));var l=Wt();l=hu(l,$a(r)),l=mu(l,Ya(r)),l=xu(l,Ss(r));var c;try{c=!Cl(a,{start:o,end:l})}catch{c=!1}return c}function fv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=no(e,1);return r&&Mu(r,o)>0||a&&a.every(function(l){return Mu(l,o)>0})||!1}function dv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=sa(e,1);return r&&Mu(o,r)>0||a&&a.every(function(l){return Mu(o,l)>0})||!1}function wO(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=t0(e),l=Wy(o);return r&&Iu(r,l)>0||a&&a.every(function(c){return Iu(c,l)>0})||!1}function kO(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ay(e),l=Np(o,1);return r&&Iu(l,r)>0||a&&a.every(function(c){return Iu(l,c)>0})||!1}function pv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=li(e,1);return r&&ju(r,o)>0||a&&a.every(function(l){return ju(l,o)>0})||!1}function _O(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=ol(li(e,o)),c=bs(l,o).endPeriod,f=r&&_t(r);return f&&f>c||!1}function hv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ua(e,1);return r&&ju(o,r)>0||a&&a.every(function(l){return ju(o,l)>0})||!1}function bO(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?zl:a,l=Ua(e,o),c=bs(l,o).startPeriod,f=r&&_t(r);return f&&f<c||!1}function iw(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)>=0});return Hg(r)}else return t?Hg(t):n}function lw(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return ii(a,n)<=0});return Ug(r)}else return t?Ug(t):n}function mv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Ha(l)){var c=ar(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var h=Object.keys(l),p=(t=h[0])!==null&&t!==void 0?t:"",x=l[p];if(typeof p=="string"&&Array.isArray(x))for(var g=0,y=x.length;g<y;g++){var k=x[g];if(k){var c=ar(k,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(p)||(f.push(p),r.set(c,f))}}}}return r}function EO(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function SO(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Ha(a)){var l=ar(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&EO(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?ka(ka([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function TO(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,h=a[c];h&&(f=B4(f,$a(h)),f=Id(f,Ya(h)),f=H4(f,Ss(h)));var p=Id(e,(t+1)*r);Ns(f,n)&&uo(f,p)&&h!=null&&l.push(h)}return l}function xv(e){return e<10?"0".concat(e):"".concat(e)}function bs(e,n){n===void 0&&(n=zl);var t=Math.ceil(_t(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function CO(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function gv(e){var n=e.getSeconds(),t=e.getMilliseconds();return nt(e.getTime()-n*1e3-t)}function DO(e,n){return gv(e).getTime()===gv(n).getTime()}function vv(e){if(!Ha(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function yv(e,n){if(!Ha(e)||!Ha(n))throw new Error("Invalid date received");var t=vv(e),r=vv(n);return uo(t,r)}function cw(e){return e.key===Ke.Space}var NO=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=Ce.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),h=f?c:new Date;if(a?.includes(":")){var p=a.split(":"),x=p[0],g=p[1];h.setHours(Number(x)),h.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,h)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?D.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):Ce.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var h;(h=r.inputRef.current)===null||h===void 0||h.focus()},required:!0,value:a,onChange:function(h){r.onTimeChange(h.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return Ce.createElement("div",{className:"react-datepicker__input-time-container"},Ce.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),Ce.createElement("div",{className:"react-datepicker-time__input-container"},Ce.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(D.Component),FO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=D.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Ke.Space&&(r.preventDefault(),r.key=Ke.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return Pt(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Hp(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Pt(t.props.day,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&Pt(r,Ts(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=ar(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=ar(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:il(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,h=a.selectsDisabledDaysInRange,p=a.startDate,x=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!h&&t.isDisabled()?!1:l&&x&&(uo(g,x)||qs(g,x))?il(o,g,x):c&&p&&!x&&(Ns(g,p)||qs(g,p))||f&&p&&!x&&(Ns(g,p)||qs(g,p))?il(o,p,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?Pt(o,f):Pt(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,h=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?Pt(o,h):Pt(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Pt(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Pt(l,a)},t.isWeekend=function(){var r=B3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===cn(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(cn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Wt())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Wr("react-datepicker__day",a,"react-datepicker__day--"+dO(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,h=t.isDisabled()||t.isExcluded()?f:l;return"".concat(h," ").concat(ar(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=ar(a,"MM.dd.yyyy"),h=[];return l.has(f)&&h.push.apply(h,l.get(f).holidayNames),t.isExcluded()&&h.push(c?.filter(function(p){return p instanceof Date?Pt(p,a):Pt(p?.date,a)}).map(function(p){if(!(p instanceof Date))return p?.message})),h.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&Pt(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Qg(t.props.day),t.props.day):Qg(t.props.day)},t.render=function(){return Ce.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&Ce.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(D.Component),AO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=D.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===Ke.Space&&(r.preventDefault(),r.key=Ke.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Pt(t.props.date,t.props.selected)&&Pt(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Pt(t.props.date,t.props.selected)&&Pt(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&Pt(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&Pt(this.props.date,this.props.selected)};return Ce.createElement("div",{ref:this.weekNumberEl,className:Wr(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(D.Component),OO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,h=new Date(r),p=0;p<7;p++){var x=new Date(r);x.setDate(x.getDate()+p);var g=!t.isDisabled(x);if(g){h=x;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(h,a,o),t.props.showWeekPicker&&t.handleDayClick(h,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):fO(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=aa(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=aa(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(Ce.createElement(AO,Rt({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(r,c);return Ce.createElement(FO,Rt({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Ts(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Pt(t.startOfWeek(),t.props.selected)&&Pt(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Pt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return Ce.createElement("div",{className:Wr(t)},this.renderDays())},n})(D.Component),tl,PO=6,ri={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},pd=(tl={},tl[ri.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},tl[ri.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},tl[ri.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},tl),fu=1;function wv(e,n){return e?ri.FOUR_COLUMNS:n?ri.TWO_COLUMNS:ri.THREE_COLUMNS}var RO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=ka([],Array(12),!0).map(function(){return D.createRef()}),t.QUARTER_REFS=ka([],Array(4),!0).map(function(){return D.createRef()}),t.isDisabled=function(r){return Wn(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return Hp(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Bn(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:$u(Xo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Bn(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:$u(Xo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&x?iu(g,x,r,l):f&&p||h&&p&&!x?iu(p,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,h=Bn(l,r),p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?an(h,p):an(h,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,h=o.selectsRange,p=Bn(l,r),x=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||h?an(p,x):an(p,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,x=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&x?uu(g,x,r,l):f&&p||h&&p&&!x?uu(p,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=aa(r,6);return an(r,a)||an(o,a)},t.isCurrentMonth=function(r,a){return _t(r)===_t(Wt())&&a===cn(Wt())},t.isCurrentQuarter=function(r,a){return _t(r)===_t(Wt())&&a===ro(Wt())},t.isSelectedMonth=function(r,a,o){return cn(o)===a&&_t(r)===_t(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return ro(r)===a&&_t(r)===_t(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Ts(Va(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.preSelection},h=function(k){return t.props.showWeekPicker?Ts(k,t.props.locale,t.props.calendarStartDay):t.props.selected},p=t.props.selected?h(t.props.selected):void 0,x=t.props.preSelection?f(t.props.preSelection):void 0;r.push(Ce.createElement(OO,Rt({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:cn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:p,preSelection:x,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=Pu(c,1);var g=a&&o>=PO,y=!a&&!t.isWeekInMonth(c);if(g||y)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Va(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Va(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,h=c.preSelection,p=c.setPreSelection,x=c.minDate,g=c.maxDate,y=c.showFourColumnMonthYearPicker,k=c.showTwoColumnMonthYearPicker;if(h){var w=wv(y,k),_=t.getVerticalOffset(w),E=(l=pd[w])===null||l===void 0?void 0:l.grid,A=function(C,Q,M){var te,K,B=Q,fe=M;switch(C){case Ke.ArrowRight:B=sa(Q,fu),fe=M===11?0:M+fu;break;case Ke.ArrowLeft:B=no(Q,fu),fe=M===0?11:M-fu;break;case Ke.ArrowUp:B=no(Q,_),fe=!((te=E?.[0])===null||te===void 0)&&te.includes(M)?M+12-_:M-_;break;case Ke.ArrowDown:B=sa(Q,_),fe=!((K=E?.[E.length-1])===null||K===void 0)&&K.includes(M)?M-12+_:M+_;break}return{newCalculatedDate:B,newCalculatedMonth:fe}},T=function(C,Q,M){for(var te=40,K=C,B=!1,fe=0,ue=A(K,Q,M),oe=ue.newCalculatedDate,he=ue.newCalculatedMonth;!B;){if(fe>=te){oe=Q,he=M;break}if(x&&oe<x){K=Ke.ArrowRight;var V=A(K,oe,he);oe=V.newCalculatedDate,he=V.newCalculatedMonth}if(g&&oe>g){K=Ke.ArrowLeft;var V=A(K,oe,he);oe=V.newCalculatedDate,he=V.newCalculatedMonth}if(yO(oe,t.props)){var V=A(K,oe,he);oe=V.newCalculatedDate,he=V.newCalculatedMonth}else B=!0;fe++}return{newCalculatedDate:oe,newCalculatedMonth:he}};if(a===Ke.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),p?.(f));return}var j=T(a,h,o),ee=j.newCalculatedDate,R=j.newCalculatedMonth;switch(a){case Ke.ArrowRight:case Ke.ArrowLeft:case Ke.ArrowUp:case Ke.ArrowDown:t.handleMonthNavigation(R,ee);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=pd[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==Ke.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Xo(t.props.day,a);lu(o,t.props)||t.handleDayClick(sv(o),r)},t.onQuarterMouseEnter=function(r){var a=Xo(t.props.day,r);lu(a,t.props)||t.handleDayMouseEnter(sv(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case Ke.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case Ke.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Np(t.props.preSelection,1));break;case Ke.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,Wy(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,x=Bn(l,r);return{isDisabled:(a=(c||f||h||p)&&ow(x,t.props))!==null&&a!==void 0?a:!1,labelDate:x}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,h=a.monthClassName,p=h?h(Bn(o,r)):void 0,x=t.getSelection();return Wr("react-datepicker__month-text","react-datepicker__month-".concat(r),p,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":x?t.isSelectMonthInList(o,r,x):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?iu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=cn(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=ro(t.props.preSelection),o=lu(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,h=a.day,p=a.locale,x=Bn(h,r),g=t.isDisabled(x)||t.isExcluded(x)?f:l;return"".concat(g," ").concat(ar(x,"MMMM yyyy",p))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,h=a.minDate,p=a.maxDate,x=a.excludeDates,g=a.includeDates,y=a.filterDate,k=a.preSelection,w=a.disabledKeyboardNavigation,_=(h||p||x||g||y)&&lu(Xo(o,r),t.props);return Wr("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":_,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!w&&k&&t.isSelectedQuarter(o,r,k)&&!_,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,h=sw(r,c),p=Up(r,c);return l?l(r,h,p,f):o?p:h},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=vO(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,h=(r=pd[wv(l,o)])===null||r===void 0?void 0:r.grid;return h?.map(function(p,x){return Ce.createElement("div",{className:"react-datepicker__month-wrapper",key:x},p.map(function(g,y){return Ce.createElement("div",{ref:t.MONTH_REFS[g],key:y,onClick:function(k){t.onMonthClick(k,g)},onKeyDown:function(k){cw(k)&&(k.preventDefault(),k.key=Ke.Enter),t.onMonthKeyDown(k,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return Ce.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return Ce.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(h){t.onQuarterClick(h,c)},onKeyDown:function(h){t.onQuarterKeyDown(h,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,h=r.showWeekPicker;return Wr("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":h})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return Ce.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(ar(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(D.Component),MO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return Ce.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?Ce.createElement("span",{className:"react-datepicker__month-option--selected"},"✓"):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return Ce.createElement(s0,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(D.Component),IO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return Ce.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return Ce.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return Ce.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},Ce.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),Ce.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return Ce.createElement(MO,Rt({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return sw(o,t.props.locale)}:function(o){return Up(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return Ce.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(D.Component);function jO(e,n){for(var t=[],r=Va(e),a=Va(n);!Ns(r,a);)t.push(Wt(r)),r=sa(r,1);return t}var LO=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=zd(a),l=xa(r.props.date,a)&&an(r.props.date,a);return Ce.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?Ce.createElement("span",{className:"react-datepicker__month-year-option--selected"},"✓"):"",ar(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:jO(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Wr({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return Ce.createElement(s0,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(D.Component),zO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Va(t.props.minDate),a=Va(t.props.maxDate),o=[];!Ns(r,a);){var l=zd(r);o.push(Ce.createElement("option",{key:l,value:l},ar(r,t.props.dateFormat,t.props.locale))),r=sa(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Ce.createElement("select",{value:zd(Va(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=ar(t.props.date,t.props.dateFormat,t.props.locale);return Ce.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},Ce.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),Ce.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return Ce.createElement(LO,Rt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Wt(r);xa(t.props.date,a)&&an(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Ce.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(D.Component),BO=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&DO(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&uv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&cv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&($a(r)*3600+Ya(r)*60+Ss(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===Ke.Space&&(r.preventDefault(),r.key=Ke.Enter),(r.key===Ke.ArrowUp||r.key===Ke.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===Ke.ArrowDown||r.key===Ke.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===Ke.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Wt(),f=vu(c),h=t.props.injectTimes&&t.props.injectTimes.sort(function(_,E){return _.getTime()-E.getTime()}),p=60*CO(c),x=p/l,g=0;g<x;g++){var y=Id(f,g*l);if(a.push(y),h){var k=TO(f,y,g,l,h);a=a.concat(k)}}var w=a.reduce(function(_,E){return E.getTime()<=c.getTime()?E:_},a[0]);return a.map(function(_){return Ce.createElement("li",{key:_.valueOf(),onClick:t.handleClick.bind(t,_),className:t.liClasses(_),ref:function(E){_===w&&(t.centerLi=E)},onKeyDown:function(E){t.handleOnKeyDown(E,_)},tabIndex:_===w?0:-1,role:"option","aria-selected":t.isSelectedTime(_)?"true":void 0,"aria-disabled":t.isDisabledTime(_)?"true":void 0},ar(_,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?Ce.createElement(Ce.Fragment,null):Ce.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},Ce.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return Ce.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),Ce.createElement("div",{className:"react-datepicker__time"},Ce.createElement("div",{className:"react-datepicker__time-box"},Ce.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(D.Component),kv=3,WO=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=ka([],Array(r.props.yearItemNumber),!0).map(function(){return D.createRef()}),r.isDisabled=function(a){return Wn(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return Hp(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,h,p=r.props,x=p.date,g=p.yearItemNumber;if(!(x===void 0||g===void 0)){var y=bs(x,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-y<0?r.updateFocusOnPaginate(g-(y-a)):a-y>=g?r.updateFocusOnPaginate(Math.abs(g-(a-y))):(h=(f=r.YEAR_REFS[a-y])===null||f===void 0?void 0:f.current)===null||h===void 0||h.focus())}},r.isSameDay=function(a,o){return Pt(a,o)},r.isCurrentYear=function(a){return a===_t(Wt())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&xa(ma(Wt(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&xa(ma(Wt(),a),r.props.endDate)},r.isInRange=function(a){return cu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,h=o.startDate,p=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&p?cu(a,r.selectingDate(),p):c&&h||f&&h&&!p?cu(a,h,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,h=ma(Wt(),a);return f?xa(h,(o=r.selectingDate())!==null&&o!==void 0?o:null):xa(h,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,h=l.selectsRange,p=ma(Wt(),a);return f||h?xa(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):xa(p,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,h=o.includeDates,p=o.filterDate,x=ol(ma(r.props.date,a)),g=(l||c||f||h||p)&&yu(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Pt(x,ol(r.props.selected))&&Pt(x,ol(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(h){return a===_t(h)}):!c||a===_t(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ol(ma(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,h=r.props,p=h.date,x=h.yearItemNumber,g=h.handleOnKeyDown;if(f!==Ke.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case Ke.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case Ke.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Ua(r.props.preSelection,1));break;case Ke.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,li(r.props.preSelection,1));break;case Ke.ArrowUp:{if(p===void 0||x===void 0||r.props.preSelection==null)break;var y=bs(p,x).startPeriod,k=kv,w=o-k;if(w<y){var _=x%k;o>=y&&o<y+_?k=_:k+=_,w=o-k}r.handleYearNavigation(w,li(r.props.preSelection,k));break}case Ke.ArrowDown:{if(p===void 0||x===void 0||r.props.preSelection==null)break;var E=bs(p,x).endPeriod,k=kv,w=o+k;if(w>E){var _=x%k;o<=E&&o>E-_?k=_:k+=_,w=o+k}r.handleYearNavigation(w,Ua(r.props.preSelection,k));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,x=o.filterDate,g=o.yearClassName;return Wr("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(ma(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||h||p||x)&&yu(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=_t(r.props.preSelection),l=yu(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var h=bs(o,l),p=h.startPeriod,x=h.endPeriod,g=function(w){r.push(Ce.createElement("div",{ref:y.YEAR_REFS[w-p],onClick:function(_){t.onYearClick(_,w)},onKeyDown:function(_){cw(_)&&(_.preventDefault(),_.key=Ke.Enter),t.onYearKeyDown(_,w)},tabIndex:Number(y.getYearTabIndex(w)),className:y.getYearClassNames(w),onMouseEnter:y.props.usePointerEvent?void 0:function(_){return c(_,w)},onPointerEnter:y.props.usePointerEvent?function(_){return c(_,w)}:void 0,onMouseLeave:y.props.usePointerEvent?void 0:function(_){return f(_,w)},onPointerLeave:y.props.usePointerEvent?function(_){return f(_,w)}:void 0,key:w,"aria-current":y.isCurrentYear(w)?"date":void 0},y.getYearContent(w)))},y=this,k=p;k<=x;k++)g(k);return Ce.createElement("div",{className:"react-datepicker__year"},Ce.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(D.Component);function UO(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=_t(t)<=l),r&&c&&(c=_t(r)>=l),c&&a.push(l)}return a}var HO=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(x){return Ce.createElement("div",{className:c===x?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:x,onClick:r.onChange.bind(r,x),"aria-selected":c===x?"true":void 0},c===x?Ce.createElement("span",{className:"react-datepicker__year-option--selected"},"✓"):"",x)}),h=r.props.minDate?_t(r.props.minDate):null,p=r.props.maxDate?_t(r.props.maxDate):null;return(!p||!r.state.yearsList.find(function(x){return x===p}))&&f.unshift(Ce.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},Ce.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!h||!r.state.yearsList.find(function(x){return x===h}))&&f.push(Ce.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},Ce.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(h){return h+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:UO(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=D.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Wr({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return Ce.createElement(s0,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(D.Component),$O=(function(e){jr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?_t(t.props.minDate):1900,a=t.props.maxDate?_t(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(Ce.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Ce.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return Ce.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},Ce.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),Ce.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return Ce.createElement(HO,Rt({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Ce.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(D.Component),YO=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],VO=function(e){var n=(e.className||"").split(/\s+/);return YO.some(function(t){return n.indexOf(t)>=0})},KO=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;VO(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=iw(r.props),h=lw(r.props),p=Wt(),x=c||l||o;return x||(f&&uo(p,f)?f:h&&Ns(p,h)?h:p)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:sa(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:no(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:ma(Wt(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!Wn(a,r.props))return a;for(var o=Va(a),l=hO(a),c=Y4(l,o),f=null,h=0;h<=c;h++){var p=aa(o,h);if(!Wn(p,r.props)){f=p;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:ma(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Bn(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:ma(Bn(l,cn(a)),_t(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Ts(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(Ce.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=aa(o,c),h=r.formatWeekday(f,r.props.locale),p=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return Ce.createElement("div",{key:c,"aria-label":ar(f,"EEEE",r.props.locale),className:Wr("react-datepicker__day-name",p)},h)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?mO(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?gO(a,o):xO(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:li(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,p=no(r.state.date,h),x;switch(!0){case r.props.showMonthYearPicker:x=pv(r.state.date,r.props);break;case r.props.showYearPicker:x=_O(r.state.date,r.props);break;case r.props.showQuarterYearPicker:x=wO(r.state.date,r.props);break;default:x=fv(p,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&x||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],y=["react-datepicker__navigation","react-datepicker__navigation--previous"],k=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(k=r.decreaseYear),x&&r.props.showDisabledMonthNavigation&&(y.push("react-datepicker__navigation--previous--disabled"),k=void 0);var w=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,_=r.props,E=_.previousMonthButtonLabel,A=E===void 0?n.defaultProps.previousMonthButtonLabel:E,T=_.previousYearButtonLabel,j=T===void 0?n.defaultProps.previousYearButtonLabel:T,ee=r.props,R=ee.previousMonthAriaLabel,C=R===void 0?typeof A=="string"?A:"Previous Month":R,Q=ee.previousYearAriaLabel,M=Q===void 0?typeof j=="string"?j:"Previous Year":Q;return Ce.createElement("button",{type:"button",className:y.join(" "),onClick:k,onKeyDown:r.props.handleOnKeyDown,"aria-label":w?M:C},Ce.createElement("span",{className:g.join(" ")},w?j:A))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Ua(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=hv(r.state.date,r.props);break;case r.props.showYearPicker:o=bO(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=kO(r.state.date,r.props);break;default:o=dv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,x=p.nextMonthButtonLabel,g=x===void 0?n.defaultProps.nextMonthButtonLabel:x,y=p.nextYearButtonLabel,k=y===void 0?n.defaultProps.nextYearButtonLabel:y,w=r.props,_=w.nextMonthAriaLabel,E=_===void 0?typeof g=="string"?g:"Next Month":_,A=w.nextYearAriaLabel,T=A===void 0?typeof k=="string"?k:"Next Year":A;return Ce.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":h?T:E},Ce.createElement("span",{className:c.join(" ")},h?k:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),Ce.createElement("h2",{className:o.join(" ")},ar(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return Ce.createElement($O,Rt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:_t(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return Ce.createElement(IO,Rt({},n.defaultProps,r.props,{month:cn(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return Ce.createElement(zO,Rt({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(ov(),a),r.props.setPreSelection&&r.props.setPreSelection(ov())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return Ce.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return Ce.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),Ce.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),Ce.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var h=fv(r.state.date,r.props),p=dv(r.state.date,r.props),x=pv(r.state.date,r.props),g=hv(r.state.date,r.props),y=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return Ce.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,Rt(Rt({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:p,prevYearButtonDisabled:x,nextYearButtonDisabled:g})),y&&Ce.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,h=f===void 0?n.defaultProps.yearItemNumber:f,p=bs(o,h),x=p.startPeriod,g=p.endPeriod;return Ce.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(x," - ").concat(g):_t(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(r.state.date,f):no(r.state.date,f),p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,x=0;x<c;++x){var g=x-p+f,y=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ua(h,g):sa(h,g),k="month-".concat(x),w=x<c-1,_=x>0;l.push(Ce.createElement("div",{key:k,ref:function(E){r.monthContainer=E??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:y,i:x}),Ce.createElement(RO,Rt({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:y,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:x,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:w,monthShowsDuplicateDaysStart:_}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return Ce.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),Ce.createElement(WO,Rt({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return Ce.createElement(BO,Rt({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&o0(a)&&!!r.props.selected,l=o?"".concat(xv(a.getHours()),":").concat(xv(a.getMinutes())):"";if(r.props.showTimeInput)return Ce.createElement(NO,Rt({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=bs(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=_t(r.state.date):f="".concat(Up(cn(r.state.date),r.props.locale)," ").concat(_t(r.state.date)),Ce.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return Ce.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=D.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:zl}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!Pt(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!an(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!Pt(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||iO;return Ce.createElement(s0,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},Ce.createElement("div",{style:{display:"contents"},ref:this.containerRef},Ce.createElement(t,{className:Wr("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(D.Component),GO=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return Ce.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(Ce.isValidElement(n)){var l=n;return Ce.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return Ce.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},Ce.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},uw=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return kA.createPortal(this.props.children,this.el)},n})(D.Component),XO="[tabindex], a, button, input, select, textarea",QO=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},fw=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(XO),1,-1).filter(QO)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=D.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?Ce.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},Ce.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,Ce.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(D.Component);function qO(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=D.useRef(null),l=oO(Rt({open:!a,whileElementsMounted:ew,placement:t.popperPlacement,middleware:ka([KA({padding:15}),VA(10),GA({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=Rt(Rt({},t),{hidePopper:a,popperProps:Rt(Rt({},l),{arrowRef:o})});return Ce.createElement(e,Rt({},c))};return n}var ZO=(function(e){jr(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,h=t.enableTabLoop,p=t.popperOnKeyDown,x=t.portalId,g=t.portalHost,y=t.popperProps,k=t.showArrow,w=void 0;if(!l){var _=Wr("react-datepicker-popper",r);w=Ce.createElement(fw,{enableTabLoop:h},Ce.createElement("div",{ref:y.refs.setFloating,style:y.floatingStyles,className:_,"data-placement":y.placement,onKeyDown:p},c,k&&Ce.createElement(JA,{ref:y.arrowRef,context:y.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(w=D.createElement(this.props.popperContainer,{},w)),x&&!l&&(w=Ce.createElement(uw,{portalId:x,portalHost:g},w));var E=Wr("react-datepicker-wrapper",a);return Ce.createElement(Ce.Fragment,null,Ce.createElement("div",{ref:y.refs.setReference,className:E},f),w)},n})(D.Component),JO=qO(ZO),_v="react-datepicker-ignore-onclickoutside";function eP(e,n){return e&&n?cn(e)!==cn(n)||_t(e)!==_t(n):e!==n}var hd="Date input not valid.",As=(function(e){jr(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Wt()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return o0(c)?ka(ka([],o,!0),[Rt(Rt({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=iw(r.props),c=lw(r.props),f=l&&uo(o,vu(l))?l:c&&Ns(o,iv(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:mv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(Rt(Rt({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(Rt(Rt({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:md},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Ha(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var x=h[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,h),!x||typeof x.isDefaultPrevented!="function"||x.isDefaultPrevented()))){r.setState({inputValue:x?.target instanceof HTMLInputElement?x.target.value:null,lastPreSelectChange:tP});var g=r.props,y=g.selectsRange,k=g.startDate,w=g.endDate,_=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,E=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,A=x?.target instanceof HTMLInputElement?x.target.value:"";if(y){var T=A.split("-",2).map(function(K){return K.trim()}),j=T[0],ee=T[1],R=fd(j??"",_,r.props.locale,E),C=fd(ee??"",_,r.props.locale,E),Q=k?.getTime()!==R?.getTime(),M=w?.getTime()!==C?.getTime();if(!Q&&!M||R&&Wn(R,r.props)||C&&Wn(C,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[R,C],x)}else{var te=fd(A,_,r.props.locale,E,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(te||!A)&&r.setSelected(te,x,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,h=c.endDate;f&&!h&&(r.props.swapRange||!yv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,h,p=a;if(r.props.showYearPicker){if(p!==null&&yu(_t(p),r.props))return}else if(r.props.showMonthYearPicker){if(p!==null&&ow(p,r.props))return}else if(p!==null&&Wn(p,r.props))return;var x=r.props,g=x.onChange,y=x.selectsRange,k=x.startDate,w=x.endDate,_=x.selectsMultiple,E=x.selectedDates,A=x.minTime,T=x.swapRange;if(!qs(r.props.selected,p)||r.props.allowSameDay||y||_)if(p!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(p=dd(p,{hour:$a(r.props.selected),minute:Ya(r.props.selected),second:Ss(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&A&&(p=dd(p,{hour:A.getHours(),minute:A.getMinutes(),second:A.getSeconds()})),r.props.inline||r.setState({preSelection:p}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),y){var j=!k&&!w,ee=k&&!w,R=k&&w;j?g?.([p,null],o):ee&&(p===null?g?.([null,null],o):yv(p,k)?g?.(T?[p,k]:[p,null],o):g?.([k,p],o)),R&&g?.([p,null],o)}else if(_){if(p!==null)if(!E?.length)g?.([p],o);else{var C=E.some(function(M){return Pt(M,p)});if(C){var Q=E.filter(function(M){return!Pt(M,p)});g?.(Q,o)}else g?.(ka(ka([],E,!0),[p],!1),o)}}else g?.(p,o);l||((h=(f=r.props).onSelect)===null||h===void 0||h.call(f,p,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Ha(r.props.minDate),l=Ha(r.props.maxDate),c=!0;if(a){var f=vu(a);if(o&&l)c=il(a,r.props.minDate,r.props.maxDate);else if(o){var h=vu(r.props.minDate);c=Ns(a,h)||qs(f,h)}else if(l){var p=iv(r.props.maxDate);c=uo(a,p)||qs(f,p)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:dd(c,{hour:$a(a),minute:Ya(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,h,p;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var x=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(x===Ke.ArrowDown||x===Ke.ArrowUp||x===Ke.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(x===Ke.ArrowDown||x===Ke.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',y=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);y instanceof HTMLElement&&y.focus({preventScroll:!0});return}var k=Wt(r.state.preSelection);x===Ke.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===md?(r.handleSelect(k,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(k)):r.setOpen(!1)):x===Ke.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):x===Ke.Tab&&r.setOpen(!1),r.inputOk()||(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hd})}},r.onPortalKeyDown=function(a){var o=a.key;o===Ke.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,h,p,x=r.props,g=x.minDate,y=x.maxDate,k=x.disabledKeyboardNavigation,w=x.showWeekPicker,_=x.shouldCloseOnSelect,E=x.locale,A=x.calendarStartDay,T=x.adjustDateOnChange,j=x.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!k){var ee=a.key,R=a.shiftKey,C=Wt(r.state.preSelection),Q=function(oe,he){var V=he;switch(oe){case Ke.ArrowRight:V=w?Pu(he,1):aa(he,1);break;case Ke.ArrowLeft:V=w?qg(he):YF(he);break;case Ke.ArrowUp:V=qg(he);break;case Ke.ArrowDown:V=Pu(he,1);break;case Ke.PageUp:V=R?li(he,1):no(he,1);break;case Ke.PageDown:V=R?Ua(he,1):sa(he,1);break;case Ke.Home:V=Ts(he,E,A);break;case Ke.End:V=pO(he);break}return V},M=function(oe,he){for(var V=40,le=oe,J=!1,ae=0,W=Q(oe,he);!J;){if(ae>=V){W=he;break}g&&W<g&&(le=Ke.ArrowRight,W=Wn(g,r.props)?Q(le,W):g),y&&W>y&&(le=Ke.ArrowLeft,W=Wn(y,r.props)?Q(le,W):y),Wn(W,r.props)?((le===Ke.PageUp||le===Ke.Home)&&(le=Ke.ArrowRight),(le===Ke.PageDown||le===Ke.End)&&(le=Ke.ArrowLeft),W=Q(le,W)):J=!0,ae++}return W};if(ee===Ke.Enter){a.preventDefault(),r.handleSelect(C,a),!_&&r.setPreSelection(C);return}else if(ee===Ke.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:hd});return}var te=null;switch(ee){case Ke.ArrowLeft:case Ke.ArrowRight:case Ke.ArrowUp:case Ke.ArrowDown:case Ke.PageUp:case Ke.PageDown:case Ke.Home:case Ke.End:te=M(ee,C);break}if(!te){(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:hd});return}if(a.preventDefault(),r.setState({lastPreSelectChange:md}),T&&r.setSelected(te),r.setPreSelection(te),j){var K=cn(C),B=cn(te),fe=_t(C),ue=_t(te);K!==B||fe!==ue?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===Ke.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:Ce.createElement(KO,Rt({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:SO(r.modifyHolidays()),outsideClickIgnoreClass:_v,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,h=f?"PPPPp":"PPPP",p;return r.props.selectsRange?p="Selected start date: ".concat(zn(r.props.startDate,{dateFormat:h,locale:c}),". ").concat(r.props.endDate?"End date: "+zn(r.props.endDate,{dateFormat:h,locale:c}):""):r.props.showTimeSelectOnly?p="Selected time: ".concat(zn(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?p="Selected year: ".concat(zn(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?p="Selected month: ".concat(zn(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?p="Selected quarter: ".concat(zn(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):p="Selected date: ".concat(zn(r.props.selected,{dateFormat:h,locale:c})),Ce.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},p)},r.renderDateInput=function(){var a,o,l,c=Wr(r.props.className,(a={},a[_v]=r.state.open,a)),f=r.props.customInput||Ce.createElement("input",{type:"text"}),h=r.props.customInputRef||"ref",p=r.props,x=p.dateFormat,g=x===void 0?n.defaultProps.dateFormat:x,y=p.locale,k=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?cO(r.props.startDate,r.props.endDate,{dateFormat:g,locale:y}):r.props.selectsMultiple?uO((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:y}):zn(r.props.selected,{dateFormat:g,locale:y});return D.cloneElement(f,(o={},o[h]=function(w){r.input=w},o.value=k,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Wr(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,h=a.endDate,p=a.clearButtonTitle,x=a.clearButtonClassName,g=x===void 0?"":x,y=a.ariaLabelClose,k=y===void 0?"Close":y,w=a.selectedDates;return o&&(c!=null||f!=null||h!=null||w?.length)?Ce.createElement("button",{type:"button",className:Wr("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":k,onClick:r.onClearClick,title:p,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:zl,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&eP(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:mv(this.props.highlightDates)}),!r.focused&&!qs(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),Ce.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&Ce.createElement(GO,Rt({icon:a,className:Wr(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?Ce.createElement(fw,{enableTabLoop:this.props.enableTabLoop},Ce.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=Ce.createElement(uw,Rt({portalId:this.props.portalId},this.props),r)),Ce.createElement("div",null,this.renderInputContainer(),r)}return Ce.createElement(JO,Rt({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(D.Component),tP="input",md="navigate";const rP={lessThanXSeconds:{one:{regular:"mniej niż sekunda",past:"mniej niż sekundę",future:"mniej niż sekundę"},twoFour:"mniej niż {{count}} sekundy",other:"mniej niż {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekundę",future:"sekundę"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"pół minuty",twoFour:"pół minuty",other:"pół minuty"},lessThanXMinutes:{one:{regular:"mniej niż minuta",past:"mniej niż minutę",future:"mniej niż minutę"},twoFour:"mniej niż {{count}} minuty",other:"mniej niż {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minutę",future:"minutę"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"około godziny",past:"około godziny",future:"około godzinę"},twoFour:"około {{count}} godziny",other:"około {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzinę",future:"godzinę"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzień",past:"dzień",future:"1 dzień"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"około tygodnia",twoFour:"około {{count}} tygodni",other:"około {{count}} tygodni"},xWeeks:{one:"tydzień",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"około miesiąc",twoFour:"około {{count}} miesiące",other:"około {{count}} miesięcy"},xMonths:{one:"miesiąc",twoFour:"{{count}} miesiące",other:"{{count}} miesięcy"},aboutXYears:{one:"około rok",twoFour:"około {{count}} lata",other:"około {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function nP(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function xd(e,n,t){const r=nP(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const aP=(e,n,t)=>{const r=rP[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+xd(r,n,"future"):xd(r,n,"past")+" temu":xd(r,n,"regular")},sP={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},oP={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},iP={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},lP={date:ei({formats:sP,defaultWidth:"full"}),time:ei({formats:oP,defaultWidth:"full"}),dateTime:ei({formats:iP,defaultWidth:"full"})},cP={masculine:"ostatni",feminine:"ostatnia"},uP={masculine:"ten",feminine:"ta"},fP={masculine:"następny",feminine:"następna"},dP={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function bv(e,n,t,r){let a;if(WF(n,t,r))a=uP;else if(e==="lastWeek")a=cP;else if(e==="nextWeek")a=fP;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=dP[o];return`'${a[l]}' eeee 'o' p`}const pP={lastWeek:bv,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:bv,other:"P"},hP=(e,n,t,r)=>{const a=pP[e];return typeof a=="function"?a(e,n,t,r):a},mP={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed naszą erą","naszej ery"]},xP={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwartał","II kwartał","III kwartał","IV kwartał"]},gP={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"]},vP={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"]},yP={narrow:["N","P","W","Ś","C","P","S"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},wP={narrow:["n","p","w","ś","c","p","s"],short:["nie","pon","wto","śro","czw","pią","sob"],abbreviated:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],wide:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},kP={narrow:{am:"a",pm:"p",midnight:"półn.",noon:"poł",morning:"rano",afternoon:"popoł.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"północ",noon:"południe",morning:"rano",afternoon:"popołudnie",evening:"wieczór",night:"noc"}},_P={narrow:{am:"a",pm:"p",midnight:"o półn.",noon:"w poł.",morning:"rano",afternoon:"po poł.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o północy",noon:"w południe",morning:"rano",afternoon:"po południu",evening:"wieczorem",night:"w nocy"}},bP=(e,n)=>String(e),EP={ordinalNumber:bP,era:ga({values:mP,defaultWidth:"wide"}),quarter:ga({values:xP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ga({values:gP,defaultWidth:"wide",formattingValues:vP,defaultFormattingWidth:"wide"}),day:ga({values:yP,defaultWidth:"wide",formattingValues:wP,defaultFormattingWidth:"wide"}),dayPeriod:ga({values:kP,defaultWidth:"wide",formattingValues:_P,defaultFormattingWidth:"wide"})},SP=/^(\d+)?/i,TP=/\d+/i,CP={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(ą|a)\s*er(ą|a)|naszej\s*ery)/i},DP={any:[/^p/i,/^n/i]},NP={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(ł|l)/i},FP={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},AP={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(ź|z)|lis|gru)/i,wide:/^(stycznia|stycze(ń|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(ń|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(ń|n)|wrze(ś|s)nia|wrzesie(ń|n)|pa(ź|z)dziernika|pa(ź|z)dziernik|listopada|listopad|grudnia|grudzie(ń|n))/i},OP={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},PP={narrow:/^[npwścs]/i,short:/^(nie|pon|wto|(ś|s)ro|czw|pi(ą|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(ś|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(ł|l)ek|wtorek|(ś|s)roda|czwartek|pi(ą|a)tek|sobota)/i},RP={narrow:[/^n/i,/^p/i,/^w/i,/^ś/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(ś|s)r/i,/^c/i,/^pi/i,/^so/i]},MP={narrow:/^(^a$|^p$|pó(ł|l)n\.?|o\s*pó(ł|l)n\.?|po(ł|l)\.?|w\s*po(ł|l)\.?|po\s*po(ł|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|pó(ł|l)noc|o\s*pó(ł|l)nocy|po(ł|l)udnie|w\s*po(ł|l)udnie|popo(ł|l)udnie|po\s*po(ł|l)udniu|rano|wieczór|wieczorem|noc|w\s*nocy)/i},IP={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/pó(ł|l)n/i,noon:/po(ł|l)/i,morning:/rano/i,afternoon:/po\s*po(ł|l)/i,evening:/wiecz/i,night:/noc/i}},jP={ordinalNumber:Oy({matchPattern:SP,parsePattern:TP,valueCallback:e=>parseInt(e,10)}),era:va({matchPatterns:CP,defaultMatchWidth:"wide",parsePatterns:DP,defaultParseWidth:"any"}),quarter:va({matchPatterns:NP,defaultMatchWidth:"wide",parsePatterns:FP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:va({matchPatterns:AP,defaultMatchWidth:"wide",parsePatterns:OP,defaultParseWidth:"any"}),day:va({matchPatterns:PP,defaultMatchWidth:"wide",parsePatterns:RP,defaultParseWidth:"any"}),dayPeriod:va({matchPatterns:MP,defaultMatchWidth:"any",parsePatterns:IP,defaultParseWidth:"any"})},gi={code:"pl",formatDistance:aP,formatLong:lP,formatRelative:hP,localize:EP,match:jP,options:{weekStartsOn:1,firstWeekContainsDate:4}};xi("pl",gi);const gd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],LP=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],zP=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=D.useState(null),[o,l]=D.useState(""),[c,f]=D.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[h,p]=D.useState(""),[x,g]=D.useState(null),[y,k]=D.useState(null),w=D.useRef(null),_=D.useRef(null),[E,A]=D.useState(null),[T,j]=D.useState(null),[ee,R]=D.useState("0,00"),[C,Q]=D.useState("0,00"),[M,te]=D.useState("0,00"),K=()=>{const H=c.reduce((ie,Z)=>{const ge=parseFloat(Z.ilosc.toString().replace(",","."))||0;return ie+ge},0),re=parseFloat(h.replace(",","."))||0;return H>0?(re/H).toFixed(2):"0,00"},B=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},fe=H=>{if(c.length>1){const re=[...c];re.splice(H,1),f(re)}},ue=H=>{const re=[...c];re[H].showDataWaznosci=!re[H].showDataWaznosci,f(re)},oe=H=>{const re=H.target.files?.[0];console.log("📎 Product file selected:",re),re&&re.type==="application/pdf"?(g(re),console.log("✅ Product invoice set:",re.name)):console.log("❌ Invalid product file type:",re?.type)},he=H=>{const re=H.target.files?.[0];console.log("📎 Transport file selected:",re),re&&re.type==="application/pdf"?(k(re),console.log("✅ Transport invoice set:",re.name)):console.log("❌ Invalid transport file type:",re?.type)},V=()=>{w.current?.click()},le=()=>{_.current?.click()},J=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",h),console.log("productRows:",c),!r||!c.some(Te=>Te.kod&&Te.nazwa&&Te.ilosc&&Te.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(Te=>Te.kod&&Te.nazwa&&Te.ilosc&&Te.cena));return}const H=parseFloat(ee.replace(",","."))||1,re=c.reduce((Te,st)=>Te+(parseFloat(st.ilosc)||0),0),ie=re>0?parseFloat(h.replace(",","."))/re*H:0,Z=c.filter(Te=>Te.kod&&Te.nazwa&&Te.ilosc&&Te.cena).map(Te=>({kod:Te.kod,nazwa:Te.nazwa,kod_kreskowy:Te.kod_kreskowy||"",ilosc:parseFloat(Te.ilosc)||0,cena:parseFloat(Te.cena.replace(",","."))||0,dataWaznosci:Te.dataWaznosci?Te.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:Te.typ||void 0,objetosc:Te.objetosc||void 0,deliveryCostPerUnitPln:ie,podatekAkcyzowyPerLiter:parseFloat(C.replace(",","."))||0}));console.log("formattedProducts:",Z);const ge=Z.reduce((Te,st)=>Te+st.ilosc*st.cena,0),xe=parseFloat(h.replace(",","."))||0,L=parseFloat(M.replace(",","."))||0,Ve=ge*(1-L/100);console.log("totalValue:",ge),console.log("rabat:",L+"%"),console.log("wartoscZRabatem:",Ve),console.log("deliveryCost:",xe),console.log("📎 Files to submit:",{productInvoice:x,transportInvoice:y}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:Ve,kosztDostawy:xe,aktualnyKurs:parseFloat(ee.replace(",","."))||1,podatekAkcyzowy:C,rabat:M,products:Z,productInvoice:x||null,transportInvoice:y||null}),ae()},ae=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),p(""),l(""),R("0,00"),Q("0,00"),te("0,00"),g(null),k(null),n()},W=()=>c.reduce((H,re)=>{const ie=parseFloat(re.ilosc)||0,Z=parseFloat(re.cena.replace(",","."))||0;return H+ie*Z},0).toFixed(2),S=(H,re)=>{const ie=[...c];ie[H].typ=re,f(ie),A(null)},P=H=>{A(E===H?null:H)},O=H=>{j(T===H?null:H)},z=(H,re)=>{const ie=[...c];ie[H].objetosc=re,f(ie),j(null)};return D.useEffect(()=>{const H=ie=>{const Z=ie.target;if(!Z.closest(".react-datepicker")&&!Z.closest('button[title*="ważności"]')){const ge=[...c];let xe=!1;ge.forEach(L=>{L.showDataWaznosci&&(L.showDataWaznosci=!1,xe=!0)}),xe&&f(ge)}E!==null&&(Z.closest(".dropdown-container")||A(null)),T!==null&&(Z.closest(".dropdown-container")||j(null))},re=ie=>{ie.key==="Escape"&&(A(null),j(null))};return document.addEventListener("mousedown",H),document.addEventListener("keydown",re),()=>{document.removeEventListener("mousedown",H),document.removeEventListener("keydown",re)}},[E,T,c]),d.jsx(Fr,{isOpen:e,onRequestClose:ae,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),d.jsx("button",{onClick:ae,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),d.jsx(As,{selected:r,onChange:H=>a(H),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsx("div",{className:"w-[200px] flex items-start",children:d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:h,onKeyPress:H=>{const re=String.fromCharCode(H.which);(!/[\d,]/.test(re)||re===","&&H.target.value.includes(",")||H.target.value===""&&re===",")&&H.preventDefault()},onChange:H=>{const re=H.target,ie=re.selectionStart??0;let Z=re.value.replace(/[^\d,]/g,"");if(Z===""){p("");return}if(!Z.includes(","))Z=Z+",00";else{const[xe,L]=Z.split(",");L&&L.length>2&&(Z=`${xe},${L.slice(0,2)}`)}p(Z),requestAnimationFrame(()=>{const xe=Math.min(ie,Z.length);re.setSelectionRange(xe,xe)})},className:"w-[70%] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),d.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"€"})]})]})}),d.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:oe,className:"hidden",ref:w}),d.jsx("button",{type:"button",onClick:V,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:d.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),x&&d.jsx("a",{href:URL.createObjectURL(x),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:x.name,children:x.name})]}),d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:he,className:"hidden",ref:_}),d.jsx("button",{type:"button",onClick:le,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:d.jsx(Zd,{className:"h-4 w-4 text-gray-500"})}),y&&d.jsx("a",{href:URL.createObjectURL(y),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:y.name,children:y.name})]})]})]})}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),d.jsx("input",{type:"text",value:o,onChange:H=>l(H.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),d.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[K().replace(".",",")," €"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:ee,onChange:H=>R(H.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł/€"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:C,onChange:H=>Q(H.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:M,onChange:H=>te(H.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),d.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((H,re)=>d.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[d.jsxs("div",{className:"col-span-1.5 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Kod"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:H.kod,onChange:ie=>{const Z=[...c];Z[re].kod=ie.target.value,f(Z)}}),re===c.length-1&&d.jsx("button",{onClick:B,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:d.jsx(Js,{size:16})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Nazwa"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:H.nazwa,onChange:ie=>{const Z=[...c];Z[re].nazwa=ie.target.value,f(Z)}})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Kod kreskowy"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:H.kod_kreskowy,onChange:ie=>{const Z=[...c];Z[re].kod_kreskowy=ie.target.value,f(Z)}})]}),d.jsxs("div",{className:"col-span-1.5",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Ilość"}),d.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:H.ilosc,onChange:ie=>{const Z=[...c],ge=ie.target.value;(ge===""||/^\d*$/.test(ge))&&(Z[re].ilosc=ge,f(Z))}})]}),d.jsxs("div",{className:"col-span-2.9 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Cena"}),d.jsx("div",{className:"relative",children:d.jsx("input",{type:"text",value:H.cena,onKeyPress:ie=>{const Z=String.fromCharCode(ie.which);(!/[\d,]/.test(Z)||Z===","&&ie.target.value.includes(",")||ie.target.value===""&&Z===",")&&ie.preventDefault()},onChange:ie=>{const Z=ie.target,ge=Z.selectionStart??0;let xe=ie.target.value.replace(/[^\d,]/g,"");if(xe===""){const Te=[...c];Te[re].cena="",f(Te);return}if(!xe.includes(","))xe=xe+",00";else{const[Te,st]=xe.split(",");st&&st.length>2&&(xe=`${Te},${st.slice(0,2)}`)}const Ve=[...c];Ve[re].cena=xe,f(Ve),requestAnimationFrame(()=>{const Te=Math.min(ge,xe.length);Z.setSelectionRange(Te,Te)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),d.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Wartość"}),d.jsx("div",{className:"relative flex items-center",children:d.jsx("input",{type:"text",value:(()=>{const ie=parseFloat(H.ilosc)||0,Z=parseFloat(H.cena.replace(",","."))||0;return(ie*Z).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),d.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[d.jsx("button",{type:"button",onClick:()=>ue(re),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${H.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:H.dataWaznosci?`Termin ważności: ${H.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:d.jsx(qd,{size:16})}),d.jsx("button",{onClick:()=>fe(re),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:d.jsx(Yt,{size:16})})]}),H.showDataWaznosci&&d.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:d.jsx(As,{selected:H.dataWaznosci,onChange:ie=>{const Z=[...c];Z[re].dataWaznosci=ie,Z[re].showDataWaznosci=!1,f(Z)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const ie=[...c];ie[re].showDataWaznosci=!1,f(ie)}})}),d.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Typ"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>P(re),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${H.typ&&gd.find(ie=>ie.value===H.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate",children:H.typ&&gd.find(ie=>ie.value===H.typ)?.label||"Wybierz typ"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E===re&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:ie=>ie.stopPropagation(),children:gd.map(ie=>d.jsx("button",{type:"button",onClick:()=>S(re,ie.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${ie.color}`,children:ie.label},ie.value))})]})]}),d.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${re>0?"invisible":""}`,children:"Objętość"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>O(re),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${H.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[d.jsx("span",{className:"truncate",children:H.objetosc||"Wybierz"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T===re&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:ie=>ie.stopPropagation(),style:{maxWidth:"200px"},children:LP.map(ie=>d.jsx("button",{type:"button",onClick:()=>z(re,ie.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:ie.label},ie.value))})]})]})]},re))})]}),d.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[d.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),d.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[W().replace(".",",")," €"]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(H=>H.kod&&H.nazwa&&H.ilosc&&H.cena)}),J()},disabled:!r||!c.some(H=>H.kod&&H.nazwa&&H.ilosc&&H.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(H=>H.kod&&H.nazwa&&H.ilosc&&H.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},BP=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilość"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilość"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsx("tr",{children:o.map((c,f)=>d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>d.jsx("tr",{children:c.map((h,p)=>d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:h},p))},f))})]})})},WP=({onSearch:e})=>{const[n,t]=D.useState(""),[r,a]=D.useState([]),[o,l]=D.useState(!1);return D.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),d.jsxs("div",{className:"w-full relative",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktów...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?d.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:d.jsxs("div",{className:"text-center py-4",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),d.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"Ładowanie..."})]})}):r.length>0?d.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:d.jsxs("table",{className:"w-full table-fixed",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),d.jsx("th",{className:"w-[70%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),d.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilość"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),d.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),d.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc})]},f))})]})}):n?d.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:d.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynikов"})}):null]})};let UP={data:""},HP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||UP,$P=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,YP=/\/\*[^]*?\*\/|  +/g,Ev=/\n+/g,ws=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?ws(l,o):o+"{"+ws(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=ws(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=ws.p?ws.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},La={},dw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+dw(e[t]);return n}return e},VP=(e,n,t,r,a)=>{let o=dw(e),l=La[o]||(La[o]=(f=>{let h=0,p=11;for(;h<f.length;)p=101*p+f.charCodeAt(h++)>>>0;return"go"+p})(o));if(!La[l]){let f=o!==e?e:(h=>{let p,x,g=[{}];for(;p=$P.exec(h.replace(YP,""));)p[4]?g.shift():p[3]?(x=p[3].replace(Ev," ").trim(),g.unshift(g[0][x]=g[0][x]||{})):g[0][p[1]]=p[2].replace(Ev," ").trim();return g[0]})(e);La[l]=ws(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&La.g?La.g:null;return t&&(La.g=La[l]),((f,h,p,x)=>{x?h.data=h.data.replace(x,f):h.data.indexOf(f)===-1&&(h.data=p?f+h.data:h.data+f)})(La[l],n,r,c),l},KP=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":ws(c,""):c===!1?"":c}return r+a+(l??"")},"");function i0(e){let n=this||{},t=e.call?e(n.p):e;return VP(t.unshift?t.raw?KP(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,HP(n.target),n.g,n.o,n.k)}let pw,Vd,Kd;i0.bind({g:1});let Ga=i0.bind({k:1});function GP(e,n,t,r){ws.p=n,pw=e,Vd=t,Kd=r}function Ps(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Vd&&Vd()},c),t.o=/ *go\d+/.test(f),c.className=i0.apply(t,r)+(f?" "+f:"");let h=e;return e[0]&&(h=c.as||e,delete c.as),Kd&&h[0]&&Kd(c),pw(h,c)}return a}}var XP=e=>typeof e=="function",Yu=(e,n)=>XP(e)?e(n):e,QP=(()=>{let e=0;return()=>(++e).toString()})(),hw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),qP=20,mw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,qP)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return mw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},wu=[],Zs={toasts:[],pausedAt:void 0},ko=e=>{Zs=mw(Zs,e),wu.forEach(n=>{n(Zs)})},ZP={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},JP=(e={})=>{let[n,t]=D.useState(Zs),r=D.useRef(Zs);D.useEffect(()=>(r.current!==Zs&&t(Zs),wu.push(t),()=>{let o=wu.indexOf(t);o>-1&&wu.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||ZP[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},eR=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||QP()}),Wl=e=>(n,t)=>{let r=eR(n,e,t);return ko({type:2,toast:r}),r.id},on=(e,n)=>Wl("blank")(e,n);on.error=Wl("error");on.success=Wl("success");on.loading=Wl("loading");on.custom=Wl("custom");on.dismiss=e=>{ko({type:3,toastId:e})};on.remove=e=>ko({type:4,toastId:e});on.promise=(e,n,t)=>{let r=on.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?Yu(n.success,a):void 0;return o?on.success(o,{id:r,...t,...t?.success}):on.dismiss(r),a}).catch(a=>{let o=n.error?Yu(n.error,a):void 0;o?on.error(o,{id:r,...t,...t?.error}):on.dismiss(r)}),e};var tR=(e,n)=>{ko({type:1,toast:{id:e,height:n}})},rR=()=>{ko({type:5,time:Date.now()})},gl=new Map,nR=1e3,aR=(e,n=nR)=>{if(gl.has(e))return;let t=setTimeout(()=>{gl.delete(e),ko({type:4,toastId:e})},n);gl.set(e,t)},sR=e=>{let{toasts:n,pausedAt:t}=JP(e);D.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&on.dismiss(c.id);return}return setTimeout(()=>on.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=D.useCallback(()=>{t&&ko({type:6,time:Date.now()})},[t]),a=D.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:h}=l||{},p=n.filter(y=>(y.position||h)===(o.position||h)&&y.height),x=p.findIndex(y=>y.id===o.id),g=p.filter((y,k)=>k<x&&y.visible).length;return p.filter(y=>y.visible).slice(...c?[g+1]:[0,g]).reduce((y,k)=>y+(k.height||0)+f,0)},[n]);return D.useEffect(()=>{n.forEach(o=>{if(o.dismissed)aR(o.id,o.removeDelay);else{let l=gl.get(o.id);l&&(clearTimeout(l),gl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:tR,startPause:rR,endPause:r,calculateOffset:a}}},oR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,iR=Ga`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lR=Ga`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,cR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${oR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${iR} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${lR} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,uR=Ga`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,fR=Ps("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${uR} 1s linear infinite;
`,dR=Ga`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,pR=Ga`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,hR=Ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dR} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${pR} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,mR=Ps("div")`
  position: absolute;
`,xR=Ps("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,gR=Ga`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,vR=Ps("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${gR} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,yR=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?D.createElement(vR,null,n):n:t==="blank"?null:D.createElement(xR,null,D.createElement(fR,{...r}),t!=="loading"&&D.createElement(mR,null,t==="error"?D.createElement(cR,{...r}):D.createElement(hR,{...r})))},wR=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,kR=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,_R="0%{opacity:0;} 100%{opacity:1;}",bR="0%{opacity:1;} 100%{opacity:0;}",ER=Ps("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,SR=Ps("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,TR=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=hw()?[_R,bR]:[wR(t),kR(t)];return{animation:n?`${Ga(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ga(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},CR=D.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?TR(e.position||n||"top-center",e.visible):{opacity:0},o=D.createElement(yR,{toast:e}),l=D.createElement(SR,{...e.ariaProps},Yu(e.message,e));return D.createElement(ER,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):D.createElement(D.Fragment,null,o,l))});GP(D.createElement);var DR=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=D.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return D.createElement("div",{ref:o,className:n,style:t},a)},NR=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},FR=i0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,du=16,AR=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=sR(t);return D.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:du,left:du,right:du,bottom:du,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(h=>{let p=h.position||n,x=f.calculateOffset(h,{reverseOrder:e,gutter:r,defaultPosition:n}),g=NR(p,x);return D.createElement(DR,{id:h.id,key:h.id,onHeightUpdate:f.updateHeight,className:h.visible?FR:"",style:g},h.type==="custom"?Yu(h.message,h):a?a(h):D.createElement(CR,{toast:h,position:p}))}))},lt=on;xi("pl",gi);const OR=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log("🔍 OrderModal render - isOpen:",e);const[r,a]=D.useState(null),[o,l]=D.useState(""),[c,f]=D.useState(""),[h,p]=D.useState([]),[x,g]=D.useState(null),[y,k]=D.useState(!1),[w,_]=D.useState([]),[E,A]=D.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[T,j]=D.useState(null),[ee,R]=D.useState(!1),[C,Q]=D.useState(!1),[M,te]=D.useState(null),[K,B]=D.useState(new Set),fe=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],ue=()=>{const S=Math.max(...E.map(P=>P.id))+1;A([...E,{id:S,searchQuery:"",selectedProduct:null,typ:""}])},oe=S=>{E.length>1&&A(P=>P.filter(O=>O.id!==S))},he=()=>{console.log("🔍 OrderModal handleClose called"),a(null),l(""),f(""),p([]),g(null),_([]),A([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),j(null),R(!1),Q(!1),te(null),B(new Set),n()};D.useEffect(()=>{e&&(console.log("🔍 OrderModal opened - clearing state"),a(null),l(""),f(""),p([]),g(null),_([]),A([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),j(null),R(!1),Q(!1),te(null),B(new Set))},[e]),D.useEffect(()=>{const P=setTimeout(async()=>{if(c.trim().length<2){p([]);return}k(!0);try{const O=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!O.ok)throw new Error("Failed to fetch clients");const z=await O.json();p(z)}catch(O){console.error("Error searching clients:",O),p([])}finally{k(!1)}},300);return()=>clearTimeout(P)},[c]),D.useEffect(()=>{const P=setTimeout(async()=>{if(T===null||!E.find(O=>O.id===T)?.searchQuery.trim()){_([]);return}R(!0);try{const O=E.find(ie=>ie.id===T)?.searchQuery||"",z=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(O)}`);if(!z.ok)throw new Error("Failed to fetch products");const re=(await z.json()).map(ie=>({kod:ie.kod,nazwa:ie.nazwa,ilosc:ie.ilosc.toString(),kodKreskowy:"",selectedQuantity:0}));_(re)}catch(O){console.error("Error searching products:",O),_([])}finally{R(!1)}},300);return()=>clearTimeout(P)},[E,T]),D.useEffect(()=>{const S=O=>{const z=O.target;M!==null&&(z.closest(".dropdown-container")||te(null))},P=O=>{O.key==="Escape"&&te(null)};return M!==null&&(document.addEventListener("mousedown",S),document.addEventListener("keydown",P)),()=>{document.removeEventListener("mousedown",S),document.removeEventListener("keydown",P)}},[M]);const V=(S,P)=>{console.log("🔍 handleProductSelect called for fieldId:",S,"product:",P.kod),A(O=>O.map(H=>H.id===S?{...H,selectedProduct:P,searchQuery:`${P.kod} - ${P.nazwa.includes(" (samples)")?P.nazwa.replace(" (samples)","")+" (samples)":P.nazwa}`}:H)),_([]),j(null),console.log("🔍 Products list cleared, activeSearchId reset")},le=S=>{te(M===S?null:S)},J=(S,P)=>{A(O=>O.map(z=>z.id===S?{...z,typ:P}:z)),te(null)},ae=()=>E.filter(S=>S.selectedProduct).reduce((S,P)=>{const O=P.selectedProduct?.selectedQuantity||0;return S+O},0),W=async()=>{const S=E.filter(ie=>ie.selectedProduct).map(ie=>({kod:ie.selectedProduct.kod,nazwa:ie.selectedProduct.nazwa,ilosc:ie.selectedProduct.selectedQuantity||0,typ:ie.typ}));if(!r){lt.error("Wybierz datę zamówienia");return}if(!o.trim()){lt.error("Wprowadź numer zamówienia");return}if(!x){lt.error("Wybierz klienta");return}if(S.length===0){lt.error("Dodaj produkty");return}if(S.some(ie=>!ie.ilosc)){lt.error("Wprowadź ilość dla wszystkich produktów");return}if(S.some(ie=>!ie.typ)){lt.error("Wybierz typ dla wszystkich produktów");return}const P=new Set;for(let ie=0;ie<E.length;ie++){const Z=E[ie];if(Z.selectedProduct){const ge=Z.selectedProduct.selectedQuantity||0,xe=parseInt(Z.selectedProduct.ilosc)||0;ge>xe&&P.add(Z.id)}}if(P.size>0){B(P);return}else B(new Set);const O=r.getDate().toString().padStart(2,"0"),z=(r.getMonth()+1).toString().padStart(2,"0"),H=r.getFullYear(),re=`${o.trim()}_${O}_${z}_${H}`;Q(!0);try{const ie=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:x.nazwa,order_number:re,products:S})});if(!ie.ok){const Z=await ie.json();if(ie.status===400&&Z.error.includes("Insufficient quantity")){const ge=Z.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(ge){const[,xe,L,Ve]=ge;lt.error(`Niewystarczająca ilość produktu ${xe}. Dostępne: ${L}, Zamówione: ${Ve}`)}else lt.error(Z.error)}else throw new Error("Failed to create order");return}lt.success("Zamówienie zostało dodane"),he(),t&&t()}catch(ie){console.error("Error creating order:",ie),lt.error("Wystąpił błąd podczas dodawania zamówienia")}finally{Q(!1)}};return d.jsx(Fr,{isOpen:e,onRequestClose:he,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamówienia"}),d.jsx("button",{onClick:he,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),d.jsx(As,{selected:r,onChange:S=>a(S),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsxs("div",{className:"w-[180px] ml-4",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),d.jsx("input",{type:"text",value:o,onChange:S=>l(S.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),d.jsxs("div",{className:"relative",children:[d.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",id:"client-search",value:c,onChange:S=>f(S.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),y&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),h.length>0&&!x&&d.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:h.map(S=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(S),f(S.nazwa),p([])},children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:S.nazwa}),d.jsx("span",{className:"text-[10px] text-gray-500",children:S.firma})]})},S.id))})]}),x&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.nazwa})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.firma})]}),x.adres&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.adres})]}),x.kontakt&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),d.jsx("p",{className:"text-xs text-gray-900",children:x.kontakt})]})]}),d.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:d.jsx(Yt,{size:16})})]})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),E.map(S=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",value:S.searchQuery,onChange:P=>{const O=P.target.value;console.log("🔍 Product search input changed for fieldId:",S.id,"value:",O),A(z=>z.map(H=>H.id===S.id?{...H,searchQuery:O,selectedProduct:null}:H)),j(S.id)},onFocus:()=>j(S.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsx("div",{className:"w-16 ml-2",children:d.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:S.selectedProduct?.selectedQuantity||"",onChange:P=>{const O=P.target.value,z=O===""?0:Math.max(1,parseInt(O)||0);if(A(H=>H.map(re=>re.id===S.id&&re.selectedProduct?{...re,selectedProduct:{...re.selectedProduct,selectedQuantity:z}}:re)),K.has(S.id)){const H=new Set(K);H.delete(S.id),B(H)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${K.has(S.id)?"border-red-500":"border-gray-300"}`})}),d.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[d.jsxs("button",{type:"button",onClick:()=>le(S.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${S.typ&&fe.find(P=>P.value===S.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate text-[10px]",children:S.typ&&fe.find(P=>P.value===S.typ)?.label||"Typ"}),d.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),M===S.id&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:P=>P.stopPropagation(),children:fe.map(P=>d.jsx("button",{type:"button",onClick:()=>J(S.id,P.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${P.color}`,children:P.label},P.value))})]}),E.length>1&&d.jsx("button",{onClick:()=>oe(S.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:d.jsx(Yt,{size:16})})]}),S.id===Math.max(...E.map(P=>P.id))&&d.jsx("button",{onClick:ue,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:d.jsx(Js,{size:16})}),ee&&T===S.id&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),w.length>0&&T===S.id&&!S.selectedProduct&&S.searchQuery.trim()&&d.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:w.map((P,O)=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>V(S.id,{...P,selectedQuantity:0}),children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:P.kod}),P.nazwa.includes(" (samples)")?d.jsxs("div",{className:"text-[10px]",children:[d.jsx("span",{className:"text-gray-500",children:P.nazwa.replace(" (samples)","")})," ",d.jsx("span",{className:"font-medium",children:"(samples)"})]}):d.jsx("span",{className:"text-[10px] text-gray-500",children:P.nazwa}),d.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",P.ilosc]})]})},`${P.kod}-${P.nazwa||""}-${O}`))})]},S.id))]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:W,disabled:C,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${C?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:C?d.jsxs("div",{className:"flex items-center justify-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),d.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",d.jsx("span",{className:"font-semibold text-gray-900",children:ae()})]})]})})},PR=({isOpen:e,onClose:n,order:t})=>{const[r,a]=D.useState(null),[o,l]=D.useState(null),[c,f]=D.useState(!1),h=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}];D.useEffect(()=>{e&&t&&(p(),x())},[e,t]);const p=async()=>{if(t){f(!0);try{const w=await fetch(`/api/orders/${t.id}`);if(!w.ok)throw new Error("Failed to load order details");const _=await w.json();a(_)}catch(w){console.error("Error loading order details:",w)}finally{f(!1)}}},x=async()=>{if(t)try{const w=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(w.ok){const _=await w.json();l(_)}}catch(w){console.error("Error loading client data:",w)}},g=w=>new Date(w).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const y=r||t,k=async()=>{if(!(!t||!y))try{const w=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!w.ok)throw new Error("Failed to generate PDF");const _=await w.blob(),E=window.URL.createObjectURL(_),A=document.createElement("a");A.href=E;const T=o?o.nazwa:y.klient,j=`${T}_${y.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",T),console.log("Order number:",y.numer_zamowienia),console.log("Generated filename:",j),A.download=j,document.body.appendChild(A),A.click(),window.URL.revokeObjectURL(E),document.body.removeChild(A)}catch(w){console.error("Error generating PDF:",w),alert("Błąd podczas generowania PDF")}};return d.jsx(Fr,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zamówienia"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?d.jsx("div",{className:"flex justify-center items-center py-8",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-700",children:"Numer zamówienia:"}),d.jsx("p",{className:"text-sm font-bold text-gray-900",children:y.numer_zamowienia})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),d.jsx("p",{className:"text-gray-900",children:g(y.data_utworzenia||"")})]})]})}),o&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),d.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Produkty w zamówieniu"}),y.products&&y.products.length>0?d.jsx("div",{children:d.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilość"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Typ"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.products.map(w=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:w.kod}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:d.jsx("div",{className:"break-words leading-tight",children:w.nazwa})}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:w.kod_kreskowy||"-"}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:w.ilosc}),d.jsx("td",{className:"px-4 py-2 text-xs w-20",children:w.typ?d.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${h.find(_=>_.value===w.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:h.find(_=>_.value===w.typ)?.label||w.typ}):d.jsx("span",{className:"text-gray-500",children:"-"})})]},w.id))})]})}):d.jsx("p",{className:"text-xs text-gray-500",children:"Brak produktów w zamówieniu"})]})]})}),d.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",d.jsx("span",{className:"font-semibold text-gray-900",children:y.laczna_ilosc})]}),d.jsx("div",{className:"absolute bottom-4 left-4",children:d.jsx("button",{onClick:k,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};xi("pl",gi);const vd=[{value:"sprzedaz",label:"Sprzedaż",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Próbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],RR=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=D.useState(""),[l,c]=D.useState(""),[f,h]=D.useState(null),[p,x]=D.useState([{kod:"",nazwa:"",ilosc:"",typ:""}]),[g,y]=D.useState(null),[k,w]=D.useState(""),[_,E]=D.useState([]),[A,T]=D.useState(!1),[j,ee]=D.useState(null),[R,C]=D.useState([]),[Q,M]=D.useState(!1),[te,K]=D.useState(null),[B,fe]=D.useState(new Set),ue=async P=>{try{const O=P.map(ie=>ie.kod).filter(ie=>ie.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",O),O.length===0)return;const z=await fetch("/api/working-sheets");if(!z.ok)throw new Error("Failed to fetch working sheets");const H=await z.json();console.log("All working sheets products:",H);const re=O.map(ie=>{const Z=H.find(ge=>ge.kod===ie);return console.log(`Found product for ${ie}:`,Z),Z}).filter(ie=>ie!==void 0);console.log("Found products for order:",re),E(re),console.log("✅ Final loaded products info for order editing:",re)}catch(O){console.error("❌ Error loading products info:",O)}};D.useEffect(()=>{if(e&&r){if(o(r.klient),w(r.klient),K({nazwa:r.klient}),c(r.numer_zamowienia),r.data_utworzenia){const P=new Date(r.data_utworzenia);h(P),console.log("📅 Loaded order date:",P)}else h(null);if(r.products&&r.products.length>0){console.log("Order products from backend:",r.products);const P=r.products.map(O=>({kod:O.kod||"",nazwa:O.nazwa||"",ilosc:(O.ilosc||0).toString(),typ:O.typ||""}));console.log("Formatted products:",P),x(P),console.log("🔄 About to load products info for:",P),ue(P)}else x([{kod:"",nazwa:"",ilosc:"",typ:""}])}},[e,r]),D.useEffect(()=>{const O=setTimeout(async()=>{if(j===null||!p.find((z,H)=>H===j)?.nazwa.trim()){E([]);return}T(!0);try{const z=p.find((Z,ge)=>ge===j)?.nazwa||"";if(!z.trim()){E([]),T(!1);return}const H=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(z)}`);if(!H.ok)throw new Error("Failed to fetch products");const ie=(await H.json()).map(Z=>({kod:Z.kod,nazwa:Z.nazwa||"",ilosc:Z.ilosc?Z.ilosc.toString():"0",status:Z.status||null}));E(ie)}catch(z){console.error("Error searching products:",z),E([])}finally{T(!1)}},300);return()=>clearTimeout(O)},[p,j]),D.useEffect(()=>{const O=setTimeout(async()=>{if(k.trim().length<2){C([]);return}M(!0);try{const z=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!z.ok)throw new Error("Failed to fetch clients");const H=await z.json();C(H)}catch(z){console.error("Error searching clients:",z),C([])}finally{M(!1)}},300);return()=>clearTimeout(O)},[k]),D.useEffect(()=>{const P=z=>{const H=z.target;g!==null&&(H.closest(".dropdown-container")||y(null))},O=z=>{z.key==="Escape"&&y(null)};return g!==null&&(document.addEventListener("mousedown",P),document.addEventListener("keydown",O)),()=>{document.removeEventListener("mousedown",P),document.removeEventListener("keydown",O)}},[g]);const oe=()=>{x([...p,{kod:"",nazwa:"",ilosc:"",typ:""}])},he=P=>{p.length>1&&x(p.filter((O,z)=>z!==P))},V=(P,O)=>{const z=[...p];z[P].typ=O,x(z),y(null)},le=P=>{y(g===P?null:P)},J=(P,O)=>{console.log("🔍 EditOrderModal handleProductSelect called for index:",P,"product:",O.kod);const z=[...p];z[P]={...z[P],kod:O.kod,nazwa:O.nazwa,typ:O.typ||"sztuki"},x(z);const H=[..._],re=H.findIndex(ie=>ie.kod===O.kod);re>=0?H[re]=O:H.push(O),E(H),ee(null),console.log("🔍 EditOrderModal Products list cleared, activeSearchId reset")},ae=async(P,O)=>{const z=new Set;for(let H=0;H<P.length;H++){const re=P[H],ie=parseInt(re.ilosc)||0,Z=p.findIndex(Ge=>Ge.kod===re.kod&&Ge.nazwa===re.nazwa&&Ge.ilosc===re.ilosc);if(Z===-1){console.warn(`⚠️ Could not find actual index for product ${re.kod}`);continue}const xe=O.find(Ge=>Ge.kod===re.kod)?.ilosc||0,L=r?.products?.find(Ge=>Ge.kod===re.kod),Ve=L&&L.ilosc||0;let Te;ie>Ve?(Te=ie-Ve,console.log(`📈 Increasing order: ${Ve} → ${ie}, need additional: ${Te}`)):(Te=ie,console.log(`📉 Decreasing order: ${Ve} → ${ie}, checking total available`));const st=xe+(ie<=Ve?Ve:0);console.log(`Product ${Z} (valid index ${H}):`,{kod:re.kod,requested:ie,availableOnStock:xe,reservedInOrder:Ve,requiredFromStock:Te,totalAvailable:st,hasError:Te>st}),Te>st&&(z.add(Z),console.log(`❌ Error for product ${Z}: required ${Te} > available ${st}`))}return z},W=async P=>{if(P.preventDefault(),!r)return;if(!a.trim()){lt.error("Wprowadź nazwę klienta");return}if(!l.trim()){lt.error("Wprowadź numer zamówienia");return}const O=p.filter(re=>re.kod.trim()&&re.nazwa.trim()&&re.ilosc.trim()&&re.typ.trim());if(O.length===0){lt.error("Dodaj produkty do zamówienia");return}if(O.some(re=>!re.ilosc||!re.typ)){lt.error("Wprowadź ilość i typ dla wszystkich produktów");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",O),console.log("products (stock info):",_),console.log("products.length:",_.length),_.length===0){console.log("⚠️ Products info is empty, reloading...");try{const re=await fetch("/api/working-sheets");if(re.ok){const ie=await re.json();console.log("Reloaded all products:",ie),E(ie);const Z=await ae(O,ie);if(Z.size>0){fe(Z);return}else fe(new Set);console.log("✅ Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),lt.error("Błąd podczas ładowania informacji o produktach");return}}catch(re){console.error("Error reloading products:",re),lt.error("Błąd podczas ładowania informacji o produktach");return}}const z=await ae(O,_);if(z.size>0){fe(z);return}else fe(new Set);const H=O.map(re=>({kod:re.kod,nazwa:re.nazwa,ilosc:parseInt(re.ilosc)||0,typ:re.typ}));console.log("Sending products data:",H);try{const re=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:H})});if(!re.ok){const ie=await re.json();throw new Error(ie.error||"Failed to update order")}lt.success("Zamówienie zostało zaktualizowane"),S(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:H})}catch(re){console.error("Error updating order:",re),lt.error("Wystąpił błąd podczas aktualizacji zamówienia")}},S=()=>{o(""),w(""),K(null),C([]),c(""),h(null),x([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),y(null),E([]),ee(null),n()};return r?d.jsx(Fr,{isOpen:e,onRequestClose:S,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj zamówienie"}),d.jsx("button",{type:"button",onClick:S,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsxs("form",{onSubmit:W,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex space-x-4",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamówienia"}),d.jsx(As,{selected:f,onChange:P=>h(P),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),d.jsx("input",{type:"text",value:l,onChange:P=>c(P.target.value),placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",value:k,onChange:P=>w(P.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),Q&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),R.length>0&&!te&&d.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:R.map(P=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{K(P),w(P.nazwa),o(P.nazwa),C([])},children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:P.nazwa}),d.jsx("span",{className:"text-[10px] text-gray-500",children:P.firma})]})},P.id))})]}),te&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),d.jsx("p",{className:"text-xs text-gray-900",children:te.nazwa})]}),te.firma&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),d.jsx("p",{className:"text-xs text-gray-900",children:te.firma})]}),te.adres&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),d.jsx("p",{className:"text-xs text-gray-900",children:te.adres})]}),te.kontakt&&d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),d.jsx("p",{className:"text-xs text-gray-900",children:te.kontakt})]})]}),d.jsx("button",{type:"button",onClick:()=>{K(null),w(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:d.jsx(Yt,{size:16})})]})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),p.map((P,O)=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx(ni,{className:"h-4 w-4 text-gray-400"})}),d.jsx("input",{type:"text",value:P.nazwa,onChange:z=>{const H=z.target.value;console.log("🔍 EditOrderModal Product search input changed for index:",O,"value:",H);const re=[...p];re[O].nazwa=H,x(re),ee(O)},onFocus:()=>ee(O),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsx("div",{className:"w-16 ml-2",children:d.jsx("input",{type:"number",min:"1",placeholder:"ilość",value:P.ilosc,onChange:z=>{const H=[...p];if(H[O].ilosc=z.target.value,x(H),B.has(O)){const re=new Set(B);re.delete(O),fe(re)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${B.has(O)?"border-red-500":"border-gray-300"}`})}),d.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[d.jsxs("button",{type:"button",onClick:()=>le(O),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${P.typ&&vd.find(z=>z.value===P.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate text-[10px]",children:P.typ&&vd.find(z=>z.value===P.typ)?.label||"Typ"}),d.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g===O&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:z=>z.stopPropagation(),children:vd.map(z=>d.jsx("button",{type:"button",onClick:()=>V(O,z.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${z.color}`,children:z.label},z.value))})]}),p.length>1&&d.jsx("button",{type:"button",onClick:()=>he(O),className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:d.jsx(Yt,{size:16})})]}),O===p.length-1&&d.jsx("button",{type:"button",onClick:oe,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj nową pozycję",children:d.jsx(Js,{size:16})}),A&&j===O&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),_.length>0&&j===O&&P.nazwa.trim()&&d.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:_.map(z=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>J(O,z),children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-medium text-[10px]",children:z.kod}),z.nazwa&&z.nazwa.includes(" (samples)")?d.jsxs("div",{className:"text-[10px]",children:[d.jsx("span",{className:"text-gray-500",children:z.nazwa.replace(" (samples)","")})," ",d.jsx("span",{className:"font-medium",children:"(samples)"})]}):d.jsx("span",{className:"text-[10px] text-gray-500",children:z.nazwa}),d.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostępna ilość: ",z.ilosc]})]})},z.kod))})]},O))]})]}),d.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[d.jsx("button",{type:"button",onClick:S,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),d.jsx("button",{type:"button",onClick:W,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null},MR=({onViewOrder:e,onEditOrder:n,onDeleteOrder:t,onUpdateOrder:r,refreshTrigger:a})=>{const[o,l]=D.useState([]),[c,f]=D.useState(!0),[h,p]=D.useState(null),[x,g]=D.useState(null),[y,k]=D.useState(!1),[w,_]=D.useState(!1),[E,A]=D.useState(null),[T,j]=D.useState(!1),[ee,R]=D.useState(null),[C,Q]=D.useState(""),[M,te]=D.useState("data_utworzenia"),[K,B]=D.useState("desc"),[fe,ue]=D.useState(""),[oe,he]=D.useState(""),V=async()=>{try{console.log("🔄 Starting to load orders..."),f(!0),p(null),console.log("📡 Fetching from /api/orders-with-products...");const xe=await fetch("/api/orders-with-products");if(console.log("📡 Response status:",xe.status),console.log("📡 Response ok:",xe.ok),!xe.ok)throw new Error(`HTTP error! status: ${xe.status}`);const L=await xe.json();console.log("📡 Raw data received:",L),console.log("📡 Raw data length:",L.length);const Ve=L.map(Te=>({id:Te.id,klient:Te.klient,numer_zamowienia:Te.numer_zamowienia,data_utworzenia:Te.data_utworzenia,laczna_ilosc:Te.laczna_ilosc,typ:Te.typ||"zamowienie",numer_zwrotu:Te.numer_zwrotu||null,products:Te.products||[]}));console.log("🔄 Transformed orders:",Ve),console.log("🔄 Orders count:",Ve.length),l(Ve)}catch(xe){console.error("❌ Error loading orders:",xe),p("Failed to load orders")}finally{f(!1)}};D.useEffect(()=>{V()},[]),D.useEffect(()=>{a&&V()},[a]);const le=xe=>new Date(xe).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),J=xe=>{g(xe),k(!0)},ae=xe=>{A(xe),_(!0)},W=async xe=>{if(console.log("OrdersList handleEditSubmit called with data:",xe),r)r(xe);else try{console.log("Sending PUT request to update order:",xe);const L=await fetch(`/api/orders/${xe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});if(!L.ok)throw new Error(`HTTP error! status: ${L.status}`);lt.success("Zamówienie zostało zaktualizowane"),V()}catch(L){console.error("Error updating order:",L),lt.error("Błąd podczas aktualizacji zamówienia")}},S=xe=>{R(xe),j(!0),Q("")},P=async()=>{if(C==="5202"){if(ee?.id)try{t&&t(ee.id);const xe=await fetch(`/api/orders/${ee.id}`,{method:"DELETE"});if(!xe.ok)throw new Error(`HTTP error! status: ${xe.status}`);const L=await xe.json();console.log("Order deleted:",L),lt.success("Zamówienie zostało usunięte"),V()}catch(xe){console.error("Error deleting order:",xe),lt.error("Błąd podczas usuwania zamówienia")}O()}else lt.error("Nieprawidłowe hasło"),Q("")},O=()=>{j(!1),R(null),Q("")},z=xe=>{xe.key==="Enter"&&P()},H=xe=>{M===xe?B(K==="asc"?"desc":"asc"):(te(xe),B("asc"))},re=Array.from(new Set(o.map(xe=>new Date(xe.data_utworzenia).getFullYear().toString()))).sort((xe,L)=>parseInt(L)-parseInt(xe)),ie=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],ge=o.filter(xe=>!(fe&&new Date(xe.data_utworzenia).getFullYear().toString()!==fe||oe&&(new Date(xe.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==oe)).sort((xe,L)=>{let Ve,Te;switch(M){case"numer_zamowienia":Ve=(xe.numer_zamowienia||"").toLowerCase(),Te=(L.numer_zamowienia||"").toLowerCase();break;case"klient":Ve=(xe.klient||"").toLowerCase(),Te=(L.klient||"").toLowerCase();break;case"laczna_ilosc":Ve=xe.laczna_ilosc,Te=L.laczna_ilosc;break;case"data_utworzenia":Ve=new Date(xe.data_utworzenia),Te=new Date(L.data_utworzenia);break;default:Ve=xe[M]||"",Te=L[M]||""}return typeof Ve=="string"&&typeof Te=="string"?K==="asc"?Ve.localeCompare(Te):Te.localeCompare(Ve):typeof Ve=="number"&&typeof Te=="number"?K==="asc"?Ve-Te:Te-Ve:Ve instanceof Date&&Te instanceof Date?K==="asc"?Ve.getTime()-Te.getTime():Te.getTime()-Ve.getTime():0});return c?d.jsx("div",{className:"flex justify-center items-center h-32",children:d.jsx("div",{className:"text-gray-500",children:"Ładowanie zamówień..."})}):h?d.jsx("div",{className:"flex justify-center items-center h-32",children:d.jsxs("div",{className:"text-red-500",children:["Błąd: ",h]})}):d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("numer_zamowienia"),children:"Numer zamówienia"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("klient"),children:"Klient"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("typ"),children:"Typ"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("laczna_ilosc"),children:"Łączna ilość"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>H("data_utworzenia"),children:"Data utworzenia"}),d.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:d.jsxs("div",{className:"flex space-x-1 justify-end",children:[d.jsxs("select",{value:fe,onChange:xe=>ue(xe.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[d.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),re.map(xe=>d.jsx("option",{value:xe,style:{fontFamily:"Sora, sans-serif"},children:xe},xe))]}),d.jsxs("select",{value:oe,onChange:xe=>he(xe.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[d.jsx("option",{value:"",children:"Msc"}),ie.map(xe=>d.jsx("option",{value:xe.value,style:{fontFamily:"Sora, sans-serif"},children:xe.value},xe.value))]})]})})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamówień"})}):ge.map(xe=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:xe.numer_zamowienia}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:xe.klient}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${xe.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:xe.typ==="zwrot"?"Zwrot":"Zamówienie"})}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:xe.laczna_ilosc}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:le(xe.data_utworzenia)}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{type:"button",onClick:L=>{L.preventDefault(),L.stopPropagation(),J(xe)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:d.jsx(Jd,{size:16})}),d.jsx("button",{type:"button",onClick:L=>{L.preventDefault(),L.stopPropagation(),ae(xe)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:d.jsx(Gu,{size:16})}),d.jsx("button",{type:"button",onClick:L=>{L.preventDefault(),L.stopPropagation(),S(xe)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:d.jsx(Yt,{size:16})})]})})]},xe.id))})]})}),d.jsx(Fr,{isOpen:T,onRequestClose:O,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),d.jsx("button",{onClick:O,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsx("div",{children:d.jsx("input",{type:"password",value:C,onChange:xe=>Q(xe.target.value),onKeyPress:z,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[d.jsx("button",{onClick:O,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),d.jsx("button",{onClick:P,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),d.jsx(PR,{isOpen:y,onClose:()=>k(!1),order:x}),d.jsx(RR,{isOpen:w,onClose:()=>{_(!1),A(null)},onSubmit:xe=>{W(xe),_(!1),A(null)},order:E})]})},IR="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",xw=({isOpen:e,onClose:n,product:t})=>t?d.jsx(Fr,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:d.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[d.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:d.jsx(Yt,{size:24})}),d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Детали товара"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Код:"})," ",t.kod]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Название:"})," ",t.nazwa]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Количество:"})," ",t.ilosc]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Ед. измерения:"})," ",t.jednostka_miary]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Штрихкод:"})," ",t.kod_kreskowy]}),t.data_waznosci&&d.jsxs("p",{children:[d.jsx("strong",{children:"Срок годности:"})," ",t.data_waznosci]}),t.waga_netto&&d.jsxs("p",{children:[d.jsx("strong",{children:"Вес нетто:"})," ",t.waga_netto," кг"]}),t.waga_brutto&&d.jsxs("p",{children:[d.jsx("strong",{children:"Вес брутто:"})," ",t.waga_brutto," кг"]}),t.objetosc&&d.jsxs("p",{children:[d.jsx("strong",{children:"Объем:"})," ",t.objetosc," л"]}),t.opis&&d.jsxs("p",{children:[d.jsx("strong",{children:"Описание:"})," ",t.opis]})]})]})}):null,Vu="",gw=({isOpen:e,onClose:n,receipt:t,products:r})=>{const[a,o]=Ce.useState(null),[l,c]=Ce.useState(!1),[f,h]=Ce.useState({x:0,y:0}),[p,x]=Ce.useState(!1),g=Ce.useRef({x:0,y:0});Ce.useEffect(()=>{const w=E=>{p&&h({x:E.clientX-g.current.x,y:E.clientY-g.current.y})},_=()=>x(!1);return p&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",_)),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",_)}},[p]);const y=w=>{w.target.closest("button")||w.target.closest("input")||(x(!0),g.current={x:w.clientX-f.x,y:w.clientY-f.y})};if(!t)return null;let k=[];if(Array.isArray(t.products))k=t.products;else if(typeof t.products=="string")try{k=JSON.parse(t.products)}catch{k=[]}return d.jsxs(Fr,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:y,style:{cursor:p?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły zakupu"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Wartość"}),d.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," €"]})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),d.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," €"]})]})]}),(t.productInvoice||t.transportInvoice)&&d.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&d.jsxs("button",{onClick:()=>{const w=`${Vu}/uploads/${t.productInvoice}`;console.log("📎 Opening product invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[d.jsx(ep,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&d.jsxs("button",{onClick:()=>{const w=`${Vu}/uploads/${t.transportInvoice}`;console.log("📎 Opening transport invoice:",w),window.open(w,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[d.jsx(Zd,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),d.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),d.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),d.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),d.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilość"}),d.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),d.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Wartość"}),d.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),d.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objętość"}),d.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data ważności"})]})}),d.jsx("tbody",{children:k.map((w,_)=>d.jsxs("tr",{children:[d.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.kod}),d.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:w.nazwa}),d.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:w.kod_kreskowy||"-"}),d.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:w.ilosc}),d.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[w.cena," €"]}),d.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(w.ilosc*w.cena).toFixed(2).replace(".",",")," €"]}),d.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const E=w.typ;return E?{czerwone:"Czerwone",biale:"Białe",musujace:"Musujące",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment"}[E]||E:"-"})()}),d.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:w.objetosc||"-"}),d.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:w.dataWaznosci?typeof w.dataWaznosci=="number"?new Date(w.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(w.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},_))})]})]})]}),d.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),d.jsx(xw,{isOpen:l,onClose:()=>c(!1),product:a})]})},jR=({isOpen:e,onClose:n,onAdd:t,initialData:r,isEditMode:a=!1})=>{const[o,l]=D.useState(""),[c,f]=D.useState(""),[h,p]=D.useState(""),[x,g]=D.useState(""),[y,k]=D.useState("");D.useEffect(()=>{console.log("🔍 useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log("🔍 Setting initial data from props"),l(r.firma),f(r.nazwa),p(r.adres),g(r.czas_dostawy),k(r.kontakt)):e&&!r&&console.log("🔍 Modal opened without initial data - keeping current values")},[e,r]);const w=()=>{if(console.log("🔍 handleSubmit called with values:",{firma:o,nazwa:c,adres:h,czas_dostawy:x,kontakt:y}),console.log("🔍 Trimmed values:",{firma:o.trim(),nazwa:c.trim(),adres:h.trim(),czas_dostawy:x.trim(),kontakt:y.trim()}),!o.trim()||!c.trim()||!h.trim()||!x.trim()||!y.trim()){console.log("❌ Validation failed: some fields are empty");return}const E={firma:o.trim(),nazwa:c.trim(),adres:h.trim(),czas_dostawy:x.trim(),kontakt:y.trim()};console.log("✅ Submitting client data:",E),t(E),_()},_=()=>{l(""),f(""),p(""),g(""),k(""),n()};return d.jsx(Fr,{isOpen:e,onRequestClose:_,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),d.jsx("button",{onClick:_,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),d.jsx("input",{type:"text",value:o,onChange:E=>{console.log("🔍 firma onChange:",E.target.value),l(E.target.value)},placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),d.jsx("input",{type:"text",value:c,onChange:E=>f(E.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),d.jsx("input",{type:"text",value:h,onChange:E=>p(E.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),d.jsx("input",{type:"text",value:x,onChange:E=>g(E.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),d.jsx("input",{type:"text",value:y,onChange:E=>k(E.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:w,disabled:!o.trim()||!c.trim()||!h.trim()||!x.trim()||!y.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!o.trim()||!c.trim()||!h.trim()||!x.trim()||!y.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};xi("pl",gi);const yd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],Sv=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],vw=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=D.useState(null),[l,c]=D.useState(""),[f,h]=D.useState({x:0,y:0}),[p,x]=D.useState(!1),[g,y]=D.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k=D.useRef({x:0,y:0}),[w,_]=D.useState(""),[E,A]=D.useState(null),[T,j]=D.useState(null),[ee,R]=D.useState(null),[C,Q]=D.useState(null),M=D.useRef(null),te=D.useRef(null),[K,B]=D.useState(null),[fe,ue]=D.useState(null),[oe,he]=D.useState("0,00"),[V,le]=D.useState("0,00"),[J,ae]=D.useState("0,00"),W=()=>{const de=g.reduce((Le,Ae)=>{const it=parseFloat(Ae.ilosc.toString().replace(",","."))||0;return Le+it},0),De=parseFloat(w.replace(",","."))||0;return de>0?(De/de).toFixed(2):"0,00"};D.useEffect(()=>{if(e&&r){let de=[];if(r.products)if(typeof r.products=="string")try{de=JSON.parse(r.products)}catch(De){console.error("Error parsing products JSON:",De),de=[]}else Array.isArray(r.products)&&(de=r.products);if(Array.isArray(de)&&de.length>0){let De=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[Ae,it,gt]=r.dataPrzyjecia.split("/");De=new Date(parseInt(gt),parseInt(it)-1,parseInt(Ae))}else r.dataPrzyjecia.includes("-")?De=new Date(r.dataPrzyjecia):De=new Date(r.dataPrzyjecia);if(o(De),c(r.sprzedawca||""),_((r.kosztDostawy||0).toFixed(2).replace(".",",")),r.aktualny_kurs!==void 0&&r.aktualny_kurs!==null)he(Number(r.aktualny_kurs).toFixed(2).replace(".",","));else if(r.aktualnyKurs!==void 0&&r.aktualnyKurs!==null)he(String(r.aktualnyKurs).replace(".",","));else{const Ae=de.reduce((Dt,Nt)=>Dt+(Nt.ilosc||0),0),it=Ae?r.kosztDostawy/Ae:0,gt=de[0]?.deliveryCostPerUnitPln||0,ht=it?gt/it:1;he(ht.toFixed(2).replace(".",","))}if(r.podatek_akcyzowy!==void 0&&r.podatek_akcyzowy!==null)le(Number(r.podatek_akcyzowy).toFixed(2).replace(".",","));else if(r.podatekAkcyzowy!==void 0&&r.podatekAkcyzowy!==null)le(String(r.podatekAkcyzowy).replace(".",","));else{const Ae=de[0]?.podatekAkcyzowyPerLiter??de[0]?.podatekAkcyzowy??de[0]?.podatek_akcyzowy??0;le(Ae.toFixed(2).replace(".",","))}r.rabat!==void 0&&r.rabat!==null?ae(Number(r.rabat).toFixed(2).replace(".",",")):ae("0,00");const Le=de.map(Ae=>({kod:Ae.kod||"",nazwa:Ae.nazwa||"",kod_kreskowy:Ae.kod_kreskowy||Ae.ean||"",ilosc:(Ae.ilosc||0).toString(),cena:(Ae.cena||0).toFixed(2).replace(".",","),dataWaznosci:Ae.dataWaznosci||"",showDataWaznosci:!1,typ:Ae.typ||Ae.typTowaru||"",objetosc:Ae.objetosc||""}));y(Le.length>0?Le:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),R(r.productInvoice||null),Q(r.transportInvoice||null),A(null),j(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),A(null),j(null),R(null),Q(null)}else y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),_(""),A(null),j(null),R(null),Q(null)},[e,r]),D.useEffect(()=>{const de=Le=>{const Ae=Le.target;if(!Ae.closest(".dropdown-container")&&!Ae.closest('button[onclick*="toggleDropdown"]')&&B(null),!Ae.closest(".objetosc-dropdown-container")&&!Ae.closest('button[onclick*="toggleObjetoscDropdown"]')&&ue(null),!Ae.closest(".react-datepicker")&&!Ae.closest('button[title*="ważności"]')){const it=[...g];let gt=!1;it.forEach(ht=>{ht.showDataWaznosci&&(ht.showDataWaznosci=!1,gt=!0)}),gt&&y(it)}},De=Le=>{if(Le.key==="Escape"){B(null),ue(null);const Ae=[...g];let it=!1;Ae.forEach(gt=>{gt.showDataWaznosci&&(gt.showDataWaznosci=!1,it=!0)}),it&&y(Ae)}};return document.addEventListener("mousedown",de),document.addEventListener("keydown",De),()=>{document.removeEventListener("mousedown",de),document.removeEventListener("keydown",De)}},[g]);const S=()=>{y([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},P=de=>{if(g.length>1){const De=[...g];De.splice(de,1),y(De)}},O=de=>{const De=[...g];De[de].showDataWaznosci=!De[de].showDataWaznosci,y(De)},z=(de,De)=>{const Le=[...g];Le[de].typ=De,y(Le),B(null)},H=de=>{B(K===de?null:de)},re=(de,De)=>{const Le=[...g];Le[de].objetosc=De,y(Le),ue(null)},ie=de=>{ue(fe===de?null:de)},Z=de=>{de.target.closest("button")||de.target.closest("input")||de.target.closest(".react-datepicker")||de.target.closest('[role="button"]')||de.target.closest(".react-datepicker__input-container")||(x(!0),k.current={x:de.clientX-f.x,y:de.clientY-f.y})};D.useEffect(()=>{const de=Le=>{p&&requestAnimationFrame(()=>{h({x:Le.clientX-k.current.x,y:Le.clientY-k.current.y})})},De=()=>{x(!1)};return p&&(window.addEventListener("mousemove",de),window.addEventListener("mouseup",De)),()=>{window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",De)}},[p]);const ge=de=>{const De=de.target.files?.[0];console.log("📎 Product file selected (edit):",De),De&&De.type==="application/pdf"?(A(De),console.log("✅ Product invoice set (edit):",De.name)):console.log("❌ Invalid product file type (edit):",De?.type)},xe=de=>{const De=de.target.files?.[0];console.log("📎 Transport file selected (edit):",De),De&&De.type==="application/pdf"?(j(De),console.log("✅ Transport invoice set (edit):",De.name)):console.log("❌ Invalid transport file type (edit):",De?.type)},L=()=>{M.current?.click()},Ve=()=>{te.current?.click()},Te=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const de=g.filter(ht=>ht.kod&&ht.nazwa&&ht.ilosc&&ht.cena);if(console.log("productRows:",g),console.log("validProducts:",de),console.log("validProducts.length:",de.length),de.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const De=de.map(ht=>({kod:ht.kod,nazwa:ht.nazwa,kod_kreskowy:ht.kod_kreskowy||"",ilosc:parseFloat(ht.ilosc)||0,cena:parseFloat(ht.cena.replace(",","."))||0,dataWaznosci:ht.dataWaznosci||void 0,typ:ht.typ||void 0,objetosc:ht.objetosc?parseFloat(ht.objetosc):void 0})),Le=De.reduce((ht,Dt)=>ht+Dt.ilosc*Dt.cena,0),Ae=parseFloat(w.replace(",","."))||0,it=parseFloat(J.replace(",","."))||0,gt=Le*(1-it/100);console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:gt,rabat:it+"%",kosztDostawy:Ae,products:De}),console.log("📎 Files to submit (edit):",{productInvoice:E,transportInvoice:T}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:gt,kosztDostawy:Ae,aktualnyKurs:parseFloat(oe.replace(",","."))||1,podatekAkcyzowy:parseFloat(V.replace(",","."))||0,rabat:it,products:De,productInvoice:E||null,transportInvoice:T||null}),st()},st=()=>{o(null),h({x:0,y:0}),y([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),_(""),c(""),A(null),j(null),R(null),Q(null),n()},Ge=()=>g.reduce((de,De)=>{const Le=parseFloat(De.ilosc)||0,Ae=parseFloat(De.cena.replace(",","."))||0;return de+Le*Ae},0).toFixed(2);return d.jsx(Fr,{isOpen:e,onRequestClose:st,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:Z,style:{cursor:p?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:de=>de.stopPropagation(),children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),d.jsx("button",{type:"button",onClick:de=>{de.preventDefault(),de.stopPropagation(),st()},className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),d.jsx(As,{selected:a,onChange:de=>o(de),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsx("div",{className:"w-[200px] flex items-start",children:d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:w,onKeyPress:de=>{const De=String.fromCharCode(de.which);(!/[\d,]/.test(De)||De===","&&de.target.value.includes(",")||de.target.value===""&&De===",")&&de.preventDefault()},onChange:de=>{const De=de.target,Le=De.selectionStart??0;let Ae=De.value.replace(/[^\d,]/g,"");if(Ae===""){_("");return}if(!Ae.includes(","))Ae=Ae+",00";else{const[gt,ht]=Ae.split(",");ht&&ht.length>2&&(Ae=`${gt},${ht.slice(0,2)}`)}_(Ae),requestAnimationFrame(()=>{const gt=Math.min(Le,Ae.length);De.setSelectionRange(gt,gt)})},className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),d.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"€"})]})]})}),d.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:ge,className:"hidden",ref:M}),d.jsx("button",{type:"button",onClick:L,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za towar",children:d.jsx(ep,{className:"h-4 w-4 text-gray-500"})}),E&&d.jsx("a",{href:URL.createObjectURL(E),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:E.name,children:E.name}),!E&&ee&&d.jsx("a",{href:`${Vu}${ee}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),d.jsxs("div",{className:"flex items-center w-48",children:[d.jsx("input",{type:"file",accept:".pdf",onChange:xe,className:"hidden",ref:te}),d.jsx("button",{type:"button",onClick:Ve,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj fakturę za transport",children:d.jsx(Zd,{className:"h-4 w-4 text-gray-500"})}),T&&d.jsx("a",{href:URL.createObjectURL(T),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:T.name,children:T.name}),!T&&C&&d.jsx("a",{href:`${Vu}${C}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),d.jsx("input",{type:"text",value:l,onChange:de=>c(de.target.value),placeholder:"Wprowadź imię sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),d.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[W().replace(".",",")," €"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:oe,onChange:de=>he(de.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-8 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł/€"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:V,onChange:de=>le(de.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"zł"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:J,onChange:de=>ae(de.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),d.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),d.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((de,De)=>d.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[d.jsxs("div",{className:"col-span-1.5 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Kod"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:de.kod,onChange:Le=>{const Ae=[...g];Ae[De].kod=Le.target.value,y(Ae)}}),De===g.length-1&&d.jsx("button",{onClick:S,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:d.jsx(Js,{size:16})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Nazwa"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:de.nazwa,onChange:Le=>{const Ae=[...g];Ae[De].nazwa=Le.target.value,y(Ae)}})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Kod kreskowy"}),d.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:de.kod_kreskowy,onChange:Le=>{const Ae=[...g];Ae[De].kod_kreskowy=Le.target.value,y(Ae)}})]}),d.jsxs("div",{className:"col-span-1.5",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Ilość"}),d.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:de.ilosc,onChange:Le=>{const Ae=[...g],it=Le.target.value;(it===""||/^\d*$/.test(it))&&(Ae[De].ilosc=it,y(Ae))}})]}),d.jsxs("div",{className:"col-span-2.9 relative",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Cena"}),d.jsx("div",{className:"relative",children:d.jsx("input",{type:"text",value:de.cena,onKeyPress:Le=>{const Ae=String.fromCharCode(Le.which);(!/[\d,]/.test(Ae)||Ae===","&&Le.target.value.includes(",")||Le.target.value===""&&Ae===",")&&Le.preventDefault()},onChange:Le=>{const Ae=Le.target,it=Ae.selectionStart??0;let gt=Le.target.value.replace(/[^\d,]/g,"");if(gt===""){const Nt=[...g];Nt[De].cena="",y(Nt);return}if(!gt.includes(","))gt=gt+",00";else{const[Nt,Kt]=gt.split(",");Kt&&Kt.length>2&&(gt=`${Nt},${Kt.slice(0,2)}`)}const Dt=[...g];Dt[De].cena=gt,y(Dt),requestAnimationFrame(()=>{const Nt=Math.min(it,gt.length);Ae.setSelectionRange(Nt,Nt)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),d.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Wartość"}),d.jsx("div",{className:"relative flex items-center",children:d.jsx("input",{type:"text",value:(()=>{const Le=parseFloat(de.ilosc)||0,Ae=parseFloat(de.cena.replace(",","."))||0;return(Le*Ae).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),d.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[d.jsx("button",{type:"button",onClick:()=>O(De),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${de.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:de.dataWaznosci?`Termin ważności: ${de.dataWaznosci}`:"Dodaj termin ważności",children:d.jsx(qd,{size:16})}),d.jsx("button",{onClick:()=>P(De),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:d.jsx(Yt,{size:16})})]}),de.showDataWaznosci&&d.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:d.jsx(As,{selected:de.dataWaznosci?new Date(de.dataWaznosci):null,onChange:Le=>{const Ae=[...g];Ae[De].dataWaznosci=Le?Le.toISOString().split("T")[0]:"",Ae[De].showDataWaznosci=!1,y(Ae)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const Le=[...g];Le[De].showDataWaznosci=!1,y(Le)}})}),d.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Typ"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>H(De),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${de.typ&&yd.find(Le=>Le.value===de.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate",children:de.typ&&yd.find(Le=>Le.value===de.typ)?.label||"Wybierz typ"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),K===De&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:Le=>Le.stopPropagation(),children:yd.map(Le=>d.jsx("button",{type:"button",onClick:()=>z(De,Le.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${Le.color}`,children:Le.label},Le.value))})]})]}),d.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[d.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${De>0?"invisible":""}`,children:"Objętość"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:()=>ie(De),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${de.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[d.jsx("span",{className:"truncate",children:de.objetosc?Sv.find(Le=>Le.value===de.objetosc)?.label||de.objetosc:"Wybierz"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),fe===De&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:Le=>Le.stopPropagation(),style:{maxWidth:"200px"},children:Sv.map(Le=>d.jsx("button",{type:"button",onClick:()=>re(De,Le.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:Le.label},Le.value))})]})]})]},De))})]}),d.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[d.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),d.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[Ge().replace(".",",")," €"]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:Te,disabled:!a||!g.some(de=>de.kod&&de.nazwa&&de.ilosc&&de.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(de=>de.kod&&de.nazwa&&de.ilosc&&de.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},LR=({receipts:e,products:n,onDelete:t,onEdit:r,onUpdate:a,selectedCategory:o=""})=>{const[l,c]=D.useState(null),[f,h]=D.useState(!1),[p,x]=D.useState(!1),[g,y]=D.useState(null),[k,w]=D.useState(!1),[_,E]=D.useState(null),[A,T]=D.useState(""),[j,ee]=D.useState({x:0,y:0}),[R,C]=D.useState(!1),Q=D.useRef({x:0,y:0}),[M,te]=D.useState("dataPrzyjecia"),[K,B]=D.useState("desc"),[fe,ue]=D.useState(""),[oe,he]=D.useState(""),V=Z=>{c(Z),h(!0)},le=Z=>{y(Z),x(!0)},J=Z=>{E(Z),w(!0),T("")},ae=()=>{A==="5202"?(_?.id&&(t(_.id),lt.success("Zapis został usunięty")),W()):(lt.error("Nieprawidłowe hasło"),T(""))},W=()=>{w(!1),E(null),T(""),ee({x:0,y:0})},S=Z=>{Z.key==="Enter"&&ae()},P=Z=>{M===Z?B(K==="asc"?"desc":"asc"):(te(Z),B("asc"))},O=Z=>{Z.target.closest("button")||Z.target.closest("input")||(C(!0),Q.current={x:Z.clientX-j.x,y:Z.clientY-j.y})};D.useEffect(()=>{const Z=xe=>{R&&requestAnimationFrame(()=>{ee({x:xe.clientX-Q.current.x,y:xe.clientY-Q.current.y})})},ge=()=>{C(!1)};return R&&(window.addEventListener("mousemove",Z),window.addEventListener("mouseup",ge)),()=>{window.removeEventListener("mousemove",Z),window.removeEventListener("mouseup",ge)}},[R]);const z=Array.from(new Set(e.map(Z=>new Date(Z.dataPrzyjecia).getFullYear().toString()))).sort((Z,ge)=>parseInt(ge)-parseInt(Z)),H=[{value:"01",label:"Styczeń"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecień"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpień"},{value:"09",label:"Wrzesień"},{value:"10",label:"Październik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzień"}],ie=e.filter(Z=>{if(o)if(typeof Z.products=="string")try{if(!JSON.parse(Z.products).some(L=>L.typ===o))return!1}catch{return!1}else if(Array.isArray(Z.products)){if(!Z.products.some(xe=>xe.typ===o))return!1}else return!1;return!(fe&&new Date(Z.dataPrzyjecia).getFullYear().toString()!==fe||oe&&(new Date(Z.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==oe)}).sort((Z,ge)=>{let xe,L;switch(M){case"dataPrzyjecia":xe=new Date(Z.dataPrzyjecia),L=new Date(ge.dataPrzyjecia);break;case"sprzedawca":xe=(Z.sprzedawca||"").toLowerCase(),L=(ge.sprzedawca||"").toLowerCase();break;case"wartosc":xe=Z.wartosc,L=ge.wartosc;break;case"kosztDostawy":xe=Z.kosztDostawy,L=ge.kosztDostawy;break;default:xe=Z[M]||"",L=ge[M]||""}return typeof xe=="string"&&typeof L=="string"?K==="asc"?xe.localeCompare(L):L.localeCompare(xe):typeof xe=="number"&&typeof L=="number"?K==="asc"?xe-L:L-xe:xe instanceof Date&&L instanceof Date?K==="asc"?xe.getTime()-L.getTime():L.getTime()-xe.getTime():0});return d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("dataPrzyjecia"),children:"Data zakupu"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("sprzedawca"),children:"Sprzedawca"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("wartosc"),children:"Wartość"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>P("kosztDostawy"),children:"Koszt dostawy"}),d.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:d.jsxs("div",{className:"flex space-x-1 justify-end",children:[d.jsxs("select",{value:fe,onChange:Z=>ue(Z.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[d.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),z.map(Z=>d.jsx("option",{value:Z,style:{fontFamily:"Sora, sans-serif"},children:Z},Z))]}),d.jsxs("select",{value:oe,onChange:Z=>he(Z.target.value),className:"block w-24 px-1 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-sora",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},size:1,children:[d.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Msc"}),H.map(Z=>d.jsx("option",{value:Z.value,style:{fontFamily:"Sora, sans-serif"},children:Z.label},Z.value))]})]})})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map(Z=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Z.dataPrzyjecia}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:Z.sprzedawca}),d.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[Z.wartosc.toFixed(2)," €"]}),d.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[Z.kosztDostawy.toFixed(2)," €"]}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{type:"button",onClick:ge=>{ge.preventDefault(),ge.stopPropagation(),V(Z)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:d.jsx(Jd,{size:16})}),d.jsx("button",{type:"button",onClick:ge=>{ge.preventDefault(),ge.stopPropagation(),le(Z)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:d.jsx(Gu,{size:16})}),d.jsx("button",{type:"button",onClick:ge=>{ge.preventDefault(),ge.stopPropagation(),J(Z)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:d.jsx(Yt,{size:16})})]})})]},Z.id))})]})}),d.jsx(Fr,{isOpen:k,onRequestClose:W,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${j.x}px), calc(-50% + ${j.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:O,style:{cursor:R?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),d.jsx("button",{onClick:W,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsx("div",{children:d.jsx("input",{type:"password",value:A,onChange:Z=>T(Z.target.value),onKeyPress:S,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[d.jsx("button",{onClick:W,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),d.jsx("button",{onClick:ae,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),d.jsx(gw,{isOpen:f,onClose:()=>h(!1),receipt:l,products:n}),d.jsx(vw,{isOpen:p,onClose:()=>{x(!1),y(null)},onSubmit:Z=>{a({...Z,productInvoice:Z.productInvoice??void 0,transportInvoice:Z.transportInvoice??void 0}),x(!1),y(null)},receipt:g?{id:g.id||0,dataPrzyjecia:g.dataPrzyjecia,sprzedawca:g.sprzedawca,wartosc:g.wartosc,kosztDostawy:g.kosztDostawy,aktualnyKurs:g.aktualnyKurs,podatekAkcyzowy:g.podatekAkcyzowy,aktualny_kurs:g.aktualny_kurs,podatek_akcyzowy:g.podatek_akcyzowy,products:g.products,productInvoice:g.productInvoice,transportInvoice:g.transportInvoice}:null})]})},zR=({isOpen:e,onClose:n,client:t})=>t?d.jsx(Fr,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegóły klienta"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:d.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),d.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),d.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,yw=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=D.useState(""),[l,c]=D.useState(""),[f,h]=D.useState(""),[p,x]=D.useState(""),[g,y]=D.useState("");D.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),h(r.adres||""),x(r.czas_dostawy||""),y(r.kontakt||"")):(o(""),c(""),h(""),x(""),y(""))},[e,r]);const k=async()=>{if(a.trim()&&l.trim()&&f.trim()&&p.trim()&&g.trim()&&r){const _={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g};t(_),w()}},w=()=>{o(""),c(""),h(""),x(""),y(""),n()};return d.jsx(Fr,{isOpen:e,onRequestClose:w,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),d.jsx("button",{onClick:w,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),d.jsx("input",{type:"text",value:a,onChange:_=>o(_.target.value),placeholder:"Wprowadź nazwę firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),d.jsx("input",{type:"text",value:l,onChange:_=>c(_.target.value),placeholder:"Wprowadź nazwę",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),d.jsx("input",{type:"text",value:f,onChange:_=>h(_.target.value),placeholder:"Wprowadź adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),d.jsx("input",{type:"text",value:p,onChange:_=>x(_.target.value),placeholder:"Wprowadź czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),d.jsx("input",{type:"text",value:g,onChange:_=>y(_.target.value),placeholder:"Wprowadź kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:k,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},BR=({clients:e,onDelete:n,onEdit:t,onUpdate:r})=>{console.log("🔍 ClientsList render - clients:",e),console.log("🔍 ClientsList render - clients length:",e.length),console.log("🔍 ClientsList render - first client:",e[0]),console.log("🔍 ClientsList render - all clients:",e.map(ae=>({id:ae.id,firma:ae.firma,nazwa:ae.nazwa})));const[a,o]=D.useState(null),[l,c]=D.useState(!1),[f,h]=D.useState(!1),[p,x]=D.useState(null),[g,y]=D.useState(!1),[k,w]=D.useState(null),[_,E]=D.useState(""),[A,T]=D.useState({x:0,y:0}),[j,ee]=D.useState(!1),R=D.useRef({x:0,y:0}),[C,Q]=D.useState(""),[M,te]=D.useState("asc");e&&e.length>0,D.useEffect(()=>{console.log("🔍 ClientsList useEffect - clients changed:",e),console.log("🔍 ClientsList useEffect - clients length:",e.length)},[e]);const K=ae=>{o(ae),c(!0)},B=ae=>{x(ae),h(!0)},fe=ae=>{w(ae),y(!0),E("")},ue=()=>{_==="5202"?(k?.id&&n(k.id),oe()):(lt.error("Nieprawidłowe hasło"),E(""))},oe=()=>{y(!1),w(null),E(""),T({x:0,y:0})},he=ae=>{ae.key==="Enter"&&ue()},V=ae=>{C===ae?te(M==="asc"?"desc":"asc"):(Q(ae),te("asc"))},le=ae=>{ae.target.closest("button")||ae.target.closest("input")||(ee(!0),R.current={x:ae.clientX-A.x,y:ae.clientY-A.y})};D.useEffect(()=>{const ae=S=>{j&&requestAnimationFrame(()=>{T({x:S.clientX-R.current.x,y:S.clientY-R.current.y})})},W=()=>{ee(!1)};return j&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",W)),()=>{window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",W)}},[j]),console.log("🔍 Sorting logic - sortField:",C,"sortDirection:",M),console.log("🔍 Sorting logic - clients length:",e.length);const J=C?[...e].sort((ae,W)=>{let S,P;switch(C){case"firma":S=(ae.firma||"").toLowerCase(),P=(W.firma||"").toLowerCase();break;case"nazwa":S=(ae.nazwa||"").toLowerCase(),P=(W.nazwa||"").toLowerCase();break;case"adres":S=(ae.adres||"").toLowerCase(),P=(W.adres||"").toLowerCase();break;case"czas_dostawy":S=(ae.czas_dostawy||"").toLowerCase(),P=(W.czas_dostawy||"").toLowerCase();break;case"kontakt":S=(ae.kontakt||"").toLowerCase(),P=(W.kontakt||"").toLowerCase();break;default:S=ae[C]||"",P=W[C]||""}return typeof S=="string"&&typeof P=="string"?M==="asc"?S.localeCompare(P):P.localeCompare(S):0}):e;return console.log("🔍 Final sortedClients length:",J.length),console.log("🔍 Final sortedClients first:",J[0]),d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>V("firma"),children:["Nazwa firmy ",C==="firma"&&(M==="asc"?"↑":"↓")]}),d.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${C==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>V("nazwa"),children:["Nazwa ",C==="nazwa"&&(M==="asc"?"↑":"↓")]}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("adres"),children:"Adres"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("czas_dostawy"),children:"Czas dostawy"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>V("kontakt"),children:"Kontakt"}),d.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:C&&d.jsx("button",{onClick:()=>{Q(""),te("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:"Сбросить сортировку",children:"Сброс"})})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:J.map((ae,W)=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.firma}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.nazwa}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.adres}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.czas_dostawy}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ae.kontakt}),d.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),S.stopPropagation(),K(ae)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegóły",children:d.jsx(Jd,{size:16})}),d.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),S.stopPropagation(),B(ae)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:d.jsx(Gu,{size:16})}),d.jsx("button",{type:"button",onClick:S=>{S.preventDefault(),S.stopPropagation(),fe(ae)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usuń",children:d.jsx(Yt,{size:16})})]})})]},ae.id||`client-${W}`))})]})}),d.jsx(Fr,{isOpen:g,onRequestClose:oe,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${A.x}px), calc(-50% + ${A.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:le,style:{cursor:j?"grabbing":"grab"},children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Hasło"}),d.jsx("button",{onClick:oe,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-6 flex-grow",children:d.jsx("div",{children:d.jsx("input",{type:"password",value:_,onChange:ae=>E(ae.target.value),onKeyPress:he,placeholder:"Wprowadź hasło",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),d.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[d.jsx("button",{onClick:oe,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),d.jsx("button",{onClick:ue,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usuń"})]})]})}),d.jsx(zR,{isOpen:l,onClose:()=>c(!1),client:a}),d.jsx(yw,{isOpen:f,onClose:()=>{h(!1),x(null)},onSubmit:ae=>{r(ae),h(!1),x(null)},client:p})]})};var wd={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Tv;function WR(){return Tv||(Tv=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(wd)),wd.exports}var UR=WR();const Gd=Ku(UR);var Cv={};const HR="react-tooltip-core-styles",$R="react-tooltip-base-styles",Dv={core:!1,base:!1};function Nv({css:e,id:n=$R,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Dv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Cv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Cv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=HR),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Dv[t]=!0}const Fv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[tw(Number(a)),rw({fallbackAxisSideDirection:"start"}),HA({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const h=l;return t?(h.push(Hd({element:t,padding:5})),$d(e,n,{placement:r,strategy:o,middleware:h}).then((({x:p,y:x,placement:g,middlewareData:y})=>{var k,w;const _={left:`${p}px`,top:`${x}px`,border:c},{x:E,y:A}=(k=y.arrow)!==null&&k!==void 0?k:{x:0,y:0},T=(w={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&w!==void 0?w:"bottom",j=c&&{borderBottom:c,borderRight:c};let ee=0;if(c){const R=`${c}`.match(/(\d+)px/);ee=R?.[1]?Number(R[1]):1}return{tooltipStyles:_,tooltipArrowStyles:{left:E!=null?`${E}px`:"",top:A!=null?`${A}px`:"",right:"",bottom:"",...j,[T]:`-${f/2+ee}px`},place:g}}))):$d(e,n,{placement:"bottom",strategy:o,middleware:h}).then((({x:p,y:x,placement:g})=>({tooltipStyles:{left:`${p}px`,top:`${x}px`},tooltipArrowStyles:{},place:g})))},Av=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),Ov=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Pv=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Xd=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Xd(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Pv(e)||!Pv(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Xd(e[a],n[a])))},YR=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Rv=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(YR(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},VR=typeof window<"u"?D.useLayoutEffect:D.useEffect,In=e=>{e.current&&(clearTimeout(e.current),e.current=null)},KR="DEFAULT_TOOLTIP_ID",GR={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},XR=D.createContext({getTooltipData:()=>GR});function ww(e=KR){return D.useContext(XR).getTooltipData(e)}var Ko={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},kd={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const QR=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:h=["hover"],openOnClick:p=!1,positionStrategy:x="absolute",middlewares:g,wrapper:y,delayShow:k=0,delayHide:w=0,float:_=!1,hidden:E=!1,noArrow:A=!1,clickable:T=!1,closeOnEsc:j=!1,closeOnScroll:ee=!1,closeOnResize:R=!1,openEvents:C,closeEvents:Q,globalCloseEvents:M,imperativeModeOnly:te,style:K,position:B,afterShow:fe,afterHide:ue,disableTooltip:oe,content:he,contentWrapperRef:V,isOpen:le,defaultIsOpen:J=!1,setIsOpen:ae,activeAnchor:W,setActiveAnchor:S,border:P,opacity:O,arrowColor:z,arrowSize:H=8,role:re="tooltip"})=>{var ie;const Z=D.useRef(null),ge=D.useRef(null),xe=D.useRef(null),L=D.useRef(null),Ve=D.useRef(null),[Te,st]=D.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[Ge,de]=D.useState(!1),[De,Le]=D.useState(!1),[Ae,it]=D.useState(null),gt=D.useRef(!1),ht=D.useRef(null),{anchorRefs:Dt,setActiveAnchor:Nt}=ww(n),Kt=D.useRef(!1),[cr,Lt]=D.useState([]),Xt=D.useRef(!1),ot=p||h.includes("click"),St=ot||C?.click||C?.dblclick||C?.mousedown,Qt=C?{...C}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!C&&ot&&Object.assign(Qt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const Et=Q?{...Q}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!Q&&ot&&Object.assign(Et,{mouseleave:!1,blur:!1,mouseout:!1});const zt=M?{...M}:{escape:j||!1,scroll:ee||!1,resize:R||!1,clickOutsideAnchor:St||!1};te&&(Object.assign(Qt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(Et,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(zt,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),VR((()=>(Xt.current=!0,()=>{Xt.current=!1})),[]);const Tt=Ye=>{Xt.current&&(Ye&&Le(!0),setTimeout((()=>{Xt.current&&(ae?.(Ye),le===void 0&&de(Ye))}),10))};D.useEffect((()=>{if(le===void 0)return()=>null;le&&Le(!0);const Ye=setTimeout((()=>{de(le)}),10);return()=>{clearTimeout(Ye)}}),[le]),D.useEffect((()=>{if(Ge!==gt.current)if(In(Ve),gt.current=Ge,Ge)fe?.();else{const Ye=(et=>{const pt=et.match(/^([\d.]+)(ms|s)$/);if(!pt)return 0;const[,Gt,sr]=pt;return Number(Gt)*(sr==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));Ve.current=setTimeout((()=>{Le(!1),it(null),ue?.()}),Ye+25)}}),[Ge]);const se=Ye=>{st((et=>Xd(et,Ye)?et:Ye))},Ne=(Ye=k)=>{In(xe),De?Tt(!0):xe.current=setTimeout((()=>{Tt(!0)}),Ye)},X=(Ye=w)=>{In(L),L.current=setTimeout((()=>{Kt.current||Tt(!1)}),Ye)},me=Ye=>{var et;if(!Ye)return;const pt=(et=Ye.currentTarget)!==null&&et!==void 0?et:Ye.target;if(!pt?.isConnected)return S(null),void Nt({current:null});k?Ne():Tt(!0),S(pt),Nt({current:pt}),In(L)},Se=()=>{T?X(w||100):w?X():Tt(!1),In(xe)},ze=({x:Ye,y:et})=>{var pt;const Gt={getBoundingClientRect:()=>({x:Ye,y:et,width:0,height:0,top:et,left:Ye,right:Ye,bottom:et})};Fv({place:(pt=Ae?.place)!==null&&pt!==void 0?pt:c,offset:f,elementReference:Gt,tooltipReference:Z.current,tooltipArrowReference:ge.current,strategy:x,middlewares:g,border:P,arrowSize:H}).then((sr=>{se(sr)}))},He=Ye=>{if(!Ye)return;const et=Ye,pt={x:et.clientX,y:et.clientY};ze(pt),ht.current=pt},Ze=Ye=>{var et;if(!Ge)return;const pt=Ye.target;pt.isConnected&&(!((et=Z.current)===null||et===void 0)&&et.contains(pt)||[document.querySelector(`[id='${o}']`),...cr].some((Gt=>Gt?.contains(pt)))||(Tt(!1),In(xe)))},yt=Ov(me,50),at=Ov(Se,50),Qe=Ye=>{at.cancel(),yt(Ye)},We=()=>{yt.cancel(),at()},dt=D.useCallback((()=>{var Ye,et;const pt=(Ye=Ae?.position)!==null&&Ye!==void 0?Ye:B;pt?ze(pt):_?ht.current&&ze(ht.current):W?.isConnected&&Fv({place:(et=Ae?.place)!==null&&et!==void 0?et:c,offset:f,elementReference:W,tooltipReference:Z.current,tooltipArrowReference:ge.current,strategy:x,middlewares:g,border:P,arrowSize:H}).then((Gt=>{Xt.current&&se(Gt)}))}),[Ge,W,he,K,c,Ae?.place,f,x,B,Ae?.position,_,H]);D.useEffect((()=>{var Ye,et;const pt=new Set(Dt);cr.forEach((Me=>{oe?.(Me)||pt.add({current:Me})}));const Gt=document.querySelector(`[id='${o}']`);Gt&&!oe?.(Gt)&&pt.add({current:Gt});const sr=()=>{Tt(!1)},F=Rv(W),G=Rv(Z.current);zt.scroll&&(window.addEventListener("scroll",sr),F?.addEventListener("scroll",sr),G?.addEventListener("scroll",sr));let I=null;zt.resize?window.addEventListener("resize",sr):W&&Z.current&&(I=ew(W,Z.current,dt,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const U=Me=>{Me.key==="Escape"&&Tt(!1)};zt.escape&&window.addEventListener("keydown",U),zt.clickOutsideAnchor&&window.addEventListener("click",Ze);const Y=[],q=Me=>!!(Me?.target&&W?.contains(Me.target)),we=Me=>{Ge&&q(Me)||me(Me)},Fe=Me=>{Ge&&q(Me)&&Se()},ye=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],_e=["click","dblclick","mousedown","mouseup"];Object.entries(Qt).forEach((([Me,Ie])=>{Ie&&(ye.includes(Me)?Y.push({event:Me,listener:Qe}):_e.includes(Me)&&Y.push({event:Me,listener:we}))})),Object.entries(Et).forEach((([Me,Ie])=>{Ie&&(ye.includes(Me)?Y.push({event:Me,listener:We}):_e.includes(Me)&&Y.push({event:Me,listener:Fe}))})),_&&Y.push({event:"pointermove",listener:He});const be=()=>{Kt.current=!0},Re=()=>{Kt.current=!1,Se()},$e=T&&(Et.mouseout||Et.mouseleave);return $e&&((Ye=Z.current)===null||Ye===void 0||Ye.addEventListener("mouseover",be),(et=Z.current)===null||et===void 0||et.addEventListener("mouseout",Re)),Y.forEach((({event:Me,listener:Ie})=>{pt.forEach((je=>{var ft;(ft=je.current)===null||ft===void 0||ft.addEventListener(Me,Ie)}))})),()=>{var Me,Ie;zt.scroll&&(window.removeEventListener("scroll",sr),F?.removeEventListener("scroll",sr),G?.removeEventListener("scroll",sr)),zt.resize?window.removeEventListener("resize",sr):I?.(),zt.clickOutsideAnchor&&window.removeEventListener("click",Ze),zt.escape&&window.removeEventListener("keydown",U),$e&&((Me=Z.current)===null||Me===void 0||Me.removeEventListener("mouseover",be),(Ie=Z.current)===null||Ie===void 0||Ie.removeEventListener("mouseout",Re)),Y.forEach((({event:je,listener:ft})=>{pt.forEach((Ut=>{var Bt;(Bt=Ut.current)===null||Bt===void 0||Bt.removeEventListener(je,ft)}))}))}}),[W,dt,De,Dt,cr,C,Q,M,ot,k,w]),D.useEffect((()=>{var Ye,et;let pt=(et=(Ye=Ae?.anchorSelect)!==null&&Ye!==void 0?Ye:l)!==null&&et!==void 0?et:"";!pt&&n&&(pt=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const Gt=new MutationObserver((sr=>{const F=[],G=[];sr.forEach((I=>{if(I.type==="attributes"&&I.attributeName==="data-tooltip-id"&&(I.target.getAttribute("data-tooltip-id")===n?F.push(I.target):I.oldValue===n&&G.push(I.target)),I.type==="childList"){if(W){const U=[...I.removedNodes].filter((Y=>Y.nodeType===1));if(pt)try{G.push(...U.filter((Y=>Y.matches(pt)))),G.push(...U.flatMap((Y=>[...Y.querySelectorAll(pt)])))}catch{}U.some((Y=>{var q;return!!(!((q=Y?.contains)===null||q===void 0)&&q.call(Y,W))&&(Le(!1),Tt(!1),S(null),In(xe),In(L),!0)}))}if(pt)try{const U=[...I.addedNodes].filter((Y=>Y.nodeType===1));F.push(...U.filter((Y=>Y.matches(pt)))),F.push(...U.flatMap((Y=>[...Y.querySelectorAll(pt)])))}catch{}}})),(F.length||G.length)&&Lt((I=>[...I.filter((U=>!G.includes(U))),...F]))}));return Gt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{Gt.disconnect()}}),[n,l,Ae?.anchorSelect,W]),D.useEffect((()=>{dt()}),[dt]),D.useEffect((()=>{if(!V?.current)return()=>null;const Ye=new ResizeObserver((()=>{setTimeout((()=>dt()))}));return Ye.observe(V.current),()=>{Ye.disconnect()}}),[he,V?.current]),D.useEffect((()=>{var Ye;const et=document.querySelector(`[id='${o}']`),pt=[...cr,et];W&&pt.includes(W)||S((Ye=cr[0])!==null&&Ye!==void 0?Ye:et)}),[o,cr,W]),D.useEffect((()=>(J&&Tt(!0),()=>{In(xe),In(L)})),[]),D.useEffect((()=>{var Ye;let et=(Ye=Ae?.anchorSelect)!==null&&Ye!==void 0?Ye:l;if(!et&&n&&(et=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),et)try{const pt=Array.from(document.querySelectorAll(et));Lt(pt)}catch{Lt([])}}),[n,l,Ae?.anchorSelect]),D.useEffect((()=>{xe.current&&(In(xe),Ne(k))}),[k]);const wt=(ie=Ae?.content)!==null&&ie!==void 0?ie:he,wr=Ge&&Object.keys(Te.tooltipStyles).length>0;return D.useImperativeHandle(e,(()=>({open:Ye=>{if(Ye?.anchorSelect)try{document.querySelector(Ye.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ye.anchorSelect}" is not a valid CSS selector`)}it(Ye??null),Ye?.delay?Ne(Ye.delay):Tt(!0)},close:Ye=>{Ye?.delay?X(Ye.delay):Tt(!1)},activeAnchor:W,place:Te.place,isOpen:!!(De&&!E&&wt&&wr)}))),De&&!E&&wt?Ce.createElement(y,{id:n,role:re,className:Gd("react-tooltip",Ko.tooltip,kd.tooltip,kd[a],t,`react-tooltip__place-${Te.place}`,Ko[wr?"show":"closing"],wr?"react-tooltip__show":"react-tooltip__closing",x==="fixed"&&Ko.fixed,T&&Ko.clickable),onTransitionEnd:Ye=>{In(Ve),Ge||Ye.propertyName!=="opacity"||(Le(!1),it(null),ue?.())},style:{...K,...Te.tooltipStyles,opacity:O!==void 0&&wr?O:void 0},ref:Z},wt,Ce.createElement(y,{className:Gd("react-tooltip-arrow",Ko.arrow,kd.arrow,r,A&&Ko.noArrow),style:{...Te.tooltipArrowStyles,background:z?`linear-gradient(to right bottom, transparent 50%, ${z} 50%)`:void 0,"--rt-arrow-size":`${H}px`},ref:ge})):null},qR=({content:e})=>Ce.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),pu=Ce.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:h="top",offset:p=10,wrapper:x="div",children:g=null,events:y=["hover"],openOnClick:k=!1,positionStrategy:w="absolute",middlewares:_,delayShow:E=0,delayHide:A=0,float:T=!1,hidden:j=!1,noArrow:ee=!1,clickable:R=!1,closeOnEsc:C=!1,closeOnScroll:Q=!1,closeOnResize:M=!1,openEvents:te,closeEvents:K,globalCloseEvents:B,imperativeModeOnly:fe=!1,style:ue,position:oe,isOpen:he,defaultIsOpen:V=!1,disableStyleInjection:le=!1,border:J,opacity:ae,arrowColor:W,arrowSize:S,setIsOpen:P,afterShow:O,afterHide:z,disableTooltip:H,role:re="tooltip"},ie)=>{const[Z,ge]=D.useState(r),[xe,L]=D.useState(a),[Ve,Te]=D.useState(h),[st,Ge]=D.useState(f),[de,De]=D.useState(p),[Le,Ae]=D.useState(E),[it,gt]=D.useState(A),[ht,Dt]=D.useState(T),[Nt,Kt]=D.useState(j),[cr,Lt]=D.useState(x),[Xt,ot]=D.useState(y),[St,Qt]=D.useState(w),[Et,zt]=D.useState(null),[Tt,se]=D.useState(null),Ne=D.useRef(le),{anchorRefs:X,activeAnchor:me}=ww(e),Se=at=>at?.getAttributeNames().reduce(((Qe,We)=>{var dt;return We.startsWith("data-tooltip-")&&(Qe[We.replace(/^data-tooltip-/,"")]=(dt=at?.getAttribute(We))!==null&&dt!==void 0?dt:null),Qe}),{}),ze=at=>{const Qe={place:We=>{var dt;Te((dt=We)!==null&&dt!==void 0?dt:h)},content:We=>{ge(We??r)},html:We=>{L(We??a)},variant:We=>{var dt;Ge((dt=We)!==null&&dt!==void 0?dt:f)},offset:We=>{De(We===null?p:Number(We))},wrapper:We=>{var dt;Lt((dt=We)!==null&&dt!==void 0?dt:x)},events:We=>{const dt=We?.split(" ");ot(dt??y)},"position-strategy":We=>{var dt;Qt((dt=We)!==null&&dt!==void 0?dt:w)},"delay-show":We=>{Ae(We===null?E:Number(We))},"delay-hide":We=>{gt(We===null?A:Number(We))},float:We=>{Dt(We===null?T:We==="true")},hidden:We=>{Kt(We===null?j:We==="true")},"class-name":We=>{zt(We)}};Object.values(Qe).forEach((We=>We(null))),Object.entries(at).forEach((([We,dt])=>{var wt;(wt=Qe[We])===null||wt===void 0||wt.call(Qe,dt)}))};D.useEffect((()=>{ge(r)}),[r]),D.useEffect((()=>{L(a)}),[a]),D.useEffect((()=>{Te(h)}),[h]),D.useEffect((()=>{Ge(f)}),[f]),D.useEffect((()=>{De(p)}),[p]),D.useEffect((()=>{Ae(E)}),[E]),D.useEffect((()=>{gt(A)}),[A]),D.useEffect((()=>{Dt(T)}),[T]),D.useEffect((()=>{Kt(j)}),[j]),D.useEffect((()=>{Qt(w)}),[w]),D.useEffect((()=>{Ne.current!==le&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[le]),D.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:le==="core",disableBase:le}}))}),[]),D.useEffect((()=>{var at;const Qe=new Set(X);let We=t;if(!We&&e&&(We=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),We)try{document.querySelectorAll(We).forEach((et=>{Qe.add({current:et})}))}catch{console.warn(`[react-tooltip] "${We}" is not a valid CSS selector`)}const dt=document.querySelector(`[id='${n}']`);if(dt&&Qe.add({current:dt}),!Qe.size)return()=>null;const wt=(at=Tt??dt)!==null&&at!==void 0?at:me.current,wr=new MutationObserver((et=>{et.forEach((pt=>{var Gt;if(!wt||pt.type!=="attributes"||!(!((Gt=pt.attributeName)===null||Gt===void 0)&&Gt.startsWith("data-tooltip-")))return;const sr=Se(wt);ze(sr)}))})),Ye={attributes:!0,childList:!1,subtree:!1};if(wt){const et=Se(wt);ze(et),wr.observe(wt,Ye)}return()=>{wr.disconnect()}}),[X,me,Tt,n,t]),D.useEffect((()=>{ue?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),J&&!Av("border",`${J}`)&&console.warn(`[react-tooltip] "${J}" is not a valid \`border\`.`),ue?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),ae&&!Av("opacity",`${ae}`)&&console.warn(`[react-tooltip] "${ae}" is not a valid \`opacity\`.`)}),[]);let He=g;const Ze=D.useRef(null);if(o){const at=o({content:Tt?.getAttribute("data-tooltip-content")||Z||null,activeAnchor:Tt});He=at?Ce.createElement("div",{ref:Ze,className:"react-tooltip-content-wrapper"},at):null}else Z&&(He=Z);xe&&(He=Ce.createElement(qR,{content:xe}));const yt={forwardRef:ie,id:e,anchorId:n,anchorSelect:t,className:Gd(l,Et),classNameArrow:c,content:He,contentWrapperRef:Ze,place:Ve,variant:st,offset:de,wrapper:cr,events:Xt,openOnClick:k,positionStrategy:St,middlewares:_,delayShow:Le,delayHide:it,float:ht,hidden:Nt,noArrow:ee,clickable:R,closeOnEsc:C,closeOnScroll:Q,closeOnResize:M,openEvents:te,closeEvents:K,globalCloseEvents:B,imperativeModeOnly:fe,style:ue,position:oe,isOpen:he,defaultIsOpen:V,border:J,opacity:ae,arrowColor:W,arrowSize:S,setIsOpen:P,afterShow:O,afterHide:z,disableTooltip:H,activeAnchor:Tt,setActiveAnchor:at=>se(at),role:re};return Ce.createElement(QR,{...yt})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Nv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Nv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));xi("pl",gi);const _d=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],ZR=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],JR=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=D.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:"",koszt_dostawy_per_unit:"",podatek_akcyzowy_per_liter:"2.22"}),[l,c]=D.useState(!1),[f,h]=D.useState(!1),[p,x]=D.useState(!1),[g,y]=D.useState(!1),[k,w]=D.useState(null);D.useEffect(()=>{if(t)if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const C=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(C).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():"",koszt_dostawy_per_unit:t.koszt_dostawy_per_unit?t.koszt_dostawy_per_unit.toString():"",podatek_akcyzowy_per_liter:t.podatek_akcyzowy&&t.objetosc&&t.objetosc>0?(t.podatek_akcyzowy/t.objetosc).toFixed(2):"2.22"}),t.data_waznosci){let C;if(typeof t.data_waznosci=="string")C=new Date(t.data_waznosci);else{const Q=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;C=new Date(Q)}w(isNaN(C.getTime())?null:C)}else w(null)},[t]);const _=C=>{o(Q=>({...Q,typ:C})),h(!1)},E=()=>{h(!f)},A=C=>{o(Q=>({...Q,objetosc:C})),x(!1)},T=()=>{x(!p)},j=()=>{y(!g)},ee=C=>{w(C),o(Q=>({...Q,data_waznosci:C?C.toISOString().split("T")[0]:""})),y(!1)};D.useEffect(()=>{const C=M=>{const te=M.target;f&&!te.closest(".dropdown-container")&&h(!1),p&&!te.closest(".dropdown-container")&&x(!1),g&&!te.closest(".react-datepicker")&&!te.closest('button[title*="ważności"]')&&y(!1)},Q=M=>{M.key==="Escape"&&(h(!1),x(!1),y(!1))};return(f||p||g)&&(document.addEventListener("mousedown",C),document.addEventListener("keydown",Q)),()=>{document.removeEventListener("mousedown",C),document.removeEventListener("keydown",Q)}},[f,p,g]);const R=async C=>{if(C&&C.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0,koszt_dostawy_per_unit:parseFloat(a.koszt_dostawy_per_unit)||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(a.podatek_akcyzowy_per_liter)*parseFloat(a.objetosc):void 0})})).ok)throw new Error("Failed to update item");const M={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0,koszt_dostawy_per_unit:parseFloat(a.koszt_dostawy_per_unit)||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(a.podatek_akcyzowy_per_liter)*parseFloat(a.objetosc):void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(te){console.error("Error creating price history record:",te)}r(M),lt.success("Pozycja została zaktualizowana pomyślnie"),n()}catch(Q){console.error("Error updating item:",Q),lt.error("Błąd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:d.jsx(Fr,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycję"}),d.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsx("form",{onSubmit:R,className:"space-y-6 flex-grow",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),d.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex-[2]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),d.jsx("input",{type:"text",value:a.sprzedawca,onChange:C=>o(Q=>({...Q,sprzedawca:C.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),d.jsxs("div",{className:"flex-1 relative dropdown-container",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:E,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&_d.find(C=>C.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[d.jsx("span",{className:"truncate",children:a.typ&&_d.find(C=>C.value===a.typ)?.label||"Wybierz typ"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:_d.map(C=>d.jsx("button",{type:"button",onClick:()=>_(C.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${C.color}`,children:C.label},C.value))})]})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex-1 relative dropdown-container",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objętość"}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{type:"button",onClick:T,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[d.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),d.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&d.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:C=>C.stopPropagation(),children:ZR.map(C=>d.jsx("button",{type:"button",onClick:()=>A(C.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:C.label},C.value))})]})]}),d.jsxs("div",{className:"flex-1 relative",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data ważności"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"text",value:k?k.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz datę",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),d.jsx("button",{type:"button",onClick:j,className:`p-1 focus:outline-none ${k?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:k?`Termin ważności: ${k.toLocaleDateString("pl-PL")}`:"Dodaj termin ważności",children:d.jsx(qd,{size:16})})]}),g&&d.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:d.jsx(As,{selected:k,onChange:ee,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>y(!1)})})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa (€)"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:C=>o(Q=>({...Q,cena:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzedaży (zł)"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:C=>o(Q=>({...Q,cena_sprzedazy:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:a.koszt_dostawy_per_unit,onChange:C=>o(Q=>({...Q,koszt_dostawy_per_unit:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:a.podatek_akcyzowy_per_liter,onChange:C=>o(Q=>({...Q,podatek_akcyzowy_per_liter:C.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:R,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},eM=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .resizable-table {
    table-layout: fixed !important;
    width: max-content !important;
    min-width: 100% !important;
  }
  
  .resizable-table th,
  .resizable-table td {
    box-sizing: border-box !important;
    overflow: visible !important;
  }
  
  /* no generic resizable columns */
`,bd=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Białe",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujące",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"}],Mv=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}return""}catch(n){return console.error("Error extracting date from order number:",n),""}},Ed=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},tM=({refreshTrigger:e,productReceipts:n=[]})=>{D.useEffect(()=>{const se=document.createElement("style");return se.textContent=eM,document.head.appendChild(se),()=>{document.head.removeChild(se)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=D.useState([]),[a,o]=D.useState([]),[l,c]=D.useState([]),[f,h]=D.useState(!0),[p,x]=D.useState(null),[g,y]=D.useState(!1),[k,w]=D.useState(null),[_,E]=D.useState(""),[A,T]=D.useState(""),[j,ee]=D.useState(()=>localStorage.getItem("sortField")||"nazwa"),[R,C]=D.useState(()=>localStorage.getItem("sortDirection")||"asc"),[Q,M]=D.useState([]),[te,K]=D.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[B,fe]=D.useState(!1),[ue,oe]=D.useState(null),[he,V]=D.useState({}),[le,J]=D.useState({}),[ae,W]=D.useState({}),[S,P]=D.useState(()=>{const se=localStorage.getItem("columnWidths");if(se)try{return JSON.parse(se)}catch(Ne){console.error("Error parsing saved column widths:",Ne)}return{nazwa:250}}),[O,z]=D.useState(null),[H,re]=D.useState(0),[ie,Z]=D.useState(0),[ge,xe]=D.useState(!1),L=D.useRef(null),Ve=D.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const se=new Map;try{for(const Ne of n)if(Array.isArray(Ne.products))for(const X of Ne.products)X.kod&&!se.has(X.kod)&&se.set(X.kod,Ne.sprzedawca)}catch(Ne){console.error("Error building sprzedawcaCache:",Ne)}return console.log("sprzedawcaCache built with",se.size,"entries"),se},[n]),Te=D.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const se=new Map;try{const Ne=X=>{let me=null;return n.forEach(Se=>{if(Array.isArray(Se.products)&&Se.products.some(ze=>ze.kod===X)){const ze=new Date(Se.dataPrzyjecia);(!me||ze<me)&&(me=ze)}}),a.forEach(Se=>{if(Se.kod===X){let ze=null;Se.numer_zamowienia&&(ze=Ed(Se.numer_zamowienia)),!ze&&Se.created_at&&(ze=new Date(Se.created_at)),ze&&(!me||ze<me)&&(me=ze)}}),me};for(const X of t){const me=Ne(X.kod);if(me){const ze=Math.max(1,Math.ceil((new Date().getTime()-me.getTime())/(1e3*60*60*24))),He=a.filter(Ze=>Ze.kod!==X.kod?!1:Ze.numer_zamowienia?Ed(Ze.numer_zamowienia)!==null:Ze.created_at!==null).reduce((Ze,yt)=>Ze+yt.ilosc,0);se.set(X.kod,He/ze)}else se.set(X.kod,0)}}catch(Ne){console.error("Error building averageSalesCache:",Ne)}return console.log("averageSalesCache built with",se.size,"entries"),se},[t,a,n]),st=async()=>{try{const se=await fetch("/api/products");if(se.ok){const Ne=await se.json(),X={};Ne.forEach(me=>{me.status!=="samples"&&(X[me.kod]||(X[me.kod]=[]),X[me.kod].push({cena:me.cena,ilosc_aktualna:me.ilosc_aktualna,data_zmiany:me.updated_at||me.created_at}))}),Object.keys(X).forEach(me=>{X[me].sort((Se,ze)=>new Date(ze.data_zmiany).getTime()-new Date(Se.data_zmiany).getTime())}),V(X)}}catch(se){console.error("Error loading all products:",se)}},Ge=se=>{const Ne=a.filter(me=>me.kod===se);if(Ne.length===0)return null;let X=null;return Ne.forEach(me=>{let Se=null;me.numer_zamowienia&&(Se=Ed(me.numer_zamowienia)),!Se&&me.created_at&&(Se=new Date(me.created_at)),Se&&(!X||Se>X)&&(X=Se)}),X},de=async()=>{try{console.log("Starting loadInventory..."),h(!0),x(null),console.log("Fetching working-sheets...");const se=await fetch("/api/working-sheets");if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const Ne=await se.json();console.log("Inventory data from server:",Ne.length,"items"),Ne.length>0&&(console.log("First item keys:",Object.keys(Ne[0])),console.log("First item typ value:",Ne[0].typ),Ne[0].data_waznosci&&(console.log("First item data_waznosci:",Ne[0].data_waznosci),console.log("First item data_waznosci type:",typeof Ne[0].data_waznosci),console.log("First item data_waznosci formatted:",zt(Ne[0].data_waznosci)))),r(Ne),console.log("Fetching orders...");const X=await fetch("/api/orders");if(!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const me=await X.json();console.log("Orders data from server:",me.length,"items"),c(me),console.log("Fetching orders-with-products...");const Se=await fetch("/api/orders-with-products");if(!Se.ok)throw new Error(`HTTP error! status: ${Se.status}`);const ze=await Se.json();console.log("Orders with products from server:",ze.length,"items");const He=[];ze.forEach(at=>{at.products&&at.products.forEach(Qe=>{He.push({...Qe,orderId:at.id,created_at:Qe.created_at||at.data_utworzenia,numer_zamowienia:at.numer_zamowienia})})}),console.log("Total order products:",He.length),o(He),await st();const Ze=await fetch("/api/products/samples-count");if(Ze.ok){const at=await Ze.json(),Qe={};at.forEach(We=>{Qe[We.kod]=We.total_ilosc||0}),J(Qe)}const yt=await fetch("/api/products/wartosc-towaru");if(yt.ok){const at=await yt.json(),Qe={};at.forEach(We=>{Qe[We.kod]=We.wartosc||0}),W(Qe)}console.log("loadInventory completed successfully")}catch(se){console.error("Error loading inventory:",se),x(`Failed to load inventory: ${se instanceof Error?se.message:"Unknown error"}`)}finally{h(!1)}};D.useEffect(()=>{de()},[]),D.useEffect(()=>{e&&de()},[e]);const De=se=>{if(j===se){const Ne=R==="asc"?"desc":"asc";C(Ne),localStorage.setItem("sortDirection",Ne)}else ee(se),C("asc"),localStorage.setItem("sortField",se),localStorage.setItem("sortDirection","asc")},Le=se=>{const Ne=bd.find(X=>X.value===se);return Ne?Ne.color:"bg-gray-100 text-gray-800 border-gray-200"},Ae=se=>se===1/0?"bg-gray-100 text-gray-800 border-gray-200":se<=30?"bg-red-100 text-gray-800 border-red-200":se<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",it=D.useMemo(()=>{const se=new Set;return t.forEach(Ne=>{const X=Ne.sprzedawca||Ve.get(Ne.kod);X&&se.add(X)}),Array.from(se).sort()},[t,Ve]),gt=D.useMemo(()=>{const se=new Set;return t.forEach(Ne=>{Ne.typ&&se.add(Ne.typ)}),Array.from(se).sort()},[t]),ht=D.useMemo(()=>{const se=new Set;return t.forEach(Ne=>{Ne.objetosc&&se.add(Ne.objetosc.toString())}),Array.from(se).sort((Ne,X)=>parseFloat(Ne)-parseFloat(X))},[t]),Dt=D.useMemo(()=>{const se=new Set;return t.forEach(Ne=>{if(Ne.ilosc===0)se.add("brak");else{const X=Te.get(Ne.kod)||0,me=X<=0?1/0:Math.floor(Ne.ilosc/X),Se=me===1/0?"Brak danych":me<=30?"mało":me<=60?"średnie":"dużo";se.add(Se)}}),Array.from(se).sort()},[t,Te]),Nt=t.filter(se=>{if(!(se.kod.toLowerCase().includes(A.toLowerCase())||se.nazwa.toLowerCase().includes(A.toLowerCase())||se.kod_kreskowy&&se.kod_kreskowy.toLowerCase().includes(A.toLowerCase()))||te.sprzedawca&&(se.sprzedawca||Ve.get(se.kod))!==te.sprzedawca||te.typ&&se.typ!==te.typ||te.objetosc&&se.objetosc?.toString()!==te.objetosc)return!1;if(te.status){let X;if(se.ilosc===0)X="brak";else{const me=Te.get(se.kod)||0,Se=me<=0?1/0:Math.floor(se.ilosc/me);X=Se===1/0?"Brak danych":Se<=30?"mało":Se<=60?"średnie":"dużo"}if(X!==te.status)return!1}return!0}).sort((se,Ne)=>{let X,me;switch(j){case"sprzedawca":X=se.sprzedawca||Ve.get(se.kod)||"",me=Ne.sprzedawca||Ve.get(Ne.kod)||"";break;case"cena":X=se.cena||0,me=Ne.cena||0;break;case"cena_sprzedazy":X=se.cena_sprzedazy||0,me=Ne.cena_sprzedazy||0;break;case"koszt_wlasny":X=se.koszt_wlasny||0,me=Ne.koszt_wlasny||0;break;case"srednieZuzycie":X=Te.get(se.kod)||0,me=Te.get(Ne.kod)||0;break;case"dniPozostalo":const Se=Te.get(se.kod)||0,ze=Te.get(Ne.kod)||0;X=Se<=0?1/0:Math.floor(se.ilosc/Se),me=ze<=0?1/0:Math.floor(Ne.ilosc/ze);break;case"dataWyczerpania":if(se.ilosc===0){const Qe=Ge(se.kod);X=Qe?Qe.getTime():0}else{const Qe=Te.get(se.kod)||0,We=Qe<=0?1/0:Math.floor(se.ilosc/Qe);X=We===1/0?1/0:new Date().setDate(new Date().getDate()+We)}if(Ne.ilosc===0){const Qe=Ge(Ne.kod);me=Qe?Qe.getTime():0}else{const Qe=Te.get(Ne.kod)||0,We=Qe<=0?1/0:Math.floor(Ne.ilosc/Qe);me=We===1/0?1/0:new Date().setDate(new Date().getDate()+We)}break;case"status":const He=Qe=>{if(Qe.ilosc===0)return 0;const We=Te.get(Qe.kod)||0,dt=We<=0?1/0:Math.floor(Qe.ilosc/We);return dt===1/0?4:dt<=30?1:dt<=60?2:3};X=He(se),me=He(Ne);break;case"typ":X=se.typ||"",me=Ne.typ||"";break;case"objetosc":X=se.objetosc||0,me=Ne.objetosc||0;break;case"dataWaznosci":const Ze=Qe=>{if(!Qe)return 0;let We;if(typeof Qe=="string")We=new Date(Qe);else if(typeof Qe=="number")Qe<1e12?We=new Date(Qe*1e3):We=new Date(Qe);else return 0;return isNaN(We.getTime())?0:We.getTime()};X=Ze(se.data_waznosci),me=Ze(Ne.data_waznosci);break;case"sprzedaze":const yt=a.filter(Qe=>Qe.kod===se.kod).length,at=a.filter(Qe=>Qe.kod===Ne.kod).length;X=yt,me=at;break;default:X=se[j],me=Ne[j]}return typeof X=="string"&&typeof me=="string"?R==="asc"?X.localeCompare(me):me.localeCompare(X):typeof X=="number"&&typeof me=="number"?R==="asc"?X-me:me-X:0}),Kt=se=>{M(se?Nt.map(Ne=>Ne.id):[])},cr=(se,Ne)=>{M(X=>Ne?[...X,se]:X.filter(me=>me!==se))},Lt=(se,Ne)=>{se.preventDefault(),se.stopPropagation(),console.log("🖱️ Mouse down on column:",Ne,"X:",se.clientX,"Current width:",S[Ne]),z(Ne),re(se.clientX),Z(S[Ne]),xe(!1),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},Xt=se=>{if(O){const Ne=se.clientX-H,X=Math.max(50,ie+Ne);console.log("🔄 Mouse move:","DeltaX:",Ne,"NewWidth:",X,"Column:",O),Math.abs(Ne)>3&&xe(!0);const me={...S,[O]:X};P(me),localStorage.setItem("columnWidths",JSON.stringify(me))}},ot=()=>{console.log("🖱️ Mouse up - finishing resize"),z(null),re(0),Z(0),document.body.style.cursor="",document.body.style.userSelect="",setTimeout(()=>{xe(!1)},100)};D.useEffect(()=>{if(O)return document.addEventListener("mousemove",Xt),document.addEventListener("mouseup",ot),()=>{document.removeEventListener("mousemove",Xt),document.removeEventListener("mouseup",ot)}},[O,H,ie]);const St=()=>{if(Q.length!==1){lt.error("Wybierz dokładnie jedną pozycję do edycji");return}const se=t.find(Ne=>Ne.id===Q[0]);se&&(oe(se),fe(!0))},Qt=se=>{r(Ne=>Ne.map(X=>X.id===se.id?se:X)),M([])},Et=Nt.length>0&&Nt.every(se=>Q.includes(se.id)),zt=se=>{if(!se)return"-";let Ne;if(typeof se=="string")Ne=new Date(se);else if(typeof se=="number")se<1e12?Ne=new Date(se*1e3):Ne=new Date(se);else return"-";return isNaN(Ne.getTime())?"-":Ne.toLocaleDateString("pl-PL")},Tt=Q.length>0?t.filter(se=>Q.includes(se.id)):[];return f?d.jsx("div",{className:"flex justify-center items-center py-8",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p?d.jsxs("div",{className:"text-center py-8",children:[d.jsx("p",{className:"text-red-600 font-sora",children:p}),d.jsx("button",{onClick:de,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[d.jsxs("div",{className:"relative w-full max-w-xs",children:[d.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),d.jsx("input",{type:"text",value:A,onChange:se=>T(se.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),d.jsx("button",{onClick:St,disabled:Q.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:d.jsx(Gu,{size:16})})]}),d.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[d.jsxs("div",{className:"flex flex-wrap gap-4",children:[d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykułów"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:Tt.length})]}),d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Łączna ilość towaru"}),d.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:Tt.length>0?Tt.reduce((se,Ne)=>se+(Ne.ilosc||0),0):0})]}),d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru fakturowa"}),d.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[Tt.length>0?Tt.reduce((se,Ne)=>se+(ae[Ne.kod]||0),0).toFixed(2):"0.00"," €"]})]}),d.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[d.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Wartość towaru w sprzedaży"}),d.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[Tt.length>0?Tt.reduce((se,Ne)=>{const X=Ne.cena_sprzedazy||0,me=Ne.ilosc||0;return se+X*me},0).toFixed(2):"0.00"," zł"]})]})]}),d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[d.jsx("div",{className:"relative",children:d.jsxs("select",{value:te.sprzedawca,onChange:se=>K(Ne=>({...Ne,sprzedawca:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Sprzedawca"}),it.map(se=>d.jsx("option",{value:se,children:se},se))]})}),d.jsx("div",{className:"relative",children:d.jsxs("select",{value:te.typ,onChange:se=>K(Ne=>({...Ne,typ:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Typ"}),gt.map(se=>d.jsx("option",{value:se,children:bd.find(Ne=>Ne.value===se)?.label||se},se))]})}),d.jsx("div",{className:"relative",children:d.jsxs("select",{value:te.objetosc,onChange:se=>K(Ne=>({...Ne,objetosc:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Objętość"}),ht.map(se=>d.jsxs("option",{value:se,children:[se," l"]},se))]})}),d.jsx("div",{className:"relative",children:d.jsxs("select",{value:te.status,onChange:se=>K(Ne=>({...Ne,status:se.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-gray-900",children:[d.jsx("option",{value:"",children:"Status"}),Dt.map(se=>d.jsx("option",{value:se,children:se},se))]})})]}),(te.sprzedawca||te.typ||te.objetosc||te.status)&&d.jsx("button",{onClick:()=>K({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczyść filtry"})]})]}),d.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:d.jsx("div",{className:"w-full overflow-x-auto overflow-y-scroll max-h-[500px] relative",style:{zIndex:1},children:d.jsxs("table",{className:"w-full resizable-table",ref:L,children:[d.jsx("thead",{className:"sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:d.jsx("input",{type:"checkbox",checked:Et,onChange:se=>Kt(se.target.checked)})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("kod"),style:{width:"100px"},children:"Kod"}),d.jsxs("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 relative",onClick:()=>{ge||De("nazwa")},style:{width:`${S.nazwa}px`},children:["Nazwa",d.jsx("div",{className:`absolute top-0 right-0 h-full cursor-col-resize hover:bg-blue-500 transition-opacity z-10 ${O==="nazwa"?"bg-blue-500 opacity-100":"opacity-0 hover:opacity-100"}`,style:{width:"2px"},onMouseDown:se=>{se.preventDefault(),se.stopPropagation(),Lt(se,"nazwa")}})]}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("sprzedawca"),style:{width:"120px"},children:"Sprzedawca"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("ilosc"),children:"Ilość"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("typ"),children:"Typ"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("objetosc"),children:"Objętość"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("cena"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Cena",d.jsx("br",{}),"fakturowa"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("koszt_wlasny"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Koszt",d.jsx("br",{}),"własny"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("cena_sprzedazy"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Cena w",d.jsx("br",{}),"sprzedaży"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("dataWaznosci"),style:{width:"90px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Data",d.jsx("br",{}),"ważności"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("sprzedaze"),children:"Sprzedaże"}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("srednieZuzycie"),style:{width:"100px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Średnie",d.jsx("br",{}),"zużycie/dzień"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("dniPozostalo"),style:{width:"80px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Dni",d.jsx("br",{}),"pozostało"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>De("dataWyczerpania"),style:{width:"110px"},children:d.jsxs("div",{className:"whitespace-normal",children:["Data wyczerpania",d.jsx("br",{}),"zapasów"]})}),d.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>De("status"),children:"Status"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Nt.map(se=>{const Ne=Te.get(se.kod)||0;return Ne<=0||Math.floor(se.ilosc/Ne),d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:d.jsx("input",{type:"checkbox",checked:Q.includes(se.id),onChange:X=>cr(se.id,X.target.checked)})}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:"100px"},children:d.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:se.kod})}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:`${S.nazwa}px`},children:d.jsx("div",{className:"break-words leading-tight max-h-12 overflow-hidden",children:se.nazwa})}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",style:{width:"120px"},children:se.sprzedawca||Ve.get(se.kod)||""}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`ilosc-tooltip-${se.kod}`,children:[se.ilosc,d.jsx(pu,{id:`ilosc-tooltip-${se.kod}`,place:"top",className:"max-w-md",children:d.jsxs("div",{className:"font-sora",children:[d.jsx("span",{children:"samples "}),d.jsxs("span",{className:"text-gray-500",children:["(",le[se.kod]||0," szt)"]})]})})]}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:se.typ?d.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Le(se.typ)}`,children:bd.find(X=>X.value===se.typ)?.label||se.typ}):"-"}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:se.objetosc?`${se.objetosc} l`:"-"}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${se.kod}`,onMouseEnter:()=>{he[se.kod]||st()},children:[se.cena!=null?`${se.cena.toFixed(2)} €`:"-",d.jsx(pu,{id:`price-tooltip-${se.kod}`,className:"max-w-md",place:"top",children:d.jsxs("div",{className:"font-sora",children:[d.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),he[se.kod]&&he[se.kod].length>0?he[se.kod].map((X,me)=>d.jsxs("div",{className:"mb-1",children:[d.jsx("span",{className:"font-medium",children:X.cena!=null?`${X.cena.toFixed(2)} €`:"N/A"}),d.jsxs("span",{className:"text-gray-500 ml-2",children:["(",X.ilosc_aktualna," szt.)"]})]},me)):d.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`koszt-tooltip-${se.kod}`,children:[se.koszt_wlasny!=null?`${se.koszt_wlasny.toFixed(2)} zł`:"-",d.jsx(pu,{id:`koszt-tooltip-${se.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:d.jsxs("div",{className:"font-sora",children:[d.jsxs("div",{className:"mb-1",children:[d.jsx("span",{className:"font-medium",children:"Transport:"}),d.jsx("span",{className:"text-gray-500 ml-2",children:se.koszt_dostawy_per_unit!=null?`${se.koszt_dostawy_per_unit.toFixed(2)} zł`:"0,00 zł"})]}),d.jsxs("div",{className:"mb-1",children:[d.jsx("span",{className:"font-medium",children:"Akcyza:"}),d.jsx("span",{className:"text-gray-500 ml-2",children:se.podatek_akcyzowy!=null?`${se.podatek_akcyzowy.toFixed(2)} zł`:"0,00 zł"})]})]})})]}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:se.cena_sprzedazy!=null?`${se.cena_sprzedazy.toFixed(2)} zł`:"-"}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:zt(se.data_waznosci)}),d.jsx("td",{className:"px-8 py-4 text-center text-xs text-gray-600 font-sora leading-tight align-middle whitespace-nowrap",children:(()=>{const X=a.filter(He=>He.kod===se.kod);console.log(`Sales for ${se.kod}:`,X.length);const me={};X.forEach(He=>{const Ze=l.find(Qe=>Qe.id===He.orderId),yt=Ze?Ze.klient:"";let at="";Ze&&Ze.numer_zamowienia&&(at=Mv(Ze.numer_zamowienia)),!at&&Ze&&(at=new Date(Ze.data_utworzenia).toLocaleDateString("pl-PL")),!at&&He.created_at&&(at=new Date(He.created_at).toLocaleDateString("pl-PL")),me[He.orderId]||(me[He.orderId]={qty:0,klient:yt,date:at}),me[He.orderId].qty+=He.ilosc});const Se=Object.entries(me).sort(([,He],[,Ze])=>{const yt=new Date(He.date.split(".").reverse().join("-"));return new Date(Ze.date.split(".").reverse().join("-")).getTime()-yt.getTime()});if(console.log(`Sales array for ${se.kod}:`,Se.length),Se.length===0)return d.jsx("div",{className:"text-gray-400",children:"-"});const ze=Se.slice(0,3);return d.jsx("div",{className:"flex items-center justify-center",children:d.jsxs("div",{className:"relative cursor-pointer",children:[d.jsx(v2,{size:16,className:"text-blue-300 hover:text-blue-400 transition-colors focus:outline-none","data-tooltip-id":`sales-tooltip-${se.kod}`,onClick:He=>{He.stopPropagation(),w(se.kod),y(!0)},tabIndex:0,onMouseDown:He=>He.preventDefault()}),d.jsx(pu,{id:`sales-tooltip-${se.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!1,children:d.jsx("div",{className:"font-sora",children:ze.map(([He,Ze])=>d.jsx("div",{className:"mb-1",children:Ze.date&&Ze.klient?d.jsxs("div",{children:[Ze.date.split(".").slice(0,2).join(".")," | ",Ze.klient,": ",d.jsx("span",{className:"text-gray-500",children:Ze.qty})]}):d.jsxs("div",{className:"text-gray-500",children:["Ilość: ",Ze.qty]})},He))})})]})})})()}),d.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(Te.get(se.kod)||0).toFixed(2),"/dzień"]}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const X=Te.get(se.kod)||0,me=X<=0?1/0:Math.floor(se.ilosc/X);return me===1/0?"∞":me})()}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(se.ilosc===0){const ze=Ge(se.kod);return ze?ze.toLocaleDateString("pl-PL"):"-"}const X=Te.get(se.kod)||0,me=X<=0?1/0:Math.floor(se.ilosc/X);if(me===1/0)return"-";const Se=new Date;return Se.setDate(Se.getDate()+me),Se.toLocaleDateString("pl-PL")})()}),d.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(se.ilosc===0)return d.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border bg-gray-100 text-gray-600 border-gray-300",children:"brak"});const X=Te.get(se.kod)||0,me=X<=0?1/0:Math.floor(se.ilosc/X),Se=me===1/0?"Brak danych":me<=30?"mało":me<=60?"średnie":"dużo";return d.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Ae(me)}`,children:Se})})()})]},se.id)})})]})})}),d.jsx(JR,{isOpen:B,onClose:()=>{fe(!1),oe(null)},item:ue,onSave:Qt}),(()=>{let se=0;if(k){const at=new Set;a.forEach(Qe=>{Qe.kod===k&&at.add(Qe.orderId)}),se=l.filter(Qe=>at.has(Qe.id)).length}const Ne=40,X=48,me=40,Se=40,ze=7,He=ze*Se,Ze=se===0?150:Ne+X+me+Math.max(se,ze)*Se+20,yt=Math.min(Math.max(Ze,Ne+X+me+He+20),window.innerHeight*.9);return d.jsx(Fr,{isOpen:g,onRequestClose:()=>{y(!1),w(null)},style:{content:{width:"400px",height:`${yt}px`,maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},contentLabel:"Zamówienia",children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-start mb-8 select-none",children:[d.jsx("h2",{className:"text-xs font-semibold text-gray-800 pr-4 break-words leading-tight",children:k?t.find(at=>at.kod===k)?.nazwa||k:""}),d.jsx("button",{onClick:()=>{y(!1),w(null),E("")},className:"text-red-500 focus:outline-none flex-shrink-0",children:d.jsx(Yt,{size:20})})]}),d.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:k&&(()=>{const at=new Set;a.forEach(wt=>{wt.kod===k&&at.add(wt.orderId)});let Qe=l.filter(wt=>at.has(wt.id));_.trim()&&(Qe=Qe.filter(wt=>wt.klient===_));const dt=Qe.map(wt=>{const wr=a.filter(et=>et.orderId===wt.id&&et.kod===k).reduce((et,pt)=>et+pt.ilosc,0);let Ye="";return wt.numer_zamowienia&&(Ye=Mv(wt.numer_zamowienia)),!Ye&&wt.data_utworzenia&&(Ye=new Date(wt.data_utworzenia).toLocaleDateString("pl-PL")),{...wt,date:Ye,totalQty:wr}}).sort((wt,wr)=>{if(wt.date&&wr.date){const Ye=new Date(wt.date.split(".").reverse().join("-"));return new Date(wr.date.split(".").reverse().join("-")).getTime()-Ye.getTime()}return 0});return dt.length===0?d.jsx("p",{className:"text-xs text-gray-500",children:"Brak zamówień dla tego towaru"}):d.jsx("div",{children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-purple-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Zamówienia"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Klient"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilość"}),d.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-0"})]})}),d.jsx("tbody",{className:"bg-white",children:dt.map(wt=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium",children:wt.numer_zamowienia||"-"}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:d.jsx("div",{className:"break-words leading-tight",children:wt.klient||"-"})}),d.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:wt.totalQty}),d.jsx("td",{})]},wt.id))})]})})})()}),k&&(()=>{const at=new Set;a.forEach(We=>{We.kod===k&&at.add(We.orderId)});const Qe=l.filter(We=>at.has(We.id)).map(We=>We.klient).filter((We,dt,wt)=>We&&wt.indexOf(We)===dt).sort();return d.jsx("div",{className:"mt-6 pt-4",children:d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("select",{value:_,onChange:We=>E(We.target.value),className:"block w-1/2 px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-0 focus:border-gray-300 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[d.jsx("option",{value:"",children:"Klient"}),Qe.map(We=>d.jsx("option",{value:We,style:{fontFamily:"Sora, sans-serif"},children:We},We))]})})})})()]})})})()]})};xi("pl",gi);const rM=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=D.useState(new Date),[o,l]=D.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=D.useState([]),[h,p]=D.useState(new Set),[x,g]=D.useState(!1),[y,k]=D.useState(""),[w,_]=D.useState(""),[E,A]=D.useState(!1),[T,j]=D.useState(null);D.useEffect(()=>{const te=setTimeout(async()=>{if(y.trim().length<2||E){f([]);return}g(!0);try{const K=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(y)}`);if(!K.ok)throw new Error("Failed to fetch orders");const B=await K.json();if(B&&B.length>0){const fe=B.map(ue=>({id:ue.id,nazwa:`Zamówienie: ${ue.numer_zamowienia}`,kod:ue.klient,klient:ue.klient,numer_zamowienia:ue.numer_zamowienia,products:ue.products||[]}));f(fe)}else f([])}catch(K){console.error("Error searching orders:",K),f([])}finally{g(!1)}},300);return()=>clearTimeout(te)},[y,E]);const ee=(M,te)=>{if(M.numer_zamowienia){if(_(M.klient),j(M.id),M.products&&M.products.length>0){const K=M.products.map(B=>({nazwa:B.nazwa,ilosc:B.ilosc,original_ilosc:B.ilosc,powod_zwrotu:""}));l(K)}f([]),k(M.numer_zamowienia),A(!0),lt.success("Zamówienie wybrane")}else{const K=[...o];K[te]={...K[te],nazwa:M.nazwa,ilosc:0,original_ilosc:0},l(K)}},R=()=>{const M=new Set;return o.forEach((te,K)=>{const B=te.original_ilosc,fe=o[K].ilosc;!te.nazwa.trim()||!fe||fe<=0||!te.powod_zwrotu?M.add(K):fe>B&&(M.add(K),lt.error(`Ilość zwrotu (${fe}) nie może przekraczać ilości w zamówieniu (${B})`))}),p(M),M.size===0},C=async()=>{if(!R()){lt.error("Proszę wypełnić wszystkie wymagane pola");return}try{const M={klient:w,data_zwrotu:r,products:o,orderId:T},te=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!te.ok){const B=await te.json();throw new Error(B.error||"Failed to create return")}const K=await te.json();console.log("Return created:",K),t(M),lt.success(`Zwrot został utworzony: ${K.numer_zwrotu}`),n(),k(""),_(""),A(!1),j(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),p(new Set)}catch(M){console.error("Error creating return:",M),lt.error("Błąd podczas tworzenia zwrotu")}},Q=()=>{n(),k(""),_(""),A(!1),j(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),p(new Set)};return d.jsx(Fr,{isOpen:e,onRequestClose:Q,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:d.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[d.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),d.jsx("button",{onClick:Q,className:"text-red-500 focus:outline-none",children:d.jsx(Yt,{size:20})})]}),d.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex flex-wrap gap-4",children:[d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),d.jsx(As,{selected:r,onChange:M=>a(M||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz datę",popperClassName:"z-50"})]}),d.jsxs("div",{className:"w-[200px]",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamówienia"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",value:y,onChange:M=>{k(M.target.value),A(!1),j(null)},placeholder:"Wprowadź numer zamówienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),x&&d.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&y.trim().length>=2&&d.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(M=>d.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>ee(M,-1),children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"text-[10px]",children:M.nazwa}),d.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",M.klient]})]})},M.id))})]})]})]})}),w&&d.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),d.jsx("p",{className:"text-xs text-gray-900",children:w})]})}),d.jsx("button",{onClick:()=>_(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:d.jsx(Yt,{size:16})})]})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((M,te)=>d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"flex",children:[d.jsx("div",{className:"relative flex-1 max-w-[50%]",children:d.jsx("input",{type:"text",value:M.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),d.jsx("div",{className:"w-20 ml-2",children:d.jsx("input",{type:"number",min:"1",max:M.original_ilosc,value:o[te].ilosc||"",onChange:K=>{const B=[...o],fe=K.target.value===""?0:parseInt(K.target.value)||0;B[te]={...B[te],ilosc:fe},l(B)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilość"})}),d.jsx("div",{className:"w-40 ml-2",children:d.jsxs("select",{value:o[te].powod_zwrotu,onChange:K=>{const B=[...o];B[te]={...B[te],powod_zwrotu:K.target.value},l(B)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[d.jsx("option",{value:"",children:"Powód zwrotu"}),d.jsx("option",{value:"Błąd w zamówieniu",children:"Błąd w zamówieniu"}),d.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),d.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&d.jsx("button",{onClick:()=>{const K=o.filter((B,fe)=>fe!==te);l(K)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usuń pozycję",children:d.jsx(Yt,{size:16})})]})},te))]})]}),d.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:d.jsx("button",{onClick:C,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwórz zwrot"})}),d.jsx("div",{className:"absolute bottom-4 right-4",children:d.jsx("button",{onClick:Q,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})},nM=e=>(e(!0),!0);Fr.setAppElement("#root");const rr="";console.log("API_URL configured as:",rr);function aM(){const[e,n]=D.useState(!1),[t,r]=D.useState(!1),[a,o]=D.useState(!1),[l,c]=D.useState(!1),[f,h]=D.useState(!1),[p,x]=D.useState(null),[g,y]=D.useState(null),[k,w]=D.useState(null),[_,E]=D.useState(null),[A,T]=D.useState(!0),[j,ee]=D.useState(["inventory","clients","orders","inventoryStatus"]),[R,C]=D.useState(()=>{const X=localStorage.getItem("activeTab")||"inventory",me=localStorage.getItem("activeSubTab")||"przyjecie";return{sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:X,activeSubTab:me,isDbInitialized:!1}}),[Q,M]=D.useState(!1),[te,K]=D.useState(!1),[B,fe]=D.useState(!1),[ue,oe]=D.useState(!1),[he,V]=D.useState(null),[le,J]=D.useState(!1),[ae,W]=D.useState(null),[S,P]=D.useState(!1),[O,z]=D.useState(null),[H,re]=D.useState(0),[ie,Z]=D.useState(0),[ge,xe]=D.useState(null),[L,Ve]=D.useState("");D.useEffect(()=>{(async()=>{try{T(!0),console.log("🚀 Starting data loading process..."),console.log("🔧 API_URL:",rr),console.log("👥 Loading clients...");const me=await Qt();console.log("✅ Clients loaded:",me.length),console.log("📦 Loading products...");const Se=await Et();console.log("✅ Products loaded:",Se.length),console.log("🧾 Loading product receipts...");const ze=await zt();console.log("✅ Product receipts loaded:",ze.length),console.log("🔄 Updating app state with loaded data..."),console.log("📋 Setting clients:",me),C(He=>{const Ze={...He,clients:me,products:Se,productReceipts:ze};return console.log("🔄 New app state:",Ze),Ze}),console.log("✅ App state updated successfully"),console.log("📊 Final data counts:"),console.log("   - Clients:",me.length),console.log("   - Products:",Se.length),console.log("   - Product Receipts:",ze.length)}catch(me){console.error("❌ Error loading data:",me),lt.error("Błąd podczas ładowania danych")}finally{T(!1),console.log("🏁 Data loading process completed")}})()},[]),D.useEffect(()=>{if(!R.isDbInitialized)return;console.log("💾 useEffect triggered - clients changed:",R.clients.length),(async()=>{const me={sheets:R.sheets,sheetsData:R.sheetsData,activeSheet:R.activeSheet,showTable:R.showTable,clients:R.clients,products:R.products,productReceipts:R.productReceipts};try{localStorage.setItem("appState",JSON.stringify(me)),console.log("App state saved to localStorage")}catch(Se){console.error("Error saving state to localStorage:",Se)}})()},[R.sheetsData,R.sheets,R.activeSheet,R.showTable,R.clients,R.products,R.productReceipts]);const Te=async()=>{try{T(!0),console.log("🔍 Loading sheets from database..."),console.log("📡 Making request to:",`${rr}/api/original-sheets`);const X=await fetch(`${rr}/api/original-sheets`);if(console.log("📡 Sheets response status:",X.status),!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const me=await X.json();console.log("✅ Received sheets from server:",me),console.log("📊 Sheets count:",me.length);const Se=me.map(ze=>({fileName:ze.fileName,data:{headers:ze.data.headers,rows:ze.data.rows}}));console.log("🔄 Processed sheets:",Se),console.log("📊 Processed sheets count:",Se.length),C(ze=>({...ze,sheets:Se,sheetsData:Se,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log("✅ App state updated with sheets data")}catch(X){console.error("❌ Ошибка загрузки файлов из базы:",X),lt.error("Ошибка загрузки файлов из базы")}finally{T(!1),console.log("🏁 Loading sheets completed")}};D.useEffect(()=>{Te()},[]);const st=async(X,me)=>{console.log("handleExcelUpload called with:",{newFileName:X,fileData:me});try{const Se=await fetch(`${rr}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:X,data:me})});if(!Se.ok){if(Se.status===409){lt.error("Może być tylko jeden plik Excel. Usuń istniejący plik przed załadowaniem nowego.");return}throw new Error(`HTTP error! status: ${Se.status}`)}await Te(),n(!1)}catch(Se){console.error("Error saving file data:",Se),lt.error("Błąd podczas zapisywania danych pliku")}},Ge=(X,me)=>{const Se=`${rr}/api/download_file/${encodeURIComponent(X.fileName)}`;window.open(Se,"_blank")},de=X=>{w(X)},De=X=>{X.preventDefault()},Le=X=>{!k||k===X||(ee(me=>{const Se=[...me],ze=Se.indexOf(k),He=Se.indexOf(X);return Se.splice(ze,1),Se.splice(He,0,k),Se}),w(null))},Ae=X=>{if(X==="inventory"||X==="clients"||X==="orders"||X==="inventoryStatus"){const me=X==="inventory"?"przyjecie":null;localStorage.setItem("activeTab",X),me&&localStorage.setItem("activeSubTab",me),C(Se=>({...Se,activeTab:X,activeSubTab:me}))}},it=X=>{localStorage.setItem("activeSubTab",X),C(me=>({...me,activeSubTab:X}))},gt=X=>{switch(X){case"inventory":return"Zakup towaru";case"clients":return"Klienci";case"orders":return"Zamówienia";case"inventoryStatus":return"Stany magazynowe";default:return X}},ht=()=>{g&&(c(!1),n(!1))},Dt=async X=>{try{console.log("🚀 Starting handleAddProduct..."),console.log("📋 Received data:",X),console.log("📎 Files check:",{hasProductInvoice:!!X.productInvoice,hasTransportInvoice:!!X.transportInvoice,productInvoice:X.productInvoice,transportInvoice:X.transportInvoice}),console.log("📡 Making request to:",`${rr}/api/product-receipts`);let me;if(X.productInvoice||X.transportInvoice){console.log("📎 Files detected, using FormData...");const He=new FormData,Ze={date:X.date,sprzedawca:X.sprzedawca,wartosc:X.wartosc,kosztDostawy:X.kosztDostawy,aktualnyKurs:X.aktualnyKurs,podatekAkcyzowy:X.podatekAkcyzowy,products:X.products};He.append("data",JSON.stringify(Ze)),console.log("📄 JSON data:",Ze),X.productInvoice&&(He.append("productInvoice",X.productInvoice),console.log("📎 Product invoice added:",X.productInvoice.name)),X.transportInvoice&&(He.append("transportInvoice",X.transportInvoice),console.log("📎 Transport invoice added:",X.transportInvoice.name)),console.log("📦 FormData entries:");for(let[yt,at]of He.entries())console.log(`  ${yt}:`,at);me=await fetch(`${rr}/api/product-receipts`,{method:"POST",body:He})}else{console.log("📄 No files, using JSON...");const He={date:X.date,sprzedawca:X.sprzedawca,wartosc:X.wartosc,kosztDostawy:X.kosztDostawy,aktualnyKurs:X.aktualnyKurs,podatekAkcyzowy:X.podatekAkcyzowy,products:X.products};console.log("📄 JSON data:",He),me=await fetch(`${rr}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(He)})}if(console.log("📡 Response status:",me.status),console.log("📡 Response headers:",me.headers),!me.ok){const He=await me.text();throw console.error("❌ Response error text:",He),new Error(`Failed to save product receipt: ${me.status} - ${He}`)}const Se=await me.json();if(console.log("✅ Saved receipt:",Se),Se.workingSheetsUpdated||Se.workingSheetsInserted){let He="Dodano nowy towar";Se.workingSheetsUpdated>0&&(He+=` (${Se.workingSheetsUpdated} товаров обновлено в working sheets)`),Se.workingSheetsInserted>0&&(He+=` (${Se.workingSheetsInserted} новых товаров добавлено в working sheets)`),lt.success(He)}else lt.success("Dodano nowy towar");console.log("🔄 Loading updated receipts...");const ze=await zt();console.log("✅ Updated receipts:",ze),console.log("🔄 Updating app state..."),C(He=>{const Ze={...He,productReceipts:ze};return console.log("✅ New app state:",Ze),Ze}),o(!1)}catch(me){console.error("❌ Error adding product:",me),lt.error("Wystąpił błąd podczas dodawania towaru")}},Nt=X=>{W(X),J(!0)},Kt=async X=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",X),console.log("📎 Files check (update):",{hasProductInvoice:!!X.productInvoice,hasTransportInvoice:!!X.transportInvoice,productInvoice:X.productInvoice,transportInvoice:X.transportInvoice});try{let me;if(X.productInvoice||X.transportInvoice){console.log("📎 Files detected (update), using FormData...");const Ze=new FormData,yt={date:X.date,sprzedawca:X.sprzedawca,wartosc:X.wartosc,kosztDostawy:X.kosztDostawy,products:X.products};Ze.append("data",JSON.stringify(yt)),console.log("📄 JSON data (update):",yt),X.productInvoice&&(Ze.append("productInvoice",X.productInvoice),console.log("📎 Product invoice added (update):",X.productInvoice.name)),X.transportInvoice&&(Ze.append("transportInvoice",X.transportInvoice),console.log("📎 Transport invoice added (update):",X.transportInvoice.name)),console.log("📦 FormData entries (update):");for(let[at,Qe]of Ze.entries())console.log(`  ${at}:`,Qe);me=await fetch(`${rr}/api/product-receipts/${X.id}`,{method:"PUT",body:Ze})}else console.log("📄 No files (update), using JSON..."),me=await fetch(`${rr}/api/product-receipts/${X.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:X.date,sprzedawca:X.sprzedawca,wartosc:X.wartosc,kosztDostawy:X.kosztDostawy,aktualnyKurs:X.aktualnyKurs,podatekAkcyzowy:X.podatekAkcyzowy,products:X.products})});if(!me.ok)throw new Error("Failed to update product receipt");const Se=await me.json();console.log("Updated receipt:",Se),console.log("Loading updated receipts...");const ze=await zt();console.log("Updated receipts:",ze),console.log("Loading updated products...");const He=await Et();console.log("Updated products:",He),console.log("Updating app state..."),C(Ze=>{const yt={...Ze,productReceipts:ze,products:He};return console.log("New app state:",yt),yt}),lt.success("Zakup został zaktualizowany"),J(!1),W(null),h(!1),x(null)}catch(me){console.error("Error updating product receipt:",me),lt.error("Wystąpił błąd podczas aktualizacji zakupu")}},cr=async X=>{try{if(!(await fetch(`${rr}/api/product-receipts/${X}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const Se=await zt(),ze=await Et();C(He=>({...He,productReceipts:Se,products:ze})),lt.success("Zakup został usunięty")}catch(me){console.error("Error deleting receipt:",me),lt.error("Wystąpił błąd podczas usuwania zakupu")}},Lt=async X=>{try{const me=await fetch(`${rr}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(!me.ok)throw new Error("Failed to add client");const Se=await me.json(),ze={...X,id:Se.id};C(He=>({...He,clients:[...He.clients,ze]})),Z(He=>He+1),lt.success("Klient został dodany")}catch(me){console.error("Error adding client:",me),lt.error("Błąd podczas dodawania klienta")}},Xt=async X=>{try{if(!(await fetch(`${rr}/api/clients/${X}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");C(Se=>({...Se,clients:Se.clients.filter(ze=>ze.id!==X)})),Z(Se=>Se+1),lt.success("Klient został usunięty")}catch(me){console.error("Error deleting client:",me),lt.error("Błąd podczas usuwania klienta")}},ot=async X=>{try{console.log("🔍 handleUpdateClient called with data:",X);const me=await fetch(`${rr}/api/clients/${X.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(!me.ok)throw new Error("Failed to update client");const Se=await me.json();console.log("✅ Client updated in database:",Se),console.log("✅ Updated client fields:",{id:Se.id,firma:Se.firma,nazwa:Se.nazwa,adres:Se.adres,czas_dostawy:Se.czas_dostawy,kontakt:Se.kontakt}),C(ze=>{console.log("🔄 Updating app state..."),console.log("📋 Previous clients:",ze.clients),console.log("📋 Updated client data:",Se);const He=ze.clients.map(yt=>yt.id===X.id?(console.log("🔄 Updating client:",yt.id,"from:",yt,"to:",{...yt,...Se}),{id:yt.id,firma:Se.firma||yt.firma,nazwa:Se.nazwa||yt.nazwa,adres:Se.adres||yt.adres,czas_dostawy:Se.czas_dostawy||yt.czas_dostawy,kontakt:Se.kontakt||yt.kontakt}):{...yt});console.log("📋 New clients array:",He);const Ze={...ze,clients:He};return console.log("🔄 New app state:",Ze),Ze}),lt.success("Klient został zaktualizowany"),setTimeout(()=>{C(ze=>(console.log("🔄 Force update after timeout"),{...ze})),Z(ze=>ze+1),xe(X.id),Qt().then(ze=>{C(He=>({...He,clients:ze})),Z(He=>He+1)})},100)}catch(me){console.error("Error updating client:",me),lt.error("Błąd podczas aktualizacji klienta")}},St=async X=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",X),console.log("Products data:",JSON.stringify(X.products,null,2));try{const me=await fetch(`${rr}/api/orders/${X.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(!me.ok)throw new Error("Failed to update order");const Se=await me.json();console.log("Updated order result:",Se),lt.success("Zamówienie zostało zaktualizowane"),re(ze=>ze+1)}catch(me){console.error("Error updating order:",me),lt.error("Błąd podczas aktualizacji zamówienia")}},Qt=async()=>{try{console.log("🔍 Loading clients from:",`${rr}/api/clients`);const X=await fetch(`${rr}/api/clients`);if(console.log("📡 Clients response status:",X.status),!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const me=await X.json();return console.log("✅ Loaded clients:",me.length,"records"),console.log("📋 First client:",me[0]),me}catch(X){return console.error("❌ Error loading clients:",X),[]}},Et=async()=>{try{console.log("🔍 Loading products from:",`${rr}/api/products`);const X=await fetch(`${rr}/api/products`);if(console.log("📡 Products response status:",X.status),!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const me=await X.json();console.log("✅ Loaded products:",me.length,"records"),console.log("📋 First product:",me[0]);const Se=me.map(ze=>({kod:ze.kod,nazwa:ze.nazwa,ilosc:ze.ilosc,jednostka_miary:ze.jednostka_miary||"",kod_kreskowy:ze.kod_kreskowy||"",data_waznosci:ze.data_waznosci??void 0,archiwalny:ze.archiwalny,rezerwacje:ze.rezerwacje,ilosc_na_poleceniach:ze.ilosc_na_poleceniach,waga_netto:ze.waga_netto,waga_brutto:ze.waga_brutto,objetosc:ze.objetosc,opis:ze.opis}));return console.log("🔄 Processed products:",Se.length,"records"),Se}catch(X){return console.error("❌ Error loading products:",X),[]}},zt=async()=>{try{console.log("🔍 Loading product receipts from:",`${rr}/api/product-receipts`);const X=await fetch(`${rr}/api/product-receipts`);if(console.log("📡 Product receipts response status:",X.status),!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const me=await X.json();return console.log("✅ Loaded product receipts:",me.length,"records"),me.map(Se=>({id:Se.id,dataPrzyjecia:Se.dataPrzyjecia,sprzedawca:Se.sprzedawca||"",wartosc:Se.wartosc||0,kosztDostawy:Se.kosztDostawy||0,aktualny_kurs:Se.aktualny_kurs,podatek_akcyzowy:Se.podatek_akcyzowy,aktualnyKurs:Se.aktualnyKurs,podatekAkcyzowy:Se.podatekAkcyzowy,products:Se.products||[],productInvoice:Se.productInvoice,transportInvoice:Se.transportInvoice}))}catch(X){return console.error("❌ Error loading product receipts:",X),[]}},Tt=async X=>{try{console.log("🔍 Searching working_sheets with query:",X),console.log("📡 Making request to:",`${rr}/api/working-sheets/search?query=${encodeURIComponent(X)}`);const me=await fetch(`${rr}/api/working-sheets/search?query=${encodeURIComponent(X)}`);if(console.log("📡 Search response status:",me.status),!me.ok)throw new Error(`HTTP error! status: ${me.status}`);const Se=await me.json();return console.log("✅ Search results:",Se.length,"items found"),Se.map(He=>({kod:He.kod,nazwa:He.nazwa,ilosc:He.ilosc.toString(),kodKreskowy:He.kod_kreskowy||""}))}catch(me){return console.error("❌ Error searching working_sheets:",me),[]}},se=()=>{re(X=>X+1)},Ne=()=>{re(X=>X+1)};return d.jsxs("div",{className:"min-h-screen bg-gray-100",children:[d.jsx(AR,{position:"top-right"}),d.jsx(xw,{isOpen:ue,onClose:()=>oe(!1),product:he}),d.jsx(I4,{isOpen:e,onClose:()=>n(!1),onUpload:st}),d.jsx(j4,{isOpen:l,onClose:()=>c(!1),fileName:g||"",onConfirm:ht}),d.jsx(zP,{isOpen:a,onClose:()=>o(!1),onSubmit:Dt}),d.jsx(jR,{isOpen:t,onClose:()=>r(!1),onAdd:Lt}),d.jsx(yw,{isOpen:S,onClose:()=>{P(!1),z(null)},onSubmit:ot,client:O}),d.jsx(gw,{isOpen:f,onClose:()=>h(!1),receipt:p}),d.jsx(vw,{isOpen:le,onClose:()=>{J(!1),W(null)},onSubmit:Kt,receipt:ae}),d.jsx(OR,{isOpen:Q,onClose:()=>M(!1),onOrderCreated:se}),d.jsx(rM,{isOpen:te,onClose:()=>K(!1),onSubmit:Ne}),d.jsx("div",{className:"bg-white shadow-sm",children:d.jsx("div",{className:"container mx-auto px-4 py-3",children:d.jsx("img",{src:IR,alt:"Enoterra Logo",className:"h-32"})})}),d.jsx("div",{className:"bg-gray-100",children:d.jsx("div",{className:"container mx-auto px-4",children:d.jsx("div",{className:"flex items-center h-14",children:d.jsx("div",{className:"flex space-x-4",children:j.map(X=>d.jsx("div",{draggable:!0,onDragStart:()=>de(X),onDragOver:De,onDrop:()=>Le(X),className:`relative -mb-px cursor-pointer ${R.activeTab===X?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${k===X?"opacity-50":""}`,onClick:()=>Ae(X),children:d.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:gt(X)})},X))})})})}),d.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:d.jsxs("div",{className:"container mx-auto px-4 py-6",children:[d.jsxs("div",{className:"flex items-start -mt-2",children:[R.activeTab==="inventory"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[d.jsxs("div",{className:"flex",children:[d.jsx("button",{onClick:()=>it("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${R.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjęcie towaru"}),d.jsx("button",{onClick:()=>it("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${R.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupów"}),d.jsx("button",{onClick:()=>it("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${R.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz płatności"})]}),R.activeSubTab==="przyjecie"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:d.jsx(Js,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>nM(n),children:[d.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:d.jsx(g2,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),d.jsx(LR,{receipts:R.productReceipts,products:R.products,onDelete:cr,onEdit:Nt,onUpdate:Kt})]}),R.activeSubTab==="analiza"&&d.jsx("div",{className:"flex flex-col gap-4",children:d.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[d.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupów"}),d.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupów będzie dostępna wkrótce."})]})}),R.activeSubTab==="kalendarz"&&d.jsx("div",{className:"flex flex-col gap-4 mt-6",children:d.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[d.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz płatności"}),d.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza płatności będzie dostępna wkrótce."})]})})]}),R.activeTab==="inventory"&&d.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:R.sheets.map(X=>d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("button",{onClick:me=>Ge(X),title:"Клик: открыть файл в новой вкладке",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:X.fileName})},X.fileName))}),R.activeTab==="inventory"&&R.showTable&&R.activeSheet&&d.jsx("div",{className:"mt-6 bg-white",children:d.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:d.jsx(BP,{data:R.activeSheet.data})})}),R.activeTab==="clients"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[d.jsx("div",{className:"flex items-center gap-4",children:d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:d.jsx(Js,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),d.jsx(BR,{clients:R.clients,onDelete:Xt,onEdit:X=>{z(X),P(!0)},onUpdate:ot},`clients-${ie}-${ge||"none"}`)]}),R.activeTab==="orders"&&d.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[d.jsx("div",{className:"mb-4",children:d.jsx("div",{className:"w-1/2 mx-auto",children:d.jsx(WP,{onSearch:Tt})})}),d.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>M(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:d.jsx(Js,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),d.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>K(!0),children:[d.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:d.jsx(Yt,{size:16})}),d.jsx("div",{className:"px-2",children:d.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]})]}),d.jsx(MR,{onViewOrder:X=>{console.log("View order:",X)},onEditOrder:X=>{console.log("Edit order:",X)},onDeleteOrder:X=>{console.log("Delete order:",X)},onUpdateOrder:St,refreshTrigger:H})]}),R.activeTab==="inventoryStatus"&&d.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:d.jsx(tM,{productReceipts:R.productReceipts})})]}),_&&d.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:_})]})})]})}h2.createRoot(document.getElementById("root")).render(d.jsx(D.StrictMode,{children:d.jsx(aM,{})}));
