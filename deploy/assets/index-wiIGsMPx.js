function ob(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Qu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ib(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function r(){var a=!1;try{a=this instanceof r}catch{}return a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var a=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return e[r]}})}),t}var U0={exports:{}},el={},$0={exports:{}},Dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hm;function lb(){if(hm)return Dt;hm=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function g(R){return R===null||typeof R!="object"?null:(R=m&&R[m]||R["@@iterator"],typeof R=="function"?R:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function k(R,S,G){this.props=R,this.context=S,this.refs=b,this.updater=G||v}k.prototype.isReactComponent={},k.prototype.setState=function(R,S){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,S,"setState")},k.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function T(){}T.prototype=k.prototype;function j(R,S,G){this.props=R,this.context=S,this.refs=b,this.updater=G||v}var C=j.prototype=new T;C.constructor=j,w(C,k.prototype),C.isPureReactComponent=!0;var W=Array.isArray,J=Object.prototype.hasOwnProperty,V={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function U(R,S,G){var D,E={},F=null,A=null;if(S!=null)for(D in S.ref!==void 0&&(A=S.ref),S.key!==void 0&&(F=""+S.key),S)J.call(S,D)&&!P.hasOwnProperty(D)&&(E[D]=S[D]);var q=arguments.length-2;if(q===1)E.children=G;else if(1<q){for(var H=Array(q),L=0;L<q;L++)H[L]=arguments[L+2];E.children=H}if(R&&R.defaultProps)for(D in q=R.defaultProps,q)E[D]===void 0&&(E[D]=q[D]);return{$$typeof:e,type:R,key:F,ref:A,props:E,_owner:V.current}}function B(R,S){return{$$typeof:e,type:R.type,key:S,ref:R.ref,props:R.props,_owner:R._owner}}function ne(R){return typeof R=="object"&&R!==null&&R.$$typeof===e}function ee(R){var S={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(G){return S[G]})}var Y=/\/+/g;function fe(R,S){return typeof R=="object"&&R!==null&&R.key!=null?ee(""+R.key):S.toString(36)}function de(R,S,G,D,E){var F=typeof R;(F==="undefined"||F==="boolean")&&(R=null);var A=!1;if(R===null)A=!0;else switch(F){case"string":case"number":A=!0;break;case"object":switch(R.$$typeof){case e:case n:A=!0}}if(A)return A=R,E=E(A),R=D===""?"."+fe(A,0):D,W(E)?(G="",R!=null&&(G=R.replace(Y,"$&/")+"/"),de(E,S,G,"",function(L){return L})):E!=null&&(ne(E)&&(E=B(E,G+(!E.key||A&&A.key===E.key?"":(""+E.key).replace(Y,"$&/")+"/")+R)),S.push(E)),1;if(A=0,D=D===""?".":D+":",W(R))for(var q=0;q<R.length;q++){F=R[q];var H=D+fe(F,q);A+=de(F,S,G,H,E)}else if(H=g(R),typeof H=="function")for(R=H.call(R),q=0;!(F=R.next()).done;)F=F.value,H=D+fe(F,q++),A+=de(F,S,G,H,E);else if(F==="object")throw S=String(R),Error("Objects are not valid as a React child (found: "+(S==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":S)+"). If you meant to render a collection of children, use an array instead.");return A}function oe(R,S,G){if(R==null)return R;var D=[],E=0;return de(R,D,"","",function(F){return S.call(G,F,E++)}),D}function he(R){if(R._status===-1){var S=R._result;S=S(),S.then(function(G){(R._status===0||R._status===-1)&&(R._status=1,R._result=G)},function(G){(R._status===0||R._status===-1)&&(R._status=2,R._result=G)}),R._status===-1&&(R._status=0,R._result=S)}if(R._status===1)return R._result.default;throw R._result}var X={current:null},le={transition:null},z={ReactCurrentDispatcher:X,ReactCurrentBatchConfig:le,ReactCurrentOwner:V};function se(){throw Error("act(...) is not supported in production builds of React.")}return Dt.Children={map:oe,forEach:function(R,S,G){oe(R,function(){S.apply(this,arguments)},G)},count:function(R){var S=0;return oe(R,function(){S++}),S},toArray:function(R){return oe(R,function(S){return S})||[]},only:function(R){if(!ne(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Dt.Component=k,Dt.Fragment=t,Dt.Profiler=a,Dt.PureComponent=j,Dt.StrictMode=r,Dt.Suspense=f,Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,Dt.act=se,Dt.cloneElement=function(R,S,G){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var D=w({},R.props),E=R.key,F=R.ref,A=R._owner;if(S!=null){if(S.ref!==void 0&&(F=S.ref,A=V.current),S.key!==void 0&&(E=""+S.key),R.type&&R.type.defaultProps)var q=R.type.defaultProps;for(H in S)J.call(S,H)&&!P.hasOwnProperty(H)&&(D[H]=S[H]===void 0&&q!==void 0?q[H]:S[H])}var H=arguments.length-2;if(H===1)D.children=G;else if(1<H){q=Array(H);for(var L=0;L<H;L++)q[L]=arguments[L+2];D.children=q}return{$$typeof:e,type:R.type,key:E,ref:F,props:D,_owner:A}},Dt.createContext=function(R){return R={$$typeof:l,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:o,_context:R},R.Consumer=R},Dt.createElement=U,Dt.createFactory=function(R){var S=U.bind(null,R);return S.type=R,S},Dt.createRef=function(){return{current:null}},Dt.forwardRef=function(R){return{$$typeof:c,render:R}},Dt.isValidElement=ne,Dt.lazy=function(R){return{$$typeof:p,_payload:{_status:-1,_result:R},_init:he}},Dt.memo=function(R,S){return{$$typeof:h,type:R,compare:S===void 0?null:S}},Dt.startTransition=function(R){var S=le.transition;le.transition={};try{R()}finally{le.transition=S}},Dt.unstable_act=se,Dt.useCallback=function(R,S){return X.current.useCallback(R,S)},Dt.useContext=function(R){return X.current.useContext(R)},Dt.useDebugValue=function(){},Dt.useDeferredValue=function(R){return X.current.useDeferredValue(R)},Dt.useEffect=function(R,S){return X.current.useEffect(R,S)},Dt.useId=function(){return X.current.useId()},Dt.useImperativeHandle=function(R,S,G){return X.current.useImperativeHandle(R,S,G)},Dt.useInsertionEffect=function(R,S){return X.current.useInsertionEffect(R,S)},Dt.useLayoutEffect=function(R,S){return X.current.useLayoutEffect(R,S)},Dt.useMemo=function(R,S){return X.current.useMemo(R,S)},Dt.useReducer=function(R,S,G){return X.current.useReducer(R,S,G)},Dt.useRef=function(R){return X.current.useRef(R)},Dt.useState=function(R){return X.current.useState(R)},Dt.useSyncExternalStore=function(R,S,G){return X.current.useSyncExternalStore(R,S,G)},Dt.useTransition=function(){return X.current.useTransition()},Dt.version="18.3.1",Dt}var xm;function jl(){return xm||(xm=1,$0.exports=lb()),$0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm;function cb(){if(mm)return el;mm=1;var e=jl(),n=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,f,h){var p,m={},g=null,v=null;h!==void 0&&(g=""+h),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(v=f.ref);for(p in f)r.call(f,p)&&!o.hasOwnProperty(p)&&(m[p]=f[p]);if(c&&c.defaultProps)for(p in f=c.defaultProps,f)m[p]===void 0&&(m[p]=f[p]);return{$$typeof:n,type:c,key:g,ref:v,props:m,_owner:a.current}}return el.Fragment=t,el.jsx=l,el.jsxs=l,el}var gm;function ub(){return gm||(gm=1,U0.exports=cb()),U0.exports}var u=ub(),N=jl();const Te=Qu(N),Mv=ob({__proto__:null,default:Te},[N]);var Gc={},H0={exports:{}},vn={},Y0={exports:{}},V0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vm;function db(){return vm||(vm=1,(function(e){function n(le,z){var se=le.length;le.push(z);e:for(;0<se;){var R=se-1>>>1,S=le[R];if(0<a(S,z))le[R]=z,le[se]=S,se=R;else break e}}function t(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var z=le[0],se=le.pop();if(se!==z){le[0]=se;e:for(var R=0,S=le.length,G=S>>>1;R<G;){var D=2*(R+1)-1,E=le[D],F=D+1,A=le[F];if(0>a(E,se))F<S&&0>a(A,E)?(le[R]=A,le[F]=se,R=F):(le[R]=E,le[D]=se,R=D);else if(F<S&&0>a(A,se))le[R]=A,le[F]=se,R=F;else break e}}return z}function a(le,z){var se=le.sortIndex-z.sortIndex;return se!==0?se:le.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],h=[],p=1,m=null,g=3,v=!1,w=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(le){for(var z=t(h);z!==null;){if(z.callback===null)r(h);else if(z.startTime<=le)r(h),z.sortIndex=z.expirationTime,n(f,z);else break;z=t(h)}}function W(le){if(b=!1,C(le),!w)if(t(f)!==null)w=!0,he(J);else{var z=t(h);z!==null&&X(W,z.startTime-le)}}function J(le,z){w=!1,b&&(b=!1,T(U),U=-1),v=!0;var se=g;try{for(C(z),m=t(f);m!==null&&(!(m.expirationTime>z)||le&&!ee());){var R=m.callback;if(typeof R=="function"){m.callback=null,g=m.priorityLevel;var S=R(m.expirationTime<=z);z=e.unstable_now(),typeof S=="function"?m.callback=S:m===t(f)&&r(f),C(z)}else r(f);m=t(f)}if(m!==null)var G=!0;else{var D=t(h);D!==null&&X(W,D.startTime-z),G=!1}return G}finally{m=null,g=se,v=!1}}var V=!1,P=null,U=-1,B=5,ne=-1;function ee(){return!(e.unstable_now()-ne<B)}function Y(){if(P!==null){var le=e.unstable_now();ne=le;var z=!0;try{z=P(!0,le)}finally{z?fe():(V=!1,P=null)}}else V=!1}var fe;if(typeof j=="function")fe=function(){j(Y)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,oe=de.port2;de.port1.onmessage=Y,fe=function(){oe.postMessage(null)}}else fe=function(){k(Y,0)};function he(le){P=le,V||(V=!0,fe())}function X(le,z){U=k(function(){le(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(le){le.callback=null},e.unstable_continueExecution=function(){w||v||(w=!0,he(J))},e.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<le?Math.floor(1e3/le):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return t(f)},e.unstable_next=function(le){switch(g){case 1:case 2:case 3:var z=3;break;default:z=g}var se=g;g=z;try{return le()}finally{g=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(le,z){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var se=g;g=le;try{return z()}finally{g=se}},e.unstable_scheduleCallback=function(le,z,se){var R=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?R+se:R):se=R,le){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=se+S,le={id:p++,callback:z,priorityLevel:le,startTime:se,expirationTime:S,sortIndex:-1},se>R?(le.sortIndex=se,n(h,le),t(f)===null&&le===t(h)&&(b?(T(U),U=-1):b=!0,X(W,se-R))):(le.sortIndex=S,n(f,le),w||v||(w=!0,he(J))),le},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(le){var z=g;return function(){var se=g;g=z;try{return le.apply(this,arguments)}finally{g=se}}}})(V0)),V0}var ym;function fb(){return ym||(ym=1,Y0.exports=db()),Y0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wm;function pb(){if(wm)return vn;wm=1;var e=jl(),n=fb();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,d=1;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function g(s){return f.call(m,s)?!0:f.call(p,s)?!1:h.test(s)?m[s]=!0:(p[s]=!0,!1)}function v(s,i,d,x){if(d!==null&&d.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return x?!1:d!==null?!d.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function w(s,i,d,x){if(i===null||typeof i>"u"||v(s,i,d,x))return!0;if(x)return!1;if(d!==null)switch(d.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function b(s,i,d,x,y,_,M){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=x,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=s,this.type=i,this.sanitizeURL=_,this.removeEmptyString=M}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){k[s]=new b(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];k[i]=new b(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){k[s]=new b(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){k[s]=new b(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){k[s]=new b(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){k[s]=new b(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){k[s]=new b(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){k[s]=new b(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){k[s]=new b(s,5,!1,s.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function j(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(T,j);k[i]=new b(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(T,j);k[i]=new b(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(T,j);k[i]=new b(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){k[s]=new b(s,1,!1,s.toLowerCase(),null,!1,!1)}),k.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){k[s]=new b(s,1,!1,s.toLowerCase(),null,!0,!0)});function C(s,i,d,x){var y=k.hasOwnProperty(i)?k[i]:null;(y!==null?y.type!==0:x||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(w(i,d,y,x)&&(d=null),x||y===null?g(i)&&(d===null?s.removeAttribute(i):s.setAttribute(i,""+d)):y.mustUseProperty?s[y.propertyName]=d===null?y.type===3?!1:"":d:(i=y.attributeName,x=y.attributeNamespace,d===null?s.removeAttribute(i):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,x?s.setAttributeNS(x,i,d):s.setAttribute(i,d))))}var W=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,J=Symbol.for("react.element"),V=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),ee=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),le=Symbol.iterator;function z(s){return s===null||typeof s!="object"?null:(s=le&&s[le]||s["@@iterator"],typeof s=="function"?s:null)}var se=Object.assign,R;function S(s){if(R===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);R=i&&i[1]||""}return`
`+R+s}var G=!1;function D(s,i){if(!s||G)return"";G=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Ce){var x=Ce}Reflect.construct(s,[],i)}else{try{i.call()}catch(Ce){x=Ce}s.call(i.prototype)}else{try{throw Error()}catch(Ce){x=Ce}s()}}catch(Ce){if(Ce&&x&&typeof Ce.stack=="string"){for(var y=Ce.stack.split(`
`),_=x.stack.split(`
`),M=y.length-1,ie=_.length-1;1<=M&&0<=ie&&y[M]!==_[ie];)ie--;for(;1<=M&&0<=ie;M--,ie--)if(y[M]!==_[ie]){if(M!==1||ie!==1)do if(M--,ie--,0>ie||y[M]!==_[ie]){var xe=`
`+y[M].replace(" at new "," at ");return s.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",s.displayName)),xe}while(1<=M&&0<=ie);break}}}finally{G=!1,Error.prepareStackTrace=d}return(s=s?s.displayName||s.name:"")?S(s):""}function E(s){switch(s.tag){case 5:return S(s.type);case 16:return S("Lazy");case 13:return S("Suspense");case 19:return S("SuspenseList");case 0:case 2:case 15:return s=D(s.type,!1),s;case 11:return s=D(s.type.render,!1),s;case 1:return s=D(s.type,!0),s;default:return""}}function F(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case P:return"Fragment";case V:return"Portal";case B:return"Profiler";case U:return"StrictMode";case fe:return"Suspense";case de:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case ee:return(s.displayName||"Context")+".Consumer";case ne:return(s._context.displayName||"Context")+".Provider";case Y:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case oe:return i=s.displayName||null,i!==null?i:F(s.type)||"Memo";case he:i=s._payload,s=s._init;try{return F(s(i))}catch{}}return null}function A(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(i);case 8:return i===U?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function q(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function H(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function L(s){var i=H(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),x=""+s[i];if(!s.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,_=d.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return y.call(this)},set:function(M){x=""+M,_.call(this,M)}}),Object.defineProperty(s,i,{enumerable:d.enumerable}),{getValue:function(){return x},setValue:function(M){x=""+M},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function ue(s){s._valueTracker||(s._valueTracker=L(s))}function I(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var d=i.getValue(),x="";return s&&(x=H(s)?s.checked?"true":"false":s.value),s=x,s!==d?(i.setValue(s),!0):!1}function Oe(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ae(s,i){var d=i.checked;return se({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??s._wrapperState.initialChecked})}function Xe(s,i){var d=i.defaultValue==null?"":i.defaultValue,x=i.checked!=null?i.checked:i.defaultChecked;d=q(i.value!=null?i.value:d),s._wrapperState={initialChecked:x,initialValue:d,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function qe(s,i){i=i.checked,i!=null&&C(s,"checked",i,!1)}function pe(s,i){qe(s,i);var d=q(i.value),x=i.type;if(d!=null)x==="number"?(d===0&&s.value===""||s.value!=d)&&(s.value=""+d):s.value!==""+d&&(s.value=""+d);else if(x==="submit"||x==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?je(s,i.type,d):i.hasOwnProperty("defaultValue")&&je(s,i.type,q(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Ne(s,i,d){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var x=i.type;if(!(x!=="submit"&&x!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,d||i===s.value||(s.value=i),s.defaultValue=i}d=s.name,d!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,d!==""&&(s.name=d)}function je(s,i,d){(i!=="number"||Oe(s.ownerDocument)!==s)&&(d==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+d&&(s.defaultValue=""+d))}var _e=Array.isArray;function Qe(s,i,d,x){if(s=s.options,i){i={};for(var y=0;y<d.length;y++)i["$"+d[y]]=!0;for(d=0;d<s.length;d++)y=i.hasOwnProperty("$"+s[d].value),s[d].selected!==y&&(s[d].selected=y),y&&x&&(s[d].defaultSelected=!0)}else{for(d=""+q(d),i=null,y=0;y<s.length;y++){if(s[y].value===d){s[y].selected=!0,x&&(s[y].defaultSelected=!0);return}i!==null||s[y].disabled||(i=s[y])}i!==null&&(i.selected=!0)}}function ft(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return se({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function ht(s,i){var d=i.value;if(d==null){if(d=i.children,i=i.defaultValue,d!=null){if(i!=null)throw Error(t(92));if(_e(d)){if(1<d.length)throw Error(t(93));d=d[0]}i=d}i==null&&(i=""),d=i}s._wrapperState={initialValue:q(d)}}function vt(s,i){var d=q(i.value),x=q(i.defaultValue);d!=null&&(d=""+d,d!==s.value&&(s.value=d),i.defaultValue==null&&s.defaultValue!==d&&(s.defaultValue=d)),x!=null&&(s.defaultValue=""+x)}function jt(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Gt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sr(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Gt(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Rt,Ht=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,d,x,y){MSApp.execUnsafeLocalFunction(function(){return s(i,d,x,y)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Rt=Rt||document.createElement("div"),Rt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Rt.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function pt(s,i){if(i){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=i;return}}s.textContent=i}var Nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yt=["Webkit","ms","Moz","O"];Object.keys(Nt).forEach(function(s){Yt.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),Nt[i]=Nt[s]})});function Ft(s,i,d){return i==null||typeof i=="boolean"||i===""?"":d||typeof i!="number"||i===0||Nt.hasOwnProperty(s)&&Nt[s]?(""+i).trim():i+"px"}function Bt(s,i){s=s.style;for(var d in i)if(i.hasOwnProperty(d)){var x=d.indexOf("--")===0,y=Ft(d,i[d],x);d==="float"&&(d="cssFloat"),x?s.setProperty(d,y):s[d]=y}}var ve=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ze(s,i){if(i){if(ve[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function kt(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ce=null;function Pe(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ze=null,et=null,at=null;function ae(s){if(s=Li(s)){if(typeof ze!="function")throw Error(t(280));var i=s.stateNode;i&&(i=cc(i),ze(s.stateNode,s.type,i))}}function ge(s){et?at?at.push(s):at=[s]:et=s}function De(){if(et){var s=et,i=at;if(at=et=null,ae(s),i)for(s=0;s<i.length;s++)ae(i[s])}}function Re(s,i){return s(i)}function $e(){}var rt=!1;function yt(s,i,d){if(rt)return s(i,d);rt=!0;try{return Re(s,i,d)}finally{rt=!1,(et!==null||at!==null)&&($e(),De())}}function Ut(s,i){var d=s.stateNode;if(d===null)return null;var x=cc(d);if(x===null)return null;d=x[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(t(231,i,typeof d));return d}var Ke=!1;if(c)try{var tt={};Object.defineProperty(tt,"passive",{get:function(){Ke=!0}}),window.addEventListener("test",tt,tt),window.removeEventListener("test",tt,tt)}catch{Ke=!1}function Me(s,i,d,x,y,_,M,ie,xe){var Ce=Array.prototype.slice.call(arguments,3);try{i.apply(d,Ce)}catch(Le){this.onError(Le)}}var nt=!1,_t=null,O=!1,te=null,K={onError:function(s){nt=!0,_t=s}};function Q(s,i,d,x,y,_,M,ie,xe){nt=!1,_t=null,Me.apply(K,arguments)}function Z(s,i,d,x,y,_,M,ie,xe){if(Q.apply(this,arguments),nt){if(nt){var Ce=_t;nt=!1,_t=null}else throw Error(t(198));O||(O=!0,te=Ce)}}function re(s){var i=s,d=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(d=i.return),s=i.return;while(s)}return i.tag===3?d:null}function ke(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Fe(s){if(re(s)!==s)throw Error(t(188))}function we(s){var i=s.alternate;if(!i){if(i=re(s),i===null)throw Error(t(188));return i!==s?null:s}for(var d=s,x=i;;){var y=d.return;if(y===null)break;var _=y.alternate;if(_===null){if(x=y.return,x!==null){d=x;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===d)return Fe(y),s;if(_===x)return Fe(y),i;_=_.sibling}throw Error(t(188))}if(d.return!==x.return)d=y,x=_;else{for(var M=!1,ie=y.child;ie;){if(ie===d){M=!0,d=y,x=_;break}if(ie===x){M=!0,x=y,d=_;break}ie=ie.sibling}if(!M){for(ie=_.child;ie;){if(ie===d){M=!0,d=_,x=y;break}if(ie===x){M=!0,x=_,d=y;break}ie=ie.sibling}if(!M)throw Error(t(189))}}if(d.alternate!==x)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?s:i}function Se(s){return s=we(s),s!==null?Ee(s):null}function Ee(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=Ee(s);if(i!==null)return i;s=s.sibling}return null}var Be=n.unstable_scheduleCallback,Je=n.unstable_cancelCallback,We=n.unstable_shouldYield,Ue=n.unstable_requestPaint,Ye=n.unstable_now,gt=n.unstable_getCurrentPriorityLevel,Qt=n.unstable_ImmediatePriority,Vt=n.unstable_UserBlockingPriority,mr=n.unstable_NormalPriority,Ls=n.unstable_LowPriority,rs=n.unstable_IdlePriority,da=null,jr=null;function wi(s){if(jr&&typeof jr.onCommitFiberRoot=="function")try{jr.onCommitFiberRoot(da,s,void 0,(s.current.flags&128)===128)}catch{}}var gr=Math.clz32?Math.clz32:Sw,bw=Math.log,_w=Math.LN2;function Sw(s){return s>>>=0,s===0?32:31-(bw(s)/_w|0)|0}var Yl=64,Vl=4194304;function ki(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Kl(s,i){var d=s.pendingLanes;if(d===0)return 0;var x=0,y=s.suspendedLanes,_=s.pingedLanes,M=d&268435455;if(M!==0){var ie=M&~y;ie!==0?x=ki(ie):(_&=M,_!==0&&(x=ki(_)))}else M=d&~y,M!==0?x=ki(M):_!==0&&(x=ki(_));if(x===0)return 0;if(i!==0&&i!==x&&(i&y)===0&&(y=x&-x,_=i&-i,y>=_||y===16&&(_&4194240)!==0))return i;if((x&4)!==0&&(x|=d&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=x;0<i;)d=31-gr(i),y=1<<d,x|=s[d],i&=~y;return x}function Ew(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nw(s,i){for(var d=s.suspendedLanes,x=s.pingedLanes,y=s.expirationTimes,_=s.pendingLanes;0<_;){var M=31-gr(_),ie=1<<M,xe=y[M];xe===-1?((ie&d)===0||(ie&x)!==0)&&(y[M]=Ew(ie,i)):xe<=i&&(s.expiredLanes|=ie),_&=~ie}}function cd(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Yp(){var s=Yl;return Yl<<=1,(Yl&4194240)===0&&(Yl=64),s}function ud(s){for(var i=[],d=0;31>d;d++)i.push(s);return i}function bi(s,i,d){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-gr(i),s[i]=d}function Cw(s,i){var d=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var x=s.eventTimes;for(s=s.expirationTimes;0<d;){var y=31-gr(d),_=1<<y;i[y]=0,x[y]=-1,s[y]=-1,d&=~_}}function dd(s,i){var d=s.entangledLanes|=i;for(s=s.entanglements;d;){var x=31-gr(d),y=1<<x;y&i|s[x]&i&&(s[x]|=i),d&=~y}}var Xt=0;function Vp(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Kp,fd,Gp,Qp,Xp,pd=!1,Gl=[],ns=null,as=null,ss=null,_i=new Map,Si=new Map,os=[],Tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qp(s,i){switch(s){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":ss=null;break;case"pointerover":case"pointerout":_i.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Si.delete(i.pointerId)}}function Ei(s,i,d,x,y,_){return s===null||s.nativeEvent!==_?(s={blockedOn:i,domEventName:d,eventSystemFlags:x,nativeEvent:_,targetContainers:[y]},i!==null&&(i=Li(i),i!==null&&fd(i)),s):(s.eventSystemFlags|=x,i=s.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),s)}function Dw(s,i,d,x,y){switch(i){case"focusin":return ns=Ei(ns,s,i,d,x,y),!0;case"dragenter":return as=Ei(as,s,i,d,x,y),!0;case"mouseover":return ss=Ei(ss,s,i,d,x,y),!0;case"pointerover":var _=y.pointerId;return _i.set(_,Ei(_i.get(_)||null,s,i,d,x,y)),!0;case"gotpointercapture":return _=y.pointerId,Si.set(_,Ei(Si.get(_)||null,s,i,d,x,y)),!0}return!1}function Zp(s){var i=Bs(s.target);if(i!==null){var d=re(i);if(d!==null){if(i=d.tag,i===13){if(i=ke(d),i!==null){s.blockedOn=i,Xp(s.priority,function(){Gp(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ql(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var d=xd(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(d===null){d=s.nativeEvent;var x=new d.constructor(d.type,d);ce=x,d.target.dispatchEvent(x),ce=null}else return i=Li(d),i!==null&&fd(i),s.blockedOn=d,!1;i.shift()}return!0}function Jp(s,i,d){Ql(s)&&d.delete(i)}function Fw(){pd=!1,ns!==null&&Ql(ns)&&(ns=null),as!==null&&Ql(as)&&(as=null),ss!==null&&Ql(ss)&&(ss=null),_i.forEach(Jp),Si.forEach(Jp)}function Ni(s,i){s.blockedOn===i&&(s.blockedOn=null,pd||(pd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Fw)))}function Ci(s){function i(y){return Ni(y,s)}if(0<Gl.length){Ni(Gl[0],s);for(var d=1;d<Gl.length;d++){var x=Gl[d];x.blockedOn===s&&(x.blockedOn=null)}}for(ns!==null&&Ni(ns,s),as!==null&&Ni(as,s),ss!==null&&Ni(ss,s),_i.forEach(i),Si.forEach(i),d=0;d<os.length;d++)x=os[d],x.blockedOn===s&&(x.blockedOn=null);for(;0<os.length&&(d=os[0],d.blockedOn===null);)Zp(d),d.blockedOn===null&&os.shift()}var No=W.ReactCurrentBatchConfig,Xl=!0;function jw(s,i,d,x){var y=Xt,_=No.transition;No.transition=null;try{Xt=1,hd(s,i,d,x)}finally{Xt=y,No.transition=_}}function Pw(s,i,d,x){var y=Xt,_=No.transition;No.transition=null;try{Xt=4,hd(s,i,d,x)}finally{Xt=y,No.transition=_}}function hd(s,i,d,x){if(Xl){var y=xd(s,i,d,x);if(y===null)Pd(s,i,x,ql,d),qp(s,x);else if(Dw(y,s,i,d,x))x.stopPropagation();else if(qp(s,x),i&4&&-1<Tw.indexOf(s)){for(;y!==null;){var _=Li(y);if(_!==null&&Kp(_),_=xd(s,i,d,x),_===null&&Pd(s,i,x,ql,d),_===y)break;y=_}y!==null&&x.stopPropagation()}else Pd(s,i,x,null,d)}}var ql=null;function xd(s,i,d,x){if(ql=null,s=Pe(x),s=Bs(s),s!==null)if(i=re(s),i===null)s=null;else if(d=i.tag,d===13){if(s=ke(i),s!==null)return s;s=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return ql=s,null}function eh(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gt()){case Qt:return 1;case Vt:return 4;case mr:case Ls:return 16;case rs:return 536870912;default:return 16}default:return 16}}var is=null,md=null,Zl=null;function th(){if(Zl)return Zl;var s,i=md,d=i.length,x,y="value"in is?is.value:is.textContent,_=y.length;for(s=0;s<d&&i[s]===y[s];s++);var M=d-s;for(x=1;x<=M&&i[d-x]===y[_-x];x++);return Zl=y.slice(s,1<x?1-x:void 0)}function Jl(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ec(){return!0}function rh(){return!1}function kn(s){function i(d,x,y,_,M){this._reactName=d,this._targetInst=y,this.type=x,this.nativeEvent=_,this.target=M,this.currentTarget=null;for(var ie in s)s.hasOwnProperty(ie)&&(d=s[ie],this[ie]=d?d(_):_[ie]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ec:rh,this.isPropagationStopped=rh,this}return se(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=ec)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=ec)},persist:function(){},isPersistent:ec}),i}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gd=kn(Co),Ti=se({},Co,{view:0,detail:0}),Aw=kn(Ti),vd,yd,Di,tc=se({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Di&&(Di&&s.type==="mousemove"?(vd=s.screenX-Di.screenX,yd=s.screenY-Di.screenY):yd=vd=0,Di=s),vd)},movementY:function(s){return"movementY"in s?s.movementY:yd}}),nh=kn(tc),Ow=se({},tc,{dataTransfer:0}),Rw=kn(Ow),zw=se({},Ti,{relatedTarget:0}),wd=kn(zw),Mw=se({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),Iw=kn(Mw),Lw=se({},Co,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Bw=kn(Lw),Ww=se({},Co,{data:0}),ah=kn(Ww),Uw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$w={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yw(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Hw[s])?!!i[s]:!1}function kd(){return Yw}var Vw=se({},Ti,{key:function(s){if(s.key){var i=Uw[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Jl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?$w[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kd,charCode:function(s){return s.type==="keypress"?Jl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Jl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Kw=kn(Vw),Gw=se({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sh=kn(Gw),Qw=se({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kd}),Xw=kn(Qw),qw=se({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zw=kn(qw),Jw=se({},tc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ek=kn(Jw),tk=[9,13,27,32],bd=c&&"CompositionEvent"in window,Fi=null;c&&"documentMode"in document&&(Fi=document.documentMode);var rk=c&&"TextEvent"in window&&!Fi,oh=c&&(!bd||Fi&&8<Fi&&11>=Fi),ih=" ",lh=!1;function ch(s,i){switch(s){case"keyup":return tk.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uh(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var To=!1;function nk(s,i){switch(s){case"compositionend":return uh(i);case"keypress":return i.which!==32?null:(lh=!0,ih);case"textInput":return s=i.data,s===ih&&lh?null:s;default:return null}}function ak(s,i){if(To)return s==="compositionend"||!bd&&ch(s,i)?(s=th(),Zl=md=is=null,To=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return oh&&i.locale!=="ko"?null:i.data;default:return null}}var sk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!sk[s.type]:i==="textarea"}function fh(s,i,d,x){ge(x),i=oc(i,"onChange"),0<i.length&&(d=new gd("onChange","change",null,d,x),s.push({event:d,listeners:i}))}var ji=null,Pi=null;function ok(s){Fh(s,0)}function rc(s){var i=Ao(s);if(I(i))return s}function ik(s,i){if(s==="change")return i}var ph=!1;if(c){var _d;if(c){var Sd="oninput"in document;if(!Sd){var hh=document.createElement("div");hh.setAttribute("oninput","return;"),Sd=typeof hh.oninput=="function"}_d=Sd}else _d=!1;ph=_d&&(!document.documentMode||9<document.documentMode)}function xh(){ji&&(ji.detachEvent("onpropertychange",mh),Pi=ji=null)}function mh(s){if(s.propertyName==="value"&&rc(Pi)){var i=[];fh(i,Pi,s,Pe(s)),yt(ok,i)}}function lk(s,i,d){s==="focusin"?(xh(),ji=i,Pi=d,ji.attachEvent("onpropertychange",mh)):s==="focusout"&&xh()}function ck(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return rc(Pi)}function uk(s,i){if(s==="click")return rc(i)}function dk(s,i){if(s==="input"||s==="change")return rc(i)}function fk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Qn=typeof Object.is=="function"?Object.is:fk;function Ai(s,i){if(Qn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var d=Object.keys(s),x=Object.keys(i);if(d.length!==x.length)return!1;for(x=0;x<d.length;x++){var y=d[x];if(!f.call(i,y)||!Qn(s[y],i[y]))return!1}return!0}function gh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function vh(s,i){var d=gh(s);s=0;for(var x;d;){if(d.nodeType===3){if(x=s+d.textContent.length,s<=i&&x>=i)return{node:d,offset:i-s};s=x}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=gh(d)}}function yh(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?yh(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function wh(){for(var s=window,i=Oe();i instanceof s.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)s=i.contentWindow;else break;i=Oe(s.document)}return i}function Ed(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function pk(s){var i=wh(),d=s.focusedElem,x=s.selectionRange;if(i!==d&&d&&d.ownerDocument&&yh(d.ownerDocument.documentElement,d)){if(x!==null&&Ed(d)){if(i=x.start,s=x.end,s===void 0&&(s=i),"selectionStart"in d)d.selectionStart=i,d.selectionEnd=Math.min(s,d.value.length);else if(s=(i=d.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var y=d.textContent.length,_=Math.min(x.start,y);x=x.end===void 0?_:Math.min(x.end,y),!s.extend&&_>x&&(y=x,x=_,_=y),y=vh(d,_);var M=vh(d,x);y&&M&&(s.rangeCount!==1||s.anchorNode!==y.node||s.anchorOffset!==y.offset||s.focusNode!==M.node||s.focusOffset!==M.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),s.removeAllRanges(),_>x?(s.addRange(i),s.extend(M.node,M.offset)):(i.setEnd(M.node,M.offset),s.addRange(i)))}}for(i=[],s=d;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<i.length;d++)s=i[d],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var hk=c&&"documentMode"in document&&11>=document.documentMode,Do=null,Nd=null,Oi=null,Cd=!1;function kh(s,i,d){var x=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Cd||Do==null||Do!==Oe(x)||(x=Do,"selectionStart"in x&&Ed(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Oi&&Ai(Oi,x)||(Oi=x,x=oc(Nd,"onSelect"),0<x.length&&(i=new gd("onSelect","select",null,i,d),s.push({event:i,listeners:x}),i.target=Do)))}function nc(s,i){var d={};return d[s.toLowerCase()]=i.toLowerCase(),d["Webkit"+s]="webkit"+i,d["Moz"+s]="moz"+i,d}var Fo={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Td={},bh={};c&&(bh=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function ac(s){if(Td[s])return Td[s];if(!Fo[s])return s;var i=Fo[s],d;for(d in i)if(i.hasOwnProperty(d)&&d in bh)return Td[s]=i[d];return s}var _h=ac("animationend"),Sh=ac("animationiteration"),Eh=ac("animationstart"),Nh=ac("transitionend"),Ch=new Map,Th="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ls(s,i){Ch.set(s,i),o(i,[s])}for(var Dd=0;Dd<Th.length;Dd++){var Fd=Th[Dd],xk=Fd.toLowerCase(),mk=Fd[0].toUpperCase()+Fd.slice(1);ls(xk,"on"+mk)}ls(_h,"onAnimationEnd"),ls(Sh,"onAnimationIteration"),ls(Eh,"onAnimationStart"),ls("dblclick","onDoubleClick"),ls("focusin","onFocus"),ls("focusout","onBlur"),ls(Nh,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function Dh(s,i,d){var x=s.type||"unknown-event";s.currentTarget=d,Z(x,i,void 0,s),s.currentTarget=null}function Fh(s,i){i=(i&4)!==0;for(var d=0;d<s.length;d++){var x=s[d],y=x.event;x=x.listeners;e:{var _=void 0;if(i)for(var M=x.length-1;0<=M;M--){var ie=x[M],xe=ie.instance,Ce=ie.currentTarget;if(ie=ie.listener,xe!==_&&y.isPropagationStopped())break e;Dh(y,ie,Ce),_=xe}else for(M=0;M<x.length;M++){if(ie=x[M],xe=ie.instance,Ce=ie.currentTarget,ie=ie.listener,xe!==_&&y.isPropagationStopped())break e;Dh(y,ie,Ce),_=xe}}}if(O)throw s=te,O=!1,te=null,s}function rr(s,i){var d=i[Id];d===void 0&&(d=i[Id]=new Set);var x=s+"__bubble";d.has(x)||(jh(i,s,2,!1),d.add(x))}function jd(s,i,d){var x=0;i&&(x|=4),jh(d,s,x,i)}var sc="_reactListening"+Math.random().toString(36).slice(2);function zi(s){if(!s[sc]){s[sc]=!0,r.forEach(function(d){d!=="selectionchange"&&(gk.has(d)||jd(d,!1,s),jd(d,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[sc]||(i[sc]=!0,jd("selectionchange",!1,i))}}function jh(s,i,d,x){switch(eh(i)){case 1:var y=jw;break;case 4:y=Pw;break;default:y=hd}d=y.bind(null,i,d,s),y=void 0,!Ke||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),x?y!==void 0?s.addEventListener(i,d,{capture:!0,passive:y}):s.addEventListener(i,d,!0):y!==void 0?s.addEventListener(i,d,{passive:y}):s.addEventListener(i,d,!1)}function Pd(s,i,d,x,y){var _=x;if((i&1)===0&&(i&2)===0&&x!==null)e:for(;;){if(x===null)return;var M=x.tag;if(M===3||M===4){var ie=x.stateNode.containerInfo;if(ie===y||ie.nodeType===8&&ie.parentNode===y)break;if(M===4)for(M=x.return;M!==null;){var xe=M.tag;if((xe===3||xe===4)&&(xe=M.stateNode.containerInfo,xe===y||xe.nodeType===8&&xe.parentNode===y))return;M=M.return}for(;ie!==null;){if(M=Bs(ie),M===null)return;if(xe=M.tag,xe===5||xe===6){x=_=M;continue e}ie=ie.parentNode}}x=x.return}yt(function(){var Ce=_,Le=Pe(d),Ve=[];e:{var Ie=Ch.get(s);if(Ie!==void 0){var ot=gd,lt=s;switch(s){case"keypress":if(Jl(d)===0)break e;case"keydown":case"keyup":ot=Kw;break;case"focusin":lt="focus",ot=wd;break;case"focusout":lt="blur",ot=wd;break;case"beforeblur":case"afterblur":ot=wd;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=nh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=Rw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=Xw;break;case _h:case Sh:case Eh:ot=Iw;break;case Nh:ot=Zw;break;case"scroll":ot=Aw;break;case"wheel":ot=ek;break;case"copy":case"cut":case"paste":ot=Bw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=sh}var ct=(i&4)!==0,vr=!ct&&s==="scroll",ye=ct?Ie!==null?Ie+"Capture":null:Ie;ct=[];for(var me=Ce,be;me!==null;){be=me;var Ge=be.stateNode;if(be.tag===5&&Ge!==null&&(be=Ge,ye!==null&&(Ge=Ut(me,ye),Ge!=null&&ct.push(Mi(me,Ge,be)))),vr)break;me=me.return}0<ct.length&&(Ie=new ot(Ie,lt,null,d,Le),Ve.push({event:Ie,listeners:ct}))}}if((i&7)===0){e:{if(Ie=s==="mouseover"||s==="pointerover",ot=s==="mouseout"||s==="pointerout",Ie&&d!==ce&&(lt=d.relatedTarget||d.fromElement)&&(Bs(lt)||lt[Ra]))break e;if((ot||Ie)&&(Ie=Le.window===Le?Le:(Ie=Le.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,ot?(lt=d.relatedTarget||d.toElement,ot=Ce,lt=lt?Bs(lt):null,lt!==null&&(vr=re(lt),lt!==vr||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(ot=null,lt=Ce),ot!==lt)){if(ct=nh,Ge="onMouseLeave",ye="onMouseEnter",me="mouse",(s==="pointerout"||s==="pointerover")&&(ct=sh,Ge="onPointerLeave",ye="onPointerEnter",me="pointer"),vr=ot==null?Ie:Ao(ot),be=lt==null?Ie:Ao(lt),Ie=new ct(Ge,me+"leave",ot,d,Le),Ie.target=vr,Ie.relatedTarget=be,Ge=null,Bs(Le)===Ce&&(ct=new ct(ye,me+"enter",lt,d,Le),ct.target=be,ct.relatedTarget=vr,Ge=ct),vr=Ge,ot&&lt)t:{for(ct=ot,ye=lt,me=0,be=ct;be;be=jo(be))me++;for(be=0,Ge=ye;Ge;Ge=jo(Ge))be++;for(;0<me-be;)ct=jo(ct),me--;for(;0<be-me;)ye=jo(ye),be--;for(;me--;){if(ct===ye||ye!==null&&ct===ye.alternate)break t;ct=jo(ct),ye=jo(ye)}ct=null}else ct=null;ot!==null&&Ph(Ve,Ie,ot,ct,!1),lt!==null&&vr!==null&&Ph(Ve,vr,lt,ct,!0)}}e:{if(Ie=Ce?Ao(Ce):window,ot=Ie.nodeName&&Ie.nodeName.toLowerCase(),ot==="select"||ot==="input"&&Ie.type==="file")var ut=ik;else if(dh(Ie))if(ph)ut=dk;else{ut=ck;var xt=lk}else(ot=Ie.nodeName)&&ot.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(ut=uk);if(ut&&(ut=ut(s,Ce))){fh(Ve,ut,d,Le);break e}xt&&xt(s,Ie,Ce),s==="focusout"&&(xt=Ie._wrapperState)&&xt.controlled&&Ie.type==="number"&&je(Ie,"number",Ie.value)}switch(xt=Ce?Ao(Ce):window,s){case"focusin":(dh(xt)||xt.contentEditable==="true")&&(Do=xt,Nd=Ce,Oi=null);break;case"focusout":Oi=Nd=Do=null;break;case"mousedown":Cd=!0;break;case"contextmenu":case"mouseup":case"dragend":Cd=!1,kh(Ve,d,Le);break;case"selectionchange":if(hk)break;case"keydown":case"keyup":kh(Ve,d,Le)}var mt;if(bd)e:{switch(s){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else To?ch(s,d)&&(bt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(bt="onCompositionStart");bt&&(oh&&d.locale!=="ko"&&(To||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&To&&(mt=th()):(is=Le,md="value"in is?is.value:is.textContent,To=!0)),xt=oc(Ce,bt),0<xt.length&&(bt=new ah(bt,s,null,d,Le),Ve.push({event:bt,listeners:xt}),mt?bt.data=mt:(mt=uh(d),mt!==null&&(bt.data=mt)))),(mt=rk?nk(s,d):ak(s,d))&&(Ce=oc(Ce,"onBeforeInput"),0<Ce.length&&(Le=new ah("onBeforeInput","beforeinput",null,d,Le),Ve.push({event:Le,listeners:Ce}),Le.data=mt))}Fh(Ve,i)})}function Mi(s,i,d){return{instance:s,listener:i,currentTarget:d}}function oc(s,i){for(var d=i+"Capture",x=[];s!==null;){var y=s,_=y.stateNode;y.tag===5&&_!==null&&(y=_,_=Ut(s,d),_!=null&&x.unshift(Mi(s,_,y)),_=Ut(s,i),_!=null&&x.push(Mi(s,_,y))),s=s.return}return x}function jo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Ph(s,i,d,x,y){for(var _=i._reactName,M=[];d!==null&&d!==x;){var ie=d,xe=ie.alternate,Ce=ie.stateNode;if(xe!==null&&xe===x)break;ie.tag===5&&Ce!==null&&(ie=Ce,y?(xe=Ut(d,_),xe!=null&&M.unshift(Mi(d,xe,ie))):y||(xe=Ut(d,_),xe!=null&&M.push(Mi(d,xe,ie)))),d=d.return}M.length!==0&&s.push({event:i,listeners:M})}var vk=/\r\n?/g,yk=/\u0000|\uFFFD/g;function Ah(s){return(typeof s=="string"?s:""+s).replace(vk,`
`).replace(yk,"")}function ic(s,i,d){if(i=Ah(i),Ah(s)!==i&&d)throw Error(t(425))}function lc(){}var Ad=null,Od=null;function Rd(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var zd=typeof setTimeout=="function"?setTimeout:void 0,wk=typeof clearTimeout=="function"?clearTimeout:void 0,Oh=typeof Promise=="function"?Promise:void 0,kk=typeof queueMicrotask=="function"?queueMicrotask:typeof Oh<"u"?function(s){return Oh.resolve(null).then(s).catch(bk)}:zd;function bk(s){setTimeout(function(){throw s})}function Md(s,i){var d=i,x=0;do{var y=d.nextSibling;if(s.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(x===0){s.removeChild(y),Ci(i);return}x--}else d!=="$"&&d!=="$?"&&d!=="$!"||x++;d=y}while(d);Ci(i)}function cs(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Rh(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return s;i--}else d==="/$"&&i++}s=s.previousSibling}return null}var Po=Math.random().toString(36).slice(2),fa="__reactFiber$"+Po,Ii="__reactProps$"+Po,Ra="__reactContainer$"+Po,Id="__reactEvents$"+Po,_k="__reactListeners$"+Po,Sk="__reactHandles$"+Po;function Bs(s){var i=s[fa];if(i)return i;for(var d=s.parentNode;d;){if(i=d[Ra]||d[fa]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(s=Rh(s);s!==null;){if(d=s[fa])return d;s=Rh(s)}return i}s=d,d=s.parentNode}return null}function Li(s){return s=s[fa]||s[Ra],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Ao(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function cc(s){return s[Ii]||null}var Ld=[],Oo=-1;function us(s){return{current:s}}function nr(s){0>Oo||(s.current=Ld[Oo],Ld[Oo]=null,Oo--)}function Jt(s,i){Oo++,Ld[Oo]=s.current,s.current=i}var ds={},Hr=us(ds),pn=us(!1),Ws=ds;function Ro(s,i){var d=s.type.contextTypes;if(!d)return ds;var x=s.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===i)return x.__reactInternalMemoizedMaskedChildContext;var y={},_;for(_ in d)y[_]=i[_];return x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=y),y}function hn(s){return s=s.childContextTypes,s!=null}function uc(){nr(pn),nr(Hr)}function zh(s,i,d){if(Hr.current!==ds)throw Error(t(168));Jt(Hr,i),Jt(pn,d)}function Mh(s,i,d){var x=s.stateNode;if(i=i.childContextTypes,typeof x.getChildContext!="function")return d;x=x.getChildContext();for(var y in x)if(!(y in i))throw Error(t(108,A(s)||"Unknown",y));return se({},d,x)}function dc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ds,Ws=Hr.current,Jt(Hr,s),Jt(pn,pn.current),!0}function Ih(s,i,d){var x=s.stateNode;if(!x)throw Error(t(169));d?(s=Mh(s,i,Ws),x.__reactInternalMemoizedMergedChildContext=s,nr(pn),nr(Hr),Jt(Hr,s)):nr(pn),Jt(pn,d)}var za=null,fc=!1,Bd=!1;function Lh(s){za===null?za=[s]:za.push(s)}function Ek(s){fc=!0,Lh(s)}function fs(){if(!Bd&&za!==null){Bd=!0;var s=0,i=Xt;try{var d=za;for(Xt=1;s<d.length;s++){var x=d[s];do x=x(!0);while(x!==null)}za=null,fc=!1}catch(y){throw za!==null&&(za=za.slice(s+1)),Be(Qt,fs),y}finally{Xt=i,Bd=!1}}return null}var zo=[],Mo=0,pc=null,hc=0,Fn=[],jn=0,Us=null,Ma=1,Ia="";function $s(s,i){zo[Mo++]=hc,zo[Mo++]=pc,pc=s,hc=i}function Bh(s,i,d){Fn[jn++]=Ma,Fn[jn++]=Ia,Fn[jn++]=Us,Us=s;var x=Ma;s=Ia;var y=32-gr(x)-1;x&=~(1<<y),d+=1;var _=32-gr(i)+y;if(30<_){var M=y-y%5;_=(x&(1<<M)-1).toString(32),x>>=M,y-=M,Ma=1<<32-gr(i)+y|d<<y|x,Ia=_+s}else Ma=1<<_|d<<y|x,Ia=s}function Wd(s){s.return!==null&&($s(s,1),Bh(s,1,0))}function Ud(s){for(;s===pc;)pc=zo[--Mo],zo[Mo]=null,hc=zo[--Mo],zo[Mo]=null;for(;s===Us;)Us=Fn[--jn],Fn[jn]=null,Ia=Fn[--jn],Fn[jn]=null,Ma=Fn[--jn],Fn[jn]=null}var bn=null,_n=null,or=!1,Xn=null;function Wh(s,i){var d=Rn(5,null,null,0);d.elementType="DELETED",d.stateNode=i,d.return=s,i=s.deletions,i===null?(s.deletions=[d],s.flags|=16):i.push(d)}function Uh(s,i){switch(s.tag){case 5:var d=s.type;return i=i.nodeType!==1||d.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,bn=s,_n=cs(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,bn=s,_n=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(d=Us!==null?{id:Ma,overflow:Ia}:null,s.memoizedState={dehydrated:i,treeContext:d,retryLane:1073741824},d=Rn(18,null,null,0),d.stateNode=i,d.return=s,s.child=d,bn=s,_n=null,!0):!1;default:return!1}}function $d(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Hd(s){if(or){var i=_n;if(i){var d=i;if(!Uh(s,i)){if($d(s))throw Error(t(418));i=cs(d.nextSibling);var x=bn;i&&Uh(s,i)?Wh(x,d):(s.flags=s.flags&-4097|2,or=!1,bn=s)}}else{if($d(s))throw Error(t(418));s.flags=s.flags&-4097|2,or=!1,bn=s}}}function $h(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;bn=s}function xc(s){if(s!==bn)return!1;if(!or)return $h(s),or=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Rd(s.type,s.memoizedProps)),i&&(i=_n)){if($d(s))throw Hh(),Error(t(418));for(;i;)Wh(s,i),i=cs(i.nextSibling)}if($h(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"){if(i===0){_n=cs(s.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++}s=s.nextSibling}_n=null}}else _n=bn?cs(s.stateNode.nextSibling):null;return!0}function Hh(){for(var s=_n;s;)s=cs(s.nextSibling)}function Io(){_n=bn=null,or=!1}function Yd(s){Xn===null?Xn=[s]:Xn.push(s)}var Nk=W.ReactCurrentBatchConfig;function Bi(s,i,d){if(s=d.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var x=d.stateNode}if(!x)throw Error(t(147,s));var y=x,_=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===_?i.ref:(i=function(M){var ie=y.refs;M===null?delete ie[_]:ie[_]=M},i._stringRef=_,i)}if(typeof s!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,s))}return s}function mc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Yh(s){var i=s._init;return i(s._payload)}function Vh(s){function i(ye,me){if(s){var be=ye.deletions;be===null?(ye.deletions=[me],ye.flags|=16):be.push(me)}}function d(ye,me){if(!s)return null;for(;me!==null;)i(ye,me),me=me.sibling;return null}function x(ye,me){for(ye=new Map;me!==null;)me.key!==null?ye.set(me.key,me):ye.set(me.index,me),me=me.sibling;return ye}function y(ye,me){return ye=ws(ye,me),ye.index=0,ye.sibling=null,ye}function _(ye,me,be){return ye.index=be,s?(be=ye.alternate,be!==null?(be=be.index,be<me?(ye.flags|=2,me):be):(ye.flags|=2,me)):(ye.flags|=1048576,me)}function M(ye){return s&&ye.alternate===null&&(ye.flags|=2),ye}function ie(ye,me,be,Ge){return me===null||me.tag!==6?(me=z0(be,ye.mode,Ge),me.return=ye,me):(me=y(me,be),me.return=ye,me)}function xe(ye,me,be,Ge){var ut=be.type;return ut===P?Le(ye,me,be.props.children,Ge,be.key):me!==null&&(me.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===he&&Yh(ut)===me.type)?(Ge=y(me,be.props),Ge.ref=Bi(ye,me,be),Ge.return=ye,Ge):(Ge=Bc(be.type,be.key,be.props,null,ye.mode,Ge),Ge.ref=Bi(ye,me,be),Ge.return=ye,Ge)}function Ce(ye,me,be,Ge){return me===null||me.tag!==4||me.stateNode.containerInfo!==be.containerInfo||me.stateNode.implementation!==be.implementation?(me=M0(be,ye.mode,Ge),me.return=ye,me):(me=y(me,be.children||[]),me.return=ye,me)}function Le(ye,me,be,Ge,ut){return me===null||me.tag!==7?(me=qs(be,ye.mode,Ge,ut),me.return=ye,me):(me=y(me,be),me.return=ye,me)}function Ve(ye,me,be){if(typeof me=="string"&&me!==""||typeof me=="number")return me=z0(""+me,ye.mode,be),me.return=ye,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case J:return be=Bc(me.type,me.key,me.props,null,ye.mode,be),be.ref=Bi(ye,null,me),be.return=ye,be;case V:return me=M0(me,ye.mode,be),me.return=ye,me;case he:var Ge=me._init;return Ve(ye,Ge(me._payload),be)}if(_e(me)||z(me))return me=qs(me,ye.mode,be,null),me.return=ye,me;mc(ye,me)}return null}function Ie(ye,me,be,Ge){var ut=me!==null?me.key:null;if(typeof be=="string"&&be!==""||typeof be=="number")return ut!==null?null:ie(ye,me,""+be,Ge);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case J:return be.key===ut?xe(ye,me,be,Ge):null;case V:return be.key===ut?Ce(ye,me,be,Ge):null;case he:return ut=be._init,Ie(ye,me,ut(be._payload),Ge)}if(_e(be)||z(be))return ut!==null?null:Le(ye,me,be,Ge,null);mc(ye,be)}return null}function ot(ye,me,be,Ge,ut){if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number")return ye=ye.get(be)||null,ie(me,ye,""+Ge,ut);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case J:return ye=ye.get(Ge.key===null?be:Ge.key)||null,xe(me,ye,Ge,ut);case V:return ye=ye.get(Ge.key===null?be:Ge.key)||null,Ce(me,ye,Ge,ut);case he:var xt=Ge._init;return ot(ye,me,be,xt(Ge._payload),ut)}if(_e(Ge)||z(Ge))return ye=ye.get(be)||null,Le(me,ye,Ge,ut,null);mc(me,Ge)}return null}function lt(ye,me,be,Ge){for(var ut=null,xt=null,mt=me,bt=me=0,Or=null;mt!==null&&bt<be.length;bt++){mt.index>bt?(Or=mt,mt=null):Or=mt.sibling;var Wt=Ie(ye,mt,be[bt],Ge);if(Wt===null){mt===null&&(mt=Or);break}s&&mt&&Wt.alternate===null&&i(ye,mt),me=_(Wt,me,bt),xt===null?ut=Wt:xt.sibling=Wt,xt=Wt,mt=Or}if(bt===be.length)return d(ye,mt),or&&$s(ye,bt),ut;if(mt===null){for(;bt<be.length;bt++)mt=Ve(ye,be[bt],Ge),mt!==null&&(me=_(mt,me,bt),xt===null?ut=mt:xt.sibling=mt,xt=mt);return or&&$s(ye,bt),ut}for(mt=x(ye,mt);bt<be.length;bt++)Or=ot(mt,ye,bt,be[bt],Ge),Or!==null&&(s&&Or.alternate!==null&&mt.delete(Or.key===null?bt:Or.key),me=_(Or,me,bt),xt===null?ut=Or:xt.sibling=Or,xt=Or);return s&&mt.forEach(function(ks){return i(ye,ks)}),or&&$s(ye,bt),ut}function ct(ye,me,be,Ge){var ut=z(be);if(typeof ut!="function")throw Error(t(150));if(be=ut.call(be),be==null)throw Error(t(151));for(var xt=ut=null,mt=me,bt=me=0,Or=null,Wt=be.next();mt!==null&&!Wt.done;bt++,Wt=be.next()){mt.index>bt?(Or=mt,mt=null):Or=mt.sibling;var ks=Ie(ye,mt,Wt.value,Ge);if(ks===null){mt===null&&(mt=Or);break}s&&mt&&ks.alternate===null&&i(ye,mt),me=_(ks,me,bt),xt===null?ut=ks:xt.sibling=ks,xt=ks,mt=Or}if(Wt.done)return d(ye,mt),or&&$s(ye,bt),ut;if(mt===null){for(;!Wt.done;bt++,Wt=be.next())Wt=Ve(ye,Wt.value,Ge),Wt!==null&&(me=_(Wt,me,bt),xt===null?ut=Wt:xt.sibling=Wt,xt=Wt);return or&&$s(ye,bt),ut}for(mt=x(ye,mt);!Wt.done;bt++,Wt=be.next())Wt=ot(mt,ye,bt,Wt.value,Ge),Wt!==null&&(s&&Wt.alternate!==null&&mt.delete(Wt.key===null?bt:Wt.key),me=_(Wt,me,bt),xt===null?ut=Wt:xt.sibling=Wt,xt=Wt);return s&&mt.forEach(function(sb){return i(ye,sb)}),or&&$s(ye,bt),ut}function vr(ye,me,be,Ge){if(typeof be=="object"&&be!==null&&be.type===P&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case J:e:{for(var ut=be.key,xt=me;xt!==null;){if(xt.key===ut){if(ut=be.type,ut===P){if(xt.tag===7){d(ye,xt.sibling),me=y(xt,be.props.children),me.return=ye,ye=me;break e}}else if(xt.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===he&&Yh(ut)===xt.type){d(ye,xt.sibling),me=y(xt,be.props),me.ref=Bi(ye,xt,be),me.return=ye,ye=me;break e}d(ye,xt);break}else i(ye,xt);xt=xt.sibling}be.type===P?(me=qs(be.props.children,ye.mode,Ge,be.key),me.return=ye,ye=me):(Ge=Bc(be.type,be.key,be.props,null,ye.mode,Ge),Ge.ref=Bi(ye,me,be),Ge.return=ye,ye=Ge)}return M(ye);case V:e:{for(xt=be.key;me!==null;){if(me.key===xt)if(me.tag===4&&me.stateNode.containerInfo===be.containerInfo&&me.stateNode.implementation===be.implementation){d(ye,me.sibling),me=y(me,be.children||[]),me.return=ye,ye=me;break e}else{d(ye,me);break}else i(ye,me);me=me.sibling}me=M0(be,ye.mode,Ge),me.return=ye,ye=me}return M(ye);case he:return xt=be._init,vr(ye,me,xt(be._payload),Ge)}if(_e(be))return lt(ye,me,be,Ge);if(z(be))return ct(ye,me,be,Ge);mc(ye,be)}return typeof be=="string"&&be!==""||typeof be=="number"?(be=""+be,me!==null&&me.tag===6?(d(ye,me.sibling),me=y(me,be),me.return=ye,ye=me):(d(ye,me),me=z0(be,ye.mode,Ge),me.return=ye,ye=me),M(ye)):d(ye,me)}return vr}var Lo=Vh(!0),Kh=Vh(!1),gc=us(null),vc=null,Bo=null,Vd=null;function Kd(){Vd=Bo=vc=null}function Gd(s){var i=gc.current;nr(gc),s._currentValue=i}function Qd(s,i,d){for(;s!==null;){var x=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,x!==null&&(x.childLanes|=i)):x!==null&&(x.childLanes&i)!==i&&(x.childLanes|=i),s===d)break;s=s.return}}function Wo(s,i){vc=s,Vd=Bo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(xn=!0),s.firstContext=null)}function Pn(s){var i=s._currentValue;if(Vd!==s)if(s={context:s,memoizedValue:i,next:null},Bo===null){if(vc===null)throw Error(t(308));Bo=s,vc.dependencies={lanes:0,firstContext:s}}else Bo=Bo.next=s;return i}var Hs=null;function Xd(s){Hs===null?Hs=[s]:Hs.push(s)}function Gh(s,i,d,x){var y=i.interleaved;return y===null?(d.next=d,Xd(i)):(d.next=y.next,y.next=d),i.interleaved=d,La(s,x)}function La(s,i){s.lanes|=i;var d=s.alternate;for(d!==null&&(d.lanes|=i),d=s,s=s.return;s!==null;)s.childLanes|=i,d=s.alternate,d!==null&&(d.childLanes|=i),d=s,s=s.return;return d.tag===3?d.stateNode:null}var ps=!1;function qd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Ba(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function hs(s,i,d){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(zt&2)!==0){var y=x.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),x.pending=i,La(s,d)}return y=x.interleaved,y===null?(i.next=i,Xd(x)):(i.next=y.next,y.next=i),x.interleaved=i,La(s,d)}function yc(s,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194240)!==0)){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,dd(s,d)}}function Xh(s,i){var d=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,d===x)){var y=null,_=null;if(d=d.firstBaseUpdate,d!==null){do{var M={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};_===null?y=_=M:_=_.next=M,d=d.next}while(d!==null);_===null?y=_=i:_=_.next=i}else y=_=i;d={baseState:x.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:x.shared,effects:x.effects},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=i:s.next=i,d.lastBaseUpdate=i}function wc(s,i,d,x){var y=s.updateQueue;ps=!1;var _=y.firstBaseUpdate,M=y.lastBaseUpdate,ie=y.shared.pending;if(ie!==null){y.shared.pending=null;var xe=ie,Ce=xe.next;xe.next=null,M===null?_=Ce:M.next=Ce,M=xe;var Le=s.alternate;Le!==null&&(Le=Le.updateQueue,ie=Le.lastBaseUpdate,ie!==M&&(ie===null?Le.firstBaseUpdate=Ce:ie.next=Ce,Le.lastBaseUpdate=xe))}if(_!==null){var Ve=y.baseState;M=0,Le=Ce=xe=null,ie=_;do{var Ie=ie.lane,ot=ie.eventTime;if((x&Ie)===Ie){Le!==null&&(Le=Le.next={eventTime:ot,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var lt=s,ct=ie;switch(Ie=i,ot=d,ct.tag){case 1:if(lt=ct.payload,typeof lt=="function"){Ve=lt.call(ot,Ve,Ie);break e}Ve=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=ct.payload,Ie=typeof lt=="function"?lt.call(ot,Ve,Ie):lt,Ie==null)break e;Ve=se({},Ve,Ie);break e;case 2:ps=!0}}ie.callback!==null&&ie.lane!==0&&(s.flags|=64,Ie=y.effects,Ie===null?y.effects=[ie]:Ie.push(ie))}else ot={eventTime:ot,lane:Ie,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},Le===null?(Ce=Le=ot,xe=Ve):Le=Le.next=ot,M|=Ie;if(ie=ie.next,ie===null){if(ie=y.shared.pending,ie===null)break;Ie=ie,ie=Ie.next,Ie.next=null,y.lastBaseUpdate=Ie,y.shared.pending=null}}while(!0);if(Le===null&&(xe=Ve),y.baseState=xe,y.firstBaseUpdate=Ce,y.lastBaseUpdate=Le,i=y.shared.interleaved,i!==null){y=i;do M|=y.lane,y=y.next;while(y!==i)}else _===null&&(y.shared.lanes=0);Ks|=M,s.lanes=M,s.memoizedState=Ve}}function qh(s,i,d){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var x=s[i],y=x.callback;if(y!==null){if(x.callback=null,x=d,typeof y!="function")throw Error(t(191,y));y.call(x)}}}var Wi={},pa=us(Wi),Ui=us(Wi),$i=us(Wi);function Ys(s){if(s===Wi)throw Error(t(174));return s}function Zd(s,i){switch(Jt($i,i),Jt(Ui,s),Jt(pa,Wi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:sr(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=sr(i,s)}nr(pa),Jt(pa,i)}function Uo(){nr(pa),nr(Ui),nr($i)}function Zh(s){Ys($i.current);var i=Ys(pa.current),d=sr(i,s.type);i!==d&&(Jt(Ui,s),Jt(pa,d))}function Jd(s){Ui.current===s&&(nr(pa),nr(Ui))}var cr=us(0);function kc(s){for(var i=s;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var e0=[];function t0(){for(var s=0;s<e0.length;s++)e0[s]._workInProgressVersionPrimary=null;e0.length=0}var bc=W.ReactCurrentDispatcher,r0=W.ReactCurrentBatchConfig,Vs=0,ur=null,Nr=null,Pr=null,_c=!1,Hi=!1,Yi=0,Ck=0;function Yr(){throw Error(t(321))}function n0(s,i){if(i===null)return!1;for(var d=0;d<i.length&&d<s.length;d++)if(!Qn(s[d],i[d]))return!1;return!0}function a0(s,i,d,x,y,_){if(Vs=_,ur=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,bc.current=s===null||s.memoizedState===null?jk:Pk,s=d(x,y),Hi){_=0;do{if(Hi=!1,Yi=0,25<=_)throw Error(t(301));_+=1,Pr=Nr=null,i.updateQueue=null,bc.current=Ak,s=d(x,y)}while(Hi)}if(bc.current=Nc,i=Nr!==null&&Nr.next!==null,Vs=0,Pr=Nr=ur=null,_c=!1,i)throw Error(t(300));return s}function s0(){var s=Yi!==0;return Yi=0,s}function ha(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pr===null?ur.memoizedState=Pr=s:Pr=Pr.next=s,Pr}function An(){if(Nr===null){var s=ur.alternate;s=s!==null?s.memoizedState:null}else s=Nr.next;var i=Pr===null?ur.memoizedState:Pr.next;if(i!==null)Pr=i,Nr=s;else{if(s===null)throw Error(t(310));Nr=s,s={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Pr===null?ur.memoizedState=Pr=s:Pr=Pr.next=s}return Pr}function Vi(s,i){return typeof i=="function"?i(s):i}function o0(s){var i=An(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=Nr,y=x.baseQueue,_=d.pending;if(_!==null){if(y!==null){var M=y.next;y.next=_.next,_.next=M}x.baseQueue=y=_,d.pending=null}if(y!==null){_=y.next,x=x.baseState;var ie=M=null,xe=null,Ce=_;do{var Le=Ce.lane;if((Vs&Le)===Le)xe!==null&&(xe=xe.next={lane:0,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null}),x=Ce.hasEagerState?Ce.eagerState:s(x,Ce.action);else{var Ve={lane:Le,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null};xe===null?(ie=xe=Ve,M=x):xe=xe.next=Ve,ur.lanes|=Le,Ks|=Le}Ce=Ce.next}while(Ce!==null&&Ce!==_);xe===null?M=x:xe.next=ie,Qn(x,i.memoizedState)||(xn=!0),i.memoizedState=x,i.baseState=M,i.baseQueue=xe,d.lastRenderedState=x}if(s=d.interleaved,s!==null){y=s;do _=y.lane,ur.lanes|=_,Ks|=_,y=y.next;while(y!==s)}else y===null&&(d.lanes=0);return[i.memoizedState,d.dispatch]}function i0(s){var i=An(),d=i.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var x=d.dispatch,y=d.pending,_=i.memoizedState;if(y!==null){d.pending=null;var M=y=y.next;do _=s(_,M.action),M=M.next;while(M!==y);Qn(_,i.memoizedState)||(xn=!0),i.memoizedState=_,i.baseQueue===null&&(i.baseState=_),d.lastRenderedState=_}return[_,x]}function Jh(){}function ex(s,i){var d=ur,x=An(),y=i(),_=!Qn(x.memoizedState,y);if(_&&(x.memoizedState=y,xn=!0),x=x.queue,l0(nx.bind(null,d,x,s),[s]),x.getSnapshot!==i||_||Pr!==null&&Pr.memoizedState.tag&1){if(d.flags|=2048,Ki(9,rx.bind(null,d,x,y,i),void 0,null),Ar===null)throw Error(t(349));(Vs&30)!==0||tx(d,i,y)}return y}function tx(s,i,d){s.flags|=16384,s={getSnapshot:i,value:d},i=ur.updateQueue,i===null?(i={lastEffect:null,stores:null},ur.updateQueue=i,i.stores=[s]):(d=i.stores,d===null?i.stores=[s]:d.push(s))}function rx(s,i,d,x){i.value=d,i.getSnapshot=x,ax(i)&&sx(s)}function nx(s,i,d){return d(function(){ax(i)&&sx(s)})}function ax(s){var i=s.getSnapshot;s=s.value;try{var d=i();return!Qn(s,d)}catch{return!0}}function sx(s){var i=La(s,1);i!==null&&ea(i,s,1,-1)}function ox(s){var i=ha();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:s},i.queue=s,s=s.dispatch=Fk.bind(null,ur,s),[i.memoizedState,s]}function Ki(s,i,d,x){return s={tag:s,create:i,destroy:d,deps:x,next:null},i=ur.updateQueue,i===null?(i={lastEffect:null,stores:null},ur.updateQueue=i,i.lastEffect=s.next=s):(d=i.lastEffect,d===null?i.lastEffect=s.next=s:(x=d.next,d.next=s,s.next=x,i.lastEffect=s)),s}function ix(){return An().memoizedState}function Sc(s,i,d,x){var y=ha();ur.flags|=s,y.memoizedState=Ki(1|i,d,void 0,x===void 0?null:x)}function Ec(s,i,d,x){var y=An();x=x===void 0?null:x;var _=void 0;if(Nr!==null){var M=Nr.memoizedState;if(_=M.destroy,x!==null&&n0(x,M.deps)){y.memoizedState=Ki(i,d,_,x);return}}ur.flags|=s,y.memoizedState=Ki(1|i,d,_,x)}function lx(s,i){return Sc(8390656,8,s,i)}function l0(s,i){return Ec(2048,8,s,i)}function cx(s,i){return Ec(4,2,s,i)}function ux(s,i){return Ec(4,4,s,i)}function dx(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function fx(s,i,d){return d=d!=null?d.concat([s]):null,Ec(4,4,dx.bind(null,i,s),d)}function c0(){}function px(s,i){var d=An();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&n0(i,x[1])?x[0]:(d.memoizedState=[s,i],s)}function hx(s,i){var d=An();i=i===void 0?null:i;var x=d.memoizedState;return x!==null&&i!==null&&n0(i,x[1])?x[0]:(s=s(),d.memoizedState=[s,i],s)}function xx(s,i,d){return(Vs&21)===0?(s.baseState&&(s.baseState=!1,xn=!0),s.memoizedState=d):(Qn(d,i)||(d=Yp(),ur.lanes|=d,Ks|=d,s.baseState=!0),i)}function Tk(s,i){var d=Xt;Xt=d!==0&&4>d?d:4,s(!0);var x=r0.transition;r0.transition={};try{s(!1),i()}finally{Xt=d,r0.transition=x}}function mx(){return An().memoizedState}function Dk(s,i,d){var x=vs(s);if(d={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null},gx(s))vx(i,d);else if(d=Gh(s,i,d,x),d!==null){var y=rn();ea(d,s,x,y),yx(d,i,x)}}function Fk(s,i,d){var x=vs(s),y={lane:x,action:d,hasEagerState:!1,eagerState:null,next:null};if(gx(s))vx(i,y);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=i.lastRenderedReducer,_!==null))try{var M=i.lastRenderedState,ie=_(M,d);if(y.hasEagerState=!0,y.eagerState=ie,Qn(ie,M)){var xe=i.interleaved;xe===null?(y.next=y,Xd(i)):(y.next=xe.next,xe.next=y),i.interleaved=y;return}}catch{}finally{}d=Gh(s,i,y,x),d!==null&&(y=rn(),ea(d,s,x,y),yx(d,i,x))}}function gx(s){var i=s.alternate;return s===ur||i!==null&&i===ur}function vx(s,i){Hi=_c=!0;var d=s.pending;d===null?i.next=i:(i.next=d.next,d.next=i),s.pending=i}function yx(s,i,d){if((d&4194240)!==0){var x=i.lanes;x&=s.pendingLanes,d|=x,i.lanes=d,dd(s,d)}}var Nc={readContext:Pn,useCallback:Yr,useContext:Yr,useEffect:Yr,useImperativeHandle:Yr,useInsertionEffect:Yr,useLayoutEffect:Yr,useMemo:Yr,useReducer:Yr,useRef:Yr,useState:Yr,useDebugValue:Yr,useDeferredValue:Yr,useTransition:Yr,useMutableSource:Yr,useSyncExternalStore:Yr,useId:Yr,unstable_isNewReconciler:!1},jk={readContext:Pn,useCallback:function(s,i){return ha().memoizedState=[s,i===void 0?null:i],s},useContext:Pn,useEffect:lx,useImperativeHandle:function(s,i,d){return d=d!=null?d.concat([s]):null,Sc(4194308,4,dx.bind(null,i,s),d)},useLayoutEffect:function(s,i){return Sc(4194308,4,s,i)},useInsertionEffect:function(s,i){return Sc(4,2,s,i)},useMemo:function(s,i){var d=ha();return i=i===void 0?null:i,s=s(),d.memoizedState=[s,i],s},useReducer:function(s,i,d){var x=ha();return i=d!==void 0?d(i):i,x.memoizedState=x.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},x.queue=s,s=s.dispatch=Dk.bind(null,ur,s),[x.memoizedState,s]},useRef:function(s){var i=ha();return s={current:s},i.memoizedState=s},useState:ox,useDebugValue:c0,useDeferredValue:function(s){return ha().memoizedState=s},useTransition:function(){var s=ox(!1),i=s[0];return s=Tk.bind(null,s[1]),ha().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,d){var x=ur,y=ha();if(or){if(d===void 0)throw Error(t(407));d=d()}else{if(d=i(),Ar===null)throw Error(t(349));(Vs&30)!==0||tx(x,i,d)}y.memoizedState=d;var _={value:d,getSnapshot:i};return y.queue=_,lx(nx.bind(null,x,_,s),[s]),x.flags|=2048,Ki(9,rx.bind(null,x,_,d,i),void 0,null),d},useId:function(){var s=ha(),i=Ar.identifierPrefix;if(or){var d=Ia,x=Ma;d=(x&~(1<<32-gr(x)-1)).toString(32)+d,i=":"+i+"R"+d,d=Yi++,0<d&&(i+="H"+d.toString(32)),i+=":"}else d=Ck++,i=":"+i+"r"+d.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Pk={readContext:Pn,useCallback:px,useContext:Pn,useEffect:l0,useImperativeHandle:fx,useInsertionEffect:cx,useLayoutEffect:ux,useMemo:hx,useReducer:o0,useRef:ix,useState:function(){return o0(Vi)},useDebugValue:c0,useDeferredValue:function(s){var i=An();return xx(i,Nr.memoizedState,s)},useTransition:function(){var s=o0(Vi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Jh,useSyncExternalStore:ex,useId:mx,unstable_isNewReconciler:!1},Ak={readContext:Pn,useCallback:px,useContext:Pn,useEffect:l0,useImperativeHandle:fx,useInsertionEffect:cx,useLayoutEffect:ux,useMemo:hx,useReducer:i0,useRef:ix,useState:function(){return i0(Vi)},useDebugValue:c0,useDeferredValue:function(s){var i=An();return Nr===null?i.memoizedState=s:xx(i,Nr.memoizedState,s)},useTransition:function(){var s=i0(Vi)[0],i=An().memoizedState;return[s,i]},useMutableSource:Jh,useSyncExternalStore:ex,useId:mx,unstable_isNewReconciler:!1};function qn(s,i){if(s&&s.defaultProps){i=se({},i),s=s.defaultProps;for(var d in s)i[d]===void 0&&(i[d]=s[d]);return i}return i}function u0(s,i,d,x){i=s.memoizedState,d=d(x,i),d=d==null?i:se({},i,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var Cc={isMounted:function(s){return(s=s._reactInternals)?re(s)===s:!1},enqueueSetState:function(s,i,d){s=s._reactInternals;var x=rn(),y=vs(s),_=Ba(x,y);_.payload=i,d!=null&&(_.callback=d),i=hs(s,_,y),i!==null&&(ea(i,s,y,x),yc(i,s,y))},enqueueReplaceState:function(s,i,d){s=s._reactInternals;var x=rn(),y=vs(s),_=Ba(x,y);_.tag=1,_.payload=i,d!=null&&(_.callback=d),i=hs(s,_,y),i!==null&&(ea(i,s,y,x),yc(i,s,y))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var d=rn(),x=vs(s),y=Ba(d,x);y.tag=2,i!=null&&(y.callback=i),i=hs(s,y,x),i!==null&&(ea(i,s,x,d),yc(i,s,x))}};function wx(s,i,d,x,y,_,M){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,_,M):i.prototype&&i.prototype.isPureReactComponent?!Ai(d,x)||!Ai(y,_):!0}function kx(s,i,d){var x=!1,y=ds,_=i.contextType;return typeof _=="object"&&_!==null?_=Pn(_):(y=hn(i)?Ws:Hr.current,x=i.contextTypes,_=(x=x!=null)?Ro(s,y):ds),i=new i(d,_),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Cc,s.stateNode=i,i._reactInternals=s,x&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=y,s.__reactInternalMemoizedMaskedChildContext=_),i}function bx(s,i,d,x){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,x),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,x),i.state!==s&&Cc.enqueueReplaceState(i,i.state,null)}function d0(s,i,d,x){var y=s.stateNode;y.props=d,y.state=s.memoizedState,y.refs={},qd(s);var _=i.contextType;typeof _=="object"&&_!==null?y.context=Pn(_):(_=hn(i)?Ws:Hr.current,y.context=Ro(s,_)),y.state=s.memoizedState,_=i.getDerivedStateFromProps,typeof _=="function"&&(u0(s,i,_,d),y.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Cc.enqueueReplaceState(y,y.state,null),wc(s,d,y,x),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308)}function $o(s,i){try{var d="",x=i;do d+=E(x),x=x.return;while(x);var y=d}catch(_){y=`
Error generating stack: `+_.message+`
`+_.stack}return{value:s,source:i,stack:y,digest:null}}function f0(s,i,d){return{value:s,source:null,stack:d??null,digest:i??null}}function p0(s,i){try{console.error(i.value)}catch(d){setTimeout(function(){throw d})}}var Ok=typeof WeakMap=="function"?WeakMap:Map;function _x(s,i,d){d=Ba(-1,d),d.tag=3,d.payload={element:null};var x=i.value;return d.callback=function(){Oc||(Oc=!0,T0=x),p0(s,i)},d}function Sx(s,i,d){d=Ba(-1,d),d.tag=3;var x=s.type.getDerivedStateFromError;if(typeof x=="function"){var y=i.value;d.payload=function(){return x(y)},d.callback=function(){p0(s,i)}}var _=s.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(d.callback=function(){p0(s,i),typeof x!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var M=i.stack;this.componentDidCatch(i.value,{componentStack:M!==null?M:""})}),d}function Ex(s,i,d){var x=s.pingCache;if(x===null){x=s.pingCache=new Ok;var y=new Set;x.set(i,y)}else y=x.get(i),y===void 0&&(y=new Set,x.set(i,y));y.has(d)||(y.add(d),s=Gk.bind(null,s,i,d),i.then(s,s))}function Nx(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Cx(s,i,d,x,y){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(i=Ba(-1,1),i.tag=2,hs(d,i,1))),d.lanes|=1),s):(s.flags|=65536,s.lanes=y,s)}var Rk=W.ReactCurrentOwner,xn=!1;function tn(s,i,d,x){i.child=s===null?Kh(i,null,d,x):Lo(i,s.child,d,x)}function Tx(s,i,d,x,y){d=d.render;var _=i.ref;return Wo(i,y),x=a0(s,i,d,x,_,y),d=s0(),s!==null&&!xn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Wa(s,i,y)):(or&&d&&Wd(i),i.flags|=1,tn(s,i,x,y),i.child)}function Dx(s,i,d,x,y){if(s===null){var _=d.type;return typeof _=="function"&&!R0(_)&&_.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(i.tag=15,i.type=_,Fx(s,i,_,x,y)):(s=Bc(d.type,null,x,i,i.mode,y),s.ref=i.ref,s.return=i,i.child=s)}if(_=s.child,(s.lanes&y)===0){var M=_.memoizedProps;if(d=d.compare,d=d!==null?d:Ai,d(M,x)&&s.ref===i.ref)return Wa(s,i,y)}return i.flags|=1,s=ws(_,x),s.ref=i.ref,s.return=i,i.child=s}function Fx(s,i,d,x,y){if(s!==null){var _=s.memoizedProps;if(Ai(_,x)&&s.ref===i.ref)if(xn=!1,i.pendingProps=x=_,(s.lanes&y)!==0)(s.flags&131072)!==0&&(xn=!0);else return i.lanes=s.lanes,Wa(s,i,y)}return h0(s,i,d,x,y)}function jx(s,i,d){var x=i.pendingProps,y=x.children,_=s!==null?s.memoizedState:null;if(x.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(Yo,Sn),Sn|=d;else{if((d&1073741824)===0)return s=_!==null?_.baseLanes|d:d,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Jt(Yo,Sn),Sn|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=_!==null?_.baseLanes:d,Jt(Yo,Sn),Sn|=x}else _!==null?(x=_.baseLanes|d,i.memoizedState=null):x=d,Jt(Yo,Sn),Sn|=x;return tn(s,i,y,d),i.child}function Px(s,i){var d=i.ref;(s===null&&d!==null||s!==null&&s.ref!==d)&&(i.flags|=512,i.flags|=2097152)}function h0(s,i,d,x,y){var _=hn(d)?Ws:Hr.current;return _=Ro(i,_),Wo(i,y),d=a0(s,i,d,x,_,y),x=s0(),s!==null&&!xn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Wa(s,i,y)):(or&&x&&Wd(i),i.flags|=1,tn(s,i,d,y),i.child)}function Ax(s,i,d,x,y){if(hn(d)){var _=!0;dc(i)}else _=!1;if(Wo(i,y),i.stateNode===null)Dc(s,i),kx(i,d,x),d0(i,d,x,y),x=!0;else if(s===null){var M=i.stateNode,ie=i.memoizedProps;M.props=ie;var xe=M.context,Ce=d.contextType;typeof Ce=="object"&&Ce!==null?Ce=Pn(Ce):(Ce=hn(d)?Ws:Hr.current,Ce=Ro(i,Ce));var Le=d.getDerivedStateFromProps,Ve=typeof Le=="function"||typeof M.getSnapshotBeforeUpdate=="function";Ve||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(ie!==x||xe!==Ce)&&bx(i,M,x,Ce),ps=!1;var Ie=i.memoizedState;M.state=Ie,wc(i,x,M,y),xe=i.memoizedState,ie!==x||Ie!==xe||pn.current||ps?(typeof Le=="function"&&(u0(i,d,Le,x),xe=i.memoizedState),(ie=ps||wx(i,d,ie,x,Ie,xe,Ce))?(Ve||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(i.flags|=4194308)):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=x,i.memoizedState=xe),M.props=x,M.state=xe,M.context=Ce,x=ie):(typeof M.componentDidMount=="function"&&(i.flags|=4194308),x=!1)}else{M=i.stateNode,Qh(s,i),ie=i.memoizedProps,Ce=i.type===i.elementType?ie:qn(i.type,ie),M.props=Ce,Ve=i.pendingProps,Ie=M.context,xe=d.contextType,typeof xe=="object"&&xe!==null?xe=Pn(xe):(xe=hn(d)?Ws:Hr.current,xe=Ro(i,xe));var ot=d.getDerivedStateFromProps;(Le=typeof ot=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(ie!==Ve||Ie!==xe)&&bx(i,M,x,xe),ps=!1,Ie=i.memoizedState,M.state=Ie,wc(i,x,M,y);var lt=i.memoizedState;ie!==Ve||Ie!==lt||pn.current||ps?(typeof ot=="function"&&(u0(i,d,ot,x),lt=i.memoizedState),(Ce=ps||wx(i,d,Ce,x,Ie,lt,xe)||!1)?(Le||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(x,lt,xe),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(x,lt,xe)),typeof M.componentDidUpdate=="function"&&(i.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof M.componentDidUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=1024),i.memoizedProps=x,i.memoizedState=lt),M.props=x,M.state=lt,M.context=xe,x=Ce):(typeof M.componentDidUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||ie===s.memoizedProps&&Ie===s.memoizedState||(i.flags|=1024),x=!1)}return x0(s,i,d,x,_,y)}function x0(s,i,d,x,y,_){Px(s,i);var M=(i.flags&128)!==0;if(!x&&!M)return y&&Ih(i,d,!1),Wa(s,i,_);x=i.stateNode,Rk.current=i;var ie=M&&typeof d.getDerivedStateFromError!="function"?null:x.render();return i.flags|=1,s!==null&&M?(i.child=Lo(i,s.child,null,_),i.child=Lo(i,null,ie,_)):tn(s,i,ie,_),i.memoizedState=x.state,y&&Ih(i,d,!0),i.child}function Ox(s){var i=s.stateNode;i.pendingContext?zh(s,i.pendingContext,i.pendingContext!==i.context):i.context&&zh(s,i.context,!1),Zd(s,i.containerInfo)}function Rx(s,i,d,x,y){return Io(),Yd(y),i.flags|=256,tn(s,i,d,x),i.child}var m0={dehydrated:null,treeContext:null,retryLane:0};function g0(s){return{baseLanes:s,cachePool:null,transitions:null}}function zx(s,i,d){var x=i.pendingProps,y=cr.current,_=!1,M=(i.flags&128)!==0,ie;if((ie=M)||(ie=s!==null&&s.memoizedState===null?!1:(y&2)!==0),ie?(_=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(y|=1),Jt(cr,y&1),s===null)return Hd(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(M=x.children,s=x.fallback,_?(x=i.mode,_=i.child,M={mode:"hidden",children:M},(x&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=M):_=Wc(M,x,0,null),s=qs(s,x,d,null),_.return=i,s.return=i,_.sibling=s,i.child=_,i.child.memoizedState=g0(d),i.memoizedState=m0,s):v0(i,M));if(y=s.memoizedState,y!==null&&(ie=y.dehydrated,ie!==null))return zk(s,i,M,x,ie,y,d);if(_){_=x.fallback,M=i.mode,y=s.child,ie=y.sibling;var xe={mode:"hidden",children:x.children};return(M&1)===0&&i.child!==y?(x=i.child,x.childLanes=0,x.pendingProps=xe,i.deletions=null):(x=ws(y,xe),x.subtreeFlags=y.subtreeFlags&14680064),ie!==null?_=ws(ie,_):(_=qs(_,M,d,null),_.flags|=2),_.return=i,x.return=i,x.sibling=_,i.child=x,x=_,_=i.child,M=s.child.memoizedState,M=M===null?g0(d):{baseLanes:M.baseLanes|d,cachePool:null,transitions:M.transitions},_.memoizedState=M,_.childLanes=s.childLanes&~d,i.memoizedState=m0,x}return _=s.child,s=_.sibling,x=ws(_,{mode:"visible",children:x.children}),(i.mode&1)===0&&(x.lanes=d),x.return=i,x.sibling=null,s!==null&&(d=i.deletions,d===null?(i.deletions=[s],i.flags|=16):d.push(s)),i.child=x,i.memoizedState=null,x}function v0(s,i){return i=Wc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Tc(s,i,d,x){return x!==null&&Yd(x),Lo(i,s.child,null,d),s=v0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function zk(s,i,d,x,y,_,M){if(d)return i.flags&256?(i.flags&=-257,x=f0(Error(t(422))),Tc(s,i,M,x)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(_=x.fallback,y=i.mode,x=Wc({mode:"visible",children:x.children},y,0,null),_=qs(_,y,M,null),_.flags|=2,x.return=i,_.return=i,x.sibling=_,i.child=x,(i.mode&1)!==0&&Lo(i,s.child,null,M),i.child.memoizedState=g0(M),i.memoizedState=m0,_);if((i.mode&1)===0)return Tc(s,i,M,null);if(y.data==="$!"){if(x=y.nextSibling&&y.nextSibling.dataset,x)var ie=x.dgst;return x=ie,_=Error(t(419)),x=f0(_,x,void 0),Tc(s,i,M,x)}if(ie=(M&s.childLanes)!==0,xn||ie){if(x=Ar,x!==null){switch(M&-M){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(x.suspendedLanes|M))!==0?0:y,y!==0&&y!==_.retryLane&&(_.retryLane=y,La(s,y),ea(x,s,y,-1))}return O0(),x=f0(Error(t(421))),Tc(s,i,M,x)}return y.data==="$?"?(i.flags|=128,i.child=s.child,i=Qk.bind(null,s),y._reactRetry=i,null):(s=_.treeContext,_n=cs(y.nextSibling),bn=i,or=!0,Xn=null,s!==null&&(Fn[jn++]=Ma,Fn[jn++]=Ia,Fn[jn++]=Us,Ma=s.id,Ia=s.overflow,Us=i),i=v0(i,x.children),i.flags|=4096,i)}function Mx(s,i,d){s.lanes|=i;var x=s.alternate;x!==null&&(x.lanes|=i),Qd(s.return,i,d)}function y0(s,i,d,x,y){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:x,tail:d,tailMode:y}:(_.isBackwards=i,_.rendering=null,_.renderingStartTime=0,_.last=x,_.tail=d,_.tailMode=y)}function Ix(s,i,d){var x=i.pendingProps,y=x.revealOrder,_=x.tail;if(tn(s,i,x.children,d),x=cr.current,(x&2)!==0)x=x&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Mx(s,d,i);else if(s.tag===19)Mx(s,d,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}if(Jt(cr,x),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(d=i.child,y=null;d!==null;)s=d.alternate,s!==null&&kc(s)===null&&(y=d),d=d.sibling;d=y,d===null?(y=i.child,i.child=null):(y=d.sibling,d.sibling=null),y0(i,!1,y,d,_);break;case"backwards":for(d=null,y=i.child,i.child=null;y!==null;){if(s=y.alternate,s!==null&&kc(s)===null){i.child=y;break}s=y.sibling,y.sibling=d,d=y,y=s}y0(i,!0,d,null,_);break;case"together":y0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Dc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Wa(s,i,d){if(s!==null&&(i.dependencies=s.dependencies),Ks|=i.lanes,(d&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,d=ws(s,s.pendingProps),i.child=d,d.return=i;s.sibling!==null;)s=s.sibling,d=d.sibling=ws(s,s.pendingProps),d.return=i;d.sibling=null}return i.child}function Mk(s,i,d){switch(i.tag){case 3:Ox(i),Io();break;case 5:Zh(i);break;case 1:hn(i.type)&&dc(i);break;case 4:Zd(i,i.stateNode.containerInfo);break;case 10:var x=i.type._context,y=i.memoizedProps.value;Jt(gc,x._currentValue),x._currentValue=y;break;case 13:if(x=i.memoizedState,x!==null)return x.dehydrated!==null?(Jt(cr,cr.current&1),i.flags|=128,null):(d&i.child.childLanes)!==0?zx(s,i,d):(Jt(cr,cr.current&1),s=Wa(s,i,d),s!==null?s.sibling:null);Jt(cr,cr.current&1);break;case 19:if(x=(d&i.childLanes)!==0,(s.flags&128)!==0){if(x)return Ix(s,i,d);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Jt(cr,cr.current),x)break;return null;case 22:case 23:return i.lanes=0,jx(s,i,d)}return Wa(s,i,d)}var Lx,w0,Bx,Wx;Lx=function(s,i){for(var d=i.child;d!==null;){if(d.tag===5||d.tag===6)s.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break;for(;d.sibling===null;){if(d.return===null||d.return===i)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},w0=function(){},Bx=function(s,i,d,x){var y=s.memoizedProps;if(y!==x){s=i.stateNode,Ys(pa.current);var _=null;switch(d){case"input":y=Ae(s,y),x=Ae(s,x),_=[];break;case"select":y=se({},y,{value:void 0}),x=se({},x,{value:void 0}),_=[];break;case"textarea":y=ft(s,y),x=ft(s,x),_=[];break;default:typeof y.onClick!="function"&&typeof x.onClick=="function"&&(s.onclick=lc)}Ze(d,x);var M;d=null;for(Ce in y)if(!x.hasOwnProperty(Ce)&&y.hasOwnProperty(Ce)&&y[Ce]!=null)if(Ce==="style"){var ie=y[Ce];for(M in ie)ie.hasOwnProperty(M)&&(d||(d={}),d[M]="")}else Ce!=="dangerouslySetInnerHTML"&&Ce!=="children"&&Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&Ce!=="autoFocus"&&(a.hasOwnProperty(Ce)?_||(_=[]):(_=_||[]).push(Ce,null));for(Ce in x){var xe=x[Ce];if(ie=y?.[Ce],x.hasOwnProperty(Ce)&&xe!==ie&&(xe!=null||ie!=null))if(Ce==="style")if(ie){for(M in ie)!ie.hasOwnProperty(M)||xe&&xe.hasOwnProperty(M)||(d||(d={}),d[M]="");for(M in xe)xe.hasOwnProperty(M)&&ie[M]!==xe[M]&&(d||(d={}),d[M]=xe[M])}else d||(_||(_=[]),_.push(Ce,d)),d=xe;else Ce==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,ie=ie?ie.__html:void 0,xe!=null&&ie!==xe&&(_=_||[]).push(Ce,xe)):Ce==="children"?typeof xe!="string"&&typeof xe!="number"||(_=_||[]).push(Ce,""+xe):Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ce)?(xe!=null&&Ce==="onScroll"&&rr("scroll",s),_||ie===xe||(_=[])):(_=_||[]).push(Ce,xe))}d&&(_=_||[]).push("style",d);var Ce=_;(i.updateQueue=Ce)&&(i.flags|=4)}},Wx=function(s,i,d,x){d!==x&&(i.flags|=4)};function Gi(s,i){if(!or)switch(s.tailMode){case"hidden":i=s.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Vr(s){var i=s.alternate!==null&&s.alternate.child===s.child,d=0,x=0;if(i)for(var y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags&14680064,x|=y.flags&14680064,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)d|=y.lanes|y.childLanes,x|=y.subtreeFlags,x|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=x,s.childLanes=d,i}function Ik(s,i,d){var x=i.pendingProps;switch(Ud(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(i),null;case 1:return hn(i.type)&&uc(),Vr(i),null;case 3:return x=i.stateNode,Uo(),nr(pn),nr(Hr),t0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(s===null||s.child===null)&&(xc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Xn!==null&&(j0(Xn),Xn=null))),w0(s,i),Vr(i),null;case 5:Jd(i);var y=Ys($i.current);if(d=i.type,s!==null&&i.stateNode!=null)Bx(s,i,d,x,y),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!x){if(i.stateNode===null)throw Error(t(166));return Vr(i),null}if(s=Ys(pa.current),xc(i)){x=i.stateNode,d=i.type;var _=i.memoizedProps;switch(x[fa]=i,x[Ii]=_,s=(i.mode&1)!==0,d){case"dialog":rr("cancel",x),rr("close",x);break;case"iframe":case"object":case"embed":rr("load",x);break;case"video":case"audio":for(y=0;y<Ri.length;y++)rr(Ri[y],x);break;case"source":rr("error",x);break;case"img":case"image":case"link":rr("error",x),rr("load",x);break;case"details":rr("toggle",x);break;case"input":Xe(x,_),rr("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!_.multiple},rr("invalid",x);break;case"textarea":ht(x,_),rr("invalid",x)}Ze(d,_),y=null;for(var M in _)if(_.hasOwnProperty(M)){var ie=_[M];M==="children"?typeof ie=="string"?x.textContent!==ie&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,ie,s),y=["children",ie]):typeof ie=="number"&&x.textContent!==""+ie&&(_.suppressHydrationWarning!==!0&&ic(x.textContent,ie,s),y=["children",""+ie]):a.hasOwnProperty(M)&&ie!=null&&M==="onScroll"&&rr("scroll",x)}switch(d){case"input":ue(x),Ne(x,_,!0);break;case"textarea":ue(x),jt(x);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(x.onclick=lc)}x=y,i.updateQueue=x,x!==null&&(i.flags|=4)}else{M=y.nodeType===9?y:y.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Gt(d)),s==="http://www.w3.org/1999/xhtml"?d==="script"?(s=M.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof x.is=="string"?s=M.createElement(d,{is:x.is}):(s=M.createElement(d),d==="select"&&(M=s,x.multiple?M.multiple=!0:x.size&&(M.size=x.size))):s=M.createElementNS(s,d),s[fa]=i,s[Ii]=x,Lx(s,i,!1,!1),i.stateNode=s;e:{switch(M=kt(d,x),d){case"dialog":rr("cancel",s),rr("close",s),y=x;break;case"iframe":case"object":case"embed":rr("load",s),y=x;break;case"video":case"audio":for(y=0;y<Ri.length;y++)rr(Ri[y],s);y=x;break;case"source":rr("error",s),y=x;break;case"img":case"image":case"link":rr("error",s),rr("load",s),y=x;break;case"details":rr("toggle",s),y=x;break;case"input":Xe(s,x),y=Ae(s,x),rr("invalid",s);break;case"option":y=x;break;case"select":s._wrapperState={wasMultiple:!!x.multiple},y=se({},x,{value:void 0}),rr("invalid",s);break;case"textarea":ht(s,x),y=ft(s,x),rr("invalid",s);break;default:y=x}Ze(d,y),ie=y;for(_ in ie)if(ie.hasOwnProperty(_)){var xe=ie[_];_==="style"?Bt(s,xe):_==="dangerouslySetInnerHTML"?(xe=xe?xe.__html:void 0,xe!=null&&Ht(s,xe)):_==="children"?typeof xe=="string"?(d!=="textarea"||xe!=="")&&pt(s,xe):typeof xe=="number"&&pt(s,""+xe):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(a.hasOwnProperty(_)?xe!=null&&_==="onScroll"&&rr("scroll",s):xe!=null&&C(s,_,xe,M))}switch(d){case"input":ue(s),Ne(s,x,!1);break;case"textarea":ue(s),jt(s);break;case"option":x.value!=null&&s.setAttribute("value",""+q(x.value));break;case"select":s.multiple=!!x.multiple,_=x.value,_!=null?Qe(s,!!x.multiple,_,!1):x.defaultValue!=null&&Qe(s,!!x.multiple,x.defaultValue,!0);break;default:typeof y.onClick=="function"&&(s.onclick=lc)}switch(d){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Vr(i),null;case 6:if(s&&i.stateNode!=null)Wx(s,i,s.memoizedProps,x);else{if(typeof x!="string"&&i.stateNode===null)throw Error(t(166));if(d=Ys($i.current),Ys(pa.current),xc(i)){if(x=i.stateNode,d=i.memoizedProps,x[fa]=i,(_=x.nodeValue!==d)&&(s=bn,s!==null))switch(s.tag){case 3:ic(x.nodeValue,d,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ic(x.nodeValue,d,(s.mode&1)!==0)}_&&(i.flags|=4)}else x=(d.nodeType===9?d:d.ownerDocument).createTextNode(x),x[fa]=i,i.stateNode=x}return Vr(i),null;case 13:if(nr(cr),x=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(or&&_n!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Hh(),Io(),i.flags|=98560,_=!1;else if(_=xc(i),x!==null&&x.dehydrated!==null){if(s===null){if(!_)throw Error(t(318));if(_=i.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[fa]=i}else Io(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Vr(i),_=!1}else Xn!==null&&(j0(Xn),Xn=null),_=!0;if(!_)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=d,i):(x=x!==null,x!==(s!==null&&s.memoizedState!==null)&&x&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(cr.current&1)!==0?Cr===0&&(Cr=3):O0())),i.updateQueue!==null&&(i.flags|=4),Vr(i),null);case 4:return Uo(),w0(s,i),s===null&&zi(i.stateNode.containerInfo),Vr(i),null;case 10:return Gd(i.type._context),Vr(i),null;case 17:return hn(i.type)&&uc(),Vr(i),null;case 19:if(nr(cr),_=i.memoizedState,_===null)return Vr(i),null;if(x=(i.flags&128)!==0,M=_.rendering,M===null)if(x)Gi(_,!1);else{if(Cr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(M=kc(s),M!==null){for(i.flags|=128,Gi(_,!1),x=M.updateQueue,x!==null&&(i.updateQueue=x,i.flags|=4),i.subtreeFlags=0,x=d,d=i.child;d!==null;)_=d,s=x,_.flags&=14680066,M=_.alternate,M===null?(_.childLanes=0,_.lanes=s,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=M.childLanes,_.lanes=M.lanes,_.child=M.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=M.memoizedProps,_.memoizedState=M.memoizedState,_.updateQueue=M.updateQueue,_.type=M.type,s=M.dependencies,_.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),d=d.sibling;return Jt(cr,cr.current&1|2),i.child}s=s.sibling}_.tail!==null&&Ye()>Vo&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304)}else{if(!x)if(s=kc(M),s!==null){if(i.flags|=128,x=!0,d=s.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),Gi(_,!0),_.tail===null&&_.tailMode==="hidden"&&!M.alternate&&!or)return Vr(i),null}else 2*Ye()-_.renderingStartTime>Vo&&d!==1073741824&&(i.flags|=128,x=!0,Gi(_,!1),i.lanes=4194304);_.isBackwards?(M.sibling=i.child,i.child=M):(d=_.last,d!==null?d.sibling=M:i.child=M,_.last=M)}return _.tail!==null?(i=_.tail,_.rendering=i,_.tail=i.sibling,_.renderingStartTime=Ye(),i.sibling=null,d=cr.current,Jt(cr,x?d&1|2:d&1),i):(Vr(i),null);case 22:case 23:return A0(),x=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==x&&(i.flags|=8192),x&&(i.mode&1)!==0?(Sn&1073741824)!==0&&(Vr(i),i.subtreeFlags&6&&(i.flags|=8192)):Vr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Lk(s,i){switch(Ud(i),i.tag){case 1:return hn(i.type)&&uc(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Uo(),nr(pn),nr(Hr),t0(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Jd(i),null;case 13:if(nr(cr),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Io()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return nr(cr),null;case 4:return Uo(),null;case 10:return Gd(i.type._context),null;case 22:case 23:return A0(),null;case 24:return null;default:return null}}var Fc=!1,Kr=!1,Bk=typeof WeakSet=="function"?WeakSet:Set,it=null;function Ho(s,i){var d=s.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(x){fr(s,i,x)}else d.current=null}function k0(s,i,d){try{d()}catch(x){fr(s,i,x)}}var Ux=!1;function Wk(s,i){if(Ad=Xl,s=wh(),Ed(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var x=d.getSelection&&d.getSelection();if(x&&x.rangeCount!==0){d=x.anchorNode;var y=x.anchorOffset,_=x.focusNode;x=x.focusOffset;try{d.nodeType,_.nodeType}catch{d=null;break e}var M=0,ie=-1,xe=-1,Ce=0,Le=0,Ve=s,Ie=null;t:for(;;){for(var ot;Ve!==d||y!==0&&Ve.nodeType!==3||(ie=M+y),Ve!==_||x!==0&&Ve.nodeType!==3||(xe=M+x),Ve.nodeType===3&&(M+=Ve.nodeValue.length),(ot=Ve.firstChild)!==null;)Ie=Ve,Ve=ot;for(;;){if(Ve===s)break t;if(Ie===d&&++Ce===y&&(ie=M),Ie===_&&++Le===x&&(xe=M),(ot=Ve.nextSibling)!==null)break;Ve=Ie,Ie=Ve.parentNode}Ve=ot}d=ie===-1||xe===-1?null:{start:ie,end:xe}}else d=null}d=d||{start:0,end:0}}else d=null;for(Od={focusedElem:s,selectionRange:d},Xl=!1,it=i;it!==null;)if(i=it,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,it=s;else for(;it!==null;){i=it;try{var lt=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var ct=lt.memoizedProps,vr=lt.memoizedState,ye=i.stateNode,me=ye.getSnapshotBeforeUpdate(i.elementType===i.type?ct:qn(i.type,ct),vr);ye.__reactInternalSnapshotBeforeUpdate=me}break;case 3:var be=i.stateNode.containerInfo;be.nodeType===1?be.textContent="":be.nodeType===9&&be.documentElement&&be.removeChild(be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ge){fr(i,i.return,Ge)}if(s=i.sibling,s!==null){s.return=i.return,it=s;break}it=i.return}return lt=Ux,Ux=!1,lt}function Qi(s,i,d){var x=i.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var y=x=x.next;do{if((y.tag&s)===s){var _=y.destroy;y.destroy=void 0,_!==void 0&&k0(i,d,_)}y=y.next}while(y!==x)}}function jc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var d=i=i.next;do{if((d.tag&s)===s){var x=d.create;d.destroy=x()}d=d.next}while(d!==i)}}function b0(s){var i=s.ref;if(i!==null){var d=s.stateNode;switch(s.tag){case 5:s=d;break;default:s=d}typeof i=="function"?i(s):i.current=s}}function $x(s){var i=s.alternate;i!==null&&(s.alternate=null,$x(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[fa],delete i[Ii],delete i[Id],delete i[_k],delete i[Sk])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Hx(s){return s.tag===5||s.tag===3||s.tag===4}function Yx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Hx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.nodeType===8?d.parentNode.insertBefore(s,i):d.insertBefore(s,i):(d.nodeType===8?(i=d.parentNode,i.insertBefore(s,d)):(i=d,i.appendChild(s)),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=lc));else if(x!==4&&(s=s.child,s!==null))for(_0(s,i,d),s=s.sibling;s!==null;)_0(s,i,d),s=s.sibling}function S0(s,i,d){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?d.insertBefore(s,i):d.appendChild(s);else if(x!==4&&(s=s.child,s!==null))for(S0(s,i,d),s=s.sibling;s!==null;)S0(s,i,d),s=s.sibling}var Ir=null,Zn=!1;function xs(s,i,d){for(d=d.child;d!==null;)Vx(s,i,d),d=d.sibling}function Vx(s,i,d){if(jr&&typeof jr.onCommitFiberUnmount=="function")try{jr.onCommitFiberUnmount(da,d)}catch{}switch(d.tag){case 5:Kr||Ho(d,i);case 6:var x=Ir,y=Zn;Ir=null,xs(s,i,d),Ir=x,Zn=y,Ir!==null&&(Zn?(s=Ir,d=d.stateNode,s.nodeType===8?s.parentNode.removeChild(d):s.removeChild(d)):Ir.removeChild(d.stateNode));break;case 18:Ir!==null&&(Zn?(s=Ir,d=d.stateNode,s.nodeType===8?Md(s.parentNode,d):s.nodeType===1&&Md(s,d),Ci(s)):Md(Ir,d.stateNode));break;case 4:x=Ir,y=Zn,Ir=d.stateNode.containerInfo,Zn=!0,xs(s,i,d),Ir=x,Zn=y;break;case 0:case 11:case 14:case 15:if(!Kr&&(x=d.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){y=x=x.next;do{var _=y,M=_.destroy;_=_.tag,M!==void 0&&((_&2)!==0||(_&4)!==0)&&k0(d,i,M),y=y.next}while(y!==x)}xs(s,i,d);break;case 1:if(!Kr&&(Ho(d,i),x=d.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=d.memoizedProps,x.state=d.memoizedState,x.componentWillUnmount()}catch(ie){fr(d,i,ie)}xs(s,i,d);break;case 21:xs(s,i,d);break;case 22:d.mode&1?(Kr=(x=Kr)||d.memoizedState!==null,xs(s,i,d),Kr=x):xs(s,i,d);break;default:xs(s,i,d)}}function Kx(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var d=s.stateNode;d===null&&(d=s.stateNode=new Bk),i.forEach(function(x){var y=Xk.bind(null,s,x);d.has(x)||(d.add(x),x.then(y,y))})}}function Jn(s,i){var d=i.deletions;if(d!==null)for(var x=0;x<d.length;x++){var y=d[x];try{var _=s,M=i,ie=M;e:for(;ie!==null;){switch(ie.tag){case 5:Ir=ie.stateNode,Zn=!1;break e;case 3:Ir=ie.stateNode.containerInfo,Zn=!0;break e;case 4:Ir=ie.stateNode.containerInfo,Zn=!0;break e}ie=ie.return}if(Ir===null)throw Error(t(160));Vx(_,M,y),Ir=null,Zn=!1;var xe=y.alternate;xe!==null&&(xe.return=null),y.return=null}catch(Ce){fr(y,i,Ce)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Gx(i,s),i=i.sibling}function Gx(s,i){var d=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Jn(i,s),xa(s),x&4){try{Qi(3,s,s.return),jc(3,s)}catch(ct){fr(s,s.return,ct)}try{Qi(5,s,s.return)}catch(ct){fr(s,s.return,ct)}}break;case 1:Jn(i,s),xa(s),x&512&&d!==null&&Ho(d,d.return);break;case 5:if(Jn(i,s),xa(s),x&512&&d!==null&&Ho(d,d.return),s.flags&32){var y=s.stateNode;try{pt(y,"")}catch(ct){fr(s,s.return,ct)}}if(x&4&&(y=s.stateNode,y!=null)){var _=s.memoizedProps,M=d!==null?d.memoizedProps:_,ie=s.type,xe=s.updateQueue;if(s.updateQueue=null,xe!==null)try{ie==="input"&&_.type==="radio"&&_.name!=null&&qe(y,_),kt(ie,M);var Ce=kt(ie,_);for(M=0;M<xe.length;M+=2){var Le=xe[M],Ve=xe[M+1];Le==="style"?Bt(y,Ve):Le==="dangerouslySetInnerHTML"?Ht(y,Ve):Le==="children"?pt(y,Ve):C(y,Le,Ve,Ce)}switch(ie){case"input":pe(y,_);break;case"textarea":vt(y,_);break;case"select":var Ie=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!_.multiple;var ot=_.value;ot!=null?Qe(y,!!_.multiple,ot,!1):Ie!==!!_.multiple&&(_.defaultValue!=null?Qe(y,!!_.multiple,_.defaultValue,!0):Qe(y,!!_.multiple,_.multiple?[]:"",!1))}y[Ii]=_}catch(ct){fr(s,s.return,ct)}}break;case 6:if(Jn(i,s),xa(s),x&4){if(s.stateNode===null)throw Error(t(162));y=s.stateNode,_=s.memoizedProps;try{y.nodeValue=_}catch(ct){fr(s,s.return,ct)}}break;case 3:if(Jn(i,s),xa(s),x&4&&d!==null&&d.memoizedState.isDehydrated)try{Ci(i.containerInfo)}catch(ct){fr(s,s.return,ct)}break;case 4:Jn(i,s),xa(s);break;case 13:Jn(i,s),xa(s),y=s.child,y.flags&8192&&(_=y.memoizedState!==null,y.stateNode.isHidden=_,!_||y.alternate!==null&&y.alternate.memoizedState!==null||(C0=Ye())),x&4&&Kx(s);break;case 22:if(Le=d!==null&&d.memoizedState!==null,s.mode&1?(Kr=(Ce=Kr)||Le,Jn(i,s),Kr=Ce):Jn(i,s),xa(s),x&8192){if(Ce=s.memoizedState!==null,(s.stateNode.isHidden=Ce)&&!Le&&(s.mode&1)!==0)for(it=s,Le=s.child;Le!==null;){for(Ve=it=Le;it!==null;){switch(Ie=it,ot=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:Qi(4,Ie,Ie.return);break;case 1:Ho(Ie,Ie.return);var lt=Ie.stateNode;if(typeof lt.componentWillUnmount=="function"){x=Ie,d=Ie.return;try{i=x,lt.props=i.memoizedProps,lt.state=i.memoizedState,lt.componentWillUnmount()}catch(ct){fr(x,d,ct)}}break;case 5:Ho(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){qx(Ve);continue}}ot!==null?(ot.return=Ie,it=ot):qx(Ve)}Le=Le.sibling}e:for(Le=null,Ve=s;;){if(Ve.tag===5){if(Le===null){Le=Ve;try{y=Ve.stateNode,Ce?(_=y.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(ie=Ve.stateNode,xe=Ve.memoizedProps.style,M=xe!=null&&xe.hasOwnProperty("display")?xe.display:null,ie.style.display=Ft("display",M))}catch(ct){fr(s,s.return,ct)}}}else if(Ve.tag===6){if(Le===null)try{Ve.stateNode.nodeValue=Ce?"":Ve.memoizedProps}catch(ct){fr(s,s.return,ct)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===s)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===s)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===s)break e;Le===Ve&&(Le=null),Ve=Ve.return}Le===Ve&&(Le=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:Jn(i,s),xa(s),x&4&&Kx(s);break;case 21:break;default:Jn(i,s),xa(s)}}function xa(s){var i=s.flags;if(i&2){try{e:{for(var d=s.return;d!==null;){if(Hx(d)){var x=d;break e}d=d.return}throw Error(t(160))}switch(x.tag){case 5:var y=x.stateNode;x.flags&32&&(pt(y,""),x.flags&=-33);var _=Yx(s);S0(s,_,y);break;case 3:case 4:var M=x.stateNode.containerInfo,ie=Yx(s);_0(s,ie,M);break;default:throw Error(t(161))}}catch(xe){fr(s,s.return,xe)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Uk(s,i,d){it=s,Qx(s)}function Qx(s,i,d){for(var x=(s.mode&1)!==0;it!==null;){var y=it,_=y.child;if(y.tag===22&&x){var M=y.memoizedState!==null||Fc;if(!M){var ie=y.alternate,xe=ie!==null&&ie.memoizedState!==null||Kr;ie=Fc;var Ce=Kr;if(Fc=M,(Kr=xe)&&!Ce)for(it=y;it!==null;)M=it,xe=M.child,M.tag===22&&M.memoizedState!==null?Zx(y):xe!==null?(xe.return=M,it=xe):Zx(y);for(;_!==null;)it=_,Qx(_),_=_.sibling;it=y,Fc=ie,Kr=Ce}Xx(s)}else(y.subtreeFlags&8772)!==0&&_!==null?(_.return=y,it=_):Xx(s)}}function Xx(s){for(;it!==null;){var i=it;if((i.flags&8772)!==0){var d=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Kr||jc(5,i);break;case 1:var x=i.stateNode;if(i.flags&4&&!Kr)if(d===null)x.componentDidMount();else{var y=i.elementType===i.type?d.memoizedProps:qn(i.type,d.memoizedProps);x.componentDidUpdate(y,d.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var _=i.updateQueue;_!==null&&qh(i,_,x);break;case 3:var M=i.updateQueue;if(M!==null){if(d=null,i.child!==null)switch(i.child.tag){case 5:d=i.child.stateNode;break;case 1:d=i.child.stateNode}qh(i,M,d)}break;case 5:var ie=i.stateNode;if(d===null&&i.flags&4){d=ie;var xe=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":xe.autoFocus&&d.focus();break;case"img":xe.src&&(d.src=xe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Ce=i.alternate;if(Ce!==null){var Le=Ce.memoizedState;if(Le!==null){var Ve=Le.dehydrated;Ve!==null&&Ci(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kr||i.flags&512&&b0(i)}catch(Ie){fr(i,i.return,Ie)}}if(i===s){it=null;break}if(d=i.sibling,d!==null){d.return=i.return,it=d;break}it=i.return}}function qx(s){for(;it!==null;){var i=it;if(i===s){it=null;break}var d=i.sibling;if(d!==null){d.return=i.return,it=d;break}it=i.return}}function Zx(s){for(;it!==null;){var i=it;try{switch(i.tag){case 0:case 11:case 15:var d=i.return;try{jc(4,i)}catch(xe){fr(i,d,xe)}break;case 1:var x=i.stateNode;if(typeof x.componentDidMount=="function"){var y=i.return;try{x.componentDidMount()}catch(xe){fr(i,y,xe)}}var _=i.return;try{b0(i)}catch(xe){fr(i,_,xe)}break;case 5:var M=i.return;try{b0(i)}catch(xe){fr(i,M,xe)}}}catch(xe){fr(i,i.return,xe)}if(i===s){it=null;break}var ie=i.sibling;if(ie!==null){ie.return=i.return,it=ie;break}it=i.return}}var $k=Math.ceil,Pc=W.ReactCurrentDispatcher,E0=W.ReactCurrentOwner,On=W.ReactCurrentBatchConfig,zt=0,Ar=null,br=null,Lr=0,Sn=0,Yo=us(0),Cr=0,Xi=null,Ks=0,Ac=0,N0=0,qi=null,mn=null,C0=0,Vo=1/0,Ua=null,Oc=!1,T0=null,ms=null,Rc=!1,gs=null,zc=0,Zi=0,D0=null,Mc=-1,Ic=0;function rn(){return(zt&6)!==0?Ye():Mc!==-1?Mc:Mc=Ye()}function vs(s){return(s.mode&1)===0?1:(zt&2)!==0&&Lr!==0?Lr&-Lr:Nk.transition!==null?(Ic===0&&(Ic=Yp()),Ic):(s=Xt,s!==0||(s=window.event,s=s===void 0?16:eh(s.type)),s)}function ea(s,i,d,x){if(50<Zi)throw Zi=0,D0=null,Error(t(185));bi(s,d,x),((zt&2)===0||s!==Ar)&&(s===Ar&&((zt&2)===0&&(Ac|=d),Cr===4&&ys(s,Lr)),gn(s,x),d===1&&zt===0&&(i.mode&1)===0&&(Vo=Ye()+500,fc&&fs()))}function gn(s,i){var d=s.callbackNode;Nw(s,i);var x=Kl(s,s===Ar?Lr:0);if(x===0)d!==null&&Je(d),s.callbackNode=null,s.callbackPriority=0;else if(i=x&-x,s.callbackPriority!==i){if(d!=null&&Je(d),i===1)s.tag===0?Ek(em.bind(null,s)):Lh(em.bind(null,s)),kk(function(){(zt&6)===0&&fs()}),d=null;else{switch(Vp(x)){case 1:d=Qt;break;case 4:d=Vt;break;case 16:d=mr;break;case 536870912:d=rs;break;default:d=mr}d=lm(d,Jx.bind(null,s))}s.callbackPriority=i,s.callbackNode=d}}function Jx(s,i){if(Mc=-1,Ic=0,(zt&6)!==0)throw Error(t(327));var d=s.callbackNode;if(Ko()&&s.callbackNode!==d)return null;var x=Kl(s,s===Ar?Lr:0);if(x===0)return null;if((x&30)!==0||(x&s.expiredLanes)!==0||i)i=Lc(s,x);else{i=x;var y=zt;zt|=2;var _=rm();(Ar!==s||Lr!==i)&&(Ua=null,Vo=Ye()+500,Qs(s,i));do try{Vk();break}catch(ie){tm(s,ie)}while(!0);Kd(),Pc.current=_,zt=y,br!==null?i=0:(Ar=null,Lr=0,i=Cr)}if(i!==0){if(i===2&&(y=cd(s),y!==0&&(x=y,i=F0(s,y))),i===1)throw d=Xi,Qs(s,0),ys(s,x),gn(s,Ye()),d;if(i===6)ys(s,x);else{if(y=s.current.alternate,(x&30)===0&&!Hk(y)&&(i=Lc(s,x),i===2&&(_=cd(s),_!==0&&(x=_,i=F0(s,_))),i===1))throw d=Xi,Qs(s,0),ys(s,x),gn(s,Ye()),d;switch(s.finishedWork=y,s.finishedLanes=x,i){case 0:case 1:throw Error(t(345));case 2:Xs(s,mn,Ua);break;case 3:if(ys(s,x),(x&130023424)===x&&(i=C0+500-Ye(),10<i)){if(Kl(s,0)!==0)break;if(y=s.suspendedLanes,(y&x)!==x){rn(),s.pingedLanes|=s.suspendedLanes&y;break}s.timeoutHandle=zd(Xs.bind(null,s,mn,Ua),i);break}Xs(s,mn,Ua);break;case 4:if(ys(s,x),(x&4194240)===x)break;for(i=s.eventTimes,y=-1;0<x;){var M=31-gr(x);_=1<<M,M=i[M],M>y&&(y=M),x&=~_}if(x=y,x=Ye()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*$k(x/1960))-x,10<x){s.timeoutHandle=zd(Xs.bind(null,s,mn,Ua),x);break}Xs(s,mn,Ua);break;case 5:Xs(s,mn,Ua);break;default:throw Error(t(329))}}}return gn(s,Ye()),s.callbackNode===d?Jx.bind(null,s):null}function F0(s,i){var d=qi;return s.current.memoizedState.isDehydrated&&(Qs(s,i).flags|=256),s=Lc(s,i),s!==2&&(i=mn,mn=d,i!==null&&j0(i)),s}function j0(s){mn===null?mn=s:mn.push.apply(mn,s)}function Hk(s){for(var i=s;;){if(i.flags&16384){var d=i.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var x=0;x<d.length;x++){var y=d[x],_=y.getSnapshot;y=y.value;try{if(!Qn(_(),y))return!1}catch{return!1}}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ys(s,i){for(i&=~N0,i&=~Ac,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var d=31-gr(i),x=1<<d;s[d]=-1,i&=~x}}function em(s){if((zt&6)!==0)throw Error(t(327));Ko();var i=Kl(s,0);if((i&1)===0)return gn(s,Ye()),null;var d=Lc(s,i);if(s.tag!==0&&d===2){var x=cd(s);x!==0&&(i=x,d=F0(s,x))}if(d===1)throw d=Xi,Qs(s,0),ys(s,i),gn(s,Ye()),d;if(d===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Xs(s,mn,Ua),gn(s,Ye()),null}function P0(s,i){var d=zt;zt|=1;try{return s(i)}finally{zt=d,zt===0&&(Vo=Ye()+500,fc&&fs())}}function Gs(s){gs!==null&&gs.tag===0&&(zt&6)===0&&Ko();var i=zt;zt|=1;var d=On.transition,x=Xt;try{if(On.transition=null,Xt=1,s)return s()}finally{Xt=x,On.transition=d,zt=i,(zt&6)===0&&fs()}}function A0(){Sn=Yo.current,nr(Yo)}function Qs(s,i){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;if(d!==-1&&(s.timeoutHandle=-1,wk(d)),br!==null)for(d=br.return;d!==null;){var x=d;switch(Ud(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&uc();break;case 3:Uo(),nr(pn),nr(Hr),t0();break;case 5:Jd(x);break;case 4:Uo();break;case 13:nr(cr);break;case 19:nr(cr);break;case 10:Gd(x.type._context);break;case 22:case 23:A0()}d=d.return}if(Ar=s,br=s=ws(s.current,null),Lr=Sn=i,Cr=0,Xi=null,N0=Ac=Ks=0,mn=qi=null,Hs!==null){for(i=0;i<Hs.length;i++)if(d=Hs[i],x=d.interleaved,x!==null){d.interleaved=null;var y=x.next,_=d.pending;if(_!==null){var M=_.next;_.next=y,x.next=M}d.pending=x}Hs=null}return s}function tm(s,i){do{var d=br;try{if(Kd(),bc.current=Nc,_c){for(var x=ur.memoizedState;x!==null;){var y=x.queue;y!==null&&(y.pending=null),x=x.next}_c=!1}if(Vs=0,Pr=Nr=ur=null,Hi=!1,Yi=0,E0.current=null,d===null||d.return===null){Cr=1,Xi=i,br=null;break}e:{var _=s,M=d.return,ie=d,xe=i;if(i=Lr,ie.flags|=32768,xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var Ce=xe,Le=ie,Ve=Le.tag;if((Le.mode&1)===0&&(Ve===0||Ve===11||Ve===15)){var Ie=Le.alternate;Ie?(Le.updateQueue=Ie.updateQueue,Le.memoizedState=Ie.memoizedState,Le.lanes=Ie.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var ot=Nx(M);if(ot!==null){ot.flags&=-257,Cx(ot,M,ie,_,i),ot.mode&1&&Ex(_,Ce,i),i=ot,xe=Ce;var lt=i.updateQueue;if(lt===null){var ct=new Set;ct.add(xe),i.updateQueue=ct}else lt.add(xe);break e}else{if((i&1)===0){Ex(_,Ce,i),O0();break e}xe=Error(t(426))}}else if(or&&ie.mode&1){var vr=Nx(M);if(vr!==null){(vr.flags&65536)===0&&(vr.flags|=256),Cx(vr,M,ie,_,i),Yd($o(xe,ie));break e}}_=xe=$o(xe,ie),Cr!==4&&(Cr=2),qi===null?qi=[_]:qi.push(_),_=M;do{switch(_.tag){case 3:_.flags|=65536,i&=-i,_.lanes|=i;var ye=_x(_,xe,i);Xh(_,ye);break e;case 1:ie=xe;var me=_.type,be=_.stateNode;if((_.flags&128)===0&&(typeof me.getDerivedStateFromError=="function"||be!==null&&typeof be.componentDidCatch=="function"&&(ms===null||!ms.has(be)))){_.flags|=65536,i&=-i,_.lanes|=i;var Ge=Sx(_,ie,i);Xh(_,Ge);break e}}_=_.return}while(_!==null)}am(d)}catch(ut){i=ut,br===d&&d!==null&&(br=d=d.return);continue}break}while(!0)}function rm(){var s=Pc.current;return Pc.current=Nc,s===null?Nc:s}function O0(){(Cr===0||Cr===3||Cr===2)&&(Cr=4),Ar===null||(Ks&268435455)===0&&(Ac&268435455)===0||ys(Ar,Lr)}function Lc(s,i){var d=zt;zt|=2;var x=rm();(Ar!==s||Lr!==i)&&(Ua=null,Qs(s,i));do try{Yk();break}catch(y){tm(s,y)}while(!0);if(Kd(),zt=d,Pc.current=x,br!==null)throw Error(t(261));return Ar=null,Lr=0,Cr}function Yk(){for(;br!==null;)nm(br)}function Vk(){for(;br!==null&&!We();)nm(br)}function nm(s){var i=im(s.alternate,s,Sn);s.memoizedProps=s.pendingProps,i===null?am(s):br=i,E0.current=null}function am(s){var i=s;do{var d=i.alternate;if(s=i.return,(i.flags&32768)===0){if(d=Ik(d,i,Sn),d!==null){br=d;return}}else{if(d=Lk(d,i),d!==null){d.flags&=32767,br=d;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Cr=6,br=null;return}}if(i=i.sibling,i!==null){br=i;return}br=i=s}while(i!==null);Cr===0&&(Cr=5)}function Xs(s,i,d){var x=Xt,y=On.transition;try{On.transition=null,Xt=1,Kk(s,i,d,x)}finally{On.transition=y,Xt=x}return null}function Kk(s,i,d,x){do Ko();while(gs!==null);if((zt&6)!==0)throw Error(t(327));d=s.finishedWork;var y=s.finishedLanes;if(d===null)return null;if(s.finishedWork=null,s.finishedLanes=0,d===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var _=d.lanes|d.childLanes;if(Cw(s,_),s===Ar&&(br=Ar=null,Lr=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Rc||(Rc=!0,lm(mr,function(){return Ko(),null})),_=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||_){_=On.transition,On.transition=null;var M=Xt;Xt=1;var ie=zt;zt|=4,E0.current=null,Wk(s,d),Gx(d,s),pk(Od),Xl=!!Ad,Od=Ad=null,s.current=d,Uk(d),Ue(),zt=ie,Xt=M,On.transition=_}else s.current=d;if(Rc&&(Rc=!1,gs=s,zc=y),_=s.pendingLanes,_===0&&(ms=null),wi(d.stateNode),gn(s,Ye()),i!==null)for(x=s.onRecoverableError,d=0;d<i.length;d++)y=i[d],x(y.value,{componentStack:y.stack,digest:y.digest});if(Oc)throw Oc=!1,s=T0,T0=null,s;return(zc&1)!==0&&s.tag!==0&&Ko(),_=s.pendingLanes,(_&1)!==0?s===D0?Zi++:(Zi=0,D0=s):Zi=0,fs(),null}function Ko(){if(gs!==null){var s=Vp(zc),i=On.transition,d=Xt;try{if(On.transition=null,Xt=16>s?16:s,gs===null)var x=!1;else{if(s=gs,gs=null,zc=0,(zt&6)!==0)throw Error(t(331));var y=zt;for(zt|=4,it=s.current;it!==null;){var _=it,M=_.child;if((it.flags&16)!==0){var ie=_.deletions;if(ie!==null){for(var xe=0;xe<ie.length;xe++){var Ce=ie[xe];for(it=Ce;it!==null;){var Le=it;switch(Le.tag){case 0:case 11:case 15:Qi(8,Le,_)}var Ve=Le.child;if(Ve!==null)Ve.return=Le,it=Ve;else for(;it!==null;){Le=it;var Ie=Le.sibling,ot=Le.return;if($x(Le),Le===Ce){it=null;break}if(Ie!==null){Ie.return=ot,it=Ie;break}it=ot}}}var lt=_.alternate;if(lt!==null){var ct=lt.child;if(ct!==null){lt.child=null;do{var vr=ct.sibling;ct.sibling=null,ct=vr}while(ct!==null)}}it=_}}if((_.subtreeFlags&2064)!==0&&M!==null)M.return=_,it=M;else e:for(;it!==null;){if(_=it,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Qi(9,_,_.return)}var ye=_.sibling;if(ye!==null){ye.return=_.return,it=ye;break e}it=_.return}}var me=s.current;for(it=me;it!==null;){M=it;var be=M.child;if((M.subtreeFlags&2064)!==0&&be!==null)be.return=M,it=be;else e:for(M=me;it!==null;){if(ie=it,(ie.flags&2048)!==0)try{switch(ie.tag){case 0:case 11:case 15:jc(9,ie)}}catch(ut){fr(ie,ie.return,ut)}if(ie===M){it=null;break e}var Ge=ie.sibling;if(Ge!==null){Ge.return=ie.return,it=Ge;break e}it=ie.return}}if(zt=y,fs(),jr&&typeof jr.onPostCommitFiberRoot=="function")try{jr.onPostCommitFiberRoot(da,s)}catch{}x=!0}return x}finally{Xt=d,On.transition=i}}return!1}function sm(s,i,d){i=$o(d,i),i=_x(s,i,1),s=hs(s,i,1),i=rn(),s!==null&&(bi(s,1,i),gn(s,i))}function fr(s,i,d){if(s.tag===3)sm(s,s,d);else for(;i!==null;){if(i.tag===3){sm(i,s,d);break}else if(i.tag===1){var x=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(ms===null||!ms.has(x))){s=$o(d,s),s=Sx(i,s,1),i=hs(i,s,1),s=rn(),i!==null&&(bi(i,1,s),gn(i,s));break}}i=i.return}}function Gk(s,i,d){var x=s.pingCache;x!==null&&x.delete(i),i=rn(),s.pingedLanes|=s.suspendedLanes&d,Ar===s&&(Lr&d)===d&&(Cr===4||Cr===3&&(Lr&130023424)===Lr&&500>Ye()-C0?Qs(s,0):N0|=d),gn(s,i)}function om(s,i){i===0&&((s.mode&1)===0?i=1:(i=Vl,Vl<<=1,(Vl&130023424)===0&&(Vl=4194304)));var d=rn();s=La(s,i),s!==null&&(bi(s,i,d),gn(s,d))}function Qk(s){var i=s.memoizedState,d=0;i!==null&&(d=i.retryLane),om(s,d)}function Xk(s,i){var d=0;switch(s.tag){case 13:var x=s.stateNode,y=s.memoizedState;y!==null&&(d=y.retryLane);break;case 19:x=s.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(i),om(s,d)}var im;im=function(s,i,d){if(s!==null)if(s.memoizedProps!==i.pendingProps||pn.current)xn=!0;else{if((s.lanes&d)===0&&(i.flags&128)===0)return xn=!1,Mk(s,i,d);xn=(s.flags&131072)!==0}else xn=!1,or&&(i.flags&1048576)!==0&&Bh(i,hc,i.index);switch(i.lanes=0,i.tag){case 2:var x=i.type;Dc(s,i),s=i.pendingProps;var y=Ro(i,Hr.current);Wo(i,d),y=a0(null,i,x,s,y,d);var _=s0();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,hn(x)?(_=!0,dc(i)):_=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,qd(i),y.updater=Cc,i.stateNode=y,y._reactInternals=i,d0(i,x,s,d),i=x0(null,i,x,!0,_,d)):(i.tag=0,or&&_&&Wd(i),tn(null,i,y,d),i=i.child),i;case 16:x=i.elementType;e:{switch(Dc(s,i),s=i.pendingProps,y=x._init,x=y(x._payload),i.type=x,y=i.tag=Zk(x),s=qn(x,s),y){case 0:i=h0(null,i,x,s,d);break e;case 1:i=Ax(null,i,x,s,d);break e;case 11:i=Tx(null,i,x,s,d);break e;case 14:i=Dx(null,i,x,qn(x.type,s),d);break e}throw Error(t(306,x,""))}return i;case 0:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),h0(s,i,x,y,d);case 1:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),Ax(s,i,x,y,d);case 3:e:{if(Ox(i),s===null)throw Error(t(387));x=i.pendingProps,_=i.memoizedState,y=_.element,Qh(s,i),wc(i,x,null,d);var M=i.memoizedState;if(x=M.element,_.isDehydrated)if(_={element:x,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},i.updateQueue.baseState=_,i.memoizedState=_,i.flags&256){y=$o(Error(t(423)),i),i=Rx(s,i,x,d,y);break e}else if(x!==y){y=$o(Error(t(424)),i),i=Rx(s,i,x,d,y);break e}else for(_n=cs(i.stateNode.containerInfo.firstChild),bn=i,or=!0,Xn=null,d=Kh(i,null,x,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Io(),x===y){i=Wa(s,i,d);break e}tn(s,i,x,d)}i=i.child}return i;case 5:return Zh(i),s===null&&Hd(i),x=i.type,y=i.pendingProps,_=s!==null?s.memoizedProps:null,M=y.children,Rd(x,y)?M=null:_!==null&&Rd(x,_)&&(i.flags|=32),Px(s,i),tn(s,i,M,d),i.child;case 6:return s===null&&Hd(i),null;case 13:return zx(s,i,d);case 4:return Zd(i,i.stateNode.containerInfo),x=i.pendingProps,s===null?i.child=Lo(i,null,x,d):tn(s,i,x,d),i.child;case 11:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),Tx(s,i,x,y,d);case 7:return tn(s,i,i.pendingProps,d),i.child;case 8:return tn(s,i,i.pendingProps.children,d),i.child;case 12:return tn(s,i,i.pendingProps.children,d),i.child;case 10:e:{if(x=i.type._context,y=i.pendingProps,_=i.memoizedProps,M=y.value,Jt(gc,x._currentValue),x._currentValue=M,_!==null)if(Qn(_.value,M)){if(_.children===y.children&&!pn.current){i=Wa(s,i,d);break e}}else for(_=i.child,_!==null&&(_.return=i);_!==null;){var ie=_.dependencies;if(ie!==null){M=_.child;for(var xe=ie.firstContext;xe!==null;){if(xe.context===x){if(_.tag===1){xe=Ba(-1,d&-d),xe.tag=2;var Ce=_.updateQueue;if(Ce!==null){Ce=Ce.shared;var Le=Ce.pending;Le===null?xe.next=xe:(xe.next=Le.next,Le.next=xe),Ce.pending=xe}}_.lanes|=d,xe=_.alternate,xe!==null&&(xe.lanes|=d),Qd(_.return,d,i),ie.lanes|=d;break}xe=xe.next}}else if(_.tag===10)M=_.type===i.type?null:_.child;else if(_.tag===18){if(M=_.return,M===null)throw Error(t(341));M.lanes|=d,ie=M.alternate,ie!==null&&(ie.lanes|=d),Qd(M,d,i),M=_.sibling}else M=_.child;if(M!==null)M.return=_;else for(M=_;M!==null;){if(M===i){M=null;break}if(_=M.sibling,_!==null){_.return=M.return,M=_;break}M=M.return}_=M}tn(s,i,y.children,d),i=i.child}return i;case 9:return y=i.type,x=i.pendingProps.children,Wo(i,d),y=Pn(y),x=x(y),i.flags|=1,tn(s,i,x,d),i.child;case 14:return x=i.type,y=qn(x,i.pendingProps),y=qn(x.type,y),Dx(s,i,x,y,d);case 15:return Fx(s,i,i.type,i.pendingProps,d);case 17:return x=i.type,y=i.pendingProps,y=i.elementType===x?y:qn(x,y),Dc(s,i),i.tag=1,hn(x)?(s=!0,dc(i)):s=!1,Wo(i,d),kx(i,x,y),d0(i,x,y,d),x0(null,i,x,!0,s,d);case 19:return Ix(s,i,d);case 22:return jx(s,i,d)}throw Error(t(156,i.tag))};function lm(s,i){return Be(s,i)}function qk(s,i,d,x){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(s,i,d,x){return new qk(s,i,d,x)}function R0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zk(s){if(typeof s=="function")return R0(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Y)return 11;if(s===oe)return 14}return 2}function ws(s,i){var d=s.alternate;return d===null?(d=Rn(s.tag,i,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=i,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&14680064,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,i=s.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d}function Bc(s,i,d,x,y,_){var M=2;if(x=s,typeof s=="function")R0(s)&&(M=1);else if(typeof s=="string")M=5;else e:switch(s){case P:return qs(d.children,y,_,i);case U:M=8,y|=8;break;case B:return s=Rn(12,d,i,y|2),s.elementType=B,s.lanes=_,s;case fe:return s=Rn(13,d,i,y),s.elementType=fe,s.lanes=_,s;case de:return s=Rn(19,d,i,y),s.elementType=de,s.lanes=_,s;case X:return Wc(d,y,_,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ne:M=10;break e;case ee:M=9;break e;case Y:M=11;break e;case oe:M=14;break e;case he:M=16,x=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Rn(M,d,i,y),i.elementType=s,i.type=x,i.lanes=_,i}function qs(s,i,d,x){return s=Rn(7,s,x,i),s.lanes=d,s}function Wc(s,i,d,x){return s=Rn(22,s,x,i),s.elementType=X,s.lanes=d,s.stateNode={isHidden:!1},s}function z0(s,i,d){return s=Rn(6,s,null,i),s.lanes=d,s}function M0(s,i,d){return i=Rn(4,s.children!==null?s.children:[],s.key,i),i.lanes=d,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function Jk(s,i,d,x,y){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ud(0),this.expirationTimes=ud(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ud(0),this.identifierPrefix=x,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function I0(s,i,d,x,y,_,M,ie,xe){return s=new Jk(s,i,d,ie,xe),i===1?(i=1,_===!0&&(i|=8)):i=0,_=Rn(3,null,null,i),s.current=_,_.stateNode=s,_.memoizedState={element:x,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},qd(_),s}function eb(s,i,d){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:V,key:x==null?null:""+x,children:s,containerInfo:i,implementation:d}}function cm(s){if(!s)return ds;s=s._reactInternals;e:{if(re(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(hn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var d=s.type;if(hn(d))return Mh(s,d,i)}return i}function um(s,i,d,x,y,_,M,ie,xe){return s=I0(d,x,!0,s,y,_,M,ie,xe),s.context=cm(null),d=s.current,x=rn(),y=vs(d),_=Ba(x,y),_.callback=i??null,hs(d,_,y),s.current.lanes=y,bi(s,y,x),gn(s,x),s}function Uc(s,i,d,x){var y=i.current,_=rn(),M=vs(y);return d=cm(d),i.context===null?i.context=d:i.pendingContext=d,i=Ba(_,M),i.payload={element:s},x=x===void 0?null:x,x!==null&&(i.callback=x),s=hs(y,i,M),s!==null&&(ea(s,y,M,_),yc(s,y,M)),M}function $c(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function dm(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<i?d:i}}function L0(s,i){dm(s,i),(s=s.alternate)&&dm(s,i)}function tb(){return null}var fm=typeof reportError=="function"?reportError:function(s){console.error(s)};function B0(s){this._internalRoot=s}Hc.prototype.render=B0.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));Uc(s,i,null,null)},Hc.prototype.unmount=B0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Gs(function(){Uc(null,s,null,null)}),i[Ra]=null}};function Hc(s){this._internalRoot=s}Hc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Qp();s={blockedOn:null,target:s,priority:i};for(var d=0;d<os.length&&i!==0&&i<os[d].priority;d++);os.splice(d,0,s),d===0&&Zp(s)}};function W0(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Yc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pm(){}function rb(s,i,d,x,y){if(y){if(typeof x=="function"){var _=x;x=function(){var Ce=$c(M);_.call(Ce)}}var M=um(i,x,s,0,null,!1,!1,"",pm);return s._reactRootContainer=M,s[Ra]=M.current,zi(s.nodeType===8?s.parentNode:s),Gs(),M}for(;y=s.lastChild;)s.removeChild(y);if(typeof x=="function"){var ie=x;x=function(){var Ce=$c(xe);ie.call(Ce)}}var xe=I0(s,0,!1,null,null,!1,!1,"",pm);return s._reactRootContainer=xe,s[Ra]=xe.current,zi(s.nodeType===8?s.parentNode:s),Gs(function(){Uc(i,xe,d,x)}),xe}function Vc(s,i,d,x,y){var _=d._reactRootContainer;if(_){var M=_;if(typeof y=="function"){var ie=y;y=function(){var xe=$c(M);ie.call(xe)}}Uc(i,M,s,y)}else M=rb(d,i,s,y,x);return $c(M)}Kp=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var d=ki(i.pendingLanes);d!==0&&(dd(i,d|1),gn(i,Ye()),(zt&6)===0&&(Vo=Ye()+500,fs()))}break;case 13:Gs(function(){var x=La(s,1);if(x!==null){var y=rn();ea(x,s,1,y)}}),L0(s,1)}},fd=function(s){if(s.tag===13){var i=La(s,134217728);if(i!==null){var d=rn();ea(i,s,134217728,d)}L0(s,134217728)}},Gp=function(s){if(s.tag===13){var i=vs(s),d=La(s,i);if(d!==null){var x=rn();ea(d,s,i,x)}L0(s,i)}},Qp=function(){return Xt},Xp=function(s,i){var d=Xt;try{return Xt=s,i()}finally{Xt=d}},ze=function(s,i,d){switch(i){case"input":if(pe(s,d),i=d.name,d.type==="radio"&&i!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<d.length;i++){var x=d[i];if(x!==s&&x.form===s.form){var y=cc(x);if(!y)throw Error(t(90));I(x),pe(x,y)}}}break;case"textarea":vt(s,d);break;case"select":i=d.value,i!=null&&Qe(s,!!d.multiple,i,!1)}},Re=P0,$e=Gs;var nb={usingClientEntryPoint:!1,Events:[Li,Ao,cc,ge,De,P0]},Ji={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ab={bundleType:Ji.bundleType,version:Ji.version,rendererPackageName:Ji.rendererPackageName,rendererConfig:Ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:W.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Se(s),s===null?null:s.stateNode},findFiberByHostInstance:Ji.findFiberByHostInstance||tb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kc.isDisabled&&Kc.supportsFiber)try{da=Kc.inject(ab),jr=Kc}catch{}}return vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nb,vn.createPortal=function(s,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W0(i))throw Error(t(200));return eb(s,i,null,d)},vn.createRoot=function(s,i){if(!W0(s))throw Error(t(299));var d=!1,x="",y=fm;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(x=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=I0(s,1,!1,null,null,d,!1,x,y),s[Ra]=i.current,zi(s.nodeType===8?s.parentNode:s),new B0(i)},vn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Se(i),s=s===null?null:s.stateNode,s},vn.flushSync=function(s){return Gs(s)},vn.hydrate=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!0,d)},vn.hydrateRoot=function(s,i,d){if(!W0(s))throw Error(t(405));var x=d!=null&&d.hydratedSources||null,y=!1,_="",M=fm;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onRecoverableError!==void 0&&(M=d.onRecoverableError)),i=um(i,null,s,1,d??null,y,!1,_,M),s[Ra]=i.current,zi(s),x)for(s=0;s<x.length;s++)d=x[s],y=d._getVersion,y=y(d._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[d,y]:i.mutableSourceEagerHydrationData.push(d,y);return new Hc(i)},vn.render=function(s,i,d){if(!Yc(i))throw Error(t(200));return Vc(null,s,i,!1,d)},vn.unmountComponentAtNode=function(s){if(!Yc(s))throw Error(t(40));return s._reactRootContainer?(Gs(function(){Vc(null,null,s,!1,function(){s._reactRootContainer=null,s[Ra]=null})}),!0):!1},vn.unstable_batchedUpdates=P0,vn.unstable_renderSubtreeIntoContainer=function(s,i,d,x){if(!Yc(d))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Vc(s,i,d,!1,x)},vn.version="18.3.1-next-f1338f8080-20240426",vn}var km;function qf(){if(km)return H0.exports;km=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),H0.exports=pb(),H0.exports}var bm;function hb(){if(bm)return Gc;bm=1;var e=qf();return Gc.createRoot=e.createRoot,Gc.hydrateRoot=e.hydrateRoot,Gc}var xb=hb();/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Dn=(e,n)=>{const t=N.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:f,...h},p)=>N.createElement("svg",{ref:p,...mb,width:a,height:a,stroke:r,strokeWidth:l?Number(o)*24/Number(a):o,className:["lucide",`lucide-${gb(e)}`,c].join(" "),...h},[...n.map(([m,g])=>N.createElement(m,g)),...Array.isArray(f)?f:[f]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Dn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=Dn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Dn("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=Dn("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=Dn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=Dn("Grape",[["path",{d:"M22 5V2l-5.89 5.89",key:"1eenpo"}],["circle",{cx:"16.6",cy:"15.89",r:"3",key:"xjtalx"}],["circle",{cx:"8.11",cy:"7.4",r:"3",key:"u2fv6i"}],["circle",{cx:"12.35",cy:"11.65",r:"3",key:"i6i8g7"}],["circle",{cx:"13.91",cy:"5.85",r:"3",key:"6ye0dv"}],["circle",{cx:"18.15",cy:"10.09",r:"3",key:"snx9no"}],["circle",{cx:"6.56",cy:"13.2",r:"3",key:"17x4xg"}],["circle",{cx:"10.8",cy:"17.44",r:"3",key:"1hogw9"}],["circle",{cx:"5",cy:"19",r:"3",key:"1sn6vo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Dn("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Dn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=Dn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=Dn("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Dn("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=Dn("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Dn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Qc={exports:{}},bs={},K0={exports:{}},G0,_m;function _b(){if(_m)return G0;_m=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return G0=e,G0}var Q0,Sm;function Sb(){if(Sm)return Q0;Sm=1;var e=_b();function n(){}function t(){}return t.resetWarningCache=n,Q0=function(){function r(l,c,f,h,p,m){if(m!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function a(){return r}var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:n};return o.PropTypes=o,o},Q0}var Em;function Iv(){return Em||(Em=1,K0.exports=Sb()()),K0.exports}var Xc={exports:{}},zn={},qc={exports:{}},Nm;function Lv(){return Nm||(Nm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=p;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var t="none",r="contents",a=/^(input|select|textarea|button|object|iframe)$/;function o(m,g){return g.getPropertyValue("overflow")!=="visible"||m.scrollWidth<=0&&m.scrollHeight<=0}function l(m){var g=m.offsetWidth<=0&&m.offsetHeight<=0;if(g&&!m.innerHTML)return!0;try{var v=window.getComputedStyle(m),w=v.getPropertyValue("display");return g?w!==r&&o(m,v):w===t}catch{return console.warn("Failed to inspect element style"),!1}}function c(m){for(var g=m,v=m.getRootNode&&m.getRootNode();g&&g!==document.body;){if(v&&g===v&&(g=v.host.parentNode),l(g))return!1;g=g.parentNode}return!0}function f(m,g){var v=m.nodeName.toLowerCase(),w=a.test(v)&&!m.disabled||v==="a"&&m.href||g;return w&&c(m)}function h(m){var g=m.getAttribute("tabindex");g===null&&(g=void 0);var v=isNaN(g);return(v||g>=0)&&f(m,!v)}function p(m){var g=[].slice.call(m.querySelectorAll("*"),0).reduce(function(v,w){return v.concat(w.shadowRoot?p(w.shadowRoot):[w])},[]);return g.filter(h)}e.exports=n.default})(qc,qc.exports)),qc.exports}var Cm;function Eb(){if(Cm)return zn;Cm=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.resetState=l,zn.log=c,zn.handleBlur=f,zn.handleFocus=h,zn.markForFocusLater=p,zn.returnFocus=m,zn.popWithoutFocus=g,zn.setupScopedFocus=v,zn.teardownScopedFocus=w;var e=Lv(),n=t(e);function t(b){return b&&b.__esModule?b:{default:b}}var r=[],a=null,o=!1;function l(){r=[]}function c(){}function f(){o=!0}function h(){if(o){if(o=!1,!a)return;setTimeout(function(){if(!a.contains(document.activeElement)){var b=(0,n.default)(a)[0]||a;b.focus()}},0)}}function p(){r.push(document.activeElement)}function m(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=null;try{r.length!==0&&(k=r.pop(),k.focus({preventScroll:b}));return}catch{console.warn(["You tried to return focus to",k,"but it is not in the DOM anymore"].join(" "))}}function g(){r.length>0&&r.pop()}function v(b){a=b,window.addEventListener?(window.addEventListener("blur",f,!1),document.addEventListener("focus",h,!0)):(window.attachEvent("onBlur",f),document.attachEvent("onFocus",h))}function w(){a=null,window.addEventListener?(window.removeEventListener("blur",f),document.removeEventListener("focus",h)):(window.detachEvent("onBlur",f),document.detachEvent("onFocus",h))}return zn}var Zc={exports:{}},Tm;function Nb(){return Tm||(Tm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var t=Lv(),r=a(t);function a(c){return c&&c.__esModule?c:{default:c}}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?o(c.activeElement.shadowRoot):c.activeElement}function l(c,f){var h=(0,r.default)(c);if(!h.length){f.preventDefault();return}var p=void 0,m=f.shiftKey,g=h[0],v=h[h.length-1],w=o();if(c===w){if(!m)return;p=v}if(v===w&&!m&&(p=g),g===w&&m&&(p=v),p){f.preventDefault(),p.focus();return}var b=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),k=b!=null&&b[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(k){var T=h.indexOf(w);if(T>-1&&(T+=m?-1:1),p=h[T],typeof p>"u"){f.preventDefault(),p=m?v:g,p.focus();return}f.preventDefault(),p.focus()}}e.exports=n.default})(Zc,Zc.exports)),Zc.exports}var ta={},X0,Dm;function Cb(){if(Dm)return X0;Dm=1;var e=function(){};return X0=e,X0}var ma={},q0={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var Fm;function Tb(){return Fm||(Fm=1,(function(e){(function(){var n=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen};e.exports?e.exports=t:window.ExecutionEnvironment=t})()})(q0)),q0.exports}var jm;function rp(){if(jm)return ma;jm=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.canUseDOM=ma.SafeNodeList=ma.SafeHTMLCollection=void 0;var e=Tb(),n=t(e);function t(o){return o&&o.__esModule?o:{default:o}}var r=n.default,a=r.canUseDOM?window.HTMLElement:{};return ma.SafeHTMLCollection=r.canUseDOM?window.HTMLCollection:{},ma.SafeNodeList=r.canUseDOM?window.NodeList:{},ma.canUseDOM=r.canUseDOM,ma.default=a,ma}var Pm;function Bv(){if(Pm)return ta;Pm=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.resetState=o,ta.log=l,ta.assertNodeList=c,ta.setElement=f,ta.validateElement=h,ta.hide=p,ta.show=m,ta.documentNotReadyOrSSRTesting=g;var e=Cb(),n=r(e),t=rp();function r(v){return v&&v.__esModule?v:{default:v}}var a=null;function o(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):a.length!=null?a.forEach(function(v){return v.removeAttribute("aria-hidden")}):document.querySelectorAll(a).forEach(function(v){return v.removeAttribute("aria-hidden")})),a=null}function l(){}function c(v,w){if(!v||!v.length)throw new Error("react-modal: No elements were found for selector "+w+".")}function f(v){var w=v;if(typeof w=="string"&&t.canUseDOM){var b=document.querySelectorAll(w);c(b,w),w=b}return a=w||a,a}function h(v){var w=v||a;return w?Array.isArray(w)||w instanceof HTMLCollection||w instanceof NodeList?w:[w]:((0,n.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function p(v){var w=!0,b=!1,k=void 0;try{for(var T=h(v)[Symbol.iterator](),j;!(w=(j=T.next()).done);w=!0){var C=j.value;C.setAttribute("aria-hidden","true")}}catch(W){b=!0,k=W}finally{try{!w&&T.return&&T.return()}finally{if(b)throw k}}}function m(v){var w=!0,b=!1,k=void 0;try{for(var T=h(v)[Symbol.iterator](),j;!(w=(j=T.next()).done);w=!0){var C=j.value;C.removeAttribute("aria-hidden")}}catch(W){b=!0,k=W}finally{try{!w&&T.return&&T.return()}finally{if(b)throw k}}}function g(){a=null}return ta}var Zs={},Am;function Db(){if(Am)return Zs;Am=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.resetState=r,Zs.log=a;var e={},n={};function t(h,p){h.classList.remove(p)}function r(){var h=document.getElementsByTagName("html")[0];for(var p in e)t(h,e[p]);var m=document.body;for(var g in n)t(m,n[g]);e={},n={}}function a(){}var o=function(p,m){return p[m]||(p[m]=0),p[m]+=1,m},l=function(p,m){return p[m]&&(p[m]-=1),m},c=function(p,m,g){g.forEach(function(v){o(m,v),p.add(v)})},f=function(p,m,g){g.forEach(function(v){l(m,v),m[v]===0&&p.remove(v)})};return Zs.add=function(p,m){return c(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs.remove=function(p,m){return f(p.classList,p.nodeName.toLowerCase()=="html"?e:n,m.split(" "))},Zs}var Go={},Om;function Wv(){if(Om)return Go;Om=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.log=r,Go.resetState=a;function e(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var n=function o(){var l=this;e(this,o),this.register=function(c){l.openInstances.indexOf(c)===-1&&(l.openInstances.push(c),l.emit("register"))},this.deregister=function(c){var f=l.openInstances.indexOf(c);f!==-1&&(l.openInstances.splice(f,1),l.emit("deregister"))},this.subscribe=function(c){l.subscribers.push(c)},this.emit=function(c){l.subscribers.forEach(function(f){return f(c,l.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},t=new n;function r(){console.log("portalOpenInstances ----------"),console.log(t.openInstances.length),t.openInstances.forEach(function(o){return console.log(o)}),console.log("end portalOpenInstances ----------")}function a(){t=new n}return Go.default=t,Go}var tl={},Rm;function Fb(){if(Rm)return tl;Rm=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.resetState=l,tl.log=c;var e=Wv(),n=t(e);function t(p){return p&&p.__esModule?p:{default:p}}var r=void 0,a=void 0,o=[];function l(){for(var p=[r,a],m=0;m<p.length;m++){var g=p[m];g&&g.parentNode&&g.parentNode.removeChild(g)}r=a=null,o=[]}function c(){console.log("bodyTrap ----------"),console.log(o.length);for(var p=[r,a],m=0;m<p.length;m++){var g=p[m],v=g||{};console.log(v.nodeName,v.className,v.id)}console.log("edn bodyTrap ----------")}function f(){o.length!==0&&o[o.length-1].focusContent()}function h(p,m){!r&&!a&&(r=document.createElement("div"),r.setAttribute("data-react-modal-body-trap",""),r.style.position="absolute",r.style.opacity="0",r.setAttribute("tabindex","0"),r.addEventListener("focus",f),a=r.cloneNode(),a.addEventListener("focus",f)),o=m,o.length>0?(document.body.firstChild!==r&&document.body.insertBefore(r,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(r.parentElement&&r.parentElement.removeChild(r),a.parentElement&&a.parentElement.removeChild(a))}return n.default.subscribe(h),tl}var zm;function jb(){return zm||(zm=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Object.assign||function(de){for(var oe=1;oe<arguments.length;oe++){var he=arguments[oe];for(var X in he)Object.prototype.hasOwnProperty.call(he,X)&&(de[X]=he[X])}return de},r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},a=(function(){function de(oe,he){for(var X=0;X<he.length;X++){var le=he[X];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(oe,le.key,le)}}return function(oe,he,X){return he&&de(oe.prototype,he),X&&de(oe,X),oe}})(),o=jl(),l=Iv(),c=J(l),f=Eb(),h=W(f),p=Nb(),m=J(p),g=Bv(),v=W(g),w=Db(),b=W(w),k=rp(),T=J(k),j=Wv(),C=J(j);Fb();function W(de){if(de&&de.__esModule)return de;var oe={};if(de!=null)for(var he in de)Object.prototype.hasOwnProperty.call(de,he)&&(oe[he]=de[he]);return oe.default=de,oe}function J(de){return de&&de.__esModule?de:{default:de}}function V(de,oe){if(!(de instanceof oe))throw new TypeError("Cannot call a class as a function")}function P(de,oe){if(!de)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return oe&&(typeof oe=="object"||typeof oe=="function")?oe:de}function U(de,oe){if(typeof oe!="function"&&oe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof oe);de.prototype=Object.create(oe&&oe.prototype,{constructor:{value:de,enumerable:!1,writable:!0,configurable:!0}}),oe&&(Object.setPrototypeOf?Object.setPrototypeOf(de,oe):de.__proto__=oe)}var B={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},ne=function(oe){return oe.code==="Tab"||oe.keyCode===9},ee=function(oe){return oe.code==="Escape"||oe.keyCode===27},Y=0,fe=(function(de){U(oe,de);function oe(he){V(this,oe);var X=P(this,(oe.__proto__||Object.getPrototypeOf(oe)).call(this,he));return X.setOverlayRef=function(le){X.overlay=le,X.props.overlayRef&&X.props.overlayRef(le)},X.setContentRef=function(le){X.content=le,X.props.contentRef&&X.props.contentRef(le)},X.afterClose=function(){var le=X.props,z=le.appElement,se=le.ariaHideApp,R=le.htmlOpenClassName,S=le.bodyOpenClassName,G=le.parentSelector,D=G&&G().ownerDocument||document;S&&b.remove(D.body,S),R&&b.remove(D.getElementsByTagName("html")[0],R),se&&Y>0&&(Y-=1,Y===0&&v.show(z)),X.props.shouldFocusAfterRender&&(X.props.shouldReturnFocusAfterClose?(h.returnFocus(X.props.preventScroll),h.teardownScopedFocus()):h.popWithoutFocus()),X.props.onAfterClose&&X.props.onAfterClose(),C.default.deregister(X)},X.open=function(){X.beforeOpen(),X.state.afterOpen&&X.state.beforeClose?(clearTimeout(X.closeTimer),X.setState({beforeClose:!1})):(X.props.shouldFocusAfterRender&&(h.setupScopedFocus(X.node),h.markForFocusLater()),X.setState({isOpen:!0},function(){X.openAnimationFrame=requestAnimationFrame(function(){X.setState({afterOpen:!0}),X.props.isOpen&&X.props.onAfterOpen&&X.props.onAfterOpen({overlayEl:X.overlay,contentEl:X.content})})}))},X.close=function(){X.props.closeTimeoutMS>0?X.closeWithTimeout():X.closeWithoutTimeout()},X.focusContent=function(){return X.content&&!X.contentHasFocus()&&X.content.focus({preventScroll:!0})},X.closeWithTimeout=function(){var le=Date.now()+X.props.closeTimeoutMS;X.setState({beforeClose:!0,closesAt:le},function(){X.closeTimer=setTimeout(X.closeWithoutTimeout,X.state.closesAt-Date.now())})},X.closeWithoutTimeout=function(){X.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},X.afterClose)},X.handleKeyDown=function(le){ne(le)&&(0,m.default)(X.content,le),X.props.shouldCloseOnEsc&&ee(le)&&(le.stopPropagation(),X.requestClose(le))},X.handleOverlayOnClick=function(le){X.shouldClose===null&&(X.shouldClose=!0),X.shouldClose&&X.props.shouldCloseOnOverlayClick&&(X.ownerHandlesClose()?X.requestClose(le):X.focusContent()),X.shouldClose=null},X.handleContentOnMouseUp=function(){X.shouldClose=!1},X.handleOverlayOnMouseDown=function(le){!X.props.shouldCloseOnOverlayClick&&le.target==X.overlay&&le.preventDefault()},X.handleContentOnClick=function(){X.shouldClose=!1},X.handleContentOnMouseDown=function(){X.shouldClose=!1},X.requestClose=function(le){return X.ownerHandlesClose()&&X.props.onRequestClose(le)},X.ownerHandlesClose=function(){return X.props.onRequestClose},X.shouldBeClosed=function(){return!X.state.isOpen&&!X.state.beforeClose},X.contentHasFocus=function(){return document.activeElement===X.content||X.content.contains(document.activeElement)},X.buildClassName=function(le,z){var se=(typeof z>"u"?"undefined":r(z))==="object"?z:{base:B[le],afterOpen:B[le]+"--after-open",beforeClose:B[le]+"--before-close"},R=se.base;return X.state.afterOpen&&(R=R+" "+se.afterOpen),X.state.beforeClose&&(R=R+" "+se.beforeClose),typeof z=="string"&&z?R+" "+z:R},X.attributesFromObject=function(le,z){return Object.keys(z).reduce(function(se,R){return se[le+"-"+R]=z[R],se},{})},X.state={afterOpen:!1,beforeClose:!1},X.shouldClose=null,X.moveFromContentToOverlay=null,X}return a(oe,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(X,le){this.props.isOpen&&!X.isOpen?this.open():!this.props.isOpen&&X.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!le.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var X=this.props,le=X.appElement,z=X.ariaHideApp,se=X.htmlOpenClassName,R=X.bodyOpenClassName,S=X.parentSelector,G=S&&S().ownerDocument||document;R&&b.add(G.body,R),se&&b.add(G.getElementsByTagName("html")[0],se),z&&(Y+=1,v.hide(le)),C.default.register(this)}},{key:"render",value:function(){var X=this.props,le=X.id,z=X.className,se=X.overlayClassName,R=X.defaultStyles,S=X.children,G=z?{}:R.content,D=se?{}:R.overlay;if(this.shouldBeClosed())return null;var E={ref:this.setOverlayRef,className:this.buildClassName("overlay",se),style:t({},D,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},F=t({id:le,ref:this.setContentRef,style:t({},G,this.props.style.content),className:this.buildClassName("content",z),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",t({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),A=this.props.contentElement(F,S);return this.props.overlayElement(E,A)}}]),oe})(o.Component);fe.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},fe.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(T.default),c.default.instanceOf(k.SafeHTMLCollection),c.default.instanceOf(k.SafeNodeList),c.default.arrayOf(c.default.instanceOf(T.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},n.default=fe,e.exports=n.default})(Xc,Xc.exports)),Xc.exports}function Uv(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function $v(e){function n(t){var r=this.constructor.getDerivedStateFromProps(e,t);return r??null}this.setState(n.bind(this))}function Hv(e,n){try{var t=this.props,r=this.state;this.props=e,this.state=n,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}Uv.__suppressDeprecationWarning=!0;$v.__suppressDeprecationWarning=!0;Hv.__suppressDeprecationWarning=!0;function Pb(e){var n=e.prototype;if(!n||!n.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function")return e;var t=null,r=null,a=null;if(typeof n.componentWillMount=="function"?t="componentWillMount":typeof n.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof n.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof n.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof n.componentWillUpdate=="function"?a="componentWillUpdate":typeof n.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),t!==null||r!==null||a!==null){var o=e.displayName||e.name,l=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+o+" uses "+l+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(n.componentWillMount=Uv,n.componentWillReceiveProps=$v),typeof n.getSnapshotBeforeUpdate=="function"){if(typeof n.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");n.componentWillUpdate=Hv;var c=n.componentDidUpdate;n.componentDidUpdate=function(h,p,m){var g=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:m;c.call(this,h,p,g)}}return e}const Ab=Object.freeze(Object.defineProperty({__proto__:null,polyfill:Pb},Symbol.toStringTag,{value:"Module"})),Ob=ib(Ab);var Mm;function Rb(){if(Mm)return bs;Mm=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.bodyOpenClassName=bs.portalClassName=void 0;var e=Object.assign||function(ee){for(var Y=1;Y<arguments.length;Y++){var fe=arguments[Y];for(var de in fe)Object.prototype.hasOwnProperty.call(fe,de)&&(ee[de]=fe[de])}return ee},n=(function(){function ee(Y,fe){for(var de=0;de<fe.length;de++){var oe=fe[de];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(Y,oe.key,oe)}}return function(Y,fe,de){return fe&&ee(Y.prototype,fe),de&&ee(Y,de),Y}})(),t=jl(),r=k(t),a=qf(),o=k(a),l=Iv(),c=k(l),f=jb(),h=k(f),p=Bv(),m=b(p),g=rp(),v=k(g),w=Ob;function b(ee){if(ee&&ee.__esModule)return ee;var Y={};if(ee!=null)for(var fe in ee)Object.prototype.hasOwnProperty.call(ee,fe)&&(Y[fe]=ee[fe]);return Y.default=ee,Y}function k(ee){return ee&&ee.__esModule?ee:{default:ee}}function T(ee,Y){if(!(ee instanceof Y))throw new TypeError("Cannot call a class as a function")}function j(ee,Y){if(!ee)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y&&(typeof Y=="object"||typeof Y=="function")?Y:ee}function C(ee,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Y);ee.prototype=Object.create(Y&&Y.prototype,{constructor:{value:ee,enumerable:!1,writable:!0,configurable:!0}}),Y&&(Object.setPrototypeOf?Object.setPrototypeOf(ee,Y):ee.__proto__=Y)}var W=bs.portalClassName="ReactModalPortal",J=bs.bodyOpenClassName="ReactModal__Body--open",V=g.canUseDOM&&o.default.createPortal!==void 0,P=function(Y){return document.createElement(Y)},U=function(){return V?o.default.createPortal:o.default.unstable_renderSubtreeIntoContainer};function B(ee){return ee()}var ne=(function(ee){C(Y,ee);function Y(){var fe,de,oe,he;T(this,Y);for(var X=arguments.length,le=Array(X),z=0;z<X;z++)le[z]=arguments[z];return he=(de=(oe=j(this,(fe=Y.__proto__||Object.getPrototypeOf(Y)).call.apply(fe,[this].concat(le))),oe),oe.removePortal=function(){!V&&o.default.unmountComponentAtNode(oe.node);var se=B(oe.props.parentSelector);se&&se.contains(oe.node)?se.removeChild(oe.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},oe.portalRef=function(se){oe.portal=se},oe.renderPortal=function(se){var R=U(),S=R(oe,r.default.createElement(h.default,e({defaultStyles:Y.defaultStyles},se)),oe.node);oe.portalRef(S)},de),j(oe,he)}return n(Y,[{key:"componentDidMount",value:function(){if(g.canUseDOM){V||(this.node=P("div")),this.node.className=this.props.portalClassName;var de=B(this.props.parentSelector);de.appendChild(this.node),!V&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(de){var oe=B(de.parentSelector),he=B(this.props.parentSelector);return{prevParent:oe,nextParent:he}}},{key:"componentDidUpdate",value:function(de,oe,he){if(g.canUseDOM){var X=this.props,le=X.isOpen,z=X.portalClassName;de.portalClassName!==z&&(this.node.className=z);var se=he.prevParent,R=he.nextParent;R!==se&&(se.removeChild(this.node),R.appendChild(this.node)),!(!de.isOpen&&!le)&&!V&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!g.canUseDOM||!this.node||!this.portal)){var de=this.portal.state,oe=Date.now(),he=de.isOpen&&this.props.closeTimeoutMS&&(de.closesAt||oe+this.props.closeTimeoutMS);he?(de.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,he-oe)):this.removePortal()}}},{key:"render",value:function(){if(!g.canUseDOM||!V)return null;!this.node&&V&&(this.node=P("div"));var de=U();return de(r.default.createElement(h.default,e({ref:this.portalRef,defaultStyles:Y.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(de){m.setElement(de)}}]),Y})(t.Component);return ne.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(v.default),c.default.instanceOf(g.SafeHTMLCollection),c.default.instanceOf(g.SafeNodeList),c.default.arrayOf(c.default.instanceOf(v.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},ne.defaultProps={isOpen:!1,portalClassName:W,bodyOpenClassName:J,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(Y,fe){return r.default.createElement("div",Y,fe)},contentElement:function(Y,fe){return r.default.createElement("div",Y,fe)}},ne.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,w.polyfill)(ne),bs.default=ne,bs}var Im;function zb(){return Im||(Im=1,(function(e,n){Object.defineProperty(n,"__esModule",{value:!0});var t=Rb(),r=a(t);function a(o){return o&&o.__esModule?o:{default:o}}n.default=r.default,e.exports=n.default})(Qc,Qc.exports)),Qc.exports}var Mb=zb();const ar=Qu(Mb);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Yv=1252,Ib=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],np={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ap=function(e){Ib.indexOf(e)!=-1&&(Yv=np[0]=e)};function Lb(){ap(1252)}var sa=function(e){ap(e)};function Vv(){sa(1200),Lb()}function Lm(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function Bb(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Kv(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var al=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?Bb(e.slice(2)):n==254&&t==255?Kv(e.slice(2)):n==65279?e.slice(1):e},Jc=function(n){return String.fromCharCode(n)},Bm=function(n){return String.fromCharCode(n)},wl,Cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wm(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,r=e.charCodeAt(h++),l=(t&3)<<4|r>>4,a=e.charCodeAt(h++),c=(r&15)<<2|a>>6,f=a&63,isNaN(r)?c=f=64:isNaN(a)&&(f=64),n+=Cs.charAt(o)+Cs.charAt(l)+Cs.charAt(c)+Cs.charAt(f);return n}function Tn(e){var n="",t=0,r=0,a=0,o=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=Cs.indexOf(e.charAt(h++)),l=Cs.indexOf(e.charAt(h++)),t=o<<2|l>>4,n+=String.fromCharCode(t),c=Cs.indexOf(e.charAt(h++)),r=(l&15)<<4|c>>2,c!==64&&(n+=String.fromCharCode(r)),f=Cs.indexOf(e.charAt(h++)),a=(c&3)<<6|f,f!==64&&(n+=String.fromCharCode(a));return n}var Pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),vo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function As(e){return Pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Um(e){return Pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var aa=function(n){return Pt?vo(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function yo(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function sp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return sp(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var Es=Pt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:vo(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),a=0;for(n=0,t=0;n<e.length;t+=a,++n)if(a=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Wb(e){for(var n=[],t=0,r=e.length+250,a=As(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++o)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|c>>6&15|(l&3)<<4,a[t++]=128|c&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>r&&(n.push(a.slice(0,t)),t=0,a=As(65535),r=65530)}return n.push(a.slice(0,t)),Es(n)}var dn=/\u0000/g,sl=/[\u0001-\u0006]/g;function ri(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function oa(e,n){var t=""+e;return t.length>=n?t:pr("0",n-t.length)+t}function op(e,n){var t=""+e;return t.length>=n?t:pr(" ",n-t.length)+t}function Su(e,n){var t=""+e;return t.length>=n?t:t+pr(" ",n-t.length)}function Ub(e,n){var t=""+Math.round(e);return t.length>=n?t:pr("0",n-t.length)+t}function $b(e,n){var t=""+e;return t.length>=n?t:pr("0",n-t.length)+t}var $m=Math.pow(2,32);function Qo(e,n){if(e>$m||e<-$m)return Ub(e,n);var t=Math.round(e);return $b(t,n)}function Eu(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Hm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Z0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Hb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ym={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Yb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Nu(e,n,t){for(var r=e<0?-1:1,a=e*r,o=0,l=1,c=0,f=1,h=0,p=0,m=Math.floor(a);h<n&&(m=Math.floor(a),c=m*l+o,p=m*h+f,!(a-m<5e-8));)a=1/(a-m),o=l,l=c,f=h,h=p;if(p>n&&(h>n?(p=f,c=o):(p=h,c=l)),!t)return[0,r*c,p];var g=Math.floor(r*c/p);return[g,r*c-g*p,p]}function to(e,n,t){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],c={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),n&&n.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),r<60&&(o=(o+6)%7),t&&(o=qb(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=o,c}var Gv=new Date(1899,11,31,0,0,0),Vb=Gv.getTime(),Kb=new Date(1900,2,1,0,0,0);function Qv(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=Kb&&(t+=1440*60*1e3),(t-(Vb+(e.getTimezoneOffset()-Gv.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ip(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Gb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Qb(e){var n=e<0?12:11,t=ip(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function Xb(e){var n=ip(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function kl(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=Qb(e):n===10?t=e.toFixed(10).substr(0,12):t=Xb(e),ip(Gb(t.toUpperCase()))}function uo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):kl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Vn(14,Qv(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function qb(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Zb(e,n,t,r){var a="",o=0,l=0,c=t.y,f,h=0;switch(e){case 98:c=t.y+543;case 121:switch(n.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:f=t.m,h=n.length;break;case 3:return Z0[t.m-1][1];case 5:return Z0[t.m-1][0];default:return Z0[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=t.d,h=n.length;break;case 3:return Hm[t.q][0];default:return Hm[t.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(t.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=t.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=t.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?oa(t.S,n.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(t.S+t.u)),o>=60*l&&(o=0),n==="s"?o===0?"0":""+o/l:(a=oa(o,2+r),n==="ss"?a.substr(0,2):"."+a.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:f=c,h=1;break}var p=h>0?oa(f,h):"";return p}function Ts(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Xv=/%/g;function Jb(e,n,t){var r=n.replace(Xv,""),a=n.length-r.length;return Va(e,r,t*Math.pow(10,2*a))+pr("%",a)}function e2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Va(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function qv(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+qv(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Zv=/# (\?+)( ?)\/( ?)(\d+)/;function t2(e,n,t){var r=parseInt(e[4],10),a=Math.round(n*r),o=Math.floor(a/r),l=a-o*r,c=r;return t+(o===0?"":""+o)+" "+(l===0?pr(" ",e[1].length+1+e[4].length):op(l,e[1].length)+e[2]+"/"+e[3]+oa(c,e[4].length))}function r2(e,n,t){return t+(n===0?"":""+n)+pr(" ",e[1].length+2+e[4].length)}var Jv=/^#*0*\.([0#]+)/,ey=/\).*[0#]/,ty=/\(###\) ###\\?-####/;function nn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Vm(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Km(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function n2(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function a2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ln(e,n,t){if(e.charCodeAt(0)===40&&!n.match(ey)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ln("n",r,t):"("+Ln("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return e2(e,n,t);if(n.indexOf("%")!==-1)return Jb(e,n,t);if(n.indexOf("E")!==-1)return qv(n,t);if(n.charCodeAt(0)===36)return"$"+Ln(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+Qo(f,n.length);if(n.match(/^[#?]+$/))return a=Qo(t,0),a==="0"&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(Zv))return t2(o,f,h);if(n.match(/^#+0+$/))return h+Qo(f,n.length-n.indexOf("0"));if(o=n.match(Jv))return a=Vm(t,o[1].length).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+pr("0",nn(o[1]).length-b.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+Vm(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Ts(Qo(f,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ln(e,n,-t):Ts(""+(Math.floor(t)+n2(t,o[1].length)))+"."+oa(Km(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return Ln(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(Ln(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(n.match(ty))return a=Ln(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Nu(f,Math.pow(10,l)-1,!1),a=""+h,p=Va("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Su(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Nu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?op(c[1],l)+o[2]+"/"+o[3]+Su(c[2],l):pr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=Qo(t,0),n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return l=Km(t,o[1].length),t<0?"-"+Ln(e,n,-t):Ts(a2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?oa(0,3-w.length):"")+w})+"."+oa(l,o[1].length);switch(n){case"###,##0.00":return Ln(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var v=Ts(Qo(f,0));return v!=="0"?h+v:"";case"###,###.00":return Ln(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ln(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function s2(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return Va(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function o2(e,n,t){var r=n.replace(Xv,""),a=n.length-r.length;return Va(e,r,t*Math.pow(10,2*a))+pr("%",a)}function ry(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+ry(e,-n);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(n/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+o):t+="E+"+(l-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,p){return f+h+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function va(e,n,t){if(e.charCodeAt(0)===40&&!n.match(ey)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?va("n",r,t):"("+va("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return s2(e,n,t);if(n.indexOf("%")!==-1)return o2(e,n,t);if(n.indexOf("E")!==-1)return ry(n,t);if(n.charCodeAt(0)===36)return"$"+va(e,n.substr(n.charAt(1)==" "?2:1),t);var a,o,l,c,f=Math.abs(t),h=t<0?"-":"";if(n.match(/^00+$/))return h+oa(f,n.length);if(n.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>n.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(Zv))return r2(o,f,h);if(n.match(/^#+0+$/))return h+oa(f,n.length-n.indexOf("0"));if(o=n.match(Jv))return a=(""+t).replace(/^([^\.]+)$/,"$1."+nn(o[1])).replace(/\.$/,"."+nn(o[1])),a=a.replace(/\.(\d*)$/,function(w,b){return"."+b+pr("0",nn(o[1]).length-b.length)}),n.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return h+Ts(""+f);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+va(e,n,-t):Ts(""+t)+"."+pr("0",o[1].length);if(o=n.match(/^#,#*,#0/))return va(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ri(va(e,n.replace(/[\\-]/g,""),t)),l=0,ri(ri(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(n.match(ty))return a=va(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),c=Nu(f,Math.pow(10,l)-1,!1),a=""+h,p=Va("n",o[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Su(c[2],l),p.length<o[4].length&&(p=nn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),c=Nu(f,Math.pow(10,l)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?op(c[1],l)+o[2]+"/"+o[3]+Su(c[2],l):pr(" ",2*l+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return a=""+t,n.length<=a.length?a:nn(n.substr(0,n.length-a.length))+a;if(o=n.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=n.indexOf(".")-l,g=n.length-a.length-m;return nn(n.substr(0,m)+a+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+va(e,n,-t):Ts(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?oa(0,3-w.length):"")+w})+"."+oa(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var v=Ts(""+f);return v!=="0"?h+v:"";default:if(n.match(/\.[0#?]*$/))return va(e,n.slice(0,n.lastIndexOf(".")),t)+nn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Va(e,n,t){return(t|0)===t?va(e,n,t):Ln(e,n,t)}function i2(e){for(var n=[],t=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(a,r-a),a=r+1}if(n[n.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var ny=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mi(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":Eu(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(ny))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function l2(e,n,t,r){for(var a=[],o="",l=0,c="",f="t",h,p,m,g="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!Eu(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(m=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(m);a[a.length]={t:"t",v:o},++l;break;case"\\":var v=e.charAt(++l),w=v==="("||v===")"?v:"t";a[a.length]={t:w,v},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:n},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=to(n,t,e.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=to(n,t),h==null))return"";for(o=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)o+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:o},f=c;break;case"A":case"a":case"":var b={t:c,v:c};if(h==null&&(h=to(n,t)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(b.v=h.H>=12?"P":"A"),b.t="T",g="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(b.v=h.H>=12?"PM":"AM"),b.t="T",l+=5,g="h"):e.substr(l,5).toUpperCase()==="/"?(h!=null&&(b.v=h.H>=12?"":""),b.t="T",l+=5,g="h"):(b.t="t",++l),h==null&&b.t==="T")return"";a[a.length]=b,f=c;break;case"[":for(o=c;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(ny)){if(h==null&&(h=to(n,t),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",mi(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=c;++l<e.length&&(c=e.charAt(l))==="0";)o+=c;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)o+=c;a[a.length]={t:"n",v:o};break;case"?":for(o=c;e.charAt(++l)===c;)o+=c;a[a.length]={t:c,v:o},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var k=0,T=0,j;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=g,f="h",k<1&&(k=1);break;case"s":(j=a[l].v.match(/\.0+$/))&&(T=Math.max(T,j[0].length-1)),k<3&&(k=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",k<2&&(k=2));break;case"X":break;case"Z":k<1&&a[l].v.match(/[Hh]/)&&(k=1),k<2&&a[l].v.match(/[Mm]/)&&(k=2),k<3&&a[l].v.match(/[Ss]/)&&(k=3)}switch(k){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",W;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=Zb(a[l].t.charCodeAt(0),a[l].v,h,T),a[l].t="t";break;case"n":case"?":for(W=l+1;a[W]!=null&&((c=a[W].t)==="?"||c==="D"||(c===" "||c==="t")&&a[W+1]!=null&&(a[W+1].t==="?"||a[W+1].t==="t"&&a[W+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[W].v==="/"||a[W].v===" "&&a[W+1]!=null&&a[W+1].t=="?"));)a[l].v+=a[W].v,a[W]={v:"",t:";"},++W;C+=a[l].v,l=W-1;break;case"G":a[l].t="t",a[l].v=uo(n,t);break}var J="",V,P;if(C.length>0){C.charCodeAt(0)==40?(V=n<0&&C.charCodeAt(0)===45?-n:n,P=Va("n",C,V)):(V=n<0&&r>1?-n:n,P=Va("n",C,V),V<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),W=P.length-1;var U=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){U=l;break}var B=a.length;if(U===a.length&&P.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(W>=a[l].v.length-1?(W-=a[l].v.length,a[l].v=P.substr(W+1,a[l].v.length)):W<0?a[l].v="":(a[l].v=P.substr(0,W+1),W=-1),a[l].t="t",B=l);W>=0&&B<a.length&&(a[B].v=P.substr(0,W+1)+a[B].v)}else if(U!==a.length&&P.indexOf("E")===-1){for(W=P.indexOf(".")-1,l=U;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===U?a[l].v.indexOf(".")-1:a[l].v.length-1,J=a[l].v.substr(p+1);p>=0;--p)W>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(J=P.charAt(W--)+J);a[l].v=J,a[l].t="t",B=l}for(W>=0&&B<a.length&&(a[B].v=P.substr(0,W+1)+a[B].v),W=P.indexOf(".")+1,l=U;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==U)){for(p=a[l].v.indexOf(".")>-1&&l===U?a[l].v.indexOf(".")+1:0,J=a[l].v.substr(0,p);p<a[l].v.length;++p)W<P.length&&(J+=P.charAt(W++));a[l].v=J,a[l].t="t",B=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(V=r>1&&n<0&&l>0&&a[l-1].v==="-"?-n:n,a[l].v=Va(a[l].t,a[l].v,V),a[l].t="t");var ne="";for(l=0;l!==a.length;++l)a[l]!=null&&(ne+=a[l].v);return ne}var Gm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Qm(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function c2(e,n){var t=i2(e),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(Gm),c=t[1].match(Gm);return Qm(n,l)?[r,t[0]]:Qm(n,c)?[r,t[1]]:[r,t[l!=null&&c!=null?2:1]]}return[r,o]}function Vn(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Et)[e],r==null&&(r=t.table&&t.table[Ym[e]]||Et[Ym[e]]),r==null&&(r=Yb[e]||"General");break}if(Eu(r,0))return uo(n,t);n instanceof Date&&(n=Qv(n,t.date1904));var a=c2(r,n);if(Eu(a[1]))return uo(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return l2(a[1],n,t,a[0])}function ao(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(Et[t]==null){n<0&&(n=t);continue}if(Et[t]==e){n=t;break}}n<0&&(n=391)}return Et[n]=e,n}function ay(){Et=Hb()}var u2={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},sy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function d2(e){var n=typeof e=="number"?Et[e]:e;return n=n.replace(sy,"(\\d+)"),new RegExp("^"+n+"$")}function f2(e,n,t){var r=-1,a=-1,o=-1,l=-1,c=-1,f=-1;(n.match(sy)||[]).forEach(function(m,g){var v=parseInt(t[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=v;break;case"d":o=v;break;case"h":l=v;break;case"s":f=v;break;case"m":l>=0?c=v:a=v;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?h:r==-1&&a==-1&&o==-1?p:h+"T"+p}var p2=(function(){var e={};e.version="1.2.0";function n(){for(var P=0,U=new Array(256),B=0;B!=256;++B)P=B,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,U[B]=P;return typeof Int32Array<"u"?new Int32Array(U):U}var t=n();function r(P){var U=0,B=0,ne=0,ee=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)ee[ne]=P[ne];for(ne=0;ne!=256;++ne)for(B=P[ne],U=256+ne;U<4096;U+=256)B=ee[U]=B>>>8^P[B&255];var Y=[];for(ne=1;ne!=16;++ne)Y[ne-1]=typeof Int32Array<"u"?ee.subarray(ne*256,ne*256+256):ee.slice(ne*256,ne*256+256);return Y}var a=r(t),o=a[0],l=a[1],c=a[2],f=a[3],h=a[4],p=a[5],m=a[6],g=a[7],v=a[8],w=a[9],b=a[10],k=a[11],T=a[12],j=a[13],C=a[14];function W(P,U){for(var B=U^-1,ne=0,ee=P.length;ne<ee;)B=B>>>8^t[(B^P.charCodeAt(ne++))&255];return~B}function J(P,U){for(var B=U^-1,ne=P.length-15,ee=0;ee<ne;)B=C[P[ee++]^B&255]^j[P[ee++]^B>>8&255]^T[P[ee++]^B>>16&255]^k[P[ee++]^B>>>24]^b[P[ee++]]^w[P[ee++]]^v[P[ee++]]^g[P[ee++]]^m[P[ee++]]^p[P[ee++]]^h[P[ee++]]^f[P[ee++]]^c[P[ee++]]^l[P[ee++]]^o[P[ee++]]^t[P[ee++]];for(ne+=15;ee<ne;)B=B>>>8^t[(B^P[ee++])&255];return~B}function V(P,U){for(var B=U^-1,ne=0,ee=P.length,Y=0,fe=0;ne<ee;)Y=P.charCodeAt(ne++),Y<128?B=B>>>8^t[(B^Y)&255]:Y<2048?(B=B>>>8^t[(B^(192|Y>>6&31))&255],B=B>>>8^t[(B^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,fe=P.charCodeAt(ne++)&1023,B=B>>>8^t[(B^(240|Y>>8&7))&255],B=B>>>8^t[(B^(128|Y>>2&63))&255],B=B>>>8^t[(B^(128|fe>>6&15|(Y&3)<<4))&255],B=B>>>8^t[(B^(128|fe&63))&255]):(B=B>>>8^t[(B^(224|Y>>12&15))&255],B=B>>>8^t[(B^(128|Y>>6&63))&255],B=B>>>8^t[(B^(128|Y&63))&255]);return~B}return e.table=t,e.bstr=W,e.buf=J,e.str=V,e})(),At=(function(){var n={};n.version="1.2.1";function t(O,te){for(var K=O.split("/"),Q=te.split("/"),Z=0,re=0,ke=Math.min(K.length,Q.length);Z<ke;++Z){if(re=K[Z].length-Q[Z].length)return re;if(K[Z]!=Q[Z])return K[Z]<Q[Z]?-1:1}return K.length-Q.length}function r(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:r(O.slice(0,-1));var te=O.lastIndexOf("/");return te===-1?O:O.slice(0,te+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var te=O.lastIndexOf("/");return te===-1?O:O.slice(te+1)}function o(O,te){typeof te=="string"&&(te=new Date(te));var K=te.getHours();K=K<<6|te.getMinutes(),K=K<<5|te.getSeconds()>>>1,O.write_shift(2,K);var Q=te.getFullYear()-1980;Q=Q<<4|te.getMonth()+1,Q=Q<<5|te.getDate(),O.write_shift(2,Q)}function l(O){var te=O.read_shift(2)&65535,K=O.read_shift(2)&65535,Q=new Date,Z=K&31;K>>>=5;var re=K&15;K>>>=4,Q.setMilliseconds(0),Q.setFullYear(K+1980),Q.setMonth(re-1),Q.setDate(Z);var ke=te&31;te>>>=5;var Fe=te&63;return te>>>=6,Q.setHours(te),Q.setMinutes(Fe),Q.setSeconds(ke<<1),Q}function c(O){Br(O,0);for(var te={},K=0;O.l<=O.length-4;){var Q=O.read_shift(2),Z=O.read_shift(2),re=O.l+Z,ke={};switch(Q){case 21589:K=O.read_shift(1),K&1&&(ke.mtime=O.read_shift(4)),Z>5&&(K&2&&(ke.atime=O.read_shift(4)),K&4&&(ke.ctime=O.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}O.l=re,te[Q]=ke}return te}var f;function h(){return f||(f={})}function p(O,te){if(O[0]==80&&O[1]==75)return ze(O,te);if((O[0]|32)==109&&(O[1]|32)==105)return yt(O,te);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var K=3,Q=512,Z=0,re=0,ke=0,Fe=0,we=0,Se=[],Ee=O.slice(0,512);Br(Ee,0);var Be=m(Ee);switch(K=Be[0],K){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(Be[1]==0)return ze(O,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Q!==512&&(Ee=O.slice(0,Q),Br(Ee,28));var Je=O.slice(0,Q);g(Ee,K);var We=Ee.read_shift(4,"i");if(K===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);Ee.l+=4,ke=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),Fe=Ee.read_shift(4,"i"),Z=Ee.read_shift(4,"i"),we=Ee.read_shift(4,"i"),re=Ee.read_shift(4,"i");for(var Ue=-1,Ye=0;Ye<109&&(Ue=Ee.read_shift(4,"i"),!(Ue<0));++Ye)Se[Ye]=Ue;var gt=v(O,Q);k(we,re,gt,Q,Se);var Qt=j(gt,ke,Se,Q);Qt[ke].name="!Directory",Z>0&&Fe!==fe&&(Qt[Fe].name="!MiniFAT"),Qt[Se[0]].name="!FAT",Qt.fat_addrs=Se,Qt.ssz=Q;var Vt={},mr=[],Ls=[],rs=[];C(ke,Qt,gt,mr,Z,Vt,Ls,Fe),w(Ls,rs,mr),mr.shift();var da={FileIndex:Ls,FullPaths:rs};return te&&te.raw&&(da.raw={header:Je,sectors:gt}),da}function m(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(de,"Header Signature: "),O.l+=16;var te=O.read_shift(2,"u");return[O.read_shift(2,"u"),te]}function g(O,te){var K=9;switch(O.l+=2,K=O.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function v(O,te){for(var K=Math.ceil(O.length/te)-1,Q=[],Z=1;Z<K;++Z)Q[Z-1]=O.slice(Z*te,(Z+1)*te);return Q[K-1]=O.slice(K*te),Q}function w(O,te,K){for(var Q=0,Z=0,re=0,ke=0,Fe=0,we=K.length,Se=[],Ee=[];Q<we;++Q)Se[Q]=Ee[Q]=Q,te[Q]=K[Q];for(;Fe<Ee.length;++Fe)Q=Ee[Fe],Z=O[Q].L,re=O[Q].R,ke=O[Q].C,Se[Q]===Q&&(Z!==-1&&Se[Z]!==Z&&(Se[Q]=Se[Z]),re!==-1&&Se[re]!==re&&(Se[Q]=Se[re])),ke!==-1&&(Se[ke]=Q),Z!==-1&&Q!=Se[Q]&&(Se[Z]=Se[Q],Ee.lastIndexOf(Z)<Fe&&Ee.push(Z)),re!==-1&&Q!=Se[Q]&&(Se[re]=Se[Q],Ee.lastIndexOf(re)<Fe&&Ee.push(re));for(Q=1;Q<we;++Q)Se[Q]===Q&&(re!==-1&&Se[re]!==re?Se[Q]=Se[re]:Z!==-1&&Se[Z]!==Z&&(Se[Q]=Se[Z]));for(Q=1;Q<we;++Q)if(O[Q].type!==0){if(Fe=Q,Fe!=Se[Fe])do Fe=Se[Fe],te[Q]=te[Fe]+"/"+te[Q];while(Fe!==0&&Se[Fe]!==-1&&Fe!=Se[Fe]);Se[Q]=-1}for(te[0]+="/",Q=1;Q<we;++Q)O[Q].type!==2&&(te[Q]+="/")}function b(O,te,K){for(var Q=O.start,Z=O.size,re=[],ke=Q;K&&Z>0&&ke>=0;)re.push(te.slice(ke*Y,ke*Y+Y)),Z-=Y,ke=eo(K,ke*4);return re.length===0?Tr(0):Es(re).slice(0,O.size)}function k(O,te,K,Q,Z){var re=fe;if(O===fe){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ke=K[O],Fe=(Q>>>2)-1;if(!ke)return;for(var we=0;we<Fe&&(re=eo(ke,we*4))!==fe;++we)Z.push(re);k(eo(ke,Q-4),te-1,K,Q,Z)}}function T(O,te,K,Q,Z){var re=[],ke=[];Z||(Z=[]);var Fe=Q-1,we=0,Se=0;for(we=te;we>=0;){Z[we]=!0,re[re.length]=we,ke.push(O[we]);var Ee=K[Math.floor(we*4/Q)];if(Se=we*4&Fe,Q<4+Se)throw new Error("FAT boundary crossed: "+we+" 4 "+Q);if(!O[Ee])break;we=eo(O[Ee],Se)}return{nodes:re,data:sg([ke])}}function j(O,te,K,Q){var Z=O.length,re=[],ke=[],Fe=[],we=[],Se=Q-1,Ee=0,Be=0,Je=0,We=0;for(Ee=0;Ee<Z;++Ee)if(Fe=[],Je=Ee+te,Je>=Z&&(Je-=Z),!ke[Je]){we=[];var Ue=[];for(Be=Je;Be>=0;){Ue[Be]=!0,ke[Be]=!0,Fe[Fe.length]=Be,we.push(O[Be]);var Ye=K[Math.floor(Be*4/Q)];if(We=Be*4&Se,Q<4+We)throw new Error("FAT boundary crossed: "+Be+" 4 "+Q);if(!O[Ye]||(Be=eo(O[Ye],We),Ue[Be]))break}re[Je]={nodes:Fe,data:sg([we])}}return re}function C(O,te,K,Q,Z,re,ke,Fe){for(var we=0,Se=Q.length?2:0,Ee=te[O].data,Be=0,Je=0,We;Be<Ee.length;Be+=128){var Ue=Ee.slice(Be,Be+128);Br(Ue,64),Je=Ue.read_shift(2),We=fp(Ue,0,Je-Se),Q.push(We);var Ye={name:We,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},gt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);gt!==0&&(Ye.ct=W(Ue,Ue.l-8));var Qt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Qt!==0&&(Ye.mt=W(Ue,Ue.l-8)),Ye.start=Ue.read_shift(4,"i"),Ye.size=Ue.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=fe,Ye.name=""),Ye.type===5?(we=Ye.start,Z>0&&we!==fe&&(te[we].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",te[Ye.start]===void 0&&(te[Ye.start]=T(K,Ye.start,te.fat_addrs,te.ssz)),te[Ye.start].name=Ye.name,Ye.content=te[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:we!==fe&&Ye.start!==fe&&te[we]&&(Ye.content=b(Ye,te[we].data,(te[Fe]||{}).data))),Ye.content&&Br(Ye.content,0),re[We]=Ye,ke.push(Ye)}}function W(O,te){return new Date((En(O,te+4)/1e7*Math.pow(2,32)+En(O,te)/1e7-11644473600)*1e3)}function J(O,te){return h(),p(f.readFileSync(O),te)}function V(O,te){var K=te&&te.type;switch(K||Pt&&Buffer.isBuffer(O)&&(K="buffer"),K||"base64"){case"file":return J(O,te);case"base64":return p(aa(Tn(O)),te);case"binary":return p(aa(O),te)}return p(O,te)}function P(O,te){var K=te||{},Q=K.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=Q+"/",O.FileIndex[0]={name:Q,type:5}),K.CLSID&&(O.FileIndex[0].clsid=K.CLSID),U(O)}function U(O){var te="Sh33tJ5";if(!At.find(O,"/"+te)){var K=Tr(4);K[0]=55,K[1]=K[3]=50,K[2]=54,O.FileIndex.push({name:te,type:2,content:K,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+te),B(O)}}function B(O,te){P(O);for(var K=!1,Q=!1,Z=O.FullPaths.length-1;Z>=0;--Z){var re=O.FileIndex[Z];switch(re.type){case 0:Q?K=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(re.R*re.L*re.C)&&(K=!0),re.R>-1&&re.L>-1&&re.R==re.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!te)){var ke=new Date(1987,1,19),Fe=0,we=Object.create?Object.create(null):{},Se=[];for(Z=0;Z<O.FullPaths.length;++Z)we[O.FullPaths[Z]]=!0,O.FileIndex[Z].type!==0&&Se.push([O.FullPaths[Z],O.FileIndex[Z]]);for(Z=0;Z<Se.length;++Z){var Ee=r(Se[Z][0]);Q=we[Ee],Q||(Se.push([Ee,{name:a(Ee).replace("/",""),type:1,clsid:he,ct:ke,mt:ke,content:null}]),we[Ee]=!0)}for(Se.sort(function(We,Ue){return t(We[0],Ue[0])}),O.FullPaths=[],O.FileIndex=[],Z=0;Z<Se.length;++Z)O.FullPaths[Z]=Se[Z][0],O.FileIndex[Z]=Se[Z][1];for(Z=0;Z<Se.length;++Z){var Be=O.FileIndex[Z],Je=O.FullPaths[Z];if(Be.name=a(Je).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||he,Z===0)Be.C=Se.length>1?1:-1,Be.size=0,Be.type=5;else if(Je.slice(-1)=="/"){for(Fe=Z+1;Fe<Se.length&&r(O.FullPaths[Fe])!=Je;++Fe);for(Be.C=Fe>=Se.length?-1:Fe,Fe=Z+1;Fe<Se.length&&r(O.FullPaths[Fe])!=r(Je);++Fe);Be.R=Fe>=Se.length?-1:Fe,Be.type=1}else r(O.FullPaths[Z+1]||"")==r(Je)&&(Be.R=Z+1),Be.type=2}}}function ne(O,te){var K=te||{};if(K.fileType=="mad")return Ut(O,K);switch(B(O),K.fileType){case"zip":return at(O,K)}var Q=(function(We){for(var Ue=0,Ye=0,gt=0;gt<We.FileIndex.length;++gt){var Qt=We.FileIndex[gt];if(Qt.content){var Vt=Qt.content.length;Vt>0&&(Vt<4096?Ue+=Vt+63>>6:Ye+=Vt+511>>9)}}for(var mr=We.FullPaths.length+3>>2,Ls=Ue+7>>3,rs=Ue+127>>7,da=Ls+Ye+mr+rs,jr=da+127>>7,wi=jr<=109?0:Math.ceil((jr-109)/127);da+jr+wi+127>>7>jr;)wi=++jr<=109?0:Math.ceil((jr-109)/127);var gr=[1,wi,jr,rs,mr,Ye,Ue,0];return We.FileIndex[0].size=Ue<<6,gr[7]=(We.FileIndex[0].start=gr[0]+gr[1]+gr[2]+gr[3]+gr[4]+gr[5])+(gr[6]+7>>3),gr})(O),Z=Tr(Q[7]<<9),re=0,ke=0;{for(re=0;re<8;++re)Z.write_shift(1,oe[re]);for(re=0;re<8;++re)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),re=0;re<3;++re)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,Q[2]),Z.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:fe),Z.write_shift(4,Q[3]),Z.write_shift(-4,Q[1]?Q[0]-1:fe),Z.write_shift(4,Q[1]),re=0;re<109;++re)Z.write_shift(-4,re<Q[2]?Q[1]+re:-1)}if(Q[1])for(ke=0;ke<Q[1];++ke){for(;re<236+ke*127;++re)Z.write_shift(-4,re<Q[2]?Q[1]+re:-1);Z.write_shift(-4,ke===Q[1]-1?fe:ke+1)}var Fe=function(We){for(ke+=We;re<ke-1;++re)Z.write_shift(-4,re+1);We&&(++re,Z.write_shift(-4,fe))};for(ke=re=0,ke+=Q[1];re<ke;++re)Z.write_shift(-4,X.DIFSECT);for(ke+=Q[2];re<ke;++re)Z.write_shift(-4,X.FATSECT);Fe(Q[3]),Fe(Q[4]);for(var we=0,Se=0,Ee=O.FileIndex[0];we<O.FileIndex.length;++we)Ee=O.FileIndex[we],Ee.content&&(Se=Ee.content.length,!(Se<4096)&&(Ee.start=ke,Fe(Se+511>>9)));for(Fe(Q[6]+7>>3);Z.l&511;)Z.write_shift(-4,X.ENDOFCHAIN);for(ke=re=0,we=0;we<O.FileIndex.length;++we)Ee=O.FileIndex[we],Ee.content&&(Se=Ee.content.length,!(!Se||Se>=4096)&&(Ee.start=ke,Fe(Se+63>>6)));for(;Z.l&511;)Z.write_shift(-4,X.ENDOFCHAIN);for(re=0;re<Q[4]<<2;++re){var Be=O.FullPaths[re];if(!Be||Be.length===0){for(we=0;we<17;++we)Z.write_shift(4,0);for(we=0;we<3;++we)Z.write_shift(4,-1);for(we=0;we<12;++we)Z.write_shift(4,0);continue}Ee=O.FileIndex[re],re===0&&(Ee.start=Ee.size?Ee.start-1:fe);var Je=re===0&&K.root||Ee.name;if(Se=2*(Je.length+1),Z.write_shift(64,Je,"utf16le"),Z.write_shift(2,Se),Z.write_shift(1,Ee.type),Z.write_shift(1,Ee.color),Z.write_shift(-4,Ee.L),Z.write_shift(-4,Ee.R),Z.write_shift(-4,Ee.C),Ee.clsid)Z.write_shift(16,Ee.clsid,"hex");else for(we=0;we<4;++we)Z.write_shift(4,0);Z.write_shift(4,Ee.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,Ee.start),Z.write_shift(4,Ee.size),Z.write_shift(4,0)}for(re=1;re<O.FileIndex.length;++re)if(Ee=O.FileIndex[re],Ee.size>=4096)if(Z.l=Ee.start+1<<9,Pt&&Buffer.isBuffer(Ee.content))Ee.content.copy(Z,Z.l,0,Ee.size),Z.l+=Ee.size+511&-512;else{for(we=0;we<Ee.size;++we)Z.write_shift(1,Ee.content[we]);for(;we&511;++we)Z.write_shift(1,0)}for(re=1;re<O.FileIndex.length;++re)if(Ee=O.FileIndex[re],Ee.size>0&&Ee.size<4096)if(Pt&&Buffer.isBuffer(Ee.content))Ee.content.copy(Z,Z.l,0,Ee.size),Z.l+=Ee.size+63&-64;else{for(we=0;we<Ee.size;++we)Z.write_shift(1,Ee.content[we]);for(;we&63;++we)Z.write_shift(1,0)}if(Pt)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function ee(O,te){var K=O.FullPaths.map(function(we){return we.toUpperCase()}),Q=K.map(function(we){var Se=we.split("/");return Se[Se.length-(we.slice(-1)=="/"?2:1)]}),Z=!1;te.charCodeAt(0)===47?(Z=!0,te=K[0].slice(0,-1)+te):Z=te.indexOf("/")!==-1;var re=te.toUpperCase(),ke=Z===!0?K.indexOf(re):Q.indexOf(re);if(ke!==-1)return O.FileIndex[ke];var Fe=!re.match(sl);for(re=re.replace(dn,""),Fe&&(re=re.replace(sl,"!")),ke=0;ke<K.length;++ke)if((Fe?K[ke].replace(sl,"!"):K[ke]).replace(dn,"")==re||(Fe?Q[ke].replace(sl,"!"):Q[ke]).replace(dn,"")==re)return O.FileIndex[ke];return null}var Y=64,fe=-2,de="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:fe,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(O,te,K){h();var Q=ne(O,K);f.writeFileSync(te,Q)}function z(O){for(var te=new Array(O.length),K=0;K<O.length;++K)te[K]=String.fromCharCode(O[K]);return te.join("")}function se(O,te){var K=ne(O,te);switch(te&&te.type||"buffer"){case"file":return h(),f.writeFileSync(te.filename,K),K;case"binary":return typeof K=="string"?K:z(K);case"base64":return Wm(typeof K=="string"?K:z(K));case"buffer":if(Pt)return Buffer.isBuffer(K)?K:vo(K);case"array":return typeof K=="string"?aa(K):K}return K}var R;function S(O){try{var te=O.InflateRaw,K=new te;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)R=O;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function G(O,te){if(!R)return ce(O,te);var K=R.InflateRaw,Q=new K,Z=Q._processChunk(O.slice(O.l),Q._finishFlushFlag);return O.l+=Q.bytesRead,Z}function D(O){return R?R.deflateRawSync(O):pt(O)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function q(O){var te=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(te>>16|te>>8|te)&255}for(var H=typeof Uint8Array<"u",L=H?new Uint8Array(256):[],ue=0;ue<256;++ue)L[ue]=q(ue);function I(O,te){var K=L[O&255];return te<=8?K>>>8-te:(K=K<<8|L[O>>8&255],te<=16?K>>>16-te:(K=K<<8|L[O>>16&255],K>>>24-te))}function Oe(O,te){var K=te&7,Q=te>>>3;return(O[Q]|(K<=6?0:O[Q+1]<<8))>>>K&3}function Ae(O,te){var K=te&7,Q=te>>>3;return(O[Q]|(K<=5?0:O[Q+1]<<8))>>>K&7}function Xe(O,te){var K=te&7,Q=te>>>3;return(O[Q]|(K<=4?0:O[Q+1]<<8))>>>K&15}function qe(O,te){var K=te&7,Q=te>>>3;return(O[Q]|(K<=3?0:O[Q+1]<<8))>>>K&31}function pe(O,te){var K=te&7,Q=te>>>3;return(O[Q]|(K<=1?0:O[Q+1]<<8))>>>K&127}function Ne(O,te,K){var Q=te&7,Z=te>>>3,re=(1<<K)-1,ke=O[Z]>>>Q;return K<8-Q||(ke|=O[Z+1]<<8-Q,K<16-Q)||(ke|=O[Z+2]<<16-Q,K<24-Q)||(ke|=O[Z+3]<<24-Q),ke&re}function je(O,te,K){var Q=te&7,Z=te>>>3;return Q<=5?O[Z]|=(K&7)<<Q:(O[Z]|=K<<Q&255,O[Z+1]=(K&7)>>8-Q),te+3}function _e(O,te,K){var Q=te&7,Z=te>>>3;return K=(K&1)<<Q,O[Z]|=K,te+1}function Qe(O,te,K){var Q=te&7,Z=te>>>3;return K<<=Q,O[Z]|=K&255,K>>>=8,O[Z+1]=K,te+8}function ft(O,te,K){var Q=te&7,Z=te>>>3;return K<<=Q,O[Z]|=K&255,K>>>=8,O[Z+1]=K&255,O[Z+2]=K>>>8,te+16}function ht(O,te){var K=O.length,Q=2*K>te?2*K:te+5,Z=0;if(K>=te)return O;if(Pt){var re=Um(Q);if(O.copy)O.copy(re);else for(;Z<O.length;++Z)re[Z]=O[Z];return re}else if(H){var ke=new Uint8Array(Q);if(ke.set)ke.set(O);else for(;Z<K;++Z)ke[Z]=O[Z];return ke}return O.length=Q,O}function vt(O){for(var te=new Array(O),K=0;K<O;++K)te[K]=0;return te}function jt(O,te,K){var Q=1,Z=0,re=0,ke=0,Fe=0,we=O.length,Se=H?new Uint16Array(32):vt(32);for(re=0;re<32;++re)Se[re]=0;for(re=we;re<K;++re)O[re]=0;we=O.length;var Ee=H?new Uint16Array(we):vt(we);for(re=0;re<we;++re)Se[Z=O[re]]++,Q<Z&&(Q=Z),Ee[re]=0;for(Se[0]=0,re=1;re<=Q;++re)Se[re+16]=Fe=Fe+Se[re-1]<<1;for(re=0;re<we;++re)Fe=O[re],Fe!=0&&(Ee[re]=Se[Fe+16]++);var Be=0;for(re=0;re<we;++re)if(Be=O[re],Be!=0)for(Fe=I(Ee[re],Q)>>Q-Be,ke=(1<<Q+4-Be)-1;ke>=0;--ke)te[Fe|ke<<Be]=Be&15|re<<4;return Q}var Gt=H?new Uint16Array(512):vt(512),sr=H?new Uint16Array(32):vt(32);if(!H){for(var Rt=0;Rt<512;++Rt)Gt[Rt]=0;for(Rt=0;Rt<32;++Rt)sr[Rt]=0}(function(){for(var O=[],te=0;te<32;te++)O.push(5);jt(O,sr,32);var K=[];for(te=0;te<=143;te++)K.push(8);for(;te<=255;te++)K.push(9);for(;te<=279;te++)K.push(7);for(;te<=287;te++)K.push(8);jt(K,Gt,288)})();var Ht=(function(){for(var te=H?new Uint8Array(32768):[],K=0,Q=0;K<A.length-1;++K)for(;Q<A[K+1];++Q)te[Q]=K;for(;Q<32768;++Q)te[Q]=29;var Z=H?new Uint8Array(259):[];for(K=0,Q=0;K<F.length-1;++K)for(;Q<F[K+1];++Q)Z[Q]=K;function re(Fe,we){for(var Se=0;Se<Fe.length;){var Ee=Math.min(65535,Fe.length-Se),Be=Se+Ee==Fe.length;for(we.write_shift(1,+Be),we.write_shift(2,Ee),we.write_shift(2,~Ee&65535);Ee-- >0;)we[we.l++]=Fe[Se++]}return we.l}function ke(Fe,we){for(var Se=0,Ee=0,Be=H?new Uint16Array(32768):[];Ee<Fe.length;){var Je=Math.min(65535,Fe.length-Ee);if(Je<10){for(Se=je(we,Se,+(Ee+Je==Fe.length)),Se&7&&(Se+=8-(Se&7)),we.l=Se/8|0,we.write_shift(2,Je),we.write_shift(2,~Je&65535);Je-- >0;)we[we.l++]=Fe[Ee++];Se=we.l*8;continue}Se=je(we,Se,+(Ee+Je==Fe.length)+2);for(var We=0;Je-- >0;){var Ue=Fe[Ee];We=(We<<5^Ue)&32767;var Ye=-1,gt=0;if((Ye=Be[We])&&(Ye|=Ee&-32768,Ye>Ee&&(Ye-=32768),Ye<Ee))for(;Fe[Ye+gt]==Fe[Ee+gt]&&gt<250;)++gt;if(gt>2){Ue=Z[gt],Ue<=22?Se=Qe(we,Se,L[Ue+1]>>1)-1:(Qe(we,Se,3),Se+=5,Qe(we,Se,L[Ue-23]>>5),Se+=3);var Qt=Ue<8?0:Ue-4>>2;Qt>0&&(ft(we,Se,gt-F[Ue]),Se+=Qt),Ue=te[Ee-Ye],Se=Qe(we,Se,L[Ue]>>3),Se-=3;var Vt=Ue<4?0:Ue-2>>1;Vt>0&&(ft(we,Se,Ee-Ye-A[Ue]),Se+=Vt);for(var mr=0;mr<gt;++mr)Be[We]=Ee&32767,We=(We<<5^Fe[Ee])&32767,++Ee;Je-=gt-1}else Ue<=143?Ue=Ue+48:Se=_e(we,Se,1),Se=Qe(we,Se,L[Ue]),Be[We]=Ee&32767,++Ee}Se=Qe(we,Se,0)-1}return we.l=(Se+7)/8|0,we.l}return function(we,Se){return we.length<8?re(we,Se):ke(we,Se)}})();function pt(O){var te=Tr(50+Math.floor(O.length*1.1)),K=Ht(O,te);return te.slice(0,K)}var Nt=H?new Uint16Array(32768):vt(32768),Yt=H?new Uint16Array(32768):vt(32768),Ft=H?new Uint16Array(128):vt(128),Bt=1,ve=1;function Ze(O,te){var K=qe(O,te)+257;te+=5;var Q=qe(O,te)+1;te+=5;var Z=Xe(O,te)+4;te+=4;for(var re=0,ke=H?new Uint8Array(19):vt(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,Se=H?new Uint8Array(8):vt(8),Ee=H?new Uint8Array(8):vt(8),Be=ke.length,Je=0;Je<Z;++Je)ke[E[Je]]=re=Ae(O,te),we<re&&(we=re),Se[re]++,te+=3;var We=0;for(Se[0]=0,Je=1;Je<=we;++Je)Ee[Je]=We=We+Se[Je-1]<<1;for(Je=0;Je<Be;++Je)(We=ke[Je])!=0&&(Fe[Je]=Ee[We]++);var Ue=0;for(Je=0;Je<Be;++Je)if(Ue=ke[Je],Ue!=0){We=L[Fe[Je]]>>8-Ue;for(var Ye=(1<<7-Ue)-1;Ye>=0;--Ye)Ft[We|Ye<<Ue]=Ue&7|Je<<3}var gt=[];for(we=1;gt.length<K+Q;)switch(We=Ft[pe(O,te)],te+=We&7,We>>>=3){case 16:for(re=3+Oe(O,te),te+=2,We=gt[gt.length-1];re-- >0;)gt.push(We);break;case 17:for(re=3+Ae(O,te),te+=3;re-- >0;)gt.push(0);break;case 18:for(re=11+pe(O,te),te+=7;re-- >0;)gt.push(0);break;default:gt.push(We),we<We&&(we=We);break}var Qt=gt.slice(0,K),Vt=gt.slice(K);for(Je=K;Je<286;++Je)Qt[Je]=0;for(Je=Q;Je<30;++Je)Vt[Je]=0;return Bt=jt(Qt,Nt,286),ve=jt(Vt,Yt,30),te}function kt(O,te){if(O[0]==3&&!(O[1]&3))return[As(te),2];for(var K=0,Q=0,Z=Um(te||1<<18),re=0,ke=Z.length>>>0,Fe=0,we=0;(Q&1)==0;){if(Q=Ae(O,K),K+=3,Q>>>1)Q>>1==1?(Fe=9,we=5):(K=Ze(O,K),Fe=Bt,we=ve);else{K&7&&(K+=8-(K&7));var Se=O[K>>>3]|O[(K>>>3)+1]<<8;if(K+=32,Se>0)for(!te&&ke<re+Se&&(Z=ht(Z,re+Se),ke=Z.length);Se-- >0;)Z[re++]=O[K>>>3],K+=8;continue}for(;;){!te&&ke<re+32767&&(Z=ht(Z,re+32767),ke=Z.length);var Ee=Ne(O,K,Fe),Be=Q>>>1==1?Gt[Ee]:Nt[Ee];if(K+=Be&15,Be>>>=4,(Be>>>8&255)===0)Z[re++]=Be;else{if(Be==256)break;Be-=257;var Je=Be<8?0:Be-4>>2;Je>5&&(Je=0);var We=re+F[Be];Je>0&&(We+=Ne(O,K,Je),K+=Je),Ee=Ne(O,K,we),Be=Q>>>1==1?sr[Ee]:Yt[Ee],K+=Be&15,Be>>>=4;var Ue=Be<4?0:Be-2>>1,Ye=A[Be];for(Ue>0&&(Ye+=Ne(O,K,Ue),K+=Ue),!te&&ke<We&&(Z=ht(Z,We+100),ke=Z.length);re<We;)Z[re]=Z[re-Ye],++re}}}return te?[Z,K+7>>>3]:[Z.slice(0,re),K+7>>>3]}function ce(O,te){var K=O.slice(O.l||0),Q=kt(K,te);return O.l+=Q[1],Q[0]}function Pe(O,te){if(O)typeof console<"u"&&console.error(te);else throw new Error(te)}function ze(O,te){var K=O;Br(K,0);var Q=[],Z=[],re={FileIndex:Q,FullPaths:Z};P(re,{root:te.root});for(var ke=K.length-4;(K[ke]!=80||K[ke+1]!=75||K[ke+2]!=5||K[ke+3]!=6)&&ke>=0;)--ke;K.l=ke+4,K.l+=4;var Fe=K.read_shift(2);K.l+=6;var we=K.read_shift(4);for(K.l=we,ke=0;ke<Fe;++ke){K.l+=20;var Se=K.read_shift(4),Ee=K.read_shift(4),Be=K.read_shift(2),Je=K.read_shift(2),We=K.read_shift(2);K.l+=8;var Ue=K.read_shift(4),Ye=c(K.slice(K.l+Be,K.l+Be+Je));K.l+=Be+Je+We;var gt=K.l;K.l=Ue+4,et(K,Se,Ee,re,Ye),K.l=gt}return re}function et(O,te,K,Q,Z){O.l+=2;var re=O.read_shift(2),ke=O.read_shift(2),Fe=l(O);if(re&8257)throw new Error("Unsupported ZIP encryption");for(var we=O.read_shift(4),Se=O.read_shift(4),Ee=O.read_shift(4),Be=O.read_shift(2),Je=O.read_shift(2),We="",Ue=0;Ue<Be;++Ue)We+=String.fromCharCode(O[O.l++]);if(Je){var Ye=c(O.slice(O.l,O.l+Je));(Ye[21589]||{}).mt&&(Fe=Ye[21589].mt),((Z||{})[21589]||{}).mt&&(Fe=Z[21589].mt)}O.l+=Je;var gt=O.slice(O.l,O.l+Se);switch(ke){case 8:gt=G(O,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Qt=!1;re&8&&(we=O.read_shift(4),we==134695760&&(we=O.read_shift(4),Qt=!0),Se=O.read_shift(4),Ee=O.read_shift(4)),Se!=te&&Pe(Qt,"Bad compressed size: "+te+" != "+Se),Ee!=K&&Pe(Qt,"Bad uncompressed size: "+K+" != "+Ee),tt(Q,We,gt,{unsafe:!0,mt:Fe})}function at(O,te){var K=te||{},Q=[],Z=[],re=Tr(1),ke=K.compression?8:0,Fe=0,we=0,Se=0,Ee=0,Be=0,Je=O.FullPaths[0],We=Je,Ue=O.FileIndex[0],Ye=[],gt=0;for(we=1;we<O.FullPaths.length;++we)if(We=O.FullPaths[we].slice(Je.length),Ue=O.FileIndex[we],!(!Ue.size||!Ue.content||We=="Sh33tJ5")){var Qt=Ee,Vt=Tr(We.length);for(Se=0;Se<We.length;++Se)Vt.write_shift(1,We.charCodeAt(Se)&127);Vt=Vt.slice(0,Vt.l),Ye[Be]=p2.buf(Ue.content,0);var mr=Ue.content;ke==8&&(mr=D(mr)),re=Tr(30),re.write_shift(4,67324752),re.write_shift(2,20),re.write_shift(2,Fe),re.write_shift(2,ke),Ue.mt?o(re,Ue.mt):re.write_shift(4,0),re.write_shift(-4,Ye[Be]),re.write_shift(4,mr.length),re.write_shift(4,Ue.content.length),re.write_shift(2,Vt.length),re.write_shift(2,0),Ee+=re.length,Q.push(re),Ee+=Vt.length,Q.push(Vt),Ee+=mr.length,Q.push(mr),re=Tr(46),re.write_shift(4,33639248),re.write_shift(2,0),re.write_shift(2,20),re.write_shift(2,Fe),re.write_shift(2,ke),re.write_shift(4,0),re.write_shift(-4,Ye[Be]),re.write_shift(4,mr.length),re.write_shift(4,Ue.content.length),re.write_shift(2,Vt.length),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(4,0),re.write_shift(4,Qt),gt+=re.l,Z.push(re),gt+=Vt.length,Z.push(Vt),++Be}return re=Tr(22),re.write_shift(4,101010256),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,Be),re.write_shift(2,Be),re.write_shift(4,gt),re.write_shift(4,Ee),re.write_shift(2,0),Es([Es(Q),Es(Z),re])}var ae={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ge(O,te){if(O.ctype)return O.ctype;var K=O.name||"",Q=K.match(/\.([^\.]+)$/);return Q&&ae[Q[1]]||te&&(Q=(K=te).match(/[\.\\]([^\.\\])+$/),Q&&ae[Q[1]])?ae[Q[1]]:"application/octet-stream"}function De(O){for(var te=Wm(O),K=[],Q=0;Q<te.length;Q+=76)K.push(te.slice(Q,Q+76));return K.join(`\r
`)+`\r
`}function Re(O){var te=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var Ee=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Q=te.split(`\r
`),Z=0;Z<Q.length;++Z){var re=Q[Z];if(re.length==0){K.push("");continue}for(var ke=0;ke<re.length;){var Fe=76,we=re.slice(ke,ke+Fe);we.charAt(Fe-1)=="="?Fe--:we.charAt(Fe-2)=="="?Fe-=2:we.charAt(Fe-3)=="="&&(Fe-=3),we=re.slice(ke,ke+Fe),ke+=Fe,ke<re.length&&(we+="="),K.push(we)}}return K.join(`\r
`)}function $e(O){for(var te=[],K=0;K<O.length;++K){for(var Q=O[K];K<=O.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+O[++K];te.push(Q)}for(var Z=0;Z<te.length;++Z)te[Z]=te[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(re){return String.fromCharCode(parseInt(re.slice(1),16))});return aa(te.join(`\r
`))}function rt(O,te,K){for(var Q="",Z="",re="",ke,Fe=0;Fe<10;++Fe){var we=te[Fe];if(!we||we.match(/^\s*$/))break;var Se=we.match(/^(.*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":Q=Se[2].trim();break;case"content-type":re=Se[2].trim();break;case"content-transfer-encoding":Z=Se[2].trim();break}}switch(++Fe,Z.toLowerCase()){case"base64":ke=aa(Tn(te.slice(Fe).join("")));break;case"quoted-printable":ke=$e(te.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var Ee=tt(O,Q.slice(K.length),ke,{unsafe:!0});re&&(Ee.ctype=re)}function yt(O,te){if(z(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=te&&te.root||"",Q=(Pt&&Buffer.isBuffer(O)?O.toString("binary"):z(O)).split(`\r
`),Z=0,re="";for(Z=0;Z<Q.length;++Z)if(re=Q[Z],!!/^Content-Location:/i.test(re)&&(re=re.slice(re.indexOf("file")),K||(K=re.slice(0,re.lastIndexOf("/")+1)),re.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),re.slice(0,K.length)!=K););var ke=(Q[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Fe="--"+(ke[1]||""),we=[],Se=[],Ee={FileIndex:we,FullPaths:Se};P(Ee);var Be,Je=0;for(Z=0;Z<Q.length;++Z){var We=Q[Z];We!==Fe&&We!==Fe+"--"||(Je++&&rt(Ee,Q.slice(Be,Z),K),Be=Z)}return Ee}function Ut(O,te){var K=te||{},Q=K.boundary||"SheetJS";Q="------="+Q;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],re=O.FullPaths[0],ke=re,Fe=O.FileIndex[0],we=1;we<O.FullPaths.length;++we)if(ke=O.FullPaths[we].slice(re.length),Fe=O.FileIndex[we],!(!Fe.size||!Fe.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gt){return"_x"+gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gt){return"_u"+gt.charCodeAt(0).toString(16)+"_"});for(var Se=Fe.content,Ee=Pt&&Buffer.isBuffer(Se)?Se.toString("binary"):z(Se),Be=0,Je=Math.min(1024,Ee.length),We=0,Ue=0;Ue<=Je;++Ue)(We=Ee.charCodeAt(Ue))>=32&&We<128&&++Be;var Ye=Be>=Je*4/5;Z.push(Q),Z.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+ke),Z.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),Z.push("Content-Type: "+ge(Fe,ke)),Z.push(""),Z.push(Ye?Re(Ee):De(Ee))}return Z.push(Q+`--\r
`),Z.join(`\r
`)}function Ke(O){var te={};return P(te,O),te}function tt(O,te,K,Q){var Z=Q&&Q.unsafe;Z||P(O);var re=!Z&&At.find(O,te);if(!re){var ke=O.FullPaths[0];te.slice(0,ke.length)==ke?ke=te:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+te).replace("//","/")),re={name:a(te),type:2},O.FileIndex.push(re),O.FullPaths.push(ke),Z||At.utils.cfb_gc(O)}return re.content=K,re.size=K?K.length:0,Q&&(Q.CLSID&&(re.clsid=Q.CLSID),Q.mt&&(re.mt=Q.mt),Q.ct&&(re.ct=Q.ct)),re}function Me(O,te){P(O);var K=At.find(O,te);if(K){for(var Q=0;Q<O.FileIndex.length;++Q)if(O.FileIndex[Q]==K)return O.FileIndex.splice(Q,1),O.FullPaths.splice(Q,1),!0}return!1}function nt(O,te,K){P(O);var Q=At.find(O,te);if(Q){for(var Z=0;Z<O.FileIndex.length;++Z)if(O.FileIndex[Z]==Q)return O.FileIndex[Z].name=a(K),O.FullPaths[Z]=K,!0}return!1}function _t(O){B(O,!0)}return n.find=ee,n.read=V,n.parse=p,n.write=se,n.writeFile=le,n.utils={cfb_new:Ke,cfb_add:tt,cfb_del:Me,cfb_mov:nt,cfb_gc:_t,ReadShift:ul,CheckField:Cy,prep_blob:Br,bconcat:Es,use_zlib:S,_deflateRaw:pt,_inflateRaw:ce,consts:X},n})();function h2(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Ca(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function lp(e){for(var n=[],t=Ca(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var Cu=new Date(1899,11,30,0,0,0);function fn(e,n){var t=e.getTime(),r=Cu.getTime()+(e.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4;return(t-r)/(1440*60*1e3)}var oy=new Date,x2=Cu.getTime()+(oy.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4,Xm=oy.getTimezoneOffset();function Xu(e){var n=new Date;return n.setTime(e*24*60*60*1e3+x2),n.getTimezoneOffset()!==Xm&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Xm)*6e4),n}function m2(e){var n=0,t=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(t=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=t*parseInt(a[o],10)}return n}var qm=new Date("2017-02-19T19:06:09.000Z"),iy=isNaN(qm.getFullYear())?new Date("2/19/17"):qm,g2=iy.getFullYear()==2017;function zr(e,n){var t=new Date(e);if(g2)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(iy.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function fo(e,n){if(Pt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return il(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return il(Kv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return il(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return il(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=Ur(e[t]));return n}function pr(e,n){for(var t="";t.length<n;)t+=e;return t}function ia(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var v2=["january","february","march","april","may","june","july","august","september","october","november","december"];function li(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),a=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&v2.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return r<0||r>8099?t:(a>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var y2=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),l=[o[0]],c=1;c<o.length;++c)l.push(a),l.push(o[c]);return l}})();function ly(e){return e?e.content&&e.type?fo(e.content,!0):e.data?al(e.data):e.asNodeBuffer&&Pt?al(e.asNodeBuffer().toString("binary")):e.asBinary?al(e.asBinary()):e._data&&e._data.getContent?al(fo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function cy(e){if(!e)return null;if(e.data)return Lm(e.data);if(e.asNodeBuffer&&Pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Lm(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function w2(e){return e&&e.name.slice(-4)===".bin"?cy(e):ly(e)}function Bn(e,n){for(var t=e.FullPaths||Ca(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var l=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function cp(e,n){var t=Bn(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function Sr(e,n,t){if(!t)return w2(cp(e,n));if(!n)return null;try{return Sr(e,n)}catch{return null}}function Nn(e,n,t){if(!t)return ly(cp(e,n));if(!n)return null;try{return Nn(e,n)}catch{return null}}function k2(e,n,t){return cy(cp(e,n))}function Zm(e){for(var n=e.FullPaths||Ca(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function b2(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return Pt?r=vo(t):r=Wb(t),At.utils.cfb_add(e,n,r)}At.utils.cfb_add(e,n,t)}else e.file(n,t)}function uy(e,n){switch(n.type){case"base64":return At.read(e,{type:"base64"});case"binary":return At.read(e,{type:"binary"});case"buffer":case"array":return At.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ol(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var dy=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_2=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Jm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,S2=/<[^>]*>/g,en=dy.match(Jm)?Jm:S2,E2=/<\w*:/,N2=/<(\/?)\w+:/;function wt(e,n,t){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(n||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(_2),c=0,f="",h=0,p="",m="",g=1;if(l)for(h=0;h!=l.length;++h){for(m=l[h],o=0;o!=m.length&&m.charCodeAt(o)!==61;++o);for(p=m.slice(0,o).trim();m.charCodeAt(o+1)==32;)++o;for(g=(a=m.charCodeAt(o+1))==34||a==39?1:0,f=m.slice(o+1+g,m.length-g),c=0;c!=p.length&&p.charCodeAt(c)!==58;++c);if(c===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=f,r[p.toLowerCase()]=f;else{var v=(c===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(c+1);if(r[v]&&p.slice(c-3,c)=="ext")continue;r[v]=f,r[v.toLowerCase()]=f}}return r}function Da(e){return e.replace(N2,"<$1")}var fy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},C2=lp(fy),Lt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(c,f){return fy[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(n,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,o))+a.slice(o+9,l)+t(a.slice(l+3))}})(),T2=/[&<>'"]/g,D2=/[\u0000-\u001f]/g;function up(e){var n=e+"";return n.replace(T2,function(t){return C2[t]}).replace(/\n/g,"<br/>").replace(D2,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var eg=(function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function ir(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function J0(e){for(var n="",t=0,r=0,a=0,o=0,l=0,c=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(a=e.charCodeAt(t++),r>191&&r<224){l=(r&31)<<6,l|=a&63,n+=String.fromCharCode(l);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(t++),c=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,n+=String.fromCharCode(55296+(c>>>10&1023)),n+=String.fromCharCode(56320+(c&1023))}return n}function tg(e){var n=As(2*e.length),t,r,a=1,o=0,l=0,c;for(r=0;r<e.length;r+=a)a=1,(c=e.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(e.charCodeAt(r+1)&63),a=2):c<240?(t=(c&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,t=(c&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(n[o++]=l&255,n[o++]=l>>>8,l=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function rg(e){return vo(e,"binary").toString("utf8")}var eu="foo bar baz",tr=Pt&&(rg(eu)==J0(eu)&&rg||tg(eu)==J0(eu)&&tg)||J0,il=Pt?function(e){return vo(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,a=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(a>>18&7))),n.push(String.fromCharCode(144+(a>>12&63))),n.push(String.fromCharCode(128+(a>>6&63))),n.push(String.fromCharCode(128+(a&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},bl=(function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}})(),py=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),F2=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),j2=/<\/?(?:vt:)?variant>/g,P2=/<(?:vt:)([^>]*)>([\s\S]*)</;function ng(e,n){var t=wt(e),r=e.match(F2(t.baseType))||[],a=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(o){var l=o.replace(j2,"").match(P2);l&&a.push({v:tr(l[2]),t:l[1]})}),a}var A2=/(^\s|\s$|\n)/;function O2(e){return Ca(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function R2(e,n,t){return"<"+e+(t!=null?O2(t):"")+(n!=null?(n.match(A2)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function dp(e){if(Pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return tr(yo(sp(e)));throw new Error("Bad input format: expected Buffer or string")}var _l=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,z2={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},M2=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function I2(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),a=e[n+6]&15,o=5;o>=0;--o)a=a*256+e[n+o];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function L2(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,a=0,o=0,l=r?-n:n;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(n)?26985:0);for(var c=0;c<=5;++c,o/=256)e[t+c]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|r}var ag=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=t)n.push.apply(n,e[0][r].slice(a,a+t));return n},sg=Pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:vo(n)})):ag(e)}:ag,og=function(e,n,t){for(var r=[],a=n;a<t;a+=2)r.push(String.fromCharCode(Ya(e,a)));return r.join("").replace(dn,"")},fp=Pt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(dn,""):og(e,n,t)}:og,ig=function(e,n,t){for(var r=[],a=n;a<n+t;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},hy=Pt?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):ig(e,n,t)}:ig,lg=function(e,n,t){for(var r=[],a=n;a<t;a++)r.push(String.fromCharCode(Zo(e,a)));return r.join("")},Al=Pt?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):lg(n,t,r)}:lg,xy=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},my=xy,gy=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},vy=gy,yy=function(e,n){var t=2*En(e,n);return t>0?Al(e,n+4,n+4+t-1):""},wy=yy,ky=function(n,t){var r=En(n,t);return r>0?fp(n,t+4,t+4+r):""},by=ky,_y=function(e,n){var t=En(e,n);return t>0?Al(e,n+4,n+4+t):""},Sy=_y,Ey=function(e,n){return I2(e,n)},Tu=Ey,Ny=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Pt&&(my=function(n,t){if(!Buffer.isBuffer(n))return xy(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},vy=function(n,t){if(!Buffer.isBuffer(n))return gy(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},wy=function(n,t){if(!Buffer.isBuffer(n))return yy(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},by=function(n,t){if(!Buffer.isBuffer(n))return ky(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},Sy=function(n,t){if(!Buffer.isBuffer(n))return _y(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Tu=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):Ey(n,t)},Ny=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var Zo=function(e,n){return e[n]},Ya=function(e,n){return e[n+1]*256+e[n]},B2=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},En=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},eo=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},W2=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ul(e,n){var t="",r,a,o=[],l,c,f,h;switch(n){case"dbcs":if(h=this.l,Pt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)t+=String.fromCharCode(Ya(this,h)),h+=2;e*=2;break;case"utf8":t=Al(this,this.l,this.l+e);break;case"utf16le":e*=2,t=fp(this,this.l,this.l+e);break;case"wstr":return ul.call(this,e,"dbcs");case"lpstr-ansi":t=my(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":t=vy(this,this.l),e=4+En(this,this.l);break;case"lpwstr":t=wy(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),t=by(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),t=Sy(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(l=Zo(this,this.l+e++))!==0;)o.push(Jc(l));t=o.join("");break;case"_wstr":for(e=0,t="";(l=Ya(this,this.l+e))!==0;)o.push(Jc(l)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Ya(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Zo(this,h),this.l=h+1,c=ul.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+c;o.push(Jc(Zo(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return r=Zo(this,this.l),this.l++,r;case 2:return r=(n==="i"?B2:Ya)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?eo:W2)(this,this.l),this.l+=4,r):(a=En(this,this.l),this.l+=4,a);case 8:case-8:if(n==="f")return e==8?a=Tu(this,this.l):a=Tu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=hy(this,this.l,e);break}}return this.l+=e,t}var U2=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},$2=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},H2=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function Y2(e,n,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=n.length;++a)H2(this,n.charCodeAt(a),this.l+2*a);r=2*n.length}else if(t==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=n.length;++a)this[this.l+a]=n.charCodeAt(a)&255;r=n.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(n.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(n.length,e);++a){var l=n.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,U2(this,n,this.l);break;case 8:if(r=8,t==="f"){L2(this,n,this.l);break}case 16:break;case-4:r=4,$2(this,n,this.l);break}return this.l+=r,this}function Cy(e,n){var t=hy(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Br(e,n){e.l=n,e.read_shift=ul,e.chk=Cy,e.write_shift=Y2}function Jr(e,n){e.l+=n}function Tr(e){var n=As(e);return Br(n,0),n}function ts(e,n,t){if(e){var r,a,o;Br(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var h=Ou[c]||Ou[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;f=e.l+o;var p=h.f&&h.f(e,o,t);if(e.l=f,n(p,h,c))return}}}function Nf(){var e=[],n=Pt?256:2048,t=function(h){var p=Tr(h);return Br(p,0),p},r=t(n),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=t(Math.max(h+1,n)))},l=function(){return a(),Es(e)},c=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:c,end:l,_bufs:e}}function dl(e,n,t){var r=Ur(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function cg(e,n,t){var r=Ur(e);return r.s=dl(r.s,n.s,t),r.e=dl(r.e,n.s,t),r}function fl(e,n){if(e.cRel&&e.c<0)for(e=Ur(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Ur(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=St(e);return!e.cRel&&e.cRel!=null&&(t=G2(t)),!e.rRel&&e.rRel!=null&&(t=V2(t)),t}function ef(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Dr(e.s.c)+":"+(e.e.cRel?"":"$")+Dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$r(e.s.r)+":"+(e.e.rRel?"":"$")+$r(e.e.r):fl(e.s,n.biff)+":"+fl(e.e,n.biff)}function pp(e){return parseInt(K2(e),10)-1}function $r(e){return""+(e+1)}function V2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K2(e){return e.replace(/\$(\d+)$/,"$1")}function hp(e){for(var n=Q2(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Dr(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function G2(e){return e.replace(/^([A-Z])/,"$$$1")}function Q2(e){return e.replace(/^\$([A-Z])/,"$1")}function X2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var n=0,t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?n=10*n+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:n-1}}function St(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function gi(e){var n=e.indexOf(":");return n==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,n)),e:ln(e.slice(n+1))}}function Ot(e,n){return typeof n>"u"||typeof n=="number"?Ot(e.s,e.e):(typeof e!="string"&&(e=St(e)),typeof n!="string"&&(n=St(n)),e==n?e:e+":"+n)}function hr(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,o=e.length;for(t=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.s.c=--t,t=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(n.s.r=--t,r===o||a!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(n.e.c=--t,t=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return n.e.r=--t,n}function ug(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Vn(e.z,t?fn(n):n)}catch{}try{return e.w=Vn((e.XF||{}).numFmtId||(t?14:0),t?fn(n):n)}catch{return""+n}}function Ja(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?bo[e.v]||e.v:n==null?ug(e,e.v):ug(e,n))}function Ms(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function Ty(e,n,t){var r=t||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,c=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=hr(o["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),l==-1&&(h.e.r=l=p.e.r+1)}for(var m=0;m!=n.length;++m)if(n[m]){if(!Array.isArray(n[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[m].length;++g)if(!(typeof n[m][g]>"u")){var v={v:n[m][g]},w=l+m,b=c+g;if(h.s.r>w&&(h.s.r=w),h.s.c>b&&(h.s.c=b),h.e.r<w&&(h.e.r=w),h.e.c<b&&(h.e.c=b),n[m][g]&&typeof n[m][g]=="object"&&!Array.isArray(n[m][g])&&!(n[m][g]instanceof Date))v=n[m][g];else if(Array.isArray(v.v)&&(v.f=n[m][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(r.nullError)v.t="e",v.v=0;else if(r.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=r.dateNF||Et[14],r.cellDates?(v.t="d",v.w=Vn(v.z,fn(v.v))):(v.t="n",v.v=fn(v.v),v.w=Vn(v.z,v.v))):v.t="s";if(a)o[w]||(o[w]=[]),o[w][b]&&o[w][b].z&&(v.z=o[w][b].z),o[w][b]=v;else{var k=St({c:b,r:w});o[k]&&o[k].z&&(v.z=o[k].z),o[k]=v}}}return h.s.c<1e7&&(o["!ref"]=Ot(h)),o}function vi(e,n){return Ty(null,e,n)}function q2(e){return e.read_shift(4,"i")}function Zr(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function Z2(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function xp(e,n){var t=e.l,r=e.read_shift(1),a=Zr(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)o.push(Z2(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=t+n,l}var J2=xp;function Gn(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function wo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var e_=Zr;function mp(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var t_=Zr,Cf=mp;function gp(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var a=r===0?Tu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):eo(n,0)>>2;return t?a/100:a}function Dy(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var ko=Dy;function Xr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function r_(e){var n={},t=e.read_shift(1),r=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=a;var h=so[a];h&&(n.rgb=El(h));break;case 2:n.rgb=El([l,c,f]);break;case 3:n.theme=a;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function n_(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function Fy(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function a_(e){return Fy(e,1)}function s_(e){return Fy(e,2)}var vp=2,yn=3,tu=11,dg=12,Du=19,ru=64,o_=65,i_=71,l_=4108,c_=4126,Rr=80,jy=81,u_=[Rr,jy],d_={1:{n:"CodePage",t:vp},2:{n:"Category",t:Rr},3:{n:"PresentationFormat",t:Rr},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:tu},12:{n:"HeadingPairs",t:l_},13:{n:"TitlesOfParts",t:c_},14:{n:"Manager",t:Rr},15:{n:"Company",t:Rr},16:{n:"LinksUpToDate",t:tu},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:tu},22:{n:"HyperlinksChanged",t:tu},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:o_},26:{n:"ContentType",t:Rr},27:{n:"ContentStatus",t:Rr},28:{n:"Language",t:Rr},29:{n:"Version",t:Rr},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},f_={1:{n:"CodePage",t:vp},2:{n:"Title",t:Rr},3:{n:"Subject",t:Rr},4:{n:"Author",t:Rr},5:{n:"Keywords",t:Rr},6:{n:"Comments",t:Rr},7:{n:"Template",t:Rr},8:{n:"LastAuthor",t:Rr},9:{n:"RevNumber",t:Rr},10:{n:"EditTime",t:ru},11:{n:"LastPrinted",t:ru},12:{n:"CreatedDate",t:ru},13:{n:"ModifiedDate",t:ru},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:i_},18:{n:"Application",t:Rr},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},fg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},p_=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function h_(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var x_=h_([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),so=Ur(x_),bo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Py={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function m_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function g_(e){var n=m_();if(!e||!e.match)return n;var t={};if((e.match(en)||[]).forEach(function(r){var a=wt(r);switch(a[0].replace(E2,"<")){case"<?xml":break;case"<Types":n.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":n[pg[a.ContentType]]!==void 0&&n[pg[a.ContentType]].push(a.PartName);break}}),n.xmlns!==z2.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var ei={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tf(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function pl(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(en)||[]).forEach(function(a){var o=wt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var c=o.TargetMode==="External"?o.Target:ol(o.Target,n);t[c]=l,r[o.Id]=l}}),t["!id"]=r,t}var v_="application/vnd.oasis.opendocument.spreadsheet";function y_(e,n){for(var t=dp(e),r,a;r=_l.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=wt(r[0],!1),a.path=="/"&&a.type!==v_)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var hl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],w_=(function(){for(var e=new Array(hl.length),n=0;n<hl.length;++n){var t=hl[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function Ay(e){var n={};e=tr(e);for(var t=0;t<hl.length;++t){var r=hl[t],a=e.match(w_[t]);a!=null&&a.length>0&&(n[r[1]]=Lt(a[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=zr(n[r[1]]))}return n}var k_=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Oy(e,n,t,r){var a=[];if(typeof e=="string")a=ng(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(p){return{v:p}}));var l=typeof n=="string"?ng(n,r).map(function(p){return p.v}):n,c=0,f=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(c,c+f);break}c+=f}}function b_(e,n,t){var r={};return n||(n={}),e=tr(e),k_.forEach(function(a){var o=(e.match(bl(a[0]))||[])[1];switch(a[2]){case"string":o&&(n[a[1]]=Lt(o));break;case"bool":n[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&Oy(r.HeadingPairs,r.TitlesOfParts,n,t),n}var __=/<[^>]+>[^<]*/g;function S_(e,n){var t={},r="",a=e.match(__);if(a)for(var o=0;o!=a.length;++o){var l=a[o],c=wt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Lt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),p=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[r]=Lt(p);break;case"bool":t[r]=ir(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(p);break;case"filetime":case"date":t[r]=zr(p);break;case"cy":case"error":t[r]=Lt(p);break;default:if(h.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(n.WTF)throw new Error(l)}}}return t}var E_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},tf;function N_(e,n,t){tf||(tf=lp(E_)),n=tf[n]||n,e[n]=t}function yp(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ry(e,n,t){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return a}function zy(e,n,t){var r=e.read_shift(0,"lpwstr");return r}function My(e,n,t){return n===31?zy(e):Ry(e,n,t)}function Df(e,n,t){return My(e,n,t===!1?0:4)}function C_(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return My(e,n,0)}function T_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var a=e.l;t[r]=e.read_shift(0,"lpwstr").replace(dn,""),e.l-a&2&&(e.l+=2)}return t}function D_(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(dn,"");return t}function F_(e){var n=e.l,t=Fu(e,jy);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Fu(e,yn);return[t,r]}function j_(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(F_(e));return t}function hg(e,n){for(var t=e.read_shift(4),r={},a=0;a!=t;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,n===1200?"utf16le":"utf8").replace(dn,"").replace(sl,"!"),n===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function Iy(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function P_(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Fu(e,n,t){var r=e.read_shift(2),a,o=t||{};if(e.l+=2,n!==dg&&r!==n&&u_.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===dg?r:n){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Ry(e,r,4).replace(dn,"");case 31:return zy(e);case 64:return yp(e);case 65:return Iy(e);case 71:return P_(e);case 80:return Df(e,r,!o.raw).replace(dn,"");case 81:return C_(e,r).replace(dn,"");case 4108:return j_(e);case 4126:case 4127:return r==4127?T_(e):D_(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function xg(e,n){var t=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,c=0,f=-1,h={};for(l=0;l!=a;++l){var p=e.read_shift(4),m=e.read_shift(4);o[l]=[p,m+t]}o.sort(function(j,C){return j[1]-C[1]});var g={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var v=!0;if(l>0&&n)switch(n[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,v=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break}if((!n||l==0)&&e.l<=o[l][1]&&(v=!1,e.l=o[l][1]),v)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(n){var w=n[o[l][0]];if(g[w.n]=Fu(e,w.t,{raw:!0}),w.p==="version"&&(g[w.n]=String(g[w.n]>>16)+"."+("0000"+String(g[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(g[w.n]){case 0:g[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:sa(c=g[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[w.n])}}else if(o[l][0]===1){if(c=g.CodePage=Fu(e,vp),sa(c),f!==-1){var b=e.l;e.l=o[f][1],h=hg(e,c),e.l=b}}else if(o[l][0]===0){if(c===0){f=l,e.l=o[l+1][1];continue}h=hg(e,c)}else{var k=h[o[l][0]],T;switch(e[e.l]){case 65:e.l+=4,T=Iy(e);break;case 30:e.l+=4,T=Df(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,T=Df(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,T=e.read_shift(4,"i");break;case 19:e.l+=4,T=e.read_shift(4);break;case 5:e.l+=4,T=e.read_shift(8,"f");break;case 11:e.l+=4,T=yr(e,4);break;case 64:e.l+=4,T=zr(yp(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[k]=T}}return e.l=t+r,g}function mg(e,n,t){var r=e.content;if(!r)return{};Br(r,0);var a,o,l,c,f=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),p=r.read_shift(16);if(p!==At.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),f=r.read_shift(4));var m=xg(r,n),g={SystemIdentifier:h};for(var v in m)g[v]=m[v];if(g.FMTID=o,a===1)return g;if(f-r.l==2&&(r.l+=2),r.l!==f)throw new Error("Length mismatch 2: "+r.l+" !== "+f);var w;try{w=xg(r,null)}catch{}for(v in w)g[v]=w[v];return g.FMTID=[o,l],g}function _s(e,n){return e.read_shift(n),null}function A_(e,n,t){for(var r=[],a=e.l+n;e.l<a;)r.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function yr(e,n){return e.read_shift(n)===1}function Er(e){return e.read_shift(2,"u")}function Ly(e,n){return A_(e,n,Er)}function O_(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function Ol(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function R_(e){var n=e.read_shift(2),t=e.read_shift(1),r=t&4,a=t&8,o=1+(t&1),l=0,c,f={};a&&(l=e.read_shift(2)),r&&(c=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",p=n===0?"":e.read_shift(n,h);return a&&(e.l+=4*l),r&&(e.l+=c),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function po(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Rl(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):po(e,r,t)}function _o(e,n,t){if(t.biff>5)return Rl(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function z_(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function M_(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var a=e.read_shift((r?n-24:n)>>1,"utf16le").replace(dn,"");return r&&(e.l+=24),a}function I_(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(dn,"");return t+l}function L_(e,n){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return M_(e);case"0303000000000000c000000000000046":return I_(e);default:throw new Error("Unsupported Moniker "+t)}}function nu(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(dn,""):"";return t}function B_(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,c,f,h="",p,m;a&16&&(o=nu(e,t-e.l)),a&128&&(l=nu(e,t-e.l)),(a&257)===257&&(c=nu(e,t-e.l)),(a&257)===1&&(f=L_(e,t-e.l)),a&8&&(h=nu(e,t-e.l)),a&32&&(p=e.read_shift(16)),a&64&&(m=yp(e)),e.l=t;var g=l||c||f||"";g&&h&&(g+="#"+h),g||(g="#"+h),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return p&&(v.guid=p),m&&(v.time=m),o&&(v.Tooltip=o),v}function By(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[n,t,r,a]}function Wy(e,n){var t=By(e);return t[3]=0,t}function Fa(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function W_(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function U_(e,n,t){return n===0?"":_o(e,n,t)}function $_(e,n,t){var r=t.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function Uy(e){var n=e.read_shift(2),t=gp(e);return[n,t]}function H_(e,n,t){e.l+=4,n-=4;var r=e.l+n,a=Ol(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function qu(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:n},e:{c:a,r:t}}}function $y(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:n},e:{c:a,r:t}}}var Y_=$y;function Hy(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function V_(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function K_(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Gr(e){e.l+=2,e.l+=e.read_shift(2)}var G_={0:Gr,4:Gr,5:Gr,6:Gr,7:K_,8:Gr,9:Gr,10:Gr,11:Gr,12:Gr,13:V_,14:Gr,15:Gr,16:Gr,17:Gr,18:Gr,19:Gr,20:Gr,21:Hy};function Q_(e,n){for(var t=e.l+n,r=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{r.push(G_[a](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function au(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function X_(e,n){return n===0||e.read_shift(2),1200}function q_(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,a=_o(e,0,t);return e.read_shift(n+r-e.l),a}function Z_(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function J_(e,n,t){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Ol(e,0,t);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function eS(e,n){for(var t=e.l+n,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<t;++l)o.push(R_(e));return o.Count=r,o.Unique=a,o}function tS(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function rS(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function nS(e){var n=W_(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function aS(e){return e.read_shift(2),e.read_shift(4)}function gg(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function sS(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),h=e.read_shift(2);return{Pos:[n,t],Dim:[r,a],Flags:o,CurTab:l,FirstTab:c,Selected:f,TabRatio:h}}function oS(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function iS(){}function lS(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Ol(e,0,t),r}function cS(e){var n=Fa(e);return n.isst=e.read_shift(4),n}function uS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,a=Fa(e);t.biff==2&&e.l++;var o=Rl(e,r-e.l,t);return a.val=o,a}function dS(e,n,t){var r=e.read_shift(2),a=_o(e,0,t);return[r,a]}var fS=_o;function vg(e,n,t){var r=e.l+n,a=t.biff==8||!t.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=r,{s:{r:o,c},e:{r:l,c:f}}}function pS(e){var n=e.read_shift(2),t=e.read_shift(2),r=Uy(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function hS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(Uy(e));if(e.l!==t)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function xS(e,n){for(var t=e.l+n-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function mS(e,n,t,r){var a={},o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=p_[c>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function gS(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=mS(e,n,r.fStyle,t),r}function vS(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function yg(e,n,t){var r=Fa(e);(t.biff==2||n==9)&&++e.l;var a=O_(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function yS(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Fa(e),a=Xr(e);return r.val=a,r}var wg=U_;function wS(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=po(e,o),c=[];r>e.l;)c.push(Rl(e));return[o,a,l,c]}function kg(e,n,t){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=H_(e,n-2,t)),o.body=a||e.read_shift(n-2),typeof a=="string"&&(o.Name=a),o}var kS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function bg(e,n,t){var r=e.l+n,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),f=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=po(e,l,t);a&32&&(h=kS[h.charCodeAt(0)]);var p=r-e.l;t&&t.biff==2&&--p;var m=r==e.l||c===0||!(p>0)?[]:rT(e,p,t,c);return{chKey:o,Name:h,itab:f,rgce:m}}function Yy(e,n,t){if(t.biff<8)return bS(e,n,t);for(var r=[],a=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push($_(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function bS(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=Ol(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function _S(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),a=e.read_shift(2),o=po(e,r,t),l=po(e,a,t);return[o,l]}function SS(e,n,t){var r=$y(e);e.l++;var a=e.read_shift(1);return n-=8,[nT(e,n,t),a,r]}function _g(e,n,t){var r=Y_(e);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,eT(e,n,t)]}function ES(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function NS(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=_o(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:a},c,l,o]}}function CS(e,n,t){return NS(e,n,t)}function TS(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(qu(e));return t}function DS(e,n,t){if(t&&t.biff<8)return jS(e,n,t);var r=Hy(e),a=Q_(e,n-22,r[1]);return{cmo:r,ft:a}}var FS={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:r}}};function jS(e,n,t){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var l=[];return l.push((FS[r]||Jr)(e,n,t)),{cmo:[a,r,o],ft:l}}function PS(e,n,t){var r=e.l,a="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=z_(e,6,t);var c=e.read_shift(2);e.read_shift(2),Er(e,2);var f=e.read_shift(2);e.l+=f;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],m=po(e,e.lens[h+1]-e.lens[h]-1);if(a+=m,a.length>=(p?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=r+n,{t:a}}catch{return e.l=r+n,{t:a}}}function AS(e,n){var t=qu(e);e.l+=16;var r=B_(e,n-24);return[t,r]}function OS(e,n){e.read_shift(2);var t=qu(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(dn,""),[t,r]}function RS(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=fg[t]||t,t=e.read_shift(2),n[1]=fg[t]||t,n}function zS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(Wy(e));return t}function MS(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(Wy(e));return t}function IS(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Vy(e,n,t){if(!t.cellStyles)return Jr(e,n);var r=t&&t.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),c=e.read_shift(r),f=e.read_shift(2);r==2&&(e.l+=2);var h={s:a,e:o,w:l,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(h.level=f>>8&7),h}function LS(e,n){var t={};return n<32||(e.l+=16,t.header=Xr(e),t.footer=Xr(e),e.l+=2),t}function BS(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}var WS=Fa,US=Ly,$S=Rl;function HS(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function YS(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Fa(e);++e.l;var a=_o(e,n-7,t);return r.t="str",r.val=a,r}function VS(e){var n=Fa(e);++e.l;var t=Xr(e);return n.t="n",n.val=t,n}function KS(e){var n=Fa(e);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function GS(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function QS(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function XS(e,n,t){var r=e.l+n,a=Fa(e),o=e.read_shift(2),l=po(e,o,t);return e.l=r,a.t="str",a.val=l,a}var qS=[2,3,48,49,131,139,140,245],Sg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=lp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var h=[],p=As(1);switch(f.type){case"base64":p=aa(Tn(c));break;case"binary":p=aa(c);break;case"buffer":case"array":p=c;break}Br(p,0);var m=p.read_shift(1),g=!!(m&136),v=!1,w=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var b=0,k=521;m==2&&(b=p.read_shift(2)),p.l+=3,m!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),m!=2&&(k=p.read_shift(2));var T=p.read_shift(2),j=f.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(j=e[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var C=[],W={},J=Math.min(p.length,m==2?521:k-10-(v?264:0)),V=w?32:11;p.l<J&&p[p.l]!=13;)switch(W={},W.name=wl.utils.decode(j,p.slice(p.l,p.l+V)).replace(/[\u0000\r\n].*$/g,""),p.l+=V,W.type=String.fromCharCode(p.read_shift(1)),m!=2&&!w&&(W.offset=p.read_shift(4)),W.len=p.read_shift(1),m==2&&(W.offset=p.read_shift(2)),W.dec=p.read_shift(1),W.name.length&&C.push(W),m!=2&&(p.l+=w?13:14),W.type){case"B":(!v||W.len!=8)&&f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(p[p.l]!==13&&(p.l=k-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=k;var P=0,U=0;for(h[0]=[],U=0;U!=C.length;++U)h[0][U]=C[U].name;for(;b-- >0;){if(p[p.l]===42){p.l+=T;continue}for(++p.l,h[++P]=[],U=0,U=0;U!=C.length;++U){var B=p.slice(p.l,p.l+C[U].len);p.l+=C[U].len,Br(B,0);var ne=wl.utils.decode(j,B);switch(C[U].type){case"C":ne.trim().length&&(h[P][U]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?h[P][U]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):h[P][U]=ne;break;case"F":h[P][U]=parseFloat(ne.trim());break;case"+":case"I":h[P][U]=w?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":h[P][U]=!0;break;case"N":case"F":h[P][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[P][U]="##MEMO##"+(w?parseInt(ne.trim(),10):B.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(h[P][U]=+ne||0);break;case"@":h[P][U]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":h[P][U]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":h[P][U]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[P][U]=-B.read_shift(-8,"f");break;case"B":if(v&&C[U].len==8){h[P][U]=B.read_shift(8,"f");break}case"G":case"P":B.l+=C[U].len;break;case"0":if(C[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[U].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=C,h}function r(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var p=vi(t(c,h),h);return p["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,p}function a(c,f){try{return Ms(r(c,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var h=f||{};if(+h.codepage>=0&&sa(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Nf(),m=zf(c,{header:1,raw:!0,cellDates:!0}),g=m[0],v=m.slice(1),w=c["!cols"]||[],b=0,k=0,T=0,j=1;for(b=0;b<g.length;++b){if(((w[b]||{}).DBF||{}).name){g[b]=w[b].DBF.name,++T;continue}if(g[b]!=null){if(++T,typeof g[b]=="number"&&(g[b]=g[b].toString(10)),typeof g[b]!="string")throw new Error("DBF Invalid column name "+g[b]+" |"+typeof g[b]+"|");if(g.indexOf(g[b])!==b){for(k=0;k<1024;++k)if(g.indexOf(g[b]+"_"+k)==-1){g[b]+="_"+k;break}}}}var C=hr(c["!ref"]),W=[],J=[],V=[];for(b=0;b<=C.e.c-C.s.c;++b){var P="",U="",B=0,ne=[];for(k=0;k<v.length;++k)v[k][b]!=null&&ne.push(v[k][b]);if(ne.length==0||g[b]==null){W[b]="?";continue}for(k=0;k<ne.length;++k){switch(typeof ne[k]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=ne[k]instanceof Date?"D":"C";break;default:U="C"}B=Math.max(B,String(ne[k]).length),P=P&&P!=U?"C":U}B>250&&(B=250),U=((w[b]||{}).DBF||{}).type,U=="C"&&w[b].DBF.len>B&&(B=w[b].DBF.len),P=="B"&&U=="N"&&(P="N",V[b]=w[b].DBF.dec,B=w[b].DBF.len),J[b]=P=="C"||U=="N"?B:o[P]||0,j+=J[b],W[b]=P}var ee=p.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,v.length),ee.write_shift(2,296+32*T),ee.write_shift(2,j),b=0;b<4;++b)ee.write_shift(4,0);for(ee.write_shift(4,0|(+n[Yv]||3)<<8),b=0,k=0;b<g.length;++b)if(g[b]!=null){var Y=p.next(32),fe=(g[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,fe,"sbcs"),Y.write_shift(1,W[b]=="?"?"C":W[b],"sbcs"),Y.write_shift(4,k),Y.write_shift(1,J[b]||o[W[b]]||0),Y.write_shift(1,V[b]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),k+=J[b]||o[W[b]]||0}var de=p.next(264);for(de.write_shift(4,13),b=0;b<65;++b)de.write_shift(4,0);for(b=0;b<v.length;++b){var oe=p.next(j);for(oe.write_shift(1,0),k=0;k<g.length;++k)if(g[k]!=null)switch(W[k]){case"L":oe.write_shift(1,v[b][k]==null?63:v[b][k]?84:70);break;case"B":oe.write_shift(8,v[b][k]||0,"f");break;case"N":var he="0";for(typeof v[b][k]=="number"&&(he=v[b][k].toFixed(V[k]||0)),T=0;T<J[k]-he.length;++T)oe.write_shift(1,32);oe.write_shift(1,he,"sbcs");break;case"D":v[b][k]?(oe.write_shift(4,("0000"+v[b][k].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(v[b][k].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+v[b][k].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var X=String(v[b][k]!=null?v[b][k]:"").slice(0,J[k]);for(oe.write_shift(1,X,"sbcs"),T=0;T<J[k]-X.length;++T)oe.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),ZS=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ca(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,v){var w=e[v];return typeof w=="number"?Bm(w):w},r=function(g,v,w){var b=v.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?g:Bm(b)};e["|"]=254;function a(g,v){switch(v.type){case"base64":return o(Tn(g),v);case"binary":return o(g,v);case"buffer":return o(Pt&&Buffer.isBuffer(g)?g.toString("binary"):yo(g),v);case"array":return o(fo(g),v)}throw new Error("Unrecognized type "+v.type)}function o(g,v){var w=g.split(/[\n\r]+/),b=-1,k=-1,T=0,j=0,C=[],W=[],J=null,V={},P=[],U=[],B=[],ne=0,ee;for(+v.codepage>=0&&sa(+v.codepage);T!==w.length;++T){ne=0;var Y=w[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),fe=Y.replace(/;;/g,"\0").split(";").map(function(E){return E.replace(/\u0000/g,";")}),de=fe[0],oe;if(Y.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":fe[1].charAt(0)=="P"&&W.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,X=!1,le=!1,z=!1,se=-1,R=-1;for(j=1;j<fe.length;++j)switch(fe[j].charAt(0)){case"A":break;case"X":k=parseInt(fe[j].slice(1))-1,X=!0;break;case"Y":for(b=parseInt(fe[j].slice(1))-1,X||(k=0),ee=C.length;ee<=b;++ee)C[ee]=[];break;case"K":oe=fe[j].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(ia(oe))?isNaN(li(oe).getDate())||(oe=zr(oe)):(oe=ia(oe),J!==null&&mi(J)&&(oe=Xu(oe))),he=!0;break;case"E":z=!0;var S=ni(fe[j].slice(1),{r:b,c:k});C[b][k]=[C[b][k],S];break;case"S":le=!0,C[b][k]=[C[b][k],"S5S"];break;case"G":break;case"R":se=parseInt(fe[j].slice(1))-1;break;case"C":R=parseInt(fe[j].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}if(he&&(C[b][k]&&C[b][k].length==2?C[b][k][0]=oe:C[b][k]=oe,J=null),le){if(z)throw new Error("SYLK shared formula cannot have own formula");var G=se>-1&&C[se][R];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");C[b][k][1]=r1(G[1],{r:b-se,c:k-R})}break;case"F":var D=0;for(j=1;j<fe.length;++j)switch(fe[j].charAt(0)){case"X":k=parseInt(fe[j].slice(1))-1,++D;break;case"Y":for(b=parseInt(fe[j].slice(1))-1,ee=C.length;ee<=b;++ee)C[ee]=[];break;case"M":ne=parseInt(fe[j].slice(1))/20;break;case"F":break;case"G":break;case"P":J=W[parseInt(fe[j].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=fe[j].slice(1).split(" "),ee=parseInt(B[0],10);ee<=parseInt(B[1],10);++ee)ne=parseInt(B[2],10),U[ee-1]=ne===0?{hidden:!0}:{wch:ne},ci(U[ee-1]);break;case"C":k=parseInt(fe[j].slice(1))-1,U[k]||(U[k]={});break;case"R":b=parseInt(fe[j].slice(1))-1,P[b]||(P[b]={}),ne>0?(P[b].hpt=ne,P[b].hpx=Nl(ne)):ne===0&&(P[b].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}D<1&&(J=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+Y)}}return P.length>0&&(V["!rows"]=P),U.length>0&&(V["!cols"]=U),v&&v.sheetRows&&(C=C.slice(0,v.sheetRows)),[C,V]}function l(g,v){var w=a(g,v),b=w[0],k=w[1],T=vi(b,v);return Ca(k).forEach(function(j){T[j]=k[j]}),T}function c(g,v){return Ms(l(g,v),v)}function f(g,v,w,b){var k="C;Y"+(w+1)+";X"+(b+1)+";K";switch(g.t){case"n":k+=g.v||0,g.f&&!g.F&&(k+=";E"+IN(g.f,{r:w,c:b}));break;case"b":k+=g.v?"TRUE":"FALSE";break;case"e":k+=g.w||g.v;break;case"d":k+='"'+(g.w||g.v)+'"';break;case"s":k+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return k}function h(g,v){v.forEach(function(w,b){var k="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?k+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Pu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Au(w.wpx)),typeof w.wch=="number"&&(k+=Math.round(w.wch))),k.charAt(k.length-1)!=" "&&g.push(k)})}function p(g,v){v.forEach(function(w,b){var k="F;";w.hidden?k+="M0;":w.hpt?k+="M"+20*w.hpt+";":w.hpx&&(k+="M"+20*Jy(w.hpx)+";"),k.length>2&&g.push(k+"R"+(b+1))})}function m(g,v){var w=["ID;PWXL;N;E"],b=[],k=hr(g["!ref"]),T,j=Array.isArray(g),C=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),g["!cols"]&&h(w,g["!cols"]),g["!rows"]&&p(w,g["!rows"]),w.push("B;Y"+(k.e.r-k.s.r+1)+";X"+(k.e.c-k.s.c+1)+";D"+[k.s.c,k.s.r,k.e.c,k.e.r].join(" "));for(var W=k.s.r;W<=k.e.r;++W)for(var J=k.s.c;J<=k.e.c;++J){var V=St({r:W,c:J});T=j?(g[W]||[])[J]:g[V],!(!T||T.v==null&&(!T.f||T.F))&&b.push(f(T,g,W,J))}return w.join(C)+C+b.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:l,from_sheet:m}})(),JS=(function(){function e(o,l){switch(l.type){case"base64":return n(Tn(o),l);case"binary":return n(o,l);case"buffer":return n(Pt&&Buffer.isBuffer(o)?o.toString("binary"):yo(o),l);case"array":return n(fo(o),l)}throw new Error("Unrecognized type "+l.type)}function n(o,l){for(var c=o.split(`
`),f=-1,h=-1,p=0,m=[];p!==c.length;++p){if(c[p].trim()==="BOT"){m[++f]=[],h=0;continue}if(!(f<0)){var g=c[p].trim().split(","),v=g[0],w=g[1];++p;for(var b=c[p]||"";(b.match(/["]/g)||[]).length&1&&p<c.length-1;)b+=`
`+c[++p];switch(b=b.trim(),+v){case-1:if(b==="BOT"){m[++f]=[],h=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?m[f][h]=!0:b==="FALSE"?m[f][h]=!1:isNaN(ia(w))?isNaN(li(w).getDate())?m[f][h]=w:m[f][h]=zr(w):m[f][h]=ia(w),++h;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),m[f][h++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function t(o,l){return vi(e(o,l),l)}function r(o,l){return Ms(t(o,l),l)}var a=(function(){var o=function(f,h,p,m,g){f.push(h),f.push(p+","+m),f.push('"'+g.replace(/"/g,'""')+'"')},l=function(f,h,p,m){f.push(h+","+p),f.push(h==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var h=[],p=hr(f["!ref"]),m,g=Array.isArray(f);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,p.e.r-p.s.r+1,""),o(h,"TUPLES",0,p.e.c-p.s.c+1,""),o(h,"DATA",0,0,"");for(var v=p.s.r;v<=p.e.r;++v){l(h,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var b=St({r:v,c:w});if(m=g?(f[v]||[])[w]:f[b],!m){l(h,1,0,"");continue}switch(m.t){case"n":var k=m.w;!k&&m.v!=null&&(k=m.v),k==null?m.f&&!m.F?l(h,1,0,"="+m.f):l(h,1,0,""):l(h,0,k,"V");break;case"b":l(h,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Vn(m.z||Et[14],fn(zr(m.v)))),l(h,0,m.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var T=`\r
`,j=h.join(T);return j}})();return{to_workbook:r,to_sheet:t,from_sheet:a}})(),eE=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(m,g){for(var v=m.split(`
`),w=-1,b=-1,k=0,T=[];k!==v.length;++k){var j=v[k].trim().split(":");if(j[0]==="cell"){var C=ln(j[1]);if(T.length<=C.r)for(w=T.length;w<=C.r;++w)T[w]||(T[w]=[]);switch(w=C.r,b=C.c,j[2]){case"t":T[w][b]=e(j[3]);break;case"v":T[w][b]=+j[3];break;case"vtf":var W=j[j.length-1];case"vtc":switch(j[3]){case"nl":T[w][b]=!!+j[4];break;default:T[w][b]=+j[4];break}j[2]=="vtf"&&(T[w][b]=[T[w][b],W])}}}return g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),T}function r(m,g){return vi(t(m,g),g)}function a(m,g){return Ms(r(m,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var g=[],v=[],w,b="",k=gi(m["!ref"]),T=Array.isArray(m),j=k.s.r;j<=k.e.r;++j)for(var C=k.s.c;C<=k.e.c;++C)if(b=St({r:j,c:C}),w=T?(m[j]||[])[C]:m[b],!(!w||w.v==null||w.t==="z")){switch(v=["cell",b,"t"],w.t){case"s":case"str":v.push(n(w.v));break;case"n":w.f?(v[2]="vtf",v[3]="n",v[4]=w.v,v[5]=n(w.f)):(v[2]="v",v[3]=w.v);break;case"b":v[2]="vt"+(w.f?"f":"c"),v[3]="nl",v[4]=w.v?"1":"0",v[5]=n(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var W=fn(zr(w.v));v[2]="vtc",v[3]="nd",v[4]=""+W,v[5]=w.w||Vn(w.z||Et[14],W);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(k.e.c-k.s.c+1)+":r:"+(k.e.r-k.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(m){return[o,l,c,l,h(m),f].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:p}})(),Sl=(function(){function e(p,m,g,v,w){w.raw?m[g][v]=p:p===""||(p==="TRUE"?m[g][v]=!0:p==="FALSE"?m[g][v]=!1:isNaN(ia(p))?isNaN(li(p).getDate())?m[g][v]=p:m[g][v]=zr(p):m[g][v]=ia(p))}function n(p,m){var g=m||{},v=[];if(!p||p.length===0)return v;for(var w=p.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var k=10,T=0,j=0;j<=b;++j)T=w[j].indexOf(" "),T==-1?T=w[j].length:T++,k=Math.max(k,T);for(j=0;j<=b;++j){v[j]=[];var C=0;for(e(w[j].slice(0,k).trim(),v,j,C,g),C=1;C<=(w[j].length-k)/10+1;++C)e(w[j].slice(k+(C-1)*10,k+C*10).trim(),v,j,C,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(p){for(var m={},g=!1,v=0,w=0;v<p.length;++v)(w=p.charCodeAt(v))==34?g=!g:!g&&w in t&&(m[w]=(m[w]||0)+1);w=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&w.push([m[v],v]);if(!w.length){m=r;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&w.push([m[v],v])}return w.sort(function(b,k){return b[0]-k[0]||r[b[1]]-r[k[1]]}),t[w.pop()[1]]||44}function o(p,m){var g=m||{},v="",w=g.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(v=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(v=p.charAt(4),p=p.slice(6)):v=a(p.slice(0,1024)):g&&g.FS?v=g.FS:v=a(p.slice(0,1024));var k=0,T=0,j=0,C=0,W=0,J=v.charCodeAt(0),V=!1,P=0,U=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var B=g.dateNF!=null?d2(g.dateNF):null;function ne(){var ee=p.slice(C,W),Y={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=ee;else if(ee.trim().length===0)Y.t="s",Y.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(Y.t="s",Y.v=ee.slice(2,-1).replace(/""/g,'"')):BN(ee)?(Y.t="n",Y.f=ee.slice(1)):(Y.t="s",Y.v=ee);else if(ee=="TRUE")Y.t="b",Y.v=!0;else if(ee=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(j=ia(ee)))Y.t="n",g.cellText!==!1&&(Y.w=ee),Y.v=j;else if(!isNaN(li(ee).getDate())||B&&ee.match(B)){Y.z=g.dateNF||Et[14];var fe=0;B&&ee.match(B)&&(ee=f2(ee,g.dateNF,ee.match(B)||[]),fe=1),g.cellDates?(Y.t="d",Y.v=zr(ee,fe)):(Y.t="n",Y.v=fn(zr(ee,fe))),g.cellText!==!1&&(Y.w=Vn(Y.z,Y.v instanceof Date?fn(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=ee;if(Y.t=="z"||(g.dense?(w[k]||(w[k]=[]),w[k][T]=Y):w[St({c:T,r:k})]=Y),C=W+1,U=p.charCodeAt(C),b.e.c<T&&(b.e.c=T),b.e.r<k&&(b.e.r=k),P==J)++T;else if(T=0,++k,g.sheetRows&&g.sheetRows<=k)return!0}e:for(;W<p.length;++W)switch(P=p.charCodeAt(W)){case 34:U===34&&(V=!V);break;case J:case 10:case 13:if(!V&&ne())break e;break}return W-C>0&&ne(),w["!ref"]=Ot(b),w}function l(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,m):vi(n(p,m),m)}function c(p,m){var g="",v=m.type=="string"?[0,0,0,0]:Cp(p,m);switch(m.type){case"base64":g=Tn(p);break;case"binary":g=p;break;case"buffer":m.codepage==65001?g=p.toString("utf8"):m.codepage&&typeof wl<"u"||(g=Pt&&Buffer.isBuffer(p)?p.toString("binary"):yo(p));break;case"array":g=fo(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=tr(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=tr(g):m.type=="binary"&&typeof wl<"u",g.slice(0,19)=="socialcalc:version:"?eE.to_sheet(m.type=="string"?g:tr(g),m):l(g,m)}function f(p,m){return Ms(c(p,m),m)}function h(p){for(var m=[],g=hr(p["!ref"]),v,w=Array.isArray(p),b=g.s.r;b<=g.e.r;++b){for(var k=[],T=g.s.c;T<=g.e.c;++T){var j=St({r:b,c:T});if(v=w?(p[b]||[])[T]:p[j],!v||v.v==null){k.push("          ");continue}for(var C=(v.w||(Ja(v),v.w)||"").slice(0,10);C.length<10;)C+=" ";k.push(C+(T===0?" ":""))}m.push(k.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})();function tE(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var a=ZS.to_workbook(e,t);return t.WTF=r,a}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return Sl.to_workbook(e,n)}}var xl=(function(){function e(S,G,D){if(S){Br(S,S.l||0);for(var E=D.Enum||se;S.l<S.length;){var F=S.read_shift(2),A=E[F]||E[65535],q=S.read_shift(2),H=S.l+q,L=A.f&&A.f(S,q,D);if(S.l=H,G(L,A,F))return}}}function n(S,G){switch(G.type){case"base64":return t(aa(Tn(S)),G);case"binary":return t(aa(S),G);case"buffer":case"array":return t(S,G)}throw"Unsupported type "+G.type}function t(S,G){if(!S)return S;var D=G||{},E=D.dense?[]:{},F="Sheet1",A="",q=0,H={},L=[],ue=[],I={s:{r:0,c:0},e:{r:0,c:0}},Oe=D.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)D.Enum=se,e(S,function(pe,Ne,je){switch(je){case 0:D.vers=pe,pe>=4096&&(D.qpro=!0);break;case 6:I=pe;break;case 204:pe&&(A=pe);break;case 222:A=pe;break;case 15:case 51:D.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:je==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=D.dateNF||Et[14],D.cellDates&&(pe[1].t="d",pe[1].v=Xu(pe[1].v))),D.qpro&&pe[3]>q&&(E["!ref"]=Ot(I),H[F]=E,L.push(F),E=D.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},q=pe[3],F=A||"Sheet"+(q+1),A="");var _e=D.dense?(E[pe[0].r]||[])[pe[0].c]:E[St(pe[0])];if(_e){_e.t=pe[1].t,_e.v=pe[1].v,pe[1].z!=null&&(_e.z=pe[1].z),pe[1].f!=null&&(_e.f=pe[1].f);break}D.dense?(E[pe[0].r]||(E[pe[0].r]=[]),E[pe[0].r][pe[0].c]=pe[1]):E[St(pe[0])]=pe[1];break}},D);else if(S[2]==26||S[2]==14)D.Enum=R,S[2]==14&&(D.qpro=!0,S.l=0),e(S,function(pe,Ne,je){switch(je){case 204:F=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>q&&(E["!ref"]=Ot(I),H[F]=E,L.push(F),E=D.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},q=pe[3],F="Sheet"+(q+1)),Oe>0&&pe[0].r>=Oe)break;D.dense?(E[pe[0].r]||(E[pe[0].r]=[]),E[pe[0].r][pe[0].c]=pe[1]):E[St(pe[0])]=pe[1],I.e.c<pe[0].c&&(I.e.c=pe[0].c),I.e.r<pe[0].r&&(I.e.r=pe[0].r);break;case 27:pe[14e3]&&(ue[pe[14e3][0]]=pe[14e3][1]);break;case 1537:ue[pe[0]]=pe[1],pe[0]==q&&(F=pe[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(E["!ref"]=Ot(I),H[A||F]=E,L.push(A||F),!ue.length)return{SheetNames:L,Sheets:H};for(var Ae={},Xe=[],qe=0;qe<ue.length;++qe)H[L[qe]]?(Xe.push(ue[qe]||L[qe]),Ae[ue[qe]]=H[ue[qe]]||H[L[qe]]):(Xe.push(ue[qe]),Ae[ue[qe]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:Ae}}function r(S,G){var D=G||{};if(+D.codepage>=0&&sa(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var E=Nf(),F=hr(S["!ref"]),A=Array.isArray(S),q=[];na(E,0,o(1030)),na(E,6,f(F));for(var H=Math.min(F.e.r,8191),L=F.s.r;L<=H;++L)for(var ue=$r(L),I=F.s.c;I<=F.e.c;++I){L===F.s.r&&(q[I]=Dr(I));var Oe=q[I]+ue,Ae=A?(S[L]||[])[I]:S[Oe];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?na(E,13,v(L,I,Ae.v)):na(E,14,b(L,I,Ae.v));else{var Xe=Ja(Ae);na(E,15,m(L,I,Xe.slice(0,239)))}}return na(E,1),E.end()}function a(S,G){var D=G||{};if(+D.codepage>=0&&sa(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var E=Nf();na(E,0,l(S));for(var F=0,A=0;F<S.SheetNames.length;++F)(S.Sheets[S.SheetNames[F]]||{})["!ref"]&&na(E,27,z(S.SheetNames[F],A++));var q=0;for(F=0;F<S.SheetNames.length;++F){var H=S.Sheets[S.SheetNames[F]];if(!(!H||!H["!ref"])){for(var L=hr(H["!ref"]),ue=Array.isArray(H),I=[],Oe=Math.min(L.e.r,8191),Ae=L.s.r;Ae<=Oe;++Ae)for(var Xe=$r(Ae),qe=L.s.c;qe<=L.e.c;++qe){Ae===L.s.r&&(I[qe]=Dr(qe));var pe=I[qe]+Xe,Ne=ue?(H[Ae]||[])[qe]:H[pe];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")na(E,23,ne(Ae,qe,q,Ne.v));else{var je=Ja(Ne);na(E,22,P(Ae,qe,q,je.slice(0,239)))}}++q}}return na(E,1),E.end()}function o(S){var G=Tr(2);return G.write_shift(2,S),G}function l(S){var G=Tr(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var D=0,E=0,F=0,A=0;A<S.SheetNames.length;++A){var q=S.SheetNames[A],H=S.Sheets[q];if(!(!H||!H["!ref"])){++F;var L=gi(H["!ref"]);D<L.e.r&&(D=L.e.r),E<L.e.c&&(E=L.e.c)}}return D>8191&&(D=8191),G.write_shift(2,D),G.write_shift(1,F),G.write_shift(1,E),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function c(S,G,D){var E={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&D.qpro?(E.s.c=S.read_shift(1),S.l++,E.s.r=S.read_shift(2),E.e.c=S.read_shift(1),S.l++,E.e.r=S.read_shift(2),E):(E.s.c=S.read_shift(2),E.s.r=S.read_shift(2),G==12&&D.qpro&&(S.l+=2),E.e.c=S.read_shift(2),E.e.r=S.read_shift(2),G==12&&D.qpro&&(S.l+=2),E.s.c==65535&&(E.s.c=E.e.c=E.s.r=E.e.r=0),E)}function f(S){var G=Tr(8);return G.write_shift(2,S.s.c),G.write_shift(2,S.s.r),G.write_shift(2,S.e.c),G.write_shift(2,S.e.r),G}function h(S,G,D){var E=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(E[0].c=S.read_shift(1),E[3]=S.read_shift(1),E[0].r=S.read_shift(2),S.l+=2):(E[2]=S.read_shift(1),E[0].c=S.read_shift(2),E[0].r=S.read_shift(2)),E}function p(S,G,D){var E=S.l+G,F=h(S,G,D);if(F[1].t="s",D.vers==20768){S.l++;var A=S.read_shift(1);return F[1].v=S.read_shift(A,"utf8"),F}return D.qpro&&S.l++,F[1].v=S.read_shift(E-S.l,"cstr"),F}function m(S,G,D){var E=Tr(7+D.length);E.write_shift(1,255),E.write_shift(2,G),E.write_shift(2,S),E.write_shift(1,39);for(var F=0;F<E.length;++F){var A=D.charCodeAt(F);E.write_shift(1,A>=128?95:A)}return E.write_shift(1,0),E}function g(S,G,D){var E=h(S,G,D);return E[1].v=S.read_shift(2,"i"),E}function v(S,G,D){var E=Tr(7);return E.write_shift(1,255),E.write_shift(2,G),E.write_shift(2,S),E.write_shift(2,D,"i"),E}function w(S,G,D){var E=h(S,G,D);return E[1].v=S.read_shift(8,"f"),E}function b(S,G,D){var E=Tr(13);return E.write_shift(1,255),E.write_shift(2,G),E.write_shift(2,S),E.write_shift(8,D,"f"),E}function k(S,G,D){var E=S.l+G,F=h(S,G,D);if(F[1].v=S.read_shift(8,"f"),D.qpro)S.l=E;else{var A=S.read_shift(2);W(S.slice(S.l,S.l+A),F),S.l+=A}return F}function T(S,G,D){var E=G&32768;return G&=-32769,G=(E?S:0)+(G>=8192?G-16384:G),(E?"":"$")+(D?Dr(G):$r(G))}var j={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function W(S,G){Br(S,0);for(var D=[],E=0,F="",A="",q="",H="";S.l<S.length;){var L=S[S.l++];switch(L){case 0:D.push(S.read_shift(8,"f"));break;case 1:A=T(G[0].c,S.read_shift(2),!0),F=T(G[0].r,S.read_shift(2),!1),D.push(A+F);break;case 2:{var ue=T(G[0].c,S.read_shift(2),!0),I=T(G[0].r,S.read_shift(2),!1);A=T(G[0].c,S.read_shift(2),!0),F=T(G[0].r,S.read_shift(2),!1),D.push(ue+I+":"+A+F)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(S.read_shift(2));break;case 6:{for(var Oe="";L=S[S.l++];)Oe+=String.fromCharCode(L);D.push('"'+Oe.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:H=D.pop(),q=D.pop(),D.push(["AND","OR"][L-20]+"("+q+","+H+")");break;default:if(L<32&&C[L])H=D.pop(),q=D.pop(),D.push(q+C[L]+H);else if(j[L]){if(E=j[L][1],E==69&&(E=S[S.l++]),E>D.length){console.error("WK1 bad formula parse 0x"+L.toString(16)+":|"+D.join("|")+"|");return}var Ae=D.slice(-E);D.length-=E,D.push(j[L][0]+"("+Ae.join(",")+")")}else return L<=7?console.error("WK1 invalid opcode "+L.toString(16)):L<=24?console.error("WK1 unsupported op "+L.toString(16)):L<=30?console.error("WK1 invalid opcode "+L.toString(16)):L<=115?console.error("WK1 unsupported function opcode "+L.toString(16)):console.error("WK1 unrecognized opcode "+L.toString(16))}}D.length==1?G[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function J(S){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=S.read_shift(2),G[3]=S[S.l++],G[0].c=S[S.l++],G}function V(S,G){var D=J(S);return D[1].t="s",D[1].v=S.read_shift(G-4,"cstr"),D}function P(S,G,D,E){var F=Tr(6+E.length);F.write_shift(2,S),F.write_shift(1,D),F.write_shift(1,G),F.write_shift(1,39);for(var A=0;A<E.length;++A){var q=E.charCodeAt(A);F.write_shift(1,q>=128?95:q)}return F.write_shift(1,0),F}function U(S,G){var D=J(S);D[1].v=S.read_shift(2);var E=D[1].v>>1;if(D[1].v&1)switch(E&7){case 0:E=(E>>3)*5e3;break;case 1:E=(E>>3)*500;break;case 2:E=(E>>3)/20;break;case 3:E=(E>>3)/200;break;case 4:E=(E>>3)/2e3;break;case 5:E=(E>>3)/2e4;break;case 6:E=(E>>3)/16;break;case 7:E=(E>>3)/64;break}return D[1].v=E,D}function B(S,G){var D=J(S),E=S.read_shift(4),F=S.read_shift(4),A=S.read_shift(2);if(A==65535)return E===0&&F===3221225472?(D[1].t="e",D[1].v=15):E===0&&F===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var q=A&32768;return A=(A&32767)-16446,D[1].v=(1-q*2)*(F*Math.pow(2,A+32)+E*Math.pow(2,A)),D}function ne(S,G,D,E){var F=Tr(14);if(F.write_shift(2,S),F.write_shift(1,D),F.write_shift(1,G),E==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var A=0,q=0,H=0,L=0;return E<0&&(A=1,E=-E),q=Math.log2(E)|0,E/=Math.pow(2,q-31),L=E>>>0,(L&2147483648)==0&&(E/=2,++q,L=E>>>0),E-=L,L|=2147483648,L>>>=0,E*=Math.pow(2,32),H=E>>>0,F.write_shift(4,H),F.write_shift(4,L),q+=16383+(A?32768:0),F.write_shift(2,q),F}function ee(S,G){var D=B(S);return S.l+=G-14,D}function Y(S,G){var D=J(S),E=S.read_shift(4);return D[1].v=E>>6,D}function fe(S,G){var D=J(S),E=S.read_shift(8,"f");return D[1].v=E,D}function de(S,G){var D=fe(S);return S.l+=G-10,D}function oe(S,G){return S[S.l+G-1]==0?S.read_shift(G,"cstr"):""}function he(S,G){var D=S[S.l++];D>G-1&&(D=G-1);for(var E="";E.length<D;)E+=String.fromCharCode(S[S.l++]);return E}function X(S,G,D){if(!(!D.qpro||G<21)){var E=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var F=S.read_shift(G-21,"cstr");return[E,F]}}function le(S,G){for(var D={},E=S.l+G;S.l<E;){var F=S.read_shift(2);if(F==14e3){for(D[F]=[0,""],D[F][0]=S.read_shift(2);S[S.l];)D[F][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return D}function z(S,G){var D=Tr(5+S.length);D.write_shift(2,14e3),D.write_shift(2,G);for(var E=0;E<S.length;++E){var F=S.charCodeAt(E);D[D.l++]=F>127?95:F}return D[D.l++]=0,D}var se={0:{n:"BOF",f:Er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:k},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},R={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:n}})();function rE(e){var n={},t=e.match(en),r=0,a=!1;if(t)for(;r!=t.length;++r){var o=wt(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=np[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return n}var nE=(function(){var e=bl("t"),n=bl("rPr");function t(o){var l=o.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:Lt(l[1])},f=o.match(n);return f&&(c.s=rE(f[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(t).filter(function(c){return c.v})}})(),aE=(function(){var n=/(\r\n|\n)/g;function t(a,o,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),o.push('<span style="'+c.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&t(a.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),sE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,oE=/<(?:\w+:)?r>/,iE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function wp(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Lt(tr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=tr(e),t&&(r.h=up(r.t))):e.match(oE)&&(r.r=tr(e),r.t=Lt(tr((e.replace(iE,"").match(sE)||[]).join("").replace(en,""))),t&&(r.h=aE(nE(r.r)))),r):{t:""}}var lE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cE=/<(?:\w+:)?(?:si|sstItem)>/g,uE=/<\/(?:\w+:)?(?:si|sstItem)>/;function dE(e,n){var t=[],r="";if(!e)return t;var a=e.match(lE);if(a){r=a[2].replace(cE,"").split(uE);for(var o=0;o!=r.length;++o){var l=wp(r[o].trim(),n);l!=null&&(t[t.length]=l)}a=wt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function fE(e){return[e.read_shift(4),e.read_shift(4)]}function pE(e,n){var t=[],r=!1;return ts(e,function(o,l,c){switch(c){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||n.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function Ky(e){for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function Ka(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function hE(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=Ka(e,4),n.U=Ka(e,4),n.W=Ka(e,4),n}function xE(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function mE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(xE(e));return n}function gE(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function vE(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=Ka(e,4),n.U=Ka(e,4),n.W=Ka(e,4),n}function yE(e){var n=vE(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Gy(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function Qy(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function wE(e){var n=Ka(e);switch(n.Minor){case 2:return[n.Minor,kE(e)];case 3:return[n.Minor,bE()];case 4:return[n.Minor,_E(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function kE(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=Gy(e,t),a=Qy(e,e.length-e.l);return{t:"Std",h:r,v:a}}function bE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _E(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(en,function(o){var l=wt(o);switch(Da(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function SE(e,n){var t={},r=t.EncryptionVersionInfo=Ka(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var a=e.read_shift(4);return n-=4,t.EncryptionHeader=Gy(e,a),n-=a,t.EncryptionVerifier=Qy(e,n),t}function EE(e){var n={},t=n.EncryptionVersionInfo=Ka(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function NE(e){var n=0,t,r=Ky(e),a=r.length+1,o,l,c,f,h;for(t=As(a),t[0]=r.length,o=1;o!=a;++o)t[o]=r[o-1];for(o=a-1;o>=0;--o)l=t[o],c=(n&16384)===0?0:1,f=n<<1&32767,h=c|f,n=h^l;return n^52811}var Xy=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},o=function(l){for(var c=n[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var p=l[h],m=0;m!=7;++m)p&64&&(c^=t[f]),p*=2,--f;return c};return function(l){for(var c=Ky(l),f=o(c),h=c.length,p=As(16),m=0;m!=16;++m)p[m]=0;var g,v,w;for((h&1)===1&&(g=f>>8,p[h]=a(e[0],g),--h,g=f&255,v=c[c.length-1],p[h]=a(v,g));h>0;)--h,g=f>>8,p[h]=a(c[h],g),--h,g=f&255,p[h]=a(c[h],g);for(h=15,w=15-c.length;w>0;)g=f>>8,p[h]=a(e[w],g),--h,--w,g=f&255,p[h]=a(c[h],g),--h,--w;return p}})(),CE=function(e,n,t,r,a){a||(a=n),r||(r=Xy(e));var o,l;for(o=0;o!=n.length;++o)l=n[o],l^=r[t],l=(l>>5|l<<3)&255,a[o]=l,++t;return[a,t,r]},TE=function(e){var n=0,t=Xy(e);return function(r){var a=CE("",r,n,t);return n=a[1],a[0]}};function DE(e,n,t,r){var a={key:Er(e),verificationBytes:Er(e)};return t.password&&(a.verifier=NE(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=TE(t.password)),a}function FE(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=EE(e):r.Data=SE(e,n),r}function jE(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?FE(e,n-2,r):DE(e,t.biff>=8?n:n-2,t,r),r}var PE=(function(){function e(a,o){switch(o.type){case"base64":return n(Tn(a),o);case"binary":return n(a,o);case"buffer":return n(Pt&&Buffer.isBuffer(a)?a.toString("binary"):yo(a),o);case"array":return n(fo(a),o)}throw new Error("Unrecognized type "+o.type)}function n(a,o){var l=o||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,m){Array.isArray(c)&&(c[m]=[]);for(var g=/\\\w+\b/g,v=0,w,b=-1;w=g.exec(p);){switch(w[0]){case"\\cell":var k=p.slice(v,g.lastIndex-w[0].length);if(k[0]==" "&&(k=k.slice(1)),++b,k.length){var T={v:k,t:"s"};Array.isArray(c)?c[m][b]=T:c[St({r:m,c:b})]=T}break}v=g.lastIndex}b>h.e.c&&(h.e.c=b)}),c["!ref"]=Ot(h),c}function t(a,o){return Ms(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=hr(a["!ref"]),c,f=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var m=St({r:h,c:p});c=f?(a[h]||[])[p]:a[m],!(!c||c.v==null&&(!c.f||c.F))&&(o.push(" "+(c.w||(Ja(c),c.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}})();function AE(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function El(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function OE(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,a=Math.max(n,t,r),o=Math.min(n,t,r),l=a-o;if(l===0)return[0,0,n];var c=0,f=0,h=a+o;switch(f=l/(h>1?2-h:h),a){case n:c=((t-r)/l+6)%6;break;case t:c=(r-n)/l+2;break;case r:c=(n-t)/l+4;break}return[c/6,f,h/2]}function RE(e){var n=e[0],t=e[1],r=e[2],a=t*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],c=6*n,f;if(t!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function ju(e,n){if(n===0)return e;var t=OE(AE(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),El(RE(t))}var qy=6,zE=15,ME=1,sn=qy;function Pu(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function Au(e){return Math.floor((e-5)/sn*100+.5)/100}function Ff(e){return Math.round((e*sn+5)/sn*256)/256}function rf(e){return Ff(Au(Pu(e)))}function kp(e){var n=Math.abs(e-rf(e)),t=sn;if(n>.005)for(sn=ME;sn<zE;++sn)Math.abs(e-rf(e))<=n&&(n=Math.abs(e-rf(e)),t=sn);sn=t}function ci(e){e.width?(e.wpx=Pu(e.width),e.wch=Au(e.wpx),e.MDW=sn):e.wpx?(e.wch=Au(e.wpx),e.width=Ff(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Ff(e.wch),e.wpx=Pu(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var IE=96,Zy=IE;function Jy(e){return e*96/Zy}function Nl(e){return e*Zy/96}var LE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function BE(e,n,t,r){n.Borders=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=wt(l);switch(Da(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=ir(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=ir(c.diagonalDown)),n.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in borders")}})}function WE(e,n,t,r){n.Fills=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=wt(l);switch(Da(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},n.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fills")}})}function UE(e,n,t,r){n.Fonts=[];var a={},o=!1;(e[0].match(en)||[]).forEach(function(l){var c=wt(l);switch(Da(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=tr(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?ir(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?ir(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?ir(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?ir(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?ir(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?ir(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?ir(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=np[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=ir(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=so[a.color.index];a.color.index==81&&(f=so[1]),f||(f=so[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=ju(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+c[0]+" in fonts")}})}function $E(e,n,t){n.NumberFmt=[];for(var r=Ca(Et),a=0;a<r.length;++a)n.NumberFmt[r[a]]=Et[r[a]];var o=e[0].match(en);if(o)for(a=0;a<o.length;++a){var l=wt(o[a]);switch(Da(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Lt(tr(l.formatCode)),f=parseInt(l.numFmtId,10);if(n.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&n.NumberFmt[f]!=null;--f);n.NumberFmt[f]=c}ao(c,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var su=["numFmtId","fillId","fontId","borderId","xfId"],ou=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function HE(e,n,t){n.CellXf=[];var r,a=!1;(e[0].match(en)||[]).forEach(function(o){var l=wt(o),c=0;switch(Da(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<su.length;++c)r[su[c]]&&(r[su[c]]=parseInt(r[su[c]],10));for(c=0;c<ou.length;++c)r[ou[c]]&&(r[ou[c]]=ir(r[ou[c]]));if(n.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[c]){r.numFmtId=c;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=ir(l.wrapText)),r.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var YE=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,h){var p={};if(!c)return p;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(n))&&$E(m,p,h),(m=c.match(a))&&UE(m,p,f,h),(m=c.match(r))&&WE(m,p,f,h),(m=c.match(o))&&BE(m,p,f,h),(m=c.match(t))&&HE(m,p,h),p}})();function VE(e,n){var t=e.read_shift(2),r=Zr(e);return[t,r]}function KE(e,n,t){var r={};r.sz=e.read_shift(2)/20;var a=n_(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var c=e.read_shift(1);c>0&&(r.family=c);var f=e.read_shift(1);switch(f>0&&(r.charset=f),e.l++,r.color=r_(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Zr(e),r}var GE=Jr;function QE(e,n){var t=e.l+n,r=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:a}}var XE=Jr;function qE(e,n,t){var r={};r.NumberFmt=[];for(var a in Et)r.NumberFmt[a]=Et[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return ts(e,function(f,h,p){switch(p){case 44:r.NumberFmt[f[0]]=f[1],ao(f[1],f[0]);break;case 43:r.Fonts.push(f),f.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(f.color.rgb=ju(n.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(p);else if(h.T<0)o.pop();else if(!l||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var ZE=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function JE(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(en)||[]).forEach(function(a){var o=wt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[ZE.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function eN(){}function tN(){}var rN=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nN=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aN=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sN(e,n,t){n.themeElements={};var r;[["clrScheme",rN,JE],["fontScheme",nN,eN],["fmtScheme",aN,tN]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,n,t)})}var oN=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function e1(e,n){(!e||e.length===0)&&(e=iN());var t,r={};if(!(t=e.match(oN)))throw new Error("themeElements not found in theme");return sN(t[0],r,n),r.raw=e,r}function iN(e,n){var t=[dy];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function lN(e,n,t){var r=e.l+n,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=uy(o,{type:"array"})}catch{return}var c=Nn(l,"theme/theme/theme1.xml",!0);if(c)return e1(c,t)}}function cN(e){return e.read_shift(4)}function uN(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=dN(e,4);break;case 2:n.xclrValue=By(e);break;case 3:n.xclrValue=cN(e);break;case 4:e.l+=4;break}return e.l+=8,n}function dN(e,n){return Jr(e,n)}function fN(e,n){return Jr(e,n)}function pN(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=uN(e);break;case 6:r[1]=fN(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function hN(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(pN(e,t-e.l));return{ixfe:r,ext:o}}function xN(e,n){n.forEach(function(t){t[0]})}function mN(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zr(e)}}function gN(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function vN(e){return e.l+=4,e.read_shift(4)!=0}function yN(e,n,t){var r={Types:[],Cell:[],Value:[]},a=t||{},o=[],l=!1,c=2;return ts(e,function(f,h,p){switch(p){case 335:r.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?r.Cell.push({type:r.Types[m[0]-1].name,index:m[1]}):c==0&&r.Value.push({type:r.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function wN(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace(en,function(c){var f=wt(c);switch(Da(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==f.name&&(l=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[f.t-1].name,index:+f.v}):o==0&&r.Value.push({type:r.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),r}function kN(e){var n=[];if(!e)return n;var t=1;return(e.match(en)||[]).forEach(function(r){var a=wt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,n.push(a);break}}),n}function bN(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=St(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function _N(e,n,t){var r=[];return ts(e,function(o,l,c){switch(c){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function SN(e,n,t,r){if(!e)return e;var a=r||{},o=!1;ts(e,function(c,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function EN(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function Eg(e,n,t,r){var a=Array.isArray(e),o;n.forEach(function(l){var c=ln(l.ref);if(a?(e[c.r]||(e[c.r]=[]),o=e[c.r][c.c]):o=e[l.ref],!o){o={t:"z"},a?e[c.r][c.c]=o:e[l.ref]=o;var f=hr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var h=Ot(f);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:t};l.h&&(p.h=l.h);for(var m=o.c.length-1;m>=0;--m){if(!t&&o.c[m].T)return;t&&!o.c[m].T&&o.c.splice(m,1)}if(t&&r){for(m=0;m<r.length;++m)if(p.a==r[m].id){p.a=r[m].name||p.a;break}}o.c.push(p)})}function NN(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=wt(c[0]),h={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=ln(f.ref);if(!(n.sheetRows&&n.sheetRows<=p.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&wp(m[1])||{r:"",t:"",h:""};h.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),h.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(h.h=g.h),r.push(h)}}}}),r}function CN(e,n){var t=[],r=!1,a={},o=0;return e.replace(en,function(c,f){var h=wt(c);switch(Da(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":o=f+c.length;break;case"</text>":a.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),t}function TN(e,n){var t=[],r=!1;return e.replace(en,function(o){var l=wt(o);switch(Da(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function DN(e){var n={};n.iauthor=e.read_shift(4);var t=ko(e);return n.rfx=t.s,n.ref=St(t.s),e.l+=16,n}var FN=Zr;function jN(e,n){var t=[],r=[],a={},o=!1;return ts(e,function(c,f,h){switch(h){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,n.sheetRows&&a.rfx&&n.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var PN="application/vnd.ms-office.vbaProject";function AN(e){var n=At.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");At.utils.cfb_add(n,a,e.FileIndex[r].content)}}),At.write(n)}function ON(){return{"!type":"dialog"}}function RN(){return{"!type":"dialog"}}function zN(){return{"!type":"macro"}}function MN(){return{"!type":"macro"}}var ni=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,a,o,l){var c=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return c?p+=n.c:--p,f?h+=n.r:--h,a+(c?"":"$")+Dr(p)+(f?"":"$")+$r(h)}return function(a,o){return n=o,a.replace(e,t)}})(),t1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,IN=(function(){return function(n,t){return n.replace(t1,function(r,a,o,l,c,f){var h=hp(l)-(o?0:t.c),p=pp(f)-(c?0:t.r),m=p==0?"":c?p+1:"["+p+"]",g=h==0?"":o?h+1:"["+h+"]";return a+"R"+m+"C"+g})}})();function r1(e,n){return e.replace(t1,function(t,r,a,o,l,c){return r+(a=="$"?a+o:Dr(hp(o)+n.c))+(l=="$"?l+c:$r(pp(c)+n.r))})}function LN(e,n,t){var r=gi(n),a=r.s,o=ln(t),l={r:o.r-a.r,c:o.c-a.c};return r1(e,l)}function BN(e){return e.length!=1}function Ng(e){return e.replace(/_xlfn\./g,"")}function _r(e){e.l+=1}function Os(e,n){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function n1(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return a1(e);t.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Os(e),c=Os(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:c[0],cRel:c[1],rRel:c[2]}}}function a1(e){var n=Os(e),t=Os(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function WN(e,n,t){if(t.biff<8)return a1(e);var r=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=Os(e),l=Os(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function s1(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return UN(e);var r=e.read_shift(t&&t.biff==12?4:2),a=Os(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function UN(e){var n=Os(e),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function $N(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function HN(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return YN(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,c=(o&32768)>>15;if(o&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:c}}function YN(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,a=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),a==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:a,rRel:r}}function VN(e,n,t){var r=(e[e.l++]&96)>>5,a=n1(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function KN(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=n1(e,o,t);return[r,a,l]}function GN(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function QN(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function XN(e,n,t){var r=(e[e.l++]&96)>>5,a=WN(e,n-1,t);return[r,a]}function qN(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Cg(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function ZN(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function JN(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function eC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function tC(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function rC(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function o1(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function nC(e){return e.read_shift(2),o1(e)}function aC(e){return e.read_shift(2),o1(e)}function sC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=s1(e,0,t);return[r,a]}function oC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=HN(e,0,t);return[r,a]}function iC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=s1(e,0,t);return[r,a,o]}function lC(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[cT[a],c1[a],r]}function cC(e,n,t){var r=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:uC(e);return[a,(o[0]===0?c1:lT)[o[1]]]}function uC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dC(e,n,t){e.l+=t&&t.biff==2?3:4}function fC(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function pC(e){return e.l++,bo[e.read_shift(1)]}function hC(e){return e.l++,e.read_shift(2)}function xC(e){return e.l++,e.read_shift(1)!==0}function mC(e){return e.l++,Xr(e)}function gC(e,n,t){return e.l++,Ol(e,n-1,t)}function vC(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=yr(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=bo[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Xr(e);break;case 2:t[1]=_o(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function yC(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((t.biff==12?ko:qu)(e));return a}function wC(e,n,t){var r=0,a=0;t.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var c=0;c!=a;++c)l[o][c]=vC(e,t.biff);return l}function kC(e,n,t){var r=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function bC(e,n,t){if(t.biff==5)return _C(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function _C(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function SC(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function EC(e,n,t){var r=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[r,a]}function NC(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function CC(e,n,t){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var TC=Jr,DC=Jr,FC=Jr;function zl(e,n,t){return e.l+=2,[$N(e)]}function bp(e){return e.l+=6,[]}var jC=zl,PC=bp,AC=bp,OC=zl;function i1(e){return e.l+=2,[Er(e),e.read_shift(2)&1]}var RC=zl,zC=i1,MC=bp,IC=zl,LC=zl,BC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WC(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=BC[t>>2&31];return{ixti:n,coltype:t&3,rt:l,idx:r,c:a,C:o}}function UC(e){return e.l+=2,[e.read_shift(4)]}function $C(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function HC(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function YC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function VC(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function KC(e){return e.l+=4,[0,0]}var Tg={1:{n:"PtgExp",f:fC},2:{n:"PtgTbl",f:FC},3:{n:"PtgAdd",f:_r},4:{n:"PtgSub",f:_r},5:{n:"PtgMul",f:_r},6:{n:"PtgDiv",f:_r},7:{n:"PtgPower",f:_r},8:{n:"PtgConcat",f:_r},9:{n:"PtgLt",f:_r},10:{n:"PtgLe",f:_r},11:{n:"PtgEq",f:_r},12:{n:"PtgGe",f:_r},13:{n:"PtgGt",f:_r},14:{n:"PtgNe",f:_r},15:{n:"PtgIsect",f:_r},16:{n:"PtgUnion",f:_r},17:{n:"PtgRange",f:_r},18:{n:"PtgUplus",f:_r},19:{n:"PtgUminus",f:_r},20:{n:"PtgPercent",f:_r},21:{n:"PtgParen",f:_r},22:{n:"PtgMissArg",f:_r},23:{n:"PtgStr",f:gC},26:{n:"PtgSheet",f:$C},27:{n:"PtgEndSheet",f:HC},28:{n:"PtgErr",f:pC},29:{n:"PtgBool",f:xC},30:{n:"PtgInt",f:hC},31:{n:"PtgNum",f:mC},32:{n:"PtgArray",f:qN},33:{n:"PtgFunc",f:lC},34:{n:"PtgFuncVar",f:cC},35:{n:"PtgName",f:kC},36:{n:"PtgRef",f:sC},37:{n:"PtgArea",f:VN},38:{n:"PtgMemArea",f:SC},39:{n:"PtgMemErr",f:TC},40:{n:"PtgMemNoMem",f:DC},41:{n:"PtgMemFunc",f:EC},42:{n:"PtgRefErr",f:NC},43:{n:"PtgAreaErr",f:GN},44:{n:"PtgRefN",f:oC},45:{n:"PtgAreaN",f:XN},46:{n:"PtgMemAreaN",f:YC},47:{n:"PtgMemNoMemN",f:VC},57:{n:"PtgNameX",f:bC},58:{n:"PtgRef3d",f:iC},59:{n:"PtgArea3d",f:KN},60:{n:"PtgRefErr3d",f:CC},61:{n:"PtgAreaErr3d",f:QN},255:{}},GC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},QC={1:{n:"PtgElfLel",f:i1},2:{n:"PtgElfRw",f:IC},3:{n:"PtgElfCol",f:jC},6:{n:"PtgElfRwV",f:LC},7:{n:"PtgElfColV",f:OC},10:{n:"PtgElfRadical",f:RC},11:{n:"PtgElfRadicalS",f:MC},13:{n:"PtgElfColS",f:PC},15:{n:"PtgElfColSV",f:AC},16:{n:"PtgElfRadicalLel",f:zC},25:{n:"PtgList",f:WC},29:{n:"PtgSxName",f:UC},255:{}},XC={0:{n:"PtgAttrNoop",f:KC},1:{n:"PtgAttrSemi",f:rC},2:{n:"PtgAttrIf",f:eC},4:{n:"PtgAttrChoose",f:ZN},8:{n:"PtgAttrGoto",f:JN},16:{n:"PtgAttrSum",f:dC},32:{n:"PtgAttrBaxcel",f:Cg},33:{n:"PtgAttrBaxcel",f:Cg},64:{n:"PtgAttrSpace",f:nC},65:{n:"PtgAttrSpaceSemi",f:aC},128:{n:"PtgAttrIfError",f:tC},255:{}};function Ml(e,n,t,r){if(r.biff<8)return Jr(e,n);for(var a=e.l+n,o=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=wC(e,0,r),o.push(t[l][1]);break;case"PtgMemArea":t[l][2]=yC(e,t[l][1],r),o.push(t[l][2]);break;case"PtgExp":r&&r.biff==12&&(t[l][1][1]=e.read_shift(4),o.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return n=a-e.l,n!==0&&o.push(Jr(e,n)),o}function Il(e,n,t){for(var r=e.l+n,a,o,l=[];r!=e.l;)n=r-e.l,o=e[e.l],a=Tg[o]||Tg[GC[o]],(o===24||o===25)&&(a=(o===24?QC:XC)[e[e.l+1]]),!a||!a.f?Jr(e,n):l.push([a.n,a.f(e,n,t)]);return l}function qC(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}n.push(a.join(","))}return n.join(";")}var ZC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JC(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function l1(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Dg(e,n,t){var r=l1(e,n,t);return r=="#REF"?r:JC(r,t)}function Qr(e,n,t,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,h,p,m=0,g=0,v,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,k="",T=0,j=e[0].length;T<j;++T){var C=e[0][T];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),b>=0){switch(e[0][b][1][0]){case 0:k=pr(" ",e[0][b][1][1]);break;case 1:k=pr("\r",e[0][b][1][1]);break;default:if(k="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}h=h+k,b=-1}c.push(h+ZC[C[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=dl(C[1][1],l,a),c.push(fl(p,o));break;case"PtgRefN":p=t?dl(C[1][1],t,a):C[1][1],c.push(fl(p,o));break;case"PtgRef3d":m=C[1][1],p=dl(C[1][2],l,a),w=Dg(r,m,a),c.push(w+"!"+fl(p,o));break;case"PtgFunc":case"PtgFuncVar":var W=C[1][0],J=C[1][1];W||(W=0),W&=127;var V=W==0?[]:c.slice(-W);c.length-=W,J==="User"&&(J=V.shift()),c.push(J+"("+V.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":v=cg(C[1][1],t?{s:t}:l,a),c.push(ef(v,a));break;case"PtgArea":v=cg(C[1][1],l,a),c.push(ef(v,a));break;case"PtgArea3d":m=C[1][1],v=C[1][2],w=Dg(r,m,a),c.push(w+"!"+ef(v,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=C[1][2];var P=(r.names||[])[g-1]||(r[0]||[])[g],U=P?P.Name:"SH33TJSNAME"+String(g);U&&U.slice(0,6)=="_xlfn."&&!a.xlfn&&(U=U.slice(6)),c.push(U);break;case"PtgNameX":var B=C[1][1];g=C[1][2];var ne;if(a.biff<=5)B<0&&(B=-B),r[B]&&(ne=r[B][g]);else{var ee="";if(((r[B]||[])[0]||[])[0]==14849||(((r[B]||[])[0]||[])[0]==1025?r[B][g]&&r[B][g].itab>0&&(ee=r.SheetNames[r[B][g].itab-1]+"!"):ee=r.SheetNames[g-1]+"!"),r[B]&&r[B][g])ee+=r[B][g].Name;else if(r[0]&&r[0][g])ee+=r[0][g].Name;else{var Y=(l1(r,B,a)||"").split(";;");Y[g-1]?ee=Y[g-1]:ee+="SH33TJSERRX"}c.push(ee);break}ne||(ne={Name:"SH33TJSERRY"}),c.push(ne.Name);break;case"PtgParen":var fe="(",de=")";if(b>=0){switch(k="",e[0][b][1][0]){case 2:fe=pr(" ",e[0][b][1][1])+fe;break;case 3:fe=pr("\r",e[0][b][1][1])+fe;break;case 4:de=pr(" ",e[0][b][1][1])+de;break;case 5:de=pr("\r",e[0][b][1][1])+de;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}c.push(fe+c.pop()+de);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var oe={c:t.c,r:t.r};if(r.sharedf[St(p)]){var he=r.sharedf[St(p)];c.push(Qr(he,l,oe,r,a))}else{var X=!1;for(f=0;f!=r.arrayf.length;++f)if(h=r.arrayf[f],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Qr(h[1],l,oe,r,a)),X=!0;break}X||c.push(C[1])}break;case"PtgArray":c.push("{"+qC(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&le.indexOf(e[0][T][0])==-1){C=e[0][b];var z=!0;switch(C[1][0]){case 4:z=!1;case 0:k=pr(" ",C[1][1]);break;case 5:z=!1;case 1:k=pr("\r",C[1][1]);break;default:if(k="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((z?k:"")+c.pop()+(z?"":k)),b=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function eT(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=Il(e,l,t);return n!==l+a&&(o=Ml(e,n-l-a,c,t)),e.l=r,[c,o]}function tT(e,n,t){var r=e.l+n,a=t.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Jr(e,n-2)];var c=Il(e,l,t);return n!==l+a&&(o=Ml(e,n-l-a,c,t)),e.l=r,[c,o]}function rT(e,n,t,r){var a=e.l+n,o=Il(e,r,t),l;return a!==e.l&&(l=Ml(e,a-e.l,o,t)),[o,l]}function nT(e,n,t){var r=e.l+n,a,o=e.read_shift(2),l=Il(e,o,t);return o==65535?[[],Jr(e,n-2)]:(n!==o+2&&(a=Ml(e,r-o-2,l,t)),[l,a])}function aT(e){var n;if(Ya(e,e.l+6)!==65535)return[Xr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function nf(e,n,t){var r=e.l+n,a=Fa(e);t.biff==2&&++e.l;var o=aT(e),l=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var c=tT(e,r-e.l,t);return{cell:a,val:o[0],formula:c,shared:l>>3&1,tt:o[1]}}function Zu(e,n,t){var r=e.read_shift(4),a=Il(e,r,t),o=e.read_shift(4),l=o>0?Ml(e,o,a,t):null;return[a,l]}var sT=Zu,Ju=Zu,oT=Zu,iT=Zu,lT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},c1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cT={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function af(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var ml={},ai={};function gl(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function u1(e,n,t,r,a,o){try{r.cellNF&&(e.z=Et[n])}catch(c){if(r.WTF)throw c}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=zr(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(Et[n]==null&&ao(u2[n]||"General",n),e.t==="e")e.w=e.w||bo[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v);else if(e.t==="d"){var l=fn(e.v);(l|0)===l?e.w=l.toString(10):e.w=kl(l)}else{if(e.v===void 0)return"";e.w=uo(e.v,ai)}else e.t==="d"?e.w=Vn(n,fn(e.v),ai):e.w=Vn(n,e.v,ai)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ju(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ju(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&o.Fills)throw c}}}function uT(e,n){var t=hr(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Ot(t))}var dT=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fT=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,pT=/<(?:\w:)?hyperlink [^>]*>/mg,hT=/"(\w*:\w*)"/,xT=/<(?:\w:)?col\b[^>]*[\/]?>/g,mT=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,gT=/<(?:\w:)?pageMargins[^>]*\/>/g,d1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vT=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yT=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function wT(e,n,t,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var c=n.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",m=e.match(fT);m?(h=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):h=p=e;var g=h.match(d1);g?_p(g[0],c,a,t):(g=h.match(vT))&&kT(g[0],g[1]||"",c,a,t);var v=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var w=h.slice(v,v+50).match(hT);w&&uT(c,w[1])}var b=h.match(yT);b&&b[1]&&CT(b[1],a);var k=[];if(n.cellStyles){var T=h.match(xT);T&&ST(k,T)}m&&TT(m[1],c,n,f,o,l);var j=p.match(mT);j&&(c["!autofilter"]=ET(j[0]));var C=[],W=p.match(dT);if(W)for(v=0;v!=W.length;++v)C[v]=hr(W[v].slice(W[v].indexOf('"')+1));var J=p.match(pT);J&&bT(c,J,r);var V=p.match(gT);if(V&&(c["!margins"]=_T(wt(V[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Ot(f)),n.sheetRows>0&&c["!ref"]){var P=hr(c["!ref"]);n.sheetRows<=+P.e.r&&(P.e.r=n.sheetRows-1,P.e.r>f.e.r&&(P.e.r=f.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>f.e.c&&(P.e.c=f.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ot(P))}return k.length>0&&(c["!cols"]=k),C.length>0&&(c["!merges"]=C),c}function _p(e,n,t,r){var a=wt(e);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=Lt(tr(a.codeName)))}function kT(e,n,t,r,a){_p(e.slice(0,e.indexOf(">")),t,r,a)}function bT(e,n,t){for(var r=Array.isArray(e),a=0;a!=n.length;++a){var o=wt(tr(n[a]),!0);if(!o.ref)return;var l=((t||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Lt(o.location))):(o.Target="#"+Lt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var c=hr(o.ref),f=c.s.r;f<=c.e.r;++f)for(var h=c.s.c;h<=c.e.c;++h){var p=St({c:h,r:f});r?(e[f]||(e[f]=[]),e[f][h]||(e[f][h]={t:"z",v:void 0}),e[f][h].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function _T(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function ST(e,n){for(var t=!1,r=0;r!=n.length;++r){var a=wt(n[r],!0);a.hidden&&(a.hidden=ir(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,kp(a.width)),ci(a);o<=l;)e[o++]=Ur(a)}}function ET(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var NT=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function CT(e,n){n.Views||(n.Views=[{}]),(e.match(NT)||[]).forEach(function(t,r){var a=wt(t);n.Views[r]||(n.Views[r]={}),+a.zoomScale&&(n.Views[r].zoom=+a.zoomScale),ir(a.rightToLeft)&&(n.Views[r].RTL=!0)})}var TT=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=bl("v"),l=bl("f");return function(f,h,p,m,g,v){for(var w=0,b="",k=[],T=[],j=0,C=0,W=0,J="",V,P,U=0,B=0,ne,ee,Y=0,fe=0,de=Array.isArray(v.CellXf),oe,he=[],X=[],le=Array.isArray(h),z=[],se={},R=!1,S=!!p.sheetStubs,G=f.split(n),D=0,E=G.length;D!=E;++D){b=G[D].trim();var F=b.length;if(F!==0){var A=0;e:for(w=0;w<F;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(P=wt(b.slice(A,w),!0),U=P.r!=null?parseInt(P.r,10):U+1,B=-1,p.sheetRows&&p.sheetRows<U)continue;se={},R=!1,P.ht&&(R=!0,se.hpt=parseFloat(P.ht),se.hpx=Nl(se.hpt)),P.hidden=="1"&&(R=!0,se.hidden=!0),P.outlineLevel!=null&&(R=!0,se.level=+P.outlineLevel),R&&(z[U-1]=se)}break;case"<":A=w;break}if(A>=w)break;if(P=wt(b.slice(A,w),!0),U=P.r!=null?parseInt(P.r,10):U+1,B=-1,!(p.sheetRows&&p.sheetRows<U)){m.s.r>U-1&&(m.s.r=U-1),m.e.r<U-1&&(m.e.r=U-1),p&&p.cellStyles&&(se={},R=!1,P.ht&&(R=!0,se.hpt=parseFloat(P.ht),se.hpx=Nl(se.hpt)),P.hidden=="1"&&(R=!0,se.hidden=!0),P.outlineLevel!=null&&(R=!0,se.level=+P.outlineLevel),R&&(z[U-1]=se)),k=b.slice(w).split(e);for(var q=0;q!=k.length&&k[q].trim().charAt(0)=="<";++q);for(k=k.slice(q),w=0;w!=k.length;++w)if(b=k[w].trim(),b.length!==0){if(T=b.match(t),j=w,C=0,W=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,T!=null&&T.length===2){for(j=0,J=T[1],C=0;C!=J.length&&!((W=J.charCodeAt(C)-64)<1||W>26);++C)j=26*j+W;--j,B=j}else++B;for(C=0;C!=b.length&&b.charCodeAt(C)!==62;++C);if(++C,P=wt(b.slice(0,C),!0),P.r||(P.r=St({r:U-1,c:B})),J=b.slice(C),V={t:""},(T=J.match(o))!=null&&T[1]!==""&&(V.v=Lt(T[1])),p.cellFormula){if((T=J.match(l))!=null&&T[1]!==""){if(V.f=Lt(tr(T[1])).replace(/\r\n/g,`
`),p.xlfn||(V.f=Ng(V.f)),T[0].indexOf('t="array"')>-1)V.F=(J.match(a)||[])[1],V.F.indexOf(":")>-1&&he.push([hr(V.F),V.F]);else if(T[0].indexOf('t="shared"')>-1){ee=wt(T[0]);var H=Lt(tr(T[1]));p.xlfn||(H=Ng(H)),X[parseInt(ee.si,10)]=[ee,H,P.r]}}else(T=J.match(/<f[^>]*\/>/))&&(ee=wt(T[0]),X[ee.si]&&(V.f=LN(X[ee.si][1],X[ee.si][2],P.r)));var L=ln(P.r);for(C=0;C<he.length;++C)L.r>=he[C][0].s.r&&L.r<=he[C][0].e.r&&L.c>=he[C][0].s.c&&L.c<=he[C][0].e.c&&(V.F=he[C][1])}if(P.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(S)V.t="z";else continue;else V.t=P.t||"n";switch(m.s.c>B&&(m.s.c=B),m.e.c<B&&(m.e.c=B),V.t){case"n":if(V.v==""||V.v==null){if(!S)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!S)continue;V.t="z"}else ne=ml[parseInt(V.v,10)],V.v=ne.t,V.r=ne.r,p.cellHTML&&(V.h=ne.h);break;case"str":V.t="s",V.v=V.v!=null?tr(V.v):"",p.cellHTML&&(V.h=up(V.v));break;case"inlineStr":T=J.match(r),V.t="s",T!=null&&(ne=wp(T[1]))?(V.v=ne.t,p.cellHTML&&(V.h=ne.h)):V.v="";break;case"b":V.v=ir(V.v);break;case"d":p.cellDates?V.v=zr(V.v,1):(V.v=fn(zr(V.v,1)),V.t="n");break;case"e":(!p||p.cellText!==!1)&&(V.w=V.v),V.v=Py[V.v];break}if(Y=fe=0,oe=null,de&&P.s!==void 0&&(oe=v.CellXf[P.s],oe!=null&&(oe.numFmtId!=null&&(Y=oe.numFmtId),p.cellStyles&&oe.fillId!=null&&(fe=oe.fillId))),u1(V,Y,fe,p,g,v),p.cellDates&&de&&V.t=="n"&&mi(Et[Y])&&(V.t="d",V.v=Xu(V.v)),P.cm&&p.xlmeta){var ue=(p.xlmeta.Cell||[])[+P.cm-1];ue&&ue.type=="XLDAPR"&&(V.D=!0)}if(le){var I=ln(P.r);h[I.r]||(h[I.r]=[]),h[I.r][I.c]=V}else h[P.r]=V}}}}z.length>0&&(h["!rows"]=z)}})();function DT(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}var FT=ko;function jT(){}function PT(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=e_(e),t}function AT(e){var n=Gn(e);return[n]}function OT(e){var n=wo(e);return[n]}function RT(e){var n=Gn(e),t=e.read_shift(1);return[n,t,"b"]}function zT(e){var n=wo(e),t=e.read_shift(1);return[n,t,"b"]}function MT(e){var n=Gn(e),t=e.read_shift(1);return[n,t,"e"]}function IT(e){var n=wo(e),t=e.read_shift(1);return[n,t,"e"]}function LT(e){var n=Gn(e),t=e.read_shift(4);return[n,t,"s"]}function BT(e){var n=wo(e),t=e.read_shift(4);return[n,t,"s"]}function WT(e){var n=Gn(e),t=Xr(e);return[n,t,"n"]}function f1(e){var n=wo(e),t=Xr(e);return[n,t,"n"]}function UT(e){var n=Gn(e),t=gp(e);return[n,t,"n"]}function $T(e){var n=wo(e),t=gp(e);return[n,t,"n"]}function HT(e){var n=Gn(e),t=xp(e);return[n,t,"is"]}function YT(e){var n=Gn(e),t=Zr(e);return[n,t,"str"]}function VT(e){var n=wo(e),t=Zr(e);return[n,t,"str"]}function KT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}function GT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}function QT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=Xr(e),l=[a,o,"n"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}function XT(e,n,t){var r=e.l+n,a=Gn(e);a.r=t["!row"];var o=Zr(e),l=[a,o,"str"];if(t.cellFormula){e.l+=2;var c=Ju(e,r-e.l,t);l[3]=Qr(c,null,a,t.supbooks,t)}else e.l=r;return l}var qT=ko;function ZT(e,n){var t=e.l+n,r=ko(e),a=mp(e),o=Zr(e),l=Zr(e),c=Zr(e);e.l=t;var f={rfx:r,relId:a,loc:o,display:c};return l&&(f.Tooltip=l),f}function JT(){}function eD(e,n,t){var r=e.l+n,a=Dy(e),o=e.read_shift(1),l=[a];if(l[2]=o,t.cellFormula){var c=sT(e,r-e.l,t);l[1]=c}else e.l=r;return l}function tD(e,n,t){var r=e.l+n,a=ko(e),o=[a];if(t.cellFormula){var l=iT(e,r-e.l,t);o[1]=l,e.l=r}else e.l=r;return o}var rD=["left","right","top","bottom","header","footer"];function nD(e){var n={};return rD.forEach(function(t){n[t]=Xr(e)}),n}function aD(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function sD(){}function oD(){}function iD(e,n,t,r,a,o,l){if(!e)return e;var c=n||{};r||(r={"!id":{}});var f=c.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,v,w,b,k,T,j,C,W,J,V=[];c.biff=12,c["!row"]=0;var P=0,U=!1,B=[],ne={},ee=c.supbooks||a.supbooks||[[]];if(ee.sharedf=ne,ee.arrayf=B,ee.SheetNames=a.SheetNames||a.Sheets.map(function(le){return le.name}),!c.supbooks&&(c.supbooks=ee,a.Names))for(var Y=0;Y<a.Names.length;++Y)ee[0][Y+1]=a.Names[Y];var fe=[],de=[],oe=!1;Ou[16]={n:"BrtShortReal",f:f1};var he;if(ts(e,function(z,se,R){if(!g)switch(R){case 148:h=z;break;case 0:v=z,c.sheetRows&&c.sheetRows<=v.r&&(g=!0),W=$r(k=v.r),c["!row"]=v.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=Nl(z.hpt)),de[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:z[2]},z[2]){case"n":w.v=z[1];break;case"s":C=ml[z[1]],w.v=C.t,w.r=C.r;break;case"b":w.v=!!z[1];break;case"e":w.v=z[1],c.cellText!==!1&&(w.w=bo[w.v]);break;case"str":w.t="s",w.v=z[1];break;case"is":w.t="s",w.v=z[1].t;break}if((b=l.CellXf[z[0].iStyleRef])&&u1(w,b.numFmtId,null,c,o,l),T=z[0].c==-1?T+1:z[0].c,c.dense?(f[k]||(f[k]=[]),f[k][T]=w):f[Dr(T)+W]=w,c.cellFormula){for(U=!1,P=0;P<B.length;++P){var S=B[P];v.r>=S[0].s.r&&v.r<=S[0].e.r&&T>=S[0].s.c&&T<=S[0].e.c&&(w.F=Ot(S[0]),U=!0)}!U&&z.length>3&&(w.f=z[3])}if(p.s.r>v.r&&(p.s.r=v.r),p.s.c>T&&(p.s.c=T),p.e.r<v.r&&(p.e.r=v.r),p.e.c<T&&(p.e.c=T),c.cellDates&&b&&w.t=="n"&&mi(Et[b.numFmtId])){var G=to(w.v);G&&(w.t="d",w.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}he&&(he.type=="XLDAPR"&&(w.D=!0),he=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;w={t:"z",v:void 0},T=z[0].c==-1?T+1:z[0].c,c.dense?(f[k]||(f[k]=[]),f[k][T]=w):f[Dr(T)+W]=w,p.s.r>v.r&&(p.s.r=v.r),p.s.c>T&&(p.s.c=T),p.e.r<v.r&&(p.e.r=v.r),p.e.c<T&&(p.e.c=T),he&&(he.type=="XLDAPR"&&(w.D=!0),he=void 0);break;case 176:V.push(z);break;case 49:he=((c.xlmeta||{}).Cell||[])[z-1];break;case 494:var D=r["!id"][z.relId];for(D?(z.Target=D.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=D):z.relId==""&&(z.Target="#"+z.loc),k=z.rfx.s.r;k<=z.rfx.e.r;++k)for(T=z.rfx.s.c;T<=z.rfx.e.c;++T)c.dense?(f[k]||(f[k]=[]),f[k][T]||(f[k][T]={t:"z",v:void 0}),f[k][T].l=z):(j=St({c:T,r:k}),f[j]||(f[j]={t:"z",v:void 0}),f[j].l=z);break;case 426:if(!c.cellFormula)break;B.push(z),J=c.dense?f[k][T]:f[Dr(T)+W],J.f=Qr(z[1],p,{r:v.r,c:T},ee,c),J.F=Ot(z[0]);break;case 427:if(!c.cellFormula)break;ne[St(z[0].s)]=z[1],J=c.dense?f[k][T]:f[Dr(T)+W],J.f=Qr(z[1],p,{r:v.r,c:T},ee,c);break;case 60:if(!c.cellStyles)break;for(;z.e>=z.s;)fe[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},oe||(oe=!0,kp(z.w/256)),ci(fe[z.e+1]);break;case 161:f["!autofilter"]={ref:Ot(z)};break;case 476:f["!margins"]=z;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),z.name&&(a.Sheets[t].CodeName=z.name),(z.above||z.left)&&(f["!outline"]={above:z.above,left:z.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),z.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!se.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=Ot(h||p)),c.sheetRows&&f["!ref"]){var X=hr(f["!ref"]);c.sheetRows<=+X.e.r&&(X.e.r=c.sheetRows-1,X.e.r>p.e.r&&(X.e.r=p.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>p.e.c&&(X.e.c=p.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Ot(X))}return V.length>0&&(f["!merges"]=V),fe.length>0&&(f["!cols"]=fe),de.length>0&&(f["!rows"]=de),f}function lD(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(n[+l[1]]=t?+l[2]:l[2])});var a=Lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,a,r]}function cD(e,n,t,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var c=0,f=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=lD(m);p.s.r=p.s.c=0,p.e.c=c,h=Dr(c),g[0].forEach(function(v,w){l[h+$r(w)]={t:"n",v,z:g[1]},f=w}),p.e.r<f&&(p.e.r=f),++c}),c>0&&(l["!ref"]=Ot(p)),l}function uD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(d1);return c&&_p(c[0],o,a,t),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function dD(e,n){e.l+=10;var t=Zr(e);return{name:t}}function fD(e,n,t,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ts(e,function(f,h,p){switch(p){case 550:o["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var p1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hD=[],xD=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jg(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],a=0;a!=n.length;++a){var o=n[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=ir(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Pg(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=ir(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function h1(e){Pg(e.WBProps,p1),Pg(e.CalcPr,xD),jg(e.WBView,pD),jg(e.Sheets,hD),ai.date1904=ir(e.WBProps.date1904)}var mD="][*?/\\".split("");function gD(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return mD.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var vD=/<\w+:workbook/;function yD(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace(en,function(f,h){var p=wt(f);switch(Da(p[0])){case"<?xml":break;case"<workbook":f.match(vD)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":p1.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":t.WBProps[m[0]]=ir(p[m[0]]);break;case"int":t.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:t.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(t.WBProps.CodeName=tr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Lt(tr(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=tr(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),ir(p.hidden||"0")&&(o.Hidden=!0),l=h+f.length;break;case"</definedName>":o.Ref=Lt(tr(e.slice(l,h))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),M2.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return h1(t),t}function wD(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Cf(e),t.name=Zr(e),t}function kD(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=n>8?Zr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function bD(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function _D(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var a=e.read_shift(4),o=t_(e),l=oT(e,0,t),c=mp(e);e.l=r;var f={Name:o,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function SD(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;n||(n={}),n.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ou[16]={n:"BrtFRTArchID$",f:bD},ts(e,function(f,h,p){switch(p){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(n.SID=f.Sheet),f.Ref=Qr(f.Ptg,null,null,l,n),delete n.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,f]):l[0]=[p,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(p),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},n),h1(t),t.Names=o,t.supbooks=l,t}function ED(e,n,t){return n.slice(-4)===".bin"?SD(e,t):yD(e,t)}function ND(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?iD(e,r,t,a,o,l,c):wT(e,r,t,a,o,l,c)}function CD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?fD(e,r,t,a,o):uD(e,r,t,a,o)}function TD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?zN():MN()}function DD(e,n,t,r,a,o,l,c){return n.slice(-4)===".bin"?ON():RN()}function FD(e,n,t,r){return n.slice(-4)===".bin"?qE(e,t,r):YE(e,t,r)}function jD(e,n,t){return e1(e,t)}function PD(e,n,t){return n.slice(-4)===".bin"?pE(e,t):dE(e,t)}function AD(e,n,t){return n.slice(-4)===".bin"?jN(e,t):NN(e,t)}function OD(e,n,t){return n.slice(-4)===".bin"?_N(e):kN(e)}function RD(e,n,t,r){return t.slice(-4)===".bin"?SN(e,n,t,r):void 0}function zD(e,n,t){return n.slice(-4)===".bin"?yN(e,n,t):wN(e,n,t)}var x1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,m1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ra(e,n){var t=e.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=e.match(x1),o,l,c,f;if(a)for(f=0;f!=a.length;++f)o=a[f].match(m1),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?c="xmlns"+o[1].slice(6):c=o[1].slice(l+1),r[c]=o[2].slice(1,o[2].length-1));return r}function MD(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(x1),a,o,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(m1),(o=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),t[l]=a[2].slice(1,a[2].length-1));return t}var vl;function ID(e,n){var t=vl[e]||Lt(e);return t==="General"?uo(n):Vn(t,n)}function LD(e,n,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ir(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=zr(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Lt(n)]=a}function BD(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=ID(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=vl[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&mi(r)){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(t.WTF)throw o}}}function WD(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=LE[r.Pattern]||r.Pattern)}e[n.ID]=n}function UD(e,n,t,r,a,o,l,c,f,h){var p="General",m=r.StyleID,g={};h=h||{};var v=[],w=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&l&&(m=l.StyleID);o[m]!==void 0&&(o[m].nf&&(p=o[m].nf),o[m].Interior&&v.push(o[m].Interior),!!o[m].Parent);)m=o[m].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=ir(e);break;case"String":r.t="s",r.r=eg(Lt(e)),r.v=e.indexOf("<")>-1?Lt(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(zr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Lt(e):r.v<60&&(r.v=r.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Py[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=eg(n||e));break}if(BD(r,p,h),h.cellFormula!==!1)if(r.Formula){var b=Lt(r.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),r.f=ni(b,a),delete r.Formula,r.ArrayRange=="RC"?r.F=ni("RC:RC",a):r.ArrayRange&&(r.F=ni(r.ArrayRange,a),f.push([hr(r.F),r.F]))}else for(w=0;w<f.length;++w)a.r>=f[w][0].s.r&&a.r<=f[w][0].e.r&&a.c>=f[w][0].s.c&&a.c<=f[w][0].e.c&&(r.F=f[w][1]);h.cellStyles&&(v.forEach(function(k){!g.patternType&&k.patternType&&(g.patternType=k.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function $D(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sf(e,n){var t=n||{};ay();var r=al(dp(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=tr(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Ur(t);return l.type="string",Sl.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ne){a.indexOf("<"+Ne)>=0&&(o=!0)}),o)return ZD(r,t);vl={"General Number":"General","General Date":Et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Et[15],"Short Date":Et[14],"Long Time":Et[19],"Medium Time":Et[18],"Short Time":Et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Et[2],Standard:Et[4],Percent:Et[10],Scientific:Et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],h,p={},m=[],g=t.dense?[]:{},v="",w={},b={},k=ra('<Data ss:Type="String">'),T=0,j=0,C=0,W={s:{r:2e6,c:2e6},e:{r:0,c:0}},J={},V={},P="",U=0,B=[],ne={},ee={},Y=0,fe=[],de=[],oe={},he=[],X,le=!1,z=[],se=[],R={},S=0,G=0,D={Sheets:[],WBProps:{date1904:!1}},E={};_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var F="";c=_l.exec(r);)switch(c[3]=(F=c[3]).toLowerCase()){case"data":if(F=="data"){if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?UD(r.slice(T,c.index),P,k,f[f.length-1][0]=="comment"?oe:w,{c:j,r:C},J,he[j],b,z,t):(P="",k=ra(c[0]),T=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(de.length>0&&(w.c=de),(!t.sheetRows||t.sheetRows>C)&&w.v!==void 0&&(t.dense?(g[C]||(g[C]=[]),g[C][j]=w):g[Dr(j)+$r(C)]=w),w.HRef&&(w.l={Target:Lt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(S=j+(parseInt(w.MergeAcross,10)|0),G=C+(parseInt(w.MergeDown,10)|0),B.push({s:{c:j,r:C},e:{c:S,r:G}})),!t.sheetStubs)w.MergeAcross?j=S+1:++j;else if(w.MergeAcross||w.MergeDown){for(var A=j;A<=S;++A)for(var q=C;q<=G;++q)(A>j||q>C)&&(t.dense?(g[q]||(g[q]=[]),g[q][A]={t:"z"}):g[Dr(A)+$r(q)]={t:"z"});j=S+1}else++j;else w=MD(c[0]),w.Index&&(j=+w.Index-1),j<W.s.c&&(W.s.c=j),j>W.e.c&&(W.e.c=j),c[0].slice(-2)==="/>"&&++j,de=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<W.s.r&&(W.s.r=C),C>W.e.r&&(W.e.r=C),c[0].slice(-2)==="/>"&&(b=ra(c[0]),b.Index&&(C=+b.Index-1)),j=0,++C):(b=ra(c[0]),b.Index&&(C=+b.Index-1),R={},(b.AutoFitHeight=="0"||b.Height)&&(R.hpx=parseInt(b.Height,10),R.hpt=Jy(R.hpx),se[C]=R),b.Hidden=="1"&&(R.hidden=!0,se[C]=R));break;case"worksheet":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));m.push(v),W.s.r<=W.e.r&&W.s.c<=W.e.c&&(g["!ref"]=Ot(W),t.sheetRows&&t.sheetRows<=W.e.r&&(g["!fullref"]=g["!ref"],W.e.r=t.sheetRows-1,g["!ref"]=Ot(W))),B.length&&(g["!merges"]=B),he.length>0&&(g["!cols"]=he),se.length>0&&(g["!rows"]=se),p[v]=g}else W={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=j=0,f.push([c[3],!1]),h=ra(c[0]),v=Lt(h.Name),g=t.dense?[]:{},B=[],z=[],se=[],E={name:v,Hidden:0},D.Sheets.push(E);break;case"table":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),he=[],le=!1}break;case"style":c[1]==="/"?WD(J,V,t):V=ra(c[0]);break;case"numberformat":V.nf=Lt(ra(c[0]).Format||"General"),vl[V.nf]&&(V.nf=vl[V.nf]);for(var H=0;H!=392&&Et[H]!=V.nf;++H);if(H==392){for(H=57;H!=392;++H)if(Et[H]==null){ao(V.nf,H);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(X=ra(c[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!le&&X.wpx>10){le=!0,sn=qy;for(var L=0;L<he.length;++L)he[L]&&ci(he[L])}le&&ci(X),he[X.Index-1||he.length]=X;for(var ue=0;ue<+X.Span;++ue)he[he.length]=Ur(X);break;case"namedrange":if(c[1]==="/")break;D.Names||(D.Names=[]);var I=wt(c[0]),Oe={Name:I.Name,Ref:ni(I.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(Oe.Sheet=D.Sheets.length-1),D.Names.push(Oe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?P+=r.slice(U,c.index):U=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;V.Interior=ra(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?N_(ne,F,r.slice(Y,c.index)):Y=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));$D(oe),de.push(oe)}else f.push([c[3],!1]),h=ra(c[0]),oe={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ae=ra(c[0]);g["!autofilter"]={ref:ni(Ae.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return Ig(r,t);var Xe=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(c[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(Y,c.index)){case"SheetHidden":E.Hidden=1;break;case"SheetVeryHidden":E.Hidden=2;break}else Y=c.index+c[0].length;break;case"header":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+wt(c[0]).Margin)||(g["!margins"].header=+wt(c[0]).Margin);break;case"footer":g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+wt(c[0]).Margin)||(g["!margins"].footer=+wt(c[0]).Margin);break;case"pagemargins":var qe=wt(c[0]);g["!margins"]||gl(g["!margins"]={},"xlml"),isNaN(+qe.Top)||(g["!margins"].top=+qe.Top),isNaN(+qe.Left)||(g["!margins"].left=+qe.Left),isNaN(+qe.Right)||(g["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(g["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?LD(ee,F,fe,r.slice(Y,c.index)):(fe=c,Y=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var pe={};return!t.bookSheets&&!t.bookProps&&(pe.Sheets=p),pe.SheetNames=m,pe.Workbook=D,pe.SSF=Ur(Et),pe.Props=ne,pe.Custprops=ee,pe}function jf(e,n){switch(Np(n=n||{}),n.type||"base64"){case"base64":return sf(Tn(e),n);case"binary":case"buffer":case"file":return sf(e,n);case"array":return sf(yo(e),n)}}function HD(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=a_(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=s_(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var YD=[60,1084,2066,2165,2175];function VD(e,n,t,r,a){var o=r,l=[],c=t.slice(t.l,t.l+o);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),t.l+=o;for(var f=Ya(t,t.l),h=Pf[f],p=0;h!=null&&YD.indexOf(f)>-1;)o=Ya(t,t.l+2),p=t.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),c=t.slice(p,t.l+4+o),l.push(c),t.l+=4+o,h=Pf[f=Ya(t,t.l)];var m=Es(l);Br(m,0);var g=0;m.lens=[];for(var v=0;v<l.length;++v)m.lens.push(g),g+=l[v].length;if(m.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+r;return n.f(m,m.length,a)}function ga(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=Et[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||bo[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kl(e.v):e.w=uo(e.v):e.w=Vn(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&mi(Et[r]||String(r))){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function iu(e,n,t){return{v:e,ixfe:n,t}}function KD(e,n){var t={opts:{}},r={},a=n.dense?[]:{},o={},l={},c=null,f=[],h="",p={},m,g="",v,w,b,k,T={},j=[],C,W,J=[],V=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},B=function(pt){return pt<8?so[pt]:pt<64&&V[pt-8]||so[pt]},ne=function(pt,Nt,Yt){var Ft=Nt.XF.data;if(!(!Ft||!Ft.patternType||!Yt||!Yt.cellStyles)){Nt.s={},Nt.s.patternType=Ft.patternType;var Bt;(Bt=El(B(Ft.icvFore)))&&(Nt.s.fgColor={rgb:Bt}),(Bt=El(B(Ft.icvBack)))&&(Nt.s.bgColor={rgb:Bt})}},ee=function(pt,Nt,Yt){if(!(R>1)&&!(Yt.sheetRows&&pt.r>=Yt.sheetRows)){if(Yt.cellStyles&&Nt.XF&&Nt.XF.data&&ne(pt,Nt,Yt),delete Nt.ixfe,delete Nt.XF,m=pt,g=St(pt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),pt.r<l.s.r&&(l.s.r=pt.r),pt.c<l.s.c&&(l.s.c=pt.c),pt.r+1>l.e.r&&(l.e.r=pt.r+1),pt.c+1>l.e.c&&(l.e.c=pt.c+1),Yt.cellFormula&&Nt.f){for(var Ft=0;Ft<j.length;++Ft)if(!(j[Ft][0].s.c>pt.c||j[Ft][0].s.r>pt.r)&&!(j[Ft][0].e.c<pt.c||j[Ft][0].e.r<pt.r)){Nt.F=Ot(j[Ft][0]),(j[Ft][0].s.c!=pt.c||j[Ft][0].s.r!=pt.r)&&delete Nt.f,Nt.f&&(Nt.f=""+Qr(j[Ft][1],l,pt,z,Y));break}}Yt.dense?(a[pt.r]||(a[pt.r]=[]),a[pt.r][pt.c]=Nt):a[g]=Nt}},Y={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:j,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(Y.password=n.password);var fe,de=[],oe=[],he=[],X=[],le=!1,z=[];z.SheetNames=Y.snames,z.sharedf=Y.sharedf,z.arrayf=Y.arrayf,z.names=[],z.XTI=[];var se=0,R=0,S=0,G=[],D=[],E;Y.codepage=1200,sa(1200);for(var F=!1;e.l<e.length-1;){var A=e.l,q=e.read_shift(2);if(q===0&&se===10)break;var H=e.l===e.length?0:e.read_shift(2),L=Pf[q];if(L&&L.f){if(n.bookSheets&&se===133&&q!==133)break;if(se=q,L.r===2||L.r==12){var ue=e.read_shift(2);if(H-=2,!Y.enc&&ue!==q&&((ue&255)<<8|ue>>8)!==q)throw new Error("rt mismatch: "+ue+"!="+q);L.r==12&&(e.l+=10,H-=10)}var I={};if(q===10?I=L.f(e,H,Y):I=VD(q,L,e,H,Y),R==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(q){case 34:t.opts.Date1904=P.WBProps.date1904=I;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=I,!n.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=I;break;case 66:var Oe=Number(I);switch(Oe){case 21010:Oe=1200;break;case 32768:Oe=1e4;break;case 32769:Oe=1252;break}sa(Y.codepage=Oe),F=!0;break;case 317:Y.rrtabid=I;break;case 25:Y.winlocked=I;break;case 439:t.opts.RefreshAll=I;break;case 12:t.opts.CalcCount=I;break;case 16:t.opts.CalcDelta=I;break;case 17:t.opts.CalcIter=I;break;case 13:t.opts.CalcMode=I;break;case 14:t.opts.CalcPrecision=I;break;case 95:t.opts.CalcSaveRecalc=I;break;case 15:Y.CalcRefMode=I;break;case 2211:t.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:J.push(I);break;case 430:z.push([I]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(I);break;case 24:case 536:E={Name:I.Name,Ref:Qr(I.rgce,l,null,z,Y)},I.itab>0&&(E.Sheet=I.itab-1),z.names.push(E),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(D[I.itab-1]={ref:Ot(I.rgce[0][0][1][2])});break;case 22:Y.ExternCount=I;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(I),z.XTI=z.XTI.concat(I);break;case 2196:if(Y.biff<8)break;E!=null&&(E.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&Y.WTF&&console.error("Password verifier: "+I);break;case 133:o[I.pos]=I,Y.snames.push(I.name);break;case 10:{if(--R)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Ot(l),n.sheetRows&&n.sheetRows<=l.e.r){var Ae=l.e.r;l.e.r=n.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ot(l),l.e.r=Ae}l.e.r++,l.e.c++}de.length>0&&(a["!merges"]=de),oe.length>0&&(a["!objects"]=oe),he.length>0&&(a["!cols"]=he),X.length>0&&(a["!rows"]=X),P.Sheets.push(U)}h===""?p=a:r[h]=a,a=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),Y.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(Y.biff=5,F=!0,sa(Y.codepage=28591)),Y.biff==8&&I.BIFFVer==0&&I.dt==16&&(Y.biff=2),R++)break;if(a=n.dense?[]:{},Y.biff<8&&!F&&(F=!0,sa(Y.codepage=n.codepage||1252)),Y.biff<5||I.BIFFVer==0&&I.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:e.l-H,name:h};o[Xe.pos]=Xe,Y.snames.push(h)}else h=(o[A]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),de=[],oe=[],Y.arrayf=j=[],he=[],X=[],le=!1,U={Hidden:(o[A]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(n.dense?(a[I.r]||[])[I.c]:a[St({c:I.c,r:I.r})])&&++I.c,C={ixfe:I.ixfe,XF:J[I.ixfe]||{},v:I.val,t:"n"},S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:I.c,r:I.r},C,n);break;case 5:case 517:C={ixfe:I.ixfe,XF:J[I.ixfe],v:I.val,t:I.t},S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:I.c,r:I.r},C,n);break;case 638:C={ixfe:I.ixfe,XF:J[I.ixfe],v:I.rknum,t:"n"},S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:I.c,r:I.r},C,n);break;case 189:for(var qe=I.c;qe<=I.C;++qe){var pe=I.rkrec[qe-I.c][0];C={ixfe:pe,XF:J[pe],v:I.rkrec[qe-I.c][1],t:"n"},S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:qe,r:I.r},C,n)}break;case 6:case 518:case 1030:{if(I.val=="String"){c=I;break}if(C=iu(I.val,I.cell.ixfe,I.tt),C.XF=J[C.ixfe],n.cellFormula){var Ne=I.formula;if(Ne&&Ne[0]&&Ne[0][0]&&Ne[0][0][0]=="PtgExp"){var je=Ne[0][0][1][0],_e=Ne[0][0][1][1],Qe=St({r:je,c:_e});T[Qe]?C.f=""+Qr(I.formula,l,I.cell,z,Y):C.F=((n.dense?(a[je]||[])[_e]:a[Qe])||{}).F}else C.f=""+Qr(I.formula,l,I.cell,z,Y)}S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee(I.cell,C,n),c=I}break;case 7:case 519:if(c)c.val=I,C=iu(I,c.cell.ixfe,"s"),C.XF=J[C.ixfe],n.cellFormula&&(C.f=""+Qr(c.formula,l,c.cell,z,Y)),S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee(c.cell,C,n),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{j.push(I);var ft=St(I[0].s);if(v=n.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[ft],n.cellFormula&&v){if(!c||!ft||!v)break;v.f=""+Qr(I[1],l,I[0],z,Y),v.F=Ot(I[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!c)break;T[St(c.cell)]=I[0],v=n.dense?(a[c.cell.r]||[])[c.cell.c]:a[St(c.cell)],(v||{}).f=""+Qr(I[0],l,m,z,Y)}}break;case 253:C=iu(f[I.isst].t,I.ixfe,"s"),f[I.isst].h&&(C.h=f[I.isst].h),C.XF=J[C.ixfe],S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:I.c,r:I.r},C,n);break;case 513:n.sheetStubs&&(C={ixfe:I.ixfe,XF:J[I.ixfe],t:"z"},S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:I.c,r:I.r},C,n));break;case 190:if(n.sheetStubs)for(var ht=I.c;ht<=I.C;++ht){var vt=I.ixfe[ht-I.c];C={ixfe:vt,XF:J[vt],t:"z"},S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:ht,r:I.r},C,n)}break;case 214:case 516:case 4:C=iu(I.val,I.ixfe,"s"),C.XF=J[C.ixfe],S>0&&(C.z=G[C.ixfe>>8&63]),ga(C,n,t.opts.Date1904),ee({c:I.c,r:I.r},C,n);break;case 0:case 512:R===1&&(l=I);break;case 252:f=I;break;case 1054:if(Y.biff==4){G[S++]=I[1];for(var jt=0;jt<S+163&&Et[jt]!=I[1];++jt);jt>=163&&ao(I[1],S+163)}else ao(I[1],I[0]);break;case 30:{G[S++]=I;for(var Gt=0;Gt<S+163&&Et[Gt]!=I;++Gt);Gt>=163&&ao(I,S+163)}break;case 229:de=de.concat(I);break;case 93:oe[I.cmo[0]]=Y.lastobj=I;break;case 438:Y.lastobj.TxO=I;break;case 127:Y.lastobj.ImData=I;break;case 440:for(k=I[0].s.r;k<=I[0].e.r;++k)for(b=I[0].s.c;b<=I[0].e.c;++b)v=n.dense?(a[k]||[])[b]:a[St({c:b,r:k})],v&&(v.l=I[1]);break;case 2048:for(k=I[0].s.r;k<=I[0].e.r;++k)for(b=I[0].s.c;b<=I[0].e.c;++b)v=n.dense?(a[k]||[])[b]:a[St({c:b,r:k})],v&&v.l&&(v.l.Tooltip=I[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;v=n.dense?(a[I[0].r]||[])[I[0].c]:a[St(I[0])];var sr=oe[I[2]];v||(n.dense?(a[I[0].r]||(a[I[0].r]=[]),v=a[I[0].r][I[0].c]={t:"z"}):v=a[St(I[0])]={t:"z"},l.e.r=Math.max(l.e.r,I[0].r),l.s.r=Math.min(l.s.r,I[0].r),l.e.c=Math.max(l.e.c,I[0].c),l.s.c=Math.min(l.s.c,I[0].c)),v.c||(v.c=[]),w={a:I[1],t:sr.TxO.t},v.c.push(w)}break;case 2173:xN(J[I.ixfe],I.ext);break;case 125:{if(!Y.cellStyles)break;for(;I.e>=I.s;)he[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},le||(le=!0,kp(I.w/256)),ci(he[I.e+1])}break;case 520:{var Rt={};I.level!=null&&(X[I.r]=Rt,Rt.level=I.level),I.hidden&&(X[I.r]=Rt,Rt.hidden=!0),I.hpt&&(X[I.r]=Rt,Rt.hpt=I.hpt,Rt.hpx=Nl(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||gl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[q]]=I;break;case 161:a["!margins"]||gl(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(P.Views[0].RTL=!0);break;case 146:V=I;break;case 2198:fe=I;break;case 140:W=I;break;case 442:h?U.CodeName=I||U.name:P.WBProps.CodeName=I||"ThisWorkbook";break}}else L||console.error("Missing Info for XLS Record 0x"+q.toString(16)),e.l+=H}return t.SheetNames=Ca(o).sort(function(Ht,pt){return Number(Ht)-Number(pt)}).map(function(Ht){return o[Ht].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&D.forEach(function(Ht,pt){t.Sheets[t.SheetNames[pt]]["!autofilter"]=Ht}),t.Strings=f,t.SSF=Ur(Et),Y.enc&&(t.Encryption=Y.enc),fe&&(t.Themes=fe),t.Metadata={},W!==void 0&&(t.Metadata.Country=W),z.names.length>0&&(P.Names=z.names),t.Workbook=P,t}var Ag={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function GD(e,n,t){var r=At.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=mg(r,d_,Ag.DSI);for(var o in a)n[o]=a[o]}catch(h){if(t.WTF)throw h}var l=At.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=mg(l,f_,Ag.SI);for(var f in c)n[f]==null&&(n[f]=c[f])}catch(h){if(t.WTF)throw h}n.HeadingPairs&&n.TitlesOfParts&&(Oy(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function g1(e,n){n||(n={}),Np(n),Vv(),n.codepage&&ap(n.codepage);var t,r;if(e.FullPaths){if(At.find(e,"/encryption"))throw new Error("File is password-protected");t=At.find(e,"!CompObj"),r=At.find(e,"/Workbook")||At.find(e,"/Book")}else{switch(n.type){case"base64":e=aa(Tn(e));break;case"binary":e=aa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Br(e,0),r={content:e}}var a,o;if(t&&HD(t),n.bookProps&&!n.bookSheets)a={};else{var l=Pt?"buffer":"array";if(r&&r.content)a=KD(r.content,n);else if((o=At.find(e,"PerfectOffice_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else if((o=At.find(e,"NativeContent_MAIN"))&&o.content)a=xl.to_workbook(o.content,(n.type=l,n));else throw(o=At.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&At.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=AN(e))}var c={};return e.FullPaths&&GD(e,c,n),a.Props=a.Custprops=c,n.bookFiles&&(a.cfb=e),a}var Ou={0:{f:DT},1:{f:AT},2:{f:UT},3:{f:MT},4:{f:RT},5:{f:WT},6:{f:YT},7:{f:LT},8:{f:XT},9:{f:QT},10:{f:KT},11:{f:GT},12:{f:OT},13:{f:$T},14:{f:IT},15:{f:zT},16:{f:f1},17:{f:VT},18:{f:BT},19:{f:xp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_D},40:{},42:{},43:{f:KE},44:{f:VE},45:{f:GE},46:{f:XE},47:{f:QE},48:{},49:{f:q2},50:{},51:{f:gN},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Vy},62:{f:HT},63:{f:bN},64:{f:sD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:aD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:PT},148:{f:FT,p:16},151:{f:JT},152:{},153:{f:kD},154:{},155:{},156:{f:wD},157:{},158:{},159:{T:1,f:fE},160:{T:-1},161:{T:1,f:ko},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:mN},336:{T:-1},337:{f:vN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Yy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eD},427:{f:tD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jT},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ZT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FN},633:{T:1},634:{T:-1},635:{T:1,f:DN},636:{T:-1},637:{f:J2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:dD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:oD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Pf={6:{f:nf},10:{f:_s},12:{f:Er},13:{f:Er},14:{f:yr},15:{f:yr},16:{f:Xr},17:{f:yr},18:{f:yr},19:{f:Er},20:{f:wg},21:{f:wg},23:{f:Yy},24:{f:bg},25:{f:yr},26:{},27:{},28:{f:CS},29:{},34:{f:yr},35:{f:kg},38:{f:Xr},39:{f:Xr},40:{f:Xr},41:{f:Xr},42:{f:yr},43:{f:yr},47:{f:jE},49:{f:lS},51:{f:Er},60:{},61:{f:sS},64:{f:yr},65:{f:iS},66:{f:Er},77:{},80:{},81:{},82:{},85:{f:Er},89:{},90:{},91:{},92:{f:q_},93:{f:DS},94:{},95:{f:yr},96:{},97:{},99:{f:yr},125:{f:Vy},128:{f:vS},129:{f:Z_},130:{f:Er},131:{f:yr},132:{f:yr},133:{f:J_},134:{},140:{f:RS},141:{f:Er},144:{},146:{f:MS},151:{},152:{},153:{},154:{},155:{},156:{f:Er},157:{},158:{},160:{f:US},161:{f:LS},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:hS},190:{f:xS},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:yr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Er},220:{},221:{f:yr},222:{},224:{f:gS},225:{f:X_},226:{f:_s},227:{},229:{f:TS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:eS},253:{f:cS},255:{f:tS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ly},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yr},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:wS},431:{f:yr},432:{},433:{},434:{},437:{},438:{f:PS},439:{f:yr},440:{f:AS},441:{},442:{f:Rl},443:{},444:{f:Er},445:{},446:{},448:{f:_s},449:{f:aS,r:2},450:{f:_s},512:{f:vg},513:{f:WS},515:{f:yS},516:{f:uS},517:{f:yg},519:{f:$S},520:{f:rS},523:{},545:{f:_g},549:{f:gg},566:{},574:{f:oS},638:{f:pS},659:{},1048:{},1054:{f:dS},1084:{},1212:{f:SS},2048:{f:OS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:au},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:IS,r:12},2173:{f:hN,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_S,r:12},2197:{},2198:{f:lN,r:12},2199:{},2200:{},2201:{},2202:{f:ES,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:nS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:BS},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:zS},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:vg},1:{},2:{f:KS},3:{f:VS},4:{f:YS},5:{f:yg},7:{f:GS},8:{},9:{f:au},11:{},22:{f:Er},30:{f:fS},31:{},32:{},33:{f:_g},36:{},37:{f:gg},50:{f:QS},62:{},52:{},67:{},68:{f:Er},69:{},86:{},126:{},127:{f:HS},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:XS},223:{},234:{},354:{},421:{},518:{f:nf},521:{f:au},536:{f:bg},547:{f:kg},561:{},579:{},1030:{f:nf},1033:{f:au},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function na(e,n,t,r){var a=n;if(!isNaN(a)){var o=(t||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&Ny(t)&&e.push(t)}}function Og(e,n){var t=n||{},r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,c=o&&o.index||e.length,f=y2(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,m=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<f.length;++l){var b=f[l].trim(),k=b.slice(0,3).toLowerCase();if(k=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(k!="<td"&&k!="<th")){var T=b.split(/<\/t[dh]>/i);for(c=0;c<T.length;++c){var j=T[c].trim();if(j.match(/<t[dh]/i)){for(var C=j,W=0;C.charAt(0)=="<"&&(W=C.indexOf(">"))>-1;)C=C.slice(W+1);for(var J=0;J<w.length;++J){var V=w[J];V.s.c==p&&V.s.r<h&&h<=V.e.r&&(p=V.e.c+1,J=-1)}var P=wt(j.slice(0,j.indexOf(">")));g=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||g>1)&&w.push({s:{r:h,c:p},e:{r:h+(m||1)-1,c:p+g-1}});var U=P.t||P["data-t"]||"";if(!C.length){p+=g;continue}if(C=py(C),v.s.r>h&&(v.s.r=h),v.e.r<h&&(v.e.r=h),v.s.c>p&&(v.s.c=p),v.e.c<p&&(v.e.c=p),!C.length){p+=g;continue}var B={t:"s",v:C};t.raw||!C.trim().length||U=="s"||(C==="TRUE"?B={t:"b",v:!0}:C==="FALSE"?B={t:"b",v:!1}:isNaN(ia(C))?isNaN(li(C).getDate())||(B={t:"d",v:zr(C)},t.cellDates||(B={t:"n",v:fn(B.v)}),B.z=t.dateNF||Et[14]):B={t:"n",v:ia(C)}),t.dense?(r[h]||(r[h]=[]),r[h][p]=B):r[St({r:h,c:p})]=B,p+=g}}}}return r["!ref"]=Ot(v),w.length&&(r["!merges"]=w),r}function QD(e,n,t,r){for(var a=e["!merges"]||[],o=[],l=n.s.c;l<=n.e.c;++l){for(var c=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>l)&&!(a[h].e.r<t||a[h].e.c<l)){if(a[h].s.r<t||a[h].s.c<l){c=-1;break}c=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(c<0)){var p=St({r:t,c:l}),m=r.dense?(e[t]||[])[l]:e[p],g=m&&m.v!=null&&(m.h||up(m.w||(Ja(m),m.w)||""))||"",v={};c>1&&(v.rowspan=c),f>1&&(v.colspan=f),r.editable?g='<span contenteditable="true">'+g+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),v.id=(r.id||"sjs")+"-"+p,o.push(R2("td",g,v))}}var w="<tr>";return w+o.join("")+"</tr>"}var XD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qD="</body></html>";function ZD(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ms(Og(t[0],n),n);var r=Tp();return t.forEach(function(a,o){Dp(r,Og(a,n),"Sheet"+(o+1))}),r}function JD(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function e4(e,n){var t=n||{},r=t.header!=null?t.header:XD,a=t.footer!=null?t.footer:qD,o=[r],l=gi(e["!ref"]);t.dense=Array.isArray(e),o.push(JD(e,l,t));for(var c=l.s.r;c<=l.e.r;++c)o.push(QD(e,l,c,t));return o.push("</table>"+a),o.join("")}function v1(e,n,t){var r=t||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}var c=n.getElementsByTagName("tr"),f=Math.min(r.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var p=gi(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),a==-1&&(h.e.r=a=p.e.r+1)}var m=[],g=0,v=e["!rows"]||(e["!rows"]=[]),w=0,b=0,k=0,T=0,j=0,C=0;for(e["!cols"]||(e["!cols"]=[]);w<c.length&&b<f;++w){var W=c[w];if(Rg(W)){if(r.display)continue;v[b]={hidden:!0}}var J=W.children;for(k=T=0;k<J.length;++k){var V=J[k];if(!(r.display&&Rg(V))){var P=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):py(V.innerHTML),U=V.getAttribute("data-z")||V.getAttribute("z");for(g=0;g<m.length;++g){var B=m[g];B.s.c==T+o&&B.s.r<b+a&&b+a<=B.e.r&&(T=B.e.c+1-o,g=-1)}C=+V.getAttribute("colspan")||1,((j=+V.getAttribute("rowspan")||1)>1||C>1)&&m.push({s:{r:b+a,c:T+o},e:{r:b+a+(j||1)-1,c:T+o+(C||1)-1}});var ne={t:"s",v:P},ee=V.getAttribute("data-t")||V.getAttribute("t")||"";P!=null&&(P.length==0?ne.t=ee||"z":r.raw||P.trim().length==0||ee=="s"||(P==="TRUE"?ne={t:"b",v:!0}:P==="FALSE"?ne={t:"b",v:!1}:isNaN(ia(P))?isNaN(li(P).getDate())||(ne={t:"d",v:zr(P)},r.cellDates||(ne={t:"n",v:fn(ne.v)}),ne.z=r.dateNF||Et[14]):ne={t:"n",v:ia(P)})),ne.z===void 0&&U!=null&&(ne.z=U);var Y="",fe=V.getElementsByTagName("A");if(fe&&fe.length)for(var de=0;de<fe.length&&!(fe[de].hasAttribute("href")&&(Y=fe[de].getAttribute("href"),Y.charAt(0)!="#"));++de);Y&&Y.charAt(0)!="#"&&(ne.l={Target:Y}),r.dense?(e[b+a]||(e[b+a]=[]),e[b+a][T+o]=ne):e[St({c:T+o,r:b+a})]=ne,h.e.c<T+o&&(h.e.c=T+o),T+=C}}++b}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),h.e.r=Math.max(h.e.r,b-1+a),e["!ref"]=Ot(h),b>=f&&(e["!fullref"]=Ot((h.e.r=c.length-w+b-1+a,h))),e}function y1(e,n){var t=n||{},r=t.dense?[]:{};return v1(r,e,n)}function t4(e,n){return Ms(y1(e,n),n)}function Rg(e){var n="",t=r4(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function r4(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function n4(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Lt(n.replace(/<[^>]*>/g,""));return[t]}var zg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function w1(e,n){var t=n||{},r=dp(e),a=[],o,l,c={name:""},f="",h=0,p,m,g={},v=[],w=t.dense?[]:{},b,k,T={value:""},j="",C=0,W=[],J=-1,V=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,B={},ne=[],ee={},Y=0,fe=0,de=[],oe=1,he=1,X=[],le={Names:[]},z={},se=["",""],R=[],S={},G="",D=0,E=!1,F=!1,A=0;for(_l.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=_l.exec(r);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?w["!ref"]=Ot(P):w["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=P.e.r&&(w["!fullref"]=w["!ref"],P.e.r=t.sheetRows-1,w["!ref"]=Ot(P)),ne.length&&(w["!merges"]=ne),de.length&&(w["!rows"]=de),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),v.push(p.name),g[p.name]=w,F=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=wt(b[0],!1),J=V=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,w=t.dense?[]:{},ne=[],de=[],F=!0);break;case"table-row-group":b[1]==="/"?--U:++U;break;case"table-row":case"":if(b[1]==="/"){J+=oe,oe=1;break}if(m=wt(b[0],!1),m.?J=m.-1:J==-1&&(J=0),oe=+m["number-rows-repeated"]||1,oe<10)for(A=0;A<oe;++A)U>0&&(de[J+A]={level:U});V=-1;break;case"covered-table-cell":b[1]!=="/"&&++V,t.sheetStubs&&(t.dense?(w[J]||(w[J]=[]),w[J][V]={t:"z"}):w[St({r:J,c:V})]={t:"z"}),j="",W=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++V,T=wt(b[0],!1),he=parseInt(T["number-columns-repeated"]||"1",10),k={t:"z",v:null},T.formula&&t.cellFormula!=!1&&(k.f=Fg(Lt(T.formula))),(T.||T["value-type"])=="string"&&(k.t="s",k.v=Lt(T["string-value"]||""),t.dense?(w[J]||(w[J]=[]),w[J][V]=k):w[St({r:J,c:V})]=k),V+=he-1;else if(b[1]!=="/"){++V,j="",C=0,W=[],he=1;var q=oe?J+oe-1:J;if(V>P.e.c&&(P.e.c=V),V<P.s.c&&(P.s.c=V),J<P.s.r&&(P.s.r=J),q>P.e.r&&(P.e.r=q),T=wt(b[0],!1),R=[],S={},k={t:T.||T["value-type"],v:null},t.cellFormula)if(T.formula&&(T.formula=Lt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(Y=parseInt(T["number-matrix-rows-spanned"],10)||0,fe=parseInt(T["number-matrix-columns-spanned"],10)||0,ee={s:{r:J,c:V},e:{r:J+Y-1,c:V+fe-1}},k.F=Ot(ee),X.push([ee,k.F])),T.formula)k.f=Fg(T.formula);else for(A=0;A<X.length;++A)J>=X[A][0].s.r&&J<=X[A][0].e.r&&V>=X[A][0].s.c&&V<=X[A][0].e.c&&(k.F=X[A][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(Y=parseInt(T["number-rows-spanned"],10)||0,fe=parseInt(T["number-columns-spanned"],10)||0,ee={s:{r:J,c:V},e:{r:J+Y-1,c:V+fe-1}},ne.push(ee)),T["number-columns-repeated"]&&(he=parseInt(T["number-columns-repeated"],10)),k.t){case"boolean":k.t="b",k.v=ir(T["boolean-value"]);break;case"float":k.t="n",k.v=parseFloat(T.value);break;case"percentage":k.t="n",k.v=parseFloat(T.value);break;case"currency":k.t="n",k.v=parseFloat(T.value);break;case"date":k.t="d",k.v=zr(T["date-value"]),t.cellDates||(k.t="n",k.v=fn(k.v)),k.z="m/d/yy";break;case"time":k.t="n",k.v=m2(T["time-value"])/86400,t.cellDates&&(k.t="d",k.v=Xu(k.v)),k.z="HH:MM:SS";break;case"number":k.t="n",k.v=parseFloat(T.);break;default:if(k.t==="string"||k.t==="text"||!k.t)k.t="s",T["string-value"]!=null&&(j=Lt(T["string-value"]),W=[]);else throw new Error("Unsupported value type "+k.t)}}else{if(E=!1,k.t==="s"&&(k.v=j||"",W.length&&(k.R=W),E=C==0),z.Target&&(k.l=z),R.length>0&&(k.c=R,R=[]),j&&t.cellText!==!1&&(k.w=j),E&&(k.t="z",delete k.v),(!E||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=J))for(var H=0;H<oe;++H){if(he=parseInt(T["number-columns-repeated"]||"1",10),t.dense)for(w[J+H]||(w[J+H]=[]),w[J+H][V]=H==0?k:Ur(k);--he>0;)w[J+H][V+he]=Ur(k);else for(w[St({r:J+H,c:V})]=k;--he>0;)w[St({r:J+H,c:V+he})]=Ur(k);P.e.c<=V&&(P.e.c=V)}he=parseInt(T["number-columns-repeated"]||"1",10),V+=he-1,he=0,k={},j="",W=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o;S.t=j,W.length&&(S.R=W),S.a=G,R.push(S)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);G="",D=0,j="",C=0,W=[];break;case"creator":b[1]==="/"?G=r.slice(D,b.index):D=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);j="",C=0,W=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(B[c.name]=f,(o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(f="",c=wt(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=wt(b[0],!1),f+=zg[b[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=wt(b[0],!1),f+=zg[b[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=r.slice(h,b.index);break}else h=b.index+b[0].length;break;case"named-range":l=wt(b[0],!1),se=af(l["cell-range-address"]);var L={Name:l.name,Ref:se[0]+"!"+se[1]};F&&(L.Sheet=v.length),le.Names.push(L);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!T||!T["string-value"])){var ue=n4(r.slice(C,b.index));j=(j.length>0?j+`
`:"")+ue[0]}else wt(b[0],!1),C=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{se=af(wt(b[0])["target-range-address"]),g[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(z=wt(b[0],!1),!z.href)break;z.Target=Lt(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(se=af(z.Target.slice(1)),z.Target="#"+se[0]+"!"+se[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(b)}}var I={Sheets:g,SheetNames:v,Workbook:le};return t.bookSheets&&delete I.Sheets,I}function Mg(e,n){n=n||{},Bn(e,"META-INF/manifest.xml")&&y_(Sr(e,"META-INF/manifest.xml"),n);var t=Nn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=w1(tr(t),n);return Bn(e,"meta.xml")&&(r.Props=Ay(Sr(e,"meta.xml"))),r}function Ig(e,n){return w1(e,n)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Sp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Af(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):tr(yo(e))}function Of(e){var n=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(a){t.set(a,r),r+=a.length}),t}function Lg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function a4(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,a=n+13;a>=n;--a)r=r*256+e[a];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function Cl(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Fr(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function qr(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],a=Cl(e,t),o=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(o){case 0:{for(var f=t[0];e[t[0]++]>=128;);c=e.slice(f,t[0])}break;case 5:l=4,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Cl(e,t),c=e.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:c,type:o};n[a]==null?n[a]=[h]:n[a].push(h)}return n}function Ep(e,n){return e?.map(function(t){return n(t.data)})||[]}function s4(e){for(var n,t=[],r=[0];r[0]<e.length;){var a=Cl(e,r),o=qr(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:Fr(o[1][0].data),messages:[]};o[2].forEach(function(c){var f=qr(c.data),h=Fr(f[3][0].data);l.messages.push({meta:f,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(n=o[3])!=null&&n[0]&&(l.merge=Fr(o[3][0].data)>>>0>0),t.push(l)}return t}function o4(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Cl(n,t),a=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var l=n[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=n[t[0]],c>1&&(l|=n[t[0]+1]<<8),c>2&&(l|=n[t[0]+2]<<16),c>3&&(l|=n[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}a.push(n.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,h=0;if(o==1?(h=(n[t[0]]>>2&7)+4,f=(n[t[0]++]&224)<<3,f|=n[t[0]++]):(h=(n[t[0]++]>>2)+1,o==2?(f=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(f=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Of(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var p=Of(a);if(p.length!=r)throw new Error("Unexpected length: ".concat(p.length," != ").concat(r));return p}function i4(e){for(var n=[],t=0;t<e.length;){var r=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(o4(r,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Of(n)}function l4(e,n,t,r){var a=Sp(e),o=a.getUint32(4,!0),l=(r>1?12:8)+Lg(o&(r>1?3470:398))*4,c=-1,f=-1,h=NaN,p=new Date(2001,0,1);o&512&&(c=a.getUint32(l,!0),l+=4),l+=Lg(o&(r>1?12288:4096))*4,o&16&&(f=a.getUint32(l,!0),l+=4),o&32&&(h=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:h};break;case 3:m={t:"s",v:n[f]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:t[c]};else if(f>-1)m={t:"s",v:n[f]};else if(!isNaN(h))m={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function c4(e,n,t){var r=Sp(e),a=r.getUint32(8,!0),o=12,l=-1,c=-1,f=NaN,h=NaN,p=new Date(2001,0,1);a&1&&(f=a4(e,o),o+=16),a&2&&(h=r.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(c=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:n[c]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return m}function u4(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return l4(e,n,t,e[0]);case 5:return c4(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fs(e){var n=qr(e);return Cl(n[1][0].data)}function Bg(e,n){var t=qr(n.data),r=Fr(t[1][0].data),a=t[3],o=[];return(a||[]).forEach(function(l){var c=qr(l.data),f=Fr(c[1][0].data)>>>0;switch(r){case 1:o[f]=Af(c[3][0].data);break;case 8:{var h=e[Fs(c[9][0].data)][0],p=qr(h.data),m=e[Fs(p[1][0].data)][0],g=Fr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=qr(m.data);o[f]=v[3].map(function(w){return Af(w.data)}).join("")}break}}),o}function d4(e,n){var t,r,a,o,l,c,f,h,p,m,g,v,w,b,k=qr(e),T=Fr(k[1][0].data)>>>0,j=Fr(k[2][0].data)>>>0,C=((r=(t=k[8])==null?void 0:t[0])==null?void 0:r.data)&&Fr(k[8][0].data)>0||!1,W,J;if((o=(a=k[7])==null?void 0:a[0])!=null&&o.data&&n!=0)W=(c=(l=k[7])==null?void 0:l[0])==null?void 0:c.data,J=(h=(f=k[6])==null?void 0:f[0])==null?void 0:h.data;else if((m=(p=k[4])==null?void 0:p[0])!=null&&m.data&&n!=1)W=(v=(g=k[4])==null?void 0:g[0])==null?void 0:v.data,J=(b=(w=k[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var V=C?4:1,P=Sp(W),U=[],B=0;B<W.length/2;++B){var ne=P.getUint16(B*2,!0);ne<65535&&U.push([B,ne])}if(U.length!=j)throw"Expected ".concat(j," cells, found ").concat(U.length);var ee=[];for(B=0;B<U.length-1;++B)ee[U[B][0]]=J.subarray(U[B][1]*V,U[B+1][1]*V);return U.length>=1&&(ee[U[U.length-1][0]]=J.subarray(U[U.length-1][1]*V)),{R:T,cells:ee}}function f4(e,n){var t,r=qr(n.data),a=(t=r?.[7])!=null&&t[0]?Fr(r[7][0].data)>>>0>0?1:0:-1,o=Ep(r[5],function(l){return d4(l,a)});return{nrows:Fr(r[4][0].data)>>>0,data:o.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,h){if(l[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));l[c.R][h]=f}),l},[])}}function p4(e,n,t){var r,a=qr(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Fr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Fr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Ot(o);var l=qr(a[4][0].data),c=Bg(e,e[Fs(l[4][0].data)][0]),f=(r=l[17])!=null&&r[0]?Bg(e,e[Fs(l[17][0].data)][0]):[],h=qr(l[3][0].data),p=0;h[1].forEach(function(m){var g=qr(m.data),v=e[Fs(g[2][0].data)][0],w=Fr(v.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=f4(e,v);b.data.forEach(function(k,T){k.forEach(function(j,C){var W=St({r:p+T,c:C}),J=u4(j,c,f);J&&(t[W]=J)})}),p+=b.nrows})}function h4(e,n){var t=qr(n.data),r={"!ref":"A1"},a=e[Fs(t[2][0].data)],o=Fr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return p4(e,a[0],r),r}function x4(e,n){var t,r=qr(n.data),a={name:(t=r[1])!=null&&t[0]?Af(r[1][0].data):"",sheets:[]},o=Ep(r[2],Fs);return o.forEach(function(l){e[l].forEach(function(c){var f=Fr(c.meta[1][0].data);f==6e3&&a.sheets.push(h4(e,c))})}),a}function m4(e,n){var t=Tp(),r=qr(n.data),a=Ep(r[1],Fs);if(a.forEach(function(o){e[o].forEach(function(l){var c=Fr(l.meta[1][0].data);if(c==2){var f=x4(e,l);f.sheets.forEach(function(h,p){Dp(t,h,p==0?f.name:f.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function of(e){var n,t,r,a,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=i4(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var p;try{p=s4(h)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){o[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Fr(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(f){o[f].forEach(function(h){var p=Fr(h.meta[1][0].data)>>>0;if(p==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return m4(o,c)}function g4(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Np(e){g4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function v4(e){return ei.WS.indexOf(e)>-1?"sheet":e==ei.CS?"chart":e==ei.DS?"dialog":e==ei.MS?"macro":e&&e.length?e:"sheet"}function y4(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,v4(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function w4(e,n,t,r,a,o,l,c,f,h,p,m){try{o[r]=pl(Nn(e,t,!0),n);var g=Sr(e,n),v;switch(c){case"sheet":v=ND(g,n,a,f,o[r],h,p,m);break;case"chart":if(v=CD(g,n,a,f,o[r],h,p,m),!v||!v["!drawel"])break;var w=ol(v["!drawel"].Target,n),b=Tf(w),k=EN(Nn(e,w,!0),pl(Nn(e,b,!0),w)),T=ol(k,w),j=Tf(T);v=cD(Nn(e,T,!0),T,f,pl(Nn(e,j,!0),T),h,v);break;case"macro":v=TD(g,n,a,f,o[r],h,p,m);break;case"dialog":v=DD(g,n,a,f,o[r],h,p,m);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=v;var C=[];o&&o[r]&&Ca(o[r]).forEach(function(W){var J="";if(o[r][W].Type==ei.CMNT){J=ol(o[r][W].Target,n);var V=AD(Sr(e,J,!0),J,f);if(!V||!V.length)return;Eg(v,V,!1)}o[r][W].Type==ei.TCMNT&&(J=ol(o[r][W].Target,n),C=C.concat(CN(Sr(e,J,!0),f)))}),C&&C.length&&Eg(v,C,!0,f.people||[])}catch(W){if(f.WTF)throw W}}function Mn(e){return e.charAt(0)=="/"?e.slice(1):e}function k4(e,n){if(ay(),n=n||{},Np(n),Bn(e,"META-INF/manifest.xml")||Bn(e,"objectdata.xml"))return Mg(e,n);if(Bn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof of<"u"){if(e.FileIndex)return of(e);var t=At.utils.cfb_new();return Zm(e).forEach(function(de){b2(t,de,k2(e,de))}),of(t)}throw new Error("Unsupported NUMBERS file")}if(!Bn(e,"[Content_Types].xml"))throw Bn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Bn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Zm(e),a=g_(Nn(e,"[Content_Types].xml")),o=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Sr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Sr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},h={};if(!n.bookSheets&&!n.bookProps){if(ml=[],a.sst)try{ml=PD(Sr(e,Mn(a.sst)),a.sst,n)}catch(de){if(n.WTF)throw de}n.cellStyles&&a.themes.length&&(f=jD(Nn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],n)),a.style&&(h=FD(Sr(e,Mn(a.style)),a.style,f,n))}a.links.map(function(de){try{var oe=pl(Nn(e,Tf(Mn(de))),de);return RD(Sr(e,Mn(de)),oe,de,n)}catch{}});var p=ED(Sr(e,Mn(a.workbooks[0])),a.workbooks[0],n),m={},g="";a.coreprops.length&&(g=Sr(e,Mn(a.coreprops[0]),!0),g&&(m=Ay(g)),a.extprops.length!==0&&(g=Sr(e,Mn(a.extprops[0]),!0),g&&b_(g,m,n)));var v={};(!n.bookSheets||n.bookProps)&&a.custprops.length!==0&&(g=Nn(e,Mn(a.custprops[0]),!0),g&&(v=S_(g,n)));var w={};if((n.bookSheets||n.bookProps)&&(p.Sheets?l=p.Sheets.map(function(oe){return oe.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),n.bookProps&&(w.Props=m,w.Custprops=v),n.bookSheets&&typeof l<"u"&&(w.SheetNames=l),n.bookSheets?w.SheetNames:n.bookProps))return w;l={};var b={};n.bookDeps&&a.calcchain&&(b=OD(Sr(e,Mn(a.calcchain)),a.calcchain));var k=0,T={},j,C;{var W=p.Sheets;m.Worksheets=W.length,m.SheetNames=[];for(var J=0;J!=W.length;++J)m.SheetNames[J]=W[J].name}var V=o?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),U=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Bn(e,U)||(U="xl/_rels/workbook."+V+".rels");var B=pl(Nn(e,U,!0),U.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(n.xlmeta=zD(Sr(e,Mn(a.metadata[0])),a.metadata[0],n)),(a.people||[]).length>=1&&(n.people=TN(Sr(e,Mn(a.people[0])),n)),B&&(B=y4(B,p.Sheets));var ne=Sr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(k=0;k!=m.Worksheets;++k){var ee="sheet";if(B&&B[k]?(j="xl/"+B[k][1].replace(/[\/]?xl\//,""),Bn(e,j)||(j=B[k][1]),Bn(e,j)||(j=U.replace(/_rels\/.*$/,"")+B[k][1]),ee=B[k][2]):(j="xl/worksheets/sheet"+(k+1-ne)+"."+V,j=j.replace(/sheet0\./,"sheet.")),C=j.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(k!=n.sheets)continue e;break;case"string":if(m.SheetNames[k].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var Y=!1,fe=0;fe!=n.sheets.length;++fe)typeof n.sheets[fe]=="number"&&n.sheets[fe]==k&&(Y=1),typeof n.sheets[fe]=="string"&&n.sheets[fe].toLowerCase()==m.SheetNames[k].toLowerCase()&&(Y=1);if(!Y)continue e}}w4(e,j,C,m.SheetNames[k],k,T,l,ee,n,p,f,h)}return w={Directory:a,Workbook:p,Props:m,Custprops:v,Deps:b,Sheets:l,SheetNames:m.SheetNames,Strings:ml,Styles:h,Themes:f,SSF:Ur(Et)},n&&n.bookFiles&&(e.files?(w.keys=r,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(de,oe){de=de.replace(/^Root Entry[\/]/,""),w.keys.push(de),w.files[de]=e.FileIndex[oe]}))),n&&n.bookVBA&&(a.vba.length>0?w.vbaraw=Sr(e,Mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===PN&&(w.vbaraw=Sr(e,"xl/vbaProject.bin",!0))),w}function b4(e,n){var t=n||{},r="Workbook",a=At.find(e,r);try{if(r="/!DataSpaces/Version",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(hE(a.content),r="/!DataSpaces/DataSpaceMap",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=mE(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=gE(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);yE(a.content)}catch{}if(r="/EncryptionInfo",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=wE(a.content);if(r="/EncryptedPackage",a=At.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Cp(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Tn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function _4(e,n){return At.find(e,"EncryptedPackage")?b4(e,n):g1(e,n)}function S4(e,n){var t,r=e,a=n||{};return a.type||(a.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),t=uy(r,a),k4(t,a)}function k1(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return jf(e.slice(t),n);default:break e}return Sl.to_workbook(e,n)}function E4(e,n){var t="",r=Cp(e,n);switch(n.type){case"base64":t=Tn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=fo(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=tr(t)),n.type="binary",k1(t,n)}function N4(e,n){var t=e;return n.type=="base64"&&(t=Tn(t)),t=wl.utils.decode(1200,t.slice(2),"str"),n.type="binary",k1(t,n)}function C4(e){return e.match(/[^\x00-\x7F]/)?il(e):e}function lf(e,n,t,r){return r?(t.type="string",Sl.to_workbook(e,t)):Sl.to_workbook(n,t)}function Rf(e,n){Vv();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rf(new Uint8Array(e),(t=Ur(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ai={},t.dateNF&&(ai.dateNF=t.dateNF),t.type||(t.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Pt?"buffer":"binary",r=h2(e),typeof Uint8Array<"u"&&!Pt&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=C4(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return t=Ur(t),t.type="array",Rf(sp(r),t)}switch((a=Cp(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return _4(At.read(r,t),t);break;case 9:if(a[1]<=8)return g1(r,t);break;case 60:return jf(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return tE(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return JS.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?S4(r,t):lf(e,r,t,o);case 239:return a[3]===60?jf(r,t):lf(e,r,t,o);case 255:if(a[1]===254)return N4(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return xl.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return xl.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return Sg.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return PE.to_workbook(r,t);break;case 10:case 13:case 32:return E4(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return qS.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Sg.to_workbook(r,t):lf(e,r,t,o)}function T4(e,n,t,r,a,o,l,c){var f=$r(t),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!l||e[t])for(var v=n.s.c;v<=n.e.c;++v){var w=l?e[t][v]:e[r[v]+f];if(w===void 0||w.t===void 0){if(h===void 0)continue;o[v]!=null&&(g[o[v]]=h);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[v]!=null){if(b==null)if(w.t=="e"&&b===null)g[o[v]]=null;else if(h!==void 0)g[o[v]]=h;else if(p&&b===null)g[o[v]]=null;else continue;else g[o[v]]=p&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?b:Ja(w,b,c);b!=null&&(m=!1)}}return{row:g,isempty:m}}function zf(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,o=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof p){case"string":f=hr(p);break;case"number":f=hr(e["!ref"]),f.s.r=p;break;default:f=p}r>0&&(a=0);var m=$r(f.s.r),g=[],v=[],w=0,b=0,k=Array.isArray(e),T=f.s.r,j=0,C={};k&&!e[T]&&(e[T]=[]);var W=h.skipHidden&&e["!cols"]||[],J=h.skipHidden&&e["!rows"]||[];for(j=f.s.c;j<=f.e.c;++j)if(!(W[j]||{}).hidden)switch(g[j]=Dr(j),t=k?e[T][j]:e[g[j]+m],r){case 1:o[j]=j-f.s.c;break;case 2:o[j]=g[j];break;case 3:o[j]=h.header[j-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=l=Ja(t,null,h),b=C[l]||0,!b)C[l]=1;else{do c=l+"_"+b++;while(C[c]);C[l]=b,C[c]=1}o[j]=c}for(T=f.s.r+a;T<=f.e.r;++T)if(!(J[T]||{}).hidden){var V=T4(e,f,T,g,r,o,k,h);(V.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(v[w++]=V.row)}return v.length=w,v}var Wg=/"/g;function D4(e,n,t,r,a,o,l,c){for(var f=!0,h=[],p="",m=$r(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var v=c.dense?(e[t]||[])[g]:e[r[g]+m];if(v==null)p="";else if(v.v!=null){f=!1,p=""+(c.rawNumbers&&v.t=="n"?v.v:Ja(v,null,c));for(var w=0,b=0;w!==p.length;++w)if((b=p.charCodeAt(w))===a||b===o||b===34||c.forceQuotes){p='"'+p.replace(Wg,'""')+'"';break}p=="ID"&&(p='"ID"')}else v.f!=null&&!v.F?(f=!1,p="="+v.f,p.indexOf(",")>=0&&(p='"'+p.replace(Wg,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&f?null:h.join(l)}function b1(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var a=hr(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),p="",m=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],v=r.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(g[w]||{}).hidden||(m[w]=Dr(w));for(var b=0,k=a.s.r;k<=a.e.r;++k)(v[k]||{}).hidden||(p=D4(e,a,k,m,l,f,o,r),p!=null&&(r.strip&&(p=p.replace(h,"")),(p||r.blankrows!==!1)&&t.push((b++?c:"")+p)));return delete r.dense,t.join("")}function F4(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=b1(e,n);return t}function j4(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var a=hr(e["!ref"]),o="",l=[],c,f=[],h=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=Dr(c);for(var p=a.s.r;p<=a.e.r;++p)for(o=$r(p),c=a.s.c;c<=a.e.c;++c)if(n=l[c]+o,t=h?(e[p]||[])[c]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}f[f.length]=n+"="+r}return f}function _1(e,n,t){var r=t||{},a=+!r.skipHeader,o=e||{},l=0,c=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?ln(r.origin):r.origin;l=f.r,c=f.c}var h,p={s:{c:0,r:0},e:{c,r:l+n.length-1+a}};if(o["!ref"]){var m=hr(o["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),l==-1&&(l=m.e.r+1,p.e.r=l+n.length-1+a)}else l==-1&&(l=0,p.e.r=n.length-1+a);var g=r.header||[],v=0;n.forEach(function(b,k){Ca(b).forEach(function(T){(v=g.indexOf(T))==-1&&(g[v=g.length]=T);var j=b[T],C="z",W="",J=St({c:c+v,r:l+k+a});h=Tl(o,J),j&&typeof j=="object"&&!(j instanceof Date)?o[J]=j:(typeof j=="number"?C="n":typeof j=="boolean"?C="b":typeof j=="string"?C="s":j instanceof Date?(C="d",r.cellDates||(C="n",j=fn(j)),W=r.dateNF||Et[14]):j===null&&r.nullError&&(C="e",j=0),h?(h.t=C,h.v=j,delete h.w,delete h.R,W&&(h.z=W)):o[J]=h={t:C,v:j},W&&(h.z=W))})}),p.e.c=Math.max(p.e.c,c+g.length-1);var w=$r(l);if(a)for(v=0;v<g.length;++v)o[Dr(v+c)+w]={t:"s",v:g[v]};return o["!ref"]=Ot(p),o}function P4(e,n){return _1(null,e,n)}function Tl(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=ln(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Tl(e,St(n)):Tl(e,St({r:n,c:t||0}))}function A4(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Tp(){return{SheetNames:[],Sheets:{}}}function Dp(e,n,t,r){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=l+a)!=-1;++a);}if(gD(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function O4(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=A4(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function R4(e,n){return e.z=n,e}function S1(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function z4(e,n,t){return S1(e,"#"+n,t)}function M4(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function I4(e,n,t,r){for(var a=typeof n!="string"?n:hr(n),o=typeof n=="string"?n:Ot(n),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=Tl(e,l,c);f.t="n",f.F=o,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=t,r&&(f.D=!0))}return e}var L4={encode_col:Dr,encode_row:$r,encode_cell:St,encode_range:Ot,decode_col:hp,decode_row:pp,split_cell:X2,decode_cell:ln,decode_range:gi,format_cell:Ja,sheet_add_aoa:Ty,sheet_add_json:_1,sheet_add_dom:v1,aoa_to_sheet:vi,json_to_sheet:P4,table_to_sheet:y1,table_to_book:t4,sheet_to_csv:b1,sheet_to_txt:F4,sheet_to_json:zf,sheet_to_html:e4,sheet_to_formulae:j4,sheet_to_row_object_array:zf,sheet_get_cell:Tl,book_new:Tp,book_append_sheet:Dp,book_set_sheet_visibility:O4,cell_set_number_format:R4,cell_set_hyperlink:S1,cell_set_internal_link:z4,cell_add_comment:M4,sheet_set_array_formula:I4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const B4=({isOpen:e,onClose:n,onUpload:t})=>{const[r,a]=N.useState(null),o=N.useRef(null),l=h=>{const p=h.target.files?.[0];p&&a(p)},c=()=>{if(r){const h=new FileReader;h.onload=p=>{try{const m=new Uint8Array(p.target?.result),g=Rf(m,{type:"array"});console.log("Workbook sheets:",g.SheetNames);const v=g.Sheets[g.SheetNames[0]];console.log("First sheet data:",v);const w=L4.sheet_to_json(v,{header:1});console.log("Parsed JSON data:",w);const b={headers:w[0],rows:w.slice(1)};console.log("Prepared file data:",b),t(r.name,b),f()}catch(m){console.error("Error reading Excel file:",m)}},h.readAsArrayBuffer(r)}},f=()=>{a(null),o.current&&(o.current.value=""),n()};return u.jsx(ar,{isOpen:e,onRequestClose:f,style:{content:{width:"500px",height:"180px",maxWidth:"500px",position:"absolute",top:"50%",left:"50%",transform:"translate(calc(-50% + 0px), calc(-50% + 0px))",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",cursor:"grab",userSelect:"none",border:"1px solid #e5e7eb",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full w-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3 select-none overflow-hidden",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800 truncate",children:"Zaaduj plik Excel"}),u.jsx("button",{onClick:f,className:"text-red-500 focus:outline-none flex-shrink-0 ml-2",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-2 overflow-hidden",children:u.jsx("div",{children:u.jsxs("div",{className:"relative mt-8",children:[u.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls",onChange:l,className:"hidden"}),u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("button",{onClick:()=>o.current?.click(),type:"button",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-sm cursor-pointer flex-shrink-0",children:"Wybierz plik"}),r&&u.jsx("span",{className:"text-sm text-gray-600 font-sora truncate",children:r.name})]})]})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-4 overflow-hidden",children:[u.jsx("button",{onClick:f,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none text-sm cursor-pointer",children:"Anuluj"}),u.jsx("button",{onClick:c,disabled:!r,"aria-label":r?"Zaaduj plik":"Nie wybrano pliku",className:`px-3 py-1.5 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm cursor-pointer ${r?"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Zaaduj"})]})]})})},W4=({isOpen:e,onClose:n,onConfirm:t,fileName:r})=>u.jsx(ar,{isOpen:e,onRequestClose:n,style:{content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"280px",height:"120px",margin:"0",padding:"16px",borderRadius:"4px",background:"white",outline:"none",zIndex:9999},overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999}},children:u.jsxs("div",{className:"h-full flex items-center justify-between",children:[u.jsxs("p",{className:"text-xs text-gray-600 mr-3 truncate max-w-[150px]",children:['Zastpi "',r,'"?']}),u.jsxs("div",{className:"flex space-x-2 shrink-0",children:[u.jsx("button",{onClick:n,className:"px-2 py-1 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200",children:"Anuluj"}),u.jsx("button",{onClick:t,className:"px-2 py-1 text-xs text-white bg-blue-500 rounded hover:bg-blue-600",children:"Zastp"})]})]})});function E1(e){var n,t,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(t=E1(e[n]))&&(r&&(r+=" "),r+=t)}else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Wr(){for(var e,n,t=0,r="",a=arguments.length;t<a;t++)(e=arguments[t])&&(n=E1(e))&&(r&&(r+=" "),r+=n);return r}const N1=6048e5,U4=864e5,ed=6e4,td=36e5,$4=1e3,Ug=Symbol.for("constructDateFrom");function Zt(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&Ug in e?e[Ug](n):e instanceof Date?new e.constructor(n):new Date(n)}function dt(e,n){return Zt(n||e,e)}function la(e,n,t){const r=dt(e,t?.in);return isNaN(n)?Zt(t?.in||e,NaN):(n&&r.setDate(r.getDate()+n),r)}function ca(e,n,t){const r=dt(e,t?.in);if(isNaN(n))return Zt(e,NaN);if(!n)return r;const a=r.getDate(),o=Zt(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}function C1(e,n,t){return Zt(e,+dt(e)+n)}function H4(e,n,t){return C1(e,n*td)}let Y4={};function So(){return Y4}function ua(e,n){const t=So(),r=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=dt(e,n?.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function ui(e,n){return ua(e,{...n,weekStartsOn:1})}function T1(e,n){const t=dt(e,n?.in),r=t.getFullYear(),a=Zt(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=ui(a),l=Zt(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=ui(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function Ru(e){const n=dt(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function ja(e,...n){const t=Zt.bind(null,e||n.find(r=>typeof r=="object"));return n.map(t)}function ho(e,n){const t=dt(e,n?.in);return t.setHours(0,0,0,0),t}function di(e,n,t){const[r,a]=ja(t?.in,e,n),o=ho(r),l=ho(a),c=+o-Ru(o),f=+l-Ru(l);return Math.round((c-f)/U4)}function V4(e,n){const t=T1(e,n),r=Zt(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),ui(r)}function Mf(e,n,t){const r=dt(e,t?.in);return r.setTime(r.getTime()+n*ed),r}function Fp(e,n,t){return ca(e,n*3,t)}function K4(e,n,t){return C1(e,n*1e3)}function zu(e,n,t){return la(e,n*7,t)}function Ga(e,n,t){return ca(e,n*12,t)}function $g(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Zt.bind(null,a));const o=dt(a,r);(!t||t<o||isNaN(+o))&&(t=o)}),Zt(r,t||NaN)}function Hg(e,n){let t,r=n?.in;return e.forEach(a=>{!r&&typeof a=="object"&&(r=Zt.bind(null,a));const o=dt(a,r);(!t||t>o||isNaN(+o))&&(t=o)}),Zt(r,t||NaN)}function G4(e,n,t){const[r,a]=ja(t?.in,e,n);return+ho(r)==+ho(a)}function Qa(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Mu(e){return!(!Qa(e)&&typeof e!="number"||isNaN(+dt(e)))}function Iu(e,n,t){const[r,a]=ja(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=r.getMonth()-a.getMonth();return o*12+l}function oo(e,n){const t=dt(e,n?.in);return Math.trunc(t.getMonth()/3)+1}function Lu(e,n,t){const[r,a]=ja(t?.in,e,n),o=r.getFullYear()-a.getFullYear(),l=oo(r)-oo(a);return o*4+l}function Bu(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()-a.getFullYear()}function Q4(e,n,t){const[r,a]=ja(t?.in,e,n),o=Yg(r,a),l=Math.abs(di(r,a));r.setDate(r.getDate()-o*l);const c=+(Yg(r,a)===-o),f=o*(l-c);return f===0?0:f}function Yg(e,n){const t=e.getFullYear()-n.getFullYear()||e.getMonth()-n.getMonth()||e.getDate()-n.getDate()||e.getHours()-n.getHours()||e.getMinutes()-n.getMinutes()||e.getSeconds()-n.getSeconds()||e.getMilliseconds()-n.getMilliseconds();return t<0?-1:t>0?1:t}function D1(e,n){const t=dt(e,n?.in);return t.setHours(23,59,59,999),t}function F1(e,n){const t=dt(e,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function If(e,n){const t=dt(e,n?.in),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function j1(e,n){const t=dt(e,n?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function P1(e,n){const t=dt(e,n?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function rd(e,n){const t=dt(e,n?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function X4(e,n){const t=So(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=dt(e,n?.in),o=a.getDay(),l=(o<r?-7:0)+6-(o-r);return a.setDate(a.getDate()+l),a.setHours(23,59,59,999),a}const q4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Z4=(e,n,t)=>{let r;const a=q4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function si(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const J4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},e3={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},t3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},r3={date:si({formats:J4,defaultWidth:"full"}),time:si({formats:e3,defaultWidth:"full"}),dateTime:si({formats:t3,defaultWidth:"full"})},n3={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},a3=(e,n,t,r)=>n3[e];function ka(e){return(n,t)=>{const r=t?.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=t?.width?String(t.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=t?.width?String(t.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const s3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},o3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},i3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},l3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},c3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},u3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},d3=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},f3={ordinalNumber:d3,era:ka({values:s3,defaultWidth:"wide"}),quarter:ka({values:o3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ka({values:i3,defaultWidth:"wide"}),day:ka({values:l3,defaultWidth:"wide"}),dayPeriod:ka({values:c3,defaultWidth:"wide",formattingValues:u3,defaultFormattingWidth:"wide"})};function ba(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(c)?h3(c,m=>m.test(l)):p3(c,m=>m.test(l));let h;h=e.valueCallback?e.valueCallback(f):f,h=t.valueCallback?t.valueCallback(h):h;const p=n.slice(l.length);return{value:h,rest:p}}}function p3(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function h3(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function A1(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const c=n.slice(a.length);return{value:l,rest:c}}}const x3=/^(\d+)(th|st|nd|rd)?/i,m3=/\d+/i,g3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},v3={any:[/^b/i,/^(a|c)/i]},y3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},w3={any:[/1/i,/2/i,/3/i,/4/i]},k3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},b3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},S3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},E3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},N3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},C3={ordinalNumber:A1({matchPattern:x3,parsePattern:m3,valueCallback:e=>parseInt(e,10)}),era:ba({matchPatterns:g3,defaultMatchWidth:"wide",parsePatterns:v3,defaultParseWidth:"any"}),quarter:ba({matchPatterns:y3,defaultMatchWidth:"wide",parsePatterns:w3,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ba({matchPatterns:k3,defaultMatchWidth:"wide",parsePatterns:b3,defaultParseWidth:"any"}),day:ba({matchPatterns:_3,defaultMatchWidth:"wide",parsePatterns:S3,defaultParseWidth:"any"}),dayPeriod:ba({matchPatterns:E3,defaultMatchWidth:"any",parsePatterns:N3,defaultParseWidth:"any"})},O1={code:"en-US",formatDistance:Z4,formatLong:r3,formatRelative:a3,localize:f3,match:C3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function T3(e,n){const t=dt(e,n?.in);return di(t,rd(t))+1}function jp(e,n){const t=dt(e,n?.in),r=+ui(t)-+V4(t);return Math.round(r/N1)+1}function Pp(e,n){const t=dt(e,n?.in),r=t.getFullYear(),a=So(),o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Zt(n?.in||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=ua(l,n),f=Zt(n?.in||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const h=ua(f,n);return+t>=+c?r+1:+t>=+h?r:r-1}function D3(e,n){const t=So(),r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=Pp(e,n),o=Zt(n?.in||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),ua(o,n)}function R1(e,n){const t=dt(e,n?.in),r=+ua(t,n)-+D3(t,n);return Math.round(r/N1)+1}function qt(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const Ss={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return qt(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):qt(t+1,2)},d(e,n){return qt(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return qt(e.getHours()%12||12,n.length)},H(e,n){return qt(e.getHours(),n.length)},m(e,n){return qt(e.getMinutes(),n.length)},s(e,n){return qt(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return qt(a,n.length)}},Xo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Vg={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return Ss.y(e,n)},Y:function(e,n,t,r){const a=Pp(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return qt(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):qt(o,n.length)},R:function(e,n){const t=T1(e);return qt(t,n.length)},u:function(e,n){const t=e.getFullYear();return qt(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return qt(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return qt(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return Ss.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return qt(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=R1(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):qt(a,n.length)},I:function(e,n,t){const r=jp(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):qt(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Ss.d(e,n)},D:function(e,n,t){const r=T3(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):qt(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return qt(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return qt(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return qt(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=Xo.noon:r===0?a=Xo.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=Xo.evening:r>=12?a=Xo.afternoon:r>=4?a=Xo.morning:a=Xo.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Ss.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Ss.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):qt(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):qt(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ss.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Ss.s(e,n)},S:function(e,n){return Ss.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return Gg(r);case"XXXX":case"XX":return Js(r);case"XXXXX":case"XXX":default:return Js(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return Gg(r);case"xxxx":case"xx":return Js(r);case"xxxxx":case"xxx":default:return Js(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Kg(r,":");case"OOOO":default:return"GMT"+Js(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Kg(r,":");case"zzzz":default:return"GMT"+Js(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return qt(r,n.length)},T:function(e,n,t){return qt(+e,n.length)}};function Kg(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+qt(o,2)}function Gg(e,n){return e%60===0?(e>0?"-":"+")+qt(Math.abs(e)/60,2):Js(e,n)}function Js(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=qt(Math.trunc(r/60),2),o=qt(r%60,2);return t+a+n+o}const Qg=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},z1=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},F3=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return Qg(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Qg(r,n)).replace("{{time}}",z1(a,n))},Lf={p:z1,P:F3},j3=/^D+$/,P3=/^Y+$/,A3=["D","DD","YY","YYYY"];function O3(e){return j3.test(e)}function R3(e){return P3.test(e)}function z3(e,n,t){const r=M3(e,n,t);if(console.warn(r),A3.includes(e))throw new RangeError(r)}function M3(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const I3=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,L3=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,B3=/^'([^]*?)'?$/,W3=/''/g,U3=/[a-zA-Z]/;function Xg(e,n,t){const r=So(),a=t?.locale??r.locale??O1,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,c=dt(e,t?.in);if(!Mu(c))throw new RangeError("Invalid time value");let f=n.match(L3).map(p=>{const m=p[0];if(m==="p"||m==="P"){const g=Lf[m];return g(p,a.formatLong)}return p}).join("").match(I3).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const m=p[0];if(m==="'")return{isToken:!1,value:$3(p)};if(Vg[m])return{isToken:!0,value:p};if(m.match(U3))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});a.localize.preprocessor&&(f=a.localize.preprocessor(c,f));const h={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(p=>{if(!p.isToken)return p.value;const m=p.value;(!t?.useAdditionalWeekYearTokens&&R3(m)||!t?.useAdditionalDayOfYearTokens&&O3(m))&&z3(m,n,String(e));const g=Vg[m[0]];return g(c,m,a.localize,h)}).join("")}function $3(e){const n=e.match(B3);return n?n[1].replace(W3,"'"):e}function qg(e,n){return dt(e,n?.in).getDate()}function H3(e,n){return dt(e,n?.in).getDay()}function Y3(e,n){const t=dt(e,n?.in),r=t.getFullYear(),a=t.getMonth(),o=Zt(t,0);return o.setFullYear(r,a+1,0),o.setHours(0,0,0,0),o.getDate()}function V3(){return Object.assign({},So())}function Xa(e,n){return dt(e,n?.in).getHours()}function K3(e,n){const t=dt(e,n?.in).getDay();return t===0?7:t}function qa(e,n){return dt(e,n?.in).getMinutes()}function cn(e,n){return dt(e,n?.in).getMonth()}function js(e){return dt(e).getSeconds()}function Bf(e){return+dt(e)}function Tt(e,n){return dt(e,n?.in).getFullYear()}function Rs(e,n){return+dt(e)>+dt(n)}function xo(e,n){return+dt(e)<+dt(n)}function G3(e,n){return+dt(e)==+dt(n)}function Q3(e,n){const t=X3(n)?new n(0):Zt(n,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}function X3(e){return typeof e=="function"&&e.prototype?.constructor===e}const q3=10;class M1{subPriority=0;validate(n,t){return!0}}class Z3 extends M1{constructor(n,t,r,a,o){super(),this.value=n,this.validateValue=t,this.setValue=r,this.priority=a,o&&(this.subPriority=o)}validate(n,t){return this.validateValue(n,this.value,t)}set(n,t,r){return this.setValue(n,t,this.value,r)}}class J3 extends M1{priority=q3;subPriority=-1;constructor(n,t){super(),this.context=n||(r=>Zt(t,r))}set(n,t){return t.timestampIsSet?n:Zt(n,Q3(n,this.context))}}class $t{run(n,t,r,a){const o=this.parse(n,t,r,a);return o?{setter:new Z3(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}validate(n,t,r){return!0}}class eF extends $t{priority=140;parse(n,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})||r.era(n,{width:"abbreviated"})||r.era(n,{width:"narrow"})}}set(n,t,r){return t.era=r,n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["R","u","t","T"]}const wr={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},_a={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function kr(e,n){return e&&{value:n(e.value),rest:e.rest}}function dr(e,n){const t=n.match(e);return t?{value:parseInt(t[0],10),rest:n.slice(t[0].length)}:null}function Sa(e,n){const t=n.match(e);if(!t)return null;if(t[0]==="Z")return{value:0,rest:n.slice(1)};const r=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,o=t[3]?parseInt(t[3],10):0,l=t[5]?parseInt(t[5],10):0;return{value:r*(a*td+o*ed+l*$4),rest:n.slice(t[0].length)}}function I1(e){return dr(wr.anyDigitsSigned,e)}function xr(e,n){switch(e){case 1:return dr(wr.singleDigit,n);case 2:return dr(wr.twoDigits,n);case 3:return dr(wr.threeDigits,n);case 4:return dr(wr.fourDigits,n);default:return dr(new RegExp("^\\d{1,"+e+"}"),n)}}function Wu(e,n){switch(e){case 1:return dr(wr.singleDigitSigned,n);case 2:return dr(wr.twoDigitsSigned,n);case 3:return dr(wr.threeDigitsSigned,n);case 4:return dr(wr.fourDigitsSigned,n);default:return dr(new RegExp("^-?\\d{1,"+e+"}"),n)}}function Ap(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function L1(e,n){const t=n>0,r=t?n:1-n;let a;if(r<=50)a=e||100;else{const o=r+50,l=Math.trunc(o/100)*100,c=e>=o%100;a=e+l-(c?100:0)}return t?a:1-a}function B1(e){return e%400===0||e%4===0&&e%100!==0}class tF extends $t{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="yy"});switch(t){case"y":return kr(xr(4,n),a);case"yo":return kr(r.ordinalNumber(n,{unit:"year"}),a);default:return kr(xr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r){const a=n.getFullYear();if(r.isTwoDigitYear){const l=L1(r.year,a);return n.setFullYear(l,0,1),n.setHours(0,0,0,0),n}const o=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class rF extends $t{priority=130;parse(n,t,r){const a=o=>({year:o,isTwoDigitYear:t==="YY"});switch(t){case"Y":return kr(xr(4,n),a);case"Yo":return kr(r.ordinalNumber(n,{unit:"year"}),a);default:return kr(xr(t.length,n),a)}}validate(n,t){return t.isTwoDigitYear||t.year>0}set(n,t,r,a){const o=Pp(n,a);if(r.isTwoDigitYear){const c=L1(r.year,o);return n.setFullYear(c,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),ua(n,a)}const l=!("era"in t)||t.era===1?r.year:1-r.year;return n.setFullYear(l,0,a.firstWeekContainsDate),n.setHours(0,0,0,0),ua(n,a)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class nF extends $t{priority=130;parse(n,t){return Wu(t==="R"?4:t.length,n)}set(n,t,r){const a=Zt(n,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),ui(a)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class aF extends $t{priority=130;parse(n,t){return Wu(t==="u"?4:t.length,n)}set(n,t,r){return n.setFullYear(r,0,1),n.setHours(0,0,0,0),n}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class sF extends $t{priority=120;parse(n,t,r){switch(t){case"Q":case"QQ":return xr(t.length,n);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})||r.quarter(n,{width:"abbreviated",context:"formatting"})||r.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class oF extends $t{priority=120;parse(n,t,r){switch(t){case"q":case"qq":return xr(t.length,n);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})||r.quarter(n,{width:"abbreviated",context:"standalone"})||r.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=1&&t<=4}set(n,t,r){return n.setMonth((r-1)*3,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class iF extends $t{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"M":return kr(dr(wr.month,n),a);case"MM":return kr(xr(2,n),a);case"Mo":return kr(r.ordinalNumber(n,{unit:"month"}),a);case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})||r.month(n,{width:"abbreviated",context:"formatting"})||r.month(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}}class lF extends $t{priority=110;parse(n,t,r){const a=o=>o-1;switch(t){case"L":return kr(dr(wr.month,n),a);case"LL":return kr(xr(2,n),a);case"Lo":return kr(r.ordinalNumber(n,{unit:"month"}),a);case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})||r.month(n,{width:"abbreviated",context:"standalone"})||r.month(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.setMonth(r,1),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function cF(e,n,t){const r=dt(e,t?.in),a=R1(r,t)-n;return r.setDate(r.getDate()-a*7),dt(r,t?.in)}class uF extends $t{priority=100;parse(n,t,r){switch(t){case"w":return dr(wr.week,n);case"wo":return r.ordinalNumber(n,{unit:"week"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r,a){return ua(cF(n,r,a),a)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function dF(e,n,t){const r=dt(e,t?.in),a=jp(r,t)-n;return r.setDate(r.getDate()-a*7),r}class fF extends $t{priority=100;parse(n,t,r){switch(t){case"I":return dr(wr.week,n);case"Io":return r.ordinalNumber(n,{unit:"week"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=53}set(n,t,r){return ui(dF(n,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const pF=[31,28,31,30,31,30,31,31,30,31,30,31],hF=[31,29,31,30,31,30,31,31,30,31,30,31];class xF extends $t{priority=90;subPriority=1;parse(n,t,r){switch(t){case"d":return dr(wr.date,n);case"do":return r.ordinalNumber(n,{unit:"date"});default:return xr(t.length,n)}}validate(n,t){const r=n.getFullYear(),a=B1(r),o=n.getMonth();return a?t>=1&&t<=hF[o]:t>=1&&t<=pF[o]}set(n,t,r){return n.setDate(r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class mF extends $t{priority=90;subpriority=1;parse(n,t,r){switch(t){case"D":case"DD":return dr(wr.dayOfYear,n);case"Do":return r.ordinalNumber(n,{unit:"date"});default:return xr(t.length,n)}}validate(n,t){const r=n.getFullYear();return B1(r)?t>=1&&t<=366:t>=1&&t<=365}set(n,t,r){return n.setMonth(0,r),n.setHours(0,0,0,0),n}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function Op(e,n,t){const r=So(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=dt(e,t?.in),l=o.getDay(),f=(n%7+7)%7,h=7-a,p=n<0||n>6?n-(l+h)%7:(f+h)%7-(l+h)%7;return la(o,p,t)}class gF extends $t{priority=90;parse(n,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["D","i","e","c","t","T"]}class vF extends $t{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"e":case"ee":return kr(xr(t.length,n),o);case"eo":return kr(r.ordinalNumber(n,{unit:"day"}),o);case"eee":return r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class yF extends $t{priority=90;parse(n,t,r,a){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+a.weekStartsOn+6)%7+c};switch(t){case"c":case"cc":return kr(xr(t.length,n),o);case"co":return kr(r.ordinalNumber(n,{unit:"day"}),o);case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})||r.day(n,{width:"abbreviated",context:"standalone"})||r.day(n,{width:"short",context:"standalone"})||r.day(n,{width:"narrow",context:"standalone"})}}validate(n,t){return t>=0&&t<=6}set(n,t,r,a){return n=Op(n,r,a),n.setHours(0,0,0,0),n}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function wF(e,n,t){const r=dt(e,t?.in),a=K3(r,t),o=n-a;return la(r,o,t)}class kF extends $t{priority=90;parse(n,t,r){const a=o=>o===0?7:o;switch(t){case"i":case"ii":return xr(t.length,n);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return kr(r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiii":return kr(r.day(n,{width:"narrow",context:"formatting"}),a);case"iiiiii":return kr(r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a);case"iiii":default:return kr(r.day(n,{width:"wide",context:"formatting"})||r.day(n,{width:"abbreviated",context:"formatting"})||r.day(n,{width:"short",context:"formatting"})||r.day(n,{width:"narrow",context:"formatting"}),a)}}validate(n,t){return t>=1&&t<=7}set(n,t,r){return n=wF(n,r),n.setHours(0,0,0,0),n}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class bF extends $t{priority=80;parse(n,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["b","B","H","k","t","T"]}class _F extends $t{priority=80;parse(n,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","B","H","k","t","T"]}class SF extends $t{priority=80;parse(n,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})||r.dayPeriod(n,{width:"abbreviated",context:"formatting"})||r.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,t,r){return n.setHours(Ap(r),0,0,0),n}incompatibleTokens=["a","b","t","T"]}class EF extends $t{priority=70;parse(n,t,r){switch(t){case"h":return dr(wr.hour12h,n);case"ho":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=12}set(n,t,r){const a=n.getHours()>=12;return a&&r<12?n.setHours(r+12,0,0,0):!a&&r===12?n.setHours(0,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["H","K","k","t","T"]}class NF extends $t{priority=70;parse(n,t,r){switch(t){case"H":return dr(wr.hour23h,n);case"Ho":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=23}set(n,t,r){return n.setHours(r,0,0,0),n}incompatibleTokens=["a","b","h","K","k","t","T"]}class CF extends $t{priority=70;parse(n,t,r){switch(t){case"K":return dr(wr.hour11h,n);case"Ko":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=11}set(n,t,r){return n.getHours()>=12&&r<12?n.setHours(r+12,0,0,0):n.setHours(r,0,0,0),n}incompatibleTokens=["h","H","k","t","T"]}class TF extends $t{priority=70;parse(n,t,r){switch(t){case"k":return dr(wr.hour24h,n);case"ko":return r.ordinalNumber(n,{unit:"hour"});default:return xr(t.length,n)}}validate(n,t){return t>=1&&t<=24}set(n,t,r){const a=r<=24?r%24:r;return n.setHours(a,0,0,0),n}incompatibleTokens=["a","b","h","H","K","t","T"]}class DF extends $t{priority=60;parse(n,t,r){switch(t){case"m":return dr(wr.minute,n);case"mo":return r.ordinalNumber(n,{unit:"minute"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setMinutes(r,0,0),n}incompatibleTokens=["t","T"]}class FF extends $t{priority=50;parse(n,t,r){switch(t){case"s":return dr(wr.second,n);case"so":return r.ordinalNumber(n,{unit:"second"});default:return xr(t.length,n)}}validate(n,t){return t>=0&&t<=59}set(n,t,r){return n.setSeconds(r,0),n}incompatibleTokens=["t","T"]}class jF extends $t{priority=30;parse(n,t){const r=a=>Math.trunc(a*Math.pow(10,-t.length+3));return kr(xr(t.length,n),r)}set(n,t,r){return n.setMilliseconds(r),n}incompatibleTokens=["t","T"]}class PF extends $t{priority=10;parse(n,t){switch(t){case"X":return Sa(_a.basicOptionalMinutes,n);case"XX":return Sa(_a.basic,n);case"XXXX":return Sa(_a.basicOptionalSeconds,n);case"XXXXX":return Sa(_a.extendedOptionalSeconds,n);case"XXX":default:return Sa(_a.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Zt(n,n.getTime()-Ru(n)-r)}incompatibleTokens=["t","T","x"]}class AF extends $t{priority=10;parse(n,t){switch(t){case"x":return Sa(_a.basicOptionalMinutes,n);case"xx":return Sa(_a.basic,n);case"xxxx":return Sa(_a.basicOptionalSeconds,n);case"xxxxx":return Sa(_a.extendedOptionalSeconds,n);case"xxx":default:return Sa(_a.extended,n)}}set(n,t,r){return t.timestampIsSet?n:Zt(n,n.getTime()-Ru(n)-r)}incompatibleTokens=["t","T","X"]}class OF extends $t{priority=40;parse(n){return I1(n)}set(n,t,r){return[Zt(n,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class RF extends $t{priority=20;parse(n){return I1(n)}set(n,t,r){return[Zt(n,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const zF={G:new eF,y:new tF,Y:new rF,R:new nF,u:new aF,Q:new sF,q:new oF,M:new iF,L:new lF,w:new uF,I:new fF,d:new xF,D:new mF,E:new gF,e:new vF,c:new yF,i:new kF,a:new bF,b:new _F,B:new SF,h:new EF,H:new NF,K:new CF,k:new TF,m:new DF,s:new FF,S:new jF,X:new PF,x:new AF,t:new OF,T:new RF},MF=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,IF=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,LF=/^'([^]*?)'?$/,BF=/''/g,WF=/\S/,UF=/[a-zA-Z]/;function $F(e,n,t,r){const a=()=>Zt(r?.in||t,NaN),o=V3(),l=r?.locale??o.locale??O1,c=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0;if(!n)return e?a():dt(t,r?.in);const h={firstWeekContainsDate:c,weekStartsOn:f,locale:l},p=[new J3(r?.in,t)],m=n.match(IF).map(k=>{const T=k[0];if(T in Lf){const j=Lf[T];return j(k,l.formatLong)}return k}).join("").match(MF),g=[];for(let k of m){const T=k[0],j=zF[T];if(j){const{incompatibleTokens:C}=j;if(Array.isArray(C)){const J=g.find(V=>C.includes(V.token)||V.token===T);if(J)throw new RangeError(`The format string mustn't contain \`${J.fullToken}\` and \`${k}\` at the same time`)}else if(j.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${k}\` and any other token at the same time`);g.push({token:T,fullToken:k});const W=j.run(e,k,l.match,h);if(!W)return a();p.push(W.setter),e=W.rest}else{if(T.match(UF))throw new RangeError("Format string contains an unescaped latin alphabet character `"+T+"`");if(k==="''"?k="'":T==="'"&&(k=HF(k)),e.indexOf(k)===0)e=e.slice(k.length);else return a()}}if(e.length>0&&WF.test(e))return a();const v=p.map(k=>k.priority).sort((k,T)=>T-k).filter((k,T,j)=>j.indexOf(k)===T).map(k=>p.filter(T=>T.priority===k).sort((T,j)=>j.subPriority-T.subPriority)).map(k=>k[0]);let w=dt(t,r?.in);if(isNaN(+w))return a();const b={};for(const k of v){if(!k.validate(w,h))return a();const T=k.set(w,b,h);Array.isArray(T)?(w=T[0],Object.assign(b,T[1])):w=T}return w}function HF(e){return e.match(LF)[1].replace(BF,"'")}function YF(e,n,t){const[r,a]=ja(t?.in,e,n);return+ua(r,t)==+ua(a,t)}function VF(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function KF(e,n,t){const[r,a]=ja(t?.in,e,n);return+If(r)==+If(a)}function GF(e,n,t){const[r,a]=ja(t?.in,e,n);return r.getFullYear()===a.getFullYear()}function Dl(e,n,t){const r=+dt(e,t?.in),[a,o]=[+dt(n.start,t?.in),+dt(n.end,t?.in)].sort((l,c)=>l-c);return r>=a&&r<=o}function QF(e,n,t){return la(e,-1,t)}function XF(e,n){const t=()=>Zt(n?.in,NaN),a=ej(e);let o;if(a.date){const h=tj(a.date,2);o=rj(h.restDateString,h.year)}if(!o||isNaN(+o))return t();const l=+o;let c=0,f;if(a.time&&(c=nj(a.time),isNaN(c)))return t();if(a.timezone){if(f=aj(a.timezone),isNaN(f))return t()}else{const h=new Date(l+c),p=dt(0,n?.in);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return dt(l+c+f,n?.in)}const lu={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},qF=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ZF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,JF=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ej(e){const n={},t=e.split(lu.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],lu.timeZoneDelimiter.test(n.date)&&(n.date=e.split(lu.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=lu.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function tj(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function rj(e,n){if(n===null)return new Date(NaN);const t=e.match(qF);if(!t)return new Date(NaN);const r=!!t[4],a=rl(t[1]),o=rl(t[2])-1,l=rl(t[3]),c=rl(t[4]),f=rl(t[5])-1;if(r)return cj(n,c,f)?sj(n,c,f):new Date(NaN);{const h=new Date(0);return!ij(n,o,l)||!lj(n,a)?new Date(NaN):(h.setUTCFullYear(n,o,Math.max(a,l)),h)}}function rl(e){return e?parseInt(e):1}function nj(e){const n=e.match(ZF);if(!n)return NaN;const t=cf(n[1]),r=cf(n[2]),a=cf(n[3]);return uj(t,r,a)?t*td+r*ed+a*1e3:NaN}function cf(e){return e&&parseFloat(e.replace(",","."))||0}function aj(e){if(e==="Z")return 0;const n=e.match(JF);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return dj(r,a)?t*(r*td+a*ed):NaN}function sj(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const oj=[31,null,31,30,31,30,31,31,30,31,30,31];function W1(e){return e%400===0||e%4===0&&e%100!==0}function ij(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(oj[n]||(W1(e)?29:28))}function lj(e,n){return n>=1&&n<=(W1(e)?366:365)}function cj(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function uj(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function dj(e,n){return n>=0&&n<=59}function Un(e,n,t){const r=dt(e,t?.in),a=r.getFullYear(),o=r.getDate(),l=Zt(e,0);l.setFullYear(a,n,15),l.setHours(0,0,0,0);const c=Y3(l);return r.setMonth(n,Math.min(o,c)),r}function gu(e,n,t){const r=dt(e,t?.in);return r.setHours(n),r}function vu(e,n,t){const r=dt(e,t?.in);return r.setMinutes(n),r}function Jo(e,n,t){const r=dt(e,t?.in),a=Math.trunc(r.getMonth()/3)+1,o=n-a;return Un(r,r.getMonth()+o*3)}function yu(e,n,t){const r=dt(e,t?.in);return r.setSeconds(n),r}function ya(e,n,t){const r=dt(e,t?.in);return isNaN(+r)?Zt(e,NaN):(r.setFullYear(n),r)}function io(e,n,t){return ca(e,-n,t)}function U1(e,n,t){return Fp(e,-1,t)}function Zg(e,n,t){return zu(e,-1,t)}function fi(e,n,t){return Ga(e,-n,t)}function nd(){return typeof window<"u"}function yi(e){return $1(e)?(e.nodeName||"").toLowerCase():"#document"}function Cn(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Pa(e){var n;return(n=($1(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function $1(e){return nd()?e instanceof Node||e instanceof Cn(e).Node:!1}function un(e){return nd()?e instanceof Element||e instanceof Cn(e).Element:!1}function Ta(e){return nd()?e instanceof HTMLElement||e instanceof Cn(e).HTMLElement:!1}function Jg(e){return!nd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Cn(e).ShadowRoot}function Ll(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Kn(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!["inline","contents"].includes(a)}function fj(e){return["table","td","th"].includes(yi(e))}function ad(e){return[":popover-open",":modal"].some(n=>{try{return e.matches(n)}catch{return!1}})}function Rp(e){const n=zp(),t=un(e)?Kn(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!n&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!n&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function pj(e){let n=zs(e);for(;Ta(n)&&!pi(n);){if(Rp(n))return n;if(ad(n))return null;n=zs(n)}return null}function zp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function pi(e){return["html","body","#document"].includes(yi(e))}function Kn(e){return Cn(e).getComputedStyle(e)}function sd(e){return un(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function zs(e){if(yi(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Jg(e)&&e.host||Pa(e);return Jg(n)?n.host:n}function H1(e){const n=zs(e);return pi(n)?e.ownerDocument?e.ownerDocument.body:e.body:Ta(n)&&Ll(n)?n:H1(n)}function Fl(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=H1(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Cn(a);if(o){const c=Wf(l);return n.concat(l,l.visualViewport||[],Ll(a)?a:[],c&&t?Fl(c):[])}return n.concat(a,Fl(a,[],t))}function Wf(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const hi=Math.min,lo=Math.max,Uu=Math.round,cu=Math.floor,Na=e=>({x:e,y:e}),hj={left:"right",right:"left",bottom:"top",top:"bottom"},xj={start:"end",end:"start"};function Uf(e,n,t){return lo(e,hi(n,t))}function Bl(e,n){return typeof e=="function"?e(n):e}function mo(e){return e.split("-")[0]}function Wl(e){return e.split("-")[1]}function Y1(e){return e==="x"?"y":"x"}function Mp(e){return e==="y"?"height":"width"}function co(e){return["top","bottom"].includes(mo(e))?"y":"x"}function Ip(e){return Y1(co(e))}function mj(e,n,t){t===void 0&&(t=!1);const r=Wl(e),a=Ip(e),o=Mp(a);let l=a==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(l=$u(l)),[l,$u(l)]}function gj(e){const n=$u(e);return[$f(e),n,$f(n)]}function $f(e){return e.replace(/start|end/g,n=>xj[n])}function vj(e,n,t){const r=["left","right"],a=["right","left"],o=["top","bottom"],l=["bottom","top"];switch(e){case"top":case"bottom":return t?n?a:r:n?r:a;case"left":case"right":return n?o:l;default:return[]}}function yj(e,n,t,r){const a=Wl(e);let o=vj(mo(e),t==="start",r);return a&&(o=o.map(l=>l+"-"+a),n&&(o=o.concat(o.map($f)))),o}function $u(e){return e.replace(/left|right|bottom|top/g,n=>hj[n])}function wj(e){return{top:0,right:0,bottom:0,left:0,...e}}function V1(e){return typeof e!="number"?wj(e):{top:e,right:e,bottom:e,left:e}}function Hu(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}var Yu=typeof document<"u"?N.useLayoutEffect:N.useEffect;const kj={...Mv},bj=kj.useInsertionEffect,_j=bj||(e=>e());function Sj(e){const n=N.useRef(()=>{});return _j(()=>{n.current=e}),N.useCallback(function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n.current==null?void 0:n.current(...r)},[])}var K1=qf();const Ej=Qu(K1);function ev(e,n,t){let{reference:r,floating:a}=e;const o=co(n),l=Ip(n),c=Mp(l),f=mo(n),h=o==="y",p=r.x+r.width/2-a.width/2,m=r.y+r.height/2-a.height/2,g=r[c]/2-a[c]/2;let v;switch(f){case"top":v={x:p,y:r.y-a.height};break;case"bottom":v={x:p,y:r.y+r.height};break;case"right":v={x:r.x+r.width,y:m};break;case"left":v={x:r.x-a.width,y:m};break;default:v={x:r.x,y:r.y}}switch(Wl(n)){case"start":v[l]-=g*(t&&h?-1:1);break;case"end":v[l]+=g*(t&&h?-1:1);break}return v}const Nj=async(e,n,t)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=t,c=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(n));let h=await l.getElementRects({reference:e,floating:n,strategy:a}),{x:p,y:m}=ev(h,r,f),g=r,v={},w=0;for(let b=0;b<c.length;b++){const{name:k,fn:T}=c[b],{x:j,y:C,data:W,reset:J}=await T({x:p,y:m,initialPlacement:r,placement:g,strategy:a,middlewareData:v,rects:h,platform:l,elements:{reference:e,floating:n}});p=j??p,m=C??m,v={...v,[k]:{...v[k],...W}},J&&w<=50&&(w++,typeof J=="object"&&(J.placement&&(g=J.placement),J.rects&&(h=J.rects===!0?await l.getElementRects({reference:e,floating:n,strategy:a}):J.rects),{x:p,y:m}=ev(h,g,f)),b=-1)}return{x:p,y:m,placement:g,strategy:a,middlewareData:v}};async function G1(e,n){var t;n===void 0&&(n={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:f}=e,{boundary:h="clippingAncestors",rootBoundary:p="viewport",elementContext:m="floating",altBoundary:g=!1,padding:v=0}=Bl(n,e),w=V1(v),k=c[g?m==="floating"?"reference":"floating":m],T=Hu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(k)))==null||t?k:k.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:h,rootBoundary:p,strategy:f})),j=m==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),W=await(o.isElement==null?void 0:o.isElement(C))?await(o.getScale==null?void 0:o.getScale(C))||{x:1,y:1}:{x:1,y:1},J=Hu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:j,offsetParent:C,strategy:f}):j);return{top:(T.top-J.top+w.top)/W.y,bottom:(J.bottom-T.bottom+w.bottom)/W.y,left:(T.left-J.left+w.left)/W.x,right:(J.right-T.right+w.right)/W.x}}const Cj=e=>({name:"arrow",options:e,async fn(n){const{x:t,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:f}=n,{element:h,padding:p=0}=Bl(e,n)||{};if(h==null)return{};const m=V1(p),g={x:t,y:r},v=Ip(a),w=Mp(v),b=await l.getDimensions(h),k=v==="y",T=k?"top":"left",j=k?"bottom":"right",C=k?"clientHeight":"clientWidth",W=o.reference[w]+o.reference[v]-g[v]-o.floating[w],J=g[v]-o.reference[v],V=await(l.getOffsetParent==null?void 0:l.getOffsetParent(h));let P=V?V[C]:0;(!P||!await(l.isElement==null?void 0:l.isElement(V)))&&(P=c.floating[C]||o.floating[w]);const U=W/2-J/2,B=P/2-b[w]/2-1,ne=hi(m[T],B),ee=hi(m[j],B),Y=ne,fe=P-b[w]-ee,de=P/2-b[w]/2+U,oe=Uf(Y,de,fe),he=!f.arrow&&Wl(a)!=null&&de!==oe&&o.reference[w]/2-(de<Y?ne:ee)-b[w]/2<0,X=he?de<Y?de-Y:de-fe:0;return{[v]:g[v]+X,data:{[v]:oe,centerOffset:de-oe-X,...he&&{alignmentOffset:X}},reset:he}}}),Tj=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(n){var t,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:f,elements:h}=n,{mainAxis:p=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:b=!0,...k}=Bl(e,n);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const T=mo(a),j=co(c),C=mo(c)===c,W=await(f.isRTL==null?void 0:f.isRTL(h.floating)),J=g||(C||!b?[$u(c)]:gj(c)),V=w!=="none";!g&&V&&J.push(...yj(c,b,w,W));const P=[c,...J],U=await G1(n,k),B=[];let ne=((r=o.flip)==null?void 0:r.overflows)||[];if(p&&B.push(U[T]),m){const oe=mj(a,l,W);B.push(U[oe[0]],U[oe[1]])}if(ne=[...ne,{placement:a,overflows:B}],!B.every(oe=>oe<=0)){var ee,Y;const oe=(((ee=o.flip)==null?void 0:ee.index)||0)+1,he=P[oe];if(he){var fe;const le=m==="alignment"?j!==co(he):!1,z=((fe=ne[0])==null?void 0:fe.overflows[0])>0;if(!le||z)return{data:{index:oe,overflows:ne},reset:{placement:he}}}let X=(Y=ne.filter(le=>le.overflows[0]<=0).sort((le,z)=>le.overflows[1]-z.overflows[1])[0])==null?void 0:Y.placement;if(!X)switch(v){case"bestFit":{var de;const le=(de=ne.filter(z=>{if(V){const se=co(z.placement);return se===j||se==="y"}return!0}).map(z=>[z.placement,z.overflows.filter(se=>se>0).reduce((se,R)=>se+R,0)]).sort((z,se)=>z[1]-se[1])[0])==null?void 0:de[0];le&&(X=le);break}case"initialPlacement":X=c;break}if(a!==X)return{reset:{placement:X}}}return{}}}};async function Dj(e,n){const{placement:t,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=mo(t),c=Wl(t),f=co(t)==="y",h=["left","top"].includes(l)?-1:1,p=o&&f?-1:1,m=Bl(n,e);let{mainAxis:g,crossAxis:v,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof w=="number"&&(v=c==="end"?w*-1:w),f?{x:v*p,y:g*h}:{x:g*h,y:v*p}}const Fj=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(n){var t,r;const{x:a,y:o,placement:l,middlewareData:c}=n,f=await Dj(n,e);return l===((t=c.offset)==null?void 0:t.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+f.x,y:o+f.y,data:{...f,placement:l}}}}},jj=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(n){const{x:t,y:r,placement:a}=n,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:k=>{let{x:T,y:j}=k;return{x:T,y:j}}},...f}=Bl(e,n),h={x:t,y:r},p=await G1(n,f),m=co(mo(a)),g=Y1(m);let v=h[g],w=h[m];if(o){const k=g==="y"?"top":"left",T=g==="y"?"bottom":"right",j=v+p[k],C=v-p[T];v=Uf(j,v,C)}if(l){const k=m==="y"?"top":"left",T=m==="y"?"bottom":"right",j=w+p[k],C=w-p[T];w=Uf(j,w,C)}const b=c.fn({...n,[g]:v,[m]:w});return{...b,data:{x:b.x-t,y:b.y-r,enabled:{[g]:o,[m]:l}}}}}};function Q1(e){const n=Kn(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=Ta(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,c=Uu(t)!==o||Uu(r)!==l;return c&&(t=o,r=l),{width:t,height:r,$:c}}function Lp(e){return un(e)?e:e.contextElement}function oi(e){const n=Lp(e);if(!Ta(n))return Na(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=Q1(n);let l=(o?Uu(t.width):t.width)/r,c=(o?Uu(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const Pj=Na(0);function X1(e){const n=Cn(e);return!zp()||!n.visualViewport?Pj:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Aj(e,n,t){return n===void 0&&(n=!1),!t||n&&t!==Cn(e)?!1:n}function go(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=Lp(e);let l=Na(1);n&&(r?un(r)&&(l=oi(r)):l=oi(e));const c=Aj(o,t,r)?X1(o):Na(0);let f=(a.left+c.x)/l.x,h=(a.top+c.y)/l.y,p=a.width/l.x,m=a.height/l.y;if(o){const g=Cn(o),v=r&&un(r)?Cn(r):r;let w=g,b=Wf(w);for(;b&&r&&v!==w;){const k=oi(b),T=b.getBoundingClientRect(),j=Kn(b),C=T.left+(b.clientLeft+parseFloat(j.paddingLeft))*k.x,W=T.top+(b.clientTop+parseFloat(j.paddingTop))*k.y;f*=k.x,h*=k.y,p*=k.x,m*=k.y,f+=C,h+=W,w=Cn(b),b=Wf(w)}}return Hu({width:p,height:m,x:f,y:h})}function Bp(e,n){const t=sd(e).scrollLeft;return n?n.left+t:go(Pa(e)).left+t}function q1(e,n,t){t===void 0&&(t=!1);const r=e.getBoundingClientRect(),a=r.left+n.scrollLeft-(t?0:Bp(e,r)),o=r.top+n.scrollTop;return{x:a,y:o}}function Oj(e){let{elements:n,rect:t,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Pa(r),c=n?ad(n.floating):!1;if(r===l||c&&o)return t;let f={scrollLeft:0,scrollTop:0},h=Na(1);const p=Na(0),m=Ta(r);if((m||!m&&!o)&&((yi(r)!=="body"||Ll(l))&&(f=sd(r)),Ta(r))){const v=go(r);h=oi(r),p.x=v.x+r.clientLeft,p.y=v.y+r.clientTop}const g=l&&!m&&!o?q1(l,f,!0):Na(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-f.scrollLeft*h.x+p.x+g.x,y:t.y*h.y-f.scrollTop*h.y+p.y+g.y}}function Rj(e){return Array.from(e.getClientRects())}function zj(e){const n=Pa(e),t=sd(e),r=e.ownerDocument.body,a=lo(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),o=lo(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+Bp(e);const c=-t.scrollTop;return Kn(r).direction==="rtl"&&(l+=lo(n.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}function Mj(e,n){const t=Cn(e),r=Pa(e),a=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,f=0;if(a){o=a.width,l=a.height;const h=zp();(!h||h&&n==="fixed")&&(c=a.offsetLeft,f=a.offsetTop)}return{width:o,height:l,x:c,y:f}}function Ij(e,n){const t=go(e,!0,n==="fixed"),r=t.top+e.clientTop,a=t.left+e.clientLeft,o=Ta(e)?oi(e):Na(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,f=a*o.x,h=r*o.y;return{width:l,height:c,x:f,y:h}}function tv(e,n,t){let r;if(n==="viewport")r=Mj(e,t);else if(n==="document")r=zj(Pa(e));else if(un(n))r=Ij(n,t);else{const a=X1(e);r={x:n.x-a.x,y:n.y-a.y,width:n.width,height:n.height}}return Hu(r)}function Z1(e,n){const t=zs(e);return t===n||!un(t)||pi(t)?!1:Kn(t).position==="fixed"||Z1(t,n)}function Lj(e,n){const t=n.get(e);if(t)return t;let r=Fl(e,[],!1).filter(c=>un(c)&&yi(c)!=="body"),a=null;const o=Kn(e).position==="fixed";let l=o?zs(e):e;for(;un(l)&&!pi(l);){const c=Kn(l),f=Rp(l);!f&&c.position==="fixed"&&(a=null),(o?!f&&!a:!f&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Ll(l)&&!f&&Z1(e,l))?r=r.filter(p=>p!==l):a=c,l=zs(l)}return n.set(e,r),r}function Bj(e){let{element:n,boundary:t,rootBoundary:r,strategy:a}=e;const l=[...t==="clippingAncestors"?ad(n)?[]:Lj(n,this._c):[].concat(t),r],c=l[0],f=l.reduce((h,p)=>{const m=tv(n,p,a);return h.top=lo(m.top,h.top),h.right=hi(m.right,h.right),h.bottom=hi(m.bottom,h.bottom),h.left=lo(m.left,h.left),h},tv(n,c,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function Wj(e){const{width:n,height:t}=Q1(e);return{width:n,height:t}}function Uj(e,n,t){const r=Ta(n),a=Pa(n),o=t==="fixed",l=go(e,!0,o,n);let c={scrollLeft:0,scrollTop:0};const f=Na(0);function h(){f.x=Bp(a)}if(r||!r&&!o)if((yi(n)!=="body"||Ll(a))&&(c=sd(n)),r){const v=go(n,!0,o,n);f.x=v.x+n.clientLeft,f.y=v.y+n.clientTop}else a&&h();o&&!r&&a&&h();const p=a&&!r&&!o?q1(a,c):Na(0),m=l.left+c.scrollLeft-f.x-p.x,g=l.top+c.scrollTop-f.y-p.y;return{x:m,y:g,width:l.width,height:l.height}}function uf(e){return Kn(e).position==="static"}function rv(e,n){if(!Ta(e)||Kn(e).position==="fixed")return null;if(n)return n(e);let t=e.offsetParent;return Pa(e)===t&&(t=t.ownerDocument.body),t}function J1(e,n){const t=Cn(e);if(ad(e))return t;if(!Ta(e)){let a=zs(e);for(;a&&!pi(a);){if(un(a)&&!uf(a))return a;a=zs(a)}return t}let r=rv(e,n);for(;r&&fj(r)&&uf(r);)r=rv(r,n);return r&&pi(r)&&uf(r)&&!Rp(r)?t:r||pj(e)||t}const $j=async function(e){const n=this.getOffsetParent||J1,t=this.getDimensions,r=await t(e.floating);return{reference:Uj(e.reference,await n(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Hj(e){return Kn(e).direction==="rtl"}const Yj={convertOffsetParentRelativeRectToViewportRelativeRect:Oj,getDocumentElement:Pa,getClippingRect:Bj,getOffsetParent:J1,getElementRects:$j,getClientRects:Rj,getDimensions:Wj,getScale:oi,isElement:un,isRTL:Hj};function ew(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function Vj(e,n){let t=null,r;const a=Pa(e);function o(){var c;clearTimeout(r),(c=t)==null||c.disconnect(),t=null}function l(c,f){c===void 0&&(c=!1),f===void 0&&(f=1),o();const h=e.getBoundingClientRect(),{left:p,top:m,width:g,height:v}=h;if(c||n(),!g||!v)return;const w=cu(m),b=cu(a.clientWidth-(p+g)),k=cu(a.clientHeight-(m+v)),T=cu(p),C={rootMargin:-w+"px "+-b+"px "+-k+"px "+-T+"px",threshold:lo(0,hi(1,f))||1};let W=!0;function J(V){const P=V[0].intersectionRatio;if(P!==f){if(!W)return l();P?l(!1,P):r=setTimeout(()=>{l(!1,1e-7)},1e3)}P===1&&!ew(h,e.getBoundingClientRect())&&l(),W=!1}try{t=new IntersectionObserver(J,{...C,root:a.ownerDocument})}catch{t=new IntersectionObserver(J,C)}t.observe(e)}return l(!0),o}function tw(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,h=Lp(e),p=a||o?[...h?Fl(h):[],...Fl(n)]:[];p.forEach(T=>{a&&T.addEventListener("scroll",t,{passive:!0}),o&&T.addEventListener("resize",t)});const m=h&&c?Vj(h,t):null;let g=-1,v=null;l&&(v=new ResizeObserver(T=>{let[j]=T;j&&j.target===h&&v&&(v.unobserve(n),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var C;(C=v)==null||C.observe(n)})),t()}),h&&!f&&v.observe(h),v.observe(n));let w,b=f?go(e):null;f&&k();function k(){const T=go(e);b&&!ew(b,T)&&t(),b=T,w=requestAnimationFrame(k)}return t(),()=>{var T;p.forEach(j=>{a&&j.removeEventListener("scroll",t),o&&j.removeEventListener("resize",t)}),m?.(),(T=v)==null||T.disconnect(),v=null,f&&cancelAnimationFrame(w)}}const rw=Fj,Kj=jj,nw=Tj,Hf=Cj,Yf=(e,n,t)=>{const r=new Map,a={platform:Yj,...t},o={...a.platform,_c:r};return Nj(e,n,{...a,platform:o})};var wu=typeof document<"u"?N.useLayoutEffect:N.useEffect;function Vu(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if(typeof e=="function"&&e.toString()===n.toString())return!0;let t,r,a;if(e&&n&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==n.length)return!1;for(r=t;r--!==0;)if(!Vu(e[r],n[r]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(n).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(n,a[r]))return!1;for(r=t;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Vu(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}function aw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function nv(e,n){const t=aw(e);return Math.round(n*t)/t}function df(e){const n=N.useRef(e);return wu(()=>{n.current=e}),n}function Gj(e){e===void 0&&(e={});const{placement:n="bottom",strategy:t="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:f,open:h}=e,[p,m]=N.useState({x:0,y:0,strategy:t,placement:n,middlewareData:{},isPositioned:!1}),[g,v]=N.useState(r);Vu(g,r)||v(r);const[w,b]=N.useState(null),[k,T]=N.useState(null),j=N.useCallback(le=>{le!==V.current&&(V.current=le,b(le))},[]),C=N.useCallback(le=>{le!==P.current&&(P.current=le,T(le))},[]),W=o||w,J=l||k,V=N.useRef(null),P=N.useRef(null),U=N.useRef(p),B=f!=null,ne=df(f),ee=df(a),Y=df(h),fe=N.useCallback(()=>{if(!V.current||!P.current)return;const le={placement:n,strategy:t,middleware:g};ee.current&&(le.platform=ee.current),Yf(V.current,P.current,le).then(z=>{const se={...z,isPositioned:Y.current!==!1};de.current&&!Vu(U.current,se)&&(U.current=se,K1.flushSync(()=>{m(se)}))})},[g,n,t,ee,Y]);wu(()=>{h===!1&&U.current.isPositioned&&(U.current.isPositioned=!1,m(le=>({...le,isPositioned:!1})))},[h]);const de=N.useRef(!1);wu(()=>(de.current=!0,()=>{de.current=!1}),[]),wu(()=>{if(W&&(V.current=W),J&&(P.current=J),W&&J){if(ne.current)return ne.current(W,J,fe);fe()}},[W,J,fe,ne,B]);const oe=N.useMemo(()=>({reference:V,floating:P,setReference:j,setFloating:C}),[j,C]),he=N.useMemo(()=>({reference:W,floating:J}),[W,J]),X=N.useMemo(()=>{const le={position:t,left:0,top:0};if(!he.floating)return le;const z=nv(he.floating,p.x),se=nv(he.floating,p.y);return c?{...le,transform:"translate("+z+"px, "+se+"px)",...aw(he.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:z,top:se}},[t,c,he.floating,p.x,p.y]);return N.useMemo(()=>({...p,update:fe,refs:oe,elements:he,floatingStyles:X}),[p,fe,oe,he,X])}const Qj=e=>{function n(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:r,padding:a}=typeof e=="function"?e(t):e;return r&&n(r)?r.current!=null?Hf({element:r.current,padding:a}).fn(t):{}:r?Hf({element:r,padding:a}).fn(t):{}}}},Xj=(e,n)=>({...rw(e),options:[e,n]}),qj=(e,n)=>({...nw(e),options:[e,n]}),Zj=(e,n)=>({...Qj(e),options:[e,n]}),Jj={...Mv};let av=!1,eP=0;const sv=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+eP++;function tP(){const[e,n]=N.useState(()=>av?sv():void 0);return Yu(()=>{e==null&&n(sv())},[]),N.useEffect(()=>{av=!0},[]),e}const rP=Jj.useId,sw=rP||tP,nP=N.forwardRef(function(n,t){const{context:{placement:r,elements:{floating:a},middlewareData:{arrow:o,shift:l}},width:c=14,height:f=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:m,stroke:g,d:v,style:{transform:w,...b}={},...k}=n,T=sw(),[j,C]=N.useState(!1);if(Yu(()=>{if(!a)return;Kn(a).direction==="rtl"&&C(!0)},[a]),!a)return null;const[W,J]=r.split("-"),V=W==="top"||W==="bottom";let P=m;(V&&l!=null&&l.x||!V&&l!=null&&l.y)&&(P=null);const U=p*2,B=U/2,ne=c/2*(h/-8+1),ee=f/2*h/4,Y=!!v,fe=P&&J==="end"?"bottom":"top";let de=P&&J==="end"?"right":"left";P&&j&&(de=J==="end"?"left":"right");const oe=o?.x!=null?P||o.x:"",he=o?.y!=null?P||o.y:"",X=v||"M0,0"+(" H"+c)+(" L"+(c-ne)+","+(f-ee))+(" Q"+c/2+","+f+" "+ne+","+(f-ee))+" Z",le={top:Y?"rotate(180deg)":"",left:Y?"rotate(90deg)":"rotate(-90deg)",bottom:Y?"":"rotate(180deg)",right:Y?"rotate(-90deg)":"rotate(90deg)"}[W];return u.jsxs("svg",{...k,"aria-hidden":!0,ref:t,width:Y?c:c+U,height:c,viewBox:"0 0 "+c+" "+(f>c?f:c),style:{position:"absolute",pointerEvents:"none",[de]:oe,[fe]:he,[W]:V||Y?"100%":"calc(100% - "+U/2+"px)",transform:[le,w].filter(z=>!!z).join(" "),...b},children:[U>0&&u.jsx("path",{clipPath:"url(#"+T+")",fill:"none",stroke:g,strokeWidth:U+(v?0:1),d:X}),u.jsx("path",{stroke:U&&!v?k.fill:"none",d:X}),u.jsx("clipPath",{id:T,children:u.jsx("rect",{x:-B,y:B*(Y?-1:1),width:c+U,height:c})})]})});function aP(){const e=new Map;return{emit(n,t){var r;(r=e.get(n))==null||r.forEach(a=>a(t))},on(n,t){e.has(n)||e.set(n,new Set),e.get(n).add(t)},off(n,t){var r;(r=e.get(n))==null||r.delete(t)}}}const sP=N.createContext(null),oP=N.createContext(null),iP=()=>{var e;return((e=N.useContext(sP))==null?void 0:e.id)||null},lP=()=>N.useContext(oP);function cP(e){const{open:n=!1,onOpenChange:t,elements:r}=e,a=sw(),o=N.useRef({}),[l]=N.useState(()=>aP()),c=iP()!=null,[f,h]=N.useState(r.reference),p=Sj((v,w,b)=>{o.current.openEvent=v?w:void 0,l.emit("openchange",{open:v,event:w,reason:b,nested:c}),t?.(v,w,b)}),m=N.useMemo(()=>({setPositionReference:h}),[]),g=N.useMemo(()=>({reference:f||r.reference||null,floating:r.floating||null,domReference:r.reference}),[f,r.reference,r.floating]);return N.useMemo(()=>({dataRef:o,open:n,onOpenChange:p,elements:g,events:l,floatingId:a,refs:m}),[n,p,g,l,a,m])}function uP(e){e===void 0&&(e={});const{nodeId:n}=e,t=cP({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||t,a=r.elements,[o,l]=N.useState(null),[c,f]=N.useState(null),p=a?.domReference||o,m=N.useRef(null),g=lP();Yu(()=>{p&&(m.current=p)},[p]);const v=Gj({...e,elements:{...a,...c&&{reference:c}}}),w=N.useCallback(C=>{const W=un(C)?{getBoundingClientRect:()=>C.getBoundingClientRect(),getClientRects:()=>C.getClientRects(),contextElement:C}:C;f(W),v.refs.setReference(W)},[v.refs]),b=N.useCallback(C=>{(un(C)||C===null)&&(m.current=C,l(C)),(un(v.refs.reference.current)||v.refs.reference.current===null||C!==null&&!un(C))&&v.refs.setReference(C)},[v.refs]),k=N.useMemo(()=>({...v.refs,setReference:b,setPositionReference:w,domReference:m}),[v.refs,b,w]),T=N.useMemo(()=>({...v.elements,domReference:p}),[v.elements,p]),j=N.useMemo(()=>({...v,...r,refs:k,elements:T,nodeId:n}),[v,k,T,n,r]);return Yu(()=>{r.dataRef.current.floatingContext=j;const C=g?.nodesRef.current.find(W=>W.id===n);C&&(C.context=j)}),N.useMemo(()=>({...v,context:j,refs:k,elements:T}),[v,k,T,j])}/*!
  react-datepicker v8.3.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Vf=function(n,t){return Vf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},Vf(n,t)};function Mr(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Vf(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var It=function(){return It=Object.assign||function(t){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},It.apply(this,arguments)};function Ea(e,n,t){if(t||arguments.length===2)for(var r=0,a=n.length,o;r<a;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var dP=function(e){var n=e.showTimeSelectOnly,t=n===void 0?!1:n,r=e.showTime,a=r===void 0?!1:r,o=e.className,l=e.children,c=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return Te.createElement("div",{className:o,role:"dialog","aria-label":c,"aria-modal":"true"},l)},fP=function(e,n){var t=N.useRef(null),r=N.useRef(e);r.current=e;var a=N.useCallback(function(o){var l,c=o.composed&&o.composedPath&&o.composedPath().find(function(f){return f instanceof Node})||o.target;t.current&&!t.current.contains(c)&&(n&&c instanceof HTMLElement&&c.classList.contains(n)||(l=r.current)===null||l===void 0||l.call(r,o))},[n]);return N.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},od=function(e){var n=e.children,t=e.onClickOutside,r=e.className,a=e.containerRef,o=e.style,l=e.ignoreClass,c=fP(t,l);return Te.createElement("div",{className:r,style:o,ref:function(f){c.current=f,a&&(a.current=f)}},n)},st;(function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"})(st||(st={}));function Wp(){var e=typeof window<"u"?window:globalThis;return e}var Ul=12;function Kt(e){if(e==null)return new Date;var n=typeof e=="string"?XF(e):dt(e);return id(n)?n:new Date}function ff(e,n,t,r,a){a===void 0&&(a=Kt());for(var o=xi(t)||xi(Up()),l=Array.isArray(n)?n:[n],c=0,f=l;c<f.length;c++){var h=f[c],p=$F(e,h,a,{locale:o});if(id(p)&&(!r||e===lr(p,h,t)))return p}return null}function id(e,n){return Mu(e)&&!xo(e,new Date("1/1/1800"))}function lr(e,n,t){if(t==="en")return Xg(e,n,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?xi(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||xi(Up()),Xg(e,n,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Wn(e,n){var t=n.dateFormat,r=n.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return e&&lr(e,a,r)||""}function pP(e,n,t){if(!e)return"";var r=Wn(e,t),a=n?Wn(n,t):"";return"".concat(r," - ").concat(a)}function hP(e,n){if(!e?.length)return"";var t=e[0]?Wn(e[0],n):"";if(e.length===1)return t;if(e.length===2&&e[1]){var r=Wn(e[1],n);return"".concat(t,", ").concat(r)}var a=e.length-1;return"".concat(t," (+").concat(a,")")}function pf(e,n){var t=n.hour,r=t===void 0?0:t,a=n.minute,o=a===void 0?0:a,l=n.second,c=l===void 0?0:l;return gu(vu(yu(e,c),o),r)}function xP(e){return jp(e)}function mP(e,n){return lr(e,"ddd",n)}function ku(e){return ho(e)}function Ps(e,n,t){var r=xi(n||Up());return ua(e,{locale:r,weekStartsOn:t})}function Za(e){return j1(e)}function ll(e){return rd(e)}function ov(e){return If(e)}function iv(){return ho(Kt())}function lv(e){return D1(e)}function gP(e){return X4(e)}function vP(e){return F1(e)}function wa(e,n){return e&&n?GF(e,n):!e&&!n}function an(e,n){return e&&n?VF(e,n):!e&&!n}function Ku(e,n){return e&&n?KF(e,n):!e&&!n}function Mt(e,n){return e&&n?G4(e,n):!e&&!n}function ro(e,n){return e&&n?G3(e,n):!e&&!n}function cl(e,n,t){var r,a=ho(n),o=D1(t);try{r=Dl(e,{start:a,end:o})}catch{r=!1}return r}function Aa(e,n){var t=Wp();t.__localeData__||(t.__localeData__={}),t.__localeData__[e]=n}function Up(){var e=Wp();return e.__localeId__}function xi(e){if(typeof e=="string"){var n=Wp();return n.__localeData__?n.__localeData__[e]:void 0}else return e}function yP(e,n,t){return n(lr(e,"EEEE",t))}function wP(e,n){return lr(e,"EEEEEE",n)}function kP(e,n){return lr(e,"EEE",n)}function $p(e,n){return lr(Un(Kt(),e),"LLLL",n)}function ow(e,n){return lr(Un(Kt(),e),"LLL",n)}function bP(e,n){return lr(Jo(Kt(),e),"QQQ",n)}function $n(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.excludeDateIntervals,c=t.includeDates,f=t.includeDateIntervals,h=t.filterDate;return $l(e,{minDate:r,maxDate:a})||o&&o.some(function(p){return p instanceof Date?Mt(e,p):Mt(e,p.date)})||l&&l.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||c&&!c.some(function(p){return Mt(e,p)})||f&&!f.some(function(p){var m=p.start,g=p.end;return Dl(e,{start:m,end:g})})||h&&!h(Kt(e))||!1}function Hp(e,n){var t=n===void 0?{}:n,r=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(o){var l=o.start,c=o.end;return Dl(e,{start:l,end:c})}):r&&r.some(function(o){var l;return o instanceof Date?Mt(e,o):Mt(e,(l=o.date)!==null&&l!==void 0?l:new Date)})||!1}function iw(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return $l(e,{minDate:r?j1(r):void 0,maxDate:a?F1(a):void 0})||o?.some(function(f){return an(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return an(e,f)})||c&&!c(Kt(e))||!1}function uu(e,n,t,r){var a=Tt(e),o=cn(e),l=Tt(n),c=cn(n),f=Tt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function _P(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates;return $l(e,{minDate:r,maxDate:a})||o&&o.some(function(c){return an(c instanceof Date?c:c.date,e)})||l&&!l.some(function(c){return an(c,e)})||!1}function du(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate;return $l(e,{minDate:r,maxDate:a})||o?.some(function(f){return Ku(e,f instanceof Date?f:f.date)})||l&&!l.some(function(f){return Ku(e,f)})||c&&!c(Kt(e))||!1}function fu(e,n,t){if(!n||!t||!Mu(n)||!Mu(t))return!1;var r=Tt(n),a=Tt(t);return r<=e&&a>=e}function bu(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,f=new Date(e,0,1);return $l(f,{minDate:r?rd(r):void 0,maxDate:a?P1(a):void 0})||o?.some(function(h){return wa(f,h instanceof Date?h:h.date)})||l&&!l.some(function(h){return wa(f,h)})||c&&!c(Kt(f))||!1}function pu(e,n,t,r){var a=Tt(e),o=oo(e),l=Tt(n),c=oo(n),f=Tt(r);return a===l&&a===f?o<=t&&t<=c:a<l?f===a&&o<=t||f===l&&c>=t||f<l&&f>a:!1}function $l(e,n){var t,r=n===void 0?{}:n,a=r.minDate,o=r.maxDate;return(t=a&&di(e,a)<0||o&&di(e,o)>0)!==null&&t!==void 0?t:!1}function cv(e,n){return n.some(function(t){return Xa(t)===Xa(e)&&qa(t)===qa(e)&&js(t)===js(e)})}function uv(e,n){var t=n===void 0?{}:n,r=t.excludeTimes,a=t.includeTimes,o=t.filterTime;return r&&cv(e,r)||a&&!cv(e,a)||o&&!o(e)||!1}function dv(e,n){var t=n.minTime,r=n.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var a=Kt();a=gu(a,Xa(e)),a=vu(a,qa(e)),a=yu(a,js(e));var o=Kt();o=gu(o,Xa(t)),o=vu(o,qa(t)),o=yu(o,js(t));var l=Kt();l=gu(l,Xa(r)),l=vu(l,qa(r)),l=yu(l,js(r));var c;try{c=!Dl(a,{start:o,end:l})}catch{c=!1}return c}function fv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=io(e,1);return r&&Iu(r,o)>0||a&&a.every(function(l){return Iu(l,o)>0})||!1}function pv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=ca(e,1);return r&&Iu(o,r)>0||a&&a.every(function(l){return Iu(o,l)>0})||!1}function SP(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=rd(e),l=U1(o);return r&&Lu(r,l)>0||a&&a.every(function(c){return Lu(c,l)>0})||!1}function EP(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=P1(e),l=Fp(o,1);return r&&Lu(l,r)>0||a&&a.every(function(c){return Lu(l,c)>0})||!1}function hv(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.includeDates,o=fi(e,1);return r&&Bu(r,o)>0||a&&a.every(function(l){return Bu(l,o)>0})||!1}function NP(e,n){var t=n===void 0?{}:n,r=t.minDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=ll(fi(e,o)),c=Ds(l,o).endPeriod,f=r&&Tt(r);return f&&f>c||!1}function xv(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.includeDates,o=Ga(e,1);return r&&Bu(o,r)>0||a&&a.every(function(l){return Bu(o,l)>0})||!1}function CP(e,n){var t=n===void 0?{}:n,r=t.maxDate,a=t.yearItemNumber,o=a===void 0?Ul:a,l=Ga(e,o),c=Ds(l,o).startPeriod,f=r&&Tt(r);return f&&f<c||!1}function lw(e){var n=e.minDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)>=0});return Hg(r)}else return t?Hg(t):n}function cw(e){var n=e.maxDate,t=e.includeDates;if(t&&n){var r=t.filter(function(a){return di(a,n)<=0});return $g(r)}else return t?$g(t):n}function mv(e,n){var t;e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--highlighted");for(var r=new Map,a=0,o=e.length;a<o;a++){var l=e[a];if(Qa(l)){var c=lr(l,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(n)||(f.push(n),r.set(c,f))}else if(typeof l=="object"){var h=Object.keys(l),p=(t=h[0])!==null&&t!==void 0?t:"",m=l[p];if(typeof p=="string"&&Array.isArray(m))for(var g=0,v=m.length;g<v;g++){var w=m[g];if(w){var c=lr(w,"MM.dd.yyyy"),f=r.get(c)||[];f.includes(p)||(f.push(p),r.set(c,f))}}}}return r}function TP(e,n){return e.length!==n.length?!1:e.every(function(t,r){return t===n[r]})}function DP(e,n){e===void 0&&(e=[]),n===void 0&&(n="react-datepicker__day--holidays");var t=new Map;return e.forEach(function(r){var a=r.date,o=r.holidayName;if(Qa(a)){var l=lr(a,"MM.dd.yyyy"),c=t.get(l)||{className:"",holidayNames:[]};if(!("className"in c&&c.className===n&&TP(c.holidayNames,[o]))){c.className=n;var f=c.holidayNames;c.holidayNames=f?Ea(Ea([],f,!0),[o],!1):[o],t.set(l,c)}}}),t}function FP(e,n,t,r,a){for(var o=a.length,l=[],c=0;c<o;c++){var f=e,h=a[c];h&&(f=H4(f,Xa(h)),f=Mf(f,qa(h)),f=K4(f,js(h)));var p=Mf(e,(t+1)*r);Rs(f,n)&&xo(f,p)&&h!=null&&l.push(h)}return l}function gv(e){return e<10?"0".concat(e):"".concat(e)}function Ds(e,n){n===void 0&&(n=Ul);var t=Math.ceil(Tt(e)/n)*n,r=t-(n-1);return{startPeriod:r,endPeriod:t}}function jP(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+t-+n)/36e5)}function vv(e){var n=e.getSeconds(),t=e.getMilliseconds();return dt(e.getTime()-n*1e3-t)}function PP(e,n){return vv(e).getTime()===vv(n).getTime()}function yv(e){if(!Qa(e))throw new Error("Invalid date");var n=new Date(e);return n.setHours(0,0,0,0),n}function wv(e,n){if(!Qa(e)||!Qa(n))throw new Error("Invalid date received");var t=yv(e),r=yv(n);return xo(t,r)}function uw(e){return e.key===st.Space}var AP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.inputRef=Te.createRef(),r.onTimeChange=function(a){var o,l;r.setState({time:a});var c=r.props.date,f=c instanceof Date&&!isNaN(+c),h=f?c:new Date;if(a?.includes(":")){var p=a.split(":"),m=p[0],g=p[1];h.setHours(Number(m)),h.setMinutes(Number(g))}(l=(o=r.props).onChange)===null||l===void 0||l.call(o,h)},r.renderTimeInput=function(){var a=r.state.time,o=r.props,l=o.date,c=o.timeString,f=o.customTimeInput;return f?N.cloneElement(f,{date:l,value:a,onChange:r.onTimeChange}):Te.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var h;(h=r.inputRef.current)===null||h===void 0||h.focus()},required:!0,value:a,onChange:function(h){r.onTimeChange(h.target.value||c)}})},r.state={time:r.props.timeString},r}return n.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},n.prototype.render=function(){return Te.createElement("div",{className:"react-datepicker__input-time-container"},Te.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),Te.createElement("div",{className:"react-datepicker-time__input-container"},Te.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n})(N.Component),OP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.dayEl=N.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===st.Space&&(r.preventDefault(),r.key=st.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isSameDay=function(r){return Mt(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(l){return t.isSameDayOrWeek(l)}):t.isSameDayOrWeek(t.props.selected),o=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!o},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),$n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Hp(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Mt(t.props.day,Ps(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&Mt(r,Ps(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,a=r.day,o=r.highlightDates;if(!o)return!1;var l=lr(a,"MM.dd.yyyy");return o.get(l)},t.getHolidaysClass=function(){var r,a=t.props,o=a.day,l=a.holidays;if(!l)return[void 0];var c=lr(o,"MM.dd.yyyy");return l.has(c)?[(r=l.get(c))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:cl(a,o,l)},t.isInSelectingRange=function(){var r,a=t.props,o=a.day,l=a.selectsStart,c=a.selectsEnd,f=a.selectsRange,h=a.selectsDisabledDaysInRange,p=a.startDate,m=a.endDate,g=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return!(l||c||f)||!g||!h&&t.isDisabled()?!1:l&&m&&(xo(g,m)||ro(g,m))?cl(o,g,m):c&&p&&!m&&(Rs(g,p)||ro(g,p))||f&&p&&!m&&(Rs(g,p)||ro(g,p))?cl(o,p,g):!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.startDate,c=a.selectsStart,f=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c?Mt(o,f):Mt(o,l)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var a=t.props,o=a.day,l=a.endDate,c=a.selectsEnd,f=a.selectsRange,h=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return c||f?Mt(o,h):Mt(o,l)},t.isRangeStart=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Mt(o,a)},t.isRangeEnd=function(){var r=t.props,a=r.day,o=r.startDate,l=r.endDate;return!o||!l?!1:Mt(l,a)},t.isWeekend=function(){var r=H3(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===cn(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(cn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Kt())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var a=t.props.dayClassName?t.props.dayClassName(r):void 0;return Wr("react-datepicker__day",a,"react-datepicker__day--"+mP(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,a=r.day,o=r.ariaLabelPrefixWhenEnabled,l=o===void 0?"Choose":o,c=r.ariaLabelPrefixWhenDisabled,f=c===void 0?"Not available":c,h=t.isDisabled()||t.isExcluded()?f:l;return"".concat(h," ").concat(lr(a,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,a=r.day,o=r.holidays,l=o===void 0?new Map:o,c=r.excludeDates,f=lr(a,"MM.dd.yyyy"),h=[];return l.has(f)&&h.push.apply(h,l.get(f).holidayNames),t.isExcluded()&&h.push(c?.filter(function(p){return p instanceof Date?Mt(p,a):Mt(p?.date,a)}).map(function(p){if(!(p instanceof Date))return p?.message})),h.join(", ")},t.getTabIndex=function(){var r=t.props.selected,a=t.props.preSelection,o=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&Mt(a,r))?0:-1;return o},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(qg(t.props.day),t.props.day):qg(t.props.day)},t.render=function(){return Te.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&Te.createElement("span",{className:"overlay"},t.getTitle()))},t}return n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},n.prototype.isDayActiveElement=function(){var t,r,a;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n})(N.Component),RP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.weekNumberEl=N.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var a,o,l=r.key;l===st.Space&&(r.preventDefault(),r.key=st.Enter),(o=(a=t.props).handleOnKeyDown)===null||o===void 0||o.call(a,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Mt(t.props.date,t.props.selected)&&Mt(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Mt(t.props.date,t.props.selected)&&Mt(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var a=!1;t.getTabIndex()===0&&!r?.isInputFocused&&Mt(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},n.prototype.render=function(){var t=this.props,r=t.weekNumber,a=t.isWeekDisabled,o=t.ariaLabelPrefix,l=o===void 0?n.defaultProps.ariaLabelPrefix:o,c=t.onClick,f={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!c&&!a,"react-datepicker__week-number--selected":!!c&&Mt(this.props.date,this.props.selected)};return Te.createElement("div",{ref:this.weekNumberEl,className:Wr(f),"aria-label":"".concat(l," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},r)},n})(N.Component),zP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isDisabled=function(r){return $n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,a){t.props.onDayClick&&t.props.onDayClick(r,a)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,a,o){for(var l,c,f,h=new Date(r),p=0;p<7;p++){var m=new Date(r);m.setDate(m.getDate()+p);var g=!t.isDisabled(m);if(g){h=m;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(h,a,o),t.props.showWeekPicker&&t.handleDayClick(h,o),((l=t.props.shouldCloseOnSelect)!==null&&l!==void 0?l:n.defaultProps.shouldCloseOnSelect)&&((f=(c=t.props).setOpen)===null||f===void 0||f.call(c,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):xP(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),a=la(r,6),o=new Date(r);o<=a;){if(!t.isDisabled(o))return!1;o=la(o,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),a=[],o=t.formatWeekNumber(r);if(t.props.showWeekNumber){var l=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,o):void 0;a.push(Te.createElement(RP,It({key:"W"},n.defaultProps,t.props,{weekNumber:o,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:l})))}return a.concat([0,1,2,3,4,5,6].map(function(c){var f=la(r,c);return Te.createElement(OP,It({},n.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:f.valueOf(),day:f,onClick:t.handleDayClick.bind(t,f),onMouseEnter:t.handleDayMouseEnter.bind(t,f)}))}))},t.startOfWeek=function(){return Ps(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Mt(t.startOfWeek(),t.props.selected)&&Mt(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Mt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return Te.createElement("div",{className:Wr(t)},this.renderDays())},n})(N.Component),nl,MP=6,ii={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},hf=(nl={},nl[ii.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},nl[ii.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},nl[ii.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},nl),hu=1;function kv(e,n){return e?ii.FOUR_COLUMNS:n?ii.TWO_COLUMNS:ii.THREE_COLUMNS}var IP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.MONTH_REFS=Ea([],Array(12),!0).map(function(){return N.createRef()}),t.QUARTER_REFS=Ea([],Array(4),!0).map(function(){return N.createRef()}),t.isDisabled=function(r){return $n(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return Hp(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,a){var o,l;(l=(o=t.props).onDayClick)===null||l===void 0||l.call(o,r,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var a,o;(o=(a=t.props).onDayMouseEnter)===null||o===void 0||o.call(a,r)},t.handleMouseLeave=function(){var r,a;(a=(r=t.props).onMouseLeave)===null||a===void 0||a.call(r)},t.isRangeStartMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Un(o,r),l)},t.isRangeStartQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Ku(Jo(o,r),l)},t.isRangeEndMonth=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:an(Un(o,r),c)},t.isRangeEndQuarter=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:Ku(Jo(o,r),c)},t.isInSelectingRangeMonth=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?uu(g,m,r,l):f&&p||h&&p&&!m?uu(p,g,r,l):!1},t.isSelectingMonthRangeStart=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.startDate,f=o.selectsStart,h=Un(l,r),p=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f?an(h,p):an(h,c)},t.isSelectingMonthRangeEnd=function(r){var a;if(!t.isInSelectingRangeMonth(r))return!1;var o=t.props,l=o.day,c=o.endDate,f=o.selectsEnd,h=o.selectsRange,p=Un(l,r),m=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return f||h?an(p,m):an(p,c)},t.isInSelectingRangeQuarter=function(r){var a,o=t.props,l=o.day,c=o.selectsStart,f=o.selectsEnd,h=o.selectsRange,p=o.startDate,m=o.endDate,g=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(c||f||h)||!g?!1:c&&m?pu(g,m,r,l):f&&p||h&&p&&!m?pu(p,g,r,l):!1},t.isWeekInMonth=function(r){var a=t.props.day,o=la(r,6);return an(r,a)||an(o,a)},t.isCurrentMonth=function(r,a){return Tt(r)===Tt(Kt())&&a===cn(Kt())},t.isCurrentQuarter=function(r,a){return Tt(r)===Tt(Kt())&&a===oo(Kt())},t.isSelectedMonth=function(r,a,o){return cn(o)===a&&Tt(r)===Tt(o)},t.isSelectMonthInList=function(r,a,o){return o.some(function(l){return t.isSelectedMonth(r,a,l)})},t.isSelectedQuarter=function(r,a,o){return oo(r)===a&&Tt(r)===Tt(o)},t.renderWeeks=function(){for(var r=[],a=t.props.fixedHeight,o=0,l=!1,c=Ps(Za(t.props.day),t.props.locale,t.props.calendarStartDay),f=function(w){return t.props.showWeekPicker?Ps(w,t.props.locale,t.props.calendarStartDay):t.props.preSelection},h=function(w){return t.props.showWeekPicker?Ps(w,t.props.locale,t.props.calendarStartDay):t.props.selected},p=t.props.selected?h(t.props.selected):void 0,m=t.props.preSelection?f(t.props.preSelection):void 0;r.push(Te.createElement(zP,It({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:o,day:c,month:cn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:p,preSelection:m,showWeekNumber:t.props.showWeekNumbers}))),!l;){o++,c=zu(c,1);var g=a&&o>=MP,v=!a&&!t.isWeekInMonth(c);if(g||v)if(t.props.peekNextMonth)l=!0;else break}return r},t.onMonthClick=function(r,a){var o=t.isMonthDisabledForLabelDate(a),l=o.isDisabled,c=o.labelDate;l||t.handleDayClick(Za(c),r)},t.onMonthMouseEnter=function(r){var a=t.isMonthDisabledForLabelDate(r),o=a.isDisabled,l=a.labelDate;o||t.handleDayMouseEnter(Za(l))},t.handleMonthNavigation=function(r,a){var o,l,c,f;(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.MONTH_REFS[r])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus()},t.handleKeyboardNavigation=function(r,a,o){var l,c=t.props,f=c.selected,h=c.preSelection,p=c.setPreSelection,m=c.minDate,g=c.maxDate,v=c.showFourColumnMonthYearPicker,w=c.showTwoColumnMonthYearPicker;if(h){var b=kv(v,w),k=t.getVerticalOffset(b),T=(l=hf[b])===null||l===void 0?void 0:l.grid,j=function(P,U,B){var ne,ee,Y=U,fe=B;switch(P){case st.ArrowRight:Y=ca(U,hu),fe=B===11?0:B+hu;break;case st.ArrowLeft:Y=io(U,hu),fe=B===0?11:B-hu;break;case st.ArrowUp:Y=io(U,k),fe=!((ne=T?.[0])===null||ne===void 0)&&ne.includes(B)?B+12-k:B-k;break;case st.ArrowDown:Y=ca(U,k),fe=!((ee=T?.[T.length-1])===null||ee===void 0)&&ee.includes(B)?B-12+k:B+k;break}return{newCalculatedDate:Y,newCalculatedMonth:fe}},C=function(P,U,B){for(var ne=40,ee=P,Y=!1,fe=0,de=j(ee,U,B),oe=de.newCalculatedDate,he=de.newCalculatedMonth;!Y;){if(fe>=ne){oe=U,he=B;break}if(m&&oe<m){ee=st.ArrowRight;var X=j(ee,oe,he);oe=X.newCalculatedDate,he=X.newCalculatedMonth}if(g&&oe>g){ee=st.ArrowLeft;var X=j(ee,oe,he);oe=X.newCalculatedDate,he=X.newCalculatedMonth}if(_P(oe,t.props)){var X=j(ee,oe,he);oe=X.newCalculatedDate,he=X.newCalculatedMonth}else Y=!0;fe++}return{newCalculatedDate:oe,newCalculatedMonth:he}};if(a===st.Enter){t.isMonthDisabled(o)||(t.onMonthClick(r,o),p?.(f));return}var W=C(a,h,o),J=W.newCalculatedDate,V=W.newCalculatedMonth;switch(a){case st.ArrowRight:case st.ArrowLeft:case st.ArrowUp:case st.ArrowDown:t.handleMonthNavigation(V,J);break}}},t.getVerticalOffset=function(r){var a,o;return(o=(a=hf[r])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&o!==void 0?o:0},t.onMonthKeyDown=function(r,a){var o=t.props,l=o.disabledKeyboardNavigation,c=o.handleOnMonthKeyDown,f=r.key;f!==st.Tab&&r.preventDefault(),l||t.handleKeyboardNavigation(r,f,a),c&&c(r)},t.onQuarterClick=function(r,a){var o=Jo(t.props.day,a);du(o,t.props)||t.handleDayClick(ov(o),r)},t.onQuarterMouseEnter=function(r){var a=Jo(t.props.day,r);du(a,t.props)||t.handleDayMouseEnter(ov(a))},t.handleQuarterNavigation=function(r,a){var o,l,c,f;t.isDisabled(a)||t.isExcluded(a)||((l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,a),(f=(c=t.QUARTER_REFS[r-1])===null||c===void 0?void 0:c.current)===null||f===void 0||f.focus())},t.onQuarterKeyDown=function(r,a){var o,l,c=r.key;if(!t.props.disabledKeyboardNavigation)switch(c){case st.Enter:t.onQuarterClick(r,a),(l=(o=t.props).setPreSelection)===null||l===void 0||l.call(o,t.props.selected);break;case st.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,Fp(t.props.preSelection,1));break;case st.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,U1(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var a,o=t.props,l=o.day,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=Un(l,r);return{isDisabled:(a=(c||f||h||p)&&iw(m,t.props))!==null&&a!==void 0?a:!1,labelDate:m}},t.isMonthDisabled=function(r){var a=t.isMonthDisabledForLabelDate(r).isDisabled;return a},t.getMonthClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.preSelection,h=a.monthClassName,p=h?h(Un(o,r)):void 0,m=t.getSelection();return Wr("react-datepicker__month-text","react-datepicker__month-".concat(r),p,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":m?t.isSelectMonthInList(o,r,m):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&f&&t.isSelectedMonth(o,r,f)&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":l&&c?uu(l,c,r,o):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(o,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=cn(t.props.preSelection),o=t.isMonthDisabledForLabelDate(a).isDisabled,l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var a=oo(t.props.preSelection),o=du(t.props.day,t.props),l=r===a&&!(o||t.props.disabledKeyboardNavigation)?"0":"-1";return l},t.getAriaLabel=function(r){var a=t.props,o=a.chooseDayAriaLabelPrefix,l=o===void 0?"Choose":o,c=a.disabledDayAriaLabelPrefix,f=c===void 0?"Not available":c,h=a.day,p=a.locale,m=Un(h,r),g=t.isDisabled(m)||t.isExcluded(m)?f:l;return"".concat(g," ").concat(lr(m,"MMMM yyyy",p))},t.getQuarterClassNames=function(r){var a=t.props,o=a.day,l=a.startDate,c=a.endDate,f=a.selected,h=a.minDate,p=a.maxDate,m=a.excludeDates,g=a.includeDates,v=a.filterDate,w=a.preSelection,b=a.disabledKeyboardNavigation,k=(h||p||m||g||v)&&du(Jo(o,r),t.props);return Wr("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":k,"react-datepicker__quarter-text--selected":f?t.isSelectedQuarter(o,r,f):void 0,"react-datepicker__quarter-text--keyboard-selected":!b&&w&&t.isSelectedQuarter(o,r,w)&&!k,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":l&&c?pu(l,c,r,o):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(o,r)})},t.getMonthContent=function(r){var a=t.props,o=a.showFullMonthYearPicker,l=a.renderMonthContent,c=a.locale,f=a.day,h=ow(r,c),p=$p(r,c);return l?l(r,h,p,f):o?p:h},t.getQuarterContent=function(r){var a,o=t.props,l=o.renderQuarterContent,c=o.locale,f=bP(r,c);return(a=l?.(r,f))!==null&&a!==void 0?a:f},t.renderMonths=function(){var r,a=t.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,f=a.selected,h=(r=hf[kv(l,o)])===null||r===void 0?void 0:r.grid;return h?.map(function(p,m){return Te.createElement("div",{className:"react-datepicker__month-wrapper",key:m},p.map(function(g,v){return Te.createElement("div",{ref:t.MONTH_REFS[g],key:v,onClick:function(w){t.onMonthClick(w,g)},onKeyDown:function(w){uw(w)&&(w.preventDefault(),w.key=st.Enter),t.onMonthKeyDown(w,g)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(g)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(g)}:void 0,tabIndex:Number(t.getTabIndex(g)),className:t.getMonthClassNames(g),"aria-disabled":t.isMonthDisabled(g),role:"option","aria-label":t.getAriaLabel(g),"aria-current":t.isCurrentMonth(c,g)?"date":void 0,"aria-selected":f?t.isSelectedMonth(c,g,f):void 0},t.getMonthContent(g))}))})},t.renderQuarters=function(){var r=t.props,a=r.day,o=r.selected,l=[1,2,3,4];return Te.createElement("div",{className:"react-datepicker__quarter-wrapper"},l.map(function(c,f){return Te.createElement("div",{key:f,ref:t.QUARTER_REFS[f],role:"option",onClick:function(h){t.onQuarterClick(h,c)},onKeyDown:function(h){t.onQuarterKeyDown(h,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(c)}:void 0,className:t.getQuarterClassNames(c),"aria-selected":o?t.isSelectedQuarter(a,c,o):void 0,tabIndex:Number(t.getQuarterTabIndex(c)),"aria-current":t.isCurrentQuarter(a,c)?"date":void 0},t.getQuarterContent(c))}))},t.getClassNames=function(){var r=t.props,a=r.selectingDate,o=r.selectsStart,l=r.selectsEnd,c=r.showMonthYearPicker,f=r.showQuarterYearPicker,h=r.showWeekPicker;return Wr("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(o||l)},{"react-datepicker__monthPicker":c},{"react-datepicker__quarterPicker":f},{"react-datepicker__weekPicker":h})},t}return n.prototype.getSelection=function(){var t=this.props,r=t.selected,a=t.selectedDates,o=t.selectsMultiple;if(o)return a;if(r)return[r]},n.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,a=t.showQuarterYearPicker,o=t.day,l=t.ariaLabelPrefix,c=l===void 0?"Month ":l,f=c?c.trim()+" ":"";return Te.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(f).concat(lr(o,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},n})(N.Component),LP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(r){return t.props.month===r},t.renderOptions=function(){return t.props.monthNames.map(function(r,a){return Te.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?Te.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return n.prototype.render=function(){return Te.createElement(od,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n})(N.Component),BP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(a,o){return Te.createElement("option",{key:a,value:o},a)})},t.renderSelectMode=function(r){return Te.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,a){return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},Te.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(r){return Te.createElement(LP,It({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var a=t.state.dropdownVisible,o=[t.renderReadView(!a,r)];return a&&o.unshift(t.renderDropdown(r)),o},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(o){return ow(o,t.props.locale)}:function(o){return $p(o,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(r);break;case"select":a=this.renderSelectMode(r);break}return Te.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},n})(N.Component);function WP(e,n){for(var t=[],r=Za(e),a=Za(n);!Rs(r,a);)t.push(Kt(r)),r=ca(r,1);return t}var UP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(a){var o=Bf(a),l=wa(r.props.date,a)&&an(r.props.date,a);return Te.createElement("div",{className:l?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:o,onClick:r.onChange.bind(r,o),"aria-selected":l?"true":void 0},l?Te.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",lr(a,r.props.dateFormat,r.props.locale))})},r.onChange=function(a){return r.props.onChange(a)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:WP(r.props.minDate,r.props.maxDate)},r}return n.prototype.render=function(){var t=Wr({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return Te.createElement(od,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(N.Component),$P=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=Za(t.props.minDate),a=Za(t.props.maxDate),o=[];!Rs(r,a);){var l=Bf(r);o.push(Te.createElement("option",{key:l,value:l},lr(r,t.props.dateFormat,t.props.locale))),r=ca(r,1)}return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Te.createElement("select",{value:Bf(Za(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var a=lr(t.props.date,t.props.dateFormat,t.props.locale);return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},Te.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return Te.createElement(UP,It({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown();var a=Kt(r);wa(t.props.date,a)&&an(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Te.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(N.Component),HP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,a,o;t.list&&(t.list.scrollTop=(o=t.centerLi&&n.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&o!==void 0?o:0)})},t.handleClick=function(r){var a,o;(t.props.minTime||t.props.maxTime)&&dv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&uv(r,t.props)||(o=(a=t.props).onChange)===null||o===void 0||o.call(a,r)},t.isSelectedTime=function(r){return t.props.selected&&PP(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&dv(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&uv(r,t.props)},t.liClasses=function(r){var a,o=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&o.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&o.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(Xa(r)*3600+qa(r)*60+js(r))%(((a=t.props.intervals)!==null&&a!==void 0?a:n.defaultProps.intervals)*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")},t.handleOnKeyDown=function(r,a){var o,l;r.key===st.Space&&(r.preventDefault(),r.key=st.Enter),(r.key===st.ArrowUp||r.key===st.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===st.ArrowDown||r.key===st.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===st.Enter&&t.handleClick(a),(l=(o=t.props).handleOnKeyDown)===null||l===void 0||l.call(o,r)},t.renderTimes=function(){for(var r,a=[],o=typeof t.props.format=="string"?t.props.format:"p",l=(r=t.props.intervals)!==null&&r!==void 0?r:n.defaultProps.intervals,c=t.props.selected||t.props.openToDate||Kt(),f=ku(c),h=t.props.injectTimes&&t.props.injectTimes.sort(function(k,T){return k.getTime()-T.getTime()}),p=60*jP(c),m=p/l,g=0;g<m;g++){var v=Mf(f,g*l);if(a.push(v),h){var w=FP(f,v,g,l,h);a=a.concat(w)}}var b=a.reduce(function(k,T){return T.getTime()<=c.getTime()?T:k},a[0]);return a.map(function(k){return Te.createElement("li",{key:k.valueOf(),onClick:t.handleClick.bind(t,k),className:t.liClasses(k),ref:function(T){k===b&&(t.centerLi=T)},onKeyDown:function(T){t.handleOnKeyDown(T,k)},tabIndex:k===b?0:-1,role:"option","aria-selected":t.isSelectedTime(k)?"true":void 0,"aria-disabled":t.isDisabledTime(k)?"true":void 0},lr(k,o,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?Te.createElement(Te.Fragment,null):Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},Te.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var t=this,r,a=this.state.height;return Te.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),Te.createElement("div",{className:"react-datepicker__time"},Te.createElement("div",{className:"react-datepicker__time-box"},Te.createElement("ul",{className:"react-datepicker__time-list",ref:function(o){t.list=o},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},n})(N.Component),bv=3,YP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.YEAR_REFS=Ea([],Array(r.props.yearItemNumber),!0).map(function(){return N.createRef()}),r.isDisabled=function(a){return $n(a,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(a){return Hp(a,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var a;return(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection},r.updateFocusOnPaginate=function(a){var o=function(){var l,c;(c=(l=r.YEAR_REFS[a])===null||l===void 0?void 0:l.current)===null||c===void 0||c.focus()};window.requestAnimationFrame(o)},r.handleYearClick=function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)},r.handleYearNavigation=function(a,o){var l,c,f,h,p=r.props,m=p.date,g=p.yearItemNumber;if(!(m===void 0||g===void 0)){var v=Ds(m,g).startPeriod;r.isDisabled(o)||r.isExcluded(o)||((c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,o),a-v<0?r.updateFocusOnPaginate(g-(v-a)):a-v>=g?r.updateFocusOnPaginate(Math.abs(g-(a-v))):(h=(f=r.YEAR_REFS[a-v])===null||f===void 0?void 0:f.current)===null||h===void 0||h.focus())}},r.isSameDay=function(a,o){return Mt(a,o)},r.isCurrentYear=function(a){return a===Tt(Kt())},r.isRangeStart=function(a){return r.props.startDate&&r.props.endDate&&wa(ya(Kt(),a),r.props.startDate)},r.isRangeEnd=function(a){return r.props.startDate&&r.props.endDate&&wa(ya(Kt(),a),r.props.endDate)},r.isInRange=function(a){return fu(a,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(a){var o=r.props,l=o.selectsStart,c=o.selectsEnd,f=o.selectsRange,h=o.startDate,p=o.endDate;return!(l||c||f)||!r.selectingDate()?!1:l&&p?fu(a,r.selectingDate(),p):c&&h||f&&h&&!p?fu(a,h,r.selectingDate()):!1},r.isSelectingRangeStart=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.startDate,f=l.selectsStart,h=ya(Kt(),a);return f?wa(h,(o=r.selectingDate())!==null&&o!==void 0?o:null):wa(h,c??null)},r.isSelectingRangeEnd=function(a){var o;if(!r.isInSelectingRange(a))return!1;var l=r.props,c=l.endDate,f=l.selectsEnd,h=l.selectsRange,p=ya(Kt(),a);return f||h?wa(p,(o=r.selectingDate())!==null&&o!==void 0?o:null):wa(p,c??null)},r.isKeyboardSelected=function(a){if(!(r.props.date===void 0||r.props.selected==null||r.props.preSelection==null)){var o=r.props,l=o.minDate,c=o.maxDate,f=o.excludeDates,h=o.includeDates,p=o.filterDate,m=ll(ya(r.props.date,a)),g=(l||c||f||h||p)&&bu(a,r.props);return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Mt(m,ll(r.props.selected))&&Mt(m,ll(r.props.preSelection))&&!g}},r.isSelectedYear=function(a){var o=r.props,l=o.selectsMultiple,c=o.selected,f=o.selectedDates;return l?f?.some(function(h){return a===Tt(h)}):!c||a===Tt(c)},r.onYearClick=function(a,o){var l=r.props.date;l!==void 0&&r.handleYearClick(ll(ya(l,o)),a)},r.onYearKeyDown=function(a,o){var l,c,f=a.key,h=r.props,p=h.date,m=h.yearItemNumber,g=h.handleOnKeyDown;if(f!==st.Tab&&a.preventDefault(),!r.props.disabledKeyboardNavigation)switch(f){case st.Enter:if(r.props.selected==null)break;r.onYearClick(a,o),(c=(l=r.props).setPreSelection)===null||c===void 0||c.call(l,r.props.selected);break;case st.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(o+1,Ga(r.props.preSelection,1));break;case st.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(o-1,fi(r.props.preSelection,1));break;case st.ArrowUp:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var v=Ds(p,m).startPeriod,w=bv,b=o-w;if(b<v){var k=m%w;o>=v&&o<v+k?w=k:w+=k,b=o-w}r.handleYearNavigation(b,fi(r.props.preSelection,w));break}case st.ArrowDown:{if(p===void 0||m===void 0||r.props.preSelection==null)break;var T=Ds(p,m).endPeriod,w=bv,b=o+w;if(b>T){var k=m%w;o<=T&&o>T-k?w=k:w+=k,b=o+w}r.handleYearNavigation(b,Ga(r.props.preSelection,w));break}}g&&g(a)},r.getYearClassNames=function(a){var o=r.props,l=o.date,c=o.minDate,f=o.maxDate,h=o.excludeDates,p=o.includeDates,m=o.filterDate,g=o.yearClassName;return Wr("react-datepicker__year-text","react-datepicker__year-".concat(a),l?g?.(ya(l,a)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(a),"react-datepicker__year-text--disabled":(c||f||h||p||m)&&bu(a,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(a),"react-datepicker__year-text--range-start":r.isRangeStart(a),"react-datepicker__year-text--range-end":r.isRangeEnd(a),"react-datepicker__year-text--in-range":r.isInRange(a),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(a),"react-datepicker__year-text--today":r.isCurrentYear(a)})},r.getYearTabIndex=function(a){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var o=Tt(r.props.preSelection),l=bu(a,r.props);return a===o&&!l?"0":"-1"},r.getYearContent=function(a){return r.props.renderYearContent?r.props.renderYearContent(a):a},r}return n.prototype.render=function(){var t=this,r=[],a=this.props,o=a.date,l=a.yearItemNumber,c=a.onYearMouseEnter,f=a.onYearMouseLeave;if(o===void 0)return null;for(var h=Ds(o,l),p=h.startPeriod,m=h.endPeriod,g=function(b){r.push(Te.createElement("div",{ref:v.YEAR_REFS[b-p],onClick:function(k){t.onYearClick(k,b)},onKeyDown:function(k){uw(k)&&(k.preventDefault(),k.key=st.Enter),t.onYearKeyDown(k,b)},tabIndex:Number(v.getYearTabIndex(b)),className:v.getYearClassNames(b),onMouseEnter:v.props.usePointerEvent?void 0:function(k){return c(k,b)},onPointerEnter:v.props.usePointerEvent?function(k){return c(k,b)}:void 0,onMouseLeave:v.props.usePointerEvent?void 0:function(k){return f(k,b)},onPointerLeave:v.props.usePointerEvent?function(k){return f(k,b)}:void 0,key:b,"aria-current":v.isCurrentYear(b)?"date":void 0},v.getYearContent(b)))},v=this,w=p;w<=m;w++)g(w);return Te.createElement("div",{className:"react-datepicker__year"},Te.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},n})(N.Component);function VP(e,n,t,r){for(var a=[],o=0;o<2*n+1;o++){var l=e+n-o,c=!0;t&&(c=Tt(t)<=l),r&&c&&(c=Tt(r)>=l),c&&a.push(l)}return a}var KP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;r.renderOptions=function(){var c=r.props.year,f=r.state.yearsList.map(function(m){return Te.createElement("div",{className:c===m?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:m,onClick:r.onChange.bind(r,m),"aria-selected":c===m?"true":void 0},c===m?Te.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",m)}),h=r.props.minDate?Tt(r.props.minDate):null,p=r.props.maxDate?Tt(r.props.maxDate):null;return(!p||!r.state.yearsList.find(function(m){return m===p}))&&f.unshift(Te.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!h||!r.state.yearsList.find(function(m){return m===h}))&&f.push(Te.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},Te.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),f},r.onChange=function(c){r.props.onChange(c)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(c){var f=r.state.yearsList.map(function(h){return h+c});r.setState({yearsList:f})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var a=t.yearDropdownItemNumber,o=t.scrollableYearDropdown,l=a||(o?10:5);return r.state={yearsList:VP(r.props.year,l,r.props.minDate,r.props.maxDate)},r.dropdownRef=N.createRef(),r}return n.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,a=r?r.find(function(o){return o.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},n.prototype.render=function(){var t=Wr({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return Te.createElement(od,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n})(N.Component),GP=(function(e){Mr(n,e);function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?Tt(t.props.minDate):1900,a=t.props.maxDate?Tt(t.props.maxDate):2100,o=[],l=r;l<=a;l++)o.push(Te.createElement("option",{key:l,value:l},l));return o},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return Te.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return Te.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},Te.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),Te.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return Te.createElement(KP,It({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,a=[t.renderReadView(!r)];return r&&a.unshift(t.renderDropdown()),a},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,a){var o;(o=t.onSelect)===null||o===void 0||o.call(t,r,a),t.setOpen()},t.onSelect=function(r,a){var o,l;(l=(o=t.props).onSelect)===null||l===void 0||l.call(o,r,a)},t.setOpen=function(){var r,a;(a=(r=t.props).setOpen)===null||a===void 0||a.call(r,!0)},t}return n.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return Te.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},n})(N.Component),QP=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],XP=function(e){var n=(e.className||"").split(/\s+/);return QP.some(function(t){return n.indexOf(t)>=0})},qP=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(a){r.props.onClickOutside(a)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(a){var o,l;XP(a.target)&&((l=(o=r.props).onDropdownFocus)===null||l===void 0||l.call(o,a))},r.getDateInView=function(){var a=r.props,o=a.preSelection,l=a.selected,c=a.openToDate,f=lw(r.props),h=cw(r.props),p=Kt(),m=c||l||o;return m||(f&&xo(p,f)?f:h&&Rs(p,h)?h:p)},r.increaseMonth=function(){r.setState(function(a){var o=a.date;return{date:ca(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(a){var o=a.date;return{date:io(o,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(a,o,l){r.props.onSelect(a,o,l),r.props.setPreSelection&&r.props.setPreSelection(a)},r.handleDayMouseEnter=function(a){r.setState({selectingDate:a}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(a,o){r.setState({selectingDate:ya(Kt(),o)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(a,o)},r.handleYearMouseLeave=function(a,o){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(a,o)},r.handleYearChange=function(a){var o,l,c,f;(l=(o=r.props).onYearChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(a),(f=(c=r.props).setOpen)===null||f===void 0||f.call(c,!0)),r.props.setPreSelection&&r.props.setPreSelection(a)},r.getEnabledPreSelectionDateForMonth=function(a){if(!$n(a,r.props))return a;for(var o=Za(a),l=vP(a),c=Q4(l,o),f=null,h=0;h<=c;h++){var p=la(o,h);if(!$n(p,r.props)){f=p;break}}return f},r.handleMonthChange=function(a){var o,l,c,f=(o=r.getEnabledPreSelectionDateForMonth(a))!==null&&o!==void 0?o:a;r.handleCustomMonthChange(f),r.props.adjustDateOnChange&&(r.props.onSelect(f),(c=(l=r.props).setOpen)===null||c===void 0||c.call(l,!0)),r.props.setPreSelection&&r.props.setPreSelection(f)},r.handleCustomMonthChange=function(a){var o,l;(l=(o=r.props).onMonthChange)===null||l===void 0||l.call(o,a),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(a){r.handleYearChange(a),r.handleMonthChange(a)},r.changeYear=function(a){r.setState(function(o){var l=o.date;return{date:ya(l,Number(a))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(a){r.setState(function(o){var l=o.date;return{date:Un(l,Number(a))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(a){r.setState(function(o){var l=o.date;return{date:ya(Un(l,cn(a)),Tt(a))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(a){a===void 0&&(a=r.state.date);var o=Ps(a,r.props.locale,r.props.calendarStartDay),l=[];return r.props.showWeekNumbers&&l.push(Te.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),l.concat([0,1,2,3,4,5,6].map(function(c){var f=la(o,c),h=r.formatWeekday(f,r.props.locale),p=r.props.weekDayClassName?r.props.weekDayClassName(f):void 0;return Te.createElement("div",{key:c,"aria-label":lr(f,"EEEE",r.props.locale),className:Wr("react-datepicker__day-name",p)},h)}))},r.formatWeekday=function(a,o){return r.props.formatWeekDay?yP(a,r.props.formatWeekDay,o):r.props.useWeekdaysShort?kP(a,o):wP(a,o)},r.decreaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:fi(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var a,o,l;if(!r.props.renderCustomHeader){var c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,p=io(r.state.date,h),m;switch(!0){case r.props.showMonthYearPicker:m=hv(r.state.date,r.props);break;case r.props.showYearPicker:m=NP(r.state.date,r.props);break;case r.props.showQuarterYearPicker:m=SP(r.state.date,r.props);break;default:m=fv(p,r.props);break}if(!(!((l=r.props.forceShowMonthNavigation)!==null&&l!==void 0?l:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&m||r.props.showTimeSelectOnly)){var g=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],v=["react-datepicker__navigation","react-datepicker__navigation--previous"],w=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(w=r.decreaseYear),m&&r.props.showDisabledMonthNavigation&&(v.push("react-datepicker__navigation--previous--disabled"),w=void 0);var b=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,k=r.props,T=k.previousMonthButtonLabel,j=T===void 0?n.defaultProps.previousMonthButtonLabel:T,C=k.previousYearButtonLabel,W=C===void 0?n.defaultProps.previousYearButtonLabel:C,J=r.props,V=J.previousMonthAriaLabel,P=V===void 0?typeof j=="string"?j:"Previous Month":V,U=J.previousYearAriaLabel,B=U===void 0?typeof W=="string"?W:"Previous Year":U;return Te.createElement("button",{type:"button",className:v.join(" "),onClick:w,onKeyDown:r.props.handleOnKeyDown,"aria-label":b?B:P},Te.createElement("span",{className:g.join(" ")},b?W:j))}}},r.increaseYear=function(){r.setState(function(a){var o,l=a.date;return{date:Ga(l,r.props.showYearPicker?(o=r.props.yearItemNumber)!==null&&o!==void 0?o:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var a;if(!r.props.renderCustomHeader){var o;switch(!0){case r.props.showMonthYearPicker:o=xv(r.state.date,r.props);break;case r.props.showYearPicker:o=CP(r.state.date,r.props);break;case r.props.showQuarterYearPicker:o=EP(r.state.date,r.props);break;default:o=pv(r.state.date,r.props);break}if(!(!((a=r.props.forceShowMonthNavigation)!==null&&a!==void 0?a:n.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&o||r.props.showTimeSelectOnly)){var l=["react-datepicker__navigation","react-datepicker__navigation--next"],c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&l.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&l.push("react-datepicker__navigation--next--with-today-button");var f=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(f=r.increaseYear),o&&r.props.showDisabledMonthNavigation&&(l.push("react-datepicker__navigation--next--disabled"),f=void 0);var h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,m=p.nextMonthButtonLabel,g=m===void 0?n.defaultProps.nextMonthButtonLabel:m,v=p.nextYearButtonLabel,w=v===void 0?n.defaultProps.nextYearButtonLabel:v,b=r.props,k=b.nextMonthAriaLabel,T=k===void 0?typeof g=="string"?g:"Next Month":k,j=b.nextYearAriaLabel,C=j===void 0?typeof w=="string"?w:"Next Year":j;return Te.createElement("button",{type:"button",className:l.join(" "),onClick:f,onKeyDown:r.props.handleOnKeyDown,"aria-label":h?C:T},Te.createElement("span",{className:c.join(" ")},h?w:g))}}},r.renderCurrentMonth=function(a){a===void 0&&(a=r.state.date);var o=["react-datepicker__current-month"];return r.props.showYearDropdown&&o.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&o.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&o.push("react-datepicker__current-month--hasMonthYearDropdown"),Te.createElement("h2",{className:o.join(" ")},lr(a,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showYearDropdown||a))return Te.createElement(GP,It({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:Tt(r.state.date)}))},r.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthDropdown||a))return Te.createElement(BP,It({},n.defaultProps,r.props,{month:cn(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!r.props.showMonthYearDropdown||a))return Te.createElement($P,It({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(a){r.props.onSelect(iv(),a),r.props.setPreSelection&&r.props.setPreSelection(iv())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return Te.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDefaultHeader=function(a){var o=a.monthDate,l=a.i;return Te.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(o),Te.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(l!==0),r.renderMonthYearDropdown(l!==0),r.renderYearDropdown(l!==0)),Te.createElement("div",{className:"react-datepicker__day-names"},r.header(o)))},r.renderCustomHeader=function(a){var o,l,c=a.monthDate,f=a.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var h=fv(r.state.date,r.props),p=pv(r.state.date,r.props),m=hv(r.state.date,r.props),g=xv(r.state.date,r.props),v=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return Te.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(l=(o=r.props).renderCustomHeader)===null||l===void 0?void 0:l.call(o,It(It({},r.state),{customHeaderCount:f,monthDate:c,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:p,prevYearButtonDisabled:m,nextYearButtonDisabled:g})),v&&Te.createElement("div",{className:"react-datepicker__day-names"},r.header(c)))},r.renderYearHeader=function(a){var o=a.monthDate,l=r.props,c=l.showYearPicker,f=l.yearItemNumber,h=f===void 0?n.defaultProps.yearItemNumber:f,p=Ds(o,h),m=p.startPeriod,g=p.endPeriod;return Te.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},c?"".concat(m," - ").concat(g):Tt(o))},r.renderHeader=function(a){var o=a.monthDate,l=a.i,c=l===void 0?0:l,f={monthDate:o,i:c};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(f);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(f);default:return r.renderDefaultHeader(f)}},r.renderMonths=function(){var a,o;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var l=[],c=(a=r.props.monthsShown)!==null&&a!==void 0?a:n.defaultProps.monthsShown,f=r.props.showPreviousMonths?c-1:0,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ga(r.state.date,f):io(r.state.date,f),p=(o=r.props.monthSelectedIn)!==null&&o!==void 0?o:f,m=0;m<c;++m){var g=m-p+f,v=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Ga(h,g):ca(h,g),w="month-".concat(m),b=m<c-1,k=m>0;l.push(Te.createElement("div",{key:w,ref:function(T){r.monthContainer=T??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:v,i:m}),Te.createElement(IP,It({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:v,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:m,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:b,monthShowsDuplicateDaysStart:k}))))}return l}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return Te.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),Te.createElement(YP,It({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return Te.createElement(HP,It({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var a=r.props.selected?new Date(r.props.selected):void 0,o=a&&id(a)&&!!r.props.selected,l=o?"".concat(gv(a.getHours()),":").concat(gv(a.getMinutes())):"";if(r.props.showTimeInput)return Te.createElement(AP,It({},n.defaultProps,r.props,{date:a,timeString:l,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var a,o=Ds(r.state.date,(a=r.props.yearItemNumber)!==null&&a!==void 0?a:n.defaultProps.yearItemNumber),l=o.startPeriod,c=o.endPeriod,f;return r.props.showYearPicker?f="".concat(l," - ").concat(c):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?f=Tt(r.state.date):f="".concat($p(cn(r.state.date),r.props.locale)," ").concat(Tt(r.state.date)),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&f)},r.renderChildren=function(){if(r.props.children)return Te.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=N.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:Ul}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},n.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!Mt(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!an(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!Mt(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},n.prototype.render=function(){var t=this.props.container||dP;return Te.createElement(od,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},Te.createElement("div",{style:{display:"contents"},ref:this.containerRef},Te.createElement(t,{className:Wr("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n})(N.Component),ZP=function(e){var n=e.icon,t=e.className,r=t===void 0?"":t,a=e.onClick,o="react-datepicker__calendar-icon";if(typeof n=="string")return Te.createElement("i",{className:"".concat(o," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:a});if(Te.isValidElement(n)){var l=n;return Te.cloneElement(l,{className:"".concat(l.props.className||""," ").concat(o," ").concat(r),onClick:function(c){typeof l.props.onClick=="function"&&l.props.onClick(c),typeof a=="function"&&a(c)}})}return Te.createElement("svg",{className:"".concat(o," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},Te.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},dw=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return n.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},n.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},n.prototype.render=function(){return Ej.createPortal(this.props.children,this.el)},n})(N.Component),JP="[tabindex], a, button, input, select, textarea",eA=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&e.tabIndex!==-1},fw=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.getTabChildren=function(){var a;return Array.prototype.slice.call((a=r.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(JP),1,-1).filter(eA)},r.handleFocusStart=function(){var a=r.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},r.handleFocusEnd=function(){var a=r.getTabChildren();a&&a.length>1&&a[0].focus()},r.tabLoopRef=N.createRef(),r}return n.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:n.defaultProps.enableTabLoop)?Te.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},Te.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,Te.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n})(N.Component);function tA(e){var n=function(t){var r,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,o=N.useRef(null),l=uP(It({open:!a,whileElementsMounted:tw,placement:t.popperPlacement,middleware:Ea([qj({padding:15}),Xj(10),Zj({element:o})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),c=It(It({},t),{hidePopper:a,popperProps:It(It({},l),{arrowRef:o})});return Te.createElement(e,It({},c))};return n}var rA=(function(e){Mr(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(n,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var t=this.props,r=t.className,a=t.wrapperClassName,o=t.hidePopper,l=o===void 0?n.defaultProps.hidePopper:o,c=t.popperComponent,f=t.targetComponent,h=t.enableTabLoop,p=t.popperOnKeyDown,m=t.portalId,g=t.portalHost,v=t.popperProps,w=t.showArrow,b=void 0;if(!l){var k=Wr("react-datepicker-popper",r);b=Te.createElement(fw,{enableTabLoop:h},Te.createElement("div",{ref:v.refs.setFloating,style:v.floatingStyles,className:k,"data-placement":v.placement,onKeyDown:p},c,w&&Te.createElement(nP,{ref:v.arrowRef,context:v.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(b=N.createElement(this.props.popperContainer,{},b)),m&&!l&&(b=Te.createElement(dw,{portalId:m,portalHost:g},b));var T=Wr("react-datepicker-wrapper",a);return Te.createElement(Te.Fragment,null,Te.createElement("div",{ref:v.refs.setReference,className:T},f),b)},n})(N.Component),nA=tA(rA),_v="react-datepicker-ignore-onclickoutside";function aA(e,n){return e&&n?cn(e)!==cn(n)||Tt(e)!==Tt(n):e!==n}var xf="Date input not valid.",wn=(function(e){Mr(n,e);function n(t){var r=e.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Kt()},r.modifyHolidays=function(){var a;return(a=r.props.holidays)===null||a===void 0?void 0:a.reduce(function(o,l){var c=new Date(l.date);return id(c)?Ea(Ea([],o,!0),[It(It({},l),{date:c})],!1):o},[])},r.calcInitialState=function(){var a,o=r.getPreSelection(),l=lw(r.props),c=cw(r.props),f=l&&xo(o,ku(l))?l:c&&Rs(o,lv(c))?c:o;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&a!==void 0?a:f,highlightDates:mv(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.resetHiddenStatus=function(){r.setState(It(It({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(It(It({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.focus)===null||o===void 0||o.call(a,{preventScroll:!0})},r.setBlur=function(){var a,o;(o=(a=r.input)===null||a===void 0?void 0:a.blur)===null||o===void 0||o.call(a),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(a,o){o===void 0&&(o=!1),r.setState({open:a,preSelection:a&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:mf},function(){a||r.setState(function(l){return{focused:o?l.focused:!1}},function(){!o&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Qa(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(a){var o,l,c=r.state.wasHidden,f=c?r.state.open:!0;c&&r.resetHiddenStatus(),r.state.preventFocus||((l=(o=r.props).onFocus)===null||l===void 0||l.call(o,a),f&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.handleBlur=function(a){var o,l;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((l=(o=r.props).onBlur)===null||l===void 0||l.call(o,a)),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(a){var o,l;r.props.inline||r.setOpen(!1),(l=(o=r.props).onClickOutside)===null||l===void 0||l.call(o,a),r.props.withPortal&&a.preventDefault()},r.handleChange=function(){for(var a,o,l,c,f,h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];var m=h[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,h),!m||typeof m.isDefaultPrevented!="function"||m.isDefaultPrevented()))){r.setState({inputValue:m?.target instanceof HTMLInputElement?m.target.value:null,lastPreSelectChange:sA});var g=r.props,v=g.selectsRange,w=g.startDate,b=g.endDate,k=(a=r.props.dateFormat)!==null&&a!==void 0?a:n.defaultProps.dateFormat,T=(o=r.props.strictParsing)!==null&&o!==void 0?o:n.defaultProps.strictParsing,j=m?.target instanceof HTMLInputElement?m.target.value:"";if(v){var C=j.split("-",2).map(function(ee){return ee.trim()}),W=C[0],J=C[1],V=ff(W??"",k,r.props.locale,T),P=ff(J??"",k,r.props.locale,T),U=w?.getTime()!==V?.getTime(),B=b?.getTime()!==P?.getTime();if(!U&&!B||V&&$n(V,r.props)||P&&$n(P,r.props))return;(c=(l=r.props).onChange)===null||c===void 0||c.call(l,[V,P],m)}else{var ne=ff(j,k,r.props.locale,T,(f=r.props.selected)!==null&&f!==void 0?f:void 0);(ne||!j)&&r.setSelected(ne,m,!0)}}},r.handleSelect=function(a,o,l){if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(o),r.setSelected(a,o,!1,l),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(a);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var c=r.props,f=c.startDate,h=c.endDate;f&&!h&&(r.props.swapRange||!wv(a,f))&&r.setOpen(!1)}},r.setSelected=function(a,o,l,c){var f,h,p=a;if(r.props.showYearPicker){if(p!==null&&bu(Tt(p),r.props))return}else if(r.props.showMonthYearPicker){if(p!==null&&iw(p,r.props))return}else if(p!==null&&$n(p,r.props))return;var m=r.props,g=m.onChange,v=m.selectsRange,w=m.startDate,b=m.endDate,k=m.selectsMultiple,T=m.selectedDates,j=m.minTime,C=m.swapRange;if(!ro(r.props.selected,p)||r.props.allowSameDay||v||k)if(p!==null&&(r.props.selected&&(!l||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(p=pf(p,{hour:Xa(r.props.selected),minute:qa(r.props.selected),second:js(r.props.selected)})),!l&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&j&&(p=pf(p,{hour:j.getHours(),minute:j.getMinutes(),second:j.getSeconds()})),r.props.inline||r.setState({preSelection:p}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:c})),v){var W=!w&&!b,J=w&&!b,V=w&&b;W?g?.([p,null],o):J&&(p===null?g?.([null,null],o):wv(p,w)?g?.(C?[p,w]:[p,null],o):g?.([w,p],o)),V&&g?.([p,null],o)}else if(k){if(p!==null)if(!T?.length)g?.([p],o);else{var P=T.some(function(B){return Mt(B,p)});if(P){var U=T.filter(function(B){return!Mt(B,p)});g?.(U,o)}else g?.(Ea(Ea([],T,!0),[p],!1),o)}}else g?.(p,o);l||((h=(f=r.props).onSelect)===null||h===void 0||h.call(f,p,o),r.setState({inputValue:null}))},r.setPreSelection=function(a){var o=Qa(r.props.minDate),l=Qa(r.props.maxDate),c=!0;if(a){var f=ku(a);if(o&&l)c=cl(a,r.props.minDate,r.props.maxDate);else if(o){var h=ku(r.props.minDate);c=Rs(a,h)||ro(f,h)}else if(l){var p=lv(r.props.maxDate);c=xo(a,p)||ro(f,p)}}c&&r.setState({preSelection:a})},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(a){var o,l;if(!(r.props.selectsRange||r.props.selectsMultiple)){var c=r.props.selected?r.props.selected:r.getPreSelection(),f=r.props.selected?a:pf(c,{hour:Xa(a),minute:qa(a)});r.setState({preSelection:f}),(l=(o=r.props).onChange)===null||l===void 0||l.call(o,f),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var a,o;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(o=(a=r.props).onInputClick)===null||o===void 0||o.call(a)},r.onInputKeyDown=function(a){var o,l,c,f,h,p;(l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a);var m=a.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(m===st.ArrowDown||m===st.ArrowUp||m===st.Enter)&&((c=r.onInputClick)===null||c===void 0||c.call(r));return}if(r.state.open){if(m===st.ArrowDown||m===st.ArrowUp){a.preventDefault();var g=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',v=((f=r.calendar)===null||f===void 0?void 0:f.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(g);v instanceof HTMLElement&&v.focus({preventScroll:!0});return}var w=Kt(r.state.preSelection);m===st.Enter?(a.preventDefault(),a.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===mf?(r.handleSelect(w,a),!r.props.shouldCloseOnSelect&&r.setPreSelection(w)):r.setOpen(!1)):m===st.Escape?(a.preventDefault(),a.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):m===st.Tab&&r.setOpen(!1),r.inputOk()||(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:xf})}},r.onPortalKeyDown=function(a){var o=a.key;o===st.Escape&&(a.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(a){var o,l,c,f,h,p,m=r.props,g=m.minDate,v=m.maxDate,w=m.disabledKeyboardNavigation,b=m.showWeekPicker,k=m.shouldCloseOnSelect,T=m.locale,j=m.calendarStartDay,C=m.adjustDateOnChange,W=m.inline;if((l=(o=r.props).onKeyDown)===null||l===void 0||l.call(o,a),!w){var J=a.key,V=a.shiftKey,P=Kt(r.state.preSelection),U=function(oe,he){var X=he;switch(oe){case st.ArrowRight:X=b?zu(he,1):la(he,1);break;case st.ArrowLeft:X=b?Zg(he):QF(he);break;case st.ArrowUp:X=Zg(he);break;case st.ArrowDown:X=zu(he,1);break;case st.PageUp:X=V?fi(he,1):io(he,1);break;case st.PageDown:X=V?Ga(he,1):ca(he,1);break;case st.Home:X=Ps(he,T,j);break;case st.End:X=gP(he);break}return X},B=function(oe,he){for(var X=40,le=oe,z=!1,se=0,R=U(oe,he);!z;){if(se>=X){R=he;break}g&&R<g&&(le=st.ArrowRight,R=$n(g,r.props)?U(le,R):g),v&&R>v&&(le=st.ArrowLeft,R=$n(v,r.props)?U(le,R):v),$n(R,r.props)?((le===st.PageUp||le===st.Home)&&(le=st.ArrowRight),(le===st.PageDown||le===st.End)&&(le=st.ArrowLeft),R=U(le,R)):z=!0,se++}return R};if(J===st.Enter){a.preventDefault(),r.handleSelect(P,a),!k&&r.setPreSelection(P);return}else if(J===st.Escape){a.preventDefault(),r.setOpen(!1),r.inputOk()||(f=(c=r.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:xf});return}var ne=null;switch(J){case st.ArrowLeft:case st.ArrowRight:case st.ArrowUp:case st.ArrowDown:case st.PageUp:case st.PageDown:case st.Home:case st.End:ne=B(J,P);break}if(!ne){(p=(h=r.props).onInputError)===null||p===void 0||p.call(h,{code:1,msg:xf});return}if(a.preventDefault(),r.setState({lastPreSelectChange:mf}),C&&r.setSelected(ne),r.setPreSelection(ne),W){var ee=cn(P),Y=cn(ne),fe=Tt(P),de=Tt(ne);ee!==Y||fe!==de?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(a){var o=a.key;o===st.Escape&&(a.preventDefault(),r.sendFocusBackToInput())},r.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),r.sendFocusBackToInput();var o=r.props,l=o.selectsRange,c=o.onChange;c?.(l?[null,null]:null,a),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(a){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(a)&&r.setOpen(!1)},r.renderCalendar=function(){var a,o;return!r.props.inline&&!r.isCalendarOpen()?null:Te.createElement(qP,It({showMonthYearDropdown:void 0,ref:function(l){r.calendar=l}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(a=r.props.dateFormatCalendar)!==null&&a!==void 0?a:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:DP(r.modifyHolidays()),outsideClickIgnoreClass:_v,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(o=r.props.dropdownMode)!==null&&o!==void 0?o:n.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var a=r.props,o=a.dateFormat,l=o===void 0?n.defaultProps.dateFormat:o,c=a.locale,f=r.props.showTimeInput||r.props.showTimeSelect,h=f?"PPPPp":"PPPP",p;return r.props.selectsRange?p="Selected start date: ".concat(Wn(r.props.startDate,{dateFormat:h,locale:c}),". ").concat(r.props.endDate?"End date: "+Wn(r.props.endDate,{dateFormat:h,locale:c}):""):r.props.showTimeSelectOnly?p="Selected time: ".concat(Wn(r.props.selected,{dateFormat:l,locale:c})):r.props.showYearPicker?p="Selected year: ".concat(Wn(r.props.selected,{dateFormat:"yyyy",locale:c})):r.props.showMonthYearPicker?p="Selected month: ".concat(Wn(r.props.selected,{dateFormat:"MMMM yyyy",locale:c})):r.props.showQuarterYearPicker?p="Selected quarter: ".concat(Wn(r.props.selected,{dateFormat:"yyyy, QQQ",locale:c})):p="Selected date: ".concat(Wn(r.props.selected,{dateFormat:h,locale:c})),Te.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},p)},r.renderDateInput=function(){var a,o,l,c=Wr(r.props.className,(a={},a[_v]=r.state.open,a)),f=r.props.customInput||Te.createElement("input",{type:"text"}),h=r.props.customInputRef||"ref",p=r.props,m=p.dateFormat,g=m===void 0?n.defaultProps.dateFormat:m,v=p.locale,w=typeof r.props.value=="string"?r.props.value:typeof r.state.inputValue=="string"?r.state.inputValue:r.props.selectsRange?pP(r.props.startDate,r.props.endDate,{dateFormat:g,locale:v}):r.props.selectsMultiple?hP((l=r.props.selectedDates)!==null&&l!==void 0?l:[],{dateFormat:g,locale:v}):Wn(r.props.selected,{dateFormat:g,locale:v});return N.cloneElement(f,(o={},o[h]=function(b){r.input=b},o.value=w,o.onBlur=r.handleBlur,o.onChange=r.handleChange,o.onClick=r.onInputClick,o.onFocus=r.handleFocus,o.onKeyDown=r.onInputKeyDown,o.id=r.props.id,o.name=r.props.name,o.form=r.props.form,o.autoFocus=r.props.autoFocus,o.placeholder=r.props.placeholderText,o.disabled=r.props.disabled,o.autoComplete=r.props.autoComplete,o.className=Wr(f.props.className,c),o.title=r.props.title,o.readOnly=r.props.readOnly,o.required=r.props.required,o.tabIndex=r.props.tabIndex,o["aria-describedby"]=r.props.ariaDescribedBy,o["aria-invalid"]=r.props.ariaInvalid,o["aria-labelledby"]=r.props.ariaLabelledBy,o["aria-required"]=r.props.ariaRequired,o))},r.renderClearButton=function(){var a=r.props,o=a.isClearable,l=a.disabled,c=a.selected,f=a.startDate,h=a.endDate,p=a.clearButtonTitle,m=a.clearButtonClassName,g=m===void 0?"":m,v=a.ariaLabelClose,w=v===void 0?"Close":v,b=a.selectedDates;return o&&(c!=null||f!=null||h!=null||b?.length)?Te.createElement("button",{type:"button",className:Wr("react-datepicker__close-icon",g,{"react-datepicker__close-icon--disabled":l}),disabled:l,"aria-label":w,onClick:r.onClearClick,title:p,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:Ul,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(t,r){var a,o,l,c;t.inline&&aA(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:mv(this.props.highlightDates)}),!r.focused&&!ro(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((o=(a=this.props).onCalendarOpen)===null||o===void 0||o.call(a)),r.open===!0&&this.state.open===!1&&((c=(l=this.props).onCalendarClose)===null||c===void 0||c.call(l)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,a=t.icon,o=t.calendarIconClassname,l=t.calendarIconClassName,c=t.toggleCalendarOnIconClick,f=this.state.open;return o&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),Te.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&Te.createElement(ZP,It({icon:a,className:Wr(l,!l&&o,f&&"react-datepicker-ignore-onclickoutside")},c?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?Te.createElement(fw,{enableTabLoop:this.props.enableTabLoop},Te.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=Te.createElement(dw,It({portalId:this.props.portalId},this.props),r)),Te.createElement("div",null,this.renderInputContainer(),r)}return Te.createElement(nA,It({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n})(N.Component),sA="input",mf="navigate";const oA={lessThanXSeconds:{one:{regular:"mniej ni sekunda",past:"mniej ni sekund",future:"mniej ni sekund"},twoFour:"mniej ni {{count}} sekundy",other:"mniej ni {{count}} sekund"},xSeconds:{one:{regular:"sekunda",past:"sekund",future:"sekund"},twoFour:"{{count}} sekundy",other:"{{count}} sekund"},halfAMinute:{one:"p minuty",twoFour:"p minuty",other:"p minuty"},lessThanXMinutes:{one:{regular:"mniej ni minuta",past:"mniej ni minut",future:"mniej ni minut"},twoFour:"mniej ni {{count}} minuty",other:"mniej ni {{count}} minut"},xMinutes:{one:{regular:"minuta",past:"minut",future:"minut"},twoFour:"{{count}} minuty",other:"{{count}} minut"},aboutXHours:{one:{regular:"okoo godziny",past:"okoo godziny",future:"okoo godzin"},twoFour:"okoo {{count}} godziny",other:"okoo {{count}} godzin"},xHours:{one:{regular:"godzina",past:"godzin",future:"godzin"},twoFour:"{{count}} godziny",other:"{{count}} godzin"},xDays:{one:{regular:"dzie",past:"dzie",future:"1 dzie"},twoFour:"{{count}} dni",other:"{{count}} dni"},aboutXWeeks:{one:"okoo tygodnia",twoFour:"okoo {{count}} tygodni",other:"okoo {{count}} tygodni"},xWeeks:{one:"tydzie",twoFour:"{{count}} tygodnie",other:"{{count}} tygodni"},aboutXMonths:{one:"okoo miesic",twoFour:"okoo {{count}} miesice",other:"okoo {{count}} miesicy"},xMonths:{one:"miesic",twoFour:"{{count}} miesice",other:"{{count}} miesicy"},aboutXYears:{one:"okoo rok",twoFour:"okoo {{count}} lata",other:"okoo {{count}} lat"},xYears:{one:"rok",twoFour:"{{count}} lata",other:"{{count}} lat"},overXYears:{one:"ponad rok",twoFour:"ponad {{count}} lata",other:"ponad {{count}} lat"},almostXYears:{one:"prawie rok",twoFour:"prawie {{count}} lata",other:"prawie {{count}} lat"}};function iA(e,n){if(n===1)return e.one;const t=n%100;if(t<=20&&t>10)return e.other;const r=t%10;return r>=2&&r<=4?e.twoFour:e.other}function gf(e,n,t){const r=iA(e,n);return(typeof r=="string"?r:r[t]).replace("{{count}}",String(n))}const lA=(e,n,t)=>{const r=oA[e];return t?.addSuffix?t.comparison&&t.comparison>0?"za "+gf(r,n,"future"):gf(r,n,"past")+" temu":gf(r,n,"regular")},cA={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},uA={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},dA={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fA={date:si({formats:cA,defaultWidth:"full"}),time:si({formats:uA,defaultWidth:"full"}),dateTime:si({formats:dA,defaultWidth:"full"})},pA={masculine:"ostatni",feminine:"ostatnia"},hA={masculine:"ten",feminine:"ta"},xA={masculine:"nastpny",feminine:"nastpna"},mA={0:"feminine",1:"masculine",2:"masculine",3:"feminine",4:"masculine",5:"masculine",6:"feminine"};function Sv(e,n,t,r){let a;if(YF(n,t,r))a=hA;else if(e==="lastWeek")a=pA;else if(e==="nextWeek")a=xA;else throw new Error(`Cannot determine adjectives for token ${e}`);const o=n.getDay(),l=mA[o];return`'${a[l]}' eeee 'o' p`}const gA={lastWeek:Sv,yesterday:"'wczoraj o' p",today:"'dzisiaj o' p",tomorrow:"'jutro o' p",nextWeek:Sv,other:"P"},vA=(e,n,t,r)=>{const a=gA[e];return typeof a=="function"?a(e,n,t,r):a},yA={narrow:["p.n.e.","n.e."],abbreviated:["p.n.e.","n.e."],wide:["przed nasz er","naszej ery"]},wA={narrow:["1","2","3","4"],abbreviated:["I kw.","II kw.","III kw.","IV kw."],wide:["I kwarta","II kwarta","III kwarta","IV kwarta"]},kA={narrow:["S","L","M","K","M","C","L","S","W","P","L","G"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycze","luty","marzec","kwiecie","maj","czerwiec","lipiec","sierpie","wrzesie","padziernik","listopad","grudzie"]},bA={narrow:["s","l","m","k","m","c","l","s","w","p","l","g"],abbreviated:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],wide:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrzenia","padziernika","listopada","grudnia"]},_A={narrow:["N","P","W","","C","P","S"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},SA={narrow:["n","p","w","","c","p","s"],short:["nie","pon","wto","ro","czw","pi","sob"],abbreviated:["niedz.","pon.","wt.","r.","czw.","pt.","sob."],wide:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"]},EA={narrow:{am:"a",pm:"p",midnight:"pn.",noon:"po",morning:"rano",afternoon:"popo.",evening:"wiecz.",night:"noc"},abbreviated:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"},wide:{am:"AM",pm:"PM",midnight:"pnoc",noon:"poudnie",morning:"rano",afternoon:"popoudnie",evening:"wieczr",night:"noc"}},NA={narrow:{am:"a",pm:"p",midnight:"o pn.",noon:"w po.",morning:"rano",afternoon:"po po.",evening:"wiecz.",night:"w nocy"},abbreviated:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"},wide:{am:"AM",pm:"PM",midnight:"o pnocy",noon:"w poudnie",morning:"rano",afternoon:"po poudniu",evening:"wieczorem",night:"w nocy"}},CA=(e,n)=>String(e),TA={ordinalNumber:CA,era:ka({values:yA,defaultWidth:"wide"}),quarter:ka({values:wA,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ka({values:kA,defaultWidth:"wide",formattingValues:bA,defaultFormattingWidth:"wide"}),day:ka({values:_A,defaultWidth:"wide",formattingValues:SA,defaultFormattingWidth:"wide"}),dayPeriod:ka({values:EA,defaultWidth:"wide",formattingValues:NA,defaultFormattingWidth:"wide"})},DA=/^(\d+)?/i,FA=/\d+/i,jA={narrow:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,abbreviated:/^(p\.?\s*n\.?\s*e\.?\s*|n\.?\s*e\.?\s*)/i,wide:/^(przed\s*nasz(|a)\s*er(|a)|naszej\s*ery)/i},PA={any:[/^p/i,/^n/i]},AA={narrow:/^[1234]/i,abbreviated:/^(I|II|III|IV)\s*kw\.?/i,wide:/^(I|II|III|IV)\s*kwarta(|l)/i},OA={narrow:[/1/i,/2/i,/3/i,/4/i],any:[/^I kw/i,/^II kw/i,/^III kw/i,/^IV kw/i]},RA={narrow:/^[slmkcwpg]/i,abbreviated:/^(sty|lut|mar|kwi|maj|cze|lip|sie|wrz|pa(|z)|lis|gru)/i,wide:/^(stycznia|stycze(|n)|lutego|luty|marca|marzec|kwietnia|kwiecie(|n)|maja|maj|czerwca|czerwiec|lipca|lipiec|sierpnia|sierpie(|n)|wrze(|s)nia|wrzesie(|n)|pa(|z)dziernika|pa(|z)dziernik|listopada|listopad|grudnia|grudzie(|n))/i},zA={narrow:[/^s/i,/^l/i,/^m/i,/^k/i,/^m/i,/^c/i,/^l/i,/^s/i,/^w/i,/^p/i,/^l/i,/^g/i],any:[/^st/i,/^lu/i,/^mar/i,/^k/i,/^maj/i,/^c/i,/^lip/i,/^si/i,/^w/i,/^p/i,/^lis/i,/^g/i]},MA={narrow:/^[npwcs]/i,short:/^(nie|pon|wto|(|s)ro|czw|pi(|a)|sob)/i,abbreviated:/^(niedz|pon|wt|(|s)r|czw|pt|sob)\.?/i,wide:/^(niedziela|poniedzia(|l)ek|wtorek|(|s)roda|czwartek|pi(|a)tek|sobota)/i},IA={narrow:[/^n/i,/^p/i,/^w/i,/^/i,/^c/i,/^p/i,/^s/i],abbreviated:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pt/i,/^so/i],any:[/^n/i,/^po/i,/^w/i,/^(|s)r/i,/^c/i,/^pi/i,/^so/i]},LA={narrow:/^(^a$|^p$|p(|l)n\.?|o\s*p(|l)n\.?|po(|l)\.?|w\s*po(|l)\.?|po\s*po(|l)\.?|rano|wiecz\.?|noc|w\s*nocy)/i,any:/^(am|pm|p(|l)noc|o\s*p(|l)nocy|po(|l)udnie|w\s*po(|l)udnie|popo(|l)udnie|po\s*po(|l)udniu|rano|wieczr|wieczorem|noc|w\s*nocy)/i},BA={narrow:{am:/^a$/i,pm:/^p$/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i},any:{am:/^am/i,pm:/^pm/i,midnight:/p(|l)n/i,noon:/po(|l)/i,morning:/rano/i,afternoon:/po\s*po(|l)/i,evening:/wiecz/i,night:/noc/i}},WA={ordinalNumber:A1({matchPattern:DA,parsePattern:FA,valueCallback:e=>parseInt(e,10)}),era:ba({matchPatterns:jA,defaultMatchWidth:"wide",parsePatterns:PA,defaultParseWidth:"any"}),quarter:ba({matchPatterns:AA,defaultMatchWidth:"wide",parsePatterns:OA,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ba({matchPatterns:RA,defaultMatchWidth:"wide",parsePatterns:zA,defaultParseWidth:"any"}),day:ba({matchPatterns:MA,defaultMatchWidth:"wide",parsePatterns:IA,defaultParseWidth:"any"}),dayPeriod:ba({matchPatterns:LA,defaultMatchWidth:"any",parsePatterns:BA,defaultParseWidth:"any"})},Oa={code:"pl",formatDistance:lA,formatLong:fA,formatRelative:vA,localize:TA,match:WA,options:{weekStartsOn:1,firstWeekContainsDate:4}};Aa("pl",Oa);const vf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],UA=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],$A=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=N.useState(null),[o,l]=N.useState(""),[c,f]=N.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),[h,p]=N.useState(""),[m,g]=N.useState(null),[v,w]=N.useState(null),b=N.useRef(null),k=N.useRef(null),[T,j]=N.useState(null),[C,W]=N.useState(null),[J,V]=N.useState("0,00"),[P,U]=N.useState("0,00"),[B,ne]=N.useState("0,00"),ee=()=>{const F=c.reduce((q,H)=>{const L=parseFloat(H.ilosc.toString().replace(",","."))||0;return q+L},0),A=parseFloat(h.replace(",","."))||0;return F>0?(A/F).toFixed(2):"0,00"},Y=()=>{f([...c,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}])},fe=F=>{if(c.length>1){const A=[...c];A.splice(F,1),f(A)}},de=F=>{const A=[...c];A[F].showDataWaznosci=!A[F].showDataWaznosci,f(A)},oe=F=>{const A=F.target.files?.[0];console.log(" Product file selected:",A),A&&A.type==="application/pdf"?(g(A),console.log(" Product invoice set:",A.name)):console.log(" Invalid product file type:",A?.type)},he=F=>{const A=F.target.files?.[0];console.log(" Transport file selected:",A),A&&A.type==="application/pdf"?(w(A),console.log(" Transport invoice set:",A.name)):console.log(" Invalid transport file type:",A?.type)},X=()=>{b.current?.click()},le=()=>{k.current?.click()},z=async()=>{if(console.log("handleSubmit called"),console.log("selectedDate:",r),console.log("sprzedawca:",o),console.log("kosztDostawy:",h),console.log("productRows:",c),!r||!c.some(Ae=>Ae.kod&&Ae.nazwa&&Ae.ilosc&&Ae.cena)){console.log("Validation failed"),console.log("selectedDate is null:",!r),console.log("productRows validation:",c.some(Ae=>Ae.kod&&Ae.nazwa&&Ae.ilosc&&Ae.cena));return}const F=parseFloat(J.replace(",","."))||1,A=c.reduce((Ae,Xe)=>Ae+(parseFloat(Xe.ilosc)||0),0),q=A>0?parseFloat(h.replace(",","."))/A*F:0,H=c.filter(Ae=>Ae.kod&&Ae.nazwa&&Ae.ilosc&&Ae.cena).map(Ae=>({kod:Ae.kod,nazwa:Ae.nazwa,kod_kreskowy:Ae.kod_kreskowy||"",ilosc:parseFloat(Ae.ilosc)||0,cena:parseFloat(Ae.cena.replace(",","."))||0,dataWaznosci:Ae.dataWaznosci?Ae.dataWaznosci.toLocaleDateString("en-CA"):void 0,typ:Ae.typ||void 0,objetosc:Ae.objetosc||void 0,deliveryCostPerUnitPln:q,podatekAkcyzowyPerLiter:parseFloat(P.replace(",","."))||0}));console.log("formattedProducts:",H);const L=H.reduce((Ae,Xe)=>Ae+Xe.ilosc*Xe.cena,0),ue=parseFloat(h.replace(",","."))||0,I=parseFloat(B.replace(",","."))||0,Oe=L*(1-I/100);console.log("totalValue:",L),console.log("rabat:",I+"%"),console.log("wartoscZRabatem:",Oe),console.log("deliveryCost:",ue),console.log(" Files to submit:",{productInvoice:m,transportInvoice:v}),t({date:r.toLocaleDateString("en-CA"),sprzedawca:o,wartosc:Oe,kosztDostawy:ue,aktualnyKurs:J,podatekAkcyzowy:P,rabat:B,products:H,productInvoice:m||null,transportInvoice:v||null}),se()},se=()=>{a(null),f([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:null,showDataWaznosci:!1,typ:"",objetosc:""}]),p(""),l(""),V("0,00"),U("0,00"),ne("0,00"),g(null),w(null),n()},R=()=>c.reduce((F,A)=>{const q=parseFloat(A.ilosc)||0,H=parseFloat(A.cena.replace(",","."))||0;return F+q*H},0).toFixed(2),S=(F,A)=>{const q=[...c];q[F].typ=A,f(q),j(null)},G=F=>{j(T===F?null:F)},D=F=>{W(C===F?null:F)},E=(F,A)=>{const q=[...c];q[F].objetosc=A,f(q),W(null)};return N.useEffect(()=>{const F=q=>{const H=q.target;if(!H.closest(".react-datepicker")&&!H.closest('button[title*="wanoci"]')){const L=[...c];let ue=!1;L.forEach(I=>{I.showDataWaznosci&&(I.showDataWaznosci=!1,ue=!0)}),ue&&f(L)}T!==null&&(H.closest(".dropdown-container")||j(null)),C!==null&&(H.closest(".dropdown-container")||W(null))},A=q=>{q.key==="Escape"&&(j(null),W(null))};return document.addEventListener("mousedown",F),document.addEventListener("keydown",A),()=>{document.removeEventListener("mousedown",F),document.removeEventListener("keydown",A)}},[T,C,c]),u.jsx(ar,{isOpen:e,onRequestClose:se,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie towaru"}),u.jsx("button",{onClick:se,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx(wn,{selected:r,onChange:F=>a(F),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:h,onKeyPress:F=>{const A=String.fromCharCode(F.which);(!/[\d,]/.test(A)||A===","&&F.target.value.includes(",")||F.target.value===""&&A===",")&&F.preventDefault()},onChange:F=>{const A=F.target,q=A.selectionStart??0;let H=A.value.replace(/[^\d,]/g,"");if(H===""){p("");return}if(!H.includes(","))H=H+",00";else{const[ue,I]=H.split(",");I&&I.length>2&&(H=`${ue},${I.slice(0,2)}`)}p(H),requestAnimationFrame(()=>{const ue=Math.min(q,H.length);A.setSelectionRange(ue,ue)})},className:"w-[70%] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:oe,className:"hidden",ref:b}),u.jsx("button",{type:"button",onClick:X,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(tp,{className:"h-4 w-4 text-gray-500"})}),m&&u.jsx("a",{href:URL.createObjectURL(m),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:m.name,children:m.name})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:he,className:"hidden",ref:k}),u.jsx("button",{type:"button",onClick:le,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Jf,{className:"h-4 w-4 text-gray-500"})}),v&&u.jsx("a",{href:URL.createObjectURL(v),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:v.name,children:v.name})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:o,onChange:F=>l(F.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[ee().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:J,onChange:F=>V(F.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:P,onChange:F=>U(F.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:B,onChange:F=>ne(F.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:c.map((F,A)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:F.kod,onChange:q=>{const H=[...c];H[A].kod=q.target.value,f(H)}}),A===c.length-1&&u.jsx("button",{onClick:Y,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(Hn,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:F.nazwa,onChange:q=>{const H=[...c];H[A].nazwa=q.target.value,f(H)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:F.kod_kreskowy,onChange:q=>{const H=[...c];H[A].kod_kreskowy=q.target.value,f(H)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:F.ilosc,onChange:q=>{const H=[...c],L=q.target.value;(L===""||/^\d*$/.test(L))&&(H[A].ilosc=L,f(H))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:F.cena,onKeyPress:q=>{const H=String.fromCharCode(q.which);(!/[\d,]/.test(H)||H===","&&q.target.value.includes(",")||q.target.value===""&&H===",")&&q.preventDefault()},onChange:q=>{const H=q.target,L=H.selectionStart??0;let ue=q.target.value.replace(/[^\d,]/g,"");if(ue===""){const Ae=[...c];Ae[A].cena="",f(Ae);return}if(!ue.includes(","))ue=ue+",00";else{const[Ae,Xe]=ue.split(",");Xe&&Xe.length>2&&(ue=`${Ae},${Xe.slice(0,2)}`)}const Oe=[...c];Oe[A].cena=ue,f(Oe),requestAnimationFrame(()=>{const Ae=Math.min(L,ue.length);H.setSelectionRange(Ae,Ae)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const q=parseFloat(F.ilosc)||0,H=parseFloat(F.cena.replace(",","."))||0;return(q*H).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>de(A),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${F.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:F.dataWaznosci?`Termin wanoci: ${F.dataWaznosci.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(Zf,{size:16})}),u.jsx("button",{onClick:()=>fe(A),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(Ct,{size:16})})]}),F.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx(wn,{selected:F.dataWaznosci,onChange:q=>{const H=[...c];H[A].dataWaznosci=q,H[A].showDataWaznosci=!1,f(H)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const q=[...c];q[A].showDataWaznosci=!1,f(q)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>G(A),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${F.typ&&vf.find(q=>q.value===F.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:F.typ&&vf.find(q=>q.value===F.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T===A&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:q=>q.stopPropagation(),children:vf.map(q=>u.jsx("button",{type:"button",onClick:()=>S(A,q.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${q.color}`,children:q.label},q.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${A>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>D(A),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${F.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:F.objetosc||"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),C===A&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:q=>q.stopPropagation(),style:{maxWidth:"200px"},children:UA.map(q=>u.jsx("button",{type:"button",onClick:()=>E(A,q.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:q.label},q.value))})]})]})]},A))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[R().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:()=>{console.log("Button clicked"),console.log("Button state:",{selectedDate:r,productRows:c,isDisabled:!r||!c.some(F=>F.kod&&F.nazwa&&F.ilosc&&F.cena)}),z()},disabled:!r||!c.some(F=>F.kod&&F.nazwa&&F.ilosc&&F.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!r||!c.some(F=>F.kod&&F.nazwa&&F.ilosc&&F.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})},HA=({data:e})=>{const n=e.headers.findIndex(c=>c==="Kod"),t=e.headers.findIndex(c=>c==="Nazwa"),r=e.headers.findIndex(c=>c==="Ilo"),a=e.headers.findIndex(c=>c==="Kod kreskowy"),o=e.headers.filter(c=>c==="Kod"||c==="Nazwa"||c==="Ilo"||c==="Kod kreskowy"),l=e.rows.filter(c=>c.some(f=>f&&f.toString().trim()!=="")).map(c=>[c[n],c[t],c[r],c[a]]);return u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsx("tr",{children:o.map((c,f)=>u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c},f))})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((c,f)=>u.jsx("tr",{children:c.map((h,p)=>u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",style:{fontSize:"12px"},children:h},p))},f))})]})})},YA=({onSearch:e})=>{const[n,t]=N.useState(""),[r,a]=N.useState([]),[o,l]=N.useState(!1);return N.useEffect(()=>{const c=setTimeout(async()=>{if(n.trim()){l(!0);try{const f=await e(n);a(f)}catch(f){console.error("Error searching products:",f),a([])}finally{l(!1)}}else a([])},300);return()=>clearTimeout(c)},[n,e]),u.jsxs("div",{className:"w-full relative",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",value:n,onChange:c=>t(c.target.value),placeholder:"Szukaj produktw...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none sm:text-sm font-sora shadow-none"})]}),o?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsxs("div",{className:"text-center py-4",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500 font-sora",children:"adowanie..."})]})}):r.length>0?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 max-h-64 overflow-y-auto font-sora",children:u.jsxs("table",{className:"w-full table-fixed",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Kod"}),u.jsx("th",{className:"w-[70%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Nazwa"}),u.jsx("th",{className:"w-[15%] px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase font-sora bg-gray-50 border-b border-gray-200",children:"Ilo"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((c,f)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.kod,children:c.kod}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.nazwa,children:c.nazwa}),u.jsx("td",{className:"px-2 py-2 text-sm text-gray-900 truncate font-sora",title:c.ilosc,children:c.ilosc})]},f))})]})}):n?u.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white rounded-lg shadow-sm border border-gray-200 mt-1 font-sora",children:u.jsx("div",{className:"text-center py-4 text-gray-500",children:"Brak wynik"})}):null]})};let VA={data:""},KA=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||VA,GA=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,QA=/\/\*[^]*?\*\/|  +/g,Ev=/\n+/g,Ns=(e,n)=>{let t="",r="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?t=o+" "+l+";":r+=o[1]=="f"?Ns(l,o):o+"{"+Ns(l,o[1]=="k"?"":n)+"}":typeof l=="object"?r+=Ns(l,n?n.replace(/([^,])+/g,c=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,c):c?c+" "+f:f)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Ns.p?Ns.p(o,l):o+":"+l+";")}return t+(n&&a?n+"{"+a+"}":a)+r},$a={},pw=e=>{if(typeof e=="object"){let n="";for(let t in e)n+=t+pw(e[t]);return n}return e},XA=(e,n,t,r,a)=>{let o=pw(e),l=$a[o]||($a[o]=(f=>{let h=0,p=11;for(;h<f.length;)p=101*p+f.charCodeAt(h++)>>>0;return"go"+p})(o));if(!$a[l]){let f=o!==e?e:(h=>{let p,m,g=[{}];for(;p=GA.exec(h.replace(QA,""));)p[4]?g.shift():p[3]?(m=p[3].replace(Ev," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][p[1]]=p[2].replace(Ev," ").trim();return g[0]})(e);$a[l]=Ns(a?{["@keyframes "+l]:f}:f,t?"":"."+l)}let c=t&&$a.g?$a.g:null;return t&&($a.g=$a[l]),((f,h,p,m)=>{m?h.data=h.data.replace(m,f):h.data.indexOf(f)===-1&&(h.data=p?f+h.data:h.data+f)})($a[l],n,r,c),l},qA=(e,n,t)=>e.reduce((r,a,o)=>{let l=n[o];if(l&&l.call){let c=l(t),f=c&&c.props&&c.props.className||/^go/.test(c)&&c;l=f?"."+f:c&&typeof c=="object"?c.props?"":Ns(c,""):c===!1?"":c}return r+a+(l??"")},"");function ld(e){let n=this||{},t=e.call?e(n.p):e;return XA(t.unshift?t.raw?qA(t,[].slice.call(arguments,1),n.p):t.reduce((r,a)=>Object.assign(r,a&&a.call?a(n.p):a),{}):t,KA(n.target),n.g,n.o,n.k)}let hw,Kf,Gf;ld.bind({g:1});let es=ld.bind({k:1});function ZA(e,n,t,r){Ns.p=n,hw=e,Kf=t,Gf=r}function Is(e,n){let t=this||{};return function(){let r=arguments;function a(o,l){let c=Object.assign({},o),f=c.className||a.className;t.p=Object.assign({theme:Kf&&Kf()},c),t.o=/ *go\d+/.test(f),c.className=ld.apply(t,r)+(f?" "+f:"");let h=e;return e[0]&&(h=c.as||e,delete c.as),Gf&&h[0]&&Gf(c),hw(h,c)}return a}}var JA=e=>typeof e=="function",Gu=(e,n)=>JA(e)?e(n):e,eO=(()=>{let e=0;return()=>(++e).toString()})(),xw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),tO=20,mw=(e,n)=>{switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,tO)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:t}=n;return mw(e,{type:e.toasts.find(o=>o.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=n;return{...e,toasts:e.toasts.map(o=>o.id===r||r===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let a=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+a}))}}},_u=[],no={toasts:[],pausedAt:void 0},Eo=e=>{no=mw(no,e),_u.forEach(n=>{n(no)})},rO={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},nO=(e={})=>{let[n,t]=N.useState(no),r=N.useRef(no);N.useEffect(()=>(r.current!==no&&t(no),_u.push(t),()=>{let o=_u.indexOf(t);o>-1&&_u.splice(o,1)}),[]);let a=n.toasts.map(o=>{var l,c,f;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((l=e[o.type])==null?void 0:l.removeDelay)||e?.removeDelay,duration:o.duration||((c=e[o.type])==null?void 0:c.duration)||e?.duration||rO[o.type],style:{...e.style,...(f=e[o.type])==null?void 0:f.style,...o.style}}});return{...n,toasts:a}},aO=(e,n="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||eO()}),Hl=e=>(n,t)=>{let r=aO(n,e,t);return Eo({type:2,toast:r}),r.id},on=(e,n)=>Hl("blank")(e,n);on.error=Hl("error");on.success=Hl("success");on.loading=Hl("loading");on.custom=Hl("custom");on.dismiss=e=>{Eo({type:3,toastId:e})};on.remove=e=>Eo({type:4,toastId:e});on.promise=(e,n,t)=>{let r=on.loading(n.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=n.success?Gu(n.success,a):void 0;return o?on.success(o,{id:r,...t,...t?.success}):on.dismiss(r),a}).catch(a=>{let o=n.error?Gu(n.error,a):void 0;o?on.error(o,{id:r,...t,...t?.error}):on.dismiss(r)}),e};var sO=(e,n)=>{Eo({type:1,toast:{id:e,height:n}})},oO=()=>{Eo({type:5,time:Date.now()})},yl=new Map,iO=1e3,lO=(e,n=iO)=>{if(yl.has(e))return;let t=setTimeout(()=>{yl.delete(e),Eo({type:4,toastId:e})},n);yl.set(e,t)},cO=e=>{let{toasts:n,pausedAt:t}=nO(e);N.useEffect(()=>{if(t)return;let o=Date.now(),l=n.map(c=>{if(c.duration===1/0)return;let f=(c.duration||0)+c.pauseDuration-(o-c.createdAt);if(f<0){c.visible&&on.dismiss(c.id);return}return setTimeout(()=>on.dismiss(c.id),f)});return()=>{l.forEach(c=>c&&clearTimeout(c))}},[n,t]);let r=N.useCallback(()=>{t&&Eo({type:6,time:Date.now()})},[t]),a=N.useCallback((o,l)=>{let{reverseOrder:c=!1,gutter:f=8,defaultPosition:h}=l||{},p=n.filter(v=>(v.position||h)===(o.position||h)&&v.height),m=p.findIndex(v=>v.id===o.id),g=p.filter((v,w)=>w<m&&v.visible).length;return p.filter(v=>v.visible).slice(...c?[g+1]:[0,g]).reduce((v,w)=>v+(w.height||0)+f,0)},[n]);return N.useEffect(()=>{n.forEach(o=>{if(o.dismissed)lO(o.id,o.removeDelay);else{let l=yl.get(o.id);l&&(clearTimeout(l),yl.delete(o.id))}})},[n]),{toasts:n,handlers:{updateHeight:sO,startPause:oO,endPause:r,calculateOffset:a}}},uO=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,dO=es`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fO=es`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,pO=Is("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${uO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${dO} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${fO} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,hO=es`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,xO=Is("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${hO} 1s linear infinite;
`,mO=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,gO=es`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,vO=Is("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${mO} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${gO} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,yO=Is("div")`
  position: absolute;
`,wO=Is("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,kO=es`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,bO=Is("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${kO} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,_O=({toast:e})=>{let{icon:n,type:t,iconTheme:r}=e;return n!==void 0?typeof n=="string"?N.createElement(bO,null,n):n:t==="blank"?null:N.createElement(wO,null,N.createElement(xO,{...r}),t!=="loading"&&N.createElement(yO,null,t==="error"?N.createElement(pO,{...r}):N.createElement(vO,{...r})))},SO=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,EO=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,NO="0%{opacity:0;} 100%{opacity:1;}",CO="0%{opacity:1;} 100%{opacity:0;}",TO=Is("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,DO=Is("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,FO=(e,n)=>{let t=e.includes("top")?1:-1,[r,a]=xw()?[NO,CO]:[SO(t),EO(t)];return{animation:n?`${es(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${es(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},jO=N.memo(({toast:e,position:n,style:t,children:r})=>{let a=e.height?FO(e.position||n||"top-center",e.visible):{opacity:0},o=N.createElement(_O,{toast:e}),l=N.createElement(DO,{...e.ariaProps},Gu(e.message,e));return N.createElement(TO,{className:e.className,style:{...a,...t,...e.style}},typeof r=="function"?r({icon:o,message:l}):N.createElement(N.Fragment,null,o,l))});ZA(N.createElement);var PO=({id:e,className:n,style:t,onHeightUpdate:r,children:a})=>{let o=N.useCallback(l=>{if(l){let c=()=>{let f=l.getBoundingClientRect().height;r(e,f)};c(),new MutationObserver(c).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return N.createElement("div",{ref:o,className:n,style:t},a)},AO=(e,n)=>{let t=e.includes("top"),r=t?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:xw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(t?1:-1)}px)`,...r,...a}},OO=ld`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,xu=16,RO=({reverseOrder:e,position:n="top-center",toastOptions:t,gutter:r,children:a,containerStyle:o,containerClassName:l})=>{let{toasts:c,handlers:f}=cO(t);return N.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:xu,left:xu,right:xu,bottom:xu,pointerEvents:"none",...o},className:l,onMouseEnter:f.startPause,onMouseLeave:f.endPause},c.map(h=>{let p=h.position||n,m=f.calculateOffset(h,{reverseOrder:e,gutter:r,defaultPosition:n}),g=AO(p,m);return N.createElement(PO,{id:h.id,key:h.id,onHeightUpdate:f.updateHeight,className:h.visible?OO:"",style:g},h.type==="custom"?Gu(h.message,h):a?a(h):N.createElement(jO,{toast:h,position:p}))}))},He=on;Aa("pl",Oa);const zO=({isOpen:e,onClose:n,onOrderCreated:t})=>{console.log(" OrderModal render - isOpen:",e);const[r,a]=N.useState(null),[o,l]=N.useState(""),[c,f]=N.useState(""),[h,p]=N.useState([]),[m,g]=N.useState(null),[v,w]=N.useState(!1),[b,k]=N.useState([]),[T,j]=N.useState([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),[C,W]=N.useState(null),[J,V]=N.useState(!1),[P,U]=N.useState(!1),[B,ne]=N.useState(null),[ee,Y]=N.useState(new Set),fe=N.useRef(null),de=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],oe=()=>{const D=Math.max(...T.map(E=>E.id))+1;j([...T,{id:D,searchQuery:"",selectedProduct:null,typ:""}])},he=D=>{T.length>1&&j(E=>E.filter(F=>F.id!==D))},X=()=>{console.log(" OrderModal handleClose called"),a(null),l(""),f(""),p([]),g(null),k([]),j([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),W(null),V(!1),U(!1),ne(null),Y(new Set),fe.current=null,n()};N.useEffect(()=>{e&&(console.log(" OrderModal opened - clearing state"),a(null),l(""),f(""),p([]),g(null),k([]),j([{id:1,searchQuery:"",selectedProduct:null,typ:""}]),W(null),V(!1),U(!1),ne(null),Y(new Set),fe.current=null)},[e]),N.useEffect(()=>{const E=setTimeout(async()=>{if(c.trim().length<2){p([]);return}w(!0);try{const F=await fetch(`/api/clients/search?q=${encodeURIComponent(c)}`);if(!F.ok)throw new Error("Failed to fetch clients");const A=await F.json();p(A)}catch(F){console.error("Error searching clients:",F),p([])}finally{w(!1)}},300);return()=>clearTimeout(E)},[c]),N.useEffect(()=>{const E=setTimeout(async()=>{if(C===null||!T.find(F=>F.id===C)?.searchQuery.trim()){k([]);return}V(!0);try{const F=T.find(ue=>ue.id===C)?.searchQuery||"",A=m?`/api/working-sheets/search?query=${encodeURIComponent(F)}&client_id=${m.id}`:`/api/working-sheets/search?query=${encodeURIComponent(F)}`,q=await fetch(A);if(!q.ok)throw new Error("Failed to fetch products");const L=(await q.json()).map(ue=>({kod:ue.kod,nazwa:ue.nazwa,ilosc:ue.ilosc.toString(),kodKreskowy:"",selectedQuantity:0,ilosc_reserved:ue.ilosc_reserved||0,ilosc_client_reserved:ue.ilosc_client_reserved||0}));k(L)}catch(F){console.error("Error searching products:",F),k([])}finally{V(!1)}},300);return()=>clearTimeout(E)},[T,C,m]),N.useEffect(()=>{const D=F=>{const A=F.target;B!==null&&(A.closest(".dropdown-container")||ne(null))},E=F=>{F.key==="Escape"&&ne(null)};return B!==null&&(document.addEventListener("mousedown",D),document.addEventListener("keydown",E)),()=>{document.removeEventListener("mousedown",D),document.removeEventListener("keydown",E)}},[B]);const le=(D,E)=>{console.log(" handleProductSelect called for fieldId:",D,"product:",E.kod),j(F=>F.map(q=>q.id===D?{...q,selectedProduct:E,searchQuery:`${E.kod} - ${E.nazwa.includes(" (samples)")?E.nazwa.replace(" (samples)","")+" (samples)":E.nazwa}`}:q)),k([]),W(null),console.log(" Products list cleared, activeSearchId reset")},z=D=>{ne(B===D?null:D)},se=(D,E)=>{j(F=>F.map(A=>A.id===D?{...A,typ:E}:A)),ne(null)},R=()=>T.filter(D=>D.selectedProduct).reduce((D,E)=>{const F=E.selectedProduct?.selectedQuantity||0;return D+F},0),S=()=>{if(!r||!o.trim()||!m)return!1;const D=T.filter(F=>F.selectedProduct);return!(D.length===0||D.some(F=>!F.selectedProduct?.selectedQuantity||F.selectedProduct.selectedQuantity<=0)||D.some(F=>!F.typ)||Array.from(ee).some(F=>{const q=T.find(H=>H.id===F)?.selectedProduct;return q?(q.ilosc_client_reserved||0)===0:!1}))},G=async()=>{const D=T.filter(H=>H.selectedProduct).map(H=>({kod:H.selectedProduct.kod,nazwa:H.selectedProduct.nazwa,ilosc:H.selectedProduct.selectedQuantity||0,typ:H.typ}));if(!r){He.error("Wybierz dat zamwienia");return}if(!o.trim()){He.error("Wprowad numer zamwienia");return}if(!m){He.error("Wybierz klienta");return}if(D.length===0){He.error("Dodaj produkty");return}if(D.some(H=>!H.ilosc)){He.error("Wprowad ilo dla wszystkich produktw");return}if(D.some(H=>!H.typ)){He.error("Wybierz typ dla wszystkich produktw");return}Y(new Set);const E=r.getDate().toString().padStart(2,"0"),F=(r.getMonth()+1).toString().padStart(2,"0"),A=r.getFullYear(),q=`${o.trim()}_${E}_${F}_${A}`;U(!0);try{const H=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientName:m.nazwa,order_number:q,products:D})});if(!H.ok){const L=await H.json();if(H.status===400&&L.error.includes("Insufficient quantity")){const ue=L.error.match(/product (.*?)\. Available: (\d+), Requested: (\d+)/);if(ue){const[,I,Oe,Ae]=ue;He.error(`Niewystarczajca ilo produktu ${I}. Dostpne: ${Oe}, Zamwione: ${Ae}`)}else He.error(L.error)}else throw new Error("Failed to create order");return}He.success("Zamwienie zostao dodane"),X(),t&&t()}catch(H){console.error("Error creating order:",H),He.error("Wystpi bd podczas dodawania zamwienia")}finally{U(!1)}};return u.jsx(ar,{isOpen:e,onRequestClose:X,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie zamwienia"}),u.jsx("button",{onClick:X,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx(wn,{selected:r,onChange:D=>a(D),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px] ml-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsx("input",{type:"text",value:o,onChange:D=>l(D.target.value),placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:c,onChange:D=>f(D.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),v&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),h.length>0&&!m&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:h.map(D=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{g(D),f(D.nazwa),p([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:D.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:D.firma})]})},D.id))})]}),m&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.firma})]}),m.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.adres})]}),m.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:m.kontakt})]})]}),u.jsx("button",{onClick:()=>{g(null),f("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Ct,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),T.map(D=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:D.searchQuery,onChange:E=>{const F=E.target.value;console.log(" Product search input changed for fieldId:",D.id,"value:",F),j(A=>A.map(q=>q.id===D.id?{...q,searchQuery:F,selectedProduct:null}:q)),W(D.id)},onFocus:()=>W(D.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:D.selectedProduct?.selectedQuantity||"",onChange:E=>{const F=E.target.value,A=F===""?0:Math.max(1,parseInt(F)||0);j(q=>{const H=q.map(ue=>ue.id===D.id&&ue.selectedProduct?{...ue,selectedProduct:{...ue.selectedProduct,selectedQuantity:A}}:ue);fe.current=null;const L=H.find(ue=>ue.id===D.id);if(L?.selectedProduct){const ue=L.selectedProduct.kod,I=parseInt(L.selectedProduct.ilosc)||0,Oe=L.selectedProduct.ilosc_reserved||0,Ae=L.selectedProduct.ilosc_client_reserved||0,Xe=H.filter(_e=>_e.selectedProduct?.kod===ue),qe=Xe.reduce((_e,Qe)=>_e+(Qe.selectedProduct?.selectedQuantity||0),0),pe=Xe.length>1;let Ne,je;Ae>0?(Ne=Ae,je=!0):(Ne=Math.max(0,I-Oe),je=!1),A===0?Y(_e=>{const Qe=new Set(_e);return Qe.delete(D.id),Qe}):qe>Ne?(Y(_e=>{const Qe=new Set(_e);return Qe.add(D.id),Qe}),je?pe?He.error(`Przekroczono ilo w rezerwacji towaru. cznie w zamwieniu: ${qe} szt., dostpne w rezerwacji: ${Ne} szt.`):He.error(`Przekroczono ilo w rezerwacji towaru. Dostpne: ${Ne} szt.`):Oe>0?pe?He.error(`Niewystarczajca ilo towaru - cznie w zamwieniu: ${qe}, dostpne: ${Ne} (na magazynie: ${I}, z nich w rezerwacji: ${Oe})`):He.error(`Niewystarczajca ilo towaru - dostpne: ${Ne} (na magazynie: ${I}, z nich w rezerwacji: ${Oe})`):pe?He.error(`Niewystarczajca ilo towaru - cznie w zamwieniu: ${qe}, dostpne: ${Ne} (na magazynie: ${I})`):He.error(`Niewystarczajca ilo towaru - dostpne: ${Ne} (na magazynie: ${I})`)):Y(_e=>{const Qe=new Set(_e);return Qe.delete(D.id),Qe})}else Y(ue=>{const I=new Set(ue);return I.delete(D.id),I});return H})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${ee.has(D.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:"w-24 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>z(D.id),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${D.typ&&de.find(E=>E.value===D.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:D.typ&&de.find(E=>E.value===D.typ)?.label||"Typ"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),B===D.id&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:E=>E.stopPropagation(),children:de.map(E=>u.jsx("button",{type:"button",onClick:()=>se(D.id,E.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${E.color}`,children:E.label},E.value))})]}),T.length>1&&u.jsx("button",{onClick:()=>he(D.id),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),D.id===Math.max(...T.map(E=>E.id))&&u.jsx("button",{onClick:oe,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),J&&C===D.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),b.length>0&&C===D.id&&!D.selectedProduct&&D.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:b.map((E,F)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>le(D.id,{...E,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:E.kod}),E.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:E.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:E.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",E.ilosc]}),(E.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",E.ilosc_reserved??0]})]})},`${E.kod}-${E.nazwa||""}-${F}`))})]},D.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:G,disabled:P||!S(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${P||!S()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:P?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:R()})]})]})})},MO=({isOpen:e,onClose:n,order:t})=>{const[r,a]=N.useState(null),[o,l]=N.useState(null),[c,f]=N.useState(!1),h=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],p=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}];N.useEffect(()=>{e&&t&&(m(),g())},[e,t]);const m=async()=>{if(t){f(!0);try{const k=await fetch(`/api/orders/${t.id}`);if(!k.ok)throw new Error("Failed to load order details");const T=await k.json();a(T)}catch(k){console.error("Error loading order details:",k)}finally{f(!1)}}},g=async()=>{if(t)try{const k=await fetch(`/api/clients/${encodeURIComponent(t.klient)}`);if(k.ok){const T=await k.json();l(T)}}catch(k){console.error("Error loading client data:",k)}},v=k=>new Date(k).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});if(!t)return null;const w=r||t,b=async()=>{if(!(!t||!w))try{const k=await fetch(`/api/orders/${t.id}/pdf`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!k.ok)throw new Error("Failed to generate PDF");const T=await k.blob(),j=window.URL.createObjectURL(T),C=document.createElement("a");C.href=j;const W=o?o.nazwa:w.klient,J=`${W}_${w.numer_zamowienia}.pdf`;console.log("Frontend filename generation:"),console.log("Client name:",W),console.log("Order number:",w.numer_zamowienia),console.log("Generated filename:",J),C.download=J,document.body.appendChild(C),C.click(),window.URL.revokeObjectURL(j),document.body.removeChild(C)}catch(k){console.error("Error generating PDF:",k),alert("Bd podczas generowania PDF")}};return u.jsx(ar,{isOpen:e,onRequestClose:n,style:{content:{width:"800px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:w.typ==="odpisanie"?"Szczegy odpisania":"Szczegy zamwienia"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:c?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-purple-50 p-4 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:w.typ==="odpisanie"?"Numer odpisania:":"Numer zamwienia:"}),u.jsx("p",{className:"text-sm font-bold text-gray-900",children:w.numer_zamowienia})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-700",children:"Data utworzenia:"}),u.jsx("p",{className:"text-gray-900",children:v(w.data_utworzenia||"")})]})]})}),o&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.nazwa})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.firma})]}),o.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.adres})]}),o.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:o.kontakt})]})]})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-3",children:w.typ==="odpisanie"?"Produkty w odpisaniu":"Produkty w zamwieniu"}),w.products&&w.products.length>0?u.jsx("div",{children:u.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Kod"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Kod kreskowy"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:w.typ==="odpisanie"?"Powd":"Typ"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.products.map(k=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-20",children:k.kod}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:k.nazwa})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 w-24",children:k.kod_kreskowy||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:k.ilosc}),u.jsx("td",{className:"px-4 py-2 text-xs w-20",children:k.typ?u.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${w.typ==="odpisanie"?p.find(T=>T.value===k.typ)?.color:h.find(T=>T.value===k.typ)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:w.typ==="odpisanie"?p.find(T=>T.value===k.typ)?.label||k.typ:h.find(T=>T.value===k.typ)?.label||k.typ}):u.jsx("span",{className:"text-gray-500",children:"-"})})]},k.id))})]})}):u.jsx("p",{className:"text-xs text-gray-500",children:w.typ==="odpisanie"?"Brak produktw w odpisaniu":"Brak produktw w zamwieniu"})]})]})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:w.laczna_ilosc})]}),u.jsx("div",{className:"absolute bottom-4 left-4",children:u.jsx("button",{onClick:b,disabled:c,className:"px-4 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora disabled:bg-gray-400 disabled:cursor-not-allowed",children:c?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Generowanie..."]}):"Generuj PDF"})})]})})};Aa("pl",Oa);const yf=[{value:"sprzedaz",label:"Sprzeda",color:"bg-blue-100 text-blue-800 border-blue-200"},{value:"probka",label:"Prbka",color:"bg-green-100 text-green-800 border-green-200"},{value:"degustacja",label:"Degustacja",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"zamiana",label:"Zamiana",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"prezent",label:"Prezent",color:"bg-pink-100 text-pink-800 border-pink-200"}],wf=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}],IO=({isOpen:e,onClose:n,onSubmit:t,order:r})=>{const[a,o]=N.useState(""),[l,c]=N.useState(""),[f,h]=N.useState(""),[p,m]=N.useState(null),[g,v]=N.useState([{kod:"",nazwa:"",ilosc:"",typ:""}]),[w,b]=N.useState(null),[k,T]=N.useState(""),[j,C]=N.useState([]),[W,J]=N.useState(!1),[V,P]=N.useState(null),[U,B]=N.useState([]),[ne,ee]=N.useState(!1),[Y,fe]=N.useState(null),[de,oe]=N.useState(new Set),he=async(E,F)=>{try{const A=E.map(H=>H.kod).filter(H=>H.trim());if(console.log("=== LOADING PRODUCTS INFO ==="),console.log("Product codes to load:",A),console.log("Client ID for reservations:",F),A.length===0)return;const q=[];for(const H of A){const L=F?`/api/working-sheets/search?query=${encodeURIComponent(H)}&client_id=${F}`:`/api/working-sheets/search?query=${encodeURIComponent(H)}`,ue=await fetch(L);if(!ue.ok)continue;const Oe=(await ue.json()).find(Ae=>Ae.kod===H);Oe&&(q.push(Oe),console.log(`Found product for ${H}:`,Oe))}console.log("Found products with reservations:",q),C(q),v(H=>H.map(L=>{const ue=q.find(I=>I.kod===L.kod);return ue?{...L,availableQuantity:parseInt(ue.ilosc)||0,ilosc_reserved:ue.ilosc_reserved||0,ilosc_client_reserved:ue.ilosc_client_reserved||0,originalIlosc:parseInt(L.ilosc)||0}:L})),console.log(" Final loaded products info for order editing:",q)}catch(A){console.error(" Error loading products info:",A)}};N.useEffect(()=>{if(e&&r){if(o(r.klient),T(r.klient),r.typ==="odpisanie"){const F=r.numer_zamowienia.match(/^(OP\d+)/);F?h(F[1]):fetch("/api/writeoffs/next-number-only").then(A=>{if(!A.ok)throw new Error("Failed to fetch next number");return A.json()}).then(A=>{A.numer_odpisania?h(A.numer_odpisania):h("OP001")}).catch(A=>{console.error(" Error fetching next write-off number:",A),h("OP001")})}if(c(r.numer_zamowienia),r.data_utworzenia){const F=new Date(r.data_utworzenia);m(F),console.log(" Loaded order date:",F)}else m(null);const E=r.products&&r.products.length>0?r.products.map(F=>({kod:F.kod||"",nazwa:F.nazwa||"",ilosc:(F.ilosc||0).toString(),typ:F.typ||"",originalIlosc:F.ilosc||0})):[{kod:"",nazwa:"",ilosc:"",typ:""}];console.log("Order products from backend:",r.products),console.log("Formatted products:",E),v(E),r.klient&&r.typ!=="odpisanie"?fetch(`/api/clients/search?q=${encodeURIComponent(r.klient)}`).then(F=>F.ok?F.json():[]).then(F=>{const A=F.find(q=>q.nazwa?.toLowerCase()===r.klient.toLowerCase());A?(fe(A),console.log(" Loaded client with id:",A.id),E.length>0&&E[0].kod&&he(E,A.id)):(fe({nazwa:r.klient}),E.length>0&&E[0].kod&&he(E))}).catch(F=>{console.error(" Error loading client:",F),fe({nazwa:r.klient}),E.length>0&&E[0].kod&&he(E)}):(fe({nazwa:r.klient}),E.length>0&&E[0].kod&&he(E))}else h("")},[e,r]),N.useEffect(()=>{if(r?.typ==="odpisanie"&&f&&p){const E=String(p.getDate()).padStart(2,"0"),F=String(p.getMonth()+1).padStart(2,"0"),A=p.getFullYear(),q=`${f}_${E}_${F}_${A}`;c(q)}},[f,p,r?.typ]),N.useEffect(()=>{const F=setTimeout(async()=>{if(V===null||!g.find((A,q)=>q===V)?.nazwa.trim()){C([]);return}J(!0);try{const A=g.find((I,Oe)=>Oe===V)?.nazwa||"";if(!A.trim()){C([]),J(!1);return}const q=Y?.id?`/api/working-sheets/search?query=${encodeURIComponent(A)}&client_id=${Y.id}`:`/api/working-sheets/search?query=${encodeURIComponent(A)}`,H=await fetch(q);if(!H.ok)throw new Error("Failed to fetch products");const ue=(await H.json()).map(I=>({kod:I.kod,nazwa:I.nazwa||"",ilosc:I.ilosc?I.ilosc.toString():"0",status:I.status||null,ilosc_reserved:I.ilosc_reserved||0,ilosc_client_reserved:I.ilosc_client_reserved||0}));C(ue)}catch(A){console.error("Error searching products:",A),C([])}finally{J(!1)}},300);return()=>clearTimeout(F)},[g,V,Y]),N.useEffect(()=>{const F=setTimeout(async()=>{if(k.trim().length<2){B([]);return}ee(!0);try{const A=await fetch(`/api/clients/search?q=${encodeURIComponent(k)}`);if(!A.ok)throw new Error("Failed to fetch clients");const q=await A.json();B(q)}catch(A){console.error("Error searching clients:",A),B([])}finally{ee(!1)}},300);return()=>clearTimeout(F)},[k]),N.useEffect(()=>{const E=A=>{const q=A.target;w!==null&&(q.closest(".dropdown-container")||b(null))},F=A=>{A.key==="Escape"&&b(null)};return w!==null&&(document.addEventListener("mousedown",E),document.addEventListener("keydown",F)),()=>{document.removeEventListener("mousedown",E),document.removeEventListener("keydown",F)}},[w]);const X=()=>{v([...g,{kod:"",nazwa:"",ilosc:"",typ:""}])},le=E=>{g.length>1&&v(g.filter((F,A)=>A!==E))},z=(E,F)=>{const A=[...g];A[E].typ=F,v(A),b(null)},se=E=>{b(w===E?null:E)},R=(E,F)=>{console.log(" EditOrderModal handleProductSelect called for index:",E,"product:",F.kod),console.log(" Product data:",F);const A=[...g];A[E]={...A[E],kod:F.kod,nazwa:F.nazwa,typ:F.typ||"sztuki",availableQuantity:parseInt(F.ilosc)||0,ilosc_reserved:F.ilosc_reserved||0,ilosc_client_reserved:F.ilosc_client_reserved||0,originalIlosc:0},v(A);const q=[...j],H=q.findIndex(L=>L.kod===F.kod);H>=0?q[H]=F:q.push(F),C(q),P(null),console.log(" EditOrderModal Products list cleared, activeSearchId reset")},S=async(E,F)=>{const A=new Set;for(let q=0;q<E.length;q++){const H=E[q],L=parseInt(H.ilosc)||0,ue=g.findIndex(Qe=>Qe.kod===H.kod&&Qe.nazwa===H.nazwa&&Qe.ilosc===H.ilosc);if(ue===-1){console.warn(` Could not find actual index for product ${H.kod}`);continue}const I=g[ue],Oe=F.find(Qe=>Qe.kod===H.kod),Ae=Oe?.ilosc||I.availableQuantity||0,Xe=Oe?.ilosc_reserved||I.ilosc_reserved||0,qe=Oe?.ilosc_client_reserved||I.ilosc_client_reserved||0,pe=r?.products?.find(Qe=>Qe.kod===H.kod),Ne=pe&&pe.ilosc||0,je=Ae+Ne;let _e;if(qe>0){const Qe=je-Xe;_e=qe+Math.max(0,Qe)}else _e=je-Xe;console.log(`Product ${ue} (valid index ${q}):`,{kod:H.kod,requested:L,totalOnStock:Ae,originalQuantityInOrder:Ne,availableForEdit:je,reservedQuantity:Xe,clientReservedQuantity:qe,maxAllowed:_e,hasError:L>_e}),L>_e&&(A.add(ue),console.log(` Error for product ${ue}: requested ${L} > maxAllowed ${_e}`),qe>0?He.error(`Produkt ${H.kod}: przekroczono ilo w rezerwacji. Dostpne: ${_e} szt.`):Xe>0?He.error(`Produkt ${H.kod}: niewystarczajca ilo - dostpne: ${_e} (na magazynie: ${je}, z nich w rezerwacji: ${Xe})`):He.error(`Produkt ${H.kod}: niewystarczajca ilo - dostpne: ${_e}`))}return A},G=async E=>{if(E.preventDefault(),!r)return;if(!a.trim()){He.error("Wprowad nazw klienta");return}if(!l.trim()){He.error(r?.typ==="odpisanie"?"Wprowad numer odpisania":"Wprowad numer zamwienia");return}const F=g.filter(H=>H.kod.trim()&&H.nazwa.trim()&&H.ilosc.trim()&&H.typ.trim());if(F.length===0){He.error(r?.typ==="odpisanie"?"Dodaj produkty do odpisania":"Dodaj produkty do zamwienia");return}if(F.some(H=>!H.ilosc||!H.typ)){He.error("Wprowad ilo i typ dla wszystkich produktw");return}if(console.log("=== STOCK CHECK DEBUG ==="),console.log("validProducts:",F),console.log("products (stock info):",j),console.log("products.length:",j.length),j.length===0){console.log(" Products info is empty, reloading...");try{const H=await fetch("/api/working-sheets");if(H.ok){const L=await H.json();console.log("Reloaded all products:",L),C(L);const ue=await S(F,L);if(ue.size>0){oe(ue);return}else oe(new Set);console.log(" Products loaded, continuing with submission...")}else{console.error("Failed to reload products"),He.error("Bd podczas adowania informacji o produktach");return}}catch(H){console.error("Error reloading products:",H),He.error("Bd podczas adowania informacji o produktach");return}}const A=await S(F,j);if(A.size>0){oe(A);return}else oe(new Set);const q=F.map(H=>({kod:H.kod,nazwa:H.nazwa,ilosc:parseInt(H.ilosc)||0,typ:H.typ}));console.log("Sending products data:",q);try{const H=await fetch(`/api/orders/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_zamowienia:l.trim(),products:q})});if(!H.ok){const L=await H.json();throw new Error(L.error||"Failed to update order")}He.success(r?.typ==="odpisanie"?"Odpisanie zostao zaktualizowane":"Zamwienie zostao zaktualizowane"),D(),t({id:r.id,klient:a.trim(),numer_zamowienia:l.trim(),products:q})}catch(H){console.error("Error updating order:",H),He.error("Wystpi bd podczas aktualizacji zamwienia")}},D=()=>{o(""),T(""),fe(null),B([]),c(""),m(null),v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",typ:""}]),b(null),C([]),P(null),n()};return r?u.jsx(ar,{isOpen:e,onRequestClose:D,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:r?.typ==="odpisanie"?"Edytuj odpisanie":"Edytuj zamwienie"}),u.jsx("button",{type:"button",onClick:D,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("form",{onSubmit:G,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex space-x-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zamwienia"}),u.jsx(wn,{selected:p,onChange:E=>m(E),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:r?.typ==="odpisanie"?"Numer odpisania":"Numer zamwienia"}),u.jsx("input",{type:"text",value:l,onChange:E=>c(E.target.value),readOnly:r?.typ==="odpisanie",placeholder:r?.typ==="odpisanie"?"Wprowad numer odpisania":"Wprowad numer zamwienia",className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${r?.typ==="odpisanie"?"bg-gray-100":""}`})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),r?.typ==="odpisanie"?u.jsx("input",{type:"text",value:"VEIS",readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100"}):u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:k,onChange:E=>T(E.target.value),placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),r?.typ!=="odpisanie"&&ne&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),r?.typ!=="odpisanie"&&U.length>0&&!Y&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:U.map(E=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{fe(E),T(E.nazwa),o(E.nazwa),B([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:E.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:E.firma})]})},E.id))})]}),r?.typ!=="odpisanie"&&Y&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Nazwa:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.nazwa})]}),Y.firma&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Firma:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.firma})]}),Y.adres&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Adres:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.adres})]}),Y.kontakt&&u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Kontakt:"}),u.jsx("p",{className:"text-xs text-gray-900",children:Y.kontakt})]})]}),u.jsx("button",{type:"button",onClick:()=>{fe(null),T(""),o("")},className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Ct,{size:16})})]})})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),g.map((E,F)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:`relative flex-1 ${r?.typ==="odpisanie"?"max-w-[65%]":"max-w-[70%]"}`,children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:E.nazwa,onChange:A=>{const q=A.target.value;console.log(" EditOrderModal Product search input changed for index:",F,"value:",q);const H=[...g];H[F].nazwa=q,v(H),P(F)},onFocus:()=>P(F),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:E.ilosc,onChange:A=>{const q=A.target.value,H=parseInt(q)||0,L=[...g];if(L[F].ilosc=q,v(L),r?.typ!=="odpisanie"&&E.kod){const ue=E.originalIlosc||0,I=E.availableQuantity||0,Oe=E.ilosc_reserved||0,Ae=E.ilosc_client_reserved||0,Xe=I+ue;let qe,pe=!1;if(Ae>0){const Ne=Xe-Oe;qe=Ae+Math.max(0,Ne),pe=!0}else qe=Xe-Oe;H>qe?(oe(Ne=>{const je=new Set(Ne);return je.add(F),je}),pe?He.error(`Przekroczono ilo w rezerwacji. Dostpne: ${qe} szt.`):Oe>0?He.error(`Niewystarczajca ilo - dostpne: ${qe} (na magazynie: ${Xe}, z nich w rezerwacji: ${Oe})`):He.error(`Niewystarczajca ilo - dostpne: ${qe} (na magazynie: ${Xe})`)):oe(Ne=>{const je=new Set(Ne);return je.delete(F),je})}else if(de.has(F)){const ue=new Set(de);ue.delete(F),oe(ue)}},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${de.has(F)?"border-red-500 bg-red-50":"border-gray-300"}`})}),u.jsxs("div",{className:`${r?.typ==="odpisanie"?"w-32":"w-24"} ml-2 relative dropdown-container`,children:[u.jsxs("button",{type:"button",onClick:()=>se(F),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${E.typ&&(r?.typ==="odpisanie"?wf.find(A=>A.value===E.typ)?.color:yf.find(A=>A.value===E.typ)?.color)||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:E.typ&&(r?.typ==="odpisanie"?wf.find(A=>A.value===E.typ)?.label:yf.find(A=>A.value===E.typ)?.label)||(r?.typ==="odpisanie"?"Powd":"Typ")}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w===F&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:A=>A.stopPropagation(),children:(r?.typ==="odpisanie"?wf:yf).map(A=>u.jsx("button",{type:"button",onClick:()=>z(F,A.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${A.color}`,children:A.label},A.value))})]}),g.length>1&&u.jsx("button",{type:"button",onClick:()=>le(F),className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),F===g.length-1&&u.jsx("button",{type:"button",onClick:X,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),W&&V===F&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),j.length>0&&V===F&&E.nazwa.trim()&&u.jsx("div",{className:`absolute z-50 mt-1 ${r?.typ==="odpisanie"?"w-[65%]":"w-[70%]"} bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200`,children:j.map(A=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>R(F,A),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:A.kod}),A.nazwa&&A.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:A.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:A.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",A.ilosc]}),(A.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",A.ilosc_reserved??0]})]})},A.kod))})]},F))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:D,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:G,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Zapisz zmiany"})]})]})}):null};Aa("pl",Oa);const LO=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const r=parseInt(t[1],10),a=parseInt(t[2],10)-1,o=parseInt(t[3],10),l=new Date(o,a,r);if(!isNaN(l.getTime()))return l}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},BO=[{value:0,label:"0%"},{value:5,label:"5%"},{value:8,label:"8%"},{value:23,label:"23%"}],WO=({isOpen:e,onClose:n,orderData:t})=>{const[r,a]=N.useState(null),[o,l]=N.useState(""),[c,f]=N.useState(""),[h,p]=N.useState(""),[m,g]=N.useState([{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23}]),[v,w]=N.useState(0),[b,k]=N.useState(!1),[T,j]=N.useState(null),[C,W]=N.useState([]),[J,V]=N.useState(null),[P,U]=N.useState(!1),B=async()=>{try{const S=await fetch("/api/working-sheets");if(!S.ok){console.error(" Failed to fetch working sheets");return}const G=await S.json(),D=new Map;G.forEach(E=>{if(E.kod&&E.cena_sprzedazy!==null&&E.cena_sprzedazy!==void 0){const F=Number(E.cena_sprzedazy);isNaN(F)||D.set(E.kod,F)}}),g(E=>E.map(F=>{if(F.kod&&D.has(F.kod)){const A=D.get(F.kod),q=A%1===0?`${A.toFixed(0)},00`:A.toFixed(2).replace(".",",");return{...F,cena_jednostkowa:q}}return F})),console.log(" Prices loaded from working_sheets")}catch(S){console.error(" Error loading prices from working_sheets:",S)}};N.useEffect(()=>{if(e)if(fetch("/api/invoices/next-number-only").then(S=>{if(!S.ok)throw new Error("Failed to fetch next number");return S.json()}).then(S=>{S.numer_faktury?(l(S.numer_faktury),console.log(" Set invoice base number to:",S.numer_faktury)):l("001")}).catch(S=>{console.error(" Error fetching next invoice number:",S),l("001")}),t){p(t.klient);const S=LO(t.numer_zamowienia);if(a(S||new Date),t.products&&t.products.length>0){const G=t.products.filter(D=>D.typ==="sprzedaz"||D.typ==="probka");if(G.length>0){const D=G.map(E=>({kod:E.kod,nazwa:E.nazwa,ilosc:E.ilosc.toString(),cena_jednostkowa:"",rabat:E.typ==="probka"?"30":"",vat:23}));g(D),w(D.length),B()}}}else a(new Date);else a(null),l(""),f(""),p(""),g([{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23}]),w(0)},[e,t]),N.useEffect(()=>{if(o&&r){const S=r.getMonth()+1,G=r.getFullYear(),D=`FV ${o}/${S}/${G}`;f(D)}else if(o&&!r){const S=new Date().getMonth()+1,G=new Date().getFullYear(),D=`FV ${o}/${S}/${G}`;f(D)}},[o,r]),N.useEffect(()=>{const S=D=>{const E=D.target;T!==null&&(E.closest(".dropdown-container")||j(null)),J!==null&&(E.closest(".product-search-container")||(V(null),W([])))},G=D=>{D.key==="Escape"&&(j(null),V(null),W([]))};return document.addEventListener("mousedown",S),document.addEventListener("keydown",G),()=>{document.removeEventListener("mousedown",S),document.removeEventListener("keydown",G)}},[T,J]),N.useEffect(()=>{const G=setTimeout(async()=>{if(J===null||J<v){W([]);return}const E=m[J]?.searchQuery||"";if(E.trim().length<1){W([]);return}U(!0);try{const F=await fetch(`/api/working-sheets/search-simple?query=${encodeURIComponent(E)}`);if(!F.ok)throw new Error("Failed to fetch products");const q=(await F.json()).map(H=>({kod:H.kod,nazwa:H.nazwa,cena_sprzedazy:H.cena_sprzedazy}));W(q)}catch(F){console.error("Error searching products:",F),W([])}finally{U(!1)}},300);return()=>clearTimeout(G)},[J,m,v]);const ne=()=>{g([...m,{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23,searchQuery:""}])},ee=S=>{if(!(S<v)&&m.length>1){const G=[...m];G.splice(S,1),g(G)}},Y=S=>{j(T===S?null:S)},fe=(S,G)=>{const D=[...m];D[S].vat=G,g(D),j(null)},de=(S,G)=>{const D=[...m],E=G.cena_sprzedazy,F=E!=null?E%1===0?`${E.toFixed(0)},00`:E.toFixed(2).replace(".",","):"";D[S]={...D[S],kod:G.kod,nazwa:G.nazwa,cena_jednostkowa:F,searchQuery:`${G.kod} - ${G.nazwa}`},g(D),W([]),V(null)},oe=S=>{const G=parseFloat(S.ilosc)||0,D=parseFloat(S.cena_jednostkowa.replace(",","."))||0,E=parseFloat(S.rabat.replace(",","."))||0;return G*D*(1-E/100)},he=S=>oe(S)*(1+S.vat/100),X=()=>m.reduce((S,G)=>S+oe(G),0).toFixed(2),le=()=>m.reduce((S,G)=>{const D=oe(G),E=he(G);return S+(E-D)},0).toFixed(2),z=()=>m.reduce((S,G)=>S+he(G),0).toFixed(2),se=async()=>{if(!r||!h||!m.some(S=>S.nazwa&&S.ilosc&&S.cena_jednostkowa)){He.error("Prosz wypeni wszystkie wymagane pola");return}k(!0);try{const S=m.filter(D=>D.nazwa&&D.ilosc&&D.cena_jednostkowa).map(D=>({kod:D.kod,nazwa:D.nazwa,ilosc:parseFloat(D.ilosc)||0,cena_jednostkowa:parseFloat(D.cena_jednostkowa.replace(",","."))||0,vat:D.vat})),G={data_faktury:r.toLocaleDateString("en-CA"),numer_faktury:c,klient:h,order_id:t?.id,products:S,total:parseFloat(z())};console.log("Creating invoice:",G),He.success(`Faktura zostaa utworzona: ${c}`),R()}catch(S){console.error("Error creating invoice:",S),He.error("Bd podczas tworzenia faktury")}finally{k(!1)}},R=()=>{a(null),l(""),f(""),p(""),g([{kod:"",nazwa:"",ilosc:"",cena_jednostkowa:"",rabat:"",vat:23}]),w(0),k(!1),j(null),W([]),V(null),U(!1),n()};return u.jsx(ar,{isOpen:e,onRequestClose:R,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Utwrz faktur VAT"}),u.jsx("button",{onClick:R,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[120px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data faktury"}),u.jsx(wn,{selected:r,onChange:S=>a(S),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-center",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[123px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer faktury"}),u.jsx("input",{type:"text",value:c,onChange:S=>f(S.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"FV XXX/M/YYYY"})]}),u.jsxs("div",{className:"w-[250px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsx("input",{type:"text",value:h,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed",placeholder:"Nazwa klienta"})]})]})}),u.jsx("div",{className:`space-y-2 pb-8 ${m.length>=8?"overflow-y-auto max-h-[280px] pr-2":"overflow-visible"}`,children:m.map((S,G)=>u.jsxs("div",{className:"relative product-search-container",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[38%]",children:[G===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),G<v?u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed",placeholder:"Nazwa produktu",value:S.nazwa,readOnly:!0}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",style:{top:G===0?"28px":"0"},children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Wyszukaj produkt...",value:S.searchQuery||S.nazwa,onChange:D=>{const E=[...m];E[G].searchQuery=D.target.value,E[G].nazwa="",E[G].kod="",E[G].cena_jednostkowa="",g(E),V(G)},onFocus:()=>V(G)}),P&&J===G&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",style:{top:G===0?"calc(50% + 14px)":"50%"},children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),C.length>0&&J===G&&(S.searchQuery?.trim()||"")&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:C.map((D,E)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>de(G,D),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:D.kod}),u.jsx("span",{className:"text-[10px] text-gray-500",children:D.nazwa})]})},`${D.kod}-${E}`))})]})]}),u.jsxs("div",{className:"w-16 ml-2",children:[G===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Ilo"}),u.jsx("input",{type:"number",className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${G<v?"bg-gray-100 text-gray-600 cursor-not-allowed":""}`,placeholder:"0",value:S.ilosc,readOnly:G<v,onChange:D=>{const E=[...m],F=D.target.value;(F===""||/^\d*$/.test(F))&&(E[G].ilosc=F,g(E))}})]}),u.jsxs("div",{className:"w-24 ml-2",children:[G===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena netto"}),u.jsx("input",{type:"text",value:S.cena_jednostkowa,onKeyPress:D=>{const E=String.fromCharCode(D.which);(!/[\d,]/.test(E)||E===","&&D.target.value.includes(",")||D.target.value===""&&E===",")&&D.preventDefault()},onChange:D=>{const E=D.target,F=E.selectionStart??0;let A=D.target.value.replace(/[^\d,]/g,"");if(A===""){const L=[...m];L[G].cena_jednostkowa="",g(L);return}if(!A.includes(","))A=A+",00";else{const[L,ue]=A.split(",");ue&&ue.length>2&&(A=`${L},${ue.slice(0,2)}`)}const H=[...m];H[G].cena_jednostkowa=A,g(H),requestAnimationFrame(()=>{const L=Math.min(F,A.length);E.setSelectionRange(L,L)})},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})]}),u.jsxs("div",{className:"w-16 ml-2",children:[G===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat %"}),u.jsx("input",{type:"text",value:S.rabat,onKeyPress:D=>{const E=String.fromCharCode(D.which);(!/[\d,]/.test(E)||E===","&&D.target.value.includes(",")||D.target.value===""&&E===",")&&D.preventDefault()},onChange:D=>{const E=[...m];E[G].rabat=D.target.value.replace(/[^\d,]/g,""),g(E)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0"})]}),u.jsxs("div",{className:"w-20 ml-2 relative dropdown-container",children:[G===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"VAT"}),u.jsxs("button",{type:"button",onClick:()=>Y(G),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between bg-white",children:[u.jsxs("span",{className:"truncate",children:[S.vat,"%"]}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),T===G&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:D=>D.stopPropagation(),children:BO.map(D=>u.jsx("button",{type:"button",onClick:()=>fe(G,D.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:D.label},D.value))})]}),u.jsxs("div",{className:"w-24 ml-2",children:[G===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Wart. netto"}),u.jsx("input",{type:"text",value:oe(S).toFixed(2).replace(".",","),readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"0,00"})]}),u.jsxs("div",{className:"w-24 ml-2",children:[G===0&&u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Wart. brutto"}),u.jsx("input",{type:"text",value:he(S).toFixed(2).replace(".",","),readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"0,00"})]}),m.length>1&&G>=v&&u.jsx("button",{onClick:()=>ee(G),className:`ml-2 text-red-400 hover:text-red-600 ${G===0?"mt-[28px]":""}`,title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),G===m.length-1&&u.jsx("button",{onClick:ne,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})})]},G))})]}),u.jsxs("div",{className:"absolute bottom-8 right-12 flex flex-col items-start gap-1",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs text-gray-700 mr-2",children:"Kwota netto:"}),u.jsxs("span",{className:"text-xs text-gray-900",children:[X().replace(".",",")," z"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs text-gray-700 mr-2",children:"Kwota VAT:"}),u.jsxs("span",{className:"text-xs text-gray-900",children:[le().replace(".",",")," z"]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs font-bold text-gray-700 mr-2",children:"Razem (PLN):"}),u.jsxs("span",{className:"text-xs font-bold text-gray-900",children:[z().replace(".",",")," z"]})]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:se,disabled:b||!r||!h||!m.some(S=>S.nazwa&&S.ilosc&&S.cena_jednostkowa),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora ${b||!r||!h||!m.some(S=>S.nazwa&&S.ilosc&&S.cena_jednostkowa)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:b?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})})]})})},mu=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const r=parseInt(t[1],10),a=parseInt(t[2],10)-1,o=parseInt(t[3],10),l=new Date(o,a,r);if(!isNaN(l.getTime()))return l}return null}catch{return null}},UO=({onDeleteOrder:e,onUpdateOrder:n,refreshTrigger:t})=>{const[r,a]=N.useState([]),[o,l]=N.useState(!0),[c,f]=N.useState(null),[h,p]=N.useState(null),[m,g]=N.useState(!1),[v,w]=N.useState(!1),[b,k]=N.useState(null),[T,j]=N.useState(!1),[C,W]=N.useState(null),[J,V]=N.useState(""),[P,U]=N.useState({}),[B,ne]=N.useState(!1),[ee,Y]=N.useState(null),[fe,de]=N.useState("data_utworzenia"),[oe,he]=N.useState("desc"),[X,le]=N.useState(""),[z,se]=N.useState(""),[R,S]=N.useState(""),[G,D]=N.useState(""),E=async()=>{try{console.log(" Starting to load orders..."),l(!0),f(null),console.log(" Fetching from /api/orders-with-products...");const ve=await fetch("/api/orders-with-products");if(console.log(" Response status:",ve.status),console.log(" Response ok:",ve.ok),!ve.ok)throw new Error(`HTTP error! status: ${ve.status}`);const Ze=await ve.json();console.log(" Raw data received:",Ze),console.log(" Raw data length:",Ze.length);const kt=Ze.map(ce=>({id:ce.id,klient:ce.klient,numer_zamowienia:ce.numer_zamowienia,data_utworzenia:ce.data_utworzenia,laczna_ilosc:ce.laczna_ilosc,typ:ce.typ||"zamowienie",numer_zwrotu:ce.numer_zwrotu||null,products:ce.products||[]}));console.log(" Transformed orders:",kt),console.log(" Orders count:",kt.length),a(kt)}catch(ve){console.error(" Error loading orders:",ve),f("Failed to load orders")}finally{l(!1)}};N.useEffect(()=>{E()},[]),N.useEffect(()=>{t&&E()},[t]);const F=ve=>new Date(ve).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),A=ve=>{p(ve),g(!0)},q=ve=>{k(ve),w(!0)},H=ve=>{Y(ve),ne(!0)},L=async ve=>{if(console.log("OrdersList handleEditSubmit called with data:",ve),n)n(ve);else try{console.log("Sending PUT request to update order:",ve);const Ze=await fetch(`/api/orders/${ve.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)});if(!Ze.ok)throw new Error(`HTTP error! status: ${Ze.status}`);He.success("Zamwienie zostao zaktualizowane"),E()}catch(Ze){console.error("Error updating order:",Ze),He.error("Bd podczas aktualizacji zamwienia")}},ue=ve=>{W(ve),j(!0),V("")},I=async()=>{if(J==="5202"){if(C?.id)try{e&&e(C.id);const ve=await fetch(`/api/orders/${C.id}`,{method:"DELETE"});if(!ve.ok)throw new Error(`HTTP error! status: ${ve.status}`);const Ze=await ve.json();console.log("Order deleted:",Ze),He.success("Zamwienie zostao usunite"),E()}catch(ve){console.error("Error deleting order:",ve),He.error("Bd podczas usuwania zamwienia")}Oe()}else He.error("Nieprawidowe haso"),V("")},Oe=()=>{j(!1),W(null),V("")},Ae=ve=>{ve.key==="Enter"&&I()},Xe=async ve=>{try{console.log("    WMS  backend, orderId:",ve.id);const Ze=await fetch("/api/wms/send-shipment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:ve.id})}),kt=await Ze.json();if(!Ze.ok)throw new Error(kt.error||`HTTP ${Ze.status}`);return console.log("   backend:",kt),He.success(`   WMS: ${kt.wmsShipmentId||""}`),!0}catch(Ze){return console.error("    WMS:",Ze),He.error(`   WMS: ${Ze instanceof Error?Ze.message:" "}`),!1}},qe=async(ve,Ze)=>{const kt=r.find(Pe=>Pe.id===ve);if(!kt)return;const ce=P[ve]||"przygotowane";if(ce==="przygotowane"&&Ze==="wysane"){const Pe=He.loading("  WMS..."),ze=await Xe(kt);if(He.dismiss(Pe),!ze)return}U(Pe=>({...Pe,[ve]:Ze})),(ce!=="przygotowane"||Ze!=="wysane")&&He.success(`Status zamwienia zmieniony na: ${Ze}`)},pe=ve=>{fe===ve?he(oe==="asc"?"desc":"asc"):(de(ve),he("asc"))},Ne=ve=>r.filter(Ze=>{if(ve.klient!==void 0&&ve.klient&&Ze.klient!==ve.klient||ve.typ!==void 0&&ve.typ&&(Ze.typ||"zamowienie")!==ve.typ)return!1;const kt=mu(Ze.numer_zamowienia);return kt?!(ve.year&&kt.getFullYear().toString()!==ve.year||ve.month&&(kt.getMonth()+1).toString().padStart(2,"0")!==ve.month):!(ve.year||ve.month)}),je=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],_e={zamowienie:"Zamwienie",zwrot:"Zwrot",odpisanie:"Odpisanie"},Qe=Ne({typ:G||void 0,year:X||void 0,month:z||void 0}),ft=new Set(Qe.map(ve=>ve.klient).filter(Boolean)),ht=Array.from(ft).sort((ve,Ze)=>ve.localeCompare(Ze));R&&!ft.has(R)&&(ht.push(R),ht.sort((ve,Ze)=>ve.localeCompare(Ze)));const vt=Ne({klient:R||void 0,year:X||void 0,month:z||void 0}),jt=new Set(vt.map(ve=>ve.typ||"zamowienie")),Gt=Array.from(jt).map(ve=>({value:ve,label:_e[ve]||ve}));G&&!jt.has(G)&&Gt.push({value:G,label:_e[G]||G});const sr=Ne({klient:R||void 0,typ:G||void 0,month:z||void 0}),Rt=new Set(sr.map(ve=>mu(ve.numer_zamowienia)).filter(ve=>ve!==null).map(ve=>ve.getFullYear().toString())),Ht=Array.from(Rt).sort((ve,Ze)=>parseInt(Ze)-parseInt(ve));X&&!Rt.has(X)&&(Ht.push(X),Ht.sort((ve,Ze)=>parseInt(Ze)-parseInt(ve)));const pt=Ne({klient:R||void 0,typ:G||void 0,year:X||void 0}),Nt=new Set(pt.map(ve=>mu(ve.numer_zamowienia)).filter(ve=>ve!==null).map(ve=>(ve.getMonth()+1).toString().padStart(2,"0"))),Yt=je.filter(ve=>Nt.has(ve.value));if(z&&!Nt.has(z)){const ve=je.find(Ze=>Ze.value===z);ve&&Yt.push(ve),Yt.sort((Ze,kt)=>Ze.value.localeCompare(kt.value))}const Bt=r.filter(ve=>{if(R&&ve.klient!==R||G&&(ve.typ||"zamowienie")!==G)return!1;const Ze=mu(ve.numer_zamowienia);return Ze?!(X&&Ze.getFullYear().toString()!==X||z&&(Ze.getMonth()+1).toString().padStart(2,"0")!==z):!X&&!z}).sort((ve,Ze)=>{let kt,ce;switch(fe){case"numer_zamowienia":kt=(ve.numer_zamowienia||"").toLowerCase(),ce=(Ze.numer_zamowienia||"").toLowerCase();break;case"klient":kt=(ve.klient||"").toLowerCase(),ce=(Ze.klient||"").toLowerCase();break;case"laczna_ilosc":kt=ve.laczna_ilosc,ce=Ze.laczna_ilosc;break;case"data_utworzenia":kt=new Date(ve.data_utworzenia),ce=new Date(Ze.data_utworzenia);break;default:kt=ve[fe]||"",ce=Ze[fe]||""}return typeof kt=="string"&&typeof ce=="string"?oe==="asc"?kt.localeCompare(ce):ce.localeCompare(kt):typeof kt=="number"&&typeof ce=="number"?oe==="asc"?kt-ce:ce-kt:kt instanceof Date&&ce instanceof Date?oe==="asc"?kt.getTime()-ce.getTime():ce.getTime()-kt.getTime():0});return o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie zamwie..."})}):c?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",c]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsxs("thead",{className:"sticky top-0 z-10",children:[u.jsxs("tr",{className:"bg-white border-b border-gray-200",children:[u.jsx("th",{colSpan:5,className:"px-8 py-2 font-sora"}),u.jsx("th",{className:"px-4 py-2 text-right font-sora bg-white",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:R,onChange:ve=>S(ve.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Klient"}),ht.map(ve=>u.jsx("option",{value:ve,style:{fontFamily:"Sora, sans-serif"},children:ve},ve))]}),u.jsxs("select",{value:G,onChange:ve=>D(ve.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Typ"}),Gt.map(ve=>u.jsx("option",{value:ve.value,style:{fontFamily:"Sora, sans-serif"},children:ve.label},ve.value))]})]})})]}),u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("numer_zamowienia"),children:"Numer zamwienia"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("klient"),children:"Klient"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("laczna_ilosc"),children:"czna ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>pe("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:X,onChange:ve=>le(ve.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),Ht.map(ve=>u.jsx("option",{value:ve,style:{fontFamily:"Sora, sans-serif"},children:ve},ve))]}),u.jsxs("select",{value:z,onChange:ve=>se(ve.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Miesic"}),Yt.map(ve=>u.jsx("option",{value:ve.value,style:{fontFamily:"Sora, sans-serif"},children:ve.label},ve.value))]})]})})]})]}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Bt.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-8 py-8 text-center text-sm text-gray-500 font-sora",children:"Brak zamwie"})}):Bt.map(ve=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.numer_zamowienia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.klient}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ve.typ==="zwrot"?"bg-red-100 text-red-800 border border-red-200":ve.typ==="odpisanie"?"bg-green-100 text-green-800 border border-green-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:ve.typ==="zwrot"?"Zwrot":ve.typ==="odpisanie"?"Odpisanie":"Zamwienie"})}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:ve.laczna_ilosc}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:F(ve.data_utworzenia)}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:Ze=>{Ze.preventDefault(),Ze.stopPropagation(),A(ve)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(ep,{size:16})}),u.jsx("button",{type:"button",onClick:Ze=>{Ze.preventDefault(),Ze.stopPropagation(),H(ve)},className:"text-purple-200 focus:outline-none font-semibold text-sm",title:"Utwrz faktur",children:"FV"}),u.jsx("button",{type:"button",onClick:Ze=>{Ze.preventDefault(),Ze.stopPropagation(),q(ve)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:Ze=>{Ze.preventDefault(),Ze.stopPropagation(),ue(ve)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Ct,{size:16})})]}),u.jsxs("select",{value:P[ve.id]||"przygotowane",onChange:Ze=>{Ze.preventDefault(),Ze.stopPropagation(),qe(ve.id,Ze.target.value)},onClick:Ze=>Ze.stopPropagation(),className:"px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-0 focus:border-gray-300 font-sora",style:{fontFamily:"Sora, sans-serif"},children:[u.jsx("option",{value:"przygotowane",children:"Przygotowane"}),u.jsx("option",{value:"wysane",children:"Wysane"})]})]})})]},ve.id))})]})}),u.jsx(ar,{isOpen:T,onRequestClose:Oe,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:Oe,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:J,onChange:ve=>V(ve.target.value),onKeyPress:Ae,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:Oe,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:I,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(MO,{isOpen:m,onClose:()=>g(!1),order:h}),u.jsx(IO,{isOpen:v,onClose:()=>{w(!1),k(null)},onSubmit:ve=>{L(ve),w(!1),k(null)},order:b}),u.jsx(WO,{isOpen:B,onClose:()=>{ne(!1),Y(null)},orderData:ee})]})},$O=({isOpen:e,onClose:n,reservation:t})=>{const[r,a]=Te.useState({x:0,y:0}),[o,l]=Te.useState(!1),c=Te.useRef({x:0,y:0});Te.useEffect(()=>{const p=g=>{o&&a({x:g.clientX-c.current.x,y:g.clientY-c.current.y})},m=()=>l(!1);return o&&(window.addEventListener("mousemove",p),window.addEventListener("mouseup",m)),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m)}},[o]);const f=p=>{p.target.closest("button")||p.target.closest("input")||(l(!0),c.current={x:p.clientX-r.x,y:p.clientY-r.y})};if(!t)return null;const h=p=>new Date(p).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"});return u.jsx(ar,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${r.x}px), calc(-50% + ${r.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:f,style:{cursor:o?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy rezerwacji"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Numer rezerwacji"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.numer_rezerwacji})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data utworzenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_utworzenia)})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Klient"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.klient})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakoczenia"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:h(t.data_zakonczenia)})]})]}),t.komentarz&&u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Komentarz"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.komentarz})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[220px]",children:"Nazwa"}),(t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa")&&u.jsx("th",{className:"py-2 text-left w-[85px]"}),u.jsx("th",{className:"px-2 py-2 text-center w-[70px]",children:"Pozostao"}),u.jsx("th",{className:"px-2 py-2 text-center w-[60px]",children:"Wydane"}),u.jsx("th",{className:"px-2 py-2 text-center w-[90px]",children:"Zarezerwowane"})]})}),u.jsx("tbody",{children:t.products&&t.products.length>0?t.products.map(p=>{const m=p.ilosc_wydane??0,g=p.ilosc-m,v=t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa";return u.jsxs("tr",{className:v?"opacity-50":"",children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:p.product_kod}),u.jsx("td",{className:"px-2 py-2 w-[220px] break-words leading-tight",children:p.product_nazwa}),t.status==="anulowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-red-600 font-medium",children:"anulowana"})}),t.status==="zrealizowana"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-blue-600 font-medium",children:"zrealizowana"})}),t.status==="wygasa"&&u.jsx("td",{className:"py-2 w-[85px] text-left",children:u.jsx("span",{className:"text-gray-600 font-medium",children:"wygasa"})}),u.jsx("td",{className:"px-2 py-2 w-[70px] text-center",children:u.jsx("span",{className:g>0&&!v?"text-green-600 font-medium":"text-gray-400",children:g})}),u.jsx("td",{className:`px-2 py-2 w-[60px] text-center ${v?"text-gray-400":"text-red-600"}`,children:m}),u.jsx("td",{className:"px-2 py-2 w-[90px] text-center",children:p.ilosc})]},p.id)}):u.jsx("tr",{children:u.jsx("td",{colSpan:t.status==="anulowana"||t.status==="zrealizowana"||t.status==="wygasa"?6:5,className:"px-2 py-4 text-center text-gray-500",children:"Brak produktw"})})})]})]})]})]})})};Aa("pl",Oa);const HO=({isOpen:e,onClose:n,onSubmit:t,reservation:r})=>{const[a,o]=N.useState(""),[l,c]=N.useState(""),[f,h]=N.useState(null),[p,m]=N.useState(null),[g,v]=N.useState("aktywna"),[w,b]=N.useState(""),[k,T]=N.useState([{kod:"",nazwa:"",ilosc:""}]),[j,C]=N.useState([]),[W,J]=N.useState([]),[V,P]=N.useState(!1),[U,B]=N.useState(null),[ne,ee]=N.useState([]),[Y,fe]=N.useState(!1),[de,oe]=N.useState(null),[he,X]=N.useState(""),[le,z]=N.useState(new Set),[se,R]=N.useState(!1),S=N.useRef(null);N.useEffect(()=>{e&&(async()=>{try{const L=await fetch("/api/working-sheets/search?query=");if(L.ok){const ue=await L.json();J(ue)}}catch(L){console.error("Error loading stock info:",L)}})()},[e]),N.useEffect(()=>{if(e&&r)if(o(r.klient),X(r.klient),oe({nazwa:r.klient,firma:r.firma}),c(r.numer_rezerwacji),v(r.status),b(r.komentarz||""),z(new Set),S.current=null,r.data_utworzenia&&h(new Date(r.data_utworzenia)),r.data_zakonczenia&&m(new Date(r.data_zakonczenia)),r.products&&r.products.length>0){const H=r.products.map(ue=>({kod:ue.product_kod||"",nazwa:ue.product_nazwa||"",ilosc:(ue.ilosc||0).toString(),originalIlosc:ue.ilosc||0,iloscWydane:ue.ilosc_wydane||0}));T(H);const L=r.products.some(ue=>(ue.ilosc_wydane||0)>0);R(L)}else T([{kod:"",nazwa:"",ilosc:""}]),R(!1)},[e,r]),N.useEffect(()=>{const L=setTimeout(async()=>{if(U===null||!k.find((ue,I)=>I===U)?.nazwa.trim()){C([]);return}P(!0);try{const ue=k.find((Ae,Xe)=>Xe===U)?.nazwa||"";if(!ue.trim()){C([]),P(!1);return}const I=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(ue)}`);if(!I.ok)throw new Error("Failed to fetch products");const Oe=await I.json();C(Oe)}catch(ue){console.error("Error searching products:",ue),C([])}finally{P(!1)}},300);return()=>clearTimeout(L)},[k,U]),N.useEffect(()=>{const L=setTimeout(async()=>{if(he.trim().length<2){ee([]);return}fe(!0);try{const ue=await fetch(`/api/clients/search?q=${encodeURIComponent(he)}`);if(!ue.ok)throw new Error("Failed to fetch clients");const I=await ue.json();ee(I)}catch(ue){console.error("Error searching clients:",ue),ee([])}finally{fe(!1)}},300);return()=>clearTimeout(L)},[he]);const G=()=>{T([...k,{kod:"",nazwa:"",ilosc:""}])},D=(H,L)=>{const ue=[...k];ue[H]={...ue[H],kod:L.kod,nazwa:L.nazwa},T(ue),B(null),W.findIndex(Oe=>Oe.kod===L.kod)<0&&J([...W,L])},E=(H,L)=>{const ue=[...k];ue[H].ilosc=L,T(ue);const I=ue[H],Oe=parseInt(L)||0,Ae=I.originalIlosc||0,Xe=I.iloscWydane||0;if(S.current=null,!L.trim()||Oe===0){z(Qe=>{const ft=new Set(Qe);return ft.delete(H),ft});return}const qe=W.find(Qe=>Qe.kod===I.kod),pe=qe?.ilosc||0,Ne=qe?.ilosc_reserved||0,je=pe-Ne+Ae;let _e=null;Oe<Xe?_e=`Nie mona zmniejszy poniej wydanej iloci (${Xe} szt.)`:I.kod&&Oe>je&&(_e=`Niewystarczajca ilo - dostpne do rezerwacji: ${Math.max(0,je-Ae)} szt.`),z(Qe=>{const ft=new Set(Qe);return _e?ft.add(H):ft.delete(H),ft}),_e&&He.error(_e)},F=()=>{if(!de||!a.trim()||!p||le.size>0||k.filter(L=>L.kod.trim()&&L.nazwa.trim()&&L.ilosc.trim()).length===0)return!1;for(let L=0;L<k.length;L++){const ue=k[L];if(!ue.kod.trim()||!ue.nazwa.trim()||!ue.ilosc.trim())continue;const I=parseInt(ue.ilosc)||0,Oe=ue.iloscWydane||0,Ae=ue.originalIlosc||0;if(I<Oe)return!1;if(I>Ae&&ue.kod){const Xe=W.find(je=>je.kod===ue.kod),qe=Xe?.ilosc||0,pe=Xe?.ilosc_reserved||0,Ne=qe-pe+Ae;if(I>Ne)return!1}}return!0},A=async H=>{if(H.preventDefault(),!r)return;if(!de||!a.trim()){He.error("Wybierz klienta");return}if(!l.trim()){He.error("Wprowad numer rezerwacji");return}if(!p){He.error("Wybierz dat zakoczenia");return}const L=k.filter(I=>I.kod.trim()&&I.nazwa.trim()&&I.ilosc.trim());if(L.length===0){He.error("Dodaj produkty do rezerwacji");return}if(!F()){He.error("Popraw bdy w formularzu");return}const ue=L.map(I=>({kod:I.kod,nazwa:I.nazwa,ilosc:parseInt(I.ilosc)||0,originalIlosc:I.originalIlosc||0,iloscWydane:I.iloscWydane||0}));try{const I=await fetch(`/api/reservations/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({klient:a.trim(),numer_rezerwacji:l.trim(),data_utworzenia:f?f.toISOString().split("T")[0]:null,data_zakonczenia:p.toISOString().split("T")[0],status:g,komentarz:w.trim()||null,products:ue})});if(!I.ok){const Oe=await I.json();throw new Error(Oe.error||"Failed to update reservation")}He.success("Rezerwacja zostaa zaktualizowana"),q(),t()}catch(I){console.error("Error updating reservation:",I),He.error(I.message||"Wystpi bd podczas aktualizacji rezerwacji")}},q=()=>{o(""),X(""),oe(null),ee([]),c(""),h(null),m(null),v("aktywna"),b(""),T([{kod:"",nazwa:"",ilosc:""}]),C([]),J([]),B(null),z(new Set),R(!1),S.current=null,n()};return r?u.jsx(ar,{isOpen:e,onRequestClose:q,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj rezerwacj"}),u.jsx("button",{type:"button",onClick:q,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("form",{onSubmit:A,className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx(wn,{selected:f,onChange:()=>{},locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholderText:"Wybierz dat",popperClassName:"z-50",disabled:!0})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:l,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx(wn,{selected:p,onChange:H=>m(H),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:f||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:he,onChange:H=>{se||(X(H.target.value),de&&(oe(null),o("")))},placeholder:"Wyszukaj klienta...",disabled:se,title:se?"Nie mona zmieni klienta - cz towaru zostaa ju wydana":"",className:`w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs ${se?"bg-gray-50 cursor-not-allowed":""}`}),Y&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),ne.length>0&&!de&&!se&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:ne.map(H=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{oe(H),X(H.nazwa),o(H.nazwa),ee([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:H.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:H.firma})]})},H.id))}),de&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:de.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:de.firma})]}),!se&&u.jsx("button",{type:"button",onClick:()=>{oe(null),X(""),o("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(Ct,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:w,onChange:H=>b(H.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),k.map((H,L)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:H.nazwa,onChange:ue=>{const I=[...k];I[L].nazwa=ue.target.value,I[L].kod="",T(I),B(L)},onFocus:()=>B(L),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",disabled:(H.iloscWydane??0)>0})]}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:H.iloscWydane||1,placeholder:"Ilo",value:H.ilosc,onChange:ue=>E(L,ue.target.value),className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${le.has(L)?"border-red-500 bg-red-50":"border-gray-300"}`})})]}),L===k.length-1&&u.jsx("button",{type:"button",onClick:G,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),V&&U===L&&u.jsx("div",{className:"absolute right-24 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),j.length>0&&U===L&&H.nazwa.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[calc(100%-6rem)] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:j.map(ue=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>D(L,ue),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:ue.kod}),ue.nazwa&&ue.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:ue.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:ue.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",ue.ilosc]}),(ue.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",ue.ilosc_reserved??0]})]})},ue.kod))})]},L))]})]}),u.jsxs("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:[u.jsx("button",{type:"button",onClick:q,className:"px-6 py-1.5 text-gray-600 hover:text-gray-800 focus:outline-none text-xs rounded-md font-sora",children:"Anuluj"}),u.jsx("button",{type:"button",onClick:A,disabled:!F(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none transition-colors font-sora ${F()?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:"Zapisz zmiany"})]})]})}):null},YO=({refreshTrigger:e})=>{const[n,t]=N.useState([]),[r,a]=N.useState(!0),[o,l]=N.useState(null),[c,f]=N.useState(null),[h,p]=N.useState(!1),[m,g]=N.useState(!1),[v,w]=N.useState(null),[b,k]=N.useState(!1),[T,j]=N.useState(null),[C,W]=N.useState("data_utworzenia"),[J,V]=N.useState("desc"),[P,U]=N.useState(""),[B,ne]=N.useState(""),[ee,Y]=N.useState(""),[fe,de]=N.useState(""),oe=async()=>{try{console.log(" Starting to load reservations..."),a(!0),l(null),console.log(" Fetching from /api/reservations-with-products...");const L=await fetch("/api/reservations-with-products");if(console.log(" Response status:",L.status),!L.ok)throw new Error(`HTTP error! status: ${L.status}`);const ue=await L.json();console.log(" Raw data received:",ue),console.log(" Raw data length:",ue.length);const I=ue.map(Oe=>({id:Oe.id,numer_rezerwacji:Oe.numer_rezerwacji,klient:Oe.klient||"",firma:Oe.firma||"",data_utworzenia:Oe.data_utworzenia,data_zakonczenia:Oe.data_zakonczenia,status:Oe.status||"aktywna",komentarz:Oe.komentarz||null,laczna_ilosc:Oe.laczna_ilosc||0,products:Oe.products||[]}));console.log(" Transformed reservations:",I),console.log(" Reservations count:",I.length),t(I)}catch(L){console.error(" Error loading reservations:",L),l("Failed to load reservations")}finally{a(!1)}};N.useEffect(()=>{oe()},[]),N.useEffect(()=>{e&&oe()},[e]);const he=L=>new Date(L).toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"}),X=L=>{f(L),p(!0)},le=L=>{w(L),g(!0)},z=L=>{j(L),k(!0)},se=async()=>{if(T)try{const L=await fetch(`/api/reservations/${T.id}/cancel`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!L.ok){const ue=await L.json();throw new Error(ue.error||"Failed to cancel reservation")}He.success("Rezerwacja zostaa anulowana"),k(!1),j(null),oe()}catch(L){console.error("Error cancelling reservation:",L),He.error(L.message||"Wystpi bd podczas anulowania rezerwacji")}},R=L=>{C===L?V(J==="asc"?"desc":"asc"):(W(L),V("asc"))},S=Array.from(new Set(n.map(L=>new Date(L.data_utworzenia).getFullYear().toString()))).sort((L,ue)=>parseInt(ue)-parseInt(L)),G=Array.from(new Set(n.map(L=>L.klient).filter(Boolean))).sort(),D=Array.from(new Set(n.map(L=>L.status).filter(Boolean))).sort(),E=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],F=new Set(n.map(L=>(new Date(L.data_utworzenia).getMonth()+1).toString().padStart(2,"0"))),A=E.filter(L=>F.has(L.value)),H=n.filter(L=>!(P&&new Date(L.data_utworzenia).getFullYear().toString()!==P||B&&(new Date(L.data_utworzenia).getMonth()+1).toString().padStart(2,"0")!==B||ee&&L.klient!==ee||fe&&L.status!==fe)).sort((L,ue)=>{let I,Oe;switch(C){case"numer_rezerwacji":I=(L.numer_rezerwacji||"").toLowerCase(),Oe=(ue.numer_rezerwacji||"").toLowerCase();break;case"klient":I=(L.klient||"").toLowerCase(),Oe=(ue.klient||"").toLowerCase();break;case"status":I=(L.status||"").toLowerCase(),Oe=(ue.status||"").toLowerCase();break;case"laczna_ilosc":I=L.laczna_ilosc,Oe=ue.laczna_ilosc;break;case"data_utworzenia":I=new Date(L.data_utworzenia),Oe=new Date(ue.data_utworzenia);break;case"data_zakonczenia":I=new Date(L.data_zakonczenia),Oe=new Date(ue.data_zakonczenia);break;default:I=L[C]||"",Oe=ue[C]||""}return typeof I=="string"&&typeof Oe=="string"?J==="asc"?I.localeCompare(Oe):Oe.localeCompare(I):typeof I=="number"&&typeof Oe=="number"?J==="asc"?I-Oe:Oe-I:I instanceof Date&&Oe instanceof Date?J==="asc"?I.getTime()-Oe.getTime():Oe.getTime()-I.getTime():0});return r?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx("div",{className:"text-gray-500",children:"adowanie rezerwacji..."})}):o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsxs("div",{className:"text-red-500",children:["Bd: ",o]})}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-end",children:u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-2 gap-y-1",children:[u.jsxs("select",{value:ee,onChange:L=>Y(L.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Klient"}),G.map(L=>u.jsx("option",{value:L,style:{fontFamily:"Sora, sans-serif"},children:L},L))]}),u.jsxs("select",{value:fe,onChange:L=>de(L.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Status"}),D.map(L=>u.jsx("option",{value:L,style:{fontFamily:"Sora, sans-serif"},children:L},L))]}),u.jsxs("select",{value:P,onChange:L=>U(L.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),S.map(L=>u.jsx("option",{value:L,style:{fontFamily:"Sora, sans-serif"},children:L},L))]}),u.jsxs("select",{value:B,onChange:L=>ne(L.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Miesic"}),A.map(L=>u.jsx("option",{value:L.value,style:{fontFamily:"Sora, sans-serif"},children:L.label},L.value))]})]}),(ee||fe||P||B)&&u.jsx("button",{onClick:()=>{Y(""),de(""),U(""),ne("")},className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})}),u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("numer_rezerwacji"),children:"Numer rezerwacji"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("klient"),children:"Klient"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("data_utworzenia"),children:"Data utworzenia"}),u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("data_zakonczenia"),children:"Data zakoczenia"}),u.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("status"),children:"Status"}),u.jsx("th",{className:"px-8 py-4 border-b border-gray-200 bg-gray-50"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak rezerwacji"})}):H.map(L=>u.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>X(L),children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:L.numer_rezerwacji}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:L.klient}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:he(L.data_utworzenia)}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:he(L.data_zakonczenia)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-left",children:u.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded ${L.status==="aktywna"?"bg-green-100 text-green-800":L.status==="anulowana"?"bg-red-100 text-red-800":L.status==="zrealizowana"?"bg-blue-100 text-blue-800":L.status==="wygasa"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:L.status})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-sora",children:u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),L.status==="aktywna"&&le(L)},className:"text-green-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:text-green-600 hover:text-green-800",title:L.status==="aktywna"?"Edytuj":void 0,disabled:L.status!=="aktywna",children:u.jsx(Pl,{size:16})}),L.status==="aktywna"&&u.jsx("button",{type:"button",onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),z(L)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Anuluj rezerwacj",children:u.jsx(bb,{size:16})})]})})]},L.id))})]})}),u.jsx($O,{isOpen:h,onClose:()=>p(!1),reservation:c}),u.jsx(HO,{isOpen:m,onClose:()=>{g(!1),w(null)},onSubmit:()=>{g(!1),w(null),oe()},reservation:v}),u.jsx(ar,{isOpen:b,onRequestClose:()=>{k(!1),j(null)},style:{content:{width:"320px",height:"170px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800"}),u.jsx("button",{onClick:()=>{k(!1),j(null)},className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-4 text-center",children:"Czy na pewno chcesz anulowa rezerwacj?"}),u.jsxs("div",{className:"flex justify-center gap-3 mt-auto",children:[u.jsx("button",{type:"button",onClick:()=>{k(!1),j(null)},className:"px-3 py-1.5 text-xs text-gray-700 bg-gray-100 rounded hover:bg-gray-200 font-sora",children:"Nie"}),u.jsx("button",{type:"button",onClick:se,className:"px-3 py-1.5 text-xs text-white bg-blue-500 rounded hover:bg-blue-600 font-sora",children:"Tak"})]})]})})]})};var kf={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Nv;function VO(){return Nv||(Nv=1,(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var c=arguments[l];c&&(o=a(o,r(c)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var c in o)n.call(o,c)&&o[c]&&(l=a(l,c));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(kf)),kf.exports}var KO=VO();const Qf=Qu(KO);var Cv={};const GO="react-tooltip-core-styles",QO="react-tooltip-base-styles",Tv={core:!1,base:!1};function Dv({css:e,id:n=QO,type:t="base",ref:r}){var a,o;if(!e||typeof document>"u"||Tv[t]||t==="core"&&typeof process<"u"&&(!((a=process==null?void 0:Cv)===null||a===void 0)&&a.REACT_TOOLTIP_DISABLE_CORE_STYLES)||t!=="base"&&typeof process<"u"&&(!((o=process==null?void 0:Cv)===null||o===void 0)&&o.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;t==="core"&&(n=GO),r||(r={});const{insertAt:l}=r;if(document.getElementById(n))return;const c=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.id=n,f.type="text/css",l==="top"&&c.firstChild?c.insertBefore(f,c.firstChild):c.appendChild(f),f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),Tv[t]=!0}const Fv=async({elementReference:e=null,tooltipReference:n=null,tooltipArrowReference:t=null,place:r="top",offset:a=10,strategy:o="absolute",middlewares:l=[rw(Number(a)),nw({fallbackAxisSideDirection:"start"}),Kj({padding:5})],border:c,arrowSize:f=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(n===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const h=l;return t?(h.push(Hf({element:t,padding:5})),Yf(e,n,{placement:r,strategy:o,middleware:h}).then((({x:p,y:m,placement:g,middlewareData:v})=>{var w,b;const k={left:`${p}px`,top:`${m}px`,border:c},{x:T,y:j}=(w=v.arrow)!==null&&w!==void 0?w:{x:0,y:0},C=(b={top:"bottom",right:"left",bottom:"top",left:"right"}[g.split("-")[0]])!==null&&b!==void 0?b:"bottom",W=c&&{borderBottom:c,borderRight:c};let J=0;if(c){const V=`${c}`.match(/(\d+)px/);J=V?.[1]?Number(V[1]):1}return{tooltipStyles:k,tooltipArrowStyles:{left:T!=null?`${T}px`:"",top:j!=null?`${j}px`:"",right:"",bottom:"",...W,[C]:`-${f/2+J}px`},place:g}}))):Yf(e,n,{placement:"bottom",strategy:o,middleware:h}).then((({x:p,y:m,placement:g})=>({tooltipStyles:{left:`${p}px`,top:`${m}px`},tooltipArrowStyles:{},place:g})))},jv=(e,n)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,n),Pv=(e,n,t)=>{let r=null;const a=function(...o){const l=()=>{r=null};!r&&(e.apply(this,o),r=setTimeout(l,n))};return a.cancel=()=>{r&&(clearTimeout(r),r=null)},a},Av=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",Xf=(e,n)=>{if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every(((a,o)=>Xf(a,n[o])));if(Array.isArray(e)!==Array.isArray(n))return!1;if(!Av(e)||!Av(n))return e===n;const t=Object.keys(e),r=Object.keys(n);return t.length===r.length&&t.every((a=>Xf(e[a],n[a])))},XO=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const n=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some((t=>{const r=n.getPropertyValue(t);return r==="auto"||r==="scroll"}))},Ov=e=>{if(!e)return null;let n=e.parentElement;for(;n;){if(XO(n))return n;n=n.parentElement}return document.scrollingElement||document.documentElement},qO=typeof window<"u"?N.useLayoutEffect:N.useEffect,In=e=>{e.current&&(clearTimeout(e.current),e.current=null)},ZO="DEFAULT_TOOLTIP_ID",JO={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},eR=N.createContext({getTooltipData:()=>JO});function gw(e=ZO){return N.useContext(eR).getTooltipData(e)}var qo={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},bf={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const tR=({forwardRef:e,id:n,className:t,classNameArrow:r,variant:a="dark",anchorId:o,anchorSelect:l,place:c="top",offset:f=10,events:h=["hover"],openOnClick:p=!1,positionStrategy:m="absolute",middlewares:g,wrapper:v,delayShow:w=0,delayHide:b=0,float:k=!1,hidden:T=!1,noArrow:j=!1,clickable:C=!1,closeOnEsc:W=!1,closeOnScroll:J=!1,closeOnResize:V=!1,openEvents:P,closeEvents:U,globalCloseEvents:B,imperativeModeOnly:ne,style:ee,position:Y,afterShow:fe,afterHide:de,disableTooltip:oe,content:he,contentWrapperRef:X,isOpen:le,defaultIsOpen:z=!1,setIsOpen:se,activeAnchor:R,setActiveAnchor:S,border:G,opacity:D,arrowColor:E,arrowSize:F=8,role:A="tooltip"})=>{var q;const H=N.useRef(null),L=N.useRef(null),ue=N.useRef(null),I=N.useRef(null),Oe=N.useRef(null),[Ae,Xe]=N.useState({tooltipStyles:{},tooltipArrowStyles:{},place:c}),[qe,pe]=N.useState(!1),[Ne,je]=N.useState(!1),[_e,Qe]=N.useState(null),ft=N.useRef(!1),ht=N.useRef(null),{anchorRefs:vt,setActiveAnchor:jt}=gw(n),Gt=N.useRef(!1),[sr,Rt]=N.useState([]),Ht=N.useRef(!1),pt=p||h.includes("click"),Nt=pt||P?.click||P?.dblclick||P?.mousedown,Yt=P?{...P}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!P&&pt&&Object.assign(Yt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const Ft=U?{...U}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!U&&pt&&Object.assign(Ft,{mouseleave:!1,blur:!1,mouseout:!1});const Bt=B?{...B}:{escape:W||!1,scroll:J||!1,resize:V||!1,clickOutsideAnchor:Nt||!1};ne&&(Object.assign(Yt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(Ft,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(Bt,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),qO((()=>(Ht.current=!0,()=>{Ht.current=!1})),[]);const ve=Ke=>{Ht.current&&(Ke&&je(!0),setTimeout((()=>{Ht.current&&(se?.(Ke),le===void 0&&pe(Ke))}),10))};N.useEffect((()=>{if(le===void 0)return()=>null;le&&je(!0);const Ke=setTimeout((()=>{pe(le)}),10);return()=>{clearTimeout(Ke)}}),[le]),N.useEffect((()=>{if(qe!==ft.current)if(In(Oe),ft.current=qe,qe)fe?.();else{const Ke=(tt=>{const Me=tt.match(/^([\d.]+)(ms|s)$/);if(!Me)return 0;const[,nt,_t]=Me;return Number(nt)*(_t==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));Oe.current=setTimeout((()=>{je(!1),Qe(null),de?.()}),Ke+25)}}),[qe]);const Ze=Ke=>{Xe((tt=>Xf(tt,Ke)?tt:Ke))},kt=(Ke=w)=>{In(ue),Ne?ve(!0):ue.current=setTimeout((()=>{ve(!0)}),Ke)},ce=(Ke=b)=>{In(I),I.current=setTimeout((()=>{Gt.current||ve(!1)}),Ke)},Pe=Ke=>{var tt;if(!Ke)return;const Me=(tt=Ke.currentTarget)!==null&&tt!==void 0?tt:Ke.target;if(!Me?.isConnected)return S(null),void jt({current:null});w?kt():ve(!0),S(Me),jt({current:Me}),In(I)},ze=()=>{C?ce(b||100):b?ce():ve(!1),In(ue)},et=({x:Ke,y:tt})=>{var Me;const nt={getBoundingClientRect:()=>({x:Ke,y:tt,width:0,height:0,top:tt,left:Ke,right:Ke,bottom:tt})};Fv({place:(Me=_e?.place)!==null&&Me!==void 0?Me:c,offset:f,elementReference:nt,tooltipReference:H.current,tooltipArrowReference:L.current,strategy:m,middlewares:g,border:G,arrowSize:F}).then((_t=>{Ze(_t)}))},at=Ke=>{if(!Ke)return;const tt=Ke,Me={x:tt.clientX,y:tt.clientY};et(Me),ht.current=Me},ae=Ke=>{var tt;if(!qe)return;const Me=Ke.target;Me.isConnected&&(!((tt=H.current)===null||tt===void 0)&&tt.contains(Me)||[document.querySelector(`[id='${o}']`),...sr].some((nt=>nt?.contains(Me)))||(ve(!1),In(ue)))},ge=Pv(Pe,50),De=Pv(ze,50),Re=Ke=>{De.cancel(),ge(Ke)},$e=()=>{ge.cancel(),De()},rt=N.useCallback((()=>{var Ke,tt;const Me=(Ke=_e?.position)!==null&&Ke!==void 0?Ke:Y;Me?et(Me):k?ht.current&&et(ht.current):R?.isConnected&&Fv({place:(tt=_e?.place)!==null&&tt!==void 0?tt:c,offset:f,elementReference:R,tooltipReference:H.current,tooltipArrowReference:L.current,strategy:m,middlewares:g,border:G,arrowSize:F}).then((nt=>{Ht.current&&Ze(nt)}))}),[qe,R,he,ee,c,_e?.place,f,m,Y,_e?.position,k,F]);N.useEffect((()=>{var Ke,tt;const Me=new Set(vt);sr.forEach((We=>{oe?.(We)||Me.add({current:We})}));const nt=document.querySelector(`[id='${o}']`);nt&&!oe?.(nt)&&Me.add({current:nt});const _t=()=>{ve(!1)},O=Ov(R),te=Ov(H.current);Bt.scroll&&(window.addEventListener("scroll",_t),O?.addEventListener("scroll",_t),te?.addEventListener("scroll",_t));let K=null;Bt.resize?window.addEventListener("resize",_t):R&&H.current&&(K=tw(R,H.current,rt,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const Q=We=>{We.key==="Escape"&&ve(!1)};Bt.escape&&window.addEventListener("keydown",Q),Bt.clickOutsideAnchor&&window.addEventListener("click",ae);const Z=[],re=We=>!!(We?.target&&R?.contains(We.target)),ke=We=>{qe&&re(We)||Pe(We)},Fe=We=>{qe&&re(We)&&ze()},we=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],Se=["click","dblclick","mousedown","mouseup"];Object.entries(Yt).forEach((([We,Ue])=>{Ue&&(we.includes(We)?Z.push({event:We,listener:Re}):Se.includes(We)&&Z.push({event:We,listener:ke}))})),Object.entries(Ft).forEach((([We,Ue])=>{Ue&&(we.includes(We)?Z.push({event:We,listener:$e}):Se.includes(We)&&Z.push({event:We,listener:Fe}))})),k&&Z.push({event:"pointermove",listener:at});const Ee=()=>{Gt.current=!0},Be=()=>{Gt.current=!1,ze()},Je=C&&(Ft.mouseout||Ft.mouseleave);return Je&&((Ke=H.current)===null||Ke===void 0||Ke.addEventListener("mouseover",Ee),(tt=H.current)===null||tt===void 0||tt.addEventListener("mouseout",Be)),Z.forEach((({event:We,listener:Ue})=>{Me.forEach((Ye=>{var gt;(gt=Ye.current)===null||gt===void 0||gt.addEventListener(We,Ue)}))})),()=>{var We,Ue;Bt.scroll&&(window.removeEventListener("scroll",_t),O?.removeEventListener("scroll",_t),te?.removeEventListener("scroll",_t)),Bt.resize?window.removeEventListener("resize",_t):K?.(),Bt.clickOutsideAnchor&&window.removeEventListener("click",ae),Bt.escape&&window.removeEventListener("keydown",Q),Je&&((We=H.current)===null||We===void 0||We.removeEventListener("mouseover",Ee),(Ue=H.current)===null||Ue===void 0||Ue.removeEventListener("mouseout",Be)),Z.forEach((({event:Ye,listener:gt})=>{Me.forEach((Qt=>{var Vt;(Vt=Qt.current)===null||Vt===void 0||Vt.removeEventListener(Ye,gt)}))}))}}),[R,rt,Ne,vt,sr,P,U,B,pt,w,b]),N.useEffect((()=>{var Ke,tt;let Me=(tt=(Ke=_e?.anchorSelect)!==null&&Ke!==void 0?Ke:l)!==null&&tt!==void 0?tt:"";!Me&&n&&(Me=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`);const nt=new MutationObserver((_t=>{const O=[],te=[];_t.forEach((K=>{if(K.type==="attributes"&&K.attributeName==="data-tooltip-id"&&(K.target.getAttribute("data-tooltip-id")===n?O.push(K.target):K.oldValue===n&&te.push(K.target)),K.type==="childList"){if(R){const Q=[...K.removedNodes].filter((Z=>Z.nodeType===1));if(Me)try{te.push(...Q.filter((Z=>Z.matches(Me)))),te.push(...Q.flatMap((Z=>[...Z.querySelectorAll(Me)])))}catch{}Q.some((Z=>{var re;return!!(!((re=Z?.contains)===null||re===void 0)&&re.call(Z,R))&&(je(!1),ve(!1),S(null),In(ue),In(I),!0)}))}if(Me)try{const Q=[...K.addedNodes].filter((Z=>Z.nodeType===1));O.push(...Q.filter((Z=>Z.matches(Me)))),O.push(...Q.flatMap((Z=>[...Z.querySelectorAll(Me)])))}catch{}}})),(O.length||te.length)&&Rt((K=>[...K.filter((Q=>!te.includes(Q))),...O]))}));return nt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{nt.disconnect()}}),[n,l,_e?.anchorSelect,R]),N.useEffect((()=>{rt()}),[rt]),N.useEffect((()=>{if(!X?.current)return()=>null;const Ke=new ResizeObserver((()=>{setTimeout((()=>rt()))}));return Ke.observe(X.current),()=>{Ke.disconnect()}}),[he,X?.current]),N.useEffect((()=>{var Ke;const tt=document.querySelector(`[id='${o}']`),Me=[...sr,tt];R&&Me.includes(R)||S((Ke=sr[0])!==null&&Ke!==void 0?Ke:tt)}),[o,sr,R]),N.useEffect((()=>(z&&ve(!0),()=>{In(ue),In(I)})),[]),N.useEffect((()=>{var Ke;let tt=(Ke=_e?.anchorSelect)!==null&&Ke!==void 0?Ke:l;if(!tt&&n&&(tt=`[data-tooltip-id='${n.replace(/'/g,"\\'")}']`),tt)try{const Me=Array.from(document.querySelectorAll(tt));Rt(Me)}catch{Rt([])}}),[n,l,_e?.anchorSelect]),N.useEffect((()=>{ue.current&&(In(ue),kt(w))}),[w]);const yt=(q=_e?.content)!==null&&q!==void 0?q:he,Ut=qe&&Object.keys(Ae.tooltipStyles).length>0;return N.useImperativeHandle(e,(()=>({open:Ke=>{if(Ke?.anchorSelect)try{document.querySelector(Ke.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${Ke.anchorSelect}" is not a valid CSS selector`)}Qe(Ke??null),Ke?.delay?kt(Ke.delay):ve(!0)},close:Ke=>{Ke?.delay?ce(Ke.delay):ve(!1)},activeAnchor:R,place:Ae.place,isOpen:!!(Ne&&!T&&yt&&Ut)}))),Ne&&!T&&yt?Te.createElement(v,{id:n,role:A,className:Qf("react-tooltip",qo.tooltip,bf.tooltip,bf[a],t,`react-tooltip__place-${Ae.place}`,qo[Ut?"show":"closing"],Ut?"react-tooltip__show":"react-tooltip__closing",m==="fixed"&&qo.fixed,C&&qo.clickable),onTransitionEnd:Ke=>{In(Oe),qe||Ke.propertyName!=="opacity"||(je(!1),Qe(null),de?.())},style:{...ee,...Ae.tooltipStyles,opacity:D!==void 0&&Ut?D:void 0},ref:H},yt,Te.createElement(v,{className:Qf("react-tooltip-arrow",qo.arrow,bf.arrow,r,j&&qo.noArrow),style:{...Ae.tooltipArrowStyles,background:E?`linear-gradient(to right bottom, transparent 50%, ${E} 50%)`:void 0,"--rt-arrow-size":`${F}px`},ref:L})):null},rR=({content:e})=>Te.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),ti=Te.forwardRef((({id:e,anchorId:n,anchorSelect:t,content:r,html:a,render:o,className:l,classNameArrow:c,variant:f="dark",place:h="top",offset:p=10,wrapper:m="div",children:g=null,events:v=["hover"],openOnClick:w=!1,positionStrategy:b="absolute",middlewares:k,delayShow:T=0,delayHide:j=0,float:C=!1,hidden:W=!1,noArrow:J=!1,clickable:V=!1,closeOnEsc:P=!1,closeOnScroll:U=!1,closeOnResize:B=!1,openEvents:ne,closeEvents:ee,globalCloseEvents:Y,imperativeModeOnly:fe=!1,style:de,position:oe,isOpen:he,defaultIsOpen:X=!1,disableStyleInjection:le=!1,border:z,opacity:se,arrowColor:R,arrowSize:S,setIsOpen:G,afterShow:D,afterHide:E,disableTooltip:F,role:A="tooltip"},q)=>{const[H,L]=N.useState(r),[ue,I]=N.useState(a),[Oe,Ae]=N.useState(h),[Xe,qe]=N.useState(f),[pe,Ne]=N.useState(p),[je,_e]=N.useState(T),[Qe,ft]=N.useState(j),[ht,vt]=N.useState(C),[jt,Gt]=N.useState(W),[sr,Rt]=N.useState(m),[Ht,pt]=N.useState(v),[Nt,Yt]=N.useState(b),[Ft,Bt]=N.useState(null),[ve,Ze]=N.useState(null),kt=N.useRef(le),{anchorRefs:ce,activeAnchor:Pe}=gw(e),ze=De=>De?.getAttributeNames().reduce(((Re,$e)=>{var rt;return $e.startsWith("data-tooltip-")&&(Re[$e.replace(/^data-tooltip-/,"")]=(rt=De?.getAttribute($e))!==null&&rt!==void 0?rt:null),Re}),{}),et=De=>{const Re={place:$e=>{var rt;Ae((rt=$e)!==null&&rt!==void 0?rt:h)},content:$e=>{L($e??r)},html:$e=>{I($e??a)},variant:$e=>{var rt;qe((rt=$e)!==null&&rt!==void 0?rt:f)},offset:$e=>{Ne($e===null?p:Number($e))},wrapper:$e=>{var rt;Rt((rt=$e)!==null&&rt!==void 0?rt:m)},events:$e=>{const rt=$e?.split(" ");pt(rt??v)},"position-strategy":$e=>{var rt;Yt((rt=$e)!==null&&rt!==void 0?rt:b)},"delay-show":$e=>{_e($e===null?T:Number($e))},"delay-hide":$e=>{ft($e===null?j:Number($e))},float:$e=>{vt($e===null?C:$e==="true")},hidden:$e=>{Gt($e===null?W:$e==="true")},"class-name":$e=>{Bt($e)}};Object.values(Re).forEach(($e=>$e(null))),Object.entries(De).forEach((([$e,rt])=>{var yt;(yt=Re[$e])===null||yt===void 0||yt.call(Re,rt)}))};N.useEffect((()=>{L(r)}),[r]),N.useEffect((()=>{I(a)}),[a]),N.useEffect((()=>{Ae(h)}),[h]),N.useEffect((()=>{qe(f)}),[f]),N.useEffect((()=>{Ne(p)}),[p]),N.useEffect((()=>{_e(T)}),[T]),N.useEffect((()=>{ft(j)}),[j]),N.useEffect((()=>{vt(C)}),[C]),N.useEffect((()=>{Gt(W)}),[W]),N.useEffect((()=>{Yt(b)}),[b]),N.useEffect((()=>{kt.current!==le&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")}),[le]),N.useEffect((()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:le==="core",disableBase:le}}))}),[]),N.useEffect((()=>{var De;const Re=new Set(ce);let $e=t;if(!$e&&e&&($e=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),$e)try{document.querySelectorAll($e).forEach((tt=>{Re.add({current:tt})}))}catch{console.warn(`[react-tooltip] "${$e}" is not a valid CSS selector`)}const rt=document.querySelector(`[id='${n}']`);if(rt&&Re.add({current:rt}),!Re.size)return()=>null;const yt=(De=ve??rt)!==null&&De!==void 0?De:Pe.current,Ut=new MutationObserver((tt=>{tt.forEach((Me=>{var nt;if(!yt||Me.type!=="attributes"||!(!((nt=Me.attributeName)===null||nt===void 0)&&nt.startsWith("data-tooltip-")))return;const _t=ze(yt);et(_t)}))})),Ke={attributes:!0,childList:!1,subtree:!1};if(yt){const tt=ze(yt);et(tt),Ut.observe(yt,Ke)}return()=>{Ut.disconnect()}}),[ce,Pe,ve,n,t]),N.useEffect((()=>{de?.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),z&&!jv("border",`${z}`)&&console.warn(`[react-tooltip] "${z}" is not a valid \`border\`.`),de?.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),se&&!jv("opacity",`${se}`)&&console.warn(`[react-tooltip] "${se}" is not a valid \`opacity\`.`)}),[]);let at=g;const ae=N.useRef(null);if(o){const De=o({content:ve?.getAttribute("data-tooltip-content")||H||null,activeAnchor:ve});at=De?Te.createElement("div",{ref:ae,className:"react-tooltip-content-wrapper"},De):null}else H&&(at=H);ue&&(at=Te.createElement(rR,{content:ue}));const ge={forwardRef:q,id:e,anchorId:n,anchorSelect:t,className:Qf(l,Ft),classNameArrow:c,content:at,contentWrapperRef:ae,place:Oe,variant:Xe,offset:pe,wrapper:sr,events:Ht,openOnClick:w,positionStrategy:Nt,middlewares:k,delayShow:je,delayHide:Qe,float:ht,hidden:jt,noArrow:J,clickable:V,closeOnEsc:P,closeOnScroll:U,closeOnResize:B,openEvents:ne,closeEvents:ee,globalCloseEvents:Y,imperativeModeOnly:fe,style:de,position:oe,isOpen:he,defaultIsOpen:X,border:z,opacity:se,arrowColor:R,arrowSize:S,setIsOpen:G,afterShow:D,afterHide:E,disableTooltip:F,activeAnchor:ve,setActiveAnchor:De=>Ze(De),role:A};return Te.createElement(tR,{...ge})}));typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",(e=>{e.detail.disableCore||Dv({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||Dv({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})}));const nR="/assets/entr%20logo%20copy%202@4x-xuoIprT_.png",vw=({isOpen:e,onClose:n,product:t})=>t?u.jsx(ar,{isOpen:e,onRequestClose:n,className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-lg w-full max-h-[80vh] overflow-y-auto relative",children:[u.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:u.jsx(Ct,{size:24})}),u.jsx("h2",{className:"text-xl font-semibold mb-4",children:" "}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.nazwa]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.ilosc]}),u.jsxs("p",{children:[u.jsx("strong",{children:". :"})," ",t.jednostka_miary]}),u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.kod_kreskowy]}),t.data_waznosci&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.data_waznosci]}),t.waga_netto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_netto," "]}),t.waga_brutto&&u.jsxs("p",{children:[u.jsx("strong",{children:" :"})," ",t.waga_brutto," "]}),t.objetosc&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.objetosc," "]}),t.opis&&u.jsxs("p",{children:[u.jsx("strong",{children:":"})," ",t.opis]})]})]})}):null,Ha="",yw=({isOpen:e,onClose:n,receipt:t})=>{const[r]=Te.useState(null),[a,o]=Te.useState(!1),[l,c]=Te.useState({x:0,y:0}),[f,h]=Te.useState(!1),p=Te.useRef({x:0,y:0});Te.useEffect(()=>{const v=b=>{f&&c({x:b.clientX-p.current.x,y:b.clientY-p.current.y})},w=()=>h(!1);return f&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",w)),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",w)}},[f]);const m=v=>{v.target.closest("button")||v.target.closest("input")||(h(!0),p.current={x:v.clientX-l.x,y:v.clientY-l.y})};if(!t)return null;let g=[];if(Array.isArray(t.products))g=t.products;else if(typeof t.products=="string")try{g=JSON.parse(t.products)}catch{g=[]}return u.jsxs(ar,{isOpen:e,onRequestClose:n,style:{content:{width:"850px",height:"520px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${l.x}px), calc(-50% + ${l.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:[u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:m,style:{cursor:f?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy zakupu"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Data zakupu"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.dataPrzyjecia})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Sprzedawca"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.sprzedawca})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Warto"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.wartosc," "]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Koszt dostawy"}),u.jsxs("div",{className:"text-xs text-gray-900 ml-2",children:[t.kosztDostawy," "]})]})]}),(t.productInvoice||t.transportInvoice)&&u.jsxs("div",{className:"mb-4 flex gap-6",children:[t.productInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ha}/uploads/${t.productInvoice}`;console.log(" Opening product invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(tp,{className:"h-4 w-4 mr-1"}),"Faktura za towar (PDF)"]}),t.transportInvoice&&u.jsxs("button",{onClick:()=>{const v=`${Ha}/uploads/${t.transportInvoice}`;console.log(" Opening transport invoice:",v),window.open(v,"_blank","noopener,noreferrer")},className:"inline-flex items-center text-xs text-blue-700 underline hover:text-blue-900 font-sora bg-transparent border-none cursor-pointer",children:[u.jsx(Jf,{className:"h-4 w-4 mr-1"}),"Faktura za transport (PDF)"]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2 text-xs",children:"Produkty:"}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Kod"}),u.jsx("th",{className:"px-2 py-2 text-left w-[180px]",children:"Nazwa"}),u.jsx("th",{className:"px-2 py-2 text-left w-[100px]",children:"Kod kreskowy"}),u.jsx("th",{className:"px-2 py-2 text-center w-[50px]",children:"Ilo"}),u.jsx("th",{className:"px-2 py-2 text-right w-[70px]",children:"Cena"}),u.jsx("th",{className:"px-2 py-2 text-right w-[90px]",children:"Warto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Typ"}),u.jsx("th",{className:"px-2 py-2 text-left w-[80px]",children:"Objto"}),u.jsx("th",{className:"px-2 py-2 text-left w-[90px]",children:"Data wanoci"})]})}),u.jsx("tbody",{children:g.map((v,w)=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.kod}),u.jsx("td",{className:"px-2 py-2 w-[180px] break-words leading-tight",children:v.nazwa}),u.jsx("td",{className:"px-2 py-2 w-[100px] break-words",children:v.kod_kreskowy||"-"}),u.jsx("td",{className:"px-2 py-2 w-[50px] text-center",children:v.ilosc}),u.jsxs("td",{className:"px-2 py-2 w-[70px] text-right",children:[v.cena," "]}),u.jsxs("td",{className:"px-2 py-2 w-[90px] text-right",children:[(v.ilosc*v.cena).toFixed(2).replace(".",",")," "]}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:(()=>{const b=v.typ;return b?{czerwone:"Czerwone",biale:"Biae",musujace:"Musujce",bezalkoholowe:"Bezalkoholowe",ferment:"Ferment",rozowe:"Rowe",slodkie:"Sodkie",aksesoria:"Aksesoria",amber:"Amber"}[b]||b:"-"})()}),u.jsx("td",{className:"px-2 py-2 w-[80px] break-words",children:v.objetosc||"-"}),u.jsx("td",{className:"px-2 py-2 w-[90px] break-words",children:v.dataWaznosci?typeof v.dataWaznosci=="number"?new Date(v.dataWaznosci*1e3).toLocaleDateString("pl-PL"):new Date(v.dataWaznosci).toLocaleDateString("pl-PL"):"-"})]},w))})]})]})]}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]}),u.jsx(vw,{isOpen:a,onClose:()=>o(!1),product:r})]})},aR=({isOpen:e,onClose:n,onAdd:t,initialData:r})=>{const[a,o]=N.useState(""),[l,c]=N.useState(""),[f,h]=N.useState(""),[p,m]=N.useState(""),[g,v]=N.useState("");N.useEffect(()=>{console.log(" useEffect triggered:",{isOpen:e,initialData:r}),e&&r?(console.log(" Setting initial data from props"),o(r.firma),c(r.nazwa),h(r.adres),m(r.czas_dostawy),v(r.kontakt)):e&&!r&&console.log(" Modal opened without initial data - keeping current values")},[e,r]);const w=()=>{if(console.log(" handleSubmit called with values:",{firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g}),console.log(" Trimmed values:",{firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()}),!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()){console.log(" Validation failed: some fields are empty");return}const k={firma:a.trim(),nazwa:l.trim(),adres:f.trim(),czas_dostawy:p.trim(),kontakt:g.trim()};console.log(" Submitting client data:",k),t(k),b()},b=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(ar,{isOpen:e,onRequestClose:b,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodaj klienta"}),u.jsx("button",{onClick:b,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:k=>{console.log(" firma onChange:",k.target.value),o(k.target.value)},placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:k=>c(k.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:k=>m(k.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:k=>v(k.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:w,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Dodaj"})})]})})};Aa("pl",Oa);const _f=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],Rv=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],ww=({isOpen:e,onClose:n,onSubmit:t,receipt:r})=>{const[a,o]=N.useState(null),[l,c]=N.useState(""),[f,h]=N.useState({x:0,y:0}),[p,m]=N.useState(!1),[g,v]=N.useState([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),w=N.useRef({x:0,y:0}),[b,k]=N.useState(""),[T,j]=N.useState(null),[C,W]=N.useState(null),[J,V]=N.useState(null),[P,U]=N.useState(null),B=N.useRef(null),ne=N.useRef(null),[ee,Y]=N.useState(null),[fe,de]=N.useState(null),[oe,he]=N.useState("0,00"),[X,le]=N.useState("0,00"),[z,se]=N.useState("0,00"),R=()=>{const pe=g.reduce((je,_e)=>{const Qe=parseFloat(_e.ilosc.toString().replace(",","."))||0;return je+Qe},0),Ne=parseFloat(b.replace(",","."))||0;return pe>0?(Ne/pe).toFixed(2):"0,00"};N.useEffect(()=>{if(e&&r){let pe=[];if(r.products)if(typeof r.products=="string")try{pe=JSON.parse(r.products)}catch(Ne){console.error("Error parsing products JSON:",Ne),pe=[]}else Array.isArray(r.products)&&(pe=r.products);if(Array.isArray(pe)&&pe.length>0){let Ne=null;if(r.dataPrzyjecia)if(r.dataPrzyjecia.includes("/")){const[_e,Qe,ft]=r.dataPrzyjecia.split("/");Ne=new Date(parseInt(ft),parseInt(Qe)-1,parseInt(_e))}else r.dataPrzyjecia.includes("-")?Ne=new Date(r.dataPrzyjecia):Ne=new Date(r.dataPrzyjecia);if(o(Ne),c(r.sprzedawca||""),k((r.kosztDostawy||0).toFixed(2).replace(".",",")),r.aktualny_kurs!==void 0&&r.aktualny_kurs!==null)he(Number(r.aktualny_kurs).toFixed(2).replace(".",","));else if(r.aktualnyKurs!==void 0&&r.aktualnyKurs!==null)he(String(r.aktualnyKurs).replace(".",","));else{const _e=pe.reduce((vt,jt)=>vt+(jt.ilosc||0),0),Qe=_e?r.kosztDostawy/_e:0,ft=pe[0]?.deliveryCostPerUnitPln||0,ht=Qe?ft/Qe:1;he(ht.toFixed(2).replace(".",","))}if(r.podatek_akcyzowy!==void 0&&r.podatek_akcyzowy!==null)le(Number(r.podatek_akcyzowy).toFixed(2).replace(".",","));else if(r.podatekAkcyzowy!==void 0&&r.podatekAkcyzowy!==null)le(String(r.podatekAkcyzowy).replace(".",","));else{const _e=pe[0]?.podatekAkcyzowyPerLiter??pe[0]?.podatekAkcyzowy??pe[0]?.podatek_akcyzowy??0;le(_e.toFixed(2).replace(".",","))}r.rabat!==void 0&&r.rabat!==null?se(Number(r.rabat).toFixed(2).replace(".",",")):se("0,00");const je=pe.map(_e=>({kod:_e.kod||"",nazwa:_e.nazwa||"",kod_kreskowy:_e.kod_kreskowy||_e.ean||"",ilosc:(_e.ilosc||0).toString(),cena:(_e.cena||0).toFixed(2).replace(".",","),dataWaznosci:_e.dataWaznosci||"",showDataWaznosci:!1,typ:_e.typ||_e.typTowaru||"",objetosc:_e.objetosc||""}));v(je.length>0?je:[{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),V(r.productInvoice||null),U(r.transportInvoice||null),j(null),W(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),k(""),j(null),W(null),V(null),U(null)}else v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),o(null),c(""),k(""),j(null),W(null),V(null),U(null)},[e,r]),N.useEffect(()=>{const pe=je=>{const _e=je.target;if(!_e.closest(".dropdown-container")&&!_e.closest('button[onclick*="toggleDropdown"]')&&Y(null),!_e.closest(".objetosc-dropdown-container")&&!_e.closest('button[onclick*="toggleObjetoscDropdown"]')&&de(null),!_e.closest(".react-datepicker")&&!_e.closest('button[title*="wanoci"]')){const Qe=[...g];let ft=!1;Qe.forEach(ht=>{ht.showDataWaznosci&&(ht.showDataWaznosci=!1,ft=!0)}),ft&&v(Qe)}},Ne=je=>{if(je.key==="Escape"){Y(null),de(null);const _e=[...g];let Qe=!1;_e.forEach(ft=>{ft.showDataWaznosci&&(ft.showDataWaznosci=!1,Qe=!0)}),Qe&&v(_e)}};return document.addEventListener("mousedown",pe),document.addEventListener("keydown",Ne),()=>{document.removeEventListener("mousedown",pe),document.removeEventListener("keydown",Ne)}},[g]);const S=()=>{v([...g,{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}])},G=pe=>{if(g.length>1){const Ne=[...g];Ne.splice(pe,1),v(Ne)}},D=pe=>{const Ne=[...g];Ne[pe].showDataWaznosci=!Ne[pe].showDataWaznosci,v(Ne)},E=(pe,Ne)=>{const je=[...g];je[pe].typ=Ne,v(je),Y(null)},F=pe=>{Y(ee===pe?null:pe)},A=(pe,Ne)=>{const je=[...g];je[pe].objetosc=Ne,v(je),de(null)},q=pe=>{de(fe===pe?null:pe)},H=pe=>{pe.target.closest("button")||pe.target.closest("input")||pe.target.closest(".react-datepicker")||pe.target.closest('[role="button"]')||pe.target.closest(".react-datepicker__input-container")||(m(!0),w.current={x:pe.clientX-f.x,y:pe.clientY-f.y})};N.useEffect(()=>{const pe=je=>{p&&requestAnimationFrame(()=>{h({x:je.clientX-w.current.x,y:je.clientY-w.current.y})})},Ne=()=>{m(!1)};return p&&(window.addEventListener("mousemove",pe),window.addEventListener("mouseup",Ne)),()=>{window.removeEventListener("mousemove",pe),window.removeEventListener("mouseup",Ne)}},[p]);const L=pe=>{const Ne=pe.target.files?.[0];console.log(" Product file selected (edit):",Ne),Ne&&Ne.type==="application/pdf"?(j(Ne),console.log(" Product invoice set (edit):",Ne.name)):console.log(" Invalid product file type (edit):",Ne?.type)},ue=pe=>{const Ne=pe.target.files?.[0];console.log(" Transport file selected (edit):",Ne),Ne&&Ne.type==="application/pdf"?(W(Ne),console.log(" Transport invoice set (edit):",Ne.name)):console.log(" Invalid transport file type (edit):",Ne?.type)},I=()=>{B.current?.click()},Oe=()=>{ne.current?.click()},Ae=async()=>{if(console.log("=== HANDLE SUBMIT DEBUG ==="),console.log("selectedDate:",a),console.log("receipt:",r),!a||!r){console.log("Early return: selectedDate or receipt is null");return}const pe=g.filter(ht=>ht.kod&&ht.nazwa&&ht.ilosc&&ht.cena);if(console.log("productRows:",g),console.log("validProducts:",pe),console.log("validProducts.length:",pe.length),pe.length===0){console.log("Early return: no valid products");return}console.log("Proceeding with submission...");const Ne=pe.map(ht=>({kod:ht.kod,nazwa:ht.nazwa,kod_kreskowy:ht.kod_kreskowy||"",ilosc:parseFloat(ht.ilosc)||0,cena:parseFloat(ht.cena.replace(",","."))||0,dataWaznosci:ht.dataWaznosci||void 0,typ:ht.typ||void 0,objetosc:ht.objetosc?parseFloat(ht.objetosc):void 0})),je=Ne.reduce((ht,vt)=>ht+vt.ilosc*vt.cena,0),_e=parseFloat(b.replace(",","."))||0,Qe=parseFloat(z.replace(",","."))||0,ft=je*(1-Qe/100);console.log("Submitting data:",{id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ft,rabat:Qe+"%",kosztDostawy:_e,products:Ne}),console.log(" Files to submit (edit):",{productInvoice:T,transportInvoice:C}),t({id:r.id,date:a.toLocaleDateString("en-CA"),sprzedawca:l,wartosc:ft,kosztDostawy:_e,aktualnyKurs:parseFloat(oe.replace(",","."))||1,podatekAkcyzowy:parseFloat(X.replace(",","."))||0,rabat:Qe,products:Ne,productInvoice:T||null,transportInvoice:C||null}),Xe()},Xe=()=>{o(null),h({x:0,y:0}),v([{kod:"",nazwa:"",kod_kreskowy:"",ilosc:"",cena:"",dataWaznosci:"",showDataWaznosci:!1,typ:"",objetosc:""}]),k(""),c(""),j(null),W(null),V(null),U(null),n()},qe=()=>g.reduce((pe,Ne)=>{const je=parseFloat(Ne.ilosc)||0,_e=parseFloat(Ne.cena.replace(",","."))||0;return pe+je*_e},0).toFixed(2);return u.jsx(ar,{isOpen:e,onRequestClose:Xe,style:{content:{width:"1000px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${f.x}px), calc(-50% + ${f.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:H,style:{cursor:p?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",onClick:pe=>pe.stopPropagation(),children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie zakupu"}),u.jsx("button",{type:"button",onClick:pe=>{pe.preventDefault(),pe.stopPropagation(),Xe()},className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakupu"}),u.jsx(wn,{selected:a,onChange:pe=>o(pe),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsx("div",{className:"w-[200px] flex items-start",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:b,onKeyPress:pe=>{const Ne=String.fromCharCode(pe.which);(!/[\d,]/.test(Ne)||Ne===","&&pe.target.value.includes(",")||pe.target.value===""&&Ne===",")&&pe.preventDefault()},onChange:pe=>{const Ne=pe.target,je=Ne.selectionStart??0;let _e=Ne.value.replace(/[^\d,]/g,"");if(_e===""){k("");return}if(!_e.includes(","))_e=_e+",00";else{const[ft,ht]=_e.split(",");ht&&ht.length>2&&(_e=`${ft},${ht.slice(0,2)}`)}k(_e),requestAnimationFrame(()=>{const ft=Math.min(je,_e.length);Ne.setSelectionRange(ft,ft)})},className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"}),u.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:""})]})]})}),u.jsxs("div",{className:"flex items-center justify-between w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:L,className:"hidden",ref:B}),u.jsx("button",{type:"button",onClick:I,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za towar",children:u.jsx(tp,{className:"h-4 w-4 text-gray-500"})}),T&&u.jsx("a",{href:URL.createObjectURL(T),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:T.name,children:T.name}),!T&&J&&u.jsx("a",{href:`${Ha}${J}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za towar (PDF)",children:"Faktura za towar (PDF)"})]}),u.jsxs("div",{className:"flex items-center w-48",children:[u.jsx("input",{type:"file",accept:".pdf",onChange:ue,className:"hidden",ref:ne}),u.jsx("button",{type:"button",onClick:Oe,className:"inline-flex items-center justify-center w-8 h-8 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",title:"Dodaj faktur za transport",children:u.jsx(Jf,{className:"h-4 w-4 text-gray-500"})}),C&&u.jsx("a",{href:URL.createObjectURL(C),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:C.name,children:C.name}),!C&&P&&u.jsx("a",{href:`${Ha}${P}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline truncate max-w-24",title:"Faktura za transport (PDF)",children:"Faktura za transport (PDF)"})]})]})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:l,onChange:pe=>c(pe.target.value),placeholder:"Wprowad imi sprzedawcy",className:"w-[300px] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsxs("div",{className:"w-[140px] px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs text-gray-600",children:[R().replace(".",",")," "]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Aktualny kurs"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:oe,onChange:pe=>he(pe.target.value),placeholder:"0,00",className:"w-[96px] px-3 py-1.5 pr-8 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z/"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:X,onChange:pe=>le(pe.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"z"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Rabat (%)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:z,onChange:pe=>se(pe.target.value),placeholder:"0,00",className:"w-[90px] px-3 py-1.5 pr-6 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),u.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none",children:"%"})]})]})]}),u.jsx("div",{className:"mt-2 h-[300px] overflow-y-auto pr-0 pb-8 mb-24",children:g.map((pe,Ne)=>u.jsxs("div",{className:"grid grid-cols-12 gap-1 relative",children:[u.jsxs("div",{className:"col-span-1.5 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Kod"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod",value:pe.kod,onChange:je=>{const _e=[...g];_e[Ne].kod=je.target.value,v(_e)}}),Ne===g.length-1&&u.jsx("button",{onClick:S,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",children:u.jsx(Hn,{size:16})})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Nazwa"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Nazwa",value:pe.nazwa,onChange:je=>{const _e=[...g];_e[Ne].nazwa=je.target.value,v(_e)}})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Kod kreskowy"}),u.jsx("input",{type:"text",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"Kod kreskowy",value:pe.kod_kreskowy,onChange:je=>{const _e=[...g];_e[Ne].kod_kreskowy=je.target.value,v(_e)}})]}),u.jsxs("div",{className:"col-span-1.5",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Ilo"}),u.jsx("input",{type:"number",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"0",value:pe.ilosc,onChange:je=>{const _e=[...g],Qe=je.target.value;(Qe===""||/^\d*$/.test(Qe))&&(_e[Ne].ilosc=Qe,v(_e))}})]}),u.jsxs("div",{className:"col-span-2.9 relative",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Cena"}),u.jsx("div",{className:"relative",children:u.jsx("input",{type:"text",value:pe.cena,onKeyPress:je=>{const _e=String.fromCharCode(je.which);(!/[\d,]/.test(_e)||_e===","&&je.target.value.includes(",")||je.target.value===""&&_e===",")&&je.preventDefault()},onChange:je=>{const _e=je.target,Qe=_e.selectionStart??0;let ft=je.target.value.replace(/[^\d,]/g,"");if(ft===""){const jt=[...g];jt[Ne].cena="",v(jt);return}if(!ft.includes(","))ft=ft+",00";else{const[jt,Gt]=ft.split(",");Gt&&Gt.length>2&&(ft=`${jt},${Gt.slice(0,2)}`)}const vt=[...g];vt[Ne].cena=ft,v(vt),requestAnimationFrame(()=>{const jt=Math.min(Qe,ft.length);_e.setSelectionRange(jt,jt)})},className:"w-[103%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholder:"0,00"})})]}),u.jsxs("div",{className:"col-span-1.8 relative -mr-2",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Warto"}),u.jsx("div",{className:"relative flex items-center",children:u.jsx("input",{type:"text",value:(()=>{const je=parseFloat(pe.ilosc)||0,_e=parseFloat(pe.cena.replace(",","."))||0;return(je*_e).toFixed(2).replace(".",",")})(),readOnly:!0,className:"w-[180%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50 ml-1",placeholder:"0,00"})})]}),u.jsxs("div",{className:"absolute right-0 top-[28px] flex flex-row items-center gap-1 z-50 pointer-events-auto",style:{transform:"translateX(0%)"},children:[u.jsx("button",{type:"button",onClick:()=>D(Ne),className:`p-1 focus:outline-none pointer-events-auto relative z-[60] ${pe.dataWaznosci?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:pe.dataWaznosci?`Termin wanoci: ${pe.dataWaznosci}`:"Dodaj termin wanoci",children:u.jsx(Zf,{size:16})}),u.jsx("button",{onClick:()=>G(Ne),className:"text-red-400 hover:text-red-600 pointer-events-auto",children:u.jsx(Ct,{size:16})})]}),pe.showDataWaznosci&&u.jsx("div",{className:"absolute top-full left-0 mt-1 z-50",style:{left:"calc(100% - 280px)"},children:u.jsx(wn,{selected:pe.dataWaznosci?new Date(pe.dataWaznosci):null,onChange:je=>{const _e=[...g];_e[Ne].dataWaznosci=je?je.toISOString().split("T")[0]:"",_e[Ne].showDataWaznosci=!1,v(_e)},locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>{const je=[...g];je[Ne].showDataWaznosci=!1,v(je)}})}),u.jsxs("div",{className:"col-span-1.8 relative dropdown-container ml-1",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>F(Ne),className:`w-[200%] px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ml-1 ${pe.typ&&_f.find(je=>je.value===pe.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:pe.typ&&_f.find(je=>je.value===pe.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ee===Ne&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-[200%] ml-1",onClick:je=>je.stopPropagation(),children:_f.map(je=>u.jsx("button",{type:"button",onClick:()=>E(Ne,je.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${je.color}`,children:je.label},je.value))})]})]}),u.jsxs("div",{className:"col-span-3 relative ml-20 objetosc-dropdown-container",children:[u.jsx("label",{className:`block text-xs font-medium text-gray-700 mb-2 font-sora ${Ne>0?"invisible":""}`,children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:()=>q(Ne),className:`w-[60%] px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${pe.objetosc?"bg-blue-50 border-blue-300":"bg-white"}`,children:[u.jsx("span",{className:"truncate",children:pe.objetosc?Rv.find(je=>je.value===pe.objetosc)?.label||pe.objetosc:"Wybierz"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),fe===Ne&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-[100] max-h-40 overflow-y-auto w-[60%]",onClick:je=>je.stopPropagation(),style:{maxWidth:"200px"},children:Rv.map(je=>u.jsx("button",{type:"button",onClick:()=>A(Ne,je.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:je.label},je.value))})]})]})]},Ne))})]}),u.jsxs("div",{className:"absolute bottom-4 right-6 flex items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 mr-2",children:"Razem:"}),u.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[qe().replace(".",",")," "]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:Ae,disabled:!a||!g.some(pe=>pe.kod&&pe.nazwa&&pe.ilosc&&pe.cena),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a||!g.some(pe=>pe.kod&&pe.nazwa&&pe.ilosc&&pe.cena)?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz zmiany"})})]})})},sR=({receipts:e,onDelete:n,onUpdate:t,selectedCategory:r=""})=>{const[a,o]=N.useState(null),[l,c]=N.useState(!1),[f,h]=N.useState(!1),[p,m]=N.useState(null),[g,v]=N.useState(!1),[w,b]=N.useState(null),[k,T]=N.useState(""),[j,C]=N.useState({x:0,y:0}),[W,J]=N.useState(!1),V=N.useRef({x:0,y:0}),[P,U]=N.useState("dataPrzyjecia"),[B,ne]=N.useState("desc"),[ee,Y]=N.useState(""),[fe,de]=N.useState(""),oe=A=>{o(A),c(!0)},he=A=>{m(A),h(!0)},X=A=>{b(A),v(!0),T("")},le=()=>{k==="5202"?(w?.id&&(n(w.id),He.success("Zapis zosta usunity")),z()):(He.error("Nieprawidowe haso"),T(""))},z=()=>{v(!1),b(null),T(""),C({x:0,y:0})},se=A=>{A.key==="Enter"&&le()},R=A=>{P===A?ne(B==="asc"?"desc":"asc"):(U(A),ne("asc"))},S=A=>{A.target.closest("button")||A.target.closest("input")||(J(!0),V.current={x:A.clientX-j.x,y:A.clientY-j.y})};N.useEffect(()=>{const A=H=>{W&&requestAnimationFrame(()=>{C({x:H.clientX-V.current.x,y:H.clientY-V.current.y})})},q=()=>{J(!1)};return W&&(window.addEventListener("mousemove",A),window.addEventListener("mouseup",q)),()=>{window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",q)}},[W]);const G=Array.from(new Set(e.map(A=>new Date(A.dataPrzyjecia).getFullYear().toString()))).sort((A,q)=>parseInt(q)-parseInt(A)),D=[{value:"01",label:"Stycze"},{value:"02",label:"Luty"},{value:"03",label:"Marzec"},{value:"04",label:"Kwiecie"},{value:"05",label:"Maj"},{value:"06",label:"Czerwiec"},{value:"07",label:"Lipiec"},{value:"08",label:"Sierpie"},{value:"09",label:"Wrzesie"},{value:"10",label:"Padziernik"},{value:"11",label:"Listopad"},{value:"12",label:"Grudzie"}],F=e.filter(A=>{if(r)if(typeof A.products=="string")try{if(!JSON.parse(A.products).some(L=>L.typ===r))return!1}catch{return!1}else if(Array.isArray(A.products)){if(!A.products.some(H=>H.typ===r))return!1}else return!1;return!(ee&&new Date(A.dataPrzyjecia).getFullYear().toString()!==ee||fe&&(new Date(A.dataPrzyjecia).getMonth()+1).toString().padStart(2,"0")!==fe)}).sort((A,q)=>{let H,L;switch(P){case"dataPrzyjecia":H=new Date(A.dataPrzyjecia),L=new Date(q.dataPrzyjecia);break;case"sprzedawca":H=(A.sprzedawca||"").toLowerCase(),L=(q.sprzedawca||"").toLowerCase();break;case"wartosc":H=A.wartosc,L=q.wartosc;break;case"kosztDostawy":H=A.kosztDostawy,L=q.kosztDostawy;break;default:H=A[P]||"",L=q[P]||""}return typeof H=="string"&&typeof L=="string"?B==="asc"?H.localeCompare(L):L.localeCompare(H):typeof H=="number"&&typeof L=="number"?B==="asc"?H-L:L-H:H instanceof Date&&L instanceof Date?B==="asc"?H.getTime()-L.getTime():L.getTime()-H.getTime():0});return u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("dataPrzyjecia"),children:"Data zakupu"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("sprzedawca"),children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("wartosc"),children:"Warto"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>R("kosztDostawy"),children:"Koszt dostawy"}),u.jsx("th",{className:"px-4 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsxs("div",{className:"flex space-x-1 justify-end",children:[u.jsxs("select",{value:ee,onChange:A=>Y(A.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Rok"}),G.map(A=>u.jsx("option",{value:A,style:{fontFamily:"Sora, sans-serif"},children:A},A))]}),u.jsxs("select",{value:fe,onChange:A=>de(A.target.value),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Miesic"}),D.map(A=>u.jsx("option",{value:A.value,style:{fontFamily:"Sora, sans-serif"},children:A.label},A.value))]})]})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(A=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:A.dataPrzyjecia}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:A.sprzedawca}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[A.wartosc.toFixed(2)," "]}),u.jsxs("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:[A.kosztDostawy.toFixed(2)," "]}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),oe(A)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(ep,{size:16})}),u.jsx("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),he(A)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:q=>{q.preventDefault(),q.stopPropagation(),X(A)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Ct,{size:16})})]})})]},A.id))})]})}),u.jsx(ar,{isOpen:g,onRequestClose:z,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${j.x}px), calc(-50% + ${j.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:S,style:{cursor:W?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:z,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:k,onChange:A=>T(A.target.value),onKeyPress:se,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:z,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:le,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(yw,{isOpen:l,onClose:()=>c(!1),receipt:a}),u.jsx(ww,{isOpen:f,onClose:()=>{h(!1),m(null)},onSubmit:A=>{t({...A,productInvoice:A.productInvoice??void 0,transportInvoice:A.transportInvoice??void 0}),h(!1),m(null)},receipt:p?{id:p.id||0,dataPrzyjecia:p.dataPrzyjecia,sprzedawca:p.sprzedawca,wartosc:p.wartosc,kosztDostawy:p.kosztDostawy,aktualnyKurs:p.aktualnyKurs,podatekAkcyzowy:p.podatekAkcyzowy,aktualny_kurs:p.aktualny_kurs,podatek_akcyzowy:p.podatek_akcyzowy,products:p.products,productInvoice:p.productInvoice,transportInvoice:p.transportInvoice}:null})]})},oR=({isOpen:e,onClose:n,client:t})=>t?u.jsx(ar,{isOpen:e,onRequestClose:n,style:{content:{width:"420px",height:"288px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"16px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Szczegy klienta"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:u.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa firmy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.firma})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Nazwa"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.nazwa})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Adres"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.adres})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Czas dostawy"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.czas_dostawy})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-700 font-sora w-32",children:"Kontakt"}),u.jsx("div",{className:"text-xs text-gray-900 ml-2",children:t.kontakt})]})]})}),u.jsx("button",{onClick:n,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Zamknij"})]})}):null,kw=({isOpen:e,onClose:n,onSubmit:t,client:r})=>{const[a,o]=N.useState(""),[l,c]=N.useState(""),[f,h]=N.useState(""),[p,m]=N.useState(""),[g,v]=N.useState("");N.useEffect(()=>{e&&r?(o(r.firma||""),c(r.nazwa||""),h(r.adres||""),m(r.czas_dostawy||""),v(r.kontakt||"")):(o(""),c(""),h(""),m(""),v(""))},[e,r]);const w=async()=>{if(a.trim()&&l.trim()&&f.trim()&&p.trim()&&g.trim()&&r){const k={id:r.id,firma:a,nazwa:l,adres:f,czas_dostawy:p,kontakt:g};t(k),b()}},b=()=>{o(""),c(""),h(""),m(""),v(""),n()};return u.jsx(ar,{isOpen:e,onRequestClose:b,style:{content:{width:"600px",height:"500px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytowanie klienta"}),u.jsx("button",{onClick:b,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa firmy"}),u.jsx("input",{type:"text",value:a,onChange:k=>o(k.target.value),placeholder:"Wprowad nazw firmy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa"}),u.jsx("input",{type:"text",value:l,onChange:k=>c(k.target.value),placeholder:"Wprowad nazw",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Adres"}),u.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"Wprowad adres",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Czas dostawy"}),u.jsx("input",{type:"text",value:p,onChange:k=>m(k.target.value),placeholder:"Wprowad czas dostawy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kontakt"}),u.jsx("input",{type:"text",value:g,onChange:k=>v(k.target.value),placeholder:"Wprowad kontakt",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:w,disabled:!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${!a.trim()||!l.trim()||!f.trim()||!p.trim()||!g.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:"Zapisz"})})]})})},iR=({clients:e,onDelete:n,onUpdate:t})=>{console.log(" ClientsList render - clients:",e),console.log(" ClientsList render - clients length:",e.length),console.log(" ClientsList render - first client:",e[0]),console.log(" ClientsList render - all clients:",e.map(z=>({id:z.id,firma:z.firma,nazwa:z.nazwa})));const[r,a]=N.useState(null),[o,l]=N.useState(!1),[c,f]=N.useState(!1),[h,p]=N.useState(null),[m,g]=N.useState(!1),[v,w]=N.useState(null),[b,k]=N.useState(""),[T,j]=N.useState({x:0,y:0}),[C,W]=N.useState(!1),J=N.useRef({x:0,y:0}),[V,P]=N.useState(""),[U,B]=N.useState("asc");N.useEffect(()=>{console.log(" ClientsList useEffect - clients changed:",e),console.log(" ClientsList useEffect - clients length:",e.length)},[e]);const ne=z=>{a(z),l(!0)},ee=z=>{p(z),f(!0)},Y=z=>{w(z),g(!0),k("")},fe=()=>{b==="5202"?(v?.id&&n(v.id),de()):(He.error("Nieprawidowe haso"),k(""))},de=()=>{g(!1),w(null),k(""),j({x:0,y:0})},oe=z=>{z.key==="Enter"&&fe()},he=z=>{V===z?B(U==="asc"?"desc":"asc"):(P(z),B("asc"))},X=z=>{z.target.closest("button")||z.target.closest("input")||(W(!0),J.current={x:z.clientX-T.x,y:z.clientY-T.y})};N.useEffect(()=>{const z=R=>{C&&requestAnimationFrame(()=>{j({x:R.clientX-J.current.x,y:R.clientY-J.current.y})})},se=()=>{W(!1)};return C&&(window.addEventListener("mousemove",z),window.addEventListener("mouseup",se)),()=>{window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",se)}},[C]),console.log(" Sorting logic - sortField:",V,"sortDirection:",U),console.log(" Sorting logic - clients length:",e.length);const le=V?[...e].sort((z,se)=>{let R,S;switch(V){case"firma":R=(z.firma||"").toLowerCase(),S=(se.firma||"").toLowerCase();break;case"nazwa":R=(z.nazwa||"").toLowerCase(),S=(se.nazwa||"").toLowerCase();break;case"adres":R=(z.adres||"").toLowerCase(),S=(se.adres||"").toLowerCase();break;case"czas_dostawy":R=(z.czas_dostawy||"").toLowerCase(),S=(se.czas_dostawy||"").toLowerCase();break;case"kontakt":R=(z.kontakt||"").toLowerCase(),S=(se.kontakt||"").toLowerCase();break;default:R=z[V]||"",S=se[V]||""}return typeof R=="string"&&typeof S=="string"?U==="asc"?R.localeCompare(S):S.localeCompare(R):0}):e;return console.log(" Final sortedClients length:",le.length),console.log(" Final sortedClients first:",le[0]),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${V==="firma"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>he("firma"),children:["Nazwa firmy ",V==="firma"&&(U==="asc"?"":"")]}),u.jsxs("th",{className:`px-8 py-4 text-left text-xs font-bold uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 ${V==="nazwa"?"bg-blue-100 text-blue-700":"bg-gray-50 text-gray-700"}`,onClick:()=>he("nazwa"),children:["Nazwa ",V==="nazwa"&&(U==="asc"?"":"")]}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>he("adres"),children:"Adres"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>he("czas_dostawy"),children:"Czas dostawy"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>he("kontakt"),children:"Kontakt"}),u.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:V&&u.jsx("button",{onClick:()=>{P(""),B("asc")},className:"text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded border border-gray-300 hover:border-gray-400",title:" ",children:""})})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:le.map((z,se)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:z.firma}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:z.nazwa}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:z.adres}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:z.czas_dostawy}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:z.kontakt}),u.jsx("td",{className:"px-8 py-3 text-left text-sm text-gray-600 font-sora",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{type:"button",onClick:R=>{R.preventDefault(),R.stopPropagation(),ne(z)},className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Zobacz szczegy",children:u.jsx(ep,{size:16})}),u.jsx("button",{type:"button",onClick:R=>{R.preventDefault(),R.stopPropagation(),ee(z)},className:"text-green-600 hover:text-green-800 focus:outline-none",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{type:"button",onClick:R=>{R.preventDefault(),R.stopPropagation(),Y(z)},className:"text-red-600 hover:text-red-800 focus:outline-none",title:"Usu",children:u.jsx(Ct,{size:16})})]})})]},z.id||`client-${se}`))})]})}),u.jsx(ar,{isOpen:m,onRequestClose:de,style:{content:{width:"400px",height:"200px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:`translate(calc(-50% + ${T.x}px), calc(-50% + ${T.y}px))`,margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",cursor:"grab",userSelect:"none",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",onMouseDown:X,style:{cursor:C?"grabbing":"grab"},children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Haso"}),u.jsx("button",{onClick:de,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-6 flex-grow",children:u.jsx("div",{children:u.jsx("input",{type:"password",value:b,onChange:z=>k(z.target.value),onKeyPress:oe,placeholder:"Wprowad haso",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",autoFocus:!0})})}),u.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[u.jsx("button",{onClick:de,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none text-sm",children:"Anuluj"}),u.jsx("button",{onClick:fe,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none text-sm",children:"Usu"})]})]})}),u.jsx(oR,{isOpen:o,onClose:()=>l(!1),client:r}),u.jsx(kw,{isOpen:c,onClose:()=>{f(!1),p(null)},onSubmit:z=>{t(z),f(!1),p(null)},client:h})]})};Aa("pl",Oa);const Sf=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],lR=[{value:"0.375",label:"0,375l"},{value:"0.5",label:"0,5l"},{value:"0.75",label:"0,75l"},{value:"1",label:"1l"},{value:"1.5",label:"1,5l"},{value:"3",label:"3l"}],cR=({isOpen:e,onClose:n,item:t,onSave:r})=>{const[a,o]=N.useState({sprzedawca:"",typ:"",objetosc:"",data_waznosci:"",cena:"",cena_sprzedazy:"",koszt_dostawy_per_unit:"",podatek_akcyzowy_per_liter:"2.22",kurs:"4.25"}),[l,c]=N.useState(!1),[f,h]=N.useState(!1),[p,m]=N.useState(!1),[g,v]=N.useState(!1),[w,b]=N.useState(null);N.useEffect(()=>{if(t){const P=async()=>{try{const U=await fetch(`/api/working-sheets/kurs/${encodeURIComponent(t.kod)}`);if(U.ok){const B=await U.json();console.log(` Loaded exchange rate for ${t.kod}: ${B.kurs}`),o(ne=>({...ne,kurs:B.kurs.toString()}))}else console.warn(` Failed to load exchange rate for ${t.kod}, using default 4.25`)}catch(U){console.error("Error loading exchange rate:",U)}};if(o({sprzedawca:t.sprzedawca||"",typ:t.typ||"",objetosc:t.objetosc&&t.objetosc>0?t.objetosc.toString():"0,75",data_waznosci:t.data_waznosci?(()=>{if(typeof t.data_waznosci=="string")return t.data_waznosci;if(typeof t.data_waznosci=="number"){const U=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;return new Date(U).toISOString().split("T")[0]}return""})():"",cena:t.cena?t.cena.toString():"",cena_sprzedazy:t.cena_sprzedazy?t.cena_sprzedazy.toString():"",koszt_dostawy_per_unit:t.koszt_dostawy_per_unit?t.koszt_dostawy_per_unit.toString():"",podatek_akcyzowy_per_liter:t.podatek_akcyzowy&&t.objetosc&&t.objetosc>0?(t.podatek_akcyzowy/t.objetosc).toFixed(2):"2.22",kurs:"4.25"}),P(),t.data_waznosci){let U;if(typeof t.data_waznosci=="string")U=new Date(t.data_waznosci);else{const B=t.data_waznosci<1e12?t.data_waznosci*1e3:t.data_waznosci;U=new Date(B)}b(isNaN(U.getTime())?null:U)}else b(null)}},[t]);const k=P=>{o(U=>({...U,typ:P})),h(!1)},T=()=>{h(!f)},j=P=>{o(U=>({...U,objetosc:P})),m(!1)},C=()=>{m(!p)},W=()=>{v(!g)},J=P=>{b(P),o(U=>({...U,data_waznosci:P?P.toISOString().split("T")[0]:""})),v(!1)};N.useEffect(()=>{const P=B=>{const ne=B.target;f&&!ne.closest(".dropdown-container")&&h(!1),p&&!ne.closest(".dropdown-container")&&m(!1),g&&!ne.closest(".react-datepicker")&&!ne.closest('button[title*="wanoci"]')&&v(!1)},U=B=>{B.key==="Escape"&&(h(!1),m(!1),v(!1))};return(f||p||g)&&(document.addEventListener("mousedown",P),document.addEventListener("keydown",U)),()=>{document.removeEventListener("mousedown",P),document.removeEventListener("keydown",U)}},[f,p,g]);const V=async P=>{if(P&&P.preventDefault(),!!t){c(!0);try{if(!(await fetch("/api/working-sheets/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(String(a.objetosc||"0").replace(",","."))||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(String(a.cena||"0").replace(",","."))||void 0,cena_sprzedazy:parseFloat(String(a.cena_sprzedazy||"0").replace(",","."))||void 0,koszt_dostawy_per_unit:parseFloat(String(a.koszt_dostawy_per_unit||"0").replace(",","."))||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(String(a.podatek_akcyzowy_per_liter||"0").replace(",","."))*parseFloat(String(a.objetosc||"0").replace(",",".")):void 0,kurs:parseFloat(a.kurs)||4.25})})).ok)throw new Error("Failed to update item");const B={...t,sprzedawca:a.sprzedawca,typ:a.typ,objetosc:parseFloat(a.objetosc)||0,data_waznosci:a.data_waznosci||null,cena:parseFloat(a.cena)||void 0,cena_sprzedazy:parseFloat(a.cena_sprzedazy)||void 0,koszt_dostawy_per_unit:parseFloat(a.koszt_dostawy_per_unit)||void 0,podatek_akcyzowy:a.podatek_akcyzowy_per_liter&&a.objetosc?parseFloat(a.podatek_akcyzowy_per_liter)*parseFloat(a.objetosc):void 0};if(a.cena&&parseFloat(a.cena)!==(t.cena||0))try{(await fetch("/api/price-history",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kod:t.kod,nazwa:t.nazwa,cena:t.cena||0,data_zmiany:new Date().toISOString().split("T")[0],ilosc_fixed:t.ilosc})})).ok?console.log("Price history record created successfully"):console.error("Failed to create price history record")}catch(ne){console.error("Error creating price history record:",ne)}r(B),He.success("Pozycja zostaa zaktualizowana pomylnie"),n()}catch(U){console.error("Error updating item:",U),He.error("Bd podczas aktualizacji pozycji")}finally{c(!1)}}};return!e||!t?null:u.jsx(ar,{isOpen:e,onRequestClose:n,style:{content:{width:"500px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Edytuj pozycj"}),u.jsx("button",{onClick:n,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsx("form",{onSubmit:V,className:"space-y-6 flex-grow",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Nazwa produktu"}),u.jsx("input",{type:"text",value:t.nazwa,disabled:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md bg-gray-50 font-sora text-xs"})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-[2]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Sprzedawca"}),u.jsx("input",{type:"text",value:a.sprzedawca,onChange:P=>o(U=>({...U,sprzedawca:P.target.value})),className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Typ"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:T,className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.typ&&Sf.find(P=>P.value===a.typ)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate",children:a.typ&&Sf.find(P=>P.value===a.typ)?.label||"Wybierz typ"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:P=>P.stopPropagation(),children:Sf.map(P=>u.jsx("button",{type:"button",onClick:()=>k(P.value),className:`w-full px-3 py-2 text-left text-xs hover:bg-gray-50 ${P.color}`,children:P.label},P.value))})]})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1 relative dropdown-container",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Objto"}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{type:"button",onClick:C,className:`w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${a.objetosc,"bg-blue-50 border-blue-300"}`,children:[u.jsx("span",{className:"truncate",children:a.objetosc?`${a.objetosc}l`:"0,75l"}),u.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md z-50 max-h-40 overflow-y-auto w-full",onClick:P=>P.stopPropagation(),children:lR.map(P=>u.jsx("button",{type:"button",onClick:()=>j(P.value),className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50",children:P.label},P.value))})]})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data wanoci"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:w?w.toLocaleDateString("pl-PL"):"",readOnly:!0,placeholder:"Wybierz dat",className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50"}),u.jsx("button",{type:"button",onClick:W,className:`p-1 focus:outline-none ${w?"text-green-600 hover:text-green-700":"text-gray-500 hover:text-gray-700"}`,title:w?`Termin wanoci: ${w.toLocaleDateString("pl-PL")}`:"Dodaj termin wanoci",children:u.jsx(Zf,{size:16})})]}),g&&u.jsx("div",{className:"absolute bottom-full left-0 mb-1 z-50",children:u.jsx(wn,{selected:w,onChange:J,locale:"pl",dateFormat:"dd/MM/yyyy",inline:!0,popperClassName:"z-50",minDate:new Date,onCalendarClose:()=>v(!1)})})]})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena fakturowa ()"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena,onChange:P=>o(U=>({...U,cena:P.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Cena w sprzeday (z)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.cena_sprzedazy,onChange:P=>o(U=>({...U,cena_sprzedazy:P.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]}),u.jsx("div",{className:"flex gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Kurs walutowy"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.kurs,onChange:P=>o(U=>({...U,kurs:P.target.value})),placeholder:"4.25",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Koszt dostawy butelki"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.koszt_dostawy_per_unit,onChange:P=>o(U=>({...U,koszt_dostawy_per_unit:P.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Pod. akcyz. (l)"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:a.podatek_akcyzowy_per_liter,onChange:P=>o(U=>({...U,podatek_akcyzowy_per_liter:P.target.value})),placeholder:"0.00",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]})]})]})}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:V,disabled:l,className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Zapisywanie...":"Zapisz"})})]})})},uR=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .resizable-table {
    table-layout: fixed !important;
    width: max-content !important;
    min-width: 100% !important;
  }
  
  .resizable-table th,
  .resizable-table td {
    box-sizing: border-box !important;
    overflow: visible !important;
  }
  
  /* no generic resizable columns */
`,Ef=[{value:"czerwone",label:"Czerwone",color:"bg-red-100 text-red-800 border-red-200"},{value:"biale",label:"Biae",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"musujace",label:"Musujce",color:"bg-yellow-50 text-yellow-600 border-yellow-100"},{value:"bezalkoholowe",label:"Bezalkoholowe",color:"bg-green-100 text-green-800 border-green-200"},{value:"ferment",label:"Ferment",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"rozowe",label:"Rowe",color:"bg-pink-100 text-pink-800 border-pink-200"},{value:"slodkie",label:"Sodkie",color:"bg-purple-100 text-purple-800 border-purple-200"},{value:"aksesoria",label:"Aksesoria",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},{value:"amber",label:"Amber",color:"bg-amber-100 text-amber-800 border-amber-200"}],zv=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f.toLocaleDateString("pl-PL")}return""}catch(n){return console.error("Error extracting date from order number:",n),""}},dR=e=>{try{const n=/(\d{1,2})_(\d{1,2})_(\d{4})$/,t=e.match(n);if(t){const o=t[1].padStart(2,"0"),l=t[2].padStart(2,"0"),c=t[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}const r=/(\d{1,2})-(\d{1,2})-(\d{4})$/,a=e.match(r);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0"),c=a[3],f=new Date(`${c}-${l}-${o}`);if(!isNaN(f.getTime()))return f}return null}catch(n){return console.error("Error extracting date from order number:",n),null}},fR=({refreshTrigger:e,productReceipts:n=[]})=>{N.useEffect(()=>{const ae=document.createElement("style");return ae.textContent=uR,document.head.appendChild(ae),()=>{document.head.removeChild(ae)}},[]),console.log("=== InventoryStatus Component DEBUG ==="),console.log("productReceipts received:",n),console.log("productReceipts length:",n.length);const[t,r]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState([]),[f,h]=N.useState(!0),[p,m]=N.useState(null),[g,v]=N.useState(!1),[w,b]=N.useState(null),[k,T]=N.useState(""),[j,C]=N.useState(""),[W,J]=N.useState(()=>localStorage.getItem("sortField")||"nazwa"),[V,P]=N.useState(()=>localStorage.getItem("sortDirection")||"asc"),[U,B]=N.useState([]),[ne,ee]=N.useState({sprzedawca:"",typ:"",objetosc:"",status:""}),[Y,fe]=N.useState(!1),[de,oe]=N.useState(null),[he,X]=N.useState({}),[le,z]=N.useState({}),[se,R]=N.useState({}),[S,G]=N.useState({}),[D,E]=N.useState({}),[F,A]=N.useState(()=>{const ae=localStorage.getItem("columnWidths");if(ae)try{return JSON.parse(ae)}catch(ge){console.error("Error parsing saved column widths:",ge)}return{nazwa:250}}),[q,H]=N.useState(null),[L,ue]=N.useState(0),[I,Oe]=N.useState(0),[Ae,Xe]=N.useState(!1),qe=N.useRef(null),[pe,Ne]=N.useState(()=>{const ae=new Date;return`${ae.getFullYear()}-${String(ae.getMonth()+1).padStart(2,"0")}-${String(ae.getDate()).padStart(2,"0")}`});N.useEffect(()=>{const ae=()=>{const De=new Date,Re=`${De.getFullYear()}-${String(De.getMonth()+1).padStart(2,"0")}-${String(De.getDate()).padStart(2,"0")}`;Ne($e=>$e!==Re?(console.log(` Date changed: ${$e}  ${Re}, triggering averageSalesCache recalculation`),Re):$e)};ae();const ge=setInterval(ae,6e4);return()=>clearInterval(ge)},[]);const je=N.useMemo(()=>{console.log("Building sprzedawcaCache with productReceipts:",n);const ae=new Map;try{for(const ge of n)if(Array.isArray(ge.products))for(const De of ge.products)De.kod&&!ae.has(De.kod)&&ae.set(De.kod,ge.sprzedawca)}catch(ge){console.error("Error building sprzedawcaCache:",ge)}return console.log("sprzedawcaCache built with",ae.size,"entries"),ae},[n]),_e=N.useMemo(()=>{console.log("Building averageSalesCache with inventory:",t.length,"items");const ae=new Map;try{for(const ge of t){const De=D[ge.kod],Re=De?new Date(De):null;if(Re&&!isNaN(Re.getTime())){const rt=Math.max(1,Math.ceil((new Date().getTime()-Re.getTime())/(1e3*60*60*24))),yt=a.filter(Ut=>Ut.kod===ge.kod).reduce((Ut,Ke)=>Ut+Ke.ilosc,0);ae.set(ge.kod,yt/rt)}else ae.set(ge.kod,0)}}catch(ge){console.error("Error building averageSalesCache:",ge)}return console.log("averageSalesCache built with",ae.size,"entries"),ae},[t,a,D,pe]),Qe=async()=>{try{const ae=await fetch("/api/products");if(ae.ok){const ge=await ae.json(),De={};ge.forEach(Re=>{Re.status!=="samples"&&(De[Re.kod]||(De[Re.kod]=[]),De[Re.kod].push({cena:Re.cena,ilosc_aktualna:Re.ilosc_aktualna,data_zmiany:Re.updated_at||Re.created_at}))}),Object.keys(De).forEach(Re=>{De[Re].sort(($e,rt)=>new Date(rt.data_zmiany).getTime()-new Date($e.data_zmiany).getTime())}),X(De)}}catch(ae){console.error("Error loading all products:",ae)}},ft=ae=>{const ge=a.filter(Re=>Re.kod===ae);if(ge.length===0)return null;let De=null;return ge.forEach(Re=>{let $e=null;Re.numer_zamowienia&&($e=dR(Re.numer_zamowienia)),!$e&&Re.created_at&&($e=new Date(Re.created_at)),$e&&(!De||$e>De)&&(De=$e)}),De},ht=async()=>{try{console.log("Starting loadInventory..."),h(!0),m(null),console.log("Fetching working-sheets...");const ae=await fetch("/api/working-sheets");if(!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const ge=await ae.json();console.log("Inventory data from server:",ge.length,"items"),ge.length>0&&(console.log("First item keys:",Object.keys(ge[0])),console.log("First item typ value:",ge[0].typ),ge[0].data_waznosci&&(console.log("First item data_waznosci:",ge[0].data_waznosci),console.log("First item data_waznosci type:",typeof ge[0].data_waznosci),console.log("First item data_waznosci formatted:",et(ge[0].data_waznosci)))),r(ge),console.log("Fetching orders...");const De=await fetch("/api/orders");if(!De.ok)throw new Error(`HTTP error! status: ${De.status}`);const Re=await De.json();console.log("Orders data from server:",Re.length,"items"),c(Re),console.log("Fetching orders-with-products...");const $e=await fetch("/api/orders-with-products");if(!$e.ok)throw new Error(`HTTP error! status: ${$e.status}`);const rt=await $e.json();console.log("Orders with products from server:",rt.length,"items");const yt=[];rt.forEach(Me=>{Me.products&&Me.products.forEach(nt=>{yt.push({...nt,orderId:Me.id,created_at:nt.created_at||Me.data_utworzenia,numer_zamowienia:Me.numer_zamowienia})})}),console.log("Total order products:",yt.length),o(yt),await Qe();const Ut=await fetch("/api/products/samples-count");if(Ut.ok){const Me=await Ut.json(),nt={};Me.forEach(_t=>{nt[_t.kod]=_t.total_ilosc||0}),z(nt)}try{const Me=await fetch("/api/products/reservations-count");if(Me.ok){const nt=await Me.json(),_t={};nt.forEach(O=>{_t[O.kod]=O.total_ilosc||0}),R(_t),console.log(" Reservations count loaded:",_t)}else console.error(" Failed to load reservations count:",Me.status)}catch(Me){console.error(" Error loading reservations count:",Me)}const Ke=await fetch("/api/products/wartosc-towaru");if(Ke.ok){const Me=await Ke.json(),nt={};Me.forEach(_t=>{nt[_t.kod]=_t.wartosc||0}),G(nt)}const tt=await fetch("/api/products/oldest-date");if(tt.ok){const Me=await tt.json(),nt={};Me.forEach(_t=>{nt[_t.kod]=_t.oldest_created_at||""}),E(nt),console.log(" Oldest product dates loaded:",Object.keys(nt).length)}console.log("loadInventory completed successfully")}catch(ae){console.error("Error loading inventory:",ae),m(`Failed to load inventory: ${ae instanceof Error?ae.message:"Unknown error"}`)}finally{h(!1)}};N.useEffect(()=>{ht()},[]),N.useEffect(()=>{e&&ht()},[e]);const vt=ae=>{if(W===ae){const ge=V==="asc"?"desc":"asc";P(ge),localStorage.setItem("sortDirection",ge)}else J(ae),P("asc"),localStorage.setItem("sortField",ae),localStorage.setItem("sortDirection","asc")},jt=ae=>{const ge=Ef.find(De=>De.value===ae);return ge?ge.color:"bg-gray-100 text-gray-800 border-gray-200"},Gt=ae=>ae===1/0?"bg-gray-100 text-gray-800 border-gray-200":ae<=30?"bg-red-100 text-gray-800 border-red-200":ae<=60?"bg-yellow-100 text-gray-800 border-yellow-200":"bg-green-100 text-gray-800 border-green-200",sr=N.useMemo(()=>{const ae=new Set;return t.forEach(ge=>{const De=ge.sprzedawca||je.get(ge.kod);De&&ae.add(De)}),Array.from(ae).sort()},[t,je]),Rt=N.useMemo(()=>{const ae=new Set;return t.forEach(ge=>{ge.typ&&ae.add(ge.typ)}),Array.from(ae).sort()},[t]),Ht=N.useMemo(()=>{const ae=new Set;return t.forEach(ge=>{ge.objetosc&&ae.add(ge.objetosc.toString())}),Array.from(ae).sort((ge,De)=>parseFloat(ge)-parseFloat(De))},[t]),pt=N.useMemo(()=>{const ae=new Set;return t.forEach(ge=>{if(ge.ilosc===0)ae.add("brak");else{const De=_e.get(ge.kod)||0,Re=De<=0?1/0:Math.floor(ge.ilosc/De),$e=Re===1/0?"Brak danych":Re<=30?"mao":Re<=60?"rednie":"duo";ae.add($e)}}),Array.from(ae).sort()},[t,_e]),Nt=t.filter(ae=>{if(!(ae.kod.toLowerCase().includes(j.toLowerCase())||ae.nazwa.toLowerCase().includes(j.toLowerCase())||ae.kod_kreskowy&&ae.kod_kreskowy.toLowerCase().includes(j.toLowerCase()))||ne.sprzedawca&&(ae.sprzedawca||je.get(ae.kod))!==ne.sprzedawca||ne.typ&&ae.typ!==ne.typ||ne.objetosc&&ae.objetosc?.toString()!==ne.objetosc)return!1;if(ne.status){let De;if(ae.ilosc===0)De="brak";else{const Re=_e.get(ae.kod)||0,$e=Re<=0?1/0:Math.floor(ae.ilosc/Re);De=$e===1/0?"Brak danych":$e<=30?"mao":$e<=60?"rednie":"duo"}if(De!==ne.status)return!1}return!0}).sort((ae,ge)=>{let De,Re;switch(W){case"sprzedawca":De=ae.sprzedawca||je.get(ae.kod)||"",Re=ge.sprzedawca||je.get(ge.kod)||"";break;case"cena":De=ae.cena||0,Re=ge.cena||0;break;case"cena_sprzedazy":De=ae.cena_sprzedazy||0,Re=ge.cena_sprzedazy||0;break;case"koszt_wlasny":De=ae.koszt_wlasny||0,Re=ge.koszt_wlasny||0;break;case"srednieZuzycie":De=_e.get(ae.kod)||0,Re=_e.get(ge.kod)||0;break;case"dniPozostalo":const $e=_e.get(ae.kod)||0,rt=_e.get(ge.kod)||0;De=$e<=0?1/0:Math.floor(ae.ilosc/$e),Re=rt<=0?1/0:Math.floor(ge.ilosc/rt);break;case"dataWyczerpania":if(ae.ilosc===0){const Me=ft(ae.kod);De=Me?Me.getTime():0}else{const Me=_e.get(ae.kod)||0,nt=Me<=0?1/0:Math.floor(ae.ilosc/Me);De=nt===1/0?1/0:new Date().setDate(new Date().getDate()+nt)}if(ge.ilosc===0){const Me=ft(ge.kod);Re=Me?Me.getTime():0}else{const Me=_e.get(ge.kod)||0,nt=Me<=0?1/0:Math.floor(ge.ilosc/Me);Re=nt===1/0?1/0:new Date().setDate(new Date().getDate()+nt)}break;case"status":const yt=Me=>{if(Me.ilosc===0)return 0;const nt=_e.get(Me.kod)||0,_t=nt<=0?1/0:Math.floor(Me.ilosc/nt);return _t===1/0?4:_t<=30?1:_t<=60?2:3};De=yt(ae),Re=yt(ge);break;case"typ":De=ae.typ||"",Re=ge.typ||"";break;case"objetosc":De=ae.objetosc||0,Re=ge.objetosc||0;break;case"dataWaznosci":const Ut=Me=>{if(!Me)return 0;let nt;if(typeof Me=="string")nt=new Date(Me);else if(typeof Me=="number")Me<1e12?nt=new Date(Me*1e3):nt=new Date(Me);else return 0;return isNaN(nt.getTime())?0:nt.getTime()};De=Ut(ae.data_waznosci),Re=Ut(ge.data_waznosci);break;case"sprzedaze":const Ke=a.filter(Me=>Me.kod===ae.kod).length,tt=a.filter(Me=>Me.kod===ge.kod).length;De=Ke,Re=tt;break;default:De=ae[W],Re=ge[W]}return typeof De=="string"&&typeof Re=="string"?V==="asc"?De.localeCompare(Re):Re.localeCompare(De):typeof De=="number"&&typeof Re=="number"?V==="asc"?De-Re:Re-De:0}),Yt=ae=>{B(ae?Nt.map(ge=>ge.id):[])},Ft=(ae,ge)=>{B(De=>ge?[...De,ae]:De.filter(Re=>Re!==ae))},Bt=(ae,ge)=>{ae.preventDefault(),ae.stopPropagation(),console.log(" Mouse down on column:",ge,"X:",ae.clientX,"Current width:",F[ge]),H(ge),ue(ae.clientX),Oe(F[ge]),Xe(!1),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},ve=ae=>{if(q){const ge=ae.clientX-L,De=Math.max(50,I+ge);console.log(" Mouse move:","DeltaX:",ge,"NewWidth:",De,"Column:",q),Math.abs(ge)>3&&Xe(!0);const Re={...F,[q]:De};A(Re),localStorage.setItem("columnWidths",JSON.stringify(Re))}},Ze=()=>{console.log(" Mouse up - finishing resize"),H(null),ue(0),Oe(0),document.body.style.cursor="",document.body.style.userSelect="",setTimeout(()=>{Xe(!1)},100)};N.useEffect(()=>{if(q)return document.addEventListener("mousemove",ve),document.addEventListener("mouseup",Ze),()=>{document.removeEventListener("mousemove",ve),document.removeEventListener("mouseup",Ze)}},[q,L,I]);const kt=()=>{if(U.length!==1){He.error("Wybierz dokadnie jedn pozycj do edycji");return}const ae=t.find(ge=>ge.id===U[0]);ae&&(oe(ae),fe(!0))},ce=async()=>{try{const ae=await fetch("/api/inventory/report/pdf");if(!ae.ok)throw new Error("   ");const ge=await ae.blob(),De=window.URL.createObjectURL(ge),Re=document.createElement("a");Re.href=De;const $e=ae.headers.get("Content-Disposition");let rt="raport_stanow_magazynowych.pdf";if($e){const yt=$e.match(/filename="?(.+)"?/i);yt&&(rt=yt[1])}Re.download=rt,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),setTimeout(()=>window.URL.revokeObjectURL(De),100)}catch(ae){console.error("Error generating report:",ae)}},Pe=ae=>{r(ge=>ge.map(De=>De.id===ae.id?ae:De)),B([])},ze=Nt.length>0&&Nt.every(ae=>U.includes(ae.id)),et=ae=>{if(!ae)return"-";let ge;if(typeof ae=="string")ge=new Date(ae);else if(typeof ae=="number")ae<1e12?ge=new Date(ae*1e3):ge=new Date(ae);else return"-";return isNaN(ge.getTime())?"-":ge.toLocaleDateString("pl-PL")},at=U.length>0?t.filter(ae=>U.includes(ae.id)):[];return f?u.jsx("div",{className:"flex justify-center items-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("p",{className:"text-red-600 font-sora",children:p}),u.jsx("button",{onClick:ht,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-sora",children:"Try again"})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[u.jsxs("div",{className:"relative w-full max-w-xs",children:[u.jsx(Yn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),u.jsx("input",{type:"text",value:j,onChange:ae=>C(ae.target.value),className:"pl-10 pr-4 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:border-gray-400 w-full font-sora text-xs"})]}),u.jsx("button",{onClick:kt,disabled:U.length!==1,className:"text-green-600 hover:text-green-800 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed",title:"Edytuj",children:u.jsx(Pl,{size:16})}),u.jsx("button",{onClick:ce,className:"text-blue-600 hover:text-blue-800 focus:outline-none",title:"Raport stanw magazynowych",children:u.jsx(yb,{size:16})})]}),u.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Liczba artykuw"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900 font-sora",children:at.length})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"czna ilo towaru"}),u.jsx("p",{className:"text-2xl font-bold text-green-600 font-sora",children:at.length>0?at.reduce((ae,ge)=>ae+(ge.ilosc||0),0):0})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru fakturowa"}),u.jsxs("p",{className:"text-2xl font-bold text-blue-600 font-sora",children:[at.length>0?at.reduce((ae,ge)=>ae+(S[ge.kod]||0),0).toFixed(2):"0.00"," "]})]}),u.jsxs("div",{className:"bg-white p-2 rounded-lg border rounded-lg max-w-[170px] w-full sm:w-auto flex-1 min-w-[170px]",children:[u.jsx("h3",{className:"text-xs font-medium text-gray-500 font-sora",children:"Warto towaru w sprzeday"}),u.jsxs("p",{className:"text-2xl font-bold text-red-600 font-sora",children:[at.length>0?at.reduce((ae,ge)=>{const De=ge.cena_sprzedazy||0,Re=ge.ilosc||0;return ae+De*Re},0).toFixed(2):"0.00"," z"]})]})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ne.sprzedawca,onChange:ae=>ee(ge=>({...ge,sprzedawca:ae.target.value})),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Sprzedawca"}),sr.map(ae=>u.jsx("option",{value:ae,style:{fontFamily:"Sora, sans-serif"},children:ae},ae))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ne.typ,onChange:ae=>ee(ge=>({...ge,typ:ae.target.value})),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Typ"}),Rt.map(ae=>u.jsx("option",{value:ae,style:{fontFamily:"Sora, sans-serif"},children:Ef.find(ge=>ge.value===ae)?.label||ae},ae))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ne.objetosc,onChange:ae=>ee(ge=>({...ge,objetosc:ae.target.value})),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Objto"}),Ht.map(ae=>u.jsxs("option",{value:ae,style:{fontFamily:"Sora, sans-serif"},children:[ae," l"]},ae))]})}),u.jsx("div",{className:"relative",children:u.jsxs("select",{value:ne.status,onChange:ae=>ee(ge=>({...ge,status:ae.target.value})),className:"block w-auto px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr",minWidth:"145px"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Status"}),pt.map(ae=>u.jsx("option",{value:ae,style:{fontFamily:"Sora, sans-serif"},children:ae},ae))]})})]}),(ne.sprzedawca||ne.typ||ne.objetosc||ne.status)&&u.jsx("button",{onClick:()=>ee({sprzedawca:"",typ:"",objetosc:"",status:""}),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-xs font-sora transition-colors",children:"Wyczy filtry"})]})]}),u.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:u.jsx("div",{className:"w-full overflow-x-auto overflow-y-scroll max-h-[500px] relative",style:{zIndex:1},children:u.jsxs("table",{className:"w-full resizable-table",ref:qe,children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:u.jsx("input",{type:"checkbox",checked:ze,onChange:ae=>Yt(ae.target.checked)})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>vt("kod"),style:{width:"100px"},children:"Kod"}),u.jsxs("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 relative",onClick:()=>{Ae||vt("nazwa")},style:{width:`${F.nazwa}px`},children:["Nazwa",u.jsx("div",{className:`absolute top-0 right-0 h-full cursor-col-resize hover:bg-blue-500 transition-opacity z-10 ${q==="nazwa"?"bg-blue-500 opacity-100":"opacity-0 hover:opacity-100"}`,style:{width:"2px"},onMouseDown:ae=>{ae.preventDefault(),ae.stopPropagation(),Bt(ae,"nazwa")}})]}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>vt("sprzedawca"),style:{width:"120px"},children:"Sprzedawca"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>vt("ilosc"),children:"Ilo"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>vt("typ"),children:"Typ"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>vt("objetosc"),children:"Objto"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>vt("cena"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena",u.jsx("br",{}),"fakturowa"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>vt("koszt_wlasny"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Koszt",u.jsx("br",{}),"wasny"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>vt("cena_sprzedazy"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Cena w",u.jsx("br",{}),"sprzeday"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>vt("dataWaznosci"),style:{width:"90px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data",u.jsx("br",{}),"wanoci"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>vt("sprzedaze"),children:"Sprzedae"}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>vt("srednieZuzycie"),style:{width:"100px"},children:u.jsxs("div",{className:"whitespace-normal",children:["rednie",u.jsx("br",{}),"zuycie/dzie"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>vt("dniPozostalo"),style:{width:"80px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Dni",u.jsx("br",{}),"pozostao"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50 leading-tight",onClick:()=>vt("dataWyczerpania"),style:{width:"110px"},children:u.jsxs("div",{className:"whitespace-normal",children:["Data wyczerpania",u.jsx("br",{}),"zapasw"]})}),u.jsx("th",{className:"px-8 py-4 text-left text-[10px] font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora cursor-pointer hover:bg-gray-100 bg-gray-50",onClick:()=>vt("status"),children:"Status"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Nt.map(ae=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora whitespace-nowrap",children:u.jsx("input",{type:"checkbox",checked:U.includes(ae.id),onChange:ge=>Ft(ae.id,ge.target.checked)})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:"100px"},children:u.jsx("div",{className:"break-words leading-tight max-h-8 overflow-hidden",children:ae.kod})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline",style:{width:`${F.nazwa}px`},children:u.jsx("div",{className:"break-words leading-tight max-h-12 overflow-hidden",children:ae.nazwa})}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",style:{width:"120px"},children:ae.sprzedawca||je.get(ae.kod)||""}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`ilosc-tooltip-${ae.kod}`,children:[ae.ilosc,u.jsx(ti,{id:`ilosc-tooltip-${ae.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"samples:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[le[ae.kod]||0," szt"]})]}),se[ae.kod]>0&&u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"rezerwacja:"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[se[ae.kod]," szt"]})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ae.typ?u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${jt(ae.typ)}`,children:Ef.find(ge=>ge.value===ae.typ)?.label||ae.typ}):"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ae.objetosc?`${ae.objetosc} l`:"-"}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`price-tooltip-${ae.kod}`,onMouseEnter:()=>{he[ae.kod]||Qe()},children:[ae.cena!=null?`${ae.cena.toFixed(2)} `:"-",u.jsx(ti,{id:`price-tooltip-${ae.kod}`,className:"max-w-md",place:"top",children:u.jsxs("div",{className:"font-sora",children:[u.jsx("div",{className:"font-semibold mb-2",children:"Historia cen:"}),he[ae.kod]&&he[ae.kod].length>0?he[ae.kod].map((ge,De)=>u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:ge.cena!=null?`${ge.cena.toFixed(2)} `:"N/A"}),u.jsxs("span",{className:"text-gray-500 ml-2",children:["(",ge.ilosc_aktualna," szt.)"]})]},De)):u.jsx("div",{className:"text-gray-500",children:"Brak danych"})]})})]}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap cursor-pointer","data-tooltip-id":`koszt-tooltip-${ae.kod}`,children:[ae.koszt_wlasny!=null?`${ae.koszt_wlasny.toFixed(2)} z`:"-",u.jsx(ti,{id:`koszt-tooltip-${ae.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",children:u.jsxs("div",{className:"font-sora",children:[u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"transport:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:ae.koszt_dostawy_per_unit!=null?`${ae.koszt_dostawy_per_unit.toFixed(2)} z`:"0,00 z"})]}),u.jsxs("div",{className:"mb-1",children:[u.jsx("span",{className:"font-medium",children:"akcyza:"}),u.jsx("span",{className:"text-gray-500 ml-2",children:ae.podatek_akcyzowy!=null?`${ae.podatek_akcyzowy.toFixed(2)} z`:"0,00 z"})]})]})})]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:ae.cena_sprzedazy!=null?`${ae.cena_sprzedazy.toFixed(2)} z`:"-"}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:et(ae.data_waznosci)}),u.jsx("td",{className:"px-8 py-4 text-center text-xs text-gray-600 font-sora leading-tight align-middle whitespace-nowrap",children:(()=>{const ge=a.filter(rt=>rt.kod===ae.kod);console.log(`Sales for ${ae.kod}:`,ge.length);const De={};ge.forEach(rt=>{const yt=l.find(tt=>tt.id===rt.orderId),Ut=yt?yt.klient:"";let Ke="";yt&&yt.numer_zamowienia&&(Ke=zv(yt.numer_zamowienia)),!Ke&&yt&&(Ke=new Date(yt.data_utworzenia).toLocaleDateString("pl-PL")),!Ke&&rt.created_at&&(Ke=new Date(rt.created_at).toLocaleDateString("pl-PL")),De[rt.orderId]||(De[rt.orderId]={qty:0,klient:Ut,date:Ke}),De[rt.orderId].qty+=rt.ilosc});const Re=Object.entries(De).sort(([,rt],[,yt])=>{const Ut=new Date(rt.date.split(".").reverse().join("-"));return new Date(yt.date.split(".").reverse().join("-")).getTime()-Ut.getTime()});if(console.log(`Sales array for ${ae.kod}:`,Re.length),Re.length===0)return u.jsx("div",{className:"text-gray-400",children:"-"});const $e=Re.slice(0,3);return u.jsx("div",{className:"flex items-center justify-center",children:u.jsxs("div",{className:"relative cursor-pointer",children:[u.jsx(kb,{size:16,className:"text-blue-300 hover:text-blue-400 transition-colors focus:outline-none","data-tooltip-id":`sales-tooltip-${ae.kod}`,onClick:rt=>{rt.stopPropagation(),b(ae.kod),v(!0)},tabIndex:0,onMouseDown:rt=>rt.preventDefault()}),u.jsx(ti,{id:`sales-tooltip-${ae.kod}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!1,children:u.jsx("div",{className:"font-sora",children:$e.map(([rt,yt])=>u.jsx("div",{className:"mb-1",children:yt.date&&yt.klient?u.jsxs("div",{children:[yt.date.split(".").slice(0,2).join(".")," | ",yt.klient,": ",u.jsx("span",{className:"text-gray-500",children:yt.qty})]}):u.jsxs("div",{className:"text-gray-500",children:["Ilo: ",yt.qty]})},rt))})})]})})})()}),u.jsxs("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:[(()=>{const ge=_e.get(ae.kod)||0;return ge>=1?ge.toFixed(2):ge>=.1?ge.toFixed(3):ge.toFixed(4)})(),"/dzie"]}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{const ge=_e.get(ae.kod)||0,De=ge<=0?1/0:Math.floor(ae.ilosc/ge);return De===1/0?"":De})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(ae.ilosc===0){const $e=ft(ae.kod);return $e?$e.toLocaleDateString("pl-PL"):"-"}const ge=_e.get(ae.kod)||0,De=ge<=0?1/0:Math.floor(ae.ilosc/ge);if(De===1/0)return"-";const Re=new Date;return Re.setDate(Re.getDate()+De),Re.toLocaleDateString("pl-PL")})()}),u.jsx("td",{className:"px-8 py-4 text-left text-xs text-gray-600 font-sora leading-tight align-baseline whitespace-nowrap",children:(()=>{if(ae.ilosc===0)return u.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border bg-gray-100 text-gray-600 border-gray-300",children:"brak"});const ge=_e.get(ae.kod)||0,De=ge<=0?1/0:Math.floor(ae.ilosc/ge),Re=De===1/0?"Brak danych":De<=30?"mao":De<=60?"rednie":"duo";return u.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-sora leading-tight border ${Gt(De)}`,children:Re})})()})]},ae.id))})]})})}),u.jsx(cR,{isOpen:Y,onClose:()=>{fe(!1),oe(null)},item:de,onSave:Pe}),(()=>{let ae=0;if(w){const tt=new Set;a.forEach(Me=>{Me.kod===w&&tt.add(Me.orderId)}),ae=l.filter(Me=>tt.has(Me.id)).length}const ge=40,De=48,Re=40,$e=40,rt=7,yt=rt*$e,Ut=ae===0?150:ge+De+Re+Math.max(ae,rt)*$e+20,Ke=Math.min(Math.max(Ut,ge+De+Re+yt+20),window.innerHeight*.9);return u.jsx(ar,{isOpen:g,onRequestClose:()=>{v(!1),b(null)},style:{content:{width:"400px",height:`${Ke}px`,maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},contentLabel:"Zamwienia",children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-start mb-8 select-none",children:[u.jsx("h2",{className:"text-xs font-semibold text-gray-800 pr-4 break-words leading-tight",children:w?t.find(tt=>tt.kod===w)?.nazwa||w:""}),u.jsx("button",{onClick:()=>{v(!1),b(null),T("")},className:"text-red-500 focus:outline-none flex-shrink-0",children:u.jsx(Ct,{size:20})})]}),u.jsx("div",{className:"space-y-3 flex-grow overflow-y-auto",children:w&&(()=>{const tt=new Set;a.forEach(O=>{O.kod===w&&tt.add(O.orderId)});let Me=l.filter(O=>tt.has(O.id));k.trim()&&(Me=Me.filter(O=>O.klient===k));const _t=Me.map(O=>{const te=a.filter(Q=>Q.orderId===O.id&&Q.kod===w).reduce((Q,Z)=>Q+Z.ilosc,0);let K="";return O.numer_zamowienia&&(K=zv(O.numer_zamowienia)),!K&&O.data_utworzenia&&(K=new Date(O.data_utworzenia).toLocaleDateString("pl-PL")),{...O,date:K,totalQty:te}}).sort((O,te)=>{if(O.date&&te.date){const K=new Date(O.date.split(".").reverse().join("-"));return new Date(te.date.split(".").reverse().join("-")).getTime()-K.getTime()}return 0});return _t.length===0?u.jsx("p",{className:"text-xs text-gray-500",children:"Brak zamwie dla tego towaru"}):u.jsx("div",{children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-purple-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Zamwienia"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Klient"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Ilo"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-0"})]})}),u.jsx("tbody",{className:"bg-white",children:_t.map(O=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium",children:O.numer_zamowienia||"-"}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900",children:u.jsx("div",{className:"break-words leading-tight",children:O.klient||"-"})}),u.jsx("td",{className:"px-4 py-2 text-xs text-gray-900 font-medium w-16 text-center",children:O.totalQty}),u.jsx("td",{})]},O.id))})]})})})()}),w&&(()=>{const tt=new Set;a.forEach(nt=>{nt.kod===w&&tt.add(nt.orderId)});const Me=l.filter(nt=>tt.has(nt.id)).map(nt=>nt.klient).filter((nt,_t,O)=>nt&&O.indexOf(nt)===_t).sort();return u.jsx("div",{className:"mt-6 pt-4",children:u.jsx("div",{className:"flex items-center space-x-2",children:u.jsxs("select",{value:k,onChange:nt=>T(nt.target.value),className:"block w-1/2 px-2 py-1 border border-gray-300 rounded text-xs font-sora font-normal text-gray-900 focus:outline-none focus:ring-0 focus:border-gray-300",style:{fontFamily:"Sora, sans-serif",direction:"ltr"},children:[u.jsx("option",{value:"",style:{fontFamily:"Sora, sans-serif"},children:"Klient"}),Me.map(nt=>u.jsx("option",{value:nt,style:{fontFamily:"Sora, sans-serif"},children:nt},nt))]})})})})()]})})})()]})};Aa("pl",Oa);const pR=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=N.useState(new Date),[o,l]=N.useState([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),[c,f]=N.useState([]),[,h]=N.useState(new Set),[p,m]=N.useState(!1),[g,v]=N.useState(""),[w,b]=N.useState(""),[k,T]=N.useState(!1),[j,C]=N.useState(null);N.useEffect(()=>{const B=setTimeout(async()=>{if(g.trim().length<2||k){f([]);return}m(!0);try{const ne=await fetch(`/api/orders/search?numer_zamowienia=${encodeURIComponent(g)}`);if(!ne.ok)throw new Error("Failed to fetch orders");const ee=await ne.json();if(ee&&ee.length>0){const Y=ee.map(fe=>({id:fe.id,nazwa:`Zamwienie: ${fe.numer_zamowienia}`,kod:fe.klient,klient:fe.klient,numer_zamowienia:fe.numer_zamowienia,products:fe.products||[]}));f(Y)}else f([])}catch(ne){console.error("Error searching orders:",ne),f([])}finally{m(!1)}},300);return()=>clearTimeout(B)},[g,k]);const W=(U,B)=>{if(U.numer_zamowienia){if(b(U.klient),C(U.id),U.products&&U.products.length>0){const ne=U.products.map(ee=>({nazwa:ee.nazwa,ilosc:ee.ilosc,original_ilosc:ee.ilosc,powod_zwrotu:""}));l(ne)}f([]),v(U.numer_zamowienia),T(!0),He.success("Zamwienie wybrane")}else{const ne=[...o];ne[B]={...ne[B],nazwa:U.nazwa,ilosc:0,original_ilosc:0},l(ne)}},J=()=>{const U=new Set;return o.forEach((B,ne)=>{const ee=B.original_ilosc,Y=o[ne].ilosc;!B.nazwa.trim()||!Y||Y<=0||!B.powod_zwrotu?U.add(ne):Y>ee&&(U.add(ne),He.error(`Ilo zwrotu (${Y}) nie moe przekracza iloci w zamwieniu (${ee})`))}),h(U),U.size===0},V=async()=>{if(!J()){He.error("Prosz wypeni wszystkie wymagane pola");return}try{const U={klient:w,data_zwrotu:r,products:o,orderId:j},B=await fetch("/api/returns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!B.ok){const ee=await B.json();throw new Error(ee.error||"Failed to create return")}const ne=await B.json();console.log("Return created:",ne),t(U),He.success(`Zwrot zosta utworzony: ${ne.numer_zwrotu}`),n(),v(""),b(""),T(!1),C(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)}catch(U){console.error("Error creating return:",U),He.error("Bd podczas tworzenia zwrotu")}},P=()=>{n(),v(""),b(""),T(!1),C(null),a(new Date),l([{nazwa:"",ilosc:0,original_ilosc:0,powod_zwrotu:""}]),h(new Set)};return u.jsx(ar,{isOpen:e,onRequestClose:P,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Zwrot towaru"}),u.jsx("button",{onClick:P,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex flex-wrap gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zwrotu"}),u.jsx(wn,{selected:r,onChange:U=>a(U||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer zamwienia"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:g,onChange:U=>{v(U.target.value),T(!1),C(null)},placeholder:"Wprowad numer zamwienia",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),p&&u.jsx("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"})}),c.length>0&&g.trim().length>=2&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-40 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:c.map(U=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>W(U,-1),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-[10px]",children:U.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Klient: ",U.klient]})]})},U.id))})]})]})]})}),w&&u.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsx("div",{className:"grid grid-cols-2 gap-x-6 gap-y-1 flex-1",children:u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-xs",children:"Klient:"}),u.jsx("p",{className:"text-xs text-gray-900",children:w})]})}),u.jsx("button",{onClick:()=>b(""),className:"text-gray-500 hover:text-gray-700 ml-4",children:u.jsx(Ct,{size:16})})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do zwrotu"}),o.map((U,B)=>u.jsx("div",{className:"relative",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"relative flex-1 max-w-[50%]",children:u.jsx("input",{type:"text",value:U.nazwa,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600",placeholder:"Produkt"})}),u.jsx("div",{className:"w-20 ml-2",children:u.jsx("input",{type:"number",min:"1",max:U.original_ilosc,value:o[B].ilosc||"",onChange:ne=>{const ee=[...o],Y=ne.target.value===""?0:parseInt(ne.target.value)||0;ee[B]={...ee[B],ilosc:Y},l(ee)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"ilo"})}),u.jsx("div",{className:"w-40 ml-2",children:u.jsxs("select",{value:o[B].powod_zwrotu,onChange:ne=>{const ee=[...o];ee[B]={...ee[B],powod_zwrotu:ne.target.value},l(ee)},className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",children:[u.jsx("option",{value:"",children:"Powd zwrotu"}),u.jsx("option",{value:"Bd w zamwieniu",children:"Bd w zamwieniu"}),u.jsx("option",{value:"Defekt towaru",children:"Defekt towaru"}),u.jsx("option",{value:"Niesprzedany towar",children:"Niesprzedany towar"})]})}),o.length>1&&u.jsx("button",{onClick:()=>{const ne=o.filter((ee,Y)=>Y!==B);l(ne)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]})},B))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:V,className:"px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora bg-blue-600 hover:bg-blue-700",children:"Utwrz zwrot"})}),u.jsx("div",{className:"absolute bottom-4 right-4",children:u.jsx("button",{onClick:P,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Anuluj"})})]})})};Aa("pl",Oa);const hR=({isOpen:e,onClose:n,onSubmit:t})=>{const[r,a]=N.useState(new Date),[o,l]=N.useState(""),[c,f]=N.useState(""),[h,p]=N.useState([{kod:"",nazwa:"",ilosc:0,powod:""}]),[m,g]=N.useState([]),[v,w]=N.useState(new Set),[b,k]=N.useState(new Set),[T,j]=N.useState(!1),[C,W]=N.useState(null),[J,V]=N.useState(null),[P,U]=N.useState(!1),B=N.useRef(null),ne=[{value:"Uszkodzenie",label:"Uszkodzenie",color:"bg-red-100 text-red-800 border-red-200"},{value:"Przeterminowanie",label:"Przeterminowanie",color:"bg-orange-100 text-orange-800 border-orange-200"},{value:"Utrata",label:"Utrata",color:"bg-gray-100 text-gray-800 border-gray-200"},{value:"Inwentaryzacja",label:"Inwentaryzacja",color:"bg-blue-100 text-blue-800 border-blue-200"}];N.useEffect(()=>{e?fetch("/api/writeoffs/next-number-only").then(z=>{if(!z.ok)throw new Error("Failed to fetch next number");return z.json()}).then(z=>{z.numer_odpisania?(l(z.numer_odpisania),console.log(" Set write-off base number to:",z.numer_odpisania)):l("OP001")}).catch(z=>{console.error(" Error fetching next write-off number:",z),l("OP001")}):(l(""),f(""))},[e]),N.useEffect(()=>{if(o&&r){const z=String(r.getDate()).padStart(2,"0"),se=String(r.getMonth()+1).padStart(2,"0"),R=r.getFullYear(),S=`${o}_${z}_${se}_${R}`;f(S)}},[o,r]),N.useEffect(()=>{const se=setTimeout(async()=>{if(C===null){g([]);return}const R=h[C];if(!R||!R.nazwa||R.nazwa.trim().length<2||R.kod){g([]);return}j(!0);try{const S=R.nazwa,G=await fetch(`/api/working-sheets/search?query=${encodeURIComponent(S)}`);if(!G.ok)throw new Error("Failed to fetch products");const E=(await G.json()).map(F=>({kod:F.kod,nazwa:F.nazwa,ilosc:F.ilosc?.toString()||"0"}));g(E)}catch(S){console.error("Error searching products:",S),g([])}finally{j(!1)}},300);return()=>clearTimeout(se)},[h,C]),N.useEffect(()=>{const z=R=>{const S=R.target;J!==null&&(S.closest(".dropdown-container")||V(null))},se=R=>{R.key==="Escape"&&V(null)};return J!==null&&(document.addEventListener("mousedown",z),document.addEventListener("keydown",se)),()=>{document.removeEventListener("mousedown",z),document.removeEventListener("keydown",se)}},[J]);const ee=(z,se)=>{const R=[...h],S=parseInt(z.ilosc)||0;R[se]={...R[se],kod:z.kod,nazwa:`${z.kod} - ${z.nazwa}`,ilosc:0,availableQuantity:S},p(R),g([]),W(null),w(G=>{const D=new Set(G);return D.delete(se),D}),k(G=>{const D=new Set(G);return D.delete(se),D})},Y=z=>{V(J===z?null:z)},fe=(z,se)=>{const R=[...h];R[z]={...R[z],powod:se},p(R),V(null)},de=()=>{p([...h,{kod:"",nazwa:"",ilosc:0,powod:""}])},oe=()=>c?h.every(z=>z.nazwa.trim()&&z.ilosc&&z.ilosc>0&&z.powod):!1,he=()=>{const z=new Set;return h.forEach((se,R)=>{(!se.nazwa.trim()||!se.ilosc||se.ilosc<=0||!se.powod)&&z.add(R)}),w(z),z.size===0},X=async()=>{if(!he()){He.error("Prosz wypeni wszystkie wymagane pola");return}if(!c){He.error("Brak numeru odpisania");return}U(!0);try{const z={data_odpisania:r.toISOString(),numer_odpisania:c,products:h},se=await fetch("/api/writeoffs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!se.ok){const S=await se.json();throw new Error(S.error||"Failed to create write-off")}const R=await se.json();console.log("Write-off created:",R),t(z),He.success(`Odpisanie zostao utworzone: ${c}`),le()}catch(z){console.error("Error creating write-off:",z),He.error("Bd podczas tworzenia odpisania")}finally{U(!1)}},le=()=>{n(),a(new Date),l(""),f(""),p([{kod:"",nazwa:"",ilosc:0,powod:""}]),w(new Set),k(new Set),g([]),W(null),V(null),U(!1)};return u.jsx(ar,{isOpen:e,onRequestClose:le,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"hidden",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Odpisanie towaru"}),u.jsx("button",{onClick:le,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4 mb-12",children:u.jsxs("div",{className:"flex items-end gap-6",children:[u.jsxs("div",{className:"w-[140px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data odpisania"}),u.jsx(wn,{selected:r,onChange:z=>a(z||new Date),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[120px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsx("input",{type:"text",value:"VEIS",readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed"})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer odpisania"}),u.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-100 text-gray-600 cursor-not-allowed"})]})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty do odpisania"}),h.map((z,se)=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"relative flex-1 max-w-[65%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:z.nazwa,onChange:R=>{const S=R.target.value,G=[...h];G[se]={...G[se],nazwa:S,kod:"",ilosc:0,powod:"",availableQuantity:void 0},p(G),W(se),k(D=>{const E=new Set(D);return E.delete(se),E})},onFocus:()=>W(se),className:`w-full pl-10 pr-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs ${v.has(se)?"border-red-500 bg-red-50":"border-gray-300"}`,placeholder:"Wyszukaj produkty..."}),T&&C===se&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),m.length>0&&C===se&&z.nazwa.trim().length>=2&&!z.kod&&u.jsx("div",{className:"absolute z-50 mt-1 w-[65%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map((R,S)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>ee(R,se),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:R.kod}),u.jsx("span",{className:"text-[10px] text-gray-500",children:R.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",R.ilosc]})]})},`${R.kod}-${S}`))})]}),u.jsx("div",{className:"w-16 ml-2",children:u.jsx("input",{type:"number",min:"1",value:z.ilosc||"",onChange:R=>{const S=R.target.value,G=S===""?0:Math.max(1,parseInt(S)||0),D=[...h];if(D[se]={...D[se],ilosc:G},p(D),B.current=null,z.kod&&z.availableQuantity!==void 0){const E=z.availableQuantity;G===0?k(F=>{const A=new Set(F);return A.delete(se),A}):G>E?(k(F=>{const A=new Set(F);return A.add(se),A}),B.current!==se&&(B.current=se,He.error(`Niewystarczajca ilo - dostpne: ${E} (na magazynie: ${E})`))):k(F=>{const A=new Set(F);return A.delete(se),A})}else k(E=>{const F=new Set(E);return F.delete(se),F})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${b.has(se)?"border-red-500 bg-red-50":"border-gray-300"}`,placeholder:"Ilo"})}),u.jsxs("div",{className:"w-32 ml-2 relative dropdown-container",children:[u.jsxs("button",{type:"button",onClick:()=>Y(se),className:`w-full px-2 py-1.5 border rounded-md focus:outline-none font-sora text-xs text-left flex items-center justify-between ${z.powod&&ne.find(R=>R.value===z.powod)?.color||"border-gray-300 bg-white"}`,children:[u.jsx("span",{className:"truncate text-[10px]",children:z.powod?ne.find(R=>R.value===z.powod)?.label||z.powod:"Powd"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),J===se&&u.jsx("div",{className:"absolute top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-40 overflow-y-auto w-full",onClick:R=>R.stopPropagation(),children:ne.map(R=>u.jsx("button",{type:"button",onClick:()=>fe(se,R.value),className:`w-full px-2 py-1.5 text-left text-[10px] hover:bg-gray-50 ${R.color}`,children:R.label},R.value))})]}),h.length>1&&u.jsx("button",{onClick:()=>{const R=h.filter((S,G)=>G!==se);p(R)},className:"ml-2 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),se===h.length-1&&u.jsx("button",{type:"button",onClick:de,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})})]},se))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:X,disabled:P||!oe(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${P||!oe()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:P?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Tworzenie..."]}):"Utwrz odpisanie"})})]})})};Aa("pl",Oa);const xR=({isOpen:e,onClose:n,onReservationCreated:t})=>{console.log(" CreateReservationModal render - isOpen:",e);const[r,a]=N.useState(null),[o,l]=N.useState(null),[c,f]=N.useState(""),[h,p]=N.useState(""),[m,g]=N.useState([]),[v,w]=N.useState(null),[b,k]=N.useState(!1),[T,j]=N.useState([]),[C,W]=N.useState([{id:1,searchQuery:"",selectedProduct:null}]),[J,V]=N.useState(null),[P,U]=N.useState(!1),[B,ne]=N.useState(!1),[ee,Y]=N.useState(new Set),[fe,de]=N.useState(""),oe=N.useRef(null),he=N.useRef(""),X=()=>{const D=Math.max(...C.map(E=>E.id))+1;W([...C,{id:D,searchQuery:"",selectedProduct:null}])},le=D=>{C.length>1&&W(E=>E.filter(F=>F.id!==D))},z=()=>{console.log(" CreateReservationModal handleClose called"),a(null),l(null),f(""),p(""),g([]),w(null),j([]),W([{id:1,searchQuery:"",selectedProduct:null}]),V(null),U(!1),ne(!1),Y(new Set),de(""),oe.current=null,n()};N.useEffect(()=>{if(e){console.log(" CreateReservationModal opened - clearing state and generating number"),a(null),l(null),p(""),g([]),w(null),j([]),W([{id:1,searchQuery:"",selectedProduct:null}]),V(null),U(!1),ne(!1),Y(new Set),de(""),oe.current=null;const D=new Date,E=D.getDate().toString().padStart(2,"0"),F=(D.getMonth()+1).toString().padStart(2,"0"),A=D.getFullYear();console.log(" Fetching next reservation number from:",`${Ha}/api/reservations/next-number-only`),fetch(`${Ha}/api/reservations/next-number-only`).then(q=>{if(console.log(" Response status:",q.status),!q.ok)throw new Error(`HTTP error! status: ${q.status}`);return q.json()}).then(q=>{if(console.log(" Received data:",q),q.numer_rezerwacji){he.current=q.numer_rezerwacji;const H=`${q.numer_rezerwacji}_${E}_${F}_${A}`;f(H),console.log(" Set reservation number to:",H)}else console.warn(" No numer_rezerwacji in response, using fallback"),he.current="R001",f(`R001_${E}_${F}_${A}`)}).catch(q=>{console.error(" Error fetching next reservation number:",q),he.current="R001",f(`R001_${E}_${F}_${A}`)})}else f(""),he.current=""},[e]),N.useEffect(()=>{const E=setTimeout(async()=>{if(h.trim().length<2){g([]);return}k(!0);try{const F=await fetch(`${Ha}/api/clients/search?q=${encodeURIComponent(h)}`);if(!F.ok)throw new Error("Failed to fetch clients");const A=await F.json();g(A)}catch(F){console.error("Error searching clients:",F),g([])}finally{k(!1)}},300);return()=>clearTimeout(E)},[h]),N.useEffect(()=>{const E=setTimeout(async()=>{if(J===null||!C.find(F=>F.id===J)?.searchQuery.trim()){j([]);return}U(!0);try{const F=C.find(L=>L.id===J)?.searchQuery||"",A=await fetch(`${Ha}/api/working-sheets/search?query=${encodeURIComponent(F)}`);if(!A.ok)throw new Error("Failed to fetch products");const H=(await A.json()).map(L=>({kod:L.kod,nazwa:L.nazwa,ilosc:L.ilosc.toString(),kodKreskowy:L.kod_kreskowy||"",selectedQuantity:0,ilosc_reserved:L.ilosc_reserved||0}));j(H)}catch(F){console.error("Error searching products:",F),j([])}finally{U(!1)}},300);return()=>clearTimeout(E)},[C,J]),N.useEffect(()=>{if(he.current)if(r){const D=r.getDate().toString().padStart(2,"0"),E=(r.getMonth()+1).toString().padStart(2,"0"),F=r.getFullYear(),A=`${he.current}_${D}_${E}_${F}`;f(A)}else{const D=new Date,E=D.getDate().toString().padStart(2,"0"),F=(D.getMonth()+1).toString().padStart(2,"0"),A=D.getFullYear(),q=`${he.current}_${E}_${F}_${A}`;f(q)}},[r]);const se=(D,E)=>{console.log(" handleProductSelect called for fieldId:",D,"product:",E.kod),W(F=>F.map(q=>q.id===D?{...q,selectedProduct:E,searchQuery:`${E.kod} - ${E.nazwa.includes(" (samples)")?E.nazwa.replace(" (samples)","")+" (samples)":E.nazwa}`}:q)),j([]),V(null),console.log(" Products list cleared, activeSearchId reset")},R=()=>C.filter(D=>D.selectedProduct).reduce((D,E)=>{const F=E.selectedProduct?.selectedQuantity||0;return D+F},0),S=()=>{if(!r||!o||!v||!c.trim())return!1;const D=C.filter(E=>E.selectedProduct);return!(D.length===0||D.some(E=>!E.selectedProduct?.selectedQuantity||E.selectedProduct.selectedQuantity<=0)||ee.size>0)},G=async()=>{const D=C.filter(E=>E.selectedProduct).map(E=>({product_kod:E.selectedProduct.kod,product_nazwa:E.selectedProduct.nazwa,kod_kreskowy:E.selectedProduct.kodKreskowy||"",ilosc:E.selectedProduct.selectedQuantity||0}));if(!r){He.error("Wybierz dat rezerwacji");return}if(!o){He.error("Wybierz dat zakoczenia rezerwacji");return}if(o<r){He.error("Data zakoczenia nie moe by wczeniejsza ni data rezerwacji");return}if(!v){He.error("Wybierz klienta");return}if(D.length===0){He.error("Dodaj produkty");return}if(D.some(E=>!E.ilosc||E.ilosc<=0)){He.error("Wprowad ilo dla wszystkich produktw");return}Y(new Set),ne(!0);try{const E=await fetch(`${Ha}/api/reservations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:v.id,numer_rezerwacji:c,data_utworzenia:r.toISOString().split("T")[0],data_zakonczenia:o.toISOString().split("T")[0],komentarz:fe.trim()||null,products:D})});if(!E.ok){const F=await E.text();let A="Failed to create reservation";try{const q=JSON.parse(F);A=q.details?.message||q.error||A}catch{console.error("Non-JSON error response when creating reservation:",F)}throw new Error(A)}He.success("Rezerwacja zostaa utworzona"),z(),t&&t()}catch(E){console.error("Error creating reservation:",E),He.error(E.message||"Wystpi bd podczas tworzenia rezerwacji")}finally{ne(!1)}};return u.jsx(ar,{isOpen:e,onRequestClose:z,style:{content:{width:"720px",height:"600px",maxWidth:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",borderRadius:"0.5rem",background:"white",overflow:"visible",outline:"none",padding:"24px",fontFamily:"Sora",zIndex:9999},overlay:{backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999}},children:u.jsxs("div",{className:"font-sora h-full flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8 select-none",children:[u.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Dodawanie rezerwacji"}),u.jsx("button",{onClick:z,className:"text-red-500 focus:outline-none",children:u.jsx(Ct,{size:20})})]}),u.jsxs("div",{className:"space-y-6 flex-grow overflow-y-auto pr-2",children:[u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data rezerwacji"}),u.jsx(wn,{selected:r,onChange:D=>a(D),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50"})]}),u.jsxs("div",{className:"w-[180px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Numer rezerwacji"}),u.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs bg-gray-50",placeholder:"R001_DD_MM_YYYY"})]}),u.jsxs("div",{className:"w-[200px]",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Data zakoczenia rezerwacji"}),u.jsx(wn,{selected:o,onChange:D=>l(D),locale:"pl",dateFormat:"dd/MM/yyyy",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs",placeholderText:"Wybierz dat",popperClassName:"z-50",minDate:r||new Date})]})]})}),u.jsxs("div",{className:"relative",children:[u.jsx("label",{htmlFor:"client-search",className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Klient"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"client-search",value:h,onChange:D=>{p(D.target.value),v&&w(null)},placeholder:"Wyszukaj klienta...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"}),b&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),m.length>0&&!v&&u.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:m.map(D=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>{w(D),p(D.nazwa),g([])},children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:D.nazwa}),u.jsx("span",{className:"text-[10px] text-gray-500",children:D.firma})]})},D.id))}),v&&u.jsx("div",{className:"bg-green-50 py-1.5 px-3 rounded-md mt-2",children:u.jsxs("div",{className:"flex justify-center items-center relative",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.nazwa}),u.jsx("p",{className:"font-bold text-gray-900 text-xs",children:v.firma})]}),u.jsx("button",{onClick:()=>{w(null),p("")},className:"text-gray-500 hover:text-gray-700 absolute right-0",children:u.jsx(Ct,{size:16})})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2 font-sora",children:"Komentarz"}),u.jsx("textarea",{value:fe,onChange:D=>de(D.target.value),rows:2,placeholder:"zostaw komentarz",className:"w-full px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs resize-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 font-sora",children:"Produkty"}),C.map(D=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-1 max-w-[70%]",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Yn,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",value:D.searchQuery,onChange:E=>{const F=E.target.value;console.log(" Product search input changed for fieldId:",D.id,"value:",F),W(A=>A.map(q=>q.id===D.id?{...q,searchQuery:F,selectedProduct:null}:q)),V(D.id)},onFocus:()=>V(D.id),placeholder:"Wyszukaj produkty...",className:"w-full pl-10 pr-3 py-1.5 border border-gray-300 rounded-md focus:outline-none font-sora text-xs"})]}),u.jsx("div",{className:"w-16 ml-8",children:u.jsx("input",{type:"number",min:"1",placeholder:"ilo",value:D.selectedProduct?.selectedQuantity||"",onChange:E=>{const F=E.target.value,A=F===""?0:Math.max(1,parseInt(F)||0);W(q=>{const H=q.map(ue=>ue.id===D.id&&ue.selectedProduct?{...ue,selectedProduct:{...ue.selectedProduct,selectedQuantity:A}}:ue);oe.current=null;const L=H.find(ue=>ue.id===D.id);if(L?.selectedProduct){const ue=parseInt(L.selectedProduct.ilosc)||0,I=L.selectedProduct.ilosc_reserved||0,Oe=Math.max(0,ue-I);A===0?Y(Ae=>{const Xe=new Set(Ae);return Xe.delete(D.id),Xe}):A>Oe?(Y(Ae=>{const Xe=new Set(Ae);return Xe.add(D.id),Xe}),I>0?He.error(`Niewystarczajca ilo - dostpne: ${Oe} (na magazynie: ${ue}, z nich w rezerwacji: ${I})`):He.error(`Niewystarczajca ilo - dostpne: ${Oe} (na magazynie: ${ue})`)):Y(Ae=>{const Xe=new Set(Ae);return Xe.delete(D.id),Xe})}else Y(ue=>{const I=new Set(ue);return I.delete(D.id),I});return H})},className:`w-full px-3 py-1.5 border rounded-md focus:outline-none font-sora text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none ${ee.has(D.id)?"border-red-500 bg-red-50":"border-gray-300"}`})}),C.length>1&&u.jsx("button",{onClick:()=>le(D.id),className:"ml-4 text-red-400 hover:text-red-600",title:"Usu pozycj",children:u.jsx(Ct,{size:16})})]}),D.id===Math.max(...C.map(E=>E.id))&&u.jsx("button",{onClick:X,className:"absolute -bottom-7 left-0 text-gray-400 hover:text-gray-600",title:"Dodaj now pozycj",children:u.jsx(Hn,{size:16})}),P&&J===D.id&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}),T.length>0&&J===D.id&&!D.selectedProduct&&D.searchQuery.trim()&&u.jsx("div",{className:"absolute z-50 mt-1 w-[70%] bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm border border-gray-200",children:T.map((E,F)=>u.jsx("div",{className:"cursor-pointer select-none relative py-1 pl-3 pr-9 hover:bg-blue-50",onClick:()=>se(D.id,{...E,selectedQuantity:0}),children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-[10px]",children:E.kod}),E.nazwa.includes(" (samples)")?u.jsxs("div",{className:"text-[10px]",children:[u.jsx("span",{className:"text-gray-500",children:E.nazwa.replace(" (samples)","")})," ",u.jsx("span",{className:"font-medium",children:"(samples)"})]}):u.jsx("span",{className:"text-[10px] text-gray-500",children:E.nazwa}),u.jsxs("span",{className:"text-[10px] text-gray-500",children:["Dostpna ilo: ",E.ilosc]}),(E.ilosc_reserved??0)>0&&u.jsxs("span",{className:"text-[10px] text-red-500",children:["Z nich w rezerw: ",E.ilosc_reserved??0]})]})},`${E.kod}-${E.nazwa||""}-${F}`))})]},D.id))]})]}),u.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",children:u.jsx("button",{onClick:G,disabled:B||!S(),className:`px-6 py-1.5 text-white text-xs rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-sora ${B||!S()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:B?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Dodawanie..."]}):"Dodaj"})}),u.jsxs("div",{className:"absolute bottom-4 right-4 text-xs text-gray-600 font-sora",children:["Razem: ",u.jsx("span",{className:"font-semibold text-gray-900",children:R()})]})]})})},mR=e=>(e(!0),!0);ar.setAppElement("#root");const gR=`
  .react-tooltip {
    z-index: 10000 !important;
    max-width: 400px !important;
  }
`,er="";console.log("API_URL configured as:",er);function vR(){const[e,n]=N.useState(!1),[t,r]=N.useState(!1),[a,o]=N.useState(!1),[l,c]=N.useState(!1),[f,h]=N.useState(!1),[p,m]=N.useState(!1),[g,v]=N.useState(null),[w,b]=N.useState(null),[k,T]=N.useState(["inventory","clients","orders","inventoryStatus"]),[j,C]=N.useState(()=>{const ce=localStorage.getItem("activeTab")||"inventory",Pe=localStorage.getItem("activeSubTab"),ze=["inventory","clients","orders","inventoryStatus"],et=["przyjecie","analiza","kalendarz","wydanie","rezerwacje","analiza_towarow","faktury"],at=ze.includes(ce)?ce:"inventory";let ae="przyjecie";at==="orders"&&(ae="wydanie");const ge=Pe&&et.includes(Pe)?Pe:ae;return{sheetsData:[],sheets:[],activeSheet:null,showTable:!1,clients:[],products:[],productReceipts:[],activeTab:at,activeSubTab:ge,isDbInitialized:!1}}),[W,J]=N.useState(!1),[V,P]=N.useState(!1),[U,B]=N.useState(!1),[ne,ee]=N.useState(!1),[Y,fe]=N.useState(!1),[de,oe]=N.useState(null),[he,X]=N.useState(!1),[le,z]=N.useState(null),[se,R]=N.useState(0),[S,G]=N.useState(0),[D,E]=N.useState(0),[F,A]=N.useState([]),[q,H]=N.useState(!1),[L,ue]=N.useState(null),[I,Oe]=N.useState(null);N.useEffect(()=>{(async()=>{try{console.log(" Starting data loading process..."),console.log(" API_URL:",er),console.log(" Loading clients...");const Pe=await Yt();console.log(" Clients loaded:",Pe.length),console.log(" Loading products...");const ze=await Ft();console.log(" Products loaded:",ze.length),console.log(" Loading product receipts...");const et=await Bt();console.log(" Product receipts loaded:",et.length),console.log(" Updating app state with loaded data..."),console.log(" Setting clients:",Pe),C(at=>{const ae={...at,clients:Pe,products:ze,productReceipts:et};return console.log(" New app state:",ae),ae}),console.log(" App state updated successfully"),console.log(" Final data counts:"),console.log("   - Clients:",Pe.length),console.log("   - Products:",ze.length),console.log("   - Product Receipts:",et.length)}catch(Pe){console.error(" Error loading data:",Pe),He.error("Bd podczas adowania danych")}finally{console.log(" Data loading process completed")}})()},[]),N.useEffect(()=>{const ce=document.createElement("style");return ce.textContent=gR,document.head.appendChild(ce),()=>{document.head.contains(ce)&&document.head.removeChild(ce)}},[]),N.useEffect(()=>{if(!j.isDbInitialized)return;console.log(" useEffect triggered - clients changed:",j.clients.length),(async()=>{const Pe={sheets:j.sheets,sheetsData:j.sheetsData,activeSheet:j.activeSheet,showTable:j.showTable,clients:j.clients,products:j.products,productReceipts:j.productReceipts};try{localStorage.setItem("appState",JSON.stringify(Pe)),console.log("App state saved to localStorage")}catch(ze){console.error("Error saving state to localStorage:",ze)}})()},[j.sheetsData,j.sheets,j.activeSheet,j.showTable,j.clients,j.products,j.productReceipts]);const Ae=async()=>{try{console.log(" Loading sheets from database..."),console.log(" Making request to:",`${er}/api/original-sheets`);const ce=await fetch(`${er}/api/original-sheets`);if(console.log(" Sheets response status:",ce.status),!ce.ok)throw new Error(`HTTP error! status: ${ce.status}`);const Pe=await ce.json();console.log(" Received sheets from server:",Pe),console.log(" Sheets count:",Pe.length);const ze=Pe.map(et=>({fileName:et.fileName,data:{headers:et.data.headers,rows:et.data.rows}}));console.log(" Processed sheets:",ze),console.log(" Processed sheets count:",ze.length),C(et=>({...et,sheets:ze,sheetsData:ze,activeSheet:null,showTable:!1,isDbInitialized:!0})),console.log(" App state updated with sheets data")}catch(ce){console.error("     :",ce),He.error("    ")}finally{console.log(" Loading sheets completed")}};N.useEffect(()=>{Ae()},[]);const Xe=async(ce,Pe)=>{console.log("handleExcelUpload called with:",{newFileName:ce,fileData:Pe});try{const ze=await fetch(`${er}/api/sheets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:ce,data:Pe})});if(!ze.ok){if(ze.status===409){He.error("Moe by tylko jeden plik Excel. Usu istniejcy plik przed zaadowaniem nowego.");return}throw new Error(`HTTP error! status: ${ze.status}`)}await Ae(),n(!1)}catch(ze){console.error("Error saving file data:",ze),He.error("Bd podczas zapisywania danych pliku")}},qe=ce=>{const Pe=`${er}/api/download_file/${encodeURIComponent(ce.fileName)}`;window.open(Pe,"_blank")},pe=ce=>{b(ce)},Ne=ce=>{ce.preventDefault()},je=ce=>{!w||w===ce||(T(Pe=>{const ze=[...Pe],et=ze.indexOf(w),at=ze.indexOf(ce);return ze.splice(et,1),ze.splice(at,0,w),ze}),b(null))},_e=ce=>{if(ce==="inventory"||ce==="clients"||ce==="orders"||ce==="inventoryStatus"){const Pe=ce==="inventory"?"przyjecie":ce==="orders"?"wydanie":null;localStorage.setItem("activeTab",ce),Pe&&localStorage.setItem("activeSubTab",Pe),C(ze=>({...ze,activeTab:ce,activeSubTab:Pe}))}},Qe=ce=>{localStorage.setItem("activeSubTab",ce),C(Pe=>({...Pe,activeSubTab:ce}))};N.useEffect(()=>{j.activeSubTab==="analiza_towarow"&&pt()},[j.activeSubTab,D]);const ft=ce=>{switch(ce){case"inventory":return"Zakup towarw";case"clients":return"Klienci";case"orders":return"Sprzeda towarw";case"inventoryStatus":return"Stany magazynowe";default:return ce}},ht=()=>{c(!1),n(!1)},vt=async ce=>{try{console.log(" Starting handleAddProduct..."),console.log(" Received data:",ce),console.log(" Files check:",{hasProductInvoice:!!ce.productInvoice,hasTransportInvoice:!!ce.transportInvoice,productInvoice:ce.productInvoice,transportInvoice:ce.transportInvoice}),console.log(" Making request to:",`${er}/api/product-receipts`);let Pe;if(ce.productInvoice||ce.transportInvoice){console.log(" Files detected, using FormData...");const at=new FormData,ae={date:ce.date,sprzedawca:ce.sprzedawca,wartosc:ce.wartosc,kosztDostawy:ce.kosztDostawy,aktualnyKurs:ce.aktualnyKurs,podatekAkcyzowy:ce.podatekAkcyzowy,products:ce.products};at.append("data",JSON.stringify(ae)),console.log(" JSON data:",ae),ce.productInvoice&&(at.append("productInvoice",ce.productInvoice),console.log(" Product invoice added:",ce.productInvoice.name)),ce.transportInvoice&&(at.append("transportInvoice",ce.transportInvoice),console.log(" Transport invoice added:",ce.transportInvoice.name)),console.log(" FormData entries:");for(let[ge,De]of at.entries())console.log(`  ${ge}:`,De);Pe=await fetch(`${er}/api/product-receipts`,{method:"POST",body:at})}else{console.log(" No files, using JSON...");const at={date:ce.date,sprzedawca:ce.sprzedawca,wartosc:ce.wartosc,kosztDostawy:ce.kosztDostawy,aktualnyKurs:ce.aktualnyKurs,podatekAkcyzowy:ce.podatekAkcyzowy,products:ce.products};console.log(" JSON data:",at),Pe=await fetch(`${er}/api/product-receipts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(at)})}if(console.log(" Response status:",Pe.status),console.log(" Response headers:",Pe.headers),!Pe.ok){const at=await Pe.text();throw console.error(" Response error text:",at),new Error(`Failed to save product receipt: ${Pe.status} - ${at}`)}const ze=await Pe.json();if(console.log(" Saved receipt:",ze),ze.workingSheetsUpdated||ze.workingSheetsInserted){let at="Dodano nowy towar";ze.workingSheetsUpdated>0&&(at+=` (${ze.workingSheetsUpdated}    working sheets)`),ze.workingSheetsInserted>0&&(at+=` (${ze.workingSheetsInserted}     working sheets)`),He.success(at)}else He.success("Dodano nowy towar");console.log(" Loading updated receipts...");const et=await Bt();console.log(" Updated receipts:",et),console.log(" Updating app state..."),C(at=>{const ae={...at,productReceipts:et};return console.log(" New app state:",ae),ae}),o(!1)}catch(Pe){console.error(" Error adding product:",Pe),He.error("Wystpi bd podczas dodawania towaru")}},jt=async ce=>{console.log("=== HANDLE UPDATE RECEIPT DEBUG ==="),console.log("Received data:",ce),console.log(" Files check (update):",{hasProductInvoice:!!ce.productInvoice,hasTransportInvoice:!!ce.transportInvoice,productInvoice:ce.productInvoice,transportInvoice:ce.transportInvoice});try{let Pe;if(ce.productInvoice||ce.transportInvoice){console.log(" Files detected (update), using FormData...");const ae=new FormData,ge={date:ce.date,sprzedawca:ce.sprzedawca,wartosc:ce.wartosc,kosztDostawy:ce.kosztDostawy,products:ce.products};ae.append("data",JSON.stringify(ge)),console.log(" JSON data (update):",ge),ce.productInvoice&&(ae.append("productInvoice",ce.productInvoice),console.log(" Product invoice added (update):",ce.productInvoice.name)),ce.transportInvoice&&(ae.append("transportInvoice",ce.transportInvoice),console.log(" Transport invoice added (update):",ce.transportInvoice.name)),console.log(" FormData entries (update):");for(let[De,Re]of ae.entries())console.log(`  ${De}:`,Re);Pe=await fetch(`${er}/api/product-receipts/${ce.id}`,{method:"PUT",body:ae})}else console.log(" No files (update), using JSON..."),Pe=await fetch(`${er}/api/product-receipts/${ce.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:ce.date,sprzedawca:ce.sprzedawca,wartosc:ce.wartosc,kosztDostawy:ce.kosztDostawy,aktualnyKurs:ce.aktualnyKurs,podatekAkcyzowy:ce.podatekAkcyzowy,products:ce.products})});if(!Pe.ok)throw new Error("Failed to update product receipt");const ze=await Pe.json();console.log("Updated receipt:",ze),console.log("Loading updated receipts...");const et=await Bt();console.log("Updated receipts:",et),console.log("Loading updated products...");const at=await Ft();console.log("Updated products:",at),console.log("Updating app state..."),C(ae=>{const ge={...ae,productReceipts:et,products:at};return console.log("New app state:",ge),ge}),He.success("Zakup zosta zaktualizowany"),fe(!1),oe(null),h(!1),v(null)}catch(Pe){console.error("Error updating product receipt:",Pe),He.error("Wystpi bd podczas aktualizacji zakupu")}},Gt=async ce=>{try{if(!(await fetch(`${er}/api/product-receipts/${ce}`,{method:"DELETE"})).ok)throw new Error("Failed to delete receipt");const ze=await Bt(),et=await Ft();C(at=>({...at,productReceipts:ze,products:et})),He.success("Zakup zosta usunity")}catch(Pe){console.error("Error deleting receipt:",Pe),He.error("Wystpi bd podczas usuwania zakupu")}},sr=async ce=>{try{const Pe=await fetch(`${er}/api/clients`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});if(!Pe.ok)throw new Error("Failed to add client");const ze=await Pe.json(),et={...ce,id:ze.id};C(at=>({...at,clients:[...at.clients,et]})),G(at=>at+1),He.success("Klient zosta dodany")}catch(Pe){console.error("Error adding client:",Pe),He.error("Bd podczas dodawania klienta")}},Rt=async ce=>{try{if(!(await fetch(`${er}/api/clients/${ce}`,{method:"DELETE"})).ok)throw new Error("Failed to delete client");C(ze=>({...ze,clients:ze.clients.filter(et=>et.id!==ce)})),G(ze=>ze+1),He.success("Klient zosta usunity")}catch(Pe){console.error("Error deleting client:",Pe),He.error("Bd podczas usuwania klienta")}},Ht=async ce=>{try{console.log(" handleUpdateClient called with data:",ce);const Pe=await fetch(`${er}/api/clients/${ce.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});if(!Pe.ok)throw new Error("Failed to update client");const ze=await Pe.json();console.log(" Client updated in database:",ze),console.log(" Updated client fields:",{id:ze.id,firma:ze.firma,nazwa:ze.nazwa,adres:ze.adres,czas_dostawy:ze.czas_dostawy,kontakt:ze.kontakt}),C(et=>{console.log(" Updating app state..."),console.log(" Previous clients:",et.clients),console.log(" Updated client data:",ze);const at=et.clients.map(ge=>ge.id===ce.id?(console.log(" Updating client:",ge.id,"from:",ge,"to:",{...ge,...ze}),{id:ge.id,firma:ze.firma||ge.firma,nazwa:ze.nazwa||ge.nazwa,adres:ze.adres||ge.adres,czas_dostawy:ze.czas_dostawy||ge.czas_dostawy,kontakt:ze.kontakt||ge.kontakt}):{...ge});console.log(" New clients array:",at);const ae={...et,clients:at};return console.log(" New app state:",ae),ae}),He.success("Klient zosta zaktualizowany"),setTimeout(()=>{C(et=>(console.log(" Force update after timeout"),{...et})),G(et=>et+1),Oe(ce.id),Yt().then(et=>{C(at=>({...at,clients:et})),G(at=>at+1)})},100)}catch(Pe){console.error("Error updating client:",Pe),He.error("Bd podczas aktualizacji klienta")}},pt=async()=>{try{H(!0),ue(null);const ce=await fetch(`${er}/api/reservations/active-products`);if(!ce.ok)throw new Error(`HTTP ${ce.status}`);const Pe=await ce.json();console.log(" Active reservation products loaded:",Pe.length),A(Pe)}catch(ce){console.error(" Error loading analysis products:",ce),ue(ce.message||"Bd adowania danych")}finally{H(!1)}},Nt=async ce=>{console.log("=== HANDLE UPDATE ORDER DEBUG ==="),console.log("Received data:",ce),console.log("Products data:",JSON.stringify(ce.products,null,2));try{const Pe=await fetch(`${er}/api/orders/${ce.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});if(!Pe.ok)throw new Error("Failed to update order");const ze=await Pe.json();console.log("Updated order result:",ze),He.success("Zamwienie zostao zaktualizowane"),R(et=>et+1)}catch(Pe){console.error("Error updating order:",Pe),He.error("Bd podczas aktualizacji zamwienia")}},Yt=async()=>{try{console.log(" Loading clients from:",`${er}/api/clients`);const ce=await fetch(`${er}/api/clients`);if(console.log(" Clients response status:",ce.status),!ce.ok)throw new Error(`HTTP error! status: ${ce.status}`);const Pe=await ce.json();return console.log(" Loaded clients:",Pe.length,"records"),console.log(" First client:",Pe[0]),Pe}catch(ce){return console.error(" Error loading clients:",ce),[]}},Ft=async()=>{try{console.log(" Loading products from:",`${er}/api/products`);const ce=await fetch(`${er}/api/products`);if(console.log(" Products response status:",ce.status),!ce.ok)throw new Error(`HTTP error! status: ${ce.status}`);const Pe=await ce.json();console.log(" Loaded products:",Pe.length,"records"),console.log(" First product:",Pe[0]);const ze=Pe.map(et=>({kod:et.kod,nazwa:et.nazwa,ilosc:et.ilosc,jednostka_miary:et.jednostka_miary||"",kod_kreskowy:et.kod_kreskowy||"",data_waznosci:et.data_waznosci??void 0,archiwalny:et.archiwalny,rezerwacje:et.rezerwacje,ilosc_na_poleceniach:et.ilosc_na_poleceniach,waga_netto:et.waga_netto,waga_brutto:et.waga_brutto,objetosc:et.objetosc,opis:et.opis}));return console.log(" Processed products:",ze.length,"records"),ze}catch(ce){return console.error(" Error loading products:",ce),[]}},Bt=async()=>{try{console.log(" Loading product receipts from:",`${er}/api/product-receipts`);const ce=await fetch(`${er}/api/product-receipts`);if(console.log(" Product receipts response status:",ce.status),!ce.ok)throw new Error(`HTTP error! status: ${ce.status}`);const Pe=await ce.json();return console.log(" Loaded product receipts:",Pe.length,"records"),Pe.map(ze=>({id:ze.id,dataPrzyjecia:ze.dataPrzyjecia,sprzedawca:ze.sprzedawca||"",wartosc:ze.wartosc||0,kosztDostawy:ze.kosztDostawy||0,aktualny_kurs:ze.aktualny_kurs,podatek_akcyzowy:ze.podatek_akcyzowy,aktualnyKurs:ze.aktualnyKurs,podatekAkcyzowy:ze.podatekAkcyzowy,products:ze.products||[],productInvoice:ze.productInvoice,transportInvoice:ze.transportInvoice}))}catch(ce){return console.error(" Error loading product receipts:",ce),[]}},ve=async ce=>{try{console.log(" Searching working_sheets with query:",ce),console.log(" Making request to:",`${er}/api/working-sheets/search?query=${encodeURIComponent(ce)}`);const Pe=await fetch(`${er}/api/working-sheets/search?query=${encodeURIComponent(ce)}`);if(console.log(" Search response status:",Pe.status),!Pe.ok)throw new Error(`HTTP error! status: ${Pe.status}`);const ze=await Pe.json();return console.log(" Search results:",ze.length,"items found"),ze.map(at=>({kod:at.kod,nazwa:at.nazwa,ilosc:at.ilosc.toString(),kodKreskowy:at.kod_kreskowy||""}))}catch(Pe){return console.error(" Error searching working_sheets:",Pe),[]}},Ze=()=>{R(ce=>ce+1)},kt=()=>{R(ce=>ce+1)};return u.jsxs("div",{className:"min-h-screen bg-gray-100",children:[u.jsx(RO,{position:"top-right"}),u.jsx(vw,{isOpen:ne,onClose:()=>ee(!1),product:null}),u.jsx(B4,{isOpen:e,onClose:()=>n(!1),onUpload:Xe}),u.jsx(W4,{isOpen:l,onClose:()=>c(!1),fileName:"",onConfirm:ht}),u.jsx($A,{isOpen:a,onClose:()=>o(!1),onSubmit:vt}),u.jsx(aR,{isOpen:t,onClose:()=>r(!1),onAdd:sr}),u.jsx(kw,{isOpen:he,onClose:()=>{X(!1),z(null)},onSubmit:Ht,client:le}),u.jsx(yw,{isOpen:f,onClose:()=>h(!1),receipt:g}),u.jsx(ww,{isOpen:Y,onClose:()=>{fe(!1),oe(null)},onSubmit:jt,receipt:de}),u.jsx(zO,{isOpen:W,onClose:()=>J(!1),onOrderCreated:Ze}),u.jsx(pR,{isOpen:V,onClose:()=>P(!1),onSubmit:kt}),u.jsx(hR,{isOpen:U,onClose:()=>B(!1),onSubmit:()=>{B(!1),R(ce=>ce+1)}}),u.jsx(xR,{isOpen:p,onClose:()=>m(!1),onReservationCreated:()=>{E(ce=>ce+1),m(!1)},apiUrl:er}),u.jsx("div",{className:"bg-white shadow-sm",children:u.jsx("div",{className:"container mx-auto px-4 py-3",children:u.jsx("img",{src:nR,alt:"Enoterra Logo",className:"h-32"})})}),u.jsx("div",{className:"bg-gray-100",children:u.jsx("div",{className:"container mx-auto px-4",children:u.jsx("div",{className:"flex items-center h-14",children:u.jsx("div",{className:"flex space-x-4",children:k.map(ce=>u.jsx("div",{draggable:!0,onDragStart:()=>pe(ce),onDragOver:Ne,onDrop:()=>je(ce),className:`relative -mb-px cursor-pointer ${j.activeTab===ce?"border-2 border-blue-500 rounded-none":"rounded-t-lg"} px-6 py-4 transition-colors ${w===ce?"opacity-50":""}`,onClick:()=>_e(ce),children:u.jsx("h1",{className:"text-sm font-medium text-black font-sora",children:ft(ce)})},ce))})})})}),u.jsx("div",{className:"bg-white shadow-sm min-h-screen",children:u.jsx("div",{className:"container mx-auto px-4 py-6",children:u.jsxs("div",{className:"flex items-start -mt-2",children:[j.activeTab==="inventory"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>Qe("przyjecie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${j.activeSubTab==="przyjecie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Przyjcie towarw"}),u.jsx("button",{onClick:()=>Qe("analiza"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${j.activeSubTab==="analiza"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza zakupw"}),u.jsx("button",{onClick:()=>Qe("kalendarz"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${j.activeSubTab==="kalendarz"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Kalendarz patnoci"})]}),j.activeSubTab==="przyjecie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>o(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj towar"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>mR(n),children:[u.jsx("button",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white",title:"Importuj",children:u.jsx(vb,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Importuj plik"})})]})]}),u.jsx(sR,{receipts:j.productReceipts,onDelete:Gt,onUpdate:jt})]}),j.activeSubTab==="analiza"&&u.jsx("div",{className:"flex flex-col gap-4",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Analiza zakupw"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja analizy zakupw bdzie dostpna wkrtce."})]})}),j.activeSubTab==="kalendarz"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Kalendarz patnoci"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja kalendarza patnoci bdzie dostpna wkrtce."})]})})]}),j.activeTab==="inventory"&&u.jsx("div",{className:"absolute top-16 right-4 flex justify-end",children:j.sheets.map(ce=>u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("button",{onClick:()=>qe(ce),title:":     ",className:"px-4 py-1.5 bg-green-50 text-green-700 rounded-md inline-flex items-center hover:bg-green-100 transition-colors font-semibold text-[10px] cursor-pointer font-sora w-fit whitespace-nowrap",children:ce.fileName})},ce.fileName))}),j.activeTab==="inventory"&&j.showTable&&j.activeSheet&&u.jsx("div",{className:"mt-6 bg-white",children:u.jsx("div",{className:"rounded-lg shadow-sm border border-gray-200 bg-white mt-6",children:u.jsx(HA,{data:j.activeSheet.data})})}),j.activeTab==="clients"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>r(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj klienta"})})]})}),u.jsx(iR,{clients:j.clients,onDelete:Rt,onUpdate:Ht},`clients-${S}-${I||"none"}`)]}),j.activeTab==="orders"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>Qe("wydanie"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${j.activeSubTab==="wydanie"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Wydanie towarw"}),u.jsx("button",{onClick:()=>Qe("rezerwacje"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${j.activeSubTab==="rezerwacje"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Rezerwacje"}),u.jsx("button",{onClick:()=>Qe("analiza_towarow"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${j.activeSubTab==="analiza_towarow"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Analiza towarw"}),u.jsx("button",{onClick:()=>Qe("faktury"),className:`px-4 py-2 text-sm font-medium font-sora transition-colors ${j.activeSubTab==="faktury"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Faktury"})]}),j.activeSubTab==="wydanie"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[u.jsx("div",{className:"mb-4",children:u.jsx("div",{className:"w-1/2 mx-auto",children:u.jsx(YA,{onSearch:ve})})}),u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>J(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj zamowienie"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>P(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white",title:"Zwrot",children:u.jsx(Ct,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Zwrot towaru"})})]}),u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>B(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-orange-500 rounded-full flex items-center justify-center text-white",title:"Odpisanie",children:u.jsx(wb,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Odpisanie towaru"})})]})]}),u.jsx(UO,{onDeleteOrder:ce=>{console.log("Delete order:",ce)},onUpdateOrder:Nt,refreshTrigger:se})]}),j.activeSubTab==="rezerwacje"&&u.jsxs("div",{className:"flex flex-col gap-4 mt-4 w-full",children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"inline-flex items-center cursor-pointer border border-transparent rounded-md px-2 py-1 hover:bg-gray-50 hover:border-gray-200 bg-white w-fit",onClick:()=>m(!0),children:[u.jsx("button",{type:"button",className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white",title:"Dodaj",children:u.jsx(Hn,{size:16})}),u.jsx("div",{className:"px-2",children:u.jsx("span",{className:"text-gray-900 font-sora text-[13px]",children:"Dodaj rezerwacj"})})]})}),u.jsx(YO,{refreshTrigger:D})]}),j.activeSubTab==="analiza_towarow"&&u.jsxs("div",{className:"space-y-4 mt-6",children:[q&&u.jsx("div",{className:"text-gray-600 font-sora text-sm",children:"adowanie danych..."}),L&&u.jsx("div",{className:"text-red-600 font-sora text-sm",children:L}),!q&&!L&&u.jsx("div",{className:"w-full overflow-y-scroll max-h-96 relative",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-0 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Kod"}),u.jsx("th",{className:"px-10 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Nazwa"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Pozostao"}),u.jsx("th",{className:"px-0 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Wydane"}),u.jsx("th",{className:"px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200 font-sora bg-gray-50",children:"Zarezerwowane"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.filter(ce=>{const Pe=ce.ilosc??0,ze=ce.ilosc_wydane??0;return Pe-ze>0}).length>0?F.filter(ce=>{const Pe=ce.ilosc??0,ze=ce.ilosc_wydane??0;return Pe-ze>0}).map((ce,Pe)=>{const ze=ce.ilosc??0,et=ce.ilosc_wydane??0,at=ze-et,ae=ce.product_kod??"",ge=ce.product_nazwa??"",De=ce.klienci||[];return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:ae}),u.jsx("td",{className:"px-10 py-4 whitespace-nowrap text-sm text-gray-900 font-sora",children:ge}),u.jsx("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center",children:u.jsx("span",{className:at>0?"text-green-600 font-medium":"text-gray-400",children:at})}),u.jsxs("td",{className:"px-0 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center text-red-600 cursor-pointer","data-tooltip-id":`wydane-tooltip-${ce.product_kod}-${Pe}`,children:[et,et>0&&u.jsx(ti,{id:`wydane-tooltip-${ce.product_kod}-${Pe}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:ce.zamowienia_z_iloscia&&ce.zamowienia_z_iloscia.length>0?ce.zamowienia_z_iloscia.map((Re,$e)=>u.jsxs("div",{className:$e===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:Re.numer_zamowienia}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[Re.ilosc," szt"]})]},$e)):u.jsx("div",{children:"Brak danych o zamwieniach"})})})]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-sora text-center cursor-pointer","data-tooltip-id":`zarezerwowane-tooltip-${ce.product_kod}-${Pe}`,children:[ze,De.length>0&&u.jsx(ti,{id:`zarezerwowane-tooltip-${ce.product_kod}-${Pe}`,className:"max-w-md",place:"top",positionStrategy:"fixed",noArrow:!0,children:u.jsx("div",{className:"font-sora",children:De.map((Re,$e)=>u.jsxs("div",{className:$e===0?"":"mt-0.5",children:[u.jsx("span",{className:"font-medium",children:Re.klient||""}),u.jsxs("span",{className:"text-gray-500 ml-2",children:[Re.ilosc??0," szt"]})]},$e))})})]})]},`${ce.product_kod}-${Pe}`)}):u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-sm text-gray-500",children:"Brak towarw w aktywnych rezerwacjach"})})})]})})]}),j.activeSubTab==="faktury"&&u.jsx("div",{className:"flex flex-col gap-4 mt-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-900 font-sora mb-4",children:"Faktury"}),u.jsx("p",{className:"text-gray-600 font-sora",children:"Funkcja faktur bdzie dostpna wkrtce."})]})})]}),j.activeTab==="inventoryStatus"&&u.jsx("div",{className:"flex flex-col gap-4 mt-4 w-full",children:u.jsx(fR,{productReceipts:j.productReceipts})})]})})})]})}xb.createRoot(document.getElementById("root")).render(u.jsx(N.StrictMode,{children:u.jsx(vR,{})}));
